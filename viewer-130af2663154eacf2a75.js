//search for "compute KdTree" -> rip(n)
function rip(temp1)
{
    var geomNodes = [];
    function recurse(node)
    {
        if (node.className() == 'Node') geomNodes.push(node);
        if (node.children.length) {
            for (var i = 0; i < node.children.length; ++i) {
                recurse(node.children[i]);
            }
        }
    }
    recurse(temp1);

    for (var tt = 0; tt <  geomNodes.length; tt++) {

        if ( geomNodes[tt]._name == null || geomNodes[tt]._name == 'rootModel') {
            continue;
        }

        console.log('processing mesh ' + tt + ': ' +  geomNodes[tt]._name);
        var vertexOffset = 0;
        var objV = '';
        var objN = '';
        var objF = '';

        var submeshes =  geomNodes[tt].children;
        for (var n = 0; n < submeshes.length; n++) {

            var sw = false; //face order switcher

            if (submeshes[n]._attributes == null){ continue; }

            console.log('processing submesh ' + n);
            var vertices = submeshes[n]._attributes.Vertex._elements;
            for (var i = 0; i < vertices.length; i += 3) {
                objV += 'v ';
                for (j = 0; j < 3; ++j) {
                    objV += vertices[i + j].toFixed(4) + ' ';
                }
                objV += '\n';
            }

            var normals = submeshes[n]._attributes.Normal._elements;
            for (var i = 0; i < normals.length; i += 3) {
                objN += 'vn ';
                for (j = 0; j < 3; ++j) {
                    objN += normals[i + j].toFixed(4) + ' ';
                }
                objN += '\n';
            }

            var primitives = submeshes[n]._primitives;
            for (p = 0; p < primitives.length; p++) {

                var faces = primitives[p].indices._elements;
                for (j = 0; j + 2 < faces.length; primitives[p].mode == 4 ? j += 3 : ++j) {

                    if (faces[j] != faces[j + 1] && faces[j + 1] != faces[j + 2] && faces[j] != faces[j + 2]) {
                        if (primitives[p].mode == 4) sw = false;
                        objF += 'f ';                        
                        
                        objF +=
                            (faces[j + (sw ? 2 : 0)] + vertexOffset + 1) + '//' + (faces[j + (sw ? 2 : 0)] + vertexOffset + 1) +
                            ' ' + (faces[j + 1] + vertexOffset + 1) + '//' + (faces[j + 1] + vertexOffset + 1) +
                            ' ' + (faces[j + (sw ? 0 : 2)] + vertexOffset + 1) + '//' + (faces[j + (sw ? 0 : 2)] + vertexOffset + 1);
                        
                        objF += '\n';
                    }
                    sw = !sw;

                }
            }

            vertexOffset += vertices.length / 3;
        } //submeshes

        var obj = 'g model\n\n' + objV + ' \n' + objN + '\n' + objF;

        //download
        var fileNameToSaveAs =  document.getElementsByClassName('model-name__label')[0].innerHTML + '.' + geomNodes[tt]._name + ".obj";
        var textFileAsBlob = new Blob([obj], {
            type: 'text/plain'
        });
        var downloadLink = document.createElement("a");
        downloadLink.download = fileNameToSaveAs;
        downloadLink.innerHTML = "Download File";
        downloadLink.href = window.webkitURL.createObjectURL(textFileAsBlob);
        downloadLink.click();
        textFileAsBlob = null;
    }
}

//viewer here













webpackJsonp([39], [, function (e, t, i) {
    "use strict";

    function n(e, t, i, n) {
        if ("function" != typeof e) return new Error("Property `" + t + "` of `" + i + "` has invalid OptionType notation inside " + n + ".")
    }

    function r(e) {
        function t(t, i, n, r, a, o) {
            var s = i[n];
            return o = o || n, null === s || void 0 === s ? t ? new Error("Required " + a + " `" + o + "` was not specified in `" + r + "`.") : null : e(i, n, r, a, o, _.a)
        }
        var i = t.bind(null, !1);
        return i.isRequired = t.bind(null, !0), i
    }

    function a(e) {
        return Array.isArray(e) ? "array" : void 0 === e ? "undefined" : h()(e)
    }

    function o(e) {
        return e instanceof p.a.Model
    }

    function s(e) {
        return e instanceof p.a.Collection
    }

    function u(e) {
        return r(function (t, i, r, o, s) {
            var u = n(e, s, r, "valuesOf");
            if (u) return u;
            var l = t[i],
                c = a(l);
            if ("object" !== c) return new Error("Invalid " + o + " `" + s + "` of type `" + c + "` supplied to `" + r + "`, expected an object.");
            for (var h in l) {
                var d = e(l, h, r, o, s + "." + h, _.a);
                if (d instanceof Error) return d
            }
            return null
        })
    }

    function l(e) {
        return r(function (t, i, n, r, s) {
            var u = t[i],
                l = a(u);
            if (!o(u)) return new Error("Invalid " + r + " `" + s + "` of type `" + l + "` supplied to `" + n + "`, expected `Backbone.Model`.");
            for (var c in e) {
                var h = e[c];
                if (h) {
                    var d = h(u.attributes, c, n, r, i + ".get('" + c + "')", _.a);
                    if (d) return d
                }
            }
            return null
        })
    }
    i.d(t, "a", function () {
        return C
    });
    var c = i(49),
        h = i.n(c),
        d = i(0),
        f = (i.n(d), i(24)),
        p = i.n(f),
        m = i(435),
        g = i.n(m),
        v = i(341),
        _ = i.n(v),
        b = l({}),
        S = r(function (e, t, i, n, r) {
            var o = e[t],
                u = a(o);
            return s(o) ? null : new Error("Invalid " + n + " `" + r + "` of type `" + u + "` supplied to `" + i + "`, expected `Backbone.Collection`.")
        }),
        x = function (e, t) {
            return r(function (i, n, r, a, o) {
                var s = g.a.number(i, n, r, a, o, _.a);
                if (s) return s;
                var u = i[n];
                return u < e || u > t ? new Error("Invalid " + a + " `" + n + "` of value `" + u + "` supplied to `" + r + "`, expected number between " + e + " and " + t + ".") : null
            })
        },
        y = Object(d.extend)({}, g.a);
    y.valuesOf = u, y.modelShape = l, y.model = b, y.collection = S, y.numberBetween = x, y.component = y.oneOfType([y.shape({
        viewClass: y.func.isRequired,
        options: y.object
    }).isRequired, y.arrayOf(y.shape({
        viewClass: y.func.isRequired,
        options: y.object
    })).isRequired]), y.selectOptionListOf = function (e) {
        return y.arrayOf(y.shape({
            title: y.string.isRequired,
            value: e,
            default: y.bool
        }).isRequired)
    }, t.b = y;
    var C = g.a.checkPropTypes
}, function (e, t, i) {
    "use strict";

    function n(e, t, i) {
        if (!e) return i ? "<div data-component " + (t ? 'class="' + t + '"' : "") + ">" + i + "</div>" : "";
        if ("function" != typeof e) throw D(e, t);
        var n = e();
        if (!n.isComponentElement) throw D(e, t);
        var r = "";
        try {
            r = n.template()
        } catch (e) {
            throw new Error("\n\nError while getting the template of Component `" + n.displayName + "`:\n\n" + e.stack + "\n\n")
        }
        return '<div data-component id="' + n.cid + '" ' + (t ? 'class="' + t + '"' : "") + ">" + r + "</div>"
    }

    function r(e, t, i) {
        return e.map(function (e) {
            return n(e, t, i)
        }).join("")
    }

    function a(e) {
        return p()(e).filter(function (t) {
            return e[t]
        }).join(" ")
    }

    function o(e) {
        return p()(Object(M.b)(e)).map(function (t) {
            return P.a(t) + ": " + e[t] + ";"
        }).join(" ")
    }

    function s(e, t) {
        return Object(b.escape)(e) + '="' + Object(b.escape)(t) + '"'
    }

    function u(e) {
        return _.a.runtime.markSafe(p()(Object(M.b)(e)).map(function (t) {
            var i = ["disabled", "checked", "selected", "readonly", "multiple"];
            return Object(b.includes)(i, t) ? e[t] ? s(t, !0) : "" : s(t.match(/^classNames?$/) ? "class" : P.a(t), "style" === t ? o(e[t]) : "classNames" === t ? a(e[t]) : e[t])
        }).join(" "))
    }
    Object.defineProperty(t, "__esModule", {
        value: !0
    });
    var l = i(80),
        c = i.n(l),
        h = i(7),
        d = i.n(h),
        f = i(26),
        p = i.n(f),
        m = i(3),
        g = i.n(m),
        v = i(335),
        _ = i.n(v),
        b = i(0),
        S = (i.n(b), i(165)),
        x = i(413),
        y = i(326),
        C = i(22),
        T = i(74),
        w = i(466),
        M = i(23),
        E = i(91),
        A = i(28),
        P = i(67),
        R = _.a.Loader.extend({
            getSource: function (e) {
                return {
                    src: {
                        type: "code",
                        obj: window.nunjucksPrecompiled[e]
                    },
                    path: e
                }
            }
        }),
        O = new _.a.Environment([new R], {
            autoescape: !0
        });
    O.addFilter("log", function (e) {
        return console.log("[Nunjucks] : ", e), e
    }), O.addFilter("urlize", P.o), O.addFilter("best_fit", y.a), O.addFilter("iterable", function (e) {
        return Array.isArray(e) ? e : [e]
    }), O.addFilter("slugify", P.j), O.addFilter("call_macro_by_name", function (e) {
        var t = this.ctx[e],
            i = Array.prototype.slice.call(arguments, 1);
        if (!t) throw new Error('Missing macro "' + e + '"');
        return t.apply(this, i)
    }), O.addFilter("user_profile_filled", function (e) {
        return "avatar-blue" !== e.avatars.name && "avatar-orange" !== e.avatars.name && "avatar-grey" !== e.avatars.name && (e.biography || e.tagline || e.city || e.country) && (e.website || e.twitterUsername || e.linkedinUsername || e.facebookUsername || e.unityConnectUrl)
    }), O.addFilter("has_plan_type", E.f), O.addFilter("badge_label", E.j), O.addFilter("print_suggestion_verb", function (e, t) {
        var i = "";
        return 0 === e && (i = t.displayName + " is a <b>popular</b> user"), 10 === e && (i = "You <b>liked</b> their models :"), 20 === e && (i = "You share a common <b>skill</b> :"), 30 === e && (i = "You share a common <b>interest</b> :"), 40 === e && (i = "Your profiles are similar."), _.a.runtime.markSafe(i)
    }), O.addFilter("print_suggestion_target", function (e, t) {
        if (0 === t) return "";
        if (10 === t) {
            var i = [];
            return e.forEach(function (e) {
                var t = g()('<a href="/models/' + e.uid + '">' + e.name + "</a>");
                i.push(g()("<div>").append(t).html())
            }), _.a.runtime.markSafe(i.join(", "))
        }
        return 20 === t ? e.name : 30 === t ? e.name : 40 === t ? "" : void 0
    });
    var I;
    O.addFilter("skill_slug_to_name", function (e) {
        return I || (I = new x.a, I.fetch({
            immediate: !0
        })), I.findWhere({
            slug: e
        }).get("name")
    });
    var F;
    O.addFilter("category_uid_to_name", function (e) {
        F || (F = new S.a, F.fetch({
            immediate: !0
        }));
        var t = F.findWhere({
                uid: e
            }),
            i = t.get("name");
        return t.get("parent") && (i = F.findWhere({
            uid: t.get("parent")
        }).get("name ") + "/" + i), i
    }), O.addFilter("underscorify", P.n), O.addFilter("image_container", function (e, t, i, n, r, a) {
        var o = Object(y.a)(e, t, i);
        return _.a.runtime.markSafe('\n        <div\n            class="image-container ' + (a && !Object(A.f)(o) ? "--loading" : "") + '"\n            ' + (a ? 'data-background="' + o + '"' : "") + '\n            style="\n                width: ' + (n ? "100%" : t + "px") + ";\n                background-image: url(" + o + ');\n            ">\n            <div style="padding-top: ' + i / t * 100 + '%"></div>\n        </div>\n    ')
    }), O.addFilter("query_string", function (e, t) {
        var i = document.createElement("a");
        return i.href = e, p()(t).length && (i.search = "?" + C.b.craft(C.b.reset(i.search, t))), i.href
    }), O.addFilter("first_n", function (e, t) {
        return e.slice(0, t)
    }), O.addFilter("fill_null", function (e, t) {
        for (var i = e.slice(); i.length < t;) i.push(null);
        return i
    }), O.addFilter("prettify_text", function (e, t) {
        var i = O.getFilter("striptags")(e);
        return O.getFilter("urlize")(i, t)
    }), O.addFilter("paragraphy", P.f), O.addFilter("striptags", P.m), O.addFilter("humanize_number", T.k), O.addFilter("humanize_file_size", T.j), O.addFilter("format_order_uid", P.d), O.addFilter("format_price", T.g), O.addFilter("format_rating", function (e, t) {
        var i = d()({
            numberOnly: !1
        }, t);
        return Object(T.b)(0, 5, Math.round(10 * Number(e)) / 10) + (i.numberOnly ? "" : "/5")
    }), O.addFilter("comma_formatted_number", T.e), O.addFilter("pluralize", P.g), O.addFilter("markdown", function (e) {
        return e
    }), O.addFilter("pretty_slug", function () {
        return (arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "").split("-").map(b.capitalize).join(" ")
    }), O.addFilter("merge", function (e, t) {
        return d()({}, e, t)
    }), O.addFilter("json_data", function (e) {
        return c()(e).replace(/<\//g, "<\\/")
    }), O.addFilter("format_date", function (e) {
        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : "MMM. Do YYYY",
            i = "full" === t ? "YYYY/MM/DD HH:mm" : t;
        return w.a.utc(e).format(i)
    }), O.addFilter("max", function (e) {
        return Math.max.apply(Math, e)
    }), O.addFilter("min", function (e) {
        return Math.min.apply(Math, e)
    }), O.addFilter("time_ago", function (e) {
        return w.a.utc(e).fromNow()
    }), O.addFilter("seconds_to_duration", function (e) {
        return w.a.utc(1e3 * parseFloat(e)).format("mm:ss")
    }), O.addFilter("can_upgrade_to_pro", function (e) {
        return Object(E.c)(e)
    }), O.addFilter("humanize_date", function (e) {
        return w.a.utc(e).format("MMM[.] Do[,] YYYY")
    });
    var N = O.getFilter("trim");
    O.addFilter("trim", function (e) {
        return null === e ? "" : N(e)
    }), O.addFilter("map", function (e, t) {
        return e.map(function (e) {
            return e[t]
        })
    });
    var D = function (e, t) {
        return new Error("\n\n" + e + (t ? " with `" + t + "` className" : "") + " is not a Component. \nThe `component` filter only accepts component elements.\nYou can get a component element by calling `Component#createChildrenComponents(childrenConfigs)`, or `Component#createChildComponent(childName, childConfig)`.\n/!\\ Note that this is different from Component instances.\n")
    };
    O.addFilter("component", function (e, t, i) {
        return _.a.runtime.markSafe(Array.isArray(e) ? r(e, t, i) : n(e, t, i))
    }), O.addFilter("class_names", a), O.addFilter("style", o), O.addFilter("attributes", u), t.default = {
        get: Object(b.curry)(function (e, t) {
            return O.render(e + ".jinja", t)
        }),
        getFromString: Object(b.curry)(function (e, t) {
            return O.renderString(e, t)
        }),
        getFromMacro: function (e, t, i) {
            Array.isArray(e) && (i = t, t = e[1], e = e[0]);
            var n = function (i) {
                return O.renderString(["{%- from source import " + t + " -%}", "{{ " + t + "(" + i.map(function (e, t) {
                    return "parameters[ " + t + " ]"
                }).join(",") + ") }}"].join("\n"), {
                    source: e + ".jinja",
                    parameters: i
                })
            };
            return i ? n(i) : n
        }
    }
}, , function (e, t, i) {
    "use strict";
    var n = i(7),
        r = i.n(n),
        a = i(40),
        o = i.n(a),
        s = i(26),
        u = i.n(s),
        l = i(3),
        c = i.n(l),
        h = i(0),
        d = (i.n(h), i(5)),
        f = i.n(d),
        p = i(11),
        m = i(65),
        g = i(53),
        v = i(91),
        _ = i(25),
        b = i(17),
        S = p.a.extend({
            defaults: {
                likes: {},
                followings: {},
                subscriptions: {},
                reviewUpvotes: {},
                purchases: {}
            },
            endpoint: function () {
                return this.options.me && !this.get("uid") ? "/users/me" : this.isNew() || null !== this.get("uid") ? this.isNew() ? "/users" : "/users/" + this.get("uid") : "/users/@" + this.get("username")
            },
            isAuthenticated: function () {
                return !this.get("isAnonymous")
            },
            isInflated: function () {
                return void 0 !== this.get("account") && u()(this.attributes).length > u()(this.defaults).length + 1
            },
            followUsers: function (e) {
                var t = this;
                return Array.isArray(e) ? (e.forEach(function (e) {
                    return t.addFollowing(e, !0)
                }), S.authenticate(function () {
                    return b.a.followUsers(e)
                })) : f.a.reject("First argument should be an array of user UIDs.")
            },
            isProfileFilled: function () {
                return "avatar-blue" !== this.get("avatars").name && (this.get("biography") || this.get("tagline") || this.get("city") || this.get("country")) && (this.get("website") || this.get("twitterUsername") || this.get("linkedinUsername") || this.get("unityConnectUrl") || this.get("facebookUsername"))
            },
            follow: function (e) {
                return this.addFollowing(e, !0), b.a.followUser(e)
            },
            unfollow: function (e) {
                return this.addFollowing(e, !1), S.authenticate(function () {
                    return b.a.unfollowUser(e)
                })
            },
            addFollowing: function (e, t) {
                var i = {},
                    n = this.get("followingCount") || 0;
                i[e] = t, this.addFollowings(i), this.set("followingCount", Math.max(n + (t ? 1 : -1), 0))
            },
            addFollowings: function (e) {
                this.set("followings", Object(h.extend)({}, this.get("followings"), e))
            },
            doesFollow: function (e) {
                return !!this.get("followings")[e]
            },
            getDoesFollow: function (e) {
                var t = this;
                return this.isAuthenticated() ? b.a.doesCurrentUserFollow(e).then(function (i) {
                    return t.addFollowing(e, i), i
                }) : f.a.resolve(!1)
            },
            getSummary: function () {
                var e = this;
                return b.a.getUserSummary(this.get("uid")).then(function (t) {
                    return e.set(t), t
                })
            },
            canViewPrivateModelsOf: function (e) {
                return !!this.isAuthenticated() && (!0 === this.get("isStaff") || void 0 !== e && this.get("uid") === e)
            },
            canUpgradePlan: function () {
                return !1 === Object(h.includes)(["ent"], this.get("account"))
            },
            canUpgradeToPro: function () {
                return Object(v.c)(this.get("account"))
            },
            addLike: function (e, t) {
                var i = {};
                i[e] = t, this.addLikes(i)
            },
            addLikes: function (e) {
                this.set("likes", Object(h.extend)({}, this.get("likes"), e))
            },
            doesLike: function (e) {
                return this.get("likes")[e] || !1
            },
            getDoesLike: function (e) {
                var t = this;
                return this.isAuthenticated() ? b.a.doesCurrentUserLike(e).then(function (i) {
                    return t.addLike(e, i), i
                }) : f.a.resolve(!1)
            },
            addReviewUpvote: function (e, t) {
                this.addReviewUpvotes(o()({}, e, t))
            },
            addReviewUpvotes: function (e) {
                this.set("reviewUpvotes", Object(h.extend)({}, this.get("reviewUpvotes"), e))
            },
            hasUpvotedReview: function (e) {
                return this.get("reviewUpvotes")[e] || !1
            },
            getHasUpvotedReview: function (e) {
                var t = this;
                return this.isAuthenticated() ? b.a.hasCurrentUserUpvoted(e).then(function (i) {
                    return t.addReviewUpvote(e, i), i
                }) : f.a.resolve(!1)
            },
            getReviewOnModel: function (e) {
                var t = this;
                return b.a.getCurrentUserReview(e).then(function (i) {
                    return u()(i).length ? i : f.a.reject(new _.d("no review found for user " + t.get("uid") + " on model " + e))
                })
            },
            canReview: function (e) {
                return this.isAuthenticated() ? b.a.canReviewModel(e).then(function (e) {
                    return e.canReview
                }).catch(function () {
                    return !1
                }) : f.a.resolve(!1)
            },
            setPurchase: function (e, t) {
                this.set("purchases", r()({}, this.get("purchases"), o()({}, e, t)))
            },
            getHasPurchased: function (e) {
                var t = this;
                return this.isAuthenticated() ? b.a.hasCurrentUserPurchased(e).then(function (i) {
                    return t.setPurchase(e, i), i
                }) : f.a.resolve(!1)
            },
            hasPurchased: function (e) {
                return this.get("purchases")[e] || !1
            },
            fetchPrivateLimits: function () {
                return this.isAuthenticated() ? this.get("privateLimits") ? f.a.resolve(this.get("privateLimits")) : b.a.getCurrentUserPrivateLimits().then(function (e) {
                    return this.set("privateLimits", Object(h.extend)({}, this.get("privateLimits"), e)), f.a.resolve(e)
                }.bind(this)) : f.a.reject("User is not authenticated.")
            },
            hasSubscribed: function (e) {
                return !!this.get("subscriptions")[e]
            },
            getHasSubscribed: function (e) {
                var t = this;
                return this.isAuthenticated() ? b.a.hasCurrentUserSubscribed(e).then(function (i) {
                    return t.updateSubscription(e, i), i
                }) : f.a.resolve(!1)
            },
            updateSubscription: function (e, t) {
                this.updateSubscriptions(o()({}, e, t))
            },
            updateSubscriptions: function (e) {
                this.set("subscriptions", r()({}, this.get("subscriptions"), e))
            },
            updateAvatar: function (e) {
                return b.a.updateUserAvatar(e).catch(function (e) {
                    throw e && e.detail || "Unexpected error, your user settings may not have been changed."
                })
            },
            updateEmailSettings: function (e) {
                return b.a.updateUserEmailSettings(this.get("uid"), e)
            },
            setAllowsRestricted: function (e) {
                return this.isAuthenticated() ? this.save({
                    allowsRestricted: e
                }, {
                    patch: !0
                }) : (g.a.set("sb_allows_age_restricted", e), f.a.resolve())
            },
            doAllowRestricted: function () {
                return this.isAuthenticated() ? this.get("allowsRestricted") : "true" === g.a.get("sb_allows_age_restricted")
            },
            isMe: function () {
                return S.me().get("uid") === this.get("uid")
            },
            canAccessFeature: function (e) {
                return Object(h.includes)(this.get("features").map(h.toUpper), Object(h.toUpper)(e))
            },
            getThumbnails: function () {
                var e = this;
                return b.a.getUserThumbnails(this.get("uid")).then(function (t) {
                    return e.set("thumbnails", t), t
                })
            }
        }, {
            login: function (e, t) {
                var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                    n = i.next;
                return b.a.login({
                    email: e,
                    password: t,
                    next: n
                }).then(function (e) {
                    return S.clear(), e.result
                })
            },
            authenticate: function (e, t) {
                var n = function () {
                        return new f.a(function (e) {
                            i.e(0).then(function () {
                                var t = [i(72)];
                                (function (t) {
                                    e(t.default)
                                }).apply(null, t)
                            }).catch(i.oe)
                        })
                    },
                    r = function () {
                        return n().then(function (i) {
                            var n = this;
                            return new i({
                                next: t || window.location.href
                            }).open().then(function (t) {
                                return n.me({
                                    allowPrefetching: !1
                                }).then(function (t) {
                                    return e(t)
                                }).then(function (e) {
                                    return e || t
                                }).catch(function (e) {
                                    return console.error(e), t
                                })
                            }).then(function (e) {
                                e && e !== window.location.href ? window.location = e : window.location.reload(!0)
                            })
                        }.bind(this))
                    }.bind(this),
                    a = this.me();
                return a.isAuthenticated() ? f.a.resolve(e(a)) : r()
            },
            me: function (e) {
                e = Object(h.extend)({}, e);
                var t = function (e) {
                        return e.isInflated() ? m.a.register("/i/users/" + e.get("uid"), e.toJSON()) : e.isAuthenticated() && (e = this.getByUid(e.get("uid"), {
                            immediate: !0,
                            userOptions: {
                                me: !0
                            }
                        })), this._me.set(e.toJSON()), this._me.set({}), this._me
                    }.bind(this),
                    i = this;
                return !1 !== e.allowPrefetching ? void 0 === this._me ? (this._me = new i(null, {
                    me: !0
                }), this._me.fetch(e), t(this._me)) : (this._me.isInflated() || this._me.fetch(), this._me) : (void 0 === this._me && (this._me = new i(null, {
                    me: !0
                })), f.a.resolve(this._me.fetch(e)).then(t))
            },
            getByName: function (e) {
                var t = this;
                return b.a.getUserByName(e).then(function (e) {
                    return new t(e)
                })
            },
            getProfileUser: function () {
                var e = c()("[data-profile-user]").first().data("profile-user");
                return this.getByUid(e)
            },
            getByAttributes: function (e, t) {
                t = Object(h.extend)({}, t), e = Object(h.extend)({
                    uid: null
                }, e);
                var i = this,
                    n = Object(h.extend)({}, t.userOptions),
                    r = new i(e, n),
                    a = function (e) {
                        return e.set({}), e
                    };
                return t.immediate ? (r.fetch(t), a(r)) : r.fetch(t).then(a)
            },
            getByUsername: function (e, t) {
                return this.getByAttributes({
                    username: e
                }, t)
            },
            getByUid: function (e, t) {
                return this.getByAttributes({
                    uid: e
                }, t)
            },
            clear: function () {
                m.a.invalidate("/i/users/me"), this._me = void 0
            }
        });
    t.a = S
}, , function (e, t, i) {
    "use strict";
    var n = i(26),
        r = i.n(n),
        a = i(3),
        o = i.n(a),
        s = i(0),
        u = (i.n(s), i(23)),
        l = (i(1), i(8)),
        c = i(116),
        h = i(587),
        d = l.a.extend({
            displayName: "Component",
            mixins: [c.a, h.a],
            isComponent: !0,
            setElement: function () {
                return l.a.prototype.setElement.apply(this, arguments), this.isRenderedManually() && (this.$el.attr("data-component") || this.$el.attr("data-component", ""), this.$el.attr("id") || this.$el.attr("id", this.cid)), this
            },
            $: function (e) {
                var t = this.$el;
                return this.$el.find(e).filter(function () {
                    return o()(this).parent().closest("[data-component]").is(t)
                })
            },
            delegate: function (e, t, i) {
                var n = this.$el;
                return this.$el.on(e + ".delegateEvents" + this.cid, t, function (e) {
                    o()(e.currentTarget).closest("[data-component]").is(n) && i.apply(this, arguments)
                }), this
            },
            _removeElement: function () {
                this.isRenderedManually() && this.$el.html("")
            },
            isRenderedManually: function () {
                return !this.options._isChildOfAComponent
            },
            getItemKey: function (e, t, i) {
                return e.options && e.options.key || t
            },
            normalizeChildConfig: function (e, t) {
                var i = t || {};
                return Object(s.extend)({
                    viewClass: d
                }, i, {
                    options: Object(s.extend)({}, i.options, {
                        _isChildOfAComponent: !0,
                        el: void 0
                    })
                })
            },
            _getLazyComponent: function (e, t) {
                return function () {
                    var i = this,
                        n = this.updateChildConfig(e, this.normalizeChildConfig(e, t)).refreshChild(e).getChild(e);
                    return {
                        isComponentElement: !0,
                        template: function () {
                            var t = i.setChildOptions(e).getChild(e);
                            return t.isMounted ? t.shouldUpdate ? t._template : "" : (t._template = t.template(), t._template)
                        },
                        cid: n.cid,
                        displayName: n.displayName
                    }
                }.bind(this)
            },
            createChildComponent: function (e, t) {
                var i = this;
                return Array.isArray(t) ? t.map(function (n, r) {
                    var a = i.getItemKey(n, r, t);
                    return i._getLazyComponent(e + a, n)
                }) : this._getLazyComponent(e, t)
            },
            createChildrenComponents: function (e) {
                return Object(s.mapValues)(e, function (e, t) {
                    return this.createChildComponent(t, e)
                }.bind(this))
            },
            beforeRender: function () {
                l.a.prototype.beforeRender.apply(this, arguments), r()(this.children).map(this.getChild.bind(this)).filter(Object(u.f)("isComponent")).forEach(function (e) {
                    e.beforeRender()
                })
            },
            removeUnmountedChildren: function (e) {
                r()(this.children).filter(function (t) {
                    return this.getChild(t).isComponent && !e.match('id="' + this.getChild(t).cid + '"')
                }.bind(this)).forEach(this.removeChild.bind(this))
            },
            onViewUpdate: function (e, t, i, n, r, a) {
                e && (a || this.isRenderedManually() ? (this.render(), this.viewDidUpdate(t, i)) : (this._template = this.template(), this.removeUnmountedChildren(this._template), this._executeAfterRender = this.viewDidUpdate.bind(this, t, i)))
            },
            render: function () {
                this._template = this.template(), this.removeUnmountedChildren(this._template), this.renderDiff(this._template)
            },
            afterRender: function () {
                var e = this;
                l.a.prototype.afterRender.apply(this, arguments), r()(this.children).map(this.getChild.bind(this)).filter(Object(u.f)("isComponent")).map(function (t) {
                    var i = e.el.querySelector("#" + t.cid);
                    return i && t.el !== i && t.setElement(i), t
                }).forEach(function (e) {
                    e.afterRender()
                }), this._executeAfterRender && (this._executeAfterRender(), this._executeAfterRender = null)
            }
        });
    t.a = d
}, , function (e, t, i) {
    "use strict";
    var n = i(49),
        r = i.n(n),
        a = i(7),
        o = i.n(a),
        s = i(26),
        u = i.n(s),
        l = i(3),
        c = i.n(l),
        h = i(0),
        d = (i.n(h), i(23)),
        f = i(30),
        p = i(372),
        m = i(373),
        g = i(224),
        v = i(116),
        _ = i(417);
    t.a = p.a.extend({
        mixins: [_.a, g.b, m.a],
        defaultOptions: function () {
            return {}
        },
        isInitialized: !1,
        isMounted: !1,
        constructor: function () {
            this.options = Object(h.extend)({}, this.defaultOptions(), Object(h.pickBy)(arguments[0] || {}, function (e) {
                return void 0 !== e
            })), p.a.apply(this, arguments)
        },
        initialize: function () {
            p.a.prototype.initialize.apply(this, arguments), this.isInitialized = !0
        },
        setElement: function (e) {
            var t = e[0] || e;
            return this.isInitialized && this.el === t || p.a.prototype.setElement.apply(this, arguments), this.el && (this.el[v.b] = this), this
        },
        _removeElement: function () {
            this.$el.html("")
        },
        template: function () {
            return ""
        },
        update: function (e, t, i, n) {
            this.shouldUpdate = n || this.shouldViewUpdate(e, t);
            var r = this.isMounted && this.shouldUpdate;
            r && this.viewWillUpdate(e, t);
            var a = this.options,
                o = this.state;
            return this.options = e, this.state = t, this.onViewUpdate(r, a, o, e, t, i)
        },
        onViewUpdate: function (e, t, i) {
            e && (this.render(), this.viewDidUpdate(t, i))
        },
        viewWillReceiveOptions: function (e) {
            var t = this,
                i = this.getDerivedStateFromOptions(e, this.state);
            i && u()(i).some(function (e) {
                return i[e] !== t.state[e]
            }) && (this.state = o()({}, this.state, i))
        },
        getDerivedStateFromOptions: function () {},
        shouldViewUpdate: function () {
            return !0
        },
        viewWillUpdate: function () {},
        viewDidUpdate: function () {},
        forceUpdate: function () {
            this.setState({}, !0)
        },
        afterRender: function () {
            p.a.prototype.afterRender.apply(this, arguments), this.isMounted || (this.isMounted = !0, this.viewDidMount())
        },
        beforeRemove: function () {
            p.a.prototype.beforeRemove.apply(this, arguments), this.isMounted && (this.viewWillUnmount(), this.isMounted = !1, this.el && delete this.el[v.b])
        },
        automagicErrors: function (e) {
            if (this.$(".form-global-error").removeAttr("data-error"), this.$(".form-global-error").hide(), this.$("[data-error-for]").removeAttr("data-error"), null !== e)
                if ("object" === (void 0 === e ? "undefined" : r()(e))) {
                    var t = this.$("[data-error-for]");
                    u()(e).forEach(function (i) {
                        t.filter(function () {
                            return c()(this).attr("data-error-for").split(",").indexOf(i) > -1
                        }).attr("data-error", e[i].join("\n"))
                    }.bind(this))
                } else this.$(".form-global-error .message").text(e), this.$(".form-global-error").attr("data-error", e), this.$(".form-global-error").fadeIn()
        }
    }, {
        isView: !0,
        extend: function (e, t) {
            var i = Object(h.extend)({}, e, {
                defaultOptions: Object(d.e)(Object(f.g)(this.prototype.defaultOptions || {}), Object(f.g)(e.defaultOptions || {})),
                events: Object(h.extend)({}, this.prototype.events || {}, e.events || {}),
                children: Object(h.extend)({}, this.prototype.children || {}, e.children || {}),
                optionTypes: Object(h.extend)({}, this.prototype.optionTypes || {}, e.optionTypes || {})
            });
            return p.a.extend.call(this, i, t)
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(1068),
        r = i(296),
        a = i(364),
        o = i(20);
    Object(r.a)(), a.a.EFFECTIVE_EPS = Object(o.a)().morphEpsilon, t.a = n.a
}, function (e, t, i) {
    "use strict";
    i.d(t, "b", function () {
        return h
    }), i.d(t, "c", function () {
        return c
    }), i.d(t, "d", function () {
        return d
    }), i.d(t, "e", function () {
        return s
    }), i.d(t, "f", function () {
        return u
    }), i.d(t, "g", function () {
        return l
    });
    var n = i(446),
        r = i(1070),
        a = i.n(r),
        o = i(1076);
    i.d(t, "a", function () {
        return a.a
    }), a.a.glMatrix.setMatrixArrayType(o.a.ArrayType), a.a.glMatrix.EPSILON = 1e-9;
    var s = a.a.vec2,
        u = a.a.vec3,
        l = a.a.vec4,
        c = a.a.mat4,
        h = a.a.mat3,
        d = a.a.quat;
    u.create32 = function () {
        return new Float32Array(3)
    }, u.create64 = function () {
        return new Float64Array(3)
    }, u.fromValues32 = function (e, t, i) {
        var n = new Float32Array(3);
        return n[0] = e, n[1] = t, n[2] = i, n
    }, u.fromValues64 = function (e, t, i) {
        var n = new Float64Array(3);
        return n[0] = e, n[1] = t, n[2] = i, n
    }, u.init = function (e) {
        return u.set(e, 0, 0, 0)
    }, u.transformMat4Rotate = function (e, t, i) {
        var n = t[0],
            r = t[1],
            a = t[2];
        return e[0] = i[0] * n + i[1] * r + i[2] * a, e[1] = i[4] * n + i[5] * r + i[6] * a, e[2] = i[8] * n + i[9] * r + i[10] * a, e
    }, u.valid = function (e) {
        return !n.a.isNaN(e[0]) && (!n.a.isNaN(e[1]) && !n.a.isNaN(e[2]))
    }, u.neg = u.negate, u.ZERO = u.create(), u.ONE = u.fromValues(1, 1, 1), u.INFINITY = u.fromValues(1 / 0, 1 / 0, 1 / 0), u.NEGATIVE_INFINITY = u.fromValues(-1 / 0, -1 / 0, -1 / 0), s.create32 = function () {
        return new Float32Array(2)
    }, s.create64 = function () {
        return new Float64Array(2)
    }, s.fromValues32 = function (e, t) {
        var i = new Float32Array(2);
        return i[0] = e, i[1] = t, i
    }, s.fromValues64 = function (e, t) {
        var i = new Float64Array(2);
        return i[0] = e, i[1] = t, i
    }, s.init = function (e) {
        return s.set(e, 0, 0)
    }, s.valid = function (e) {
        return !n.a.isNaN(e[0]) && !n.a.isNaN(e[1])
    }, s.ZERO = s.create(), s.ONE = s.fromValues(1, 1), s.INFINITY = s.fromValues(1 / 0, 1 / 0), s.NEGATIVE_INFINITY = s.fromValues(-1 / 0, -1 / 0), l.create32 = function () {
        return new Float32Array(4)
    }, l.create64 = function () {
        return new Float64Array(4)
    }, l.fromValues32 = function (e, t, i, n) {
        var r = new Float32Array(4);
        return r[0] = e, r[1] = t, r[2] = i, r[3] = n, r
    }, l.fromValues64 = function (e, t, i, n) {
        var r = new Float64Array(4);
        return r[0] = e, r[1] = t, r[2] = i, r[3] = n, r
    }, l.init = function (e) {
        return l.set(e, 0, 0, 0, 0)
    }, l.valid = function (e) {
        return !n.a.isNaN(e[0]) && (!n.a.isNaN(e[1]) && (!n.a.isNaN(e[2]) && !n.a.isNaN(e[3])))
    }, l.neg = l.negate, l.ZERO = l.create(), l.ONE = l.fromValues(1, 1, 1, 1), l.INFINITY = l.fromValues(1 / 0, 1 / 0, 1 / 0, 1 / 0), l.NEGATIVE_INFINITY = l.fromValues(-1 / 0, -1 / 0, -1 / 0, -1 / 0), d.IDENTITY = d.create(), d.zeroRotation = function (e) {
        return 0 === e[0] && 0 === e[1] && 0 === e[2] && 1 === e[3]
    }, d.create32 = function () {
        var e = new Float32Array(4);
        return e[3] = 1, e
    }, d.create64 = function () {
        var e = new Float64Array(4);
        return e[3] = 1, e
    }, d.fromValues32 = l.fromValues32, d.fromValues64 = l.fromValues64, d.init = d.identity, d.nlerp = function (e, t, i, n) {
        var r, a, o, s, u = t[0],
            l = t[1],
            c = t[2],
            h = t[3],
            d = i[0],
            f = i[1],
            p = i[2],
            m = i[3],
            g = u * d + l * f + c * p + h * m,
            v = 1 - n;
        g < 0 ? (r = u * v - d * n, a = l * v - f * n, o = c * v - p * n, s = h * v - m * n) : (r = u * v + d * n, a = l * v + f * n, o = c * v + p * n, s = h * v + m * n);
        var _ = 1 / Math.sqrt(r * r + a * a + o * o + s * s);
        return e[0] = r * _, e[1] = a * _, e[2] = o * _, e[3] = s * _, e
    }, h.IDENTITY = h.create(), h.create32 = function () {
        var e = new Float32Array(9);
        return e[0] = e[4] = e[8] = 1, e
    }, h.create64 = function () {
        var e = new Float64Array(9);
        return e[0] = e[4] = e[8] = 1, e
    }, c.IDENTITY = c.create(), c.create32 = function () {
        var e = new Float32Array(16);
        return e[0] = e[5] = e[10] = e[15] = 1, e
    }, c.create64 = function () {
        var e = new Float64Array(16);
        return e[0] = e[5] = e[10] = e[15] = 1, e
    }, c.setTranslation = function (e, t) {
        return e[12] = t[0], e[13] = t[1], e[14] = t[2], e
    }, c.getFrustum = function (e, t) {
        var i, n, r = 0,
            a = 0,
            o = 0,
            s = 0;
        if (0 !== t[3] || 0 !== t[7] || -1 !== t[11] || 0 !== t[15]) return !1;
        var u = t[14] / (t[10] - 1),
            l = t[14] / (1 + t[10]);
        return a = u * (t[8] - 1) / t[0], r = u * (1 + t[8]) / t[0], o = u * (1 + t[9]) / t[5], s = u * (t[9] - 1) / t[5], i = u, n = l, e.left = a, e.right = r, e.top = o, e.bottom = s, e.zNear = i, e.zFar = n, !0
    }, c.getPerspective = function () {
        var e = {
            right: 0,
            left: 0,
            top: 0,
            bottom: 0,
            zNear: 0,
            zFar: 0
        };
        return function (t, i) {
            return c.getFrustum(e, i) && (t.fovy = 180 / Math.PI * (Math.atan(e.top / e.zNear) - Math.atan(e.bottom / e.zNear)), t.aspectRatio = (e.right - e.left) / (e.top - e.bottom)), t.zNear = e.zNear, t.zFar = e.zFar, t
        }
    }(), c.getLookAt = function () {
        var e = c.create(),
            t = u.create(),
            i = u.fromValues(0, 1, 0),
            n = u.fromValues(0, 0, -1);
        return function (r, a, o, s, l) {
            var h = void 0 !== l ? l : 1;
            c.invert(e, s), c.getTranslation(r, e), u.transformMat4Rotate(o, i, s), u.transformMat4Rotate(a, n, s), u.normalize(a, a), u.add(a, u.scale(t, a, h), r)
        }
    }(), c.getFrustumPlanes = function () {
        var e = c.create();
        return function (t, i, n, r) {
            c.mul(e, i, n);
            var a = !!r,
                o = t[0];
            o[0] = e[3] - e[0], o[1] = e[7] - e[4], o[2] = e[11] - e[8], o[3] = e[15] - e[12];
            var s = t[1];
            s[0] = e[3] + e[0], s[1] = e[7] + e[4], s[2] = e[11] + e[8], s[3] = e[15] + e[12];
            var u = t[2];
            u[0] = e[3] + e[1], u[1] = e[7] + e[5], u[2] = e[11] + e[9], u[3] = e[15] + e[13];
            var l = t[3];
            l[0] = e[3] - e[1], l[1] = e[7] - e[5], l[2] = e[11] - e[9], l[3] = e[15] - e[13];
            var h = 4;
            if (a) {
                h = 6;
                var d = t[4];
                d[0] = e[3] - e[2], d[1] = e[7] - e[6], d[2] = e[11] - e[10], d[3] = e[15] - e[14];
                var f = t[5];
                f[0] = e[3] + e[2], f[1] = e[7] + e[6], f[2] = e[11] + e[10], f[3] = e[15] + e[14]
            }
            for (var p = 0; p < h; p++) {
                var m = t[p],
                    g = 1 / Math.sqrt(m[0] * m[0] + m[1] * m[1] + m[2] * m[2]);
                m[0] *= g, m[1] *= g, m[2] *= g, m[3] *= g
            }
        }
    }(), c.infiniteFrustum = function (e, t, i, n, r, a) {
        var o = 2 * a / (i - t),
            s = 2 * a / (r - n),
            u = (i + t) / (i - t),
            l = (r + n) / (r - n);
        return e[0] = o, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 0, e[5] = s, e[6] = 0, e[7] = 0, e[8] = u, e[9] = l, e[10] = -1, e[11] = -1, e[12] = 0, e[13] = 0, e[14] = -2 * a, e[15] = 0, e
    }, c.lookAtDirection = function () {
        var e = u.create(),
            t = u.create(),
            i = u.create();
        return function (n, r, a, o) {
            var s = a;
            return u.cross(e, s, o), u.normalize(e, e), u.cross(t, e, s), u.normalize(t, t), n[0] = e[0], n[1] = t[0], n[2] = -s[0], n[3] = 0, n[4] = e[1], n[5] = t[1], n[6] = -s[1], n[7] = 0, n[8] = e[2], n[9] = t[2], n[10] = -s[2], n[11] = 0, n[12] = 0, n[13] = 0, n[14] = 0, n[15] = 1, c.translate(n, n, u.neg(i, r))
        }
    }(), c.getScale = function () {
        var e = u.create(),
            t = u.create(),
            i = u.create();
        return function (n, r) {
            return e[0] = r[0], e[1] = r[4], e[2] = r[8], t[0] = r[1], t[1] = r[5], t[2] = r[9], i[0] = r[2], i[1] = r[6], i[2] = r[10], n[0] = u.length(e), n[1] = u.length(t), n[2] = u.length(i), n
        }
    }(), c.getSqrScale = function () {
        var e = u.create(),
            t = u.create(),
            i = u.create();
        return function (n, r) {
            return e[0] = r[0], e[1] = r[4], e[2] = r[8], t[0] = r[1], t[1] = r[5], t[2] = r[9], i[0] = r[2], i[1] = r[6], i[2] = r[10], n[0] = u.sqrLen(e), n[1] = u.sqrLen(t), n[2] = u.sqrLen(i), n
        }
    }();
    var f = c.rotate;
    c.rotate = function (e, t, i, n) {
        return f(e, t, i, n) || c.identity(e)
    };
    var p = c.fromRotation;
    c.fromRotation = function (e, t, i) {
        return p(e, t, i) || c.identity(e)
    }
}, function (e, t, i) {
    "use strict";
    var n = i(49),
        r = i.n(n),
        a = i(0),
        o = (i.n(a), i(24)),
        s = i.n(o),
        u = i(158),
        l = i(228),
        c = i(22),
        h = i(1),
        d = Object(u.a)(["initialize"]),
        f = d(s.a.Model);
    t.a = f.extend({
        optionTypes: {},
        idAttribute: "uid",
        backend: l.a,
        constructor: function () {
            this.options = arguments[1] || {}, f.apply(this, arguments)
        },
        initialize: function () {
            f.prototype.initialize.apply(this, arguments), this.checkModelTypes()
        },
        set: function () {
            return f.prototype.set.apply(this, arguments)
        },
        sync: function () {
            return f.prototype.sync.apply(this, arguments).then(function () {
                return this
            }.bind(this))
        },
        domain: function () {
            return Object(a.result)(this.backend, "domain")
        },
        queryParams: function () {
            return {}
        },
        url: function () {
            var e = Object(a.result)(this, "domain"),
                t = Object(a.result)(this, "endpoint"),
                i = e + t,
                n = i + c.b.craft("?", this.queryParams());
            return n = n.replace(/(?!^)\/{2,}/g, "/")
        },
        isNew: function () {
            var e = this.get(this.idAttribute);
            return void 0 === e || !(!e || "tmp_" !== e.toString().substr(0, 4))
        },
        checkModelTypes: function () {
            Object(h.a)(this.optionTypes, this.toJSON(), "value", this.displayName || "Model")
        }
    }, {
        extend: function (e, t) {
            var i = Object(a.extend)({}, e, {
                optionTypes: Object(a.extend)({}, this.prototype.optionTypes || {}, e.optionTypes || {})
            });
            return f.extend.call(this, i, t)
        },
        get: function (e, t) {
            t = Object(a.extend)({}, t), "object" !== (void 0 === e ? "undefined" : r()(e)) && (e = {
                uid: e
            });
            var i = this,
                n = new i(e),
                o = function (e) {
                    return e.set({}), e
                };
            return t.immediate ? (n.fetch(t), o(n)) : n.fetch(t).then(o)
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(5),
        r = i.n(n),
        a = i(315),
        o = i(36),
        s = {};
    s.extend = function () {
        var e, t, i, n, r = window.Object.prototype.toString,
            a = window.Object.prototype.hasOwnProperty,
            o = s.isArray,
            u = function (e) {
                if (!e || "[object Object]" !== r.call(e) || e.nodeType || e.setInterval) return !1;
                if (e.constructor && !a.call(e, "constructor") && !a.call(e.constructor.prototype, "isPrototypeOf")) return !1;
                var t;
                for (t in e);
                return void 0 === t || a.call(e, t)
            },
            l = arguments[0] || {},
            c = 1,
            h = arguments.length,
            d = !1;
        for ("boolean" == typeof l && (d = l, l = arguments[1] || {}, c = 2), "object" == typeof l || function (e) {
                return "[object Function]" === r.call(e)
            }(l) || (l = {}), h === c && (l = this, --c); c < h; c++)
            if (null !== (e = arguments[c]))
                for (t in e)
                    if (i = l[t], n = e[t], l !== n)
                        if (d && n && (u(n) || o(n))) {
                            var f = i && (u(i) || o(i)) ? i : o(n) ? [] : {};
                            l[t] = s.extend(d, f, n)
                        } else void 0 !== n && (l[t] = n);
        return l
    }, s.objectInherit = function (e) {
        function t() {}
        t.prototype = e;
        for (var i = new t, n = 1; n < arguments.length; n++) s.objectMix(i, arguments[n], !1);
        return i
    }, s.objectMix = function (e, t, i) {
        for (var n in t) i && e[n] || (e[n] = t[n]);
        return e
    }, s.objectType = {}, s.objectType.type = 0, s.arrayDense = function (e, t, i) {
        var n = t.length;
        if (e >= n)
            for (var r = n; r <= e; r++) t.push(i ? i() : null)
    }, s.objectLibraryClass = function (e, t, i) {
        e.className = function () {
            return i
        }, e.libraryName = function () {
            return t
        };
        var n = t + "::" + i;
        return e.libraryClassName = function () {
            return n
        }, e
    }, s.setTypeID = function (e) {
        var t = e.prototype.libraryClassName(),
            i = s.generateId(s.objectType, t),
            n = function () {
                return i
            };
        e.typeID = e.prototype.typeID = i, e.getTypeID = e.prototype.getTypeID = n
    }, s.createPrototypeObject = function (e, t, i, n) {
        t.hasOwnProperty("getTypeID") && (t = s.objectInherit(t, {})), e.prototype = t, t.constructor = e, i && n && (s.objectLibraryClass(t, i, n), s.setTypeID(e))
    }, s.generateId = function (e, t) {
        if (void 0 !== e[t]) return o.a.error(t + " is already defined, change class name or library name"), -1;
        var i = e.type;
        return e[i] = t, e[t] = i, e.type += 1, i
    }, s.objectNodeType = {}, s.objectNodeType.type = 0, s.setNodeTypeID = function (e) {
        var t = e.prototype.libraryClassName(),
            i = s.generateId(s.objectNodeType, t),
            n = function () {
                return i
            };
        e.nodeTypeID = e.prototype.nodeTypeID = i, e.getNodeTypeID = e.prototype.getNodeTypeID = n
    }, s.createPrototypeNode = function (e, t, n, r) {
        var a = i(844).default,
            o = t.nodeTypeID;
        if (s.createPrototypeObject(e, t, n, r), n && r) {
            s.setNodeTypeID(e);
            var u = e.nodeTypeID;
            s.arrayDense(u, a.applyFunctionArray), a.registerApplyFunction(u, a.getApplyFunction(o))
        }
    };
    var u = 0,
        l = 0,
        c = {},
        h = {},
        d = 0,
        f = {};
    s.getStateAttributeTypeNameToTypeId = function () {
        return f
    }, s.createPrototypeStateAttribute = function (e, t, i, n) {
        s.createPrototypeObject(e, t, i, n);
        var r = s.getOrCreateStateAttributeTypeId(e);
        e.prototype.attributeTypeId = r
    }, s.getMaxStateAttributeTypeID = function () {
        return d
    }, s.getOrCreateStateAttributeTypeId = function (e) {
        var t = e.prototype.getType();
        if (f[t]) return f[t];
        var i = d++;
        return f[t] = i, i
    }, s.getOrCreateStateAttributeTypeMemberIndex = function (e) {
        if (void 0 !== e._attributeTypeIndex) return e._attributeTypeIndex;
        var t = e.getTypeMember();
        return e._attributeTypeIndex = s.getOrCreateStateAttributeTypeMemberIndexFromName(t), e._attributeTypeIndex
    }, s.getOrCreateStateAttributeTypeMemberIndexFromName = function (e) {
        var t = c[e];
        return void 0 !== t ? t : (t = u++, c[e] = t, t)
    }, s.getOrCreateTextureStateAttributeTypeMemberIndex = function (e) {
        if (void 0 !== e._attributeTypeIndex) return e._attributeTypeIndex;
        var t = e.getTypeMember();
        return e._attributeTypeIndex = s.getOrCreateTextureStateAttributeTypeMemberIndexFromName(t), e._attributeTypeIndex
    }, s.getOrCreateTextureStateAttributeTypeMemberIndexFromName = function (e) {
        var t = h[e];
        return void 0 !== t ? t : (t = l++, h[e] = t, t)
    }, s.getIdFromTypeMember = function (e) {
        return c[e]
    }, s.getTextureIdFromTypeMember = function (e) {
        return h[e]
    }, s.Int8Array = window.Int8Array, s.Uint8Array = window.Uint8Array, s.Uint8ClampedArray = window.Uint8ClampedArray, s.Int16Array = window.Int16Array, s.Uint16Array = window.Uint16Array, s.Int32Array = window.Int32Array, s.Uint32Array = window.Uint32Array, s.Float32Array = window.Float32Array, s.Float64Array = window.Float64Array;
    var p = {},
        m = {};
    s.logTime = (o.a.console.time || function (e) {
        p[e] = a.a.instance().tick()
    }).bind(o.a.console), s.logTimeEnd = (o.a.console.timeEnd || function (e) {
        if (void 0 !== p[e]) {
            var t = a.a.instance().deltaM(p[e], a.a.instance().tick());
            o.a.log(e + ": " + t + "ms"), p[e] = void 0
        }
    }).bind(o.a.console), s.time = function (e, t) {
        var i = t;
        void 0 === i && (i = o.a.NOTICE), i > o.a.getNotifyLevel() || (m[e] = 1, s.logTime(e))
    }, s.timeEnd = function (e) {
        void 0 !== m[e] && s.logTimeEnd(e)
    }, s.profile = (o.a.console.profile || function () {}).bind(o.a.console), s.profileEnd = (o.a.console.profileEnd || function () {}).bind(o.a.console), s.arrayUniq = function (e) {
        for (var t = e.length, i = {}, n = [], r = 0, a = 0; a < t; a++) {
            var o = e[a];
            1 !== i[o] && (i[o] = 1, n[r++] = o)
        }
        return n
    }, s.rejectObject = function (e, t) {
        return t && (e = "Invalid json " + e + " " + Object.keys(t)), o.a.warn(e), r.a.reject(e)
    }, s.setStateAttributeConfig = function (e, t) {
        e.stateAttributeConfig = t, t.attribute.forEach(s.getOrCreateStateAttributeTypeMemberIndexFromName), t.textureAttribute.forEach(s.getOrCreateTextureStateAttributeTypeMemberIndexFromName), e.validAttributeTypeMember = t.attribute, e.validTextureAttributeTypeMember = t.textureAttribute
    }, t.a = s
}, function (e, t, i) {
    "use strict";

    function n(e) {
        return new u.a(function (t) {
            window.ga.apply(window, ["send"].concat(e, {
                hitCallback: t
            }))
        })
    }

    function r(e) {
        return d || (d = void 0 !== window.ga) ? n(e).timeout(1e3).catch(h.d) : (console.info("Tracking event skipped : " + o()(e)), u.a.resolve())
    }
    var a = i(80),
        o = i.n(a),
        s = i(5),
        u = i.n(s),
        l = i(22),
        c = i(53),
        h = i(30),
        d = !1;
    t.a = {
        wrapLink: function (e, t) {
            var i = e.currentTarget,
                n = i.target,
                r = i.href;
            "_blank" === n || e.metaKey || e.ctrlKey || (e.preventDefault(), t.timeout(800).catch(h.d).then(function () {
                window.location.href = r
            }))
        },
        saveCurrentReferrer: function () {
            var e = document.referrer,
                t = document.location.href,
                i = l.b.string("utm_source"),
                n = c.a.get("utm_source"),
                r = new Date;
            return r.setSeconds(240), -1 === t.indexOf(e) && i && (e = i), -1 === t.indexOf(e) && n && (e = n), c.a.set("skfb_referrer_override", e, {
                expires: r
            }), e
        },
        setSegment: function (e) {
            void 0 !== window.ga && window.ga("set", {
                dimension5: e ? e.get("name") : "None",
                dimension6: e ? e.get("kind") : "None"
            })
        },
        pageView: function (e) {
            return void 0 === e && (e = window.location.pathname + window.location.search), r(["pageview", e])
        },
        userRegistered: function (e) {
            return r(["event", "user", "registered", e])
        },
        userUnregistrationSurveyNotCompleted: function (e) {
            return r(["event", "user", "unregistrationSurveyNotCompleted", e])
        },
        userUnregistrationSurveyCompleted: function (e, t) {
            return r(["event", "user", "unregistrationSurveyCompleted", e, t])
        },
        userUpgraded: function (e) {
            return r(["event", "user", "upgraded", e])
        },
        userUpgradeCanceled: function (e) {
            return r(["event", "user", "upgradeCanceled", e])
        },
        userSettingsAvatarUpdated: function (e) {
            return r(["event", "userSettings", "avatarUpdated", e])
        },
        userSettingsNotificationsUpdated: function (e) {
            return r(["event", "userSettings", "notificationsUpdated", e])
        },
        userSettingsPasswordUpdated: function (e) {
            return r(["event", "userSettings", "passwordUpdated", e])
        },
        userSettingsProfileUpdated: function (e) {
            return r(["event", "userSettings", "profileUpdated", e])
        },
        userSettingsAppConnected: function (e) {
            return r(["event", "userSettings", "appConnected", e])
        },
        userSettingsAppDisconnected: function (e) {
            return r(["event", "userSettings", "appDisconnected", e])
        },
        userSummaryFollowButtonClicked: function (e, t) {
            return r(["event", "userSummary", "followButtonClicked", e, t ? 1 : 0])
        },
        userProfileFollowButtonClicked: function (e, t) {
            return r(["event", "userProfile", "followButtonClicked", e, t ? 1 : 0])
        },
        userProfileContactButtonClicked: function (e) {
            return r(["event", "userProfile", "contactButtonClicked", e])
        },
        userProfileWebsiteLinkClicked: function (e) {
            return r(["event", "userProfile", "websiteLinkClicked", e])
        },
        userProfileSocialLinkClicked: function (e, t) {
            return r(["event", "userProfile", "socialLinkClicked", t])
        },
        followSuggestionsSuggestFollowButtonClicked: function (e, t) {
            return r(["event", "followSuggestionsPopupSuggest", "followButtonClicked", e, t ? 1 : 0])
        },
        followSuggestionsSearchFollowButtonClicked: function (e, t) {
            return r(["event", "followSuggestionsPopupSearch", "followButtonClicked", e, t ? 1 : 0])
        },
        followSuggestionsSuggestFollowAllButtonClicked: function (e) {
            return r(["event", "followSuggestionsPopupSuggest", "followAllButtonClicked", e])
        },
        followSuggestionsSearchFollowAllButtonClicked: function (e) {
            return r(["event", "followSuggestionsPopupSearch", "followAllButtonClicked", e])
        },
        modelPageFollowButtonClicked: function (e, t) {
            return r(["event", "modelPage", "followButtonClicked", e, t ? 1 : 0])
        },
        modelPageSettingsButtonClicked: function (e) {
            return r(["event", "modelPage", "settingsButtonClicked", e])
        },
        modelPage3dSettingsButtonClicked: function (e) {
            return r(["event", "modelPage", "3dSettingsButtonClicked", e])
        },
        modelPageAnnotationsButtonClicked: function (e) {
            return r(["event", "modelPage", "AnnotationsButtonClicked", e])
        },
        modelPageAddToCollectionButtonClicked: function (e) {
            return r(["event", "modelPage", "addToCollectionButtonClicked", e])
        },
        modelPageCreateCollectionButtonClicked: function (e) {
            return r(["event", "modelPage", "createCollectionButtonClicked", e])
        },
        modelPageReuploadButtonClicked: function (e) {
            return r(["event", "modelPage", "reuploadButtonClicked", e])
        },
        modelPageDeleteButtonClicked: function (e) {
            return r(["event", "modelPage", "deleteButtonClicked", e])
        },
        modelPageEmbedButtonClicked: function (e) {
            return r(["event", "modelPage", "embedButtonClicked", e])
        },
        modelPageShareButtonClicked: function (e) {
            return r(["event", "modelPage", "shareButtonClicked", e])
        },
        modelPageFavoriteButtonClicked: function (e, t) {
            return r(["event", "modelPage", "favoriteButtonClicked", e, t ? 1 : 0])
        },
        modelPageDownloadButtonClicked: function (e) {
            return r(["event", "modelPage", "downloadButtonClicked", e])
        },
        modelPageNewCommentPosted: function (e, t) {
            return r(["event", "modelPage", "newCommentPosted", e, t ? 1 : 0])
        },
        modelPageCommentDeleted: function (e, t) {
            return r(["event", "modelPage", "commentDeleted", e, t ? 1 : 0])
        },
        modelPageExporterLinkClicked: function (e) {
            return r(["event", "modelPage", "exporterLinkClicked", e])
        },
        modelPageModelInformationClicked: function () {
            return r(["event", "modelPage", "modelInformationClicked"])
        },
        modelRipperBlocked: function (e, t) {
            return r(["event", "modelRipper", e + "Blocked", t])
        },
        modelCardSettingsButtonClicked: function (e) {
            return r(["event", "modelCard", "settingsButtonClicked", e])
        },
        modelCardReuploadButtonClicked: function (e) {
            return r(["event", "modelCard", "reuploadButtonClicked", e])
        },
        modelCardDeleteButtonClicked: function (e) {
            return r(["event", "modelCard", "deleteButtonClicked", e])
        },
        modelCard3dSettingsButtonClicked: function (e) {
            return r(["event", "modelCard", "3dSettingsButtonClicked", e])
        },
        modelCardAnnotationsButtonClicked: function (e) {
            return r(["event", "modelCard", "AnnotationsButtonClicked", e])
        },
        modelCardAddToCollectionButtonClicked: function (e) {
            return r(["event", "modelCard", "addToCollectionButtonClicked", e])
        },
        modelCardPreviewButtonClicked: function (e) {
            return r(["event", "modelCard", "previewButtonClicked", e])
        },
        modelCardFavoriteButtonClicked: function (e, t) {
            return r(["event", "modelCard", "favoriteButtonClicked", e, t ? 1 : 0])
        },
        modelCardCommentsButtonClicked: function (e, t) {
            return r(["event", "modelCard", "commentsButtonClicked", e, t])
        },
        modelListCardFavoriteButtonClicked: function (e, t) {
            return r(["event", "modelListCard", "favoriteButtonClicked", e, t ? 1 : 0])
        },
        modelListCardCommentsButtonClicked: function (e, t) {
            return r(["event", "modelListCard", "commentsButtonClicked", e, t])
        },
        modelPreviewClosePopupButtonClicked: function (e) {
            return r(["event", "modelPreview", "closePopupButtonClicked", e])
        },
        modelPreviewViewModelButtonClicked: function (e) {
            return r(["event", "modelPreview", "viewModelButtonClicked", e])
        },
        modelPreviewShareButtonClicked: function (e) {
            return r(["event", "modelPreview", "shareButtonClicked", e, status ? 1 : 0])
        },
        modelPreviewFavoriteButtonClicked: function (e, t) {
            return r(["event", "modelPreview", "favoriteButtonClicked", e, t ? 1 : 0])
        },
        modelPreviewCommentsButtonClicked: function (e, t) {
            return r(["event", "modelPreview", "commentsButtonClicked", e, t])
        },
        modelPreviewDownloadButtonClicked: function (e) {
            return r(["event", "modelPreview", "downloadButtonClicked", e])
        },
        modelPreviewCollectionButtonClicked: function (e) {
            return r(["event", "modelPreview", "collectionButtonClicked", e])
        },
        modelSettingsDownloadButtonClicked: function (e, t) {
            return r(["event", "modelSettings", "downloadButtonClicked", e, t])
        },
        modelDownloadFavoriteButtonClicked: function (e, t) {
            return r(["event", "modelDownload", "favoriteButtonClicked", e, t ? 1 : 0])
        },
        modelSettingsLicenseChanged: function (e) {
            return r(["event", "modelSettings", "licenseChanged", e])
        },
        modelSettingsSaveButtonClicked: function (e) {
            return r(["event", "modelSettings", "saveButtonClicked", e])
        },
        modelSettingsCancelButtonClicked: function (e) {
            return r(["event", "modelSettings", "cancelButtonClick", e])
        },
        modelEmbedDownloadButtonClicked: function (e) {
            return r(["event", "modelEmbed", "downloadButtonClicked", e])
        },
        modelEmbedFavoriteButtonClicked: function (e, t) {
            return r(["event", "modelEmbed", "favoriteButtonClicked", e, t ? 1 : 0])
        },
        modelEmbedShareButtonClicked: function (e) {
            return r(["event", "modelEmbed", "shareButtonClicked", e])
        },
        modelEmbedInfosButtonClicked: function (e, t) {
            return r(["event", "modelEmbed", "infosButtonClicked", e, t ? 1 : 2])
        },
        modelEmbedAutostart: function (e) {
            return r(["event", "modelEmbed", "autostart", e])
        },
        modelEmbedPlayButtonClicked: function (e) {
            return r(["event", "modelEmbed", "playButtonClicked", e])
        },
        modelEmbedStopButtonClicked: function (e) {
            return r(["event", "modelEmbed", "stopButtonClicked", e])
        },
        modelEmbedModelInteraction: function (e, t) {
            return r(["event", "modelEmbed", "modelInteraction" + t, e])
        },
        modelEmbedViewModelButtonClicked: function (e) {
            return r(["event", "modelEmbed", "viewModelButtonClicked", e])
        },
        modelEmbedWatermarkClicked: function (e) {
            return r(["event", "modelEmbed", "watermarkClicked", e])
        },
        modelViewerRenderingOptionsButtonClicked: function () {
            return r(["event", "modelViewer", "renderingOptionsButtonClicked"])
        },
        modelViewerViewerModeButtonClicked: function () {
            return r(["event", "modelViewer", "viewerModeButtonClicked"])
        },
        modelViewerFullscreenButtonClicked: function (e) {
            return r(["event", "modelViewer", "fullscreenButtonClicked", e ? 1 : 0])
        },
        modelViewerTheatreModeButtonClicked: function (e) {
            return r(["event", "modelViewer", "theatreButtonClicked", e ? 1 : 0])
        },
        modelViewerVrButtonClicked: function (e) {
            return r(["event", "modelViewer", "vrButtonClicked", e])
        },
        modelViewerInspectorShortcut: function () {
            return r(["event", "modelViewer", "inspectorShortcut"])
        },
        modelViewerInspectorButtonClicked: function () {
            return r(["event", "modelViewer", "inspectorButtonShortcut"])
        },
        modelViewerViewerModeSelected: function (e) {
            return r(["event", "modelViewer", "viewerModeSelected", e])
        },
        modelViewerShadingSelected: function (e) {
            return r(["event", "modelViewer", "shadingSelected", e])
        },
        modelViewerAnnotationsToggled: function (e, t) {
            return r(["event", "modelViewer", "annotationsToggled", e, t ? 1 : 0])
        },
        modelViewerAnnotationListClicked: function (e) {
            return r(["event", "modelViewer", "annotationListClicked", e])
        },
        modelViewerAnnotationsCycleToggled: function (e, t) {
            return r(["event", "modelViewer", "annotationsCycleToggled", e, t ? 1 : 0])
        },
        modelViewerWireframeToggleClicked: function (e) {
            return r(["event", "modelViewer", "wireframeEnable", e])
        },
        modelViewerWireframeColorSelected: function (e) {
            return r(["event", "modelViewer", "wireframeColorSelected", e])
        },
        modelViewerWireframeShortcut: function (e) {
            return r(["timing", "modelViewer", "wireframeEnable", e])
        },
        modelViewerTextureQualitySelected: function (e) {
            return r(["event", "modelViewer", "textureQualitySelected", e])
        },
        modelViewerPolygonLoaded: function (e) {
            return r(["timing", "modelViewer", "polygonLoaded", e])
        },
        modelViewerWireframeLoaded: function (e) {
            return r(["timing", "modelViewer", "wireframeLoaded", e])
        },
        modelViewerHighResTexturesLoaded: function (e, t) {
            return r(["timing", "modelViewer", "highResTexturesLoaded", e, {
                metric2: t
            }])
        },
        modelViewerLowResTexturesLoaded: function (e, t) {
            return r(["timing", "modelViewer", "lowResTexturesLoaded", e, {
                metric2: t
            }])
        },
        modelViewerModelDisplayed: function (e) {
            return r(["timing", "modelViewer", "modelDisplayed", e])
        },
        modelViewerNextAnnotationClicked: function (e) {
            return r(["event", "modelViewer", "nextAnnotationClicked", e])
        },
        modelViewerPreviousAnnotationClicked: function (e) {
            return r(["event", "modelViewer", "previousAnnotationClicked", e])
        },
        modelViewerAnnotationClicked: function (e) {
            return r(["event", "modelViewer", "annotationClicked", e])
        },
        modelViewerAnimationPlayClicked: function (e) {
            return r(["event", "modelViewer", "animationPlayClicked", e])
        },
        modelViewerAnimationPauseClicked: function (e) {
            return r(["event", "modelViewer", "animationPauseClicked", e])
        },
        modelViewerAnimationSpeedSelected: function (e) {
            return r(["event", "modelViewer", "animationSpeedSelected", e])
        },
        modelViewerAnimationRepeatModeSelected: function (e) {
            return r(["event", "modelViewer", "animationRepeatModeSelected", e])
        },
        modelViewerAnimationListClicked: function (e) {
            return r(["event", "modelViewer", "animationListClicked", e])
        },
        modelViewerAnimationNoAnimationClicked: function (e) {
            return r(["event", "modelViewer", "animationNoAnimationClicked", e])
        },
        modelViewerAnimationSeeked: function (e, t) {
            return r(["event", "modelViewer", "animationSeeked", e, t])
        },
        modelViewerFallbackDisplayed: function (e) {
            return r(["event", "modelViewer", "fallbackDisplayed", e])
        },
        modelViewerHelpButtonCliked: function (e) {
            return r(["event", "modelViewer", "helpButtonClicked", e])
        },
        modelViewerResetCameraButtonClicked: function () {
            return r(["event", "modelViewer", "resetCameraButtonClicked"])
        },
        modelViewerHelpTabClicked: function (e) {
            return r(["event", "modelViewer", "helpTabClicked", e])
        },
        modelViewerMuteButtonClicked: function (e) {
            return r(["event", "modelViewer", "muteButtonClicked"])
        },
        headerSearchInitiated: function (e) {
            return r(["event", "header", "searchInitiated", e])
        },
        headerUploadButtonClicked: function () {
            return r(["event", "header", "uploadButtonClicked", window.location.pathname + window.location.search])
        },
        headerUploadSignupButtonClicked: function () {
            return r(["event", "header", "uploadSignupButtonClicked"])
        },
        headerStoreSellerSignupButtonClicked: function () {
            return r(["event", "header", "storeSellerSignupButtonClicked"])
        },
        embedPopupEmbedFormatSelected: function (e) {
            return r(["event", "embedPopup", "embedFormatSelected", e])
        },
        embedPopupShowOptionsButtonClicked: function () {
            return r(["event", "embedPopup", "showOptionsButtonClicked"])
        },
        embedPopupOptionToggleChanged: function (e, t) {
            return r(["event", "embedPopup", "optionToggleChanged", e, t ? 1 : 0])
        },
        collectionEmbedPopupShowOptionsButtonClicked: function () {
            return r(["event", "collectionEmbedPopup", "showOptionsButtonClicked"])
        },
        collectionEmbedPopupOptionToggleChanged: function (e, t) {
            return r(["event", "collectionEmbedPopup", "optionToggleChanged", e, t ? 1 : 0])
        },
        modelBrowseTagFilterAdded: function (e) {
            return r(["event", "modelBrowse", "tagFilterAdded", e])
        },
        modelBrowseDateFilterChanged: function (e) {
            return r(["event", "modelBrowse", "dateFilterChanged", e])
        },
        modelBrowseSortFilterChanged: function (e) {
            return r(["event", "modelBrowse", "sortFilterChanged", e])
        },
        modelBrowseFaceCountFilterChanged: function (e) {
            return r(["event", "modelBrowse", "faceCountFilterChanged", e])
        },
        modelBrowseFeaturesFilterChanged: function (e) {
            return r(["event", "modelBrowse", "featuresFilterChanged", e])
        },
        modelBrowseCategoryFilterChanged: function (e) {
            return r(["event", "modelBrowse", "categoryFilterChanged", e])
        },
        modelBrowseFlagFilterChanged: function (e) {
            return r(["event", "modelBrowse", "flagFilterChanged", e])
        },
        modelUploadStarted: function () {
            return r(["event", "modelUpload", "started"])
        },
        modelUploadCanceled: function () {
            return r(["event", "modelUpload", "canceled"])
        },
        modelUploadProcessed: function (e) {
            return r(["event", "modelUpload", "processed", e ? 1 : 0])
        },
        collectionCardDeleteButtonClicked: function (e) {
            return r(["event", "collectionCard", "deleteButtonClicked", e])
        },
        collectionCardPreviewButtonClicked: function (e) {
            return r(["event", "collectionCard", "previewButtonClicked", e])
        },
        collectionSettingsSaveButtonClicked: function (e) {
            return r(["event", "collectionSettings", "saveButtonClicked", e])
        },
        collectionSettingsCancelButtonClicked: function (e) {
            return r(["event", "collectionSettings", "cancelButtonClicked", e])
        },
        collectionPageDeleteButtonClicked: function (e) {
            return r(["event", "collectionPage", "deleteButtonClicked", e])
        },
        collectionPageEmbedButtonClicked: function (e) {
            return r(["event", "collectionPage", "embedCollectionButtonClicked", e])
        },
        collectionPageShareButtonClicked: function (e) {
            return r(["event", "collectionPage", "shareCollectionButtonClicked", e])
        },
        collectionPreviewViewCollectionButtonClicked: function (e) {
            return r(["event", "collectionPreview", "viewCollectionButtonClicked", e])
        },
        collectionPreviewShareButtonClicked: function (e) {
            return r(["event", "collectionPreview", "shareButtonClicked", e])
        },
        collectionPreviewClosePopupButtonClicked: function (e) {
            return r(["event", "collectionPreview", "closePopupButtonClicked", e])
        },
        landingVideoTourButtonClicked: function () {
            return r(["event", "landing", "videoTourButtonClicked"])
        },
        studentsPageCheckEligibilitySucceeded: function (e) {
            return r(["event", "studentsPage", "eligibilityCheckSucceeded", e])
        },
        studentsPageCheckEligibilityFailed: function (e) {
            return r(["event", "studentsPage", "eligibilityCheckFailed", e])
        },
        studentsPageContactUsButtonClicked: function () {
            return r(["event", "studentsPage", "contactUsButtonClicked"])
        },
        annotationEditorCreateButtonClicked: function (e) {
            return r(["event", "annotationEditor", "createButtonClicked", e])
        },
        annotationEditorDeleteButtonClicked: function (e) {
            return r(["event", "annotationEditor", "deleteButtonClicked", e])
        },
        annotationEditorPositionMoved: function (e) {
            return r(["event", "annotationEditor", "positionMoved", e])
        },
        annotationEditorListReordered: function (e) {
            return r(["event", "annotationEditor", "listReordered", e])
        },
        annotationEditorCameraButtonClicked: function (e) {
            return r(["event", "annotationEditor", "cameraButtonClicked", e])
        },
        annotationEditorTooltipEdited: function (e) {
            return r(["event", "annotationEditor", "tooltipEdited", e])
        },
        annotationEditorWidgetDoneButtonClicked: function (e) {
            return r(["event", "annotationEditor", "widgetDoneButtonClicked", e])
        },
        annotationEditorLimitReachedUpgradeButtonClicked: function (e) {
            return r(["event", "annotationEditor", "annotationEditorLimitReachedUpgradeButtonClicked", e.get("uid")])
        },
        soundEditorSoundAdded: function () {
            return r(["event", "soundEditor", "soundAdded"])
        },
        soundEditorSoundRemoved: function () {
            return r(["event", "soundEditor", "soundRemoved"])
        },
        soundEditorPreviewSoundButtonClicked: function () {
            return r(["event", "soundEditor", "previewSoundButtonClicked"])
        },
        soundEditorChangeSoundButtonClicked: function () {
            return r(["event", "soundEditor", "changeSoundButtonClicked"])
        },
        soundEditor3DSoundButtonClicked: function () {
            return r(["event", "soundEditor", "3DSoundButtonClicked"])
        },
        soundEditorLoopButtonClicked: function () {
            return r(["event", "soundEditor", "LoopButtonClicked"])
        },
        postProcessEditorEffectToggled: function (e, t) {
            return r(["event", "postProcessEditor", "effectToggled", e, t ? 1 : 0])
        },
        categoryPageFollowSuggestionsButtonClicked: function (e, t) {
            return r(["event", "categoryPage", "followSuggestionsFollowButtonClicked", e, t ? 1 : 0])
        },
        tagPageFollowSuggestionsButtonClicked: function (e, t) {
            return r(["event", "tagPage", "followSuggestionsFollowButtonClicked", e, t ? 1 : 0])
        },
        shareButtonClicked: function (e, t, i) {
            return r(["event", e, t, i])
        },
        deleteModelPopupReasonSelected: function (e) {
            return r(["event", "deleteModelPopup", "deleteReasonSelected", e])
        },
        invitePageSendEmailClicked: function (e) {
            return e = parseInt(e), r(["event", "invitePage", "sendEmailClicked", "", e])
        },
        invitePageTwitterButtonClicked: function () {
            return r(["event", "invitePage", "twitterButtonClicked"])
        },
        invitePageFacebookButtonClicked: function () {
            return r(["event", "invitePage", "facebookButtonClicked"])
        },
        invitePageGoogleplusButtonClicked: function () {
            return r(["event", "invitePage", "googleplusButtonClicked"])
        },
        modelIssueReported: function (e, t) {
            return r(["event", "modelIssueReported", e, t])
        },
        newsfeedFollowCardFollowButtonClicked: function (e, t) {
            return r(["event", "newsfeedFollowCard", "followButtonClicked", e, t ? 1 : 0])
        },
        newsfeedPageFollowSuggestionsButtonClicked: function (e, t) {
            return r(["event", "newsfeedPage", "followSuggestionsFollowButtonClicked", e, t ? 1 : 0])
        },
        newsfeedCardFollowButtonClicked: function (e, t) {
            return r(["event", "newsfeedCard", "followButtonClicked", e, t ? 1 : 0])
        },
        newsfeedCardModelPreviewButtonClicked: function (e) {
            return r(["event", "newsfeedCard", "modelPreviewButtonClicked", e])
        },
        newsfeedCardFavoriteButtonClicked: function (e, t) {
            return r(["event", "newsfeedCard", "favoriteButtonClicked", e, t ? 1 : 0])
        },
        onboardingUsageType: function (e) {
            return r(["event", "onboarding", "usageType", e])
        },
        newsfeedUsersFollowed: function (e) {
            return r(["event", "newsfeed", "usersFollowed", e])
        },
        newsfeedInterestsSelected: function (e) {
            return r(["event", "newsfeed", "interestsSelected", e])
        },
        playlistNextButtonClicked: function () {
            return r(["event", "playlist", "nextButtonClicked"])
        },
        playlistPreviousButtonClicked: function () {
            return r(["event", "playlist", "previousButtonClicked"])
        },
        playlistItemClicked: function () {
            return r(["event", "playlist", "tocItemClicked"])
        },
        profileWizardGeolocationClicked: function () {
            return r(["event", "profileWizard", "geolocationClicked"])
        },
        uploadCardCollectionCreated: function (e) {
            return r(["event", "uploadCard", "collectionCreated", e])
        },
        uploadCardCollectionEnabled: function (e) {
            return r(["event", "uploadCard", "collectionEnabled", e])
        },
        uploadCardCollectionDisabled: function (e) {
            return r(["event", "uploadCard", "collectionDisabled", e])
        },
        uploadCardSettingsButtonClicked: function (e) {
            return r(["event", "uploadCard", "settingsButtonClicked", e])
        },
        uploadCardReuploadButtonClicked: function (e) {
            return r(["event", "uploadCard", "reuploadButtonClicked", e])
        },
        uploadCardDeleteButtonClicked: function (e) {
            return r(["event", "uploadCard", "deleteButtonClicked", e])
        },
        uploadCard3dSettingsButtonClicked: function (e) {
            return r(["event", "uploadCard", "3dSettingsButtonClicked", e])
        },
        uploadCardAnnotationsButtonClicked: function (e) {
            return r(["event", "uploadCard", "AnnotationsButtonClicked", e])
        },
        inspectorDisplayViewClicked: function (e, t) {
            return r(["event", "inspector", "displayViewClicked", e + ":" + t])
        },
        inspectorModeShortcut: function (e, t) {
            return r(["event", "inspector", "displayViewShortcut", e + ":" + t])
        },
        inspectorSplitTypeClicked: function (e) {
            return r(["event", "inspector", "splitTypeClicked", e])
        },
        inspectorUIVisibilityToggleClicked: function () {
            return r(["event", "inspector", "UIVisibilityToggleClicked"])
        },
        storeCheckoutInitiated: function (e, t) {
            return r(["event", "store", "InitiateCheckout", e, t])
        },
        storeModelAddedToCart: function (e, t) {
            return r(["event", "store", "AddToCart", e, t])
        },
        storePurchaseCompleted: function (e, t) {
            return r(["event", "store", "Purchase", e, t])
        }
    }
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(377)),
        a = i(393),
        o = i.n(a);
    t.a = Object(n.extend)({}, r.a, o.a)
}, function (e, t, i) {
    i(37), i(63),
        function () {
            (window.nunjucksPrecompiled = window.nunjucksPrecompiled || {})["skfb_front/macros/model.jinja"] = function () {
                function e(e, t, i, n, r) {
                    var a = null,
                        o = null,
                        s = "";
                    try {
                        var u = null;
                        e.getTemplate("skfb_front/macros/buttons.jinja", !1, "skfb_front/macros/model.jinja", !1, function (l, c) {
                            if (l) return void r(l);
                            c.getExported(function (l, c) {
                                if (l) return void r(l);
                                if (!c.hasOwnProperty("star_like_button")) return void r(new Error("cannot import 'star_like_button'"));
                                var h = c.star_like_button;
                                t.setVariable("star_like_button", h), s += "\n", e.getTemplate("skfb_front/macros/utils.jinja", !1, "skfb_front/macros/model.jinja", !1, function (l, c) {
                                    if (l) return void r(l);
                                    c.getExported(function (l, c) {
                                        if (l) return void r(l);
                                        if (!c.hasOwnProperty("humanize_count")) return void r(new Error("cannot import 'humanize_count'"));
                                        var h = c.humanize_count;
                                        t.setVariable("humanize_count", h), s += "\n\n";
                                        var d = n.makeMacro(["model"], ["options"], function (r, a) {
                                            var o = i;
                                            i = new n.Frame, a = a || {}, a.hasOwnProperty("caller") && i.set("caller", a.caller), i.set("model", r), i.set("options", a.hasOwnProperty("options") ? a.options : {});
                                            var s = "";
                                            s += "\n    ";
                                            var u;
                                            u = e.getFilter("merge").call(t, {
                                                withStaffpickFlag: !0,
                                                withStaffpickLink: !1,
                                                withRestrictedFlag: !0,
                                                displayRecentlyStaffpicked: !1
                                            }, n.contextOrFrameLookup(t, i, "options")), i.set("options", u, !0), i.topLevel && t.setVariable("options", u), i.topLevel && t.addExport("options", u), s += "\n    ";
                                            var l;
                                            return l = n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "displayRecentlyStaffpicked") && n.memberLookup(r, "recentlyStaffpicked"), i.set("recentlyStaffpicked", l, !0), i.topLevel && t.setVariable("recentlyStaffpicked", l), i.topLevel && t.addExport("recentlyStaffpicked", l), s += "\n\n    ", n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "withStaffpickLink") && n.memberLookup(r, "staffpickedAt") ? s += '\n        <meta itemprop="award" content="Staff Pick" />\n        <a href="/models/staffpicks" class="flag --staffpicked" title="See all staff picks"></a>\n    ' : n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "withStaffpickFlag") && n.memberLookup(r, "staffpickedAt") && (s += '\n        <meta itemprop="award" content="Staff Pick" />\n        <span class="flag --staffpicked ', n.contextOrFrameLookup(t, i, "recentlyStaffpicked") && (s += "--with-text"), s += '" title="Staff Picks"></span>\n    '), s += "\n\n    ", (n.memberLookup(r, "isRestricted") || n.memberLookup(r, "isAdult")) && (s += "\n        ", n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "withRestrictedFlag") && (s += '\n            <a\n                href="https://help.sketchfab.com/hc/en-us/articles/214867883-Age-Restricted-Content"\n                target="_blank"\n                class="flag --restricted"\n                title="Age-restricted content"></a>\n        '), s += "\n    "), s += "\n", i = o, new n.SafeString(s)
                                        });
                                        t.addExport("model_labels"), t.setVariable("model_labels", d), s += "\n\n";
                                        var f = n.makeMacro(["authUser", "model"], ["options"], function (r, s, u) {
                                            var l = i;
                                            i = new n.Frame, u = u || {}, u.hasOwnProperty("caller") && i.set("caller", u.caller), i.set("authUser", r), i.set("model", s), i.set("options", u.hasOwnProperty("options") ? u.options : {});
                                            var c, h = "";
                                            return c = e.getFilter("merge").call(t, {
                                                clickable: !0
                                            }, n.contextOrFrameLookup(t, i, "options")), i.set("options", c, !0), i.topLevel && t.setVariable("options", c), i.topLevel && t.addExport("options", c), h += '<span class="model-name">\n\n        ', n.memberLookup(s, "isProtected") ? h += '\n            <i class="model-name__icon fa fa-lock --protected"></i>\n        ' : n.memberLookup(s, "isPrivate") && (h += '\n            <i class="model-name__icon custom-icons icon-private --private"></i>\n        '), h += "\n\n        ", n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "clickable") ? (h += '\n            <a class="model-name__label" data-route href="', h += n.suppressValue(n.memberLookup(s, "viewerUrl"), e.opts.autoescape), h += '"', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "target") && (h += ' target="', h += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "target"), e.opts.autoescape), h += '"'), h += ' title="', h += n.suppressValue(n.memberLookup(s, "inStore") ? "Buy " : "", e.opts.autoescape), h += n.suppressValue(n.memberLookup(s, "name"), e.opts.autoescape), h += ' 3D Model">', h += n.suppressValue(n.memberLookup(s, "name"), e.opts.autoescape), h += "</a>\n        ") : (h += '\n            <span class="model-name__label">', h += n.suppressValue(n.memberLookup(s, "name"), e.opts.autoescape), h += "</span>\n        "), h += "\n\n        ", h += n.suppressValue((a = 49, o = 21, n.callWrap(n.contextOrFrameLookup(t, i, "model_labels"), "model_labels", t, [s, n.contextOrFrameLookup(t, i, "options")])), e.opts.autoescape), h += "\n\n    </span>", i = l, new n.SafeString(h)
                                        });
                                        t.addExport("model_name"), t.setVariable("model_name", f), s += "\n\n";
                                        var p = n.makeMacro(["authUser", "list"], ["options"], function (r, s, u) {
                                            var l = i;
                                            i = new n.Frame, u = u || {}, u.hasOwnProperty("caller") && i.set("caller", u.caller), i.set("authUser", r), i.set("list", s), i.set("options", u.hasOwnProperty("options") ? u.options : {});
                                            var c, h = "";
                                            c = e.getFilter("merge").call(t, {
                                                maxDisplayed: 3,
                                                othersHref: ""
                                            }, n.contextOrFrameLookup(t, i, "options")), i.set("options", c, !0), i.topLevel && t.setVariable("options", c), i.topLevel && t.addExport("options", c);
                                            var d;
                                            d = e.getFilter("first_n").call(t, s, n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "maxDisplayed")), i.set("shortList", d, !0), i.topLevel && t.setVariable("shortList", d), i.topLevel && t.addExport("shortList", d);
                                            var f;
                                            f = e.getFilter("length").call(t, s) - e.getFilter("length").call(t, n.contextOrFrameLookup(t, i, "shortList")), i.set("otherCount", f, !0), i.topLevel && t.setVariable("otherCount", f), i.topLevel && t.addExport("otherCount", f), i = i.push();
                                            var p = n.contextOrFrameLookup(t, i, "shortList");
                                            if (p)
                                                for (var m = p.length, g = 0; g < p.length; g++) {
                                                    var v = p[g];
                                                    i.set("model", v), i.set("loop.index", g + 1), i.set("loop.index0", g), i.set("loop.revindex", m - g), i.set("loop.revindex0", m - g - 1), i.set("loop.first", 0 === g), i.set("loop.last", g === m - 1), i.set("loop.length", m), n.memberLookup(n.contextOrFrameLookup(t, i, "loop"), "first") || (n.memberLookup(n.contextOrFrameLookup(t, i, "loop"), "last") && n.contextOrFrameLookup(t, i, "otherCount") < 1 ? h += "<span> and </span>" : h += "<span>, </span>"), h += n.suppressValue((a = 71, o = 19, n.callWrap(n.contextOrFrameLookup(t, i, "model_name"), "model_name", t, [r, v, {
                                                        withStaffpickFlag: !1,
                                                        withStaffpickLink: !1,
                                                        withRestrictedFlag: !1
                                                    }])), e.opts.autoescape)
                                                }
                                            return i = i.pop(), n.contextOrFrameLookup(t, i, "otherCount") > 0 && (n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "othersHref") ? (h += '<a href="', h += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "othersHref"), e.opts.autoescape), h += '" class="others"> and ', h += n.suppressValue(n.contextOrFrameLookup(t, i, "otherCount"), e.opts.autoescape), h += " other", h += n.suppressValue(e.getFilter("pluralize").call(t, n.contextOrFrameLookup(t, i, "otherCount")), e.opts.autoescape), h += "</a>") : (h += '<span class="others"> and ', h += n.suppressValue(n.contextOrFrameLookup(t, i, "otherCount"), e.opts.autoescape), h += " other", h += n.suppressValue(e.getFilter("pluralize").call(t, n.contextOrFrameLookup(t, i, "otherCount")), e.opts.autoescape), h += "</span>")), i = l, new n.SafeString(h)
                                        });
                                        t.addExport("model_name_list"), t.setVariable("model_name_list", p), s += "\n\n";
                                        var m = n.makeMacro(["authUser", "model"], ["options"], function (r, a, o) {
                                            var s = i;
                                            i = new n.Frame, o = o || {}, o.hasOwnProperty("caller") && i.set("caller", o.caller), i.set("authUser", r), i.set("model", a), i.set("options", o.hasOwnProperty("options") ? o.options : {});
                                            var u = "";
                                            u += "\n\n    ";
                                            var l;
                                            return l = e.getFilter("merge").call(t, {
                                                withProperties: !0,
                                                withPublish: !0,
                                                with3DSettings: !0
                                            }, n.contextOrFrameLookup(t, i, "options")), i.set("options", l, !0), i.topLevel && t.setVariable("options", l), i.topLevel && t.addExport("options", l), u += '\n\n    <ul class="hover-menu quicksettings corner ', u += n.suppressValue(e.getFilter("class_names").call(t, {
                                                "--up": "up" == n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "direction"),
                                                "--left": "left" == n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "direction")
                                            }), e.opts.autoescape), u += '">\n\n        ', 2 == n.memberLookup(a, "processingStatus") && (u += "\n            ", n.memberLookup(a, "isDisabled") || n.memberLookup(a, "publishedAt") || !n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "withPublish") || (u += '\n                <li><a data-action="publish">Publish</a></li>\n                <li class="separator"></li>\n            '), u += "\n\n            ", n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "withProperties") && (u += '\n                <li><a data-action="open-settings-popup">Properties</a></li>\n            '), u += "\n\n            ", n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "with3DSettings") && (u += '\n                <li><a href="', u += n.suppressValue(n.memberLookup(a, "editorUrl"), e.opts.autoescape), u += '" data-action="settings3d-button">3D settings</a></li>\n            '), u += "\n\n            ", n.memberLookup(a, "publishedAt") && (u += '\n                <li><a data-action="open-collection-popup">Add to collection</a></li>\n            '), u += '\n\n            <li class="separator"></li>\n\n        '), u += "\n\n        ", n.memberLookup(a, "processingStatus") > 1 && (u += '\n            <li><a data-action="open-reupload-popup">Re-upload</a></li>\n            <li class="js-duplicate"></li>\n            <li class="separator"></li>\n            <li><a class="--red" data-action="delete-model">Delete</a></li>\n        '), u += '\n        <li><a data-action="report-issue">Report an issue</a></li>\n\n    </ul>\n\n', i = s, new n.SafeString(u)
                                        });
                                        t.addExport("model_quicksettings"), t.setVariable("model_quicksettings", m), s += "\n\n";
                                        var g = n.makeMacro([], [], function (e) {
                                            var t = i;
                                            i = new n.Frame, e = e || {}, e.hasOwnProperty("caller") && i.set("caller", e.caller);
                                            var r = "";
                                            return r += '\n\n    <div class="card-preview" data-action="open-preview">\n        <i class="card-preview__icon fa fa-search" title="see preview"></i>\n    </div>\n\n', i = t, new n.SafeString(r)
                                        });
                                        t.addExport("preview_link"), t.setVariable("preview_link", g), s += "\n\n";
                                        var v = n.makeMacro(["authUser", "model"], ["options"], function (e, r, a) {
                                            var o = i;
                                            i = new n.Frame, a = a || {}, a.hasOwnProperty("caller") && i.set("caller", a.caller), i.set("authUser", e), i.set("model", r), i.set("options", a.hasOwnProperty("options") ? a.options : {});
                                            var s = "";
                                            return s += '\n\n    <ul class="hover-menu quicksettings corner', "up" == n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "direction") && (s += " hover-menu-up"), "left" == n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "direction") && (s += " hover-menu-left"), s += '">\n        <li><a data-action="remove-model">Remove</a></li>\n    </ul>\n\n', i = o, new n.SafeString(s)
                                        });
                                        t.addExport("collection_item_quicksettings"), t.setVariable("collection_item_quicksettings", v), s += "\n\n";
                                        var _ = n.makeMacro(["authUser", "model"], ["options"], function (r, s, u) {
                                            var l = i;
                                            i = new n.Frame, u = u || {}, u.hasOwnProperty("caller") && i.set("caller", u.caller), i.set("authUser", r), i.set("model", s), i.set("options", u.hasOwnProperty("options") ? u.options : {});
                                            var c = "";
                                            return c += '\n\n    <div class="model-uploadcard">\n\n        <h3 class="filename">\n            <a data-route href="', c += n.suppressValue(n.memberLookup(s, "viewerUrl"), e.opts.autoescape), c += '">', n.memberLookup(s, "name") ? c += n.suppressValue((a = 158, o = 31, n.callWrap(n.contextOrFrameLookup(t, i, "model_name"), "model_name", t, [r, s, {
                                                withStaffpickFlag: !1
                                            }])), e.opts.autoescape) : c += n.suppressValue(e.getFilter("default").call(t, n.memberLookup(s, "originalFileName"), "No file name"), e.opts.autoescape), c += '</a>\n        </h3>\n        <div class="meta">', n.memberLookup(s, "name") && (c += '<span class="original-filename">\n                    ', c += n.suppressValue(e.getFilter("default").call(t, n.memberLookup(s, "originalFileName"), "No file name"), e.opts.autoescape), c += "\n                </span>"), n.memberLookup(s, "processedAt") ? (c += '\n                <span class="date" title="', c += n.suppressValue(n.memberLookup(s, "processedAt"), e.opts.autoescape), c += '">', c += n.suppressValue(e.getFilter("time_ago").call(t, n.memberLookup(s, "processedAt")), e.opts.autoescape), c += "</span>\n            ") : (c += '\n                <span class="date" title="', c += n.suppressValue(n.memberLookup(s, "createdAt"), e.opts.autoescape), c += '">', c += n.suppressValue(e.getFilter("time_ago").call(t, n.memberLookup(s, "createdAt")), e.opts.autoescape), c += "</span>\n            "), c += '\n        </div>\n\n        <div class="status">', 0 == n.memberLookup(s, "processingStatus") ? c += '<div class="help">\n                    <i class="icon spinner-small-slow"></i>\n                    <div class="tooltip tooltip-down">Pending</div>\n                </div>' : 1 == n.memberLookup(s, "processingStatus") ? c += '<div class="help">\n                    <i class="icon spinner-small"></i>\n                    <div class="tooltip tooltip-down">Processing</div>\n                </div>' : 2 == n.memberLookup(s, "processingStatus") ? n.memberLookup(s, "isPublished") ? c += '<div class="help">\n                        <i class="icon fa fa-check"></i>\n                        <div class="tooltip tooltip-down">Published</div>\n                    </div>' : (c += '<button type="button" class="button btn-important btn-medium" data-action="publish">\n                        Publish\n                    </button>\n\n                    <a href="/models/', c += n.suppressValue(n.memberLookup(s, "uid"), e.opts.autoescape), c += '/edit" class="button btn-tertiary btn-medium btn-edit" data-action="edit">\n                        3D Settings\n                    </a>') : 3 == n.memberLookup(s, "processingStatus") && (c += '<div class="help">\n                    <i class="icon fa fa-times"></i>\n                    <div class="tooltip tooltip-down">Error</div>\n                </div>'), c += '</div>\n\n        <div class="model-uploadcard-settings">\n            <div class="button btn-medium btn-tertiary"', n.memberLookup(s, "processingStatus") < 2 && (c += " disabled"), c += '>\n                <i class="fa fa-cog"></i>\n                ', c += n.suppressValue((a = 226, o = 36, n.callWrap(n.contextOrFrameLookup(t, i, "model_quicksettings"), "model_quicksettings", t, [r, s, {
                                                direction: "left",
                                                withPublish: !1
                                            }])), e.opts.autoescape), c += "\n            </div>\n        </div>\n\n    </div>\n\n", i = l, new n.SafeString(c)
                                        });
                                        t.addExport("model_uploadcard"), t.setVariable("model_uploadcard", _), s += "\n\n\n";
                                        var b = n.makeMacro(["authUser"], ["options"], function (r, a) {
                                            var o = i;
                                            i = new n.Frame, a = a || {}, a.hasOwnProperty("caller") && i.set("caller", a.caller), i.set("authUser", r), i.set("options", a.hasOwnProperty("options") ? a.options : {});
                                            var s = "";
                                            return s += '\n\n    <div class="annotation" data-hotspot="', s += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "hotspotIndex"), e.opts.autoescape), s += '">\n\n        <div class="tooltip">\n\n            ', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "editMode") ? s += '\n                <form class="tooltip-content">\n                    <div class="edition">\n                        <input class="title" placeholder="Title *" maxlength="64" required>\n                        <textarea class="description" placeholder="Description (add links, images and other formatting with Markdown)" maxlength="1024" rows="2"></textarea>\n                    </div>\n                    <div class="render">\n                        <div class="title"></div>\n                        <div class="markdown-editor">\n                            <div class="description markdown-rendered-content inversed"></div>\n                        </div>\n                    </div>\n                    <div class="meta">\n                        <button type="submit" class="submit button btn-primary btn-small">OK</button>\n                        <div class="meta__mode">\n                            <i class="fa fa-pencil activate-edition selected" title="Edit"></i>\n                            <i class="fa fa-eye activate-render" title="Preview"></i>\n                        </div>\n                    </div>\n                </form>\n            ' : s += '\n\n                <div class="tooltip-content">\n                    <div class="tooltip-content-minimal">\n                        <div class="title"></div>\n                        <a href="#" class="more">+ more info</a>\n                    </div>\n                    <div class="title"></div>\n                    <div class="description markdown-rendered-content inversed"></div>\n                </div>\n\n            ', s += "\n\n        </div>\n\n    </div>\n\n", i = o, new n.SafeString(s)
                                        });
                                        t.addExport("model_hotspot"), t.setVariable("model_hotspot", b), s += "\n\n\n";
                                        var S = n.makeMacro([], ["options"], function (r) {
                                            var s = i;
                                            i = new n.Frame, r = r || {}, r.hasOwnProperty("caller") && i.set("caller", r.caller), i.set("options", r.hasOwnProperty("options") ? r.options : {});
                                            var u = "";
                                            u += "\n\n";
                                            var l;
                                            l = 30, i.set("width_before", l, !0), i.topLevel && t.setVariable("width_before", l), i.topLevel && t.addExport("width_before", l), u += "\n";
                                            var c;
                                            c = 960, i.set("width_next", c, !0), i.topLevel && t.setVariable("width_next", c), i.topLevel && t.addExport("width_next", c), u += '\n\n<div class="annotation vr visible" data-hotspot="', u += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "hotspotIndex"), e.opts.autoescape), u += '" style="width:', u += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "widthContent"), e.opts.autoescape), u += 'px;height:576px;position:absolute;top:30px;left:30px;">\n\n    <div class="tooltip visible" style="width:', u += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "widthContent"), e.opts.autoescape), u += 'px;border-radius:30px;left:0;">\n        <div class="tooltip-content" style="width:', u += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "widthContent"), e.opts.autoescape), u += 'px;height:576px;border-radius:30px;display:flex;flex-direction:column;">\n\n            <div class="title" style="font-size:48px;line-height:1.5;padding:10px 80px 0 80px;">', u += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "title"), e.opts.autoescape), u += "</div>", i = i.push();
                                            var h = (a = 293, o = 32, n.callWrap(n.contextOrFrameLookup(t, i, "range"), "range", t, [0, n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "column")]));
                                            if (h)
                                                for (var d = h.length, f = 0; f < h.length; f++) {
                                                    var p = h[f];
                                                    i.set("column", p), i.set("loop.index", f + 1), i.set("loop.index0", f), i.set("loop.revindex", d - f), i.set("loop.revindex0", d - f - 1), i.set("loop.first", 0 === f), i.set("loop.last", f === d - 1), i.set("loop.length", d), n.contextOrFrameLookup(t, i, "width_before") > 30 && (u += '<div class="fa fa-arrow-left" style="font-size:40px;position:absolute;top:250px;left:', u += n.suppressValue(n.contextOrFrameLookup(t, i, "width_before"), e.opts.autoescape), u += 'px"></div>');
                                                    var m;
                                                    m = n.contextOrFrameLookup(t, i, "width_before") + 1024, i.set("width_before", m, !0), i.topLevel && t.setVariable("width_before", m), i.topLevel && t.addExport("width_before", m)
                                                }
                                            i = i.pop(), u += '<div class="description" style="column-gap:180px;column-count:', u += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "column"), e.opts.autoescape), u += ';font-size:36px;width:100%;line-height:1.5;padding:10px 80px 0 80px;">', u += n.suppressValue(e.getFilter("safe").call(t, n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "description")), e.opts.autoescape), u += "</div>", i = i.push();
                                            var g = (a = 302, o = 32, n.callWrap(n.contextOrFrameLookup(t, i, "range"), "range", t, [1, n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "column")]));
                                            if (g)
                                                for (var v = g.length, _ = 0; _ < g.length; _++) {
                                                    var b = g[_];
                                                    i.set("column", b), i.set("loop.index", _ + 1), i.set("loop.index0", _), i.set("loop.revindex", v - _), i.set("loop.revindex0", v - _ - 1), i.set("loop.first", 0 === _), i.set("loop.last", _ === v - 1), i.set("loop.length", v), u += '<div class="fa fa-arrow-right" style="font-size:40px;position:absolute;top:250px;left:', u += n.suppressValue(n.contextOrFrameLookup(t, i, "width_next"), e.opts.autoescape), u += 'px"></div>\n                ';
                                                    var S;
                                                    S = n.contextOrFrameLookup(t, i, "width_next") + 1024, i.set("width_next", S, !0), i.topLevel && t.setVariable("width_next", S), i.topLevel && t.addExport("width_next", S)
                                                }
                                            i = i.pop(), u += '<div class="footer" style="text-align:left;font-size:36px;justify-content:space-around;bottom:15px;left:0;position:absolute;margin:20px 0 20px 0;">', i = i.push();
                                            var x = (a = 308, o = 40, n.callWrap(n.contextOrFrameLookup(t, i, "range"), "range", t, [0, n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "column")]));
                                            if (x)
                                                for (var y = x.length, C = 0; C < x.length; C++) {
                                                    var T = x[C];
                                                    i.set("column", T), i.set("loop.index", C + 1), i.set("loop.index0", C), i.set("loop.revindex", y - C), i.set("loop.revindex0", y - C - 1), i.set("loop.first", 0 === C), i.set("loop.last", C === y - 1), i.set("loop.length", y), u += '<div class="containter-button" style="width:1024px;display:inline-block;text-align:center;">', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "displayNavigation") ? u += '<button id="prevButton" class="button" style="background:#444444;">Prev</button>\n                                <button id="closeButton" class="button" style="background:#444444;">Close annotation</button>\n                                <button id="nextButton" class="button" style="background:#444444;">Next</button>' : u += '<button id="closeButton" class="button" style="background:#444444;">Close annotation</button>', u += "</div>"
                                                }
                                            return i = i.pop(), u += "</div>\n\n        </div>\n    </div>\n</div>\n\n", i = s, new n.SafeString(u)
                                        });
                                        t.addExport("model_hotspot_vr"), t.setVariable("model_hotspot_vr", S), s += "\n\n";
                                        var x = n.makeMacro(["src"], ["options"], function (r, a) {
                                            var o = i;
                                            i = new n.Frame, a = a || {}, a.hasOwnProperty("caller") && i.set("caller", a.caller), i.set("src", r), i.set("options", a.hasOwnProperty("options") ? a.options : {});
                                            var s = "";
                                            return s += "<iframe ", s += n.suppressValue(e.getFilter("attributes").call(t, {
                                                class: n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "class"),
                                                width: n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "width"),
                                                height: n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "height"),
                                                src: r,
                                                frameborder: "0",
                                                allow: "autoplay; fullscreen; vr",
                                                allowvr: "",
                                                allowfullscreen: "",
                                                mozallowfullscreen: "true",
                                                webkitallowfullscreen: "true",
                                                onmousewheel: ""
                                            }), e.opts.autoescape), s += "></iframe>", i = o, new n.SafeString(s)
                                        });
                                        t.addExport("model_iframe"), t.setVariable("model_iframe", x), s += "\n\n";
                                        var y = n.makeMacro(["license"], [], function (t, r) {
                                            var a = i;
                                            i = new n.Frame, r = r || {}, r.hasOwnProperty("caller") && i.set("caller", r.caller), i.set("license", t);
                                            var o = "";
                                            return o += '\n    <div class="model-license">\n        <p class="model-license__name help">\n            ', o += n.suppressValue(n.memberLookup(t, "label"), e.opts.autoescape), o += '\n            <span class="tooltip tooltip-up">', o += n.suppressValue(n.memberLookup(t, "fullname"), e.opts.autoescape), o += '</span>\n        </p>\n\n        <p class="model-license__requirements">', o += n.suppressValue(n.memberLookup(t, "requirements"), e.opts.autoescape), o += '</p>\n\n        <a\n            class="model-license__link skfb-link"\n            href="', o += n.suppressValue(n.memberLookup(t, "url"), e.opts.autoescape), o += '"\n            rel="license"\n            itemprop="license"\n            target="_blank">more info</a>\n    </div>\n', i = a, new n.SafeString(o)
                                        });
                                        t.addExport("model_license"), t.setVariable("model_license", y), s += "\n\n";
                                        var C = n.makeMacro(["model"], ["options"], function (r, a) {
                                            var o = i;
                                            i = new n.Frame, a = a || {}, a.hasOwnProperty("caller") && i.set("caller", a.caller), i.set("model", r), i.set("options", a.hasOwnProperty("options") ? a.options : {});
                                            var s = "";
                                            s += "\n    ";
                                            var u;
                                            return u = e.getFilter("merge").call(t, {
                                                className: ""
                                            }, n.contextOrFrameLookup(t, i, "options")), i.set("options", u, !0), i.topLevel && t.setVariable("options", u), i.topLevel && t.addExport("options", u), s += '\n    <span class="', s += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "className"), e.opts.autoescape), s += ' custom-icons icon-eye-icon help">\n        <span class="count">\n            ', s += n.suppressValue(e.getFilter("humanize_number").call(t, n.memberLookup(r, "viewCount")), e.opts.autoescape), s += '\n        </span>\n        <span class="tooltip tooltip-up">Views</span>\n    </span>\n', i = o, new n.SafeString(s)
                                        });
                                        t.addExport("model_view_count"), t.setVariable("model_view_count", C), s += "\n\n";
                                        var T = n.makeMacro(["authUser", "model"], ["options"], function (r, s, u) {
                                            var l = i;
                                            i = new n.Frame, u = u || {}, u.hasOwnProperty("caller") && i.set("caller", u.caller), i.set("authUser", r), i.set("model", s), i.set("options", u.hasOwnProperty("options") ? u.options : {});
                                            var c, h = "";
                                            return c = e.getFilter("merge").call(t, {
                                                isMine: !1
                                            }, n.contextOrFrameLookup(t, i, "options")), i.set("options", c, !0), i.topLevel && t.setVariable("options", c), i.topLevel && t.addExport("options", c), h += '<div class="model-cell__name-container">\n        <p class="model-cell__name ', h += n.suppressValue(n.memberLookup(s, "isDeleted") ? "--deleted" : "", e.opts.autoescape), h += '">\n            ', h += n.suppressValue((a = 378, o = 23, n.callWrap(n.contextOrFrameLookup(t, i, "model_name"), "model_name", t, [r, s, {
                                                clickable: !n.memberLookup(s, "isDeleted")
                                            }])), e.opts.autoescape), h += "\n        </p>\n\n        ", n.memberLookup(s, "isDeleted") && (h += '\n            <span class="model-cell__deleted-tooltip help">\n                <i class="fa fa-question-circle"></i>\n                <span class="tooltip tooltip-right">\n                    This model was deleted', h += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "isMine") ? "" : ", but no worries, you can still download the latest version!", e.opts.autoescape), h += "\n                </span>\n            </span>\n        "), h += "\n    </div>\n", i = l, new n.SafeString(h)
                                        });
                                        t.addExport("model_cell_name"), t.setVariable("model_cell_name", T), s += "\n", u ? u.rootRenderFunc(e, t, i, n, r) : r(null, s)
                                    })
                                })
                            })
                        })
                    } catch (e) {
                        r(n.handleError(e, a, o))
                    }
                }
                return {
                    root: e
                }
            }()
        }()
}, function (e, t, i) {
    i(37),
        function () {
            (window.nunjucksPrecompiled = window.nunjucksPrecompiled || {})["skfb_front/macros/user.jinja"] = function () {
                function e(e, t, i, n, r) {
                    var a = null,
                        o = null,
                        s = "";
                    try {
                        var u = null;
                        e.getTemplate("skfb_front/macros/buttons.jinja", !1, "skfb_front/macros/user.jinja", !1, function (l, c) {
                            if (l) return void r(l);
                            c.getExported(function (l, c) {
                                if (l) return void r(l);
                                if (!c.hasOwnProperty("follow_button")) return void r(new Error("cannot import 'follow_button'"));
                                var h = c.follow_button;
                                t.setVariable("follow_button", h), s += "\n\n";
                                var d = n.makeMacro(["user"], ["options"], function (r, a) {
                                    var o = i;
                                    i = new n.Frame, a = a || {}, a.hasOwnProperty("caller") && i.set("caller", a.caller), i.set("user", r), i.set("options", a.hasOwnProperty("options") ? a.options : {});
                                    var s = "";
                                    s += "\n    ";
                                    var u;
                                    return u = e.getFilter("merge").call(t, {
                                        avatarWidth: 20,
                                        avatarHeight: 20
                                    }, n.contextOrFrameLookup(t, i, "options")), i.set("options", u, !0), i.topLevel && t.setVariable("options", u), i.topLevel && t.addExport("options", u), s += '\n    <div\n        class="avatar"\n        data-user-summary-anchor="true"\n        data-user="', s += n.suppressValue(n.memberLookup(r, "uid"), e.opts.autoescape), s += '">\n        ', s += n.suppressValue(e.getFilter("image_container").call(t, n.memberLookup(r, "avatars"), n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "avatarWidth"), n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "avatarHeight")), e.opts.autoescape), s += "\n    </div>\n", i = o, new n.SafeString(s)
                                });
                                t.addExport("user_name_avatar"), t.setVariable("user_name_avatar", d), s += "\n\n";
                                var f = n.makeMacro(["authUser", "user"], ["options"], function (r, s, u) {
                                    var l = i;
                                    i = new n.Frame, u = u || {}, u.hasOwnProperty("caller") && i.set("caller", u.caller), i.set("authUser", r), i.set("user", s), i.set("options", u.hasOwnProperty("options") ? u.options : {});
                                    var c, h = "";
                                    return c = e.getFilter("merge").call(t, {
                                        noLink: !1,
                                        noBadge: !1,
                                        tag: !1
                                    }, n.contextOrFrameLookup(t, i, "options")), i.set("options", c, !0), i.topLevel && t.setVariable("options", c), i.topLevel && t.addExport("options", c), h += '\n\n    <div class="user-name ', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "noLink") && (h += "--no-link"), h += " ", n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "noBadge") && (h += "--no-badge-link"), h += '">\n        <a class="user-name__link" href="', h += n.suppressValue(n.memberLookup(s, "profileUrl"), e.opts.autoescape), h += '" ', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "target") && (h += ' target="', h += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "target"), e.opts.autoescape), h += '"'), h += '>\n            <data itemprop="url" value="', h += n.suppressValue(n.memberLookup(s, "profileUrl"), e.opts.autoescape), h += '"></data>\n            ', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "withAvatar") && (h += "\n            <span ", n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "withSummary") && (h += 'data-action="show-user-summary"\n                data-user="', h += n.suppressValue(n.memberLookup(s, "uid"), e.opts.autoescape), h += '"'), h += ">\n                ", h += n.suppressValue((a = 30, o = 33, n.callWrap(n.contextOrFrameLookup(t, i, "user_name_avatar"), "user_name_avatar", t, [s, n.contextOrFrameLookup(t, i, "options")])), e.opts.autoescape), h += "\n            </span>\n            "), h += '\n\n            <div class="text">\n                ', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "by") && (h += "by"), h += '\n                <div\n                    class="username-wrapper"\n                    itemprop="name"\n                    title="', h += n.suppressValue(n.memberLookup(s, "displayName"), e.opts.autoescape), h += '">\n                    ', h += n.suppressValue(n.memberLookup(s, "displayName"), e.opts.autoescape), h += "\n                    ", n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "tag") && (h += '\n                        <div class="user-name__tag">@', h += n.suppressValue(n.memberLookup(s, "username"), e.opts.autoescape), h += "</div>\n                    "), h += "\n                </div>\n            </div>\n        </a>\n        ", n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "withoutBadge") || (h += '\n            <a class="user-name__flag" href="/plans" target="_blank">\n                ', n.memberLookup(s, "planDetail") ? (h += '\n                    <span class="flag --', h += n.suppressValue(n.memberLookup(n.memberLookup(s, "planDetail"), "badge"), e.opts.autoescape), h += '">', h += n.suppressValue(n.memberLookup(n.memberLookup(s, "planDetail"), "title"), e.opts.autoescape), h += "</span>\n                ") : "basic" != n.memberLookup(s, "account") && (h += '\n                    <span class="flag --', h += n.suppressValue(n.memberLookup(s, "account"), e.opts.autoescape), h += '">', h += n.suppressValue(e.getFilter("badge_label").call(t, n.memberLookup(s, "account")), e.opts.autoescape), h += "</span>\n                "), h += "\n            </a>\n        "), h += "\n    </div>", i = l, new n.SafeString(h)
                                });
                                t.addExport("user_name"), t.setVariable("user_name", f), s += "\n\n";
                                var p = n.makeMacro(["users"], ["options"], function (r, s) {
                                    var u = i;
                                    i = new n.Frame, s = s || {}, s.hasOwnProperty("caller") && i.set("caller", s.caller), i.set("users", r), i.set("options", s.hasOwnProperty("options") ? s.options : {});
                                    var l = "";
                                    l += "\n    ";
                                    var c;
                                    c = e.getFilter("merge").call(t, {
                                        maxDisplayed: 3,
                                        avatarWidth: 18,
                                        avatarHeight: 18
                                    }, n.contextOrFrameLookup(t, i, "options")), i.set("options", c, !0), i.topLevel && t.setVariable("options", c), i.topLevel && t.addExport("options", c), l += "\n    ";
                                    var h;
                                    h = e.getFilter("first_n").call(t, r, n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "maxDisplayed")), i.set("shortList", h, !0), i.topLevel && t.setVariable("shortList", h), i.topLevel && t.addExport("shortList", h), l += '\n    <div class="inline-avatars">\n        ', i = i.push();
                                    var d = n.contextOrFrameLookup(t, i, "shortList");
                                    if (d)
                                        for (var f = d.length, p = 0; p < d.length; p++) {
                                            var m = d[p];
                                            i.set("user", m), i.set("loop.index", p + 1), i.set("loop.index0", p), i.set("loop.revindex", f - p), i.set("loop.revindex0", f - p - 1), i.set("loop.first", 0 === p), i.set("loop.last", p === f - 1), i.set("loop.length", f), l += '\n            <a\n                href="', l += n.suppressValue(n.memberLookup(m, "profileUrl"), e.opts.autoescape), l += '"', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "target") && (l += ' target="', l += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "target"), e.opts.autoescape), l += '" '), l += 'data-action="show-user-summary"\n                data-user="', l += n.suppressValue(n.memberLookup(m, "uid"), e.opts.autoescape), l += '">\n                ', l += n.suppressValue((a = 74, o = 36, n.callWrap(n.contextOrFrameLookup(t, i, "user_name_avatar"), "user_name_avatar", t, [m, n.contextOrFrameLookup(t, i, "options")])), e.opts.autoescape), l += "\n            </a>\n        "
                                        }
                                    return i = i.pop(), l += "\n    </div>\n", i = u, new n.SafeString(l)
                                });
                                t.addExport("user_inline_avatars"), t.setVariable("user_inline_avatars", p), s += "\n\n";
                                var m = n.makeMacro(["authUser", "list"], ["options"], function (r, s, u) {
                                    var l = i;
                                    i = new n.Frame, u = u || {}, u.hasOwnProperty("caller") && i.set("caller", u.caller), i.set("authUser", r), i.set("list", s), i.set("options", u.hasOwnProperty("options") ? u.options : {});
                                    var c, h = "";
                                    c = e.getFilter("merge").call(t, {
                                        maxDisplayed: 3,
                                        othersHref: ""
                                    }, n.contextOrFrameLookup(t, i, "options")), i.set("options", c, !0), i.topLevel && t.setVariable("options", c), i.topLevel && t.addExport("options", c), h += "\n    ";
                                    var d;
                                    if (d = e.getFilter("first_n").call(t, s, n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "maxDisplayed")), i.set("shortList", d, !0), i.topLevel && t.setVariable("shortList", d), i.topLevel && t.addExport("shortList", d), h += "\n    ", n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "totalCount")) {
                                        h += "\n        ";
                                        var f;
                                        f = n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "totalCount") - n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "maxDisplayed"), i.set("otherCount", f, !0), i.topLevel && t.setVariable("otherCount", f), i.topLevel && t.addExport("otherCount", f), h += "\n    "
                                    } else {
                                        h += "\n        ";
                                        var p;
                                        p = e.getFilter("length").call(t, s) - e.getFilter("length").call(t, n.contextOrFrameLookup(t, i, "shortList")), i.set("otherCount", p, !0), i.topLevel && t.setVariable("otherCount", p), i.topLevel && t.addExport("otherCount", p), h += "\n    "
                                    }
                                    h += "\n\n    ", i = i.push();
                                    var m = n.contextOrFrameLookup(t, i, "shortList");
                                    if (m)
                                        for (var g = m.length, v = 0; v < m.length; v++) {
                                            var _ = m[v];
                                            i.set("user", _), i.set("loop.index", v + 1), i.set("loop.index0", v), i.set("loop.revindex", g - v), i.set("loop.revindex0", g - v - 1), i.set("loop.first", 0 === v), i.set("loop.last", v === g - 1), i.set("loop.length", g), n.memberLookup(n.contextOrFrameLookup(t, i, "loop"), "first") || (n.memberLookup(n.contextOrFrameLookup(t, i, "loop"), "last") && n.contextOrFrameLookup(t, i, "otherCount") < 1 ? h += "<span> and </span>" : h += "<span>, </span>"), h += n.suppressValue((a = 101, o = 18, n.callWrap(n.contextOrFrameLookup(t, i, "user_name"), "user_name", t, [r, _, {
                                                withoutBadge: !0
                                            }])), e.opts.autoescape)
                                        }
                                    return i = i.pop(), n.contextOrFrameLookup(t, i, "otherCount") > 0 && (h += "<span> and </span>\n        ", n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "othersHref") || n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "otherAction") ? (h += '\n        <a\n            class="others ', h += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "otherAction") ? "skfb-link" : "", e.opts.autoescape), h += '"\n            ', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "othersHref") && (h += ' href="', h += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "othersHref"), e.opts.autoescape), h += '" '), h += "\n            ", n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "otherAction") && (h += ' data-action="', h += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "otherAction"), e.opts.autoescape), h += '" '), h += ">", h += n.suppressValue(n.contextOrFrameLookup(t, i, "otherCount"), e.opts.autoescape), h += " other", h += n.suppressValue(e.getFilter("pluralize").call(t, n.contextOrFrameLookup(t, i, "otherCount")), e.opts.autoescape), h += "</a>\n        ") : (h += '\n    <span class="others">', h += n.suppressValue(n.contextOrFrameLookup(t, i, "otherCount"), e.opts.autoescape), h += " other", h += n.suppressValue(e.getFilter("pluralize").call(t, n.contextOrFrameLookup(t, i, "otherCount")), e.opts.autoescape), h += "</span>\n        "), h += "\n    "), i = l, new n.SafeString(h)
                                });
                                t.addExport("user_name_list"), t.setVariable("user_name_list", m), s += "\n\n";
                                var g = n.makeMacro(["avatars"], ["options"], function (r, a) {
                                    var o = i;
                                    i = new n.Frame, a = a || {}, a.hasOwnProperty("caller") && i.set("caller", a.caller), i.set("avatars", r), i.set("options", a.hasOwnProperty("options") ? a.options : {});
                                    var s = "";
                                    s += "\n\n    ";
                                    var u;
                                    return u = e.getFilter("merge").call(t, {
                                        size: 32,
                                        expand: !1
                                    }, n.contextOrFrameLookup(t, i, "options")), i.set("options", u, !0), i.topLevel && t.setVariable("options", u), i.topLevel && t.addExport("options", u), s += "\n    ", s += n.suppressValue(e.getFilter("image_container").call(t, r, n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "size"), n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "size"), n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "expand")), e.opts.autoescape), s += "\n\n", i = o, new n.SafeString(s)
                                });
                                t.addExport("user_avatar"), t.setVariable("user_avatar", g), s += "\n\n\n", s += "\n";
                                var v = n.makeMacro(["authUser", "user"], ["options"], function (r, a, o) {
                                    var s = i;
                                    i = new n.Frame, o = o || {}, o.hasOwnProperty("caller") && i.set("caller", o.caller), i.set("authUser", r), i.set("user", a), i.set("options", o.hasOwnProperty("options") ? o.options : {});
                                    var u = "";
                                    return (n.memberLookup(a, "city") || n.memberLookup(a, "country")) && (n.memberLookup(a, "city") && (n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "microData") && (u += '<data itemprop="addressLocality">'), u += n.suppressValue(n.memberLookup(a, "city"), e.opts.autoescape), n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "microData") && (u += "</data>"), n.memberLookup(a, "country") && (u += ",")), u += " ", n.memberLookup(a, "country") && (n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "microData") && (u += '<data itemprop="addressCountry">'), u += n.suppressValue(n.memberLookup(a, "country"), e.opts.autoescape), n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "microData") && (u += "</data>"))), i = s, new n.SafeString(u)
                                });
                                t.addExport("user_location_plaintext"), t.setVariable("user_location_plaintext", v), s += "\n\n";
                                var _ = n.makeMacro(["authUser", "user"], ["options"], function (r, s, u) {
                                    var l = i;
                                    i = new n.Frame, u = u || {}, u.hasOwnProperty("caller") && i.set("caller", u.caller), i.set("authUser", r), i.set("user", s), i.set("options", u.hasOwnProperty("options") ? u.options : {});
                                    var c = "";
                                    if (c += "\n\n    ", "" != (a = 134, o = 31, n.callWrap(n.contextOrFrameLookup(t, i, "user_location_plaintext"), "user_location_plaintext", t, [r, s, n.contextOrFrameLookup(t, i, "options")]))) {
                                        c += "\n\n        ";
                                        var h;
                                        h = e.getFilter("merge").call(t, {
                                            microData: !0
                                        }, n.contextOrFrameLookup(t, i, "options")), i.set("options", h, !0), i.topLevel && t.setVariable("options", h), i.topLevel && t.addExport("options", h), c += '\n\n        <i class="fa fa-map-marker"></i>\n        <data itemprop="homeLocation" itemscope itemtype="http://schema.org/Place">\n            <data itemprop="address" itemscope itemtype="http://schema.org/PostalAddress">\n            ', c += n.suppressValue((a = 141, o = 36, n.callWrap(n.contextOrFrameLookup(t, i, "user_location_plaintext"), "user_location_plaintext", t, [r, s, n.contextOrFrameLookup(t, i, "options")])), e.opts.autoescape), c += "\n            </data>\n        </data>\n    "
                                    }
                                    return c += "\n\n", i = l, new n.SafeString(c)
                                });
                                t.addExport("user_location"), t.setVariable("user_location", _), s += "\n\n";
                                var b = n.makeMacro(["authUser", "user"], ["options"], function (r, s, u) {
                                    var l = i;
                                    i = new n.Frame, u = u || {}, u.hasOwnProperty("caller") && i.set("caller", u.caller), i.set("authUser", r), i.set("user", s), i.set("options", u.hasOwnProperty("options") ? u.options : {});
                                    var c = "";
                                    c += '\n\n    <div class="user">\n        <a href="/', c += n.suppressValue(n.memberLookup(s, "username"), e.opts.autoescape), c += '">\n        ', c += n.suppressValue((a = 152, o = 20, n.callWrap(n.contextOrFrameLookup(t, i, "user_avatar"), "user_avatar", t, [n.memberLookup(s, "avatars"), {
                                        size: 104
                                    }])), e.opts.autoescape), c += '\n        </a>\n        <div class="info">\n            <p class="name" title="', c += n.suppressValue(n.memberLookup(s, "displayName"), e.opts.autoescape), c += '"><a href="/', c += n.suppressValue(n.memberLookup(s, "username"), e.opts.autoescape), c += '">', c += n.suppressValue(n.memberLookup(s, "displayName"), e.opts.autoescape), c += '</a></p>\n            <p class="tagline" title="', c += n.suppressValue(n.memberLookup(s, "tagline"), e.opts.autoescape), c += '"><a href="/', c += n.suppressValue(n.memberLookup(s, "username"), e.opts.autoescape), c += '">', c += n.suppressValue(n.memberLookup(s, "tagline"), e.opts.autoescape), c += "</a></p>\n            ", 0 != n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "followButton") && n.memberLookup(r, "uid") != n.memberLookup(s, "uid") && (c += '\n                <div class="follow-wrapper">\n                    ', c += n.suppressValue((a = 159, o = 34, n.callWrap(n.contextOrFrameLookup(t, i, "follow_button"), "follow_button", t, [r, s])), e.opts.autoescape), c += '\n                    <p class="follow-count"><a href="/', c += n.suppressValue(n.memberLookup(s, "username"), e.opts.autoescape), c += '/followers"><span>', c += n.suppressValue(n.memberLookup(s, "followerCount"), e.opts.autoescape), c += "</span> followers</a></p>\n                </div>\n            "), c += '\n        </div>\n    </div>\n    <div class="models">', i = i.push();
                                    var h = e.getFilter("first_n").call(t, n.memberLookup(s, "thumbnails"), 3);
                                    if (h)
                                        for (var d = h.length, f = 0; f < h.length; f++) {
                                            var p = h[f];
                                            i.set("thumb", p), i.set("loop.index", f + 1), i.set("loop.index0", f), i.set("loop.revindex", d - f), i.set("loop.revindex0", d - f - 1), i.set("loop.first", 0 === f), i.set("loop.last", f === d - 1), i.set("loop.length", d), c += '\n            <a href="', c += n.suppressValue(n.memberLookup(p, "viewerUrl"), e.opts.autoescape), c += '">\n                ', c += n.suppressValue(e.getFilter("image_container").call(t, n.memberLookup(p, "thumbnail"), 133, 88, !1), e.opts.autoescape), c += "\n            </a>\n        "
                                        }
                                    return i = i.pop(), c += '\n    </div>\n    <div class="stats">\n        <p class="model-count">', c += n.suppressValue(n.memberLookup(s, "modelCount"), e.opts.autoescape), c += " model", c += n.suppressValue(e.getFilter("pluralize").call(t, n.memberLookup(s, "modelCount")), e.opts.autoescape), c += '</p>\n        <p class="view-count">', c += n.suppressValue(e.getFilter("humanize_number").call(t, n.memberLookup(n.memberLookup(s, "stats"), "view_count")), e.opts.autoescape), c += " view", c += n.suppressValue(e.getFilter("pluralize").call(t, n.memberLookup(n.memberLookup(s, "stats"), "view_count")), e.opts.autoescape), c += '</p>\n        <p class="like-count">', c += n.suppressValue(e.getFilter("humanize_number").call(t, n.memberLookup(n.memberLookup(s, "stats"), "like_count")), e.opts.autoescape), c += " like", c += n.suppressValue(e.getFilter("pluralize").call(t, n.memberLookup(n.memberLookup(s, "stats"), "like_count")), e.opts.autoescape), c += "</p>\n    </div>\n\n", i = l, new n.SafeString(c)
                                });
                                t.addExport("user_summary"), t.setVariable("user_summary", b), s += "\n\n";
                                var S = n.makeMacro(["authUser", "followSuggestion", "cloaked"], ["options"], function (r, s, u, l) {
                                    var c = i;
                                    i = new n.Frame, l = l || {}, l.hasOwnProperty("caller") && i.set("caller", l.caller), i.set("authUser", r), i.set("followSuggestion", s), i.set("cloaked", u), i.set("options", l.hasOwnProperty("options") ? l.options : {});
                                    var h = "";
                                    return h += "\n\n\n    ", h += n.suppressValue(e.getFilter("image_container").call(t, n.memberLookup(s, "avatars"), 64, 64), e.opts.autoescape), h += '\n\n    <div class="info">\n        <p class="name">', h += n.suppressValue(n.memberLookup(s, "displayName"), e.opts.autoescape), h += '</p>\n        <p class="stats">', h += n.suppressValue(e.getFilter("humanize_number").call(t, n.memberLookup(s, "followerCount")), e.opts.autoescape), h += " follower", h += n.suppressValue(e.getFilter("pluralize").call(t, n.memberLookup(s, "followerCount")), e.opts.autoescape), h += ", ", h += n.suppressValue(e.getFilter("humanize_number").call(t, n.memberLookup(s, "modelCount")), e.opts.autoescape), h += " model", h += n.suppressValue(e.getFilter("pluralize").call(t, n.memberLookup(s, "modelCount")), e.opts.autoescape), h += " </p>\n    </div>\n\n    ", n.memberLookup(r, "uid") != n.memberLookup(s, "uid") && (h += "\n        ", h += n.suppressValue((a = 191, o = 22, n.callWrap(n.contextOrFrameLookup(t, i, "follow_button"), "follow_button", t, [r, s])), e.opts.autoescape), h += "\n    "), h += "\n\n", i = c, new n.SafeString(h)
                                });
                                t.addExport("follow_suggestion_large"), t.setVariable("follow_suggestion_large", S), s += "\n\n";
                                var x = n.makeMacro(["authUser", "user", "cloaked"], ["options"], function (r, s, u, l) {
                                    var c = i;
                                    i = new n.Frame, l = l || {}, l.hasOwnProperty("caller") && i.set("caller", l.caller), i.set("authUser", r), i.set("user", s), i.set("cloaked", u), i.set("options", l.hasOwnProperty("options") ? l.options : {});
                                    var h = "";
                                    return h += '\n\n    <span\n        class="avatar-container"\n        data-action="show-user-summary"\n        data-user="', h += n.suppressValue(n.memberLookup(s, "uid"), e.opts.autoescape), h += '">\n        ', h += n.suppressValue(e.getFilter("image_container").call(t, n.memberLookup(s, "avatars"), 64, 64), e.opts.autoescape), h += '\n    </span>\n\n    <div class="info">\n        <p\n            class="name"\n            data-action="show-user-summary"\n            data-user="', h += n.suppressValue(n.memberLookup(s, "uid"), e.opts.autoescape), h += '"\n            data-user-summary-anchor-class=".avatar-container[data-user=\'', h += n.suppressValue(n.memberLookup(s, "uid"), e.opts.autoescape), h += "']\">\n            ", h += n.suppressValue(n.memberLookup(s, "displayName"), e.opts.autoescape), h += '\n        </p>\n        <p class="stats">', h += n.suppressValue(e.getFilter("humanize_number").call(t, n.memberLookup(s, "followerCount")), e.opts.autoescape), h += " follower", h += n.suppressValue(e.getFilter("pluralize").call(t, n.memberLookup(s, "followerCount")), e.opts.autoescape), h += ", ", h += n.suppressValue(e.getFilter("humanize_number").call(t, n.memberLookup(s, "modelCount")), e.opts.autoescape), h += " model", h += n.suppressValue(e.getFilter("pluralize").call(t, n.memberLookup(s, "modelCount")), e.opts.autoescape), h += " </p>\n    </div>\n\n    ", n.memberLookup(r, "uid") != n.memberLookup(s, "uid") && (h += "\n        ", h += n.suppressValue((a = 217, o = 22, n.callWrap(n.contextOrFrameLookup(t, i, "follow_button"), "follow_button", t, [r, s])), e.opts.autoescape), h += "\n    "), h += '\n\n    <div class="reason">\n        <p>', h += n.suppressValue(e.getFilter("print_suggestion_verb").call(t, n.memberLookup(n.contextOrFrameLookup(t, i, "followSuggestion"), "verb"), n.memberLookup(n.contextOrFrameLookup(t, i, "followSuggestion"), "user")), e.opts.autoescape), h += " ", h += n.suppressValue(e.getFilter("print_suggestion_target").call(t, n.memberLookup(n.contextOrFrameLookup(t, i, "followSuggestion"), "target"), n.memberLookup(n.contextOrFrameLookup(t, i, "followSuggestion"), "verb")), e.opts.autoescape), h += "</p>\n    </div>\n\n", i = c, new n.SafeString(h)
                                });
                                t.addExport("follow_suggestion_reason"), t.setVariable("follow_suggestion_reason", x), s += "\n\n";
                                var y = n.makeMacro(["authUser", "followSuggestion", "cloaked"], ["options"], function (r, s, u, l) {
                                    var c = i;
                                    i = new n.Frame, l = l || {}, l.hasOwnProperty("caller") && i.set("caller", l.caller), i.set("authUser", r), i.set("followSuggestion", s), i.set("cloaked", u), i.set("options", l.hasOwnProperty("options") ? l.options : {});
                                    var h = "";
                                    return h += '\n\n    <li class="follow-item', u && (h += " cloaked"), h += '" data-user="', h += n.suppressValue(n.memberLookup(s, "uid"), e.opts.autoescape), h += '">\n\n        ', h += n.suppressValue((a = 230, o = 18, n.callWrap(n.contextOrFrameLookup(t, i, "user_name"), "user_name", t, [r, s, n.makeKeywordArgs({
                                        options: {
                                            withAvatar: !0,
                                            withSummary: n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "withSummary"),
                                            avatarHeight: 32,
                                            avatarWidth: 32
                                        }
                                    })])), e.opts.autoescape), h += "\n\n        ", n.memberLookup(r, "uid") != n.memberLookup(s, "uid") && (h += "\n\n            ", h += n.suppressValue((a = 239, o = 26, n.callWrap(n.contextOrFrameLookup(t, i, "follow_button"), "follow_button", t, [n.contextOrFrameLookup(t, i, "user"), s])), e.opts.autoescape), h += "\n\n        "), h += "\n\n    </li>\n\n", i = c, new n.SafeString(h)
                                });
                                t.addExport("follow_suggestion"), t.setVariable("follow_suggestion", y), s += "\n\n";
                                var C = n.makeMacro(["authUser", "followSuggestions"], ["options"], function (r, s, u) {
                                    var l = i;
                                    i = new n.Frame, u = u || {}, u.hasOwnProperty("caller") && i.set("caller", u.caller), i.set("authUser", r), i.set("followSuggestions", s), i.set("options", u.hasOwnProperty("options") ? u.options : {});
                                    var c = "";
                                    c += '\n\n    <div class="sidebar-box suggested-follow', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "container_class") && (c += " ", c += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "container_class"), e.opts.autoescape)), c += '">\n        <h5 class="sidebar-title">', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "title") ? c += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "title"), e.opts.autoescape) : c += "Who to follow ", c += "</h5>\n        <ul>\n\n            ";
                                    var h;
                                    if (h = e.getFilter("length").call(t, s), i.set("suggestionsCount", h, !0), i.topLevel && t.setVariable("suggestionsCount", h), i.topLevel && t.addExport("suggestionsCount", h), c += "\n\n            ", n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "maxSuggestions")) {
                                        c += "\n                ";
                                        var d;
                                        d = n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "maxSuggestions"), i.set("max", d, !0), i.topLevel && t.setVariable("max", d), i.topLevel && t.addExport("max", d), c += "\n            "
                                    } else {
                                        c += "\n                ";
                                        var f;
                                        f = n.contextOrFrameLookup(t, i, "suggestionsCount"), i.set("max", f, !0), i.topLevel && t.setVariable("max", f), i.topLevel && t.addExport("max", f), c += "\n            "
                                    }
                                    c += "\n\n            ", i = i.push();
                                    var p = s;
                                    if (p)
                                        for (var m = p.length, g = 0; g < p.length; g++) {
                                            var v = p[g];
                                            i.set("following", v), i.set("loop.index", g + 1), i.set("loop.index0", g), i.set("loop.revindex", m - g), i.set("loop.revindex0", m - g - 1), i.set("loop.first", 0 === g), i.set("loop.last", g === m - 1), i.set("loop.length", m), c += "\n\n                ", c += n.suppressValue((a = 263, o = 34, n.callWrap(n.contextOrFrameLookup(t, i, "follow_suggestion"), "follow_suggestion", t, [r, v, n.memberLookup(n.contextOrFrameLookup(t, i, "loop"), "index") > n.contextOrFrameLookup(t, i, "max"), n.contextOrFrameLookup(t, i, "options")])), e.opts.autoescape), c += "\n\n            "
                                        }
                                    return i = i.pop(), c += '\n        </ul>\n\n        <a href="#" class="show-more" data-action="show-more"><i class="icon fa fa-plus"></i> Show More</i></a>\n\n    </div>\n\n', i = l, new n.SafeString(c)
                                });
                                t.addExport("follow_suggestions"), t.setVariable("follow_suggestions", C), s += "\n", u ? u.rootRenderFunc(e, t, i, n, r) : r(null, s)
                            })
                        })
                    } catch (e) {
                        r(n.handleError(e, a, o))
                    }
                }
                return {
                    root: e
                }
            }()
        }()
}, function (e, t, i) {
    "use strict";
    var n = i(68),
        r = i.n(n),
        a = i(420),
        o = i.n(a),
        s = i(143),
        u = i(22),
        l = i(30),
        c = i(5),
        h = i.n(c),
        d = function (e) {
            return o()(e).reduce(function (e, t) {
                var i = r()(t, 2),
                    n = i[0],
                    a = i[1];
                return Array.isArray(a) ? a.forEach(function (t) {
                    return e.append(n, t)
                }) : e.append(n, a), e
            }, new FormData)
        };
    t.a = function (e) {
        var t = Object(l.a)(function (t) {
                return e.get("/i/users/me/followings" + Object(u.a)("?", {
                    user_uids: t
                }))
            }),
            i = function (e) {
                return t([e]).then(function (t) {
                    return t.results[e]
                })
            },
            n = Object(l.a)(function (t) {
                return e.get("/i/users/me/likes" + Object(u.a)("?", {
                    model_uids: t
                }))
            }),
            r = function (e) {
                return n([e]).then(function (t) {
                    return t.results[e]
                })
            },
            a = Object(l.a)(function (t) {
                return e.get("/i/users/me/upvotes" + Object(u.a)("?", {
                    review_uids: t
                }))
            }),
            o = function (e) {
                return a([e]).then(function (t) {
                    return t.results[e]
                })
            },
            s = Object(l.a)(function (t) {
                return e.get("/i/users/me/purchases" + Object(u.a)("?", {
                    model_uids: t
                }))
            }),
            c = function (e) {
                return s([e]).then(function (t) {
                    return t.results[e]
                })
            },
            f = Object(l.a)(function (t) {
                return e.get("/i/collections/subscribed" + Object(u.a)("?", {
                    uid: t
                }))
            }),
            p = function (e) {
                return f([e]).then(function (t) {
                    return t.results[e]
                })
            },
            m = Object(l.a)(function (t) {
                return e.get("/i/collections/thumbnails" + Object(u.a)("?", {
                    uids: t,
                    count: 4
                }))
            }),
            g = function (e) {
                return m([e]).then(function (t) {
                    return t[e]
                })
            },
            v = Object(l.a)(function (t) {
                return e.get("/i/users/thumbnails" + Object(u.a)("?", {
                    uids: t,
                    count: 2
                }))
            }),
            _ = function (e) {
                return v([e]).then(function (t) {
                    return t[e]
                })
            };
        return {
            login: function (t) {
                var i = t.email,
                    n = t.password,
                    r = t.next;
                return e.post("/login", Object(u.a)({
                    email: i,
                    password: n,
                    next: r
                }))
            },
            logout: function () {
                return e.post("/logout")
            },
            finalizeSignup: function (t) {
                var i = t.email,
                    n = t.username;
                return e.post("/signup/finalize", Object(u.a)({
                    email: i,
                    username: n
                }))
            },
            getCurrentUserFollowings: t,
            doesCurrentUserFollow: i,
            getCurrentUserLikes: n,
            doesCurrentUserLike: r,
            getCurrentUserUpvotes: a,
            hasCurrentUserUpvoted: o,
            getCurrentUserPurchases: s,
            hasCurrentUserPurchased: c,
            getCurrentUserSubscriptions: f,
            hasCurrentUserSubscribed: p,
            getCurrentUserPrivateLimits: function () {
                return e.get("/i/users/me/account", {
                    allowPrefetching: !1
                })
            },
            getCurrentUserReview: function (t) {
                return e.get("/i/users/me/review" + Object(u.a)("?", {
                    model: t
                }))
            },
            getUserByName: function (t) {
                return e.get("/i/users/@" + t)
            },
            getUserSummary: function (t) {
                return e.get("/i/users/" + t + "/summary")
            },
            getUsersThumbnails: v,
            getUserThumbnails: _,
            getSeller: function (t) {
                return e.get("/i/store/sellers/" + t)
            },
            becomeASeller: function () {
                return e.post("/i/store/sellers")
            },
            removeSeller: function (t) {
                return e.delete("/i/store/sellers/" + t)
            },
            followUsers: function (t) {
                return e.post("/i/users/follow", {
                    uids: t
                })
            },
            followUser: function (t) {
                return e.post("/i/users/" + t + "/followers")
            },
            unfollowUser: function (t) {
                return e.delete("/i/users/" + t + "/followers")
            },
            updateUserAvatar: function (t) {
                return e.post("/i/avatars", d({
                    imageFile: t
                }))
            },
            updateCurrentUserEmail: function (t, i) {
                return e.patch("/i/users/me/email", {
                    email: t,
                    password_confirmation: i
                })
            },
            updateCurrentUserPassword: function (t, i) {
                return e.patch("/i/users/me/password", {
                    password: t,
                    password_confirmation: i
                })
            },
            updateUserEmailSettings: function (t, i) {
                return e.patch("/i/users/" + t + "/email_settings", i)
            },
            updateUserUsageType: function (t, i) {
                return e.patch("/i/users/" + t, {
                    usageType: i
                })
            },
            sendAccountConfirmationMail: function (t) {
                var i = t.after;
                return e.get("/i/users/email_confirmation" + Object(u.a)("?", {
                    after: i
                }))
            },
            sendEmailInvitations: function (t) {
                return e.post("/i/invites", {
                    emails: t
                })
            },
            patchAppsSettings: function (t, i) {
                return e.patch("/i/users/" + t + "/apps_settings", i)
            },
            getModelMetadata: function (t, i) {
                var n = i.allowPrefetching;
                return e.get("/i/models/" + t + "/management", {
                    allowPrefetching: n
                })
            },
            getModelStatus: function (t) {
                var i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
                    n = i.allowPrefetching,
                    r = void 0 !== n && n;
                return e.get("/i/models/" + t + "/status", {
                    allowPrefetching: r
                })
            },
            getModelSharing: function (t) {
                return e.get("/i/models/" + t + "/sharing")
            },
            getModelCollections: function (t, i) {
                return e.get("/i/models/" + t + "/collections" + Object(u.a)("?", {
                    uid: i
                }))
            },
            getModelExtraArchive: function (t) {
                return e.get("/i/archives/extra" + Object(u.a)("?", {
                    model: t
                }))
            },
            getModelRatings: function (t) {
                return e.get("/i/models/" + t + "/ratings")
            },
            getModelFallback: function (t) {
                return e.get("/i/models/" + t + "/fallback")
            },
            updateModelExtraArchive: function (t, i) {
                return e.post("/i/archives/extra", d({
                    model: t,
                    extraFile: i
                }))
            },
            removeModelExtraArchive: function (t) {
                return e.delete("/i/archives/extra", d({
                    model: t
                }))
            },
            getModelOwnershipStatus: function (t) {
                var i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
                    n = i.allowPrefetching;
                return e.get("/i/models/" + t + "/download", {
                    allowPrefetching: n
                })
            },
            reprocessModel: function (t) {
                return e.post("/i/models/" + t + "/reprocess")
            },
            duplicateModel: function (t) {
                return e.post("/i/models/" + t + "/duplicate")
            },
            viewModel: function (t) {
                return e.post("/i/models/" + t + "/views")
            },
            likeModel: function (t) {
                return e.post("/i/models/" + t + "/likes")
            },
            unlikeModel: function (t) {
                return e.delete("/i/models/" + t + "/likes")
            },
            publishModel: function (t) {
                return e.patch("/i/models/" + t, {
                    isPublished: !0
                })
            },
            canReviewModel: function (t) {
                return e.get("/i/models/" + t + "/can-review")
            },
            upvoteReview: function (t) {
                return e.post("/i/reviews/" + t + "/upvotes")
            },
            downvoteReview: function (t) {
                return e.delete("/i/reviews/" + t + "/upvotes")
            },
            patchReview: function (t, i) {
                return e.patch("/i/reviews/" + t, i)
            },
            patchAnimation: function (t, i) {
                return e.patch("/i/animations/" + t, i)
            },
            createThumbnail: function (t) {
                var i = t.imageFile,
                    n = t.source,
                    r = t.modelUid;
                return e.post("/i/thumbnails", d({
                    imageFile: i,
                    source: n,
                    modelUid: r
                }))
            },
            getCollectionsThumbnails: m,
            getCollectionThumbnails: g,
            getCollectionSharing: function (t) {
                return e.get("/i/collections/" + t + "/sharing")
            },
            addModelsToCollection: function (t, i) {
                return e.post("/i/collections/" + t + "/models", {
                    models: i
                })
            },
            removeModelsFromCollection: function (t, i) {
                return e.delete("/i/collections/" + t + "/models", {
                    models: i
                })
            },
            subscribeToCollection: function (t) {
                return e.post("/i/collections/" + t + "/subscribe")
            },
            unsubscribeFromCollection: function (t) {
                return e.post("/i/collections/" + t + "/unsubscribe")
            },
            payOrder: function (t, i) {
                return e.post("/i/store/orders/" + t + "/pay", {
                    buyerId: i
                })
            },
            cancelOrder: function (t) {
                return e.post("/i/store/orders/" + t + "/cancel")
            },
            getOrderStatus: function (t) {
                return e.get("/i/store/orders/" + t + "/status", {
                    allowPrefetching: !1
                })
            },
            getCart: function () {
                return e.get("/i/store/cart")
            },
            addModelsToCart: function (t) {
                return e.post("/i/store/cart", {
                    models: t
                })
            },
            removeModelsFromCart: function (t) {
                return e.delete("/i/store/cart", {
                    models: t
                })
            },
            validateCoupon: function (t) {
                return e.get("/i/store/coupons/" + t.toUpperCase() + "/validate")
            },
            getUnseenActivitiesCount: function () {
                return e.get("/i/feeds/unseen", {
                    allowPrefetching: !1
                }).then(function (e) {
                    return e.count
                })
            },
            seeActivities: function () {
                return e.post("/i/feeds/seen")
            },
            readActivities: function (t) {
                return e.post("/i/feeds/read", {
                    uids: t
                })
            },
            getMarkdownPreview: function (t) {
                return t.trim() ? e.post("/i/markdown/preview", {
                    text: t
                }) : h.a.resolve({
                    result: ""
                })
            },
            revokeApp: function (t) {
                return e.post("/oauth2/revoke_app/", Object(u.a)({
                    app_id: t
                }))
            },
            getCsrf: function () {
                return e.get("/i/csrf")
            }
        }
    }(s.a)
}, , , function (e, t, i) {
    "use strict";
    var n, r = i(14),
        a = i(0),
        o = (i.n(a), i(268)),
        s = i.n(o),
        u = i(414),
        l = i(79),
        c = i(22),
        h = i(223),
        d = i(101),
        f = i(4),
        p = function (e) {
            if (null !== e && void 0 !== e) return "+Infinity" === e || "Infinity" === e ? 1 / 0 : "-Infinity" === e ? -1 / 0 : e
        },
        m = function () {
            var e = {};
            for (var t in s.a) {
                var i = s.a[t],
                    n = p(i.defaultValue),
                    r = void 0;
                if (void 0 !== i.alias)
                    for (var o in i.alias)
                        if (void 0 !== (r = c.b[i.type](o))) break;
                e[Object(a.camelCase)(t)] = void 0 !== r ? r : c.b[i.type](t, n)
            }
            return e
        },
        g = function () {
            if (n) return n;
            if (window.prefetchedData.embedOptions) {
                n = window.prefetchedData.embedOptions;
                for (var e in n) n[e] = p(n[e])
            } else n = m();
            try {
                f.a.me().get("isStaff") && void 0 === n.webgl2 && (n.webgl2 = !0)
            } catch (e) {
                console.warn("Prefetching failure while trying to reach User.me(). This is probably because this code has been run in a non web context where prefetchdata are unusable.")
            }
            if (n.apiId = c.b.string("api_id", void 0), n.uiInspector) {
                var t = Object(u.a)();
                n.uiInspector = -1 === r.a.inspectorBlacklist.indexOf(t)
            }
            n.annotationCycleAutostart = void 0 !== n.annotationCycle, n.annotationCycleDuration = 5e3, void 0 !== n.annotationCycle && (n.annotationCycleDuration = 1e3 * n.annotationCycle, delete n.annotationCycle), (n.cardboard || n.annotation || Object(l.a)()) && (n.camera = !1), n.stats && (n.continuousRender = !0), n.processOptions && Object(d.a)(!0), n.processOptions && (n.processMaterial = !0), n.stats && (n.webglTimerGpu = !1);
            var i = !n.apiVersion || "1.1.0" === n.apiVersion,
                a = i && !n.materialShowcase,
                o = !Object(d.a)() && !Object(l.a)() && a;
            if (void 0 === n.mergeMaterials && (n.mergeMaterials = o), void 0 === n.graphOptimizer && (n.graphOptimizer = o), void 0 === n.materialPacking && (n.materialPacking = a), void 0 === n.imageCompression && (n.imageCompression = !Object(l.a)()), n.shadowAtlas = n.shadowAtlas && !Object(l.a)(), void 0 === n.drsMin) {
                var s = Math.max(1, Math.min(1.5, window.devicePixelRatio || 0));
                n.drsMin = 1 / s
            }
            return n.sssKernel % 2 == 0 && n.sssKernel++, n.sssHalfKernel = 1 + (n.sssKernel >> 1), Object(h.a)(n), n.zoct = c.b.bool("zoct", !1), n.zq = c.b.bool("zq", !0), n.zw = c.b.bool("zw", !0), n.zz = c.b.bool("zz", !Object(l.a)()), n.zratio = c.b.number("zratio", 50), void 0 === n.forceTriangles && (n.forceTriangles = -1 !== navigator.userAgent.indexOf("Firefox/62.0")), n
        };
    t.a = g
}, function (e, t) {
    ! function () {
        (window.nunjucksPrecompiled = window.nunjucksPrecompiled || {})["skfb_front/layouts/popup.jinja"] = function () {
            function e(e, t, i, n, r) {
                var a = "";
                try {
                    var o = null;
                    a += '<div class="popup-container', n.contextOrFrameLookup(t, i, "popupNeedsLoading") && (a += " popup-loading"), a += " ", a += n.suppressValue(n.contextOrFrameLookup(t, i, "popupClass"), e.opts.autoescape), a += '">\n    <form class="popup js-popup" method="post"', n.contextOrFrameLookup(t, i, "allowAutocomplete") || (a += ' autocomplete="off"'), a += " ", n.contextOrFrameLookup(t, i, "popupAction") && (a += 'action="', a += n.suppressValue(n.contextOrFrameLookup(t, i, "popupAction"), e.opts.autoescape), a += '"'), a += ">\n\n        ", n.contextOrFrameLookup(t, i, "allowAutocomplete") || (a += "\n            ", a += '\n            <input type="text" style="display:none" />\n            <input type="password" style="display:none" />\n        '), a += '\n\n        <header class="popup-header">\n\n            ', (o ? function (e, t, i, n, r) {
                        r("")
                    } : t.getBlock("popup_header"))(e, t, i, n, function (s, u) {
                        if (s) return void r(s);
                        a += u, a += '\n\n            <div class="popup-actions">\n                ', n.contextOrFrameLookup(t, i, "popupClosable") && (a += '\n                    <a class="popup-close" data-action="close">\n                        <i class="fa fa-times"></i>\n                    </a>\n                '), a += '\n            </div>\n\n        </header>\n\n        <div class="popup-content">\n            ', (o ? function (e, t, i, n, r) {
                            r("")
                        } : t.getBlock("popup_content"))(e, t, i, n, function (s, u) {
                            if (s) return void r(s);
                            a += u, a += "\n        </div>\n\n        ", e.getFilter("default").call(t, n.contextOrFrameLookup(t, i, "withFooter"), !0) && (a += '\n            <footer class="popup-footer">\n                ', (o ? function (e, t, i, n, r) {
                                r("")
                            } : t.getBlock("popup_footer"))(e, t, i, n, function (e, t) {
                                if (e) return void r(e);
                                a += t, a += "\n            </footer>\n        "
                            })), a += "\n\n    </form>\n\n</div>\n", o ? o.rootRenderFunc(e, t, i, n, r) : r(null, a)
                        })
                    })
                } catch (e) {
                    r(n.handleError(e, null, null))
                }
            }

            function t(e, t, i, n, r) {
                var a = "";
                try {
                    var i = i.push(!0);
                    a += '\n                <div class="popup-title">\n                    ', a += n.suppressValue(n.contextOrFrameLookup(t, i, "popupTitle"), e.opts.autoescape), a += "\n                </div>\n            ", r(null, a)
                } catch (e) {
                    r(n.handleError(e, null, null))
                }
            }

            function i(e, t, i, n, r) {
                var a = "";
                try {
                    var i = i.push(!0);
                    a += "\n            ", r(null, a)
                } catch (e) {
                    r(n.handleError(e, null, null))
                }
            }

            function n(e, t, i, n, r) {
                var a = "";
                try {
                    var i = i.push(!0);
                    a += "\n                ", r(null, a)
                } catch (e) {
                    r(n.handleError(e, null, null))
                }
            }
            return {
                b_popup_header: t,
                b_popup_content: i,
                b_popup_footer: n,
                root: e
            }
        }()
    }()
}, function (e, t, i) {
    "use strict";

    function n(e) {
        return "cursor" === e || "page" === e
    }

    function r(e, t) {
        arguments.length < 2 && (t = e, e = ""), t = Object(v.a)(t);
        var i = p()(t).sort(function (e, t) {
            return n(e) ? 1 : n(t) ? -1 : e === t ? 0 : e < t ? -1 : 1
        }).map(function (e) {
            return t[e].filter(function (e) {
                return null !== e && void 0 !== e && "" !== e
            }).map(function (t) {
                return !0 !== t && !1 !== t || (t = Number(t)), [e, t].map(function (e) {
                    return encodeURIComponent(e).replace(/%20/g, "+").replace(/%25/g, "%").replace(/%2C/g, ",")
                }).join("=")
            }).join("&")
        }).filter(function (e) {
            return e.length > 0
        }).join("&");
        return i ? e + i : ""
    }

    function a() {
        return Array.prototype.slice.call(arguments).map(v.a).reduce(function (e, t) {
            return p()(t).forEach(function (i, n) {
                e[n] = (e[n] || []).concat(t[n])
            }), e
        }, {})
    }

    function o() {
        return Array.prototype.slice.call(arguments).map(v.a).reduce(function (e, t) {
            return Object(m.assign)(e, t)
        }, {})
    }

    function s(e) {
        var t = window.location.search.substr(1);
        return Object(v.a)(t)[e] || []
    }

    function u(e, t) {
        var i = s(e) || [];
        return i.length ? i.pop() : void 0 !== t ? t.toString() : void 0
    }

    function l(e, t) {
        var i = u(e);
        return void 0 === i ? void 0 !== t ? Boolean(t) : void 0 : "0" !== i
    }

    function c(e, t) {
        var i = t || [],
            n = u(e, ""),
            r = i.reduce(function (e, t) {
                return e[t] = !1, e
            }, {});
        return n.split(" ").map(g.k).reduce(function (e, t) {
            return e[t] = !0, e
        }, r)
    }

    function h(e, t) {
        var i = u(e);
        return void 0 === i ? void 0 !== t ? Number(t) : void 0 : Number(i)
    }

    function d(e, t) {
        var i = u(e);
        if (!i) return t;
        if (i = i.split(","), i.length < 3) return t;
        i.length = 3;
        for (var n = 0; n < 3; ++n) i[n] = parseFloat(i[n]);
        return i
    }
    t.a = r;
    var f = i(26),
        p = i.n(f),
        m = i(0),
        g = (i.n(m), i(67)),
        v = i(100);
    t.b = {
        craft: r,
        merge: a,
        features: c,
        reset: o,
        strings: s,
        string: u,
        bool: l,
        number: h,
        vec3: d
    }
}, function (e, t, i) {
    "use strict";

    function n(e, t) {
        return p()(e).reduce(function (i, n) {
            return d()({}, i, t(e[n], n))
        }, {})
    }

    function r(e, t) {
        return n(e, function (e, i) {
            return t(e, i) ? c()({}, i, e) : {}
        })
    }

    function a(e) {
        return r(e, function (e) {
            return void 0 !== e && null !== e && "" !== e
        })
    }

    function o(e) {
        return r(e, function (e) {
            return void 0 !== e
        })
    }

    function s(e, t) {
        return function () {
            return d()({}, e.call(this), t.call(this))
        }
    }

    function u(e, t) {
        for (var i in e)
            if (!(i in t) || e[i] !== t[i]) return !1;
        for (var n in t)
            if (!(n in e) || e[n] !== t[n]) return !1;
        return !0
    }
    t.c = n, i.d(t, "f", function () {
        return g
    }), t.b = a, t.a = o, t.e = s, t.d = u;
    var l = i(40),
        c = i.n(l),
        h = i(7),
        d = i.n(h),
        f = i(26),
        p = i.n(f),
        m = i(0),
        g = (i.n(m), Object(m.curry)(function (e, t) {
            return t[e]
        }))
}, , function (e, t, i) {
    "use strict";
    i.d(t, "c", function () {
        return b
    }), i.d(t, "e", function () {
        return S
    }), i.d(t, "a", function () {
        return x
    }), i.d(t, "d", function () {
        return y
    }), i.d(t, "b", function () {
        return C
    }), i.d(t, "f", function () {
        return T
    }), i.d(t, "g", function () {
        return w
    });
    var n = i(337),
        r = i.n(n),
        a = i(338),
        o = i.n(a),
        s = i(131),
        u = i.n(s),
        l = i(430),
        c = i.n(l),
        h = i(123),
        d = i.n(h),
        f = i(89),
        p = i.n(f),
        m = i(128),
        g = i.n(m),
        v = i(129),
        _ = i.n(v),
        b = function (e) {
            function t(e, i, n, r) {
                p()(this, t);
                var a = g()(this, (t.__proto__ || d()(t)).call(this, e));
                return a.feature = i, a.limitReached = n, a.account = r, a
            }
            return _()(t, e), t
        }(function (e) {
            function t() {
                var t = c()(e, u()(arguments));
                return o()(t, d()(this)), t
            }
            return t.prototype = r()(e.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), o.a ? o()(t, e) : t.__proto__ = e, t
        }(Error)),
        S = function (e) {
            function t() {
                return p()(this, t), g()(this, (t.__proto__ || d()(t)).apply(this, arguments))
            }
            return _()(t, e), t
        }(function (e) {
            function t() {
                var t = c()(e, u()(arguments));
                return o()(t, d()(this)), t
            }
            return t.prototype = r()(e.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), o.a ? o()(t, e) : t.__proto__ = e, t
        }(Error)),
        x = function (e) {
            function t() {
                return p()(this, t), g()(this, (t.__proto__ || d()(t)).apply(this, arguments))
            }
            return _()(t, e), t
        }(function (e) {
            function t() {
                var t = c()(e, u()(arguments));
                return o()(t, d()(this)), t
            }
            return t.prototype = r()(e.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), o.a ? o()(t, e) : t.__proto__ = e, t
        }(Error)),
        y = function (e) {
            function t() {
                return p()(this, t), g()(this, (t.__proto__ || d()(t)).apply(this, arguments))
            }
            return _()(t, e), t
        }(function (e) {
            function t() {
                var t = c()(e, u()(arguments));
                return o()(t, d()(this)), t
            }
            return t.prototype = r()(e.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), o.a ? o()(t, e) : t.__proto__ = e, t
        }(Error)),
        C = function (e) {
            function t() {
                return p()(this, t), g()(this, (t.__proto__ || d()(t)).apply(this, arguments))
            }
            return _()(t, e), t
        }(function (e) {
            function t() {
                var t = c()(e, u()(arguments));
                return o()(t, d()(this)), t
            }
            return t.prototype = r()(e.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), o.a ? o()(t, e) : t.__proto__ = e, t
        }(Error)),
        T = function (e, t) {
            return function (i) {
                if (i instanceof e) return t(i);
                throw i
            }
        },
        w = function (e) {
            return function (t) {
                if (!(t instanceof e)) throw t
            }
        }
}, , , function (e, t, i) {
    "use strict";
    i.d(t, "b", function () {
        return h
    }), i.d(t, "g", function () {
        return d
    }), i.d(t, "e", function () {
        return f
    }), i.d(t, "i", function () {
        return m
    }), i.d(t, "h", function () {
        return g
    }), i.d(t, "f", function () {
        return v
    }), i.d(t, "c", function () {
        return _
    }), i.d(t, "d", function () {
        return b
    }), i.d(t, "j", function () {
        return C
    }), i.d(t, "k", function () {
        return T
    }), i.d(t, "a", function () {
        return w
    }), i.d(t, "l", function () {
        return M
    });
    var n = i(3),
        r = i.n(n),
        a = i(0),
        o = (i.n(a), i(141)),
        s = i(30),
        u = i(67),
        l = i(5),
        c = i.n(l),
        h = function (e) {
            var t = e.getBoundingClientRect(),
                i = {
                    x: t.left + t.width / 2,
                    y: t.top + t.height / 2
                },
                n = {
                    y: (window.innerHeight || document.documentElement.clientHeight) / 2,
                    x: (window.innerWidth || document.documentElement.clientWidth) / 2
                };
            return i.x - n.x + (i.y - n.y)
        },
        d = function (e) {
            var t = e.getBoundingClientRect();
            return t.top >= 0 - t.height && t.left >= 0 && t.bottom <= window.innerHeight + t.height && t.right <= window.innerWidth
        },
        f = function (e, t) {
            return Object(a.includes)(Object(o.b)(r()(t).parents()), e)
        },
        p = function (e) {
            var t = e.getBoundingClientRect(),
                i = document.body,
                n = document.documentElement,
                r = window.pageYOffset || n.scrollTop || i.scrollTop,
                a = window.pageXOffset || n.scrollLeft || i.scrollLeft,
                o = n.clientTop || i.clientTop || 0,
                s = n.clientLeft || i.clientLeft || 0,
                u = Math.round(t.top + r - o),
                l = Math.round(t.left + a - s);
            return {
                top: u,
                left: l,
                bottom: u + t.height,
                right: l + t.width
            }
        },
        m = function (e) {
            return new c.a(function (t, i) {
                var n = new Image;
                n.onload = function () {
                    return t(n)
                }, n.onerror = i, n.src = e, n.complete && t(n)
            })
        },
        g = function (e) {
            return m(e).catch(s.d)
        },
        v = function (e) {
            var t = new Image;
            return t.src = e, t.complete && 0 !== t.naturalHeight
        },
        _ = function (e, t, i) {
            var n = document.createElementNS("http://www.w3.org/2000/svg", "svg");
            return n.setAttribute("width", t), n.setAttribute("height", i), n.innerHTML = '\n        <foreignObject\n            x="0"\n            y="0"\n            width="' + t + '"\n            height="' + i + '">\n            <div xmlns="http://www.w3.org/1999/xhtml">\n                ' + e + "\n            </div>\n        </foreignObject>\n    ", n
        },
        b = function (e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : "image/png",
                i = document.createElement("canvas");
            i.setAttribute("width", 2 * e.width), i.setAttribute("height", 2 * e.height);
            var n = i.getContext("2d");
            return n.scale(2, 2), n.fillStyle = "#fff", n.fillRect(0, 0, i.width, i.height), n.drawImage(e, 0, 0), i.toDataURL(t)
        },
        S = function (e, t) {
            var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                n = i.margin,
                r = void 0 === n ? 20 : n,
                a = !1;
            new window.IntersectionObserver(function (e) {
                e.forEach(function (e) {
                    var i = e.intersectionRatio > 0;
                    i !== a && t(i), a = i
                })
            }, {
                threshold: [0, 1],
                rootMargin: r + "px"
            }).observe(e)
        },
        x = function () {
            var e = [],
                t = Object(a.throttle)(function (t) {
                    return e.forEach(function (e) {
                        return e(t)
                    })
                }, 30),
                i = function () {
                    window.addEventListener("scroll", t)
                },
                n = function () {
                    window.removeEventListener("scroll", t)
                };
            return {
                listen: function (t) {
                    return e.push(t), 1 === e.length && i(),
                        function () {
                            e = e.filter(function (e) {
                                return e !== t
                            }), e.length || n()
                        }
                }
            }
        }(),
        y = function (e, t) {
            var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                n = i.margin,
                r = void 0 === n ? 20 : n,
                a = p(e),
                o = a.top,
                s = a.bottom,
                u = !1,
                l = function () {
                    var e = document.scrollingElement.scrollTop + window.innerHeight + r >= o && document.scrollingElement.scrollTop - r < s;
                    e !== u && t(e), u = e
                };
            x.listen(l), l()
        },
        C = function () {
            "IntersectionObserver" in window ? S.apply(void 0, arguments) : y.apply(void 0, arguments)
        },
        T = function (e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : "string",
                i = void 0,
                n = void 0;
            if (!(i = document.getElementById("js-dom-data-" + e))) return null;
            if (n = Object(a.unescape)(Object(u.b)((i.innerHTML || "").trim())), "json" === t) try {
                return JSON.parse(n)
            } catch (e) {
                console.warn("Failed to JSON decode DOM data."), console.warn(e)
            }
            return n
        },
        w = function (e, t, i, n) {
            Object(a.isFunction)(e.on) ? e.on(t, i) : Object(a.isFunction)(e.addEventListener) && e.addEventListener(t, i, n)
        },
        M = function (e, t, i, n) {
            Object(a.isFunction)(e.off) ? e.off(t, i) : Object(a.isFunction)(e.removeEventListener) && e.removeEventListener(t, i, n)
        };
    Object(a.memoize)(function () {
        return !0 === window.__IS_JSDOM__
    })
}, function (e, t, i) {
    "use strict";
    var n = i(3),
        r = i.n(n),
        a = i(5),
        o = i.n(a),
        s = i(0),
        u = (i.n(s), i(8)),
        l = i(25),
        c = i(86),
        h = i(33),
        d = i(1),
        f = i(106),
        p = [];
    t.a = u.a.extend({
        parent: "body",
        el: '<div data-element="popup" />',
        optionTypes: {
            cleanOnClose: d.b.bool,
            shouldExitOnClickOutside: d.b.bool,
            shouldRejectOnCancel: d.b.bool
        },
        defaultOptions: {
            cleanOnClose: !0,
            shouldExitOnClickOutside: !0,
            shouldRejectOnCancel: !1
        },
        events: {
            "click .popup-container": "onClickOutside",
            'click [data-action="close"]': "cancel",
            "click button:not([type])": h.e
        },
        constructor: function () {
            this.onKeyDown = this.onKeyDown.bind(this), this.debouncedCenter = Object(s.debounce)(this.center, 50), this.resizeHandler = function () {
                r.a.each(p, function (e, t) {
                    t.debouncedCenter()
                })
            }.bind(this), u.a.apply(this, arguments)
        },
        initialize: function () {
            u.a.prototype.initialize.apply(this, arguments), this.renderLayout()
        },
        setElement: function () {
            return u.a.prototype.setElement.apply(this, arguments), this.$container = this.$(".popup-container"), this
        },
        delegateEvents: function () {
            u.a.prototype.delegateEvents.apply(this, arguments), r()(window).on("resize", this.resizeHandler), document.addEventListener("keydown", this.onKeyDown, !0)
        },
        undelegateEvents: function () {
            u.a.prototype.undelegateEvents.apply(this, arguments), r()(window).off("resize", this.resizeHandler), document.removeEventListener("keydown", this.onKeyDown, !0)
        },
        getPromise: function () {
            return this._promise || (this._promise = new c.a), this._promise
        },
        open: function () {
            return -1 !== p.indexOf(this) ? (this.show(), this.setElement(this.$el), this.getPromise()) : (this.render(), p.unshift(this), r()(Object(s.result)(this, "parent")).append(this.$el), this.setElement(this.$el), this.hide(), this.center(), window.requestAnimationFrame(function () {
                this.show()
            }.bind(this)), this.autofocus(), this.center(), this.getPromise())
        },
        show: function () {
            this.$container.removeClass("hidden"), document.body.classList.add("--prevent-scroll")
        },
        hide: function () {
            this.$container.addClass("hidden"), p.length || document.body.classList.remove("--prevent-scroll")
        },
        setIsLoading: function (e) {
            this.$container.toggleClass("popup-loading", e)
        },
        isHidden: function () {
            return this.$container.hasClass("hidden")
        },
        onKeyDown: function (e) {
            27 === e.keyCode && 0 !== p.length && this.cancel()
        },
        onClickOutside: function (e) {
            e.target === e.currentTarget && this.options.shouldExitOnClickOutside && this.cancel()
        },
        cancel: function (e) {
            return this._close(), this.options.shouldRejectOnCancel ? this.getPromise().reject(new l.e(e)) : this.getPromise().resolve()
        },
        continue: function (e) {
            return this._close(), this.getPromise().resolve(e)
        },
        _close: function (e, t) {
            return -1 === p.indexOf(this) ? this : this.$container.closest(".inline-popup").length > 0 ? this : this.options.cleanOnClose || t ? (-1 !== p.indexOf(this) && p.splice(p.indexOf(this), 1), this.hide(), Object(f.a)(this.$el).timeout(500).catch(function () {}).then(this.remove.bind(this))) : (this.hide(), o.a.resolve())
        },
        close: function (e) {
            return this._close(null, e)
        },
        replaceWith: function (e, t) {
            return this.close(t), e.open()
        },
        center: function () {
            var e = this.$(".js-popup"),
                t = r()(window).width(),
                i = r()(window).height(),
                n = e.height(),
                a = e.width(),
                o = (t - a) / 2,
                s = i / 2 - n / 2 + (n < i ? 0 : (n - i) / 2 + 40);
            e.css({
                position: "absolute",
                left: o + "px",
                top: s
            });
            var u = o + a / 2 + "px",
                l = s + n / 2 + "px",
                c = u + " " + l;
            this.$container.css({
                perspectiveOrigin: c
            })
        },
        resize: function (e) {
            var t = this.$(".js-popup");
            return e.width && t.width(e.width), e.height && t.height(e.height), this
        },
        autofocus: function () {
            var e = window.scrollX,
                t = window.scrollY;
            this.$(".form-input:visible").length > 0 ? (this.$(".form-input").eq(0).focus(), window.scrollTo(e, t)) : (this.$(".btn-primary, .submit").focus(), window.scrollTo(e, t))
        },
        _removeElement: function () {
            this.$el.remove()
        },
        remove: function () {
            return this.undelegateEvents(), u.a.prototype.remove.apply(this, arguments)
        },
        renderLayout: function () {
            this.$el.html(this.template()), this.$container = this.$(".popup-container")
        },
        afterRender: function () {
            u.a.prototype.afterRender.apply(this, arguments), this.renderChildren(), this.center()
        }
    })
}, function (e, t, i) {
    "use strict";

    function n(e) {
        return e
    }

    function r() {
        return Array.prototype.slice.call(arguments).reduce(function (e, t) {
            return function () {
                return e(t.apply(t, arguments))
            }
        }, n)
    }

    function a(e) {
        return Object(l.isFunction)(e) ? e : Object(l.constant)(e)
    }

    function o() {}
    t.c = n, t.b = r, t.g = a, t.d = o, i.d(t, "e", function () {
        return h
    }), i.d(t, "f", function () {
        return d
    }), i.d(t, "a", function () {
        return f
    });
    var s = i(54),
        u = i.n(s),
        l = i(0),
        c = (i.n(l), i(35)),
        h = function (e) {
            var t = !0,
                i = [];
            return function () {
                for (var n = arguments.length, r = Array(n), a = 0; a < n; a++) r[a] = arguments[a];
                i = r, t && (t = !1, window.requestAnimationFrame(function () {
                    t = !0, e.apply(void 0, u()(i))
                }))
            }
        },
        d = Object(l.curry)(function (e, t, i) {
            var n = t;
            return function (t) {
                return n = e(n, t), i(n)
            }
        }),
        f = function (e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 50,
                i = [],
                n = Object(c.b)(function () {
                    var t = [].concat(u()(i));
                    return i = [], e(t)
                }, t);
            return function (e) {
                return i = Object(l.uniq)(i.concat(e)), n()
            }
        }
}, , , function (e, t, i) {
    "use strict";

    function n(e) {
        return e.preventDefault(), e
    }

    function r(e) {
        return e.stopPropagation(), e
    }

    function a(e) {
        return {
            eventName: e.split(" ")[0],
            selector: e.split(" ").slice(1).join(" ")
        }
    }

    function o(e) {
        var t = e.originalEvent || e;
        return {
            x: t.type.match(/^touch/) ? t.changedTouches[0] ? t.changedTouches[0].pageX : 0 : t.clientX,
            y: t.type.match(/^touch/) ? t.changedTouches[0] ? t.changedTouches[0].pageY : 0 : t.clientY
        }
    }

    function s(e, t) {
        var i = o(t),
            n = e ? o(e) : i;
        return {
            x: i.x - n.x,
            y: i.y - n.y
        }
    }

    function u(e, t) {
        return t.velocity = s(e, t), t
    }
    t.e = n, t.f = r, t.d = a, t.c = o, t.a = u, i.d(t, "b", function () {
        return d
    });
    var l = i(0),
        c = (i.n(l), function (e) {
            var t = o(e),
                i = t.x,
                n = t.y;
            return e.dragX = i, e.dragY = n, e
        }),
        h = function (e, t, i) {
            return function (n) {
                var r = Object(l.throttle)(function (e) {
                        return i.onDrag(c(e))
                    }, 16),
                    a = function n(a) {
                        window.removeEventListener(e, r), window.removeEventListener(t, n), i.onDragEnd(c(a))
                    };
                window.addEventListener(e, r), window.addEventListener(t, a), i.onDragStart(c(n))
            }
        },
        d = function () {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
                t = e.onDrag,
                i = e.onDragStart,
                n = void 0 === i ? function (e) {
                    return e
                } : i,
                r = e.onDragEnd,
                a = void 0 === r ? function (e) {
                    return e
                } : r;
            return {
                onMouseDown: h("mousemove", "mouseup", {
                    onDrag: t,
                    onDragStart: n,
                    onDragEnd: a
                }),
                onTouchStart: h("touchmove", "touchend", {
                    onDrag: t,
                    onDragStart: n,
                    onDragEnd: a
                })
            }
        }
}, function (e, t, i) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: !0
    });
    var n = i(2),
        r = i(29),
        a = i(1),
        o = i(153);
    i.n(o);
    t.default = r.a.extend({
        displayName: "MessagePopup",
        optionTypes: {
            title: a.b.string.isRequired,
            text: a.b.string.isRequired,
            buttons: a.b.shape({
                cancel: a.b.bool,
                cancelClass: a.b.string,
                cancelLabel: a.b.string,
                close: a.b.bool,
                closeClass: a.b.string,
                closeLabel: a.b.string,
                continue: a.b.bool,
                continueClass: a.b.string,
                continueLabel: a.b.string,
                ok: a.b.bool,
                okClass: a.b.string,
                okLabel: a.b.string,
                delete: a.b.bool,
                deleteClass: a.b.string,
                deleteLabel: a.b.string
            }),
            popupClass: a.b.string,
            safe: a.b.bool,
            popupClosable: a.b.bool,
            shouldRejectOnCancel: a.b.bool
        },
        defaultOptions: {
            shouldRejectOnCancel: !0
        },
        events: {
            "reset form": "cancel",
            "submit form": "continue"
        },
        template: function () {
            return n.default.get("skfb_front/popups/message", {
                title: this.options.title,
                text: this.options.text,
                buttons: this.options.buttons,
                safe: this.options.safe,
                popupClass: this.options.popupClass,
                popupClosable: this.options.popupClosable
            })
        }
    })
}, function (e, t, i) {
    "use strict";

    function n(e, t, i) {
        var r = Object(o.extend)({
            interval: 1e3,
            prevInterval: 1e3
        }, Object(c.a)(i));
        return t().catch(function (i) {
            var a = "function" == typeof r.interval ? r.interval(r.prevInterval) : r.interval;
            return e > 0 ? u.a.delay(a).then(function () {
                return n(e - 1, t, Object(o.extend)({}, r, {
                    prevInterval: a
                }))
            }) : u.a.reject(i)
        })
    }
    t.d = n, i.d(t, "c", function () {
        return d
    }), i.d(t, "a", function () {
        return f
    }), i.d(t, "b", function () {
        return p
    });
    var r = i(54),
        a = i.n(r),
        o = i(0),
        s = (i.n(o), i(5)),
        u = i.n(s),
        l = i(86),
        c = i(23),
        h = i(25),
        d = function (e) {
            var t = void 0;
            return function () {
                return t || (t = e.apply(void 0, arguments), t.then(function (e) {
                    return t = void 0, e
                }).catch(function (e) {
                    throw t = void 0, e
                }))
            }
        },
        f = function (e) {
            var t = void 0,
                i = new u.a(function (i, n) {
                    t = n, e.then(i).catch(n)
                });
            return i.cancel = function () {
                return t(new h.a)
            }, i
        },
        p = function (e, t) {
            var i = new l.a,
                n = Object(o.debounce)(function (t) {
                    var n = e.apply(void 0, a()(t));
                    i.resolve(n), i = new l.a
                }, t),
                r = function () {
                    for (var e = arguments.length, t = Array(e), r = 0; r < e; r++) t[r] = arguments[r];
                    return n(t), i
                };
            return r.cancel = function () {
                return n.cancel()
            }, r
        }
}, function (e, t, i) {
    "use strict";

    function n() {
        var e = arguments[0];
        if (u.console && !(e > u.currentNotifyLevel)) {
            var t = arguments[1],
                i = Array.prototype.slice.call(arguments);
            i = i.splice(2, arguments.length), u.console[t].apply(u.console, i), u.traceLogCall && e !== u.ERROR && console.trace()
        }
    }

    function r(e, t, i, n) {
        !u.console || e > u.currentNotifyLevel || (u.console.groupCollapsed && u.console.groupCollapsed(i), u.console[t](n), u.traceLogCall && e !== u.ERROR && console.trace(), u.console.groupEnd && u.console.groupEnd())
    }

    function a(e, t) {
        return t ? [e.slice(0, 4), e.slice(4, 8), e.slice(8, 12), e.slice(12, 16)] : [
            [e[0], e[4], e[8], e[12]],
            [e[1], e[5], e[9], e[13]],
            [e[2], e[6], e[10], e[14]],
            [e[3], e[7], e[11], e[15]]
        ]
    }

    function o(e, t, i) {
        e > u.currentNotifyLevel || u.console.table && n("table", a(t, i))
    }

    function s(e, t, i, n) {
        e > u.currentNotifyLevel || u.console.table && r("table", t, a(i, n))
    }
    var u = {};
    u.ALWAYS = 0, u.FATAL = u.ERROR = 1, u.WARN = 2, u.NOTICE = u.LOG = 3, u.INFO = 4, u.DEBUG = 5, u.currentNotifyLevel = u.LOG, u.console = window.console;
    for (var l = ["error", "warn", "log", "info", "debug"], c = 0; c < l.length; ++c) {
        var h = l[c],
            d = u[h.toUpperCase()];
        u[h] = n.bind(u, d, h), u[h + "Fold"] = r.bind(u, d, h), u[h + "Matrix"] = o.bind(u, d), u[h + "MatrixFold"] = s.bind(u, d)
    }
    u.group = n.bind(u, u.LOG, "group"), u.groupCollapsed = n.bind(u, u.LOG, "groupCollapsed"), u.groupEnd = u.console.groupEnd, u.notice = u.log, u.noticeFold = u.logFold, u.noticeMatrix = u.logMatrix, u.noticeMatrixFold = u.logMatrixFold, u.timeStamp = function () {}, u.assert = function (e, t) {
        void 0 === this.console || e || this.console.assert(e, t)
    }, u.setNotifyLevel = function (e, t) {
        u.currentNotifyLevel = e, void 0 !== t && (u.traceLogCall = t)
    }, u.getNotifyLevel = function () {
        return u.currentNotifyLevel
    }, u.reportWebGLError = !1, u.setConsole = function (e) {
        u.console = e
    }, t.a = u
}, function (e, t, i) {
    i(127),
        function () {
            (window.nunjucksPrecompiled = window.nunjucksPrecompiled || {})["skfb_front/macros/buttons.jinja"] = function () {
                function e(e, t, i, n, r) {
                    var a = null,
                        o = null,
                        s = "";
                    try {
                        var u = null;
                        e.getTemplate("skfb_front/macros/popovers.jinja", !1, "skfb_front/macros/buttons.jinja", !1, function (l, c) {
                            if (l) return void r(l);
                            c.getExported(function (l, c) {
                                if (l) return void r(l);
                                if (!c.hasOwnProperty("share_popover")) return void r(new Error("cannot import 'share_popover'"));
                                var h = c.share_popover;
                                t.setVariable("share_popover", h), s += "\n\n";
                                var d = n.makeMacro(["authUser", "user"], ["options"], function (t, r, a) {
                                    var o = i;
                                    i = new n.Frame, a = a || {}, a.hasOwnProperty("caller") && i.set("caller", a.caller), i.set("authUser", t), i.set("user", r), i.set("options", a.hasOwnProperty("options") ? a.options : {});
                                    var s = "";
                                    return s += '\n\n    <span class="toggle-button follow-user-button btn-loading" data-action="follow" data-user="', s += n.suppressValue(n.memberLookup(r, "uid"), e.opts.autoescape), s += '">\n        <a class="button btn-primary toggle btn-disabled">\n            <i class="icon fa fa-plus"></i>\n            Follow\n        </a>\n        <a class="button btn-important untoggle">\n            <span class="toggled">\n                Following\n            </span>\n            <span class="untoggled">\n                Unfollow\n            </span>\n        </a>\n    </span>\n\n', i = o, new n.SafeString(s)
                                });
                                t.addExport("follow_button"), t.setVariable("follow_button", d), s += "\n\n";
                                var f = n.makeMacro(["authUser"], ["options"], function (r, s) {
                                    var u = i;
                                    i = new n.Frame, s = s || {}, s.hasOwnProperty("caller") && i.set("caller", s.caller), i.set("authUser", r), i.set("options", s.hasOwnProperty("options") ? s.options : {});
                                    var l = "";
                                    return l += '\n\n    <div class="button btn-medium btn-secondary btn-loading like like-button popover-container btn-disabled" data-action="like-model">\n        <i class="icon fa fa-star"></i>\n        Like\n        ', n.memberLookup(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "popover"), "display") && (l += "\n            ", l += n.suppressValue((a = 27, o = 26, n.callWrap(n.contextOrFrameLookup(t, i, "share_popover"), "share_popover", t, [{
                                        class: n.memberLookup(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "popover"), "arrow")
                                    }])), e.opts.autoescape), l += "\n        "), l += "\n    </div>\n\n", i = u, new n.SafeString(l)
                                });
                                t.addExport("like_button"), t.setVariable("like_button", f), s += "\n\n";
                                var p = n.makeMacro(["authUser"], ["options"], function (r, s) {
                                    var u = i;
                                    i = new n.Frame, s = s || {}, s.hasOwnProperty("caller") && i.set("caller", s.caller), i.set("authUser", r), i.set("options", s.hasOwnProperty("options") ? s.options : {});
                                    var l = "";
                                    return l += '\n\n    <div class="help like-button star-like-button btn-loading popover-container', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "buttonClass") && (l += " ", l += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "buttonClass"), e.opts.autoescape)), l += '" data-action="like-model">\n        ', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "count") && n.memberLookup(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "count"), "display") && (l += '\n            <span class="count">', l += n.suppressValue(n.memberLookup(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "count"), "like"), e.opts.autoescape), l += "</span>\n        "), l += '\n        <span class="tooltip liked-content', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "tooltipClass") ? (l += " ", l += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "tooltipClass"), e.opts.autoescape)) : l += " tooltip-down", l += '">Like</span>\n        <span class="tooltip unliked-content', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "tooltipClass") ? (l += " ", l += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "tooltipClass"), e.opts.autoescape)) : l += " tooltip-down", l += '">Unlike</span>\n        ', n.memberLookup(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "popover"), "display") && (l += "\n            ", l += n.suppressValue((a = 42, o = 26, n.callWrap(n.contextOrFrameLookup(t, i, "share_popover"), "share_popover", t, [{
                                        class: n.memberLookup(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "popover"), "arrow")
                                    }])), e.opts.autoescape), l += "\n        "), l += "\n    </div>\n\n", i = u, new n.SafeString(l)
                                });
                                t.addExport("star_like_button"), t.setVariable("star_like_button", p), s += "\n\n";
                                var m = n.makeMacro(["model"], ["options"], function (r, a) {
                                    var o = i;
                                    i = new n.Frame, a = a || {}, a.hasOwnProperty("caller") && i.set("caller", a.caller), i.set("model", r), i.set("options", a.hasOwnProperty("options") ? a.options : {});
                                    var s = "";
                                    return s += '\n\n    <a class="', s += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "className"), e.opts.autoescape), s += ' help" itemprop="discussionUrl" href="', s += n.suppressValue(n.memberLookup(r, "viewerUrl"), e.opts.autoescape), s += '#comments" data-action="go-to-comments">\n        <span class="count">\n            ', s += n.suppressValue(e.getFilter("humanize_number").call(t, n.memberLookup(r, "commentCount")), e.opts.autoescape), s += '\n        </span>\n        <span class="tooltip tooltip-up">Comment</span>\n    </a>\n\n', i = o, new n.SafeString(s)
                                });
                                t.addExport("comments_button"), t.setVariable("comments_button", m), s += "\n\n";
                                var g = n.makeMacro(["authUser"], ["options"], function (r, s) {
                                    var u = i;
                                    i = new n.Frame, s = s || {}, s.hasOwnProperty("caller") && i.set("caller", s.caller), i.set("authUser", r), i.set("options", s.hasOwnProperty("options") ? s.options : {});
                                    var l = "";
                                    return l += '\n\n    <div class="', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "buttonClass") && (l += " ", l += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "buttonClass"), e.opts.autoescape), l += " "), l += n.suppressValue(e.getFilter("class_names").call(t, {
                                        help: !0,
                                        "subscribe-button": !0,
                                        "count-subscribe-button": !0,
                                        "btn-loading": !0,
                                        "popover-container": !0,
                                        "--disabled": n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "disabled")
                                    }), e.opts.autoescape), l += '"\n\n        ', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "disabled") || (l += '\n            data-action="subscribe-collection"\n        '), l += ">\n\n        ", n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "count") && n.memberLookup(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "count"), "display") && (l += '\n            <span class="count">', l += n.suppressValue(n.memberLookup(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "count"), "subscribe"), e.opts.autoescape), l += "</span>\n        "), l += "\n\n        ", n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "disabled") ? (l += '\n            <span class="tooltip subscribed-content', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "tooltipClass") ? (l += " ", l += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "tooltipClass"), e.opts.autoescape)) : l += " tooltip-down", l += '">Subscribers</span>\n        ') : (l += '\n             <span class="tooltip subscribed-content', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "tooltipClass") ? (l += " ", l += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "tooltipClass"), e.opts.autoescape)) : l += " tooltip-down", l += '">Subscribe</span>\n            <span class="tooltip unsubscribed-content', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "tooltipClass") ? (l += " ", l += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "tooltipClass"), e.opts.autoescape)) : l += " tooltip-down", l += '">Unsubscribe</span>\n        '), l += "\n\n        ", n.memberLookup(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "popover"), "display") && (l += "\n            ", l += n.suppressValue((a = 86, o = 26, n.callWrap(n.contextOrFrameLookup(t, i, "share_popover"), "share_popover", t, [{
                                        class: n.memberLookup(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "popover"), "arrow")
                                    }])), e.opts.autoescape), l += "\n        "), l += "\n    </div>\n\n", i = u, new n.SafeString(l)
                                });
                                t.addExport("subscribe_button_count"), t.setVariable("subscribe_button_count", g), s += "\n\n";
                                var v = n.makeMacro(["collection"], [], function (t, r) {
                                    var a = i;
                                    i = new n.Frame, r = r || {}, r.hasOwnProperty("caller") && i.set("caller", r.caller), i.set("collection", t);
                                    var o = "";
                                    return o += '\n\n    <span class="toggle-button addto-button" data-action="add-to-collection" data-collection="', o += n.suppressValue(n.memberLookup(t, "uid"), e.opts.autoescape), o += '">\n        <a class="button btn-small btn-primary toggle">\n            Add\n        </a>\n        <a class="button btn-small btn-important untoggle">\n            <span class="toggled">\n                Added\n            </span>\n            <span class="untoggled">\n                Remove\n            </span>\n        </a>\n    </span>\n\n', i = a, new n.SafeString(o)
                                });
                                t.addExport("add_to_collection_button"), t.setVariable("add_to_collection_button", v), s += "\n\n";
                                var _ = n.makeMacro(["collection"], [], function (t, r) {
                                    var a = i;
                                    i = new n.Frame, r = r || {}, r.hasOwnProperty("caller") && i.set("caller", r.caller), i.set("collection", t);
                                    var o = "";
                                    return o += '\n\n    <span class="toggle-button subscribe-collection-button btn-loading" data-action="subscribe-collection" data-collection="', o += n.suppressValue(n.memberLookup(t, "uid"), e.opts.autoescape), o += '">\n        <div class="subscribe">\n            <a class="button btn-medium btn-primary btn-disabled toggle">\n                <i class="icon fa fa-rss"></i>\n                Subscribe\n            </a>\n            <a class="button btn-medium btn-important untoggle">\n                <i class="icon icon-fixed-left fa fa-rss"></i>\n                <span class="toggled">\n                    Subscribed\n                </span>\n                <span class="untoggled">\n                    Unsubscribe\n                </span>\n            </a>\n        </div>\n    </span>\n\n', i = a, new n.SafeString(o)
                                });
                                t.addExport("subscribe_button"), t.setVariable("subscribe_button", _), s += "\n\n";
                                var b = n.makeMacro([], ["options"], function (r) {
                                    var a = i;
                                    i = new n.Frame, r = r || {}, r.hasOwnProperty("caller") && i.set("caller", r.caller), i.set("options", r.hasOwnProperty("options") ? r.options : {});
                                    var o = "";
                                    o += "\n\n    ";
                                    var s;
                                    return s = e.getFilter("merge").call(t, {
                                        buttonClass: "btn-secondary"
                                    }, n.contextOrFrameLookup(t, i, "options")), i.set("options", s, !0), i.topLevel && t.setVariable("options", s), i.topLevel && t.addExport("options", s), o += '\n\n    <a class="button btn-medium ', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "buttonClass") && (o += " ", o += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "buttonClass"), e.opts.autoescape)), o += '" data-action="open-collection-popup">\n        <div class="add-to">\n            <i class="icon fa fa-plus"></i>\n            Add to\n        </div>\n    </a>\n\n', i = a, new n.SafeString(o)
                                });
                                t.addExport("add_to_open_popup"), t.setVariable("add_to_open_popup", b), s += "\n\n";
                                var S = n.makeMacro([], [], function (e) {
                                    var t = i;
                                    i = new n.Frame, e = e || {}, e.hasOwnProperty("caller") && i.set("caller", e.caller);
                                    var r = "";
                                    return r += '\n\n    <li class="item create-collection">\n        <div class="collection-addcard" data-action="open-create-collection-popup">\n            <div class="thumbnail create-new-collection">\n                <i class="icon fa fa-plus"></i>\n            </div>\n            <div class="js-title">\n                Create new collection\n            </div>\n        </div>\n    </li>\n\n', i = t, new n.SafeString(r)
                                });
                                t.addExport("open_create_collection"), t.setVariable("open_create_collection", S), s += "\n", u ? u.rootRenderFunc(e, t, i, n, r) : r(null, s)
                            })
                        })
                    } catch (e) {
                        r(n.handleError(e, a, o))
                    }
                }
                return {
                    root: e
                }
            }()
        }()
}, function (e, t, i) {
    var n, r, a;
    /**
     * isMobile.js v0.4.1
     *
     * A simple library to detect Apple phones and tablets,
     * Android phones and tablets, other mobile devices (like blackberry, mini-opera and windows phone),
     * and any kind of seven inch device, via user agent sniffing.
     *
     * @author: Kai Mallea (kmallea@gmail.com)
     *
     * @license: http://creativecommons.org/publicdomain/zero/1.0/
     */
    ! function (i) {
        var o = /iPhone/i,
            s = /iPod/i,
            u = /iPad/i,
            l = /(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,
            c = /Android/i,
            h = /(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,
            d = /(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,
            f = /Windows Phone/i,
            p = /(?=.*\bWindows\b)(?=.*\bARM\b)/i,
            m = /BlackBerry/i,
            g = /BB10/i,
            v = /Opera Mini/i,
            _ = /(CriOS|Chrome)(?=.*\bMobile\b)/i,
            b = /(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,
            S = new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)", "i"),
            x = function (e, t) {
                return e.test(t)
            },
            y = function (e) {
                var t = e || navigator.userAgent,
                    i = t.split("[FBAN");
                if (void 0 !== i[1] && (t = i[0]), i = t.split("Twitter"), void 0 !== i[1] && (t = i[0]), this.apple = {
                        phone: x(o, t),
                        ipod: x(s, t),
                        tablet: !x(o, t) && x(u, t),
                        device: x(o, t) || x(s, t) || x(u, t)
                    }, this.amazon = {
                        phone: x(h, t),
                        tablet: !x(h, t) && x(d, t),
                        device: x(h, t) || x(d, t)
                    }, this.android = {
                        phone: x(h, t) || x(l, t),
                        tablet: !x(h, t) && !x(l, t) && (x(d, t) || x(c, t)),
                        device: x(h, t) || x(d, t) || x(l, t) || x(c, t)
                    }, this.windows = {
                        phone: x(f, t),
                        tablet: x(p, t),
                        device: x(f, t) || x(p, t)
                    }, this.other = {
                        blackberry: x(m, t),
                        blackberry10: x(g, t),
                        opera: x(v, t),
                        firefox: x(b, t),
                        chrome: x(_, t),
                        device: x(m, t) || x(g, t) || x(v, t) || x(b, t) || x(_, t)
                    }, this.seven_inch = x(S, t), this.any = this.apple.device || this.android.device || this.windows.device || this.other.device || this.seven_inch, this.phone = this.apple.phone || this.android.phone || this.windows.phone, this.tablet = this.apple.tablet || this.android.tablet || this.windows.tablet, "undefined" == typeof window) return this
            },
            C = function () {
                var e = new y;
                return e.Class = y, e
            };
        void 0 !== e && e.exports && "undefined" == typeof window ? e.exports = y : void 0 !== e && e.exports && "undefined" != typeof window ? e.exports = C() : (r = [], n = i.isMobile = C(), void 0 !== (a = "function" == typeof n ? n.apply(t, r) : n) && (e.exports = a))
    }(this)
}, , , function (e, t, i) {
    "use strict";
    var n = i(6),
        r = i(23);
    t.a = n.a.extend({
        displayName: "PureComponent",
        shouldViewUpdate: function (e, t) {
            return !Object(r.d)(this.options, e) || !Object(r.d)(this.state, t)
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(14),
        r = i(0),
        a = (i.n(r), i(24)),
        o = i.n(a),
        s = i(5),
        u = i.n(s),
        l = i(158),
        c = i(228),
        h = i(471),
        d = i(472),
        f = i(22),
        p = i(23),
        m = i(30),
        g = i(473),
        v = i(224),
        _ = Object(l.a)(["initialize"]),
        b = _(o.a.Collection);
    t.a = b.extend({
        mixins: [v.b],
        optionsTypes: {
            offset: v.a.number,
            pageSize: v.a.number,
            paginationType: v.a.oneOf(["cursor", "offset"]),
            lastPage: v.a.number,
            firstPage: v.a.number,
            minOffset: v.a.number,
            maxOffset: v.a.number,
            cursor: v.a.shape({
                previous: v.a.string,
                next: v.a.string
            })
        },
        defaultOptions: function () {
            return {
                pageSize: n.a.apiPageSize,
                paginationType: "cursor",
                offset: 0,
                minOffset: 0,
                maxOffset: 1 / 0,
                cursor: {
                    previous: null
                }
            }
        },
        backend: c.a,
        previousPromise: u.a.resolve(),
        constructor: function () {
            this.options = Object(r.extend)({}, this.defaultOptions(), Object(r.pickBy)(arguments[1] || {}, function (e) {
                return void 0 !== e
            })), b.apply(this, arguments)
        },
        initialize: function () {
            this.options.backend && (this.backend = this.options.backend), this._loading = "none", Object(g.a)("add", "afterAdd", this), Object(g.a)("remove", "afterRemove", this), this.triggerAfterRequest = Object(r.debounce)(this.triggerAfterRequest.bind(this), 20), this.initializePagination(), b.prototype.initialize.apply(this, arguments)
        },
        at: function (e) {
            return e < 0 ? void 0 : b.prototype.at.call(this, e)
        },
        domain: function () {
            return Object(r.result)(this.backend, "domain")
        },
        parse: function (e) {
            return this.backend.parse(e)
        },
        queryParams: function () {
            return this.isCursorPagination() ? {
                cursor: this._currentCursor,
                count: Object(r.result)(this.options, "pageSize")
            } : {
                offset: this.options.offset,
                count: Object(r.result)(this.options, "pageSize")
            }
        },
        url: function () {
            var e = Object(r.result)(this, "domain"),
                t = Object(r.result)(this, "endpoint"),
                i = e + t,
                n = i + f.b.craft("?", this.queryParams());
            return n = n.replace(/(?!^)\/{2,}/g, "/")
        },
        fetch: function () {
            this.triggerBeforeRequest();
            var e = this.previousPromise;
            return this.previousPromise = u.a.resolve(b.prototype.fetch.apply(this, arguments)).then(function (t) {
                return e.timeout(1e3).catch(m.d).then(function () {
                    return t
                })
            }), this.previousPromise.then(function (e) {
                return this.previousPromise = u.a.resolve(), this.triggerAfterRequest(e), e
            }.bind(this))
        },
        reset: function () {
            b.prototype.reset.apply(this, arguments), this.pagination.reset()
        },
        triggerBeforeRequest: function () {
            this.trigger("beforeRequest")
        },
        triggerAfterRequest: function (e) {
            this.trigger("afterRequest", e)
        },
        isCursorPagination: function () {
            return "cursor" === this.pagination.type
        },
        initializePagination: function () {
            "offset" === this.options.paginationType ? this._initializeOffsetPagination() : this._initializeCursorPagination()
        },
        _initializeCursorPagination: function () {
            var e = this.options.cursor;
            this.pagination = Object(d.a)(e, function (e, t) {
                return this._currentCursor = e, u.a.resolve(this.fetch(Object(r.extend)({}, t, {
                    reset: !1,
                    add: !1,
                    remove: !1
                })))
            }.bind(this))
        },
        _initializeOffsetPagination: function () {
            var e = {
                lastPage: this.options.lastPage,
                firstPage: this.options.firstPage
            };
            this.pagination = Object(h.a)(e, function (e, t) {
                return this.options.offset = this.options.minOffset + Object(r.result)(this.options, "pageSize") * e, u.a.resolve(this.fetch(Object(r.extend)({}, t, {
                    reset: !1,
                    add: !1,
                    remove: !1
                })))
            }.bind(this))
        },
        loadPreviousPage: function (e) {
            var t = this;
            this.setLoading("previous");
            var i = e || {};
            return this.pagination.loadPrevious(i).then(function (e) {
                var n = t.parse(e);
                return i.setPrevious && i.setNext ? t.set(n) : t.add(n, {
                    at: 0
                }), t.setLoading("none"), n
            }).catch(function (e) {
                throw t.setLoading("none"), e
            })
        },
        loadNextPage: function (e) {
            var t = this;
            this.setLoading("next");
            var i = e || {};
            return this.pagination.loadNext(i).then(function (e) {
                var n = t.parse(e);
                return i.setPrevious && i.setNext ? t.set(n) : t.add(n), t.setLoading("none"), n
            }).catch(function (e) {
                throw t.setLoading("none"), e
            })
        },
        loadFirstPage: function (e) {
            var t = this;
            return this.setLoading("refresh"), this.pagination.loadFirst(e || {}).then(function (e) {
                var i = t.parse(e);
                return i.length || t.trigger("empty"), t.set(i), t.setLoading("none"), i
            }).catch(function (e) {
                throw t.setLoading("none"), e
            })
        },
        loadLatestItems: function () {
            var e = this;
            return this.setLoading("refresh"), this.pagination.loadFirst({
                allowPrefetching: !1
            }).then(function (t) {
                var i = e.parse(t);
                return e.add(i, {
                    at: 0
                }), e.setLoading("none"), i
            }).catch(function (t) {
                throw e.setLoading("none"), t
            })
        },
        hasPreviousPage: function () {
            return this.pagination.hasPrevious()
        },
        hasNextPage: function () {
            return this.pagination.hasNext()
        },
        setLoading: function (e) {
            this._loading = e, this.trigger("loadingChanged", e)
        },
        loading: function () {
            return this._loading
        },
        isLoading: function () {
            return "none" !== this._loading
        }
    }, {
        extend: function (e, t) {
            var i = Object(r.extend)({}, e, {
                defaultOptions: Object(p.e)(Object(m.g)(this.prototype.defaultOptions || {}), Object(m.g)(e.defaultOptions || {})),
                optionTypes: Object(r.extend)({}, this.prototype.optionTypes || {}, e.optionTypes || {})
            });
            return b.extend.call(this, i, t)
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(40),
        r = i.n(n),
        a = i(52),
        o = i.n(a),
        s = i(3),
        u = i.n(s),
        l = i(0),
        c = (i.n(l), i(23)),
        h = i(33),
        d = o()("windowCallbackKey");
    t.a = {
        name: "WithWindowEvents",
        constructor: function () {
            var e = this;
            this[d] = {
                listeners: []
            }, this.events = Object(c.c)(this.events, function (t, i) {
                var n = Object(h.d)(i);
                if ("window" !== n.selector) return r()({}, i, t);
                if ("string" == typeof t && !e[t]) throw new Error("WithWindowEvents error: " + e.displayName + "." + t + " is not defined.");
                return e[d].listeners.push({
                    eventName: n.eventName,
                    callback: function () {
                        for (var i, n = arguments.length, r = Array(n), a = 0; a < n; a++) r[a] = arguments[a];
                        return Object(l.isFunction)(t) ? t.call.apply(t, [e].concat(r)) : (i = e[t]).call.apply(i, [e].concat(r))
                    }
                }), {}
            })
        },
        delegateEvents: function () {
            this[d].listeners.forEach(function (e) {
                u()(window).on(e.eventName, e.callback)
            })
        },
        undelegateEvents: function () {
            this[d].listeners.forEach(function (e) {
                u()(window).off(e.eventName, e.callback)
            })
        },
        beforeRemove: function () {
            this[d].listeners.forEach(function (e) {
                u()(window).off(e.eventName, e.callback)
            })
        }
    }
}, function (e, t, i) {
    "use strict";
    var n, r, a, o, s, u = i(9),
        l = i(147),
        c = i(704),
        h = i(5),
        d = i.n(h),
        f = i(47),
        p = i(20),
        m = u.a.osg,
        g = {},
        v = -1,
        _ = 0,
        b = !1,
        S = 40,
        x = m.Timer.instance().tick(),
        y = !1,
        C = !1,
        T = Object(c.a)(),
        w = function () {
            if (a = window.setTimeout(w, S), n && r && !y && !g.isDrawAlreadyQueued()) {
                Object(c.b)() && !f.a.getHighResBound().isFulfilled() && s();
                m.Timer.instance().tick() - x - S <= S || (r.enable(), v = -1)
            }
        };
    Object(l.a)() || (a = window.setTimeout(w, S)), s = function () {
        o || (o = new d.a(function (e) {
            e()
        }).finally(function () {
            n.requestRedraw(), n.frame(), o = void 0
        }))
    };
    var M = function (e) {
        if (n && !y) {
            if (Object(c.b)()) return s(), void(C = !0);
            C = !1;
            var t = g.isDrawAlreadyQueued();
            if (t || n.requestRedraw(), r && !e && (r.reset(), !t)) {
                var i = m.Timer.instance().tick();
                _ += i - x, v++, 0 === v ? (v = 0, _ = 0) : 4 === v && (S = Math.min(200, Math.max(16, _ / v)), v = 0, _ = 0), x = i
            }
        }
    };
    g.setPoseForScreenshot = function (e) {
        y = e
    }, g.isDrawAlreadyQueued = function () {
        return n._requestRedraw
    }, g.draw = function () {
        M()
    }, g.drawNoJitter = function () {
        this._doJitter = !1, M()
    }, g.drawSameFrame = function () {
        M(!0)
    }, g.redrawShadow = function () {
        b = !0, M()
    }, g.redrawShadowNextFrame = function () {
        window.setTimeout(g.redrawShadow, 0)
    }, g.getShadowForcedUpdate = function () {
        return b
    }, g.setShadowForcedUpdate = function (e) {
        b = e
    }, g.setViewer = function (e) {
        n = e
    }, g.setSuperSample = function (e) {
        r = e
    }, g.getSuperSample = function () {
        return r
    }, g.getFrameTimeAverage = function () {
        return S
    };
    var E = 0,
        A = 0;
    g.requestTextureBudget = function (e) {
        if (!f.a.getModelDisplayed().isResolved()) return !0;
        if (!n) return !0;
        var t = n.getFrameStamp().getFrameNumber();
        if (A < t && (A = t, E = 0), (E += e) === e) return !0;
        var i = Object(p.a)().textureFrameBudget;
        return E <= i * i
    }, T && document.addEventListener(T, function () {
        C && M()
    }), t.a = g
}, , , function (e, t, i) {
    "use strict";
    var n = i(5),
        r = i.n(n),
        a = i(20),
        o = {};
    o.OSG_VERSION = -1;
    var s = function (e) {
        var t = {},
            i = new r.a(function (e, i) {
                t.resolve = e, t.reject = i
            });
        i.resolve = t.resolve, i.reject = t.reject, o["get" + e] = function () {
            return i
        }, o["resolve" + e] = function () {
            !1 === i.isFulfilled() && i.resolve.apply(i, arguments)
        }
    };
    o.getInitialTextureBoundPromise = function () {
        return Object(a.a)().preload ? r.a.all([o.getHighResBound(), o.getGroundHiResAoLoaded()]) : o.getLowResBound()
    }, s("Polygon"), s("Wireframe"), s("WireframeOptimized"), s("WireframeOptimizedSplit"), s("WireframeOptimizedSplitCompressed"), s("ModelDisplayed"), s("FirstAnimation"), s("AllAnimations"), s("HasAnimation"), s("FirstCameraAnimation"), s("Material"), s("GroundHiResAoLoaded"), s("HasSound"), s("SoundsCanPlayTrough"), s("VrDisplayReady"), s("LowResLoaded"), s("HighResLoaded"), s("LowResBound"), s("HighResBound"), s("AsyncShaderCompilation"), s("DataSizeOSGJS"), s("DataSizePolygon"), s("DataSizeTextures"), s("DataSizeSound"), s("DataSizeEnvironment"), s("DataSizeWireframe"), s("DataSizeAllModel"), r.a.all([o.getDataSizeOSGJS(), o.getDataSizePolygon(), o.getDataSizeSound(), o.getDataSizeTextures(), o.getDataSizeEnvironment(), o.getDataSizeWireframe()]).then(function (e) {
        for (var t = 0, i = 0, n = e.length; i < n; i++) t += e[i];
        o.resolveDataSizeAllModel(t)
    }), window.sketchfabViewerLoaded = r.a.all([o.getHighResBound(), o.getAllAnimations(), o.getWireframeOptimizedSplitCompressed()]), document.createEvent && window.dispatchEvent && window.sketchfabViewerLoaded.then(function () {
        var e = document.createEvent("Event");
        e.initEvent("sketchfaballloadingdone", !0, !0), window.dispatchEvent(e)
    }), t.a = o
}, , , , , , function (e, t, i) {
    "use strict";
    var n = i(54),
        r = i.n(n),
        a = i(0),
        o = (i.n(a), function (e) {
            return e.split(/; */g).reduce(function (e, t) {
                var i = t.indexOf("="),
                    n = decodeURIComponent(t.substr(0, i)),
                    r = decodeURIComponent(t.substr(i + 1));
                return e[n] = r, e
            }, {})
        }),
        s = function (e, t) {
            var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                n = i.expires,
                a = void 0 === n ? 31536e6 : n,
                o = i.domain,
                s = void 0 === o ? "" : o,
                u = i.path,
                l = void 0 === u ? "/" : u,
                c = a instanceof Date ? a : new Date(Date.now() + a);
            return [encodeURIComponent(e) + "=" + encodeURIComponent(t), "expires=" + c.toUTCString()].concat(r()(s ? ["domain=" + s] : []), ["path=" + l, "secure"]).join(";")
        },
        u = function (e, t) {
            document.cookie = s(e, "", Object(a.extend)({}, t, {
                expires: new Date("01/01/1970 00:00+0000")
            }))
        },
        l = function (e, t) {
            var i = void 0;
            try {
                i = o(document.cookie)[e]
            } catch (e) {
                console.warn("The cookies could not be read, most likely due to sandboxing issues.")
            }
            return void 0 === i ? t : i
        },
        c = function (e, t, i) {
            try {
                document.cookie = s(e, t, i)
            } catch (e) {
                console.warn("The cookies could not be set, most likely due to sandboxing issues.")
            }
        };
    t.a = {
        remove: u,
        get: l,
        set: c
    }
}, , function (e, t, i) {
    "use strict";

    function n(e, t) {
        var i, n = {},
            r = e ? " " + e : "";
        return n["wheel" + r] = function (e) {
            var t = -.25 * e.originalEvent.wheelDelta;
            t && (e.preventDefault(), s()(e.currentTarget).scrollTop(t + s()(e.currentTarget).scrollTop()))
        }, n["touchstart" + r] = function (e) {
            i = e.originalEvent.touches[0].pageY
        }, n["touchmove" + r] = function (e) {
            e.preventDefault();
            var t = i - e.originalEvent.touches[0].pageY;
            i = e.originalEvent.touches[0].pageY, s()(e.currentTarget).scrollTop(t + s()(e.currentTarget).scrollTop())
        }, a()({}, t, n)
    }
    var r = i(7),
        a = i.n(r),
        o = i(3),
        s = i.n(o);
    t.a = function (e) {
        return {
            name: "PreventPageScroll",
            constructor: function () {
                this.events = n(e, this.events)
            }
        }
    }
}, , , , , , , function (e, t, i) {
    "use strict";
    var n = i(26),
        r = i.n(n),
        a = i(7),
        o = i.n(a),
        s = i(0),
        u = (i.n(s), i(5)),
        l = i.n(u),
        c = i(143),
        h = i(35),
        d = i(4),
        f = i(11),
        p = i(145),
        m = i(17);
    t.a = f.a.extend(Object(s.extend)({}, p.a, {
        defaults: {
            collections: {},
            disableInfo: {
                requiredPlan: "",
                detail: [],
                isExempt: !1
            }
        },
        initialize: function () {
            f.a.prototype.initialize.apply(this, arguments), this.on("change:isPrivate", function () {
                this.get("isPrivate") || this.set("password", "")
            }.bind(this)), this.set("filters", new f.a), this.maxFailCount = 5
        },
        endpoint: function () {
            return "/models" + (this.isNew() ? "" : "/" + this.get("uid"))
        },
        queryParams: function () {
            return o()({}, f.a.prototype.queryParams.apply(this, arguments))
        },
        fetchMetadata: function () {
            var e = this,
                t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
                i = t.allowPrefetching,
                n = void 0 === i || i;
            return m.a.getModelMetadata(this.get("uid"), {
                allowPrefetching: n
            }).then(function (t) {
                return e.set({
                    hasStats: t.hasStats,
                    downloadStatus: t.downloadStatus,
                    extraFile: t.extraFile,
                    disableInfo: t.disableInfo
                }), t
            })
        },
        updateLike: function (e) {
            return d.a.authenticate(function (t) {
                var i = this.get("uid"),
                    n = this.get("likeCount"),
                    r = n + (e ? 1 : -1);
                return this.set({
                    likeCount: r
                }), t.addLike(i, e), (e ? m.a.likeModel(this.get("uid")) : m.a.unlikeModel(this.get("uid"))).catch(function (r) {
                    return this.set({
                        likeCount: n
                    }), t.addLike(i, !e), l.a.reject(r)
                }.bind(this))
            }.bind(this))
        },
        like: function () {
            return this.updateLike(!0)
        },
        unlike: function () {
            return this.updateLike(!1)
        },
        toggleLike: function () {
            return d.a.authenticate(function (e) {
                return e.doesLike(this.get("uid")) ? this.unlike() : this.like()
            }.bind(this))
        },
        hit: function () {
            var e = d.a.me();
            if (e.isAuthenticated()) {
                var t = this.get("user") && e.get("uid") === this.get("user").uid,
                    i = e.get("isStaff");
                if (t || i) return l.a.resolve()
            }
            return this.get("isPublished") ? m.a.viewModel(this.get("uid")) : l.a.resolve()
        },
        isPublished: function () {
            return (this.get("isPublished") || !!this.get("publishedAt")) && !this.get("isDeleted")
        },
        publish: function () {
            return this.set("isPublished", !0), this.set("publishedAt", new Date), m.a.publishModel(this.get("uid"))
        },
        sharing: function () {
            var e = this;
            return m.a.getModelSharing(this.get("uid")).then(function (t) {
                return e.set("sharing", t), t
            })
        },
        addCollection: function (e, t) {
            var i = {};
            i[e] = t, this.addCollections(i)
        },
        addCollections: function (e) {
            var t = Object(s.clone)(this.get("collections"));
            Object(s.extend)(t, e), this.set("collections", t)
        },
        isInflated: function () {
            var e = r()(this.attributes);
            return e.indexOf("description") > -1 && e.indexOf("tags") > -1
        },
        isInCollection: function (e) {
            return !!this.get("collections")[e]
        },
        isProcessing: function () {
            var e = this.get("status");
            return e && "PROCESSING" === e.processing
        },
        getCollections: function (e) {
            var t = this,
                i = e.filter(function (e) {
                    return !(e in t.get("collections"))
                });
            return i.length ? m.a.getModelCollections(this.get("uid"), i).then(function (e) {
                var i = e.results;
                return t.addCollection(i)
            }) : (this.trigger("change:collections"), l.a.resolve())
        },
        getDownloadType: function () {
            return this.get("price") > 0 && this.get("license") ? "paid" : this.get("license") ? "free" : "no"
        },
        getExtraArchive: function () {
            var e = this;
            return "paid" !== this.getDownloadType() || this.isProcessing() ? (this.set("extraArchive", null), l.a.resolve()) : m.a.getModelExtraArchive(this.get("uid")).then(function (t) {
                t = t.metadata ? t : null, e.set("extraArchive", t)
            }).catch(function (t) {
                404 === t.status && e.set("extraArchive", null)
            })
        },
        uploadExtraArchive: function (e) {
            return m.a.updateModelExtraArchive(this.get("uid"), e)
        },
        removeExtraArchive: function () {
            return m.a.removeModelExtraArchive(this.get("uid"))
        },
        reprocess: function () {
            return m.a.reprocessModel(this.get("uid")).then(this.checkStatusAndRetry.bind(this)).then(function (e) {
                switch (e.processing) {
                    case "SUCCEEDED":
                        return this.set("hasStats", !0), l.a.resolve();
                    case "FAILED":
                        return this.set("hasStats", !1), l.a.reject()
                }
            }.bind(this))
        },
        getOwnershipStatus: function (e) {
            return m.a.getModelOwnershipStatus(this.get("uid"), {
                allowPrefetching: e
            })
        },
        pollArchivesStatus: function () {
            return h.d(1 / 0, function () {
                return l.a.resolve(this.fetchMetadata({
                    allowPrefetching: !1
                })).then(function (e) {
                    return "archives_processing" === e.downloadStatus || "processing" === e.extraFile.status || "pending" === e.extraFile.status ? l.a.reject() : e
                })
            }.bind(this), {
                interval: 1e4
            })
        },
        getRatings: function () {
            return m.a.getModelRatings(this.get("uid"))
        }
    }), {
        pollDownloadLink: function (e) {
            return c.a.poll(e, function (e) {
                return e > 3e4 ? e : 2 * e
            })
        }
    })
}, function (e, t) {
    ! function () {
        (window.nunjucksPrecompiled = window.nunjucksPrecompiled || {})["skfb_front/macros/utils.jinja"] = function () {
            function e(e, t, i, n, r) {
                var a = "";
                try {
                    var o = null,
                        s = n.makeMacro(["number"], [], function (r, a) {
                            var o = i;
                            i = new n.Frame, a = a || {}, a.hasOwnProperty("caller") && i.set("caller", a.caller), i.set("number", r);
                            var s = "";
                            return s += "\n    ", s += n.suppressValue(e.getFilter("humanize_number").call(t, r), e.opts.autoescape), s += "\n", i = o, new n.SafeString(s)
                        });
                    t.addExport("humanize_count"), t.setVariable("humanize_count", s), a += "\n\n";
                    var u = n.makeMacro(["host", "type", "uid"], ["options"], function (r, a, o, s) {
                        var u = i;
                        i = new n.Frame, s = s || {}, s.hasOwnProperty("caller") && i.set("caller", s.caller), i.set("host", r), i.set("type", a), i.set("uid", o), i.set("options", s.hasOwnProperty("options") ? s.options : {});
                        var l = "";
                        l += "\n    ";
                        var c;
                        if (c = r + "/requests/new?type=report_abuse&utm_campaign=report_abuse&utm_source=website&" + a + "=" + o, i.set("link", c, !0), i.topLevel && t.setVariable("link", c), i.topLevel && t.addExport("link", c), l += "\n\n    ", n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "subject")) {
                            l += "\n        ";
                            var h;
                            h = "&report_string=" + e.getFilter("urlencode").call(t, n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "subject")), i.set("label", h, !0), i.topLevel && t.setVariable("label", h), i.topLevel && t.addExport("label", h), l += "\n    "
                        }
                        return l += '\n\n    <a href="', l += n.suppressValue(n.contextOrFrameLookup(t, i, "link"), e.opts.autoescape), l += n.suppressValue(n.contextOrFrameLookup(t, i, "label"), e.opts.autoescape), l += '" class="report-link ', l += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "class"), e.opts.autoescape), l += '" target="_blank">\n        ', l += n.suppressValue(e.getFilter("safe").call(t, e.getFilter("default").call(t, n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "text"), "Report abuse")), e.opts.autoescape), l += "\n    </a>\n", i = u, new n.SafeString(l)
                    });
                    t.addExport("report_link"), t.setVariable("report_link", u), a += "\n", o ? o.rootRenderFunc(e, t, i, n, r) : r(null, a)
                } catch (e) {
                    r(n.handleError(e, null, null))
                }
            }
            return {
                root: e
            }
        }()
    }()
}, , function (e, t, i) {
    "use strict";
    var n = i(26),
        r = i.n(n),
        a = i(0),
        o = (i.n(a), i(28)),
        s = {};
    s = window.prefetchedData ? window.prefetchedData : Object(o.k)("prefetched-data", "json"), window.prefetchedData || (window.prefetchedData = s), t.a = {
        getInitialPropsOf: function (e) {
            var t = s,
                i = t.ssrProps;
            return (void 0 === i ? {} : i)[e] || {}
        },
        get: function (e, t) {
            return s[e] || t
        },
        register: function (e, t) {
            s[e] = t
        },
        invalidate: function (e) {
            var t = e.replace(/\?.*$/, "");
            r()(s).forEach(function (e) {
                var i = e.replace(/\?.*$/, "");
                t !== i && 0 !== t.indexOf(i + "/") || (s[e] = void 0)
            })
        },
        update: function (e, t) {
            Object(a.each)(s[e], function (i, n) {
                void 0 !== t[n] && (s[e][n] = t[n])
            })
        }
    }
}, , function (e, t, i) {
    "use strict";

    function n(e) {
        return e.replace(/([A-Z])/g, "_$1").toLowerCase()
    }

    function r(e) {
        return e.replace(/[^\w\s-]+/g, "").trim().toLowerCase().replace(/[-\s]+/g, "-")
    }

    function a(e) {
        return e.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/\\/g, "")
    }

    function o(e) {
        return e && "string" == typeof e && (e = e.replace(/<script[^>]*>([\S\s]*?)<\/script>/gim, ""), e = e.replace(/<\/?\w(?:[^"'>]|"[^"]*"|'[^']*')*>/gim, ""), N.innerHTML = e, e = N.textContent, N.textContent = ""), e
    }

    function s(e, t, i, n) {
        var r = Array.prototype.slice.call(arguments, 0);
        if (r.length && r[r.length - 1].__keywords) {
            var o = r.pop(),
                s = r[1],
                u = r[2],
                l = r[3];
            t = s || o.trim_url_limit, i = u || o.nofollow, n = l || o.target
        }
        null == i && (i = !0), "string" == typeof e && (e = a(e));
        var c = n ? ' target="' + n + '"' : "",
            h = ["noopener", "noreferrer"].concat(i ? ["nofollow"] : []),
            d = e.replace(M, function (e) {
                var i = e.trim(),
                    n = A.test(i) ? h.slice(0, -1).join(" ") : h.join(" ");
                return F(e, '<a href="' + I(i) + '" rel="' + n + '"' + c + ">" + P(t, i) + "</a>")
            }).replace(w, function (e) {
                var t = e.trim();
                return F(e, '<a href="mailto:' + t + '">' + t + "</a>")
            }).replace(E, function (e) {
                var t = e.trim();
                return (e.match(/^\s/) ? " " : "") + '<a href="' + window.location.origin + "/" + R(t).substring(1) + '" rel="' + h.join(" ") + '">' + O(t)
            });
        return x.a.runtime.markSafe(d)
    }

    function u(e) {
        return x.a.runtime.markSafe(C.a.sanitize(e, {
            ALLOWED_TAGS: []
        }))
    }

    function l(e) {
        return b()("<div/>").html(C.a.sanitize(e, {
            ALLOWED_TAGS: []
        }).trim()).text()
    }

    function c(e) {
        var t = e.match(/.+/g);
        return t ? x.a.runtime.markSafe(t.map(function (e) {
            return "<p>" + e + "</p>"
        }).join("")) : e
    }

    function h(e, t, i) {
        return void 0 === t && (t = ""), void 0 === i && (i = "s"), 1 === e ? t : i
    }

    function d(e, t, i) {
        return e.split(t).pop().split(i)[0]
    }

    function f(e) {
        return e.replace(/[A-Z]/g, function (e) {
            return "-" + e.toLowerCase()
        })
    }

    function p(e) {
        return e.replace(/_./g, function (e) {
            return e.toUpperCase().replace("_", "")
        })
    }

    function m(e) {
        return e.start + ".." + e.end
    }

    function g(e) {
        var t = e.split("..");
        return {
            start: parseFloat(t[0] || 0),
            end: parseFloat(t[1] || 0)
        }
    }

    function v(e) {
        return e.split("/").reduce(function (e, t) {
            return t ? "." === t ? e : ".." === t && e.length ? Object(T.dropRight)(e, 1) : e.concat(t) : e
        }, []).join("/") + ("/" === Object(T.last)(e) ? "/" : "")
    }
    t.n = n, t.j = r, t.b = o, t.o = s, t.m = u, t.i = l, t.f = c, t.g = h, t.c = d, t.a = f, t.k = p, t.h = m, t.l = g, t.e = v, i.d(t, "d", function () {
        return D
    });
    var _ = i(3),
        b = i.n(_),
        S = i(335),
        x = i.n(S),
        y = i(193),
        C = i.n(y),
        T = i(0),
        w = (i.n(T), /(\s|^)\S+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+(\s|$)/g),
        M = /(\s|^)(https?:\/\/)?(?:(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[\/?#]\S*)?(?=(\s|$))/g,
        E = /(\s|^)(@[a-zA-Z0-9._-]{2,30})/g,
        A = new RegExp("sketchfab.com"),
        P = function (e, t) {
            var i = t.replace(/^(https?:\/\/)?(www\.)?/, "");
            return null == e || i.length <= e ? i : i.substr(0, e) + "..."
        },
        R = function (e) {
            return e.match(/^(@[a-zA-Z0-9._-]{2,30})/)[0]
        },
        O = function (e) {
            var t = e.split(/^(@[a-zA-Z0-9._-]{2,30})/);
            return t.length > 3 ? t.join("") : t[1] + "</a>" + t[2]
        },
        I = function (e) {
            return e.match(/^https?:\/\//) ? e : "http://" + e
        },
        F = function (e, t) {
            var i = e.match(/^\s/),
                n = e.match(/\s$/);
            return (i ? i[0] : "") + t + (n ? n[0] : "")
        },
        N = document.createElement("div"),
        D = function (e) {
            return "#" + e.substring(0, 6)
        }
}, , function (e, t, i) {
    "use strict";
    var n = {};
    n.PICK_GEOMETRY_FIXED = 1, n.PICK_GEOMETRY_ANIMATED = 2, n.PICK_GEOMETRY_RIG_BOX = 4, n.PICK_GIZMO_LIGHT = 8, n.SHADOW_CAST = 16, n.SHADOW_BOUNDS = 32, n.PICK_GEOMETRY_SLOW = n.PICK_GEOMETRY_FIXED | n.PICK_GEOMETRY_ANIMATED, n.PICK_GEOMETRY_FAST = n.PICK_GEOMETRY_FIXED | n.PICK_GEOMETRY_RIG_BOX, n.PICK_GEOMETRY = n.PICK_GEOMETRY_FIXED | n.PICK_GEOMETRY_ANIMATED | n.PICK_GEOMETRY_RIG_BOX, n.PICK = n.PICK_GEOMETRY | n.PICK_GIZMO_LIGHT, n.SHADOW = n.SHADOW_BOUNDS | n.SHADOW_CAST, n.PICK_GEOMETRY_SHADOW = n.PICK_GEOMETRY | n.SHADOW, n.NO_SHADOW = ~n.SHADOW, n.NO_PICK = ~n.PICK, n.NO_PICK_NO_SHADOW_CAST = ~(n.PICK | n.SHADOW_CAST), n.NO_PICK_NO_SHADOW_BOUNDS = ~(n.PICK | n.SHADOW_BOUNDS), n.NO_PICK_NO_SHADOW = ~(n.PICK | n.SHADOW), t.a = n
}, , function (e, t, i) {
    "use strict";
    t.a = function (e) {
        var t = Array.prototype.slice.call(arguments, 1),
            i = e.bind.apply(e, t);
        return i(), i
    }
}, , , function (e, t, i) {
    "use strict";

    function n(e) {
        return String(e).split("").reduce(function (e, t, i, n) {
            var r = n.length - i;
            return e + (!i || r % 3 ? t : "," + t)
        }, "")
    }

    function r(e) {
        var t = e / 100;
        if (Object(g.isInteger)(t)) return "$" + n(t);
        var i = String(Math.round(e)).split(""),
            r = i.filter(function (e, t) {
                return t >= i.length - 2
            });
        return "$" + n(i.filter(function (e, t) {
            return t < i.length - 2
        }).join("") || "0") + "." + r.join("")
    }

    function a(e, t) {
        if (t <= 0) return e;
        var i = Math.pow(10, t),
            n = e * i;
        return Math.round(n) / i
    }

    function o(e) {
        var t = parseFloat(e),
            i = [3, 6, 9, 12, 15];
        if (!t) return e;
        var n = t < 0 ? "-" : "",
            r = Math.abs(t);
        if (r < 1e3) return t;
        for (var o = 0, s = i.length; o < s; ++o) {
            var u = a(r / Math.pow(10, i[o]), 1);
            if (u < 1e3) {
                var l = Math.floor(u);
                return u !== l ? n + u + v[o] : n + l + v[o]
            }
        }
        return t < 0 ? "1000- P" : "1000+ P"
    }

    function s(e) {
        var t = Math.pow(Math.abs(e), 1 / 3);
        return e < 0 ? -t : t
    }

    function u(e, t, i) {
        return (i - e) / (t - e)
    }

    function l(e, t, i) {
        return i * (t - e) + e
    }

    function c(e, t, i) {
        return Math.max(e, Math.min(t, i))
    }

    function h(e, t) {
        var i = t || 1;
        return Math.round(e / i) * i
    }

    function d(e) {
        return e.reduce(function (t, i) {
            return t + i / e.length
        }, 0)
    }

    function f(e, t, i) {
        if (!e.length) return null;
        if (1 === e.length) return e[0];
        var n = i || {},
            r = function (i) {
                return n[i] = void 0 === n[i] ? t(e[i]) : n[i], n[i]
            };
        if (2 === e.length) return Math.abs(r(0)) < Math.abs(r(1)) ? e[0] : e[1];
        var a = Math.floor(e.length / 2);
        return f(r(a) > 0 ? e.slice(0, a + 1) : e.slice(a), t, n)
    }

    function p(e) {
        var t = Math.floor(e),
            i = Math.floor(e / 1024),
            n = Math.floor(e / 1048576),
            r = Math.floor(e / 1073741824);
        return r ? r + "GB" : n ? n + "MB" : i ? i + "kB" : t + "B"
    }

    function m(e, t, i) {
        return e.start === t && e.end >= i ? "Any" : e.start === t ? "Up to " + o(e.end) : e.start >= i ? o(e.start) + "+" : o(e.start) + " to " + o(e.end)
    }
    t.e = n, t.g = r, t.k = o, t.c = s, t.n = u, t.h = l, t.b = c, t.m = h, t.a = d, t.d = f, i.d(t, "i", function () {
        return _
    }), i.d(t, "f", function () {
        return b
    }), t.j = p, t.l = m;
    var g = i(0),
        v = (i.n(g), ["k", "M", "B", "T", "P"]),
        _ = function (e, t, i, n) {
            return e / t > i / n ? {
                width: e,
                height: n * e / i
            } : {
                width: i * t / n,
                height: t
            }
        },
        b = {
            linear: function (e) {
                return e
            },
            easeInQuad: function (e) {
                return e * e
            },
            easeInCubic: function (e) {
                return e * e * e
            }
        }
}, , , function (e, t, i) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: !0
    });
    var n = i(5),
        r = i.n(n),
        a = i(9),
        o = i(0),
        s = (i.n(o), i(1172)),
        u = i(705),
        l = i(1178),
        c = i(1179),
        h = i(985),
        d = i(1180),
        f = i(1027),
        p = i(1181),
        m = i(1183),
        g = i(229),
        v = i(916),
        _ = i(1184),
        b = a.a.osg,
        S = function (e) {
            e = this.computeURL(e);
            var t = new b.Image;
            return t.setURL(e), r.a.resolve(t)
        },
        x = [],
        y = {},
        C = function () {
            return function () {
                var e = this.getJSON(),
                    t = e.UniqueID,
                    i = new b.BufferArray(b.BufferArray[e.Type]);
                i.setItemSize(e.ItemSize), i.setElements(x);
                var n = i.getInstanceID();
                if (y[n] = {}, e.Array) {
                    var a = Object.keys(e.Array)[0],
                        o = e.Array[a];
                    o.Elements ? y[n].inlined = o.Elements : (y[n].vb = o, y[n].type = a)
                } else y[n].inlined = e.Elements;
                var s = r.a.resolve(i);
                return void 0 !== t && (this._identifierMap[t] = s), s
            }
        },
        T = function (e) {
            return function (t, i) {
                return t = i.currentAnimationUID ? i.currentAnimationUID : this.computeURL(t), e.getBinaryArray(t, i).getPromise()
            }
        },
        w = function (e, t) {
            this.resource = e, this.promise = t
        },
        M = function (e) {
            if (!e) {
                if (M.instance) return M.instance;
                M.instance = this
            }
            return this._optPrefetch = {
                modelUid: void 0,
                checkPrefetch: !0
            }, this._maps = {}, this._collections = {}, this._resourceLoader = new s.a, this
        };
    M.Entry = w, M.prototype = {
        setModelUid: function (e) {
            this._optPrefetch.modelUid = e
        },
        setStateContextOSG: function (e) {
            this._state = e
        },
        getInstance: function () {
            return M.instance
        },
        register: function (e, t) {
            this._maps[e] = t
        },
        exist: function (e) {
            return this._maps[e]
        },
        hashTextureOptions: function (e) {
            for (var t = "", i = u.a.getValidOptions(), n = i.length, r = 0; r < n; ++r) t += e[i[r]];
            return t
        },
        _getCollection: function (e, t) {
            var i = this._collections[t];
            return i || (this._collections[t] = new e([], this._optPrefetch), window.RunningTests || this._collections[t].fetch(), this._collections[t])
        },
        getEnvironmentCollection: function () {
            return this._getCollection(l.a, "environment")
        },
        getBackgroundCollection: function () {
            return this._getCollection(c.a, "background")
        },
        getSoundCollection: function () {
            return this._getCollection(m.a, "sound")
        },
        getHotspotCollection: function () {
            return this._getCollection(f.a, "hotspot")
        },
        getMatcapCollection: function () {
            return this._getCollection(d.a, "matcap")
        },
        getAnimationCollection: function () {
            return this._getCollection(p.a, "animation")
        },
        getTextureCollection: function () {
            if (this._collections.texture) return this._collections.texture;
            var e = this._getCollection(h.a, "texture");
            return e.forEach(function (t) {
                0 === t.getImages().length && e.remove(t)
            }), e.isValid(), e
        },
        getOrCreateMultiresTexture: function (e, t) {
            var i = this.hashTextureOptions(t),
                n = [e, i].join(""),
                a = this.exist(n);
            if (a) return a;
            var o = this.getTextureCollection().get(e) || this.getMatcapCollection().get(e);
            if (o) {
                var s = new g.a;
                return u.a.setOptions(t, s), s.setImageModel(o), a = new w(s, r.a.resolve(s)), this.register(n, a), a
            }
        },
        getOrCreateImage: function (e, t) {
            var i = "image" + e;
            t && t.widget && (i += "widget");
            var n = this.exist(i);
            if (n) return n;
            var r = this._resourceLoader.getImage(e, t),
                a = r.getPromise();
            return n = new w, n.promise = a.then(function (e) {
                return n.image = e, n.resource = e, e
            }), this.register(i, n), n
        },
        getOrCreateTexture: function (e, t) {
            var i = function (e) {
                    !this._state || e._textureObject && !e.isDirty() || this._state.applyTextureAttribute(0, e)
                }.bind(this),
                n = u.a.createValidOptions(t),
                r = this.hashTextureOptions(n),
                a = [e, r].join(""),
                o = this.exist(a),
                s = !!(t && t.transferToGPU && this._state);
            if (o) return s && (o.promise.isFulfilled() ? i(o.texture) : o._bindToGPU = !0), o;
            n.cubemap = t && t.cubemap;
            var l = n.cubemap ? new v.a : new g.a;
            l.setTextureSize(1, 1), u.a.setOptions(n, l), t && void 0 !== t.convertNPOT && (l._convertNPOT = t.convertNPOT);
            var c = this._resourceLoader.getImage(e, t),
                h = c.getPromise();
            o = new w(l), o.texture = l, o._bindToGPU = s;
            var d = this;
            return o.promise = h.then(function (e) {
                if (n.cubemap)
                    for (var t = 0; t < 6; t++) {
                        var r = b.Texture.TEXTURE_CUBE_MAP_POSITIVE_X + t;
                        l.setImage(r, e[r], "RGBA")
                    } else l.setImage(e);
                return l.dirty(), o._bindToGPU && i(l), l
            }).finally(function () {
                return h.isFulfilled() || d.register(a, void 0), l
            }), this.register(a, o), o
        },
        getOrCreateModel: function (e, t) {
            var i = e,
                n = this.exist(i);
            if (n) return n;
            var r = t && t.node ? t.node : new b.Node,
                a = {};
            a.readImageURL = S, a.readBinaryArrayURL = T(this._resourceLoader), a.bufferMap = y, a.readBufferArray = C();
            var s = Object(o.extend)({}, a, t),
                u = this._resourceLoader.getModel(e, s),
                l = e.split("/");
            l.length = l.length - 1, l.length <= 0 && b.error("getOrCreateModel: can't find prefix to load subdata");
            var c = l.join("/") + "/";
            s.prefixURL = c;
            var h = Object(_.a)(u.getPromise(), e, s, r, this._resourceLoader);
            return n = new w(r, h), n.node = r, this.register(i, n), n
        },
        run: function () {
            this._resourceLoader.run()
        }
    }, new M, t.default = M
}, , function (e, t, i) {
    "use strict";
    var n = !1,
        r = function (e) {
            return void 0 !== e && (n = e), n
        };
    t.a = r
}, , , , , function (e, t, i) {
    "use strict";
    var n = function (e) {
        this.traversalMask = -1, this.nodeMaskOverride = 0, this.traversalMode = e, void 0 === e && (this.traversalMode = n.TRAVERSE_ALL_CHILDREN), this.nodePath = [], this.visitorType = n.NODE_VISITOR, this._databaseRequestHandler = void 0, this._frameStamp = void 0, this.traverse = n._traversalFunctions[this.traversalMode], this.pushOntoNodePath = n._pushOntoNodePath[this.traversalMode], this.popFromNodePath = n._popFromNodePath[this.traversalMode]
    };
    n.TRAVERSE_PARENTS = 1, n.TRAVERSE_ALL_CHILDREN = 2, n.TRAVERSE_ACTIVE_CHILDREN = 3, n.NODE_VISITOR = 0, n.UPDATE_VISITOR = 1, n.CULL_VISITOR = 2;
    var r = function (e) {
            e.ascend(this)
        },
        a = function (e) {
            e.traverse(this)
        };
    n._traversalFunctions = [void 0, r, a, a];
    var o = function (e) {
            this.nodePath.unshift(e)
        },
        s = function (e) {
            this.nodePath.push(e)
        };
    n._pushOntoNodePath = [void 0, o, s, s];
    var u = function () {
            return this.nodePath.shift()
        },
        l = function () {
            this.nodePath.pop()
        };
    n._popFromNodePath = [void 0, u, l, l], n.prototype = {
        reset: function () {
            this.nodePath.length = 0
        },
        setFrameStamp: function (e) {
            this._frameStamp = e
        },
        getFrameStamp: function () {
            return this._frameStamp
        },
        setNodeMaskOverride: function (e) {
            this.nodeMaskOverride = e
        },
        getNodeMaskOverride: function () {
            return this.nodeMaskOverride
        },
        setTraversalMask: function (e) {
            this.traversalMask = e
        },
        getTraversalMask: function () {
            return this.traversalMask
        },
        getNodePath: function () {
            return this.nodePath
        },
        validNodeMask: function (e) {
            var t = e.getNodeMask();
            return 0 != (this.traversalMask & (this.nodeMaskOverride | t))
        },
        apply: function (e) {
            this.traverse(e)
        },
        getVisitorType: function () {
            return this.visitorType
        },
        setDatabaseRequestHandler: function (e) {
            this._databaseRequestHandler = e
        },
        getDatabaseRequestHandler: function () {
            return this._databaseRequestHandler
        }
    }, t.a = n
}, function (e, t, i) {
    "use strict";
    var n = {};
    n.OPAQUE = 0, n.OPAQUE_NO_EARLYZ = n.BACKGROUND = 1, n.REFRACTION = 2, n.TRANSPARENT_CUSTOM_EARLYZ = 8, n.TRANSPARENT_NO_EARLYZ_PRE = 9, n.TRANSPARENT = 10, n.TRANSPARENT_NO_EARLYZ_POST = 11, n.EXTRA = 19, n.EDITOR_GIZMO = n.HOTSPOT = 20, n.GRID = n.TOOLTIP = n.VR_MENU = 21, n.WIREFRAME = n.VR_CURSOR = 22, n.OUTLINE = 23, n.DEBUG = 24, n.DEBUG_2 = 25, t.a = n
}, function (e, t, i) {
    "use strict";

    function n() {
        var e = {},
            t = new a.a(function (t, i) {
                e.resolve = t, e.reject = i
            });
        return t.resolve = e.resolve, t.reject = e.reject, t.promise = t, t
    }
    t.a = n;
    var r = i(5),
        a = i.n(r)
}, , function (e, t, i) {
    "use strict";
    var n = i(9),
        r = n.a.osg,
        a = {
            DEPTH_LESS_WRITE: new r.Depth(r.Depth.LESS, 0, 1, !0),
            DEPTH_LESS_NO_WRITE: new r.Depth(r.Depth.LESS, 0, 1, !1),
            DEPTH_DISABLE: new r.Depth(r.Depth.DISABLE, 0, 1, !0),
            DEPTH_ALWAYS: new r.Depth(r.Depth.ALWAYS, 0, 1, !0),
            DEPTH_NEVER: new r.Depth(r.Depth.NEVER, 0, 1, !1),
            DEPTH_LEQUAL_BACKGROUND_NO_WRITE: new r.Depth(r.Depth.LEQUAL, 1, 1, !1),
            DEPTH_LEQUAL_WRITE: new r.Depth(r.Depth.LEQUAL, 0, 1, !0),
            DEPTH_LEQUAL_NO_WRITE: new r.Depth(r.Depth.LEQUAL, 0, 1, !1),
            DEPTH_EQUAL_NO_WRITE: new r.Depth(r.Depth.EQUAL, 0, 1, !1),
            COLOR_MASK_NONE: new r.ColorMask(!1, !1, !1, !1),
            COLOR_MASK_ALPHA: new r.ColorMask(!1, !1, !1, !0),
            COLOR_MASK_RGBA: new r.ColorMask(!0, !0, !0, !0),
            BLEND_DISABLE: new r.BlendFunc,
            BLEND_SUBSTRACTIVE: new r.BlendFunc(r.BlendFunc.ONE, r.BlendFunc.ONE_MINUS_SRC_ALPHA),
            BLEND_ADDITIVE: new r.BlendFunc(r.BlendFunc.ONE, r.BlendFunc.ONE),
            CULL_BACK: new r.CullFace(r.CullFace.BACK),
            CULL_FRONT: new r.CullFace(r.CullFace.FRONT),
            CULL_DISABLE: new r.CullFace(r.CullFace.DISABLE)
        };
    t.a = a
}, , function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), function (e) {
            this._views = [], e && (this._name = e.FeatureName, this._modelName = e.ModelName, this._modelType = e.ModelType, this._viewListType = e.ViewListType.slice(0))
        });
    r.prototype = {
        getName: function () {
            return this._name
        },
        getModel: function () {
            return this._model
        },
        addView: function (e) {
            e && this._views.push(e)
        },
        init: function (e) {
            if (this._model || (this._model = e.getModelByName(this._modelName)), !this._model) {
                var t = this._modelType;
                this._model = new t, this._model.init && this._model.init(e)
            }
            var i = function (t) {
                var i = new t({
                    model: this._model,
                    context: e
                });
                this.addView(i)
            };
            this._viewListType.forEach(function (e) {
                i.call(this, e)
            }, this), e.addFeature(this)
        },
        prepareForScreenShot: function () {
            var e = this.getWidgetNode();
            return !(!e || !e.getNodeMask()) && (this._oldMaskEditorWidget = e.getNodeMask(), e.setNodeMask(0), !0)
        },
        resetAfterScreenShot: function () {
            var e = this.getWidgetNode();
            e && e.setNodeMask(this._oldMaskEditorWidget)
        },
        getWidgetNode: function () {}
    }, r.create = function (e) {
        var t = function () {
            r.call(this, t)
        };
        return t.prototype = Object(n.extend)({}, r.prototype), Object(n.extend)(t, e), t.getName = function () {
            return e.FeatureName
        }, t
    }, t.a = r
}, function (e, t, i) {
    "use strict";

    function n(e) {
        return p.a.planLabels[e]
    }

    function r(e, t) {
        return p.a.proPlanTypes.indexOf(e) > p.a.proPlanTypes.indexOf(t)
    }

    function a(e, t) {
        return p.a.proPlanTypes.indexOf(e) >= p.a.proPlanTypes.indexOf(t)
    }

    function o(e, t) {
        return !!e.isStaff || !!p.a.proPlanTypes.includes(t) && p.a.proPlanTypes.slice(p.a.proPlanTypes.indexOf(t)).includes(e.account)
    }

    function s(e) {
        return "basic" === e
    }

    function u(e) {
        var t = ["basic"].concat(p.a.proPlanTypes);
        return t[t.indexOf(e) + 1]
    }

    function l(e) {
        return p.a.planLabels[u(e)] || null
    }

    function c(e) {
        return p.a.maxSoundtracksPerModel[e] === g
    }

    function h(e) {
        return p.a.maxSoundtracksPerModel[e] === v
    }

    function d(e) {
        return e > _
    }

    function f(e) {
        if ("ent" === e.account) return !1;
        if ("basic" === e.account) return !0;
        var t = e.privateLimit.count;
        return null !== t && (0 === t || t <= .25 * p.a.plansPrivateModelLimit[e.account])
    }
    t.j = n, t.h = r, t.i = a, t.f = o, t.c = s, t.d = u, t.e = l, t.b = c, t.a = h, t.g = d, t.k = f;
    var p = i(14),
        m = i(0),
        g = (i.n(m), Object(m.max)(Object(m.values)(p.a.maxSoundtracksPerModel))),
        v = Object(m.max)(Object(m.values)(p.a.maxSoundtracksPerModel)),
        _ = Object(m.max)(Object(m.values)(p.a.maxModelFilesizes))
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(102),
        a = function () {
            r.a.call(this)
        };
    n.a.createPrototypeStateAttribute(a, n.a.objectInherit(r.a.prototype, {
        _attributeTypeIndex: void 0,
        getType: function () {
            return this.attributeType
        },
        getTypeMember: function () {
            return this.attributeType
        },
        apply: function () {},
        getHash: function () {
            return this.getType()
        }
    }), "osg", "StateAttribute"), a.OFF = 0, a.ON = 1, a.OVERRIDE = 2, a.PROTECTED = 4, a.INHERIT = 8, a.OVERRIDE_ON = a.OVERRIDE | a.ON, t.a = a
}, , function (e, t, i) {
    "use strict";
    var n = i(8),
        r = i(0),
        a = (i.n(r), i(3)),
        o = i.n(a),
        s = i(2),
        u = i(106),
        l = i(1),
        c = i(126);
    i.n(c);
    t.a = n.a.extend({
        displayName: "Notification",
        optionTypes: {
            parent: l.b.string,
            class: l.b.string,
            content: l.b.string,
            delay: l.b.number
        },
        defaultOptions: {
            parent: ".flashmessage-container"
        },
        events: {
            'click [data-action="close"]': "onClickClose"
        },
        template: function () {
            return s.default.getFromMacro("skfb_front/macros/notification", "flashmessage", [this.options.class, this.options.content, {
                safecontent: "True"
            }])
        },
        initialize: function () {
            n.a.prototype.initialize.apply(this, arguments), this.render(), this.options.delay && this.close(this.options.delay)
        },
        render: function () {
            this.$el.html(Object(r.result)(this, "template")), o()(this.options.parent).append(this.$el);
            var e = this.$el.find(".notification");
            e.addClass("hidden"), Object(r.defer)(e.removeClass.bind(e, "hidden"))
        },
        onClickClose: function (e) {
            e && e.preventDefault && e.preventDefault(), this.close(0)
        },
        close: function (e) {
            var t = this;
            e = e || 0;
            var i = this.$el.find(".notification");
            return setTimeout(function () {
                i.addClass("hidden"), Object(u.a)(i).then(function () {
                    t.$el.parent()[0].removeChild(t.el)
                })
            }, e), this
        }
    })
}, , , , , , function (e, t, i) {
    "use strict";

    function n(e) {
        var t = {};
        return u()(e).forEach(function (i) {
            t[i] = Array.isArray(e[i]) ? e[i] : [e[i]]
        }), t
    }

    function r(e) {
        return "object" === (void 0 === e ? "undefined" : o()(e)) ? n(e) : ("?" === e[0] && (e = e.substr(1)), e.split(/&+/g).reduce(function (e, t) {
            if (0 === t.length) return e;
            var i = t.indexOf("="); - 1 === i && (i = t.length);
            var n = decodeURIComponent(t.substr(0, i).replace(/\+/g, "%20")),
                r = decodeURIComponent(t.substr(i + 1).replace(/\+/g, "%20"));
            return void 0 === e[n] && (e[n] = []), e[n].push(r), e
        }, {}))
    }
    t.a = r;
    var a = i(49),
        o = i.n(a),
        s = i(26),
        u = i.n(s)
}, function (e, t, i) {
    "use strict";
    var n = !1,
        r = function (e) {
            return void 0 !== e && (n = e), n
        };
    t.a = r
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = function () {
            this._name = void 0, this._userdata = void 0, this._instanceID = r.getInstanceID()
        };
    n.a.createPrototypeObject(r, {
        cloneType: function () {
            return new(0, this.constructor)
        },
        getInstanceID: function () {
            return this._instanceID
        },
        setName: function (e) {
            this._name = e
        },
        getName: function () {
            return this._name
        },
        setUserData: function (e) {
            this._userdata = e
        },
        getUserData: function () {
            return this._userdata
        }
    }, "osg", "Object");
    var a = 0;
    r.getInstanceID = function () {
        return a += 1
    }, t.a = r
}, function (e, t, i) {
    "use strict";
    var n, r, a = i(9),
        o = i(1191),
        s = i(86),
        u = a.a.osg,
        l = 0,
        c = new s.a,
        h = {
            BIAS_MIN: .9,
            BIAS_MAX: 1.1,
            getBoxReady: function () {
                return c.promise
            },
            updateMaxWorldDisplacement: function (e) {
                e <= l || (l = e, this._updateModelBoxes())
            },
            getModelBoxWithDisplacement: function () {
                return n
            },
            getModelBoxWithoutDisplacement: function () {
                return r
            },
            _updateModelBoxes: function () {
                if (n) {
                    var e = n.getMin(),
                        t = n.getMax(),
                        i = u.vec3.fromValues(l, l, l);
                    u.vec3.add(t, t, i), u.vec3.sub(e, e, i)
                }
            },
            computePreciseBox: function (e) {
                var t = new o.a;
                e.accept(t), r = t.getPreciseBox(), n = new u.BoundingBox, n.copy(r), this._updateModelBoxes(), c.resolve()
            },
            getMaxDistanceFromOrigin: function () {
                var e = u.vec3.length(r.getMin()),
                    t = u.vec3.length(r.getMax());
                return Math.max(e, t)
            }
        };
    t.a = h
}, , function (e, t, i) {
    "use strict";
    i.d(t, "b", function () {
        return s
    });
    var n = i(367),
        r = i.n(n),
        a = i(368),
        o = i.n(a);
    i.d(t, "a", function () {
        return r.a
    }), i.d(t, "c", function () {
        return o.a
    });
    var s = function () {
        return window.innerWidth <= parseInt(o.a.responsiveBreakpointXSmall)
    }
}, function (e, t, i) {
    "use strict";
    var n = i(3),
        r = i.n(n),
        a = i(5),
        o = i.n(a),
        s = i(0),
        u = (i.n(s), Object(s.find)({
            WebkitTransition: "webkitTransitionEnd",
            MozTransition: "transitionend",
            OTransition: "oTransitionEnd otransitionend",
            transition: "transitionend"
        }, function (e, t) {
            return t in document.body.style
        })),
        l = function (e) {
            return new o.a(function (t) {
                return r()(e).one(u, t)
            })
        };
    t.a = l
}, , function (e, t, i) {
    "use strict";
    var n = i(36),
        r = function (e) {
            this._data = void 0, this._transpose = !1, this._glCall = "", this._cache = void 0, this._name = e, this._type = void 0, this._isMatrix = !1
        };
    r.isUniform = function (e) {
        return "object" == typeof e && window.Object.getPrototypeOf(e) === r.prototype
    }, r.prototype = {
        getName: function () {
            return this._name
        },
        getType: function () {
            return this._type
        },
        apply: function (e, t) {
            this._cache || (this._cache = e[this._glCall]), this._isMatrix ? this._cache.call(e, t, this._transpose, this._data) : this._cache.call(e, t, this._data)
        },
        setInternalArray: function (e) {
            n.a.warn("setInternalArray deprecated, please use getInternalArray instead: " + e.length), this._data = e
        },
        getInternalArray: function () {
            return this._data
        },
        setFloat: function (e) {
            this._data[0] = e
        },
        setFloat1: function (e) {
            this._data[0] = e[0]
        },
        setFloat2: function (e) {
            this._data[0] = e[0], this._data[1] = e[1]
        },
        setFloat3: function (e) {
            this._data[0] = e[0], this._data[1] = e[1], this._data[2] = e[2]
        },
        setFloat4: function (e) {
            this._data[0] = e[0], this._data[1] = e[1], this._data[2] = e[2], this._data[3] = e[3]
        },
        setFloat9: function (e) {
            this._data[0] = e[0], this._data[1] = e[1], this._data[2] = e[2], this._data[3] = e[3], this._data[4] = e[4], this._data[5] = e[5], this._data[6] = e[6], this._data[7] = e[7], this._data[8] = e[8]
        },
        setFloat16: function (e) {
            this._data[0] = e[0], this._data[1] = e[1], this._data[2] = e[2], this._data[3] = e[3], this._data[4] = e[4], this._data[5] = e[5], this._data[6] = e[6], this._data[7] = e[7], this._data[8] = e[8], this._data[9] = e[9], this._data[10] = e[10], this._data[11] = e[11], this._data[12] = e[12], this._data[13] = e[13], this._data[14] = e[14], this._data[15] = e[15]
        }
    }, r.prototype.setVec2 = r.prototype.setFloat2, r.prototype.setVec3 = r.prototype.setFloat3, r.prototype.setVec4 = r.prototype.setFloat4, r.prototype.setMatrix4 = r.prototype.setFloat16, r.prototype.setMatrix3 = r.prototype.setFloat9, r.prototype.setInt = r.prototype.setFloat, r.prototype.setInt1 = r.prototype.setFloat1, r.prototype.setInt2 = r.prototype.setFloat2, r.prototype.setInt3 = r.prototype.setFloat3, r.prototype.setInt4 = r.prototype.setFloat4;
    var a = function (e, t, i, n, a, o) {
            var s = t && t.length ? e : void 0,
                u = new r(void 0 !== s ? t : e);
            if (u._data = i, void 0 !== s)
                if (s.length)
                    for (var l = 0, c = s.length; l < c; ++l) u._data[l] = s[l];
                else u._data[0] = s;
            return u._glCall = n, u._type = a, u._isMatrix = !!o, u
        },
        o = function (e) {
            for (var t = new Float32Array(4 * e), i = 0; i < t.length; i += 4) t[i] = t[i + 3] = 1;
            return t
        },
        s = function (e) {
            for (var t = new Float32Array(9 * e), i = 0; i < t.length; i += 9) t[i] = t[i + 4] = t[i + 8] = 1;
            return t
        },
        u = function (e) {
            for (var t = new Float32Array(16 * e), i = 0; i < t.length; i += 16) t[i] = t[i + 5] = t[i + 10] = t[i + 15] = 1;
            return t
        },
        l = function (e, t, i) {
            return i && !i.length ? i : "string" != typeof t ? (t.length || 1) / e : 1
        };
    r.createFloat1 = function (e, t) {
        return a(e, t, new Float32Array(1 * l(1, e, t)), "uniform1fv", "float")
    }, r.createFloat2 = function (e, t) {
        return a(e, t, new Float32Array(2 * l(2, e, t)), "uniform2fv", "vec2")
    }, r.createFloat3 = function (e, t) {
        return a(e, t, new Float32Array(3 * l(3, e, t)), "uniform3fv", "vec3")
    }, r.createFloat4 = function (e, t) {
        return a(e, t, new Float32Array(4 * l(4, e, t)), "uniform4fv", "vec4")
    }, r.createInt1 = function (e, t) {
        return a(e, t, new Int32Array(1 * l(1, e, t)), "uniform1iv", "int")
    }, r.createInt2 = function (e, t) {
        return a(e, t, new Int32Array(2 * l(2, e, t)), "uniform2iv", "vec2i")
    }, r.createInt3 = function (e, t) {
        return a(e, t, new Int32Array(3 * l(3, e, t)), "uniform3iv", "vec3i")
    }, r.createInt4 = function (e, t) {
        return a(e, t, new Int32Array(4 * l(4, e, t)), "uniform4iv", "vec4i")
    }, r.createMatrix2 = function (e, t) {
        return a(e, t, o(l(4, e, t)), "uniformMatrix2fv", "mat2", !0)
    }, r.createMatrix3 = function (e, t) {
        return a(e, t, s(l(9, e, t)), "uniformMatrix3fv", "mat3", !0)
    }, r.createMatrix4 = function (e, t) {
        return a(e, t, u(l(16, e, t)), "uniformMatrix4fv", "mat4", !0)
    }, r.float = r.createFloatArray = r.createFloat = r.createFloat1, r.vec2 = r.createFloat2Array = r.createFloat2, r.vec3 = r.createFloat3Array = r.createFloat3, r.vec4 = r.createFloat4Array = r.createFloat4, r.int = r.createIntArray = r.createInt = r.createInt1, r.vec2i = r.createInt2Array = r.createInt2, r.vec3i = r.createInt3Array = r.createInt3, r.vec4i = r.createInt4Array = r.createInt4, r.mat2 = r.createMat2Array = r.createMat2 = r.createMatrix2, r.mat3 = r.createMat3Array = r.createMat3 = r.createMatrix3, r.mat4 = r.createMat4Array = r.createMat4 = r.createMatrix4, t.a = r
}, , , , , , function (e, t, i) {
    "use strict";
    var n = {};
    n.SCENE = "scene", n.MANIPULATORS = "scene.manipulators", n.ORBIT_MANIPULATOR = "scene.manipulators.orbit", n.ORBIT_MANIPULATOR_MOUSEKEYBOARD = "scene.manipulators.orbit.mousekeyboard", n.ORBIT_MANIPULATOR_RESETTOHOME = "scene.manipulators.orbit.mousekeyboard.home", n.ORBIT_MANIPULATOR_TOUCH = "scene.manipulators.orbit.touch", n.ORBIT_MANIPULATOR_WEBVR = "scene.manipulators.orbit.webvr", n.ORBIT_MANIPULATOR_DEVICEORIENTATION = "scene.manipulators.orbit.deviceorientation", n.ORBIT_MANIPULATOR_GAMEPAD = "scene.manipulators.orbit.gamepad", n.FPS_MANIPULATOR = "scene.manipulators.fps", n.FPS_MANIPULATOR_MOUSEKEYBOARD = "scene.manipulators.fps.mousekeyboard", n.FPS_MANIPULATOR_RESETTOHOME = "scene.manipulators.fps.mousekeyboard.home", n.FPS_MANIPULATOR_TOUCH = "scene.manipulators.fps.touch", n.FPS_MANIPULATOR_WEBVR = "scene.manipulators.fps.webvr", n.FPS_MANIPULATOR_DEVICEORIENTATION = "scene.manipulators.fps.deviceorientation", n.FPS_MANIPULATOR_GAMEPAD = "scene.manipulators.fps.gamepad", n.CAD_MANIPULATOR = "scene.manipulators.cad", n.CAD_MANIPULATOR_MOUSEKEYBOARD = "scene.manipulators.cad.mousekeyboard", n.CAD_MANIPULATOR_RESETTOHOME = "scene.manipulators.cad.mousekeyboard.home", n.CAD_MANIPULATOR_TOUCH = "scene.manipulators.cad.touch", n.NODE_GIZMO = "scene.nodegizmo", n.UI = "ui", n.STATS = "ui.stats", t.a = n
}, , function (e, t, i) {
    "use strict";
    i.d(t, "b", function () {
        return u
    });
    var n = i(52),
        r = i.n(n),
        a = i(0),
        o = (i.n(a), i(467)),
        s = i.n(o),
        u = r()("instanceKey"),
        l = function (e) {
            var t = e[u];
            return !t || t.shouldUpdate
        };
    t.a = {
        name: "WithTemplate",
        template: function () {
            return ""
        },
        renderDiff: function (e) {
            var t = this.el.cloneNode();
            t.innerHTML = e, s()(this.el, t, {
                onBeforeElUpdated: l,
                onBeforeElChildrenUpdated: l,
                childrenOnly: !0
            })
        },
        render: function () {
            this.renderDiff(Object(a.result)(this, "template"))
        }
    }
}, , function (e, t, i) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: !0
    });
    var n = i(36),
        r = i(12),
        a = i(92),
        o = i(108),
        s = i(448),
        u = i(406),
        l = i(1077),
        c = i(319),
        h = window.ImageBitmap || function () {},
        d = function (e) {
            return 0 !== e && (e & 1 + ~e) === e
        },
        f = function () {
            a.a.call(this), u.a.call(this), this.setDefaultParameters(), this._dirty = !0, this._dirtyMipmap = !0, this._applyTexImage2DCallbacks = [], this._textureObject = void 0, this._textureNull = !0
        },
        p = function (e, t) {
            var i = f[e];
            return void 0 === i ? (n.a.warn("bad Texture enum argument " + e + "\nfallback to " + t), t) : i
        };
    f.UNPACK_COLORSPACE_CONVERSION_WEBGL = 37443, f.UNPACK_FLIP_Y_WEBGL = 37440, f.BROWSER_DEFAULT_WEBGL = 37444, f.NONE = 0, f.DEPTH_COMPONENT = 6402, f.DEPTH_COMPONENT16 = 33189, f.DEPTH_STENCIL = 34041, f.DEPTH24_STENCIL8 = 35056, f.DEPTH_COMPONENT24 = 33190, f.DEPTH_COMPONENT32F = 36012, f.COMPRESSED_RGB_S3TC_DXT1_EXT = 33776, f.COMPRESSED_RGBA_S3TC_DXT1_EXT = 33777, f.COMPRESSED_RGBA_S3TC_DXT3_EXT = 33778, f.COMPRESSED_RGBA_S3TC_DXT5_EXT = 33779, f.COMPRESSED_RGB_ATC_WEBGL = 35986, f.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL = 35987, f.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL = 34798, f.COMPRESSED_RGB_PVRTC_4BPPV1_IMG = 35840, f.COMPRESSED_RGB_PVRTC_2BPPV1_IMG = 35841, f.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG = 35842, f.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG = 35843, f.COMPRESSED_RGB_ETC1_WEBGL = 36196, f.LINEAR = 9729, f.NEAREST = 9728, f.NEAREST_MIPMAP_NEAREST = 9984, f.LINEAR_MIPMAP_NEAREST = 9985, f.NEAREST_MIPMAP_LINEAR = 9986, f.LINEAR_MIPMAP_LINEAR = 9987, f.TEXTURE_MAX_ANISOTROPY_EXT = 34046, f.MAX_TEXTURE_MAX_ANISOTROPY_EXT = 34047, f.CLAMP_TO_EDGE = 33071, f.REPEAT = 10497, f.MIRRORED_REPEAT = 33648, f.TEXTURE_2D = 3553, f.TEXTURE_CUBE_MAP = 34067, f.TEXTURE_BINDING_CUBE_MAP = 34068, f.TEXTURE_CUBE_MAP_POSITIVE_X = 34069, f.TEXTURE_CUBE_MAP_NEGATIVE_X = 34070, f.TEXTURE_CUBE_MAP_POSITIVE_Y = 34071, f.TEXTURE_CUBE_MAP_NEGATIVE_Y = 34072, f.TEXTURE_CUBE_MAP_POSITIVE_Z = 34073, f.TEXTURE_CUBE_MAP_NEGATIVE_Z = 34074, f.MAX_CUBE_MAP_TEXTURE_SIZE = 34076, f.UNSIGNED_BYTE = 5121, f.UNSIGNED_SHORT = 5123, f.UNSIGNED_SHORT_4_4_4_4 = 32819, f.UNSIGNED_SHORT_5_5_5_1 = 32820, f.UNSIGNED_SHORT_5_6_5 = 33635, f.FLOAT = 5126, f.HALF_FLOAT_OES = 36193, f.HALF_FLOAT = 5131, f.UNSIGNED_INT_10F_11F_11F_REV = 35899, f.UNSIGNED_INT_24_8 = 34042, f.ALPHA = 6406, f.RGB = 6407, f.RGBA = 6408, f.LUMINANCE = 6409, f.LUMINANCE_ALPHA = 6410, f.RED_INTEGER = 36244, f.RGB_INTEGER = 36248, f.RGBA_INTEGER = 36249, f.RG_INTEGER = 33320, f.RED = 6403, f.R8 = 33321, f.R8UI = 33330, f.RG8 = 33323, f.RG8UI = 33336, f.RGB8 = 36758, f.RGB565 = 36194, f.RGB9_E5 = 35901, f.RGB8UI = 36221, f.RGBA8 = 32856, f.RGB5_A1 = 32855, f.RGBA4 = 32854, f.RGBA8UI = 36220, f.SRGB8_ALPHA8 = 35907, f.SRGB8 = 35905, f.R16F = 33325, f.RG16F = 33327, f.RGB16F = 34843, f.RGBA16F = 34842, f.R11F_G11F_B10F = 35898, f.R32F = 33326, f.RG32F = 33328, f.RGB32F = 34837, f.RGBA32F = 34836;
    var m = function () {
            var e = {};
            return e[f.R8] = f.LUMINANCE, e[f.R8UI] = f.LUMINANCE, e[f.R16F] = f.LUMINANCE, e[f.R32F] = f.LUMINANCE, e[f.SRGB8] = f.LUMINANCE, e[f.RG8] = f.RGB, e[f.RG8UI] = f.RGB, e[f.RG16F] = f.RGB, e[f.RG32F] = f.RGB, e[f.RGB8] = f.RGB, e[f.RGB565] = f.RGB, e[f.RGB9_E5] = f.RGB, e[f.RGB8UI] = f.RGB, e[f.RGB5_A1] = f.RGB, e[f.RGB16F] = f.RGB, e[f.RGB32F] = f.RGB, e[f.RGBA8] = f.RGBA, e[f.R11F_G11F_B10F] = f.RGBA, e[f.RGBA16F] = f.RGBA, e[f.RGBA32F] = f.RGBA, e[f.SRGB8_ALPHA8] = f.RGBA, e
        }(),
        g = function () {
            var e = {},
                t = {},
                i = {},
                n = {},
                r = {},
                a = {};
            return e[f.FLOAT] = t, e[f.HALF_FLOAT] = e[f.HALF_FLOAT_OES] = i, e[f.UNSIGNED_SHORT] = n, e[f.UNSIGNED_INT] = r, e[f.UNSIGNED_INT_24_8] = a, i[f.LUMINANCE] = f.R16F, i[f.RGB] = f.RGB16F, i[f.RGBA] = f.RGBA16F, t[f.LUMINANCE] = f.R32F, t[f.RGB] = f.RGB32F, t[f.RGBA] = f.RGBA32F, n[f.DEPTH_COMPONENT] = f.DEPTH_COMPONENT16, r[f.DEPTH_COMPONENT] = f.DEPTH_COMPONENT32F, a[f.DEPTH_STENCIL] = f.DEPTH24_STENCIL8, e
        }();
    f._sTextureManager = new window.Map, f.getTextureManager = function (e) {
        return f._sTextureManager.has(e) || f._sTextureManager.set(e, new l.a), f._sTextureManager.get(e)
    }, f.getEnumFromString = function (e) {
        var t = e;
        return "string" == typeof t && (t = p(t, e)), t
    }, r.a.createPrototypeStateAttribute(f, r.a.objectInherit(u.a.prototype, r.a.objectInherit(a.a.prototype, {
        attributeType: "Texture",
        cloneType: function () {
            return new f
        },
        invalidate: function () {
            this._textureObject = void 0, this.dirty()
        },
        dirty: function () {
            this._dirty = !0
        },
        isDirty: function () {
            return this._dirty
        },
        isTextureNull: function () {
            return this._textureNull
        },
        getOrCreateUniforms: function (e) {
            if (void 0 === f.uniforms && (f.uniforms = []), void 0 === f.uniforms[e]) {
                var t = this.getType() + e;
                f.uniforms[e] = {
                    texture: o.a.createInt1(e, t)
                }
            }
            return f.uniforms[e]
        },
        setDefaultParameters: function () {
            this._image = void 0, this._magFilter = f.LINEAR, this._minFilter = f.LINEAR, this._maxAnisotropy = 1, this._wrapS = f.CLAMP_TO_EDGE, this._wrapT = f.CLAMP_TO_EDGE, this._textureWidth = 0, this._textureHeight = 0, this._unrefImageDataAfterApply = !1, this._internalFormat = void 0, this._dirtyMipmap = !0, this._textureTarget = f.TEXTURE_2D, this.setInternalFormatType(f.UNSIGNED_BYTE), this._isCompressed = !1, this._flipY = !0, this._colorSpaceConversion = f.NONE
        },
        setColorSpaceConversion: function (e) {
            this._colorSpaceConversion = e
        },
        setFlipY: function (e) {
            this._flipY = e
        },
        getTextureTarget: function () {
            return this._textureTarget
        },
        getTextureObject: function () {
            return this._textureObject
        },
        setTextureSize: function (e, t) {
            var i = c.a.instance().getWebGLParameter("MAX_TEXTURE_SIZE");
            e === this._textureWidth && t === this._textureHeight || this.dirty(), void 0 !== e && (e > i ? (n.a.error("width (" + e + ') too big for GPU. Max Texture Size is "' + i + '"'), this._textureWidth = i) : this._textureWidth = e), void 0 !== t && (t > i ? (n.a.error("height (" + t + ') too big for GPU. Max Texture Size is "' + i + '"'), this._textureHeight = i) : this._textureHeight = t), this._textureNull = !1
        },
        init: function (e) {
            this._gl || this.setGraphicContext(e.getGraphicContext()), this._textureObject || (this._textureObject = f.getTextureManager(this._gl).generateTextureObject(this._gl, this, this._textureTarget, this._internalFormat, this._textureWidth, this._textureHeight), this.dirty(), this._dirtyTextureObject = !1, this._textureNull = !1)
        },
        addApplyTexImage2DCallback: function (e) {
            this._applyTexImage2DCallbacks.indexOf(e) < 0 && this._applyTexImage2DCallbacks.push(e)
        },
        removeApplyTexImage2DCallback: function (e) {
            var t = this._applyTexImage2DCallbacks.indexOf(e);
            t >= 0 && this._applyTexImage2DCallbacks.splice(t, 1)
        },
        getWidth: function () {
            return this._textureWidth
        },
        getHeight: function () {
            return this._textureHeight
        },
        releaseGLObjects: function () {
            void 0 !== this._textureObject && null !== this._textureObject && void 0 !== this._gl && (f.getTextureManager(this._gl).releaseTextureObject(this._textureObject), u.a.removeObject(this._gl, this)), this.invalidate()
        },
        getWrapT: function () {
            return this._wrapT
        },
        getWrapS: function () {
            return this._wrapS
        },
        setWrapS: function (e) {
            this._wrapS = "string" == typeof e ? p(e, f.CLAMP_TO_EDGE) : e, this.dirtyTextureParameters()
        },
        setWrapT: function (e) {
            this._wrapT = "string" == typeof e ? p(e, f.CLAMP_TO_EDGE) : e, this.dirtyTextureParameters()
        },
        dirtyTextureParameters: function () {
            this.dirty(), this.dirtyMipmap(), this.dirtyTextureObject()
        },
        dirtyTextureObject: function () {
            this._dirtyTextureObject = !0, this.dirtyMipmap(), this.dirty()
        },
        getMinFilter: function () {
            return this._minFilter
        },
        getMagFilter: function () {
            return this._magFilter
        },
        setMaxAnisotropy: function (e) {
            this._maxAnisotropy = e, this.dirtyTextureParameters()
        },
        getMaxAnisotropy: function () {
            return this._maxAnisotropy
        },
        setMinFilter: function (e) {
            this._minFilter = "string" == typeof e ? p(e, f.LINEAR) : e, this.dirtyTextureParameters()
        },
        setMagFilter: function (e) {
            this._magFilter = "string" == typeof e ? p(e, f.LINEAR) : e, this.dirtyTextureParameters()
        },
        setImage: function (e, t) {
            var i = e;
            (e instanceof window.Image || e instanceof HTMLCanvasElement || e instanceof h || e instanceof Uint8Array || e instanceof Uint16Array || e instanceof Float32Array) && (i = new s.a(e)), this._image = i, this.setImageFormat(t), i && (i.getWidth && i.getHeight ? this.setTextureSize(i.getWidth(), i.getHeight()) : i.width && i.height && this.setTextureSize(i.width, i.height)), this._textureNull = !1, this.dirty()
        },
        getImage: function () {
            return this._image
        },
        setImageFormat: function (e) {
            var t = e;
            t ? ("string" == typeof t && (t = f[t]), this._imageFormat = t) : this._imageFormat = f.RGBA
        },
        setInternalFormatType: function (e) {
            this._type = "string" == typeof e ? f[e] : e
        },
        getInternalFormatType: function () {
            return this._type
        },
        setUnrefImageDataAfterApply: function (e) {
            this._unrefImageDataAfterApply = e
        },
        checkIsCompressed: function (e) {
            switch (e || this._internalFormat) {
                case f.COMPRESSED_RGB_S3TC_DXT1_EXT:
                case f.COMPRESSED_RGBA_S3TC_DXT1_EXT:
                case f.COMPRESSED_RGBA_S3TC_DXT3_EXT:
                case f.COMPRESSED_RGBA_S3TC_DXT5_EXT:
                case f.COMPRESSED_RGB_ATC_WEBGL:
                case f.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:
                case f.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:
                case f.COMPRESSED_RGB_PVRTC_4BPPV1_IMG:
                case f.COMPRESSED_RGB_PVRTC_2BPPV1_IMG:
                case f.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:
                case f.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:
                case f.COMPRESSED_RGB_ETC1_WEBGL:
                    return !0;
                default:
                    return !1
            }
        },
        setInternalFormat: function (e) {
            var t = e;
            t ? ("string" == typeof t && (t = f[t]), this._isCompressed = this.checkIsCompressed(t)) : (this._isCompressed = !1, t = f.RGBA), this._internalFormat = t
        },
        getInternalFormat: function () {
            return this._internalFormat
        },
        isDirtyMipmap: function () {
            return this._dirtyMipmap
        },
        dirtyMipmap: function () {
            this._dirtyMipmap = !0
        },
        applyFilterParameter: function (e, t) {
            if (d(this._textureWidth) && d(this._textureHeight) || (this._wrapT = f.CLAMP_TO_EDGE, this._wrapS = f.CLAMP_TO_EDGE, this._minFilter !== f.LINEAR_MIPMAP_LINEAR && this._minFilter !== f.LINEAR_MIPMAP_NEAREST || (this._minFilter = f.LINEAR)), e.texParameteri(t, e.TEXTURE_MAG_FILTER, this._magFilter), e.texParameteri(t, e.TEXTURE_MIN_FILTER, this._minFilter), this._maxAnisotropy > 1 && f.ANISOTROPIC_SUPPORT_EXT) {
                var i = this._maxAnisotropy < f.ANISOTROPIC_SUPPORT_MAX ? this._maxAnisotropy : f.ANISOTROPIC_SUPPORT_MAX;
                e.texParameterf(t, f.TEXTURE_MAX_ANISOTROPY_EXT, i)
            }
            e.texParameteri(t, e.TEXTURE_WRAP_S, this._wrapS), e.texParameteri(t, e.TEXTURE_WRAP_T, this._wrapT)
        },
        generateMipmap: function (e, t) {
            if (this._dirtyMipmap = !1, this.hasMipmapFilter()) {
                var i = this._image;
                if (i && i.hasMipmap())
                    for (var n = this._getInternalFormatGL(), r = i.getMipmap(), a = 1, o = r.length; a < o; a++) {
                        var s = r[a];
                        this._isCompressed ? this.applyTexImage2D(e, this._textureTarget, a, n, s.getWidth(), s.getHeight(), 0, s.getImage()) : this.applyTexImage2D(e, this._textureTarget, a, n, s.getWidth(), s.getHeight(), 0, this._internalFormat, this._type, s.getImage())
                    } else e.generateMipmap(t)
            }
        },
        hasMipmapFilter: function () {
            return this._minFilter === f.NEAREST_MIPMAP_NEAREST || this._minFilter === f.LINEAR_MIPMAP_NEAREST || this._minFilter === f.NEAREST_MIPMAP_LINEAR || this._minFilter === f.LINEAR_MIPMAP_LINEAR
        },
        applyTexImage2D: function (e) {
            var t = Array.prototype.slice.call(arguments, 1);
            e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL, this._flipY), e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL, this._colorSpaceConversion), this._isCompressed ? e.compressedTexImage2D.apply(e, t) : e.texImage2D.apply(e, t);
            var i = this._applyTexImage2DCallbacks.length;
            if (i > 0)
                for (var n = 0, r = i; n < r; n++) this._applyTexImage2DCallbacks[n].call(this)
        },
        computeTextureFormat: function () {
            this._internalFormat ? this._imageFormat = this._internalFormat : (this._internalFormat = this._imageFormat || f.RGBA, this._imageFormat = this._internalFormat)
        },
        applyImage: function (e) {
            var t = this._getInternalFormatGL(),
                i = this._image || null,
                n = i && this._image.getImage(),
                r = this._getTypeGL();
            this._isCompressed ? this.applyTexImage2D(e, this._textureTarget, 0, t, this._textureWidth, this._textureHeight, 0, n) : !n || i.isTypedArray() ? this.applyTexImage2D(e, this._textureTarget, 0, t, this._textureWidth, this._textureHeight, 0, this._internalFormat, r, n) : this.applyTexImage2D(e, this._textureTarget, 0, t, this._internalFormat, r, n), i && i.setDirty(!1)
        },
        apply: function (e) {
            var t = e.getGraphicContext();
            if (this._dirtyTextureObject && (this.releaseGLObjects(), this._dirtyTextureObject = !1, this.setGraphicContext(t)), void 0 === this._textureObject || this.isDirty())
                if (this._textureNull) t.bindTexture(this._textureTarget, null);
                else {
                    var i = this._image;
                    if (void 0 !== i)
                        if (i.isReady()) {
                            this.computeTextureFormat();
                            var n = i.getWidth() || this._textureWidth,
                                r = i.getHeight() || this._textureHeight;
                            this.setTextureSize(n, r), this._textureObject || this.init(e), this._textureObject.bind(t), this.applyImage(t), this.applyFilterParameter(t, this._textureTarget), this.generateMipmap(t, this._textureTarget), this._unrefImageDataAfterApply && (this._image = void 0), this._dirty = !1
                        } else t.bindTexture(this._textureTarget, null);
                    else 0 !== this._textureHeight && 0 !== this._textureWidth && (this.computeTextureFormat(), this._textureObject || this.init(e), this._textureObject.bind(t), this.applyImage(t), this.applyFilterParameter(t, this._textureTarget), this.generateMipmap(t, this._textureTarget), this._dirty = !1)
                }
            else this._textureObject.bind(t), void 0 !== this._image && this._image.isDirty() && (this.applyImage(t), this.dirtyMipmap()), this.isDirtyMipmap() && this.generateMipmap(t, this._textureTarget)
        },
        _getInternalFormatGL: function () {
            var e = this._internalFormat;
            if (!c.a.instance().isWebGL2()) return m[e] || e;
            var t = g[this._type];
            return t && t[e] || e
        },
        _getTypeGL: function () {
            return this._type !== f.HALF_FLOAT || c.a.instance().isWebGL2() ? this._type : f.HALF_FLOAT_OES
        }
    })), "osg", "Texture"), f.textureNull = new f, f.createFromImage = function (e, t) {
        var i = new f;
        return i.setImage(e, t), i
    }, f.createFromCanvas = function (e, t) {
        return f.createFromImage(e, t)
    }, t.default = f
}, function (e, t, i) {
    "use strict";
    var n = i(11),
        r = new n.a;
    r.PBR_LIT = 1, r.CLASSIC_LIT = 2, r.PBR_SHADELESS = 4, r.CLASSIC_SHADELESS = 8, r.MATCAP = 16, r.INSPECTOR = 32, r.nameMatch = {
        "shadeless-pbr": r.PBR_SHADELESS,
        "shadeless-classic": r.CLASSIC_SHADELESS,
        "lit-pbr": r.PBR_LIT,
        "lit-classic": r.CLASSIC_LIT,
        "shading-ar": r.PBR_LIT,
        "shading-vr": r.PBR_LIT,
        ground: r.INSPECTOR,
        inspector: r.INSPECTOR
    }, r.LIT = r.PBR_LIT | r.CLASSIC_LIT, r.SHADELESS = r.PBR_SHADELESS | r.CLASSIC_SHADELESS, r.PBR = r.PBR_LIT | r.PBR_SHADELESS, r.CLASSIC = r.CLASSIC_LIT | r.CLASSIC_SHADELESS, r.set("mask", r.PBR_LIT), r.set("hasSsr", !1), r.on("change:mask", function () {
        var e = r.get("mask");
        switch (e) {
            case r.PBR_LIT:
            case r.CLASSIC_LIT:
            case r.PBR_SHADELESS:
            case r.CLASSIC_SHADELESS:
            case r.INSPECTOR:
            case r.MATCAP:
                break;
            default:
                console.error("Invalid ShadingGlobal mask value !" + e)
        }
    }), t.a = r
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(20),
        a = n.a.osg,
        o = n.a.osgShader.shaderProcessor,
        s = {
            "utils/common.glsl": i(1198),
            "utils/functions.glsl": i(1199),
            "shadowing/shadowReceive.glsl": i(1200),
            "shadowing/shadowLinearSoft.glsl": i(1201),
            "shadowing/tapPCF.glsl": i(1202),
            "utils/lightCommon.glsl": i(1203),
            "utils/lights.glsl": i(1204),
            "utils/lightsPBR.glsl": i(1205),
            "utils/lightsSSS.glsl": i(1206),
            "utils/skinning.glsl": i(1207),
            "utils/morphing.glsl": i(1208),
            "utils/environment.glsl": i(1209),
            "utils/panoramaLod.glsl": i(1210),
            "utils/cubemapLod.glsl": i(1211),
            "utils/cubemap.glsl": i(1212),
            "utils/rand.glsl": i(1213),
            "utils/curvature.glsl": i(1214),
            "utils/refraction.glsl": i(1215),
            "utils/clearCoat.glsl": i(1216),
            "utils/ssr.glsl": i(1217),
            "utils/material.glsl": i(1218),
            "utils/normalBump.glsl": i(1219),
            "utils/checkerboard.glsl": i(1220),
            "utils/decodeDepth.glsl": i(1221),
            "utils/encodeDepth.glsl": i(1222),
            "utils/encodeDecode.glsl": i(1223),
            "utils/getLuminance.glsl": i(1224),
            "base.vert": i(1225),
            "earlyz.vert": i(1226),
            "earlyz.frag": i(1227),
            "pbr.vert": i(1228),
            "pbr.frag": i(1229),
            "outline.vert": i(1230),
            "outline.frag": i(1231),
            "matcap.vert": i(1232),
            "matcap.frag": i(1233),
            "shadeless.vert": i(1234),
            "shadeless.frag": i(1235),
            "wireframe.vert": i(1236),
            "wireframe.frag": i(1237),
            "inspector/inspector.vert": i(1238),
            "inspector/inspector.frag": i(1239),
            "shadowing/shadowCast.vert": i(1240),
            "shadowing/shadowCast.frag": i(1241),
            "ARKit/shadowAr.vert": i(1242),
            "ARKit/shadowAr.frag": i(1243),
            "webVR/controller.vert": i(1244),
            "webVR/controller.frag": i(1245),
            "debug/boneBox.vert": i(1246),
            "debug/boneBox.frag": i(1247),
            "debug/normal.vert": i(1248),
            "debug/normal.frag": i(1249),
            "debug/tangent.vert": i(1250),
            "debug/tangent.frag": i(1251),
            "debug/skinning.vert": i(1252),
            "debug/skinning.frag": i(1253),
            "debug/geometry.vert": i(1254),
            "debug/geometry.frag": i(1255),
            "ground/ground.vert": i(1256),
            "ground/ground.frag": i(1257),
            "ground/bakeShadowMap.vert": i(1258),
            "ground/bakeShadowMap.frag": i(1259)
        };
    if (o.addShaders(s), !Object(r.a)().rgbm) {
        var u = o.getShaderTextPure("utils/functions.glsl");
        u = u.replace(/encodeRGBM.*\{/, "$&\nreturn vec4(color, 1.0);"), u = u.replace(/decodeRGBM.*\{/, "$&\nreturn color.rgb;"), o.addShaders({
            "utils/functions.glsl": u
        })
    }
    var l = function () {
        this._shaderCache = {}
    };
    l.prototype = {
        getOrCreateShader: function (e, t, i, n, r) {
            var a = "";
            r && (a = r.toString());
            var o = i + a,
                s = this._shaderCache[o];
            return s || (s = this.createShader(e, t, i, n, r), this._shaderCache[o] = s), s
        },
        createShader: function (e, t, i, n, r) {
            var s = "#define SHADER_NAME " + n + "\n";
            if (r)
                if (Array.isArray(r))
                    for (var u = 0; u < r.length; u++) s += "#define " + r[u] + "\n";
                else s += "#define " + r + "\n";
            var l = {};
            return l[i + "-vert"] = s + e, l[i + "-frag"] = s + t, o.addShaders(l), new a.Program(new a.Shader(a.Shader.VERTEX_SHADER, o.getShader(i + "-vert")), new a.Shader(a.Shader.FRAGMENT_SHADER, o.getShader(i + "-frag")))
        }
    }, t.a = new l
}, , , , , , function (e, t) {
    ! function () {
        (window.nunjucksPrecompiled = window.nunjucksPrecompiled || {})["skfb_front/macros/notification.jinja"] = function () {
            function e(e, t, i, n, r) {
                var a = "";
                try {
                    var o = null;
                    a += "\n\n";
                    var s = n.makeMacro(["type", "content"], ["options"], function (r, a, o) {
                        var s = i;
                        i = new n.Frame, o = o || {}, o.hasOwnProperty("caller") && i.set("caller", o.caller), i.set("type", r), i.set("content", a), i.set("options", o.hasOwnProperty("options") ? o.options : {});
                        var u = "";
                        u += "\n\n    ";
                        var l;
                        return l = e.getFilter("merge").call(t, {
                            safecontent: !1
                        }, n.contextOrFrameLookup(t, i, "options")), i.set("options", l, !0), i.topLevel && t.setVariable("options", l), i.topLevel && t.addExport("options", l), u += '\n\n    <div class="flashmessage notification ', u += n.suppressValue(r, e.opts.autoescape), u += '">\n        <div class="inner">\n            <button class="flashmessage-close" data-action="close" title="Close"></button>\n            <div class="message">\n                ', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "safecontent") ? (u += "\n                    ", u += n.suppressValue(e.getFilter("safe").call(t, a), e.opts.autoescape), u += "\n                ") : (u += "\n                    ", u += n.suppressValue(a, e.opts.autoescape), u += "\n                "), u += "\n            </div>\n        </div>\n    </div>\n\n", i = s, new n.SafeString(u)
                    });
                    t.addExport("flashmessage"), t.setVariable("flashmessage", s), a += "\n", o ? o.rootRenderFunc(e, t, i, n, r) : r(null, a)
                } catch (e) {
                    r(n.handleError(e, null, null))
                }
            }
            return {
                root: e
            }
        }()
    }()
}, function (e, t) {
    ! function () {
        (window.nunjucksPrecompiled = window.nunjucksPrecompiled || {})["skfb_front/macros/popovers.jinja"] = function () {
            function e(e, t, i, n, r) {
                var a = "";
                try {
                    var o = null,
                        s = n.makeMacro([], ["options"], function (r) {
                            var a = i;
                            i = new n.Frame, r = r || {}, r.hasOwnProperty("caller") && i.set("caller", r.caller), i.set("options", r.hasOwnProperty("options") ? r.options : {});
                            var o = "";
                            return o += '\n\n    <div class="popover share-popover hidden', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "class") && (o += " ", o += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "class"), e.opts.autoescape)), o += '">\n        <p>Thanks! Also share?</p>\n\n        <a data-action="share-on-facebook" class="share-popover-icon icons-facebook"></a>\n        <a data-action="share-on-twitter" class="share-popover-icon icons-twitter"></a>\n        <a data-action="share-on-google-plus" class="share-popover-icon icons-google"></a>\n        <a data-action="share-on-pinterest" class="share-popover-icon icons-pinterest"></a>\n    </div>\n\n', i = a, new n.SafeString(o)
                        });
                    t.addExport("share_popover"), t.setVariable("share_popover", s), a += "\n", o ? o.rootRenderFunc(e, t, i, n, r) : r(null, a)
                } catch (e) {
                    r(n.handleError(e, null, null))
                }
            }
            return {
                root: e
            }
        }()
    }()
}, , , function (e, t, i) {
    "use strict";
    var n = i(3),
        r = i.n(n),
        a = i(14),
        o = i(34);
    t.a = {
        isMaintenance: function () {
            return r()('meta[property="skfb:maintenance"]').attr("content")
        },
        showPopup: function () {
            var e = "?utm_source=website&utm_campaign=maintenance_error",
                t = 'An unknown error occurred. Please try again later or <a href="' + a.a.hosts.faq + "/requests/new" + e + '&type=website" target="_blank">contact our support team</a> if the problem persists.',
                i = this.isMaintenance(),
                n = new o.default({
                    title: i ? "Maintenance" : "Error",
                    text: i ? 'Sketchfab is undergoing maintenance.<br>See: <a href="https://forum.sketchfab.com/t/sketchfab-operations/6678?utm_source=website&utm_campaign=maintenance_error" target=_blank>Operations forum post</a>' : t,
                    buttons: {
                        ok: !0
                    },
                    safe: !0
                });
            return n.open().then(function () {
                n.close()
            }), n
        }
    }
}, , , , , , , function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(102),
        a = i(317),
        o = i(447),
        s = i(288),
        u = i(84),
        l = i(10),
        c = i(318),
        h = i(571),
        d = i(177),
        f = function () {
            r.a.call(this), this.children = [], this._parents = [], this.nodeMask = -1, this._boundingSphere = new o.a, this._boundingSphereComputed = !1, this._boundingBox = new a.a, this._boundingBoxComputed = !1, this._updateCallbacks = [], this._cullCallback = void 0, this._cullingActive = !0, this._numChildrenWithCullingDisabled = 0, this._numChildrenRequiringUpdateTraversal = 0, this._tmpBox = new a.a
        },
        p = new c.a(l.c.create),
        m = function () {
            var e = p.getOrCreateObject();
            return l.c.identity(e)
        },
        g = new o.a;
    n.a.createPrototypeNode(f, n.a.objectInherit(r.a.prototype, {
        getMinimumBound: function () {
            var e = this.getBoundingBox(),
                t = this.getBoundingSphere();
            return !e.valid() || t.volume() < e.volume() ? t : (g.copyBoundingBox(e), g)
        },
        getOrCreateStateSet: function () {
            return this.stateset || this.setStateSet(new s.a), this.stateset
        },
        getStateSet: function () {
            return this.stateset
        },
        accept: function (e) {
            e.validNodeMask(this) && (e.pushOntoNodePath(this), e.apply(this), e.popFromNodePath())
        },
        dirtyBound: function () {
            if (!0 === this._boundingSphereComputed || !0 === this._boundingBoxComputed) {
                this._boundingSphereComputed = !1, this._boundingBoxComputed = !1;
                for (var e = this._parents, t = 0, i = e.length; t < i; t++) e[t].dirtyBound()
            }
        },
        setNodeMask: function (e) {
            this.nodeMask = e
        },
        getNodeMask: function () {
            return this.nodeMask
        },
        setStateSet: function (e) {
            if (this.stateset !== e) {
                var t = 0;
                this.stateset && (this.stateset.requiresUpdateTraversal() && t--, this.stateset.removeParent(this)), e && (e.addParent(this), e.requiresUpdateTraversal() && ++t), 0 !== t && this.setNumChildrenRequiringUpdateTraversal(this.getNumChildrenRequiringUpdateTraversal() + t), this.stateset = e
            }
        },
        _updateNumChildrenRequeringUpdateTraversal: function (e) {
            if (0 === this._numChildrenRequiringUpdateTraversal && this._parents.length)
                for (var t = 0, i = this._parents.length; t < i; t++) {
                    var n = this._parents[t],
                        r = n.getNumChildrenRequiringUpdateTraversal();
                    n.setNumChildrenRequiringUpdateTraversal(r + e)
                }
        },
        setNumChildrenRequiringUpdateTraversal: function (e) {
            if (this._numChildrenRequiringUpdateTraversal !== e) {
                if (!this._updateCallbacks.length && this._parents.length) {
                    var t = 0;
                    if (this._numChildrenRequiringUpdateTraversal > 0 && --t, e > 0 && ++t, 0 !== t)
                        for (var i = this._parents, n = 0, r = i.length; n < r; n++) {
                            var a = i[n],
                                o = a.getNumChildrenRequiringUpdateTraversal();
                            a.setNumChildrenRequiringUpdateTraversal(o + t)
                        }
                }
                this._numChildrenRequiringUpdateTraversal = e
            }
        },
        getNumChildrenRequiringUpdateTraversal: function () {
            return this._numChildrenRequiringUpdateTraversal
        },
        getUpdateCallback: function () {
            return this._updateCallbacks[0]
        },
        addUpdateCallback: function (e) {
            var t = Boolean(this._updateCallbacks.length);
            this._updateCallbacks.push(e), t || this._updateNumChildrenRequeringUpdateTraversal(1)
        },
        removeUpdateCallback: function (e) {
            var t = this._updateCallbacks.indexOf(e); - 1 !== t && (this._updateCallbacks.splice(t, 1), this._updateCallbacks.length || this._updateNumChildrenRequeringUpdateTraversal(-1))
        },
        getUpdateCallbackList: function () {
            return this._updateCallbacks
        },
        setCullCallback: function (e) {
            this._cullCallback = e
        },
        getCullCallback: function () {
            return this._cullCallback
        },
        hasChild: function (e) {
            for (var t = 0, i = this.children.length; t < i; t++)
                if (this.children[t] === e) return !0;
            return !1
        },
        addChild: function (e) {
            if (-1 === this.children.indexOf(e)) return this.children.push(e), e.addParent(this), this.dirtyBound(), (e.getNumChildrenRequiringUpdateTraversal() > 0 || e.getUpdateCallbackList().length) && this.setNumChildrenRequiringUpdateTraversal(this.getNumChildrenRequiringUpdateTraversal() + 1), (e.getNumChildrenWithCullingDisabled() > 0 || !1 === e.getCullingActive()) && this.setNumChildrenWithCullingDisabled(this.getNumChildrenWithCullingDisabled() + 1), e
        },
        getChildren: function () {
            return this.children
        },
        getNumChildren: function () {
            return this.children.length
        },
        getChild: function (e) {
            return this.children[e]
        },
        getParents: function () {
            return this._parents
        },
        addParent: function (e) {
            this._parents.push(e)
        },
        removeParent: function (e) {
            var t = this._parents.indexOf(e); - 1 !== t && this._parents.splice(t, 1)
        },
        removeChildren: function () {
            var e = this.children,
                t = e.length;
            if (t) {
                for (var i = 0, n = 0; n < t; n++) {
                    var r = e[n];
                    r.removeParent(this), (r.getNumChildrenRequiringUpdateTraversal() > 0 || r.getUpdateCallbackList().length) && ++i
                }
                e.length = 0, i && this.setNumChildrenRequiringUpdateTraversal(this.getNumChildrenRequiringUpdateTraversal() - i), this.dirtyBound()
            }
        },
        removeChild: function (e) {
            var t = this.children,
                i = t.indexOf(e); - 1 !== i && (e.removeParent(this), t.splice(i, 1), this.dirtyBound(), (e.getNumChildrenRequiringUpdateTraversal() > 0 || e.getUpdateCallbackList().length) && this.setNumChildrenRequiringUpdateTraversal(this.getNumChildrenRequiringUpdateTraversal() - 1))
        },
        traverse: function (e) {
            for (var t = this.children, i = 0, n = t.length; i < n; i++) {
                t[i].accept(e)
            }
        },
        ascend: function (e) {
            for (var t = this._parents, i = 0, n = t.length; i < n; i++) {
                t[i].accept(e)
            }
        },
        getBoundingBox: function () {
            return this._boundingBoxComputed || (this.computeBoundingBox(this._boundingBox), this._boundingBoxComputed = !0), this._boundingBox
        },
        computeBoundingBox: function (e) {
            var t = i(611).default,
                n = t.instance = t.instance || new t;
            return n.setNodeMaskOverride(-1), n.reset(), n.apply(this), e.copy(n.getBoundingBox()), e
        },
        getBoundingSphere: function () {
            return this.getBound()
        },
        getBound: function () {
            return this._boundingSphereComputed || (this.computeBoundingSphere(this._boundingSphere), this._boundingSphereComputed = !0), this._boundingSphere
        },
        computeBoundingSphere: function (e) {
            var t = this.children,
                i = t.length;
            if (e.init(), 0 === i) return e;
            var n, r, a = this._tmpBox;
            for (a.init(), r = 0; r < i; r++) n = t[r], n.referenceFrame !== d.a.ABSOLUTE_RF && a.expandByBoundingSphere(n.getBound());
            if (!a.valid()) return e;
            for (e.set(a.center(e.center()), 0), r = 0; r < i; r++) n = t[r], n.referenceFrame !== d.a.ABSOLUTE_RF && e.expandRadiusBySphere(n.getBound());
            return e
        },
        getWorldMatrices: function () {
            var e = function () {
                this.nodePaths = [], this.halt = void 0, u.a.call(this, u.a.TRAVERSE_PARENTS)
            };
            e.prototype = n.a.objectInherit(u.a.prototype, {
                reset: function () {
                    this.nodePath.length = 0, this.nodePaths.length = 0
                },
                apply: function (e) {
                    0 === e._parents.length || e === this.halt || e.referenceFrame === d.a.ABSOLUTE_RF ? this.nodePaths.push(this.nodePath.slice(0)) : this.traverse(e)
                }
            });
            var t = new e;
            return t.setNodeMaskOverride(-1),
                function (e, i) {
                    t.reset(), t.halt = e, this.accept(t);
                    for (var n = [], r = i || l.c.create, a = 0, o = t.nodePaths.length; a < o; a++) {
                        var s = t.nodePaths[a],
                            u = r();
                        0 !== s.length && h.a.computeLocalToWorld(s, !0, u), n.push(u)
                    }
                    return n
                }
        }(),
        getWorldMatrix: function (e, t) {
            var i = this.getWorldMatrices(e, m);
            return 0 === i.length ? l.c.identity(t) : l.c.copy(t, i[0]), p.reset(), t
        },
        setCullingActive: function (e) {
            if (this._cullingActive !== e) {
                if (0 === this._numChildrenWithCullingDisabled && this._parents.length > 0) {
                    var t = 0;
                    if (this._cullingActive || --t, e || ++t, 0 !== t)
                        for (var i = 0, n = this._parents.length; i < n; i++) this._parents[i].setNumChildrenWithCullingDisabled(this._parents[i].getNumChildrenWithCullingDisabled() + t)
                }
                this._cullingActive = e
            }
        },
        getCullingActive: function () {
            return this._cullingActive
        },
        isCullingActive: function () {
            return 0 === this._numChildrenWithCullingDisabled && this._cullingActive && this.getBound().valid()
        },
        setNumChildrenWithCullingDisabled: function (e) {
            if (this._numChildrenWithCullingDisabled !== e) {
                if (this._cullingActive && this._parents.length > 0) {
                    var t = 0;
                    if (this._numChildrenWithCullingDisabled > 0 && --t, e > 0 && ++t, 0 !== t)
                        for (var i = 0, n = this._parents.length; i < n; i++) this._parents[i].setNumChildrenWithCullingDisabled(this._parents[i].getNumChildrenWithCullingDisabled() + t)
                }
                this._numChildrenWithCullingDisabled = e
            }
        },
        getNumChildrenWithCullingDisabled: function () {
            return this._numChildrenWithCullingDisabled
        },
        releaseGLObjects: function () {
            void 0 !== this.stateset && this.stateset.releaseGLObjects()
        }
    }), "osg", "Node"), t.a = f
}, function (e, t, i) {
    "use strict";
    var n = {};
    n.POINTS = 0, n.LINES = 1, n.LINE_LOOP = 2, n.LINE_STRIP = 3, n.TRIANGLES = 4, n.TRIANGLE_STRIP = 5, n.TRIANGLE_FAN = 6, t.a = n
}, , , function (e, t, i) {
    "use strict";

    function n(e, t, i) {
        return e.filter(i)[0] || t
    }

    function r(e) {
        return Array.prototype.slice.call(e)
    }
    t.a = n, t.b = r
}, , function (e, t, i) {
    "use strict";
    var n = i(82),
        r = i.n(n),
        a = i(83),
        o = i.n(a),
        s = i(7),
        u = i.n(s),
        l = i(144),
        c = i.n(l),
        h = i(437),
        d = i.n(h),
        f = i(5),
        p = i.n(f),
        m = i(65),
        g = i(53),
        v = i(35),
        _ = this,
        b = function (e) {
            return e.match(new RegExp("^(" + window.location.origin + "|/)"))
        },
        S = function (e) {
            return b(e) ? {
                "X-CsrfToken": g.a.get("sb_csrftoken") || "skfb-no-token"
            } : {}
        },
        x = d.a.create({
            headers: {
                "X-Requested-With": "XMLHttpRequest"
            }
        }),
        y = function () {
            return g.a.get("sb_csrftoken") ? p.a.resolve() : x.get("/i/csrf").then(function () {
                return p.a.resolve()
            })
        },
        C = function (e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
                i = t.allowPrefetching,
                n = void 0 === i || i,
                r = t.headers,
                a = void 0 === r ? {} : r,
                o = c()(t, ["allowPrefetching", "headers"]),
                s = m.a.get(e);
            return n && s ? p.a.resolve(s) : p.a.resolve(x.get(e, u()({}, o, {
                headers: u()({}, S(e), a)
            })).then(function (t) {
                var i = t.data;
                return m.a.register(e, i), i
            }))
        },
        T = function () {
            var e = o()(r.a.mark(function e(t, i) {
                var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                    a = n.cacheBusting,
                    o = void 0 === a || a,
                    s = n.headers,
                    l = void 0 === s ? {} : s,
                    h = c()(n, ["cacheBusting", "headers"]);
                return r.a.wrap(function (e) {
                    for (;;) switch (e.prev = e.next) {
                        case 0:
                            if (o && m.a.invalidate(t), !b(t)) {
                                e.next = 4;
                                break
                            }
                            return e.next = 4, y();
                        case 4:
                            return e.abrupt("return", p.a.resolve(x.post(t, i, u()({}, h, {
                                headers: u()({}, S(t), l)
                            })).then(function (e) {
                                return e.data
                            })));
                        case 5:
                        case "end":
                            return e.stop()
                    }
                }, e, _)
            }));
            return function (t, i) {
                return e.apply(this, arguments)
            }
        }(),
        w = function () {
            var e = o()(r.a.mark(function e(t, i) {
                var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                    a = n.cacheBusting,
                    o = void 0 === a || a,
                    s = n.headers,
                    l = void 0 === s ? {} : s,
                    h = c()(n, ["cacheBusting", "headers"]);
                return r.a.wrap(function (e) {
                    for (;;) switch (e.prev = e.next) {
                        case 0:
                            if (o && m.a.invalidate(t), !b(t)) {
                                e.next = 4;
                                break
                            }
                            return e.next = 4, y();
                        case 4:
                            return e.abrupt("return", p.a.resolve(x.request(u()({}, h, {
                                url: t,
                                data: i,
                                method: "DELETE",
                                headers: u()({}, S(t), l)
                            })).then(function (e) {
                                return e.data
                            })));
                        case 5:
                        case "end":
                            return e.stop()
                    }
                }, e, _)
            }));
            return function (t, i) {
                return e.apply(this, arguments)
            }
        }(),
        M = function () {
            var e = o()(r.a.mark(function e(t, i) {
                var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                    a = n.headers,
                    o = void 0 === a ? {} : a,
                    s = c()(n, ["headers"]);
                return r.a.wrap(function (e) {
                    for (;;) switch (e.prev = e.next) {
                        case 0:
                            if (m.a.update(t, i), !b(t)) {
                                e.next = 4;
                                break
                            }
                            return e.next = 4, y();
                        case 4:
                            return e.abrupt("return", p.a.resolve(x.patch(t, i, u()({}, s, {
                                headers: u()({}, S(t), o)
                            })).then(function (e) {
                                return e.data
                            })));
                        case 5:
                        case "end":
                            return e.stop()
                    }
                }, e, _)
            }));
            return function (t, i) {
                return e.apply(this, arguments)
            }
        }(),
        E = function e(t, i, n) {
            return Object(v.a)(x.get(t, {
                headers: u()({}, S(t))
            }).then(function (r) {
                var a = r.status,
                    o = r.data,
                    s = "function" == typeof i ? i(n || 1e3) : i || 1e3;
                return 202 === a || 429 === a ? p.a.delay(s).then(function () {
                    return e(t, i, s)
                }) : o
            }))
        };
    t.a = {
        get: C,
        post: T,
        delete: w,
        patch: M,
        poll: E
    }
}, , function (e, t, i) {
    "use strict";
    var n = i(5),
        r = i.n(n),
        a = i(0),
        o = (i.n(a), i(24)),
        s = i.n(o),
        u = i(35);
    t.a = {
        status: function () {
            return void 0 === this.get("status") ? this.pollStatus() : r.a.resolve(this.get("status"))
        },
        pollStatus: function () {
            return new r.a(function (e, t) {
                s.a.ajax({
                    type: "GET",
                    url: Object(a.result)(this, "url") + "/status",
                    allowPrefetching: !1
                }).then(function (i) {
                    if (!i) return t();
                    var n = {
                        PENDING: 0,
                        PROCESSING: 1,
                        SUCCEEDED: 2,
                        FAILED: 3
                    } [i.processing.toUpperCase()];
                    this.set("status", i), this.set("processingStatus", n), e(i)
                }.bind(this), t)
            }.bind(this))
        },
        checkStatus: function () {
            return this.pollStatus().then(function (e) {
                return -1 !== ["SUCCEEDED", "FAILED"].indexOf(e.processing.toUpperCase()) ? r.a.resolve(e) : r.a.reject(e)
            }.bind(this), function () {
                return this.maxFailCount <= 0 ? r.a.resolve({
                    processing: "FAILED",
                    error: "The server failed to answer in time"
                }) : (this.maxFailCount -= 1, r.a.reject("Server responded with an error"))
            }.bind(this))
        },
        checkStatusAndRetry: function () {
            return u.d(1 / 0, this.checkStatus.bind(this), {
                interval: 2e3
            })
        }
    }
}, , function (e, t, i) {
    "use strict";
    var n = "undefined" != typeof global,
        r = function () {
            return n
        };
    t.a = r
}, , function (e, t, i) {
    "use strict";
    var n = i(24),
        r = i.n(n),
        a = i(9),
        o = i(1137),
        s = i.n(o),
        u = i(1138),
        l = i.n(u),
        c = i(0),
        h = (i.n(c), a.a.osg),
        d = Object(c.invert)(a.a.osg.CullFace),
        f = r.a.Model,
        p = function (e) {
            return Array.isArray(e) || e instanceof Int8Array || e instanceof Uint8Array || e instanceof Uint8ClampedArray || e instanceof Int16Array || e instanceof Uint16Array || e instanceof Int32Array || e instanceof Uint32Array || e instanceof Float32Array || e instanceof Float64Array
        },
        m = f.extend({
            initialize: function () {
                if (f.prototype.initialize.apply(this, arguments), this._featureSchema = this.getSubSchema(this.getModelOptionPath()), this._featureSchema) {
                    this._typeMap = {}, this._buildTypeMap(this._featureSchema, this._typeMap);
                    var e = this.getInstance();
                    this.initDefaults(e)
                }
            },
            getModelOptionPath: function () {
                return ""
            },
            getSubSchema: function (e, t) {
                for (void 0 === t && (t = !0), e = e ? 0 === e.indexOf("#") ? e.substring(2).replace(/\//g, ".") : "properties." + e.replace(/\./g, ".properties.") : "properties"; e.indexOf(":") > 0;) {
                    var i = e.split(":"),
                        n = this._getAttribute(s.a, i[0]);
                    if (n.patternProperties) {
                        var r = i[1].indexOf(".");
                        r < 0 && (r = i[1].length);
                        var a = i[1].substring(0, r),
                            o = Object.keys(n.patternProperties)[a];
                        e = e.replace(":" + a, ".patternProperties." + o)
                    }
                }
                var u = this._getAttribute(s.a, e);
                if (u && t)
                    if (0 === e.indexOf("definition")) {
                        u.definitions = Object(c.merge)({}, s.a.definitions);
                        var l = e.split(".");
                        l = l[l.length - 1], delete u.definitions[l]
                    } else u.definitions = s.a.definitions;
                return u
            },
            _getAttribute: function (e, t) {
                for (var i = t.split("."); i.length && (e = e[i.shift()]););
                return e
            },
            getInstance: function (e) {
                return e || (e = this._featureSchema), this._instantiateFromSchema(e)
            },
            _getRequiredFields: function (e) {
                var t = e.required ? e.required.slice() : void 0;
                return e.oneOf && e.oneOf.length && e.oneOf[0].required && e.oneOf[0].required.length && t.push(e.oneOf[0].required[0]), t
            },
            _instantiateFromSchema: function (e) {
                if ("object" === e.type) {
                    var t = {},
                        i = this._getRequiredFields(e);
                    e = e.properties ? e.properties : e;
                    for (var n in e)
                        if (!(i && i.indexOf(n) < 0)) {
                            var r = e[n];
                            t[n] = this._instantiateAttribute(r)
                        } return t
                }
                return this._instantiateAttribute(e)
            },
            _instantiateAttribute: function (e) {
                var t = e.default;
                if (e.$ref) {
                    var i = e.$ref,
                        n = this.getSubSchema(i, !1),
                        r = this._instantiateFromSchema(n);
                    return t && ("object" == typeof t ? Object(c.merge)(r, t) : r = t), r
                }
                if (e.type) {
                    if (t && "array" !== e.type) return t;
                    switch (e.type) {
                        case "object":
                            return this._instantiateFromSchema(e);
                        case "array":
                            var a;
                            if (a = e.minItems ? new Array(e.minItems) : [], e.items)
                                for (var o = e.items, s = 0; s < a.length; s++) Array.isArray(e.items) && (o = e.items[Object.keys(e.items)[s]]), a[s] = this._instantiateFromSchema(o);
                            return a;
                        case "number":
                        case "integer":
                            return 0;
                        case "boolean":
                            return !1;
                        case "string":
                            return e.enum ? e.enum[0] : ""
                    }
                }
            },
            validate: function (e, t) {
                var i = this._validator,
                    n = t && t.schema || this._featureSchema;
                i || (i = new l.a({
                    allErrors: !0,
                    removeAdditional: !0
                }).compile(n), this._validator = i);
                var r = [];
                if (i(e)) return r;
                for (var a = 0; a < i.errors.length; a++) {
                    var o = i.errors[a],
                        s = o.dataPath.substring(1);
                    s.indexOf("]") >= 0 && (s = s.replace(/]/g, ""));
                    var u;
                    if ("type" === o.keyword) {
                        if (null === (u = this._getAttribute(e, s)) || void 0 === u) continue;
                        if (p(u)) continue
                    }
                    "pattern" === o.keyword && (u = this._getAttribute(e, s), -1 !== s.indexOf("texture.uid") && -1 !== u.indexOf("tmp_")) || "required" !== o.keyword && r.push(this._formatErrorMessage(o, s, t))
                }
                return r
            },
            _formatErrorMessage: function (e, t, i) {
                var n;
                i && i.context && (n = i.context);
                var r = n ? n + ": " : "";
                if (r += t.length ? '"' + t + '" ' : "", r += e.message, "enum" === e.keyword) {
                    r += ": ";
                    for (var a = 0; a < e.params.allowedValues.length; a++) {
                        r += e.params.allowedValues[a] + ", "
                    }
                } else "additionalProperties" === e.keyword && (r += " (" + e.params.additionalProperty + ")");
                return r
            },
            setJSON: function (e, t) {
                if (!this._featureSchema) return ["Json Schema not initialized"];
                this._adaptJSON && this._adaptJSON(e);
                var i, n = t || {};
                if (n.schema ? (i = {}, this._buildTypeMap(n.schema, i)) : (n.schema = this._featureSchema, i = this._typeMap), n.validate) {
                    var r = this.validate(e, n);
                    if (r.length) {
                        if (!n.warnOnError) return console.error("Failed to validate json", e, r), r.join("\n");
                        console.warn("Failed to validate json", e), console.warn(r.join("\n"))
                    }
                }
                var a = this._flattenObject(e, i, n);
                return this.set(a), []
            },
            _buildTypeMap: function (e, t) {
                if (e.properties) {
                    var i = e.properties;
                    for (var n in i) {
                        var r = i[n];
                        "object" === r.type ? (t[n] = {}, this._buildTypeMap(r, t[n])) : r.type ? t[n] = r.type : r.$ref && (t[n] = r.$ref)
                    }
                } else e.$ref && this._buildTypeMap(this.getSubSchema(e.$ref, !1), t)
            },
            initDefaults: function (e) {
                if (e) {
                    var t = this._flattenObject(e, this._typeMap);
                    this.set(t)
                }
            },
            getJSON: function (e) {
                if (!this._featureSchema) return ["Json Schema not initialized"];
                var t = this.getInstance();
                if (e && e.ignore)
                    for (var i = 0; i < e.ignore.length; i++) {
                        var n = e.ignore[i];
                        delete t[n]
                    }
                return this._populate(t, this._typeMap, "", e), t
            },
            _flattenObject: function (e, t, i) {
                var n = {},
                    r = i && i.ignore ? i.ignore : void 0;
                for (var a in t)
                    if (e.hasOwnProperty(a) && !(r && r.indexOf(a) >= 0))
                        if ("object" == typeof t[a]) {
                            var o = this._flattenObject(e[a], t[a], i);
                            for (var s in o) o.hasOwnProperty(s) && (n[a + s.charAt(0).toUpperCase() + s.slice(1)] = o[s])
                        } else void 0 !== e[a] && (n[a] = this._toModelType(e[a], t[a]));
                return n
            },
            _toModelType: function (e, t) {
                return void 0 === e ? e : t.indexOf("vec2") > 0 || t.indexOf("unitVec2") > 0 ? h.vec2.clone(e) : t.indexOf("vec3") > 0 || t.indexOf("unitVec3") > 0 ? h.vec3.clone(e) : t.indexOf("vec4") > 0 || t.indexOf("unitVec4") > 0 ? h.vec4.clone(e) : t.indexOf("quaternion") > 0 ? h.quat.clone(e) : t.indexOf("matrix") > 0 ? h.mat4.clone(e) : t.indexOf("cullFace") > 0 ? h.CullFace[e] : e
            },
            _toJsonType: function (e, t) {
                return t.indexOf("vec2") > 0 || t.indexOf("unitVec2") > 0 || t.indexOf("vec3") > 0 || t.indexOf("unitVec3") > 0 || t.indexOf("vec4") > 0 || t.indexOf("unitVec4") > 0 || t.indexOf("quaternion") > 0 || t.indexOf("matrix") > 0 ? Array.prototype.slice.call(e) : t.indexOf("cullFace") > 0 ? d[e] : e
            },
            _populate: function (e, t, i, n) {
                for (var r in t)
                    if (!(n && n.ignore && n.ignore.indexOf(r) >= 0)) {
                        var a = i ? i + r.charAt(0).toUpperCase() + r.slice(1) : r;
                        if ("object" == typeof t[r]) this._populate(e[r], t[r], a);
                        else {
                            var o = this.get(a);
                            void 0 !== o && (e[r] = this._toJsonType(o, t[r]))
                        }
                    }
            }
        });
    t.a = m
}, , , function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(119),
        a = n.a.osg,
        o = ["Inspector", "Matcap", "Displacement", "Opacity", "SubsurfaceScattering", "SubsurfaceTranslucency", "DiffuseColor", "DiffusePBR", "AlbedoPBR", "ClearCoat", "ClearCoatRoughness", "ClearCoatNormalMap", "SpecularColor", "DiffuseIntensity", "SpecularPBR", "MetalnessPBR", "GlossinessPBR", "RoughnessPBR", "NormalMap", "BumpMap", "AOPBR", "EmitColor", "CavityPBR", "SpecularHardness", "SpecularF0"],
        s = function (e) {
            switch (e) {
                case "Matcap":
                    return r.a.MATCAP;
                case "SubsurfaceScattering":
                case "SubsurfaceTranslucency":
                    return r.a.LIT;
                case "Opacity":
                case "Displacement":
                    return r.a.LIT | r.a.SHADELESS | r.a.MATCAP | r.a.INSPECTOR;
                case "EmitColor":
                    return r.a.LIT | r.a.SHADELESS;
                case "NormalMap":
                case "BumpMap":
                    return r.a.LIT | r.a.MATCAP;
                case "DiffusePBR":
                case "AlbedoPBR":
                case "AOPBR":
                case "CavityPBR":
                    return r.a.PBR;
                case "SpecularPBR":
                case "MetalnessPBR":
                case "GlossinessPBR":
                case "RoughnessPBR":
                case "SpecularF0":
                case "ClearCoat":
                case "ClearCoatRoughness":
                case "ClearCoatNormalMap":
                    return r.a.PBR_LIT;
                case "DiffuseColor":
                case "DiffuseIntensity":
                    return r.a.CLASSIC;
                case "SpecularColor":
                case "SpecularHardness":
                    return r.a.CLASSIC_LIT;
                case "Inspector":
                    return r.a.INSPECTOR
            }
        },
        u = function (e) {
            switch (e) {
                case "DiffuseColor":
                case "DiffusePBR":
                case "AlbedoPBR":
                case "EmitColor":
                case "SpecularColor":
                case "SpecularPBR":
                case "Matcap":
                case "Inspector":
                    return !0;
                default:
                    return !1
            }
        },
        l = function (e) {
            switch (e) {
                case "DiffuseColor":
                case "DiffuseIntensity":
                case "SpecularColor":
                case "NormalMap":
                case "EmitColor":
                case "DiffusePBR":
                case "AlbedoPBR":
                case "SpecularPBR":
                case "Matcap":
                case "Inspector":
                case "ClearCoatNormalMap":
                    return a.Texture.RGB;
                case "SpecularHardness":
                case "BumpMap":
                case "GlossinessPBR":
                case "RoughnessPBR":
                case "MetalnessPBR":
                case "SpecularF0":
                case "AOPBR":
                case "CavityPBR":
                case "Displacement":
                case "SubsurfaceScattering":
                case "SubsurfaceTranslucency":
                case "ClearCoat":
                case "ClearCoatRoughness":
                    return a.Texture.LUMINANCE;
                case "Opacity":
                    return a.Texture.ALPHA;
                default:
                    return console.error("unknown channel: " + e), a.Texture.RGB
            }
        },
        c = function (e) {
            var t = l(e);
            return t === a.Texture.RGB ? "rgb" : t === a.Texture.LUMINANCE ? "r" : t === a.Texture.ALPHA ? "a" : "rgba"
        },
        h = function (e) {
            var t = l(e);
            return t === a.Texture.RGB ? "RGB" : t === a.Texture.LUMINANCE ? "LUMINANCE" : t === a.Texture.ALPHA ? "ALPHA" : "RGBA"
        },
        d = function (e) {
            return l(e) === a.Texture.RGB ? 3 : 1
        },
        f = function (e) {
            var t = {};
            switch (e) {
                case "NormalMap":
                case "SpecularPBR":
                case "ClearCoatNormalMap":
                    t.RGB = "RGB";
                    break;
                case "SpecularHardness":
                case "BumpMap":
                case "GlossinessPBR":
                case "RoughnessPBR":
                case "MetalnessPBR":
                case "SpecularF0":
                case "AOPBR":
                case "CavityPBR":
                case "Displacement":
                case "SubsurfaceScattering":
                case "SubsurfaceTranslucency":
                case "ClearCoat":
                case "ClearCoatRoughness":
                    t.LUMINANCE = "Luminance";
                    break;
                case "DiffuseColor":
                case "DiffuseIntensity":
                case "SpecularColor":
                case "EmitColor":
                case "DiffusePBR":
                case "AlbedoPBR":
                case "Matcap":
                case "Inspector":
                    t.LUMINANCE = "Luminance", t.RGB = "RGB";
                    break;
                case "Opacity":
                    t.ALPHA = "Alpha", t.LUMINANCE = "Luminance";
                    break;
                default:
                    return console.error("unknown channel: " + e), a.Texture.RGB
            }
            return t
        },
        p = function (e) {
            switch (e) {
                case "DiffuseColor":
                case "DiffusePBR":
                case "AlbedoPBR":
                case "Inspector":
                    return 0;
                case "EmitColor":
                    return 1;
                case "SpecularColor":
                case "SpecularPBR":
                    return 2;
                case "DiffuseIntensity":
                    return 3;
                default:
                    return -1
            }
        },
        m = function (e) {
            var t = {};
            return "Displacement" !== e && (t.LINEAR_MIPMAP_LINEAR = "Trilinear (best)", t.NEAREST_MIPMAP_LINEAR = "Nearest (mipmap)"), t.LINEAR = "Bilinear", t.NEAREST = "Nearest", t
        },
        g = function (e) {
            return "SubsurfaceScattering" === e ? .2 : "SubsurfaceTranslucency" === e ? .2 : "Displacement" === e ? 1 : -1
        },
        v = function (e) {
            for (var t = {}, i = 0, n = o.length; i < n; ++i) {
                var r = o[i];
                t[r] = e(r)
            }
            return function (e) {
                return t[e]
            }
        };
    o.getShadingMask = v(s), o.isSRGB = v(u), o.getDefaultFormatEnum = v(l), o.getDefaultFormatComponent = v(c), o.getDefaultFormatString = v(h), o.getDefaultComponentCount = v(d), o.getPossibleFormat = v(f), o.getPossibleFiltering = v(m), o.getColorPacking = v(p), o.getBoxFactor = v(g), t.a = o
}, function (e, t, i) {
    i(21),
        function () {
            (window.nunjucksPrecompiled = window.nunjucksPrecompiled || {})["skfb_front/popups/message.jinja"] = function () {
                function e(e, t, i, n, r) {
                    var a = "";
                    try {
                        var o = null;
                        e.getTemplate("skfb_front/layouts/popup.jinja", !0, "skfb_front/popups/message.jinja", !1, function (s, u) {
                            if (s) return void r(s);
                            o = u;
                            for (var l in o.blocks) t.addBlock(l, o.blocks[l]);
                            a += "\n\n";
                            var c;
                            if (c = n.contextOrFrameLookup(t, i, "title"), i.set("popupTitle", c, !0), i.topLevel && t.setVariable("popupTitle", c), i.topLevel && t.addExport("popupTitle", c), a += "\n\n", !n.contextOrFrameLookup(t, i, "popupClass")) {
                                a += "\n    ";
                                var h;
                                h = "popup-message", i.set("popupClass", h, !0), i.topLevel && t.setVariable("popupClass", h), i.topLevel && t.addExport("popupClass", h), a += "\n"
                            }
                            a += "\n\n", (o ? function (e, t, i, n, r) {
                                r("")
                            } : t.getBlock("popup_content"))(e, t, i, n, function (s, u) {
                                if (s) return void r(s);
                                a += u, a += "\n\n", (o ? function (e, t, i, n, r) {
                                    r("")
                                } : t.getBlock("popup_footer"))(e, t, i, n, function (s, u) {
                                    if (s) return void r(s);
                                    a += u, a += "\n", o ? o.rootRenderFunc(e, t, i, n, r) : r(null, a)
                                })
                            })
                        })
                    } catch (e) {
                        r(n.handleError(e, null, null))
                    }
                }

                function t(e, t, i, n, r) {
                    var a = "";
                    try {
                        var i = i.push(!0);
                        a += "\n\n    ", n.contextOrFrameLookup(t, i, "safe") ? (a += "\n        ", a += n.suppressValue(e.getFilter("safe").call(t, n.contextOrFrameLookup(t, i, "text")), e.opts.autoescape), a += "\n    ") : (a += "\n        ", a += n.suppressValue(n.contextOrFrameLookup(t, i, "text"), e.opts.autoescape), a += "\n    "), a += "\n\n", r(null, a)
                    } catch (e) {
                        r(n.handleError(e, null, null))
                    }
                }

                function i(e, t, i, n, r) {
                    var a = "";
                    try {
                        var i = i.push(!0);
                        a += '\n    <div class="actions">\n\n        ', a += "\n        ", a += "\n\n        ", n.memberLookup(n.contextOrFrameLookup(t, i, "buttons"), "cancel") && (a += '\n            <button class="button btn-medium btn-tertiary cancel', n.memberLookup(n.contextOrFrameLookup(t, i, "buttons"), "cancelClass") && (a += " ", a += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "buttons"), "cancelClass"), e.opts.autoescape)), a += '" type="reset">', a += n.suppressValue(e.getFilter("default").call(t, n.memberLookup(n.contextOrFrameLookup(t, i, "buttons"), "cancelLabel"), "Cancel"), e.opts.autoescape), a += "</button>\n        "), a += "\n\n        ", n.memberLookup(n.contextOrFrameLookup(t, i, "buttons"), "close") && (a += '\n            <button class="button btn-medium btn-tertiary', n.memberLookup(n.contextOrFrameLookup(t, i, "buttons"), "cancelClass") && (a += " ", a += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "buttons"), "closeClass"), e.opts.autoescape)), a += '" type="reset" data-action="close">', a += n.suppressValue(e.getFilter("default").call(t, n.memberLookup(n.contextOrFrameLookup(t, i, "buttons"), "closeLabel"), "Close"), e.opts.autoescape), a += "</button>\n        "), a += "\n\n        ", n.memberLookup(n.contextOrFrameLookup(t, i, "buttons"), "continue") && (a += '\n            <button class="button btn-medium btn-primary submit', n.memberLookup(n.contextOrFrameLookup(t, i, "buttons"), "continueClass") && (a += " ", a += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "buttons"), "continueClass"), e.opts.autoescape)), a += '" type="submit">', a += n.suppressValue(e.getFilter("default").call(t, n.memberLookup(n.contextOrFrameLookup(t, i, "buttons"), "continueLabel"), "Continue"), e.opts.autoescape), a += "</button>\n        "), a += "\n\n        ", n.memberLookup(n.contextOrFrameLookup(t, i, "buttons"), "ok") && (a += '\n            <button class="button btn-medium btn-primary submit', n.memberLookup(n.contextOrFrameLookup(t, i, "buttons"), "okClass") && (a += " ", a += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "buttons"), "okClass"), e.opts.autoescape)), a += '" type="submit">', a += n.suppressValue(e.getFilter("default").call(t, n.memberLookup(n.contextOrFrameLookup(t, i, "buttons"), "okLabel"), "OK"), e.opts.autoescape), a += "</button>\n        "), a += "\n\n        ", n.memberLookup(n.contextOrFrameLookup(t, i, "buttons"), "delete") && (a += '\n            <button class="button btn-medium btn-danger submit', n.memberLookup(n.contextOrFrameLookup(t, i, "buttons"), "deleteClass") && (a += " ", a += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "buttons"), "deleteClass"), e.opts.autoescape)), a += '" type="submit">', a += n.suppressValue(e.getFilter("default").call(t, n.memberLookup(n.contextOrFrameLookup(t, i, "buttons"), "deleteLabel"), "Delete"), e.opts.autoescape), a += "</button>\n        "), a += "\n\n    </div>\n", r(null, a)
                    } catch (e) {
                        r(n.handleError(e, null, null))
                    }
                }
                return {
                    b_popup_content: t,
                    b_popup_footer: i,
                    root: e
                }
            }()
        }()
}, , , , , function (e, t, i) {
    "use strict";

    function n(e) {
        return e[0].toUpperCase() + e.slice(1)
    }

    function r(e, t, i) {
        t.mixins.forEach(function (n) {
            n[e] && n[e].apply(t, i)
        })
    }

    function a(e, t) {
        if (!e.name) throw new Error("Every mixin should have a `name` property. Check https://sketchfab.atlassian.net/wiki/display/DOC/Mixins for more info");
        e.dependencies && e.dependencies.forEach(function (i) {
            if (-1 === t.mixins.map(Object(h.f)("name")).indexOf(i)) throw new Error("You must include the " + i + " mixin in order to use the " + e.name + " mixin. Check https://sketchfab.atlassian.net/wiki/display/DOC/Mixins for more info")
        })
    }

    function o(e, t) {
        var i = function (e) {
            return function () {
                if (t.prototype[e]) {
                    var i = t.prototype[e].apply(this, arguments);
                    return r(e, this, arguments), i
                }
                r(e, this, arguments)
            }
        };
        return e.reduce(function (e, t) {
            var r = "after" + n(t),
                a = "before" + n(t),
                o = i(t),
                s = i(a),
                u = i(r);
            return e[t] = o, e[a] = s, e[r] = u, e
        }, {})
    }

    function s(e) {
        var t = e || [];
        return function (e) {
            return e.extend(Object(c.extend)(o(t, e), {
                mixins: e.prototype.mixins || [],
                constructor: function () {
                    Array.isArray(this.mixins) ? this.mixins.forEach(function (e) {
                        a(e, this), Object(c.defaults)(this, Object(c.cloneDeep)(Object(c.omit)(e, ["name", "dependencies", "constructor"].concat(t))))
                    }.bind(this)) : (this.mixins = [], console.error("Mixinable instances must have a `mixins` property of type Array.", "Check https://sketchfab.atlassian.net/wiki/display/DOC/Mixins for more info")), t.forEach(function (e) {
                        var t = "after" + n(e),
                            i = "before" + n(e),
                            r = this[e];
                        this[e] = function () {
                            this[i].apply(this, arguments);
                            var e = r.apply(this, arguments);
                            return this[t].apply(this, arguments), e
                        }
                    }.bind(this)), r("constructor", this, arguments), e.apply(this, arguments)
                }
            }), {
                extend: function (t, i) {
                    var n = t.mixins || [],
                        r = l()({}, t, {
                            mixins: this.prototype.mixins.filter(function (e) {
                                return n.every(function (t) {
                                    return t.name !== e.name
                                })
                            }).concat(n)
                        });
                    return e.extend.call(this, r, i)
                }
            })
        }
    }
    t.a = s;
    var u = i(7),
        l = i.n(u),
        c = i(0),
        h = (i.n(c), i(23))
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(69),
        a = i(103),
        o = i(444),
        s = i(635),
        u = i(179),
        l = i(44),
        c = n.a.osg,
        h = n.a.osgUtil,
        d = function () {
            c.NodeVisitor.call(this), this.setNodeMaskOverride(-1)
        };
    d.prototype = c.objectInherit(c.NodeVisitor.prototype, {
        apply: function (e) {
            e.setShape && e.setShape(null), this.traverse(e)
        }
    });
    var f = {
        init: function (e, t) {
            rip(t), this._context = e, this._viewer = e.getViewer(), this._viewerOSGJS = this._viewer.getViewerOSGJS(), this._features = this._context.getFeatures(), this._rootModel = t, c.time("compute KdTree"), this.computeKdTree(t), c.timeEnd("compute KdTree"), this._initialized = !0
        },
        isInitialized: function () {
            return this._initialized
        },
        getViewport3d: function () {
            return this._features.postProcess.getCamera().getViewport()
        },
        getMaterialFromHit: function (e) {
            return this._features.material.getModel().findFirstMaterial(e._nodePath)
        },
        decodeDepth: function (e) {
            if (255 === e[0]) return 1;
            var t = e[0] + e[1] / 255;
            return 3 & e && (t += e[2] / 65025), t / 255
        },
        pickDepth: function () {
            var e = new Uint8Array(4);
            return function (t, i, n) {
                return t.readPixels(i, n, 1, 1, t.RGBA, t.UNSIGNED_BYTE, e), this.decodeDepth(e)
            }
        }(),
        getWorldPositionFromDepthXY: function () {
            var e = c.vec4.create(),
                t = c.mat4.create();
            return function (i, n, r, a) {
                var o = this._viewerOSGJS.getCamera(),
                    s = this._viewer.getFeaturesManager().getViewport3d(),
                    l = u.a.uNearFar.getInternalArray(),
                    h = l[0] + (l[1] - l[0]) * i;
                return e[0] = (n / s.width() * 2 - 1) * h, e[1] = (r / s.height() * 2 - 1) * h, e[2] = 1, e[3] = h, c.mat4.invert(t, o.getProjectionMatrix()), c.vec4.transformMat4(e, e, t), c.mat4.invert(t, o.getViewMatrix()), c.vec3.transformMat4(a || c.vec3.create(), e, t)
            }
        }(),
        getPixelDepth: function (e, t, i) {
            l.a.draw();
            var n = this._features.quality.getModel(),
                r = n.get("dynamicResolutionScaling")[0];
            s.a.setCallbackDepth(function (a) {
                s.a.setCallbackDepth(void 0);
                var o = a.getGraphicContext();
                if (o.checkFramebufferStatus(o.FRAMEBUFFER) !== o.FRAMEBUFFER_COMPLETE) return i(-1);
                o.flush(), o.finish();
                var u = n.get("dynamicResolutionScaling")[0];
                r !== u && (e = e * u / r, t = t * u / r);
                var l = this.pickDepth(o, e, t, i);
                i(l, e, t, o)
            }.bind(this))
        },
        _computeIntersections3D: function () {
            var e = new h.IntersectionVisitor,
                t = new h.LineSegmentIntersector;
            return function (i, n, o, s) {
                s || (s = this._features.webVR.getNode()), void 0 === o && (o = r.a.PICK_GEOMETRY_SLOW), e.reset(), t.reset();
                var u = this._features.shadingStyle,
                    l = u && u.getModel().get("hasLines"),
                    c = u && u.getModel().get("hasPoints"),
                    h = .005 * a.a.getModelBoxWithoutDisplacement().radius(),
                    d = c || l ? h : 0;
                return e.setTraversalMask(o), e.setIntersector(t), t.set(i, n, d), s.accept(e), t.getIntersections()
            }
        }(),
        computeNearestIntersection3D: function (e, t, i, n) {
            var r = this._computeIntersections3D(e, t, i, n);
            return this._sortIntersections(r)
        },
        computeNearestIntersection3DHotspotFirst: function (e, t, i, n) {
            var r = this._computeIntersections3D(e, t, i, n);
            if (0 !== r.length) {
                r.sort(function (e, t) {
                    return e._ratio - t._ratio
                });
                var a = 0,
                    o = r.length,
                    s = this._features.hotspot.getWidgetNode();
                for (a = 0; a < o; ++a)
                    if (-1 !== r[a]._nodePath.indexOf(s)) return r[a];
                return this._getFirstVisibleHit(r)
            }
        },
        pickNearestSurface: function (e) {
            return this.computeNearestIntersection2D(e.canvasX, e.canvasY, r.a.PICK_GEOMETRY_SLOW, this._rootModel)
        },
        _computeIntersections2D: function () {
            var e = c.vec3.create(),
                t = c.vec3.create(),
                i = c.mat4.create();
            return function (n, r, a, s) {
                return s || (s = this._features.webVR.getNode()), o.a.canvasCoordToGL(n, r, e), o.a.canvasCoordToGL(n, r, t), e[2] = 0, t[2] = 1, this.getWorldPositionFromScreenPoint(e, e), this.getWorldPositionFromScreenPoint(t, t), s.getWorldMatrix(void 0, i), c.mat4.invert(i, i), c.vec3.transformMat4(e, e, i), c.vec3.transformMat4(t, t, i), this._computeIntersections3D(e, t, a, s)
            }
        }(),
        computeNearestIntersection2D: function (e, t, i, n) {
            var r = this._computeIntersections2D(e, t, i, n);
            return this._sortIntersections(r)
        },
        _sortIntersections: function (e) {
            if (0 !== e.length) return e.sort(function (e, t) {
                return e._ratio - t._ratio
            }), this._getFirstVisibleHit(e)
        },
        _getFirstVisibleHit: function (e) {
            for (var t = 0, i = e.length; t < i; ++t) {
                var n = e[t];
                if (!n._backface) return n;
                for (var r = n._nodePath, a = r.length - 1; a >= 0; --a) {
                    var o = r[a].getStateSet(),
                        s = o && o.getAttribute("CullFace");
                    if (void 0 !== s) {
                        if (s.getMode() === c.CullFace.DISABLE) return n;
                        break
                    }
                }
            }
        },
        getRelativePositionFromHit: function () {
            var e = c.mat4.create(),
                t = c.mat3.create();
            return function (i, n, r, a) {
                for (var o = i._nodePath, s = !1, u = 0, l = o.length; u < l; ++u)
                    if (o[u] === a) {
                        o = o.slice(u), s = !0;
                        break
                    } return c.mat4.identity(e), !1 === s && o[0].getWorldMatrix(a, e), c.computeLocalToWorld(o, !0, e), c.vec3.transformMat4(n, i._localIntersectionPoint, e), r && (c.mat3.normalFromMat4(t, e), c.vec3.transformMat3(r, i._localIntersectionNormal, t), c.vec3.normalize(r, r)), n
            }
        }(),
        getWorldPositionFromHit: function (e, t, i) {
            return this.getRelativePositionFromHit(e, t, i, this._viewerOSGJS.getSceneData())
        },
        getScenePositionFromHit: function (e, t, i) {
            return this.getRelativePositionFromHit(e, t, i, this._rootModel)
        },
        getWorldPositionFromScenePoint: function (e, t) {
            var i = t || c.vec3.create(),
                n = this._features.orientation,
                r = this._features.autospin;
            return n && c.vec3.transformMat4(i, e, n.getNode().getMatrix()), r && c.vec3.transformMat4(i, i, r.getNode().getMatrix()), i
        },
        getScenePositionFromWorldPoint: function () {
            var e = c.mat4.create();
            return function (t, i) {
                var n = i || c.vec3.create(),
                    r = this._features.orientation,
                    a = this._features.autospin;
                return c.mat4.identity(e), r && c.mat4.multiply(e, e, r.getNode().getMatrix()), a && c.mat4.multiply(e, e, a.getNode().getMatrix()), c.mat4.invert(e, e), c.vec3.transformMat4(n, t, e)
            }
        }(),
        getScreenPositionFromScenePoint: function (e, t) {
            var i = this.getWorldPositionFromScenePoint(e, t);
            return this.getScreenPositionFromWorldPoint(i, i)
        },
        getScreenPositionFromWorldPoint: function () {
            var e = c.mat4.create();
            return function (t, i) {
                if (this._viewerOSGJS) {
                    var n = this._viewerOSGJS.getCamera();
                    c.mat4.identity(e), this.getViewport3d().computeWindowMatrix(e), c.mat4.multiply(e, e, n.getProjectionMatrix()), c.mat4.multiply(e, e, n.getViewMatrix());
                    var r = i || c.vec3.create();
                    return c.vec3.transformMat4(r, t, e)
                }
            }
        }(),
        getWorldPositionFromScreenPoint: function () {
            var e = c.mat4.create();
            return function (t, i) {
                var n = this._viewerOSGJS.getCamera();
                c.mat4.identity(e), this.getViewport3d().computeWindowMatrix(e), c.mat4.multiply(e, e, n.getProjectionMatrix()), c.mat4.multiply(e, e, n.getViewMatrix()), c.mat4.invert(e, e);
                var r = i || c.vec3.create();
                return c.vec3.transformMat4(r, t, e)
            }
        }(),
        getScenePositionFromScreenPoint: function (e, t) {
            var i = this.getWorldPositionFromScreenPoint(e, t);
            return this.getScenePositionFromWorldPoint(i, i)
        },
        computeKdTree: function (e) {
            for (var t = this._context.getScene().getWireframeNodes(), i = new d, n = t.length, r = 0; r < n; ++r) t[r].accept(i);
            new c.KdTreeBuilder({
                _numVerticesProcessed: 0,
                _targetNumTrianglesPerLeaf: 50,
                _maxNumLevels: 50
            }).apply(e)
        }
    };
    t.a = f
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(36),
        a = i(137),
        o = i(319),
        s = i(289),
        u = i(680),
        l = i(613),
        c = function () {
            a.a.call(this), this._attributes = {}, this._primitives = [], this._cacheDrawCall = {}, this._useVAO = void 0, this._vao = {}, this._cacheVertexAttributeBufferList = {}, this._shape = void 0
        };
    c.enableVAO = !0, n.a.createPrototypeNode(c, n.a.objectInherit(a.a.prototype, {
        releaseGLObjects: function () {
            void 0 !== this.stateset && this.stateset.releaseGLObjects();
            for (var e in this._attributes) {
                this._attributes[e].releaseGLObjects()
            }
            for (var t = 0, i = this._primitives.length; t < i; t++) {
                var n = this._primitives[t];
                void 0 !== n.getIndices && void 0 !== n.getIndices() && null !== n.getIndices() && n.indices.releaseGLObjects()
            }
            this.releaseVAO()
        },
        releaseVAO: function () {
            if (this._useVAO && this._glContext)
                for (var e in this._vao) this._vao[e] && (this._vao[e].releaseGLObjects(), this._vao[e] = void 0)
        },
        dirty: function () {
            this._cacheDrawCall = {}, this.releaseVAO()
        },
        getPrimitives: function () {
            return this.getPrimitiveSetList()
        },
        getAttributes: function () {
            return this.getVertexAttributeList()
        },
        getShape: function () {
            return this._shape
        },
        setShape: function (e) {
            this._shape = e
        },
        getVertexAttributeList: function () {
            return this._attributes
        },
        getPrimitiveSetList: function () {
            return this._primitives
        },
        setVertexAttribArray: function (e, t) {
            this._attributes[e] !== t && (this._attributes[e] = t, this.dirty())
        },
        _generateVertexSetup: function (e, t, i) {
            for (var n = ["//generated by Geometry::implementation", "state.lazyDisablingOfVertexAttributes();", "var attr;"], r = 0, a = e.length; r < a; r++) n.push("attr = this._attributes['" + e[r] + "'];"), n.push("if ( attr.BufferArrayProxy ) attr = attr.getBufferArray();"), n.push("if ( !attr.isValid() ) return;"), n.push("state.setVertexAttribArray(" + t[r] + ", attr, attr.getNormalize() );");
            return n.push("state.applyDisablingOfVertexAttributes();"), i && n.push("state.setIndexArray( this._primitives[ 0 ].getIndices() );"), n
        },
        _generatePrimitives: function (e, t, i) {
            var n = [t ? "state.enableVertexColor();" : "state.disableVertexColor();"];
            if (i) return n.concat(["var primitive = this._primitives[ " + e[0] + " ];", "var indexes = primitive.getIndices();", "if ( indexes.isDirty() ) {;", "  indexes.bind( gl );", "  indexes.compile( gl );", "};", "primitive.drawElements( state );"]);
            n.push("var primitives = this._primitives;");
            for (var r = 0, a = e.length; r < a; r++) n.push("primitives[" + e[r] + "].draw(state);");
            return n
        },
        generateDrawCommand: function () {
            var e = [],
                t = [];
            return function (i, n, r, a) {
                var o = n._attributesCache,
                    c = this.getVertexAttributeList();
                t.length = 0, e.length = 0;
                var h, d, f, p = this._useVAO,
                    m = p ? [] : void 0,
                    g = !1;
                for (var v in o)
                    if (h = o[v], void 0 !== c[v]) {
                        var _ = this._attributes[v];
                        if (_ instanceof u.a && (_ = _.getBufferArray(), p = !1), !_.isValid()) return;
                        p && m.push(_), g || "Color" !== v || (g = !0), t.push(v), e.push(h)
                    } var b, S;
                if (p) {
                    this._cacheVertexAttributeBufferList[r] = m;
                    var x = 1 === a.length && this._primitives[a[0]] instanceof s.a,
                        y = this._generateVertexSetup(t, e, x);
                    i.clearVertexAttribCache();
                    var C = i.getGraphicContext(),
                        T = new l.a(C);
                    T.create(C), i.setVertexArrayObject(T), this._vao[r] = T;
                    new Function("state", y.join("\n")).call(this, i);
                    var w = ["var gl = state.getGraphicContext();", "var vao = this._vao[ " + r + " ] ", "var hasChanged = state.setVertexArrayObject( vao );", "if ( hasChanged ) {", "  var vaList = this._cacheVertexAttributeBufferList[ " + r + " ];", "  var va;"];
                    for (d = 0, f = m.length; d < f; d++) w.push("  va = vaList[ " + d + "];"), w.push("  if ( va.isDirty() ) {;"), w.push("    va.bind( gl );"), w.push("    va.compile( gl );"), w.push("  };");
                    w.push("}"), b = w.concat(this._generatePrimitives(a, g, x)).join("\n"), S = "GeometryDrawImplementationCacheVAO"
                } else b = this._generateVertexSetup(t, e, !1).concat(this._generatePrimitives(a, g, !1)).join("\n"), S = "GeometryDrawImplementationCache";
                var M = new Function("state", "return function " + S + "( state ) { " + b + "}")();
                return this._cacheDrawCall[r] = M, M
            }
        }(),
        _getValidPrimitives: function () {
            for (var e = [], t = 0; t < this._primitives.length; t++) {
                this._primitives[t].getCount() ? e.push(t) : this._warnInvalidPrimitives || (r.a.warn("geometry with instanceID " + this._instanceID + " has invalid primitives"), this._warnInvalidPrimitives = !0)
            }
            return e
        },
        drawImplementation: function (e) {
            var t = e.getLastProgramApplied(),
                i = t.getInstanceID();
            e.drawGeometry(this);
            var n = this._cacheDrawCall[i];
            if (this._vao[i] ? this._vao[i].isDirty() && (n = void 0) : e.setVertexArrayObject(null), n) return void n.call(this, e);
            if (!this._primitives.length) return void(this._warnNoPrimitives || (r.a.warn("geometry with instanceID " + this._instanceID + " has no primitives"), this._warnNoPrimitives = !0));
            var a = this._getValidPrimitives();
            a.length && (void 0 === this._useVAO && c.enableVAO && (this._useVAO = o.a.instance().hasVAO(), this._glContext = e.getGraphicContext()), n = this.generateDrawCommand(e, t, i, a), n.call(this, e), e.setVertexArrayObject(null))
        },
        setBound: function (e) {
            this._boundingBox = e, this._boundingBoxComputed = !0
        },
        computeBoundingBox: function (e) {
            e.init();
            var t = e.getMin(),
                i = e.getMax(),
                n = this.getVertexAttributeList().Vertex;
            if (n && n.getElements() && n.getItemSize() > 2) {
                for (var r = n.getElements(), a = n.getItemSize(), o = t[0], s = t[1], u = t[2], l = i[0], c = i[1], h = i[2], d = 0, f = r.length; d < f; d += a) {
                    var p = r[d],
                        m = r[d + 1],
                        g = r[d + 2];
                    p < o && (o = p), p > l && (l = p), m < s && (s = m), m > c && (c = m), g < u && (u = g), g > h && (h = g)
                }
                t[0] = o, t[1] = s, t[2] = u, i[0] = l, i[1] = c, i[2] = h
            }
            if (this._displacementFactor) {
                t = e.getMin(), i = e.getMax();
                var v = this._displacementFactor;
                t[0] -= v, t[1] -= v, t[2] -= v, i[0] += v, i[1] += v, i[2] += v
            }
            return e
        },
        computeBoundingSphere: function (e) {
            return e.init(), e.expandByBoundingBox(this.getBoundingBox()), this._displacementFactor && e.set(e.center(), e.radius() + this._displacementFactor), e
        }
    }), "osg", "Geometry"), c.appendVertexAttributeToList = function (e, t, i) {
        for (var n in e) {
            var r = n;
            void 0 !== i && (r += "_" + i), t[r] = e[n]
        }
    }, t.a = c
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(152),
        a = i(119),
        o = i(20),
        s = i(38),
        u = i.n(s),
        l = n.a.osg,
        c = n.a.osgShader.shaderProcessor,
        h = Math.random(),
        d = function (e, t) {
            this._vertDefines = [], this._fragDefines = [], this._vertAssignUV = [], this._envBrdf, this._envSpecular, this._compression, this._material, this._skinning, this._morphing, this._pointSize, this._lights = [], this._shadows = [], this._shadowsTextures = [], this._targetByUnit = [], this.initAttributes(e), this.initTextureAttributes(t);
            var i = this._material ? this._material.getMaterialModel() : void 0;
            this._channels = i ? i.getChannels() : void 0, u.a.apple.device && this._vertDefines.push("#define IS_IOS"), this.defineShaderName(), this.initDefines()
        },
        f = {
            attribute: ["VertexCompression", "SketchfabLight0", "SketchfabLight1", "SketchfabLight2", "SketchfabLight3", "ShadowReceive0", "ShadowReceive1", "ShadowReceive2", "ShadowReceive3", "SketchfabMaterial", "Morph", "Skinning", "PointSize"],
            textureAttribute: ["Texture"]
        };
    l.setStateAttributeConfig(d, f), l.createPrototypeObject(d, {
        getCompilerName: function () {
            return "PBR"
        },
        getFragmentMain: function () {
            return "pbr.frag"
        },
        getVertexMain: function () {
            return "pbr.vert"
        },
        initAttributes: function (e) {
            for (var t = this._lights, i = this._shadows, n = 0, r = e.length; n < r; n++) {
                var a = e[n].className();
                "Light" === a ? t.push(e[n]) : "Material" === a ? this._material = e[n] : "ShadowReceiveAttribute" === a ? i.push(e[n]) : "SkinningAttribute" === a ? this._skinning = e[n] : "MorphAttribute" === a ? this._morphing = e[n] : "PointSizeAttribute" === a ? this._pointSize = e[n] : "VertexCompression" === a && (this._compression = e[n])
            }
        },
        initTextureAttributes: function (e) {
            for (var t = e.length, i = 0; i < t; i++) {
                var n = e[i];
                if (n)
                    for (var r = 0, a = n.length; r < a; r++) {
                        var o = n[r];
                        this._targetByUnit[i] = o;
                        var s = o.className();
                        if ("TextureEnvironment" === s) {
                            var u = o.getChannel();
                            "SpecularPBR" === u ? this._envSpecular = o : "Specular" === u ? this._envSpecular = o : "IntegrateBRDF" === u && (this._envBrdf = o)
                        }
                        "ShadowTexture" !== s && "ShadowTextureAtlas" !== s || this._shadowsTextures.push(o)
                    }
            }
        },
        defineShaderName: function () {
            this._vertDefines.push("#define SHADER_NAME " + this.getVertexShaderName()), this._fragDefines.push("#define SHADER_NAME " + this.getFragmentShaderName());
            var e = (1 - Object(o.a)().epsilonAlpha).toExponential();
            this._fragDefines.push("#define EPSILON_ALPHA " + e)
        },
        getFragmentShaderName: function () {
            var e = this.getCompilerName(),
                t = this._material && this._material.getName();
            t && (t = t.replace(/[^a-zA-Z0-9]+/g, "_").slice(0, 20), e += "(" + t + ")");
            var i, n = this._channels && this._channels.Opacity,
                r = n && n.isEffective() && n.get("type");
            if (i = "alphaBlend" === r || "additive" === r ? "Blend" : "refraction" === r ? "Refract" : "alphaMask" === r || "dithering" === r ? "MaskDither" : "Opaque") {
                var a = this.getCompilerName();
                e = e.replace(a, a + "_" + i)
            }
            return e
        },
        getVertexShaderName: function () {
            return this.getFragmentShaderName()
        },
        getDebugIdentifier: function () {
            var e = this.getVertexShaderName(),
                t = this.getFragmentShaderName();
            return e === t ? t : e + "|" + t
        },
        createShader: function (e) {
            var t = e ? this.getFragmentMain() : this.getVertexMain(),
                i = e ? this._fragDefines : this._vertDefines;
            e || i.push("#define ASSIGN_UV " + this._vertAssignUV.join(" ")), i = c.getSortedUnique(i);
            for (var n = "", r = 0; r < i.length; ++r) i[r] && (n += i[r] + "\n");
            return n = "#define SHADER_NAME " + this.getFragmentShaderName() + "\n" + n, n = n + '#pragma include "' + t + '"', c.processShader(n)
        },
        createFragmentShader: function () {
            return this.createShader(!0)
        },
        createVertexShader: function () {
            return this.createShader(!1)
        },
        getChannelUV: function (e) {
            var t = e.getName();
            if (!e.getTextureModel()) {
                var i = r.a.getColorPacking(t);
                return 0 === i ? "vec2(0.125, 0.5)" : 1 === i ? "vec2(0.375, 0.5)" : 2 === i ? "vec2(0.625, 0.5)" : "vec2(0.875, 0.5)"
            }
            var n = "Displacement" === e.get("name"),
                a = e.getTexCoordUnit(),
                o = "TexCoord" + a;
            if (this._vertDefines.push("attribute vec2 " + o + ";"), n && !this._compression) return o;
            var s = "vTexCoord" + a,
                u = "varying vec2 " + s + ";",
                l = "vec2 " + s + ";";
            if (n) - 1 === this._vertDefines.indexOf(u) && this._vertDefines.push("vec2 " + s + ";");
            else {
                this._fragDefines.push(u), this._vertDefines.push(u);
                var c = this._vertDefines.indexOf(l); - 1 !== c && this._vertDefines.splice(c, 1)
            }
            var h = s + " = ";
            if (this._compression) {
                var d = "uQUV" + a;
                this._vertDefines.push("uniform vec4 " + d + ";"), h += o + ".xy * " + d + ".zw + " + d + ".xy;"
            } else h += o + ";";
            return -1 === this._vertAssignUV.indexOf(h) && this._vertAssignUV.push(h), s
        },
        defineOpacity: function (e) {
            var t = e.get("type");
            return "alphaBlend" === t || "additive" === t ? void this._fragDefines.push("#define HAS_OPACITY_BLEND_OR_ADDITIVE") : "alphaMask" === t || "dithering" === t ? void this._fragDefines.push("#define HAS_OPACITY_MASK_OR_DITHER") : (this._fragDefines.push("#define HAS_OPACITY_REFRACTION"), e.get("useNormalOffset") && this._fragDefines.push("#define HAS_REFRACTION_NORMAL_OFFSET"), e.get("useAlbedoTint") && this._fragDefines.push("#define HAS_REFRACTION_ALBEDO_TINT"), e.get("useMicrosurfaceTexture") && this._fragDefines.push("#define HAS_REFRACTION_MICROSURFACE"), void(Object(o.a)().depthMipmap && this._fragDefines.push("#define DEPTH_MIPMAP")))
        },
        defineChannel: function (e) {
            var t = e.getName();
            if (e.isEnableEffectiveHardware(this._material)) {
                var i = "Displacement" === t ? this._vertDefines : this._fragDefines,
                    n = t.toUpperCase();
                if (i.push("#define HAS_" + n), "NormalMap" === t && this._vertDefines.push("#define HAS_" + n), e.isEffective()) {
                    "NormalMap" !== t && "BumpMap" !== t && "ClearCoatNormalMap" !== t || (this._fragDefines.push("#define HAS_VIEW_TANGENT"), this._vertDefines.push("#define HAS_VIEW_TANGENT")), "Opacity" === t && this.defineOpacity(e), "Displacement" === t && (Object(o.a)().substanceDisplacement ? i.push("#define HAS_SUBSTANCE_DISPLACEMENT") : i.push("#define HAS_SKETCHFAB_DISPLACEMENT"));
                    var a = r.a.getColorPacking(t);
                    if (e.getTextureModel() || !(a < 0)) {
                        var s = this._material.getChannelMapping(t);
                        if (!(void 0 === s || s < 0)) {
                            var u = this._targetByUnit[s],
                                l = u.getName(),
                                c = u.getChannelPacking(t),
                                h = e.getSRGB() ? "sRGBToLinear" : "",
                                d = t.toUpperCase(),
                                f = this.getChannelUV(e);
                            i.push("uniform sampler2D " + l + ";"), i.push("#define SAMPLER_" + d + " " + l), i.push("#define PACK_" + d + " " + c), i.push("#define UV_" + d + " " + f), i.push("#define COLOR_CONVERT_" + d + " " + h)
                        }
                    }
                }
            }
        },
        defineVertexColorAndAlpha: function () {
            if (this._material && this._material.getVertexColorEnable()) {
                this._fragDefines.push("#define HAS_VERTEX_COLOR"), this._vertDefines.push("#define HAS_VERTEX_COLOR");
                var e = "srgb" === this._material.getVertexColorColorSpace() ? "sRGBToLinear" : "";
                this._fragDefines.push("#define COLOR_CONVERT_VERTEX_COLOR " + e), this._material.getVertexAlphaEnable() && (this._fragDefines.push("#define HAS_VERTEX_ALPHA"), this._vertDefines.push("#define HAS_VERTEX_ALPHA"))
            }
        },
        defineLights: function () {
            var e = this._lights;
            if (e.length) {
                for (var t = 0; t < e.length; ++t) {
                    var i = e[t],
                        n = i.getLightNumber(),
                        r = "LIGHT_" + i.getLightType();
                    this._fragDefines.push("#define LIGHT_TYPE_" + n + " " + r)
                }
                this._fragDefines.push("#define HAS_LIGHT")
            }
        },
        defineShadows: function () {
            var e = this._shadows;
            if (e.length) {
                for (var t = 0; t < e.length; ++t) {
                    var i = e[t];
                    this._fragDefines.push("#define HAS_SHADOW_" + i.getLightNumber()), this._fragDefines.push.apply(this._fragDefines, i.getDefines())
                }
                this._fragDefines.push("#define HAS_SHADOW"), this._vertDefines.push("#define HAS_MODEL_VERTEX"), this._vertDefines.push("#define HAS_MODEL_NORMAL")
            }
        },
        defineEnvironment: function () {
            this._envSpecular && (this._fragDefines.push("#define HAS_ENVIRONMENT"), this._envSpecular.getIsCubemap() ? this._fragDefines.push("#define ENV_CUBEMAP") : this._fragDefines.push("#define ENV_PANORAMA")), this._envBrdf && this._fragDefines.push("#define HAS_ENVIRONMENT_BRDF")
        },
        defineSsr: function () {
            a.a.get("hasSsr") && (this._fragDefines.push("#define HAS_SSR"), Object(o.a)().ssrTransparent && this._fragDefines.push("#define HAS_SSR_TRANSPARENT"), Object(o.a)().depthMipmap && -1 === this._fragDefines.indexOf("#define DEPTH_MIPMAP") && this._fragDefines.push("#define DEPTH_MIPMAP"))
        },
        defineSkinning: function () {
            this._skinning && (this._vertDefines.push("#define HAS_SKINNING"), this._vertDefines.push("#define NUM_BONES " + this._skinning.getBoneUniformSize()))
        },
        defineMorphing: function () {
            this._morphing && this._morphing.hasTarget("Vertex") && (this._vertDefines.push("#define HAS_MORPHING"), this._vertDefines.push("#define NUM_TARGETS " + this._morphing.getNumTargets()), this._morphing.hasTarget("Normal") && this._vertDefines.push("#define HAS_MORPHING_NORMAL"), this._morphing.hasTarget("Tangent") && this._vertDefines.push("#define HAS_MORPHING_TANGENT"))
        },
        defineChannels: function () {
            var e = this._channels;
            for (var t in e) this.defineChannel(e[t])
        },
        _randHardcodedScale: function () {
            var e, t = l.BufferArray.randa,
                i = t[0],
                n = t[1],
                r = t[2];
            h > .5 ? e = "* " : (e = "/ ", i = 1 / i, n = 1 / n, r = 1 / r), i = i.toExponential(), n = n.toExponential(), r = r.toExponential();
            var a = Math.random();
            return a < .33 ? e + "vec3(" + r + "," + i + "," + n + ").yzx" : a < .66 ? e + "vec3(" + n + "," + r + "," + i + ").zxy" : e + "vec3(" + r + "," + i + "," + n + ").yzx"
        },
        defineCompression: function () {
            this._compression && Object(o.a)().zz && (this._vertDefines.push("#define RAND_SCALE " + this._randHardcodedScale()), this._vertDefines.push("#define HAS_COMPRESSION"), Object(o.a)().zoct && this._vertDefines.push("#define HAS_OCT_COMPRESSION"), Object(o.a)().zw && this._vertDefines.push("#define HAS_ZW_COMPRESSION"))
        },
        definePointSize: function () {
            this._pointSize && (this._vertDefines.push("#define HAS_POINT_SIZE"), this._pointSize.isCircleShape() && this._fragDefines.push("#define HAS_POINT_CIRCLE"))
        },
        initDefines: function () {
            this.defineChannels(), this.defineVertexColorAndAlpha(), this.defineLights(), this.defineShadows(), this.defineEnvironment(), this.defineSsr(), this.defineMorphing(), this.defineSkinning(), this.defineCompression(), this.definePointSize(), a.a.get("mask") & a.a.CLASSIC && (this._fragDefines.push("#define HAS_LEGACY_CLASSIC"), "PBR" === this.getCompilerName() && (this._fragDefines.push('#pragma include "utils/cubemap.glsl"'), this._fragDefines.push('#pragma include "utils/lights.glsl"')))
        }
    }, "osgSketchfab", "Compiler"), t.a = d
}, , function (e, t, i) {
    "use strict";
    var n = i(434),
        r = i.n(n),
        a = i(14),
        o = i(4),
        s = function (e) {
            var t, i = 0;
            if (0 === e.length) return i;
            for (var n = 0; n < e.length; n++) t = e.charCodeAt(n), i = (i << 5) - i + t, i &= i;
            return i
        };
    t.a = {
        debounceMap: {},
        install: function () {
            var e = {
                ignoreUrls: [/extensions\//i, /^chrome:\/\//i, /^moz-extension:\/\//i, /webtoolbar\//i],
                release: a.a.version
            };
            r.a.setShouldSendCallback(function (e) {
                if (void 0 === e || void 0 === e.message && (void 0 === e.exception || !e.exception.values.length)) return !1;
                if ("plugin.setSuspendState is not a function" === e.message || "undefined" === e.message) return !1;
                if (-1 !== e.message.indexOf("NS_ERROR")) return !1;
                if (e.message.indexOf("undefined") && (-1 !== e.message.indexOf("osgjs/osg/GLObject") || -1 !== e.message.indexOf("window.Map"))) return !1;
                var t = Date.now(),
                    n = "";
                try {
                    n = e.exception.values[0].stacktrace.frames.reduce(function (e, t) {
                        e += t.filename + t.lineno + ";"
                    }, "")
                } catch (e) {}
                var r = s(e.message + n),
                    a = t - this.debounceMap[r] < 500;
                if (this.debounceMap[r] = Date.now(), a) return !1;
                if ((0, i(342).default)() && window.MSInputMethodContext && document.documentMode) return !1;
                var o = navigator.userAgent.toLowerCase();
                return -1 === o.indexOf("msie") || 9 !== parseInt(o.split("msie")[1])
            }.bind(this));
            var t = r.a.config(a.a.sentryDSN, e);
            a.a.useSentry ? t.install() : console.warn("Sentry was not installed ; it is manually disabled.");
            var n = o.a.me();
            return n.isAuthenticated() && r.a.setUserContext({
                uid: n.get("uid"),
                username: n.get("username"),
                email: n.get("email")
            }), r.a
        },
        client: r.a
    }
}, , function (e, t, i) {
    "use strict";
    var n, r = i(334),
        a = i(465);
    n = r.a.extend({
        model: a.a,
        endpoint: "/categories",
        defaultOptions: {
            pageSize: ""
        },
        queryParams: function () {
            return {}
        }
    }), t.a = n
}, , , , , , , , , , , , function (e, t, i) {
    "use strict";
    t.a = {
        RELATIVE_RF: 0,
        ABSOLUTE_RF: 1
    }
}, function (e, t, i) {
    "use strict";
    var n = i(36),
        r = i(12),
        a = i(102),
        o = i(406),
        s = i(315),
        u = i(10),
        l = i(20),
        c = function (e) {
            var t;
            return e instanceof r.a.Float32Array && (t = 5126), e instanceof r.a.Int16Array && (t = 5122), e instanceof r.a.Uint16Array && (t = 5123), e instanceof r.a.Int8Array && (t = 5120), e instanceof r.a.Uint8Array && (t = 5121), e instanceof r.a.Uint8ClampedArray && (t = 5121), e instanceof r.a.Int32Array && (t = 5124), e instanceof r.a.Uint32Array && (t = 5125), t
        },
        h = function (e) {
            i(572).default.logMessage(e)
        },
        d = function (e, t, i) {
            o.a.call(this), this._instanceID = a.a.getInstanceID(), this.dirty(), this._itemSize = i, this._target = "string" == typeof e ? d[e] : e, this._type = void 0, this._normalize = !1, t && (void 0 === t.byteLength && (n.a.warn("BufferArray with non typedArray elements is deprecated"), t = this._target === d.ELEMENT_ARRAY_BUFFER ? new r.a.Uint16Array(t) : new r.a.Float32Array(t)), this.setElements(t)), this._usage = d.STATIC_DRAW
        },
        f = function (e, t) {
            return e + Math.random() * (t - e)
        },
        p = u.f.fromValues(f(.1, 10), f(4.2, 7.5), f(.7, 1.5));
    d.randa = p, d.ELEMENT_ARRAY_BUFFER = 34963, d.ARRAY_BUFFER = 34962, d.STATIC_DRAW = 35044, d.DYNAMIC_DRAW = 35048, d.STREAM_DRAW = 35040, d._sDeletedGLBufferArrayCache = new window.Map, d.deleteGLBufferArray = function (e, t) {
        d._sDeletedGLBufferArrayCache.has(e) || d._sDeletedGLBufferArrayCache.set(e, []), d._sDeletedGLBufferArrayCache.get(e).push(t)
    }, d.flushDeletedGLBufferArrays = function (e, t) {
        if (t <= 0) return t;
        if (!d._sDeletedGLBufferArrayCache.has(e)) return t;
        for (var i = 0, n = s.a.instance().tick(), r = d._sDeletedGLBufferArrayCache.get(e), a = r.length, o = a - 1; o >= 0 && i < t; o--) e.deleteBuffer(r[o]), r.splice(o, 1), i = s.a.instance().deltaS(n, s.a.instance().tick());
        return t - i
    }, d.flushAllDeletedGLBufferArrays = function (e) {
        if (d._sDeletedGLBufferArrayCache.has(e))
            for (var t = d._sDeletedGLBufferArrayCache.get(e), i = t.length, n = i - 1; n >= 0; n--) e.deleteBuffer(t[n]), t.splice(n, 1)
    }, d.onLostContext = function (e) {
        if (d._sDeletedGLBufferArrayCache.has(e)) {
            d._sDeletedGLBufferArrayCache.get(e).length = 0
        }
    }, r.a.createPrototypeObject(d, r.a.objectInherit(o.a.prototype, {
        setUsage: function (e) {
            this._usage = e
        },
        getUsage: function () {
            return this._usage
        },
        getInstanceID: function () {
            return this._instanceID
        },
        setItemSize: function (e) {
            this._itemSize = e
        },
        isValid: function () {
            return !!this._buffer || !(!this._elements || !this._elements.length)
        },
        invalidate: function () {
            this._buffer = void 0, this.dirty()
        },
        releaseGLObjects: function () {
            void 0 !== this._buffer && null !== this._buffer && void 0 !== this._gl && (d.deleteGLBufferArray(this._gl, this._buffer), o.a.removeObject(this._gl, this)), this.invalidate()
        },
        setNormalize: function (e) {
            this._normalize = e
        },
        getNormalize: function () {
            return this._normalize
        },
        bind: function (e) {
            this._gl || this.setGraphicContext(e);
            var t = this._target,
                i = this._buffer;
            if (i) return void e.bindBuffer(t, i);
            !i && this._elements.length > 0 && (this._buffer = e.createBuffer(), this._numItems = this._elements.length / this._itemSize, e.bindBuffer(t, this._buffer))
        },
        getItemSize: function () {
            return this._itemSize
        },
        dirty: function () {
            this._dirty = !0
        },
        isDirty: function () {
            return this._dirty
        },
        setElements: function (e) {
            this._elements = e, this._type = c(e), this._dirty = !0
        },
        getType: function () {
            return this._type
        },
        compile: function (e) {
            if (this._dirty) return this._QTAN || this._QNOR ? this._encodeDirection(e) : this._QVS ? this._encodeVertex(e) : this._QUV ? this._encodeUV(e) : void this.compileGl(e)
        },
        compileGl: function (e) {
            this._dirty && (e.bufferData(this._target, this._elements, this._usage), this._dirty = !1)
        },
        getGlItemSize: function () {
            return this._glItemSize || this._itemSize
        },
        getGlType: function () {
            return this._glType || this._type
        },
        getGlNormalize: function () {
            return this._glNormalize || this._normalize
        },
        getElements: function () {
            return this._elements
        },
        computeMinMaxVertex: function (e, t, i) {
            return this._minMaxVertex(e, t, i)
        },
        computeMinMaxUV: function (e, t, i) {
            return this._minMaxUV(e, t, i)
        },
        _minMaxVertex: function (e, t, i) {
            for (var n = 1 / 0, r = 1 / 0, a = 1 / 0, o = -1 / 0, s = -1 / 0, u = -1 / 0, l = this.getElements(), c = void 0 === i ? l.length : i, h = t || 0; h < c; h += 3) {
                var d = l[h],
                    f = l[h + 1],
                    p = l[h + 2];
                d < n && (n = d), f < r && (r = f), p < a && (a = p), d > o && (o = d), f > s && (s = f), p > u && (u = p)
            }
            return o <= n && (o = .001), s <= r && (s = .001), u <= a && (u = .001), e.xmin = n, e.xmax = o, e.ymin = r, e.ymax = s, e.zmin = a, e.zmax = u, e
        },
        _minMaxUV: function (e, t, i) {
            for (var n = 1 / 0, r = 1 / 0, a = -1 / 0, o = -1 / 0, s = this.getElements(), u = void 0 === i ? s.length : i, l = t || 0; l < u; l += 2) {
                var c = s[l],
                    h = s[l + 1];
                c < n && (n = c), h < r && (r = h), c > a && (a = c), h > o && (o = h)
            }
            return a <= n && (a = .001), o <= r && (o = .001), e.xmin = n, e.ymin = r, e.xmax = a, e.ymax = o, e
        },
        _compileHook: function (e, t, i, n) {
            var r = this.getElements(),
                a = this.getItemSize(),
                o = this.getNormalize();
            this.setNormalize(i), this.setItemSize(t), this.setElements(e), this._glType = this.getType(), this._glItemSize = t, this._glNormalize = i, this.compileGl(n), this.setElements(r), this.setItemSize(a), this.setNormalize(o), this._dirty = !1
        },
        _encodeDirection: function (e) {
            for (var t = this.getElements(), i = t.length, n = this.getItemSize(), r = n - 1, a = 0, o = new Int16Array(r * i / n), s = Object(l.a)().zoct, u = 0; u < i; u += n) {
                var c = t[u],
                    h = t[u + 1],
                    d = t[u + 2],
                    f = 1 / Math.sqrt(c * c + h * h + d * d);
                if (c *= f, h *= f, d *= f, s) {
                    var p = 1 / (Math.abs(c) + Math.abs(h) + Math.abs(d)),
                        m = c * p,
                        g = h * p,
                        v = d * p,
                        _ = v >= 0 ? m : (1 - Math.abs(g)) * (Math.sign(m) || 1),
                        b = v >= 0 ? g : (1 - Math.abs(m)) * (Math.sign(g) || 1);
                    o[a] = 32767 * _, o[a + 1] = 32767 * b
                } else if (d <= -.99999) o[a] = 32767 * Math.sqrt(.5), o[a + 1] = 32767 * Math.sqrt(.5);
                else {
                    var S = 1 / Math.sqrt(2 * d + 2);
                    o[a] = 32767 * c * S, o[a + 1] = 32767 * h * S
                }
                3 === r && (o[a + 2] = 32767 * t[u + 3]), a += r
            }
            this._compileHook(o, r, !0, e)
        },
        _encodeVertex: function (e) {
            var t = this._QVS,
                i = this._QVT,
                n = this.getElements(),
                r = this._FQU || this._minMax && this._minMax._FQU;
            r && h("vFQU - " + this.getInstanceID());
            for (var a = Object(l.a)().zq && !r, o = a ? 65535 : 1, s = a ? Uint16Array : Float32Array, u = 1 / (p[0] * t[0]), c = 1 / (p[1] * t[1]), d = 1 / (p[2] * t[2]), f = i[0], m = i[1], g = i[2], v = Object(l.a)().zw, _ = this.getItemSize(), b = v ? 4 : 3, S = n.length, x = new s(b * S / _), y = 0, C = 0; C < S; C += _) {
                var T = u * (n[C] - f),
                    w = c * (n[C + 1] - m),
                    M = d * (n[C + 2] - g);
                if (x[y] = o * T, x[y + 1] = o * w, x[y + 2] = o * M, v) {
                    var E = Math.min(x[y], x[y + 1], x[y + 2]);
                    x[y] -= E, x[y + 1] -= E, x[y + 2] -= E, x[y + 3] = E
                }
                y += b
            }
            this._compileHook(x, b, a, e)
        },
        _encodeUV: function (e) {
            var t = this._QUV,
                i = t[0],
                n = t[1],
                r = 1 / t[2],
                a = 1 / t[3],
                o = this.getElements(),
                s = o.length,
                l = 0;
            if (Math.max(t[2], t[3]) / 65535 > 1 / 2048) return h("NoQUV - " + this.getInstanceID()), this.compileGl(e), void u.g.set(t, 0, 0, 1, 1);
            var c = 65535 * r,
                d = 65535 * a,
                f = new Uint16Array(s);
            for (l = 0; l < s; l += 2) f[l] = c * (o[l] - i), f[l + 1] = d * (o[l + 1] - n);
            this._compileHook(f, 2, !0, e)
        }
    }), "osg", "BufferArray"), t.a = d
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(636),
        a = n.a.osg,
        o = {
            uDrawOpaque: a.Uniform.createInt(-1, "uDrawOpaque"),
            uEarlyZ: a.Uniform.createInt(0, "uEarlyZ"),
            uQVT: a.Uniform.createFloat3("uQVT"),
            uQVS: a.Uniform.createFloat3("uQVS"),
            uQW: a.Uniform.createFloat2("uQW"),
            uQUV0: a.Uniform.createFloat4("uQUV0"),
            uNearFar: a.Uniform.createFloat2("uNearFar"),
            uBoxRadius: a.Uniform.createFloat("uBoxRadius"),
            uOutputLinear: a.Uniform.createInt(1, "uOutputLinear"),
            uRGBMRange: a.Uniform.createFloat("uRGBMRange"),
            uGlobalTexSize: a.Uniform.createFloat2("uGlobalTexSize"),
            uGlobalTexRatio: a.Uniform.createFloat2("uGlobalTexRatio"),
            uPixelRatio: a.Uniform.createFloat2("uPixelRatio"),
            uPreviousGlobalTexSize: a.Uniform.createFloat2("uPreviousGlobalTexSize"),
            uPreviousGlobalTexRatio: a.Uniform.createFloat2("uPreviousGlobalTexRatio"),
            uPreviousHalton: a.Uniform.createFloat4("uPreviousHalton"),
            uReprojectViewProj: a.Uniform.createMatrix4("uReprojectViewProj"),
            uTaaCornersCSLeft: r.a.uTaaCornersCSLeft,
            uPreviousProjection: a.Uniform.createMatrix4("uPreviousProjection"),
            uPreviousViewInvView: a.Uniform.createMatrix4("uPreviousViewInvView"),
            uTextureToBeRefractedSize: a.Uniform.createFloat2("uTextureToBeRefractedSize"),
            uDisplay2D: a.Uniform.createFloat(0, "uDisplay2D"),
            uSplitView: a.Uniform.createFloat(0, "uSplitView"),
            uDisplayVertexAlpha: a.Uniform.createFloat(0, "uDisplayVertexAlpha"),
            uTimeViewer: a.Uniform.createFloat("uTimeViewer"),
            uHalton: a.Uniform.createFloat4("uHalton"),
            uSSAARestart: a.Uniform.createFloat(0, "uSSAARestart"),
            uScatteringFactorPacker: a.Uniform.createFloat("uScatteringFactorPacker"),
            uNormalizeFactorThickness: a.Uniform.createFloat("uNormalizeFactorThickness"),
            uStaticFrameNumShadow0: a.Uniform.createFloat("uStaticFrameNumShadow0"),
            uStaticFrameNumShadow1: a.Uniform.createFloat("uStaticFrameNumShadow1"),
            uStaticFrameNumShadow2: a.Uniform.createFloat("uStaticFrameNumShadow2"),
            uStaticFrameNumShadow3: a.Uniform.createFloat("uStaticFrameNumShadow3"),
            uShadowMapSize: a.Uniform.createFloat2("uShadowMapSize"),
            uIsVr: a.Uniform.createInt("uIsVr"),
            uFrameMod: a.Uniform.createFloat(0, "uFrameMod"),
            uFrameModTaaSS: a.Uniform.createFloat(0, "uFrameModTaaSS"),
            uSsrFactor: a.Uniform.createFloat(1, "uSsrFactor"),
            uQuality: a.Uniform.createFloat(0, "uQuality")
        };
    t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(26),
        r = i.n(n),
        a = i(3),
        o = i.n(a),
        s = i(0),
        u = (i.n(s), i(372)),
        l = i(224),
        c = i(373);
    t.a = u.a.extend({
        mixins: [l.b, c.a],
        el: '<div class="widget"/>',
        constructor: function (e, t) {
            this.environment = Object(s.extend)({}, e ? e.environment : {}, (t || {}).environment), this.options = t || {}, this.collection = this.options.collection, this.model = this.options.model, u.a.call(this, t)
        },
        initialize: function (e) {
            u.a.prototype.initialize.call(this, e), this.render(), void 0 !== this.options.id && (this.id = this.options.id, this.$el.attr("id", this.id)), void 0 !== this.options.className && (this.className = this.options.className, this.$el.addClass(this.className)), void 0 !== this.options.title && this.$el.attr("title", this.options.title)
        },
        $: function (e) {
            var t = this.$el;
            return this.$el.find(e).filter(function () {
                return o()(this).parent().closest(".widget").is(t)
            })
        },
        delegateEvents: function (e) {
            e || (e = Object(s.result)(this, "events") || {});
            var t = this.$el;
            return u.a.prototype.delegateEvents.call(this, r()(e).reduce(function (i, n) {
                var r = e[n];
                return Object(s.isFunction)(r) || (r = this[e[n]]), r ? (i[n] = function (e) {
                    e && e.currentTarget && !o()(e.currentTarget).closest(".widget").is(t) || r.apply(this, arguments)
                }.bind(this), i) : i
            }.bind(this), {})), this.model && this.model.on("change", this.modelChangeEvent, this), this
        },
        undelegateEvents: function () {
            return u.a.prototype.undelegateEvents.apply(this, arguments), this.model && this.model.off("change", this.modelChangeEvent, this), this
        },
        modelChangeEvent: function () {
            var e = this.options.name,
                t = e + ".",
                i = !e,
                n = r()(this.model.changedAttributes() || {}),
                a = n.some(function (i) {
                    return i === e || 0 === i.indexOf(t)
                });
            (i || a) && this.render()
        },
        change: function (e, t) {
            1 === arguments.length && (t = e, e = void 0);
            var i = !0,
                n = function () {
                    i = !1
                },
                r = {
                    target: this,
                    which: e,
                    value: t,
                    preventDefault: n
                };
            return this.trigger("change.before", r), !!i && (this.defaultAction(e, t), this.trigger("change"), !0)
        },
        defaultAction: function (e, t) {
            this.set(t)
        },
        field: function (e) {
            return this.options.name + (e ? "." + e : "")
        },
        get: function (e) {
            return this.model.get(this.field(e))
        },
        set: function (e, t) {
            return 1 === arguments.length && (t = e, e = void 0), this.model.set(this.field(e), t)
        },
        disable: function () {
            this._disabled = !0, this.$el.addClass("disabled")
        },
        enable: function () {
            this._disabled = !1, this.$el.removeClass("disabled")
        }
    }, {
        reify: function () {
            var e = arguments,
                t = this,
                i = function () {
                    t.apply(this, e)
                };
            return i.prototype = this.prototype, new i
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = !1;
    window && window.navigator && (n = -1 !== window.navigator.userAgent.indexOf("Edge"));
    var r = function () {
        return n
    };
    t.a = r
}, , , , , , , , , , , , function (e, t, i) {
    var n, r;
    ! function (a, o) {
        "use strict";
        n = o, void 0 !== (r = "function" == typeof n ? n.call(t, i, t, e) : n) && (e.exports = r)
    }(0, function () {
        "use strict";
        var e = {};
        return e.sanitize = function (e, t) {
            var i = ["a", "abbr", "acronym", "address", "area", "article", "aside", "audio", "b", "bdi", "bdo", "big", "blink", "blockquote", "body", "br", "button", "canvas", "caption", "center", "cite", "code", "col", "colgroup", "content", "data", "datalist", "dd", "decorator", "del", "details", "dfn", "dir", "div", "dl", "dt", "element", "em", "fieldset", "figcaption", "figure", "font", "footer", "form", "h1", "h2", "h3", "h4", "h5", "h6", "head", "header", "hgroup", "hr", "html", "i", "img", "input", "ins", "kbd", "label", "legend", "li", "main", "map", "mark", "marquee", "menu", "menuitem", "meter", "nav", "nobr", "ol", "optgroup", "option", "output", "p", "pre", "progress", "q", "rp", "rt", "ruby", "s", "samp", "section", "select", "shadow", "small", "source", "spacer", "span", "strike", "strong", "style", "sub", "summary", "sup", "table", "tbody", "td", "template", "textarea", "tfoot", "th", "thead", "time", "tr", "track", "tt", "u", "ul", "var", "video", "wbr", "svg", "altglyph", "altglyphdef", "altglyphitem", "animatecolor", "animatemotion", "animatetransform", "circle", "clippath", "defs", "desc", "ellipse", "font", "g", "glyph", "glyphref", "hkern", "image", "line", "lineargradient", "marker", "mask", "metadata", "mpath", "path", "pattern", "polygon", "polyline", "radialgradient", "rect", "stop", "switch", "symbol", "text", "textpath", "title", "tref", "tspan", "view", "vkern", "math", "menclose", "merror", "mfenced", "mfrac", "mglyph", "mi", "mlabeledtr", "mmuliscripts", "mn", "mo", "mover", "mpadded", "mphantom", "mroot", "mrow", "ms", "mpspace", "msqrt", "mystyle", "msub", "msup", "msubsup", "mtable", "mtd", "mtext", "mtr", "munder", "munderover", "#text"],
                n = !0,
                r = ["accept", "action", "align", "alt", "autocomplete", "bgcolor", "border", "checked", "cite", "class", "color", "cols", "colspan", "coords", "datetime", "default", "dir", "disabled", "download", "enctype", "for", "headers", "height", "hidden", "high", "href", "hreflang", "id", "ismap", "label", "lang", "list", "loop", "low", "max", "maxlength", "media", "method", "min", "multiple", "name", "novalidate", "open", "optimum", "pattern", "placeholder", "poster", "preload", "pubdate", "radiogroup", "readonly", "rel", "required", "rev", "reversed", "rows", "rowspan", "spellcheck", "scope", "selected", "shape", "size", "span", "srclang", "start", "src", "step", "style", "summary", "tabindex", "title", "type", "usemap", "valign", "value", "width", "xmlns", "accent-height", "accumulate", "additivive", "alignment-baseline", "ascent", "azimuth", "baseline-shift", "bias", "clip", "clip-path", "clip-rule", "color", "color-interpolation", "color-interpolation-filters", "color-profile", "color-rendering", "cx", "cy", "d", "dy", "dy", "direction", "display", "divisor", "dur", "elevation", "end", "fill", "fill-opacity", "fill-rule", "filter", "flood-color", "flood-opacity", "font-family", "font-size", "font-size-adjust", "font-stretch", "font-style", "font-variant", "front-weight", "image-rendering", "in", "in2", "k1", "k2", "k3", "k4", "kerning", "letter-spacing", "lighting-color", "local", "marker-end", "marker-mid", "marker-start", "max", "mask", "mode", "min", "operator", "opacity", "order", "overflow", "paint-order", "path", "points", "r", "rx", "ry", "radius", "restart", "scale", "seed", "shape-rendering", "stop-color", "stop-opacity", "stroke-dasharray", "stroke-dashoffset", "stroke-linecap", "stroke-linejoin", "stroke-miterlimit", "stroke-opacity", "stroke", "stroke-width", "transform", "text-anchor", "text-decoration", "text-rendering", "u1", "u2", "viewbox", "visibility", "word-spacing", "wrap", "writing-mode", "x", "x1", "x2", "y", "y1", "y2", "z", "accent", "accentunder", "bevelled", "close", "columnsalign", "columnlines", "columnspan", "denomalign", "depth", "display", "displaystyle", "fence", "frame", "largeop", "length", "linethickness", "lspace", "lquote", "mathbackground", "mathcolor", "mathsize", "mathvariant", "maxsize", "minsize", "movablelimits", "notation", "numalign", "open", "rowalign", "rowlines", "rowspacing", "rowspan", "rspace", "rquote", "scriptlevel", "scriptminsize", "scriptsizemultiplier", "selection", "separator", "separators", "stretchy", "subscriptshift", "supscriptshift", "symmetric", "voffset", "xlink:href", "xml:id", "xlink:title", "xml:space"],
                a = !1,
                o = !1,
                s = !1,
                u = !0,
                l = !0,
                c = ["a", "abbr", "acronym", "address", "article", "aside", "b", "bdi", "bdo", "big", "blink", "blockquote", "caption", "center", "cite", "code", "col", "dd", "del", "details", "dfn", "dir", "div", "dl", "dt", "em", "figcaption", "figure", "footer", "h1", "h2", "h3", "h4", "h5", "h6", "header", "i", "ins", "kbd", "label", "legend", "li", "main", "mark", "marquee", "nav", "ol", "output", "p", "pre", "q", "rp", "rt", "ruby", "s", "samp", "section", "small", "span", "strike", "strong", "sub", "summary", "sup", "table", "tbody", "td", "tfoot", "th", "thead", "time", "tr", "tt", "u", "ul", "var"],
                h = function (e) {
                    return document.createNodeIterator(e, NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_COMMENT | NodeFilter.SHOW_TEXT, function () {
                        return NodeFilter.FILTER_ACCEPT
                    }, !1)
                },
                d = function (e) {
                    return !(e instanceof Text) && !!(e.children && !(e.children instanceof HTMLCollection) || e.attributes instanceof NodeList || "string" != typeof e.nodeName || "string" != typeof e.textContent || "number" != typeof e.nodeType || "number" != typeof e.COMMENT_NODE || "function" != typeof e.setAttribute || "function" != typeof e.cloneNode || "function" != typeof e.removeAttributeNode || "function" != typeof e.insertAdjacentHTML || "function" != typeof e.attributes.item)
                },
                f = function (e) {
                    if (d(e)) {
                        try {
                            e.parentNode.removeChild(e)
                        } catch (t) {
                            e.outerHTML = ""
                        }
                        return !0
                    }
                    if (e.nodeType === e.COMMENT_NODE || -1 === i.indexOf(e.nodeName.toLowerCase())) {
                        if (l && e.insertAdjacentHTML && e.nodeName.toLowerCase && -1 !== c.indexOf(e.nodeName.toLowerCase())) try {
                            e.insertAdjacentHTML("AfterEnd", e.innerHTML)
                        } catch (e) {}
                        return e.parentNode.removeChild(e), !0
                    }
                    return s && !e.firstElementChild && (e.textContent = e.textContent.replace(/</g, "&lt;")), !1
                },
                p = function (e) {
                    var t, i, a = /^(\w+script|data):/gi,
                        o = e.cloneNode(!0);
                    if (e.attributes)
                        for (var s = e.attributes.length - 1; s >= 0; s--) t = o.attributes[s], i = !1, e.removeAttribute(e.attributes[s].name), t instanceof Attr && (u && ("id" === t.name && window[t.value] && (i = !0), "name" === t.name && document[t.value] && (i = !0)), !(r.indexOf(t.name.toLowerCase()) > -1 || n && t.name.match(/^data-[\w-]+/i)) || t.value.replace(/[\x00-\x20]/g, "").match(a) && ("src" !== t.name || 0 !== t.value.indexOf("data:") || "IMG" !== t.ownerElement.nodeName) || i || e.setAttribute(t.name, t.value))
                },
                m = function (e) {
                    for (var t, i = h(e); t = i.nextNode();) f(t) || (t.content instanceof DocumentFragment && m(t.content), p(t))
                };
            t && function (e) {
                e.ALLOWED_ATTR && (r = e.ALLOWED_ATTR), e.ALLOWED_TAGS && (i = e.ALLOWED_TAGS), e.ALLOW_DATA_ATTR && (n = e.ALLOW_DATA_ATTR), e.SAFE_FOR_JQUERY && (s = e.SAFE_FOR_JQUERY), e.WHOLE_DOCUMENT && (a = e.WHOLE_DOCUMENT), e.RETURN_DOM && (o = e.RETURN_DOM), e.SANITIZE_DOM && (u = e.SANITIZE_DOM), e.KEEP_CONTENT && (l = e.KEEP_CONTENT), e.ADD_ATTR && (r = r.concat(e.ADD_ATTR)), e.ADD_TAGS && (i = i.concat(e.ADD_TAGS)), l && i.push("#text")
            }(t);
            var g = function (e) {
                var t = document.implementation.createHTMLDocument("");
                t.body.parentNode.removeChild(t.body.parentNode.firstElementChild), t.body.outerHTML = e, null === t.body && (t.body.innerHTML = e);
                var i = a ? t.body.parentNode : t.body;
                if (!(t.body instanceof HTMLBodyElement && t.body instanceof HTMLHtmlElement)) {
                    var n = document.implementation.createHTMLDocument("");
                    i = a ? n.getElementsByTagName.call(t, "html")[0] : n.getElementsByTagName.call(t, "body")[0]
                }
                return i
            }(e);
            if (void 0 === g) return "";
            for (var v, _ = h(g); v = _.nextNode();) f(v) || (v.content instanceof DocumentFragment && m(v.content), p(v));
            return o ? g : a ? g.outerHTML : g.innerHTML
        }, e
    })
}, , , , function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(316),
        a = i(573),
        o = i(10),
        s = i(118),
        u = i(177),
        l = function () {
            r.a.call(this), a.a.call(this), this.viewport = void 0, this._graphicContext = void 0, this._scissor = void 0, this.setClearColor(o.g.fromValues(0, 0, 0, 1)), this.setClearDepth(1), this.setClearMask(l.COLOR_BUFFER_BIT | l.DEPTH_BUFFER_BIT), this.setViewMatrix(o.c.create()), this.setProjectionMatrix(o.c.create()), this.renderOrder = l.NESTED_RENDER, this.renderOrderNum = 0, this._view = void 0, this._renderer = void 0, this._attachments = {}
        };
    l.PRE_RENDER = 0, l.NESTED_RENDER = 1, l.POST_RENDER = 2, l.COLOR_BUFFER_BIT = 16384, l.DEPTH_BUFFER_BIT = 256, l.STENCIL_BUFFER_BIT = 1024, n.a.createPrototypeNode(l, n.a.objectInherit(a.a.prototype, n.a.objectInherit(r.a.prototype, {
        getView: function () {
            return this._view
        },
        setView: function (e) {
            this._view = e
        },
        getRenderer: function () {
            return this._renderer
        },
        setRenderer: function (e) {
            this._renderer = e
        },
        setFinalDrawCallback: function (e) {
            this._finalDrawCallback = e
        },
        getFinalDrawCallback: function () {
            return this._finalDrawCallback
        },
        setInitialDrawCallback: function (e) {
            this._initialDrawCallback = e
        },
        getInitialDrawCallback: function () {
            return this._initialDrawCallback
        },
        getAttachments: function () {
            return this._attachments
        },
        setGraphicContext: function (e) {
            this._graphicContext = e
        },
        getGraphicContext: function () {
            return this._graphicContext
        },
        setClearDepth: function (e) {
            this.clearDepth = e
        },
        getClearDepth: function () {
            return this.clearDepth
        },
        setClearMask: function (e) {
            this.clearMask = e
        },
        getClearMask: function () {
            return this.clearMask
        },
        setClearColor: function (e) {
            this.clearColor = e
        },
        getClearColor: function () {
            return this.clearColor
        },
        setViewport: function (e) {
            this.viewport = e, this.getOrCreateStateSet().setAttributeAndModes(e)
        },
        getViewport: function () {
            return this.viewport
        },
        setScissor: function (e) {
            this._scissor = e, this.getOrCreateStateSet().setAttributeAndModes(this._scissor)
        },
        getScissor: function () {
            return this._scissor
        },
        setViewMatrix: function (e) {
            this.modelviewMatrix = e
        },
        setViewMatrixAsLookAt: function (e, t, i) {
            o.c.lookAt(this.getViewMatrix(), e, t, i)
        },
        setProjectionMatrix: function (e) {
            this.projectionMatrix = e
        },
        setProjectionMatrixAsOrtho: function (e, t, i, n, r, a) {
            o.c.ortho(this.getProjectionMatrix(), e, t, i, n, r, a)
        },
        isRenderToTextureCamera: function () {
            return window.Object.keys(this._attachments).length > 0
        },
        getViewMatrix: function () {
            return this.modelviewMatrix
        },
        getProjectionMatrix: function () {
            return this.projectionMatrix
        },
        getRenderOrder: function () {
            return this.renderOrder
        },
        setRenderOrder: function (e, t) {
            this.renderOrder = e, this.renderOrderNum = t
        },
        getFrameBufferObject: function () {
            return this.frameBufferObject
        },
        setFrameBufferObject: function (e) {
            this.frameBufferObject = e
        },
        detachAll: function () {
            this._attachments = {}, this.frameBufferObject && this.frameBufferObject.dirty()
        },
        resetAttachments: function () {
            this.frameBufferObject && (this.frameBufferObject.reset(), this.frameBufferObject = 0), this._attachments = {}
        },
        attachTexture: function (e, t, i) {
            this.frameBufferObject && this.frameBufferObject.dirty(), i || (i = s.default.TEXTURE_2D), this._attachments[e] = {
                attachment: e,
                texture: t,
                textureTarget: i
            }
        },
        attachRenderBuffer: function (e, t) {
            this.frameBufferObject && this.frameBufferObject.dirty(), this._attachments[e] = {
                format: t,
                attachment: e
            }
        },
        computeLocalToWorldMatrix: function (e) {
            return this.referenceFrame === u.a.RELATIVE_RF ? o.c.mul(e, e, this.modelviewMatrix) : o.c.copy(e, this.modelviewMatrix), !0
        },
        computeWorldToLocalMatrix: function () {
            var e = o.c.create();
            return function (t) {
                return o.c.invert(e, this.modelviewMatrix), this.referenceFrame === u.a.RELATIVE_RF ? o.c.mul(t, e, t) : o.c.copy(t, e), !0
            }
        }()
    })), "osg", "Camera"), t.a = l
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(10),
        a = i(316),
        o = i(177),
        s = function () {
            a.a.call(this), this.matrix = r.c.create()
        };
    n.a.createPrototypeNode(s, n.a.objectInherit(a.a.prototype, {
        getMatrix: function () {
            return this.matrix
        },
        setMatrix: function (e) {
            this.matrix = e, this.dirtyBound()
        },
        computeLocalToWorldMatrix: function (e) {
            return this.referenceFrame === o.a.RELATIVE_RF ? r.c.mul(e, e, this.matrix) : r.c.copy(e, this.matrix), !0
        },
        computeWorldToLocalMatrix: function () {
            var e = r.c.create();
            return function (t) {
                return r.c.invert(e, this.matrix), this.referenceFrame === o.a.RELATIVE_RF ? r.c.mul(t, e, t) : r.c.copy(t, e), !0
            }
        }()
    }), "osg", "MatrixTransform"), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(79),
        a = i(20),
        o = i(1277),
        s = n.a.InputGroups;
    s.GLOBAL_ACTIONS = s.SCENE + ".globalactions", s.GLOBAL_FOCUS = "focuscanvas", s.SCENE_VIEWERAPI = s.SCENE + ".viewerapi", s.FOCUS_INSPECTOR = "focus.inspector", s.SCENE_INSPECTOR = s.SCENE + ".inspector", s.UI_INSPECTOR = s.UI + ".inspector", s.SCENE_INSPECTOR_ZOOM = s.SCENE_INSPECTOR + ".zoom", s.UI_INSPECTOR_ZOOM = s.UI_INSPECTOR + ".zoom", s.ENVIRONMENT = s.SCENE + ".environment", s.DEBUG = "debug", s.DEBUG_TRIPICK = "debug.tripick", s.DEBUG_GEOMPICK = "debug.geompick", s.AUTOSPIN = s.SCENE + ".autospin", s.HOTSPOT = s.SCENE + ".hotspot", s.HOTSPOT_VIEWER = s.HOTSPOT + ".viewer", s.HOTSPOT_EDITOR = s.HOTSPOT + ".editor", s.CAMERA = s.SCENE + ".camera", s.CAMERA_GIZMO = s.CAMERA + ".gizmo", s.SOUND = s.SCENE + ".sound", s.SOUND_GIZMO = s.SOUND + ".gizmo", s.WEBVR = s.SCENE + ".webvr", s.WEBVREDITOR = s.SCENE + "webvreditor", s.WEBVR_NAVIGATION = s.WEBVR + ".navigation", s.WEBVR_DISPLAY = s.WEBVR + ".display", s.AR = "ar", s.AR_DEBUG = s.AR + ".debug";
    var u = {
        init: function (e) {
            this._manager = e
        },
        initGlobalClickEvents: function (e, t) {
            var i = 0,
                n = 0,
                r = 0,
                a = function (e) {
                    r = 0, i = e.clientX, n = e.clientY
                },
                o = function (e) {
                    var t = Math.abs(i - e.clientX) + Math.abs(n - e.clientY);
                    r = Math.max(r, t)
                },
                u = function (t) {
                    r < 2 && e.onSingleClick(t)
                };
            this._manager.group(s.GLOBAL_ACTIONS).addMappings({
                onDoubleClick: ["doubletap", "doubletap2fingers", "dblclick"],
                onSingleClick: "singletap"
            }, e), this._manager.group(s.GLOBAL_ACTIONS).addMappings({
                preventclick: "mousedown"
            }, a), this._manager.group(s.GLOBAL_ACTIONS).addMappings({
                preventmousemove: "mousemove"
            }, o), this._manager.group(s.GLOBAL_ACTIONS).addMappings({
                fallbacksingleclick: "mouseup"
            }, u), this._manager.group("focuscanvas").addMappings({
                focus: "mousedown"
            }, function () {
                t.focus({
                    preventScroll: !0
                })
            }), this._manager.setPriority("focuscanvas", 0)
        },
        initViewerAPI: function (e) {
            this._manager.group(s.SCENE_VIEWERAPI).addMappings({
                onMouseMove: "mousemove",
                onCursorUp: ["mouseup", "singletap"]
            }, e)
        },
        initInspector: function (e) {
            this._manager.group(s.FOCUS_INSPECTOR).addMappings({
                focusCheck: ["mousedown", "touchstart", "wheel", "mousemove", "touchend", "mouseup"],
                onCursorDown: ["mousedown", "touchstart"],
                onCursorUp: ["touchend", "touchcancel", "mouseout", "mouseup"]
            }, e), this._manager.group(s.SCENE_INSPECTOR).addMappings({
                onMouseMove: "mousemove"
            }, e), this._manager.group(s.SCENE_INSPECTOR_ZOOM).addMappings({
                onMouseWheel: "wheel"
            }, e), this._manager.setPriority(s.FOCUS_INSPECTOR, this._manager.getHigherPriority(s.SCENE_INSPECTOR)), this._manager.setPriority(s.FOCUS_INSPECTOR + ":onCursorUp", this._manager.getHigherPriority(s.FOCUS_INSPECTOR))
        },
        initInspectorCamera2D: function (e) {
            this._manager.group(s.UI_INSPECTOR).addMappings({
                onEventStart: ["pinchstart", "panstart", "mousedown"],
                onEventEnd: ["pinchend", "panend", "mouseup", "mouseout"],
                onEventUpdate: ["pinch", "pan", "mousemove"]
            }, e), this._manager.group(s.UI_INSPECTOR_ZOOM).addMappings({
                onMouseWheel: "wheel"
            }, e), this._manager.setPriority(s.UI_INSPECTOR + ":onEventEnd", this._manager.getHigherPriority(s.FOCUS_INSPECTOR))
        },
        initEnvironment: function (e) {
            this._manager.group(s.ENVIRONMENT).addMappings({
                startRotate: ["mousedown alt", "touchstart 3"],
                rotateLight: ["mousemove alt ctrl !shift"],
                rotateEnv: ["mousemove alt shift !ctrl"],
                rotateEnvAndLight: ["mousemove alt !shift !ctrl", "panmove 3"],
                endRotate: ["mouseup", "mouseout", "touchend", "touchcancel"]
            }, e), this._manager.setPriority(s.ENVIRONMENT, this._manager.getHigherPriority(s.MANIPULATORS))
        },
        initDebug3D: function (e) {
            this._manager.group(s.DEBUG_TRIPICK).addMappings({
                onTrianglePick: "dblclick"
            }, e), this._manager.group(s.DEBUG_GEOMPICK).addMappings({
                onPickSelect: "dblclick"
            }, e), this._manager.setPriority(s.DEBUG, 1)
        },
        initAutospin: function (e, t) {
            this._manager.group(s.AUTOSPIN).addMappings({
                pause: ["mousedown", "touchstart"],
                resume: ["mouseup", "mouseout", "touchend", "touchcancel"]
            }, e), this._manager.setPriority(s.AUTOSPIN, this._manager.getHigherPriority(s.MANIPULATORS)), this._manager.setEnable(s.AUTOSPIN, t)
        },
        initHotspot: function (e) {
            this._manager.group(s.HOTSPOT).addMappings({
                hoverHotspot: "mousemove"
            }, e), Object(r.a)() ? (this._manager.group(s.HOTSPOT_EDITOR).addMappings({
                createHotspot: "dblclick",
                startDrag: ["mousedown", "touchstart"],
                dragHotspot: ["mousemove", "touchmove"],
                stopDrag: ["touchend", "mouseup"],
                cancelDrag: ["touchcancel", "mouseout"]
            }, e), this._manager.setPriority(s.HOTSPOT, this._manager.getHigherPriority(s.MANIPULATORS))) : this._manager.group(s.HOTSPOT_VIEWER).addMappings({
                selectHotspot: ["mousedown", "singletap"]
            }, e)
        },
        initCamera: function (e) {
            this._manager.group(s.CAMERA_GIZMO).addMappings({
                motion: "mousemove",
                startDrag: "mousedown",
                endDrag: ["mouseleave", "mouseup"]
            }, e), this._manager.setPriority(s.CAMERA_GIZMO, this._manager.getHigherPriority(s.MANIPULATORS))
        },
        initSound: function (e) {
            this._manager.group(s.SOUND_GIZMO).addMappings({
                onDragMove: "mousemove",
                onDragStart: "mousedown",
                onDragEnd: ["mouseleave", "mouseup"],
                onDoubleClick: "dblclick"
            }, e), this._manager.setEnable(s.SOUND_GIZMO, !1), this._manager.setPriority(s.SOUND_GIZMO, this._manager.getHigherPriority(s.MANIPULATORS))
        },
        initWebVR: function (e) {
            this._manager.group(s.WEBVR).addMappings({
                scaleUp: "keydown o",
                scaleDown: "keydown p"
            }, e), this._manager.group(s.WEBVR_DISPLAY).addMappings({
                onDisplayChange: ["vrdisplayconnected", "vrdisplaynotfound"]
            }, e), this._manager.setEnable(s.WEBVR, !1), Object(r.a)() && this._manager.group(s.WEBVREDITOR).addMappings({
                savePosition: "mousemove"
            }, e)
        },
        initWebVRNavigation: function (e) {
            this._manager.group(s.WEBVR_NAVIGATION).addMappings({
                onPointerDown: "touchstart 1",
                onPointerUp: ["touchend 1", "mouseup 0", "mouseup 1"],
                displayMenu: ["mouseup 2", "touchend 2"],
                onMouseDown: "mousedown"
            }, e), this._manager.setEnable(s.WEBVR_NAVIGATION, !1)
        },
        initAR: function (e) {
            Object(a.a)().arkitDebug && (this._manager.group(s.AR_DEBUG).addMappings({
                startMotion: ["mousedown 1", "mousedown 2"],
                startRotate: "mousedown 1 !ctrl",
                startElevate: "mousedown ctrl 1",
                startScale: "mousedown 2",
                motion: "mousemove",
                endMotion: ["mouseup", "mouseout"]
            }, e), this._manager.setPriority(s.AR_DEBUG, this._manager.getHigherPriority(s.MANIPULATORS))), o.a.initGestures(this._manager), this._manager.group(s.AR).addMappings({
                startScale: "pinchstart",
                endScale: "pinchend",
                scale: "pinch",
                endRotate: "panhend",
                endElevate: "panvend",
                rotate: "panh",
                elevate: "panv"
            }, e)
        }
    };
    t.a = u
}, , , , , , , , , , , , function (e, t, i) {
    "use strict";
    var n = i(3),
        r = i.n(n),
        a = i(0);
    i.n(a);
    t.a = {
        name: "LazyLoading",
        handleLazyLoading: function (e) {
            e = e || {}, Object(a.defaults)(e, {
                onBeforeLoad: function () {},
                onAfterLoad: function () {}
            });
            var t = function () {
                this.$(".lazyload").each(function () {
                    var t = r()(this),
                        i = t.attr("data-uri"),
                        n = new Image;
                    n.classList.add("lazyloaded"), n.onload = n.onerror = function () {
                        var i, r = t.width();
                        if (i = n.naturalWidth > r ? n.naturalHeight * (r / n.naturalWidth) : n.naturalHeight, e.onBeforeLoad(i), t.is(":visible")) {
                            var a = function () {
                                t.append(n), t.addClass("loaded").one("transitionend webkittransitionend moztransitionend", function () {
                                    t.replaceWith(n), e.onAfterLoad()
                                })
                            }.bind(this);
                            i !== t.outerHeight() ? t.css("min-height", i).one("transitionend webkittransitionend moztransitionend", a) : a()
                        } else t.replaceWith(n), e.onAfterLoad()
                    }, n.src = i
                })
            }.bind(this);
            "complete" === document.readyState ? t() : r()(window).load(t)
        }
    }
}, , , , , , , , , , , , function (e, t, i) {
    "use strict";
    var n = function (e) {
        var t = e || {};
        return window.location && window.location.hash ? (window.location.hash.substr(1).split(",").forEach(function (e) {
            var i = e.split("="),
                n = i[0],
                r = i[1];
            if ("debug3d" === n && (t.debug3D = !0), "stats" === n && (t.stats = !0), "inspector" === n && (t.inspector = !0), n.match("material_")) switch (n = n.substr(9)) {
                case "showcase":
                    t.materialShowcase = void 0 === r ? t.materialShowcase : "0" !== r;
                    break;
                case "names":
                    t.materialNames = r;
                    break;
                case "normal":
                    t.materialNormal = r;
                    break;
                case "emissive":
                    t.materialEmissive = r;
                    break;
                case "transparency":
                    t.materialTransparency = r;
                    break;
                case "diffuse":
                    t.materialDiffuse = r;
                    break;
                case "metalness":
                    t.materialMetalness = r;
                    break;
                case "roughness":
                    t.materialRoughness = r;
                    break;
                case "glossiness":
                    t.materialGlossiness = r;
                    break;
                case "specular":
                    t.materialSpecular = r;
                    break;
                case "cavity":
                    t.materialCavity = r;
                    break;
                case "f0":
                    t.materialF0 = r;
                    break;
                case "ao":
                    t.materialAO = r;
                    break;
                case "displacement":
                    t.materialDisplacement = r;
                    break;
                case "displacement_factor":
                    t.materialDisplacementFactor = void 0 === r ? t.materialDisplacementFactor : Number(r)
            }
        }), t) : t
    };
    t.a = n
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(23)),
        a = i(1);
    i.d(t, "a", function () {
        return a.b
    }), t.b = {
        name: "WithOptionTypes",
        optionTypes: {},
        initialize: function () {},
        setOptions: function (e) {
            var t = Object(n.extend)({}, this.options, Object(r.a)(e));
            this.isMounted && this.viewWillReceiveOptions(t), this.update(t, this.state, !1)
        },
        viewWillReceiveOptions: function () {},
        checkOptionTypes: function () {
            Object(a.a)(this.optionTypes, this.options, "option", this.displayName || "View")
        }
    }
}, , , , function (e, t, i) {
    "use strict";
    t.a = {
        name: "internal",
        domain: "/i",
        parse: function (e) {
            return e.results || []
        }
    }
}, function (e, t, i) {
    "use strict";
    var n = i(5),
        r = i.n(n),
        a = i(9),
        o = i(0),
        s = (i.n(o), i(632)),
        u = i(581),
        l = i(47),
        c = i(44),
        h = a.a.osg,
        d = function () {
            h.Texture.call(this), this._isVideo = !1, this._requireOriginalCompression = !1, this._imageModel = void 0, this._convertNPOT = !0, this._truePackingRead = void 0
        };
    d.WAIT_ANIMATION = !0;
    var f = h.ImageStream.prototype.play;
    h.ImageStream.prototype.play = function () {
        this._status !== h.ImageStream.PLAYING && (c.a.draw(), f.call(this))
    };
    var p = -1 === navigator.userAgent.indexOf("Firefox/46");
    h.createPrototypeStateAttribute(d, h.objectInherit(h.Texture.prototype, {
        isVideo: function () {
            return this._isVideo
        },
        getOriginalFormat: function () {
            return this._truePackingRead || this.getInternalFormat()
        },
        _resizeToNearestPowerOf2: function (e) {
            var t = document.createElement("canvas"),
                i = t.width = u.a.floorPowerOf2(e.getWidth()),
                n = t.height = u.a.floorPowerOf2(e.getHeight()),
                r = t.getContext("2d");
            r.drawImage(e.getImage(), 0, 0, i, n);
            var a = this._internalFormat;
            if (a === h.Texture.RGB || a === h.Texture.RGBA) return t;
            for (var o = r.getImageData(0, 0, i, n).data, s = a === h.Texture.ALPHA ? 3 : 0, l = i * n, c = new Uint8Array(l), d = 0; d < l; ++d) c[d] = o[4 * d + s];
            return this.setTextureSize(i, n), c
        },
        setImage: function (e, t) {
            var i = e instanceof h.Image;
            if (!i || e.isDirty() || e !== this.getImage() && e !== this._lastSetImage) {
                this._lastSetImage = e;
                var n = e instanceof h.ImageStream;
                this._convertNPOT && i && !n && (u.a.isPowerOf2(e.getWidth()) && u.a.isPowerOf2(e.getHeight()) || (e.setDirty && e.setDirty(!1), e = this._resizeToNearestPowerOf2(e))), !p && this.hasMipmapFilter() && this.setMinFilter(this.getMagFilter()), h.Texture.prototype.setImage.call(this, e, t), c.a.draw()
            }
        },
        applyTexImage2D: function () {
            h.Texture.prototype.applyTexImage2D.apply(this, arguments), c.a.draw()
        },
        getResourceManager: function () {
            return this._resourceManager || i(77).default.instance
        },
        setImageModel: function (e) {
            this._imageModel = e, this._isVideo = e.isVideo(), this.updateRequireOriginalCompression();
            var t = this.getImageJSONMaxSupported();
            t.options && "A" === t.options.format ? (this._truePackingRead = h.Texture.ALPHA, this.setInternalFormat(h.Texture.LUMINANCE)) : this._truePackingRead = void 0
        },
        getImageModel: function () {
            return this._imageModel
        },
        getImageCount: function () {
            var e = this._imageModel;
            return e && e.getImages ? e.getImages().length : this._image ? 1 : 0
        },
        setImageSmallest: function () {
            var e = this.getImageSmallest();
            if (e) return !0 === e.promise.isFulfilled() && e.image ? this.setImage(e.image) : this._setEntryImage(e, e.promise), e
        },
        setImageMaxSupported: function () {
            var e = this.getImageMaxSupported();
            if (e) {
                var t = d.WAIT_ANIMATION ? l.a.getFirstCameraAnimation() : r.a.resolve(),
                    i = r.a.all(Object(o.map)([t, e.promise, l.a.getLowResBound()], function (e) {
                        return e.reflect()
                    }));
                return this._setEntryImage(e, i), e
            }
        },
        _setEntryImage: function (e, t) {
            this._lastEntry = e, e.promise = t.then(function () {
                return this._lastEntry !== e ? this._lastEntry.promise : (this.setImage(e.image), e.image)
            }.bind(this))
        },
        getImageSmallest: function () {
            if (this._imageModel) {
                var e = this._requireOriginalCompression ? void 0 : this.getOriginalFormat(),
                    t = this._imageModel.findImageNearestToResolution(128, 128, e);
                return this.getResourceImage(t)
            }
        },
        updateRequireOriginalCompression: function () {
            var e = Object(s.a)(),
                t = this._imageModel.findImageNearestPowerOfTwoUpToResolution(e, e, this.getOriginalFormat()),
                i = this._imageModel.findImageNearestPowerOfTwoUpToResolution(e, e),
                n = Math.min(e, u.a.floorPowerOf2(i.width)),
                r = Math.min(e, u.a.floorPowerOf2(i.height));
            return this._requireOriginalCompression = t.width < n || t.height < r, this._requireOriginalCompression
        },
        getImageJSONMaxSupported: function (e) {
            e = Object(s.a)(e);
            var t = this._requireOriginalCompression ? void 0 : this.getOriginalFormat();
            return this._imageModel.findImageNearestPowerOfTwoUpToResolution(e, e, t)
        },
        getImageMaxSupported: function () {
            if (this._imageModel) return this.getResourceImage(this.getImageJSONMaxSupported())
        },
        getImageWidget: function () {
            if (this._imageModel) {
                var e = this._imageModel.findImageWidget();
                return e.options ? e.options.widget = !0 : e.options = {
                    widget: !0
                }, this.getResourceImage(e, !0)
            }
        },
        getResourceImage: function (e, t) {
            !t && e.url && e.width * e.height > 1048576 && (e.options = e.options || {}, e.options.decodeAsync = !0);
            var i = this.getResourceManager().getOrCreateImage(e.url, e.options);
            return i.promise.progressSize = e.size, i
        },
        _shouldBindNull: function () {
            return !!this._textureNull || (this._image ? !this._image.isReady() : 0 === this._textureHeight || 0 === this._textureWidth)
        },
        _requestUploadBudget: function (e) {
            var t = this._textureWidth * this._textureHeight,
                i = this._forceUpload || c.a.requestTextureBudget(t);
            return i || c.a.draw(), i || e || this._gl.texImage2D(this._textureTarget, 0, this._getInternalFormatGL(), 1, 1, 0, this._internalFormat, this._getTypeGL(), null), i
        },
        setForceUpload: function (e) {
            this._forceUpload = e
        },
        apply: function (e) {
            var t = e.getGraphicContext();
            if (this._dirtyTextureObject && (this.releaseGLObjects(), this._dirtyTextureObject = !1, this.setGraphicContext(t)), this._textureObject && !this.isDirty()) return this._textureObject.bind(t), void 0 !== this._image && this._image.isDirty() && this.applyImage(t), this.isDirtyMipmap() && this.generateMipmap(t, this._textureTarget), !0;
            if (this._shouldBindNull()) return t.bindTexture(this._textureTarget, null), !0;
            if (this.computeTextureFormat(), this._image) {
                var i = this._image.getWidth() || this._textureWidth,
                    n = this._image.getHeight() || this._textureHeight;
                this.setTextureSize(i, n)
            }
            var r = !!this._textureObject;
            return this._textureObject || this.init(e), this._textureObject.bind(t), !!this._requestUploadBudget(r) && (this.applyImage(t), this.applyFilterParameter(t, this._textureTarget), this.generateMipmap(t, this._textureTarget), this._unrefImageDataAfterApply && (this._image = void 0), this._dirty = !1, !0)
        },
        getHash: function () {
            return "osgSketchfabTexture"
        }
    }), "osgSketchfab", "MultiresTexture"), d.dummyTexture = new d, d.dummyTexture.setName("MultiresDummyTexture"), d.dummyTexture.setTextureSize(1, 1), t.a = d
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = n.a.osg,
        a = n.a.osgAnimation,
        o = {
            wireframe: !0,
            epsilon: !0,
            nphi: !0,
            attributes: !0,
            vertex_mode: !0,
            triangle_mode: !0,
            rigIndex: !0,
            framerate: !0,
            bx: !0,
            by: !0,
            bz: !0,
            hx: !0,
            hy: !0,
            hz: !0,
            ox: !0,
            oy: !0,
            oz: !0,
            ow: !0,
            ot: !0,
            channel_mode: !0
        },
        s = function () {
            r.NodeVisitor.call(this)
        };
    s.convertUserDataToObject = function (e, t) {
        var i = t || {};
        if (!e) return i;
        for (var n = 0, r = e.length; n < r; ++n) {
            var a = e[n],
                s = a.Name;
            o[s] || -1 !== s.indexOf("_bbl_") || -1 !== s.indexOf("_h_") || -1 !== s.indexOf("_mode") ? i[s] = JSON.parse(a.Value) : i[s] = a.Value
        }
        return i
    }, s.instanceIDGeometryMap = {}, s.uidGeometryMap = {}, s.hasPoints = !1, s.hasTriangles = !1, s.hasLines = !1, s.hasVertexNormals = !1, s.hasRigsOrMorphs = !1, r.createPrototypeObject(s, r.objectInherit(r.NodeVisitor.prototype, {
        apply: function (e) {
            var t = e instanceof r.Geometry;
            if (t && (void 0 !== e._uniqueID && (s.uidGeometryMap[e._uniqueID] = e), s.instanceIDGeometryMap[e.getInstanceID()] = e, !s.hasRigsOrMorphs)) {
                var i = e instanceof a.RigGeometry,
                    n = e instanceof a.MorphGeometry;
                s.hasRigsOrMorphs = i || n
            }
            if (t || e instanceof a.Bone) {
                e.userDataMap = s.convertUserDataToObject(e.getUserData());
                var o = e;
                if (e.getSourceGeometry && (o = e.getSourceGeometry(), s.convertUserDataToObject(o.getUserData(), e.userDataMap)), o instanceof a.MorphGeometry)
                    for (var u = o.getMorphTargets(), l = 0, c = u.length; l < c; ++l) {
                        var h = e.userDataMap["morph_" + l] = {};
                        s.convertUserDataToObject(u[l].getUserData(), h)
                    }
            }
            return this.traverse(e)
        }
    })), t.a = s
}, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , function (e, t, i) {
    "use strict";

    function n(e) {
        return u.a.extend({
            displayName: "Popup",
            mixins: [l.a],
            defaultOptions: e.prototype.defaultOptions,
            children: {
                componentWrapper: {
                    selector: ".js-popup-content",
                    viewClass: o.a.extend({
                        displayName: "PopupWrapper(" + e.prototype.displayName + ")",
                        template: function () {
                            return s.default.getFromString("{{ components.child | component }}", {
                                components: this.createChildrenComponents({
                                    child: {
                                        viewClass: e,
                                        options: this.options
                                    }
                                })
                            })
                        }
                    }),
                    options: function () {
                        return a()({}, this.options, {
                            popup: {
                                continue: this.continue.bind(this),
                                cancel: this.cancel.bind(this),
                                open: this.open.bind(this),
                                close: this.close.bind(this),
                                remove: this.remove.bind(this),
                                show: this.show.bind(this),
                                hide: this.hide.bind(this),
                                center: this.center.bind(this),
                                resize: this.resize.bind(this),
                                autofocus: this.autofocus.bind(this)
                            }
                        })
                    }
                }
            },
            template: function () {
                return s.default.getFromString('\n                <div class="popup-container">\n                    <div class="popup-overlay"></div>\n                    <div class="js-popup js-popup-content"></div>\n                </div>\n                ', {})
            }
        })
    }
    t.a = n;
    var r = i(7),
        a = i.n(r),
        o = i(6),
        s = i(2),
        u = i(29),
        l = i(116)
}, function (e, t, i) {
    "use strict";
    var n = i(6),
        r = i(2),
        a = i(1),
        o = i(457);
    i.n(o);
    t.a = n.a.extend({
        displayName: "Popup",
        optionTypes: {
            child: a.b.component.isRequired,
            title: a.b.string,
            className: a.b.string,
            isClosable: a.b.bool,
            width: a.b.number
        },
        defaultOptions: {
            className: "",
            isClosable: !0
        },
        state: {},
        events: {},
        template: function () {
            var e = this.options,
                t = e.width,
                i = e.className,
                n = e.isClosable,
                a = e.title,
                o = e.child;
            return r.default.getFromMacro("skfb_front/macros/components/molecules/popup", "popup", [{
                className: i,
                isClosable: n,
                width: t,
                title: a,
                components: this.createChildrenComponents({
                    child: o
                })
            }])
        }
    })
}, function (e, t) {
    e.exports = {
        allow_swift_shader: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Allow swift shader software rendering."
        },
        animation_autoplay: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "private",
            help: "Automatically play animations when the viewer starts."
        },
        anisotropy: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "private",
            help: "If we activate anisotropy when trilinear is chosen."
        },
        annotation: {
            type: "number",
            defaultValue: 0,
            values: "[1, 50]",
            share: "public",
            help: "Setting to [1, 50] will automatically load that annotation when the viewer starts."
        },
        annotation_cycle: {
            type: "number",
            defaultValue: null,
            values: "+X",
            share: "public",
            help: "Setting to any number will start the Autopilot cycle with that duration, in seconds, at each annotation."
        },
        annotations_visible: {
            type: "bool",
            defaultValue: null,
            values: "0, 1",
            share: "public",
            help: "Setting to 0 will hide annotations by default."
        },
        api_hook_env: {
            type: "string",
            defaultValue: null,
            values: "prod, dev, staging, local",
            share: "private",
            help: "Viewer Api Debug."
        },
        api_version: {
            type: "string",
            defaultValue: null,
            values: "string",
            share: "private",
            help: "The version of the viewer API."
        },
        arkit: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Initialize the viewer in ARKit mode"
        },
        arkit_debug: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Enter in debug mode for ar to debug in a desktop browser"
        },
        async_image: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "shared",
            help: "Loads png and jpg in asynchronous (memory overhead for now so disabled by default)."
        },
        async_shader: {
            type: "number",
            defaultValue: 0,
            values: "+X",
            share: "shared",
            help: "Compile Shaders asynchronously, specify number of frame waiting for compilation, 0 to disable, 3 to enable at minimum"
        },
        autospin: {
            type: "number",
            defaultValue: 0,
            values: "+/-X",
            share: "public",
            help: "Setting to any number will cause the model to automatically spin around the z-axis after loading. The greater the number, the faster the spin. A negative number will reverse the spin direction."
        },
        autostart: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "public",
            help: "Setting to 1 will make the model load immediately once the page is ready, rather than waiting for a user to click the Play button."
        },
        camera: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "public",
            help: "Setting to 0 will skip the initial animation that occurs when a model is loaded, and immediately show the model in its default position."
        },
        camera_constraints: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "shared",
            help: "Enable / Disable camera limits"
        },
        camera_easing: {
            type: "number",
            defaultValue: null,
            values: "0..1",
            share: "private",
            help: "0 means no easing."
        },
        camera_eye: {
            type: "vec3",
            defaultValue: null,
            values: "X,Y,Z",
            share: "private",
            help: "Forces position of the camera."
        },
        camera_follow_bones: {
            type: "number",
            defaultValue: 0,
            values: "0, 1, 2",
            share: "private",
            help: "1: translate eye 2: focus eye. You need to double-click the model on an animated part first."
        },
        camera_target: {
            type: "vec3",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "Forces the target of the camera."
        },
        cardboard: {
            type: "number",
            defaultValue: 0,
            values: "0, 1, 2",
            share: "public",
            help: "Start in VR Mode automatically."
        },
        carmel: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "If we are in the carmel context."
        },
        clean_shader: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Pre-process the shader to resolve the define statement."
        },
        ui_color: {
            type: "string",
            defaultValue: "",
            values: "",
            share: "private",
            limited_to: "ent",
            help: "The primary color of the ui."
        },
        continuous_render: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Redraw continuously."
        },
        convert_vertex_color_8bit: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "private",
            help: "Converts vertex color in 8bit."
        },
        debug3d: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Open a dat.gui panel to debug 3d stuffs."
        },
        depth_mipmap: {
            type: "bool",
            defaultValue: 0,
            values: "+X",
            share: "private",
            help: "Uses depth mipmap."
        },
        dof_attenuate_distance: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "private",
            help: "Attenuates dof effect when we unzoom."
        },
        dof_attenuate_speed: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Attenuates dof effect when we move the camera."
        },
        dof_res: {
            type: "number",
            defaultValue: 2,
            values: "+X",
            share: "private",
            help: "Resolution divider of dof postprocess (2 means half resolution)."
        },
        dof_sticky: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "If the dof focus point sticks on the same place."
        },
        dof_transition: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "private",
            help: "If there is a transition when changing the dof focus point."
        },
        double_click: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "shared",
            help: "If we allow double-click (focus constraint)."
        },
        download_picture: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Download the thumbnail on Save View."
        },
        drs: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "private",
            help: "Enables dynamic resolution scaling."
        },
        drs_ratio: {
            type: "number",
            defaultValue: 1,
            values: "+X",
            share: "private",
            help: "Speeds at which we reduce the resolution."
        },
        drs_fps: {
            type: "number",
            defaultValue: 15,
            values: "0..1",
            share: "private",
            help: "Minimum before reducing the resolution."
        },
        drs_min: {
            type: "number",
            defaultValue: null,
            values: "0..1",
            share: "private",
            help: "Minimum resoluton rate allowed, by default value is (1.0 / canvasPixelRatio)."
        },
        drs_test: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Alternates between 2 drs values (for debugging purpose)."
        },
        epsilon_alpha: {
            type: "number",
            defaultValue: 1e-5,
            values: "0..1",
            share: "private",
            help: "GPU workaround bug with epsilon alpha discard threshold."
        },
        float_rtt: {
            type: "number",
            defaultValue: 2,
            values: "0, 1, 2",
            share: "private",
            help: "0 : force 8bit, 1 force float if supported, 2 : depends (dynamic)."
        },
        force_controller: {
            type: "string",
            defaultValue: "",
            values: "vive, daydream, oculus, windows",
            share: "private",
            help: "Force display of controller (debug)."
        },
        force_controller_orientation: {
            type: "number",
            defaultValue: -.5,
            values: "-2..2",
            share: "private",
            help: "Rotates the controller when set: -2 is -2PI, 2 is 2PI"
        },
        force_controller_ray_orientation: {
            type: "number",
            defaultValue: -.075,
            values: "-2..2",
            share: "private",
            help: "Rotates the teleport ray when set: -2 is -2PI, 2 is 2PI"
        },
        force_ground: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Forces activation of the ground feature"
        },
        force_ms: {
            type: "number",
            defaultValue: 0,
            values: "+X",
            share: "private",
            help: "Forces framerate with a setTimeout (in ms, 0 means requestAnimationFrame)."
        },
        force_triangles: {
            type: "bool",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "Forces merge of TRIANGLE and TRIANGLE_STRIP."
        },
        fps_speed: {
            type: "number",
            defaultValue: 5,
            values: "+X",
            share: "public",
            help: "Set the default walk speed in First-Person."
        },
        fxaa: {
            type: "bool",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "Uses fxaa."
        },
        grain_speed: {
            type: "number",
            defaultValue: 64,
            values: "+X",
            share: "private",
            help: "Grain animation speed, in ms."
        },
        graph_optimizer: {
            type: "bool",
            defaultValue: null,
            values: "+X",
            share: "private",
            help: "Optimizes mesh (merge and bake geometries, etc), disabled by default in some cases (editor, api, processing)."
        },
        image_compression: {
            type: "bool",
            defaultValue: null,
            values: "0, 1",
            share: "shared",
            help: "Use the full resolution, original textures (false in editor, true in viewer)."
        },
        internal: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Allows us to use limited parameters on whitelisted domains (e.g. hide the watermark on sketchfab.com)."
        },
        is_app: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "If we are in the mobile app context."
        },
        keep_empty_geometries: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "If we want to keep the empty geometries in the scene graph instead of removing them."
        },
        material_ao: {
            type: "string",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "override ao channel for material given by material_names option."
        },
        material_cavity: {
            type: "string",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "override cavity channel for material given by material_names option."
        },
        material_diffuse: {
            type: "string",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "override diffuse channel for material given by material_names option."
        },
        material_displacement: {
            type: "string",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "override displacement channel for material given by material_names option."
        },
        material_displacement_factor: {
            type: "number",
            defaultValue: null,
            values: "+X",
            share: "private",
            help: "override displacement factor channel for material given by material_names option."
        },
        material_emissive: {
            type: "string",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "override emissive channel for material given by material_names option."
        },
        material_f0: {
            type: "string",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "override f0 channel for material given by material_names option."
        },
        material_glossiness: {
            type: "string",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "override glossiness channel for material given by material_names option."
        },
        material_metalness: {
            type: "string",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "override metalness channel for material given by material_names option."
        },
        material_names: {
            type: "string",
            defaultValue: "main_material",
            values: "0, 1",
            share: "private",
            help: "Multiple names are separated with ; For example material_names=mat1;mat2."
        },
        material_normal: {
            type: "string",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "override normal channel for material given by material_names option."
        },
        material_packing: {
            type: "bool",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "Pack texture materials."
        },
        material_roughness: {
            type: "string",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "override roughness channel for material given by material_names option."
        },
        material_showcase: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Enables material showcase."
        },
        material_specular: {
            type: "string",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "override specular channel for material given by material_names option."
        },
        material_transparency: {
            type: "string",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "override opacity channel for material given by material_names option."
        },
        max_texture_units: {
            type: "number",
            defaultValue: 32,
            values: "+X",
            share: "private",
            help: "Sets maximum count of texture units."
        },
        max_texture_size: {
            type: "number",
            defaultValue: 8192,
            values: "+X",
            share: "private",
            help: "All texture capped at that texture size."
        },
        max_vertex_uniforms: {
            type: "number",
            defaultValue: 8192,
            values: "+X",
            share: "private",
            help: "Sets max vertex uniform."
        },
        merge_materials: {
            type: "bool",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "Merge similar materials."
        },
        messaging: {
            type: "bool",
            defaultValue: null,
            values: "0, 1",
            share: "private"
        },
        model: {
            type: "string",
            defaultValue: null,
            values: "uid",
            share: "UID of model to hook."
        },
        model_optimization: {
            defaultValue: null,
            help: "Use the unoptimized editor build.",
            share: "private",
            type: "bool",
            values: "0, 1"
        },
        morph_epsilon: {
            defaultValue: .05,
            help: "Epsilon to limit the number of interpolated morph targets per frame.",
            share: "private",
            type: "number",
            values: "+X"
        },
        morph_gpu: {
            defaultValue: 4,
            help: "Maximum morph gpu allowed (rest is done on the cpu), minimum value is 1.",
            share: "private",
            type: "number",
            values: "[1, +X]"
        },
        navigation: {
            type: "string",
            defaultValue: "orbit",
            values: "orbit, fps",
            share: "public",
            help: "Choose between fps and orbit mode."
        },
        orbit_constraint_pan: {
            type: "bool",
            defaultValue: null,
            values: "0, 1",
            share: "shared",
            help: "Disable panning"
        },
        orbit_constraint_pitch_down: {
            type: "number",
            defaultValue: null,
            values: "[-PI/2, PI/2]",
            share: "shared",
            help: "Pitch down limit."
        },
        orbit_constraint_pitch_up: {
            type: "number",
            defaultValue: null,
            values: "[-PI/2, PI/2]",
            share: "shared",
            help: "Pitch up limit."
        },
        orbit_constraint_yaw_left: {
            type: "number",
            defaultValue: null,
            values: "[-PI, PI]",
            share: "shared",
            help: "Yaw left limit."
        },
        orbit_constraint_yaw_right: {
            type: "number",
            defaultValue: null,
            values: "[-PI, PI]",
            share: "shared",
            help: "Yaw right limit."
        },
        orbit_constraint_zoom_in: {
            type: "number",
            defaultValue: null,
            values: "+X",
            share: "shared",
            help: "Zoom in limit."
        },
        orbit_constraint_zoom_out: {
            type: "number",
            defaultValue: null,
            values: "+X",
            share: "shared",
            help: "Zoom out limit."
        },
        panorama: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Uses panorama hdr instead of cubemap."
        },
        pixel_budget: {
            type: "number",
            defaultValue: null,
            values: "+X",
            share: "private",
            help: "x is nb of pixel (e.g 4096)."
        },
        pratio: {
            type: "number",
            defaultValue: null,
            values: "+X",
            share: "private",
            help: "For debugging, same as osgjs overrideDevicePixelRatio (but shorter)."
        },
        post_process: {
            type: "bool",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "If postprocess filters are enabled."
        },
        power_preference: {
            type: "string",
            defaultValue: "default",
            values: "default|low-power|high-performance",
            share: "private",
            help: "Hint for gpu (power battery vs performance). Setting high-performance might be unsafe (context lost), so be wary."
        },
        preload: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "public",
            help: "Download all textures before displaying the model."
        },
        preserve_drawing_buffer: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "public",
            help: "WebGL canvas option."
        },
        process_material: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Reprocess materials."
        },
        process_options: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Reprocess all the options (same as a reupload without backend reprocessing)."
        },
        quality: {
            type: "number",
            defaultValue: null,
            values: "+X",
            share: "private",
            help: "Quality of viewer (null means it depends of the fps), for now it only impacts a few postprocesses."
        },
        refraction_res: {
            type: "number",
            defaultValue: 1,
            values: "+X",
            share: "private",
            help: "Resolution divider of refraction texture (2 means half resolution)."
        },
        resize_timeout: {
            type: "number",
            defaultValue: 1e3,
            values: "+X",
            share: "shared",
            help: "Resize timeout when the size is stable (in ms)."
        },
        rgbm: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "private",
            help: "For quick visual framebuffer debugging (spectorjs)."
        },
        scale: {
            type: "number",
            defaultValue: 1,
            values: "+X",
            share: "private",
            help: "Scale the scene (DEBUG only)."
        },
        scale_epsilon: {
            type: "number",
            defaultValue: 1e-5,
            values: "+X",
            share: "private",
            help: "Epsilon used to drop rendering of small matrixTransform/geometries (DEBUG only)."
        },
        scrollwheel: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "public",
            help: "Disable zooming with scrollwheel (Ctrl+Click/drag still zooms)."
        },
        shadow: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "private",
            help: "enable shadow"
        },
        shadow_atlas: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "private",
            help: "enable shadow atlas."
        },
        shadow_jitter_offset: {
            type: "string",
            defaultValue: "default",
            values: "default, none",
            share: "private",
            help: "If we use jitter offset shadow."
        },
        shadow_normal_offset: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "If we use normal offset shadow bias."
        },
        shadow_PCF: {
            type: "string",
            defaultValue: "1Tap(4texFetch)",
            values: "1Tap(4texFetch), 4Tap(16texFetch), 9Tap(36texFetch), 16Tap(64texFetch)",
            share: "private",
            help: "Shadow attempt to fight aliasing complex settings."
        },
        shadow_texture_size: {
            type: "number",
            defaultValue: 1024,
            values: "+X",
            share: "private",
            help: "Size of shadowmaps."
        },
        share: {
            type: "bool",
            defaultValue: !1
        },
        show_bones: {
            type: "number",
            defaultValue: 0,
            values: "0, 1, 2, 3",
            share: "private",
            help: "1: Skeleton only, 2: Skeleton + Mesh, 3: Bounding boxes"
        },
        single_sided: {
            type: "bool",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "Force single sided (or double sided) on all material"
        },
        snap_keyframe: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Snap on keyframes."
        },
        sound_enable: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "private",
            help: "Enables the sound feature"
        },
        sound_mute: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Mute any sound"
        },
        sound_preload: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Preloads the sounds"
        },
        split_limit: {
            type: "number",
            defaultValue: 65535,
            values: "+X",
            share: "private",
            help: "Graph optimizer split limit"
        },
        ssao_normal: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "DEBUG ONLY! otherwise needs mrt."
        },
        ssr: {
            type: "bool",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "Forces screen space reflection."
        },
        ssr_transparent: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Enables SSR on transparent material (additive/blending/refraction)."
        },
        sss_jitter: {
            type: "number",
            defaultValue: 1,
            values: "[0, 1]",
            share: "private",
            help: "SSS jitter force ."
        },
        sss_kernel: {
            type: "number",
            defaultValue: 17,
            values: "11, 17, 25",
            share: "private",
            help: "Kernel size for diffuse kernel scattering."
        },
        stats: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "OSGJS option to display stats"
        },
        svg_size: {
            type: "number",
            defaultValue: 2048,
            values: "+X",
            share: "private",
            help: "Default svg size."
        },
        substance_displacement: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Moves vertices in y dimension only (displacement map)."
        },
        supersample: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "private",
            help: "If accumulation supersample is enabled or not."
        },
        tracking: {
            type: "bool",
            defaultValue: !0,
            limited_to: "staff"
        },
        taa: {
            type: "bool",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "Forces disabling/enabling of Temporal Anti-Aliasing."
        },
        taa_animation: {
            type: "bool",
            defaultValue: !1,
            values: "[0, 1]",
            share: "private",
            help: "If we allow taa while an animation is playing."
        },
        taa_feedback_max: {
            type: "number",
            defaultValue: .97,
            values: "[0, 1]",
            share: "private",
            help: "Feedback controls how much the current and the previous frames are blended together. The blending is done within the [min,max] range."
        },
        taa_feedback_min: {
            type: "number",
            defaultValue: .88,
            values: "[0, 1]",
            share: "private",
            help: "Feedback controls how much the current and the previous frames are blended together. The blending is done within the [min,max] range."
        },
        taa_jitter: {
            type: "bool",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "Enable/Disable jittering when not supersampling."
        },
        taa_transparent: {
            type: "bool",
            defaultValue: null,
            values: "0, 1",
            share: "private",
            help: "Enables taa on transparent objects."
        },
        tab: {
            type: "string",
            defaultValue: null,
            values: "scene, lighting, materials, post processing filters, annotations, animation, virtual reality, sound",
            share: "private",
            help: "Default tab opening in the editor (note: the web is not using getOptions, the entry is here for documentation only)."
        },
        texture_frame_budget: {
            type: "number",
            defaultValue: 512,
            values: "+X",
            share: "private",
            help: "x is nb of pixel, Frame texture budget upload/allocation per frame."
        },
        transparent: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "public",
            limited_to: "pro",
            help: "Makes the background transparent."
        },
        ui_animations: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "public",
            limited_to: "prem",
            help: "Hide Animation menu / timeline."
        },
        ui_annotations: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "public",
            limited_to: "prem",
            help: "Hide Annotation menu / controls."
        },
        ui_controls: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "public",
            limited_to: "prem",
            help: "Hide help, Settings, VR, Fullscreen."
        },
        ui_fadeout: {
            type: "bool",
            defaultValue: !0,
            limited_to: "prem"
        },
        ui_fullscreen: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "public",
            limited_to: "prem",
            help: "Hide Fullscreen button."
        },
        ui_general_controls: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "public",
            limited_to: "prem",
            help: "Hide all viewer controls."
        },
        ui_help: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "public",
            limited_to: "prem",
            help: "Hide help button."
        },
        ui_hint: {
            type: "number",
            defaultValue: 1,
            values: "0, 1, 2",
            share: "private",
            help: "Hide viewer hint."
        },
        ui_infos: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "public",
            limited_to: "prem",
            alias: ["desc_button"],
            help: "Hide top info bar."
        },
        ui_inspector: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "private",
            limited_to: "prem",
            help: "Show model inspector."
        },
        ui_inspector_open: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Show model inspector open on start."
        },
        ui_related: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "public",
            limited_to: "pro",
            help: "Hide related models."
        },
        ui_settings: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "public",
            limited_to: "prem",
            help: "Hide Settings button."
        },
        ui_snapshots: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "public",
            help: "Show Save View button."
        },
        ui_sound: {
            type: "bool",
            defaultValue: !0,
            limited_to: "staff"
        },
        ui_stop: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "public",
            alias: ["stop_button"],
            help: "Hide Stop Viewer button. "
        },
        ui_theatre: {
            type: "bool",
            defaultValue: !1,
            limited_to: "prem"
        },
        ui_vr: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "public",
            limited_to: "prem",
            help: "Hide View in VR button."
        },
        ui_watermark: {
            type: "bool",
            defaultValue: !0,
            alias: ["watermark"],
            limited_to: "ent",
            help: "Disable watermark when false."
        },
        ui_watermark_link: {
            type: "bool",
            defaultValue: !0,
            limited_to: "biz",
            help: "Disable link in watermark when false."
        },
        unit_render_local: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Uses for unit render test."
        },
        unit_render_reporter: {
            type: "string",
            defaultValue: "html",
            values: "console, html",
            share: "private",
            help: "To run 1 uid in /tests/screenshot"
        },
        unit_render_task: {
            type: "number",
            defaultValue: null,
            values: "index",
            share: "private",
            help: "To run only one test in /tests/screenshot"
        },
        use_vao: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "private",
            help: "If we use the VAO gl extension."
        },
        varying_sorting: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "private",
            help: "Hack because of earlyz (bug gpu)."
        },
        vr_ar: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "transparent background and no floor (to test)"
        },
        vr_browser_env: {
            type: "string",
            defaultValue: "c0022acc4f3242e2bcae8043e08df8cc",
            values: "uid",
            share: "private",
            help: "Model UID of the environment model for the vr browse."
        },
        vr_fade: {
            type: "number",
            defaultValue: 200,
            values: "+X",
            share: "private",
            help: "Fade time of the black transition in vr."
        },
        vr_launcher_alpha_card_factor: {
            type: "number",
            defaultValue: 1,
            values: "+X",
            share: "private",
            help: "Alpha card factor."
        },
        vr_mirror: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "public",
            help: "Copy VR headset view on desktop screen."
        },
        vr_mobile_max_faces: {
            type: "number",
            defaultValue: 5e4,
            values: "+X",
            share: "public",
            help: "Filter the fetched models in vr on mobile to those with a face count below the value"
        },
        vr_generate_ui_textures: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "private",
            help: "Set to false to disable the UI texture generation in VR (fallback for ios app)"
        },
        vr_force_raf: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "Debug only (force replacement of native raf with hmd raf)."
        },
        vr_link_navigation: {
            type: "bool",
            defaultValue: 0,
            values: "0, 1",
            share: "private",
            help: "1 means the vr launcher use standards link navigation to navigate in VR."
        },
        vr_in_navigation: {
            type: "bool",
            defaultValue: 0,
            values: "0, 1",
            share: "private",
            help: "1 means browser is in vr."
        },
        vr_scale_rtt: {
            type: "number",
            defaultValue: 0,
            values: "+X",
            share: "private",
            help: "If not 0, it will scale the size of te recommended vr renderTarget."
        },
        vr_stereo: {
            type: "bool",
            defaultValue: !0,
            values: "0, 1",
            share: "private",
            help: "Mostly for debugging vr on desktop: disable stereo view in vr context."
        },
        webgl2: {
            type: "bool",
            defaultValue: null,
            values: "0, 1",
            share: "shared",
            help: "Uses webgl2 instead of webgl1 if provided."
        },
        webgl_ext: {
            type: "bool",
            defaultValue: !0,
            share: "private",
            help: "when false, disables any webgl extensions."
        },
        webgl_render_texture: {
            type: "string",
            defaultValue: null,
            values: "none, float, float_linear, half_float,half_float_linear",
            share: "private",
            help: "only allow up to the format"
        },
        webgl_restore: {
            type: "number",
            defaultValue: 3,
            values: "+X",
            share: "private",
            help: "when 0, enables webgl restore on other browser than Edge."
        },
        webgl_timer_gpu: {
            type: "bool",
            defaultValue: !1,
            values: "0, 1",
            share: "private",
            help: "when false, disables gpu timer queries for cleaner gl traces."
        },
        webgl_uniforms: {
            type: "bool",
            defaultValue: !1,
            share: "private",
            help: "artificially limits to 64 uniform."
        }
    }
}, , , function (e, t, i) {
    "use strict";
    var n = i(8);
    t.a = n.a.extend({
        constructor: function (e) {
            this.viewer = e.viewer, this.widgets = e.widgets, n.a.apply(this, arguments)
        },
        enable: function () {
            this.$el.removeClass("disabled")
        },
        disable: function () {
            this.$el.addClass("disabled")
        },
        isEnabled: function () {
            return this.$el.hasClass("disabled")
        }
    })
}, , , , , , , , , , , , , , , , , function (e, t, i) {
    "use strict";
    var n = i(102),
        r = i(92),
        a = i(12),
        o = function () {
            n.a.call(this), this._parents = [], this._attributeArray = [], this._textureAttributeArrayList = [], this._activeTextureAttributeUnit = [], this._activeAttribute = [], this._activeTextureAttribute = [], this._binName = void 0, this._binNumber = 0, this._shaderGeneratorPair = null, this._updateCallbackList = [], this.uniforms = {}, this._hasUniform = !1, this._drawID = -1
        };
    o.AttributePair = function (e, t) {
        this._object = e, this._value = t
    }, o.AttributePair.prototype = {
        getShaderGeneratorName: function () {
            return this._object
        },
        getAttribute: function () {
            return this._object
        },
        getUniform: function () {
            return this._object
        },
        getValue: function () {
            return this._value
        }
    }, a.a.createPrototypeObject(o, a.a.objectInherit(n.a.prototype, {
        setDrawID: function (e) {
            this._drawID = e
        },
        getDrawID: function () {
            return this._drawID
        },
        getAttributePair: function (e, t) {
            return new o.AttributePair(e, t)
        },
        addUniform: function (e, t) {
            var i = void 0 !== t ? t : r.a.ON,
                n = e.getName();
            this.uniforms[n] = this.getAttributePair(e, i), this._hasUniform = !0
        },
        addParent: function (e) {
            this._parents.push(e)
        },
        removeParent: function (e) {
            var t = this._parents.indexOf(e); - 1 !== t && this._parents.splice(t, 1)
        },
        removeUniform: function (e) {
            this.removeUniformByName(e.getName())
        },
        removeUniformByName: function (e) {
            delete this.uniforms[e], this._hasUniform = !!window.Object.keys(this.uniforms).length
        },
        hasUniform: function () {
            return this._hasUniform
        },
        getUniform: function (e) {
            var t = this.uniforms;
            if (t[e]) return t[e].getAttribute()
        },
        getUniformList: function () {
            return this.uniforms
        },
        setTextureAttributeAndModes: function (e, t, i) {
            this._setTextureAttribute(e, this.getAttributePair(t, void 0 !== i ? i : r.a.ON))
        },
        getNumTextureAttributeLists: function () {
            return this._textureAttributeArrayList.length
        },
        getTextureAttribute: function (e, t) {
            var i = a.a.getTextureIdFromTypeMember(t);
            if (void 0 !== i && this._hasTextureAttribute(e, i)) {
                var n = this._textureAttributeArrayList[e];
                return n[i] ? n[i].getAttribute() : void 0
            }
        },
        removeTextureAttribute: function (e, t) {
            var i = a.a.getTextureIdFromTypeMember(t);
            if (void 0 !== i && this._hasTextureAttribute(e, i)) {
                this._textureAttributeArrayList[e][i] = void 0, this._computeValidTextureUnit()
            }
        },
        getAttribute: function (e) {
            var t = a.a.getIdFromTypeMember(e);
            if (void 0 !== t && this._hasAttribute(t)) return this._attributeArray[t].getAttribute()
        },
        setAttributeAndModes: function (e, t) {
            this._setAttribute(this.getAttributePair(e, void 0 !== t ? t : r.a.ON))
        },
        setAttribute: function (e, t) {
            this.setAttributeAndModes(e, t)
        },
        removeAttribute: function (e) {
            var t = a.a.getIdFromTypeMember(e);
            this._hasAttribute(t) && (this._attributeArray[t] = void 0, this._computeValidAttribute())
        },
        setRenderingHint: function (e) {
            "OPAQUE_BIN" === e ? this.setRenderBinDetails(0, "RenderBin") : "TRANSPARENT_BIN" === e ? this.setRenderBinDetails(10, "DepthSortedBin") : this.setRenderBinDetails(0, "")
        },
        getUpdateCallbackList: function () {
            return this._updateCallbackList
        },
        removeUpdateCallback: function (e) {
            var t = this._updateCallbackList.indexOf(e);
            if (-1 !== t && (this._updateCallbackList.splice(t, 1), 0 === this._updateCallbackList.length))
                for (var i = this._parents, n = 0, r = i.length; n < r; n++) {
                    var a = i[n];
                    a.setNumChildrenRequiringUpdateTraversal(a.getNumChildrenRequiringUpdateTraversal() - 1)
                }
        },
        requiresUpdateTraversal: function () {
            return !!this._updateCallbackList.length
        },
        addUpdateCallback: function (e) {
            var t = Boolean(this._updateCallbackList.length);
            if (this._updateCallbackList.push(e), !t)
                for (var i = this._parents, n = 0, r = i.length; n < r; n++) {
                    var a = i[n];
                    a.setNumChildrenRequiringUpdateTraversal(a.getNumChildrenRequiringUpdateTraversal() + 1)
                }
        },
        hasUpdateCallback: function (e) {
            return -1 !== this._updateCallbackList.indexOf(e)
        },
        setRenderBinDetails: function (e, t) {
            this._binNumber = e, this._binName = t
        },
        getAttributeMap: function () {
            for (var e = {}, t = 0, i = this._attributeArray.length; t < i; t++) {
                var n = this._attributeArray[t];
                if (n) {
                    e[n.getAttribute().getTypeMember()] = n
                }
            }
            return e
        },
        getBinNumber: function () {
            return this._binNumber
        },
        getBinName: function () {
            return this._binName
        },
        setBinNumber: function (e) {
            this._binNumber = e
        },
        setBinName: function (e) {
            this._binName = e
        },
        getAttributeList: function () {
            for (var e = this._attributeArray, t = [], i = 0, n = e.length; i < n; i++) e[i] && t.push(e[i]);
            return t
        },
        setShaderGeneratorName: function (e, t) {
            this._shaderGeneratorPair = this.getAttributePair(e, void 0 !== t ? t : r.a.ON)
        },
        getShaderGeneratorPair: function () {
            return this._shaderGeneratorPair
        },
        getShaderGeneratorName: function () {
            return this._shaderGeneratorPair ? this._shaderGeneratorPair.getShaderGeneratorName() : void 0
        },
        releaseGLObjects: function () {
            for (var e = 0, t = this._textureAttributeArrayList.length; e < t; e++) {
                var i = this.getTextureAttribute(e, "Texture");
                i && i.releaseGLObjects()
            }
            for (var n = this.getAttributeList(), r = 0, a = n.length; r < a; r++) n[r]._object.releaseGLObjects && n[r]._object.releaseGLObjects()
        },
        _setTextureAttribute: function (e, t) {
            a.a.arrayDense(e, this._textureAttributeArrayList), this._textureAttributeArrayList[e] || (this._textureAttributeArrayList[e] = []);
            var i = a.a.getOrCreateTextureStateAttributeTypeMemberIndex(t.getAttribute());
            a.a.arrayDense(i, this._textureAttributeArrayList[e]), this._textureAttributeArrayList[e][i] = t, this._computeValidTextureUnit()
        },
        _computeValidTextureUnit: function () {
            this._activeTextureAttributeUnit.length = 0, this._activeTextureAttribute.length = 0;
            for (var e = this._textureAttributeArrayList, t = 0, i = e.length; t < i; t++) {
                var n = e[t];
                if (n && n.length) {
                    for (var r = !1, a = 0, o = n.length; a < o; a++) n[a] && (r = !0, -1 === this._activeTextureAttribute.indexOf(a) && this._activeTextureAttribute.push(a));
                    r && this._activeTextureAttributeUnit.push(t)
                }
            }
        },
        _computeValidAttribute: function () {
            this._activeAttribute.length = 0;
            for (var e = this._attributeArray, t = 0, i = e.length; t < i; t++) e[t] && this._activeAttribute.push(t)
        },
        _setAttribute: function (e) {
            var t = a.a.getOrCreateStateAttributeTypeMemberIndex(e.getAttribute());
            a.a.arrayDense(t, this._attributeArray), this._attributeArray[t] = e, this._computeValidAttribute()
        },
        _hasAttribute: function (e) {
            return !(e >= this._attributeArray.length) && !!this._attributeArray[e]
        },
        _hasTextureAttribute: function (e, t) {
            return !(e >= this._textureAttributeArrayList.length || !this._textureAttributeArrayList[e]) && (!(t >= this._textureAttributeArrayList[e].length) && !!this._textureAttributeArrayList[e][t])
        }
    }), "osg", "StateSet"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(138),
        r = i(319),
        a = function (e, t) {
            this.mode = n.a.POINTS, void 0 !== e && ("string" == typeof e && (e = n.a[e]), this.mode = e), this.count = 0, this.offset = 0, this.indices = t, this.uType = a.UNSIGNED_SHORT, void 0 !== t && this.setIndices(t)
        };
    a.UNSIGNED_BYTE = 5121, a.UNSIGNED_SHORT = 5123, a.UNSIGNED_INT = 5125, a.prototype = {
        getMode: function () {
            return this.mode
        },
        draw: function (e) {
            0 !== this.count && (e.setIndexArray(this.indices), this.drawElements(e))
        },
        drawElements: function (e) {
            e.getGraphicContext().drawElements(this.mode, this.count, this.uType, this.offset)
        },
        setIndices: function (e) {
            var t = e.getElements();
            r.a.instance().isWebGL2() && (1 === t.BYTES_PER_ELEMENT ? -1 !== t.indexOf(255) && e.setElements(new Uint16Array(t)) : 2 === t.BYTES_PER_ELEMENT && -1 !== t.indexOf(65535) && e.setElements(new Uint32Array(t))), this.indices = e, this.count = t.length;
            var i = t.BYTES_PER_ELEMENT;
            1 === i ? this.uType = a.UNSIGNED_BYTE : 2 === i ? this.uType = a.UNSIGNED_SHORT : 4 === i && (this.uType = a.UNSIGNED_INT)
        },
        getIndices: function () {
            return this.indices
        },
        setFirst: function (e) {
            this.offset = e
        },
        getFirst: function () {
            return this.offset
        },
        setCount: function (e) {
            this.count = e
        },
        getCount: function () {
            return this.count
        },
        getNumIndices: function () {
            return this.indices.getElements().length
        },
        index: function (e) {
            return this.indices.getElements()[e]
        }
    }, t.a = a
}, function (e, t, i) {
    "use strict";
    var n = function () {
        this._pool = [], this._length = 0
    };
    n.prototype = {
        clean: function () {
            this._length = 0, this._pool.length = 0
        },
        reset: function () {
            this._length = 0
        },
        getLength: function () {
            return this._length
        },
        getArray: function () {
            return this._pool
        },
        back: function () {
            return this._pool[this._length - 1]
        },
        pop: function () {
            return this._length--, this._pool[this._length]
        },
        push: function (e) {
            this._length === this._pool.length ? this._pool.push(e) : this._pool[this._length] = e, this._length++
        },
        forEach: function (e) {
            for (var t = 0; t < this._length; t++) e(this._pool[t])
        }
    }, t.a = n
}, function (e, t, i) {
    "use strict";
    var n = i(138),
        r = function (e, t, i) {
            this.mode = e, void 0 !== e && ("string" == typeof e && (e = n.a[e]), this.mode = e), this.first = t, this.count = i
        };
    r.prototype = {
        draw: function (e) {
            if (0 !== this.count) {
                e.getGraphicContext().drawArrays(this.mode, this.first, this.count)
            }
        },
        getMode: function () {
            return this.mode
        },
        setCount: function (e) {
            this.count = e
        },
        getCount: function () {
            return this.count
        },
        setFirst: function (e) {
            this.first = e
        },
        getFirst: function () {
            return this.first
        },
        getNumIndices: function () {
            return this.count
        },
        index: function (e) {
            return this.first + e
        }
    }, t.a = r
}, function (e, t, i) {
    "use strict";
    var n, r = i(12),
        a = i(36),
        o = i(612),
        s = i(406),
        u = i(92),
        l = i(687),
        c = i(315),
        h = o.a.getOptionsURL().shaderStats ? {} : void 0,
        d = o.a.getOptionsURL().syncCompile,
        f = new Uint8Array(4),
        p = function (e) {
            e.flush(), e.finish(), e.readPixels(0, 0, 1, 1, e.RGBA, e.UNSIGNED_BYTE, f)
        },
        m = /uniform\s+\w+\s+(\w+)((\s)?\[(.*?)\])?/g,
        g = /(in|attribute)\s+\w+\s+(\w+)\s*;/g,
        v = function (e) {
            for (var t, i, n = {}; null !== (t = g.exec(e));) i = t[2], n[i] = !0;
            return n
        },
        _ = function (e) {
            for (var t, i = {}; null !== (t = m.exec(e));) {
                i[t[1]] = !0
            }
            return i
        },
        b = function (e, t) {
            s.a.call(this), u.a.call(this), this._program = null, this._nullProgram = !0, this._vertex = void 0, this._fragment = void 0, this._uniformsCache = void 0, this._attributesCache = void 0, this._activeUniforms = void 0, this._foreignUniforms = void 0, this._trackAttributes = void 0, this._asyncCompilation = void 0, this._compileClean = void 0, e && this.setVertexShader(e), t && this.setFragmentShader(t), this._dirty = !0
        };
    b._sDeletedGLProgramCache = new window.Map, b.deleteGLProgram = function (e, t) {
        b._sDeletedGLProgramCache.has(e) || b._sDeletedGLProgramCache.set(e, []), b._sDeletedGLProgramCache.get(e).push(t)
    }, b.flushDeletedGLPrograms = function (e, t) {
        if (t <= 0) return t;
        if (!b._sDeletedGLProgramCache.has(e)) return t;
        for (var i = 0, n = c.a.instance().tick(), r = b._sDeletedGLProgramCache.get(e), a = r.length, o = a - 1; o >= 0 && i < t; o--) e.deleteProgram(r[o]), r.splice(o, 1), i = c.a.instance().deltaS(n, c.a.instance().tick());
        return t - i
    }, b.flushAllDeletedGLPrograms = function (e) {
        if (b._sDeletedGLProgramCache.has(e))
            for (var t = b._sDeletedGLProgramCache.get(e), i = t.length, n = i - 1; n >= 0; n--) e.deleteProgram(t[n]), t.splice(n, 1)
    }, b.onLostContext = function (e) {
        if (b._sDeletedGLProgramCache.has(e)) {
            b._sDeletedGLProgramCache.get(e).length = 0
        }
    }, r.a.createPrototypeStateAttribute(b, r.a.objectInherit(s.a.prototype, r.a.objectInherit(u.a.prototype, {
        attributeType: "Program",
        cloneType: function () {
            return new b
        },
        setVertexShader: function (e) {
            this._vertex = e, this._nullProgram = !1, e.setText(l.a.processShader(e.getText()))
        },
        setFragmentShader: function (e) {
            this._fragment = e, this._nullProgram = !1, e.setText(l.a.processShader(e.getText()))
        },
        getVertexShader: function () {
            return this._vertex
        },
        getFragmentShader: function () {
            return this._fragment
        },
        getProgram: function () {
            return this._program
        },
        setActiveUniforms: function (e) {
            this._activeUniforms = e
        },
        getActiveUniforms: function () {
            return this._activeUniforms
        },
        setForeignUniforms: function (e) {
            this._foreignUniforms = e
        },
        getForeignUniforms: function () {
            return this._foreignUniforms
        },
        setUniformsCache: function (e) {
            this._uniformsCache = e
        },
        getUniformsCache: function () {
            return this._uniformsCache
        },
        setAttributesCache: function (e) {
            this._attributesCache = e
        },
        getAttributesCache: function () {
            return this._attributesCache
        },
        setTrackAttributes: function (e) {
            this._trackAttributes = e
        },
        getTrackAttributes: function () {
            return this._trackAttributes
        },
        releaseGLObjects: function () {
            void 0 !== this._vertex && this._vertex.releaseGLObjects(), void 0 !== this._fragment && this._fragment.releaseGLObjects(), null !== this._program && (void 0 !== this._gl && (b.deleteGLProgram(this._gl, this._program), s.a.removeObject(this._gl, this)), this.invalidate())
        },
        dirty: function () {
            this._program = void 0
        },
        invalidate: function () {
            this._cacheUniformId = void 0, this._uniformsCache = void 0, this._attributesCache = void 0, this._foreignUniforms = void 0, this._trackAttributes = void 0, this._compileClean = void 0, this._program = void 0
        },
        _rebuildProgramFromSpector: function (e, t, i, n) {
            this._dirty = !0, this._vertex.invalidate(), this._fragment.invalidate(), this.invalidate(), this._vertex.setText(e), this._fragment.setText(t), this._program = null, this._spectorOnCompiled = i, this._spectorOnError = n, this._compileClean = void 0
        },
        _onErrorToSpector: function (e) {
            return !!this._spectorOnError && (this._spectorOnError(e), !0)
        },
        _onCompilationToSpector: function () {
            this._spectorOnCompiled && this._spectorOnCompiled(this._program)
        },
        _bindProgramToSpector: function () {
            window && window.spector && !this._program.__SPECTOR_rebuildProgram && (this._program.__SPECTOR_rebuildProgram = this._rebuildProgramFromSpector.bind(this))
        },
        _logDebugShaders: function (e, t) {
            if ("Failed to create D3D shaders.\n" === t) {
                var i = void 0 !== e.rawgl ? e.rawgl : e;
                void 0 !== i && void 0 === i.getExtension && (i = i.getExtension("WEBGL_debug_shaders")) && (a.a.error(i.getTranslatedShaderSource(this._vertex.shader)), a.a.error(i.getTranslatedShaderSource(this._fragment.shader)))
            }
        },
        _activateFailSafe: function (e) {
            var t = e.createProgram();
            this._vertex.failSafe(e, this._vertex.getText()), this._fragment.failSafe(e, this._fragment.getText()), this._glAttachAndLink(e, t, this._vertex, this._fragment), a.a.warn("FailSafe shader Activated "), this._program = t
        },
        _glAttachAndLink: function (e, t, i, n) {
            e.attachShader(t, i.shader), e.attachShader(t, n.shader), e.linkProgram(t)
        },
        _glShaderCompile: function (e, t) {
            t.shader || (h && (t === this._vertex ? h.vert = c.a.tick() : h.frag = c.a.tick()), t.compile(e, n))
        },
        _glShaderCompilationResult: function (e, t) {
            var i = t.getCompilationResult(e, n);
            return h && (void 0 === this._asyncCompilation && p(e), t === this._vertex ? h.vert = c.a.tick() - h.vert : h.frag = c.a.tick() - h.frag), i
        },
        compile: function () {
            var e = this._gl,
                t = this._fragment.getText(),
                i = this._vertex.getText();
            this._attributeMap = v(i), this._uniformMap = _(t + "\n" + i), this._glShaderCompile(e, this._vertex), this._glShaderCompile(e, this._fragment)
        },
        getShaderName: function () {
            if (this._shaderName) return this._shaderName;
            if (this._fragment && this._fragment.getText()) {
                var e = this._fragment.getText().match(/^#define\s+SHADER_NAME\s+(.*)$/m);
                return this._shaderName = e && e[1] ? e[1] : "", this._shaderName
            }
        },
        getCompilationResultAndLink: function (e) {
            return !!this._compileClean || (h && (h.vert = 0, h.frag = 0, h.link = 0, h.total = 0, void 0 === this._asyncCompilation && p(e), h.total = c.a.tick(), a.a.log(this.getShaderName() + " start"), a.a.timeStamp(this.getShaderName() + " start")), this._compileClean = this._glShaderCompilationResult(e, this._vertex), this._compileClean = this._glShaderCompilationResult(e, this._fragment) && this._compileClean, h && (a.a.log(this.getShaderName() + " compilation"), a.a.timeStamp(this.getShaderName() + " compilation")), !!this._compileClean && (this._program = e.createProgram(), this._attributeMap.Vertex && e.bindAttribLocation(this._program, 0, "Vertex"), this._glAttachAndLink(e, this._program, this._vertex, this._fragment), !0))
        },
        getAsyncCompiling: function () {
            return this._asyncCompilation
        },
        _logShaderStats: function (e) {
            if (void 0 === this._asyncCompilation && p(e), h.link = c.a.tick() - h.link, h.link) {
                h.total = c.a.tick() - h.total, this._placeHolder && (h.total = h.vert + h.frag + h.link);
                var t = (this._placeHolder ? "Async" : "") + this.getShaderName() + " - " + h.total.toFixed(2) + "ms";
                a.a.group(t), a.a.log("vertex : " + h.vert.toFixed(2) + "ms"), a.a.log("fragment : " + h.frag.toFixed(2) + "ms"), a.a.log("link : " + h.link.toFixed(2) + "ms"), a.a.log("total : " + h.total.toFixed(2) + "ms"), a.a.groupEnd(t)
            }
        },
        getLinkResult: function (e) {
            if (this._compileClean) {
                h && (h.link = c.a.tick(), a.a.log(this.getShaderName() + " link"), a.a.timeStamp(this.getShaderName() + " link"));
                var t = e.getProgramParameter(this._program, e.LINK_STATUS);
                if (h && this._logShaderStats(e), t || e.isContextLost()) this._onCompilationToSpector(this._program);
                else {
                    var i = e.getProgramInfoLog(this._program);
                    if (a.a.errorFold(i, "can't link program\nvertex shader:\n" + this._vertex.text + "\n fragment shader:\n" + this._fragment.text), this._logDebugShaders(e, i), n && n(this._vertex.text, this._fragment.text, i), this._compileClean = !1, this._onErrorToSpector(i)) return
                }
            }
            return this._dirty = !1, this._asyncCompilation = -1, this._placeHolder = void 0, this._uniformsCache = {}, this._attributesCache = {}, this._compileClean ? (this.cacheAttributeList(e, window.Object.keys(this._attributeMap)), this.cacheUniformList(e, window.Object.keys(this._uniformMap))) : this._activateFailSafe(e), this._bindProgramToSpector(), this._compileClean
        },
        enableAsyncCompilation: function (e, t) {
            this._placeHolder = e, this._asyncCompilation = t
        },
        apply: function (e) {
            if (!this._nullProgram) {
                if (this._gl || this.setGraphicContext(e.getGraphicContext()), this._program && !this._dirty) return void e.applyProgram(this._program);
                if (this._placeHolder) return void this._placeHolder.apply(e);
                if (this.compile(), d || -1 === this._fragment.getText().indexOf("#pragma compilationAsync")) return this.getCompilationResultAndLink(this._gl), this.getLinkResult(this._gl), e.applyProgram(this._program), void(this._dirty = !1);
                this._asyncCompilation = 1
            }
        },
        cacheUniformList: function (e, t) {
            for (var i = this._uniformsCache, n = 0, r = t.length; n < r; n++) {
                var a = t[n],
                    o = e.getUniformLocation(this._program, a);
                void 0 !== o && null !== o && void 0 === i[a] && (i[a] = o)
            }
        },
        cacheAttributeList: function (e, t) {
            for (var i = this._attributesCache, n = 0, r = t.length; n < r; n++) {
                var a = t[n],
                    o = e.getAttribLocation(this._program, a); - 1 !== o && void 0 !== o && void 0 === i[a] && (i[a] = o)
            }
        }
    })), "osg", "Program"), b.registerErrorCallback = function (e) {
        n = e
    }, t.a = b
}, , , , function (e, t, i) {
    "use strict";
    var n = i(3),
        r = i.n(n),
        a = i(0),
        o = (i.n(a), i(65));
    t.a = function () {
        var e = r.a.ajax;
        r.a.ajax = function () {
            var t = arguments.length >= 2 ? arguments[1] : arguments[0];
            if (t = Object(a.extend)({
                    allowPrefetching: !0,
                    cacheBusting: !0
                }, t), t.method) throw new Error('The "method" option is actually "type" ;)');
            if (t.allowPrefetch) throw new Error('The "allowPrefetch" option is actually "allowPrefetching" ;)');
            if (t.immediate && !t.allowPrefetching) throw new Error('The "immediate" option cannot be used with "allowPrefetching" false (mutually exclusives)');
            if ("GET" === t.type.toUpperCase()) {
                var i = o.a.get(t.url);
                if (!i && t.immediate) throw new Error('The "' + t.url + '" URL should be prefetched: immediate loading required');
                if (i && t.allowPrefetching) {
                    var n = {
                        status: 200,
                        data: i
                    };
                    t.success && t.success(n.data, "success", n), t.complete && t.complete(n, "success");
                    var s = r.a.Deferred().resolve(n.data, "success", n);
                    return s.readyState = 4, s.status = 200, s.abort = function () {}, s
                }
                var u = e.apply(this, arguments);
                return u.then(function (e, i, n) {
                    return o.a.register(t.url, e), r.a.Deferred().resolve(e, i, n)
                }), u
            }
            return "PATCH" === t.type.toUpperCase() ? (o.a.update(t.url, "string" == typeof t.data ? JSON.parse(t.data) : t.data), e.apply(this, arguments)) : t.cacheBusting ? (o.a.invalidate(t.url), e.apply(this, arguments)) : e.apply(this, arguments)
        }
    }
}, , , , , , , , , , , function (e, t, i) {
    "use strict";
    var n, r = i(647),
        a = i(20),
        o = [{
            type: "VERTEX_SHADER",
            text: ["attribute vec3 aPosition;", "void main() {", "gl_Position = vec4(aPosition, 1.0);", "}"].join("\n")
        }, {
            type: "FRAGMENT_SHADER",
            text: ["#version 100", "#ifdef GL_FRAGMENT_PRECISION_HIGH", "  precision highp float;", "#else", " precision mediump float;", "#endif", "uniform sampler2D uT0;", "uniform sampler2D uT1;", "uniform sampler2D uT2;", "uniform sampler2D uT3;", "uniform ivec4 uR;", "varying vec2 vT;", "varying vec3 vC;", "varying vec3 vColor;", "varying vec4 vColor2;", "void f(in vec3 a, out vec3 b) {", "b = 2.0 * a;", "}", "#define LIN_SRGB(x) x < 0.0031308 ? x * 12.92 : 1.055 * pow(x, 1.0/2.4) - 0.055", "#define SRGB_LIN(x) x < 0.04045 ? x * (1.0 / 12.92) : pow((x + 0.055) * (1.0 / 1.055), 2.4)", "float linearTosRGB(const in float color) { return LIN_SRGB(color); }", "vec3 linearTosRGB(const in vec3 color) { return vec3(LIN_SRGB(color.r), LIN_SRGB(color.g), LIN_SRGB(color.b)); }", "vec4 linearTosRGB(const in vec4 color) { return vec4(LIN_SRGB(color.r), LIN_SRGB(color.g), LIN_SRGB(color.b), color.a); }", "void main(void) {", "vec4 col;", "col.r = linearTosRGB(vColor2.r);", "col.rgb = linearTosRGB(vColor);", "f(vC, col.xyz);", "if ( uR.x == 3 ) {", "  col.rgb = texture2D( uT0, vT ).aaa;", "  col.a = uR.y == 0 ? texture2D( uT1, vT ).r : texture2D( uT1, vT ).a;", "} else if ( uR.x == 2 ) {", "  col.rgb = texture2D( uT0, vT ).rgb;", "  col.a = uR.y == 0 ? texture2D( uT1, vT ).r : texture2D( uT1, vT ).a;", "} else {", "  col.r = uR.x == 0 ? texture2D( uT0, vT ).r : texture2D( uT0, vT ).a;", "  col.g = uR.y == 0 ? texture2D( uT1, vT ).r : texture2D( uT1, vT ).a;", "  col.b = uR.z == 0 ? texture2D( uT2, vT ).r : texture2D( uT2, vT ).a;", "  col.a = uR.w == 0 ? texture2D( uT3, vT ).r : texture2D( uT3, vT ).a;", "}", "gl_FragColor = gl_FrontFacing ? vec4(col.rgb, 1.0) : col;", "}"].join("\n")
        }],
        s = function (e, t, i) {
            var n = t;
            "string" == typeof n && (n = e[t]);
            var r = e.createShader(n);
            return e.shaderSource(r, i), e.compileShader(r), !(!e.getShaderParameter(r, e.COMPILE_STATUS) && !e.isContextLost()) || (console.warn("Could't compile shader " + i), console.warn(e.getShaderInfoLog(r)), console.warn("You may want to consider a browser that fully supports WebGL."), !1)
        };
    t.a = function () {
        if (void 0 !== window.sketchfabWebGLSupport) return window.sketchfabWebGLSupport;
        if (n = !1, window.sketchfabWebGLSupport = n, !window.Set || !window.Map || !window.Uint8ClampedArray) return !1;
        if (Object(r.a)()) return !1;
        try {
            var e = ["webgl", "experimental-webgl"],
                t = {
                    antialias: !1
                },
                i = null,
                u = document.createElement("canvas");
            if (!u || !u.getContext) return !1;
            for (var l = 0; l < e.length && !(i = u.getContext(e[l], t)); l++);
            if (!(i && i.getParameter && i.getExtension && i.getShaderPrecisionFormat)) return !1;
            var c = i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS);
            if (!c || c < 64) return !1;
            var h = i.getParameter(i.MAX_VARYING_VECTORS);
            if (!h || h < 8) return !1;
            var d = i.getExtension("WEBGL_debug_renderer_info");
            if (d && "Google SwiftShader" === i.getParameter(d.UNMASKED_RENDERER_WEBGL) && !Object(a.a)().allowSwiftShader) return !1;
            n = o.every(function (e) {
                return s(i, e.type, e.text)
            })
        } catch (e) {
            return !1
        }
        return window.sketchfabWebGLSupport = n, n
    }
}, , , , , , function (e, t, i) {
    "use strict";
    var n, r = i(147);
    window.requestAnimationFrame && (n = Object(r.a)() ? function () {
        return 0
    } : window.requestAnimationFrame.bind(window)), t.a = {
        get: function () {
            return n
        }
    }
}, , function (e, t, i) {
    "use strict";
    var n = function () {
            var e = window || global;
            if (void 0 === e.performance) return function () {
                return Date.now()
            };
            var t = e.performance.now || e.performance.mozNow || e.performance.msNow || e.performance.oNow || e.performance.webkitNow || function () {
                return Date.now()
            };
            return function () {
                return t.apply(e.performance, arguments)
            }
        }(),
        r = function () {};
    r.instance = function () {
        return r._instance || (r._instance = new r), r._instance
    }, r.tick = n, r.prototype = {
        deltaS: function (e, t) {
            return (t - e) / 1e3
        },
        deltaM: function (e, t) {
            return t - e
        },
        tick: function () {
            return n()
        }
    }, t.a = r
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(137),
        a = i(10),
        o = i(177),
        s = function () {
            r.a.call(this), this.referenceFrame = o.a.RELATIVE_RF
        };
    n.a.createPrototypeNode(s, n.a.objectInherit(r.a.prototype, {
        setReferenceFrame: function (e) {
            this.referenceFrame = e
        },
        getReferenceFrame: function () {
            return this.referenceFrame
        },
        computeBoundingSphere: function () {
            var e = a.c.create();
            return function (t) {
                return r.a.prototype.computeBoundingSphere.call(this, t), t.valid() ? (a.c.identity(e), this.computeLocalToWorldMatrix(e), t.transformMat4(t, e), t) : t
            }
        }()
    }), "osg", "Transform"), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(36),
        r = i(12),
        a = i(10),
        o = function () {
            this._min = a.f.create(), this._max = a.f.create(), this.init()
        };
    r.a.createPrototypeObject(o, {
        init: function () {
            a.f.copy(this._min, a.f.INFINITY), a.f.copy(this._max, a.f.NEGATIVE_INFINITY)
        },
        volume: function () {
            var e = this._max[0] - this._min[0];
            return e *= this._max[1] - this._min[1], e *= this._max[2] - this._min[2]
        },
        copy: function (e) {
            a.f.copy(this._min, e._min), a.f.copy(this._max, e._max)
        },
        valid: function () {
            return this._max[0] >= this._min[0] && this._max[1] >= this._min[1] && this._max[2] >= this._min[2]
        },
        expandByBoundingSphere: function (e) {
            if (e.valid()) {
                var t = this._max,
                    i = this._min,
                    n = e._radius,
                    r = e._center[0],
                    a = e._center[1],
                    o = e._center[2];
                i[0] = Math.min(i[0], r - n), i[1] = Math.min(i[1], a - n), i[2] = Math.min(i[2], o - n), t[0] = Math.max(t[0], r + n), t[1] = Math.max(t[1], a + n), t[2] = Math.max(t[2], o + n)
            }
        },
        expandByvec3: function (e) {
            n.a.warn("deprecated, use expandByVec3"), this.expandByVec3(e)
        },
        expandByVec3: function (e) {
            var t = this._min,
                i = this._max;
            t[0] = Math.min(t[0], e[0]), t[1] = Math.min(t[1], e[1]), t[2] = Math.min(t[2], e[2]), i[0] = Math.max(i[0], e[0]), i[1] = Math.max(i[1], e[1]), i[2] = Math.max(i[2], e[2])
        },
        expandByBoundingBox: function (e) {
            if (e.valid()) {
                var t = this._min,
                    i = this._max,
                    n = e._min,
                    r = e._max;
                n[0] < t[0] && (t[0] = n[0]), r[0] > i[0] && (i[0] = r[0]), n[1] < t[1] && (t[1] = n[1]), r[1] > i[1] && (i[1] = r[1]), n[2] < t[2] && (t[2] = n[2]), r[2] > i[2] && (i[2] = r[2])
            }
        },
        center: function (e) {
            var t = this._min,
                i = this._max;
            return e[0] = .5 * (t[0] + i[0]), e[1] = .5 * (t[1] + i[1]), e[2] = .5 * (t[2] + i[2]), e
        },
        radius: function () {
            return Math.sqrt(this.radius2())
        },
        radius2: function () {
            var e = this._min,
                t = this._max,
                i = t[0] - e[0],
                n = t[1] - e[1],
                r = t[2] - e[2];
            return .25 * (i * i + n * n + r * r)
        },
        getMin: function () {
            return this._min
        },
        getMax: function () {
            return this._max
        },
        setMin: function (e) {
            return a.f.copy(this._min, e), this
        },
        setMax: function (e) {
            return a.f.copy(this._max, e), this
        },
        xMax: function () {
            return this._max[0]
        },
        yMax: function () {
            return this._max[1]
        },
        zMax: function () {
            return this._max[2]
        },
        xMin: function () {
            return this._min[0]
        },
        yMin: function () {
            return this._min[1]
        },
        zMin: function () {
            return this._min[2]
        },
        corner: function (e, t) {
            return t[0] = 1 & e ? this._max[0] : this._min[0], t[1] = 2 & e ? this._max[1] : this._min[1], t[2] = 4 & e ? this._max[2] : this._min[2], t
        },
        transformMat4: function () {
            var e = a.f.create(),
                t = a.f.create();
            return function (i, n) {
                var r = this.getMin(),
                    o = this.getMax();
                a.c.getTranslation(e, n), a.f.copy(t, e);
                for (var s = 0; s < 3; ++s)
                    for (var u = 4 * s, l = r[s], c = o[s], h = 0; h < 3; ++h) {
                        var d = n[u + h],
                            f = d * c,
                            p = d * l;
                        f < p ? (e[h] += f, t[h] += p) : (e[h] += p, t[h] += f)
                    }
                var m = i.getMax(),
                    g = i.getMin();
                return m[0] = t[0], m[1] = t[1], m[2] = t[2], g[0] = e[0], g[1] = e[1], g[2] = e[2], i
            }
        }()
    }, "osg", "BoundingBox"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = function (e) {
        this._createFunction = e, this._pool = [], this._length = 0
    };
    n.prototype = {
        clean: function () {
            this._pool.length = 0, this._length = 0
        },
        getLength: function () {
            return this._length
        },
        reset: function () {
            this._length = 0
        },
        getOrCreateObject: function () {
            var e;
            return this._length === this._pool.length ? (e = this._createFunction(), this._pool.push(e)) : e = this._pool[this._length], this._length++, e
        },
        forEach: function (e) {
            for (var t = 0; t < this._length; t++) e(this._pool[t])
        }
    }, t.a = n
}, function (e, t, i) {
    "use strict";
    var n, r = i(36),
        a = i(848),
        o = i(612),
        s = i(20),
        u = function () {
            n || (n = i(118).default), this._checkRTT = {}, this._webGLExtensions = {}, this._webGLParameters = {}, this._webGLShaderMaxInt = "NONE", this._webGLShaderMaxFloat = "NONE", this._bugsDB = {}, this._webGLPlatforms = {}, this._webGLParameters.MAX_COMBINED_TEXTURE_IMAGE_UNITS = 8, this._webGLParameters.MAX_CUBE_MAP_TEXTURE_SIZE = 16, this._webGLParameters.MAX_FRAGMENT_UNIFORM_VECTORS = 16, this._webGLParameters.MAX_RENDERBUFFER_SIZE = 1, this._webGLParameters.MAX_TEXTURE_IMAGE_UNITS = 8, this._webGLParameters.MAX_TEXTURE_SIZE = 64, this._webGLParameters.MAX_VARYING_VECTORS = 8, this._webGLParameters.MAX_VERTEX_ATTRIBS = 8, this._webGLParameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS = 0, this._webGLParameters.MAX_VERTEX_UNIFORM_VECTORS = 128, this._webGLParameters.MAX_VIEWPORT_DIMS = [1, 1], this._webGLParameters.NUM_COMPRESSED_TEXTURE_FORMATS = 0, this._webGLParameters.MAX_SHADER_PRECISION_FLOAT = "none", this._webGLParameters.MAX_SHADER_PRECISION_INT = "none", this._gl = void 0
        };
    u.instance = function (e, t) {
        if (!u._instance) {
            var i, n = e;
            if (!n) {
                "undefined" != typeof window && window.gli && (i = window.gli.host.inspectContext, window.gli.host.inspectContext = !1);
                var s = document.createElement("canvas");
                s.width = 32, s.height = 32;
                var l = new o.a;
                l.extend({
                    antialias: !1
                }), l.extendWithOptionsURL(), n = a.a.setupWebGL(s, l, function () {})
            }
            u._instance = new u, n ? u._instance.init(n) : r.a.warn("no support for webgl context detected."), i && (window.gli.host.inspectContext = i)
        }
        return e && (t || e !== u._instance.getContext()) && u._instance.initContextDependant(e), u._instance
    }, u.prototype = {
        getContext: function () {
            return this._gl
        },
        initContextDependant: function (e) {
            this._gl = e, this._isGL2 = void 0 !== window.WebGL2RenderingContext && e instanceof window.WebGL2RenderingContext, this.initWebGLExtensions(e), Object(s.a)().webglUniforms && (this._webGLParameters.MAX_FRAGMENT_UNIFORM_VECTORS = 64), this.hasLinearHalfFloatRTT(e), this.hasLinearFloatRTT(e), this.hasHalfFloatRTT(e), this.hasFloatRTT(e)
        },
        init: function (e) {
            if (this.initWebGLParameters(e), this.initPlatformSupport(), this.initBugDB(e), this.initContextDependant(e), this._isGL2)
                for (var t = ["OES_element_index_uint", "EXT_sRGB", "EXT_blend_minmax", "EXT_frag_depth", "WEBGL_depth_texture", "EXT_shader_texture_lod", "OES_standard_derivatives", "OES_texture_float", "OES_texture_half_float", "OES_texture_half_float_linear", "OES_texture_float_linear", "OES_vertex_array_object", "WEBGL_draw_buffers", "OES_fbo_render_mipmap", "ANGLE_instanced_arrays"], i = u._instance.getWebGLExtensions(), n = function () {}, r = 0, a = t.length; r < a; r++) i[t[r]] = n
        },
        isWebGL2: function () {
            return this._isGL2
        },
        initBugDB: function (e) {
            var t = this._webGLPlatforms,
                i = this._webGLParameters;
            if (t.Apple && (i.UNMASKED_VENDOR_WEBGL && -1 === i.UNMASKED_VENDOR_WEBGL.indexOf("Intel") || (this._bugsDB.OES_standard_derivatives = !0)), e.getExtension("EXT_shader_texture_lod")) {
                var n = {
                    type: "FRAGMENT_SHADER",
                    text: ["#version 100", "#extension GL_EXT_shader_texture_lod : require", "#ifdef GL_FRAGMENT_PRECISION_HIGH", "  precision highp float;", "#else", " precision mediump float;", "#endif", "uniform samplerCube uT0;", "varying vec3 vC;", "void main(void) {", "  gl_FragColor = textureCubeLodEXT(uT0, vC, 1.0);", "}"].join("\n")
                };
                this.checkShader(e, n.type, n.text) || (this._bugsDB.EXT_shader_texture_lod = !0)
            }
        },
        checkShader: function (e, t, i) {
            var n = t;
            "string" == typeof n && (n = e[t]);
            var a = e.createShader(n);
            return e.shaderSource(a, i), e.compileShader(a), !(!e.getShaderParameter(a, e.COMPILE_STATUS) && !e.isContextLost()) || (r.a.warn(e.getShaderInfoLog(a)), !1)
        },
        initPlatformSupport: function () {
            var e = this._webGLPlatforms;
            e.Apple = -1 !== navigator.vendor.indexOf("Apple") || -1 !== navigator.vendor.indexOf("OS X"), e.Mobile = /Mobi/.test(navigator.userAgent) || /ablet/.test(navigator.userAgent)
        },
        getWebGLPlatform: function (e) {
            return this._webGLPlatforms[e]
        },
        getWebGLPlatforms: function () {
            return this._webGLPlatforms
        },
        getWebGLParameter: function (e) {
            return this._webGLParameters[e]
        },
        getWebGLParameters: function () {
            return this._webGLParameters
        },
        getShaderMaxPrecisionFloat: function () {
            return this._webGLParameters.MAX_SHADER_PRECISION_FLOAT
        },
        getShaderMaxPrecisionInt: function () {
            return this._webGLParameters.MAX_SHADER_PRECISION_INT
        },
        checkSupportRTT: function (e, t, i) {
            var r = t + "," + i;
            if (this._isGL2) return !!this._webGLExtensions.EXT_color_buffer_float;
            if (void 0 !== this._checkRTT[r]) return this._checkRTT[r];
            if (!e) return !1;
            switch (Object(s.a)().webglRenderTexture) {
                case "none":
                    return !1;
                case "float":
                    if (t === n.FLOAT && i === n.LINEAR) return !1;
                    break;
                case "half_float":
                    if (t === n.FLOAT) return !1;
                    if (i === n.LINEAR) return !1;
                    break;
                case "half_float_linear":
                    if (t === n.FLOAT) return !1
            }
            var a = e.createTexture();
            e.bindTexture(e.TEXTURE_2D, a), e.texImage2D(e.TEXTURE_2D, 0, e.RGBA, 2, 2, 0, e.RGBA, t, null), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MAG_FILTER, i), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, i);
            var o = e.createFramebuffer();
            e.bindFramebuffer(e.FRAMEBUFFER, o), e.framebufferTexture2D(e.FRAMEBUFFER, e.COLOR_ATTACHMENT0, e.TEXTURE_2D, a, 0);
            var u = this._checkRTT[r] = e.checkFramebufferStatus(e.FRAMEBUFFER) === e.FRAMEBUFFER_COMPLETE;
            return e.deleteTexture(a), e.deleteFramebuffer(o), e.bindTexture(e.TEXTURE_2D, null), e.bindFramebuffer(e.FRAMEBUFFER, null), u
        },
        hasLinearHalfFloatRTT: function (e) {
            return this._webGLExtensions.OES_texture_half_float_linear && this.checkSupportRTT(e, n.HALF_FLOAT_OES, n.LINEAR)
        },
        hasLinearFloatRTT: function (e) {
            return this._webGLExtensions.OES_texture_float_linear && this.checkSupportRTT(e, n.FLOAT, n.LINEAR)
        },
        hasHalfFloatRTT: function (e) {
            return this._webGLExtensions.OES_texture_half_float && this.checkSupportRTT(e, n.HALF_FLOAT_OES, n.NEAREST)
        },
        hasFloatRTT: function (e) {
            return this._webGLExtensions.OES_texture_float && this.checkSupportRTT(e, n.FLOAT, n.NEAREST)
        },
        queryPrecision: function (e, t, i) {
            var n = e.getShaderPrecisionFormat(t, i);
            return !!n && 0 !== n.precision
        },
        hasVAO: function () {
            return !!this._webGLExtensions.OES_vertex_array_object
        },
        getDisjointTimerQuery: function () {
            return this._webGLExtensions.EXT_disjoint_timer_query_webgl2 || this._webGLExtensions.EXT_disjoint_timer_query
        },
        initWebGLParameters: function (e) {
            if (e) {
                for (var t = ["MAX_COMBINED_TEXTURE_IMAGE_UNITS", "MAX_CUBE_MAP_TEXTURE_SIZE", "MAX_FRAGMENT_UNIFORM_VECTORS", "MAX_RENDERBUFFER_SIZE", "MAX_TEXTURE_IMAGE_UNITS", "MAX_TEXTURE_SIZE", "MAX_VARYING_VECTORS", "MAX_VERTEX_ATTRIBS", "MAX_VERTEX_TEXTURE_IMAGE_UNITS", "MAX_VERTEX_UNIFORM_VECTORS", "MAX_VIEWPORT_DIMS", "SHADING_LANGUAGE_VERSION", "VERSION", "VENDOR", "RENDERER", "ALIASED_LINE_WIDTH_RANGE", "ALIASED_POINT_SIZE_RANGE", "RED_BITS", "GREEN_BITS", "BLUE_BITS", "ALPHA_BITS", "DEPTH_BITS", "STENCIL_BITS"], i = this._webGLParameters, n = 0, r = t.length; n < r; ++n) {
                    var a = t[n];
                    i[a] = e.getParameter(e[a])
                }
                this.queryPrecision(e, e.FRAGMENT_SHADER, e.HIGH_FLOAT) ? i.MAX_SHADER_PRECISION_FLOAT = "high" : this.queryPrecision(e, e.FRAGMENT_SHADER, e.MEDIUM_FLOAT) ? i.MAX_SHADER_PRECISION_FLOAT = "medium" : this.queryPrecision(e, e.FRAGMENT_SHADER, e.LOW_FLOAT) && (i.MAX_SHADER_PRECISION_FLOAT = "low"), this.queryPrecision(e, e.FRAGMENT_SHADER, e.HIGH_INT) ? i.MAX_SHADER_PRECISION_INT = "high" : this.queryPrecision(e, e.FRAGMENT_SHADER, e.MEDIUM_INT) ? i.MAX_SHADER_PRECISION_INT = "medium" : this.queryPrecision(e, e.FRAGMENT_SHADER, e.LOW_INT) && (i.MAX_SHADER_PRECISION_INT = "low");
                var o = e.getExtension("WEBGL_debug_renderer_info");
                o && (i.UNMASKED_RENDERER_WEBGL = e.getParameter(o.UNMASKED_RENDERER_WEBGL), i.UNMASKED_VENDOR_WEBGL = e.getParameter(o.UNMASKED_VENDOR_WEBGL))
            }
        },
        applyExtension: function (e, t) {
            var i = e.getExtension(t),
                n = t.split("_")[0],
                r = "_" + n,
                a = new RegExp(n + "$"),
                o = new RegExp(r);
            for (var s in i) {
                if ("function" == typeof i[s]) {
                    var u = s.replace(a, "");
                    void 0 === e[u] && (e[u] = i[s].bind(i))
                } else {
                    var l = s.replace(o, "");
                    void 0 === e[l] && (e[l] = i[s])
                }
            }
        },
        getWebGLExtension: function (e) {
            return this._webGLExtensions[e]
        },
        getWebGLExtensions: function () {
            return this._webGLExtensions
        },
        _checkShader: function (e, t, i) {
            var n = t;
            "string" == typeof n && (n = e[t]);
            var r = e.createShader(n);
            return e.shaderSource(r, i), e.compileShader(r), !(!e.getShaderParameter(r, e.COMPILE_STATUS) && !e.isContextLost())
        },
        _doubleCheckExtension: function (e, t) {
            var i = ["#version 100", "#extension GL_%ext% : require", "precision mediump float;", "varying vec3 vColor;", "void main() {", "gl_FragColor = vec4(vColor, 1.0);", "}"].join("\n");
            return this._checkShader(e, "FRAGMENT_SHADER", i.replace(/\%ext\%/g, t))
        },
        initWebGLExtensions: function (e, t) {
            if (e) {
                var i = t;
                void 0 === i && (i = !0);
                if (!Object(s.a)().webglExt) return void(this._webGLExtensions = {});
                var r = e.getSupportedExtensions();
                if (r) {
                    for (var a = this._webGLExtensions, o = 0, u = r.length; o < u; ++o) {
                        var l = r[o];
                        i && this._bugsDB[l] || (a[l] = e.getExtension(l), this._isGL2 || this.applyExtension(e, l))
                    }
                    if (!this._isGL2) {
                        var c = "EXT_shader_texture_lod";
                        a[c] && !this._doubleCheckExtension(e, c) && delete a[c]
                    }
                    var h = this.getWebGLExtension("EXT_texture_filter_anisotropic");
                    h && (n.ANISOTROPIC_SUPPORT_EXT = !0, n.ANISOTROPIC_SUPPORT_MAX = e.getParameter(h.MAX_TEXTURE_MAX_ANISOTROPY_EXT))
                }
            }
        }
    }, t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(36),
        r = i(12),
        a = i(315),
        o = i(406),
        s = function (e, t) {
            o.a.call(this);
            var i = e;
            "string" == typeof e && (i = s[e]), this.type = i, this.setText(t)
        };
    s.VERTEX_SHADER = 35633, s.FRAGMENT_SHADER = 35632;
    s.VS_DBG = "#define _DEBUG 1\n#ifdef _DEBUG\nattribute vec3 Vertex;uniform mat4 uModelViewMatrix;uniform mat4 uProjectionMatrix;void main(void) {  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex, 1.0);}\n", s.FS_DBG = "#define _DEBUG 1\n#ifdef _DEBUG\n precision lowp float; void main(void) { gl_FragColor = vec4(1.0, 0.6, 0.6, 1.0);}\n", s._sDeletedGLShaderCache = new window.Map, s.deleteGLShader = function (e, t) {
        s._sDeletedGLShaderCache.has(e) || s._sDeletedGLShaderCache.set(e, []), s._sDeletedGLShaderCache.get(e).push(t)
    }, s.flushDeletedGLShaders = function (e, t) {
        if (t <= 0) return t;
        if (!s._sDeletedGLShaderCache.has(e)) return t;
        for (var i = 0, n = a.a.instance().tick(), r = s._sDeletedGLShaderCache.get(e), o = r.length, u = o - 1; u >= 0 && i < t; u--) e.deleteShader(r[u]), r.splice(u, 1), i = a.a.instance().deltaS(n, a.a.instance().tick());
        return t - i
    }, s.flushAllDeletedGLShaders = function (e) {
        if (s._sDeletedGLShaderCache.has(e))
            for (var t = s._sDeletedGLShaderCache.get(e), i = t.length, n = i - 1; n >= 0; n--) e.deleteShader(t[n]), t.splice(n, 1)
    }, s.onLostContext = function (e) {
        if (s._sDeletedGLShaderCache.has(e)) {
            s._sDeletedGLShaderCache.get(e).length = 0
        }
    }, r.a.createPrototypeObject(s, r.a.objectInherit(o.a.prototype, {
        setText: function (e) {
            this.text = e
        },
        getText: function () {
            return this.text
        },
        failSafe: function (e, t) {
            this.shader = e.createShader(this.type);
            var i = t.match(/#define[\s]+SHADER_NAME[\s]+([\S]+)(\n|$)/);
            i = i ? i[1] : "";
            var n = this.type === s.VERTEX_SHADER ? s.VS_DBG : s.FS_DBG;
            n += "\n#define SHADER_NAME FailSafe" + i + "\n#else\n" + t + "\n#endif\n", e.shaderSource(this.shader, n), e.compileShader(this.shader)
        },
        processErrors: function (e, t) {
            var i = /ERROR: [\d]+:([\d]+): (.+)/gim,
                r = t.split("\n"),
                a = r.length;
            if (0 !== a) {
                var o, s;
                if (null === i.exec(e) && (i = /Shader compilation errors\n\((\d+)\, \d+\): (.+)/gim), null === i.exec(e)) return void n.a.error(e);
                for (i.lastIndex = 0; null !== (s = i.exec(e));) {
                    s.index === i.lastIndex && i.lastIndex++;
                    var u = parseInt(s[1], 10);
                    if (!(u > a)) {
                        n.a.error("ERROR " + s[2] + " in line " + u);
                        var l = Math.max(0, u - 7),
                            c = Math.max(0, u - 2);
                        for (o = l; o <= c; o++) n.a.warn(r[o].replace(/^[ \t]+/g, ""));
                        for (c = Math.max(0, u - 1), n.a.error(r[c].replace(/^[ \t]+/g, "")), l = Math.min(a, u), c = Math.min(a, u + 5), o = l; o < c; o++) n.a.warn(r[o].replace(/^[ \t]+/g, ""))
                    }
                }
            }
        },
        compile: function (e) {
            this._gl || this.setGraphicContext(e), this.shader = e.createShader(this.type), e.shaderSource(this.shader, this.text), e.compileShader(this.shader)
        },
        getCompilationResult: function (e, t) {
            if (!e.getShaderParameter(this.shader, e.COMPILE_STATUS) && !e.isContextLost()) {
                var i = e.getShaderInfoLog(this.shader);
                this.processErrors(i, this.text);
                for (var r = this.text.split("\n"), a = "\n", o = 0, s = r.length; o < s; ++o) a += o + " " + r[o] + "\n";
                return n.a.errorFold("can't compile shader", a), t && t(this.text, a, i), !1
            }
            return !0
        },
        releaseGLObjects: function () {
            void 0 !== this._gl && (s.deleteGLShader(this._gl, this.shader), o.a.removeObject(this._gl, this)), this.invalidate()
        },
        invalidate: function () {
            this.shader = void 0
        }
    }), "osg", "Shader"), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(11),
        r = i(79),
        a = i(20),
        o = new n.a({
            hasTransparency: !1,
            hasScattering: !1,
            hasRefraction: !1,
            hasExtra: !1,
            protectDepthAndColorUnit: !1
        }),
        s = {
            modelkey: "hasTransparency",
            activeStateSets: {},
            count: 0
        },
        u = {
            modelkey: "hasScattering",
            activeStateSets: {},
            count: 0
        },
        l = {
            modelkey: "hasRefraction",
            activeStateSets: {},
            count: 0
        },
        c = function (e, t, i) {
            var n = t.getInstanceID();
            !!e.activeStateSets[n] !== i && (e.activeStateSets[n] = i, e.count += i ? 1 : -1, o.set(e.modelkey, e.count > 0))
        };
    o.registerStateSetIsTransparent = c.bind(c, s), o.registerStateSetIsScattering = c.bind(c, u), o.registerStateSetIsRefraction = c.bind(c, l);
    var h = !1,
        d = !1,
        f = !1,
        p = !1,
        m = !1,
        g = function () {
            o.set("hasExtra", p || h || d || f || m || Object(a.a)().debug3D || Object(r.a)() || !Object(a.a)().vrStereo)
        };
    o.setHotspot = function (e) {
        d = e, g()
    }, o.setWireframe = function (e) {
        h = e, g()
    }, o.setGizmo = function (e) {
        f = e, g()
    }, o.setDebugNormal = function (e) {
        p = e, g()
    }, o.setOutline = function (e) {
        m = e, g()
    }, g(), t.a = o
}, , , , , function (e, t, i) {
    "use strict";
    t.a = function (e, t, i) {
        if (!e) return "";
        var n;
        return n = e.images ? e.images : e, 0 === n.length ? "" : 1 === n.length ? n[0].url : n.reduce(function (e, n) {
            var r = Math.abs(t - e.width),
                a = Math.abs(i - e.height),
                o = r + a,
                s = Math.abs(t - n.width),
                u = Math.abs(i - n.height),
                l = s + u;
            return (e.width < t || e.height < i) && (o += t * i), (n.width < t || n.height < i) && (l += t * i), o < l ? e : n
        }).url
    }
}, , , , , , , , function (e, t, i) {
    "use strict";
    var n, r = i(0),
        a = (i.n(r), i(42));
    n = a.a.extend({}, {
        get: function (e) {
            e = Object(r.extend)({}, e);
            var t = this,
                i = new t;
            return !1 !== e.allowPrefetching ? (void 0 === this.singleton && (this.singleton = i), this.singleton.fetch(e), this.singleton) : i.fetch(e)
        }
    }), t.a = n
}, , , , , function (e, t, i) {
    "use strict";
    var n = i(419),
        r = i.n(n),
        a = i(431),
        o = i.n(a),
        s = i(427),
        u = i.n(s),
        l = i(432),
        c = i.n(l),
        h = i(433),
        d = i.n(h);
    Array.prototype.find || (Array.prototype.find = function (e) {
        for (var t = 0, i = this.length; t < i; ++t)
            if (e(this[t])) return this[t]
    }), Array.prototype.includes || Object.defineProperty(Array.prototype, "includes", {
        value: function (e, t) {
            if (null == this) throw new TypeError('"this" is null or not defined');
            var i = Object(this),
                n = i.length >>> 0;
            if (0 === n) return !1;
            for (var r = 0 | t, a = Math.max(r >= 0 ? r : n - Math.abs(r), 0); a < n;) {
                if (function (e, t) {
                        return e === t || "number" == typeof e && "number" == typeof t && isNaN(e) && isNaN(t)
                    }(i[a], e)) return !0;
                a++
            }
            return !1
        }
    }), d.a || (Number.isNaN = function (e) {
        return e !== e
    }), c.a || (Number.isInteger = function (e) {
        return "number" == typeof e && isFinite(e) && Math.floor(e) === e
    }), u.a || (Math.sign = function (e) {
        return (e > 0) - (e < 0) || +e
    }), o.a || (Math.log2 = function (e) {
        return Math.log(e) * Math.LOG2E
    }), r.a || (Math.log10 = function (e) {
        return Math.log(e) * Math.LOG10E
    }), String.prototype.endsWith || (String.prototype.endsWith = function (e, t) {
        return (void 0 === t || t >= this.length) && (t = this.length), this.substr(t - e.length, e.length) === e
    }), String.prototype.startsWith || (String.prototype.startsWith = function (e, t) {
        return this.substr(t || 0, e.length) === e
    });
    var f = window.Image;
    delete window.Image, window.Image || (window.Image = f)
}, function (e, t, i) {
    "use strict";
    var n = i(3),
        r = i.n(n),
        a = i(5),
        o = i.n(a),
        s = i(53),
        u = {
            "http:": "80",
            "https:": "443"
        };
    t.a = function () {
        var e = r.a.ajax;
        r.a.ajax = function () {
            var t = this,
                i = arguments,
                n = arguments.length >= 2 ? arguments[1] : arguments[0];
            return "GET" === n.type.toUpperCase() || "HEAD" === n.type.toUpperCase() || s.a.get("sb_csrftoken") ? e.apply(this, arguments) : new o.a(function (n, r) {
                var a = new XMLHttpRequest;
                a.open("GET", "/i/csrf"), a.addEventListener("load", function () {
                    n(e.apply(t, i))
                }), a.addEventListener("error", function (e) {
                    r(e)
                }), a.send()
            })
        }, r()(document).ajaxSend(function (e, t, i) {
            var n = window.location,
                r = document.createElement("a");
            r.href = i.url, r.href = r.href;
            var a = r.port;
            a = "0" !== a ? a : u[r.protocol], a = a !== u[r.protocol] ? a : "", r.protocol !== n.protocol || r.hostname !== n.hostname || a !== n.port || t.setRequestHeader("X-CsrfToken", s.a.get("sb_csrftoken"))
        })
    }
}, , function (e, t, i) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: !0
    });
    var n = !1,
        r = function (e) {
            return void 0 !== e && (n = e), n
        };
    t.default = r
}, , , , , , , , , , , , , , , , , , , function (e, t) {
    var i = {};
    i.EPSILON = 1e-6, i.ARRAY_TYPE = "undefined" != typeof Float32Array ? Float32Array : Array, i.RANDOM = Math.random, i.ENABLE_SIMD = !1, i.SIMD_AVAILABLE = i.ARRAY_TYPE === Float32Array && "SIMD" in this, i.USE_SIMD = i.ENABLE_SIMD && i.SIMD_AVAILABLE, i.setMatrixArrayType = function (e) {
        i.ARRAY_TYPE = e
    };
    var n = Math.PI / 180;
    i.toRadian = function (e) {
        return e * n
    }, i.equals = function (e, t) {
        return Math.abs(e - t) <= i.EPSILON * Math.max(1, Math.abs(e), Math.abs(t))
    }, e.exports = i
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(92),
        a = function (e, t, i, n) {
            r.a.call(this), this._sourceFactor = a.DISABLE, this._destinationFactor = a.DISABLE, this._sourceFactorAlpha = this._sourceFactor, this._destinationFactorAlpha = this._destinationFactor, this._separate = !1, void 0 !== e && this.setSource(e), void 0 !== t && this.setDestination(t), void 0 !== i && this.setSourceAlpha(i), void 0 !== n && this.setDestinationAlpha(n)
        };
    a.DISABLE = -1, a.ZERO = 0, a.ONE = 1, a.SRC_COLOR = 768, a.ONE_MINUS_SRC_COLOR = 769, a.SRC_ALPHA = 770, a.ONE_MINUS_SRC_ALPHA = 771, a.DST_ALPHA = 772, a.ONE_MINUS_DST_ALPHA = 773, a.DST_COLOR = 774, a.ONE_MINUS_DST_COLOR = 775, a.SRC_ALPHA_SATURATE = 776, a.BLEND_DST_RGB = 32968, a.BLEND_SRC_RGB = 32969, a.BLEND_DST_ALPHA = 32970, a.BLEND_SRC_ALPHA = 32971, a.CONSTANT_COLOR = 32769, a.ONE_MINUS_CONSTANT_COLOR = 32770, a.CONSTANT_ALPHA = 32771, a.ONE_MINUS_CONSTANT_ALPHA = 32772, a.BLEND_COLOR = 32773, n.a.createPrototypeStateAttribute(a, n.a.objectInherit(r.a.prototype, {
        attributeType: "BlendFunc",
        cloneType: function () {
            return new a
        },
        setSource: function (e) {
            this.setSourceRGB(e), this.setSourceAlpha(e)
        },
        getSource: function () {
            return this._sourceFactor
        },
        setDestination: function (e) {
            this.setDestinationRGB(e), this.setDestinationAlpha(e)
        },
        getDestination: function () {
            return this._destinationFactor
        },
        getSeparate: function () {
            return this._separate
        },
        checkSeparate: function () {
            return this._sourceFactor !== this._sourceFactorAlpha || this._destinationFactor !== this._destinationFactorAlpha
        },
        setSourceRGB: function (e) {
            this._sourceFactor = "string" == typeof e ? a[e] : e, this._separate = this.checkSeparate()
        },
        getSourceRGB: function () {
            return this._sourceFactor
        },
        setSourceAlpha: function (e) {
            this._sourceFactorAlpha = "string" == typeof e ? a[e] : e, this._separate = this.checkSeparate()
        },
        getSourceAlpha: function () {
            return this._sourceFactorAlpha
        },
        setDestinationRGB: function (e) {
            this._destinationFactor = "string" == typeof e ? a[e] : e, this._separate = this.checkSeparate()
        },
        getDestinationRGB: function () {
            return this._destinationFactor
        },
        setDestinationAlpha: function (e) {
            this._destinationFactorAlpha = "string" == typeof e ? a[e] : e, this._separate = this.checkSeparate()
        },
        getDestinationAlpha: function () {
            return this._destinationFactorAlpha
        },
        apply: function (e) {
            e.applyBlendFunc(this)
        }
    }), "osg", "BlendFunc"), t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(36),
        r = i(12),
        a = i(406),
        o = i(92),
        s = i(315),
        u = i(319),
        l = function () {
            a.a.call(this), o.a.call(this), this._fbo = void 0, this._rbo = void 0, this._attachments = [], this._buffers = [], this._dirty = !0, this._hasMRT = u.a.instance().getWebGLExtension("WEBGL_draw_buffers")
        };
    l.COLOR_ATTACHMENT0 = 36064, l.DEPTH_ATTACHMENT = 36096, l.DEPTH_COMPONENT16 = 33189, l._sDeletedGLFrameBufferCache = new window.Map, l.deleteGLFrameBuffer = function (e, t) {
        l._sDeletedGLFrameBufferCache.has(e) || l._sDeletedGLFrameBufferCache.set(e, []), l._sDeletedGLFrameBufferCache.get(e).push(t)
    }, l.flushDeletedGLFrameBuffers = function (e, t) {
        if (t <= 0) return t;
        if (!l._sDeletedGLFrameBufferCache.has(e)) return t;
        var i = l._sDeletedGLFrameBufferCache.get(e);
        if (0 === i.length) return t;
        for (var n = 0, r = s.a.instance().tick(), a = i.length, o = a - 1; o >= 0 && n < t; o--) e.deleteFramebuffer(i[o]), i.splice(o, 1), n = s.a.instance().deltaS(r, s.a.instance().tick());
        return t - n
    }, l.flushAllDeletedGLFrameBuffers = function (e) {
        if (l._sDeletedGLFrameBufferCache.has(e)) {
            var t = l._sDeletedGLFrameBufferCache.get(e);
            if (0 !== t.length)
                for (var i = t.length, n = i - 1; n >= 0; n--) e.deleteFramebuffer(t[n]), t.splice(n, 1)
        }
    }, l._sDeletedGLRenderBufferCache = new window.Map, l.deleteGLRenderBuffer = function (e, t) {
        l._sDeletedGLRenderBufferCache.has(e) || l._sDeletedGLRenderBufferCache.set(e, []), l._sDeletedGLRenderBufferCache.get(e).push(t)
    }, l.flushDeletedGLRenderBuffers = function (e, t) {
        if (t <= 0) return t;
        if (!l._sDeletedGLRenderBufferCache.has(e)) return t;
        for (var i = 0, n = s.a.instance().tick(), r = l._sDeletedGLRenderBufferCache.get(e), a = r.length, o = a - 1; o >= 0 && i < t; o--) e.deleteRenderbuffer(r[o]), r.splice(o, 1), i = s.a.instance().deltaS(n, s.a.instance().tick());
        return t - i
    }, l.flushAllDeletedGLRenderBuffers = function (e) {
        if (l._sDeletedGLRenderBufferCache.has(e))
            for (var t = l._sDeletedGLRenderBufferCache.get(e), i = t.length, n = i - 1; n >= 0; n--) e.deleteRenderbuffer(t[n]), t.splice(n, 1)
    }, l.onLostContext = function (e) {
        if (l._sDeletedGLFrameBufferCache.has(e)) {
            var t = l._sDeletedGLFrameBufferCache.get(e);
            t.length = 0, l._sDeletedGLRenderBufferCache.has(e) && (t = l._sDeletedGLRenderBufferCache.get(e), t.length = 0)
        }
    }, r.a.createPrototypeStateAttribute(l, r.a.objectInherit(a.a.prototype, r.a.objectInherit(o.a.prototype, {
        attributeType: "FrameBufferObject",
        cloneType: function () {
            return new l
        },
        invalidate: function () {
            if (this._rbo && this._attachments) {
                for (var e = 0, t = this._attachments.length; e < t; ++e) {
                    var i = this._attachments[e];
                    i.texture || (i.renderBufferObject = void 0)
                }
                this._rbo = void 0
            }
            this._fbo = void 0, this._buffers.length = 0, this._dirty = !0
        },
        dirty: function () {
            this._buffers.length = 0, this._dirty = !0
        },
        isDirty: function () {
            return this._dirty
        },
        setAttachment: function (e) {
            this._attachments.push(e)
        },
        getAttachment: function (e) {
            if (this._attachments)
                for (var t = 0, i = this._attachments.length; t < i; ++t) {
                    var n = this._attachments[t];
                    if (n.attachment === e) return n
                }
        },
        releaseGLObjects: function () {
            void 0 !== this._fbo && void 0 !== this._gl && l.deleteGLFrameBuffer(this._gl, this._fbo), this._fbo = void 0, void 0 !== this._rbo && void 0 !== this._gl && l.deleteGLRenderBuffer(this._gl, this._rbo), this.invalidate()
        },
        _reportFrameBufferError: function (e) {
            switch (e) {
                case 36054:
                    n.a.debug("FRAMEBUFFER_INCOMPLETE_ATTACHMENT");
                    break;
                case 36055:
                    n.a.debug("FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");
                    break;
                case 36057:
                    n.a.debug("FRAMEBUFFER_INCOMPLETE_DIMENSIONS");
                    break;
                case 36061:
                    n.a.debug("FRAMEBUFFER_UNSUPPORTED");
                    break;
                default:
                    n.a.debug("FRAMEBUFFER unknown error " + e.toString(16))
            }
        },
        reset: function () {
            this.releaseGLObjects(), this._attachments = []
        },
        getFrameBufferObject: function () {
            return this._fbo
        },
        getRenderBufferObject: function () {
            return this._rbo
        },
        createFrameBufferObject: function (e) {
            this.setGraphicContext(e.getGraphicContext()), this._fbo = this._gl.createFramebuffer()
        },
        createRenderBuffer: function (e, t, i) {
            var n = this._gl,
                r = n.createRenderbuffer();
            return n.bindRenderbuffer(n.RENDERBUFFER, r), n.renderbufferStorage(n.RENDERBUFFER, e, t, i), r
        },
        framebufferRenderBuffer: function (e, t) {
            var i = this._gl;
            i.bindRenderbuffer(i.RENDERBUFFER, t), i.framebufferRenderbuffer(i.FRAMEBUFFER, e, i.RENDERBUFFER, t)
        },
        framebufferTexture2D: function (e, t, i, n) {
            var r = this._gl;
            if (e.applyTextureAttribute(1, n), n.isDirty() || !n.getTextureObject()) return !1;
            var a = r.DRAW_FRAMEBUFFER || r.FRAMEBUFFER;
            return r.framebufferTexture2D(a, t, i, n.getTextureObject().id(), 0), !0
        },
        bindFrameBufferObject: function () {
            var e = this._gl;
            e.bindFramebuffer(e.FRAMEBUFFER, this._fbo)
        },
        checkStatus: function () {
            var e = this._gl,
                t = e.checkFramebufferStatus(e.FRAMEBUFFER);
            t !== e.FRAMEBUFFER_COMPLETE && this._reportFrameBufferError(t)
        },
        _checkAllowedSize: function (e, t) {
            var i = u.a.instance().getWebGLParameter("MAX_RENDERBUFFER_SIZE");
            return !(0 === e || 0 === t || t > i || e > i) || (n.a.error("width (" + e + ") or height (" + e + ') makes frame buffer not bindable. Max RenderBuffer is "' + i + '"'), !1)
        },
        apply: function (e) {
            this._gl || this.setGraphicContext(e.getGraphicContext());
            var t = this._gl,
                i = this._attachments,
                r = i.length;
            if (0 === r && !this._fbo) return void t.bindFramebuffer(t.FRAMEBUFFER, null);
            var a = 0;
            if (!this.isDirty()) {
                for (a = 0; a < r; ++a) {
                    var o = i[a].texture;
                    o && o.isDirty() && e.applyTextureAttribute(1, o)
                }
                return t.bindFramebuffer(t.FRAMEBUFFER, this._fbo), void(!0 === n.a.reportWebGLError && this.checkStatus())
            }
            this._fbo || this.createFrameBufferObject(e), this.bindFrameBufferObject();
            var s = this._hasMRT ? this._buffers : void 0,
                u = !1;
            for (a = 0; a < r; ++a) {
                var l = i[a];
                if (l.texture) {
                    var c = l.texture;
                    if (!this._checkAllowedSize(c.getWidth(), c.getHeight())) return void this.releaseGLObjects();
                    if (this._hasMRT && l.attachment >= t.COLOR_ATTACHMENT0 && l.attachment <= t.COLOR_ATTACHMENT15 && -1 === s.indexOf(l.attachment) && s.push(l.attachment), !this.framebufferTexture2D(e, l.attachment, l.textureTarget, c)) return void this.releaseGLObjects()
                } else {
                    if (!this._checkAllowedSize(l.width, l.height)) return void this.releaseGLObjects();
                    l.renderBufferObject ? this._rbo = l.renderBufferObject : (this._rbo = this.createRenderBuffer(l.format, l.width, l.height), l.renderBufferObject = this._rbo), this.framebufferRenderBuffer(l.attachment, this._rbo), u = !0
                }
            }
            s && s.length > 0 && t.drawBuffers(s), this.checkStatus(), u && t.bindRenderbuffer(t.RENDERBUFFER, null), this._dirty = !1
        }
    })), "osg", "FrameBufferObject"), t.a = l
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(680),
        a = i(36),
        o = i(10),
        s = i(160),
        u = i(288),
        l = i(854),
        c = i(92),
        h = i(317),
        d = function () {
            s.a.call(this), this._shape = null, this._targets = [], this._stateSetAnimation = new u.a, this._targetWeights = new Float32Array(d.MAX_MORPH_GPU), this._morphAttribute = void 0, this._morphTargetNames = void 0, this._maxMorphGPU = d.MAX_MORPH_GPU, this._isInitialized = !1
        };
    d.MAX_MORPH_GPU = 4, n.a.createPrototypeNode(d, n.a.objectInherit(s.a.prototype, {
        init: function () {
            return this._morphAttribute ? (this._isInitialized = !0, !1) : (this._morphAttribute = new l.a(Math.min(this._maxMorphGPU, this.getMorphTargets().length)), this.getStateSetAnimation().setAttributeAndModes(this._morphAttribute, c.a.ON), this._morphAttribute.setTargetWeights(this.getTargetsWeight()), this._targets[0] ? (this._morphTargetNames = window.Object.keys(this._targets[0].getVertexAttributeList()), this._morphAttribute.copyTargetNames(this._morphTargetNames)) : (this._morphTargetNames = [], a.a.error("No Targets in the MorphGeometry !")), this._isInitialized = !0, !0)
        },
        getMaximumPossibleMorphGPU: function () {
            return this._maxMorphGPU
        },
        setMaximumPossibleMorphGPU: function (e) {
            this._maxMorphGPU = e, this._isInitialized = !1, this._morphAttribute && this._morphAttribute.setNumTargets(e)
        },
        getMorphTargetNames: function () {
            return this._morphTargetNames
        },
        getStateSetAnimation: function () {
            return this._stateSetAnimation
        },
        getMorphTargets: function () {
            return this._targets
        },
        isInitialized: function () {
            return this._isInitialized
        },
        getTargetsWeight: function () {
            return this._targetWeights
        },
        computeBoundingBox: function () {
            var e = new h.a;
            return function (t) {
                s.a.prototype.computeBoundingBox.call(this, t);
                for (var i = 0, n = this._targets.length; i < n; i++) t.expandByBoundingBox(this._targets[i].computeBoundingBox(e));
                return t
            }
        }(),
        mergeChildrenVertexAttributeList: function () {
            for (var e = 0, t = this._targets.length; e < t; e++) {
                var i = this._targets[e],
                    n = i.getVertexAttributeList();
                for (var a in n) {
                    var o = n[a];
                    o && !o.getBufferArray && (n[a] = new r.a(o))
                }
                s.a.appendVertexAttributeToList(i.getVertexAttributeList(), this.getVertexAttributeList(), e)
            }
        },
        _computeEffectiveSumWeights: function () {
            for (var e = 0, t = this._targetWeights, i = 0, n = t.length; i < n; ++i) {
                var r = t[i];
                Math.abs(r) <= d.EFFECTIVE_EPS || (e += r)
            }
            return Math.abs(e) > 1e-5 ? e : e < 0 ? -1e-5 : 1e-5
        },
        computeTransformedVertex: function (e, t) {
            t = t || o.f.create();
            var i = 3 * e,
                n = this._targetWeights,
                r = this.getVertexAttributeList(),
                a = r.Vertex.getElements(),
                s = 1 - this._computeEffectiveSumWeights();
            t[0] = s * a[i], t[1] = s * a[i + 1], t[2] = s * a[i + 2];
            for (var u = 0, l = n.length; u < l; ++u) {
                var c = n[u];
                if (!(Math.abs(c) <= d.EFFECTIVE_EPS)) {
                    var h = r["Vertex_" + u].getElements();
                    t[0] += c * h[i], t[1] += c * h[i + 1], t[2] += c * h[i + 2]
                }
            }
            return t
        },
        computeTransformedVertices: function () {
            for (var e = this._targetWeights, t = this.getVertexAttributeList(), i = t.Vertex.getElements(), n = i.length, r = this._morphedVerts = this._morphedVerts || new Float32Array(n), a = 1 - this._computeEffectiveSumWeights(), o = 0; o < n; ++o) r[o] = a * i[o];
            for (var s = 0, u = e.length; s < u; ++s) {
                var l = e[s];
                if (!(Math.abs(l) <= d.EFFECTIVE_EPS))
                    for (var c = t["Vertex_" + s].getElements(), h = 0; h < n; ++h) r[h] += l * c[h]
            }
            return r
        }
    }), "osgAnimation", "MorphGeometry"), t.a = d
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(92),
        a = function (e, t, i, n) {
            r.a.call(this), this._func = a.LESS, this._near = 0, this._far = 1, this._writeMask = !0, void 0 !== e && (this._func = "string" == typeof e ? a[e] : e), void 0 !== t && (this._near = t), void 0 !== i && (this._far = i), void 0 !== n && (this._writeMask = n)
        };
    a.DISABLE = 0, a.NEVER = 512, a.LESS = 513, a.EQUAL = 514, a.LEQUAL = 515, a.GREATER = 516, a.NOTEQUAL = 517, a.GEQUAL = 518, a.ALWAYS = 519, n.a.createPrototypeStateAttribute(a, n.a.objectInherit(r.a.prototype, {
        attributeType: "Depth",
        cloneType: function () {
            return new a
        },
        setRange: function (e, t) {
            this._near = e, this._far = t
        },
        setWriteMask: function (e) {
            this._writeMask = e
        },
        getWriteMask: function () {
            return this._writeMask
        },
        getFunc: function () {
            return this._func
        },
        apply: function (e) {
            e.applyDepth(this)
        }
    }), "osg", "Depth"), t.a = a
}, function (e, t, i) {
    "use strict";
    var n = function (e) {
        this._manipulator = e, this._enable = !0
    };
    n.prototype = {
        isEnabled: function () {
            return this._enable
        },
        setEnable: function (e) {
            this._enable = e
        }
    }, t.a = n
}, function (e, t) {
    e.exports = {
        skfbWhite: "#ffffff",
        skfbRed: "#cc211f",
        skfbBrightRed: "#f02624",
        skfbLightBlue: "#49cdf8",
        skfbBlue: "#1caad9",
        skfbDarkBlue: "#1c88bb",
        skfbLightYellow: "#ffe9b4",
        skfbYellow: "#fed600",
        skfbOrange: "#ff9e3a",
        skfbGreen: "#35cba7",
        skfbBrightGreen: "#1ac95d",
        skfbPurple: "#df1660",
        skfbBlack: "#222222",
        skfbGrey0: "#555555",
        skfbGrey1: "#888888",
        skfbGrey2: "#999999",
        skfbGrey3: "#cccccc",
        skfbGrey4: "#dddddd",
        skfbGrey5: "#e7e7e7",
        skfbGrey6: "#f2f2f2",
        skfbDarkAlpha: "rgba(0, 0, 0, 0.2)",
        skfbEditorGrey0: "#000000",
        skfbEditorGrey1: "#1a1a1a",
        skfbEditorGrey2: "#333333",
        skfbEditorGrey3: "#595959",
        skfbEditorGrey4: "#666666",
        skfbEditorGrey5: "#777777",
        skfbEditorGrey6: "#888888",
        skfbEditorGrey7: "#cccccc",
        containerInfoBg: "#ddf6fa",
        containerInfoBorder: "#8bdded",
        containerWarningBg: "#ffe9b4",
        containerWarningBorder: "#fed600",
        containerDangerBg: "#f6d3d6",
        containerDangerBorder: "#e07881",
        colorPositive: "#1ac95d",
        colorError: "#db6f6f",
        colorRestricted: "#cc211f",
        colorDanger: "#cc211f",
        colorWarning: "#fed600",
        colorStaff: "#ff9e3a",
        colorMaster: "#35cba7",
        websiteBackgroundColor: "#f2f2f2",
        websiteTopBackgroundColor: "white",
        websiteTopTextColor: "#222222",
        websiteTopHoverColor: "#1caad9",
        websiteTopSearchColor: "#999999",
        websiteTopSearchActiveColor: "black",
        websiteOddTextColor: "#555555",
        websiteOddLinkColor: "#1caad9",
        websiteOddHoverLinkColor: "#1c88bb",
        websiteEvenTextColor: "#eeeeee",
        websiteEvenLinkColor: "white",
        websiteEvenHoverLinkColor: "#f2f2f2",
        websiteSidebarIconColor: "#999999",
        editorColor: "#333333",
        editorImportantColor: "#0d0d0d",
        editorKeyColor: "#1a1a1a",
        editorMinorColor: "#4d4d4d",
        editorTrivialColor: "#595959",
        editorTextColor: "#cccccc",
        editorStrongColor: "white",
        editorBorderColor: "black",
        editorActiveColor: "#1caad9",
        editorScrollbarTrackColor: "#a3a3a3",
        editorScrollbarThumbColor: "#444444",
        viewerRadialBackgroundFrom: "#f2f2f2",
        viewerRadialBackgroundTo: "#b3b3b3",
        viewerPrimaryLoadingColor: "#1caad9",
        viewerSecondaryLoadingColor: "#1caad9",
        viewerBackgroundColor: "black",
        brandColor: "#1caad9",
        facebookColor: "#3a589a",
        twitterColor: "#00c4fc",
        googleplusColor: "#de4830",
        pinterestColor: "#ce1d21",
        linkedinColor: "#1884bc",
        instagramColor: "#125688",
        tumblrColor: "#36465d",
        redditColor: "#ff5700",
        mailColor: "#555555",
        websiteSuccessColor: "#00a317",
        storeColor: "#df1660",
        storeHoverColor: "#c81859",
        storeGradient: "linear-gradient(45deg, #a60b43 0%, #f42671 100%)",
        websiteStoreCheckoutGradient: "linear-gradient(45deg, #1caad9, #49cdf8)",
        labelColor: "#888888",
        dropdownArrowColor: "#b8b8b8",
        dropdownArrowColorHighlight: "#222222",
        linkColor: "#1caad9",
        linkHoverColor: "#1c88bb",
        privateLimitInfoBg: "#ffe9b4",
        privateLimitInfoBorder: "#fed600",
        privateLimitReachedBg: "#f6d3d6",
        privateLimitReachedBorder: "#e07881",
        colorProUser: "#00aad8",
        colorPremUser: "#007395",
        colorBizUser: "#003748",
        colorEntUser: "#222222",
        userFlagPro: "#00aad8",
        userFlagPrem: "#007395",
        userFlagBiz: "#003748",
        userFlagEnt: "#222222",
        userFlagStaff: "#ff9e3a",
        userFlagMaster: "#35cba7"
    }
}, function (e, t) {
    e.exports = {
        websiteTopHeight: "60px",
        websiteBigTopHeight: "86px",
        websiteBannerHeight: "50px",
        websiteResponsiveTopHeight: "40px",
        websiteResponsiveNavigationWidth: "250px",
        editorHeaderHeight: "55px",
        editorPanelWidth: "320px",
        editorScrollbarWidth: "10px",
        editorGroupWidgetHeaderHeight: "30px",
        editorGroupWidgetSwitchWidth: "50px",
        editorGroupWidgetSwitchHeight: "24px",
        editorGroupWidgetSwitchMargin: "2px",
        editorGroupWidgetSwitchCursorWidth: "12px",
        editorNestedGroupWidgetSwitchMargin: "3px",
        editorImageWidgetWidth: "30px",
        editorImageWidgetHeight: "30px",
        viewerControlSize: "30px",
        websiteMaxWidth: "2000px",
        responsiveBreakpointXXLarge: "1910px",
        responsiveBreakpointXLarge: "1400px",
        responsiveBreakpointLarge: "1280px",
        responsiveBreakpointMedium: "1100px",
        responsiveBreakpointSmall: "950px",
        responsiveBreakpointXSmall: "800px",
        responsiveBreakpointXXSmall: "480px",
        responsiveGridOneColumn: "700px",
        responsiveGridTwoColumn: "1015px",
        responsiveGridThreeColumn: "1910px"
    }
}, , , , function (e, t, i) {
    "use strict";
    var n = i(24),
        r = i.n(n),
        a = i(158);
    t.a = Object(a.a)(["initialize", "remove", "delegateEvents", "undelegateEvents", "setElement", "render", "viewDidMount", "viewDidUpdate", "viewWillUnmount"])(r.a.View)
}, function (e, t, i) {
    "use strict";

    function n(e, t) {
        var i = e.__withChildren.childrenConfigs[t];
        return !i.shouldCreateChild || i.shouldCreateChild.call(e)
    }

    function r(e, t) {
        var i = e.__withChildren.childrenConfigs[t];
        return "function" == typeof i.selector ? i.selector.call(e) : i.selector
    }

    function a(e, t) {
        var i = e.__withChildren.childrenConfigs[t];
        return "function" == typeof i.options ? i.options.call(e) : i.options
    }

    function o(e, t) {
        var i = e.__withChildren.childrenConfigs[t];
        return i.viewClass.isView ? i.viewClass : i.viewClass.call(e)
    }
    var s = i(26),
        u = i.n(s),
        l = i(0),
        c = (i.n(l), i(1), {
            options: function () {
                return {}
            }
        });
    t.a = {
        name: "WithChildren",
        dependencies: ["WithOptionTypes"],
        children: {},
        constructor: function () {
            this.__withChildren = {
                childrenConfigs: {}
            }, u()(this.children).forEach(function (e) {
                this.updateChildConfig(e, this.children[e])
            }.bind(this)), this.children = {}
        },
        setElement: function () {
            return this.setChildrenElements(), this
        },
        beforeRemove: function () {
            this.removeChildren()
        },
        createChild: function (e) {
            var t = r(this, e),
                i = a(this, e),
                n = o(this, e),
                s = new n(Object(l.extend)({}, i, t ? {
                    el: this.$(t)
                } : {}));
            return this.children[e] = s, this
        },
        removeChild: function (e) {
            return this.hasChild(e) && this.getChild(e).remove(), delete this.children[e], this
        },
        removeChildren: function () {
            return u()(this.__withChildren.childrenConfigs).forEach(this.removeChild.bind(this)), this
        },
        refreshChild: function (e) {
            var t = n(this, e),
                i = this.hasChild(e);
            return t ? i ? this.refreshChildViewClass(e).setChildElement(e) : this.createChild(e) : this.removeChild(e), this
        },
        refreshChildren: function () {
            u()(this.__withChildren.childrenConfigs).forEach(this.refreshChild.bind(this))
        },
        initializeChild: function (e) {
            this.refreshChild(e)
        },
        initializeChildren: function () {
            this.refreshChildren()
        },
        setChildElement: function (e) {
            var t = r(this, e);
            return t && this.getChild(e).setElement(this.$(t)), this
        },
        setChildrenElements: function () {
            return u()(this.__withChildren.childrenConfigs).filter(this.hasChild.bind(this)).forEach(this.setChildElement.bind(this)), this
        },
        setChildOptions: function (e) {
            return this.getChild(e).setOptions(a(this, e)), this
        },
        setChildrenOptions: function () {
            return u()(this.__withChildren.childrenConfigs).filter(this.hasChild.bind(this)).forEach(this.setChildOptions.bind(this)), this
        },
        refreshChildViewClass: function (e) {
            var t = o(this, e);
            return this.getChild(e) instanceof t || (this.removeChild(e), this.createChild(e)), this
        },
        renderChild: function (e) {
            if (this.refreshChild(e), this.hasChild(e)) {
                var t = this.getChild(e);
                t.isMounted ? this.setChildOptions(e) : t.render()
            }
        },
        renderChildren: function () {
            u()(this.__withChildren.childrenConfigs).forEach(this.renderChild.bind(this))
        },
        getChildrenConfigs: function () {
            return this.__withChildren.childrenConfigs
        },
        updateChildConfig: function (e, t) {
            var i = Object(l.extend)({}, c, t);
            return this.__withChildren.childrenConfigs[e] = i, this
        },
        getChild: function (e) {
            return this.children[e]
        },
        hasChild: function (e) {
            return !!this.children[e]
        }
    }
}, function (e, t, i) {
    "use strict";
    var n = i(79),
        r = i(147),
        a = "";
    Object(r.a)() || Object(n.a)() || (a += "?optimized=1");
    var o = function (e, t, i) {
        var n = "/i/models/" + t;
        if (e && (n += "/" + e + a), i && !window.prefetchedData[n]) throw console.error("Missing prefetch " + n), new Error("Missing prefetch " + n);
        return n
    };
    t.a = o
}, , , function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(28));
    window.webpackPublicPath = Object(r.k)("webpack-public-path");
    var a = Object(r.k)("sketchfab-runtime", "json");
    i.p = window.webpackPublicPath;
    var o = {
        __webpack_public_path__: window.webpackPublicPath,
        isFeatureEnabled: function (e) {
            var t = this.features[e];
            return t && void 0 !== t.enabled ? t.enabled : !t || void 0 === t.flag || t.flag > 0
        }
    };
    Object(n.extend)(o, a), t.a = o
}, , , , , , , , , , , , , , , , function (e, t, i) {
    "use strict";
    e.exports = {
        buildMode: "dist",
        modelFiletypes: ["wrl", "obj", "ive", "3ds", "dae", "ply", "osg2", "osgt", "osgb", "osgx", "osgs", "gem", "geo", "mdl", "rgb", "lws", "dxf", "tgz", "osgterrain", "shp", "zae", "stl", "sta", "bvh", "ac", "flt", "ogr", "osga", "md2", "x", "txp", "dw", "osgtgz", "3dc", "asc", "lw", "lwo", "gdal", "bsp", "osg", "iv", "blend", "blend1", "fbx", "dat", "mc2obj", "dwf", "vpk", "zip", "7z", "rar", "gz", "kmz", "craft", "wrz", "mu", "q3d", "gltf", "glb", "iges", "igs", "abc", "las"],
        environmentFiletypes: ["hdr", "exr"],
        exportersFiletypes: {
            s3d: "strata",
            ztl: "zbrush",
            blend: "blender",
            prefab: "unity",
            ghx: "grasshopper",
            lxo: "modo",
            lws: "lightwave",
            c4d: "cinema4d",
            skp: "sketchup",
            psd: "photoshop",
            qef: "qubicle",
            ic3d: "ironcad",
            qmo: "qubicle",
            spp: "substance",
            max: "3dsmax",
            ma: "maya",
            sbs: "substance",
            craft: "kerbalspaceprogram",
            fmz: "formz",
            sldprt: "solidworks",
            "3dslash": "3dslash",
            unity: "unity",
            qb: "qubicle",
            mat: "unity",
            ipt: "inventor",
            gh: "grasshopper",
            mb: "maya"
        },
        textureFileTypes: ["jpg", "jpeg", "png", "tga"],
        avatarFiletypes: ["jpg", "jpeg", "png"],
        backgroundFiletypes: ["jpg", "jpeg", "png"],
        matcapFiletypes: ["jpg", "jpeg", "png", "tga"],
        additionalUploadableFileTypes: ["mtl", "psd", "bin"],
        soundFiletypes: ["mp3"],
        maxBackgroundFilesize: 4194304,
        maxMatcapFilesize: 4194304,
        maxEnvironmentFilesize: 52428800,
        maxAvatarFilesizes: {
            ent: 1048576,
            biz: 1048576,
            basic: 1048576,
            prem: 1048576,
            pro: 1048576
        },
        maxModelFilesizes: {
            ent: 524288e3,
            biz: 524288e3,
            basic: 52428800,
            prem: 524288e3,
            pro: 209715200
        },
        maxHotspotsPerModel: {
            ent: 100,
            biz: 75,
            basic: 5,
            prem: 50,
            pro: 20
        },
        maxSoundFilesize: 5242880,
        maxSoundtracksPerModel: {
            ent: 15,
            biz: 15,
            basic: 1,
            prem: 10,
            pro: 5
        },
        plansPrivateModelLimit: {
            ent: "Custom",
            biz: 500,
            basic: 0,
            prem: 200,
            pro: 20
        },
        textureMaxFileSize: 78643200,
        cameraConstraintsEditing: {
            ent: 1,
            biz: 1,
            basic: 0,
            prem: 1,
            pro: 1
        },
        analyticsReferrerOverrides: ["facebook.com/.*?/?dialog/oauth.*?", "facebook.com/login$", "facebook.com/l.php$"],
        oauthRedirectUris: {},
        usernameMaxLength: 30,
        usernameValidatorRegex: "^[a-zA-Z0-9._-]{2,30}$",
        usernameValidatorTitle: "Letters, numbers, -, _ and . only",
        userUsageTypeChoices: {
            visitor: "visitor",
            uploader: "uploader",
            buyer: "buyer"
        },
        proPlanTypes: ["pro", "prem", "biz", "ent"],
        planLabels: {
            ent: "enterprise",
            biz: "business",
            basic: "basic",
            prem: "premium",
            pro: "pro"
        },
        deflatableModelFiletypes: ["stl", "ply", "obj", "dae"],
        minDeflatableFilesize: 524288,
        maxLevenshteinDistance: 2,
        prodHookDomainsBlacklist: ["sketchfab.com"],
        inspectorBlacklist: ["3docean.net", "3dsquirrel.co.uk", "3dexport.com", "blendermarket.com", "cgtrader.com", "creativemarket.com", "crytek.com", "cubebrush.co", "daz3d.com", "evermotion.orggumroad.com", "pond5.com", "renderosity.com", "stock.adobe.com", "turbosquid.com", "unrealengine.com", "unity3d.com"],
        maxExtraArchiveSize: 524288e3,
        apiPageSize: 24,
        internalDomains: [{
            domain: "2mdn.net",
            allowSubdomains: !0
        }, {
            domain: "3dtotal.com",
            allowSubdomains: !0
        }, {
            domain: "80.lv",
            allowSubdomains: !0
        }, {
            domain: "artstation.com",
            allowSubdomains: !0
        }, {
            domain: "blendernation.com",
            allowSubdomains: !0
        }, {
            domain: "cgsociety.org",
            allowSubdomains: !0
        }, {
            domain: "fatvoxel.com",
            allowSubdomains: !0
        }, {
            domain: "guidigo.com",
            allowSubdomains: !0
        }, {
            domain: "moddb.com",
            allowSubdomains: !0
        }, {
            domain: "nearpod.com",
            allowSubdomains: !0
        }, {
            domain: "serving-sys.com",
            allowSubdomains: !0
        }, {
            domain: "sketchfab.com",
            allowSubdomains: !0
        }, {
            domain: "skfb-local.com",
            allowSubdomains: !0
        }, {
            domain: "syncsketch.com",
            allowSubdomains: !0
        }, {
            domain: "therookies.co",
            allowSubdomains: !0
        }, {
            domain: "yeggi.com",
            allowSubdomains: !0
        }, {
            domain: "yobi3d.com",
            allowSubdomains: !0
        }],
        hosts: {
            faq: "https://help.sketchfab.com/hc/en-us"
        },
        optionsVersion: 8,
        channelNames: {
            Matcap: ["matcap"],
            Displacement: ["displacement"],
            Opacity: ["transparency", "transparent", "opacity", "mask", "alpha"],
            SubsurfaceScattering: ["scattering", "subsurface"],
            SubsurfaceTranslucency: ["translucency", "thickness"],
            DiffuseColor: ["diffuse", "albedo", "basecolor"],
            DiffusePBR: ["diffuse", "albedo", "basecolor"],
            AlbedoPBR: ["diffuse", "albedo", "basecolor"],
            ClearCoat: ["clearcoat"],
            ClearCoatRoughness: ["clearcoat roughness"],
            ClearCoatNormalMap: ["clearcoat normal map"],
            SpecularColor: ["specular", "spec", "s"],
            DiffuseIntensity: ["ambient occlusion", "ao", "occlusion", "lightmap", "diffuseintensity"],
            SpecularPBR: ["specular", "spec", "s"],
            MetalnessPBR: ["metalness", "metallic", "metal", "m"],
            GlossinessPBR: ["glossiness", "glossness", "gloss", "g", "glossy"],
            RoughnessPBR: ["roughness", "rough", "r"],
            NormalMap: ["normal", "nrm", "normalmap"],
            BumpMap: ["bump", "bumpmap", "heightmap"],
            AOPBR: ["ambient occlusion", "ao", "occlusion", "lightmap", "diffuseintensity"],
            EmitColor: ["emission", "emit", "emissive"],
            CavityPBR: ["cavity"],
            SpecularHardness: ["glossiness", "glossness", "gloss", "g", "glossy"],
            SpecularF0: ["specularf0", "f0"],
            Inspector: []
        },
        shortcuts: {
            viewerRendering: {
                name: "Rendering",
                shortcuts: [{
                    id: "defaultRenderingMode",
                    name: "Lit: ",
                    description: "Shows default rendering mode",
                    keyCombinations: ["1"]
                }, {
                    id: "shadelessRenderingMode",
                    name: "Shadeless: ",
                    description: "Shows shadeless rendering mode",
                    keyCombinations: "2"
                }, {
                    id: "matcapRenderingMode",
                    name: "MatCap: ",
                    description: "Shows matcap rendering mode",
                    keyCombinations: "3"
                }, {
                    id: "toggleWireframe",
                    name: "Wireframe: ",
                    description: "Toggles wireframe visibility",
                    keyCombinations: "5"
                }, {
                    id: "inspector",
                    name: "Inspector: ",
                    keyCombinations: ["i"]
                }]
            },
            animationControl: {
                name: "Animations",
                shortcuts: [{
                    id: "prevFrame",
                    name: "Previous frame: ",
                    keyCombinations: ["b", "ctrl+b", "shift+b"]
                }, {
                    id: "nextFrame",
                    name: "Next frame: ",
                    keyCombinations: ["n", "ctrl+n", "shift+n"]
                }, {
                    id: "toggleTextEdition",
                    name: "Go to time/frame : ",
                    keyCombinations: ["enter"]
                }]
            },
            annotationControl: {
                name: "Annotations",
                shortcuts: [{
                    id: "prevAnnotation",
                    name: "Previous: ",
                    keyCombinations: ["j", "pageup"]
                }, {
                    id: "nextAnnotation",
                    name: "Next: ",
                    keyCombinations: ["k", "pagedown"]
                }]
            },
            inspectorControl: {
                name: "Inspector",
                shortcuts: [{
                    id: "render",
                    name: "Render: ",
                    keyCombinations: ["1"]
                }, {
                    id: "materials",
                    name: "Materials: ",
                    keyCombinations: ["2"]
                }, {
                    id: "geometry",
                    name: "Geometry: ",
                    keyCombinations: ["3"]
                }, {
                    id: "uv",
                    name: "UV: ",
                    keyCombinations: ["4"]
                }]
            },
            sound: {
                name: "Sound",
                shortcuts: [{
                    id: "mute",
                    name: "Mute: ",
                    keyCombinations: ["m"]
                }]
            }
        },
        vr: {
            launcherUid: "c0022acc4f3242e2bcae8043e08df8cc"
        },
        defaultMatcapUid: "35c4d334eded44d8a657f390954a32dd",
        facebookApiVersion: "v2.10",
        modelMinPrice: 399,
        reviewsUsageOptions: [{
            value: "game",
            title: "Game development"
        }, {
            value: "rtr",
            title: "Real-Time Rendering"
        }, {
            value: "vfx",
            title: "Rendering & Visual FX"
        }, {
            value: "anim",
            title: "Animation/Motion Design"
        }, {
            value: "vr",
            title: "VR"
        }, {
            value: "print",
            title: "3D Printing, Maker Projects & DIY"
        }, {
            value: "archi",
            title: "Architecture / Interior Design"
        }, {
            value: "edu",
            title: "Education"
        }, {
            value: "ar",
            title: "AR"
        }, {
            value: "art",
            title: "Art"
        }, {
            value: "other",
            title: "Other"
        }],
        storeCartMaxSize: 50
    }
}, , , , , , , , , , , , , function (e, t, i) {
    "use strict";
    var n = (i(36), function () {
        this._gl = void 0, this._onLostContextCallback = void 0
    });
    n.prototype = {
        setGraphicContext: function (e) {
            this._gl = e, n.addObject(this._gl, this)
        },
        getGraphicContext: function () {
            return this._gl
        },
        setLostContextCallback: function (e) {
            this._onLostContextCallback = e
        },
        onLostContext: function () {
            this.invalidate && "function" == typeof this.invalidate && this.invalidate(), this._onLostContextCallback && this._onLostContextCallback()
        }
    }, n._sResourcesArrayCache = new window.Map, n.addObject = function (e, t) {
        n._sResourcesArrayCache.has(e) || n._sResourcesArrayCache.set(e, []);
        var i = n._sResourcesArrayCache.get(e); - 1 === i.indexOf(t) && i.push(t)
    }, n.removeObject = function (e, t) {
        if (n._sResourcesArrayCache.has(e)) {
            var i = n._sResourcesArrayCache.get(e),
                r = i.indexOf(t); - 1 !== r && i.splice(r, 1)
        }
    }, n.onLostContext = function (e) {
        if (n._sResourcesArrayCache.has(e))
            for (var t = n._sResourcesArrayCache.get(e), i = 0, r = t.length; i < r; i++) t[i].onLostContext()
    }, t.a = n
}, function (e, t, i) {
    "use strict";
    var n = i(10),
        r = i(178),
        a = i(160),
        o = i(138),
        s = i(291),
        u = i(289),
        l = i(292),
        c = i(320),
        h = i(12),
        d = function (e, t, i, n, s, l) {
            var c, d, f, p = void 0 !== e ? e : 0,
                m = void 0 !== t ? t : 0,
                g = void 0 !== i ? i : 0,
                v = void 0 !== n ? n : 1,
                _ = void 0 !== s ? s : 1,
                b = void 0 !== l ? l : 1,
                S = new a.a;
            c = v / 2, d = _ / 2, f = b / 2;
            var x = new h.a.Float32Array(72),
                y = new h.a.Float32Array(48),
                C = new h.a.Float32Array(72);
            x[0] = p - c, x[1] = m - d, x[2] = g + f, C[0] = 0, C[1] = -1, C[2] = 0, y[0] = 0, y[1] = 1, x[3] = p - c, x[4] = m - d, x[5] = g - f, C[3] = 0, C[4] = -1, C[5] = 0, y[2] = 0, y[3] = 0, x[6] = p + c, x[7] = m - d, x[8] = g - f, C[6] = 0, C[7] = -1, C[8] = 0, y[4] = 1, y[5] = 0, x[9] = p + c, x[10] = m - d, x[11] = g + f, C[9] = 0, C[10] = -1, C[11] = 0, y[6] = 1, y[7] = 1, x[12] = p + c, x[13] = m + d, x[14] = g + f, C[12] = 0, C[13] = 1, C[14] = 0, y[8] = 0, y[9] = 1, x[15] = p + c, x[16] = m + d, x[17] = g - f, C[15] = 0, C[16] = 1, C[17] = 0, y[10] = 0, y[11] = 0, x[18] = p - c, x[19] = m + d, x[20] = g - f, C[18] = 0, C[19] = 1, C[20] = 0, y[12] = 1, y[13] = 0, x[21] = p - c, x[22] = m + d, x[23] = g + f, C[21] = 0, C[22] = 1, C[23] = 0, y[14] = 1, y[15] = 1, x[24] = p + c, x[25] = m - d, x[26] = g + f, C[24] = 1, C[25] = 0, C[26] = 0, y[16] = 0, y[17] = 1, x[27] = p + c, x[28] = m - d, x[29] = g - f, C[27] = 1, C[28] = 0, C[29] = 0, y[18] = 0, y[19] = 0, x[30] = p + c, x[31] = m + d, x[32] = g - f, C[30] = 1, C[31] = 0, C[32] = 0, y[20] = 1, y[21] = 0, x[33] = p + c, x[34] = m + d, x[35] = g + f, C[33] = 1, C[34] = 0, C[35] = 0, y[22] = 1, y[23] = 1, x[36] = p - c, x[37] = m + d, x[38] = g + f, C[36] = -1, C[37] = 0, C[38] = 0, y[24] = 0, y[25] = 1, x[39] = p - c, x[40] = m + d, x[41] = g - f, C[39] = -1, C[40] = 0, C[41] = 0, y[26] = 0, y[27] = 0, x[42] = p - c, x[43] = m - d, x[44] = g - f, C[42] = -1, C[43] = 0, C[44] = 0, y[28] = 1, y[29] = 0, x[45] = p - c, x[46] = m - d, x[47] = g + f, C[45] = -1, C[46] = 0, C[47] = 0, y[30] = 1, y[31] = 1, x[48] = p - c, x[49] = m + d, x[50] = g + f, C[48] = 0, C[49] = 0, C[50] = 1, y[32] = 0, y[33] = 1, x[51] = p - c, x[52] = m - d, x[53] = g + f, C[51] = 0, C[52] = 0, C[53] = 1, y[34] = 0, y[35] = 0, x[54] = p + c, x[55] = m - d, x[56] = g + f, C[54] = 0, C[55] = 0, C[56] = 1, y[36] = 1, y[37] = 0, x[57] = p + c, x[58] = m + d, x[59] = g + f, C[57] = 0, C[58] = 0, C[59] = 1, y[38] = 1, y[39] = 1, x[60] = p + c, x[61] = m + d, x[62] = g - f, C[60] = 0, C[61] = 0, C[62] = -1, y[40] = 0, y[41] = 1, x[63] = p + c, x[64] = m - d, x[65] = g - f, C[63] = 0, C[64] = 0, C[65] = -1, y[42] = 0, y[43] = 0, x[66] = p - c, x[67] = m - d, x[68] = g - f, C[66] = 0, C[67] = 0, C[68] = -1, y[44] = 1, y[45] = 0, x[69] = p - c, x[70] = m + d, x[71] = g - f, C[69] = 0, C[70] = 0, C[71] = -1, y[46] = 1, y[47] = 1;
            var T = new h.a.Uint16Array(36);
            T[0] = 0, T[1] = 1, T[2] = 2, T[3] = 0, T[4] = 2, T[5] = 3, T[6] = 4, T[7] = 5, T[8] = 6, T[9] = 4, T[10] = 6, T[11] = 7, T[12] = 8, T[13] = 9, T[14] = 10, T[15] = 8, T[16] = 10, T[17] = 11, T[18] = 12, T[19] = 13, T[20] = 14, T[21] = 12, T[22] = 14, T[23] = 15, T[24] = 16, T[25] = 17, T[26] = 18, T[27] = 16, T[28] = 18, T[29] = 19, T[30] = 20, T[31] = 21, T[32] = 22, T[33] = 20, T[34] = 22, T[35] = 23, S.getAttributes().Vertex = new r.a(r.a.ARRAY_BUFFER, x, 3), S.getAttributes().Normal = new r.a(r.a.ARRAY_BUFFER, C, 3), S.getAttributes().TexCoord0 = new r.a(r.a.ARRAY_BUFFER, y, 2);
            var w = new u.a(o.a.TRIANGLES, new r.a(r.a.ELEMENT_ARRAY_BUFFER, T, 1));
            return S.getPrimitives().push(w), S
        },
        f = function () {
            var e = new a.a,
                t = new h.a.Float32Array([4, -1, -1, 4, -1, -1]),
                i = new r.a(r.a.ARRAY_BUFFER, t, 2);
            e.getAttributes().Vertex = i, e.getAttributes().TexCoord0 = i;
            var n = new s.a(o.a.TRIANGLES, 0, 3);
            return e.getPrimitives().push(n),
                function () {
                    return e
                }
        }(),
        p = function (e, t, i, s, l, c, d, f, p, m, g, v, _) {
            void 0 === v && void 0 === _ && (v = m, _ = g, m = 0, g = 0);
            var b = new a.a,
                S = new h.a.Float32Array(12);
            S[0] = e + d, S[1] = t + f, S[2] = i + p, S[3] = e, S[4] = t, S[5] = i, S[6] = e + s, S[7] = t + l, S[8] = i + c, S[9] = e + s + d, S[10] = t + l + f, S[11] = i + c + p, void 0 === v && (v = 1), void 0 === _ && (_ = 1);
            var x = new h.a.Float32Array(8);
            x[0] = m, x[1] = _, x[2] = m, x[3] = g, x[4] = v, x[5] = g, x[6] = v, x[7] = _;
            var y = n.f.fromValues(s, l, c);
            n.f.cross(y, y, n.f.fromValues(d, f, p)), n.f.normalize(y, y);
            var C = new h.a.Float32Array(12);
            C[0] = y[0], C[1] = y[1], C[2] = y[2], C[3] = y[0], C[4] = y[1], C[5] = y[2], C[6] = y[0], C[7] = y[1], C[8] = y[2], C[9] = y[0], C[10] = y[1], C[11] = y[2];
            var T = new h.a.Uint16Array(6);
            T[0] = 0, T[1] = 1, T[2] = 2, T[3] = 0, T[4] = 2, T[5] = 3, b.getAttributes().Vertex = new r.a(r.a.ARRAY_BUFFER, S, 3), b.getAttributes().Normal = new r.a(r.a.ARRAY_BUFFER, C, 3), b.getAttributes().TexCoord0 = new r.a(r.a.ARRAY_BUFFER, x, 2);
            var w = new u.a(o.a.TRIANGLES, new r.a(r.a.ELEMENT_ARRAY_BUFFER, T, 1));
            return b.getPrimitives().push(w), b
        },
        m = function (e) {
            void 0 === e && (e = 1), void 0 === m.getShader && (m.getShader = function () {
                if (void 0 === m.getShader.program) {
                    var e = ["attribute vec3 Vertex;", "attribute vec4 Color;", "uniform mat4 uModelViewMatrix;", "uniform mat4 uProjectionMatrix;", "", "varying vec4 vColor;", "", "void main(void) {", "  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex, 1.0));", "  vColor = Color;", "}"].join("\n"),
                        t = ["varying vec4 vColor;", "void main(void) {", "gl_FragColor = vColor;", "}"].join("\n"),
                        i = new l.a(new c.a("VERTEX_SHADER", e), new c.a("FRAGMENT_SHADER", t));
                    m.getShader.program = i
                }
                return m.getShader.program
            });
            var t = new a.a,
                i = new h.a.Float32Array(18);
            i[3] = e, i[10] = e, i[17] = e;
            var n = new h.a.Float32Array(24);
            n[0] = n[3] = 1, n[4] = n[7] = 1, n[9] = n[11] = 1, n[13] = n[15] = 1, n[18] = n[19] = 1, n[22] = n[23] = 1, t.getAttributes().Vertex = new r.a(r.a.ARRAY_BUFFER, i, 3), t.getAttributes().Color = new r.a(r.a.ARRAY_BUFFER, n, 4);
            var u = new s.a(o.a.LINES, 0, 6);
            return t.getPrimitives().push(u), t.getOrCreateStateSet().setAttributeAndModes(m.getShader()), t
        },
        g = function (e, t, i, l, c, d, f) {
            e = e || 1, l = void 0 !== l ? l : 0, c = void 0 !== c ? c : 2 * Math.PI, d = void 0 !== d ? d : 0, f = void 0 !== f ? f : Math.PI;
            for (var p = Math.max(3, Math.floor(t) || 8), m = Math.max(2, Math.floor(i) || 6), g = p * m / 3 >= 65536, v = g ? p * m * 6 : p * m * 4, _ = new h.a.Float32Array(3 * v), b = new h.a.Float32Array(3 * v), S = new h.a.Float32Array(2 * v), x = g ? void 0 : new h.a.Uint16Array(p * m * 6), y = 0, C = 0, T = new h.a.Float32Array(3), w = new h.a.Float32Array(3), M = new h.a.Float32Array(3), E = new h.a.Float32Array(3), A = new h.a.Float32Array(3), P = new h.a.Float32Array(3), R = new h.a.Float32Array(3), O = new h.a.Float32Array(3), I = new h.a.Float32Array(2), F = new h.a.Float32Array(2), N = new h.a.Float32Array(2), D = new h.a.Float32Array(2), L = function (t, i, r, a, o) {
                    r[0] = -e * Math.cos(l + t * c) * Math.sin(d + i * f), r[1] = e * Math.cos(d + i * f), r[2] = e * Math.sin(l + t * c) * Math.sin(d + i * f), n.f.normalize(a, r), o[0] = t, o[1] = 1 - i
                }, k = 0; k < m; k++)
                for (var V = 0; V < p; V++) {
                    L((V + 1) / p, k / m, T, A, I), L(V / p, k / m, w, P, F), L(V / p, (k + 1) / m, M, R, N), L((V + 1) / p, (k + 1) / m, E, O, D);
                    var B = 3 * y;
                    _[B] = T[0], _[B + 1] = T[1], _[B + 2] = T[2], _[B + 3] = w[0], _[B + 4] = w[1], _[B + 5] = w[2], _[B + 6] = M[0], _[B + 7] = M[1], _[B + 8] = M[2], b[B] = A[0], b[B + 1] = A[1], b[B + 2] = A[2], b[B + 3] = P[0], b[B + 4] = P[1], b[B + 5] = P[2], b[B + 6] = R[0], b[B + 7] = R[1], b[B + 8] = R[2];
                    var U = 2 * y;
                    if (S[U] = I[0], S[U + 1] = I[1], S[U + 2] = F[0], S[U + 3] = F[1], S[U + 4] = N[0], S[U + 5] = N[1], y += 3, g) B = 3 * y, _[B] = T[0], _[B + 1] = T[1], _[B + 2] = T[2], _[B + 3] = M[0], _[B + 4] = M[1], _[B + 5] = M[2], _[B + 6] = E[0], _[B + 7] = E[1], _[B + 8] = E[2], b[B] = A[0], b[B + 1] = A[1], b[B + 2] = A[2], b[B + 3] = R[0], b[B + 4] = R[1], b[B + 5] = R[2], b[B + 6] = O[0], b[B + 7] = O[1], b[B + 8] = O[2], U = 2 * y, S[U] = I[0], S[U + 1] = I[1], S[U + 2] = N[0], S[U + 3] = N[1], S[U + 4] = D[0], S[U + 5] = D[1], y += 3;
                    else {
                        B = 3 * y, _[B] = E[0], _[B + 1] = E[1], _[B + 2] = E[2], b[B] = O[0], b[B + 1] = O[1], b[B + 2] = O[2], U = 2 * y, S[U] = D[0], S[U + 1] = D[1];
                        var G = 3 * C,
                            j = y - 3;
                        x[G] = j, x[G + 1] = j + 1, x[G + 2] = j + 2, x[G + 3] = j, x[G + 4] = j + 2, x[G + 5] = j + 3, C += 2, y += 1
                    }
                }
            var z = new a.a;
            return z.getAttributes().Vertex = new r.a("ARRAY_BUFFER", _, 3), z.getAttributes().Normal = new r.a("ARRAY_BUFFER", b, 3), z.getAttributes().TexCoord0 = new r.a("ARRAY_BUFFER", S, 2), g ? z.getPrimitives().push(new s.a(o.a.TRIANGLES, 0, _.length / 3)) : z.getPrimitives().push(new u.a(o.a.TRIANGLES, new r.a("ELEMENT_ARRAY_BUFFER", x, 1))), z
        },
        v = function (e, t, i, n, u, l, c, h, d, f, p) {
            e = void 0 !== e ? e : -.5, t = void 0 !== t ? t : -.5, i = void 0 !== i ? i : 0, n = void 0 !== n ? n : 1, u = void 0 !== u ? u : 0, l = void 0 !== l ? l : 0, c = void 0 !== c ? c : 0, h = void 0 !== h ? h : 1, d = void 0 !== d ? d : 0, f = void 0 !== f ? f : 5, p = void 0 !== p ? p : f, f += 2, p += 2;
            var m = new a.a,
                g = new Float32Array(2 * (f + p) * 3),
                v = 0,
                _ = 0,
                b = n / (f - 1),
                S = u / (f - 1),
                x = l / (f - 1),
                y = e + n + c,
                C = t + u + h,
                T = i + l + d;
            for (v = 0; v < f; ++v) _ = 6 * v, g[_] = e + b * v, g[_ + 1] = t + S * v, g[_ + 2] = i + x * v, g[_ + 3] = y - b * (f - v - 1), g[_ + 4] = C - S * (f - v - 1), g[_ + 5] = T - x * (f - v - 1);
            for (b = c / (p - 1), S = h / (p - 1), x = d / (p - 1), v = 0; v < p; ++v) _ = 6 * (f + v), g[_] = e + b * v, g[_ + 1] = t + S * v, g[_ + 2] = i + x * v, g[_ + 3] = y - b * (p - v - 1), g[_ + 4] = C - S * (p - v - 1), g[_ + 5] = T - x * (p - v - 1);
            m.getAttributes().Vertex = new r.a(r.a.ARRAY_BUFFER, g, 3);
            var w = new s.a(o.a.LINES, 0, 2 * (f + p));
            return m.getPrimitives().push(w), m
        },
        _ = function (e) {
            var t = new a.a,
                i = new Float32Array([-.5, -.5, -.5, .5, -.5, -.5, .5, .5, -.5, -.5, .5, -.5, -.5, -.5, .5, .5, -.5, .5, .5, .5, .5, -.5, .5, .5]);
            t.getAttributes().Vertex = new r.a(r.a.ARRAY_BUFFER, i, 3), e || (e = [1, 0, 0, 1]);
            for (var n = new h.a.Float32Array(32), s = 0; s < 8; s++)
                for (var l = 0; l < 4; l++) n[3 * s + l] = e[l];
            t.getAttributes().Color = new r.a(r.a.ARRAY_BUFFER, n, 4);
            var c = new h.a.Uint16Array([0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7]);
            return t.getPrimitives().push(new u.a(o.a.LINES, new r.a("ELEMENT_ARRAY_BUFFER", c, 1))), t
        };
    t.a = {
        createTexturedBoxGeometry: d,
        createTexturedQuadGeometry: p,
        createTexturedSphereGeometry: g,
        createTexturedFullScreenFakeQuadGeometry: f,
        createAxisGeometry: m,
        createTexturedSphere: g,
        createGridGeometry: v,
        createBoundingBoxGeometry: _
    }
}, function (e, t, i) {
    "use strict";
    var n = i(10),
        r = i(864),
        a = {};
    a.InvalidTargetID = -1;
    var o = function (e, t, i) {
            return {
                type: e,
                id: a.InvalidTargetID,
                channels: [],
                value: t,
                defaultValue: i
            }
        },
        s = function (e) {
            return o(r.a.Quat, n.d.copy(n.d.create(), e), n.d.copy(n.d.create(), e))
        },
        u = function (e) {
            return o(r.a.Matrix, n.c.copy(n.c.create(), e), n.c.copy(n.c.create(), e))
        },
        l = function (e) {
            return o(r.a.Vec3, n.f.copy(n.f.create(), e), n.f.copy(n.f.create(), e))
        },
        c = function (e) {
            return o(r.a.Float, e, e)
        };
    a.createQuatTarget = s, a.createVec3Target = l, a.createFloatTarget = c, a.createMatrixTarget = u, t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(14),
        a = i(750),
        o = i(751),
        s = i(920),
        u = i(705),
        l = i(230),
        c = n.a.osg,
        h = function (e, t, i) {
            c.NodeVisitor.call(this, c.NodeVisitor.TRAVERSE_ALL_CHILDREN), this._lights = [], this._materials = [], this._materialManager = e, this._stateSetsProcessed = {}, this._authoringTool = t, this._source = i, this._style = "", this._hasMetal = void 0, this._globalEnforceRoughness = void 0, this._dictionary = r.a.channelNames, this._dictionaryKeys = Object.keys(r.a.channelNames), this._sortedImages = void 0, this._textureFactor1 = !1, this._textureUnit0 = !1
        };
    c.createPrototypeObject(h, c.objectInherit(c.NodeVisitor.prototype, {
        getStyle: function () {
            return this._style
        },
        hasMetallicWorkflow: function () {
            return this._hasMetal
        },
        getLights: function () {
            return this._lights
        },
        getMaterials: function () {
            return this._materials
        },
        copyDiffuse: function (e) {
            var t = e.getChannels().DiffuseColor,
                i = e.getChannels().AlbedoPBR,
                n = e.getChannels().DiffusePBR,
                r = t.getColor(),
                a = t.getFactor(),
                o = t.getTextureModel();
            r && (i.setColor(r), n.setColor(r)), i.setFactor(a), n.setFactor(a), o && (i.setTextureModel(o), n.setTextureModel(o))
        },
        matchNameAgainstDict: function (e, t, i) {
            for (var n = Object(o.a)(e), r = 0; r < t.length; r++) {
                var s = t[r],
                    u = Object(a.a)(n, s);
                if (u < i && u < s.length) return !0
            }
            return !1
        },
        channelTextureExtract: function (e, t) {
            var i = e.getChannels()[t];
            if (i) {
                var n = i.getTextureModel();
                if (n) return n.getImageModel().get("name")
            }
        },
        channelTextureMatch: function (e, t, i, n) {
            var r = this.channelTextureExtract(e, t);
            return r && this.matchNameAgainstDict(r, i, n)
        },
        hasTextureChannel: function (e, t) {
            return void 0 !== this.channelTextureExtract(e, t)
        },
        channelTextureCopy: function (e, t, i) {
            var n, r = e.getChannels();
            if (this.channelTextureExtract(e, t))
                for (var a = i.length; a--;) n = r[i[a]], n.setTextureModel(r[t].getTextureModel().clone())
        },
        checkPBRSlot: function (e) {
            if (e)
                for (var t = 0; t < this._dictionaryKeys.length; t++) {
                    var i = this._dictionaryKeys[t],
                        n = this._dictionary[i];
                    if (this.matchNameAgainstDict(e, n, r.a.maxLevenshteinDistance)) return i
                }
        },
        assignPBRTextureFromFilenames: function (e, t) {
            for (var i = 0, n = e.length; i < n; ++i) {
                var r = e[i],
                    a = r.getName(),
                    o = this.checkPBRSlot(a);
                if (!o && r.getImage() && (a = r.getImage().getURL(), o = this.checkPBRSlot(a)), o) {
                    var s = t.getChannels(),
                        u = s[o];
                    if (!u.getTextureModel()) {
                        var l = this.createTextureOptionsFromTextureOSG(r);
                        l && u.setupTextureModel(l)
                    }
                }
            }
        },
        checkChannelsAndSetWorkFlowRoughGloss: function (e) {
            if (e) {
                var t = e.getChannels(),
                    i = this.hasTextureChannel(e, "GlossinessPBR"),
                    n = this.hasTextureChannel(e, "SpecularPBR"),
                    r = this.hasTextureChannel(e, "RoughnessPBR");
                this.hasTextureChannel(e, "BumpMap") && t.BumpMap.setFactor(10), this.hasTextureChannel(e, "MetalnessPBR") && (this._hasMetal = !0), n && void 0 === this._hasMetal && (this._hasMetal = !1);
                var a = r || this._globalEnforceRoughness;
                a || (a = !i && void 0 === this._globalEnforceRoughness), e.setWorkFlowRoughGloss(a, !1)
            }
        },
        matchFullNameAgainstDict: function (e, t) {
            for (var i = 0; i < t.length; ++i)
                if (!(t[i].length < 4) && -1 !== e.indexOf(t[i])) return !0;
            return !1
        },
        setChannelsFromImagesNames: function (e, t, i, n) {
            for (var a = r.a.maxLevenshteinDistance, o = 0, u = t.length; o < u; o++)
                for (var l = t[o], c = this._dictionary[l], h = 0, d = i.length; h < d; h++) {
                    var f = i[h].get("name"),
                        p = n ? this.matchFullNameAgainstDict(f, c) : this.matchNameAgainstDict(f, c, a);
                    if (p) {
                        var m = e.getChannels()[l];
                        m.setTextureModel(new s.a({
                            image: i[h]
                        })), m.setFactor(1), e.setChannelEnable(m.get("name"), !0)
                    }
                }
        },
        setGlossinessPBRFromSpecularGlossiness: function (e, t, i) {
            var n = .2126 * t[0] + .7152 * t[1] + .0722 * t[2],
                r = Math.pow(1e4 * i, .25) / 100 * n;
            e.setChannelFactor("GlossinessPBR", r), e.setChannelEnable("GlossinessPBR", !0), this._globalEnforceRoughness = !1
        },
        getPBRChannels: function (e) {
            var t = [],
                i = e.getChannels();
            for (var n in i) - 1 !== n.indexOf("PBR") && t.push(n);
            return t
        },
        channelMatchAndCopy: function (e, t, i) {
            var n = this._dictionary[i];
            if (this.channelTextureMatch(e, t, n, 2)) return this.channelTextureCopy(e, t, [i])
        },
        checkForPBRTextureFromChannelsAndFilenames: function (e) {
            if (e) {
                for (var t = this.getPBRChannels(e), i = t.length; i--;)
                    if (void 0 !== this.channelTextureExtract(e, t[i])) return;
                this.channelTextureCopy(e, "DiffuseColor", ["AlbedoPBR", "DiffusePBR"]), this.channelTextureCopy(e, "DiffuseIntensity", ["AOPBR"]), this.channelMatchAndCopy(e, "SpecularColor", "MetalnessPBR") || this.channelMatchAndCopy(e, "SpecularHardness", "MetalnessPBR") || this.channelMatchAndCopy(e, "SpecularColor", "SpecularPBR") || this.channelMatchAndCopy(e, "SpecularHardness", "SpecularPBR"), this.channelMatchAndCopy(e, "SpecularColor", "RoughnessPBR") || this.channelMatchAndCopy(e, "SpecularHardness", "RoughnessPBR") || this.channelMatchAndCopy(e, "SpecularColor", "GlossinessPBR") || this.channelMatchAndCopy(e, "SpecularHardness", "GlossinessPBR")
            }
        },
        getOrCreateSortedImagesList: function () {
            return void 0 === this._sortedImages && (this._sortedImages = this._materialManager.getImageCollection().clone(), this._sortedImages.comparator = function (e, t) {
                return (e.get("version") || 0) - (t.get("version") || 0)
            }, this._sortedImages.sort()), this._sortedImages
        },
        checkForPBRTextureFromMaterialAndFilenames: function (e, t) {
            if (e && 0 !== this._materialManager.getImageCollection().length) {
                var i = [],
                    n = this,
                    r = e.getChannels();
                for (var a in r) n.channelTextureExtract(e, a) || i.push(a);
                for (var o = [], s = this.getOrCreateSortedImagesList(), u = e.get("name").toLowerCase(), l = 0; l < s.length; l++) {
                    var c = s.models[l].get("name");
                    (t || -1 !== c.toLowerCase().indexOf(u)) && o.push(s.models[l])
                }
                this.setChannelsFromImagesNames(e, i, o, t)
            }
        },
        hasMaterialAttributes: function (e) {
            return e.getAttribute("Material")
        },
        hasTextureAttributes: function (e) {
            for (var t = 0, i = e.getNumTextureAttributeLists(); t < i; t++)
                if (e.getTextureAttribute(t, "Texture")) return !0;
            return !1
        },
        processDefaultMaterial: function (e, t) {
            t.removeAttribute("Material");
            for (var i = 0, n = t.getNumTextureAttributeLists(); i < n; i++) t.removeTextureAttribute(i, "Texture")
        },
        getReferencedTextures: function (e) {
            for (var t = [], i = 0; i < e.getNumTextureAttributeLists(); i++) {
                var n = e.getTextureAttribute(i, "Texture");
                n && ("PackedMaterialTexture" === n.className() && (n = n.getTexture()), t[i] = n)
            }
            return t
        },
        createMaterial: function (e, t) {
            var i = this._materialManager.createMaterial(e, t);
            return this._materials.push(i), i
        },
        createTextureOptionsFromTextureOSG: function (e) {
            var t = u.a.getOptions(e),
                i = e.getImage(),
                n = i.getURL(),
                r = this._materialManager.getImageCollection(),
                a = r.getImageFromURL(n);
            return a ? (t.image = a, t) : void c.error("Cannot find image in collection : " + n)
        },
        mapTexturesOnMaterial: function (e, t) {
            for (var i = ["EmitColor", "DiffuseColor", "SpecularColor"], n = this.getReferencedTextures(e), r = e.getNumTextureAttributeLists(), a = 0, o = r; a < o; a++)
                if (e.getTextureAttribute(a, "Texture")) {
                    var u = 1 === r ? "DiffuseColor" : i[a];
                    if (u && n[a]) {
                        var l = this.createTextureOptionsFromTextureOSG(n[a]);
                        if (l) {
                            var c = new s.a(l);
                            this.setMaterialChannelTexture(e, t, a, u, c)
                        }
                    }
                }
        },
        applyExistingMaterial: function (e, t) {
            if (e) {
                var i = this._materialManager.getMaterialByStateSet(e);
                if (!i) return void(this._stateSetsProcessed[e.getInstanceID()] = !0);
                var n = i.get("stateSet") || e,
                    r = n.getInstanceID();
                if (!0 === this._stateSetsProcessed[r]) return i;
                this._stateSetsProcessed[r] = !0;
                var a = e.getAttributeMap().Material,
                    o = this._materialManager.getUniqueMaterialName(a, e, t);
                return i.set("name", o), i.setStateSet(e), this._materials.push(i), i
            }
        },
        processLightSource: function () {},
        pushLight: function (e) {
            var t = this.nodePath[this.nodePath.length - 1];
            t instanceof c.LightSource && (t.setNodeMask(0), t.setLight(e)), e._worldMatrix = c.computeLocalToWorld(this.nodePath), this._lights.push(e)
        },
        processNode: function (e) {
            var t = e.getStateSet();
            if (t) {
                var i = this.applyExistingMaterial(t, e);
                if (i) return void e.setStateSet(i.get("stateSet"));
                var n = t.getUserData();
                if (this.hasMaterialAttributes(t) || this.hasTextureAttributes(t))
                    if (n) {
                        var r = l.a.convertUserDataToObject(n);
                        this.processMaterial(e, t, r)
                    } else this.processDefaultMaterial(e, t);
                i = this._materialManager.getMaterialByStateSet(t), this.checkForPBRTextureFromChannelsAndFilenames(i), this.checkForPBRTextureFromMaterialAndFilenames(i), this.checkChannelsAndSetWorkFlowRoughGloss(i)
            }
        },
        apply: function (e) {
            e.typeID === c.LightSource.typeID && this.processLightSource(e), this.processNode(e), this.traverse(e)
        },
        handleSingleMaterialMapping: function () {
            if (1 === this.getMaterials().length) {
                var e = this.getMaterials()[0];
                this.checkForPBRTextureFromMaterialAndFilenames(e, !0), this.checkChannelsAndSetWorkFlowRoughGloss(e)
            }
        },
        setMaterialChannelColor: function (e, t, i, n) {
            var r = t.getChannels()[i];
            return r.setColor && r.setColor(n), r.setEnable(!0), r
        },
        setMaterialChannelFactor: function (e, t, i, n) {
            var r = t.getChannels()[i];
            return r.setFactor(n), r.setEnable(!0), r
        },
        setMaterialChannelTexture: function (e, t, i, n, r) {
            e.removeTextureAttribute(i, "Texture");
            var a = t.getChannels()[n];
            return a.setTextureModel(r), a.resetTextureFormat(), this._textureFactor1 && a.setFactor(1), a.setTexCoordUnit(this._textureUnit0 ? 0 : i), a.setEnable(!0), a
        },
        setChannelsFromMetaDataFactor: function (e, t) {
            if (this._metaMapFactor) {
                var i = this._metaMapFactor;
                for (var n in i)
                    if (void 0 !== e[n]) {
                        var r = JSON.parse(e[n]);
                        this.setMaterialChannelFactor(e, t, i[n], r)
                    }
            }
        },
        setChannelsFromMetaDataColor: function (e, t) {
            if (this._metaMapColor) {
                var i = this._metaMapColor;
                for (var n in i)
                    if (void 0 !== e[n]) {
                        var r = JSON.parse(e[n]);
                        this.setMaterialChannelColor(e, t, i[n], r)
                    }
            }
        },
        setChannelsFromMetaDataTexture: function (e, t, i) {
            if (this._metaMapTexture) {
                var n = this.getReferencedTextures(t),
                    r = this._metaMapTexture;
                for (var a in r)
                    if (void 0 !== e[a]) {
                        var o = JSON.parse(e[a]),
                            u = n[o];
                        if (u) {
                            var l = this.createTextureOptionsFromTextureOSG(u);
                            if (l) {
                                var c = new s.a(l),
                                    h = r[a];
                                this.setMaterialChannelTexture(t, i, o, h, c)
                            }
                        }
                    }
            }
        }
    })), t.a = h
}, , , , function (e, t, i) {
    "use strict";
    var n, r = i(474),
        a = i(334);
    n = a.a.extend({
        model: r.a,
        url: "/i/skills"
    }), t.a = n
}, function (e, t, i) {
    "use strict";

    function n() {
        var e;
        try {
            if (!(e = window.location !== window.parent.location ? document.referrer : document.location.href)) throw new Error("url is not defined")
        } catch (t) {
            e = document.referrer
        }
        var t = document.createElement("a");
        return t.href = e, t
    }

    function r() {
        return n().hostname.replace(/^www\./, "")
    }
    t.b = n, t.a = r
}, function (e, t, i) {
    ! function () {
        (window.nunjucksPrecompiled = window.nunjucksPrecompiled || {})["skfb_front/macros/logo.jinja"] = function () {
            function e(e, t, n, r, a) {
                var o = null,
                    s = null,
                    u = "";
                try {
                    var l = null,
                        c = r.makeMacro([], ["headerStyle"], function (a) {
                            var u = n;
                            n = new r.Frame, a = a || {}, a.hasOwnProperty("caller") && n.set("caller", a.caller), n.set("headerStyle", a.hasOwnProperty("headerStyle") ? a.headerStyle : "normal");
                            var l = "";
                            return l += '\n<div class="logo">\n    <a class="link" href="/">\n        ', l += "\n        ", "transparent" == r.contextOrFrameLookup(t, n, "headerStyle") && (l += '\n        <div class="logo__image --white">\n            <img src="', l += r.suppressValue(i(945), e.opts.autoescape), l += '" width="121" height="30" class="svg-logo" alt="Sketchfab">\n            <img src="', l += r.suppressValue(i(946), e.opts.autoescape), l += '" width="121" height="30" class="svg-logo --hover" alt="Sketchfab">\n        </div>\n        '), l += "\n        ", l += '\n        <div class="logo__image">\n            ', l += r.suppressValue((o = 12, s = 17, r.callWrap(r.contextOrFrameLookup(t, n, "logo"), "logo", t, [121, 30])), e.opts.autoescape), l += "\n        </div>\n    </a>\n</div>\n", n = u, new r.SafeString(l)
                        });
                    t.addExport("header_logo"), t.setVariable("header_logo", c), u += "\n\n\n";
                    var h = r.makeMacro([], [], function (i) {
                        var a = n;
                        n = new r.Frame, i = i || {}, i.hasOwnProperty("caller") && n.set("caller", i.caller);
                        var u = "";
                        return u += '\n<div class="logo">\n    <a href="/">\n        ', u += r.suppressValue((o = 22, s = 13, r.callWrap(r.contextOrFrameLookup(t, n, "logo"), "logo", t, [96, 20])), e.opts.autoescape), u += "\n    </a>\n</div>\n", n = a, new r.SafeString(u)
                    });
                    t.addExport("responsive_header_logo"), t.setVariable("responsive_header_logo", h), u += "\n\n\n";
                    var d = r.makeMacro(["width", "height"], ["options"], function (i, a, o) {
                        var s = n;
                        n = new r.Frame, o = o || {}, o.hasOwnProperty("caller") && n.set("caller", o.caller), n.set("width", i), n.set("height", a), n.set("options", o.hasOwnProperty("options") ? o.options : {});
                        var u = "";
                        u += "\n\n    ";
                        var l;
                        if (l = e.getFilter("merge").call(t, {
                                brand: !0,
                                color: "#555555",
                                logo_color: "#FFFFFF",
                                circle_color: "#1CAAD9"
                            }, r.contextOrFrameLookup(t, n, "options")), n.set("options", l, !0), n.topLevel && t.setVariable("options", l), n.topLevel && t.addExport("options", l), u += "\n\n    ", r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "brand")) {
                            u += "\n        ";
                            var c;
                            c = 121, n.set("view_width", c, !0), n.topLevel && t.setVariable("view_width", c), n.topLevel && t.addExport("view_width", c), u += "\n    "
                        } else {
                            u += "\n        ";
                            var h;
                            h = 25, n.set("view_width", h, !0), n.topLevel && t.setVariable("view_width", h), n.topLevel && t.addExport("view_width", h), u += "\n    "
                        }
                        return u += '\n\n    <svg class="svg-logo" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve"\n         x="0" y="0" width="', u += r.suppressValue(i, e.opts.autoescape), u += '" height="', u += r.suppressValue(a, e.opts.autoescape), u += '"\n         viewBox="0 0 ', u += r.suppressValue(r.contextOrFrameLookup(t, n, "view_width"), e.opts.autoescape), u += ' 25"\n         enable-background="new 0 0 ', u += r.suppressValue(r.contextOrFrameLookup(t, n, "view_width"), e.opts.autoescape), u += ' 25">\n\n        ', r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "brand") && (u += '\n            <g id="logo-text" class="logo-text">\n                <path fill="', u += r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "color"), e.opts.autoescape), u += '"\n                    d="M36.471,7.719c-1.526,0-2.289,0.504-2.289,1.512c0,0.448,0.189,0.791,0.567,1.029\n                       c0.378,0.238,1.263,0.582,2.656,1.029c1.393,0.448,2.37,0.956,2.93,1.522c0.56,0.567,0.84,1.438,0.84,2.615\n                       c0,1.498-0.455,2.632-1.365,3.401c-0.911,0.771-2.1,1.155-3.57,1.155c-1.092,0-2.429-0.168-4.011-0.504l-0.756-0.147l0.294-2.247\n                       c1.876,0.253,3.311,0.379,4.305,0.379c1.484,0,2.226-0.616,2.226-1.849c0-0.447-0.171-0.798-0.515-1.05s-1.025-0.525-2.047-0.819\n                       c-1.624-0.462-2.769-1.011-3.434-1.648s-0.998-1.522-0.998-2.657c0-1.428,0.434-2.492,1.302-3.192c0.868-0.7,2.058-1.05,3.57-1.05\n                       c1.036,0,2.352,0.14,3.948,0.42l0.756,0.147L40.65,8.056C38.676,7.832,37.283,7.719,36.471,7.719z"\n                />\n                <path fill="', u += r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "color"), e.opts.autoescape), u += '"\n                    d="M46.068,19.731h-2.814v-14.7h2.814v8.358l1.071-0.189l2.079-3.969h3.15l-2.73,4.977l2.877,5.523h-3.171\n                       l-2.121-4.095l-1.155,0.188V19.731z"\n                />\n                <path fill="', u += r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "color"), e.opts.autoescape), u += '"\n                    d="M56.705,17.075c0.329,0.287,0.801,0.431,1.417,0.431c1.302,0,2.464-0.042,3.486-0.126l0.589-0.063\n                       l0.041,2.079c-1.61,0.392-3.066,0.588-4.368,0.588c-1.582,0-2.73-0.42-3.444-1.26c-0.714-0.84-1.071-2.205-1.071-4.095\n                       c0-3.766,1.547-5.649,4.641-5.649c3.052,0,4.578,1.582,4.578,4.746l-0.209,1.953H56.19C56.204,16.322,56.375,16.788,56.705,17.075z\n                       M59.802,13.536c0-0.84-0.133-1.424-0.399-1.753c-0.266-0.329-0.732-0.493-1.396-0.493c-0.666,0-1.134,0.171-1.407,0.514\n                       c-0.273,0.343-0.417,0.921-0.431,1.732H59.802z"\n                />\n                <path fill="', u += r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "color"), e.opts.autoescape), u += '"\n                    d="M70.407,11.625h-2.583v4.305c0,0.42,0.011,0.718,0.031,0.893c0.021,0.175,0.098,0.325,0.231,0.451\n                       c0.133,0.126,0.339,0.189,0.619,0.189l1.596-0.042l0.126,2.246c-0.938,0.211-1.651,0.315-2.142,0.315\n                       c-1.26,0-2.121-0.283-2.583-0.851c-0.462-0.566-0.693-1.613-0.693-3.14v-4.368h-1.238V9.231h1.238V6.312h2.814v2.919h2.583V11.625z"\n                />\n                <path fill="', u += r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "color"), e.opts.autoescape), u += '"\n                    d="M76.161,8.979c0.729,0,1.659,0.112,2.794,0.336l0.566,0.126l-0.084,2.226\n                       c-1.106-0.112-1.925-0.168-2.457-0.168c-0.966,0-1.606,0.207-1.921,0.62c-0.315,0.413-0.473,1.193-0.473,2.341\n                       c0,1.148,0.157,1.937,0.473,2.363c0.314,0.427,0.962,0.641,1.942,0.641l2.436-0.168l0.084,2.246\n                       c-1.498,0.295-2.639,0.441-3.423,0.441c-1.554,0-2.671-0.438-3.35-1.312s-1.019-2.278-1.019-4.211c0-1.932,0.35-3.328,1.05-4.189\n                       S74.607,8.979,76.161,8.979z"\n                />\n                <path fill="', u += r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "color"), e.opts.autoescape), u += '"\n                    d="M84.414,19.731H81.6v-14.7h2.814v4.704c0.966-0.504,1.834-0.756,2.604-0.756c1.4,0,2.366,0.413,2.898,1.239\n                       c0.531,0.826,0.798,2.1,0.798,3.822v5.691h-2.814v-5.628c0-0.882-0.104-1.536-0.314-1.963s-0.63-0.641-1.26-0.641\n                       c-0.546,0-1.093,0.084-1.639,0.252l-0.272,0.084V19.731z"\n                />\n                <path fill="', u += r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "color"), e.opts.autoescape), u += '"\n                    d="M96.531,11.625v8.106h-2.814v-8.106h-1.134V9.231h1.134V8.77c0-1.512,0.224-2.555,0.672-3.129\n                       s1.246-0.861,2.395-0.861c0.504,0,1.155,0.07,1.953,0.21l0.44,0.063l-0.042,2.289c-0.616-0.028-1.134-0.042-1.554-0.042\n                       s-0.7,0.112-0.84,0.336c-0.141,0.224-0.21,0.609-0.21,1.155v0.441h2.541v2.394H96.531z"\n                />\n                <path fill="', u += r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "color"), e.opts.autoescape), u += '"\n                    d="M108.753,12.507v4.368c0.028,0.337,0.084,0.571,0.168,0.704s0.259,0.228,0.525,0.283l-0.084,2.121\n                       c-0.714,0-1.285-0.049-1.712-0.146c-0.427-0.099-0.857-0.295-1.291-0.589c-1.008,0.49-2.037,0.735-3.087,0.735\n                       c-2.171,0-3.255-1.147-3.255-3.444c0-1.119,0.301-1.914,0.902-2.383c0.603-0.469,1.526-0.746,2.772-0.83l2.247-0.168v-0.651\n                       c0-0.434-0.099-0.731-0.294-0.893c-0.196-0.161-0.512-0.241-0.945-0.241l-3.948,0.168l-0.084-1.953\n                       c1.498-0.406,2.923-0.609,4.273-0.609c1.352,0,2.324,0.28,2.919,0.84C108.456,10.379,108.753,11.276,108.753,12.507z\n                       M104.028,15.279c-0.784,0.07-1.176,0.49-1.176,1.26c0,0.771,0.343,1.155,1.028,1.155c0.532,0,1.113-0.084,1.743-0.252l0.315-0.084\n                       v-2.247L104.028,15.279z"\n                />\n                <path fill="', u += r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "color"), e.opts.autoescape), u += '"\n                    d="M116.522,8.979c1.47,0,2.545,0.402,3.224,1.208s1.019,2.244,1.019,4.316c0,2.071-0.392,3.503-1.176,4.294\n                       s-2.136,1.187-4.053,1.187c-0.603,0-1.701-0.07-3.298-0.21l-0.798-0.084V5.031h2.814v4.515\n                       C115.15,9.168,115.906,8.979,116.522,8.979z M115.536,17.464c0.938,0,1.567-0.228,1.89-0.683s0.482-1.271,0.482-2.447\n                       c0-1.89-0.588-2.834-1.764-2.834c-0.56,0-1.092,0.07-1.596,0.21l-0.294,0.063v5.607C114.898,17.436,115.325,17.464,115.536,17.464z"\n                />\n            </g>\n        '), u += '\n\n        <g class="logo">\n            <path fill="', u += r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "logo_color"), e.opts.autoescape), u += '"\n                  d="M12.5,0.833C6.056,0.833,0.834,6.057,0.834,12.5S6.056,24.167,12.5,24.167S24.167,18.943,24.167,12.5\n                     S18.944,0.833,12.5,0.833z" />\n        </g>\n\n        <g id="logo-circle" class="logo-circle">\n            <path fill=', u += r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "circle_color"), e.opts.autoescape), u += '\n                d="M12.5-0.029C5.596-0.029,0,5.568,0,12.472c0,6.904,5.596,12.501,12.5,12.501s12.5-5.597,12.5-12.501\n                   C25.001,5.568,19.405-0.029,12.5-0.029z M11.414,19.911L6.025,16.8v-6.276l5.389,2.911V19.911z M12.374,11.958l-6.376-3.38\n                   l6.376-3.682l6.377,3.682L12.374,11.958z M18.755,16.812l-5.369,3.1v-6.452l5.369-2.901V16.812z"\n            />\n        </g>\n\n    </svg>\n\n', n = s, new r.SafeString(u)
                    });
                    t.addExport("logo"), t.setVariable("logo", d), u += "\n", l ? l.rootRenderFunc(e, t, n, r, a) : a(null, u)
                } catch (e) {
                    a(r.handleError(e, o, s))
                }
            }
            return {
                root: e
            }
        }()
    }()
}, , function (e, t, i) {
    "use strict";

    function n(e, t) {
        e.__withState.nextState = t
    }

    function r(e) {
        delete e.__withState.nextState
    }

    function a(e) {
        return e.__withState.nextState || e.state
    }
    var o = i(0),
        s = (i.n(o), i(30));
    t.a = {
        name: "WithState",
        state: {},
        constructor: function () {
            var e = this;
            this.__withState = {
                planRender: Object(s.e)(function (t) {
                    var i = a(e);
                    r(e), e.update(e.options, i, !0, t)
                })
            }
        },
        setState: function (e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1],
                i = a(this),
                r = Object(o.isFunction)(e) ? e(i) : e;
            n(this, Object(o.extend)({}, i, r)), this.__withState.planRender(t)
        }
    }
}, , , , function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(92),
        a = i(10),
        o = function (e, t, i, n) {
            r.a.call(this), this._x = void 0 !== e ? e : 0, this._y = void 0 !== t ? t : 0, this._width = void 0 !== i ? i : 800, this._height = void 0 !== n ? n : 600
        };
    n.a.createPrototypeStateAttribute(o, n.a.objectInherit(r.a.prototype, {
        attributeType: "Viewport",
        cloneType: function () {
            return new o
        },
        setViewport: function (e, t, i, n) {
            this._x = e, this._y = t, this._width = i, this._height = n
        },
        x: function () {
            return this._x
        },
        y: function () {
            return this._y
        },
        width: function () {
            return this._width
        },
        height: function () {
            return this._height
        },
        computeWindowMatrix: function () {
            var e = a.c.create(),
                t = a.c.create(),
                i = a.f.create();
            return function (n) {
                a.c.fromTranslation(e, a.f.ONE), a.c.fromScaling(t, [.5 * this._width, .5 * this._height, .5]);
                var r = a.c.fromTranslation(n, a.f.set(i, this._x, this._y, 0));
                return a.c.mul(r, r, a.c.mul(t, t, e))
            }
        }(),
        apply: function (e) {
            e.applyViewport(this)
        }
    }), "osg", "Viewport"), t.a = o
}, function (e, t, i) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: !0
    });
    var n = i(36),
        r = i(12),
        a = i(108),
        o = i(362),
        s = i(160),
        u = i(178),
        l = i(138),
        c = i(291),
        h = i(289),
        d = i(288),
        f = i(137),
        p = i(10),
        m = i(198),
        g = i(682),
        v = i(578),
        _ = {};
    _.ObjectWrapper = {}, _.ObjectWrapper.serializers = {}, _.readImage = function (e, t) {
        return _.registry().readImageURL(e, t)
    }, _.readImageURL = _.readImage, _.readBinaryArrayURL = function (e, t) {
        return _.registry().readBinaryArrayURL(e, t)
    }, _.readNodeURL = function (e, t) {
        var i = e.substr(e.lastIndexOf(".") + 1),
            n = v.a.instance().getReaderWriterForExtension(i);
        return void 0 !== n ? n.readNodeURL(e, t) : _.registry().readNodeURL(e, t)
    }, _.registry = function () {
        var e = i(690).default;
        return void 0 === _.registry._input && (_.registry._input = new e), _.registry._input
    }, _.parseSceneGraph = function (e, t) {
        if (!(void 0 !== e.Version && e.Version > 0)) {
            r.a.time("osgjs.metric:ReaderParser.parseSceneGraphDeprecated", n.a.INFO);
            var i = _.parseSceneGraphDeprecated(e);
            return r.a.timeEnd("osgjs.metric:ReaderParser.parseSceneGraphDeprecated", n.a.INFO), i
        }
        r.a.time("osgjs.metric:ReaderParser.parseSceneGraph", n.a.INFO);
        var a;
        for (var o in e)
            if ("Generator" !== o && "Version" !== o) {
                a = o;
                break
            } if (a) {
            var s = {};
            s[a] = e[a];
            var u = _.registry().clone();
            u.setJSON(s);
            var l = r.a.objectMix(r.a.objectMix({}, _.registry().getOptions()), t || {});
            u.setOptions(l);
            var c = u.readObject();
            return r.a.timeEnd("osgjs.metric:ReaderParser.parseSceneGraph", n.a.INFO), c
        }
        n.a.log("can't parse scenegraph " + e, n.a.INFO)
    }, _.parseSceneGraphDeprecated = function (e) {
        var t, v = function (e, t) {
                var i = t[e];
                return void 0 === i && (i = t[e.toLowerCase()]), i
            },
            b = function (e, t) {
                var i = v("Name", t);
                i && void 0 !== e.setName && e.setName(i)
            },
            S = function (e, t) {
                b(e, t), e.setAmbient(v("Ambient", t)), e.setDiffuse(v("Diffuse", t)), e.setEmission(v("Emission", t)), e.setSpecular(v("Specular", t)), e.setShininess(v("Shininess", t))
            },
            x = function (e, t) {
                b(e, t), e.setSourceRGB(t.SourceRGB), e.setSourceAlpha(t.SourceAlpha), e.setDestinationRGB(t.DestinationRGB), e.setDestinationAlpha(t.DestinationAlpha)
            },
            y = function (e, t) {
                var i = t.MagFilter || t.mag_filter || void 0;
                i && e.setMagFilter(i);
                var r = t.MinFilter || t.min_filter || void 0;
                r && e.setMinFilter(r);
                var a = t.WrapT || t.wrap_t || void 0;
                a && e.setWrapT(a);
                var o = t.WrapS || t.wrap_s || void 0;
                o && e.setWrapS(o);
                var s = v("File", t);
                _.readImage(s).then(function (t) {
                    e.setImage(t)
                }).catch(function () {
                    n.a.log("Can't read image")
                })
            },
            C = e.children,
            T = e._primitives || e.primitives || e.Primitives || void 0,
            w = e._attributes || e.attributes || e.Attributes || void 0;
        if (T || w) {
            var M = new s.a;
            b(M, e), M.stateset = e.stateset, e = M;
            for (var E = 0, A = T.length; E < A; E++) {
                var P = T[E].mode;
                if (T[E].indices) {
                    var R = T[E].indices;
                    R = new u.a(u.a[R.type], R.elements, R.itemSize), P = P ? l.a[P] : "TRIANGLES", M.getPrimitiveSetList().push(new h.a(P, R))
                } else {
                    P = l.a[P];
                    var O = T[E].first,
                        I = T[E].count;
                    M.getPrimitiveSetList().push(new c.a(P, O, I))
                }
            }
            for (var F in w) {
                var N = w[F];
                M.getVertexAttributeList()[F] = new u.a(N.type, N.elements, N.itemSize)
            }
        }
        var D = v("StateSet", e);
        if (D) {
            var L = new d.a;
            ! function (e, t) {
                b(e, t);
                var r = v("Textures", t) || v("TextureAttributeList", t) || void 0;
                if (r)
                    for (var s = 0, u = r.length; s < u; s++) {
                        var l = v("File", r[s]);
                        if (l) {
                            var c = i(118).default,
                                h = new c;
                            y(h, r[s]), e.setTextureAttributeAndModes(s, h), e.addUniform(a.a.createInt1(s, "Texture" + s))
                        } else n.a.log("no texture on unit " + s + " skip it")
                    }
                var d = v("BlendFunc", t);
                if (d) {
                    var f = new o.a;
                    x(f, d), e.setAttributeAndModes(f)
                }
                var p = v("Material", t);
                if (p) {
                    var m = i(859).default,
                        g = new m;
                    S(g, p), e.setAttributeAndModes(g)
                }
            }(L, D), e.stateset = L
        }
        var k = e.matrix || e.Matrix || void 0;
        k && (t = new m.a, b(t, e), r.a.extend(t, e), p.c.copy(t.getMatrix(), k), e = t);
        var V = e.projection || e.Projection || void 0;
        if (V && (t = new g.a, b(t, e), r.a.extend(t, e), p.c.copy(t.setProjectionMatrix(), V), e = t), void 0 === e.typeID && (t = new f.a, b(t, e), r.a.extend(t, e), e = t), C) {
            e.children = [];
            for (var B = 0, U = C.length; B < U; B++) e.addChild(_.parseSceneGraphDeprecated(C[B]))
        }
        return e
    }, t.default = _
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(152),
        a = i(119),
        o = n.a.osg,
        s = function () {
            o.StateAttribute.call(this), this._channelMapping = {}, this._materialModel = void 0, this._stateSetContext = void 0, this._additive = !1, this._depthWrite = !0, this._castShadows = !0, this._hashes = ["", ""], this._dirtyUniforms = !0, this._activeChannels = []
        };
    s.SHADING_COMPILER = 0, s.EARLYZ_COMPILER = 1, s.SHADOWCAST_COMPILER = 2, s.WIREFRAME_COMPILER = 3, s.CURRENT_COMPILER = s.SHADING_COMPILER, s.compilerChannels = [], s.compilerChannels[s.SHADING_COMPILER] = r.a, s.compilerChannels[s.EARLYZ_COMPILER] = ["Opacity", "Displacement", "SubsurfaceScattering"], s.compilerChannels[s.SHADOWCAST_COMPILER] = ["Displacement", "Opacity"], s.compilerChannels[s.WIREFRAME_COMPILER] = ["Displacement"], s.hasVertexColor = !1, s.hasVertexAlpha = !1, o.createPrototypeStateAttribute(s, o.objectInherit(o.StateAttribute.prototype, {
        attributeType: "SketchfabMaterial",
        dirtyMaterial: function () {
            for (var e = this._hashes.length, t = 0; t < e; ++t) this._hashes[t] = "";
            this._dirtyUniforms = !0
        },
        getHash: function () {
            if (!this._materialModel) return "";
            var e = this._hashes[s.CURRENT_COMPILER];
            if (e) return e;
            e = this.attributeType, s.CURRENT_COMPILER !== s.WIREFRAME_COMPILER && (e += this.getVertexAlphaEnable() ? "1" : "0"), s.CURRENT_COMPILER === s.SHADING_COMPILER && (e += this.getShadeless() ? "1" : "0", e += this.getVertexColorEnable() ? "1" : "0", e += this.getHasOnlyPoints() ? "1" : "0", e += "srgb" === this.getVertexColorColorSpace() ? "1" : "0", e += a.a.get("hasSsr") ? "1" : "0");
            for (var t = s.CURRENT_COMPILER === s.SHADOWCAST_COMPILER, i = this._materialModel.getChannels(), n = s.compilerChannels[s.CURRENT_COMPILER], r = n.length, o = this._channelMapping, u = 0; u < r; ++u) {
                var l = n[u],
                    c = i[l];
                if (c.isEnableEffective())
                    if (!t || this._castShadows) {
                        var h = o[l];
                        e += ".", e += h < 0 ? "" : h, e += c.getShaderHash(), e += this.getChannelPacking(l)
                    } else e += ".0";
                else e += ".0"
            }
            return this._hashes[s.CURRENT_COMPILER] = e, e
        },
        setMaterialModel: function (e) {
            this._materialModel = e
        },
        setStateSetContext: function (e) {
            this._stateSetContext = e
        },
        setChannelMapping: function (e, t) {
            this._channelMapping[e] = t
        },
        getChannelPacking: function (e) {
            return this._stateSetContext ? this._stateSetContext.getChannelPacking(e) : ""
        },
        updateOpacity: function () {
            this._additive = !1, this._depthWrite = !0, this._castShadows = !0;
            var e = this._materialModel.getChannels().Opacity;
            if (e.isEffective()) {
                var t = e.getTransparency();
                if ("alphaMask" !== t && "dithering" !== t) {
                    if ("additive" === t) return this._additive = !0, this._depthWrite = !1, void(this._castShadows = !1);
                    var i = !1;
                    return 1 === e.getFactor() && (i = e.getTextureModel() || this.getVertexAlphaEnable()), i ? void 0 : (this._depthWrite = !1, void(this._castShadows = !1))
                }
            }
        },
        cloneType: function () {
            return new s
        },
        getType: function () {
            return this.attributeType
        },
        getTypeMember: function () {
            return this.attributeType
        },
        getMaterialModel: function () {
            return this._materialModel
        },
        getShadeless: function () {
            return this._materialModel && this._materialModel.get("shadeless")
        },
        getReflection: function () {
            return this._materialModel && this._materialModel.get("reflection")
        },
        getVertexColorEnable: function () {
            return this._materialModel && this._materialModel.get("vertexColorEnable")
        },
        getVertexAlphaEnable: function () {
            return this._materialModel && this._materialModel.get("vertexAlphaEnable")
        },
        getVertexColorColorSpace: function () {
            return this._materialModel && this._materialModel.get("vertexColorColorSpace")
        },
        getCullFace: function () {
            return this._materialModel && this._materialModel.get("cullFace")
        },
        getHasOnlyPoints: function () {
            return this._materialModel && this._materialModel.hasOnlyPoints()
        },
        getAdditive: function () {
            return this._additive
        },
        getDepthWrite: function () {
            return this._depthWrite
        },
        getCastShadows: function () {
            return this._castShadows
        },
        getChannelMapping: function (e) {
            return this._channelMapping[e]
        },
        getOrCreateUniforms: function () {
            if (s.uniforms) return s.uniforms;
            var e = s.uniforms = {};
            e.uReflection = o.Uniform.createFloat("uReflection");
            for (var t = i(707).default, n = r.a.length, a = 0; a < n; ++a) {
                var u = r.a[a],
                    l = t[u].model;
                l.prototype.addUniforms.call(l, e, u)
            }
            return e
        },
        _cacheChannelUniforms: function () {
            var e = this.getOrCreateUniforms(),
                t = this._materialModel.getChannels(),
                i = r.a.length,
                n = this._activeChannels;
            n.length = 0;
            for (var a = 0; a < i; ++a) {
                var o = t[r.a[a]];
                o.isEnableEffective() && (o.cacheUniforms(e), n.push(o))
            }
        },
        apply: function () {
            if (this._materialModel) {
                this._dirtyUniforms && (this._dirtyUniforms = !1, this._cacheChannelUniforms());
                this.getOrCreateUniforms().uReflection.setFloat(this.getReflection());
                for (var e = this._activeChannels, t = e.length, i = 0; i < t; ++i) e[i].updateUniforms()
            }
        }
    }), "osgSketchfab", "Material"), t.a = s
}, function (e, t, i) {
    var n = i(1340),
        r = function (e) {
            e = e || "", e = decodeURIComponent(e);
            var t = {};
            return e.split("&").forEach(function (e) {
                if (e.indexOf("=") > -1) {
                    var i = e.split("=");
                    t[i[0]] = i[1]
                } else t = e.indexOf(",") > -1 ? e.split(",") : e
            }.bind(this)), t
        },
        a = function (e, t) {
            var i = e;
            i.indexOf("#") > -1 && (i = i.slice(1));
            var n = i.split(";"),
                r = [];
            for (var a in n) {
                var u = new s(o(n[a]));
                u.from && u.from === t || !u.data || r.push(u)
            }
            return r
        },
        o = function (e) {
            var t = e,
                i = {};
            t.indexOf("#") > -1 && (t = t.slice(1));
            var n = t.split(":");
            return 1 === n.length ? i.data = n[0] : 2 === n.length ? (i.from = n[0].toUpperCase(), i.data = n[1]) : 3 === n.length && (i.from = n[0].toUpperCase(), i.to = n[1].toUpperCase(), i.data = n[2]), i.data && (i.stringData = i.data, i.data = r(i.data)), i._originalString = e + ";", i
        },
        s = function (e) {
            var t = e;
            "string" == typeof e && (t = o(e)), this._msg = t, this.from = t.from, this.to = t.to, this.data = u(t.data)
        },
        u = function (e) {
            return "string" == typeof e ? e = decodeURIComponent(e) : Array.isArray(e) ? e = e.map(decodeURIComponent) : "object" === (typeof e).toLowerCase() && Object.keys(e).forEach(function (t) {
                "string" == typeof e[t] ? e[t] = decodeURIComponent(e[t]) : Array.isArray(e[t]) && (e[t] = e[t].map(decodeURIComponent))
            }.bind(this)), e
        };
    s.prototype._getStringifiedData = function () {
        var e = "";
        if ("string" == typeof this.data) return encodeURIComponent(this.data);
        if (Array.isArray(this.data)) return this.data.map(encodeURIComponent).join(",");
        if ("object" == typeof this.data)
            for (var t in this.data) {
                var i;
                "string" == typeof this.data[t] ? i = encodeURIComponent(this.data[t]) : Array.isArray(this.data[t]) && (i = this.data[t].map(encodeURIComponent).join(",")), e += t + "=" + i
            }
        return e
    }, s.prototype.toString = function () {
        var e = "";
        return this.from && (e += this.from + ":"), this.to && (e += this.to + ":"), e += this._getStringifiedData() + ";"
    };
    var l = function (e) {
        if (e = e || {}, !e.device) throw new Error('ViewerHashAPI options need to contain the "device" identifier property');
        e.listen && this.listen(e.listen), this.device = e.device
    };
    l.prototype.appendToHash = function (e, t) {
        e instanceof s && (e = e.toString()), "string" == typeof e && (t = c(t), -1 === t.location.hash.indexOf(e) && (t.location.hash = t.location.hash + e))
    }, l.prototype.removeFromHash = function (e, t) {
        if (!(e instanceof s)) throw new Error("Please supply an instance of ViewerHashMessage");
        t = c(t);
        var i = t.location.hash;
        i = e._msg && e._msg._originalString ? i.replace(e._msg._originalString, "") : i.replace(e.toString(), ""), t.location.hash = i
    };
    var c = function (e) {
        if (e = (!0 === e ? window : e) || window, e && e.tagName && "iframe" === e.tagName.toLowerCase() && (e = e.contentWindow), !e.addEventListener) throw new Error("Could not bind an event to supplied target. Please supply an instance of window or an iframe.");
        return e
    };
    l.prototype.listen = function (e) {
        return e = c(e), e.addEventListener("hashchange", this._onHashChange.bind(this, e), !1)
    }, l.prototype._onHashChange = function (e) {
        (this.getMessages(e.location.hash).messages || []).forEach(function (e) {
            if (e)
                if (e.data && !Array.isArray(e)) {
                    var t = e.data;
                    if ("object" == typeof e.data) {
                        var i = Object.keys(e.data);
                        t = e.data._key ? e.data._key : i[0]
                    }
                    t && this.trigger("message:" + t, e)
                } else this.trigger("message", e)
        }.bind(this))
    }, l.prototype.getMessages = function (e) {
        var t = a(e, this.device),
            i = e;
        for (var n in t) i = t[n]._msg && t[n]._msg._originalString ? i.replace(t[n]._msg._originalString, "") : i.replace(t[n].toString(), "");
        return {
            messages: t,
            hash: i
        }
    }, l.prototype.createMessage = function (e) {
        return e = e || {}, e.from = this.device, new s(e)
    }, n.mixin(l.prototype), s.prototype.removeFromHash = function () {
        l.prototype.removeFromHash.call(this, this)
    }, s.prototype.appendToHash = function () {
        l.prototype.appendToHash.call(this, this)
    }, e.exports = l
}, , , , , function (e, t) {}, , , , , , , , , function (e, t, i) {
    "use strict";
    var n = {
            STRIP: Uint16Array,
            TRIANGLES: Uint16Array,
            VERTEX: Float32Array,
            NORMAL: Float32Array,
            COLOR: Float32Array
        },
        r = function (e) {
            for (var t in e) {
                var i = e[t];
                e[t] = i.length ? new n[t](i) : r(i)
            }
            return e
        };
    t.a = {
        getBaseVR: function (e) {
            i.e(15).then(function () {
                e(i(1709).default)
            }.bind(null, i)).catch(i.oe)
        },
        getVrBrowserAssets: function (e) {
            i.e(17).then(function () {
                e(i(1710).default)
            }.bind(null, i)).catch(i.oe)
        },
        getControllerVive: function (e) {
            i.e(21).then(function () {
                e(r(i(1711).default))
            }.bind(null, i)).catch(i.oe)
        },
        getControllerDaydream: function (e) {
            i.e(24).then(function () {
                e(r(i(1712).default))
            }.bind(null, i)).catch(i.oe)
        },
        getControllerOculusTouch: function (e) {
            i.e(22).then(function () {
                e(r(i(1713).default))
            }.bind(null, i)).catch(i.oe)
        },
        getControllerOculusGo: function (e) {
            i.e(23).then(function () {
                e(r(i(1714).default))
            }.bind(null, i)).catch(i.oe)
        },
        getControllerWin: function (e) {
            i.e(20).then(function () {
                e(r(i(1715).default))
            }.bind(null, i)).catch(i.oe)
        },
        getHuman: function (e) {
            i.e(19).then(function () {
                e(r(i(1716).default))
            }.bind(null, i)).catch(i.oe)
        }
    }
}, , , , , function (e, t, i) {
    "use strict";
    var n = i(7),
        r = i.n(n),
        a = i(41),
        o = i(2),
        s = i(28),
        u = i(74),
        l = i(1),
        c = i(55),
        h = i(43),
        d = i(607);
    i.n(d);
    t.a = a.a.extend({
        displayName: "Dropdown",
        mixins: [Object(c.a)('[data-ref="menu"]'), h.a],
        optionTypes: {
            child: l.b.component.isRequired,
            labelTitle: l.b.string,
            labelValue: l.b.string,
            longestLabelValue: l.b.string,
            placeholder: l.b.string,
            color: l.b.string,
            className: l.b.string,
            theme: l.b.oneOf(["dark", "light", "white-background", "grey-background"]),
            menuAlign: l.b.oneOf(["left", "right"]),
            disabled: l.b.bool,
            withBackground: l.b.bool,
            grey: l.b.bool
        },
        defaultOptions: {
            color: "",
            theme: "light",
            menuAlign: "left",
            disabled: !1,
            withBackground: !1,
            grey: !1
        },
        events: {
            'click [data-action="toggle-menu"]:not([data-disabled="true"])': "onToggle",
            "click window": "onWindowClick",
            "resize window": "setMenuPosition"
        },
        state: {
            isOpen: !1
        },
        viewDidMount: function () {
            this.setMenuPosition()
        },
        viewDidUpdate: function () {
            this.setMenuPosition()
        },
        onToggle: function () {
            this.setState({
                isOpen: !this.state.isOpen
            })
        },
        onWindowClick: function (e) {
            !Object(s.e)(this.el, e.target) && this.state.isOpen && this.setState({
                isOpen: !1
            })
        },
        setMenuPosition: function () {
            var e = this.el.getBoundingClientRect(),
                t = this.refs.menu.getBoundingClientRect();
            this.refs.$menu.css({
                bottom: -Math.min(0, window.innerHeight - (e.bottom + t.height + 10)),
                right: "right" === this.options.menuAlign ? Math.min(0, e.right - (t.width + 10)) : "auto",
                left: "left" === this.options.menuAlign ? Math.min(0, window.innerWidth - (e.left + t.width + 10)) : "auto"
            })
        },
        scrollToHeightPercent: function (e) {
            var t = this.refs.$menu.prop("scrollHeight");
            this.refs.$menu.scrollTop(Object(u.b)(0, 1, e) * t)
        },
        template: function () {
            var e = this;
            return o.default.getFromMacro("skfb_front/macros/components/atoms/dropdown", "dropdown", [{
                isOpen: this.state.isOpen && !this.options.disabled,
                labelTitle: this.options.labelTitle,
                labelValue: this.options.labelValue,
                longestLabelValue: this.options.longestLabelValue,
                placeholder: this.options.placeholder,
                color: this.options.color,
                disabled: this.options.disabled,
                withBackground: this.options.withBackground,
                grey: this.options.grey,
                theme: this.options.theme,
                className: this.options.className,
                components: this.createChildrenComponents({
                    child: [].concat(this.options.child).map(function (t, i) {
                        return r()({}, t, {
                            options: r()({}, t.options, {
                                key: t.options.key || i,
                                dropdown: {
                                    isOpen: e.state.isOpen,
                                    onToggle: e.onToggle.bind(e),
                                    scrollToHeightPercent: e.scrollToHeightPercent.bind(e)
                                }
                            })
                        })
                    })
                })
            }])
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = n.a.osg,
        a = [0, 0],
        o = {
            init: function (e, t, i) {
                this._qualityModel = t, this._canvasPixelRatio = i, this._canvas = e, this._pixelRatio = [1, 1]
            },
            getCanvasCoord: function (e, t) {
                if (t = t || a, e.center || e.touches) {
                    if (e.center) t[0] = e.center.x, t[1] = e.center.y;
                    else {
                        t[0] = t[1] = 0;
                        for (var i = e.touches.length, n = 0; n < i; ++n) t[0] += e.touches[n].clientX / i, t[1] += e.touches[n].clientY / i
                    }
                    var r = e.target.getBoundingClientRect();
                    t[0] += -r.left, t[1] += -r.top
                } else t[0] = void 0 === e.offsetX ? e.layerX : e.offsetX, t[1] = void 0 === e.offsetY ? e.layerY : e.offsetY;
                return t
            },
            getPixelRatio: function () {
                var e = this._qualityModel.get("dynamicResolutionScaling");
                return this._pixelRatio[0] = this._canvasPixelRatio * e[0], this._pixelRatio[1] = this._canvasPixelRatio * e[1], this._pixelRatio
            },
            canvasCoordToGL: function (e, t, i) {
                var n = this._canvas,
                    a = i || r.vec2.create(),
                    o = this.getPixelRatio();
                return a[0] = e * o[0], a[1] = (n.clientHeight - t) * o[1], a
            },
            glCoordToCanvas: function (e, t, i) {
                var n = this._canvas,
                    a = i || r.vec2.create(),
                    o = this.getPixelRatio();
                return a[0] = e / o[0], a[1] = n.clientHeight - t / o[1], a
            }
        };
    t.a = o
}, function (e, t, i) {
    i(37), i(15), i(127), i(16), i(415),
        function () {
            (window.nunjucksPrecompiled = window.nunjucksPrecompiled || {})["skfb_front/macros/viewer.jinja"] = function () {
                function e(e, t, n, r, a) {
                    var o = null,
                        s = null,
                        u = "";
                    try {
                        var l = null;
                        e.getTemplate("skfb_front/macros/buttons.jinja", !1, "skfb_front/macros/viewer.jinja", !1, function (c, h) {
                            if (c) return void a(c);
                            h.getExported(function (c, h) {
                                if (c) return void a(c);
                                if (!h.hasOwnProperty("star_like_button")) return void a(new Error("cannot import 'star_like_button'"));
                                var d = h.star_like_button;
                                t.setVariable("star_like_button", d), u += "\n", e.getTemplate("skfb_front/macros/model.jinja", !1, "skfb_front/macros/viewer.jinja", !1, function (c, h) {
                                    if (c) return void a(c);
                                    h.getExported(function (c, h) {
                                        if (c) return void a(c);
                                        if (!h.hasOwnProperty("model_name")) return void a(new Error("cannot import 'model_name'"));
                                        var d = h.model_name;
                                        t.setVariable("model_name", d), u += "\n", e.getTemplate("skfb_front/macros/popovers.jinja", !1, "skfb_front/macros/viewer.jinja", !1, function (c, h) {
                                            if (c) return void a(c);
                                            h.getExported(function (c, h) {
                                                if (c) return void a(c);
                                                if (!h.hasOwnProperty("share_popover")) return void a(new Error("cannot import 'share_popover'"));
                                                var d = h.share_popover;
                                                t.setVariable("share_popover", d), u += "\n", e.getTemplate("skfb_front/macros/user.jinja", !1, "skfb_front/macros/viewer.jinja", !1, function (c, h) {
                                                    if (c) return void a(c);
                                                    h.getExported(function (c, h) {
                                                        if (c) return void a(c);
                                                        if (!h.hasOwnProperty("user_name")) return void a(new Error("cannot import 'user_name'"));
                                                        var d = h.user_name;
                                                        t.setVariable("user_name", d), u += "\n", e.getTemplate("skfb_front/macros/user.jinja", !1, "skfb_front/macros/viewer.jinja", !1, function (c, h) {
                                                            if (c) return void a(c);
                                                            h.getExported(function (c, h) {
                                                                if (c) return void a(c);
                                                                if (!h.hasOwnProperty("user_avatar")) return void a(new Error("cannot import 'user_avatar'"));
                                                                var d = h.user_avatar;
                                                                t.setVariable("user_avatar", d), u += "\n", e.getTemplate("skfb_front/macros/logo.jinja", !1, "skfb_front/macros/viewer.jinja", !1, function (c, h) {
                                                                    if (c) return void a(c);
                                                                    h.getExported(function (c, h) {
                                                                        if (c) return void a(c);
                                                                        if (!h.hasOwnProperty("logo")) return void a(new Error("cannot import 'logo'"));
                                                                        var d = h.logo;
                                                                        t.setVariable("logo", d), u += "\n\n\n";
                                                                        var f = r.makeMacro(["authUser", "model"], ["options"], function (i, a, u) {
                                                                            var l = n;
                                                                            n = new r.Frame, u = u || {}, u.hasOwnProperty("caller") && n.set("caller", u.caller), n.set("authUser", i), n.set("model", a), n.set("options", u.hasOwnProperty("options") ? u.options : {});
                                                                            var c = "";
                                                                            return c += '\n\n    <div class="titlebar">\n\n        <div class="summary">\n            ', r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiInfos") && (c += '\n                <div class="avatar">\n                    <a target="_blank" href="/models/', c += r.suppressValue(r.memberLookup(a, "uid"), e.opts.autoescape), c += '">', c += r.suppressValue((o = 15, s = 78, r.callWrap(r.contextOrFrameLookup(t, n, "user_avatar"), "user_avatar", t, [r.memberLookup(r.memberLookup(a, "user"), "avatars"), {
                                                                                size: 32
                                                                            }])), e.opts.autoescape), c += '</a>\n                </div>\n                <div class="model-info">\n                    <h1 class="title">', c += r.suppressValue((o = 18, s = 49, r.callWrap(r.contextOrFrameLookup(t, n, "model_name"), "model_name", t, [i, a, {
                                                                                target: "_blank",
                                                                                withRestrictedFlag: !1
                                                                            }])), e.opts.autoescape), c += '</h1>\n                    <h2>by <a target="_blank" href="/models/', c += r.suppressValue(r.memberLookup(a, "uid"), e.opts.autoescape), c += '">', c += r.suppressValue(r.memberLookup(r.memberLookup(a, "user"), "displayName"), e.opts.autoescape), c += "</a></h2>\n                </div>\n            "), c += '\n        </div>\n\n        <div class="actions">\n\n            ', r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiInfos") && (r.memberLookup(a, "isDownloadable") || r.memberLookup(a, "inStore")) && (c += '\n                <a class="help tooltip tooltip-down download" data-tooltip="Download" target="_blank" href="/models/', c += r.suppressValue(r.memberLookup(a, "uid"), e.opts.autoescape), c += '#download">\n                    <i class="icon fa fa-download"></i>\n                </a>\n            '), c += "\n\n            ", r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiInfos") && (c += '\n                <a class="help tooltip tooltip-down share" data-tooltip="Share" data-action="open-share-overlay">\n                    <i class="custom-icons icon-ion-android-share-alt-icon"></i>\n                </a>\n            '), c += "\n\n            ", r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiStop") && (c += '\n                <a class="help tooltip tooltip-down close hidden" data-tooltip="Stop" data-action="stop">\n                    <i class="custom-icons icon-ion-close-round-icon"></i>\n                </a>\n            '), c += "\n\n        </div>\n\n    </div>\n\n", n = l, new r.SafeString(c)
                                                                        });
                                                                        t.addExport("viewer_infos"), t.setVariable("viewer_infos", f), u += "\n\n";
                                                                        var p = r.makeMacro(["message"], [], function (t, i) {
                                                                            var a = n;
                                                                            n = new r.Frame, i = i || {}, i.hasOwnProperty("caller") && n.set("caller", i.caller), n.set("message", t);
                                                                            var o = "";
                                                                            return o += '\n    <div class="viewer">\n        <div class="osd active">\n            <div class="content">\n                <div class="panel">\n                    <p>', o += r.suppressValue(t, e.opts.autoescape), o += "</p>\n                </div>\n            </div>\n        </div>\n    </div>\n", n = a, new r.SafeString(o)
                                                                        });
                                                                        t.addExport("viewer_message"), t.setVariable("viewer_message", p), u += "\n\n";
                                                                        var m = r.makeMacro(["authUser", "model"], ["options", "display_status"], function (i, a, u) {
                                                                            var l = n;
                                                                            n = new r.Frame, u = u || {}, u.hasOwnProperty("caller") && n.set("caller", u.caller), n.set("authUser", i), n.set("model", a), n.set("options", u.hasOwnProperty("options") ? u.options : {}), n.set("display_status", u.hasOwnProperty("display_status") ? u.display_status : "ok");
                                                                            var c = "";
                                                                            return c += "\n\n    ", "deleted" == r.contextOrFrameLookup(t, n, "display_status") ? (c += "\n        ", c += r.suppressValue((o = 65, s = 23, r.callWrap(r.contextOrFrameLookup(t, n, "viewer_message"), "viewer_message", t, ["This model has been deleted"])), e.opts.autoescape), c += "\n\n    ") : "disabled" == r.contextOrFrameLookup(t, n, "display_status") ? (c += "\n        ", c += r.suppressValue((o = 68, s = 23, r.callWrap(r.contextOrFrameLookup(t, n, "viewer_message"), "viewer_message", t, ["This model has been disabled"])), e.opts.autoescape), c += "\n\n    ") : "unsupported" == r.contextOrFrameLookup(t, n, "display_status") ? (c += "\n        ", c += r.suppressValue((o = 71, s = 23, r.callWrap(r.contextOrFrameLookup(t, n, "viewer_message"), "viewer_message", t, ["Password-protected models are not supported through the Viewer API"])), e.opts.autoescape), c += "\n\n    ") : "draft" == r.contextOrFrameLookup(t, n, "display_status") ? (c += "\n        ", c += r.suppressValue((o = 74, s = 23, r.callWrap(r.contextOrFrameLookup(t, n, "viewer_message"), "viewer_message", t, ["This model has not been published yet"])), e.opts.autoescape), c += "\n\n    ") : "ok" == r.contextOrFrameLookup(t, n, "display_status") && (c += "\n        ", c += r.suppressValue((o = 77, s = 20, r.callWrap(r.contextOrFrameLookup(t, n, "show_viewer"), "show_viewer", t, [i, a, r.contextOrFrameLookup(t, n, "options")])), e.opts.autoescape), c += "\n\n    "), c += "\n\n", n = l, new r.SafeString(c)
                                                                        });
                                                                        t.addExport("viewer"), t.setVariable("viewer", m), u += "\n\n";
                                                                        var g = r.makeMacro(["authUser", "model"], ["options"], function (i, a, u) {
                                                                            var l = n;
                                                                            n = new r.Frame, u = u || {}, u.hasOwnProperty("caller") && n.set("caller", u.caller), n.set("authUser", i), n.set("model", a), n.set("options", u.hasOwnProperty("options") ? u.options : {});
                                                                            var c = "";
                                                                            return c += '\n\n    <div class="viewer has-model ', r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "transparent") && (c += " transparent"), r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "autostart") && (c += " started"), c += '">\n\n        ', c += r.suppressValue((o = 87, s = 21, r.callWrap(r.contextOrFrameLookup(t, n, "viewer_infos"), "viewer_infos", t, [i, a, r.contextOrFrameLookup(t, n, "options")])), e.opts.autoescape), c += '\n\n        <div class="landing" data-action="start">\n\n            <div class="preview">\n                ', c += r.suppressValue(e.getFilter("image_container").call(t, r.memberLookup(a, "thumbnails"), 1024, 768, !0, !0), e.opts.autoescape), c += '\n            </div>\n\n            <div class="start-button">\n                <button class="play">\n                    <i class="fa fa-play"></i>\n                    <span class="label">3D</span>\n                </button>\n            </div>\n\n            ', c += r.suppressValue((o = 102, s = 23, r.callWrap(r.contextOrFrameLookup(t, n, "watermark"), "watermark", t, [a, r.contextOrFrameLookup(t, n, "options")])), e.opts.autoescape), c += '\n\n        </div>\n\n        <div class="overlays">\n            ', r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "restricted") && (c += '\n                <div class="overlay restricted">\n                    <div>\n                        <h3 class="heading">Age-restricted content</h3>\n                        <p>\n                            This 3D model contains age-restricted content.<br/>\n                            You need to enable age-restricted content to view this.\n                        </p>\n                        <button type="submit" class="button btn-input btn-primary submit" data-action="allowRestricted">Enable age-restricted content</button>\n                        ', c += r.suppressValue((o = 116, s = 29, r.callWrap(r.contextOrFrameLookup(t, n, "logo"), "logo", t, [121, 25, {
                                                                                color: "#ffffff"
                                                                            }])), e.opts.autoescape), c += "\n                    </div>\n                </div>\n            "), c += '\n            <div class="overlay help hidden">\n                <a href="#" class="close custom-icons icon-ion-close-round-icon"></a>\n                <div class="inner">\n                    <ul class="tabs">\n                        <li class="active"><a href="#" data-target="basic">Navigation basics</a></li>\n                        <li><a href="#" data-target="all">All controls</a></li>\n                    </ul>\n                    <div class="tabs-container">\n                        <div class="tab active" data-tab="basic">\n                            <div class="tip">\n                                <div>\n                                    <i class="fa fa-refresh"></i>\n                                </div>\n                                <div>\n                                    <b>Orbit around</b>\n                                    <div>\n                                        Left click + drag or<br>\n                                        One finger drag (touch)\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="tip">\n                                <div>\n                                    <i class="fa fa-search-plus"></i>\n                                </div>\n                                <div>\n                                    <b>Zoom</b>\n                                    <div>\n                                        Double click on model<br>\n                                        or scroll anywhere or<br>\n                                        Pinch (touch)\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="tip">\n                                <div>\n                                    <i class="fa fa-arrows"></i>\n                                </div>\n                                <div>\n                                    <b>Pan</b>\n                                    <div>\n                                        Right click + drag or<br />\n                                        Two fingers drag (touch)\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        <div class="tab" data-tab="all">\n                            <div>\n                                <div class="section">\n                                    <h2>Orbit navigation</h2>\n                                    <b>Move camera:</b> 1 finger drag or Left Mouse Button<br>\n                                    <b>Pan:</b> 2-finger drag or Right Mouse Button or <kbd>SHIFT</kbd>+ Left Mouse Button<br>\n                                    <b>Zoom on object:</b> Double-tap or Double-click on object<br>\n                                    <b>Zoom out:</b> Double-tap or Double-click on background<br>\n                                    <b>Zoom:</b> Pinch in/out or Mousewheel or <kbd>CTRL</kbd> + Left Mouse Button<br>\n                                </div>\n                                <div class="section">\n                                    <h2>First-person navigation</h2>\n                                    <b>Move:</b> <kbd>↑</kbd>,<kbd>←</kbd>,<kbd>↓</kbd>,<kbd>→</kbd> (or <kbd>W</kbd>,<kbd>A</kbd>,<kbd>S</kbd>,<kbd>D</kbd>)<br>\n                                    <b>Look around:</b> 1-finger drag or Left Mouse Button<br>\n                                    <b>Adjust speed:</b> Mousewheel<br>\n                                </div>\n                                <div class="section rendering-shortcuts"></div>\n                                <div class="section">\n                                    <h2>Lighting</h2>\n                                    <b>Rotate lighting:</b> 3-finger drag or <kbd>ALT</kbd> + Left Mouse Button<br>\n                                    <b>Rotate env. only:</b> <kbd>ALT</kbd> + <kbd>SHIFT</kbd> + Left Mouse Button<br>\n                                </div>\n                                <div class="section annotation-shortcuts"></div>\n                                <div class="section animation-shortcuts"></div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="action">\n                        <button class="button" data-action="reset-camera">Reset camera view</button>\n                    </div>\n\n                </div>\n            </div>\n            <div class="overlay share hidden">\n                <a href="#" class="close custom-icons icon-ion-close-round-icon"></a>\n                <div class="inner">\n                    <div class="share-link">\n                        <div class="text-field">\n                            <label>Link</label>\n                            <input type="text" class="text" value="" readonly>\n                            <button data-clipboard-target=".text-field .text">copy</button>\n                        </div>\n                    </div>\n                    <div class="share-social">\n                        <a data-action="share-on-facebook" target="_blank"><i class="fa fa-facebook"></i></a>\n                        <a data-action="share-on-twitter" target="_blank"><i class="fa fa-twitter"></i></a>\n                        <a data-action="share-on-reddit" target="_blank"><i class="fa fa-reddit"></i></a>\n                        <a data-action="share-on-tumblr" target="_blank"><i class="fa fa-tumblr"></i></a>\n                        <a data-action="share-on-google-plus" target="_blank"><i class="fa fa-google-plus"></i></a>\n                        <a data-action="share-on-linkedin" target="_blank"><i class="fa fa-linkedin"></i></a>\n                        <a data-action="share-on-pinterest" target="_blank"><i class="fa fa-pinterest"></i></a>\n                        <a class="share-mail" target="_blank"><i class="fa fa-envelope"></i></a>\n                    </div>\n                    <div class="share-embed">\n                        <a class="button" href="" target="_blank">\n                            <i class="fa fa-code"></i> Embed\n                        </a>\n                    </div>\n                </div>\n            </div>\n            <div class="overlay hotspots-overlay hidden">\n                <a href="#" class="close custom-icons icon-ion-close-round-icon"></a>\n                <div class="inner">\n                    <h4 class="hotspot-title"></h4>\n                    <div class="hotspot-content js-scrollable markdown-rendered-content"></div>\n                </div>\n            </div>\n            <div class="overlay helper-vr-overlay hidden">\n                <i class="custom-icons icon-ion-close-round-icon close"></i>\n                <div class="inner custom-scrollbar">\n                     <div class="header-helper">\n                        To view this model in virtual reality:\n                    </div>\n                    <div class="content-helper">\n                        <div class="row-helper">\n                            <div class="content-row">\n                                <div class="image"><i class="fa fa-mobile"></i></div>\n                                <div class="text">\n                                    <div class="title">on mobile phone</div>\n                                    <div>with Cardboard or similar</div>\n                                </div>\n                            </div>\n                            <ul class="info">\n                                <li>On your mobile, open this link: <a class="url" target="_blank" href="#"></a></li>\n                                <li>Press the VR icon</li>\n                                <li>Insert your mobile in a Cardboard headset</li>\n                            </ul>\n                        </div>\n                        <div class="row-helper">\n                            <div class="content-row">\n                                <div class="image"><i class="fa fa-desktop"></i></div>\n                                <div class="text">\n                                    <div class="title">on desktop PC <span class="flag --info">BETA</span></div>\n                                    <div>with a VR headset</div>\n                                </div>\n                            </div>\n                            <ul class="info">\n                                <li><a href="https://webvr.info/" target="_blank" rel="noopener noreferrer nofollow">Get a WebVR-compatible browser</a></li>\n                                <li>Enable WebVR</li>\n                                <li>Open this model</li>\n                                <li>Click on the VR icon</li>\n                            </ul>\n                        </div>\n                    </div>\n                    <div class="footer-helper">\n                        <a href="https://help.sketchfab.com/hc/en-us/articles/204777439-Mobile-VR-and-Desktop-WebVR?utm_source=website&amp;utm_campaign=vr_hints" target="_blank">\n                        More info on Virtual reality.\n                        </a>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div class="webgl">\n\n            <canvas class="canvas" data-modelUid="', c += r.suppressValue(r.memberLookup(a, "uid"), e.opts.autoescape), c += '" data-action="create-hotspot">\n            </canvas>\n\n            <div class="loading-container">\n                <div class="secondary-progress">\n                    <div class="secondary-progress-percentage"></div>\n                    <div class="secondary-progress-display"></div>\n                </div>\n                <div class="main-progress">\n                    <img src="', c += r.suppressValue(e.getFilter("best_fit").call(t, r.memberLookup(a, "thumbnails"), 64, 36), e.opts.autoescape), c += '" class="loading-thumbnail" />\n                    <div class="main-progress-wrapper">\n                        <div class="main-progress-percentage loading-percentage">0%</div>\n                        <p>Loading 3D model</p>\n                        <div class="main-progress-display">\n                            <div class="main-progress-display__progress"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div class="hotspots"></div>\n\n            <div class="gui">\n\n                <div class="animation-not-supported hidden">\n                    <a href="#" class="close"></a>\n                    <p>Model is too heavy for your device and can not be rendered properly</p>\n                </div>\n\n                ', r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiControls") && r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiAnnotations") && (c += '\n                    <div class="hotspot-controls-responsive">\n                        <div data-title="Previous Annotation" data-action="prev-annotation">\n                            <div class="icon fa fa-caret-left"></div>\n                        </div>\n                        <div data-title="Next Annotation" data-action="next-annotation">\n                            <div class="icon fa fa-caret-right"></div>\n                        </div>\n                    </div>\n                '), c += "\n\n                ", r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiInspector") && (c += '\n                    <div class="model-inspector">\n                        <div class="model-inspector__menu">\n                            <div class="model-inspector__minimize"><i class="fa fa-caret-down" aria-hidden="true"></i>Model Inspector</div>\n                            <div class="model-inspector__content">\n                                <div class="model-inspector__modes custom-scrollbar js-scrollable">\n                                    ', c += '\n                                </div>\n                            </div>\n                        </div>\n                        <div class="model-inspector__2D-options">\n                            <div class="model-inspector__UV-options"></div>\n                            <div class="model-inspector__material-options"></div>\n                        </div>\n                        <div class="model-inspector__empty-2d-view">\n                        </div>\n                    </div>\n                '), c += '\n\n\n                <div class="controls">\n                    ', c += r.suppressValue((o = 344, s = 31, r.callWrap(r.contextOrFrameLookup(t, n, "watermark"), "watermark", t, [a, r.contextOrFrameLookup(t, n, "options")])), e.opts.autoescape), c += "\n\n                    ", r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiControls") && (c += "\n\n                        ", r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiAnimations") && (c += '\n                            <div class="animation-controls widget ', r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiFadeout") || (c += "no-fadeout"), c += '">\n                                <div class="timeline">\n                                    <div class="timeline-wrapper">\n                                        <div class="track">\n                                            <div class="bar">\n                                            </div>\n                                            <div class="knob">\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                                <a href="#" class="control play fa"></a>\n                                <a href="#" class="control next fa"></a>\n                                <div class="animation-timer control progress help" data-unit="time">00:00.00</div>\n                                <div class="animation-list control has-menu">\n                                    <p class="animation-name"></p>\n                                    <div class="control-menu list">\n                                        <div class="animation__options">\n                                            <div class="toggle-button">\n                                                <span class="toggle-button__option tooltip" data-tooltip="Repeat one">\n                                                    <input type="radio" name="animation-cycle" data-value="one" id="animation-cycle-one">\n                                                    <label for="animation-cycle-one"><i class="custom-icons icon-cycle-repeat-one"></i></label>\n                                                </span>\n                                                <span class="toggle-button__option tooltip" data-tooltip="Repeat all">\n                                                    <input type="radio" name="animation-cycle" data-value="all" id="animation-cycle-all">\n                                                    <label for="animation-cycle-all"><i class="custom-icons icon-cycle-repeat-all"></i></label>\n                                                </span>\n                                                <span class="toggle-button__option tooltip" data-tooltip="No repeat">\n                                                    <input type="radio" name="animation-cycle" data-value="none" id="animation-cycle-none">\n                                                    <label for="animation-cycle-none"><i class="custom-icons icon-cycle-no-repeat"></i></label>\n                                                </span>\n                                            </div>\n                                            <div class="toggle-button">\n                                                <span class="toggle-button__option tooltip" data-tooltip="Speed x0.1">\n                                                    <input type="radio" name="animation-speed" data-value="0.1" id="animation-speed-point-one">\n                                                    <label for="animation-speed-point-one">x0.1</label>\n                                                </span>\n                                                <span class="toggle-button__option tooltip" data-tooltip="Speed x0.5">\n                                                    <input type="radio" name="animation-speed" data-value="0.5" id="animation-speed-point-five">\n                                                    <label for="animation-speed-point-five">x0.5</label>\n                                                </span>\n                                                <span class="toggle-button__option tooltip" data-tooltip="Speed x1">\n                                                    <input type="radio" name="animation-speed" data-value="1" id="animation-speed-one">\n                                                    <label for="animation-speed-one">x1</label>\n                                                </span>\n                                                <span class="toggle-button__option tooltip" data-tooltip="Speed x2">\n                                                    <input type="radio" name="animation-speed" data-value="2" id="animation-speed-two">\n                                                    <label for="animation-speed-two">x2</label>\n                                                </span>\n                                            </div>\n                                        </div>\n                                        <ul class="js-scrollable"></ul>\n                                    </div>\n                                </div>\n                            </div>\n                        '), c += "\n\n                        ", r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiAnnotations") && (c += '\n                            <div class="hotspot-controls widget has-menu ', r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiFadeout") || (c += "no-fadeout"), c += '">\n\n                                <div data-title="Previous Annotation" data-action="prev-annotation">\n                                    <div class="icon fa fa-caret-left"></div>\n                                </div>\n\n                                <div class="hotspot-name default" data-action="toggle-annotation-list">\n                                    Select an annotation\n                                </div>\n\n                                <div data-title="Next Annotation" data-action="next-annotation">\n                                    <div class="icon fa fa-caret-right"></div>\n                                </div>\n\n                                <div class="list hotspots-list"></div>\n\n                            </div>\n                        '), c += '\n\n                            <div class="general-controls widget ', r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiFadeout") || (c += "no-fadeout"), c += '">\n                            ', r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiGeneralControls") && (c += "\n\n                                ", r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiHelp") && (c += '\n                                    <a class="control tooltip help" data-tooltip="Help">\n                                        <i class="fa fa-question"></i>\n                                    </a>\n                                '), c += "\n                                ", r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiSound") && (c += '\n                                    <a class="control volume" title="Volume (M)" draggable="false">\n                                        <i class="fa fa-volume-up"></i>\n                                        <div class="volume-menu">\n                                        </div>\n                                    </a>\n                                '), c += "\n                                ", r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiSettings") && (c += '\n                                    <a class="control tooltip settings has-menu" data-tooltip="Settings">\n                                        <i class="fa fa-gear"></i>\n                                        <div class="control-menu settings-menu">\n                                            <div class="control-menu-wrapper">\n                                                <div class="control-menu-list"></div>\n                                                <div class="control-menu-pane"></div>\n                                            </div>\n                                        </div>\n                                        <span class="control-badge"></span>\n                                    </a>\n                                '), c += "\n                                ", r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiInspector") && (c += '\n                                    <a class="control tooltip inspector" data-tooltip="Model Inspector (I)" data-action="inspector">\n                                        <i class="custom-icons icon-inspector"></i>\n                                    </a>\n                                '), c += "\n                                ", r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiVr") && (c += '\n                                    <a class="control tooltip vr ', r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiTheatre") || r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiFullscreen") || (c += "tooltip-right-bound"), c += '" data-tooltip="View in VR">\n                                        <i class="custom-icons icon-vr-icon"></i>\n                                    </a>\n                                '), c += "\n                                ", r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiTheatre") && (c += '\n                                    <a class="control tooltip theatre" data-tooltip="Theater Mode">\n                                        <i class="custom-icons icon-theater-icon"></i>\n                                    </a>\n                                '), c += "\n                                ", r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiFullscreen") && (c += '\n                                    <a class="control tooltip tooltip-right-bound fullscreen" data-tooltip="Fullscreen">\n                                        <i class="custom-icons icon-fullscreen-icon"></i>\n                                    </a>\n                                '), c += "\n                            "), c += "\n                            </div>\n                    "), c += "\n                </div>\n\n                ", r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiSnapshots") && (c += '\n                    <div class="snapshot-guides">\n                    </div>\n                    <div class="snapshot widget">\n                        <a class="button help">\n                            <span class="normal"><i class="icon fa fa-camera"></i> Save view</span>\n                            <span class="progress"><i class="icon fa fa-camera"></i> Saving&hellip;</span>\n                            <span class="success"><i class="icon fa fa-check"></i>Saved</span>\n                            <div class="tooltip tooltip-right">Save thumbnail and initial camera view</div>\n                        </a>\n                        <div class="img-container invisible"></div>\n                    </div>\n                    <div class="snapshot-flash">\n                    </div>\n                '), c += '\n\n                <div class="viewer-hint widget disabled">\n                    <div class="viewer-movehint">\n                        <i class="icon"></i>\n                        <span class="label"></span>\n                    </div>\n                </div>\n\n            </div>\n\n        </div>\n\n        <div class="osd widget">\n            <div class="osd-content">\n            </div>\n        </div>\n\n        <div class="fallback" style="display: none">\n\n            <div class="fallback-viewport">\n                <img src="" alt="" class="fallback-sprite">\n            </div>\n\n            <div class="fallback-warning">\n                <div class="inner">\n                    For compatibility reasons, 3D is not available (<a href="https://help.sketchfab.com/hc/en-us/articles/203059088-Compatibility?utm_source=website&amp;utm_campaign=error_fallback" target="_blank">see requirements</a>).<br>\n                    You are seeing a 360&deg; image instead.\n                </div>\n            </div>\n\n            <div class="fallback-error fallback-error-loading">\n                <div class="inner">\n                    <p>Connection error. Please try again.</p>\n                </div>\n            </div>\n\n            <div class="fallback-error fallback-error-nofallback">\n                <div class="inner">\n                    <p>Sorry, the model can\'t be displayed.</p>\n                    <p>Please check out <a href="https://help.sketchfab.com/hc/en-us/articles/203059088-Compatibility?utm_source=website&amp;utm_campaign=error_fallback" target="_blank">our FAQ</a> to learn how to fix this issue.</p>\n                </div>\n            </div>\n\n            <div class="progress-bar">\n                <div class="progress-bar-percentage"></div>\n                <div class="progress-bar-display"></div>\n            </div>\n\n            <div class="progress-circle">\n                <div class="progress-circle-percentage loading-percentage"></div>\n                <svg class="progress-circle-display" version="1.1">\n                    <path class="progress-circle-path" fill="none" stroke="#1caad9" stroke-width="6" />\n                </svg>\n            </div>\n\n            ', r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiControls") && (c += '\n                <div class="controls">\n                    <div class="control control-fullscreen fullscreen tooltip tooltip-left" data-tooltip="Fullscreen" data-action="fullscreen">\n                        <div class="icon custom-icons icon-fullscreen-icon"></div>\n                    </div>\n                </div>\n            '), c += "\n\n        </div>\n\n    </div>\n\n", n = l, new r.SafeString(c)
                                                                        });
                                                                        t.addExport("show_viewer"), t.setVariable("show_viewer", g), u += "\n\n";
                                                                        var v = r.makeMacro(["mode"], [], function (e, t) {
                                                                            var i = n;
                                                                            n = new r.Frame, t = t || {}, t.hasOwnProperty("caller") && n.set("caller", t.caller), n.set("mode", e);
                                                                            var a = "";
                                                                            return a += "\n\n    ", "orbit" == e && (a += '\n\n        <div class="viewer-mode-help">\n            <h2>Orbit mode</h2>\n            <ul class="help-shortcuts">\n                <li class="mouse-left">Rotate</li>\n                <li class="mouse-wheel">Zoom <small class="hint">also works with CTRL+left click</small></li>\n                <li class="mouse-right">Pan <small class="hint">also works with SHIFT+left click</small></li>\n            </ul>\n        </div>\n\n    '), a += "\n\n    ", "fps" == e && (a += '\n\n        <div class="viewer-mode-help">\n            <h2>First person mode</h2>\n            <ul class="help-shortcuts">\n                <li class="mouse-left">Look around</li>\n                <li class="mouse-wheel">Walking speed</li>\n                <li class="kbd-wasd">Walk <small class="hint">also works with arrows or Z,Q,S,D</small></li>\n            </ul>\n        </div\n\n    '), a += "\n\n", n = i, new r.SafeString(a)
                                                                        });
                                                                        t.addExport("help_viewer_mode"), t.setVariable("help_viewer_mode", v), u += "\n\n";
                                                                        var _ = r.makeMacro(["hotspots"], [], function (i, a) {
                                                                            var o = n;
                                                                            n = new r.Frame, a = a || {}, a.hasOwnProperty("caller") && n.set("caller", a.caller), n.set("hotspots", i);
                                                                            var s = "";
                                                                            s += '\n<a href="#" data-action="toggle-visibility" class="annotations-visibility --hide"></a>\n<a href="#" data-action="toggle-autopilot" class="annotations-autopilot --stopped"></a>\n<ul class="js-scrollable">\n    ', n = n.push();
                                                                            var u = i;
                                                                            if (u)
                                                                                for (var l = u.length, c = 0; c < u.length; c++) {
                                                                                    var h = u[c];
                                                                                    n.set("hotspot", h), n.set("loop.index", c + 1), n.set("loop.index0", c), n.set("loop.revindex", l - c), n.set("loop.revindex0", l - c - 1), n.set("loop.first", 0 === c), n.set("loop.last", c === l - 1), n.set("loop.length", l), s += '\n        <li class="link"><a data-hotspot-target="', s += r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t, n, "loop"), "index0"), e.opts.autoescape), s += '" title="', s += r.suppressValue(r.memberLookup(h, "name"), e.opts.autoescape), s += '"><span class="index">', s += r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t, n, "loop"), "index"), e.opts.autoescape), s += "</span> ", s += r.suppressValue(r.memberLookup(h, "name"), e.opts.autoescape), s += "</a></li>\n    "
                                                                                }
                                                                            return n = n.pop(), s += "\n</ul>\n", n = o, new r.SafeString(s)
                                                                        });
                                                                        t.addExport("hotspots_list"), t.setVariable("hotspots_list", _), u += "\n\n";
                                                                        var b = r.makeMacro(["hasFullscreen"], [], function (t, a) {
                                                                            var o = n;
                                                                            n = new r.Frame, a = a || {}, a.hasOwnProperty("caller") && n.set("caller", a.caller), n.set("hasFullscreen", t);
                                                                            var s = "";
                                                                            return s += '\n\n    <div class="vr-mode-help">\n        ', s += '\n        <img src="', s += r.suppressValue(i(947), e.opts.autoescape), s += '" width="96" height="116" alt="Place your landscape oriented phone in front of lenses">\n\n        <p>\n            ', s += t ? '\n                <button class="button btn-textified" data-action="fullscreen">Switch to fullscreen</button><br>\n                then place your phone into your Cardboard viewer\n            ' : "\n                Place your phone into your Cardboard viewer\n            ", s += "\n        </p>\n    </div>\n\n", n = o, new r.SafeString(s)
                                                                        });
                                                                        t.addExport("help_vr_mode"), t.setVariable("help_vr_mode", b), u += "\n\n";
                                                                        var S = r.makeMacro(["model"], ["options"], function (i, a) {
                                                                            var o = n;
                                                                            n = new r.Frame, a = a || {}, a.hasOwnProperty("caller") && n.set("caller", a.caller), n.set("model", i), n.set("options", a.hasOwnProperty("options") ? a.options : {});
                                                                            var s = "";
                                                                            return s += "\n    ", r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiWatermark") && (s += '\n        <div class="watermark', s += r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiWatermarkLink") ? "" : " tooltip tooltip-left-bound", e.opts.autoescape), s += '"\n            ', r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiWatermarkLink") || (s += '\n                data-tooltip="Powered by Sketchfab.com"\n            '), s += "\n        >\n            <a\n                ", r.memberLookup(r.contextOrFrameLookup(t, n, "options"), "uiWatermarkLink") && (s += '\n                    title="View on Sketchfab"\n                    data-action="watermark" href="', s += r.suppressValue(r.memberLookup(i, "viewerUrl"), e.opts.autoescape), s += '" target="_blank"\n                '), s += "\n            ></a>\n        </div>\n    "), s += "\n", n = o, new r.SafeString(s)
                                                                        });
                                                                        t.addExport("watermark"), t.setVariable("watermark", S), u += "\n", l ? l.rootRenderFunc(e, t, n, r, a) : a(null, u)
                                                                    })
                                                                })
                                                            })
                                                        })
                                                    })
                                                })
                                            })
                                        })
                                    })
                                })
                            })
                        })
                    } catch (e) {
                        a(r.handleError(e, o, s))
                    }
                }
                return {
                    root: e
                }
            }()
        }()
}, function (e, t, i) {
    "use strict";
    var n = function (e, t, i) {
            return Math.min(i, Math.max(t, e))
        },
        r = function (e, t, i) {
            if (i <= e) return 0;
            if (i >= t) return 1;
            var n = (i - e) / (t - e);
            return n * n * (3 - 2 * n)
        },
        a = function (e) {
            return e !== e
        };
    t.a = {
        clamp: n,
        smoothStep: r,
        isNaN: a
    }
}, function (e, t, i) {
    "use strict";
    var n = i(36),
        r = i(12),
        a = i(317),
        o = i(10),
        s = function () {
            this._center = o.f.create(), this._radius = -1
        };
    r.a.createPrototypeObject(s, {
        init: function () {
            o.f.init(this._center), this._radius = -1
        },
        valid: function () {
            return this._radius >= 0
        },
        set: function (e, t) {
            this._center = e, this._radius = t
        },
        center: function () {
            return this._center
        },
        radius: function () {
            return this._radius
        },
        radius2: function () {
            return this._radius * this._radius
        },
        volume: function () {
            var e = this._radius;
            return e * e * e * Math.PI * 4 / 3
        },
        copy: function (e) {
            this._radius = e._radius, o.f.copy(this._center, e._center)
        },
        copyBoundingBox: function (e) {
            e.center(this._center), this._radius = e.radius()
        },
        expandByBoundingBox: function () {
            var e = o.f.create(),
                t = new a.a;
            return function (i) {
                if (i.valid()) {
                    if (!this.valid()) return void this.copyBoundingBox(i);
                    o.f.copy(t._min, i._min), o.f.copy(t._max, i._max);
                    for (var n = 0; n < 8; n++) o.f.sub(e, i.corner(n, e), this._center), o.f.normalize(e, e), o.f.scaleAndAdd(e, this._center, e, -this._radius), t.expandByVec3(e);
                    t.center(this._center), this._radius = t.radius()
                }
            }
        }(),
        expandByvec3: function (e) {
            n.a.warn("deprecated, use expandByVec3"), this.expandByVec3(e)
        },
        expandByVec3: function () {
            var e = o.f.create();
            return function (t) {
                if (this.valid()) {
                    o.f.sub(e, t, this.center(e));
                    var i = o.f.length(e);
                    if (i > this.radius()) {
                        var n = .5 * (i - this.radius());
                        this._center[0] += e[0] * (n / i), this._center[1] += e[1] * (n / i), this._center[2] += e[2] * (n / i), this._radius += n
                    }
                } else this._center[0] = t[0], this._center[1] = t[1], this._center[2] = t[2], this._radius = 0
            }
        }(),
        expandRadiusBySphere: function (e) {
            if (e.valid())
                if (this.valid()) {
                    var t = o.f.distance(this._center, e._center) + e._radius;
                    t > this._radius && (this._radius = t)
                } else o.f.copy(this._center, e._center), this._radius = e._radius
        },
        expandByBoundingSphere: function (e) {
            if (e.valid()) {
                if (!this.valid()) return this._center[0] = e._center[0], this._center[1] = e._center[1], this._center[2] = e._center[2], void(this._radius = e.radius());
                var t = o.f.distance(e.center(), this.center());
                if (!(t + e.radius() <= this.radius())) {
                    if (t + this.radius() <= e.radius()) return this._center[0] = e._center[0], this._center[1] = e._center[1], this._center[2] = e._center[2], void(this._radius = e._radius);
                    var i = .5 * (this.radius() + t + e.radius()),
                        n = (i - this.radius()) / t;
                    this._center[0] += (e._center[0] - this._center[0]) * n, this._center[1] += (e._center[1] - this._center[1]) * n, this._center[2] += (e._center[2] - this._center[2]) * n, this._radius = i
                }
            }
        },
        contains: function (e) {
            return !!this.valid() && o.f.sqrDist(this.center(), e) <= this.radius2()
        },
        intersects: function (e) {
            if (!this.valid() || !e.valid()) return !1;
            var t = this.radius() + e.radius();
            return o.f.sqrDist(e.center(), this.center()) <= t * t
        },
        transformMat4: function () {
            var e = o.f.create();
            return function (t, i) {
                if (!this.valid()) return t;
                t._center !== this._center && (o.f.copy(t._center, this._center), t._radius = this._radius);
                var n = t._center,
                    r = t._radius;
                return o.c.getSqrScale(e, i), r *= Math.sqrt(Math.max(Math.max(e[0], e[1]), e[2])), t._radius = r, o.f.transformMat4(n, n, i), t
            }
        }()
    }, "osg", "BoundingSphere"), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = (i(36), i(12)),
        r = i(102),
        a = window.ImageBitmap || function () {},
        o = function (e) {
            r.a.call(this), this._imageObject = void 0, this._url = void 0, this._width = void 0, this._height = void 0, this._dirty = !0, this._mipmap = [], e && this.setImage(e), this._isGreyscale = void 0
        };
    n.a.createPrototypeObject(o, n.a.objectInherit(r.a.prototype, {
        dirty: function () {
            this._isGreyscale = void 0, this._dirty = !0
        },
        isDirty: function () {
            return this._dirty
        },
        setDirty: function (e) {
            this._dirty = e
        },
        getImage: function () {
            return this._imageObject instanceof o ? this._imageObject.getImage() : this._imageObject
        },
        getURL: function () {
            return this._url
        },
        setURL: function (e) {
            this._url = e
        },
        useOrCreateImage: function (e) {
            return e instanceof o == !1 ? new o(e) : e
        },
        setImage: function (e) {
            if (!this._url && e && (e.src || e.currentSrc) && (this._url = e.src || e.currentSrc), this._mipmap.length = 0, Array.isArray(e)) {
                for (var t = 0, i = e.length; t < i; t++) this._mipmap.push(this.useOrCreateImage(e[t]));
                this.setWidth(this._mipmap[0].getWidth()), this.setHeight(this._mipmap[0].getHeight())
            } else this._mipmap.push(e);
            this._imageObject = this._mipmap[0], this.dirty()
        },
        isCanvas: function () {
            return this.getImage() instanceof window.HTMLCanvasElement
        },
        isBitmap: function () {
            return this.getImage() instanceof a
        },
        isVideo: function () {
            return this.getImage() instanceof window.HTMLVideoElement
        },
        isImage: function () {
            return this.getImage() instanceof window.Image
        },
        isTypedArray: function () {
            var e = this.getImage();
            return e instanceof Uint8Array || e instanceof Float32Array || e instanceof Uint16Array
        },
        setWidth: function (e) {
            this._width = e
        },
        setHeight: function (e) {
            this._height = e
        },
        getWidth: function () {
            var e = this.getImage();
            return this.isImage() ? e.naturalWidth : this.isVideo() ? e.videoWidth : this.isCanvas() || this.isBitmap() ? e.width : this._width
        },
        getHeight: function () {
            var e = this.getImage();
            return this.isImage() ? e.naturalHeight : this.isVideo() ? e.videoHeight : this.isCanvas() || this.isBitmap() ? e.height : this._height
        },
        isGreyscale: function (e) {
            if (void 0 !== this._isGreyscale) return this._isGreyscale;
            if (void 0 !== this._imageObject && this.isReady() && void 0 === this._isGreyscale) {
                var t = this._imageObject;
                this.isCanvas() || (t = document.createElement("canvas"));
                var i = t.getContext("2d");
                t.width = this._imageObject.width, t.height = this._imageObject.height, i.drawImage(this._imageObject, 0, 0);
                var n, r;
                e || (n = t.width, r = t.height), e > 0 && (e = Math.min(Math.min(t.width, t.height), e), n = r = e);
                for (var a = !0, o = t.width / n, s = t.height / r, u = 0; u < n; u++)
                    for (var l = 0; l < r; l++) {
                        var c = Math.floor(o * (u + .5)),
                            h = Math.floor(s * (l + .5)),
                            d = i.getImageData(c, h, 1, 1).data;
                        if (d[0] !== d[1] || d[0] !== d[2]) {
                            a = !1;
                            break
                        }
                    }
                this._isGreyscale = a
            }
            return this._isGreyscale
        },
        isReady: function () {
            if (this._imageObject && this._imageObject instanceof o) return this._imageObject.isReady();
            if (this.isCanvas() || this.isTypedArray() || this.isBitmap()) return !0;
            if (this.isImage()) {
                var e = this.getImage();
                if (e.complete) return void 0 === e.naturalWidth || 0 !== e.naturalWidth
            }
            if (this.isVideo() && 0 !== this.getWidth()) return !0;
            var t = this.getImage();
            return !!t.complete && (void 0 === t.naturalWidth || 0 !== t.naturalWidth)
        },
        getMipmap: function () {
            return this._mipmap
        },
        hasMipmap: function () {
            return this._mipmap.length > 1
        },
        release: function () {
            this._mipmap.length = 0, this._imageObject = void 0
        }
    }), "osg", "Image"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(92),
        a = function (e) {
            r.a.call(this), this.setMode(void 0 !== e ? e : a.BACK)
        };
    a.DISABLE = 0, a.FRONT = 1028, a.BACK = 1029, a.FRONT_AND_BACK = 1032, n.a.createPrototypeStateAttribute(a, n.a.objectInherit(r.a.prototype, {
        attributeType: "CullFace",
        cloneType: function () {
            return new a
        },
        setMode: function (e) {
            var t = e;
            "string" == typeof t && (t = a[t]), this._mode = t
        },
        getMode: function () {
            return this._mode
        },
        apply: function (e) {
            e.applyCullFace(this)
        }
    }), "osg", "CullFace"), t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(10),
        a = n.a.objectInherit(r.g, {
            INSIDE: 1,
            INTERSECT: 2,
            OUTSIDE: 3,
            transformProvidingInverse: function () {
                var e = a.create();
                return function (t, i) {
                    var n = t[0],
                        r = t[1],
                        o = t[2],
                        s = t[3];
                    return e[0] = i[0] * n + i[1] * r + i[2] * o + i[3] * s, e[1] = i[4] * n + i[5] * r + i[6] * o + i[7] * s, e[2] = i[8] * n + i[9] * r + i[10] * o + i[11] * s, e[3] = i[12] * n + i[13] * r + i[14] * o + i[15] * s, a.normalizeEquation(e), a.copy(e, t), t
                }
            },
            normalizeEquation: function (e) {
                var t = 1 / Math.sqrt(e[0] * e[0] + e[1] * e[1] + e[2] * e[2]);
                e[0] *= t, e[1] *= t, e[2] *= t, e[3] *= t
            },
            getNormal: function (e, t) {
                return t[0] = e[0], t[1] = e[1], t[2] = e[2], t
            },
            setNormal: function (e, t) {
                e[0] = t[0], e[1] = t[1], e[2] = t[2]
            },
            getDistance: function (e) {
                return e[3]
            },
            setDistance: function (e, t) {
                e[3] = t
            },
            distanceToPlane: function (e, t) {
                return e[0] * t[0] + e[1] * t[1] + e[2] * t[2] + e[3]
            },
            intersectsOrContainsBoundingSphere: function (e, t) {
                if (!t.valid()) return a.OUTSIDE;
                var i = t.center(),
                    n = t.radius(),
                    r = this.distanceToPlane(e, i);
                return r < -n ? a.OUTSIDE : r <= n ? a.INTERSECT : a.INSIDE
            },
            instersectsBoundingSphere: function (e, t) {
                return this.intersectsOrContainsBoundingSphere(e, t) === a.INTERSECT
            },
            intersectsOrContainsBoundingBox: function () {
                var e = r.f.create();
                return function (t, i) {
                    var n = (t[0] >= 0 ? 1 : 0) | (t[1] >= 0 ? 2 : 0) | (t[2] >= 0 ? 4 : 0),
                        r = 7 & ~n;
                    return this.distanceToPlane(t, i.corner(r, e)) > 0 ? a.INSIDE : this.distanceToPlane(t, i.corner(n, e)) < 0 ? a.OUTSIDE : a.INTERSECT
                }
            }(),
            intersectsBoundingBox: function (e, t, i) {
                return this.intersectsOrContainsBoundingBox(e, t, i) === a.INTERSECT
            },
            intersectOrContainsVertices: function (e, t) {
                for (var i = -1, n = 0; n < t.length; n++) {
                    var r = this.distanceToPlane(e, t[n]);
                    if (r < 0) {
                        if (1 === i) return a.INTERSECT;
                        i = 2
                    } else {
                        if (!(r > 0)) return a.INTERSECT;
                        if (2 === i) return a.INTERSECT;
                        i = 1
                    }
                }
                return i > 0 ? a.INSIDE : a.OUTSIDE
            },
            intersectVertices: function (e, t) {
                return this.intersectOrContainsVertices(e, t) === a.INTERSECT
            }
        });
    t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(10),
        a = i(317),
        o = i(198),
        s = i(618),
        u = function (e) {
            void 0 !== e && this.setName(e), o.a.call(this), this._invBindInSkeletonSpace = r.c.create(), this._boneInSkeletonSpace = r.c.create(), this._boneBoundingBox = new a.a
        };
    n.a.createPrototypeNode(u, n.a.objectInherit(o.a.prototype, {
        getOrCreateDebugColor: function () {
            return this._boneColor ? this._boneColor : (this._boneColor = r.f.fromValues(Math.random(), Math.random(), Math.random()), this._boneColor)
        },
        getBoneBoundingBox: function () {
            return this._boneBoundingBox
        },
        setBoneBoundingBox: function (e) {
            this._boneBoundingBox = e
        },
        getMatrixInSkeletonSpace: function () {
            return this._boneInSkeletonSpace
        },
        getInvBindMatrixInSkeletonSpace: function () {
            return this._invBindInSkeletonSpace
        },
        setMatrixInSkeletonSpace: function (e) {
            r.c.copy(this._boneInSkeletonSpace, e)
        },
        setInvBindMatrixInSkeletonSpace: function (e) {
            r.c.copy(this._invBindInSkeletonSpace, e)
        },
        getBoneParent: function () {
            for (var e = this.getParents(), t = 0, i = e.length; t < i; t++) {
                if (e[t].getTypeID() === u.getTypeID()) return e[t]
            }
        },
        setDefaultUpdateCallback: function (e) {
            this.addUpdateCallback(new s.a(void 0 !== e ? e : this.getName()))
        }
    }), "osgAnimation", "Bone"), t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(10),
        a = i(160),
        o = i(36),
        s = i(288),
        u = i(364),
        l = i(1081),
        c = i(1083),
        h = i(577),
        d = i(571),
        f = function () {
            a.a.call(this), this._shape = null, this.addUpdateCallback(new l.a), this._root = void 0, this._pathToRoot = void 0, this._isAnimatedPath = !1, this._boneNameID = {}, this._matrixFromSkeletonToGeometry = r.c.create(), this._invMatrixFromSkeletonToGeometry = r.c.create(), this._rigTransformImplementation = new c.a, this._geometry = void 0, this._stateSetAnimation = new s.a, this._needToComputeMatrix = !0
        };
    n.a.createPrototypeNode(f, n.a.objectInherit(a.a.prototype, {
        getStateSetAnimation: function () {
            return this._stateSetAnimation
        },
        getSkeleton: function () {
            return this._root
        },
        setSkeleton: function (e) {
            this._root = e
        },
        setPathToSkeleton: function (e) {
            this._pathToRoot = e, this._isAnimatedPath = h.a.checkPathIsAnimated(e)
        },
        setNeedToComputeMatrix: function (e) {
            this._needToComputeMatrix = e
        },
        getNeedToComputeMatrix: function () {
            return this._needToComputeMatrix
        },
        separateStaticBoxInGeometry: function () {
            var e = this.getBoundingBox();
            if (e.valid() && !this._staticGeomAdded) {
                this._staticGeomAdded = !0;
                var t = new a.a;
                t.setNodeMask(0), t.setName("staticBoxOf:" + this.getName());
                for (var i = this.getParents(), n = 0; n < i.length; ++n) i[n].addChild(t);
                t.getBoundingBox().copy(e), t.getBoundingSphere().copy(this.getBoundingSphere()), e.init(), this.getBoundingSphere().init()
            }
        },
        computeBoundingBox: function (e) {
            e.init();
            var t = this.getVertexAttributeList().Vertex,
                i = this.getVertexAttributeList().Weights;
            if (t && i && t.getElements() && t.getItemSize() > 2) {
                for (var n = i.getElements(), r = t.getElements(), a = t.getItemSize(), o = e.getMin(), s = e.getMax(), u = o[0], l = o[1], c = o[2], h = s[0], d = s[1], f = s[2], p = 0, m = 0, g = r.length; p < g; p += a, m += 4)
                    if (0 === n[p] && 0 === n[p + 1] && 0 === n[p + 2] && 0 === n[p + 3]) {
                        var v = r[p],
                            _ = r[p + 1],
                            b = r[p + 2];
                        v < u && (u = v), v > h && (h = v), _ < l && (l = _), _ > d && (d = _), b < c && (c = b), b > f && (f = b)
                    } o[0] = u, o[1] = l, o[2] = c, s[0] = h, s[1] = d, s[2] = f
            }
            return e
        },
        computeMatrixFromRootSkeleton: function () {
            if (!this._root) return void o.a.warn("Warning " + this.className() + ".computeMatrixFromRootSkeleton if you have this message it means you miss to call buildTransformer( root ), or your RigGeometry (" + this.getName() + ") is not attached to a Skeleton subgraph");
            r.c.identity(this._matrixFromSkeletonToGeometry), d.a.computeLocalToWorld(this._pathToRoot, !0, this._matrixFromSkeletonToGeometry), r.c.invert(this._invMatrixFromSkeletonToGeometry, this._matrixFromSkeletonToGeometry), this._isAnimatedPath || (this._needToComputeMatrix = !1)
        },
        getMatrixFromSkeletonToGeometry: function () {
            return this._matrixFromSkeletonToGeometry
        },
        getInvMatrixFromSkeletonToGeometry: function () {
            return this._invMatrixFromSkeletonToGeometry
        },
        getSourceGeometry: function () {
            return this._geometry
        },
        setSourceGeometry: function (e) {
            this._geometry = e
        },
        getBoneNameID: function () {
            return this._boneNameID
        },
        setBoneNameID: function (e) {
            this._boneNameID = e
        },
        mergeChildrenVertexAttributeList: function () {
            this._geometry instanceof u.a && this._geometry.mergeChildrenVertexAttributeList();
            var e = this._geometry.getVertexAttributeList();
            a.a.appendVertexAttributeToList(e, this.getVertexAttributeList())
        },
        mergeChildrenData: function () {
            this.mergeChildrenVertexAttributeList();
            var e = this._geometry.getPrimitiveSetList();
            this.getPrimitiveSetList().length = 0;
            for (var t = 0, i = e.length; t < i; t++) this.getPrimitiveSetList()[t] = e[t];
            this.getStateSet() && console.error("A stateset in the rig is already present : " + this.getStateSet()), this.setStateSet(this._geometry.getStateSet())
        },
        update: function () {
            this._rigTransformImplementation.update(this)
        },
        computeTransformedVertex: function (e, t) {
            t = t || r.f.create();
            var i = this.getVertexAttributeList(),
                n = i.Weights.getElements(),
                a = i.Bones.getElements(),
                o = 0,
                s = 0,
                u = 0;
            if (this._geometry.computeTransformedVertex) this._geometry.computeTransformedVertex(e, t), o = t[0], s = t[1], u = t[2];
            else {
                var l = i.Vertex.getElements();
                o = l[3 * e], s = l[3 * e + 1], u = l[3 * e + 2]
            }
            for (var c = 4 * e, h = this._rigTransformImplementation._skinningAttribute.getMatrixPalette(), d = 0, f = 0, p = 0, m = 0, g = 0, v = 0, _ = 0, b = 0, S = 0, x = 0, y = 0, C = 0, T = 0, w = !1, M = 0; M < 4; ++M) {
                var E = n[c + M];
                if (0 !== E) {
                    var A = 12 * a[c + M];
                    d += h[A + 0] * E, m += h[A + 1] * E, _ += h[A + 2] * E, x += h[A + 3] * E, f += h[A + 4] * E, g += h[A + 5] * E, b += h[A + 6] * E, y += h[A + 7] * E, p += h[A + 8] * E, v += h[A + 9] * E, S += h[A + 10] * E, C += h[A + 11] * E, T += E, w = !0
                }
            }
            w || (t[0] = o, t[1] = s, t[2] = u);
            var P = 1 / T;
            return t[0] = (d * o + m * s + _ * u + x) * P, t[1] = (f * o + g * s + b * u + y) * P, t[2] = (p * o + v * s + S * u + C) * P, t
        },
        computeTransformedVertices: function () {
            for (var e = this.getVertexAttributeList(), t = this._geometry.computeTransformedVertices ? this._geometry.computeTransformedVertices() : e.Vertex.getElements(), i = e.Weights.getElements(), n = e.Bones.getElements(), r = this._riggedVerts || new Float32Array(t.length), a = this._rigTransformImplementation._skinningAttribute.getMatrixPalette(), o = 0, s = 0, u = t.length; o < u; o += 3, s += 4) {
                var l, c = 0,
                    h = 0,
                    d = 0,
                    f = 0,
                    p = 0,
                    m = 0,
                    g = 0,
                    v = 0,
                    _ = 0,
                    b = 0,
                    S = 0,
                    x = 0,
                    y = 0,
                    C = !1,
                    T = i[s];
                0 !== T && (l = 12 * n[s], c += a[l + 0] * T, f += a[l + 1] * T, g += a[l + 2] * T, b += a[l + 3] * T, h += a[l + 4] * T, p += a[l + 5] * T, v += a[l + 6] * T, S += a[l + 7] * T, d += a[l + 8] * T, m += a[l + 9] * T, _ += a[l + 10] * T, x += a[l + 11] * T, y += T, C = !0), T = i[s + 1], 0 !== T && (l = 12 * n[s + 1], c += a[l + 0] * T, f += a[l + 1] * T, g += a[l + 2] * T, b += a[l + 3] * T, h += a[l + 4] * T, p += a[l + 5] * T, v += a[l + 6] * T, S += a[l + 7] * T, d += a[l + 8] * T, m += a[l + 9] * T, _ += a[l + 10] * T, x += a[l + 11] * T, y += T, C = !0), T = i[s + 2], 0 !== T && (l = 12 * n[s + 2], c += a[l + 0] * T, f += a[l + 1] * T, g += a[l + 2] * T, b += a[l + 3] * T, h += a[l + 4] * T, p += a[l + 5] * T, v += a[l + 6] * T, S += a[l + 7] * T, d += a[l + 8] * T, m += a[l + 9] * T, _ += a[l + 10] * T, x += a[l + 11] * T, y += T, C = !0), T = i[s + 3], 0 !== T && (l = 12 * n[s + 3], c += a[l + 0] * T, f += a[l + 1] * T, g += a[l + 2] * T, b += a[l + 3] * T, h += a[l + 4] * T, p += a[l + 5] * T, v += a[l + 6] * T, S += a[l + 7] * T, d += a[l + 8] * T, m += a[l + 9] * T, _ += a[l + 10] * T, x += a[l + 11] * T, y += T, C = !0);
                var w = t[o],
                    M = t[o + 1],
                    E = t[o + 2];
                if (C) {
                    var A = 1 / y;
                    r[o] = (c * w + f * M + g * E + b) * A, r[o + 1] = (h * w + p * M + v * E + S) * A, r[o + 2] = (d * w + m * M + _ * E + x) * A
                } else r[o] = w, r[o + 1] = M, r[o + 2] = E
            }
            return r
        }
    }), "osgAnimation", "RigGeometry"), t.a = f
}, function (e, t, i) {
    "use strict";
    var n = i(10),
        r = i(408),
        a = i(864),
        o = {},
        s = function (e, t, i, n, r, a) {
            var o = i[0],
                s = i[i.length - 1];
            return a.start = o, a.keys = t, a.end = s, a.times = i, a.type = e, a.duration = s - o, a.target = n, a.name = r, a
        },
        u = function (e, t, i, n, r) {
            return s(a.a.Vec3, e, t, i, n, r || {})
        },
        l = function (e, t, i, n, r) {
            return s(a.a.Float, e, t, i, n, r || {})
        },
        c = function (e, t, i, n, r) {
            return s(a.a.Quat, e, t, i, n, r || {})
        },
        h = function (e, t, i, n, r) {
            return s(a.a.QuatSlerp, e, t, i, n, r || {})
        },
        d = function (e, t, i, n, r) {
            return s(a.a.FloatCubicBezier, e, t, i, n, r || {})
        },
        f = function (e, t, i, n, r) {
            return s(a.a.Vec3CubicBezier, e, t, i, n, r || {})
        },
        p = {
            create: function () {
                return 0
            }
        },
        m = {
            create: function () {
                return n.f.create32()
            }
        },
        g = {
            create: function () {
                return n.d.create32()
            }
        },
        v = function (e, t) {
            return {
                channel: t,
                value: e.create(),
                targetID: r.a.InvalidTargetID,
                weight: 1,
                key: 0,
                start: 0,
                end: 0
            }
        },
        _ = function (e) {
            return v(m, e)
        },
        b = function (e) {
            return v(g, e)
        },
        S = function (e) {
            return v(p, e)
        },
        x = function (e) {
            return v(p, e)
        },
        y = function (e) {
            return v(m, e)
        },
        C = function (e) {
            return o[e.type](e)
        };
    o.createInstanceChannel = C, o.createInstanceVec3Channel = _, o.createInstanceQuatChannel = b, o.createInstanceQuatSlerpChannel = b, o.createInstanceFloatChannel = S, o.createInstanceFloatCubicBezierChannel = x, o.createInstanceVec3CubicBezierChannel = y, o.createVec3Channel = u, o.createQuatChannel = c, o.createQuatSlerpChannel = h, o.createFloatChannel = l, o.createFloatCubicBezierChannel = d, o.createVec3CubicBezierChannel = f, o[a.a.Vec3] = _, o[a.a.Quat] = b, o[a.a.QuatSlerp] = b, o[a.a.Float] = S, o[a.a.FloatCubicBezier] = x, o[a.a.Vec3CubicBezier] = y, o.ChannelType = a.a, t.a = o
}, function (e, t, i) {
    "use strict";
    var n = function (e) {
        this._target = e, this._supportedEvents = []
    };
    n.prototype = {
        supportsEvent: function (e) {
            for (var t = 0; t < this._supportedEvents.length; t++) {
                var i = this._supportedEvents[t];
                if (0 === e.indexOf(i)) return !0
            }
            return !1
        },
        setInputManager: function (e) {
            this._inputManager = e
        }
    }, t.a = n
}, function (e, t, i) {
    "use strict";

    function n(e, t) {
        t = t || {};
        for (var i in e) t[i] = e[i];
        return t
    }

    function r(e, t, i) {
        var n = i ? " !== " : " === ",
            r = i ? " || " : " && ",
            a = i ? "!" : "",
            o = i ? "" : "!";
        switch (e) {
            case "null":
                return t + n + "null";
            case "array":
                return a + "Array.isArray(" + t + ")";
            case "object":
                return "(" + a + t + r + "typeof " + t + n + '"object"' + r + o + "Array.isArray(" + t + "))";
            case "integer":
                return "(typeof " + t + n + '"number"' + r + o + "(" + t + " % 1)" + r + t + n + t + ")";
            default:
                return "typeof " + t + n + '"' + e + '"'
        }
    }

    function a(e, t) {
        switch (e.length) {
            case 1:
                return r(e[0], t, !0);
            default:
                var i = "",
                    n = s(e);
                n.array && n.object && (i = n.null ? "(" : "(!" + t + " || ", i += "typeof " + t + ' !== "object")', delete n.null, delete n.array, delete n.object), n.number && delete n.integer;
                for (var a in n) i += (i ? " && " : "") + r(a, t, !0);
                return i
        }
    }

    function o(e, t) {
        if (Array.isArray(t)) {
            for (var i = [], n = 0; n < t.length; n++) {
                var r = t[n];
                w[r] ? i[i.length] = r : "array" === e && "array" === r && (i[i.length] = r)
            }
            if (i.length) return i
        } else {
            if (w[t]) return [t];
            if ("array" === e && "array" === t) return ["array"]
        }
    }

    function s(e) {
        for (var t = {}, i = 0; i < e.length; i++) t[e[i]] = !0;
        return t
    }

    function u(e) {
        return "number" == typeof e ? "[" + e + "]" : M.test(e) ? "." + e : "['" + l(e) + "']"
    }

    function l(e) {
        return e.replace(E, "\\$&").replace(/\n/g, "\\n").replace(/\r/g, "\\r").replace(/\f/g, "\\f").replace(/\t/g, "\\t")
    }

    function c(e, t) {
        t += "[^0-9]";
        var i = e.match(new RegExp(t, "g"));
        return i ? i.length : 0
    }

    function h(e, t, i) {
        return t += "([^0-9])", i = i.replace(/\$/g, "$$$$"), e.replace(new RegExp(t, "g"), i + "$1")
    }

    function d(e) {
        return e.replace(A, "").replace(P, "").replace(R, "if (!($1))")
    }

    function f(e, t) {
        var i = e.match(O);
        return i && 2 == i.length && (e = t ? e.replace(F, "").replace(L, k) : e.replace(I, "").replace(N, D)), i = e.match(V), i && 3 === i.length ? e.replace(B, "") : e
    }

    function p(e, t) {
        if ("boolean" == typeof e) return !e;
        for (var i in e)
            if (t[i]) return !0
    }

    function m(e, t, i) {
        if ("boolean" == typeof e) return !e && "not" != i;
        for (var n in e)
            if (n != i && t[n]) return !0
    }

    function g(e) {
        return "'" + l(e) + "'"
    }

    function v(e, t, i, n) {
        return S(e, i ? "'/' + " + t + (n ? "" : ".replace(/~/g, '~0').replace(/\\//g, '~1')") : n ? "'[' + " + t + " + ']'" : "'[\\'' + " + t + " + '\\']'")
    }

    function _(e, t, i) {
        return S(e, g(i ? "/" + C(t) : u(t)))
    }

    function b(e, t, i) {
        var n, r, a, o;
        if ("" === e) return "rootData";
        if ("/" == e[0]) {
            if (!U.test(e)) throw new Error("Invalid JSON-pointer: " + e);
            r = e, a = "rootData"
        } else {
            if (!(o = e.match(G))) throw new Error("Invalid JSON-pointer: " + e);
            if (n = +o[1], "#" == (r = o[2])) {
                if (n >= t) throw new Error("Cannot access property/index " + n + " levels up, current level is " + t);
                return i[t - n]
            }
            if (n > t) throw new Error("Cannot access data " + n + " levels up, current level is " + t);
            if (a = "data" + (t - n || ""), !r) return a
        }
        for (var s = a, l = r.split("/"), c = 0; c < l.length; c++) {
            var h = l[c];
            h && (a += u(T(h)), s += " && " + a)
        }
        return s
    }

    function S(e, t) {
        return '""' == e ? t : (e + " + " + t).replace(/' \+ '/g, "")
    }

    function x(e) {
        return T(decodeURIComponent(e))
    }

    function y(e) {
        return encodeURIComponent(C(e))
    }

    function C(e) {
        return e.replace(/~/g, "~0").replace(/\//g, "~1")
    }

    function T(e) {
        return e.replace(/~1/g, "/").replace(/~0/g, "~")
    }
    e.exports = {
        copy: n,
        checkDataType: r,
        checkDataTypes: a,
        coerceToTypes: o,
        toHash: s,
        getProperty: u,
        escapeQuotes: l,
        equal: i(702),
        ucs2length: i(1141),
        varOccurences: c,
        varReplace: h,
        cleanUpCode: d,
        finalCleanUpCode: f,
        schemaHasRules: p,
        schemaHasRulesExcept: m,
        toQuotedString: g,
        getPathExpr: v,
        getPath: _,
        getData: b,
        unescapeFragment: x,
        unescapeJsonPointer: T,
        escapeFragment: y,
        escapeJsonPointer: C
    };
    var w = s(["string", "number", "integer", "boolean", "null"]),
        M = /^[a-z$_][a-z$_0-9]*$/i,
        E = /'|\\/g,
        A = /else\s*{\s*}/g,
        P = /if\s*\([^)]+\)\s*\{\s*\}(?!\s*else)/g,
        R = /if\s*\(([^)]+)\)\s*\{\s*\}\s*else(?!\s*if)/g,
        O = /[^v.]errors/g,
        I = /var errors = 0;|var vErrors = null;|validate.errors = vErrors;/g,
        F = /var errors = 0;|var vErrors = null;/g,
        N = "return errors === 0;",
        D = "validate.errors = null; return true;",
        L = /if \(errors === 0\) return data;\s*else throw new ValidationError\(vErrors\);/,
        k = "return data;",
        V = /[^A-Za-z_$]rootData[^A-Za-z0-9_$]/g,
        B = /if \(rootData === undefined\) rootData = data;/,
        U = /^\/(?:[^~]|~0|~1)*$/,
        G = /^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/
}, function (e, t, i) {
    "use strict";
    i.d(t, "a", function () {
        return h
    }), i.d(t, "d", function () {
        return m
    }), i.d(t, "b", function () {
        return g
    }), i.d(t, "c", function () {
        return _
    });
    var n, r = i(9),
        a = i(230),
        o = i(159),
        s = i(712),
        u = i(20),
        l = r.a.osg,
        c = r.a.osgAnimation,
        h = function (e) {
            n = e.getViewerWebGL().getRootModel()
        },
        d = null !== Object(u.a)().apiVersion,
        f = function (e) {
            var t = e.get("sticky");
            if (void 0 !== t) return t;
            var i = e.get("geometryUid");
            if (i < 0) return e.set("sticky", null), null;
            var n = a.a.uidGeometryMap[i];
            return n ? d ? (e.set("sticky", n), n) : n instanceof c.RigGeometry || n instanceof c.MorphGeometry || Object(s.a)(n) ? (e.set("sticky", n), n) : (e.set("sticky", null), null) : (e.set("sticky", null), null)
        },
        p = function () {
            var e = l.vec3.create(),
                t = l.mat4.create();
            return function (i) {
                var r = i.get("lastComputedScenePosition"),
                    a = f(i);
                if (!a) return l.vec3.copy(r, i.get("position"));
                var o = i.get("indices"),
                    s = o[0],
                    u = o[1],
                    c = o[2];
                if (a.getWorldMatrix(n, t), s < 0 || !a.computeTransformedVertex) return l.vec3.transformMat4(r, i.get("localPosition"), t);
                var h = a.getVertexAttributeList().Vertex.getElements(),
                    d = h.length / 3;
                if (s >= d || u >= d || c >= d) return l.vec3.copy(r, i.get("position"));
                var p = i.get("barycentricWeights"),
                    m = p[0],
                    g = p[1],
                    v = p[2];
                return l.vec3.init(r), a.computeTransformedVertex(s, e), l.vec3.scaleAndAdd(r, r, e, m), u >= 0 && (a.computeTransformedVertex(u, e), l.vec3.scaleAndAdd(r, r, e, g)), c >= 0 && (a.computeTransformedVertex(c, e), l.vec3.scaleAndAdd(r, r, e, v)), l.vec3.transformMat4(r, r, t), r
            }
        }(),
        m = function (e) {
            p(e);
            var t = e.get("lastComputedScenePosition"),
                i = e.get("lastComputedWorldPosition");
            return o.a.getWorldPositionFromScenePoint(t, i)
        },
        g = function (e, t) {
            o.a.getScenePositionFromHit(t, e.get("position"));
            var i = t._nodePath[t._nodePath.length - 1],
                n = void 0 !== i._uniqueID ? i._uniqueID : -1;
            e.set("geometryUid", n);
            var r = e.get("localPosition");
            r[0] = t._localIntersectionPoint[0], r[1] = t._localIntersectionPoint[1], r[2] = t._localIntersectionPoint[2];
            var a = e.get("indices");
            a[0] = t._i1, a[1] = t._i2, a[2] = t._i3;
            var s = e.get("barycentricWeights");
            s[0] = t._r1, s[1] = t._r2, s[2] = t._r3
        },
        v = function (e) {
            e.set("geometryUid", -1), l.vec3.set(e.get("indices"), -1, -1, -1), l.vec3.init(e.get("barycentricWeights")), l.vec3.init(e.get("localPosition"))
        },
        _ = function (e, t) {
            var i = e.get("position");
            o.a.getScenePositionFromWorldPoint(t, i), l.vec3.copy(e.get("lastComputedScenePosition"), i), l.vec3.copy(e.get("lastComputedWorldPosition"), t), v(e)
        }
}, function (e, t) {
    ! function () {
        (window.nunjucksPrecompiled = window.nunjucksPrecompiled || {})["skfb_front/macros/components/molecules/popup.jinja"] = function () {
            function e(e, t, i, n, r) {
                var a = "";
                try {
                    var o = null,
                        s = n.makeMacro([], ["options"], function (r) {
                            var a = i;
                            i = new n.Frame, r = r || {}, r.hasOwnProperty("caller") && i.set("caller", r.caller), i.set("options", r.hasOwnProperty("options") ? r.options : {});
                            var o = "";
                            return o += '\n    <section\n        style="', o += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "width") ? "width:" + n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "width") + "px" : "", e.opts.autoescape), o += '"\n        class="c-popup ', o += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "className"), e.opts.autoescape), o += '">\n        ', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "title") && (o += '\n            <header class="c-popup__header">\n                <div class="c-popup__title">\n                    ', o += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "title"), e.opts.autoescape), o += '\n                </div>\n\n                <div class="c-popup__actions">\n                    ', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "isClosable") && (o += '\n                        <a class="c-popup__close" data-action="close">\n                            <i class="fa fa-times"></i>\n                        </a>\n                    '), o += "\n                </div>\n            </header>\n        "), o += '\n\n        <div class="c-popup__content">\n            ', o += n.suppressValue(e.getFilter("component").call(t, n.memberLookup(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "components"), "child")), e.opts.autoescape), o += "\n        </div>\n    </section>\n", i = a, new n.SafeString(o)
                        });
                    t.addExport("popup"), t.setVariable("popup", s), a += "\n", o ? o.rootRenderFunc(e, t, i, n, r) : r(null, a)
                } catch (e) {
                    r(n.handleError(e, null, null))
                }
            }
            return {
                root: e
            }
        }()
    }()
}, , , , , , , , function (e, t, i) {
    "use strict";
    var n = i(11);
    t.a = n.a.extend({})
}, function (e, t, i) {
    "use strict";
    var n = i(644),
        r = i.n(n),
        a = i(645),
        o = i.n(a),
        s = i(646),
        u = i.n(s);
    i.d(t, "a", function () {
        return r.a
    }), r.a.extend(o.a), r.a.extend(u.a);
    var l = function (e) {
            if ("number" == typeof e) return e;
            var t = new Date(e);
            return t.getTime() - 60 * t.getTimezoneOffset() * 1e3
        },
        c = function (e, t, i) {
            t.prototype.isValid = function () {
                return !isNaN(this.$s)
            }, i.utc = function (e) {
                return r()(l(e))
            };
            var n = t.prototype.format;
            t.prototype.format = function () {
                if (!this.isValid()) return this.toString();
                for (var e = arguments.length, t = Array(e), i = 0; i < e; i++) t[i] = arguments[i];
                return n.call.apply(n, [this].concat(t))
            }
        };
    r.a.extend(c)
}, , , , , function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(100)),
        a = function (e, t) {
            return Math.min(e, Math.max(0, parseInt(t) || 0))
        },
        o = function () {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "";
            return Object(r.a)(e.split("?")[1] || "").page
        },
        s = function () {
            var e = {};
            return {
                get: function (t) {
                    return e[t]
                },
                update: function (t) {
                    (arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : []).forEach(function (i) {
                        e[i.uid] = t
                    })
                }
            }
        },
        u = function (e, t) {
            var i = function () {
                    var t = Object(n.isNumber)(e.lastPage) ? e.lastPage : 0,
                        i = a(t, e.firstPage);
                    return {
                        lastPage: t,
                        currentPageIndex: i,
                        hasPrevious: 0 !== i
                    }
                },
                r = s(),
                u = i(),
                l = function (e) {
                    return function (t) {
                        return r.update(e, t.results), u.currentPageIndex = e, t.previous || (u.hasPrevious = !1), t.next ? u.lastPage = 1 / 0 : u.lastPage = e, t
                    }
                };
            return {
                type: "offset",
                loadPrevious: function (e) {
                    var i = a(u.lastPage, u.currentPageIndex - 1);
                    return t(i, e).then(l(i))
                },
                loadNext: function (e) {
                    var i = a(u.lastPage, u.currentPageIndex + 1);
                    return t(i, e).then(l(i))
                },
                loadFirst: function (e) {
                    u = i(), r = s();
                    return t(0, e).then(l(0))
                },
                reset: function () {
                    u = i()
                },
                hasPrevious: function () {
                    return u.hasPrevious
                },
                hasNext: function () {
                    return u.currentPageIndex + 1 < u.lastPage
                },
                isFirst: function () {
                    return 0 === u.currentPageIndex
                },
                getQueryParamsForElementUid: function (e) {
                    return {
                        page: r.get(e) || ""
                    }
                },
                getQueryParams: function () {
                    return {
                        page: u.currentPageIndex
                    }
                },
                setInitialQuery: function () {
                    var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "",
                        t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
                        i = o(e);
                    r.update(i, t.results)
                }
            }
        };
    t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(7),
        r = i.n(n),
        a = i(100),
        o = function () {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "";
            return Object(a.a)(e.split("?")[1] || "").cursor
        },
        s = function () {
            var e = {};
            return {
                get: function (t) {
                    return e[t]
                },
                update: function (t) {
                    (arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : []).forEach(function (i) {
                        e[i.uid] = t
                    })
                }
            }
        },
        u = function (e, t) {
            var i = function () {
                    return {
                        previousCursor: e.previous || null,
                        currentCursor: e.current,
                        nextCursor: e.next || null
                    }
                },
                n = s(),
                a = i(),
                u = function (e, t) {
                    return function (i) {
                        return n.update(e, i.results), a.currentCursor = e, t.setNext && (a.nextCursor = i.next ? o(i.next) : null), t.setPrevious && (a.previousCursor = i.previous ? o(i.previous) : null), i
                    }
                };
            return {
                type: "cursor",
                loadPrevious: function (e) {
                    return t(a.previousCursor, e).then(u(a.previousCursor, r()({}, e, {
                        setPrevious: !0
                    })))
                },
                loadNext: function (e) {
                    return t(a.nextCursor, e).then(u(a.nextCursor, r()({}, e, {
                        setNext: !0
                    })))
                },
                loadFirst: function (e) {
                    return a = i(), n = s(), t(a.currentCursor, e).then(u(a.current, r()({}, e, {
                        setNext: !0,
                        setPrevious: !0
                    })))
                },
                reset: function () {
                    a = i()
                },
                hasPrevious: function () {
                    return null !== a.previousCursor
                },
                hasNext: function () {
                    return null !== a.nextCursor
                },
                isFirst: function () {
                    return a.currentCursor === e.current
                },
                getQueryParamsForElementUid: function (e) {
                    return {
                        cursor: n.get(e)
                    }
                },
                getQueryParams: function () {
                    return {
                        cursor: a.currentCursor
                    }
                },
                setInitialQuery: function () {
                    var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "",
                        t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
                        i = o(e);
                    n.update(i, t.results)
                }
            }
        };
    t.a = u
}, function (e, t, i) {
    "use strict";

    function n(e, t, i) {
        var n = [],
            a = Object(r.debounce)(function () {
                var e = n.slice();
                n = [], i.trigger(t, e)
            }, 20),
            o = function (e) {
                n.push(e), a()
            };
        return i.on(e, o),
            function () {
                i.off(e, o)
            }
    }
    t.a = n;
    var r = i(0);
    i.n(r)
}, function (e, t, i) {
    "use strict";
    var n = i(11);
    t.a = n.a.extend({})
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(3)),
        a = i.n(r),
        o = i(24),
        s = i.n(o),
        u = i(1459),
        l = i.n(u),
        c = function (e, t) {
            if (Array.isArray(e)) this.shortcuts = e || [];
            else {
                if (!Object(n.isObject)(e)) throw new Error("Shortcut manager needs a shortcut object to function");
                this.shortcutGroup = e, this.shortcuts = e.shortcuts || []
            }
            this.options = t || {}, this.handlers = {}, this.options = Object(n.defaults)({}, this.options, {
                listen: !1
            }), this.options.listen && this.listen()
        },
        h = new l.a;
    h.stopCallback = function (e, t) {
        return !((" " + t.className + " ").indexOf(" mousetrap ") > -1) && ("button" === document.activeElement.tagName.toLowerCase() || ("INPUT" === t.tagName || "SELECT" === t.tagName || "TEXTAREA" === t.tagName || t.contentEditable && "true" === t.contentEditable))
    }, Object(n.extend)(c.prototype, s.a.Events), c.prototype.listen = function (e) {
        void 0 === e ? this.shortcuts.forEach(this._listen.bind(this)) : Array.isArray(e) ? (this.shortcuts = this.shortcuts.concat(e), e.forEach(this._listen.bind(this))) : this._listen(e)
    }, c.prototype.stopListening = function (e) {
        e.forEach(function (e) {
            h.unbind(this._getShortcut(e).keyCombinations), delete this.handlers[e]
        }.bind(this))
    }, c.prototype.getTitle = function () {
        return this.shortcutGroup ? this.shortcutGroup.name || "" : ""
    }, c.prototype.getShortcut = function (e) {
        return this.shortcuts.filter(function (t) {
            return t.id === e
        })[0] || ""
    }, c.prototype.getShortDescriptionById = function (e) {
        var t = "";
        return this.shortcuts.forEach(function (i) {
            i.id === e && (t = this._formatKeyCombination(i.keyCombinations).replace("<br />", ""))
        }.bind(this)), t
    }, c.prototype.generateHelpSection = function () {
        var e = a()("<div />"),
            t = this.getTitle();
        return t && e.append("<h2>" + t + "</h2>"), this.shortcuts.filter(this._validate).forEach(function (t) {
            t.name && e.append("<b>" + t.name + "</b>"), e.append(this._formatKeyCombination(t.keyCombinations))
        }.bind(this)), e.html() || ""
    }, c.prototype.hasKeyCombination = function (e) {
        var t = !1;
        return this.shortcuts.forEach(function (i) {
            t || (Array.isArray(i.shortcuts) ? i.shortcuts.forEach(function (i) {
                t = i === e
            }) : t = i.shortcuts === e)
        }), t
    }, c.prototype._formatKeyCombination = function (e) {
        return [].concat(e).map(function (e) {
            return "<kbd>" + e + "</kbd>"
        }).join(" or ") + "<br />"
    }, c.prototype._listen = function (e) {
        this._validate(e) && !this.handlers[e.id] && (this.handlers[e.id] = this._notify.bind(this, e), h.bind(e.keyCombinations, this.handlers[e.id]))
    }, c.prototype._getShortcut = function (e) {
        return Object(n.find)(this.shortcuts, function (t) {
            return t.id === e
        })
    }, c.prototype._validate = function (e) {
        return !!e.keyCombinations && !!e.id
    }, c.prototype._notify = function (e, t) {
        this.trigger(e.id, e, t)
    }, t.a = c
}, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , function (e, t, i) {
    "use strict";
    var n = i(10),
        r = i(177),
        a = function (e, t, i, a) {
            var o = t,
                s = void 0 !== a ? a : e.length;
            void 0 === o && (o = !0);
            var u = i || n.c.create(),
                l = 0;
            if (o) {
                for (l = s - 1; l >= 0; l--) {
                    var c = e[l];
                    if ("Camera" === c.className() && (c.getReferenceFrame() !== r.a.RELATIVE_RF || 0 === c.getParents().length)) break
                }
                l += 1
            }
            for (var h = l, d = s; h < d; h++) {
                var f = e[h];
                f.computeLocalToWorldMatrix && f.computeLocalToWorldMatrix(u)
            }
            return u
        };
    t.a = {
        computeLocalToWorld: a
    }
}, function (e, t, i) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: !0
    });
    var n = i(9),
        r = n.a.osg,
        a = !0,
        o = r.Timer.prototype.tick,
        s = function () {
            this.children = [], this.message = "", this.parent = this
        },
        u = {},
        l = {},
        c = new s,
        h = c,
        d = function (e) {
            console.log("%c" + e, "color:purple")
        };
    r.time = function (e) {
        var t = new s;
        u[e] = t, t.start = o(), a && (h.children.push(t), t.parent = h, h = t, t.timerMessage = e)
    }, r.timeEnd = function (e) {
        var t = u[e],
            i = e + " : " + (o() - t.start).toFixed(2) + "ms";
        if (!a) return void l.logMessage(i);
        h = t.parent || c, t.message = i
    };
    var f = function (e, t) {
        var i = !e.message,
            n = e.children,
            r = "";
        e !== c && n.length > 0 && (r = t + e.timerMessage + (i ? "(pending)\n\n" : "\n"));
        for (var a = e === c || i ? "" : "  |  ", o = 0; o < n.length; ++o) r += f(n[o], t + a) + "\n";
        var s = e.parent === c || !e.parent.message,
            u = s && e.timerMessage ? "\n" : "";
        return r + (t + e.message) + u
    };
    l.showMessage = function () {
        var e = f(c, "");
        e = e.replace(/(\n*$)/, ""), e += "\n\n<<<<< Model Displayed! " + (window.performance && window.performance.now ? (window.performance.now() / 1e3).toString() : "") + ">>>>>", d(e), a = !1
    }, l.logBound = function (e) {
        var t = e.center(r.vec3.create()),
            i = "Bound center : [ " + t[0] + ", " + t[1] + ", " + t[2] + " ]\n";
        i += "Bound radius : " + e.radius() + "\n";
        var n = e.getMin(),
            a = e.getMax();
        i += "Bbox min : [ " + n[0] + ", " + n[1] + ", " + n[2] + " ]\n", i += "Bbox max : [ " + a[0] + ", " + a[1] + ", " + a[2] + " ]\n", l.logMessage(i)
    }, l.logMessage = function (e) {
        if (!a) return d(e);
        var t = new s;
        t.message = e, h.children.push(t), t.parent = h
    }, t.default = l
}, function (e, t, i) {
    "use strict";
    var n = function () {
        n.prototype.reset.call(this)
    };
    n.prototype = {
        reset: function () {
            this._computeNearFar = !0, this._nearFarRatio = .005, this._enableFrustumCulling = !1, this._settingsSourceOverrider = this, this._LODScale = 1, this._clampProjectionMatrixCallback = void 0
        },
        setCullSettings: function (e) {
            this._computeNearFar = e._computeNearFar, this._nearFarRatio = e._nearFarRatio, this._enableFrustumCulling = e._enableFrustumCulling, this._settingsSourceOverrider = e._settingsSourceOverrider, this._clampProjectionMatrixCallback = e._clampProjectionMatrixCallback
        },
        setNearFarRatio: function (e) {
            this._nearFarRatio = e
        },
        getNearFarRatio: function () {
            return this._nearFarRatio
        },
        setComputeNearFar: function (e) {
            this._computeNearFar = e
        },
        getComputeNearFar: function () {
            return this._computeNearFar
        },
        setEnableFrustumCulling: function (e) {
            this._enableFrustumCulling = e
        },
        getEnableFrustumCulling: function () {
            return this._enableFrustumCulling
        },
        getSettingSourceOverrider: function () {
            return this._settingsSourceOverrider
        },
        setClampProjectionMatrixCallback: function (e) {
            this._clampProjectionMatrixCallback = e
        },
        getClampProjectionMatrixCallback: function () {
            return this._clampProjectionMatrixCallback
        },
        setLODScale: function (e) {
            this._LODScale = e
        },
        getLODScale: function () {
            return this._LODScale
        }
    }, t.a = n
}, function (e, t, i) {
    "use strict";
    var n = i(36),
        r = i(12),
        a = i(446),
        o = i(84),
        s = i(573),
        u = i(850),
        l = i(10),
        c = i(198),
        h = i(679),
        d = i(682),
        f = i(683),
        p = i(844),
        m = i(160),
        g = i(851),
        v = i(575),
        _ = i(616),
        b = i(137),
        S = i(684),
        x = i(852),
        y = i(685),
        C = i(197),
        T = i(177),
        w = i(617),
        M = i(452),
        E = i(451),
        A = i(364),
        P = i(290),
        R = i(318),
        O = function () {
            return new g.a
        },
        I = function () {
            return new s.a
        },
        F = function () {
            o.a.call(this, o.a.TRAVERSE_ACTIVE_CHILDREN), s.a.call(this), u.a.call(this), this._rootStateGraph = void 0, this._currentStateGraph = void 0, this._currentRenderBin = void 0, this._currentRenderStage = void 0, this._rootRenderStage = void 0, this._computedNear = Number.POSITIVE_INFINITY, this._computedFar = Number.NEGATIVE_INFINITY, this._camera = void 0, this._pooledLeaf = new R.a(O), this._pooledRenderStages = {}, this._pooledCullSettings = new R.a(I), this._renderBinStack = new P.a, this.visitorType = o.a.CULL_VISITOR, this._identityMatrix = l.c.create(), this._renderer = void 0, this._renderStageType = _.a, this._numCamera = 0, this._numMatrixTransform = 0, this._numProjection = 0, this._numNode = 0, this._numLightSource = 0, this._numGeometry = 0
        };
    F.registerApplyFunction = p.default.registerApplyFunction, F.getApplyFunction = p.default.getApplyFunction, r.a.createPrototypeObject(F, r.a.objectInherit(u.a.prototype, r.a.objectInherit(o.a.prototype, {
        applyFunctionArray: p.default.applyFunctionArray,
        distance: function (e, t) {
            return -(e[0] * t[2] + e[1] * t[6] + e[2] * t[10] + t[14])
        },
        getComputedNear: function () {
            return this._computedNear
        },
        getComputedFar: function () {
            return this._computedFar
        },
        resetStats: function () {
            this._numCamera = 0, this._numMatrixTransform = 0, this._numProjection = 0, this._numNode = 0, this._numLightSource = 0, this._numGeometry = 0
        },
        handleCullCallbacksAndTraverse: function (e) {
            var t = e.getCullCallback();
            t && !t.cull(e, this) || this.traverse(e)
        },
        getCurrentCamera: function () {
            return this._currentRenderBin.getStage().getCamera()
        },
        updateCalculatedNearFar: function () {
            var e = l.f.create(),
                t = l.f.create();
            return function (i, n) {
                var r, a, o = n.getBoundingBox();
                if (r = this.distance(o.corner(this._bbCornerNear, e), i), a = this.distance(o.corner(this._bbCornerFar, t), i), r > a) {
                    var s = r;
                    r = a, a = s
                }
                return !(a < 0) && (r < this._computedNear && (this._computedNear = r), a > this._computedFar && (this._computedFar = a), !0)
            }
        }(),
        setStateGraph: function (e) {
            this._rootStateGraph = e, this._currentStateGraph = e
        },
        setRenderStage: function (e) {
            this._rootRenderStage = e, this._currentRenderBin = e
        },
        setRenderer: function (e) {
            this._renderer = e
        },
        getRenderer: function () {
            return this._renderer
        },
        reset: function () {
            u.a.prototype.reset.call(this), this._pooledLeaf.reset(), this._pooledCullSettings.reset();
            for (var e in this._pooledRenderStages) this._pooledRenderStages[e].reset();
            v.a.reset(), this._computedNear = Number.POSITIVE_INFINITY, this._computedFar = Number.NEGATIVE_INFINITY
        },
        getCurrentRenderBin: function () {
            return this._currentRenderBin
        },
        setCurrentRenderBin: function (e) {
            this._currentRenderBin = e
        },
        addPositionedAttribute: function (e, t) {
            var i = e || this._identityMatrix;
            this._currentRenderBin.getStage().addPositionAttribute(i, t)
        },
        pushStateSet: function (e) {
            if (this._currentStateGraph = this._currentStateGraph.findOrInsert(e), void 0 !== e.getBinName()) {
                var t = this._renderBinStack,
                    i = this._currentRenderBin;
                t.push(i), this._currentRenderBin = i.getStage().findOrInsert(e.getBinNumber(), e.getBinName())
            }
        },
        popStateSet: function () {
            var e = this._currentStateGraph,
                t = e.getStateSet();
            if (this._currentStateGraph = e.getParent(), void 0 !== t.getBinName()) {
                var i = this._renderBinStack;
                0 === i.getLength() ? this._currentRenderBin = this._currentRenderBin.getStage() : this._currentRenderBin = i.pop()
            }
        },
        popProjectionMatrix: function () {
            if (!0 === this._computeNearFar && this._computedFar >= this._computedNear) {
                var e = this.getCurrentProjectionMatrix();
                void 0 !== this._clampProjectionMatrixCallback ? this._clampProjectionMatrixCallback(e, this._computedNear, this._computedFar, this._nearFarRatio) : this.clampProjectionMatrix(e, this._computedNear, this._computedFar, this._nearFarRatio)
            }
            u.a.prototype.popProjectionMatrix.call(this)
        },
        clampProjectionMatrix: function (e, t, i, r, a) {
            if (i < t - 1e-6) return n.a.log("clampProjectionMatrix not applied, invalid depth range, znear = " + t + "  zfar = " + i, !1, !0), !1;
            var o, s;
            if (i < t + 1e-6) {
                var u = .5 * (t + i);
                t = u - 1e-6, i = u + 1e-6
            }
            if (Math.abs(e[3]) < 1e-6 && Math.abs(e[7]) < 1e-6 && Math.abs(e[11]) < 1e-6) {
                var l = .02 * (i - t);
                l < 1 && (l = 1), o = t - l, s = i + l, t = o, i = s, e[10] = -2 / (s - o), e[14] = -(s + o) / (s - o)
            } else {
                o = .98 * t, s = 1.02 * i;
                var c = i * r;
                o < c && (o = c), t = o, i = s;
                var h = e[10],
                    d = e[14],
                    f = e[11],
                    p = e[15],
                    m = (-o * h + d) / (-o * f + p),
                    g = (-s * h + d) / (-s * f + p),
                    v = Math.abs(2 / (m - g)),
                    _ = -(m + g) / 2,
                    b = _ * v;
                e[2] = e[2] * v + e[3] * b, e[6] = e[6] * v + e[7] * b, e[10] = h * v + f * b, e[14] = d * v + p * b
            }
            return void 0 !== a && (a[0] = t, a[1] = i), !0
        },
        popCameraModelViewProjectionMatrix: function () {
            this.popModelViewMatrix(), this.popProjectionMatrix()
        },
        pushCameraModelViewProjectionMatrix: function (e, t, i) {
            this.pushModelViewMatrix(t), this.pushProjectionMatrix(i)
        },
        apply: function (e) {
            this.applyFunctionArray[e.nodeTypeID].call(this, e)
        },
        createOrReuseRenderLeaf: function () {
            return this._pooledLeaf.getOrCreateObject()
        },
        createOrReuseRenderStage: function (e) {
            var t = e ? e.className() : "RenderStage";
            if (!this._pooledRenderStages[t]) {
                var i = e ? e.constructor : _.a,
                    n = function () {
                        return new i
                    };
                this._pooledRenderStages[t] = new R.a(n)
            }
            return this._pooledRenderStages[t].getOrCreateObject().init()
        },
        postPushGeometry: function (e, t) {
            var i, n;
            t instanceof M.a ? (n = t.getStateSetAnimation(), n && e.pushStateSet(n), (i = t.getSourceGeometry()) instanceof A.a && (n = i.getStateSetAnimation()) && e.pushStateSet(n)) : t instanceof A.a && (n = t.getStateSetAnimation()) && e.pushStateSet(n)
        },
        prePopGeometry: function (e, t) {
            if (t instanceof M.a) {
                var i = t.getSourceGeometry();
                i instanceof A.a && i.getStateSetAnimation() && e.popStateSet(), t.getStateSetAnimation() && e.popStateSet()
            } else t instanceof A.a && t.getStateSetAnimation() && e.popStateSet()
        },
        pushLeaf: function (e, t) {
            var i = this._currentStateGraph.getLeafs();
            i.getLength() || this._currentRenderBin.addStateGraph(this._currentStateGraph);
            var n = this.createOrReuseRenderLeaf();
            n.init(this._currentStateGraph, e, this.getCurrentProjectionMatrix(), this.getCurrentViewMatrix(), this.getCurrentModelViewMatrix(), this.getCurrentModelMatrix(), t), i.push(n)
        }
    })), "osg", "CullVisitor");
    var N = function (e) {
            this._numCamera++;
            var t = e.getStateSet();
            t && this.pushStateSet(t);
            var i = this._pooledMatrix.getOrCreateObject(),
                n = this._pooledMatrix.getOrCreateObject();
            if (e.getReferenceFrame() === T.a.RELATIVE_RF) {
                var r = this.getCurrentProjectionMatrix();
                l.c.mul(n, r, e.getProjectionMatrix());
                var a = this.getCurrentModelViewMatrix();
                l.c.mul(i, a, e.getViewMatrix())
            } else l.c.copy(i, e.getViewMatrix()), l.c.copy(n, e.getProjectionMatrix());
            var o = this._computedNear,
                s = this._computedFar,
                u = this._pooledCullSettings.getOrCreateObject();
            if (u.reset(), u.setCullSettings(this), this._computedNear = Number.POSITIVE_INFINITY, this._computedFar = Number.NEGATIVE_INFINITY, this.setCullSettings(e), u.getSettingSourceOverrider() === this && u.getEnableFrustumCulling() && this.setEnableFrustumCulling(!0), this.pushCameraModelViewProjectionMatrix(e, i, n), e.getViewport() && this.pushViewport(e.getViewport()), e.getRenderOrder() === C.a.NESTED_RENDER) this.handleCullCallbacksAndTraverse(e);
            else {
                var c = this.getCurrentRenderBin(),
                    h = c.getStage(),
                    d = this.createOrReuseRenderStage(this._rootRenderStage);
                d.setCamera(e), d.setClearDepth(e.getClearDepth()), d.setClearColor(e.getClearColor()), d.setClearMask(e.getClearMask());
                var f = e.getViewport() ? e.getViewport() : h.getViewport(),
                    p = e.getScissor() ? e.getScissor() : h.getScissor();
                d.setViewport(f), d.setScissor(p), this.setCurrentRenderBin(d), this.handleCullCallbacksAndTraverse(e), this.setCurrentRenderBin(c), e.getRenderOrder() === C.a.PRE_RENDER ? this.getCurrentRenderBin().getStage().addPreRenderStage(d, e.renderOrderNum) : this.getCurrentRenderBin().getStage().addPostRenderStage(d, e.renderOrderNum)
            }
            this.popCameraModelViewProjectionMatrix(e), e.getViewport() && this.popViewport(), this.setCullSettings(u), this._computedNear = o, this._computedFar = s, t && this.popStateSet()
        },
        D = function (e) {
            if (this._numMatrixTransform++, !this.isCulled(e, this.nodePath)) {
                this.pushCurrentMask();
                var t = this._pooledMatrix.getOrCreateObject(),
                    i = this.getCurrentModelViewMatrix();
                l.c.copy(t, i), e.computeLocalToWorldMatrix(t), this.pushModelViewMatrix(t);
                var n = e.getStateSet();
                n && this.pushStateSet(n), this.handleCullCallbacksAndTraverse(e), n && this.popStateSet(), this.popModelViewMatrix(), this.popCurrentMask()
            }
        },
        L = function (e) {
            this._numProjection++;
            var t = this.getCurrentProjectionMatrix(),
                i = this._pooledMatrix.getOrCreateObject();
            l.c.mul(i, t, e.getProjectionMatrix()), this.pushProjectionMatrix(i);
            var n = e.getStateSet();
            n && this.pushStateSet(n), this.handleCullCallbacksAndTraverse(e), n && this.popStateSet(), this.popProjectionMatrix()
        },
        k = function (e) {
            if (this._numNode++, !this.isCulled(e, this.nodePath)) {
                this.pushCurrentMask();
                var t = e.getStateSet();
                t && this.pushStateSet(t), this.handleCullCallbacksAndTraverse(e), t && this.popStateSet(), this.popCurrentMask()
            }
        },
        V = function (e) {
            this._numLightSource++;
            var t = e.getStateSet();
            t && this.pushStateSet(t);
            var i = e.getLight();
            i && (e.getReferenceFrame() === T.a.RELATIVE_RF ? this.addPositionedAttribute(this.getCurrentModelViewMatrix(), i) : this.addPositionedAttribute(null, i)), this.handleCullCallbacksAndTraverse(e), t && this.popStateSet()
        },
        B = l.f.create(),
        U = !1,
        G = function (e) {
            this._numGeometry++;
            var t = this.getCurrentModelViewMatrix(),
                i = e.getBoundingBox();
            if (!this._computeNearFar || !i.valid() || this.updateCalculatedNearFar(t, e)) {
                var r = e.getCullCallback();
                if (!r || r.cull(e, this)) {
                    var o = e.getStateSet();
                    o && this.pushStateSet(o), this.postPushGeometry(this, e);
                    var s = 0;
                    i.valid() && (s = this.distance(i.center(B), t)), a.a.isNaN(s) ? U || (n.a.warn("warning geometry has a NaN depth, " + t + " center " + B), U = !0) : this.pushLeaf(e, s), this.prePopGeometry(this, e), o && this.popStateSet()
                }
            }
        };
    p.default.registerApplyFunction(b.a.nodeTypeID, k), p.default.registerApplyFunction(x.a.nodeTypeID, k), p.default.registerApplyFunction(y.a.nodeTypeID, k), p.default.registerApplyFunction(C.a.nodeTypeID, N), p.default.registerApplyFunction(c.a.nodeTypeID, D), p.default.registerApplyFunction(d.a.nodeTypeID, L), p.default.registerApplyFunction(m.a.nodeTypeID, G), p.default.registerApplyFunction(w.a.nodeTypeID, D), p.default.registerApplyFunction(E.a.nodeTypeID, D), p.default.registerApplyFunction(h.a.nodeTypeID, D), p.default.registerApplyFunction(S.a.nodeTypeID, k), p.default.registerApplyFunction(f.a.nodeTypeID, V), p.default.registerApplyFunction(M.a.nodeTypeID, G), p.default.registerApplyFunction(A.a.nodeTypeID, G), t.a = F
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(36),
        a = i(102),
        o = i(446),
        s = i(318),
        u = i(290),
        l = i(614),
        c = function () {
            return [null, null]
        },
        h = function (e) {
            a.a.call(this), this._renderStage = void 0, this._parent = void 0, this._binNum = 0, this._sorted = !1, this._sortMode = void 0 !== e ? e : h.defaultSortMode, this._drawCallback = void 0, this._leafs = [], this._pooledPositionedAttribute = new s.a(c), this._positionedAttribute = new u.a, this._stateGraphList = new u.a, this._bins = new l.a, h.prototype.init.call(this, e)
        };
    h.SORT_BY_STATE = 0, h.SORT_BACK_TO_FRONT = 1, h.SORT_FRONT_TO_BACK = 2, h.defaultSortMode = h.SORT_BY_STATE;
    var d = function () {
            return new h
        },
        f = new s.a(d);
    h.BinPrototypes = {
        RenderBin: function () {
            return f.getOrCreateObject().init()
        },
        DepthSortedBin: function () {
            return f.getOrCreateObject().init(h.SORT_BACK_TO_FRONT)
        }
    };
    var p = function (e, t) {
            return t._depth - e._depth
        },
        m = function (e, t) {
            return e._depth - t._depth
        },
        g = function (e, t) {
            return e._binNum - t._binNum
        };
    n.a.createPrototypeObject(h, n.a.objectInherit(a.a.prototype, {
        init: function (e) {
            return this._renderStage = void 0, this._parent = void 0, this._binNum = 0, this._sortMode = void 0 !== e ? e : h.defaultSortMode, this._drawCallback = void 0, h.prototype._initInternal.call(this), this
        },
        _initInternal: function () {
            this._bins.reset(), this._stateGraphList.reset(), this._positionedAttribute.reset(), this._pooledPositionedAttribute.reset(), this._leafs.length = 0, this._sorted = !1
        },
        _createRenderBin: function (e) {
            var t = h.BinPrototypes.RenderBin;
            return e && h.BinPrototypes[e] && (t = h.BinPrototypes[e]), t()
        },
        addPositionAttribute: function (e, t) {
            var i = this._pooledPositionedAttribute.getOrCreateObject();
            i[0] = e, i[1] = t, this._positionedAttribute.push(i)
        },
        getStateGraphList: function () {
            return this._stateGraphList
        },
        getPositionedAttribute: function () {
            return this._positionedAttribute
        },
        copyLeavesFromStateGraphListToRenderLeafList: function () {
            this._leafs.length = 0;
            for (var e = !1, t = this._stateGraphList.getArray(), i = this._stateGraphList.getLength(), n = 0; n < i; n++)
                for (var a = t[n]._leafs, s = a.getArray(), u = a.getLength(), l = 0; l < u; l++) {
                    var c = s[l];
                    o.a.isNaN(c._depth) ? e = !0 : this._leafs.push(c)
                }
            e && r.a.debug("warning: RenderBin::copyLeavesFromStateGraphListToRenderLeafList() detected NaN depth values, database may be corrupted."), this._stateGraphList.reset()
        },
        getSortMode: function () {
            return this._sortMode
        },
        sortBackToFront: function () {
            this.copyLeavesFromStateGraphListToRenderLeafList(), this._leafs.sort(p)
        },
        sortFrontToBack: function () {
            this.copyLeavesFromStateGraphListToRenderLeafList(), this._leafs.sort(m)
        },
        sortImplementation: function () {
            var e = h;
            switch (this._sortMode) {
                case e.SORT_BACK_TO_FRONT:
                    this.sortBackToFront();
                    break;
                case e.SORT_FRONT_TO_BACK:
                    this.sortFrontToBack();
                    break;
                case e.SORT_BY_STATE:
            }
        },
        sort: function () {
            if (!this._sorted) {
                for (var e = this._bins.getKeys(), t = this._bins.getMap(), i = e.getArray(), n = e.getLength(), r = 0; r < n; r++) {
                    t[i[r]].sort()
                }
                this.sortImplementation(), this._sorted = !0
            }
        },
        setParent: function (e) {
            this._parent = e
        },
        getParent: function () {
            return this._parent
        },
        getBinNumber: function () {
            return this._binNum
        },
        findOrInsert: function (e, t) {
            var i = this._bins.getMap(),
                n = i[e];
            return n || (n = this._createRenderBin(t), n._parent = this, n._binNum = e, n._renderStage = this._renderStage, this._bins.set(e, n)), n
        },
        getStage: function () {
            return this._renderStage
        },
        addStateGraph: function (e) {
            this._stateGraphList.push(e)
        },
        reset: function () {
            h.prototype._initInternal.call(this)
        },
        draw: function (e, t) {
            var i = t;
            return i = this._drawCallback && this._drawCallback.drawImplementation ? this._drawCallback.drawImplementation(this, e, i) : this.drawImplementation(e, i)
        },
        applyPositionedAttribute: function (e, t) {
            for (var i = t.getArray(), n = t.getLength(), r = 0, a = n; r < a; r++) {
                var o = i[r],
                    s = o[1],
                    u = o[0];
                e.setGlobalDefaultAttribute(s), s.apply(e), s.applyPositionedUniform(u, e), e.haveAppliedAttribute(s)
            }
        },
        drawImplementation: function (e, t) {
            for (var i = t, n = [], r = this._bins.getMap(), a = this._bins.getKeys(), o = a.getLength(), s = a.getArray(), u = 0; u < o; u++) {
                var l = s[u];
                n.push(r[l])
            }
            n.sort(g);
            for (var c, h = 0, d = n.length; h < d && (c = n[h], !(c.getBinNumber() > 0)); h++) i = c.draw(e, i);
            for (i = this.drawLeafs(e, i); h < d; h++) c = n[h], i = c.draw(e, i);
            return i
        },
        drawLeafs: function (e, t) {
            for (var i, n = this._stateGraphList.getArray(), r = this._stateGraphList.getLength(), a = this._leafs, o = t, s = 0, u = a.length; s < u; s++) i = a[s], i.render(e, o), o = i;
            for (var l = 0, c = r; l < c; l++)
                for (var h = n[l], d = h._leafs.getArray(), f = h._leafs.getLength(), p = 0; p < f; p++) i = d[p], i.render(e, o), o = i;
            return o
        }
    }), "osg", "RenderBin"), h.reset = function () {
        f.reset()
    }, h.clean = function () {
        f.clean()
    }, t.a = h
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(10),
        a = i(577),
        o = function () {
            a.a.call(this), this._stackedTransforms = [], this._matrix = r.c.create(), this._dirty = !1
        };
    n.a.createPrototypeObject(o, n.a.objectInherit(a.a.prototype, {
        getStackedTransforms: function () {
            return this._stackedTransforms
        },
        setMatrix: function (e) {
            r.c.copy(this._matrix, e), this._dirty = !0
        },
        getMatrix: function () {
            return this._matrix
        },
        computeChannels: function () {
            this._dirty = !0;
            var e = this._matrix;
            r.c.identity(e);
            for (var t = this._stackedTransforms, i = 0, n = t.length; i < n; i++) {
                t[i].applyToMatrix(e)
            }
        },
        reset: function () {
            for (var e = this._stackedTransforms, t = 0, i = e.length; t < i; t++) e[t].resetToDefaultValue();
            this.computeChannels()
        },
        update: function (e) {
            return r.c.copy(e.getMatrix(), this._matrix), this._dirty && (e.dirtyBound(), this._dirty = !1), !0
        }
    }), "osgAnimation", "UpdateMatrixTransform"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(102),
        a = i(198),
        o = function () {
            r.a.call(this)
        };
    o.checkPathIsAnimated = function (e) {
        for (var t = 0, i = e.length; t < i; ++t) {
            var n = e[t];
            if (n instanceof a.a)
                for (var r = n.getUpdateCallbackList(), s = 0, u = r.length; s < u; ++s)
                    if (r[s] instanceof o) return !0
        }
        return !1
    }, n.a.createPrototypeObject(o, n.a.objectInherit(r.a.prototype, {
        computeChannels: function () {},
        reset: function () {}
    }), "osgAnimation", "AnimationUpdateCallback"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(36),
        r = {
            instance: function () {
                return r._instance || (r._instance = r, r._instance.plugins = new window.Map), r._instance
            },
            addReaderWriter: function (e, t) {
                void 0 !== r.instance().plugins.get(e) && n.a.warn("the '" + e + "' plugin already exists"), r.instance().plugins.set(e, t)
            },
            getReaderWriterForExtension: function (e) {
                return r.instance().plugins.get(e)
            }
        };
    t.a = r
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(84),
        a = i(10),
        o = i(318),
        s = i(290),
        u = i(177),
        l = function () {
            r.a.call(this), this._intersector = void 0, this._projectionStack = new s.a, this._modelStack = new s.a, this._viewStack = new s.a, this._windowStack = new s.a, this._pooledMatrix = new o.a(a.c.create), this.reset()
        };
    n.a.createPrototypeObject(l, n.a.objectInherit(r.a.prototype, {
        reset: function () {
            this._pooledMatrix.reset(), this._viewStack.reset(), this._modelStack.reset(), this._projectionStack.reset(), this._windowStack.reset(), this._viewStack.push(a.c.IDENTITY), this._modelStack.push(a.c.IDENTITY), this._projectionStack.push(a.c.IDENTITY), this._windowStack.push(a.c.IDENTITY)
        },
        setIntersector: function (e) {
            this._intersector = e
        },
        getIntersector: function () {
            return this._intersector
        },
        pushModelMatrix: function (e) {
            this._modelStack.push(e)
        },
        getModelMatrix: function () {
            return this._modelStack.back()
        },
        popModelMatrix: function () {
            return this._modelStack.pop()
        },
        pushViewMatrix: function (e) {
            this._viewStack.push(e)
        },
        getViewMatrix: function () {
            return this._viewStack.back()
        },
        popViewMatrix: function () {
            return this._viewStack.pop()
        },
        pushProjectionMatrix: function (e) {
            this._projectionStack.push(e)
        },
        getProjectionMatrix: function () {
            return this._projectionStack.back()
        },
        popProjectionMatrix: function () {
            return this._projectionStack.pop()
        },
        pushWindowMatrix: function (e) {
            this._windowStack.push(e)
        },
        pushWindowMatrixUsingViewport: function (e) {
            this._windowStack.push(e.computeWindowMatrix(this._pooledMatrix.getOrCreateObject()))
        },
        getWindowMatrix: function () {
            return this._windowStack.back()
        },
        popWindowMatrix: function () {
            return this._windowStack.pop()
        },
        getTransformation: function () {
            var e = a.c.create64();
            return function () {
                return a.c.copy(e, this.getWindowMatrix()), a.c.mul(e, e, this.getProjectionMatrix()), a.c.mul(e, e, this.getViewMatrix()), a.c.mul(e, e, this.getModelMatrix()), e
            }
        }(),
        enter: function (e) {
            return this._intersector.enter(e)
        },
        apply: function (e) {
            e.getViewMatrix ? this.applyCamera(e) : e.getMatrix ? this.applyTransform(e) : this.applyNode(e)
        },
        applyCamera: function (e) {
            var t = e.getViewport();
            void 0 !== t && this.pushWindowMatrixUsingViewport(t);
            var i, n, r;
            e.getReferenceFrame() === u.a.RELATIVE_RF && this.getViewMatrix() && this.getProjectionMatrix() ? (i = a.c.mul(this._pooledMatrix.getOrCreateObject(), this.getProjectionMatrix(), e.getProjectionMatrix()), n = this.getViewMatrix(), r = a.c.mul(this._pooledMatrix.getOrCreateObject(), this.getModelMatrix(), e.getViewMatrix())) : (i = e.getProjectionMatrix(), n = e.getViewMatrix(), r = a.c.identity(this._pooledMatrix.getOrCreateObject())), this.pushProjectionMatrix(i), this.pushViewMatrix(n), this.pushModelMatrix(r), this._intersector.setCurrentTransformation(this.getTransformation()), this.traverse(e), this.popModelMatrix(), this.popViewMatrix(), this.popProjectionMatrix(), void 0 !== t && this.popWindowMatrix(), this._intersector.setCurrentTransformation(this.getTransformation())
        },
        applyNode: function (e) {
            if (this.enter(e)) return e.getPrimitiveSetList ? void this._intersector.intersect(this, e) : void(e.traverse && this.traverse(e))
        },
        applyTransform: function (e) {
            if (this.enter(e)) {
                if (e.getReferenceFrame() === u.a.ABSOLUTE_RF) {
                    var t = this._pooledMatrix.getOrCreateObject();
                    this.pushViewMatrix(a.c.identity(t)), this.pushModelMatrix(e.getMatrix())
                } else if (this._modelStack.getLength() > 0) {
                    var i = a.c.copy(this._pooledMatrix.getOrCreateObject(), this.getModelMatrix());
                    a.c.mul(i, i, e.getMatrix()), this.pushModelMatrix(i)
                } else this.pushModelMatrix(e.getMatrix());
                this._intersector.setCurrentTransformation(this.getTransformation()), this.traverse(e), this.popModelMatrix(), e.getReferenceFrame() === u.a.ABSOLUTE_RF && this.popViewMatrix(), this._intersector.setCurrentTransformation(this.getTransformation())
            }
        }
    }), "osgUtil", "IntersectionVisitor"), t.a = l
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(10),
        a = i(625),
        o = i(876),
        s = function () {
            a.a.call(this), this._start = r.f.create(), this._iStart = r.f.create(), this._end = r.f.create(), this._iEnd = r.f.create(), this._threshold = 0, this._iThreshold = 0
        };
    n.a.createPrototypeObject(s, n.a.objectInherit(a.a.prototype, {
        set: function (e, t, i) {
            r.f.copy(this._start, e), r.f.copy(this._iStart, e), r.f.copy(this._end, t), r.f.copy(this._iEnd, t), void 0 !== i && (this._threshold = this._iThreshold = i)
        },
        setStart: function (e) {
            r.f.copy(this._start, e), r.f.copy(this._iStart, e)
        },
        setEnd: function (e) {
            r.f.copy(this._end, e), r.f.copy(this._iEnd, e)
        },
        intersectNode: function (e) {
            return this.intersectBoundingSphere(e.getBoundingSphere())
        },
        intersectBoundingSphere: function () {
            var e = r.f.create(),
                t = r.f.create();
            return function (i) {
                if (!i.valid()) return !1;
                r.f.sub(e, this._iStart, i.center());
                var n = r.f.sqrLen(e) - i.radius2();
                if (n <= 0) return !0;
                r.f.sub(t, this._iEnd, this._iStart);
                var a = r.f.sqrLen(t),
                    o = 2 * r.f.dot(e, t),
                    s = o * o - 4 * a * n;
                if (s < 0) return !1;
                s = Math.sqrt(s);
                var u = .5 / a,
                    l = (-o - s) * u,
                    c = (-o + s) * u;
                return !(l <= 0 && c <= 0) && !(l > 1 && c > 1)
            }
        }(),
        intersect: function () {
            var e = new o.a;
            return function (t, i) {
                e.setGeometry(i), e.setIntersectionVisitor(t), e.setIntersector(this), e.set(this._iStart, this._iEnd, this._iThreshold);
                var n = i.getShape();
                if (n) return void n.intersectLineSegment(e, n.getNodes()[0], this._iStart, this._iEnd, this._iThreshold);
                i.computeTransformedVertices && e.setVertices(i.computeTransformedVertices()), e.apply(i), e.reset()
            }
        }(),
        setCurrentTransformation: function (e) {
            if (r.c.invert(e, e), this._threshold > 0) {
                var t = this._iStart;
                r.c.getScale(t, e);
                var i = t[0],
                    n = t[1],
                    a = t[2];
                this._iThreshold = this._threshold * (i > n ? i > a ? i : a : n > a ? n : a)
            }
            r.f.transformMat4(this._iStart, this._start, e), r.f.transformMat4(this._iEnd, this._end, e)
        }
    }), "osgUtil", "LineSegmentIntersector"), t.a = s
}, function (e, t, i) {
    "use strict";

    function n(e) {
        return a[0] = e, a[0] = (a[0] << 16 | a[0] >> 16) >>> 0, a[0] = (1431655765 & a[0]) << 1 | (2863311530 & a[0]) >>> 1 >>> 0, a[0] = (858993459 & a[0]) << 2 | (3435973836 & a[0]) >>> 2 >>> 0, a[0] = (252645135 & a[0]) << 4 | (4042322160 & a[0]) >>> 4 >>> 0, a[0] = (16711935 & a[0]) << 8 | (4278255360 & a[0]) >>> 8 >>> 0, 2.3283064365386963e-10 * a[0]
    }
    var r = {};
    r.isPowerOf2 = function (e) {
        return 0 == (e & e - 1)
    }, r.floorPowerOf2 = function (e) {
        return 1 << Math.floor(Math.log2(e))
    }, r.ceilPowerOf2 = function (e) {
        return 1 << Math.ceil(Math.log2(e))
    }, r.snapToPowerOf2 = function (e, t) {
        if (r.isPowerOf2(e)) return e;
        var i = r.floorPowerOf2(e);
        return e / i - 1 > (void 0 === t ? .5 : t) ? r.ceilPowerOf2(e) : i
    };
    var a = new Uint32Array(1);
    r.hammersley = function (e, t) {
        return [e / t, n(e)]
    }, r.hemisphereSampleUniform = function (e, t) {
        var i = r.hammersley(e, t),
            n = 2 * i[1] * Math.PI,
            a = 1 - i[0],
            o = Math.sqrt(1 - a * a);
        return [Math.cos(n) * o, Math.sin(n) * o, a]
    }, r.hemisphereSampleCos = function (e, t) {
        var i = r.hammersley(e, t),
            n = 2 * i[1] * Math.PI,
            a = Math.sqrt(1 - i[0]),
            o = Math.sqrt(1 - a * a);
        return [Math.cos(n) * o, Math.sin(n) * o, a]
    }, t.a = r
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(20),
        a = n.a.osg,
        o = function () {
            var e = a.WebGLCaps.instance().getWebGLParameter("MAX_TEXTURE_IMAGE_UNITS");
            return Math.min(e, Object(r.a)().maxTextureUnits)
        };
    t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(69),
        a = i(179),
        o = i(103),
        s = i(20),
        u = n.a.osg,
        l = function () {
            u.CullVisitor.call(this), this._separateVR = !1, this._isEnv = !1
        },
        c = l.vrConfig = {
            doVR: !1,
            leftRenderWidth: 0,
            rightRenderWidth: 0,
            leftRenderHeight: 0,
            rightRenderHeight: 0,
            rightProjection: u.mat4.create(),
            leftProjection: u.mat4.create(),
            leftOffsetView: u.mat4.create(),
            rightOffsetView: u.mat4.create()
        };
    u.createPrototypeObject(l, u.objectInherit(u.CullVisitor.prototype, {
        popCameraModelViewProjectionMatrix: function (e) {
            this.popModelViewMatrix(), this.popProjectionMatrix(e)
        },
        reset: function () {
            u.CullVisitor.prototype.reset.call(this), this._minNear = this._computedNear, this._maxFar = this._computedFar
        },
        updateNearFar: function () {
            this._minNear = Math.min(this._minNear, this._computedNear), this._maxFar = Math.max(this._maxFar, this._computedFar)
        },
        _handleMainCamera: function (e) {
            var t = this.getCurrentProjectionMatrix(),
                i = this._computedNear,
                n = this._computedFar,
                r = this._nearFarRatio,
                o = this._projectionMatrixStack.getArray()[0];
            u.mat4.copy(o, t), this.clampProjectionMatrix(o, this._minNear, this._maxFar, 1e-5), c.doVR && (this.clampProjectionMatrix(c.leftProjection, i, n, r), this.clampProjectionMatrix(c.rightProjection, i, n, r));
            var s = a.a.uNearFar.getInternalArray();
            this.clampProjectionMatrix(t, i, n, r, s), e.clampedProjectionMatrix ? u.mat4.copy(e.clampedProjectionMatrix, t) : e.clampedProjectionMatrix = u.mat4.clone(t)
        },
        popProjectionMatrix: function (e) {
            if (!0 === this._computeNearFar && this._computedFar >= this._computedNear) {
                var t = "PostProcess - MainCamera" === e.getName();
                (t || e.getReferenceFrame() === u.Transform.RELATIVE_RF && !e.isRenderToTextureCamera()) && this.updateNearFar(), t ? this._handleMainCamera(e) : this.clampProjectionMatrix(this.getCurrentProjectionMatrix(), this._computedNear, this._computedFar, this._nearFarRatio)
            }
            u.CullStack.prototype.popProjectionMatrix.call(this)
        },
        handleCullCallbacksAndTraverse: function (e) {
            var t = c.doVR && (this._nodeOut === e || "PostProcess - node Out" === e.getName());
            t && (this._nodeOut = e, this._separateVR = !0);
            var i = this._nodeEnv === e || "Environment - Camera" === e.getName();
            i && (this._nodeEnv = e, this._isEnv = !0);
            var n = e.getCullCallback();
            n && !n.cull(e, this) || this.traverse(e), i && (this._isEnv = !1), t && (this._separateVR = !1)
        },
        pushLeaf: function (e, t) {
            var i = this._currentStateGraph._leafs;
            0 === i.getLength() && this._currentRenderBin.addStateGraph(this._currentStateGraph);
            var n = this._separateVR && this.traversalMask !== r.a.SHADOW,
                a = this.createOrReuseRenderLeaf();
            if (a.isVR = n, n) {
                var o = this._isEnv,
                    s = this.getCurrentModelViewMatrix(),
                    l = this.getCurrentViewMatrix();
                a.leftProjection = c.leftProjection, a.rightProjection = c.rightProjection;
                var h = a.leftModelView || u.mat4.create(),
                    d = a.rightModelView || u.mat4.create();
                a.leftModelView = o ? u.mat4.copy(h, s) : u.mat4.multiply(h, c.leftOffsetView, s), a.rightModelView = o ? u.mat4.copy(d, s) : u.mat4.multiply(d, c.rightOffsetView, s);
                var f = a.leftView || u.mat4.create(),
                    p = a.rightView || u.mat4.create();
                a.leftView = o ? u.mat4.copy(f, l) : u.mat4.multiply(f, c.leftOffsetView, l), a.rightView = o ? u.mat4.copy(p, l) : u.mat4.multiply(p, c.rightOffsetView, l)
            }
            a.init(this._currentStateGraph, e, this.getCurrentProjectionMatrix(), this.getCurrentViewMatrix(), this.getCurrentModelViewMatrix(), this.getCurrentModelMatrix(), t), i.push(a)
        },
        updateCalculatedNearFar: function (e, t) {
            var i = o.a.getModelBoxWithoutDisplacement();
            if (i) {
                var n = Object(s.a)().scaleEpsilon * i.radius() / t.getBound().radius();
                n *= n;
                var r = e[0],
                    a = e[4],
                    l = e[8];
                if (r * r + a * a + l * l < n && (r = e[1], a = e[5], l = e[9], r * r + a * a + l * l < n && (r = e[2], a = e[6], l = e[10], r * r + a * a + l * l < n))) return !1
            }
            return u.CullVisitor.prototype.updateCalculatedNearFar.call(this, e, t)
        }
    }), "osgSketchfab", "CullVisitor"), t.a = l
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = n.a.osg,
        a = function () {
            r.Light.apply(this, arguments)
        };
    a.DIRECTION = r.Light.DIRECTION, a.SPOT = r.Light.SPOT, a.POINT = r.Light.POINT, a.HEMI = r.Light.HEMI, r.createPrototypeStateAttribute(a, r.objectInherit(r.Light.prototype, {
        attributeType: "SketchfabLight",
        isDirectionLight: function () {
            return 0 === this._position[3] && (-1 === this._ground[3] || 0 === this._ground[3])
        }
    }), "osgSketchfab", "Light");
    var o = r.vec3.create();
    r.LightSource.prototype.computeBoundingSphere = function (e) {
        if (r.Node.prototype.computeBoundingSphere.call(this, e), !e.valid()) return e;
        if (void 0 !== this._light && this._referenceFrame === r.Transform.RELATIVE_RF) {
            var t = this._light.getPosition();
            0 !== t[3] && e.expandByVec3(r.vec3.scale(o, t, 1 / t[3]))
        }
        return e
    }, t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(5)),
        a = i.n(r),
        o = i(9),
        s = i(229),
        u = i(120),
        l = i(47),
        c = i(44),
        h = i(572),
        d = i(152),
        f = i(20),
        p = i(1294),
        m = i.n(p),
        g = i(1295),
        v = i.n(g),
        _ = o.a.osg,
        b = _.StateAttribute.OVERRIDE_ON,
        S = _.createTexturedFullScreenFakeQuadGeometry(),
        x = function (e, t) {
            _.Camera.call(this), this.addChild(S), this.setNodeMask(0), this._outTexture = e, this._packedTextures = Object(n.clone)(t.getPackedTextures()), this._channels = t.getOrderedChannels().slice(), this._lastHash = "", this.initPacking()
        };
    x.AUTO_RELEASE_GL = !1;
    var y, C = function (e) {
            e.generateMipmap = function () {
                this._rttPass || _.Texture.prototype.generateMipmap.apply(this, arguments), this._rttPass = !1
            }
        },
        T = function (e) {
            for (var t in y)
                for (var i = y[t], n = i.get("stateSet"), r = n.getNumTextureAttributeLists(), a = 0; a < r; ++a) {
                    var o = n.getTextureAttribute(a, "Texture");
                    if (o && o.getTexture && o.getTexture() === e) return !1
                }
            return !0
        };
    _.createPrototypeNode(x, _.objectInherit(_.Camera.prototype, {
        getNbChannels: function () {
            return this._channels.length
        },
        disablePacking: function () {
            this.setNodeMask(0);
            for (var e = this.getStateSet(), t = this.getNbChannels(), i = 0; i < t; ++i) {
                var n = e.getTextureAttribute(i, "Texture");
                n && n !== s.a.dummyTexture && T(n) && n.releaseGLObjects()
            }
            if (x.AUTO_RELEASE_GL) {
                var r = this.frameBufferObject;
                r && r.releaseGLObjects()
            }
        },
        initPacking: function () {
            var e = this.getOrCreateStateSet(),
                t = this._packedTextures,
                i = 0,
                n = this._channels,
                r = n.length,
                a = _.Uniform.createInt4("uReadPacking"),
                o = a.getInternalArray();
            for (i = 0; i < r; ++i) {
                var u = n[i],
                    l = t[u].texture,
                    c = l.getInternalFormat() === _.Texture.ALPHA;
                3 === d.a.getDefaultComponentCount(u) ? o[i] = c ? 3 : 2 : o[i] = c ? 1 : 0
            }
            for (i = 0; i < 4; ++i) e.setTextureAttributeAndModes(i, s.a.dummyTexture, b);
            this._outTexture.setTextureSize(1, 1), this.setRenderOrder(_.Camera.PRE_RENDER, 0), this.attachTexture(_.FrameBufferObject.COLOR_ATTACHMENT0, this._outTexture, _.Texture.TEXTURE_2D);
            var h = new _.Viewport(0, 0, 1, 1);
            this.setReferenceFrame(_.Transform.ABSOLUTE_RF), this.setViewport(h), e.addUniform(_.Uniform.createInt(0, "uTexture0"), b), e.addUniform(_.Uniform.createInt(1, "uTexture1"), b), e.addUniform(_.Uniform.createInt(2, "uTexture2"), b), e.addUniform(_.Uniform.createInt(3, "uTexture3"), b), e.addUniform(a, b)
        },
        updatePacking: function (e) {
            var t, i = this._packedTextures,
                n = this._channels,
                r = n.length,
                a = 0,
                o = "";
            for (a = 0; a < r; ++a) t = i[n[a]].texture, o += "" + t.getWidth() + t.getHeight();
            if (o === this._lastHash) return 0;
            var s = 0,
                u = 0;
            for (a = 0; a < r; ++a) {
                if (t = i[n[a]].texture, !t.apply(e)) return -1;
                s = Math.max(s, t.getWidth()), u = Math.max(u, t.getHeight())
            }
            if (!c.a.requestTextureBudget(s * u)) return -1;
            this._lastHash = o, this.setNodeMask(-1);
            var l = this.getStateSet();
            for (a = 0; a < r; ++a) t = i[n[a]].texture, l.setTextureAttributeAndModes(a, t, b);
            return this._outTexture.setTextureSize(s, u), this._outTexture.dirtyMipmap(), this._outTexture._rttPass = !0, this.setRenderOrder(_.Camera.PRE_RENDER, 0), this.resetAttachments(), this.attachTexture(_.FrameBufferObject.COLOR_ATTACHMENT0, this._outTexture, _.Texture.TEXTURE_2D), this.getViewport().setViewport(0, 0, s, u), (this._packedTextures.Opacity || this._packedTextures.Displacement) && c.a.redrawShadowNextFrame(), s * u
        }
    }), "osgSketchfab", "TexturePacker");
    var w = function () {
        _.Node.call(this), this.setCullCallback(this), this._program = u.a.createShader(m.a, v.a, "material-packer", "MaterialPacker"), this._dirtyPackedTextures = [], this._cacheCameras = {}, this._currentPackingCameras = [], this._frameCount = -1, this._lowResDone = !1, this._highResDone = !1, this._canResolveHighRes = !1, this._allMaterialsPackingCalled = !1
    };
    _.createPrototypeNode(w, _.objectInherit(_.Node.prototype, {
        initReadyForHighResBound: function () {
            var e;
            e = Object(f.a)().preload ? l.a.getHighResLoaded() : a.a.all([l.a.getHighResLoaded(), l.a.getFirstCameraAnimation()]), e.then(function () {
                this._canResolveHighRes = !0
            }.bind(this))
        },
        addPackedTexture: function (e) {
            this._allMaterialsPackingCalled && this._dirtyPackedTextures.push(e)
        },
        removePackedTexture: function (e) {
            var t = this._dirtyPackedTextures.indexOf(e);
            t >= 0 && (this._dirtyPackedTextures[t] = void 0)
        },
        packAllMaterialsTextures: function (e) {
            for (var t in e)
                for (var i = e[t].get("stateSet"), n = i.getNumTextureAttributeLists(), r = 0; r < n; ++r) {
                    var a = i.getTextureAttribute(r, "Texture");
                    a && a.getTexture && a.getTexture()
                }
            this._allMaterialsPackingCalled = !0
        },
        resetCaches: function () {
            var e = this.frameBufferObject;
            e && e.releaseGLObjects(), this._cacheCameras = {}, this._currentPackingCameras = []
        },
        deleteUnusedCameras: function (e) {
            var t = {};
            for (var i in e)
                for (var n = e[i].get("stateSet"), r = n.getNumTextureAttributeLists(), a = 0; a < r; ++a) {
                    var o = n.getTextureAttribute(a, "Texture");
                    if (o && o.getTexture) {
                        var s = this._getHash(o);
                        t[s] = !0
                    }
                }
            var u = this._cacheCameras;
            for (var l in u)
                if (!t[l]) {
                    var c = u[l];
                    c.disablePacking(), c.getParents()[0].removeChild(c), delete this._cacheTextures[l]
                }
        },
        packTextures: function (e) {
            var t = e.getPackedTextures(),
                i = e.getOrderedChannels();
            if (0 === i.length) return _.Texture.textureNull;
            var n = t[i[0]].texture;
            if (1 === i.length) return n;
            var r = this._getHash(e);
            if (this._cacheCameras[r]) return this._cacheCameras[r]._outTexture;
            var a = new s.a;
            a.setForceUpload(!0), C(a), a.setImageFormat(_.Texture.RGBA), a.setWrapS(n.getWrapS()), a.setWrapT(n.getWrapT()), a.setMagFilter(n.getMagFilter());
            var o = n.getMinFilter();
            a.setMinFilter(o), o === _.Texture.LINEAR_MIPMAP_LINEAR && Object(f.a)().anisotropy && a.setMaxAnisotropy(16);
            var u = new x(a, e);
            return u.getOrCreateStateSet().setAttributeAndModes(this._program, b), this._cacheCameras[r] = u, this.addChild(u), a
        },
        _getHash: function (e) {
            var t = "";
            if (e.getOrderedChannels().length <= 1) return t;
            for (var i = e.getPackedTextures(), n = e.getOrderedChannels(), r = 0; r < n.length; ++r) {
                var a = n[r],
                    o = i[a].texture,
                    s = d.a.getDefaultComponentCount(a);
                t += o.getInstanceID() + "-" + s + "-"
            }
            return t
        },
        _createNewJobs: function () {
            var e = this._dirtyPackedTextures,
                t = e.length;
            if (t) {
                for (var i = 0; i < t; ++i) e[i] && e[i].getTexture();
                e.length = 0
            }
        },
        _disableOldJobs: function () {
            var e = this._currentPackingCameras,
                t = e.length;
            if (!t) return 0;
            for (var i = 0; i < t; ++i) e[i].disablePacking();
            return e.length = 0, c.a.draw(), t
        },
        _updateNewJobs: function (e) {
            for (var t = this._currentPackingCameras, i = this.getChildren(), n = i.length, r = 0; r < n; ++r) {
                var a = i[r].updatePacking(e);
                if (0 !== a) {
                    if (a < 0) return t.length || -1;
                    t.push(i[r])
                }
            }
            return t.length
        },
        _checkResolveHighResBound: function () {
            if (this._canResolveHighRes && !this._highResDone) {
                this._highResDone = !0, l.a.resolveHighResBound(), Object(f.a)().textureFrameBudget = 1 / 0;
                var e = this.getChildren(),
                    t = e.length;
                h.default.logMessage("Texture packing FBO Count : " + t), x.AUTO_RELEASE_GL = !0;
                for (var i = 0; i < t; ++i) {
                    var n = e[i].frameBufferObject;
                    n && n.releaseGLObjects()
                }
            }
        },
        _checkResolveLowResBound: function () {
            this._lowResDone || (this._lowResDone = !0, l.a.resolveLowResBound())
        },
        cull: function (e, t) {
            if (0 === ++this._frameCount) return !0;
            this._createNewJobs();
            var i = this._disableOldJobs(),
                n = this._updateNewJobs(t.getRenderer().getState());
            return this._frameCount > 1 && !i && !n && (this._checkResolveLowResBound(), this._checkResolveHighResBound()), !0
        }
    }));
    var M = new w;
    M.setMaterials = function (e) {
        y = e
    }, t.a = M
}, function (e, t, i) {
    "use strict";
    var n = i(438),
        r = i(9),
        a = i(638),
        o = i(424),
        s = i.n(o),
        u = i(5),
        l = i.n(u),
        c = i(38),
        h = i.n(c),
        d = i(3),
        f = i.n(d),
        p = i(0),
        m = (i.n(p), i(677)),
        g = i(20),
        v = i(229),
        _ = r.a.osg,
        b = new s.a({
            device: "VWR",
            listen: !0
        }),
        S = {},
        x = function (e) {
            return 1 << Math.ceil(Math.log2(e))
        },
        y = function (e) {
            var t, i, n, r = 0;
            if (0 === e.length) return r;
            for (t = 0, n = e.length; t < n; t++) i = e.charCodeAt(t), r = (r << 5) - r + i, r |= 0;
            return "vr-browser-" + r
        },
        C = function (e, t, i, n, r, o) {
            a.a.call(this, e, t, i, n, r, o), this._uPaginate = void 0, this._textureWidth = 1024, this._textureHeight = 1024, this._useCache = !1
        };
    C.prototype = _.objectInherit(a.a.prototype, {
        initialize: function (e, t, i) {
            m.a && !Object(g.a)().isApp || (t = Object(p.extend)({}, t), n.a.getBaseVR(function (n) {
                this._styles = n.vrStyles, this._appendVrElement();
                var r = f()(n.TEMPLATES.getFromMacro(e, "panel", [t]));
                this._templatePath = e, r.css("position", "absolute"), r.css("top", "0"), r.css("left", "0"), this._$uiPanelsDiv.append(r);
                var a = this._extractMetaData(r);
                if (this._useCache) {
                    var o = y(r.html()),
                        s = localStorage.getItem(o);
                    if (s) {
                        var u = new Image;
                        return u.crossOrigin = "anonymous", u.onload = function () {
                            var e = new _.Texture;
                            e.setTextureSize(1, 1), e.setImage(u), this._applyTexture(e, a, i)
                        }.bind(this), u.src = s, void r.remove()
                    }
                }
                if (!Object(g.a)().vrGenerateUiTextures) return i(v.a.dummyTexture, a), void r.remove();
                this._rasterizeElement(n.rasterizeHTML, r).then(function (e) {
                    if (this._useCache) {
                        var t = e.toDataURL(),
                            i = y(r.html());
                        this._storeInCache(i, t)
                    }
                    var n = new _.Texture;
                    return n.setTextureSize(1, 1), n.setImage(e), n
                }.bind(this)).then(function (e) {
                    this._applyTexture(e, a, i)
                }.bind(this)), r.remove()
            }.bind(this)))
        },
        _storeInCache: function (e, t) {
            try {
                localStorage.setItem(e, t)
            } catch (n) {
                localStorage.removeItem(localStorage.key(0));
                for (var i = 0; i < localStorage.length && 0 !== localStorage.key(i).indexOf("vr-browser-"); i++) localStorage.removeItem(localStorage.key(i));
                this._storeInCache(e, t)
            }
        },
        setUseCache: function (e) {
            this._useCache = e || !1
        },
        _applyTexture: function (e, t, i) {
            this.isInitialized() ? (this.changeTexture(e), this.updateMetaData(t)) : a.a.prototype.initialize.call(this, e, t), i && i(e, t)
        },
        _appendVrElement: function () {
            this._$uiPanelsDiv = f()("#vr-ui-panels"), this._$uiPanelsDiv.length || (this._$uiPanelsDiv = f()('<div id="vr-ui-panels" style="position:absolue; top:0;bottom:0;left:0;right:0; background:transparent"/>'), f()("body").append(this._$uiPanelsDiv), this._$uiPanelsDiv.append('<style id="vr-panel-style">' + this._styles + "</style>"))
        },
        _rasterizeElement: function (e, t) {
            var i = document.createElement("canvas");
            return i.width = t.outerWidth(), i.height = t.outerHeight(), e.drawHTML(this._$uiPanelsDiv.prop("outerHTML"), i, {
                cacheBucket: S,
                cache: "all"
            }).then(function (e) {
                if (h.a.apple.phone) {
                    var t = "data:image/svg+xml;base64," + window.btoa(unescape(encodeURIComponent(e.svg))),
                        n = Object(p.uniqueId)("rasterize");
                    return b.createMessage({
                        data: {
                            _key: n,
                            height: i.height + "",
                            width: i.width + "",
                            svg: t
                        }
                    }).appendToHash(), new l.a(function (e) {
                        b.on("message:" + n, function (t) {
                            var i = new Image;
                            i.crossOrigin = "anonymous";
                            var n;
                            i.onload = function () {
                                e(i)
                            }, t.b64 && (n = t.b64), t.data.b64 && (n = t.data.b64), n.indexOf("%3D") > -1 && (n = decodeURIComponent(n)), -1 === n.indexOf("data:image/png") && (n = "data:image/png;base64," + n), i.src = n
                        })
                    })
                }
                if (this._textureWidth = x(i.width), this._textureHeight = x(i.height), i.width === this._textureWidth && i.height === this._textureHeight) return i;
                var r = document.createElement("canvas");
                return r.width = this._textureWidth, r.height = this._textureHeight, r.getContext("2d").drawImage(i, 0, 0, this._textureWidth, this._textureHeight), r
            }.bind(this), function (e) {
                console.log(e)
            })
        },
        _extractMetaData: function (e) {
            var t = e.find(".page"),
                i = e.outerHeight(!0),
                n = e.outerWidth(!0),
                r = {
                    id: e.attr("id"),
                    width: n,
                    height: i,
                    cells: [],
                    pages: []
                };
            if (0 === t.length) this._extractButtons(e, r, 0, "default");
            else
                for (var a = 0; a < t.length; a++) this._extractButtons(f()(t[a]), r, a, t[a].id);
            return this._extractCells(e, r), r
        },
        _extractButtons: function (e, t, i, n) {
            if (n) {
                var r = e.find("button"),
                    a = e.offset().top,
                    o = e.offset().left,
                    s = e.outerHeight(!0),
                    u = e.outerWidth(!0);
                t.pages[i] = {
                    id: n,
                    num: i,
                    x: o,
                    y: a,
                    width: u,
                    height: s,
                    items: [],
                    areas: []
                };
                for (var l = 0; l < r.length; l++) {
                    var c = r[l].id,
                        h = r[l].disabled;
                    if (c && !h) {
                        var d = f()(r[l]),
                            p = _.vec4.create();
                        p[0] = d.offset().left - o, p[1] = p[0] + d.outerWidth(), p[2] = d.offset().top - a, p[3] = p[2] + d.outerHeight(), p[0] > t.width && (p[0] %= t.width), p[1] > t.width && (p[1] %= t.width), t.pages[i].items.push(c), t.pages[i].areas.push(p)
                    }
                }
            }
        },
        _extractCells: function (e, t) {
            for (var i = e.find(".cell"), n = e.offset().top, r = e.offset().left, a = 0, o = 1 / 0, s = 1 / 0, u = 0, l = 0; l < i.length; l++) {
                var c = i[l].id;
                if (c) {
                    var h = f()(i[l]),
                        d = {};
                    d.id = c, d.x = h.offset().left - r, d.y = h.offset().top - n;
                    var p = h.css("z-index");
                    d.z = isNaN(p) ? 0 : p, d.width = h.outerWidth(!1), d.height = h.outerHeight(!1);
                    var m = d.x + d.width;
                    m > a && (a = m), d.x < o && (o = d.x);
                    var g = d.y + d.height;
                    g > u && (u = g), d.y < s && (s = d.y), t.cells[l] = d
                }
            }
            0 === i.length ? (t.cellsWidth = e.outerWidth(!1), t.cellsHeight = e.outerHeight(!1)) : (t.cellsWidth = a - o, t.cellsHeight = u - s)
        }
    }), t.a = C
}, function (e, t, i) {
    "use strict";
    var n = i(3),
        r = i.n(n),
        a = i(141);
    t.a = {
        name: "WithRefs",
        refs: {},
        initialize: function () {
            this.refreshRefs()
        },
        afterRender: function () {
            this.refreshRefs()
        },
        refreshRefs: function () {
            this.refs = Object(a.b)(this.$("[data-ref]")).reduce(function (e, t) {
                var i = t.getAttribute("data-ref");
                return e["$" + i] = r()(t), e[i] = t, e
            }, {})
        }
    }
}, , , , , , function (e, t, i) {
    "use strict";
    i.d(t, "a", function () {
        return d
    });
    var n = i(0),
        r = (i.n(n), i(41)),
        a = i(2),
        o = i(141),
        s = i(1),
        u = i(43),
        l = i(443),
        c = Object(n.curry)(function (e, t) {
            return e + t
        }),
        h = function (e, t) {
            return Object(o.a)(e, {}, function (e) {
                return e.value === t
            })
        },
        d = r.a.extend({
            displayName: "DropdownOptionList",
            mixins: [u.a],
            optionTypes: {
                value: s.b.string.isRequired,
                options: s.b.arrayOf(s.b.shape({
                    title: s.b.string.isRequired,
                    value: s.b.string.isRequired,
                    default: s.b.bool
                }).isRequired).isRequired,
                onSelectOption: s.b.func.isRequired,
                dropdown: s.b.shape({
                    isOpen: s.b.bool.isRequired,
                    onToggle: s.b.func.isRequired,
                    scrollToHeightPercent: s.b.func.isRequired
                }).isRequired,
                color: s.b.string,
                theme: s.b.string,
                closeOnSelection: s.b.bool
            },
            events: {
                'click [data-action="select-option"]': "onOptionClick",
                'mouseenter [data-action="select-option"]': "onMouseEnterOption",
                'mouseleave [data-action="select-option"]': "onMouseLeaveOption",
                "keydown window": "onWindowKeyDown"
            },
            viewDidMount: function () {
                this.updateScrollPosition()
            },
            viewDidUpdate: function () {
                this.updateScrollPosition()
            },
            getSelectedIndex: function () {
                return this.options.options.indexOf(h(this.options.options, this.options.value))
            },
            onOptionClick: function (e) {
                this.options.onSelectOption(e.target.getAttribute("data-value")), this.options.closeOnSelection && this.options.dropdown.isOpen && this.options.dropdown.onToggle()
            },
            onMouseEnterOption: function (e) {
                e.target.style.color = this.options.color
            },
            onMouseLeaveOption: function (e) {
                e.target.getAttribute("data-active") || (e.target.style.color = "")
            },
            onWindowKeyDown: function (e) {
                this.options.dropdown.isOpen && this.options.options.length && (38 !== e.which && 40 !== e.which || e.preventDefault(), 38 === e.which && this.selectIndex(c(-1)), 40 === e.which && this.selectIndex(c(1)))
            },
            selectIndex: function (e) {
                var t = this.getSelectedIndex(),
                    i = this.options.options.length,
                    n = (i + e(t)) % i;
                this.options.onSelectOption(this.options.options[n].value), this.scrollAtNextRender = !0
            },
            scrollToSelectedOption: function () {
                var e = (this.getSelectedIndex() - 1) / this.options.options.length;
                this.options.dropdown.scrollToHeightPercent(e)
            },
            updateScrollPosition: function () {
                this.scrollAtNextRender && (this.scrollAtNextRender = !1, this.scrollToSelectedOption())
            },
            template: function () {
                return a.default.getFromString(["<ul class=\"c-dropdown-select {{ '--' + theme + '-theme' if theme else '' }}\">", "    {% for optionItem in options %}", "        {% set isActive = optionItem.value == value %}", "        <li", '            class="c-dropdown-select__option {{ {', "                '--active': isActive", '            } | class_names }}"', '            style="{{ {', "                'color': color if isActive else ''", '            } | style }}"', '            {% if isActive %} data-active="true" {% endif %}', '            data-value="{{ optionItem.value }}"', '            data-action="select-option">', "            {{ optionItem.title }}", "        </li>", "    {% endfor %}", "</ul>"].join("\n"), {
                    options: this.options.options,
                    value: this.options.value,
                    color: this.options.color,
                    theme: this.options.theme
                })
            }
        });
    t.b = r.a.extend({
        displayName: "DropdownSelect",
        optionTypes: {
            value: s.b.string.isRequired,
            onChange: s.b.func.isRequired,
            options: s.b.arrayOf(s.b.shape({
                title: s.b.string.isRequired,
                value: s.b.string.isRequired,
                default: s.b.bool
            }).isRequired).isRequired,
            title: s.b.string,
            placeholder: s.b.string,
            color: s.b.string,
            theme: s.b.oneOf(["dark", "light", "white-background", "grey-background"]),
            menuAlign: s.b.oneOf(["left", "right"]),
            disabled: s.b.bool,
            closeOnSelection: s.b.bool,
            autoScale: s.b.bool
        },
        defaultOptions: {
            theme: "light",
            closeOnSelection: !0,
            autoScale: !1
        },
        initialize: function () {
            r.a.prototype.initialize.apply(this, arguments);
            var e = this.getDefaultValue();
            !this.options.value && e && this.options.onChange(e)
        },
        getDefaultValue: function () {
            return Object(o.a)(this.options.options, {}, function (e) {
                return e.default
            }).value
        },
        template: function () {
            return a.default.getFromString("{{ components.dropdown | component }}", {
                components: this.createChildrenComponents({
                    dropdown: {
                        viewClass: l.a,
                        options: {
                            disabled: this.options.disabled,
                            labelTitle: this.options.title,
                            labelValue: h(this.options.options, this.options.value).title,
                            longestLabelValue: this.options.autoScale ? this.options.options.reduce(function (e, t) {
                                return e.length > t.title.length ? e : t.title
                            }, "") : "",
                            placeholder: this.options.placeholder,
                            color: this.options.color,
                            theme: this.options.theme,
                            className: this.options.className,
                            menuAlign: this.options.menuAlign,
                            child: {
                                viewClass: d,
                                options: {
                                    value: this.options.value,
                                    options: this.options.options,
                                    color: this.options.color,
                                    theme: this.options.theme,
                                    closeOnSelection: this.options.closeOnSelection,
                                    onSelectOption: this.options.onChange
                                }
                            }
                        }
                    }
                })
            })
        }
    })
}, , , , , function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(2));
    t.a = function (e) {
        var t = {
                fileTypes: function (e, t) {
                    var i = t.name.replace(/^.*\.([^.]*)$/, "$1").toLowerCase();
                    if (-1 === e.indexOf(i)) return {
                        type: "fileTypes",
                        message: "<p>Unsupported format. Please upload a " + e.join(", ").toUpperCase() + ".</p>"
                    }
                },
                maxFileSize: function (e, t) {
                    if (!(t.size < e)) {
                        var i = Math.floor(e / 1024 / 1024) + "MB",
                            n = Math.ceil(t.size / 1024 / 1024) + "MB";
                        return {
                            type: "maxFileSize",
                            message: r.default.getFromString('<p>The {{ fileName | default("selected") }} image file size is too large. The maximum file size is {{ maxSizeLabel}} (your file is {{ currentSizeLabel }}).<p/>', {
                                fileName: t.name,
                                maxSizeLabel: i,
                                currentSizeLabel: n
                            })
                        }
                    }
                }
            },
            i = {
                fileTypes: "<p>The file type you tried to upload is not currently supported by Sketchfab.</p>",
                maxFileSize: '        <p>To reduce your file size, you can:</p>        <ul class="--disc">            <li>resize your image to a lower resolution.</li>            <li>use a more efficient file format like JPEG.</li>            <li>reduce the JPEG quality.</li>        </ul>        '
            };
        return {
            name: "Validator",
            validateFile: function (i, r) {
                if (null == e) return console.error("Ruleset not defined");
                var a, o = [];
                return Object(n.each)(e, function (e, n) {
                    (a = t[n](e, i)) && o.push(a)
                }), r ? o.length > 0 ? o : void 0 : this.concatErrorMessages(o)
            },
            concatErrorMessages: function (e) {
                return e.reduce(function (e, t) {
                    return e.concat(e, t.message)
                }, "")
            },
            getExtraErrorInformation: function (e) {
                return i[e]
            }
        }
    }
}, function (e, t, i) {
    "use strict";
    var n = i(49),
        r = i.n(n),
        a = i(5),
        o = i.n(a),
        s = i(3),
        u = i.n(s),
        l = i(11),
        c = i(631);
    t.a = l.a.extend({
        defaults: {
            colorSpace: "unknown"
        },
        endpoint: function () {
            return "/textures" + (this.isNew() ? "" : "/" + this.get("uid"))
        },
        isValid: function () {
            var e = this.get("name");
            return void 0 === e && console.warn("no name for Texture " + this.id), e = e || this.id, void 0 === this.get("images") && console.warn("no images for Texture " + e), void 0 === this.get("uid") && console.warn("no uid for Texture " + e), !0
        },
        save: function (e, t) {
            null != e && "object" !== (void 0 === e ? "undefined" : r()(e)) || (t = e);
            var i = new FormData;
            return i.append("imageFile", this.get("imageFile"), this.get("name")), i.append("colorSpace", this.get("colorSpace")), i.append("modelUid", t.modelUID), o.a.resolve(u.a.ajax({
                url: this.url(),
                data: i,
                processData: !1,
                contentType: !1,
                type: "POST"
            }))
        },
        saveColorspace: function () {
            return o.a.resolve(u.a.ajax({
                url: this.url(),
                data: {
                    colorSpace: this.get("colorSpace")
                },
                type: "PATCH"
            }))
        }
    }).extend(c.a)
}, function (e, t, i) {
    "use strict";
    var n = i(103),
        r = i(53),
        a = i(62),
        o = i(9),
        s = i(5),
        u = i.n(s),
        l = i(1424),
        c = i(20),
        h = i(79),
        d = i(147),
        f = i(38),
        p = i.n(f),
        m = i(86),
        g = o.a.osg,
        v = function () {
            if (this._volume = Number(r.a.get("sf_volume", 1)), this._sounds = [], this._context = void 0, this._enabled = !1, this._tabVisible = !0, this._isPlaying = !1, this._waiting = !Object(h.a)(), this._muted = !1, this._unlockBound = this._unlock.bind(this), this._lockBound = this._lock.bind(this), this._forcePlayBound = function () {
                    this.forcePlay(this._isPlaying)
                }.bind(this), this._hasSounds = !1, this._willHaveSounds = void 0, !(window.AudioContext || window.webkitAudioContext)) return void(this._willHaveSounds = !1);
            if (Object(h.a)() && (this._willHaveSounds = !0), !this._willHaveSounds) {
                var e = Object(c.a)().model;
                if (!e) {
                    var t = window.location.href.match(/\/models\/((.+)(?:\/)+|(.+))/);
                    t && t.length > 3 && (e = t[2] ? t[2] : t[3])
                }
                e && a.a.get(e).then(this.checkWillHaveSounds.bind(this))
            }
            this._authErrors = this.featureDetectSoundAuthGestureNeeded(), this._resetPlayedOnceFromAuthGesture(), this._enablingAuthAudio = !1, this._firstEnter = !0, this._readyForErrorMessage = new m.a, this._audioContextTriesCount = 0, window.addEventListener("beforeunload", this.exit.bind(this)), this._contextClosePending = !1, this._radius = 1, n.a.getBoxReady().then(function () {
                this._radius = n.a.getModelBoxWithoutDisplacement().radius()
            }.bind(this))
        };
    v.prototype = {
        release: function () {
            if (this._context && !this._releasePending) {
                var e;
                this._releasePendingPromises = [];
                for (var t = 0; t < this._sounds.length; t++)(e = this.releaseSound(this._sounds[t])) && this._releasePendingPromises.push(e);
                var i = this._context.close;
                i && (e = this._context.close(), e ? (this._contextClosePending = !0, e.then(function () {
                    this._contextClosePending = !1, this._context = void 0
                }.bind(this)), this._releasePendingPromises.push(e)) : i = !1), this._releasePending = u.a.all(this._releasePendingPromises), this._releasePending.finally(function () {
                    i || (this._context = void 0), this._releasePendingPromises = void 0, this._releasePending = void 0
                }.bind(this))
            }
        },
        releaseSound: function (e) {
            if (e && (this.disconnectSound(e), e._mediaElementSource && (e._mediaElementSource.disconnect(), e._mediaElementSource = void 0), e._player)) {
                e._player.volume = 0, e.pause();
                var t = e.playerPause();
                return t.then(e.releasePlayerBound), e.isSoundAsync() && (e._exitTime = e._player.currentTime), e._player = void 0, e.isPlayerPlaying() || e.releasePlayer(), t
            }
        },
        removeSound: function (e) {
            e && (this.releaseSound(e), this._sounds.splice(this._sounds.indexOf(e), 1))
        },
        reset: function () {
            if (this._releasePending) return void this._releasePending.then(this.reset.bind(this));
            this._audioContextTriesCount = 0, this._hasSounds && !this._firstEnter && this.forcePlay(this._isPlaying)
        },
        enableTapRequestPopup: function () {
            this._osdProxyModel && this._willHaveSounds && !Object(h.a)() && this._osdProxyModel.trigger("sound-show", "Tap/Click to play sounds", {
                position: "top",
                duration: 1 / 0
            })
        },
        exit: function () {
            this._context && (this.release(), this._firstEnter = !1, this._lock())
        },
        enter: function () {
            this.reset()
        },
        checkWillHaveSounds: function (e) {
            if (void 0 !== this._willHaveSounds) return this._willHaveSounds;
            var t = e.get("options").sound;
            if (!t || !t.soundtracks || !t.soundtracks.length) return this._willHaveSounds = !1, !1;
            if (!p.a.apple.device) return this._willHaveSounds = !0, !0;
            for (var i, n = 0, r = t.soundtracks.length; n < r; n++)
                if (t.soundtracks[n].ambient) {
                    i = n;
                    break
                } return void 0 !== i ? (t.soundtracks.length > 1 && (t.soundtracks.splice(i + 1, t.soundtracks.length - i), t.soundtracks.splice(0, i)), this._willHaveSounds = !0, !0) : (t.soundtracks.length = 0, this._willHaveSounds = !1, !1)
        },
        setProxyModel: function (e) {
            this._osdProxyModel = e, this._readyForErrorMessage && this._readyForErrorMessage.resolve()
        },
        getProxyModel: function () {
            return this._osdProxyModel
        },
        getOrCreateAudioContext: function (e) {
            if (this._willHaveSounds && this._enabled && !this._waiting && this._tabVisible) {
                if (this._context && !this._contextClosePending) return this._context;
                var t = window.AudioContext || window.webkitAudioContext;
                try {
                    return this._context = e ? new t : new t({
                        latencyHint: "interactive"
                    }), "suspended" === this._context.state ? void this._context.resume().then(function () {
                        this._unlock()
                    }.bind(this)).catch(function () {
                        this._authErrors = !0, this._lock()
                    }.bind(this)) : (this._audioContextTriesCount && this.forcePlay(this._isPlaying), this._context)
                } catch (e) {
                    if (e instanceof TypeError) {
                        if (g.debug(e.message), this.getOrCreateAudioContext(!0), this._context) return this._context
                    } else if ("An AudioContext in a cross origin iframe must be created or resumed from a user gesture to enable audio output." === e.message) return this._authErrors = !0, this.pendingToPlayResolved(), void this._lock();
                    this._readyForErrorMessage.promise.then(function () {
                        this._audioContextTriesCount++, this._audioContextTriesCount < 5 ? setTimeout(function () {
                            this.getOrCreateAudioContext()
                        }.bind(this), 200) : this._osdProxyModel.trigger("sound-error", new Error('Your browser can not play additional sounds and this page must be reloaded. If the problem persists, try to restart your browser. <a style="color: -webkit-link; cursor: auto; text-decoration: underline;" href="javascript:window.location.reload()">reload</a>'), {
                            position: "top",
                            duration: 1 / 0
                        })
                    }.bind(this))
                }
                return this._context
            }
        },
        _createAudio: function () {
            var e = document.createElement("audio");
            return e.loop = !0, e.volume = 1, e.muted = !0, e.preload = "auto", e.crossOrigin = "anonymous", e
        },
        addSound: function (e, t) {
            return this._hasSounds = !0, this._playedOnceFromAuthGesture || this._enableAuthAudioListener(this._forcePlayBound), this.canPlay() && (t || !1 === this._hasAnim) && e.play(), this._sounds.push(e), e
        },
        createSound: function (e, t) {
            this._isPlaying = t;
            var i, n = this._createAudio(e),
                r = new l.a(this, n, e);
            return n && this.canPlay() && (i = e.get("ambient") ? this.connectAmbientSound(r) : this.connect3DSound(r)) && i.then(this._unlockBound).catch(this._lockBound), this.addSound(r, t)
        },
        createPreview: function (e) {
            var t = this._createAudio(e),
                i = new l.a(this, t, e);
            return this.connectAmbientSound(i), i
        },
        _errorCatchAndTryAgain: function (e) {
            g.debug(e.message), this.exit(), window.setTimeout(function () {
                this.reset()
            }.bind(this), 500)
        },
        _tryCreateMediaElementSource: function (e) {
            if (e._mediaElementSource) return !0;
            try {
                return e._mediaElementSource = this._context.createMediaElementSource(e._player), !0
            } catch (e) {
                return e instanceof DOMException && "Failed to execute 'createMediaElementSource' on 'BaseAudioContext': AudioContext has been closed." === e.message && this._errorCatchAndTryAgain(e), !1
            }
        },
        _tryConnectMediaElementSource: function (e, t) {
            try {
                return e._mediaElementSource.connect(t), !0
            } catch (e) {
                return this._errorCatchAndTryAgain(e), !1
            }
        },
        _setPannerPosition: function (e, t, i, n) {
            if (e.positionX) {
                var r = this.getOrCreateAudioContext(),
                    a = r ? r.currentTime : 0;
                e.positionX.setTargetAtTime(t, a, .016), e.positionY.setTargetAtTime(i, a, .016), e.positionZ.setTargetAtTime(n, a, .016)
            } else e.setPosition(t, i, n)
        },
        _setPannerOrientation: function (e, t, i, n, r, a, o) {
            if (e.forwardX) {
                var s = this.getOrCreateAudioContext(),
                    u = s ? s.currentTime : 0;
                e.forwardX.setTargetAtTime(t, u, .016), e.forwardY.setTargetAtTime(i, u, .016), e.forwardZ.setTargetAtTime(n, u, .016), e.upX.setTargetAtTime(r, u, .016), e.upY.setTargetAtTime(a, u, .016), e.upZ.setTargetAtTime(o, u, .016)
            } else e.setOrientation(t, i, n, r, a, o)
        },
        connect3DSound: function (e) {
            var t = this.getOrCreateAudioContext();
            if (t) {
                this.disconnectSound(e);
                var i = t.createPanner();
                if (e._panner = i, i.panningModel = "HRTF", i.rolloffFactor = 1, i.coneInnerAngle = 360, i.coneOuterAngle = 0, i.coneOuterGain = 0, i.distanceModel = e.getModel().get("distanceModel"), e.setRefDistanceNormalized(e.getModel().get("distance")), e.setMaxDistanceNormalized(e.getModel().get("distanceMax")), e._player || (e._player = this._createAudio(e.getModel())), this._tryCreateMediaElementSource(e)) {
                    var n = e._gain ? e._gain : t.createGain();
                    if (e._gain = n, e.setGainValue(0), n.connect(i), i.connect(t.destination), this._tryConnectMediaElementSource(e, n)) return e.playerPlay()
                }
            }
        },
        connectAmbientSound: function (e) {
            var t = this.getOrCreateAudioContext();
            if (t && (this.disconnectSound(e), e._player || (e._player = this._createAudio(e.getModel())), this._tryCreateMediaElementSource(e))) {
                var i = t.createGain();
                if (e._gain = i, e.setGainValue(0), i.connect(t.destination), this._tryConnectMediaElementSource(e, i)) return e.playerPlay()
            }
        },
        disconnectSound: function (e) {
            e && (e._panner && (e._panner.disconnect(), e._panner = void 0), e._gain && (e._gain.disconnect(), e._gain = void 0))
        },
        update: function () {
            var e = g.vec3.create(),
                t = g.vec3.create(),
                i = g.vec3.create();
            return function () {
                if (!this._enabled) return !0;
                var n = this._context,
                    r = this._camera;
                if (!r || !n) return !0;
                g.mat4.getLookAt(e, t, i, r.getViewMatrix()), g.vec3.sub(t, t, e), g.vec3.normalize(t, t);
                var a = this._radius,
                    o = n.listener;
                return this._setPannerPosition(o, e[0] / a, e[1] / a, e[2] / a), this._setPannerOrientation(o, t[0], t[1], t[2], i[0], i[1], i[2]), !0
            }
        }(),
        getVolume: function () {
            return this._volume
        },
        setCamera: function (e) {
            this._camera = e
        },
        setVolume: function (e) {
            var t = 0 === this._volume;
            if (this._volume = e, !this._muted && (r.a.set("sf_volume", e), this.canPlay())) {
                !t && e > 0 && this._lock();
                for (var i = 0, n = this._sounds.length; i < n; i++) this._sounds[i].updateVolume()
            }
        },
        isTabVisible: function () {
            return this._tabVisible
        },
        hide: function () {
            this._tabVisible = !1, this.exit()
        },
        show: function () {
            this._tabVisible = !0, this.enter()
        },
        setEnabled: function (e) {
            e ? (this._enabled = !0, this.reset()) : (this.exit(), this._enabled = !1)
        },
        isEnabled: function () {
            return this._enabled
        },
        setHasAnim: function (e) {
            this._hasAnim = e
        },
        _unlockAcknowledge: function () {
            document.removeEventListener("touchend", this._forcePlayBound, !0), document.removeEventListener("mouseup", this._forcePlayBound, !0), this._playedOnceFromAuthGesture = !0, this._authErrors = this.featureDetectSoundAuthGestureNeeded(), this._osdProxyModel && this._osdProxyModel.trigger("sound-hide")
        },
        _unlock: function () {
            if (this._enablingAuthAudio = !1, this._context) return this._context.resume(), void this._unlockAcknowledge();
            var e = this.getOrCreateAudioContext();
            e && (e.resume(), this._unlockAcknowledge())
        },
        _lock: function () {
            this._resetPlayedOnceFromAuthGesture(), this._playedOnceFromAuthGesture || this._waiting || this._muted || 0 === this._volume || (this._enableAuthAudioListener(this._forcePlayBound), this.enableTapRequestPopup())
        },
        _enableAuthAudioListener: function () {
            this._enablingAuthAudio || (this._enablingAuthAudio = !0, document.addEventListener("touchend", this._forcePlayBound, !0), document.addEventListener("mouseup", this._forcePlayBound, !0))
        },
        setPlaying: function (e) {
            this._isPlaying = e
        },
        isPlaying: function () {
            return this._isPlaying
        },
        forcePlay: function (e) {
            var t = this._sounds.length;
            if (!t) return this._unlock();
            for (var i = [], n = 0; n < t; n++) {
                var r = this._sounds[n];
                r.updateFromModel();
                var a = r.playerPlay();
                a && i.push(a), r.isSoundAsync() && (r.play(), r._exitTime && (r._player.currentTime = r._exitTime, r._exitTime = void 0))
            }
            this._isPlaying = e, this._context && this._context.resume && i.push(this._context.resume()), i.length && u.a.all(i).then(this._unlockBound).catch(function () {
                g.debug("error on sound play"), this._authErrors = !0, this._lock()
            }.bind(this))
        },
        pause: function () {
            for (var e = 0; e < this._sounds.length; e++) {
                var t = this._sounds[e];
                t.isSoundAsync() || t.pause()
            }
            this._isPlaying = !1
        },
        getPlayedOnceFromAuthGesture: function () {
            return this._playedOnceFromAuthGesture
        },
        _resetPlayedOnceFromAuthGesture: function () {
            this._playedOnceFromAuthGesture = !this._authErrors || Object(c.a)().isApp || Object(d.a)(), this._playedOnceFromAuthGesture || (this._playedOnceFromAuthGesture = !1, this._enabled && this._hasSounds && (this._playedOnceFromAuthGesture = !this._authErrors))
        },
        canPlay: function () {
            return this._enabled && !this._releasePending && !this._waiting && this._tabVisible
        },
        setWaiting: function (e) {
            this._waiting = e, e && this._lock()
        },
        getRadius: function () {
            return this._radius
        },
        featureDetectSoundAuthGestureNeeded: function () {
            var e = document.createElement("audio");
            try {
                return e.pause(), e.play().catch(function (e) {
                    e instanceof DOMException && "NotAllowedError" === e.name && (this._authErrors = !0, this._lock())
                }.bind(this)), e.paused
            } catch (e) {
                return g.debug(e), !0
            }
        },
        setMute: function (e) {
            if (this.canPlay()) {
                this._muted = e;
                for (var t = 0, i = this._sounds.length; t < i; t++) this._sounds[t].updateVolume();
                this._muted || this._lock()
            }
        },
        getIsMute: function () {
            return this._muted
        }
    };
    var _ = new v;
    t.a = _
}, , , , , , , function (e, t) {
    ! function () {
        (window.nunjucksPrecompiled = window.nunjucksPrecompiled || {})["skfb_front/macros/components/atoms/dropdown.jinja"] = function () {
            function e(e, t, i, n, r) {
                var a = "";
                try {
                    var o = null,
                        s = n.makeMacro([], ["options"], function (r) {
                            var a = i;
                            i = new n.Frame, r = r || {}, r.hasOwnProperty("caller") && i.set("caller", r.caller), i.set("options", r.hasOwnProperty("options") ? r.options : {});
                            var o = "";
                            o += "\n    ";
                            var s;
                            return s = e.getFilter("merge").call(t, {
                                labelTitle: "",
                                labelValue: "",
                                className: "",
                                longestLabelValue: "",
                                placeholder: "",
                                theme: "",
                                color: "",
                                components: {},
                                disabled: !1,
                                isOpen: !1,
                                withBackground: !1,
                                grey: !1
                            }, n.contextOrFrameLookup(t, i, "options")), i.set("options", s, !0), i.topLevel && t.setVariable("options", s), i.topLevel && t.addExport("options", s), o += '\n    <div\n        class="c-dropdown ', o += n.suppressValue(e.getFilter("class_names").call(t, {
                                "--disabled": n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "disabled"),
                                "--open": n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "isOpen"),
                                "--with-background": n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "withBackground"),
                                "--grey": n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "grey")
                            }), e.opts.autoescape), o += " ", o += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "className"), e.opts.autoescape), o += " ", o += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "theme") ? "--" + n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "theme") + "-theme" : "", e.opts.autoescape), o += '">\n        <div\n            class="c-dropdown__label"\n            data-action="toggle-menu"\n            data-disabled="', o += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "disabled"), e.opts.autoescape), o += '">\n            <span\n                data-ref="labelTitle"\n                class="c-dropdown__label-title">\n                ', o += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "labelTitle") ? n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "labelTitle") : "", e.opts.autoescape), o += '\n            </span>\n\n            <span\n                class="', o += n.suppressValue(e.getFilter("class_names").call(t, {
                                "c-dropdown__label-value": !0,
                                "--placeholder": !n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "labelValue")
                            }), e.opts.autoescape), o += '"\n                style="', o += n.suppressValue(e.getFilter("style").call(t, {
                                color: n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "labelValue") ? n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "color") : ""
                            }), e.opts.autoescape), o += '">\n                <span class="c-dropdown__label-value__text ', o += n.suppressValue(e.getFilter("class_names").call(t, {
                                "--absolute": n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "longestLabelValue")
                            }), e.opts.autoescape), o += '">\n                    ', o += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "labelValue") ? n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "labelValue") : n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "placeholder"), e.opts.autoescape), o += '\n                </span>\n\n                <span class="c-dropdown__label-value__hidden">', o += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "longestLabelValue"), e.opts.autoescape), o += '</span>\n            </span>\n        </div>\n        <div\n            data-ref="menu"\n            class="c-dropdown__menu ', o += n.suppressValue(e.getFilter("class_names").call(t, {
                                "--open": n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "isOpen")
                            }), e.opts.autoescape), o += '">\n            ', o += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "isOpen") ? e.getFilter("component").call(t, n.memberLookup(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "components"), "child")) : "", e.opts.autoescape), o += "\n        </div>\n    </div>\n", i = a, new n.SafeString(o)
                        });
                    t.addExport("dropdown"), t.setVariable("dropdown", s), a += "\n", o ? o.rootRenderFunc(e, t, i, n, r) : r(null, a)
                } catch (e) {
                    r(n.handleError(e, null, null))
                }
            }
            return {
                root: e
            }
        }()
    }()
}, , , , function (e, t, i) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: !0
    });
    var n = i(317),
        r = i(160),
        a = i(10),
        o = i(316),
        s = i(84),
        u = i(12),
        l = i(290),
        c = i(318),
        h = function (e) {
            s.a.call(this, e), this._pooledMatrix = new c.a(a.c.create), this._matrixStack = new l.a, this._matrixStack.push(a.c.IDENTITY), this._bb = new n.a
        };
    u.a.createPrototypeObject(h, u.a.objectInherit(s.a.prototype, {
        reset: function () {
            this._pooledMatrix.reset(), this._matrixStack.reset(), this._matrixStack.push(a.c.IDENTITY), this._bb.init()
        },
        getBoundingBox: function () {
            return this._bb
        },
        applyTransform: function (e) {
            var t = this._pooledMatrix.getOrCreateObject();
            a.c.copy(t, this._matrixStack.back()), e.computeLocalToWorldMatrix(t, this), this.pushMatrix(t), this.traverse(e), this.popMatrix()
        },
        apply: function (e) {
            return e instanceof o.a ? void this.applyTransform(e) : e instanceof r.a ? void this.applyBoundingBox(e.getBoundingBox()) : void this.traverse(e)
        },
        pushMatrix: function (e) {
            this._matrixStack.push(e)
        },
        popMatrix: function () {
            this._matrixStack.pop()
        },
        applyBoundingBox: function () {
            var e = new n.a;
            return function (t) {
                t.valid() && (t.transformMat4(e, this._matrixStack.back()), this._bb.expandByBoundingBox(e))
            }
        }(),
        getMatrixStack: function () {
            return this._matrixStack
        }
    }), "osg", "ComputeBoundsVisitor"), t.default = h
}, function (e, t, i) {
    "use strict";
    var n, r = i(36),
        a = i(12),
        o = i(20),
        s = function () {
            var e = {
                antialias: !0,
                fullscreen: !0,
                enableFrustumCulling: !1,
                scrollwheel: !0,
                webgl2: Object(o.a)().webgl2,
                powerPreference: "high-performance",
                shaderStats: !1,
                stats: !1
            };
            for (var t in e) this[t] = e[t]
        };
    s.getOptionsURL = function () {
        if (n) return n;
        if (n = {}, !window.location.search) return n;
        for (var e, t = [], i = window.location.search.slice(1).split("&"), a = 0; a < i.length; a++) {
            e = i[a].split("=");
            var o = e[0];
            t.push(o);
            var s = e[1];
            "0" !== s && "false" !== s && (void 0 === s && (s = "1"), n[o] = s)
        }
        if (void 0 !== n.log) {
            switch (n.log.toLowerCase()) {
                case "debug":
                    r.a.setNotifyLevel(r.a.DEBUG);
                    break;
                case "info":
                    r.a.setNotifyLevel(r.a.INFO);
                    break;
                case "notice":
                    r.a.setNotifyLevel(r.a.NOTICE);
                    break;
                case "warn":
                    r.a.setNotifyLevel(r.a.WARN);
                    break;
                case "error":
                    r.a.setNotifyLevel(r.a.ERROR);
                    break;
                case "html":
                    var u = [],
                        l = document.createElement("div"),
                        c = document.createElement("pre");
                    document.addEventListener("DOMContentLoaded", function () {
                        document.body.insertBefore(l, document.body.firstChild), l.appendChild(c)
                    });
                    var h = function (e) {
                        u.unshift(e), c.innerHTML = u.join("\n")
                    };
                    l.style.overflow = "hidden", l.style.position = "absolute", l.style.zIndex = "10000", l.style.height = "100%", l.style.maxWidth = "600px", l.style.pointerEvents = "none", c.style.overflow = "scroll", c.style.width = "105%", c.style.height = "100%", c.style.fontSize = "10px", c.style.pointerEvents = "none", ["log", "error", "warn", "info", "debug"].forEach(function (e) {
                        window.console[e] = h
                    })
            }
        }
        return n
    }, s.prototype = {
        extend: function (e) {
            return a.a.objectMix(this, e), this
        },
        get: function (e) {
            return this[e]
        },
        getBoolean: function (e) {
            var t = this.getString(e);
            if (t) return "false" !== t && "0" !== t
        },
        getNumber: function (e) {
            var t = this[e];
            if (t) return Number(t)
        },
        getString: function (e) {
            if (void 0 !== this[e]) return this[e].toString()
        },
        extendWithOptionsURL: function () {
            this.extend(s.getOptionsURL())
        }
    }, t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(102),
        a = i(406),
        o = i(315),
        s = function () {
            a.a.call(this), this._instanceID = r.a.getInstanceID(), this._vaoObject = void 0, this.dirty()
        };
    s._sDeletedGLVertexArrayObjectCache = new window.Map, s.deleteGLVertexArrayObject = function (e, t) {
        s._sDeletedGLVertexArrayObjectCache.has(e) || s._sDeletedGLVertexArrayObjectCache.set(e, []), s._sDeletedGLVertexArrayObjectCache.get(e).push(t)
    }, s.flushDeletedGLVertexArrayObjects = function (e, t) {
        if (t <= 0) return t;
        if (!s._sDeletedGLVertexArrayObjectCache.has(e)) return t;
        for (var i = 0, n = o.a.instance().tick(), r = s._sDeletedGLVertexArrayObjectCache.get(e), a = r.length, u = a - 1; u >= 0 && i < t; u--) e.deleteVertexArray(r[u]), r.splice(u, 1), i = o.a.instance().deltaS(n, o.a.instance().tick());
        return t - i
    }, s.flushAllDeletedGLVertexArrayObjects = function (e) {
        if (s._sDeletedGLVertexArrayObjectCache.has(e))
            for (var t = s._sDeletedGLVertexArrayObjectCache.get(e), i = t.length, n = i - 1; n >= 0; n--) e.deleteVertexArray(t[n]), t.splice(n, 1)
    }, s.onLostContext = function (e) {
        if (s._sDeletedGLVertexArrayObjectCache.has(e)) {
            s._sDeletedGLVertexArrayObjectCache.get(e).length = 0
        }
    }, n.a.createPrototypeObject(s, n.a.objectInherit(a.a.prototype, {
        getInstanceID: function () {
            return this._instanceID
        },
        invalidate: function () {
            this._vaoObject = void 0, this.dirty()
        },
        releaseGLObjects: function () {
            void 0 !== this._vaoObject && void 0 !== this._gl && (s.deleteGLVertexArrayObject(this._gl, this._vaoObject), a.a.removeObject(this._gl, this)), this.invalidate()
        },
        create: function (e) {
            this._vaoObject = e.createVertexArray(), this._dirty = !1
        },
        bind: function (e) {
            this._gl || this.setGraphicContext(e), this._vaoObject && e.bindVertexArray(this._vaoObject)
        },
        dirty: function () {
            this._dirty = !0
        },
        isDirty: function () {
            return this._dirty
        }
    }), "osg", "VertexArrayObject"), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(290),
        r = function () {
            this._keys = new n.a, this._map = {}
        };
    r.prototype = {
        reset: function () {
            for (var e = this._keys.getArray(), t = this._keys.getLength(), i = 0; i < t; i++) {
                var n = e[i];
                this._map[n] = void 0
            }
            this._keys.reset()
        },
        set: function (e, t) {
            this._keys.push(e), this._map[e] = t
        },
        hasKey: function (e) {
            return void 0 !== this._map[e]
        },
        getMap: function () {
            return this._map
        },
        getKeys: function () {
            return this._keys
        },
        forEach: function (e) {
            for (var t = this._keys.getArray(), i = this._keys.getLength(), n = 0; n < i; n++) {
                var r = t[n];
                e(r, this._map[r])
            }
        }
    }, t.a = r
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(290),
        a = i(614),
        o = i(318),
        s = function () {
            this._depth = 0, this._children = new a.a, this._leafs = new r.a, this._stateset = void 0, this._parent = void 0
        },
        u = function () {
            return new s
        };
    s.pooledStateGraph = new o.a(u), s.statsNbMoveStateGraph = 0, s.reset = function () {
        s.pooledStateGraph.reset(), s.statsNbMoveStateGraph = 0
    }, n.a.createPrototypeObject(s, {
        clean: function () {
            this._leafs.reset(), this._children.reset(), this._depth = 0, this._stateset = void 0, this._parent = void 0
        },
        getStateSet: function () {
            return this._stateset
        },
        getLeafs: function () {
            return this._leafs
        },
        getParent: function () {
            return this._parent
        },
        findOrInsert: function (e) {
            var t = e.getInstanceID(),
                i = this._children.getMap(),
                n = i[t];
            return n || (n = s.pooledStateGraph.getOrCreateObject(), n.clean(), n._parent = this, n._depth = this._depth + 1, n._stateset = e, this._children.set(t, n)), n
        }
    }, "osg", "StateGraph"), s.moveStateGraph = function () {
        var e = new r.a,
            t = e.getArray();
        return function (i, n, r) {
            s.statsNbMoveStateGraph++, e.reset();
            var a, o, u = r,
                l = n;
            if (u !== l && void 0 !== u)
                if (void 0 !== l) {
                    if (l._parent === u._parent) return void 0 !== l._stateset && i.popStateSet(), void(void 0 !== u._stateset && i.pushStateSet(u._stateset));
                    for (; l._depth > u._depth;) void 0 !== l._stateset && i.popStateSet(), l = l._parent;
                    for (e.reset(); u._depth > l._depth;) void 0 !== u._stateset && e.push(u._stateset), u = u._parent;
                    for (; l !== u;) void 0 !== l._stateset && i.popStateSet(), l = l._parent, void 0 !== u._stateset && e.push(u._stateset), u = u._parent;
                    for (a = e._length - 1, o = 0; a >= o; --a) i.pushStateSet(t[a])
                } else {
                    do {
                        void 0 !== u._stateset && e.push(u._stateset), u = u._parent
                    } while (u);
                    for (a = e._length - 1, o = 0; a >= o; --a) i.pushStateSet(t[a])
                }
        }
    }(), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(197),
        a = i(363),
        o = i(36),
        s = i(575),
        u = i(10),
        l = i(318),
        c = function () {
            s.a.call(this), this._clearColor = u.g.create(), this._clearDepth = void 0, this._clearMask = void 0, this._camera = void 0, this._viewport = void 0, this._scissor = void 0, this._preRenderList = [], this._postRenderList = [], c.prototype.init.call(this)
        },
        h = function () {
            return {
                renderStage: null,
                order: null
            }
        },
        d = new l.a(h);
    n.a.createPrototypeObject(c, n.a.objectInherit(s.a.prototype, {
        init: function () {
            return s.a.prototype.init.call(this), this._clearDepth = 1, u.g.set(this._clearColor, 0, 0, 0, 1), this._clearMask = r.a.COLOR_BUFFER_BIT | r.a.DEPTH_BUFFER_BIT, this._camera = void 0, this._viewport = void 0, this._scissor = void 0, this._renderStage = this, c.prototype._initInternal.call(this), this
        },
        _initInternal: function () {
            this._preRenderList.length = 0, this._postRenderList.length = 0
        },
        reset: function () {
            d.reset(), s.a.prototype.reset.call(this), c.prototype._initInternal.call(this)
        },
        setClearDepth: function (e) {
            this._clearDepth = e
        },
        getClearDepth: function () {
            return this._clearDepth
        },
        setClearColor: function (e) {
            u.g.copy(this._clearColor, e)
        },
        getClearColor: function () {
            return this._clearColor
        },
        setClearMask: function (e) {
            this._clearMask = e
        },
        getClearMask: function () {
            return this._clearMask
        },
        setViewport: function (e) {
            this._viewport = e
        },
        getViewport: function () {
            return this._viewport
        },
        setScissor: function (e) {
            this._scissor = e
        },
        getScissor: function () {
            return this._scissor
        },
        setCamera: function (e) {
            this._camera = e
        },
        getCamera: function () {
            return this._camera
        },
        getPreRenderStageList: function () {
            return this._preRenderList
        },
        getPostRenderStageList: function () {
            return this._postRenderList
        },
        addPreRenderStage: function (e, t) {
            for (var i = 0, n = this._preRenderList.length; i < n; i++) {
                if (t < this._preRenderList[i].order) break
            }
            var r = d.getOrCreateObject();
            r.order = t, r.renderStage = e, i < this._preRenderList.length ? this._preRenderList.splice(i, 0, r) : this._preRenderList.push(r)
        },
        addPostRenderStage: function (e, t) {
            for (var i = 0, n = this._postRenderList.length; i < n; i++) {
                if (t < this._postRenderList[i].order) break
            }
            var r = d.getOrCreateObject();
            r.order = t, r.renderStage = e, i < this._postRenderList.length ? this._postRenderList.splice(i, 0, r) : this._postRenderList.push(r)
        },
        drawPreRenderStages: function (e, t) {
            for (var i = t, n = 0, r = this._preRenderList.length; n < r; ++n) {
                i = this._preRenderList[n].renderStage.draw(e, i)
            }
            return i
        },
        draw: function (e, t) {
            this._camera && this._camera.getInitialDrawCallback() && this._camera.getInitialDrawCallback()(e);
            var i = this.drawPreRenderStages(e, t);
            return i = this.drawImplementation(e, i), i = this.drawPostRenderStages(e, i), this._camera && this._camera.getFinalDrawCallback() && this._camera.getFinalDrawCallback()(e), i
        },
        sort: function () {
            for (var e = 0, t = this._preRenderList.length; e < t; ++e) this._preRenderList[e].renderStage.sort();
            s.a.prototype.sort.call(this);
            for (var i = 0, n = this._postRenderList.length; i < n; ++i) this._postRenderList[i].renderStage.sort()
        },
        drawPostRenderStages: function (e, t) {
            for (var i = t, n = 0, r = this._postRenderList.length; n < r; ++n) {
                i = this._postRenderList[n].renderStage.draw(e, i)
            }
            return i
        },
        applyCamera: function (e) {
            var t = e.getGraphicContext();
            if (void 0 === this._camera) return void t.bindFramebuffer(t.FRAMEBUFFER, null);
            var i = this._camera.getViewport(),
                n = this._camera.frameBufferObject;
            if (n || (n = new a.a, this._camera.frameBufferObject = n), n.isDirty()) {
                var r, o, s = this._camera.getAttachments(),
                    u = s[a.a.COLOR_ATTACHMENT0];
                u && u.texture && (r = u.texture.getWidth(), o = u.texture.getHeight());
                for (var l in s) {
                    u = s[l];
                    var c = {};
                    c.attachment = u.attachment, void 0 === u.texture ? (c.format = u.format, c.width = void 0 !== r ? r : i.width(), c.height = void 0 !== o ? o : i.height()) : (c.texture = u.texture, c.textureTarget = u.textureTarget, u.format && (c.format = u.format)), n.setAttachment(c)
                }
            }
            n.apply(e)
        },
        drawImplementation: function (e, t) {
            var i = e.getGraphicContext();
            return this.applyCamera(e), void 0 === this._viewport && o.a.log("RenderStage does not have a valid viewport"), e.applyAttribute(this._viewport), this._scissor && e.applyAttribute(this._scissor), 0 !== this._clearMask && (this._clearMask & i.COLOR_BUFFER_BIT && e.clearColor(this._clearColor), this._clearMask & i.DEPTH_BUFFER_BIT && (e.depthMask(!0), e.clearDepth(this._clearDepth)), e.clear(this._clearMask)), 0 !== this._positionedAttribute.getLength() && this.applyPositionedAttribute(e, this._positionedAttribute), s.a.prototype.drawImplementation.call(this, e, t)
        }
    }), "osg", "RenderStage"), c.clean = function () {
        d.clean()
    }, t.a = c
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(198),
        a = i(853),
        o = i(84),
        s = i(576),
        u = i(451),
        l = function () {
            o.a.call(this, o.a.TRAVERSE_ALL_CHILDREN)
        };
    n.a.createPrototypeObject(l, n.a.objectInherit(o.a.prototype, {
        apply: function (e) {
            if (e.getTypeID() === u.a.getTypeID()) {
                var t = e.getUpdateCallback();
                if (t instanceof s.a) {
                    for (var i = t._stackedTransforms, n = 0, r = i.length; n < r; n++) {
                        i[n].resetToDefaultValue()
                    }
                    t.computeChannels()
                }
            }
            this.traverse(e)
        }
    }), "osgAnimation", "ResetRestPoseVisitor");
    var c = new l,
        h = function () {
            r.a.call(this)
        };
    n.a.createPrototypeNode(h, n.a.objectInherit(r.a.prototype, {
        setDefaultUpdateCallback: function () {
            this.addUpdateCallback(new a.a)
        },
        setRestPose: function () {
            this.accept(c)
        }
    }), "osgAnimation", "Skeleton"), t.a = h
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(36),
        a = i(576),
        o = i(10),
        s = i(84),
        u = function () {
            a.a.call(this)
        };
    n.a.createPrototypeObject(u, n.a.objectInherit(a.a.prototype, {
        update: function (e, t) {
            if (t.getVisitorType() === s.a.UPDATE_VISITOR) {
                if (e.className && "Bone" !== e.className()) return r.a.warn("Warning: UpdateBone set on non-Bone object."), !1;
                var i = e;
                a.a.prototype.update.call(this, e), i.setMatrix(i.getMatrix());
                var n = i.getMatrix(),
                    u = i.getBoneParent();
                u ? o.c.mul(i.getMatrixInSkeletonSpace(), u.getMatrixInSkeletonSpace(), n) : i.setMatrixInSkeletonSpace(n)
            }
            return !0
        }
    }), "osgAnimation", "UpdateBone"), t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(92),
        a = i(108),
        o = i(10),
        s = function (e, t) {
            r.a.call(this);
            var i = void 0 !== e ? e : 0;
            this._ambient = o.g.fromValues(.2, .2, .2, 1), this._diffuse = o.g.fromValues(.8, .8, .8, 1), this._specular = o.g.fromValues(.2, .2, .2, 1), this._position = o.g.fromValues(0, 0, 1, 0), this._direction = o.f.fromValues(0, 0, -1), this._ground = o.g.fromValues(.2, .2, .2, -1), this._spotCutoff = 180, this._spotBlend = .01, this._attenuation = o.g.fromValues(1, 0, 0, 0), this._lightNumber = i, this._enable = !t, this._dirtyHash = !0, this._hash = ""
        };
    s.DIRECTION = "DIRECTION", s.SPOT = "SPOT", s.POINT = "POINT", s.HEMI = "HEMI", s.uniforms = {}, n.a.createPrototypeStateAttribute(s, n.a.objectInherit(r.a.prototype, {
        attributeType: "Light",
        cloneType: function () {
            return new s(this._lightNumber, !0)
        },
        getTypeMember: function () {
            return this.attributeType + this._lightNumber
        },
        getUniformName: function (e) {
            return "u" + this.getTypeMember() + "_" + e
        },
        getHash: function () {
            return this._dirtyHash ? (this._hash = this._computeInternalHash(), this._dirtyHash = !1, this._hash) : this._hash
        },
        _computeInternalHash: function () {
            return this.getTypeMember() + this.getLightType() + this.isEnabled().toString()
        },
        getOrCreateUniforms: function () {
            var e = s,
                t = this.getTypeMember();
            return e.uniforms[t] ? e.uniforms[t] : (e.uniforms[t] = {
                viewPosition: a.a.createFloat4(this.getUniformName("viewPosition")),
                viewDirection: a.a.createFloat3(this.getUniformName("viewDirection")),
                modelViewMatrix: a.a.createMatrix4(this.getUniformName("modelViewMatrix")),
                modelViewNormalMatrix: a.a.createMatrix3(this.getUniformName("modelViewNormalMatrix")),
                ambient: a.a.createFloat4(this.getUniformName("ambient")),
                diffuse: a.a.createFloat4(this.getUniformName("diffuse")),
                specular: a.a.createFloat4(this.getUniformName("specular")),
                attenuation: a.a.createFloat4(this.getUniformName("attenuation")),
                spotCutOff: a.a.createFloat1(this.getUniformName("spotCutOff")),
                spotBlend: a.a.createFloat1(this.getUniformName("spotBlend")),
                ground: a.a.createFloat4(this.getUniformName("ground"))
            }, e.uniforms[t])
        },
        isEnabled: function () {
            return this._enable
        },
        setEnabled: function (e) {
            this._enable = e, this._dirtyHash = !0
        },
        setAmbient: function (e) {
            o.g.copy(this._ambient, e)
        },
        getAmbient: function () {
            return this._ambient
        },
        setDiffuse: function (e) {
            o.g.copy(this._diffuse, e)
        },
        getDiffuse: function () {
            return this._diffuse
        },
        setSpecular: function (e) {
            o.g.copy(this._specular, e)
        },
        getSpecular: function () {
            return this._specular
        },
        setPosition: function (e) {
            o.g.copy(this._position, e)
        },
        getPosition: function () {
            return this._position
        },
        setDirection: function (e) {
            o.f.copy(this._direction, e)
        },
        getDirection: function () {
            return this._direction
        },
        setSpotCutoff: function (e) {
            this._spotCutoff = e
        },
        getSpotCutoff: function () {
            return this._spotCutoff
        },
        setSpotBlend: function (e) {
            this._spotBlend = e
        },
        getSpotBlend: function () {
            return this._spotBlend
        },
        setGround: function (e) {
            o.f.copy(this._ground, e)
        },
        getGround: function () {
            return this._ground
        },
        setConstantAttenuation: function (e) {
            this._attenuation[0] = e
        },
        getConstantAttenuation: function () {
            return this._attenuation[0]
        },
        setLinearAttenuation: function (e) {
            this._attenuation[1] = e
        },
        getLinearAttenuation: function () {
            return this._attenuation[1]
        },
        setQuadraticAttenuation: function (e) {
            this._attenuation[2] = e
        },
        getQuadraticAttenuation: function () {
            return this._attenuation[2]
        },
        setLightType: function (e) {
            return e === s.DIRECTION ? this.setLightAsDirection() : e === s.SPOT ? this.setLightAsSpot() : e === s.HEMI ? this.setLightAsHemi() : this.setLightAsPoint()
        },
        getLightType: function () {
            return this.isDirectionLight() ? s.DIRECTION : this.isSpotLight() ? s.SPOT : this.isHemiLight() ? s.HEMI : s.POINT
        },
        setLightAsSpot: function () {
            o.g.set(this._position, 0, 0, 0, 1), o.f.set(this._direction, 0, 0, -1), this._ground[3] = -1, this._spotCutoff = 90, this._dirtyHash = !0
        },
        setLightAsPoint: function () {
            o.g.set(this._position, 0, 0, 0, 1), o.f.set(this._direction, 0, 0, -1), this._ground[3] = -1, this._dirtyHash = !0
        },
        setLightAsDirection: function () {
            o.g.set(this._position, 0, 0, 1, 0), this._spotCutoff = 180, this._ground[3] = -1, this._dirtyHash = !0
        },
        setLightAsHemi: function () {
            o.g.set(this._position, 0, 0, 1, 0), this._spotCutoff = 180, this._ground[3] = 1, this._dirtyHash = !0
        },
        setLightNumber: function (e) {
            this._lightNumber = e, this._dirtyHash = !0
        },
        getLightNumber: function () {
            return this._lightNumber
        },
        isSpotLight: function () {
            return this._spotCutoff < 180
        },
        isDirectionLight: function () {
            return 0 === this._position[3] && -1 === this._ground[3]
        },
        isHemiLight: function () {
            return 1 === this._ground[3]
        },
        applyPositionedUniform: function (e) {
            var t = this.getOrCreateUniforms(),
                i = t.modelViewMatrix.getInternalArray(),
                n = t.modelViewNormalMatrix.getInternalArray(),
                r = t.viewPosition.getInternalArray(),
                a = t.viewDirection.getInternalArray();
            o.c.copy(i, e), o.b.normalFromMat4(n, e), o.g.transformMat4(r, this._position, i), o.f.transformMat3(a, this._direction, n)
        },
        apply: function () {
            if (this._enable) {
                var e = this.getOrCreateUniforms();
                if (this.isSpotLight()) {
                    var t = Math.cos(this._spotCutoff * Math.PI / 180);
                    e.spotCutOff.setFloat(t), e.spotBlend.setFloat((1 - t) * this._spotBlend)
                }
                this.isHemiLight() && e.ground.setFloat4(this._ground), e.attenuation.setFloat4(this._attenuation), e.diffuse.setFloat4(this._diffuse), e.specular.setFloat4(this._specular), e.ambient.setFloat4(this._ambient)
            }
        }
    }), "osg", "Light"), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(453),
        r = 0,
        a = function (e, t) {
            for (var i = 1 / 0, n = -1 / 0, a = 0; a < e.length; a++) i = Math.min(i, e[a].start), n = Math.max(n, e[a].end);
            var o = n - i,
                s = t || "animation" + r.toString();
            return r++, {
                channels: e,
                duration: o,
                name: s,
                start: i
            }
        },
        o = function (e) {
            for (var t = [], i = 0; i < e.channels.length; i++) {
                var r = n.a.createInstanceChannel(e.channels[i]);
                t.push(r)
            }
            return {
                channels: t,
                duration: e.duration,
                start: 0,
                name: e.name,
                firstKeyTime: e.start
            }
        },
        s = function () {};
    s.createAnimation = a, s.createInstanceAnimation = o, t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(178),
        a = i(452),
        o = i(577),
        s = i(408),
        u = i(364),
        l = function () {
            o.a.call(this), this._targets = [], this._targetNames = [], this._morphs = [], this._weights = new Float32Array(u.a.MAX_MORPH_GPU), this._indexMap = new Uint32Array(u.a.MAX_MORPH_GPU), this._gpuMorphed = [], this._maxMorphGPU = -1
        },
        c = function (e, t) {
            return Math.abs(t.value) - Math.abs(e.value)
        };
    n.a.createPrototypeObject(l, n.a.objectInherit(o.a.prototype, {
        _initNode: function (e) {
            var t;
            e instanceof u.a ? t = e : e instanceof a.a && e.getSourceGeometry() instanceof u.a && (t = e.getSourceGeometry()), t && t.getName() === this.getName() && (t.isInitialized() || t.init(), this._morphs.push(t), this._maxMorphGPU = Math.min(this._maxMorphGPU, t.getMaximumPossibleMorphGPU()))
        },
        init: function (e) {
            this._maxMorphGPU = u.a.MAX_MORPH_GPU, this._morphs.length = 0;
            var t = e.getChildren();
            if (!t.length) return void this._initNode(e);
            for (var i = 0, n = t.length; i < n; i++) this._initNode(t[i])
        },
        isInitialized: function () {
            var e = this._morphs,
                t = e.length;
            if (!t) return !1;
            for (var i = 0; i < t; ++i)
                if (!e[i].isInitialized()) return !1;
            return !0
        },
        getNumTarget: function () {
            return this._targets.length
        },
        getTarget: function (e) {
            return this._targets[e]
        },
        getTargetName: function (e) {
            return this._targetNames[e]
        },
        addTarget: function (e, t) {
            this._targets[t] = s.a.createFloatTarget(0), this._targetNames[t] = e
        },
        _remapBufferArrays: function () {
            for (var e = this._indexMap, t = this._morphs, i = 0; i < this._maxMorphGPU; ++i)
                for (var n = e[i], r = "_" + i, a = "_" + n, o = 0, s = t.length; o < s; ++o)
                    for (var u = t[o], l = u.getVertexAttributeList(), c = u.getMorphTargetNames(), h = 0, d = c.length; h < d; ++h) {
                        var f = c[h];
                        l[f + r].setBufferArray(l[f + a].getInitialBufferArray())
                    }
        },
        _mergeExtraMorphTarget: function (e, t, i) {
            var n = 0,
                a = this._gpuMorphed,
                o = e[t],
                s = o.getElements().length,
                l = s / o.getItemSize(),
                c = o.getItemSize();
            o._cpuMorph = o._cpuMorph || new r.a(r.a.ARRAY_BUFFER, new Float32Array(s), c);
            var h = o._cpuMorph.getElements();
            for (n = 0; n < s; ++n) h[n] = 0;
            for (var d = this._targets, f = 0, p = d.length; f < p; ++f)
                if (!0 !== a[f]) {
                    var m = d[f].value;
                    if (!(Math.abs(m) <= u.a.EFFECTIVE_EPS)) {
                        m /= i;
                        var g = e[t + "_" + f].getInitialBufferArray().getElements();
                        for (n = 0; n < l; ++n) {
                            var v = n * c;
                            h[v] += m * g[v], h[v + 1] += m * g[v + 1], h[v + 2] += m * g[v + 2]
                        }
                    }
                } e[t + "_" + (this._maxMorphGPU - 1)].setBufferArray(o._cpuMorph), o._cpuMorph.dirty()
        },
        _computeExtraWeightsSum: function () {
            for (var e = this._gpuMorphed, t = 0, i = this._targets, n = 0, r = i.length; n < r; ++n)
                if (!0 !== e[n]) {
                    var a = i[n].value;
                    Math.abs(a) <= u.a.EFFECTIVE_EPS || (t += a)
                } return Math.abs(t) > 1e-5 ? t : t < 0 ? -1e-5 : 1e-5
        },
        _morphBufferArrayCPU: function () {
            for (var e = this._weights[this._maxMorphGPU - 1] = this._computeExtraWeightsSum(), t = {}, i = this._morphs, n = 0, r = i.length; n < r; ++n)
                for (var a = i[n], o = a.getVertexAttributeList(), s = a.getMorphTargetNames(), u = 0, l = s.length; u < l; ++u) {
                    var c = s[u],
                        h = o[c];
                    h && !t[h.getInstanceID()] && (t[h.getInstanceID()] = !0, this._mergeExtraMorphTarget(o, c, e))
                }
        },
        updateWeights: function () {
            if (0 !== this._maxMorphGPU) {
                var e = 0,
                    t = this._targets,
                    i = t.length,
                    n = this._weights;
                if (n[0] = n[1] = n[2] = n[3] = 0, i <= this._maxMorphGPU)
                    for (e = 0; e < i; ++e) n[e] = t[e].value;
                else {
                    var r = this._indexMap;
                    r[0] = r[1] = r[2] = r[3] = 0;
                    var a = this._gpuMorphed;
                    for (a.length = i, e = 0; e < i; ++e) a[e] = !1;
                    var o = t.slice(0).sort(c);
                    for (e = 0; e < this._maxMorphGPU; ++e) {
                        var s = t.indexOf(o[e]);
                        a[s] = !0, r[e] = s, n[e] = o[e].value
                    }
                    var l = Math.abs(o[this._maxMorphGPU].value),
                        h = l > u.a.EFFECTIVE_EPS;
                    a[r[this._maxMorphGPU - 1]] = !h, this._remapBufferArrays(), h && this._morphBufferArrayCPU()
                }
            }
        },
        reset: function () {
            for (var e = this._targets, t = 0, i = e.length; t < i; ++t) e[t].value = e[t].defaultValue
        },
        update: function (e) {
            this.isInitialized() || this.init(e), this.updateWeights();
            for (var t = this._weights, i = Math.min(this._maxMorphGPU, this._targets.length), n = this._morphs, r = 0, a = n.length; r < a; ++r)
                for (var o = n[r].getTargetsWeight(), s = 0; s < i; s++) o[s] = t[s];
            return !0
        }
    }), "osgAnimation", "UpdateMorph"), t.a = l
}, function (e, t, i) {
    "use strict";
    var n = i(5),
        r = i.n(n),
        a = i(422),
        o = i(578),
        s = i(871),
        u = i(36),
        l = function (e) {
            return "string" == typeof e || e instanceof String
        },
        c = function (e) {
            return "blob:http" === e.substr(0, 9)
        },
        h = function (e) {
            return "http://" === e.substr(0, 7) || "https://" === e.substr(0, 8)
        },
        d = function (e) {
            return !!l(e) && (c(e) || h(e))
        },
        f = window.zip,
        p = new window.Map,
        m = function (e) {
            return new r.a(function (t, i) {
                var n = new window.Image;
                n.onerror = function () {
                    i(n)
                }, n.onload = function () {
                    t(n)
                }, n.src = e
            })
        },
        g = function (e) {
            var t = window.URL.createObjectURL(e),
                i = m(t);
            return i.finally(function () {
                window.URL.revokeObjectURL(t)
            }), i
        },
        v = function (e) {
            return new r.a(function (t, i) {
                var n = new window.FileReader;
                n.onerror = function () {
                    i(n)
                }, n.onload = function () {
                    t(this.result)
                }, n.readAsArrayBuffer(e)
            })
        },
        _ = function (e) {
            return Object(s.a)(e, {
                responseType: "arraybuffer"
            })
        },
        b = function (e) {
            return Object(s.a)(e).then(function (e) {
                return JSON.parse(e)
            })
        },
        S = function (e) {
            var t = JSON.parse(e);
            return r.a.resolve(t)
        },
        x = {
            createJSONFromURL: b,
            createArrayBufferFromURL: _,
            createArrayBufferFromBlob: v,
            createImageFromBlob: g,
            createImageFromURL: m,
            requestURI: s.a,
            requestResource: function (e, t) {
                var i = x.getExtension(e),
                    n = x.getMimeType(i);
                if (t && t.responseType ? t.responseType.toLowerCase() : void 0) return Object(s.a)(e, t);
                if (n) {
                    if (n.match("image")) return m(e);
                    if (n.match("binary")) return _(e);
                    if (n.match("json")) return b(e);
                    if (n.match("text")) return Object(s.a)(e)
                }
                return Object(s.a)(e)
            },
            resolveData: function (e, t) {
                var i, n = x.getExtension(e),
                    a = x.getMimeType(n);
                a && (a.match("image") ? l(t) ? i = m : t instanceof window.Blob && (i = g) : a.match("json") ? i = d(t) ? b : S : a.match("binary") && (l(t) ? i = _ : t instanceof window.Blob && (i = v)));
                return i ? i(t) : r.a.resolve(t)
            },
            resolveFilesMap: function (e) {
                var t = [];
                for (var i in e) {
                    var n = e[i],
                        a = x.resolveData(i, n).then(function (e, t) {
                            this[e] = t
                        }.bind(e, i));
                    t.push(a)
                }
                return r.a.all(t).then(function () {
                    return e
                })
            },
            _unzipEntry: function (e) {
                return new r.a(function (t) {
                    var i = e.filename,
                        n = x.getExtension(i),
                        r = x.getMimeType(n),
                        a = f.BlobWriter;
                    null === r.match("text") && null === r.match("json") || (a = f.TextWriter), e.getData(new a(r), function (e) {
                        t({
                            filename: i,
                            data: e
                        })
                    })
                })
            },
            unzipBlob: function (e) {
                return new r.a(function (t, i) {
                    var n = {},
                        a = [];
                    f.createReader(new f.BlobReader(e), function (e) {
                        e.getEntries(function (i) {
                            for (var o = 0; o < i.length; o++)
                                if (!i[o].directory) {
                                    var s = x._unzipEntry(i[o]);
                                    s.then(function (e) {
                                        n[e.filename] = e.data
                                    }), a.push(s)
                                } r.a.all(a).then(function () {
                                e.close(), x.resolveFilesMap(n).then(function (e) {
                                    t(e)
                                })
                            })
                        })
                    }, function () {
                        i(this)
                    })
                })
            },
            unzip: function (e) {
                if (!window.zip) return r.a.reject("missing deps to unzip, require https://github.com/gildas-lormeau/zip.js");
                if (l(e)) return x.requestResource(e).then(function (e) {
                    var t = new window.Blob([e], {
                        type: p.get("zip")
                    });
                    return x.unzipBlob(t)
                });
                if (e instanceof window.Blob) return x.unzipBlob(e);
                if (e instanceof window.ArrayBuffer) {
                    var t = new window.Blob([e], {
                        type: p.get("zip")
                    });
                    return x.unzipBlob(t)
                }
                return r.a.reject("cant unzip input")
            },
            readFileList: function (e) {
                var t, i, n = {},
                    u = [];
                for (i = 0; i < e.length; ++i) {
                    var l = x.getExtension(e[i].name);
                    void 0 === o.a.instance().getReaderWriterForExtension(l) && "osgjs" !== l || (t = e[i].name);
                    var c, h = x.getMimeType(l);
                    c = h.match("image") ? "blob" : h.match("json") || h.match("text") ? "string" : "arraybuffer", u.push(Object(s.a)(e[i], {
                        responseType: c
                    }))
                }
                return r.a.all(u).then(function (r) {
                    for (i = 0; i < r.length; ++i) n[e[i].name] = r[i];
                    return x.resolveFilesMap(n).then(function (e) {
                        return a.default.readNodeURL(t, {
                            filesMap: e
                        })
                    })
                })
            },
            getMimeType: function (e) {
                return p.get(e)
            },
            getExtension: function (e) {
                return e.substr(e.lastIndexOf(".") + 1)
            },
            addMimeTypeForExtension: function (e, t) {
                void 0 !== p.has(e) && u.a.warn("the '" + e + "' already has a mimetype: " + p.get(e)), p.set(e, t)
            }
        };
    p.set("bin", "application/octet-binary"), p.set("b3dm", "application/octet-binary"), p.set("glb", "application/octet-binary"), p.set("zip", "application/octet-binary"), p.set("gz", "application/octet-binary"), p.set("png", "image/png"), p.set("jpg", "image/jpeg"), p.set("jpeg", "image/jpeg"), p.set("gif", "image/gif"), p.set("json", "application/json"), p.set("gltf", "application/json"), p.set("osgjs", "application/json"), p.set("txt", "text/plain"), p.set("glsl", "text/plain"), t.a = x
}, function (e, t, i) {
    "use strict";
    var n = i(5),
        r = i.n(n),
        a = i(12),
        o = i(177),
        s = a.a.rejectObject,
        u = {};
    u.Object = function (e, t) {
        var i = e.getJSON();
        if (i.Name && t.setName(i.Name), i.UserDataContainer) {
            var n = e.setJSON(i.UserDataContainer).readUserDataContainer();
            void 0 !== n && t.setUserData(n)
        }
        return t
    }, u.Node = function (e, t) {
        var i = e.getJSON();
        u.Object(e, t);
        var n = [];
        if (i.UpdateCallbacks)
            for (var a = t.addUpdateCallback.bind(t), o = 0, s = i.UpdateCallbacks.length; o < s; o++) {
                var l = e.setJSON(i.UpdateCallbacks[o]).readObject();
                n.push(l), l.then(a)
            }
        if (i.StateSet) {
            var c = e.setJSON(i.StateSet).readObject();
            n.push(c), c.then(t.setStateSet.bind(t))
        }
        var h = [];
        if (i.Children)
            for (var d = 0, f = i.Children.length; d < f; d++) h.push(e.setJSON(i.Children[d]).readObject());
        return r.a.all(n).then(function () {
            return r.a.all(h).then(function (e) {
                for (var i = e.length, n = 0; n < i; n++) t.addChild(e[n]);
                return t
            })
        })
    }, u.StateSet = function (e, t) {
        var i = e.getJSON();
        u.Object(e, t), void 0 !== i.RenderingHint && t.setRenderingHint(i.RenderingHint);
        var n = [];
        if (void 0 !== i.AttributeList)
            for (var a = 0, o = i.AttributeList.length; a < o; a++) ! function (i) {
                var r = e.setJSON(i).readObject();
                r.isRejected() || (n.push(r), r.then(t.setAttributeAndModes.bind(t)))
            }(i.AttributeList[a]);
        if (i.TextureAttributeList)
            for (var s = i.TextureAttributeList, l = 0, c = s.length; l < c; l++)
                for (var h = s[l], d = 0, f = h.length; d < f; d++) ! function (i, r) {
                    var a = e.setJSON(r).readObject();
                    a.isRejected() || (n.push(a), a.then(t.setTextureAttributeAndModes.bind(t, i)))
                }(l, h[d]);
        return r.a.all(n).then(function () {
            return t
        })
    }, u.Material = function (e, t) {
        var i = e.getJSON();
        return i.Diffuse && i.Emission && i.Specular && void 0 !== i.Shininess ? (u.Object(e, t), t.setAmbient(i.Ambient), t.setDiffuse(i.Diffuse), t.setEmission(i.Emission), t.setSpecular(i.Specular), t.setShininess(i.Shininess), r.a.resolve(t)) : s("Material", i)
    }, u.BlendFunc = function (e, t) {
        var i = e.getJSON();
        return i.SourceRGB && i.SourceAlpha && i.DestinationRGB && i.DestinationAlpha ? (u.Object(e, t), t.setSourceRGB(i.SourceRGB), t.setSourceAlpha(i.SourceAlpha), t.setDestinationRGB(i.DestinationRGB), t.setDestinationAlpha(i.DestinationAlpha), r.a.resolve(t)) : s("BlendFunc", i)
    }, u.CullFace = function (e, t) {
        var i = e.getJSON();
        return void 0 === i.Mode ? s("CullFace", i) : (u.Object(e, t), t.setMode(i.Mode), r.a.resolve(t))
    }, u.BlendColor = function (e, t) {
        var i = e.getJSON();
        return i.ConstantColor ? (u.Object(e, t), t.setConstantColor(i.ConstantColor), r.a.resolve(t)) : s("BlendColor", i)
    }, u.Light = function (e, t) {
        var i = e.getJSON();
        return i.Ambient && i.Diffuse && i.Direction && i.Position && i.Specular && void 0 !== i.LightNum && void 0 !== i.SpotCutoff && void 0 !== i.LinearAttenuation && void 0 !== i.ConstantAttenuation && void 0 !== i.QuadraticAttenuation ? (u.Object(e, t), t.setAmbient(i.Ambient), t.setConstantAttenuation(i.ConstantAttenuation), t.setDiffuse(i.Diffuse), t.setDirection(i.Direction), t.setLightNumber(i.LightNum), t.setLinearAttenuation(i.LinearAttenuation), t.setPosition(i.Position), t.setQuadraticAttenuation(i.QuadraticAttenuation), t.setSpecular(i.Specular), t.setSpotCutoff(i.SpotCutoff), t.setSpotBlend(.01), void 0 !== i.SpotExponent && t.setSpotBlend(i.SpotExponent / 128), r.a.resolve(t)) : s("Light", i)
    }, u.Texture = function (e, t) {
        var i = e.getJSON();
        u.Object(e, t), i.MinFilter && t.setMinFilter(i.MinFilter), i.MagFilter && t.setMagFilter(i.MagFilter), i.WrapT && t.setWrapT(i.WrapT), i.WrapS && t.setWrapS(i.WrapS);
        var n = i.File;
        return void 0 === n && (n = "no-image-provided"), e.readImageURL(n).then(function (e) {
            return t.setImage(e), t
        })
    }, u.Projection = function (e, t) {
        var i = e.getJSON();
        if (!i.Matrix) return s("Projection", i);
        var n = u.Node(e, t);
        return t.setMatrix(i.Matrix), n
    }, u.MatrixTransform = function (e, t) {
        var i = e.getJSON();
        if (!i.Matrix) return s("MatrixTransform", i);
        var n = u.Node(e, t);
        return t.setMatrix(i.Matrix), n
    }, u.LightSource = function (e, t) {
        var i = e.getJSON();
        if (!i.Light) return s("LightSource", i);
        var n = u.Node(e, t);
        return r.a.all([e.setJSON(i.Light).readObject(), n]).then(function (e) {
            var n = e[0];
            return t.setLight(n), "ABSOLUTE_RF" === i.ReferenceFrame && t.setReferenceFrame(o.a.ABSOLUTE_RF), t
        })
    }, u.functionSortAttributes = function (e, t) {
        return -1 !== e.indexOf("TexCoord") && -1 !== t.indexOf("TexCoord") ? parseInt(e.substr(8), 10) - parseInt(t.substr(8), 10) : e < t ? -1 : e > t ? 1 : 0
    }, u.Geometry = function (e, t) {
        var i = e.getJSON();
        if (!i.VertexAttributeList) return s("Geometry", i);
        i.PrimitiveSetList = i.PrimitiveSetList || [];
        var n = [];
        n.push(u.Node(e, t));
        var a = t.getPrimitives(),
            o = a.push.bind(a),
            l = 0,
            c = i.PrimitiveSetList.length;
        for (l = 0; l < c; l++) {
            var h = e.setJSON(i.PrimitiveSetList[l]).readPrimitiveSet();
            n.push(h), h.then(o)
        }
        var d = function (e, t) {
                this.getVertexAttributeList()[e] = t
            },
            f = i.VertexAttributeList,
            p = window.Object.keys(f);
        for (p.sort(u.functionSortAttributes), c = p.length, l = 0; l < c; l++) {
            var m = p[l],
                g = e.setJSON(f[m]).readBufferArray();
            n.push(g), g.then(d.bind(t, m))
        }
        return r.a.all(n).then(function () {
            return t
        })
    }, u.PagedLOD = function (e, t) {
        var i = e.getJSON();
        u.Object(e, t), "USE_BOUNDING_SPHERE_CENTER" === i.CenterMode ? t.setCenterMode(0) : "UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED" === i.CenterMode && t.setCenterMode(2), t.setCenter([i.UserCenter[0], i.UserCenter[1], i.UserCenter[2]]), t.setRadius(i.UserCenter[3]), "PIXEL_SIZE_ON_SCREEN" === i.RangeMode && t.setRangeMode(1);
        for (var n, a = i.RangeList, o = 0; o < window.Object.keys(a).length; o++) {
            n = "Range " + o;
            var s = a[n];
            t.setRange(o, s[0], s[1])
        }
        for (a = i.RangeDataList, o = 0; o < window.Object.keys(a).length; o++) n = "File " + o, t.setFileName(o, a[n]);
        t.setDatabasePath(e.getDatabasePath());
        var l = [];
        if (i.Children)
            for (var c = 0, h = i.Children.length; c < h; c++) l.push(e.setJSON(i.Children[c]).readObject());
        return r.a.all(l).then(function (e) {
            var i = e.length;
            for (o = 0; o < i; o++) t.addChildNode(e[o]);
            return t
        })
    }, t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(36),
        r = i(447),
        a = i(10),
        o = function (e) {
            e && (this._boundStrategy = e.boundStrategy, this.setInputManager(e.inputManager)), void 0 === this._boundStrategy && (this._boundStrategy = o.COMPUTE_HOME_USING_SPHERE), this._controllerList = {}, this._inverseMatrix = a.c.create(), this._camera = void 0, this._node = void 0, this._frustum = {}, this._computeBoundNodeMaskOverride = -1, this._tmpSphere = new r.a
        };
    o.prototype = {
        setCamera: function (e) {
            this._camera = e
        },
        getCamera: function () {
            return this._camera
        },
        setNode: function (e) {
            this._node = e
        },
        setComputeBoundNodeMaskOverride: function (e) {
            this._computeBoundNodeMaskOverride = e
        },
        getComputeBoundNodeMaskOverride: function () {
            return this._computeBoundNodeMaskOverride
        },
        setInputManager: function (e) {
            this._inputManager = e
        },
        getInputManager: function () {
            return this._inputManager
        },
        getHomeBoundingSphere: function (e) {
            var t = this._node;
            if (t) {
                var n = void 0 !== e ? e : this._boundStrategy;
                if (n & o.COMPUTE_HOME_USING_BBOX) {
                    var r;
                    if (-1 === this._computeBoundNodeMaskOverride) r = t.getBoundingBox();
                    else {
                        var a = i(611).default,
                            s = new a;
                        s.setNodeMaskOverride(this._computeBoundNodeMaskOverride), s.reset(), s.apply(t), r = s.getBoundingBox()
                    }
                    if (!r.valid()) return t.getBoundingSphere();
                    if (n & o.COMPUTE_HOME_USING_SPHERE) {
                        var u = t.getBoundingSphere();
                        if (u.valid() && u.volume() < r.volume()) return u
                    }
                    return this._tmpSphere.copyBoundingBox(r), this._tmpSphere
                }
                return t.getBoundingSphere()
            }
        },
        getHomeBound: function (e) {
            return n.a.warn("Please use getHomeBoundingSphere instead"), this.getHomeBoundingSphere(e)
        },
        getHomeDistance: function (e) {
            var t = this._frustum,
                i = e.radius();
            if (this._camera && a.c.getFrustum(t, this._camera.getProjectionMatrix())) {
                var n = Math.abs(t.right - t.left) / t.zNear / 2,
                    r = Math.abs(t.top - t.bottom) / t.zNear / 2;
                i /= Math.sin(Math.atan2(r < n ? r : n, 1))
            } else i *= 1.5;
            return i
        },
        update: function () {},
        getInverseMatrix: function () {
            return this._inverseMatrix
        },
        getControllerList: function () {
            return this._controllerList
        }
    }, o.COMPUTE_HOME_USING_SPHERE = 1, o.COMPUTE_HOME_USING_BBOX = 2, t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(626),
        r = function () {
            this._intersections = [], this._primitiveMask = n.a.ALL_PRIMITIVES, this._intersectionLimit = n.a.NO_LIMIT
        };
    r.prototype = {
        reset: function () {
            this._intersections.length = 0
        },
        enter: function (e) {
            return !this.reachedLimit() && (!e.isCullingActive() || this.intersectNode(e))
        },
        intersectNode: function (e) {
            return this.intersectBoundingSphere(e.getBoundingSphere()) || this.intersectBoundingBox(e.getBoundingBox())
        },
        intersectBoundingSphere: function () {
            return !1
        },
        intersectBoundingBox: function () {
            return !1
        },
        getIntersections: function () {
            return this._intersections
        },
        setIntersectionLimit: function (e) {
            this._intersectionLimit = e
        },
        getIntersectionLimit: function () {
            return this._intersectionLimit
        },
        setPrimitiveMask: function (e) {
            this._primitiveMask = e
        },
        getPrimitiveMask: function () {
            return this._primitiveMask
        },
        reachedLimit: function () {
            return this._intersectionLimit === n.a.LIMIT_ONE && this._intersections.length > 0
        },
        setCurrentTransformation: function () {},
        intersect: function () {}
    }, t.a = r
}, function (e, t, i) {
    "use strict";
    t.a = {
        NO_LIMIT: 0,
        LIMIT_ONE_PER_DRAWABLE: 1,
        LIMIT_ONE: 2,
        POINT_PRIMITIVES: 1,
        LINE_PRIMITIVES: 2,
        TRIANGLE_PRIMITIVES: 4,
        ALL_PRIMITIVES: 7
    }
}, function (e, t, i) {
    "use strict";
    var n = i(10),
        r = i(686),
        a = i(626),
        o = function () {
            this._hit = !1, this._primitiveIndex = 0, this._vertices = void 0, this._geometry = void 0, this._intersectionVisitor = void 0, this._intersector = void 0, this._limitOneIntersection = !1, this._primitiveMask = a.a.ALL_PRIMITIVES
        };
    o.Intersection = function () {
        this._nodePath = void 0, this._drawable = void 0, this._matrix = void 0, this._primitiveIndex = void 0, this._ratio = 0, this._backface = !1, this._localIntersectionPoint = n.f.create()
    }, o.prototype = {
        reset: function () {
            this._hit = !1, this._vertices = void 0, this._primitiveIndex = 0
        },
        setPrimitiveIndex: function (e) {
            this._primitiveIndex = e
        },
        setGeometry: function (e) {
            this._geometry = e, this._primitiveIndex = 0, this._vertices = e.getAttributes().Vertex.getElements()
        },
        setVertices: function (e) {
            this._vertices = e
        },
        setIntersectionVisitor: function (e) {
            this._intersectionVisitor = e
        },
        setIntersector: function (e) {
            this._intersector = e, this._primitiveMask = e.getPrimitiveMask();
            var t = e.getIntersectionLimit();
            this._limitOneIntersection = t === a.a.LIMIT_ONE_PER_DRAWABLE || t === a.a.LIMIT_ONE
        },
        setLimitOneIntersection: function (e) {
            this._limitOneIntersection = e
        },
        leave: function () {},
        enter: function () {},
        initIntersection: function (e) {
            return e._matrix = n.c.clone(this._intersectionVisitor.getModelMatrix()), e._nodePath = this._intersectionVisitor.getNodePath().slice(), e._primitiveIndex = this._primitiveIndex, e._drawable = this._geometry, this._intersector.getIntersections().push(e), this._hit = !0, e
        },
        intersectPoint: function () {},
        intersectLine: function () {},
        intersectTriangle: function () {},
        operatorPoint: function () {
            var e = n.f.create();
            return function (t) {
                if (!(this._limitOneIntersection && this._hit || 0 == (this._primitiveMask & a.a.POINT_PRIMITIVES))) {
                    var i = this._vertices;
                    n.f.set(e, i[3 * t], i[3 * t + 1], i[3 * t + 2]), this.intersectPoint(e, t), this._primitiveIndex++
                }
            }
        }(),
        operatorLine: function () {
            var e = n.f.create(),
                t = n.f.create();
            return function (i, r) {
                if (!(this._limitOneIntersection && this._hit || 0 == (this._primitiveMask & a.a.LINE_PRIMITIVES))) {
                    var o = this._vertices;
                    n.f.set(e, o[3 * i], o[3 * i + 1], o[3 * i + 2]), n.f.set(t, o[3 * r], o[3 * r + 1], o[3 * r + 2]), this.intersectLine(e, t, i, r), this._primitiveIndex++
                }
            }
        }(),
        operatorTriangle: function () {
            var e = n.f.create(),
                t = n.f.create(),
                i = n.f.create();
            return function (r, o, s) {
                if (!(this._limitOneIntersection && this._hit || 0 == (this._primitiveMask & a.a.TRIANGLE_PRIMITIVES))) {
                    var u = this._vertices;
                    n.f.set(e, u[3 * r], u[3 * r + 1], u[3 * r + 2]), n.f.set(t, u[3 * o], u[3 * o + 1], u[3 * o + 2]), n.f.set(i, u[3 * s], u[3 * s + 1], u[3 * s + 2]), this.intersectTriangle(e, t, i, r, o, s), this._primitiveIndex++
                }
            }
        }(),
        apply: function (e) {
            e.getAttributes().Vertex && Object(r.a)(e, this)
        }
    }, t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(366),
        r = i(12),
        a = i(446),
        o = i(114),
        s = function (e) {
            n.a.call(this, e), this.init()
        };
    r.a.createPrototypeObject(s, r.a.objectInherit(n.a.prototype, {
        init: function () {
            this._panFactor = [], this._panFactor[0] = 1, this._panFactor[1] = -this._panFactor[0], this._rotateFactor = [], this._rotateFactor[0] = .6, this._rotateFactor[1] = -this._rotateFactor[0], this._zoomFactor = 5, this._lastScale = 0, this._zooming = !1, this._dragStarted = !1, this._initInputs(o.a.ORBIT_MANIPULATOR_TOUCH)
        },
        _initInputs: function (e) {
            this._manipulator.getInputManager().group(e).addMappings({
                pinchEnd: "pinchend",
                pinchStart: "pinchstart",
                pinchInOut: ["pinchin", "pinchout"],
                startPan: ["panstart 2"],
                startRotate: ["panstart 1"],
                pan: ["panmove 2"],
                rotate: ["panmove 1"],
                endMotion: ["touchend 2", "touchcancel 2", "touchend 1", "touchcancel 1"]
            }, this)
        },
        startPan: function (e) {
            this._panning = !0, this.startMotion(this._manipulator.getPanInterpolator(), this._panFactor, e)
        },
        startRotate: function (e) {
            this._rotating = !0, this.startMotion(this._manipulator.getRotateInterpolator(), this._rotateFactor, e)
        },
        pan: function (e) {
            this._panning || (this.endMotion(), this.startPan(e)), this.move(this._manipulator.getPanInterpolator(), this._panFactor, e)
        },
        rotate: function (e) {
            this._rotating || (this.endMotion(), this.startPan(e)), this.move(this._manipulator.getRotateInterpolator(), this._rotateFactor, e)
        },
        startMotion: function (e, t, i) {
            if (!this._zooming) {
                e.reset();
                var n = i.canvasX * t[0],
                    r = i.canvasY * t[1];
                e.set(n, r)
            }
        },
        move: function (e, t, i) {
            var n = i.canvasX * t[0],
                r = i.canvasY * t[1];
            e.setTarget(n, r)
        },
        endMotion: function () {
            (this._panning || this._rotating) && (this._panning = !1, this._rotating = !1)
        },
        pinchStart: function (e) {
            this._zooming = !0, this._lastScale = e.scale;
            var t = this._manipulator.getZoomInterpolator();
            t.reset(), t.set(this._lastScale)
        },
        pinchEnd: function () {
            this._zooming = !1
        },
        pinchInOut: function (e) {
            if (this._zooming) {
                var t = e.scale > this._lastScale ? this._zoomFactor : 3 * this._zoomFactor,
                    i = .5 - Math.abs(e.velocity);
                t *= a.a.smoothStep(0, .5, i);
                var n = (e.scale - this._lastScale) * t;
                this._lastScale = e.scale;
                var r = this._manipulator.getZoomInterpolator();
                r.setTarget(r.getTarget()[0] - n)
            }
        },
        setManipulator: function (e) {
            this._manipulator = e
        }
    })), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = function (e, t) {
        this._current = new Float32Array(e), this._target = new Float32Array(e), this._delta = new Float32Array(e), this._delay = void 0 !== t ? t : .15, this._reset = !1, this._start = 0, this.reset()
    };
    n.prototype = {
        setDelay: function (e) {
            this._delay = e
        },
        reset: function () {
            for (var e = 0, t = this._current.length; e < t; e++) this._current[e] = this._target[e] = 0;
            this._reset = !0
        },
        update: function (e) {
            for (var t = Math.min(1, this._delay * e * 60), i = 0, n = this._current.length; i < n; i++) {
                var r = (this._target[i] - this._current[i]) * t;
                this._delta[i] = r, this._current[i] += r
            }
            return this._delta
        },
        set: function () {
            for (var e = 0, t = this._current.length; e < t; e++) this._current[e] = this._target[e] = arguments[e];
            this._reset = !1
        },
        isReset: function () {
            return this._reset
        },
        getCurrent: function () {
            return this._current
        },
        setTarget: function () {
            for (var e = 0, t = this._target.length; e < t; e++) this._reset ? this._target[e] = this._current[e] = arguments[e] : this._target[e] = arguments[e];
            this._reset = !1
        },
        addTarget: function () {
            for (var e = 0; e < arguments.length; e++) this._target[e] += arguments[e]
        },
        getTarget: function () {
            return this._target
        },
        getDelta: function () {
            return this._delta
        },
        getStart: function () {
            return this._start
        },
        setStart: function (e) {
            this._start = e
        }
    }, t.a = n
}, function (e, t, i) {
    "use strict";
    var n = i(86),
        r = i(44),
        a = function (e, t, i) {
            this._url = e, this._defer = new n.a, this._responseType = t, this._options = i
        };
    a.prototype = {
        getPromise: function () {
            return this._defer
        },
        getURL: function () {
            return this._url
        },
        start: function () {
            this._xhr = new XMLHttpRequest, this._xhr.addEventListener("error", this.error.bind(this), !1), this._xhr.addEventListener("abort", this.abort.bind(this), !1), this._xhr.addEventListener("progress", this.progress.bind(this), !1), this._xhr.addEventListener("load", function (e) {
                if (200 !== this._xhr.status) return console.log("Error not loaded " + this._url), void this.error(e);
                this._xhr.response || (this._xhr.response = this._xhr.responseText), this.load.call(this), r.a.draw()
            }.bind(this), !1), this._xhr.open("GET", this._url, !0), this._xhr.responseType = this._responseType, this._xhr.send(null)
        },
        error: function () {
            console.error("Error when downloading url : " + this._url), this._defer.reject(this)
        },
        abort: function () {
            this._defer.cancel(this)
        },
        progress: function (e) {
            var t = this._options;
            if (t && t.progress && t.size) {
                var i = e.loaded / t.size;
                t.progress(i, t.secondary, t.progressKey)
            }
        },
        load: function () {
            this._defer.resolve(this)
        },
        getXHR: function () {
            return this._xhr
        }
    }, t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(9)),
        a = i(20),
        o = i(581),
        s = i(38),
        u = i.n(s),
        l = r.a.osg,
        c = function (e, t, i, n) {
            var r = i - e,
                a = n - t;
            return r * r + a * a
        },
        h = function (e) {
            return o.a.isPowerOf2(e.width) && o.a.isPowerOf2(e.height)
        },
        d = {
            isVideoURL: function (e) {
                var t = e.split("."),
                    i = t[t.length - 1].toLowerCase();
                return "ogv" === i || "ogg" === i || "mp4" === i || "avi" === i || "webm" === i
            },
            isVideo: function () {
                return this.isVideoURL(this.get("images")[0].url)
            },
            getUID: function () {
                return this.get("uid")
            },
            getImages: function () {
                return this.get("images")
            },
            getURL: function () {
                console.error("dont call ImageSet.getURL")
            },
            filterPng: function (e, t) {
                var i = e[0];
                if (!i) return e;
                for (var r = 1; r < e.length; ++r)
                    if (e[r].width === i.width && e[r].height === i.height) return Object(n.filter)(e, function (e) {
                        return e.url.endsWith(".png") === t
                    });
                return e
            },
            findFormat: function (e) {
                var t = Object(n.filter)(this.get("images"), function (t) {
                    return !t.options || t.options.format === e
                });
                return "N" === e && Object(a.a)().preferOriginalNormalMap ? this.filterPng(t, !u.a.any) : t
            },
            getFilteredImages: function (e) {
                if (!e || !Object(a.a)().imageCompression) return this.findFormat();
                var t;
                switch (e) {
                    case l.Texture.ALPHA:
                        if (t = this.findFormat("A"), t.length > 0) return t;
                        break;
                    case l.Texture.RGB:
                        if (t = this.findFormat("RGB"), t.length > 0) return t;
                        if (t = this.findFormat("N"), t.length > 0) return t;
                        break;
                    case l.Texture.LUMINANCE:
                        if (t = this.findFormat("R"), t.length > 0) return t;
                        if (t = this.findFormat("RGB"), t.length > 0) return t;
                        if (t = this.findFormat("N"), t.length > 0) return t
                }
                return this.findFormat()
            },
            findImageNearestPowerOfTwoUpToResolution: function (e, t, i) {
                return this.findImageNearestUpToResolution(e, t, !0, i)
            },
            findImageNearestUpToResolution: function (e, t, i, n) {
                for (var r, a, o = 1 / 0, s = !1, u = 1 / 0, l = this.getFilteredImages(n), d = 0, f = l.length; d < f; ++d) {
                    var p = l[d],
                        m = c(e, t, p.width, p.height);
                    if (m < o && (o = m, r = p), !(p.width > e || p.height > t))
                        if (i) {
                            var g = h(p);
                            s && !g || (!a || !s && g || m < u || u === 1 / 0 && p.width > a.width && p.height > a.height) && (a = p, s = g, u = m)
                        } else(!a || m < u || u === 1 / 0 && p.width > a.width && p.height > a.height) && (a = p, u = m)
                }
                return a || r
            },
            findImageSmallest: function (e) {
                return this.findImageNearestToResolution(0, 0, e)
            },
            findImageWidget: function () {
                return this.findImageNearestToResolution(0, 0, l.Texture.RGB)
            },
            findImageNearestToResolution: function (e, t, i) {
                for (var n, r = 1 / 0, a = this.getFilteredImages(i), o = 0, s = a.length; o < s; ++o) {
                    var u = a[o],
                        l = c(e, t, u.width, u.height);
                    l < r && (r = l, n = u)
                }
                return n
            }
        };
    t.a = d
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(20),
        a = n.a.osg,
        o = function (e) {
            var t = a.WebGLCaps.instance(),
                i = t.getWebGLParameter("MAX_TEXTURE_SIZE"),
                n = t.getWebGLParameter("MAX_RENDERBUFFER_SIZE"),
                o = Object(r.a)().maxTextureSize,
                s = void 0 === e ? 1 / 0 : e;
            return Math.min(i, n, o, s)
        };
    t.a = o
}, function (e, t, i) {
    "use strict";
    var n, r = i(9),
        a = i(1265),
        o = i(1266),
        s = i(44),
        u = i(20),
        l = r.a.osg,
        c = r.a.osgGA,
        h = r.a.osgUtil,
        d = h.DelayInterpolator.prototype,
        f = d.set;
    d.set = function () {
        f.apply(this, arguments), this._epsilon >= 0 && !this.isDone() && n(!0)
    };
    var p = d.setTarget;
    d.setTarget = function () {
        p.apply(this, arguments), this._epsilon >= 0 && !this.isDone() && n(!0)
    };
    var m = d.addTarget;
    d.addTarget = function () {
        m.apply(this, arguments), this._epsilon >= 0 && !this.isDone() && n(!0)
    }, d.isDone = function (e) {
        e = e || 1;
        for (var t = Math.abs(this._epsilon), i = 0, n = this._current.length; i < n; ++i)
            if (Math.abs(this._target[i] - this._current[i]) > t * e) return !1;
        return !0
    };
    var g = d.update;
    d.update = function (e) {
        var t = g.call(this, e);
        if (this._epsilon >= 0)
            if (this.isDone())
                for (var i = 0, r = this._current.length; i < r; ++i) this._current[i] = this._target[i];
            else n(), this.isDone(100) ? s.a.draw() : s.a.drawNoJitter();
        return t
    };
    var v = function () {
            for (var e = Math.abs(this._epsilon), t = 0, i = this._current.length; t < i; ++t)
                if (1 === Math.abs(this._target[t]) || Math.abs(this._target[t] - this._current[t]) > e) return !1;
            return !0
        },
        _ = function (e) {
            e.isDone = v.bind(e)
        },
        b = function (e, t) {
            n = t, c.SwitchManipulator.call(this), this._boundStrategy = c.Manipulator.COMPUTE_HOME_USING_SPHERE | c.Manipulator.COMPUTE_HOME_USING_BBOX, this._inputManager = e, this.init()
        };
    l.createPrototypeObject(b, l.objectInherit(c.SwitchManipulator.prototype, {
        init: function () {
            c.SwitchManipulator.prototype.setManipulatorIndex.call(this, 0);
            var e = new o.a({
                boundStrategy: this._boundStrategy,
                inputManager: this._inputManager
            });
            e.getRotateInterpolator()._epsilon = .1, e.getPanInterpolator()._epsilon = .1, e.getZoomInterpolator()._epsilon = .001, e.getPanInterpolator()._isOrbitPan = !0;
            var t = new a.a({
                boundStrategy: this._boundStrategy,
                inputManager: this._inputManager
            });
            t.getLookPositionInterpolator()._epsilon = .1, t.getSideInterpolator()._epsilon = .001, _(t.getSideInterpolator()), t.getForwardInterpolator()._epsilon = .001, _(t.getForwardInterpolator()), t.getPanInterpolator()._epsilon = .001, _(t.getPanInterpolator()), t.getZoomInterpolator()._epsilon = .001, _(t.getZoomInterpolator()), this.addManipulator(e, "ORBIT"), this.addManipulator(t, "FPS"), void 0 !== Object(u.a)().cameraEasing && this.setDelay(1 - Object(u.a)().cameraEasing)
        },
        getOrbitManipulator: function () {
            return this._manipulatorList[b.ORBIT]
        },
        getFirstPersonManipulator: function () {
            return this._manipulatorList[b.FPS]
        },
        _setManipulatorDelay: function (e, t) {
            e.setDelay(t);
            var i = e._controllerList;
            for (var n in i) {
                var r = i[n];
                void 0 !== r._delay && (r._delay = t)
            }
        },
        setDelay: function (e) {
            this._setManipulatorDelay(this._manipulatorList[b.ORBIT], e), this._setManipulatorDelay(this._manipulatorList[b.FPS], e)
        },
        addManipulator: function (e, t) {
            c.SwitchManipulator.prototype.addManipulator.call(this, e), t && (b[t] = this.getManipulatorList().length - 1)
        },
        setManipulatorIndex: function () {
            var e = l.vec3.create(),
                t = l.vec3.create();
            return function (i) {
                if (i !== this.getCurrentManipulatorIndex()) {
                    var n = this.getCurrentManipulator();
                    c.SwitchManipulator.prototype.setManipulatorIndex.call(this, i), this.setTargetAndEye(n.getTarget(e), n.getEyePosition(t))
                }
            }
        }(),
        setTargetAndEye: function (e, t) {
            var i = this.getCurrentManipulator();
            this.getCurrentManipulatorIndex() === b.ORBIT ? (e && i.setTarget(e), t && i.setEyePosition(t)) : (t && i.setEyePosition(t), e && i.setTarget(e)), n(!0)
        },
        setEyePosition: function (e, t) {
            this.getCurrentManipulator().setEyePosition(e, t), n(!0)
        },
        getEyePosition: function (e) {
            return this.getCurrentManipulator().getEyePosition(e)
        },
        setTarget: function (e) {
            this.getCurrentManipulator().setTarget(e), n(!0)
        },
        getTarget: function (e) {
            return this.getCurrentManipulator().getTarget(e)
        },
        setDistance: function (e) {
            this.getCurrentManipulatorIndex() === b.ORBIT && (this.getCurrentManipulator().setDistance(e), n(!0))
        },
        getDistance: function () {
            return this.getCurrentManipulator().getDistance()
        },
        computeHomePosition: function (e) {
            c.SwitchManipulator.prototype.computeHomePosition.call(this, e), n(!0)
        }
    }), "osgSketchfab", "SwitchManipulator"), t.a = b
}, function (e, t, i) {
    "use strict";
    t.a = {
        iconCamCenter: i(1268),
        iconZoomHint: i(1269),
        iconsLight: {
            DIRECTION: i(1270),
            SPOT: i(1271),
            POINT: i(1272),
            HEMI: i(1273)
        },
        iconSound: i(1274),
        iconHotspot: i(1275)
    }
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(582),
        a = i(85),
        o = i(88),
        s = i(1276),
        u = n.a.osg,
        l = u.vec4.fromValues(1, 1, 1, 0),
        c = function (e, t) {
            return e._binNum - t._binNum
        },
        h = function (e, t) {
            for (var i = t ? t._parent : void 0, n = 0; i;) i._stateset && n++, i = i._parent;
            return n > 1 && n--, e.getStateSetStackSize() - n
        },
        d = s.a.passTypes,
        f = s.a.forceAttribute,
        p = u.StateAttribute.OVERRIDE_ON,
        m = function () {
            var e = new u.StateSet;
            e.setShaderGeneratorName("earlyz", p);
            for (var t = Object(r.a)(), i = 0; i < t; i++) e.setTextureAttributeAndModes(i, u.Texture.textureNull, p);
            return e
        }(),
        g = function () {
            u.RenderStage.apply(this, arguments), this._binArraySorted = [], g.prototype.init.call(this)
        },
        v = !0;
    g.setHasTriangles = function (e) {
        v = e
    };
    var _;
    g.setTimerGPU = function (e) {
        _ = e
    }, g.getTimerGPU = function () {
        return _
    };
    var b = u.vec4.create();
    g.getClearColor = function () {
        return b
    };
    var S;
    g.setCallbackDepth = function (e) {
        S = e
    }, u.createPrototypeObject(g, u.objectInherit(u.RenderStage.prototype, {
        constructor: g,
        init: function () {
            return u.RenderStage.prototype.init.call(this), this._binArraySorted.length = 0, this._renderBufferDepthAttachment = void 0, this
        },
        isMainCamera: function () {
            var e = this.getCamera();
            return !(!e || "PostProcess - MainCamera" !== e.getName())
        },
        isShadowCasterCamera: function () {
            var e = this.getCamera(),
                t = e && e.getName();
            return !(!t || !t.startsWith("light_shadow_camera"))
        },
        sortBinArray: function () {
            var e = this._binArraySorted;
            e.length = 0;
            for (var t = this._bins.getKeys(), i = t.getLength(), n = t.getArray(), r = this._bins.getMap(), a = 0; a < i; a++) {
                var o = n[a];
                e.push(r[o])
            }
            e.sort(c)
        },
        drawTransparentBin: function (e, t) {
            for (var i, n = t, r = this._binArraySorted, o = 0, u = r.length, l = s.a.currentPass === d.EARLYZ_TRANSPARENT; o < u; o++) {
                i = r[o];
                var c = i.getBinNumber();
                if (c !== a.a.TRANSPARENT) {
                    if (!l && (c === a.a.TRANSPARENT_NO_EARLYZ_POST || c === a.a.TRANSPARENT_NO_EARLYZ_PRE)) {
                        var h = f.depth;
                        f.depth = void 0, n = i.draw(e, n), f.depth = h
                    }
                } else n = i.draw(e, n)
            }
            return n
        },
        drawGroundBin: function (e, t) {
            for (var i, n = t, r = this._binArraySorted, o = 0, s = r.length; o < s; o++) {
                i = r[o];
                i.getBinNumber() === a.a.TRANSPARENT_CUSTOM_EARLYZ && (n = i.draw(e, n))
            }
            return n
        },
        drawOpaqueBin: function (e, t) {
            for (var i, n = this.getDoEarlyZ(), r = t, o = this._binArraySorted, u = 0, l = o.length; u < l && (i = o[u], !(i.getBinNumber() > 0)); u++) r = i.draw(e, r);
            r = this.drawLeafs(e, r);
            for (var c = s.a.currentPass === d.OPAQUE_SHADING; u < l; u++) {
                i = o[u];
                var h = i.getBinNumber();
                if (h === a.a.OPAQUE || h === a.a.REFRACTION || n && h === a.a.TRANSPARENT) r = i.draw(e, r);
                else if (c && h === a.a.OPAQUE_NO_EARLYZ) {
                    var p = f.depth;
                    f.depth = void 0, s.a.currentPass = d.DEFAULT, r = i.draw(e, r), s.a.currentPass = d.OPAQUE_SHADING, f.depth = p
                }
            }
            return r
        },
        drawRefractionBin: function (e, t) {
            for (var i, n = t, r = this._binArraySorted, o = 0, s = r.length; o < s; o++) {
                i = r[o];
                i.getBinNumber() === a.a.REFRACTION && (n = i.draw(e, n))
            }
            return n
        },
        drawExtraBin: function (e, t) {
            for (var i, n = t, r = this._binArraySorted, o = 0, s = r.length; o < s; o++) {
                i = r[o];
                i.getBinNumber() >= a.a.EXTRA && (n = i.draw(e, n))
            }
            return n
        },
        bindDepthRTT: function (e) {
            this.getCamera().fboDepth.apply(e)
        },
        bindTransparencyRTT: function (e) {
            this.getCamera().fboTransparent.apply(e)
        },
        bindRefractionRTT: function (e) {
            this.getCamera().fboRefraction.apply(e)
        },
        bindOpaqueRTT: function (e) {
            this.getCamera().fboOpaque.apply(e)
        },
        bindExtraRTT: function (e) {
            this.getCamera().fboExtra.apply(e)
        },
        createFBO: function (e, t) {
            if (t) {
                var i = new u.FrameBufferObject,
                    n = this._renderBufferDepthAttachment;
                n || (n = {
                    attachment: u.FrameBufferObject.DEPTH_ATTACHMENT,
                    format: u.FrameBufferObject.DEPTH_COMPONENT16,
                    width: t.getWidth(),
                    height: t.getHeight()
                }, this._renderBufferDepthAttachment = n), i.setAttachment(n);
                var r = {
                    attachment: u.FrameBufferObject.COLOR_ATTACHMENT0,
                    textureTarget: u.Texture.TEXTURE_2D,
                    texture: t
                };
                return i.setAttachment(r), i.apply(e), i
            }
        },
        drawOpaqueShading: function (e, t) {
            s.a.currentPass = d.OPAQUE_SHADING, f.depth = this.getDoEarlyZ() ? o.a.DEPTH_EQUAL_NO_WRITE : o.a.DEPTH_LESS_WRITE, f.blend = o.a.BLEND_DISABLE;
            var i = this.drawOpaqueBin(e, t);
            return f.blend = void 0, f.depth = void 0, s.a.currentPass = d.DEFAULT, i
        },
        drawEarlyOpaque: function (e, t) {
            s.a.currentPass = d.EARLYZ_OPAQUE, f.depth = o.a.DEPTH_LESS_WRITE, f.blend = o.a.BLEND_DISABLE, f.colorMask = this.isWritingDepth() ? o.a.COLOR_MASK_RGBA : o.a.COLOR_MASK_NONE;
            var i = this.drawOpaqueBin(e, t);
            return f.colorMask = void 0, f.blend = void 0, f.depth = void 0, s.a.currentPass = d.DEFAULT, i
        },
        drawEarlyAlpha: function (e, t) {
            s.a.currentPass = d.EARLYZ_TRANSPARENT, f.depth = o.a.DEPTH_LESS_NO_WRITE, f.colorMask = o.a.COLOR_MASK_ALPHA;
            var i = this.drawTransparentBin(e, t);
            return f.colorMask = void 0, f.depth = void 0, s.a.currentPass = d.DEFAULT, i
        },
        drawEarlyGround: function (e, t) {
            s.a.currentPass = d.EARLYZ_TRANSPARENT, f.depth = o.a.DEPTH_LESS_NO_WRITE, f.colorMask = o.a.COLOR_MASK_ALPHA;
            var i = this.drawGroundBin(e, t);
            return f.colorMask = void 0, f.depth = void 0, s.a.currentPass = d.DEFAULT, i
        },
        drawTransparentShading: function (e, t) {
            s.a.currentPass = d.TRANSPARENT_SHADING, f.depth = o.a.DEPTH_LEQUAL_NO_WRITE, f.blend = o.a.BLEND_SUBSTRACTIVE;
            var i = this.drawTransparentBin(e, t);
            return f.blend = void 0, f.depth = void 0, s.a.currentPass = d.DEFAULT, i
        },
        drawGroundShading: function (e, t) {
            s.a.currentPass = d.TRANSPARENT_SHADING, f.depth = o.a.DEPTH_LEQUAL_NO_WRITE, f.blend = o.a.BLEND_SUBSTRACTIVE;
            var i = this.drawGroundBin(e, t);
            return f.blend = void 0, f.depth = void 0, s.a.currentPass = d.DEFAULT, i
        },
        drawRefractionShading: function (e, t) {
            s.a.currentPass = d.REFRACTION, f.depth = o.a.DEPTH_LESS_WRITE, f.blend = o.a.BLEND_DISABLE;
            var i = this.drawRefractionBin(e, t);
            return f.blend = void 0, f.depth = void 0, s.a.currentPass = d.DEFAULT, i
        },
        drawExtra: function (e, t) {
            s.a.currentPass = d.EXTRA;
            var i = this.drawExtraBin(e, t);
            return s.a.currentPass = d.DEFAULT, i
        },
        isWritingDepth: function () {
            return !!this.getCamera()._textureDepth
        },
        getDoEarlyZ: function () {
            return v || this.isWritingDepth()
        },
        drawImplementationSketchfab: function (e, t) {
            var i = e.getGraphicContext(),
                n = t,
                r = this.getCamera(),
                a = !!r._textureDepth;
            if (a ? (this.bindDepthRTT(e), e.clearColor(l)) : (this.bindOpaqueRTT(e), e.clearColor(b)), e.depthMask(!0), e.clearDepth(this.getClearDepth()), e.clear(i.COLOR_BUFFER_BIT | i.DEPTH_BUFFER_BIT), this.getDoEarlyZ()) {
                var s = h(e, n);
                e.insertStateSet(s, m), _.start("EarlyOpaque"), n = this.drawEarlyOpaque(e, n), _.end("EarlyOpaque");
                var c = a && r._textureTransparent;
                c && (_.start("EarlyTransparency"), n = this.drawEarlyAlpha(e, n), _.end("EarlyTransparency")), S && S(e), e.removeStateSet(s), c && (_.start("EarlyTransparencyCustom"), n = this.drawEarlyGround(e, n), _.end("EarlyTransparencyCustom")), e.applyAttribute(o.a.COLOR_MASK_RGBA)
            }
            return a && (this.bindOpaqueRTT(e), e.clearColor(b), e.clear(i.COLOR_BUFFER_BIT)), _.start("ShadingOpaque"), n = this.drawOpaqueShading(e, n), _.end("ShadingOpaque"), e.clearColor(u.vec4.ZERO), r._textureTransparent && (this.bindTransparencyRTT(e), e.clear(i.COLOR_BUFFER_BIT), _.start("ShadingTransparency"), n = this.drawGroundShading(e, n), n = this.drawTransparentShading(e, n), _.end("ShadingTransparency")), r._textureRefraction && (this.bindRefractionRTT(e), e.clear(i.COLOR_BUFFER_BIT), _.start("ShadingRefraction"), n = this.drawRefractionShading(e, n), _.end("ShadingRefraction")), r._textureExtra && (this.bindExtraRTT(e), e.clear(i.COLOR_BUFFER_BIT), _.start("Extra"), n = this.drawExtra(e, n), _.end("Extra")), n
        },
        drawImplementation: function (e, t) {
            if (!this.isMainCamera()) {
                this.isShadowCasterCamera() && (s.a.currentPass = d.SHADOWMAP);
                var i = u.RenderStage.prototype.drawImplementation.call(this, e, t);
                return s.a.currentPass = d.DEFAULT, i
            }
            var n = this.getCamera();
            if (!n._textureOpaque) return t;
            n.fboOpaque || (n.fboOpaque = this.createFBO(e, n._textureOpaque)), n.fboTransparent || (n.fboTransparent = this.createFBO(e, n._textureTransparent)), n.fboDepth || (n.fboDepth = this.createFBO(e, n._textureDepth)), n.fboRefraction || (n.fboRefraction = this.createFBO(e, n._textureRefraction)), n.fboExtra || (n.fboExtra = this.createFBO(e, n._textureExtra));
            var r = this.getViewport();
            void 0 === r && u.log("RenderStage does not have a valid viewport"), e.applyAttribute(r), this._scissor && e.applyAttribute(this._scissor), 0 !== this._positionedAttribute.getLength() && this.applyPositionedAttribute(e, this._positionedAttribute), this.sortBinArray();
            var a = t;
            return _.start("Shading"), a = this.drawImplementationSketchfab(e, a), _.end("Shading"), a
        }
    }), "osgSketchfab", "RenderStageSketchfab"), u.RenderBin.prototype.drawLeafs = function (e, t) {
        for (var i, n = this.getStateGraphList(), r = n.getArray(), a = this._leafs, o = t, u = this.getStage().getViewport(), l = 0; l < a.length; l++) i = a[l], s.a.LAST_LEAF = i, !i.isVR && o && o.isVR && e.applyViewport(u), i.render(e, o), o = i;
        for (var c = n.getLength(), h = 0; h < c; h++)
            for (var d = r[h], f = d._leafs.getArray(), p = d._leafs.getLength(), m = 0; m < p; m++) i = f[m], s.a.LAST_LEAF = i, !i.isVR && o && o.isVR && e.applyViewport(u), i.render(e, o), o = i;
        return o
    }, t.a = g
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = n.a.osg,
        a = {
            uProjFactor: r.Uniform.createFloat("uProjFactor"),
            uSsaoRadius: r.Uniform.createFloat("uSsaoRadius"),
            uSsaoIntensity: r.Uniform.createFloat("uSsaoIntensity"),
            uSsaoBias: r.Uniform.createFloat("uSsaoBias"),
            uSsaoProjectionInfo: r.Uniform.createFloat4("uSsaoProjectionInfo"),
            uSsaoProjectionScale: r.Uniform.createFloat(1, "uSsaoProjectionScale"),
            uDofBlurNearFarFocal: r.Uniform.createFloat3("uDofBlurNearFarFocal"),
            uDofCross: r.Uniform.createFloat3(r.vec3.create(), "uDofCross"),
            uDofScale: r.Uniform.createFloat(1, "uDofScale"),
            uBloomFactor: r.Uniform.createFloat("uBloomFactor"),
            uBloomThreshold: r.Uniform.createFloat("uBloomThreshold"),
            uBloomRadius: r.Uniform.createFloat("uBloomRadius"),
            uChromaFactor: r.Uniform.createFloat("uChromaFactor"),
            uColorBalanceLow: r.Uniform.createFloat3("uColorBalanceLow"),
            uColorBalanceMid: r.Uniform.createFloat3("uColorBalanceMid"),
            uColorBalanceHigh: r.Uniform.createFloat3("uColorBalanceHigh"),
            uToneExposure: r.Uniform.createFloat("uToneExposure"),
            uToneBrightness: r.Uniform.createFloat("uToneBrightness"),
            uToneContrast: r.Uniform.createFloat("uToneContrast"),
            uToneSaturation: r.Uniform.createFloat("uToneSaturation"),
            uToneMethod: r.Uniform.createInt("uToneMethod"),
            uDistortion: r.Uniform.createFloat2("uDistortion"),
            uProjectionLeft: r.Uniform.createFloat4("uProjectionLeft"),
            uUnprojectionLeft: r.Uniform.createFloat4("uUnprojectionLeft"),
            uSharpFactor: r.Uniform.createFloat("uSharpFactor"),
            uLensRadius: r.Uniform.createFloat2("uLensRadius"),
            uTimeGrain: r.Uniform.createFloat("uTimeGrain"),
            uGrainFactor: r.Uniform.createFloat("uGrainFactor"),
            uTaaInvViewMatrixLeft: r.Uniform.createMatrix4("uTaaInvViewMatrixLeft"),
            uTaaCurrentFramePVLeft: r.Uniform.createMatrix4("uTaaCurrentFramePVLeft"),
            uTaaLastFramePVLeft: r.Uniform.createMatrix4("uTaaLastFramePVLeft"),
            uTaaCornersCSLeft: r.Uniform.createFloat4Array("uTaaCornersCSLeft", 2),
            uTaaEnabled: r.Uniform.createFloat(1, "uTaaEnabled"),
            uTaaInvViewMatrixRight: r.Uniform.createMatrix4("uTaaInvViewMatrixRight"),
            uTaaCurrentFramePVRight: r.Uniform.createMatrix4("uTaaCurrentFramePVRight"),
            uTaaLastFramePVRight: r.Uniform.createMatrix4("uTaaLastFramePVRight"),
            uTaaCornersCSRight: r.Uniform.createFloat4Array("uTaaCornersCSRight", 2),
            uVrFadeFactor: r.Uniform.createFloat(0, "uVrFadeFactor"),
            uVrVeilFactor: r.Uniform.createFloat(1, "uVrVeilFactor")
        };
    t.a = a
}, function (e, t, i) {
    "use strict";
    var n = function (e) {
        var t, i = window.WebKitBlobBuilder || window.MozBlobBuilder || window.BlobBuilder;
        t = e.split(",")[0].indexOf("base64") >= 0 ? window.atob(e.split(",")[1]) : window.decodeURI(e.split(",")[1]);
        for (var n = e.split(",")[0].split(":")[1].split(";")[0], r = new ArrayBuffer(t.length), a = new Uint8Array(r), o = 0; o < t.length; o++) a[o] = t.charCodeAt(o);
        var s;
        if (void 0 !== window.Blob) s = new Blob([a], {
            type: n
        });
        else if (void 0 !== i) {
            var u = new i;
            u.append(r), s = u.getBlob(n)
        }
        return s
    };
    t.a = n
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(88),
        a = i(69),
        o = i(85),
        s = i(120),
        u = i(1338),
        l = i.n(u),
        c = i(1339),
        h = i.n(c),
        d = i(0),
        f = (i.n(d), n.a.osg),
        p = f.BufferArray,
        m = f.Geometry,
        g = f.primitiveSet,
        v = f.DrawElements,
        _ = f.vec4.fromValues(1, 1, 1, 1),
        b = function (e, t, i, n, r, a) {
            f.MatrixTransform.call(this), this._subX = void 0 !== r ? r : 1, this._subY = void 0 !== a ? a : 1, this._curveAxis = i, this._curveFactor = n, this._distanceFromCam = 2.5, this._width = 1, t && (this._distanceFromCam = t), e && (this._width = e), this._clickActions = {}, this._opacity = 1, this._round = .02, this._opaqueRollover = !1, this._visible = !0, this._currentPage = 0, this._enabled = !0
        };
    b.AXIS_X = 0, b.AXIS_Y = 1, b.AXIS_BOTH = 2, f.createPrototypeNode(b, f.objectInherit(f.MatrixTransform.prototype, {
        initialize: function (e, t) {
            this._texPanel = e, this._metaData = this._computeMetaData(t), this._panelGeom = this._createGridGeometry(this._metaData.cells), this.addChild(this._panelGeom);
            var i = this._panelGeom.getOrCreateStateSet(),
                n = f.Uniform.createFloat1(this._opacity, "uAlpha");
            this._uAlpha = n.getInternalArray(), i.addUniform(n);
            var a = f.Uniform.createFloat1(t.aspectRatio, "uRatio");
            this._uRatio = a.getInternalArray(), i.addUniform(a);
            var u = f.Uniform.createFloat1(this._enabled ? 1 : .5, "uVeilFactor");
            this._uVeilFactor = u.getInternalArray(), i.addUniform(u), i.addUniform(f.Uniform.createFloat1(this._opaqueRollover ? 1 : 0, "uHoveredOpaque"));
            var c = f.Uniform.createFloat1(this._round, "uRound");
            i.addUniform(c), i.addUniform(f.Uniform.createInt(0, "uTexturePanel")), i.setTextureAttributeAndModes(0, this._texPanel), i.setAttributeAndModes(r.a.CULL_DISABLE);
            var d = s.a.getOrCreateShader(l.a, h.a, "textured-panel", "TexturedPanel");
            i.setAttributeAndModes(d);
            var p = f.Uniform.createFloat4(_, "uHoveredArea");
            this._uHoveredArea = p.getInternalArray(), i.addUniform(p), i.setRenderBinDetails(o.a.VR_MENU, "RenderBin"), i.setAttributeAndModes(r.a.BLEND_SUBSTRACTIVE), this.initPage(), this._initialized = !0
        },
        changeTexture: function (e) {
            var t = this._panelGeom.getOrCreateStateSet();
            this._texPanel = e, t.setTextureAttributeAndModes(0, this._texPanel)
        },
        updateMetaData: function (e) {
            this._metaData = this._computeMetaData(e), this._uRatio[0] = this._metaData.aspectRatio
        },
        setEnabled: function (e) {
            this._enabled = e, this._uVeilFactor && (this._uVeilFactor[0] = e ? 1 : .5)
        },
        setMetaData: function (e) {
            this._metaData = e, this._uRatio[0] = this._metaData.aspectRatio
        },
        getTexture: function () {
            return this._texPanel
        },
        isInitialized: function () {
            return this._initialized
        },
        setVisible: function (e) {
            if (this._visible !== e) {
                if (this._animation) {
                    if (!this._animation.isFinished()) return;
                    e && this._doSetVisible(!0), this._animation.start(0)
                } else this._doSetVisible(e);
                this._visible = e
            }
        },
        _doSetVisible: function (e) {
            this.setNodeMask(e ? a.a.PICK_GEOMETRY_FAST : 0), this._uAlpha && (this._uAlpha[0] = 1), e || this.initPage()
        },
        isVisible: function () {
            return this._visible
        },
        setOpacity: function (e) {
            this._opacity = e, this._uAlpha && (this._uAlpha[0] = e)
        },
        updateHit: function (e) {
            if (this._initialized && this._enabled) {
                var t = e && e._localIntersectionPoint;
                if (!e || -1 === e._nodePath.indexOf(this)) return void(void 0 !== this._currentHovered && (this._currentHovered = void 0, f.vec4.copy(this._uHoveredArea, _)));
                var i = {
                        x: (t[0] + .5 * this._width) / this._width,
                        y: (t[1] + .5 * this._height) / this._height
                    },
                    n = this._metaData.pages ? this._findPage(i) : void 0,
                    r = i.x,
                    a = i.y;
                if (n) {
                    var o = n.areas;
                    if (o)
                        for (var s = 0; s < o.length; s++)
                            if (this._checkArea(o[s], r, a, n.items[s], n)) return this
                }
                return "WHOLE_PANEL" !== this._currentHovered && (this._currentHovered = "WHOLE_PANEL", f.vec4.copy(this._uHoveredArea, _)), this
            }
        },
        _findPage: function (e) {
            for (var t = e.x, i = e.y, n = 0; n < this._metaData.cells.length; n++) {
                var r = this._metaData.cells[n],
                    a = r.x / this._width,
                    o = 1 - r.y / this._height,
                    s = (r.x + r.width) / this._width,
                    u = 1 - (r.y + r.height) / this._height;
                if (t >= a && t <= s && i <= o && i >= u) return e.x = (t - a) / (s - a), e.y = (i - u) / (o - u), r.page
            }
        },
        _checkArea: function (e, t, i, n, r) {
            return t > e[0] && t < e[1] && i < e[2] && i > e[3] && (this._currentHovered !== n && (this._currentHovered = n, r ? (this._uHoveredArea[0] = r.x + e[0] * r.width, this._uHoveredArea[1] = r.x + e[1] * r.width, this._uHoveredArea[2] = 1 - r.y - r.height + e[2] * r.height, this._uHoveredArea[3] = 1 - r.y - r.height + e[3] * r.height) : f.vec4.copy(this._uHoveredArea, e)), !0)
        },
        click: function () {
            if (this._currentHovered)
                if ("WHOLE_PANEL" !== this._currentHovered) {
                    var e = this._clickActions[this._currentHovered];
                    e && e()
                } else this._panelClickAction && this._panelClickAction()
        },
        initPage: function () {
            this._metaData && this._metaData.pages && this.setPageForCell(this._metaData.pages[0].id, this._metaData.cells[0].id)
        },
        setPageForCell: function (e, t) {
            var i = this._getPage(e);
            if (!i) return void f.log("can't find page named " + e + " for panel " + (this._metaData ? this._metaData.id : "unknown"));
            var n = this._getCell(t);
            if (!n) return void f.log("can't find cell named " + t + " for panel " + (this._metaData ? this._metaData.id : "unknown"));
            n.page = i;
            for (var r = this._panelGeom.getAttributes().TexCoord0, a = r.getElements(), o = this._subY, s = this._subX, u = n.startIndex ? n.startIndex : 0, l = 0; l <= o; l++)
                for (var c = 0; c <= s; c++) {
                    var h = 2 * u;
                    a[h] = i.x + c / s * i.width, a[h + 1] = 1 - i.y - l / o * i.height, u++
                }
            r.dirty(), this._panelGeom.dirty()
        },
        _getPage: function (e) {
            if (this._metaData && this._metaData.pages)
                for (var t = 0; t < this._metaData.pages.length; t++)
                    if (this._metaData.pages[t].id === e) return this._metaData.pages[t]
        },
        _getCell: function (e) {
            var t = this._metaData && this._metaData.cells;
            if (t)
                for (var i = 0; i < t.length; ++i)
                    if (t[i].id === e) return t[i]
        },
        setClickAction: function (e, t) {
            this._clickActions[e] = t
        },
        removeClickAction: function (e) {
            delete this._clickActions[e]
        },
        setPanelClickAction: function (e) {
            this._panelClickAction = e
        },
        removePanelClickAction: function () {
            this._panelClickAction = void 0
        },
        displayInView: function () {
            var e = f.vec3.create(),
                t = f.vec3.create(),
                i = f.vec3.fromValues(0, 0, .1),
                n = f.vec3.create();
            return function (r, a, o) {
                f.vec3.copy(e, a), e[2] = r[2];
                var s = f.mat4.lookAt(this.getMatrix(), r, e, i);
                f.mat4.invert(s, s);
                var u = o;
                f.mat4.scale(s, s, f.vec3.set(t, u, u, u)), f.vec3.sub(n, e, r), f.vec3.normalize(n, n), f.vec3.scale(n, n, this._distanceFromCam * o), f.vec3.add(n, r, n), n[2] += -.2 * o, f.mat4.setTranslation(s, n), this.dirtyBound(), this.setVisible(!0)
            }
        }(),
        setAnimation: function (e) {
            e.setOnFinishCallback(this._onAnimationFinished.bind(this)), this._animation = e, this.addUpdateCallback(e)
        },
        getAnimation: function () {
            return this._animation
        },
        _onAnimationFinished: function () {
            this._visible || this._doSetVisible(!1)
        },
        _computeMetaData: function (e) {
            var t = Object(d.extend)(e, {
                aspectRatio: e.cellsWidth ? e.cellsWidth / e.cellsHeight : e.width / e.height
            });
            this._height = this._width / t.aspectRatio;
            var i, n;
            if (t.pages)
                for (n = 0; n < t.pages.length; n++) {
                    var r = t.pages[n];
                    if (r.areas)
                        for (i = 0; i < r.areas.length; i++) {
                            var a = r.areas[i];
                            a[0] = a[0] / r.width, a[1] = a[1] / r.width, a[2] = 1 - a[2] / r.height, a[3] = 1 - a[3] / r.height
                        }
                    r.x /= e.width, r.y /= e.height, r.width /= e.width, r.height /= e.height
                }
            if (t.cells && t.cells.length > 0)
                for (i = 0; i < t.cells.length; i++) {
                    var o = t.cells[i];
                    o.x = o.x / t.cellsWidth * this._width, o.y = o.y / t.cellsHeight * this._height, o.z /= 100, o.width = o.width / t.cellsWidth * this._width, o.height = o.height / t.cellsHeight * this._height
                } else t.cells = [{
                    id: "default",
                    x: 0,
                    y: 0,
                    z: 0,
                    width: this._width,
                    height: this._height
                }];
            return t
        },
        _createTexturedGridGeometry: function (e, t, i, n, r, a, o, s, u, l, c, h) {
            t *= -1, s && (u = void 0 !== u ? u : .2);
            for (var d = n / a, f = r / o, p = this._verticesIndex, m = 0, g = 0, v = this._indicesIndex, _ = 0, S = 0, x = 0; x <= o; x++)
                for (var y = 0; y <= a; y++) m = 3 * p, g = 2 * p, c[g] = y / a, c[g + 1] = 1 - x / o, s && (s !== b.AXIS_X && s !== b.AXIS_BOTH || (_ = y / a - .5, _ = _ * _ * u), s !== b.AXIS_Y && s !== b.AXIS_BOTH || (S = x / o - .5, S = S * S * u)), l[m] = e + d * y, l[m + 1] = t - f * x, l[m + 2] = i + _ + S, p++;
            var C = this._verticesIndex;
            this._verticesIndex = p;
            for (var T = 0; T < a * o; T++) v = this._indicesIndex + 6 * T, p = C + T + Math.floor(T / a), h[v] = p, h[v + 1] = a + 1 + p, h[v + 2] = a + 1 + p + 1, h[v + 3] = a + 1 + p + 1, h[v + 4] = p + 1, h[v + 5] = p;
            this._indicesIndex = v + 6
        },
        _createGridGeometry: function (e) {
            var t = this._subY,
                i = this._subX,
                n = (i + 1) * (t + 1) * e.length,
                r = new m,
                a = new Float32Array(3 * n),
                o = new Float32Array(2 * n),
                s = new Uint8Array(i * t * 6 * e.length);
            this._verticesIndex = 0, this._indicesIndex = 0;
            for (var u = .5 * this._width, l = .5 * this._height, c = 0; c < e.length; c++) {
                var h = e[c];
                h.startIndex = this._verticesIndex, this._createTexturedGridGeometry(h.x - u, h.y - l, h.z, h.width, h.height, i, t, this._curveAxis, this._curveFactor, a, o, s)
            }
            r.getAttributes().Vertex = new p(p.ARRAY_BUFFER, a, 3), r.getAttributes().TexCoord0 = new p(p.ARRAY_BUFFER, o, 2);
            var d = new v(g.TRIANGLES, new p(p.ELEMENT_ARRAY_BUFFER, s, 1));
            return r.getPrimitives().push(d), r
        }
    }), "osgSketchfab", "TexturedPanel"), t.a = b
}, function (e, t, i) {
    "use strict";
    i.d(t, "b", function () {
        return h
    });
    var n = function (e) {
            var t = 0;
            return e < .0031308 ? e > 0 && (t = 12.92 * e) : t = 1.055 * Math.pow(e, 1 / 2.4) - .055, t
        },
        r = function (e) {
            var t = 0;
            return e < .04045 ? e >= 0 && (t = e * (1 / 12.92)) : t = Math.pow((e + .055) * (1 / 1.055), 2.4), t
        },
        a = function (e, t) {
            var i = t || new Array(e.length);
            return i[0] = n(e[0]), i[1] = n(e[1]), i[2] = n(e[2]), i.length > 3 && e.length > 3 && (i[3] = e[3]), i
        },
        o = function (e, t) {
            var i = t || new Array(e.length);
            return i[0] = r(e[0]), i[1] = r(e[1]), i[2] = r(e[2]), i.length > 3 && e.length > 3 && (i[3] = e[3]), i
        },
        s = function (e, t, i) {
            i[3] = Math.min(1, Math.max(e[0] / t, i[1] / t, i[2] / t, 1e-6)), i[3] = Math.ceil(255 * i[3]) / 255;
            var n = 1 / (t * i[3]);
            return i[0] = e[0] * n, i[1] = e[1] * n, i[2] = e[2] * n, i
        },
        u = function (e, t, i) {
            var n = t * e[3];
            return i[0] = n * i[0], i[1] = n * i[1], i[2] = n * i[2], i
        },
        l = function (e) {
            var t = {
                r: Math.round(255 * e.r),
                g: Math.round(255 * e.g),
                b: Math.round(255 * e.b)
            };
            return "#" + (16777216 | t.b | t.g << 8 | t.r << 16).toString(16).substr(1)
        },
        c = function (e) {
            return /^[0-9a-f]{3}([0-9a-f]{3})?$/i.test(e)
        },
        h = function (e) {
            var t = decodeURI(e);
            return c(t) ? "#" + t : t
        };
    t.a = {
        linearToSrgb1: n,
        srgbToLinear1: r,
        linearToSrgb: a,
        srgbToLinear: o,
        encodeRGBM: s,
        decodeRGBM: u,
        rgbToHex: l,
        parseUrlColor: h
    }
}, , , , , , , , function (e, t, i) {
    "use strict";
    t.a = function () {
        var e = window.navigator.userAgent,
            t = e.indexOf("MSIE "),
            i = e.indexOf("Trident/");
        return (t >= 0 || i >= 0) && (document.all && !window.atob)
    }
}, , , , , , , , , , , , , , , , , , , , , , , function (e, t, i) {
    "use strict";
    var n = i(49),
        r = i.n(n),
        a = i(5),
        o = i.n(a),
        s = i(24),
        u = i.n(s),
        l = i(3),
        c = i.n(l),
        h = i(11);
    t.a = h.a.extend({
        defaults: function () {
            return {
                name: "",
                content: "",
                position: [0, 0, 0],
                eye: [0, 0, 0],
                target: [0, 0, 0],
                lastComputedScenePosition: [0, 0, 0],
                lastComputedWorldPosition: [0, 0, 0],
                uidImage: void 0,
                imageFile: void 0,
                preview: "",
                hovered: !0,
                geometryUid: -1,
                indices: [-1, -1, -1],
                barycentricWeights: [0, 0, 0],
                localPosition: [0, 0, 0],
                visible: !0
            }
        },
        endpoint: function () {
            return "/hotspots" + (this.isNew() ? "" : "/" + this.get("uid"))
        },
        remove: function () {
            return o.a.resolve(u.a.ajax({
                type: "DELETE",
                url: this.url()
            }))
        },
        appendArray: function (e, t, i) {
            for (var n = 0, r = i.length; n < r; ++n) e.append(t, i[n])
        },
        _dumpOptions: function () {
            return {
                eye: this.get("eye").toString(),
                target: this.get("target").toString(),
                position: this.get("position").toString(),
                content: this.get("content").raw,
                name: this.get("name"),
                imFile: this.get("imFile")
            }
        },
        registerOptions: function () {
            this._lastOptions = this._dumpOptions()
        },
        hasChangedOptions: function () {
            if (!this._lastOptions) return !0;
            var e = this._dumpOptions(),
                t = this._lastOptions;
            for (var i in t)
                if (t[i] !== e[i]) return !0;
            return !1
        },
        save: function (e, t) {
            if (!this.hasChangedOptions()) return o.a.resolve();
            this.registerOptions(), null != e && "object" !== (void 0 === e ? "undefined" : r()(e)) || (t = e);
            var i = this.isNew(),
                n = new FormData,
                a = this.get("imageFile");
            void 0 === this.get("uidImage") && a && n.append("imageFile", a), n.append("model", t.modelUID), n.append("name", this.get("name"));
            var s = this.get("content").raw;
            n.append("content", null !== s ? s : ""), this.appendArray(n, "eye", this.get("eye")), this.appendArray(n, "target", this.get("target")), this.appendArray(n, "position", this.get("position"));
            var u = this,
                l = c.a.ajax({
                    type: i ? "POST" : "PATCH",
                    url: this.url(),
                    data: n,
                    cache: !1,
                    contentType: !1,
                    processData: !1,
                    success: function (e) {
                        i && (u.set("uid", e.uid), e.images.length > 0 && u.set("uidImage", e.images[0].uid))
                    },
                    error: function (e) {
                        console.error(e.stack)
                    }
                });
            return o.a.resolve(l)
        },
        _validate: function (e, t) {
            return t = t || {}, t.validate = !0, h.a.prototype._validate.call(this, e, t)
        },
        validate: function (e) {
            var t = e.eye,
                i = e.target,
                n = i[0] - t[0],
                r = i[1] - t[1],
                a = i[2] - t[2],
                o = Math.sqrt(n * n + r * r + a * a);
            if (o <= 1e-8) return i[0] = e.position[0], i[1] = e.position[1], i[2] = e.position[2], !1;
            if (o <= .001) {
                var s = .01 / o;
                i[0] = t[0] + n * s, i[1] = t[1] + r * s, i[2] = t[2] + a * s
            }
            return !1
        }
    })
}, , , , , , , function (e, t, i) {
    "use strict";
    var n = navigator.vendor && navigator.vendor.indexOf("Apple") > -1 && navigator.userAgent && !navigator.userAgent.match("CriOS");
    t.a = n
}, function (e, t, i) {
    "use strict";
    var n = i(271);
    t.a = n.a.extend({
        events: {
            "click .close": "hide",
            "touchstart .close": "hide"
        },
        show: function (e) {
            e && e.preventDefault && e.preventDefault(), this.$el.removeClass("hidden")
        },
        hide: function (e) {
            e && e.preventDefault && e.preventDefault(), this.$el.addClass("hidden")
        },
        isVisible: function () {
            return !this.el.classList.contains("hidden")
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(36),
        r = i(12),
        a = i(316),
        o = i(10),
        s = i(84),
        u = i(177),
        l = i(137),
        c = function () {
            a.a.call(this), this._matrix = o.c.create(), this._position = o.f.create(), this._matrixDirty = !0, this._scale = o.f.fromValues(1, 1, 1), this._minimumScale = 0, this._maximumScale = Number.MAX_VALUE, this._rotation = o.d.create(), this._pivotPoint = o.f.create(), this._autoScaleToScreen = !1, this._autoRotateToScreen = !1, this._cachedMatrix = o.c.create(), this._firstTimeToInitEyePoint = !0, this._autoScaleTransitionWidthRatio = .25, this._billboardAttribute = void 0, this._previousWidth = 0, this._previousHeight = 0, this._previousProjection = o.c.create(), this._previousModelView = o.c.create(), this._previousPosition = o.f.create()
        };
    r.a.createPrototypeNode(c, r.a.objectInherit(a.a.prototype, {
        getMatrix: function () {
            return this._matrix
        },
        setMatrix: function (e) {
            this._matrix = e, this.dirtyBound()
        },
        setPosition: function (e) {
            this._position = e, this._matrixDirty = !0, this.dirtyBound()
        },
        getPosition: function () {
            return this._position
        },
        setRotation: function (e) {
            this._rotation = e, this._matrixDirty = !0, this.dirtyBound()
        },
        getRotation: function () {
            return this._rotation
        },
        setScale: function (e) {
            this.setScaleFromVec3(o.f.fromValues(e, e, e))
        },
        setScaleFromvec3: function (e) {
            n.a.warn("deprecated, use setScaleFromVec3"), this.setScaleFromVec3(e)
        },
        setScaleFromVec3: function (e) {
            this._scale = e, this._matrixDirty = !0, this.dirtyBound()
        },
        getScale: function () {
            return this._scale
        },
        setMinimumScale: function (e) {
            this._minimumScale = e
        },
        getMinimumScale: function () {
            return this._minimumScale
        },
        setMaximumScale: function (e) {
            this._maximumScale = e
        },
        getMaximumScale: function () {
            return this._maximumScale
        },
        setAutoScaleToScreen: function (e) {
            this._autoScaleToScreen = e, this._matrixDirty = !0
        },
        getAutoScaleToScreen: function () {
            return this._autoScaleToScreen
        },
        setAutoRotateToScreen: function (e) {
            this._autoRotateToScreen = e
        },
        getAutoRotateToScreen: function () {
            return this._autoRotateToScreen
        },
        setAutoScaleTransitionWidthRatio: function (e) {
            this._autoScaleTransitionWidthRatio = e
        },
        getAutoScaleTransitionWidthRatio: function () {
            return this._autoScaleTransitionWidthRatio
        },
        computeLocalToWorldMatrix: function (e) {
            this._matrixDirty && this.computeMatrix(), this.referenceFrame === u.a.RELATIVE_RF ? o.c.mul(e, e, this._matrix) : o.c.copy(e, this._matrix)
        },
        computeMatrix: function () {
            var e = o.f.create(),
                t = o.c.create();
            return function () {
                this._matrixDirty && (o.c.fromQuat(this._matrix, this._rotation), o.c.fromTranslation(t, this._position), o.c.mul(this._matrix, t, this._matrix), o.c.scale(this._matrix, this._matrix, this._scale), o.c.translate(this._matrix, this._matrix, o.f.neg(e, this._pivotPoint)), this._matrixDirty = !1)
            }
        }(),
        computeWorldToLocalMatrix: function () {
            var e = o.f.create(),
                t = o.d.create(),
                i = o.f.create(),
                n = o.c.create();
            return function (r) {
                return (0 !== this.scale[0] || 0 !== this.scale[1] || 0 !== this.scale[2]) && (i[0] = 1 / this._scale[0], i[1] = 1 / this._scale[1], i[2] = 1 / this._scale[2], this.referenceFrame === u.a.RELATIVE_RF ? (o.c.fromTranslation(n, o.f.neg(e, this._position)), o.c.mul(r, n, r), o.d.zeroRotation(this._rotation) || (o.c.fromQuat(n, o.d.invert(t, this._rotation)), o.c.mul(r, n, r)), o.c.fromScaling(n, i), o.c.mul(r, n, r), o.c.fromTranslation(n, this._pivotPoint), o.c.mul(r, n, r)) : (o.c.fromQuat(this._matrix, o.d.invert(t, this._rotation)), o.c.translate(r, r, o.f.neg(e, this._position)), o.c.fromScaling(n, i), o.c.mul(r, n, r), o.c.fromTranslation(n, this._pivotPoint), o.c.mul(r, n, r)), !0)
            }
        }(),
        computeBound: function () {
            var e = o.c.create();
            return function (t) {
                return this._autoScaleToScreen && this._firstTimeToInitEyePoint ? t : (l.a.prototype.computeBound.call(this, t), t.valid() ? (o.c.identity(e), this.computeLocalToWorldMatrix(e), t.transformMat4(t, e), t) : t)
            }
        }(),
        accept: function () {
            return function (e) {
                if (e.getVisitorType() === s.a.CULL_VISITOR) {
                    var t = e.getViewport().width(),
                        i = e.getViewport().height(),
                        n = e.getCurrentProjectionMatrix(),
                        r = e.getCurrentModelViewMatrix(),
                        a = this._position,
                        u = this._firstTimeToInitEyePoint;
                    if (this._firstTimeToInitEyePoint || (t !== this._previousWidth || i !== this._previousHeight ? u = !0 : o.c.exactEquals(n, this._previousProjection) && o.c.exactEquals(r, this._previousModelView) ? o.f.exactEquals(a, this._previousPosition) || (u = !0) : u = !0), this._firstTimeToInitEyePoint = !1, u) {
                        if (this._autoScaleToScreen) {
                            var c = e.getViewport(),
                                h = this.computePixelSizeVector(c, n, r),
                                d = o.g.fromValues(this._position[0], this._position[1], this._position[2], 1),
                                f = o.g.dot(d, h);
                            f = .48 / f;
                            var p = 1 / f;
                            if (this._autoScaleTransitionWidthRatio > 0) {
                                var m, g, v;
                                if (this._minimumScale > 0) {
                                    var _ = this._minimumScale,
                                        b = this._maximumScale < Number.MAX_VALUE ? this._minimumScale + (this._maximumScale - this._minimumScale) * this._autoScaleTransitionWidthRatio : this._minimumScale * (1 + this._autoScaleTransitionWidthRatio);
                                    m = 1 / (4 * (b - _)), g = 1 - 2 * m * b, v = _ + g * g / (4 * m);
                                    p < -g / (2 * m) ? p = this._minimumScale : p < b && (p = v + g * p + m * (p * p))
                                }
                                if (this._maximumScale < Number.MAX_VALUE) {
                                    var S = this._maximumScale,
                                        x = this._minimumScale > 0 ? this._maximumScale + (this._minimumScale - this._maximumScale) * this._autoScaleTransitionWidthRatio : this._maximumScale * (1 - this._autoScaleTransitionWidthRatio);
                                    m = 1 / (4 * (x - S)), g = 1 - 2 * m * x, v = S + g * g / (4 * m);
                                    p > -g / (2 * m) ? p = this._maximumScale : p > x && (p = v + g * p + m * (p * p))
                                }
                            }
                            this.setScale(p)
                        }
                        if (this._autoRotateToScreen) {
                            var y = o.d.create();
                            o.c.getRotation(y, r), this.setRotation(o.d.invert(y, y))
                        }
                        this._previousWidth = t, this._previousHeight = i, o.f.copy(this._previousPosition, a), o.c.copy(this._previousProjection, n), o.c.copy(this._previousModelView, r)
                    }
                }
                l.a.prototype.accept.call(this, e)
            }
        }(),
        computePixelSizeVector: function () {
            var e = o.f.create(),
                t = o.f.create();
            return function (i, n, r) {
                var a = n[0] * i.width() * .5,
                    s = n[8] * i.width() * .5 + n[11] * i.width() * .5;
                o.f.set(e, r[0] * a + r[2] * s, r[4] * a + r[6] * s, r[8] * a + r[10] * s);
                var u = n[5] * i.height() * .5,
                    l = n[9] * i.height() * .5 + n[11] * i.height() * .5;
                o.f.set(t, r[1] * u + r[2] * l, r[5] * u + r[6] * l, r[9] * u + r[10] * l);
                var c = n[11],
                    h = n[15],
                    d = o.g.fromValues(r[2] * c, r[6] * c, r[10] * c, r[14] * c + r[15] * h),
                    f = .7071067811 / Math.sqrt(o.f.sqrLen(e) + o.f.sqrLen(t));
                return o.g.scale(d, d, f), d
            }
        }()
    }), "osg", "AutoTransform"), t.a = c
}, function (e, t, i) {
    "use strict";
    var n = i(178),
        r = function (e) {
            this._initialBufferArray = void 0, this._bufferArray = void 0, e && (this.setBufferArray(e), this.setInitialBufferArray(e))
        },
        a = {
            setInitialBufferArray: function (e) {
                this._initialBufferArray = e
            },
            getInitialBufferArray: function () {
                return this._initialBufferArray
            },
            setBufferArray: function (e) {
                this._bufferArray = e.getBufferArray ? e.getBufferArray() : e
            },
            getBufferArray: function () {
                return this._bufferArray
            },
            getGlItemSize: function () {
                return this._bufferArray.getGlItemSize()
            },
            getGlType: function () {
                return this._bufferArray.getGlType()
            },
            getGlNormalize: function () {
                return this._bufferArray.getGlNormalize()
            }
        };
    for (var o in n.a.prototype) a[o] = function (e) {
        return function () {
            return e.apply(this._bufferArray, arguments)
        }
    }(n.a.prototype[o]);
    r.prototype = a, t.a = r
}, function (e, t, i) {
    "use strict";
    var n = i(102),
        r = i(450),
        a = i(12),
        o = i(10),
        s = i(290),
        u = function () {
            this._clippingMask = 0, this._planeList = [r.a.create(), r.a.create(), r.a.create(), r.a.create(), r.a.create(), r.a.create()], this._vertexList = [], this._maskStack = new s.a, this._resultMask = 0, this._maskStack.push(this._resultMask)
        };
    a.a.createPrototypeObject(u, a.a.objectInherit(n.a.prototype, {
        getPlanes: function () {
            return this._planeList
        },
        setPlanes: function (e) {
            this._planeList = e, this.setupMask()
        },
        clear: function () {
            if (this._clippingMask = 0, this._planeList)
                for (var e = 0, t = this._planeList.length; e < t; ++e) r.a.init(this._planeList[e]);
            this._vertexList = [], this.setupMask()
        },
        setToUnitFrustum: function (e, t) {
            void 0 === e && (e = !0), void 0 === t && (t = !0), this._planeList.length = 0, this._planeList.push(o.g.set(r.a.create(), 1, 0, 0, 1)), this._planeList.push(o.g.set(r.a.create(), -1, 0, 0, 1)), this._planeList.push(o.g.set(r.a.create(), 0, 1, 0, 1)), this._planeList.push(o.g.set(r.a.create(), 0, -1, 0, 1)), e && this._planeList.push(o.g.set(r.a.create(), 0, 0, 1, 1)), t && this._planeList.push(o.g.set(r.a.create(), 0, 0, -1, 1)), this.setupMask()
        },
        setToBoundingBox: function (e) {
            this._planeList.length = 0, this._planeList.push(o.g.set(r.a.create(), 1, 0, 0, -e.getMin()[0])), this._planeList.push(o.g.set(r.a.create(), -1, 0, 0, e.getMax()[0])), this._planeList.push(o.g.set(r.a.create(), 0, 1, 0, -e.getMin()[1])), this._planeList.push(o.g.set(r.a.create(), 0, -1, 0, e.getMax()[1])), this._planeList.push(o.g.set(r.a.create(), 0, 0, 1, -e.getMin()[2])), this._planeList.push(o.g.set(r.a.create(), 0, 0, -1, e.getMax()[2])), this.setupMask()
        },
        setAndTransformProvidingInverse: function (e, t) {
            this._referenceVertexList = e._referenceVertexList;
            var i = this._maskStack.getLength() - 1,
                n = e._maskStack[i];
            if (0 === n) return this._maskStack.getArray()[i] = 0, this._resultMask = 0, void(this._planeList.length = 0);
            var a, o = 1,
                s = 0;
            for (a = 0; a !== e._planeList.length; ++a) n & o && ++s, o <<= 1;
            this._planeList.length = s, this._resultMask = 0, o = 1;
            var u = 0;
            for (a = 0; a !== e._planeList.length; ++a) n & o && (this._planeList[u] = e._planeList[a], r.a.transformProvidingInverse(this._planeList[u++], t), this._resultMask = this._resultMask << 1 | 1), o <<= 1;
            this._maskStack.getArray()[i] = this._resultMask
        },
        voidset: function (e) {
            this._planeList = e, this.setupMask()
        },
        add: function (e) {
            this._planeList.push(e), this.setupMask()
        },
        empty: function () {
            return 0 === this._planeList.length
        },
        setReferenceVertexList: function (e) {
            this._referenceVertexList = e
        },
        getReferenceVertexList: function () {
            return this._referenceVertexList
        },
        setupMask: function (e) {
            this._resultMask = 0;
            for (var t = void 0 !== e ? e : this._planeList.length, i = 0; i < t; ++i) this._resultMask = this._resultMask << 1 | 1;
            this._maskStack.reset(), this._maskStack.push(this._resultMask)
        },
        getCurrentMask: function () {
            return this._maskStack.back()
        },
        setResultMask: function (e) {
            this._resultMask = e
        },
        getResultMask: function () {
            return this._resultMask
        },
        getMaskStack: function () {
            return this._maskStack
        },
        pushCurrentMask: function () {
            this._maskStack.push(this._resultMask)
        },
        popCurrentMask: function () {
            return this._maskStack.pop()
        },
        containsVertex: function (e) {
            var t = this._maskStack.back();
            if (!t) return !0;
            for (var i = 1, n = 0; n < this._planeList.length; ++n) {
                if (t & i && r.a.distanceToPlane(this._planeList[n], e) < 0) return !1;
                i <<= 1
            }
            return !0
        },
        containsVertices: function (e) {
            var t = this._maskStack.back();
            if (!t) return !0;
            this._resultMask = t;
            for (var i = 0; i < e.length; ++i) {
                for (var n = e[i], a = !1, o = 1, s = 0; !a && s < this._planeList.length; ++s) t & o && r.a.distanceToPlane(this._planeList[s], n) < 0 && (a = !0), o <<= 1;
                if (!a) return !0
            }
            return !1
        },
        containsBoundingSphere: function (e) {
            var t = this._maskStack.back();
            if (!t || !e.valid()) return !0;
            this._resultMask = t;
            for (var i = 1, n = 0; n < this._planeList.length; ++n) {
                if (this._resultMask & i) {
                    var a = r.a.intersectsOrContainsBoundingSphere(this._planeList[n], e);
                    if (r.a.OUTSIDE === a) return !1;
                    r.a.INSIDE === a && (this._resultMask ^= i)
                }
                i <<= 1
            }
            return !0
        },
        containsBoundingBox: function (e) {
            var t = this._maskStack.back();
            if (!t) return !0;
            this._resultMask = t;
            for (var i = 1, n = 0; n < this._planeList.length; ++n) {
                if (this._resultMask & i) {
                    var a = r.a.intersectsOrContainsBoundingBox(this._planeList[n], e);
                    if (r.a.OUTSIDE === a) return !1;
                    r.a.INSIDE === a && (this._resultMask ^= i)
                }
                i <<= 1
            }
            return !0
        },
        containsAllOfVertices: function (e) {
            var t = this._maskStack.back();
            if (!t) return !1;
            this._resultMask = t;
            for (var i = 1, n = 0; n < this._planeList.length; ++n) {
                if (this._resultMask & i) {
                    if (r.a.intersectsOrContainsVertices(this._planeList[n], e) < 1) return !1;
                    this._resultMask ^= i
                }
                i <<= 1
            }
            return !0
        },
        containsAllOfBoundingSphere: function (e) {
            var t = this._maskStack.back();
            if (!t) return !1;
            this._resultMask = t;
            for (var i = 1, n = 0; n < this._planeList.length; ++n) {
                if (this._resultMask & i) {
                    if (r.a.intersectsOrContainsBoundingSphere(this._planeList[n], e) < 1) return !1;
                    this._resultMask ^= i
                }
                i <<= 1
            }
            return !0
        },
        containsAllOfBoundingBox: function (e) {
            var t = this._maskStack.back();
            if (!t) return !1;
            this._resultMask = t;
            for (var i = 1, n = 0; n < this._planeList.length; ++n) {
                if (this._resultMask & i) {
                    if (r.a.intersectsOrContainsBoundingBox(this._planeList[n], e) < 1) return !1;
                    this._resultMask ^= i
                }
                i <<= 1
            }
            return !0
        },
        transformProvidingInverse: function (e) {
            var t = this._maskStack.back();
            if (t) {
                this._resultMask = t;
                for (var i = 1, n = 0; n < this._planeList.length; ++n) t & i && r.a.transformProvidingInverse(this._planeList[n], e), i <<= 1
            }
        }
    }), "osg", "Polytope"), t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(137),
        a = i(10),
        o = function () {
            r.a.call(this), this.projection = a.c.create()
        };
    n.a.createPrototypeNode(o, n.a.objectInherit(r.a.prototype, {
        getProjectionMatrix: function () {
            return this.projection
        },
        setProjectionMatrix: function (e) {
            this.projection = e
        }
    }), "osg", "Projection"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(137),
        a = i(177),
        o = i(10),
        s = function () {
            r.a.call(this), this.setCullingActive(!1), this._light = void 0, this._referenceFrame = a.a.RELATIVE_RF
        };
    n.a.createPrototypeNode(s, n.a.objectInherit(r.a.prototype, {
        getLight: function () {
            return this._light
        },
        setLight: function (e) {
            this._light = e
        },
        setReferenceFrame: function (e) {
            this._referenceFrame = e
        },
        getReferenceFrame: function () {
            return this._referenceFrame
        },
        computeBoundingSphere: function () {
            var e = o.f.create();
            return function (t) {
                if (r.a.prototype.computeBoundingSphere.call(this, t), void 0 !== this._light && this._referenceFrame === a.a.RELATIVE_RF) {
                    var i = this._light.getPosition();
                    0 !== i[3] && t.expandByVec3(o.f.scale(e, i, 1 / i[3]))
                }
                return t
            }
        }()
    }), "osg", "LightSource"), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(137),
        a = i(84),
        o = i(10),
        s = i(447),
        u = function () {
            r.a.call(this), this._radius = -1, this._range = [], this._rangeMode = u.DISTANCE_FROM_EYE_POINT, this._userDefinedCenter = [], this._centerMode = u.USE_BOUNDING_SPHERE_CENTER
        };
    u.DISTANCE_FROM_EYE_POINT = 0, u.PIXEL_SIZE_ON_SCREEN = 1, u.USE_BOUNDING_SPHERE_CENTER = 0, u.USER_DEFINED_CENTER = 1, u.UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED = 2, n.a.createPrototypeNode(u, n.a.objectInherit(r.a.prototype, {
        getRadius: function () {
            return this._radius
        },
        setRadius: function (e) {
            this._radius = e
        },
        setCenter: function (e) {
            this._centerMode !== u.UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED && (this._centerMode = u.USER_DEFINED_CENTER), this._userDefinedCenter = e
        },
        getCenter: function () {
            return this._centerMode === u.USER_DEFINED_CENTER || this._centerMode === u.UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED ? this._userDefinedCenter : this.getBound().center()
        },
        setCenterMode: function (e) {
            this._centerMode = e
        },
        computeBoundingSphere: function (e) {
            if (this._centerMode === u.USER_DEFINED_CENTER && this._radius >= 0) return e.set(this._userDefinedCenter, this._radius), e;
            if (this._centerMode === u.UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED && this._radius >= 0) {
                e.set(this._userDefinedCenter, this._radius);
                var t = new s.a;
                return e.expandByBoundingSphere(r.a.prototype.computeBoundingSphere.call(this, t)), e
            }
            return r.a.prototype.computeBoundingSphere.call(this, e), e
        },
        projectBoundingSphere: function () {
            var e = o.f.create();
            return function (t, i, n) {
                o.f.transformMat4(e, t.center(), i);
                var r = t.radius2(),
                    a = e[2] * e[2],
                    s = o.f.sqrLen(e);
                return -Math.PI * n * n * r * Math.sqrt(Math.abs((s - r) / (r - a))) / (r - a)
            }
        }(),
        setRangeMode: function (e) {
            this._rangeMode = e
        },
        addChildNode: function (e) {
            if (r.a.prototype.addChild.call(this, e), this.children.length > this._range.length) {
                var t = [],
                    i = 0;
                this._range.lenght > 0 && (i = this._range[this._range.length - 1][1]), t.push(o.e.fromValues(i, i)), this._range.push(t)
            }
            return !0
        },
        addChild: function (e, t, i) {
            if (r.a.prototype.addChild.call(this, e), this.children.length > this._range.length) {
                var n = [];
                n.push(o.e.fromValues(t, t)), this._range.push(n)
            }
            return this._range[this.children.length - 1][0] = t, this._range[this.children.length - 1][1] = i, !0
        },
        traverse: function () {
            var e = o.f.create(),
                t = o.f.create(),
                i = o.c.create();
            return function (n) {
                switch (n.traversalMode) {
                    case a.a.TRAVERSE_ALL_CHILDREN:
                        for (var r = 0; r < this.children.length; r++) this.children[r].accept(n);
                        break;
                    case a.a.TRAVERSE_ACTIVE_CHILDREN:
                        var s = 0,
                            l = n.getCurrentModelViewMatrix();
                        if (o.c.invert(i, l), this._rangeMode === u.DISTANCE_FROM_EYE_POINT) o.f.transformMat4(t, e, i), s = o.f.distance(this.getBound().center(), t) * n.getLODScale();
                        else {
                            var c = n.getCurrentProjectionMatrix();
                            s = this.projectBoundingSphere(this.getBound(), l, c[0]), s = s * n.getViewport().width() * n.getViewport().width() * .25 / n.getLODScale()
                        }
                        var h = this.children.length;
                        this._range.length < h && (h = this._range.length);
                        for (var d = 0; d < h; ++d) this._range[d][0] <= s && s < this._range[d][1] && this.children[d].accept(n)
                }
            }
        }()
    }), "osg", "Lod"), t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(684),
        a = i(84),
        o = i(10),
        s = function () {
            r.a.call(this), this._perRangeDataList = [], this._loading = !1, this._expiryTime = 0, this._expiryFrame = 0, this._centerMode = r.a.USER_DEFINED_CENTER, this._frameNumberOfLastTraversal = 0, this._databasePath = "", this._numChildrenThatCannotBeExpired = 0
        },
        u = function () {
            this.filename = "", this.function = void 0, this.loaded = !1, this.timeStamp = 0, this.frameNumber = 0, this.frameNumberOfLastTraversal = 0, this.dbrequest = void 0
        };
    n.a.createPrototypeNode(s, n.a.objectInherit(r.a.prototype, {
        setRange: function (e, t, i) {
            if (e >= this._range.length) {
                var n = [];
                n.push([t, t]), this._range.push(n)
            }
            this._range[e][0] = t, this._range[e][1] = i
        },
        setExpiryTime: function (e) {
            this._expiryTime = e
        },
        setDatabasePath: function (e) {
            this._databasePath = e
        },
        getDatabasePath: function () {
            return this._databasePath
        },
        setFileName: function (e, t) {
            if (e >= this._perRangeDataList.length) {
                var i = new u;
                i.filename = t, this._perRangeDataList.push(i)
            } else this._perRangeDataList[e].filename = t
        },
        setFunction: function (e, t) {
            if (e >= this._perRangeDataList.length) {
                var i = new u;
                i.function = t, this._perRangeDataList.push(i)
            } else this._perRangeDataList[e].function = t
        },
        addChild: function (e, t, i) {
            r.a.prototype.addChild.call(this, e, t, i), this._perRangeDataList.push(new u)
        },
        addChildNode: function (e) {
            r.a.prototype.addChildNode.call(this, e)
        },
        setFrameNumberOfLastTraversal: function (e) {
            this._frameNumberOfLastTraversal = e
        },
        getFrameNumberOfLastTraversal: function () {
            return this._frameNumberOfLastTraversal
        },
        setTimeStamp: function (e, t) {
            this._perRangeDataList[e].timeStamp = t
        },
        setFrameNumber: function (e, t) {
            this._perRangeDataList[e].frameNumber = t
        },
        setNumChildrenThatCannotBeExpired: function (e) {
            this._numChildrenThatCannotBeExpired = e
        },
        getNumChildrenThatCannotBeExpired: function () {
            return this._numChildrenThatCannotBeExpired
        },
        getDatabaseRequest: function (e) {
            return this._perRangeDataList[e].dbrequest
        },
        removeExpiredChildren: function (e, t, i) {
            if (!(this.children.length <= this._numChildrenThatCannotBeExpired)) {
                var n, r, a = this.children.length - 1;
                n = this._perRangeDataList[a].timeStamp + this._expiryTime, r = this._perRangeDataList[a].frameNumber + this._expiryFrame, n < e && r < t && (this._perRangeDataList[a].filename.length > 0 || void 0 !== this._perRangeDataList[a].function) && (i.push(this.children[a]), this.removeChild(this.children[a]), this._perRangeDataList[a].loaded = !1, void 0 !== this._perRangeDataList[a].dbrequest && (this._perRangeDataList[a].dbrequest._groupExpired = !0))
            }
        },
        traverse: function () {
            var e = o.f.create(),
                t = o.f.create(),
                i = o.c.create();
            return function (n) {
                var s = n.traversalMode,
                    u = !1;
                switch (n.getVisitorType() === a.a.CULL_VISITOR && (this._frameNumberOfLastTraversal = n.getFrameStamp().getFrameNumber(), u = !0), s) {
                    case a.a.TRAVERSE_ALL_CHILDREN:
                        for (var l = 0; l < this.children.length; l++) this.children[l].accept(n);
                        break;
                    case a.a.TRAVERSE_ACTIVE_CHILDREN:
                        var c = 0,
                            h = n.getCurrentModelViewMatrix();
                        if (o.c.invert(i, h), this._rangeMode === r.a.DISTANCE_FROM_EYE_POINT) {
                            o.f.transformMat4(t, e, i);
                            c = o.f.distance(this.getBound().center(), t) * n.getLODScale()
                        } else {
                            var d = n.getCurrentProjectionMatrix();
                            c = this.projectBoundingSphere(this.getBound(), h, d[0]), c = c * n.getViewport().width() * n.getViewport().width() * .25 / n.getLODScale(), c < 0 && (c = this._range[this._range.length - 1][0])
                        }
                        for (var f = !1, p = -1, m = 0; m < this._range.length; ++m) this._range[m][0] <= c && c < this._range[m][1] && (m < this.children.length ? (u && (this._perRangeDataList[m].timeStamp = n.getFrameStamp().getSimulationTime(), this._perRangeDataList[m].frameNumber = n.getFrameStamp().getFrameNumber()), this.children[m].accept(n), p = m) : f = !0);
                        if (f) {
                            var g = this.children.length;
                            if (g > 0 && g - 1 !== p && (u && (this._perRangeDataList[g - 1].timeStamp = n.getFrameStamp().getSimulationTime(), this._perRangeDataList[g - 1].frameNumber = n.getFrameStamp().getFrameNumber()), this.children[g - 1].accept(n)), g < this._perRangeDataList.length) {
                                var v = (this._range[g][0] - c) / (this._range[g][1] - this._range[g][0]);
                                this._rangeMode === r.a.PIXEL_SIZE_ON_SCREEN && (v = -v);
                                var _ = n.nodePath[n.nodePath.length - 1];
                                if (!1 === this._perRangeDataList[g].loaded) {
                                    this._perRangeDataList[g].loaded = !0;
                                    var b = n.getDatabaseRequestHandler();
                                    this._perRangeDataList[g].dbrequest = b.requestNodeFile(this._perRangeDataList[g].function, this._databasePath + this._perRangeDataList[g].filename, _, n.getFrameStamp().getSimulationTime(), v)
                                } else void 0 !== this._perRangeDataList[g].dbrequest ? (this._perRangeDataList[g].dbrequest._timeStamp = n.getFrameStamp().getSimulationTime(), this._perRangeDataList[g].dbrequest._priority = v) : this._perRangeDataList[g].loaded = !1
                            }
                        }
                }
            }
        }()
    }), "osg", "PagedLOD"), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(138),
        r = i(289),
        a = i(291),
        o = [],
        s = [];
    o[n.a.TRIANGLES] = function (e, t, i, n) {
        for (var r = e + t, a = e; a < r; a += 3) n.operatorTriangle(i[a], i[a + 1], i[a + 2])
    }, o[n.a.TRIANGLE_STRIP] = function (e, t, i, n) {
        for (var r = 2, a = e; r < t; ++r, ++a) r % 2 ? n.operatorTriangle(i[a], i[a + 2], i[a + 1]) : n.operatorTriangle(i[a], i[a + 1], i[a + 2])
    }, o[n.a.TRIANGLE_FAN] = function (e, t, i, n) {
        for (var r = i[e], a = 2, o = e + 1; a < t; ++a, ++o) n.operatorTriangle(r, i[o], i[o + 1])
    }, o[n.a.POINTS] = function (e, t, i, n) {
        for (var r = e + t, a = e; a < r; ++a) n.operatorPoint(i[a])
    }, o[n.a.LINES] = function (e, t, i, n) {
        for (var r = e + t, a = e; a < r; a += 2) n.operatorLine(i[a], i[a + 1])
    }, o[n.a.LINE_STRIP] = function (e, t, i, n) {
        for (var r = e + t, a = e; a < r; ++a) n.operatorLine(i[a], i[a + 1])
    }, o[n.a.LINE_LOOP] = function (e, t, i, n) {
        for (var r = e + t, a = e; a < r; ++a) n.operatorLine(i[a], i[a + 1]);
        n.operatorLine(i[i.length - 1], i[0])
    }, s[n.a.TRIANGLES] = function (e, t, i) {
        for (var n = 2, r = e; n < t; n += 3, r += 3) i.operatorTriangle(r, r + 1, r + 2)
    }, s[n.a.TRIANGLE_STRIP] = function (e, t, i) {
        for (var n = 2, r = e; n < t; ++n, ++r) n % 2 ? i.operatorTriangle(r, r + 2, r + 1) : i.operatorTriangle(r, r + 1, r + 2)
    }, s[n.a.TRIANGLE_FAN] = function (e, t, i) {
        for (var n = 2, r = e + 1; n < t; ++n, ++r) i.operatorTriangle(e, r, r + 1)
    }, s[n.a.POINTS] = function (e, t, i) {
        for (var n = 0, r = e; n < t; ++n, ++r) i.operatorPoint(r)
    }, s[n.a.LINES] = function (e, t, i) {
        for (var n = 1, r = e; n < t; n += 2, r += 2) i.operatorLine(r, r + 1)
    }, s[n.a.LINE_STRIP] = function (e, t, i) {
        for (var n = 1, r = e; n < t; ++n, ++r) i.operatorLine(r, r + 1)
    }, s[n.a.LINE_LOOP] = function (e, t, i) {
        for (var n = 1, r = e; n < t; ++n, ++r) i.operatorLine(r, r + 1);
        i.operatorLine(e + t - 1, e)
    };
    var u = function (e, t) {
        var i = e.getPrimitiveSetList();
        if (i)
            for (var n, u = i.length, l = 0; l < u; l++) {
                var c = i[l];
                if (c instanceof r.a) {
                    if (n = o[c.getMode()]) {
                        var h = c.indices.getElements();
                        n(c.getFirst() / h.BYTES_PER_ELEMENT, c.getCount(), h, t)
                    }
                } else c instanceof a.a && (n = s[c.getMode()]) && n(c.getFirst(), c.getCount(), t)
            }
    };
    t.a = u
}, function (module, __webpack_exports__, __webpack_require__) {
    "use strict";
    var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(36),
        __WEBPACK_IMPORTED_MODULE_1_osg_WebGLCaps__ = __webpack_require__(319),
        __WEBPACK_IMPORTED_MODULE_2_viewer_getOptions__ = __webpack_require__(20),
        __WEBPACK_IMPORTED_MODULE_3_osgShader_gl2convert__ = __webpack_require__(1091),
        shaderProcessor = {},
        cbFilterDuplicate = function (e, t, i) {
            return !t || e !== i[t - 1]
        };
    shaderProcessor.getSortedUnique = function (e) {
        return e.sort().filter(cbFilterDuplicate)
    };
    var isStringInteger = function (e) {
            return /^[\+|\-]?\d+$/.test(e)
        },
        getFinalDefinedValue = function (e, t) {
            for (; e[t] && t !== e[t];) t = e[t];
            return t
        },
        testIf = function (defines, line) {
            if (line.startsWith("#ifdef")) return void 0 !== defines[line.substr(7 - line.length)];
            if (line.startsWith("#ifndef")) return void 0 === defines[line.substr(8 - line.length)];
            if (line.startsWith("#else")) return !0;
            for (var txt = line.match(/[#elif|#if]\s+(.*)/)[1], tokens = txt.split(/\b\d+\b|\W+|defined+/g), i = 0; i < tokens.length; ++i) {
                var tok = tokens[i];
                if (tok) {
                    var value = getFinalDefinedValue(defines, defines[tok]);
                    void 0 === value || isStringInteger(value) || (value = !0), txt = txt.replace(tok, value)
                }
            }
            return eval("var defined = function(x) { return x !== undefined | 0; };\n" + txt)
        },
        processBranch = function (e, t, i, n) {
            for (var r = [1], a = t; a < e.length; ++a) {
                var o = e[a].trim();
                if (o.startsWith("#endif")) r.length--;
                else if (o.startsWith("#el")) {
                    var s = r.length - 1;
                    0 === r[s] ? r[s] = testIf(i, o) ? 1 : 0 : 1 === r[s] && (r[s] = 2)
                } else if (o.startsWith("#if")) r.push(testIf(i, o) ? 1 : 0);
                else {
                    for (var u = !0, l = r.length; l--;) u = u && 1 === r[l];
                    if (u)
                        if (o.startsWith("#"))
                            if (o.startsWith("#extension")) n.push(o);
                            else if (o.startsWith("#undef")) i[o.match(/#undef\s+(\w+)/)[1]] = void 0, n.push(o);
                    else if (o.startsWith("#define")) {
                        var c = o.match(/#define\s+(\w+)\s*(.*)/); - 1 !== o.indexOf(c[1] + "(") ? i[c[1]] = {
                            args: o.match(/\(.*?\)/)[0].match(/\w+/g),
                            body: o.match(/\)(.*)/)[1]
                        } : i[c[1]] = c[2]
                    } else console.error("unknown preprocessor line: " + o);
                    else n.push(o)
                }
            }
        },
        fixIndent = function (e) {
            e = e.replace(/(\n\s*\n)+/g, "\n\n");
            for (var t = e.split("\n"), i = "", n = 0; n < t.length; ++n) {
                var r = t[n].trim(),
                    a = -1 !== r.indexOf("{"),
                    o = -1 !== r.indexOf("}");
                !a && o && (i = i.substr(4)), t[n] = i + r, a && !o && (i += "    ")
            }
            return t.join("\n")
        },
        cleanDeclarations = function (e, t) {
            for (var i = 0; i < t.length; ++i) e = e.replace(t[i], ""), t[i] = t[i].replace(/\s+/g, " ").replace(/\s+;/, ";");
            return e
        },
        handleVaryings = function (e) {
            var t = e.match(/varying\s.*?;/g);
            if (!t) return e;
            e = cleanDeclarations(e, t), t = shaderProcessor.getSortedUnique(t);
            for (var i = 0; i < t.length; ++i)
                if (-1 !== t[i].indexOf("vViewNormal;")) {
                    var n = t[0];
                    t[0] = t[i], t[i] = n;
                    break
                } return "\n" + t.join("\n") + "\n" + e
        },
        handleUniforms = function (e) {
            var t = e.match(/uniform\s.*?;/g);
            return t ? (e = cleanDeclarations(e, t), t = shaderProcessor.getSortedUnique(t), "\n" + t.join("\n") + "\n" + e) : e
        },
        handleAttributes = function (e) {
            var t = e.match(/attribute\s.*?;/g);
            if (!t) return e;
            e = cleanDeclarations(e, t), t = shaderProcessor.getSortedUnique(t);
            for (var i = 0; i < t.length; ++i)
                if (-1 !== t[i].indexOf(" Vertex;")) {
                    t.unshift(t[i]), t.splice(i + 1, 1);
                    break
                } return "\n" + t.join("\n") + "\n" + e
        },
        handlePrecision = function (e) {
            var t = e.match(/precision\s+(high|low|medium)p\s+float\s*;/);
            return t ? t[0] + "\n" + e.replace(t[0], "") : "precision " + __WEBPACK_IMPORTED_MODULE_1_osg_WebGLCaps__.a.instance().getShaderMaxPrecisionFloat() + "p float;\n" + e
        },
        addExtensions = function (e) {
            var t = e.match(/#extension\s(\w+)\s:\s(\w+)/g);
            if (!t) return e;
            t = shaderProcessor.getSortedUnique(t);
            for (var i = 0; i < t.length; ++i) e = e.replace(t[i], "");
            return t.join("\n") + "\n" + e
        },
        addVersion = function (e) {
            return (__WEBPACK_IMPORTED_MODULE_1_osg_WebGLCaps__.a.instance().isWebGL2() ? "#version 300 es\n" : "#version 100\n") + e
        },
        hasVersion = function (e) {
            return e.match(/^#\s*version/m)
        },
        cbUnroll = function (e, t, i) {
            t = parseInt(t);
            for (var n = "", r = 0; r < t; ++r) n += i.replace(/%ID%/g, r);
            return n
        },
        unrollReplace = function (e) {
            return e.replace(/%UNROLL ([0-9]+)%([\s\S]+?)%%/g, cbUnroll)
        },
        glslPreprocessShader = function (e) {
            var t = {
                debugExperimental: !1,
                defines: [],
                doStats: !1,
                extensions: [],
                pruneComments: !0,
                logCounts: !1,
                minify: !1,
                output: 0,
                preprocess: !0,
                profileTimeEach: !1,
                profileTimeGlobal: !1,
                pruneUnused: !0,
                pruneDefines: !0,
                replaceDefine: !0,
                optimize: !0,
                tabs: 4,
                whitespace: !0
            };
            return window.glslesPreprocessor(e, t)
        },
        extractArguments = function (e, t) {
            for (var i = [""], n = 0, r = t; r < e.length; ++r) {
                if ("(" === e[r]) n++;
                else if (")" === e[r]) {
                    if (0 === n) return [i, r + 1];
                    if (0 === --n) {
                        i[i.length - 1] += e[r];
                        continue
                    }
                }
                "," !== e[r] || 0 !== n ? i[i.length - 1] += e[r] : i.push("")
            }
        },
        replaceRange = function (e, t, i, n) {
            return e.substring(0, t) + n + e.substring(i)
        },
        resolveDefineFunction = function (e, t, i) {
            var n = new RegExp("\\b" + t + "\\b\\s*\\(", "g"),
                r = e.match(n);
            if (!r) return e;
            for (var a = i.args, o = i.body, s = 0; s < r.length; ++s) {
                var u = r[s],
                    l = e.indexOf(u),
                    c = l + u.length,
                    h = extractArguments(e, c),
                    d = h[0],
                    f = o.replace(/\w+/g, function (e) {
                        var t = a.indexOf(e);
                        return -1 !== t ? d[t] : e
                    });
                e = replaceRange(e, l, h[1], f)
            }
            return e
        },
        resolveDefines = function (e, t) {
            for (var i = Object.keys(t), n = 0; n < i.length; ++n) {
                for (var r = i[n], a = t[r], o = "object" == typeof a, s = !o && new RegExp("\\b" + r + "\\b", "g"), u = n + 1; u < i.length; ++u) {
                    var l = i[u],
                        c = t[l];
                    "object" == typeof c ? c.body = o ? resolveDefineFunction(c.body, r, a) : c.body.replace(s, a) : t[l] = o ? resolveDefineFunction(c, r, a) : c.replace(s, a)
                }
                e = o ? resolveDefineFunction(e, r, a) : e.replace(s, a)
            }
            return e
        },
        extensions = ["EXT_shader_texture_lod", "EXT_draw_buffers", "EXT_frag_depth", "OES_standard_derivatives"],
        getDefaultDefines = function () {
            for (var e = {}, t = __WEBPACK_IMPORTED_MODULE_1_osg_WebGLCaps__.a.instance(), i = t.getWebGLExtensions(), n = 0; n < extensions.length; ++n) {
                var r = extensions[n];
                i[r] && (e["GL_" + r] = "GL_" + r)
            }
            return "high" === t.getShaderMaxPrecisionFloat() && (e.GL_FRAGMENT_PRECISION_HIGH = "GL_FRAGMENT_PRECISION_HIGH"), e
        },
        fastPreprocess = function (e) {
            e = e.replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm, "");
            var t = getDefaultDefines(),
                i = [];
            return processBranch(e.split("\n"), 0, t, i, !0), resolveDefines(i.join("\n"), t)
        },
        preprocess = function (e) {
            var t = e.match("#define SHADER_NAME .*");
            return e = Object(__WEBPACK_IMPORTED_MODULE_2_viewer_getOptions__.a)().cleanShader && window.glslesPreprocessor ? glslPreprocessShader(e) : fastPreprocess(e), t ? t[0] + "\n" + e : e
        };
    shaderProcessor.processIncludes = function (e, t) {
        return e.replace(/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g, function (e, i) {
            var n = i.split(" ")[0].replace(/"/g, "");
            return -1 !== t.indexOf(n) ? "" : (t.push(n), shaderProcessor.processIncludes(shaderProcessor.getShaderTextPure(n), t))
        })
    }, shaderProcessor.processShader = function (e) {
        if (hasVersion(e)) return e;
        var t = [],
            i = shaderProcessor.processIncludes(e, t),
            n = -1 === i.indexOf("gl_Position");
        return i = i.replace(/\\\n/g, ""), i = unrollReplace(i), i = preprocess(i), i = handleVaryings(i), i = handleUniforms(i), i = handleAttributes(i), i = fixIndent(i), __WEBPACK_IMPORTED_MODULE_1_osg_WebGLCaps__.a.instance().isWebGL2() && (i = Object(__WEBPACK_IMPORTED_MODULE_3_osgShader_gl2convert__.a)(i, n)), i = handlePrecision(i), i = addExtensions(i), i = addVersion(i)
    };
    var shadersText = {};
    shaderProcessor.addShaders = function (e) {
        for (var t in e) shadersText[t] = e[t]
    }, shaderProcessor.hasShader = function (e) {
        return void 0 !== shadersText[e]
    }, shaderProcessor.getShaderTextPure = function (e) {
        var t = shadersText[e];
        return t || __WEBPACK_IMPORTED_MODULE_0_osg_notify__.a.error("shader file/text: " + e + " not registered"), t
    }, shaderProcessor.getShader = function (e) {
        var t = shaderProcessor.getShaderTextPure(e);
        return shaderProcessor.processShader(t)
    }, __webpack_exports__.a = shaderProcessor
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(92),
        a = function (e, t, i, n) {
            r.a.call(this), this._x = void 0 !== e ? e : -1, this._y = void 0 !== t ? t : -1, this._width = void 0 !== i ? i : -1, this._height = void 0 !== n ? n : -1
        };
    n.a.createPrototypeStateAttribute(a, n.a.objectInherit(r.a.prototype, {
        attributeType: "Scissor",
        cloneType: function () {
            return new a
        },
        setScissor: function (e, t, i, n) {
            this._x = e, this._y = t, this._width = i, this._height = n
        },
        x: function () {
            return this._x
        },
        y: function () {
            return this._y
        },
        width: function () {
            return this._width
        },
        height: function () {
            return this._height
        },
        apply: function (e) {
            e.applyScissor(this)
        }
    }), "osg", "Scissor"), t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(102),
        a = i(10),
        o = i(408),
        s = function (e, t) {
            r.a.call(this), this._target = o.a.createVec3Target(t || a.f.ONE), e && this.setName(e)
        };
    n.a.createPrototypeObject(s, n.a.objectInherit(r.a.prototype, {
        init: function (e) {
            this.setScale(e), a.f.copy(this._target.defaultValue, e)
        },
        setScale: function (e) {
            a.f.copy(this._target.value, e)
        },
        getTarget: function () {
            return this._target
        },
        resetToDefaultValue: function () {
            this.setScale(this._target.defaultValue)
        },
        applyToMatrix: function (e) {
            var t = this._target.value;
            a.c.scale(e, e, t)
        }
    }), "osgAnimation", "StackedScale"), t.a = s
}, function (e, t, i) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: !0
    });
    var n = i(5),
        r = i.n(n),
        a = i(12),
        o = i(842),
        s = i(622),
        u = i(1099),
        l = i(691),
        c = i.n(l),
        h = i(36),
        d = i(448),
        f = i(178),
        p = i(291),
        m = i(856),
        g = i(289),
        v = i(138),
        _ = a.a.rejectObject,
        b = function (e, t) {
            this._json = e;
            var i = t;
            void 0 === i && (i = {}), this._identifierMap = i, this._objectRegistry = {}, this._cacheReadObject = {}, this.setOptions(a.a.objectMix({}, u.a))
        };
    b.imageFallback || (b.imageFallback = function () {
        var e = new window.Image;
        return e.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQIW2P8DwQACgAD/il4QJ8AAAAASUVORK5CYII=", e
    }()), b.prototype = {
        clone: function () {
            var e = new b;
            return e._objectRegistry = this._objectRegistry, e._cacheReadObject = this._cacheReadObject, e
        },
        setOptions: function (e) {
            this._defaultOptions = e
        },
        getOptions: function () {
            return this._defaultOptions
        },
        setProgressXHRCallback: function (e) {
            this._defaultOptions.progressXHRCallback = e
        },
        setReadNodeURLCallback: function (e) {
            this._defaultOptions.readNodeURL = e
        },
        registerObject: function (e, t) {
            this._objectRegistry[e] = t
        },
        getJSON: function () {
            return this._json
        },
        setJSON: function (e) {
            return this._json = e, this
        },
        setPrefixURL: function (e) {
            this._defaultOptions.prefixURL = e
        },
        getPrefixURL: function () {
            return this._defaultOptions.prefixURL
        },
        setDatabasePath: function (e) {
            this._defaultOptions.databasePath = e
        },
        getDatabasePath: function () {
            return this._defaultOptions.databasePath
        },
        computeURL: function (e) {
            return "string" == typeof this._defaultOptions.prefixURL && this._defaultOptions.prefixURL.length > 0 ? this._defaultOptions.prefixURL + e : e
        },
        requestFile: function (e, t) {
            return s.a.requestURI(e, t)
        },
        getObjectWrapper: function (e) {
            if (this._objectRegistry[e]) return new this._objectRegistry[e];
            for (var t = o.a, i = e.split("."), n = 0, r = i.length; n < r; n++) {
                var a = t[i[n]];
                if (void 0 === a) return;
                t = a
            }
            return this._objectRegistry[e] = t, new t
        },
        fetchImage: function (e, t, i) {
            var n = "data:image/" === t.substring(0, "data:image/".length),
                a = new window.Image;
            return !n && i.imageCrossOrigin && (a.crossOrigin = i.imageCrossOrigin), e.setURL(t), e.setImage(a), a.src = t, new r.a(function (n) {
                a.onerror = function () {
                    h.a.warn("warning use white texture as fallback instead of " + t), e.setImage(b.imageFallback), n(e)
                }, a.onload = function () {
                    i.imageOnload && i.imageOnload.call(e), n(e)
                }
            })
        },
        readImageURL: function (e, t) {
            if (void 0 === t && (t = this._defaultOptions), t.readImageURL) return t.readImageURL.call(this, e, t);
            "data:image" !== e.substr(0, 10) && (e = this.computeURL(e));
            var i = new d.a;
            return this.fetchImage(i, e, t)
        },
        readNodeURL: function (e, t) {
            var n = t;
            if (void 0 === n && (n = this._defaultOptions), n.readNodeURL) return n.readNodeURL.call(this, e, n);
            e = this.computeURL(e);
            var r = this;
            if (n = a.a.objectMix({}, n), !n.prefixURL) {
                var o = r.getPrefixURL(),
                    s = e.lastIndexOf("/"); - 1 !== s && (o = e.substring(0, s + 1)), n.prefixURL = o
            }
            var u = i(422).default,
                l = function (t) {
                    return u.parseSceneGraph(t, n).then(function (t) {
                        return h.a.log("loaded " + e), t
                    })
                },
                d = function (e) {
                    function t(e) {
                        return e.length < 2 ? "0" + e : e
                    }
                    var i = e;
                    c.a.isGunzipBuffer(e) && (i = c.a.gunzip(e));
                    var n = new Uint8Array(i);
                    return function (e) {
                        for (var i = "", n = 0, r = e.length; n < r; ++n) i += "%" + t(e[n].toString(16));
                        return i = decodeURIComponent(i)
                    }(n)
                };
            return a.a.time("osgjs.metric:Input.readNodeURL", h.a.INFO), r.requestFile(e).then(function (t) {
                var i;
                try {
                    i = JSON.parse(t)
                } catch (t) {
                    h.a.error("cant parse url " + e + " try to gunzip")
                }
                return i ? l(i) : r.requestFile(e, {
                    responseType: "arraybuffer"
                }).then(function (e) {
                    var t = d(e);
                    return i = JSON.parse(t), l(i)
                }).catch(function (t) {
                    var i = "cant read file " + e + " status " + t;
                    return h.a.error(i), i
                })
            }).catch(function (t) {
                var i = "cant get file " + e + " status " + t;
                return h.a.error(i), i
            }).finally(function () {
                a.a.timeEnd("osgjs.metric:Input.readNodeURL")
            })
        },
        _unzipTypedArray: function (e) {
            var t = new Uint8Array(e);
            if (31 === t[0] && 139 === t[1]) {
                var n = i(691);
                n || h.a.error("osg failed to use a gunzip.min.js to uncompress a gz file.\n You can add this vendors to enable this feature or adds the good header in your gzip file served by your server");
                return new n.Gunzip(t).decompress().buffer
            }
            return e
        },
        readBinaryArrayURL: function (e, t) {
            if (void 0 === t && (t = this._defaultOptions), t.readBinaryArrayURL) return t.readBinaryArrayURL.call(this, e, t);
            if (e = this.computeURL(e), void 0 !== this._identifierMap[e]) return this._identifierMap[e];
            var i = this.requestFile(e, {
                    responseType: "arraybuffer",
                    progress: this._defaultOptions.progressXHRCallback
                }),
                n = this;
            return this._identifierMap[e] = i.then(function (e) {
                return n._unzipTypedArray(e)
            }), this._identifierMap[e]
        },
        initializeBufferArray: function (e, t, i, n) {
            if (void 0 === n && (n = this.getOptions()), n.initializeBufferArray) return n.initializeBufferArray.call(this, e, t, i);
            var r = e.File;
            return this.readBinaryArrayURL(r).then(function (n) {
                var r, o;
                ! function () {
                    var e = new Uint8Array([18, 52]),
                        t = new Uint16Array(e.buffer);
                    o = "1234" === t[0].toString(16)
                }();
                var s = 0;
                void 0 !== e.Offset && (s = e.Offset);
                var u = a.a[t].BYTES_PER_ELEMENT,
                    l = e.Size,
                    c = i.getItemSize(),
                    d = l * u * c;
                if (o) {
                    h.a.log("big endian detected");
                    var f = a.a[t],
                        p = new f(l * c),
                        m = new DataView(n, s, d),
                        g = 0,
                        v = p.length;
                    if ("Uint16Array" === t)
                        for (; g < v; g++) p[g] = m.getUint16(g * u, !0);
                    else if ("Float32Array" === t)
                        for (; g < v; g++) p[g] = m.getFloat32(g * u, !0);
                    r = p, m = null
                } else r = new a.a[t](n, s, c * l);
                return i.setElements(r), i
            })
        },
        readBufferArray: function (e) {
            var t, i = this.getJSON(),
                n = i.UniqueID;
            if (void 0 !== n && void 0 !== (t = this._identifierMap[n])) return t;
            if (void 0 === e && (e = this.getOptions()), e.readBufferArray) return e.readBufferArray.call(this);
            if (!i.Elements && !i.Array || !i.ItemSize || !i.Type) return _("BufferArray", i);
            var o;
            if (i.Elements) o = r.a.resolve(new f.a(f.a[i.Type], i.Elements, i.ItemSize));
            else if (i.Array) {
                var s = new f.a(f.a[i.Type]);
                s.setItemSize(i.ItemSize);
                var u, l;
                if (i.Array.Float32Array ? (u = i.Array.Float32Array, l = "Float32Array") : i.Array.Uint16Array ? (u = i.Array.Uint16Array, l = "Uint16Array") : i.Array.Uint8Array && (u = i.Array.Uint8Array, l = "Uint8Array"), void 0 === u) return _("Typed Array " + window.Object.keys(i.Array)[0]);
                u.File ? o = this.initializeBufferArray(u, l, s) : u.Elements && (s.setElements(new a.a[l](u.Elements)), o = r.a.resolve(s))
            }
            return void 0 !== n && (this._identifierMap[n] = o), o
        },
        readUserDataContainer: function () {
            var e, t = this.getJSON(),
                i = t.UniqueID;
            return void 0 !== i && void 0 !== (e = this._identifierMap[i]) ? e.Values : (this._identifierMap[i] = t, t.Values)
        },
        readPrimitiveSet: function () {
            var e, t, i, n, a, o, s, u = this.getJSON(),
                l = u.DrawElementUShort || u.DrawElementUByte || u.DrawElementUInt || u.DrawElementsUShort || u.DrawElementsUByte || u.DrawElementsUInt,
                c = u.DrawArray || u.DrawArrays,
                h = u.DrawArrayLengths;
            if (l) {
                if (void 0 !== (e = l.UniqueID) && void 0 !== (t = this._identifierMap[e])) return t;
                a = l.Mode ? v.a[l.Mode] : v.a.TRIANGLES, n = new g.a(a), this.setJSON(l.Indices), i = this.readBufferArray().then(function (e) {
                    return n.setIndices(e), n
                }), this.setJSON(u)
            } else if (c) {
                if (void 0 !== (e = c.UniqueID) && void 0 !== (t = this._identifierMap[e])) return t;
                a = c.Mode || c.mode, o = void 0 !== c.First ? c.First : c.first, s = void 0 !== c.Count ? c.Count : c.count, n = new p.a(v.a[a], o, s), i = r.a.resolve(n)
            } else if (h) {
                if (void 0 !== (e = h.UniqueID) && void 0 !== (t = this._identifierMap[e])) return t;
                a = h.Mode, o = h.First;
                var d = h.ArrayLengths;
                n = new m.a(v.a[a], o, d), i = r.a.resolve(n)
            } else i = _("PrimitiveSet", u);
            return void 0 !== e && (this._identifierMap[e] = i), i
        },
        readObject: function () {
            var e = this.getJSON(),
                t = window.Object.keys(e),
                n = t[0];
            if (!n) return _("can't find property for object " + t);
            var r, a = e[n].UniqueID;
            if (void 0 !== a && void 0 !== (r = this._identifierMap[a])) return r;
            var o = this.getObjectWrapper(n);
            if (!o) return _("can't instanciate object " + n);
            var s = i(422).default,
                u = s.ObjectWrapper.serializers;
            if (this._cacheReadObject[n]) u = this._cacheReadObject[n];
            else {
                for (var l = n.split("."), c = 0, h = l.length; c < h; c++) {
                    var d = l[c],
                        f = u[d];
                    if (!f) return _("Unknown scope " + n + "(" + d + ")");
                    u = f
                }
                this._cacheReadObject[n] = u
            }
            var p = u(this.setJSON(e[n]), o);
            return void 0 !== a && (this._identifierMap[a] = p, o._uniqueID = a), p
        }
    }, t.default = b
}, function (e, t) {}, function (e, t, i) {
    var n;
    /*! Hammer.JS - v2.0.7 - 2016-04-22
     * http://hammerjs.github.io/
     *
     * Copyright (c) 2016 Jorik Tangelder;
     * Licensed under the MIT license */
    ! function (r, a, o, s) {
        "use strict";

        function u(e, t, i) {
            return setTimeout(f(e, i), t)
        }

        function l(e, t, i) {
            return !!Array.isArray(e) && (c(e, i[t], i), !0)
        }

        function c(e, t, i) {
            var n;
            if (e)
                if (e.forEach) e.forEach(t, i);
                else if (e.length !== s)
                for (n = 0; n < e.length;) t.call(i, e[n], n, e), n++;
            else
                for (n in e) e.hasOwnProperty(n) && t.call(i, e[n], n, e)
        }

        function h(e, t, i) {
            var n = "DEPRECATED METHOD: " + t + "\n" + i + " AT \n";
            return function () {
                var t = new Error("get-stack-trace"),
                    i = t && t.stack ? t.stack.replace(/^[^\(]+?[\n$]/gm, "").replace(/^\s+at\s+/gm, "").replace(/^Object.<anonymous>\s*\(/gm, "{anonymous}()@") : "Unknown Stack Trace",
                    a = r.console && (r.console.warn || r.console.log);
                return a && a.call(r.console, n, i), e.apply(this, arguments)
            }
        }

        function d(e, t, i) {
            var n, r = t.prototype;
            n = e.prototype = Object.create(r), n.constructor = e, n._super = r, i && pe(n, i)
        }

        function f(e, t) {
            return function () {
                return e.apply(t, arguments)
            }
        }

        function p(e, t) {
            return typeof e == ve ? e.apply(t ? t[0] || s : s, t) : e
        }

        function m(e, t) {
            return e === s ? t : e
        }

        function g(e, t, i) {
            c(S(t), function (t) {
                e.addEventListener(t, i, !1)
            })
        }

        function v(e, t, i) {
            c(S(t), function (t) {
                e.removeEventListener(t, i, !1)
            })
        }

        function _(e, t) {
            for (; e;) {
                if (e == t) return !0;
                e = e.parentNode
            }
            return !1
        }

        function b(e, t) {
            return e.indexOf(t) > -1
        }

        function S(e) {
            return e.trim().split(/\s+/g)
        }

        function x(e, t, i) {
            if (e.indexOf && !i) return e.indexOf(t);
            for (var n = 0; n < e.length;) {
                if (i && e[n][i] == t || !i && e[n] === t) return n;
                n++
            }
            return -1
        }

        function y(e) {
            return Array.prototype.slice.call(e, 0)
        }

        function C(e, t, i) {
            for (var n = [], r = [], a = 0; a < e.length;) {
                var o = t ? e[a][t] : e[a];
                x(r, o) < 0 && n.push(e[a]), r[a] = o, a++
            }
            return i && (n = t ? n.sort(function (e, i) {
                return e[t] > i[t]
            }) : n.sort()), n
        }

        function T(e, t) {
            for (var i, n, r = t[0].toUpperCase() + t.slice(1), a = 0; a < me.length;) {
                if (i = me[a], (n = i ? i + r : t) in e) return n;
                a++
            }
            return s
        }

        function w() {
            return Ce++
        }

        function M(e) {
            var t = e.ownerDocument || e;
            return t.defaultView || t.parentWindow || r
        }

        function E(e, t) {
            var i = this;
            this.manager = e, this.callback = t, this.element = e.element, this.target = e.options.inputTarget, this.domHandler = function (t) {
                p(e.options.enable, [e]) && i.handler(t)
            }, this.init()
        }

        function A(e) {
            var t = e.options.inputClass;
            return new(t || (Me ? j : Ee ? W : we ? X : G))(e, P)
        }

        function P(e, t, i) {
            var n = i.pointers.length,
                r = i.changedPointers.length,
                a = t & Pe && n - r == 0,
                o = t & (Oe | Ie) && n - r == 0;
            i.isFirst = !!a, i.isFinal = !!o, a && (e.session = {}), i.eventType = t, R(e, i), e.emit("hammer.input", i), e.recognize(i), e.session.prevInput = i
        }

        function R(e, t) {
            var i = e.session,
                n = t.pointers,
                r = n.length;
            i.firstInput || (i.firstInput = F(t)), r > 1 && !i.firstMultiple ? i.firstMultiple = F(t) : 1 === r && (i.firstMultiple = !1);
            var a = i.firstInput,
                o = i.firstMultiple,
                s = o ? o.center : a.center,
                u = t.center = N(n);
            t.timeStamp = Se(), t.deltaTime = t.timeStamp - a.timeStamp, t.angle = V(s, u), t.distance = k(s, u), O(i, t), t.offsetDirection = L(t.deltaX, t.deltaY);
            var l = D(t.deltaTime, t.deltaX, t.deltaY);
            t.overallVelocityX = l.x, t.overallVelocityY = l.y, t.overallVelocity = be(l.x) > be(l.y) ? l.x : l.y, t.scale = o ? U(o.pointers, n) : 1, t.rotation = o ? B(o.pointers, n) : 0, t.maxPointers = i.prevInput ? t.pointers.length > i.prevInput.maxPointers ? t.pointers.length : i.prevInput.maxPointers : t.pointers.length, I(i, t);
            var c = e.element;
            _(t.srcEvent.target, c) && (c = t.srcEvent.target), t.target = c
        }

        function O(e, t) {
            var i = t.center,
                n = e.offsetDelta || {},
                r = e.prevDelta || {},
                a = e.prevInput || {};
            t.eventType !== Pe && a.eventType !== Oe || (r = e.prevDelta = {
                x: a.deltaX || 0,
                y: a.deltaY || 0
            }, n = e.offsetDelta = {
                x: i.x,
                y: i.y
            }), t.deltaX = r.x + (i.x - n.x), t.deltaY = r.y + (i.y - n.y)
        }

        function I(e, t) {
            var i, n, r, a, o = e.lastInterval || t,
                u = t.timeStamp - o.timeStamp;
            if (t.eventType != Ie && (u > Ae || o.velocity === s)) {
                var l = t.deltaX - o.deltaX,
                    c = t.deltaY - o.deltaY,
                    h = D(u, l, c);
                n = h.x, r = h.y, i = be(h.x) > be(h.y) ? h.x : h.y, a = L(l, c), e.lastInterval = t
            } else i = o.velocity, n = o.velocityX, r = o.velocityY, a = o.direction;
            t.velocity = i, t.velocityX = n, t.velocityY = r, t.direction = a
        }

        function F(e) {
            for (var t = [], i = 0; i < e.pointers.length;) t[i] = {
                clientX: _e(e.pointers[i].clientX),
                clientY: _e(e.pointers[i].clientY)
            }, i++;
            return {
                timeStamp: Se(),
                pointers: t,
                center: N(t),
                deltaX: e.deltaX,
                deltaY: e.deltaY
            }
        }

        function N(e) {
            var t = e.length;
            if (1 === t) return {
                x: _e(e[0].clientX),
                y: _e(e[0].clientY)
            };
            for (var i = 0, n = 0, r = 0; r < t;) i += e[r].clientX, n += e[r].clientY, r++;
            return {
                x: _e(i / t),
                y: _e(n / t)
            }
        }

        function D(e, t, i) {
            return {
                x: t / e || 0,
                y: i / e || 0
            }
        }

        function L(e, t) {
            return e === t ? Fe : be(e) >= be(t) ? e < 0 ? Ne : De : t < 0 ? Le : ke
        }

        function k(e, t, i) {
            i || (i = Ge);
            var n = t[i[0]] - e[i[0]],
                r = t[i[1]] - e[i[1]];
            return Math.sqrt(n * n + r * r)
        }

        function V(e, t, i) {
            i || (i = Ge);
            var n = t[i[0]] - e[i[0]],
                r = t[i[1]] - e[i[1]];
            return 180 * Math.atan2(r, n) / Math.PI
        }

        function B(e, t) {
            return V(t[1], t[0], je) + V(e[1], e[0], je)
        }

        function U(e, t) {
            return k(t[0], t[1], je) / k(e[0], e[1], je)
        }

        function G() {
            this.evEl = He, this.evWin = We, this.pressed = !1, E.apply(this, arguments)
        }

        function j() {
            this.evEl = Ye, this.evWin = Ke, E.apply(this, arguments), this.store = this.manager.session.pointerEvents = []
        }

        function z() {
            this.evTarget = Qe, this.evWin = Je, this.started = !1, E.apply(this, arguments)
        }

        function H(e, t) {
            var i = y(e.touches),
                n = y(e.changedTouches);
            return t & (Oe | Ie) && (i = C(i.concat(n), "identifier", !0)), [i, n]
        }

        function W() {
            this.evTarget = et, this.targetIds = {}, E.apply(this, arguments)
        }

        function q(e, t) {
            var i = y(e.touches),
                n = this.targetIds;
            if (t & (Pe | Re) && 1 === i.length) return n[i[0].identifier] = !0, [i, i];
            var r, a, o = y(e.changedTouches),
                s = [],
                u = this.target;
            if (a = i.filter(function (e) {
                    return _(e.target, u)
                }), t === Pe)
                for (r = 0; r < a.length;) n[a[r].identifier] = !0, r++;
            for (r = 0; r < o.length;) n[o[r].identifier] && s.push(o[r]), t & (Oe | Ie) && delete n[o[r].identifier], r++;
            return s.length ? [C(a.concat(s), "identifier", !0), s] : void 0
        }

        function X() {
            E.apply(this, arguments);
            var e = f(this.handler, this);
            this.touch = new W(this.manager, e), this.mouse = new G(this.manager, e), this.primaryTouch = null, this.lastTouches = []
        }

        function Y(e, t) {
            e & Pe ? (this.primaryTouch = t.changedPointers[0].identifier, K.call(this, t)) : e & (Oe | Ie) && K.call(this, t)
        }

        function K(e) {
            var t = e.changedPointers[0];
            if (t.identifier === this.primaryTouch) {
                var i = {
                    x: t.clientX,
                    y: t.clientY
                };
                this.lastTouches.push(i);
                var n = this.lastTouches,
                    r = function () {
                        var e = n.indexOf(i);
                        e > -1 && n.splice(e, 1)
                    };
                setTimeout(r, tt)
            }
        }

        function $(e) {
            for (var t = e.srcEvent.clientX, i = e.srcEvent.clientY, n = 0; n < this.lastTouches.length; n++) {
                var r = this.lastTouches[n],
                    a = Math.abs(t - r.x),
                    o = Math.abs(i - r.y);
                if (a <= it && o <= it) return !0
            }
            return !1
        }

        function Q(e, t) {
            this.manager = e, this.set(t)
        }

        function J(e) {
            if (b(e, st)) return st;
            var t = b(e, ut),
                i = b(e, lt);
            return t && i ? st : t || i ? t ? ut : lt : b(e, ot) ? ot : at
        }

        function Z(e) {
            this.options = pe({}, this.defaults, e || {}), this.id = w(), this.manager = null, this.options.enable = m(this.options.enable, !0), this.state = ht, this.simultaneous = {}, this.requireFail = []
        }

        function ee(e) {
            return e & gt ? "cancel" : e & pt ? "end" : e & ft ? "move" : e & dt ? "start" : ""
        }

        function te(e) {
            return e == ke ? "down" : e == Le ? "up" : e == Ne ? "left" : e == De ? "right" : ""
        }

        function ie(e, t) {
            var i = t.manager;
            return i ? i.get(e) : e
        }

        function ne() {
            Z.apply(this, arguments)
        }

        function re() {
            ne.apply(this, arguments), this.pX = null, this.pY = null
        }

        function ae() {
            ne.apply(this, arguments)
        }

        function oe() {
            Z.apply(this, arguments), this._timer = null, this._input = null
        }

        function se() {
            ne.apply(this, arguments)
        }

        function ue() {
            ne.apply(this, arguments)
        }

        function le() {
            Z.apply(this, arguments), this.pTime = !1, this.pCenter = !1, this._timer = null, this._input = null, this.count = 0
        }

        function ce(e, t) {
            return t = t || {}, t.recognizers = m(t.recognizers, ce.defaults.preset), new he(e, t)
        }

        function he(e, t) {
            this.options = pe({}, ce.defaults, t || {}), this.options.inputTarget = this.options.inputTarget || e, this.handlers = {}, this.session = {}, this.recognizers = [], this.oldCssProps = {}, this.element = e, this.input = A(this), this.touchAction = new Q(this, this.options.touchAction), de(this, !0), c(this.options.recognizers, function (e) {
                var t = this.add(new e[0](e[1]));
                e[2] && t.recognizeWith(e[2]), e[3] && t.requireFailure(e[3])
            }, this)
        }

        function de(e, t) {
            var i = e.element;
            if (i.style) {
                var n;
                c(e.options.cssProps, function (r, a) {
                    n = T(i.style, a), t ? (e.oldCssProps[n] = i.style[n], i.style[n] = r) : i.style[n] = e.oldCssProps[n] || ""
                }), t || (e.oldCssProps = {})
            }
        }

        function fe(e, t) {
            var i = a.createEvent("Event");
            i.initEvent(e, !0, !0), i.gesture = t, t.target.dispatchEvent(i)
        }
        var pe, me = ["", "webkit", "Moz", "MS", "ms", "o"],
            ge = a.createElement("div"),
            ve = "function",
            _e = Math.round,
            be = Math.abs,
            Se = Date.now;
        pe = "function" != typeof Object.assign ? function (e) {
            if (e === s || null === e) throw new TypeError("Cannot convert undefined or null to object");
            for (var t = Object(e), i = 1; i < arguments.length; i++) {
                var n = arguments[i];
                if (n !== s && null !== n)
                    for (var r in n) n.hasOwnProperty(r) && (t[r] = n[r])
            }
            return t
        } : Object.assign;
        var xe = h(function (e, t, i) {
                for (var n = Object.keys(t), r = 0; r < n.length;)(!i || i && e[n[r]] === s) && (e[n[r]] = t[n[r]]), r++;
                return e
            }, "extend", "Use `assign`."),
            ye = h(function (e, t) {
                return xe(e, t, !0)
            }, "merge", "Use `assign`."),
            Ce = 1,
            Te = /mobile|tablet|ip(ad|hone|od)|android/i,
            we = "ontouchstart" in r,
            Me = T(r, "PointerEvent") !== s,
            Ee = we && Te.test(navigator.userAgent),
            Ae = 25,
            Pe = 1,
            Re = 2,
            Oe = 4,
            Ie = 8,
            Fe = 1,
            Ne = 2,
            De = 4,
            Le = 8,
            ke = 16,
            Ve = Ne | De,
            Be = Le | ke,
            Ue = Ve | Be,
            Ge = ["x", "y"],
            je = ["clientX", "clientY"];
        E.prototype = {
            handler: function () {},
            init: function () {
                this.evEl && g(this.element, this.evEl, this.domHandler), this.evTarget && g(this.target, this.evTarget, this.domHandler), this.evWin && g(M(this.element), this.evWin, this.domHandler)
            },
            destroy: function () {
                this.evEl && v(this.element, this.evEl, this.domHandler), this.evTarget && v(this.target, this.evTarget, this.domHandler), this.evWin && v(M(this.element), this.evWin, this.domHandler)
            }
        };
        var ze = {
                mousedown: Pe,
                mousemove: Re,
                mouseup: Oe
            },
            He = "mousedown",
            We = "mousemove mouseup";
        d(G, E, {
            handler: function (e) {
                var t = ze[e.type];
                t & Pe && 0 === e.button && (this.pressed = !0), t & Re && 1 !== e.which && (t = Oe), this.pressed && (t & Oe && (this.pressed = !1), this.callback(this.manager, t, {
                    pointers: [e],
                    changedPointers: [e],
                    pointerType: "mouse",
                    srcEvent: e
                }))
            }
        });
        var qe = {
                pointerdown: Pe,
                pointermove: Re,
                pointerup: Oe,
                pointercancel: Ie,
                pointerout: Ie
            },
            Xe = {
                2: "touch",
                3: "pen",
                4: "mouse",
                5: "kinect"
            },
            Ye = "pointerdown",
            Ke = "pointermove pointerup pointercancel";
        r.MSPointerEvent && !r.PointerEvent && (Ye = "MSPointerDown", Ke = "MSPointerMove MSPointerUp MSPointerCancel"), d(j, E, {
            handler: function (e) {
                var t = this.store,
                    i = !1,
                    n = e.type.toLowerCase().replace("ms", ""),
                    r = qe[n],
                    a = Xe[e.pointerType] || e.pointerType,
                    o = "touch" == a,
                    s = x(t, e.pointerId, "pointerId");
                r & Pe && (0 === e.button || o) ? s < 0 && (t.push(e), s = t.length - 1) : r & (Oe | Ie) && (i = !0), s < 0 || (t[s] = e, this.callback(this.manager, r, {
                    pointers: t,
                    changedPointers: [e],
                    pointerType: a,
                    srcEvent: e
                }), i && t.splice(s, 1))
            }
        });
        var $e = {
                touchstart: Pe,
                touchmove: Re,
                touchend: Oe,
                touchcancel: Ie
            },
            Qe = "touchstart",
            Je = "touchstart touchmove touchend touchcancel";
        d(z, E, {
            handler: function (e) {
                var t = $e[e.type];
                if (t === Pe && (this.started = !0), this.started) {
                    var i = H.call(this, e, t);
                    t & (Oe | Ie) && i[0].length - i[1].length == 0 && (this.started = !1), this.callback(this.manager, t, {
                        pointers: i[0],
                        changedPointers: i[1],
                        pointerType: "touch",
                        srcEvent: e
                    })
                }
            }
        });
        var Ze = {
                touchstart: Pe,
                touchmove: Re,
                touchend: Oe,
                touchcancel: Ie
            },
            et = "touchstart touchmove touchend touchcancel";
        d(W, E, {
            handler: function (e) {
                var t = Ze[e.type],
                    i = q.call(this, e, t);
                i && this.callback(this.manager, t, {
                    pointers: i[0],
                    changedPointers: i[1],
                    pointerType: "touch",
                    srcEvent: e
                })
            }
        });
        var tt = 2500,
            it = 25;
        d(X, E, {
            handler: function (e, t, i) {
                var n = "touch" == i.pointerType,
                    r = "mouse" == i.pointerType;
                if (!(r && i.sourceCapabilities && i.sourceCapabilities.firesTouchEvents)) {
                    if (n) Y.call(this, t, i);
                    else if (r && $.call(this, i)) return;
                    this.callback(e, t, i)
                }
            },
            destroy: function () {
                this.touch.destroy(), this.mouse.destroy()
            }
        });
        var nt = T(ge.style, "touchAction"),
            rt = nt !== s,
            at = "auto",
            ot = "manipulation",
            st = "none",
            ut = "pan-x",
            lt = "pan-y",
            ct = function () {
                if (!rt) return !1;
                var e = {},
                    t = r.CSS && r.CSS.supports;
                return ["auto", "manipulation", "pan-y", "pan-x", "pan-x pan-y", "none"].forEach(function (i) {
                    e[i] = !t || r.CSS.supports("touch-action", i)
                }), e
            }();
        Q.prototype = {
            set: function (e) {
                "compute" == e && (e = this.compute()), rt && this.manager.element.style && ct[e] && (this.manager.element.style[nt] = e), this.actions = e.toLowerCase().trim()
            },
            update: function () {
                this.set(this.manager.options.touchAction)
            },
            compute: function () {
                var e = [];
                return c(this.manager.recognizers, function (t) {
                    p(t.options.enable, [t]) && (e = e.concat(t.getTouchAction()))
                }), J(e.join(" "))
            },
            preventDefaults: function (e) {
                var t = e.srcEvent,
                    i = e.offsetDirection;
                if (this.manager.session.prevented) return void t.preventDefault();
                var n = this.actions,
                    r = b(n, st) && !ct[st],
                    a = b(n, lt) && !ct[lt],
                    o = b(n, ut) && !ct[ut];
                if (r) {
                    var s = 1 === e.pointers.length,
                        u = e.distance < 2,
                        l = e.deltaTime < 250;
                    if (s && u && l) return
                }
                return o && a ? void 0 : r || a && i & Ve || o && i & Be ? this.preventSrc(t) : void 0
            },
            preventSrc: function (e) {
                this.manager.session.prevented = !0, e.preventDefault()
            }
        };
        var ht = 1,
            dt = 2,
            ft = 4,
            pt = 8,
            mt = pt,
            gt = 16;
        Z.prototype = {
            defaults: {},
            set: function (e) {
                return pe(this.options, e), this.manager && this.manager.touchAction.update(), this
            },
            recognizeWith: function (e) {
                if (l(e, "recognizeWith", this)) return this;
                var t = this.simultaneous;
                return e = ie(e, this), t[e.id] || (t[e.id] = e, e.recognizeWith(this)), this
            },
            dropRecognizeWith: function (e) {
                return l(e, "dropRecognizeWith", this) ? this : (e = ie(e, this), delete this.simultaneous[e.id], this)
            },
            requireFailure: function (e) {
                if (l(e, "requireFailure", this)) return this;
                var t = this.requireFail;
                return e = ie(e, this), -1 === x(t, e) && (t.push(e), e.requireFailure(this)), this
            },
            dropRequireFailure: function (e) {
                if (l(e, "dropRequireFailure", this)) return this;
                e = ie(e, this);
                var t = x(this.requireFail, e);
                return t > -1 && this.requireFail.splice(t, 1), this
            },
            hasRequireFailures: function () {
                return this.requireFail.length > 0
            },
            canRecognizeWith: function (e) {
                return !!this.simultaneous[e.id]
            },
            emit: function (e) {
                function t(t) {
                    i.manager.emit(t, e)
                }
                var i = this,
                    n = this.state;
                n < pt && t(i.options.event + ee(n)), t(i.options.event), e.additionalEvent && t(e.additionalEvent), n >= pt && t(i.options.event + ee(n))
            },
            tryEmit: function (e) {
                if (this.canEmit()) return this.emit(e);
                this.state = 32
            },
            canEmit: function () {
                for (var e = 0; e < this.requireFail.length;) {
                    if (!(this.requireFail[e].state & (32 | ht))) return !1;
                    e++
                }
                return !0
            },
            recognize: function (e) {
                var t = pe({}, e);
                if (!p(this.options.enable, [this, t])) return this.reset(), void(this.state = 32);
                this.state & (mt | gt | 32) && (this.state = ht), this.state = this.process(t), this.state & (dt | ft | pt | gt) && this.tryEmit(t)
            },
            process: function (e) {},
            getTouchAction: function () {},
            reset: function () {}
        }, d(ne, Z, {
            defaults: {
                pointers: 1
            },
            attrTest: function (e) {
                var t = this.options.pointers;
                return 0 === t || e.pointers.length === t
            },
            process: function (e) {
                var t = this.state,
                    i = e.eventType,
                    n = t & (dt | ft),
                    r = this.attrTest(e);
                return n && (i & Ie || !r) ? t | gt : n || r ? i & Oe ? t | pt : t & dt ? t | ft : dt : 32
            }
        }), d(re, ne, {
            defaults: {
                event: "pan",
                threshold: 10,
                pointers: 1,
                direction: Ue
            },
            getTouchAction: function () {
                var e = this.options.direction,
                    t = [];
                return e & Ve && t.push(lt), e & Be && t.push(ut), t
            },
            directionTest: function (e) {
                var t = this.options,
                    i = !0,
                    n = e.distance,
                    r = e.direction,
                    a = e.deltaX,
                    o = e.deltaY;
                return r & t.direction || (t.direction & Ve ? (r = 0 === a ? Fe : a < 0 ? Ne : De, i = a != this.pX, n = Math.abs(e.deltaX)) : (r = 0 === o ? Fe : o < 0 ? Le : ke, i = o != this.pY, n = Math.abs(e.deltaY))), e.direction = r, i && n > t.threshold && r & t.direction
            },
            attrTest: function (e) {
                return ne.prototype.attrTest.call(this, e) && (this.state & dt || !(this.state & dt) && this.directionTest(e))
            },
            emit: function (e) {
                this.pX = e.deltaX, this.pY = e.deltaY;
                var t = te(e.direction);
                t && (e.additionalEvent = this.options.event + t), this._super.emit.call(this, e)
            }
        }), d(ae, ne, {
            defaults: {
                event: "pinch",
                threshold: 0,
                pointers: 2
            },
            getTouchAction: function () {
                return [st]
            },
            attrTest: function (e) {
                return this._super.attrTest.call(this, e) && (Math.abs(e.scale - 1) > this.options.threshold || this.state & dt)
            },
            emit: function (e) {
                if (1 !== e.scale) {
                    var t = e.scale < 1 ? "in" : "out";
                    e.additionalEvent = this.options.event + t
                }
                this._super.emit.call(this, e)
            }
        }), d(oe, Z, {
            defaults: {
                event: "press",
                pointers: 1,
                time: 251,
                threshold: 9
            },
            getTouchAction: function () {
                return [at]
            },
            process: function (e) {
                var t = this.options,
                    i = e.pointers.length === t.pointers,
                    n = e.distance < t.threshold,
                    r = e.deltaTime > t.time;
                if (this._input = e, !n || !i || e.eventType & (Oe | Ie) && !r) this.reset();
                else if (e.eventType & Pe) this.reset(), this._timer = u(function () {
                    this.state = mt, this.tryEmit()
                }, t.time, this);
                else if (e.eventType & Oe) return mt;
                return 32
            },
            reset: function () {
                clearTimeout(this._timer)
            },
            emit: function (e) {
                this.state === mt && (e && e.eventType & Oe ? this.manager.emit(this.options.event + "up", e) : (this._input.timeStamp = Se(), this.manager.emit(this.options.event, this._input)))
            }
        }), d(se, ne, {
            defaults: {
                event: "rotate",
                threshold: 0,
                pointers: 2
            },
            getTouchAction: function () {
                return [st]
            },
            attrTest: function (e) {
                return this._super.attrTest.call(this, e) && (Math.abs(e.rotation) > this.options.threshold || this.state & dt)
            }
        }), d(ue, ne, {
            defaults: {
                event: "swipe",
                threshold: 10,
                velocity: .3,
                direction: Ve | Be,
                pointers: 1
            },
            getTouchAction: function () {
                return re.prototype.getTouchAction.call(this)
            },
            attrTest: function (e) {
                var t, i = this.options.direction;
                return i & (Ve | Be) ? t = e.overallVelocity : i & Ve ? t = e.overallVelocityX : i & Be && (t = e.overallVelocityY), this._super.attrTest.call(this, e) && i & e.offsetDirection && e.distance > this.options.threshold && e.maxPointers == this.options.pointers && be(t) > this.options.velocity && e.eventType & Oe
            },
            emit: function (e) {
                var t = te(e.offsetDirection);
                t && this.manager.emit(this.options.event + t, e), this.manager.emit(this.options.event, e)
            }
        }), d(le, Z, {
            defaults: {
                event: "tap",
                pointers: 1,
                taps: 1,
                interval: 300,
                time: 250,
                threshold: 9,
                posThreshold: 10
            },
            getTouchAction: function () {
                return [ot]
            },
            process: function (e) {
                var t = this.options,
                    i = e.pointers.length === t.pointers,
                    n = e.distance < t.threshold,
                    r = e.deltaTime < t.time;
                if (this.reset(), e.eventType & Pe && 0 === this.count) return this.failTimeout();
                if (n && r && i) {
                    if (e.eventType != Oe) return this.failTimeout();
                    var a = !this.pTime || e.timeStamp - this.pTime < t.interval,
                        o = !this.pCenter || k(this.pCenter, e.center) < t.posThreshold;
                    this.pTime = e.timeStamp, this.pCenter = e.center, o && a ? this.count += 1 : this.count = 1, this._input = e;
                    if (0 === this.count % t.taps) return this.hasRequireFailures() ? (this._timer = u(function () {
                        this.state = mt, this.tryEmit()
                    }, t.interval, this), dt) : mt
                }
                return 32
            },
            failTimeout: function () {
                return this._timer = u(function () {
                    this.state = 32
                }, this.options.interval, this), 32
            },
            reset: function () {
                clearTimeout(this._timer)
            },
            emit: function () {
                this.state == mt && (this._input.tapCount = this.count, this.manager.emit(this.options.event, this._input))
            }
        }), ce.VERSION = "2.0.7", ce.defaults = {
            domEvents: !1,
            touchAction: "compute",
            enable: !0,
            inputTarget: null,
            inputClass: null,
            preset: [
                [se, {
                    enable: !1
                }],
                [ae, {
                        enable: !1
                    },
                    ["rotate"]
                ],
                [ue, {
                    direction: Ve
                }],
                [re, {
                        direction: Ve
                    },
                    ["swipe"]
                ],
                [le],
                [le, {
                        event: "doubletap",
                        taps: 2
                    },
                    ["tap"]
                ],
                [oe]
            ],
            cssProps: {
                userSelect: "none",
                touchSelect: "none",
                touchCallout: "none",
                contentZooming: "none",
                userDrag: "none",
                tapHighlightColor: "rgba(0,0,0,0)"
            }
        };
        he.prototype = {
            set: function (e) {
                return pe(this.options, e), e.touchAction && this.touchAction.update(), e.inputTarget && (this.input.destroy(), this.input.target = e.inputTarget, this.input.init()), this
            },
            stop: function (e) {
                this.session.stopped = e ? 2 : 1
            },
            recognize: function (e) {
                var t = this.session;
                if (!t.stopped) {
                    this.touchAction.preventDefaults(e);
                    var i, n = this.recognizers,
                        r = t.curRecognizer;
                    (!r || r && r.state & mt) && (r = t.curRecognizer = null);
                    for (var a = 0; a < n.length;) i = n[a], 2 === t.stopped || r && i != r && !i.canRecognizeWith(r) ? i.reset() : i.recognize(e), !r && i.state & (dt | ft | pt) && (r = t.curRecognizer = i), a++
                }
            },
            get: function (e) {
                if (e instanceof Z) return e;
                for (var t = this.recognizers, i = 0; i < t.length; i++)
                    if (t[i].options.event == e) return t[i];
                return null
            },
            add: function (e) {
                if (l(e, "add", this)) return this;
                var t = this.get(e.options.event);
                return t && this.remove(t), this.recognizers.push(e), e.manager = this, this.touchAction.update(), e
            },
            remove: function (e) {
                if (l(e, "remove", this)) return this;
                if (e = this.get(e)) {
                    var t = this.recognizers,
                        i = x(t, e); - 1 !== i && (t.splice(i, 1), this.touchAction.update())
                }
                return this
            },
            on: function (e, t) {
                if (e !== s && t !== s) {
                    var i = this.handlers;
                    return c(S(e), function (e) {
                        i[e] = i[e] || [], i[e].push(t)
                    }), this
                }
            },
            off: function (e, t) {
                if (e !== s) {
                    var i = this.handlers;
                    return c(S(e), function (e) {
                        t ? i[e] && i[e].splice(x(i[e], t), 1) : delete i[e]
                    }), this
                }
            },
            emit: function (e, t) {
                this.options.domEvents && fe(e, t);
                var i = this.handlers[e] && this.handlers[e].slice();
                if (i && i.length) {
                    t.type = e, t.preventDefault = function () {
                        t.srcEvent.preventDefault()
                    };
                    for (var n = 0; n < i.length;) i[n](t), n++
                }
            },
            destroy: function () {
                this.element && de(this, !1), this.handlers = {}, this.session = {}, this.input.destroy(), this.element = null
            }
        }, pe(ce, {
            INPUT_START: Pe,
            INPUT_MOVE: Re,
            INPUT_END: Oe,
            INPUT_CANCEL: Ie,
            STATE_POSSIBLE: ht,
            STATE_BEGAN: dt,
            STATE_CHANGED: ft,
            STATE_ENDED: pt,
            STATE_RECOGNIZED: mt,
            STATE_CANCELLED: gt,
            STATE_FAILED: 32,
            DIRECTION_NONE: Fe,
            DIRECTION_LEFT: Ne,
            DIRECTION_RIGHT: De,
            DIRECTION_UP: Le,
            DIRECTION_DOWN: ke,
            DIRECTION_HORIZONTAL: Ve,
            DIRECTION_VERTICAL: Be,
            DIRECTION_ALL: Ue,
            Manager: he,
            Input: E,
            TouchAction: Q,
            TouchInput: W,
            MouseInput: G,
            PointerEventInput: j,
            TouchMouseInput: X,
            SingleTouchInput: z,
            Recognizer: Z,
            AttrRecognizer: ne,
            Tap: le,
            Pan: re,
            Swipe: ue,
            Pinch: ae,
            Rotate: se,
            Press: oe,
            on: g,
            off: v,
            each: c,
            merge: ye,
            extend: xe,
            assign: pe,
            inherit: d,
            bindFn: f,
            prefixed: T
        }), (void 0 !== r ? r : "undefined" != typeof self ? self : {}).Hammer = ce, (n = function () {
            return ce
        }.call(t, i, t, e)) !== s && (e.exports = n)
    }(window, document)
}, function (e, t, i) {
    "use strict";
    var n = i(366),
        r = i(12),
        a = i(446),
        o = i(880),
        s = i(114),
        u = function (e) {
            n.a.call(this, e), this._zoomFactor = 1, this.init()
        };
    r.a.createPrototypeObject(u, r.a.objectInherit(n.a.prototype, {
        init: function () {
            this._mode = void 0, this._inMotion = !1, this._initInputs(s.a.ORBIT_MANIPULATOR_MOUSEKEYBOARD, s.a.ORBIT_MANIPULATOR_RESETTOHOME)
        },
        _initInputs: function (e, t) {
            var i = this._manipulator.getInputManager(),
                n = this.setMode.bind(this, o.a.ROTATE, this._manipulator.getRotateInterpolator()),
                r = this.setMode.bind(this, o.a.PAN, this._manipulator.getPanInterpolator()),
                a = this.setMode.bind(this, o.a.ZOOM, this._manipulator.getZoomInterpolator());
            i.group(e).addMappings({
                move: "mousemove",
                startPan: ["mousedown shift 0", "mousedown 1", "mousedown 2"],
                startZoom: ["mousedown ctrl 0", "mousedown ctrl 2"],
                startRotate: "mousedown 0 !shift !ctrl",
                stopMotion: ["mouseup", "mouseout", "keyup a", "keyup s", "keyup d"],
                zoom: "wheel"
            }, this), i.group(t).addMappings({
                reset: "keydown space"
            }, this), i.group(e).addMappings({
                setRotationMode: "keydown a"
            }, n), i.group(e).addMappings({
                setPanMode: "keydown d"
            }, r), i.group(e).addMappings({
                setZoomMode: "keydown s"
            }, a)
        },
        getMode: function () {
            return this._mode
        },
        setMode: function (e, t) {
            this.getMode() !== e && (this._mode = e, t.reset(), this._inMotion = !0)
        },
        setManipulator: function (e) {
            this._manipulator = e
        },
        getZoomFactor: function () {
            return this._zoomFactor
        },
        setZoomFactor: function (e) {
            this._zoomFactor = e
        },
        move: function (e) {
            if (!1 !== this._inMotion) {
                var t = e.canvasX,
                    i = -e.canvasY,
                    n = this._manipulator;
                if (!1 === a.a.isNaN(t) && !1 === a.a.isNaN(i)) {
                    var r = this.getMode();
                    if (r === o.a.ROTATE) n.getRotateInterpolator().setTarget(t, i);
                    else if (r === o.a.PAN) n.getPanInterpolator().setTarget(t, i);
                    else if (r === o.a.ZOOM) {
                        var s = n.getZoomInterpolator();
                        s.isReset() && (s.setStart(i), s.set(0));
                        var u = i - s.getStart();
                        s.setStart(i);
                        var l = s.getTarget()[0];
                        s.setTarget(l - u / 20)
                    }
                }
            }
        },
        startPan: function (e) {
            var t = this._manipulator.getPanInterpolator();
            this.setMode(o.a.PAN, t), t.reset(), t.set(e.canvasX, -e.canvasY)
        },
        startRotate: function (e) {
            var t = this._manipulator.getRotateInterpolator();
            this.setMode(o.a.ROTATE, t), t.reset(), t.set(e.canvasX, -e.canvasY)
        },
        startZoom: function (e) {
            var t = this._manipulator.getZoomInterpolator();
            this.setMode(o.a.ZOOM, t), t.setStart(-e.canvasY), t.set(0)
        },
        stopMotion: function () {
            this._inMotion = !1, this._mode = void 0
        },
        zoom: function (e) {
            var t = e.deltaY / this._zoomFactor,
                i = this._manipulator,
                n = i.getZoomInterpolator().getTarget()[0] - t;
            i.getZoomInterpolator().setTarget(n)
        },
        reset: function () {
            this._manipulator.computeHomePosition()
        }
    })), t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(366),
        r = i(12),
        a = i(10),
        o = i(114),
        s = Math.PI / 180,
        u = function (e, t, i, n, r) {
            var a = Math.cos(t / 2),
                o = Math.cos(i / 2),
                s = Math.cos(n / 2),
                u = Math.sin(t / 2),
                l = Math.sin(i / 2),
                c = Math.sin(n / 2);
            return "XYZ" === r ? (e[0] = u * o * s + a * l * c, e[1] = a * l * s - u * o * c, e[2] = a * o * c + u * l * s, e[3] = a * o * s - u * l * c) : "YXZ" === r ? (e[0] = u * o * s + a * l * c, e[1] = a * l * s - u * o * c, e[2] = a * o * c - u * l * s, e[3] = a * o * s + u * l * c) : "ZXY" === r ? (e[0] = u * o * s - a * l * c, e[1] = a * l * s + u * o * c, e[2] = a * o * c + u * l * s, e[3] = a * o * s - u * l * c) : "ZYX" === r ? (e[0] = u * o * s - a * l * c, e[1] = a * l * s + u * o * c, e[2] = a * o * c - u * l * s, e[3] = a * o * s + u * l * c) : "YZX" === r ? (e[0] = u * o * s + a * l * c, e[1] = a * l * s + u * o * c, e[2] = a * o * c - u * l * s, e[3] = a * o * s - u * l * c) : "XZY" === r && (e[0] = u * o * s - a * l * c, e[1] = a * l * s - u * o * c, e[2] = a * o * c + u * l * s, e[3] = a * o * s + u * l * c), e
        },
        l = function (e) {
            n.a.call(this, e), this.init()
        };
    l.computeQuaternion = function () {
        var e = a.d.create(),
            t = a.d.fromValues(-Math.sqrt(.5), 0, 0, Math.sqrt(.5));
        return function (i, n, r) {
            var o = n.alpha * s,
                l = n.beta * s,
                c = n.gamma * s,
                h = r * s;
            u(i, l, o, -c, "YXZ");
            var d = -h / 2;
            e[1] = Math.sin(d), e[3] = Math.cos(d), a.d.mul(i, i, e), a.d.mul(i, i, t);
            var f = i[1];
            return i[1] = -i[2], i[2] = f, i
        }
    }(), r.a.createPrototypeObject(l, r.a.objectInherit(n.a.prototype, {
        init: function () {
            this._quat = a.d.create(), this._pos = a.f.create(), this._deviceOrientation = void 0, this._screenOrientation = void 0;
            var e = this._manipulator.getInputManager();
            e.group(o.a.FPS_MANIPULATOR_DEVICEORIENTATION).addMappings({
                setDeviceOrientation: "deviceorientation",
                setScreenOrientation: "orientationchange"
            }, this), e.setEnable(o.a.FPS_MANIPULATOR_DEVICEORIENTATION, !1)
        },
        setDeviceOrientation: function (e) {
            if (this._deviceOrientation || (this._deviceOrientation = {}), this._deviceOrientation.alpha = e.alpha, this._deviceOrientation.beta = e.beta, this._deviceOrientation.gamma = e.gamma, e.screenOrientation) return void this.setScreenOrientation(e);
            this._update()
        },
        setScreenOrientation: function (e) {
            this._screenOrientation = e.screenOrientation, this._update()
        },
        _update: function () {
            this._deviceOrientation && this._screenOrientation && (l.computeQuaternion(this._quat, this._deviceOrientation, this._screenOrientation), this._manipulator.setPoseVR(this._quat, this._pos))
        }
    })), t.a = l
}, function (e, t, i) {
    "use strict";
    var n, r = i(1108),
        a = i(890),
        o = i(36),
        s = function () {
            try {
                n = i(3)
            } catch (e) {
                o.a.warn("You will not be able to use osgUtil.DisplayGraph until you add jQuery in your page")
            }
        },
        u = function (e) {
            this.options = e;
            var t = document.createElement("style");
            t.type = "text/css", t.innerHTML = [".osgDebugSimpleTooltip {", "display: none;", "position: absolute;", "margin-left: 10px;", "border-radius: 4px;", "padding: 10px;", "background: rgba(0,0,0,.9);", "color: #ffffff;", "}", ".osgDebugSimpleTooltip:before {", "content: ", ";", "position: absolute;", "left: -10px;", "top: 8px;", "border: 10px solid transparent;", "border-width: 10px 10px 10px 0;", "border-right-color: rgba(0,0,0,.9);", "}"].join("\n"), document.getElementsByTagName("head")[0].appendChild(t), this.el = document.createElement("div"), this.el.className = "osgDebugSimpleTooltip", document.body.appendChild(this.el);
            for (var i = document.querySelectorAll(this.options.selector), n = 0; n < i.length; n++) i[n].addEventListener("mouseover", this.showTooltip.bind(this), !1), i[n].addEventListener("mouseout", this.hideTooltip.bind(this), !1)
        };
    u.prototype = {
        showTooltip: function (e) {
            if (n) {
                var t = e.currentTarget;
                this.el.innerHTML = t.getAttribute("title"), this.el.style.display = "block", this.el.style.left = n(t).position().left + n(t).get(0).getBoundingClientRect().width + "px", this.el.style.top = n(t).position().top + "px"
            }
        },
        hideTooltip: function () {
            this.el.style.display = "none"
        }
    };
    var l = function () {
        s(), n && (this._selectables = new window.Map, this._graphNode = new a.a(this._selectables), this._graphRender = new r.a(this._selectables), this._displayNode = !0, this._displayRenderer = !1, this._cbSelect = void 0, this._focusedElement = "graph", this._idToDomElement = new window.Map, this._$svg = n("<svg width=100% height=100%></svg>"), n("body").append(this._$svg), this._css = ".node {text-align: center;cursor: pointer;}.node rect {stroke: #FFF;}.edgePath path {stroke: #FFF;fill: none;}table {text-align: right;}svg {position: absolute;left: 0px;top: 0px;}.osgDebugButton {position: absolute;left: 15px;top: 15px;z-index: 5;border: 0;background: #65a9d7;background: -webkit-gradient(linear, left top, left bottom, from(#3e779d), to(#65a9d7));background: -webkit-linear-gradient(top, #3e779d, #65a9d7);background: -moz-linear-gradient(top, #3e779d, #65a9d7);background: -ms-linear-gradient(top, #3e779d, #65a9d7);background: -o-linear-gradient(top, #3e779d, #65a9d7);padding: 5px 10px;-webkit-border-radius: 7px;-moz-border-radius: 7px;border-radius: 7px;-webkit-box-shadow: rgba(0,0,0,1) 0 1px 0;-moz-box-shadow: rgba(0,0,0,1) 0 1px 0;box-shadow: rgba(0,0,0,1) 0 1px 0;text-shadow: rgba(0,0,0,.4) 0 1px 0;color: white;font-size: 15px;font-family: Helvetica, Arial, Sans-Serif;text-decoration: none;vertical-align: middle;}.osgDebugButton:hover {border-top-color: #28597a;background: #28597a;color: #ccc;}.osgDebugButton:active {border-top-color: #1b435e;background: #1b435e;}.osgDebugSimpleTooltip .osgDebugName {font-weight: bold;color: #60b1fc;margin: 0;}.osgDebugSimpleTooltip .osgDebugDescription {margin: 0;}")
    };
    l.instance = function () {
        return l._instance || (l._instance = new l), l._instance
    }, l.prototype = {
        getColorFromClassName: a.a.prototype.getColorFromClassName,
        setCallbackSelect: function (e) {
            this._cbSelect = e
        },
        reset: function () {
            n && (this._selectables.clear(), this._$svg.empty(), this._focusedElement = "scene", n(".osgDebugButton").hide())
        },
        setDisplayGraphRenderer: function (e) {
            this._displayRenderer = e
        },
        createRenderGraph: function (e) {
            this._graphRender.createGraph(e), this.displayGraph()
        },
        createGraph: function (e) {
            n && (this.reset(), this._displayNode = !!e, e && this._graphNode.createGraph(e), this._displayRenderer ? i(696).default.debugGraph = !0 : this.displayGraph())
        },
        displayGraph: function () {
            if (n) {
                if (window.d3 && window.dagreD3) return void this._createGraphApply();
                var e = this._createGraphApply.bind(this);
                n.getScript("//cdnjs.cloudflare.com/ajax/libs/d3/3.4.13/d3.min.js").done(function () {
                    n.getScript("//cdn.jsdelivr.net/dagre-d3/0.2.9/dagre-d3.min.js").done(e)
                })
            }
        },
        _createGraphApply: function () {
            var e = new window.dagreD3.Digraph;
            this._displayNode && this._graphNode.generateNodeAndLink(e), this._displayRenderer && this._graphRender.generateNodeAndLink(e), this.injectStyleElement(), n(".osgDebugButton").show();
            var t = this.renderer = new window.dagreD3.Renderer,
                i = window.d3.select(this._$svg.get(0)),
                r = i.append("g"),
                a = t.zoom();
            t.zoom(function (e, t) {
                var i = a(e, t);
                return i.scale(.75).event(t), i
            });
            var o = function (e, t) {
                    return '<p class="osgDebugName">' + e + '</p><pre class="osgDebugDescription">' + t + "</pre>"
                },
                s = this._idToDomElement,
                l = t.drawNodes();
            t.drawNodes(function (e, t) {
                var i = l(e, t);
                return i.attr("title", function (t) {
                    return s.set(t, this), o(t, e.node(t).description || "")
                }), i
            }), t.run(e, r), this.tooltip = new u({
                selector: ".node"
            }), n(".node").click(this.onNodeSelect.bind(this)), this.focusOnGraph()
        },
        selectNode: function (e) {
            var t = e.getInstanceID(),
                i = this._idToDomElement.get(t);
            i && n(i).click()
        },
        onNodeSelect: function (e) {
            var t = e.currentTarget,
                i = n(t.getAttribute("title"))[0].innerHTML,
                r = this._selectables;
            this.lastNode && (this.lastNode.style.fill = this.lastColor);
            var a = r.get(i);
            a && (this.lastNode = t.childNodes[0], this.lastColor = this.lastNode.style.fill, t.childNodes[0].style.fill = "#f00", window.activeNode = a, o.a.info("window.activeNode is set with the node below !"), o.a.log(window.activeNode), o.a.log("\n"), this._cbSelect && this._cbSelect(a))
        },
        focusOnScene: function () {
            n(".osgDebugButton").text("Access to the graph"), this._$svg.css("zIndex", "-2"), this._focusedElement = "scene"
        },
        focusOnGraph: function () {
            n(".osgDebugButton").text("Access to the scene"), this._$svg.css("zIndex", "2"), n(".osgDebugSimpleTooltip").css("zIndex", "3"), this._focusedElement = "graph"
        },
        injectStyleElement: function () {
            if (!this._cssInjected) {
                this._cssInjected = !0, n("body").append('<button class="osgDebugButton">Access to the scene</button>'), n(".osgDebugButton").click(function () {
                    "scene" === this._focusedElement ? this.focusOnGraph() : this.focusOnScene()
                }.bind(this));
                var e = document.createElement("style");
                e.type = "text/css", e.innerHTML = this._css, document.getElementsByTagName("head")[0].appendChild(e)
            }
        }
    }, t.a = l
}, function (e, t, i) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: !0
    });
    var n = i(12),
        r = i(573),
        a = i(574),
        o = i(102),
        s = i(616),
        u = i(861),
        l = i(615),
        c = i(10),
        h = i(891),
        d = i(695),
        f = function (e) {
            o.a.call(this), this._state = void 0, this._camera = e, this._renderStage = void 0, this._stateGraph = void 0, this._frameStamp = void 0, this._previousCullsettings = new r.a, this.setDefaults()
        };
    f.debugGraph = !1, n.a.createPrototypeObject(f, n.a.objectInherit(o.a.prototype, {
        setDefaults: function () {
            this._state = new u.a(new h.a.ShaderGeneratorProxy), this._cullVisitor = new a.a, this._cullVisitor.setRenderer(this), this._stateGraph = new l.a, this.getCamera().setClearColor(c.g.create()), this.setRenderStage(new s.a);
            var e = i(843).default,
                t = this.getCamera().getOrCreateStateSet();
            t.setAttributeAndModes(new e.Material), t.setAttributeAndModes(new e.Depth), t.setAttributeAndModes(new e.BlendFunc), t.setAttributeAndModes(new e.CullFace)
        },
        getCullVisitor: function () {
            return this._cullVisitor
        },
        setCullVisitor: function (e) {
            e && !e.getRenderer() && e.setRenderer(this), this._cullVisitor = e
        },
        setRenderStage: function (e) {
            this._renderStage = e
        },
        getCamera: function () {
            return this._camera
        },
        setFrameStamp: function (e) {
            this._frameStamp = e
        },
        getFrameStamp: function () {
            return this._frameStamp
        },
        getState: function () {
            return this._state
        },
        setState: function (e) {
            this._state = e
        },
        setGraphicContext: function (e) {
            this._state.setGraphicContext(e)
        },
        getGraphicContext: function () {
            return this._state.getGraphicContext()
        },
        cullAndDraw: function () {
            this.cull(), this.draw()
        },
        cull: function () {
            var e = this.getCamera(),
                t = e.getView();
            this._cullVisitor.setFrameStamp(this._frameStamp), this._cullVisitor.resetStats(), l.a.reset(), this._stateGraph.clean(), this._renderStage.reset(), this._cullVisitor.reset(), this._cullVisitor.setStateGraph(this._stateGraph), this._cullVisitor.setRenderStage(this._renderStage), this._cullVisitor.pushStateSet(e.getStateSet()), this._previousCullsettings.reset(), this._previousCullsettings.setCullSettings(this._cullVisitor), this._cullVisitor.setCullSettings(e), this._previousCullsettings.getSettingSourceOverrider() === this._cullVisitor && this._previousCullsettings.getEnableFrustumCulling() && this._cullVisitor.setEnableFrustumCulling(!0), this._cullVisitor.pushCameraModelViewProjectionMatrix(e, e.getViewMatrix(), e.getProjectionMatrix()), e.getBound();
            var n = t.getLight(),
                r = i(697).default;
            if (n) switch (t.getLightingMode()) {
                case r.LightingMode.HEADLIGHT:
                    this._cullVisitor.addPositionedAttribute(null, n);
                    break;
                case r.LightingMode.SKY_LIGHT:
                    this._cullVisitor.addPositionedAttribute(e.getViewMatrix(), n)
            }
            var a = e.getViewport(),
                o = e.getScissor();
            this._cullVisitor.pushViewport(a), this._renderStage.setClearDepth(e.getClearDepth()), this._renderStage.setClearColor(e.getClearColor()), this._renderStage.setClearMask(e.getClearMask()), this._renderStage.setViewport(a), this._renderStage.setScissor(o), this._cullVisitor.setDatabaseRequestHandler(this._camera.getView().getDatabasePager()), this._cullVisitor.handleCullCallbacksAndTraverse(e), this._cullVisitor.popCameraModelViewProjectionMatrix(e), this._cullVisitor.setCullSettings(this._previousCullsettings), this._cullVisitor.popViewport(), this._cullVisitor.popStateSet(), this._renderStage.sort()
        },
        draw: function () {
            var e = this.getState();
            e.resetCacheFrame(), e.resetStats(), this._renderStage.setCamera(this._camera), this._renderStage.draw(e), f.debugGraph && (d.a.instance().createRenderGraph(this._renderStage), f.debugGraph = !1), this._renderStage.setCamera(void 0), e.applyDefault()
        }
    }), "osgViewer", "Renderer"), t.default = f
}, function (e, t, i) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: !0
    });
    var n = i(178),
        r = i(197),
        a = i(857),
        o = i(363),
        s = i(619),
        u = i(10),
        l = i(118),
        c = i(292),
        h = i(320),
        d = i(688),
        f = i(421),
        p = i(613),
        m = i(319),
        g = i(579),
        v = i(580),
        _ = i(696),
        b = i(893),
        S = i(695),
        x = i(36),
        y = function () {
            this._camera = new r.a, this._camera.setName("OSGJS camera"), this._scene = new b.a, this._camera.setName("OSGJS Scene"), this._frameStamp = new a.a, this._lightingMode = void 0, this._manipulator = void 0, this._canvasWidth = 0, this._canvasHeight = 0, this._requestContinousUpdate = !0, this._requestRedraw = !0, this.setLightingMode(y.LightingMode.HEADLIGHT);
            var e = this.createRenderer(this.getCamera());
            e.setFrameStamp(this._frameStamp), this.getCamera().setRenderer(e), this.getCamera().setView(this)
        };
    y.LightingMode = {
        NO_LIGHT: 0,
        HEADLIGHT: 1,
        SKY_LIGHT: 2
    }, y.prototype = {
        requestRedraw: function () {
            this._requestRedraw = !0
        },
        requestContinuousUpdate: function (e) {
            this._requestContinousUpdate = e
        },
        createRenderer: function (e) {
            return new _.default(e)
        },
        setGraphicContext: function (e) {
            this.getCamera().getRenderer().getState().setGraphicContext(e)
        },
        getGraphicContext: function () {
            return this.getCamera().getRenderer().getState().getGraphicContext()
        },
        initWebGLCaps: function (e, t) {
            m.a.instance(e, t)
        },
        computeCanvasSize: function () {
            var e, t, i;
            return function (n) {
                i || (window.ResizeObserver ? (i = new ResizeObserver(function () {
                    e = n.clientWidth, t = n.clientHeight
                }), i.observe(n), e = n.clientWidth, t = n.clientHeight) : (e = n.clientWidth, t = n.clientHeight)), e < 1 && (e = 1), t < 1 && (t = 1);
                var r = this._devicePixelRatio,
                    a = Math.floor(e * r),
                    o = Math.floor(t * r),
                    s = !1;
                return this._canvasWidth !== a && (n.width = a, this._canvasWidth = a, s = !0), this._canvasHeight !== o && (n.height = o, this._canvasHeight = o, s = !0), s
            }
        }(),
        getCanvasWidth: function () {
            return this._canvasWidth
        },
        getCanvasHeight: function () {
            return this._canvasHeight
        },
        getCanvasClientWidth: function () {
            return Math.ceil(this._canvasWidth / this._devicePixelRatio)
        },
        getCanvasClientHeight: function () {
            return Math.ceil(this._canvasHeight / this._devicePixelRatio)
        },
        getCanvasPixelRatio: function () {
            return this._devicePixelRatio
        },
        setUpView: function (e, t) {
            var i = window.devicePixelRatio || 1,
                n = t.getNumber("overrideDevicePixelRatio"),
                r = t.getNumber("maxDevicePixelRatio") || -1;
            "number" == typeof n ? i = n : -1 !== r && (i = Math.min(i, r)), this._devicePixelRatio = i, this.computeCanvasSize(e);
            var a = e.width,
                o = e.height,
                s = a / o;
            if (this._camera.setViewport(new f.a(0, 0, a, o)), this._camera.setScissor(new d.a), this._camera.setGraphicContext(this.getGraphicContext()), u.c.lookAt(this._camera.getViewMatrix(), u.f.fromValues(0, 0, -10), u.f.create(), u.f.fromValues(0, 1, 0)), u.c.perspective(this._camera.getProjectionMatrix(), Math.PI / 180 * 55, s, 1, 1e3), t && t.enableFrustumCulling && this.getCamera().getRenderer().getCullVisitor().setEnableFrustumCulling(!0), t && t.debugGraph) {
                var l = this.getCamera();
                S.a.instance().refreshGraph = function () {
                    var e = S.a.instance();
                    e.setDisplayGraphRenderer(!0), e.createGraph(l)
                }, x.a.log("to refresh the graphs type in the console:\nOSG.osgUtil.DisplayGraph.instance().refreshGraph()")
            }
        },
        computeIntersections: function (e, t, i) {
            return void 0 === i && (i = -1), this._lsi ? this._lsi.reset() : this._lsi = new v.a, this._origIntersect || (this._origIntersect = u.f.create(), this._dstIntersect = u.f.create()), this._lsi.set(u.f.set(this._origIntersect, e, t, 0), u.f.set(this._dstIntersect, e, t, 1)), this._iv ? this._iv.reset() : (this._iv = new g.a, this._iv.setIntersector(this._lsi)), this._iv.setTraversalMask(i), this._camera.accept(this._iv), this._lsi.getIntersections()
        },
        setFrameStamp: function (e) {
            this._frameStamp = e
        },
        getFrameStamp: function () {
            return this._frameStamp
        },
        setCamera: function (e) {
            this._camera = e
        },
        getCamera: function () {
            return this._camera
        },
        setSceneData: function (e) {
            if (e !== this._scene.getSceneData()) {
                this._scene.setSceneData(e);
                for (var t = this._camera.getChildren(), i = void 0, n = 0, r = t.length; n < r; n++)
                    if ("osgStats" === t[n].getName()) {
                        i = t[n];
                        break
                    } this._camera.removeChildren(), this._camera.addChild(e), i && this._camera.addChild(i)
            }
        },
        getSceneData: function () {
            return this._scene.getSceneData()
        },
        setDatabasePager: function (e) {
            this._scene.setDatabasePager(e)
        },
        getDatabasePager: function () {
            return this._scene.getDatabasePager()
        },
        getScene: function () {
            return this._scene
        },
        getManipulator: function () {
            return this._manipulator
        },
        setManipulator: function (e) {
            this._manipulator = e
        },
        getLight: function () {
            return this._light
        },
        setLight: function (e) {
            this._light = e, this._lightingMode !== y.LightingMode.NO_LIGHT && this._scene.getOrCreateStateSet().setAttributeAndModes(this._light)
        },
        getLightingMode: function () {
            return this._lightingMode
        },
        setLightingMode: function (e) {
            this._lightingMode !== e && (this._lightingMode = e, this._lightingMode !== y.LightingMode.NO_LIGHT ? this._light || (this._light = new s.a) : this._light = void 0)
        },
        flushDeletedGLObjects: function (e) {
            var t = this.getGraphicContext(),
                i = e;
            i = n.a.flushDeletedGLBufferArrays(t, i), i = p.a.flushDeletedGLVertexArrayObjects(t, i), i = l.default.getTextureManager(t).flushDeletedTextureObjects(t, i), i = c.a.flushDeletedGLPrograms(t, i), i = h.a.flushDeletedGLShaders(t, i), i = o.a.flushDeletedGLFrameBuffers(t, i), o.a.flushDeletedGLRenderBuffers(t, i)
        },
        flushAllDeletedGLObjects: function () {
            var e = this.getGraphicContext();
            p.a.flushAllDeletedGLVertexArrayObjects(e), n.a.flushAllDeletedGLBufferArrays(e), l.default.getTextureManager(e).flushAllDeletedTextureObjects(e), c.a.flushAllDeletedGLPrograms(e), h.a.flushAllDeletedGLShaders(e), o.a.flushAllDeletedGLFrameBuffers(e), o.a.flushAllDeletedGLRenderBuffers(e)
        }
    }, t.default = y
}, function (e, t, i) {
    "use strict";
    var n = function () {
        this._values = new Float32Array(n.maxGraphValue), this._index = 0, this._maxValue = 0, this._x = 0, this._y = 0
    };
    n.maxGraphValue = 120, n.prototype = {
        getIndex: function () {
            return this._index
        },
        getValues: function () {
            return this._values
        },
        setDisplayPosition: function (e, t) {
            this._x = e, this._y = t
        },
        getX: function () {
            return this._x
        },
        getY: function () {
            return this._y
        },
        addValue: function (e, t) {
            var i = this._index;
            this._maxValue = e > this._maxValue ? e : this._maxValue, this._maxValue *= .99, this._values[i] = e / (1.1 * this._maxValue), t && (this._values[i] += t), this._index = (this._index + 1) % n.maxGraphValue
        }
    }, t.a = n
}, function (e, t, i) {
    "use strict";
    var n = i(36),
        r = i(102),
        a = i(12),
        o = function () {
            r.a.call(this), this._shadowedScene = void 0, this._dirty = !1, this._continuousUpdate = !0, this._needRedraw = !0
        };
    a.a.createPrototypeObject(o, a.a.objectInherit(r.a.prototype, {
        dirty: function () {
            this._dirty = !0
        },
        getShadowedScene: function () {
            return this._shadowedScene
        },
        setContinuousUpdate: function (e) {
            this._continuousUpdate = e
        },
        isContinuousUpdate: function () {
            return this._continuousUpdate
        },
        needRedraw: function () {
            return this._needRedraw
        },
        requestRedraw: function () {
            this._needRedraw = !0
        },
        setShadowedScene: function (e) {
            this._shadowedScene = e
        },
        init: function () {
            n.a.log("No ShadowTechnique activated: normal rendering activated")
        },
        valid: function () {
            return !1
        },
        updateShadowTechnique: function () {},
        cullShadowCasting: function () {},
        cleanSceneGraph: function () {
            n.a.log("No ShadowTechnique activated: normal rendering activated")
        }
    }), "osgShadow", "ShadowTechnique"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(36),
        r = i(118),
        a = i(108),
        o = i(12),
        s = i(10),
        u = function () {
            r.default.call(this), this._uniforms = {}, this._mapSize = s.g.create(), this._renderSize = s.e.create(), this._lightNumber = -1, this._dirtyHash = !0, this._hash = ""
        };
    u.uniforms = {}, o.a.createPrototypeStateAttribute(u, o.a.objectInherit(r.default.prototype, {
        cloneType: function () {
            return new u
        },
        invalidate: function () {
            r.default.prototype.invalidate.call(this), this.dirty()
        },
        hasLightNumber: function (e) {
            return this._lightNumber === e
        },
        setLightNumber: function (e) {
            this._lightNumber = e, this._dirtyHash = !0
        },
        getLightNumber: function () {
            return this._lightNumber
        },
        getUniformName: function (e) {
            return "uShadow_" + this.getType() + this._lightNumber.toString() + "_" + e
        },
        setInternalFormatType: function (e) {
            r.default.prototype.setInternalFormatType.call(this, e), this._dirtyHash = !0
        },
        getOrCreateUniforms: function (e) {
            var t = u;
            if (n.a.assert(void 0 !== e), n.a.assert(-1 !== this._lightNumber), void 0 !== t.uniforms[e]) return t.uniforms[e];
            var i = t.uniforms[e] = {
                    ViewRight: a.a.createFloat4(this.getUniformName("viewRight")),
                    ViewUp: a.a.createFloat4(this.getUniformName("viewUp")),
                    ViewLook: a.a.createFloat4(this.getUniformName("viewLook")),
                    Projection: a.a.createFloat3(this.getUniformName("projection")),
                    DepthRange: a.a.createFloat2(this.getUniformName("depthRange")),
                    MapSize: a.a.createFloat4(this.getUniformName("mapSize")),
                    RenderSize: a.a.createFloat2(this.getUniformName("renderSize"))
                },
                r = "Texture" + e,
                o = a.a.createInt1(e, r);
            return i[r] = o, t.uniforms[e]
        },
        setViewMatrix: function (e) {
            this._viewMatrix = e
        },
        setProjection: function (e) {
            this._projection = e
        },
        setDepthRange: function (e) {
            this._depthRange = e
        },
        setTextureSize: function (e, t) {
            r.default.prototype.setTextureSize.call(this, e, t), this.dirty(), this._mapSize[0] = e, this._mapSize[1] = t, this._mapSize[2] = 1 / e, this._mapSize[3] = 1 / t, this._renderSize[0] = 1 / e, this._renderSize[1] = 1 / t
        },
        _updateViewMatrixUniforms: function (e, t, i, n) {
            var r, a = e;
            r = t.getInternalArray(), r[0] = a[0], r[1] = a[4], r[2] = a[8], r[3] = a[12], r = i.getInternalArray(), r[0] = a[1], r[1] = a[5], r[2] = a[9], r[3] = a[13], r = n.getInternalArray(), r[0] = a[2], r[1] = a[6], r[2] = a[10], r[3] = a[14]
        },
        apply: function (e, t) {
            if (r.default.prototype.apply.call(this, e, t), -1 !== this._lightNumber) {
                var i = this.getOrCreateUniforms(t);
                this._updateViewMatrixUniforms(this._viewMatrix, i.ViewRight, i.ViewUp, i.ViewLook), i.Projection.setFloat3(this._projection), i.DepthRange.setFloat2(this._depthRange), i.MapSize.setFloat4(this._mapSize), i.RenderSize.setFloat2(this._renderSize)
            }
        },
        getHash: function () {
            return this._dirtyHash ? (this._hash = this._computeInternalHash(), this._dirtyHash = !1, this._hash) : this._hash
        },
        _computeInternalHash: function () {
            return this.getTypeMember() + "_" + this._lightNumber + "_" + this._type
        }
    }), "osgShadow", "ShadowTexture"), t.a = u
}, function (e, t, i) {
    "use strict";

    function n(e, t, i) {
        var a = this._refs[i];
        if ("string" == typeof a) {
            if (!this._refs[a]) return n.call(this, e, t, a);
            a = this._refs[a]
        }
        if ((a = a || this._schemas[i]) instanceof _) return s(a.schema, this._opts.inlineRefs) ? a.schema : a.validate || this._compile(a);
        var o, u, l, c = r.call(this, t, i);
        return c && (o = c.schema, t = c.root, l = c.baseId), o instanceof _ ? u = o.validate || e.call(this, o.schema, t, void 0, l) : void 0 !== o && (u = s(o, this._opts.inlineRefs) ? o : e.call(this, o, t, void 0, l)), u
    }

    function r(e, t) {
        var i = m.parse(t),
            n = h(i),
            r = c(this._getId(e.schema));
        if (n !== r) {
            var s = d(n),
                u = this._refs[s];
            if ("string" == typeof u) return a.call(this, e, u, i);
            if (u instanceof _) u.validate || this._compile(u), e = u;
            else {
                if (!((u = this._schemas[s]) instanceof _)) return;
                if (u.validate || this._compile(u), s == d(t)) return {
                    schema: u,
                    root: e,
                    baseId: r
                };
                e = u
            }
            if (!e.schema) return;
            r = c(this._getId(e.schema))
        }
        return o.call(this, i, r, e.schema, e)
    }

    function a(e, t, i) {
        var n = r.call(this, e, t);
        if (n) {
            var a = n.schema,
                s = n.baseId;
            e = n.root;
            var u = this._getId(a);
            return u && (s = f(s, u)), o.call(this, i, s, a, e)
        }
    }

    function o(e, t, i, n) {
        if (e.fragment = e.fragment || "", "/" == e.fragment.slice(0, 1)) {
            for (var a = e.fragment.split("/"), o = 1; o < a.length; o++) {
                var s = a[o];
                if (s) {
                    if (s = v.unescapeFragment(s), void 0 === (i = i[s])) break;
                    var u;
                    if (!S[s] && (u = this._getId(i), u && (t = f(t, u)), i.$ref)) {
                        var l = f(t, i.$ref),
                            c = r.call(this, n, l);
                        c && (i = c.schema, n = c.root, t = c.baseId)
                    }
                }
            }
            return void 0 !== i && i !== n.schema ? {
                schema: i,
                root: n,
                baseId: t
            } : void 0
        }
    }

    function s(e, t) {
        return !1 !== t && (void 0 === t || !0 === t ? u(e) : t ? l(e) <= t : void 0)
    }

    function u(e) {
        var t;
        if (Array.isArray(e)) {
            for (var i = 0; i < e.length; i++)
                if ("object" == typeof (t = e[i]) && !u(t)) return !1
        } else
            for (var n in e) {
                if ("$ref" == n) return !1;
                if ("object" == typeof (t = e[n]) && !u(t)) return !1
            }
        return !0
    }

    function l(e) {
        var t, i = 0;
        if (Array.isArray(e)) {
            for (var n = 0; n < e.length; n++)
                if (t = e[n], "object" == typeof t && (i += l(t)), i == 1 / 0) return 1 / 0
        } else
            for (var r in e) {
                if ("$ref" == r) return 1 / 0;
                if (x[r]) i++;
                else if (t = e[r], "object" == typeof t && (i += l(t) + 1), i == 1 / 0) return 1 / 0
            }
        return i
    }

    function c(e, t) {
        return !1 !== t && (e = d(e)), h(m.parse(e))
    }

    function h(e) {
        return m.serialize(e).split("#")[0] + "#"
    }

    function d(e) {
        return e ? e.replace(y, "") : ""
    }

    function f(e, t) {
        return t = d(t), m.resolve(e, t)
    }

    function p(e) {
        var t = d(this._getId(e)),
            i = {
                "": t
            },
            n = {
                "": c(t, !1)
            },
            r = {},
            a = this;
        return b(e, {
            allKeys: !0
        }, function (e, t, o, s, u, l, c) {
            if ("" !== t) {
                var h = a._getId(e),
                    f = i[s],
                    p = n[s] + "/" + u;
                if (void 0 !== c && (p += "/" + ("number" == typeof c ? c : v.escapeFragment(c))), "string" == typeof h) {
                    h = f = d(f ? m.resolve(f, h) : h);
                    var _ = a._refs[h];
                    if ("string" == typeof _ && (_ = a._refs[_]), _ && _.schema) {
                        if (!g(e, _.schema)) throw new Error('id "' + h + '" resolves to more than one schema')
                    } else if (h != d(p))
                        if ("#" == h[0]) {
                            if (r[h] && !g(e, r[h])) throw new Error('id "' + h + '" resolves to more than one schema');
                            r[h] = e
                        } else a._refs[h] = p
                }
                i[t] = f, n[t] = p
            }
        }), r
    }
    var m = i(1140),
        g = i(702),
        v = i(455),
        _ = i(908),
        b = i(1142);
    e.exports = n, n.normalizeId = d, n.fullPath = c, n.url = f, n.ids = p, n.inlineRef = s, n.schema = r;
    var S = v.toHash(["properties", "patternProperties", "enum", "dependencies", "definitions"]),
        x = v.toHash(["type", "format", "pattern", "maxLength", "minLength", "maxProperties", "minProperties", "maxItems", "minItems", "maximum", "minimum", "uniqueItems", "multipleOf", "required", "enum"]),
        y = /#\/?$/
}, function (e, t, i) {
    "use strict";
    var n = Array.isArray,
        r = Object.keys,
        a = Object.prototype.hasOwnProperty;
    e.exports = function e(t, i) {
        if (t === i) return !0;
        var o, s, u, l = n(t),
            c = n(i);
        if (l && c) {
            if ((s = t.length) != i.length) return !1;
            for (o = 0; o < s; o++)
                if (!e(t[o], i[o])) return !1;
            return !0
        }
        if (l != c) return !1;
        var h = t instanceof Date,
            d = i instanceof Date;
        if (h != d) return !1;
        if (h && d) return t.getTime() == i.getTime();
        var f = t instanceof RegExp,
            p = i instanceof RegExp;
        if (f != p) return !1;
        if (f && p) return t.toString() == i.toString();
        if (t instanceof Object && i instanceof Object) {
            var m = r(t);
            if ((s = m.length) !== r(i).length) return !1;
            for (o = 0; o < s; o++)
                if (!a.call(i, m[o])) return !1;
            for (o = 0; o < s; o++)
                if (u = m[o], !e(t[u], i[u])) return !1;
            return !0
        }
        return !1
    }
}, function (e, t, i) {
    "use strict";

    function n(e) {
        this.message = "validation failed", this.errors = e, this.ajv = this.validation = !0
    }

    function r(e, t, i) {
        this.message = i || r.message(e, t), this.missingRef = o.url(e, t), this.missingSchema = o.normalizeId(o.fullPath(this.missingRef))
    }

    function a(e) {
        return e.prototype = Object.create(Error.prototype), e.prototype.constructor = e, e
    }
    var o = i(701);
    e.exports = {
        Validation: a(n),
        MissingRef: a(r)
    }, r.message = function (e, t) {
        return "can't resolve reference " + t + " from id " + e
    }
}, function (e, t, i) {
    "use strict";
    i.d(t, "a", function () {
        return d
    }), i.d(t, "b", function () {
        return h
    });
    var n, r, a = i(147),
        o = !1;
    if (document)
        for (var s = ["hidden", "mozHidden", "msHidden", "webkitHidden"], u = 0, l = s.length; u < l; u++) {
            var c = s[u];
            if (void 0 !== document[c]) {
                n = c, r = c.toLowerCase().split("hidden").shift() + "visibilitychange";
                break
            }
        }
    var h, d = function () {
        return r
    };
    h = Object(a.a)() ? function () {
        return !1
    } : function () {
        return !(o || !n) && document[n]
    }
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(20),
        a = n.a.osg,
        o = ["magFilter", "minFilter", "wrapS", "wrapT", "textureWidth", "textureHeight", "textureTarget", "internalFormat"],
        s = {
            getValidOptions: function () {
                return o
            },
            getOptions: function (e) {
                var t = {};
                return t.minFilter = e.getMinFilter(), t.magFilter = e.getMagFilter(), t.wrapT = e.getWrapT(), t.wrapS = e.getWrapS(), t.textureWidth = e.getWidth(), t.textureHeight = e.getHeight(), t.textureTarget = e.getTextureTarget(), t.internalFormat = e._internalFormat, t.imageFormat = e._imageFormat, t
            },
            setOptions: function (e, t) {
                t.setMinFilter(e.minFilter), t.setMagFilter(e.magFilter), t.setWrapT(e.wrapT), t.setWrapS(e.wrapS), e.minFilter === a.Texture.LINEAR_MIPMAP_LINEAR && Object(r.a)().anisotropy && t.setMaxAnisotropy(16), t.setInternalFormat(e.internalFormat)
            },
            createValidOptionsForMaterial: function (e) {
                var t = s.createValidOptions(e),
                    i = t.minFilter,
                    n = t.magFilter;
                return i === a.Texture.LINEAR_MIPMAP_LINEAR || i === a.Texture.LINEAR ? (t.magFilter = a.Texture.LINEAR, t) : n === a.Texture.LINEAR ? (t.minFilter = a.Texture.LINEAR_MIPMAP_LINEAR, t) : i === a.Texture.NEAREST_MIPMAP_LINEAR || i === a.Texture.NEAREST ? (t.magFilter = a.Texture.NEAREST, t) : (t.magFilter = a.Texture.LINEAR, t.minFilter = a.Texture.LINEAR_MIPMAP_LINEAR, t)
            },
            createValidOptions: function (e) {
                e || (e = {});
                for (var t = o.length, i = 0; i < t; ++i) {
                    var n = o[i];
                    "string" == typeof e[n] && (e[n] = a.Texture[e[n]])
                }
                return e.magFilter || (e.magFilter = a.Texture.LINEAR), e.minFilter || (e.minFilter = a.Texture.LINEAR_MIPMAP_LINEAR), e.wrapS || (e.wrapS = a.Texture.REPEAT), e.wrapT || (e.wrapT = a.Texture.REPEAT), e.textureWidth || (e.textureWidth = 0), e.textureHeight || (e.textureHeight = 0), e.textureTarget || (e.textureTarget = a.Texture.TEXTURE_2D), e.internalFormat || (e.internalFormat = -1), e
            }
        };
    t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(49),
        r = i.n(n),
        a = i(5),
        o = i.n(a),
        s = i(24),
        u = i.n(s),
        l = i(149),
        c = i(14),
        h = i(598),
        d = i(0),
        f = (i.n(d), i(228));
    t.a = l.a.extend({
        getModelOptionPath: function () {
            return "#.definitions.soundtrack"
        },
        getName: function () {
            return "Soundtrack"
        },
        initDefaults: function (e) {
            var t = this._flattenObject(e, this._typeMap);
            this.set(Object(d.merge)(t, this.attributes)), this.get("uid") || this.set("uid", "tmp_" + this.get("cid"))
        },
        defaults: function () {
            return {
                cid: this.cid,
                lastComputedScenePosition: [0, 0, 0],
                lastComputedWorldPosition: [0, 0, 0]
            }
        },
        isNew: function () {
            var e = this.get("uid");
            return void 0 === e || !(!e || !e.toString().startsWith("tmp_"))
        },
        makeUrl: function () {
            return f.a.domain + "/sounds" + (this.isNew() ? "" : "/" + this.get("uid"))
        },
        duplicate: function () {
            var e = new this.constructor;
            return e.setJSON(this.getJSON()), e.set("name", this.get("name")), e.set("url", this.get("url")), e.set("files", this.get("files")), e
        },
        save: function (e, t) {
            if (!this.isNew()) return o.a.resolve();
            null != e && "object" !== (void 0 === e ? "undefined" : r()(e)) || (t = e);
            var i = new FormData;
            i.append("soundFile", this.get("files")[0]), i.append("name", this.get("name")), i.append("model", t.modelUID);
            var n = this;
            return o.a.resolve(u.a.ajax({
                type: "POST",
                url: this.makeUrl(),
                data: i,
                processData: !1,
                contentType: !1
            })).then(function (e) {
                n.set("uid", e.uid)
            })
        }
    }, Object(h.a)({
        fileTypes: c.a.soundFiletypes,
        maxFileSize: c.a.maxSoundFilesize
    }))
}, function (e, t, i) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: !0
    });
    var n = i(0),
        r = (i.n(n), i(9)),
        a = i(149),
        o = i(24),
        s = i.n(o),
        u = i(14),
        l = i(79),
        c = i(152),
        h = i(119),
        d = i(920),
        f = i(44),
        p = i(103),
        m = i(77),
        g = i(423),
        v = r.a.osg,
        _ = s.a.View,
        b = s.a.Model,
        S = function (e) {
            return 0 === e[0] && 0 === e[1] && 0 === e[2]
        },
        x = function (e) {
            return 1 === e[0] && 1 === e[1] && 1 === e[2]
        },
        y = {
            CavityPBR: !0,
            AOPBR: !0,
            NormalMap: !0,
            Displacement: !0,
            BumpMap: !0,
            ClearCoatNormalMap: !0
        },
        C = {
            DiffuseIntensity: !0,
            DiffusePBR: !0,
            AlbedoPBR: !0,
            SpecularPBR: !0,
            GlossinessPBR: !0,
            RoughnessPBR: !0,
            MetalnessPBR: !0,
            SpecularF0: !0
        },
        T = {},
        w = T.view = _.extend({
            initialize: function () {
                _.prototype.initialize.apply(this, arguments), this.model.on("change:enable", this.updateChannel, this), this.model.on("change:texCoordUnit", this.changeTexCoord, this), this.model.on("setFactor", this.updateChannel, this), this.model.on("setColor", this.updateChannel, this), this.model.on("setTextureModel", this.updateChannel, this), this.model.on("updateChannel", this.updateChannel, this), this.model.on("all", f.a.draw)
            },
            getStateSetContext: function () {
                return this.stateSetContext
            },
            updateChannel: function () {
                if (this.model.getTextureModel()) {
                    var e = this.model.get("material").get("texCoordUnitList"),
                        t = this.model.getTexCoordUnit();
                    e.length && -1 === e.indexOf(t) && this.model.setTexCoordUnit(e[0])
                }
                this.getStateSetContext().updateChannel(this.model)
            },
            changeTexCoord: function () {
                this.getStateSetContext().dirtyMaterial()
            }
        }),
        M = T.model = a.a.extend({
            getModelOptionPath: function () {
                return "materials:0.channels." + this.get("name")
            },
            _initFactorFromBox: function (e, t) {
                var i = this;
                i.get(e) >= 0 || p.a.getBoxReady().then(function () {
                    if (!(i.get(e) >= 0)) {
                        var n = p.a.getModelBoxWithoutDisplacement().radius();
                        i.set(e, n * t)
                    }
                })
            },
            setupTextureModel: function (e) {
                var t = new d.a(e);
                return -1 === t.get("internalFormat") && t.set("internalFormat", c.a.getDefaultFormatEnum(this.get("name"))), t.updateMultiresTexture(), this.setTextureModel(t), t
            },
            _createTextureModel: function (e, t) {
                var i = t.get(e.uid);
                if (i) return this.setupTextureModel(Object(n.extend)({}, e, {
                    image: i
                }));
                (this.isEffective() || Object(l.a)()) && v.error("can't find imageModel " + e.uid)
            },
            setChannelJSON: function (e, t, i) {
                var n = this.setJSON(e, {
                    ignore: ["texture"],
                    context: this.get("name"),
                    imageCollection: t,
                    validate: i && i.validate,
                    warnOnError: i && i.warnOnError
                });
                return n.length ? n : (e.texture ? this._createTextureModel(e.texture, t) : null === e.texture && this.setTextureModel(void 0), n)
            },
            getJSON: function () {
                var e = a.a.prototype.getJSON.call(this, {
                        ignore: ["texture"],
                        context: this.get("name")
                    }),
                    t = this.get("textureModel");
                return t && (e.texture = t.getJSON()), e
            },
            validate: function (e, t) {
                var i = a.a.prototype.validate.call(this, e, t);
                return t && t.imageCollection && e.texture && e.enable && e.factor && !t.warnOnError ? (t.imageCollection.get(e.texture.uid) || i.push(this.get("name") + " texture uid does not exist"), i) : i
            },
            getName: function () {
                return this.get("name")
            },
            getEnable: function () {
                return this.get("enable")
            },
            getFactor: function () {
                return this.get("factor")
            },
            getTextureModel: function () {
                return this.get("textureModel")
            },
            getTexCoordUnit: function () {
                var e = this.get("textureModel");
                return e && e.get("texCoordUnit")
            },
            setEnable: function (e) {
                return this.set("enable", e)
            },
            setFactor: function (e) {
                return this.set("factor", e), this.trigger("setFactor")
            },
            setTextureModel: function (e) {
                return this.set("textureModel", e), this.trigger("setTextureModel")
            },
            setTexCoordUnit: function (e) {
                var t = this.get("textureModel");
                void 0 !== t && (t.set("texCoordUnit", e), this.trigger("change:texCoordUnit"))
            },
            removeTexture: function () {
                this.setColor(v.vec3.ONE)
            },
            reset: function () {
                return this.removeTexture(), this.set("factor", 1), this.trigger("updateChannel")
            },
            resetTextureFormat: function () {
                var e = this.get("textureModel");
                e && (e.set("internalFormat", c.a.getDefaultFormatEnum(this.get("name"))), e.updateMultiresTexture())
            },
            isEffective: function () {
                if (!this.isActivated()) return !1;
                var e = this.get("name"),
                    t = this.get("factor");
                if (0 === t) {
                    if ("RoughnessPBR" !== e && "GlossinessPBR" !== e) return !1;
                    var i = this.get("material").getChannels().Opacity;
                    return i.isEffective() && "refraction" === i.get("type") && i.get("useMicrosurfaceTexture")
                }
                if (y[e] && !this.get("textureModel")) return !1;
                if ("Displacement" === e && !v.WebGLCaps.instance().getWebGLParameter("MAX_VERTEX_TEXTURE_IMAGE_UNITS")) return !1;
                var n = this.get("color");
                return !(!C[e] && n && S(n) && "SubsurfaceTranslucency" !== e) && ("DiffuseIntensity" !== e || 1 !== t || !n || !x(n))
            },
            isEnableEffective: function () {
                return !!this.isActivated() && (!!C[this.get("name")] || this.isEffective())
            },
            isEnableEffectiveHardware: function (e) {
                if (!this.isEnableEffective()) return !1;
                if (!y[this.get("name")]) return !0;
                var t = e.getChannelMapping(this.get("name"));
                return void 0 !== t && t >= 0
            },
            isActivated: function () {
                return !!(c.a.getShadingMask(this.get("name")) & this.getCurrentShading()) && this.get("enable")
            },
            getCurrentShading: function () {
                var e = this.get("material").get("stateSet"),
                    t = e && e.getShaderGeneratorName();
                return t ? h.a.nameMatch[t] : h.a.get("mask")
            },
            shouldDisplayGUIWarningOnDeletion: function () {
                if (!this.getEnable()) return !1;
                var e = h.a.get("mask") & h.a.CLASSIC,
                    t = e ? h.a.CLASSIC : h.a.PBR;
                return !!(c.a.getShadingMask(this.getName()) & t)
            },
            addUniforms: function (e, t) {
                var i = "u" + (t || this.get("name")) + "Factor";
                e[i] = v.Uniform.createFloat(i)
            },
            cacheUniforms: function (e) {
                this._uniformFactor = e["u" + this.get("name") + "Factor"].getInternalArray(), this._valueFactor = this.isEnableEffective() ? this.get("factor") : 0
            },
            updateUniforms: function () {
                this._uniformFactor[0] = this._valueFactor
            },
            getSRGB: function () {
                var e = this.get("textureModel");
                if (!e) return !1;
                if (!e.getImageModel()) return c.a.isSRGB(this.get("name"));
                var t = e.getImageModel().get("colorSpace");
                return "srgb" === t || "linear" !== t && c.a.isSRGB(this.get("name"))
            },
            getShaderHash: function () {
                var e = this.isEffective(),
                    t = e && this.get("textureModel"),
                    i = this.getSRGB() ? "1" : "0";
                return i += t ? t.get("texCoordUnit") : "x"
            }
        }),
        E = {};
    E.view = w, E.model = M.extend({
        _adaptJSON: function (e) {
            e.texture ? delete e.color : delete e.texture
        },
        getColor: function () {
            return this.get("color")
        },
        setColor: function (e) {
            return this.set("textureModel", void 0), this.set("color", v.vec3.copy(this.get("color") || v.vec3.create(), e)), this.trigger("setColor")
        },
        setTextureModel: function (e) {
            e && this.set("color", void 0), M.prototype.setTextureModel.call(this, e)
        },
        getJSON: function () {
            var e = M.prototype.getJSON.call(this);
            return this.get("textureModel") && e.color && delete e.color, e
        },
        setChannelJSON: function (e, t, i) {
            var n = M.prototype.setChannelJSON.call(this, e, t, i);
            return n.length ? n : (e.color && this.setColor(e.color), n)
        }
    });
    var A = M.prototype.addUniforms,
        P = M.prototype.cacheUniforms,
        R = {};
    R.view = w.extend({
        initialize: function () {
            w.prototype.initialize.apply(this, arguments), this.model.on("change:type", this.changeType, this), this.model.on("change:invert", this.updateChannel, this), this.model.on("change:ior", this.updateChannel, this), this.model.on("change:roughnessFactor", this.updateChannel, this), this.model.on("change:useMicrosurfaceTexture", this.updateChannel, this), this.model.on("change:useAlbedoTint", this.updateChannel, this), this.model.on("change:useNormalOffset", this.updateChannel, this), this.model.on("change:refractionColor", this.updateChannel, this), this.model.on("change:thinLayer", this.updateChannel, this), this.model.get("material").on("change:vertexAlphaEnable", this.updateChannel, this), this._isMasking = "alphaMask" === this.model.getTransparency()
        },
        _checkForceLuminance: function () {
            var e = this.model.getTextureModel(),
                t = e && e.getMultiresTexture();
            if (t) {
                var i = e.getImageModel();
                if (!(!1 === i.get("alpha"))) {
                    var n = i.get("name") || t.getImageModel().getURL();
                    if (n = n.toLowerCase(), -1 === n.indexOf("jpg") && -1 === n.indexOf("jpeg")) return
                }
                e.set("internalFormat", v.Texture.LUMINANCE), e.updateMultiresTexture()
            }
        },
        updateChannel: function () {
            var e = this.model.get("material").getChannels();
            e.RoughnessPBR.isEnableEffective() ? e.RoughnessPBR.trigger("updateChannel") : e.GlossinessPBR.isEnableEffective() && e.GlossinessPBR.trigger("updateChannel"), this._checkForceLuminance(), w.prototype.updateChannel.call(this), f.a.redrawShadow()
        },
        _updateMaskingFiltering: function () {
            var e = "alphaMask" === this.model.getTransparency();
            if (e !== this._isMasking) {
                this._isMasking = e;
                var t = this.model.getTextureModel();
                if (t && t.get("magFilter") !== v.Texture.NEAREST) {
                    var i = t.get("minFilter"),
                        n = i === v.Texture.LINEAR_MIPMAP_LINEAR,
                        r = i;
                    e && i === n ? r = v.Texture.LINEAR : e || i !== v.Texture.LINEAR || (r = this._blendFilter), r && (t.set("minFilter", i), t.set("magFilter", n ? v.Texture.LINEAR : i), t.updateMultiresTexture())
                }
            }
        },
        changeType: function () {
            this._updateMaskingFiltering(), this.updateChannel()
        }
    }), R.model = M.extend({
        _modelOptionPath: "materials:0.channels.Opacity",
        getTransparency: function () {
            return this.get("type")
        },
        setTransparency: function (e) {
            this.setJSON({
                type: e
            })
        },
        isEffective: function () {
            if (!this.isActivated()) return !1;
            var e = this.get("type"),
                t = this.get("factor"),
                i = this.get("textureModel"),
                n = i || this.get("material").get("vertexAlphaEnable");
            if ("alphaMask" === e) return n && 0 !== t;
            if ("alphaBlend" === e || "refraction" === e || "additive" === e) {
                if (this.get("material").getChannels().SubsurfaceScattering.isEffective()) return !1
            }
            return "alphaBlend" !== e && "refraction" !== e && "dithering" !== e || (n || 1 !== t)
        },
        addUniforms: function (e, t) {
            A.call(this, e, t), e.uOpacityInvert = v.Uniform.createInt("uOpacityInvert"), e.uOpacityDithering = v.Uniform.createInt("uOpacityDithering"), e.uOpacityAdditive = v.Uniform.createInt("uOpacityAdditive"), e.uOpacityIOR = v.Uniform.createFloat("uOpacityIOR"), e.uOpacityRoughnessFactor = v.Uniform.createFloat("uOpacityRoughnessFactor"), e.uOpacityRefractionColor = v.Uniform.createFloat3("uOpacityRefractionColor"), e.uOpacityThinLayer = v.Uniform.createFloat("uOpacityThinLayer")
        },
        cacheUniforms: function (e) {
            P.call(this, e), this._uniformInvert = e.uOpacityInvert.getInternalArray(), this._uniformDithering = e.uOpacityDithering.getInternalArray(), this._uniformAdditive = e.uOpacityAdditive.getInternalArray(), this._uniformIOR = e.uOpacityIOR.getInternalArray(), this._uniformRoughnessFactor = e.uOpacityRoughnessFactor.getInternalArray(), this._uniformRefractionColor = e.uOpacityRefractionColor.getInternalArray();
            var t = this.isEnableEffective();
            this._valueInvert = t && this.get("textureModel") && this.get("invert") ? 1 : 0, this._valueDithering = t && "dithering" === this.get("type") ? 1 : 0, this._valueAdditive = t && "additive" === this.get("type") ? 1 : 0;
            var i = t && "refraction" === this.get("type");
            this._valueIOR = i ? this.get("ior") : 0, this._valueRoughness = i ? this.get("roughnessFactor") : 0, this._valueRefractionColor = i ? this.get("refractionColor") : v.vec3.ONE, this._uniformThinLayer = e.uOpacityThinLayer.getInternalArray(), this._valueThinLayer = this.get("thinLayer") ? 1 : 0
        },
        updateUniforms: function () {
            this._uniformFactor[0] = this._valueFactor, this._uniformInvert[0] = this._valueInvert, this._uniformDithering[0] = this._valueDithering, this._uniformAdditive[0] = this._valueAdditive, this._uniformIOR[0] = this._valueIOR, this._uniformRoughnessFactor[0] = this._valueRoughness, v.vec3.copy(this._uniformRefractionColor, this._valueRefractionColor), this._uniformThinLayer[0] = this._valueThinLayer
        },
        _hasTextureAlpha: function () {
            var e = this.get("textureModel");
            if (!e) return !1;
            var t = e.getMultiresTexture();
            return !(!t || !t.getOriginalFormat) && t.getOriginalFormat() === v.Texture.ALPHA
        },
        getSRGB: function () {
            return !this._hasTextureAlpha() && M.prototype.getSRGB.call(this)
        },
        _isReadingMicrosurface: function () {
            if ("refraction" !== this.get("type")) return !1;
            if (!this.get("useMicrosurfaceTexture")) return !1;
            if (0 == (h.a.get("mask") & h.a.PBR)) return !1;
            var e = this.get("material").getChannels();
            return e.RoughnessPBR.isEnableEffective() ? e.RoughnessPBR.getTextureModel() : e.GlossinessPBR.getTextureModel()
        },
        getShaderHash: function () {
            var e = M.prototype.getShaderHash.call(this),
                t = this.get("type"),
                i = "alphaBlend" === t || "additive" === t,
                n = this.get("textureModel") && this.get("textureModel").isLuminance(),
                r = "refraction" === t,
                a = this._isReadingMicrosurface(),
                o = r && this.get("useAlbedoTint"),
                s = r && this.get("useNormalOffset");
            return g.a.CURRENT_COMPILER === g.a.SHADOWCAST_COMPILER || g.a.CURRENT_COMPILER === g.a.EARLYZ_COMPILER ? (e += i || r ? "1" : "0", e += n ? "1" : "0", e += "0000") : (e += i ? "1" : "0", e += n ? "1" : "0", e += r ? "1" : "0", e += a ? "1" : "0", e += o ? "1" : "0", e += s ? "1" : "0"), e
        }
    });
    var O = {};
    O.view = w.extend({
        initialize: function () {
            w.prototype.initialize.apply(this, arguments), this.model.on("change:occludeSpecular", this.updateChannel, this)
        }
    }), O.model = M.extend({
        getModelOptionPath: function () {
            return "materials:0.channels.AOPBR"
        },
        addUniforms: function (e, t) {
            A.call(this, e, t), e.uAOPBROccludeSpecular = v.Uniform.createInt("uAOPBROccludeSpecular")
        },
        cacheUniforms: function (e) {
            P.call(this, e), this._uniformOcclude = e.uAOPBROccludeSpecular.getInternalArray(), this._valueOcclude = this.isEnableEffective() && this.get("occludeSpecular") ? 1 : 0
        },
        updateUniforms: function () {
            this._uniformFactor[0] = this._valueFactor, this._uniformOcclude[0] = this._valueOcclude
        }
    });
    var I = {};
    I.view = w.extend({}), I.model = M.extend({
        _modelOptionPath: "materials:0.channels.BumpMap",
        addUniforms: function (e, t) {
            A.call(this, e, t);
            var i = "u" + t + "Size";
            e[i] = v.Uniform.createFloat2(v.vec2.create(), i)
        },
        cacheUniforms: function (e) {
            P.call(this, e), this._uniformSize = e["u" + this.get("name") + "Size"].getInternalArray(), this._mrTexture = this.get("textureModel") && this.get("textureModel").getMultiresTexture()
        },
        updateUniforms: function () {
            this._uniformFactor[0] = this._valueFactor, this._uniformSize[0] = this._mrTexture ? this._mrTexture.getWidth() : 0, this._uniformSize[1] = this._mrTexture ? this._mrTexture.getHeight() : 0
        }
    });
    var F = {};
    F.view = w.extend({
        initialize: function () {
            w.prototype.initialize.apply(this, arguments), this.model.on("change:thickness", this.updateChannel, this), this.model.on("change:tint", this.updateChannel, this), this.model.on("change:reflectivity", this.updateChannel, this), this.model.on("change:useBaseNormalMap", this.updateChannel, this)
        }
    }), F.model = M.extend({
        addUniforms: function (e, t) {
            A.call(this, e, t);
            var i = "uClearCoatThickness";
            e[i] = v.Uniform.createFloat(0, i), i = "uClearCoatIor", e[i] = v.Uniform.createFloat(0, i), i = "uClearCoatF0", e[i] = v.Uniform.createFloat(0, i), i = "uClearCoatTint", e[i] = v.Uniform.createFloat3(v.vec3.create(), i)
        },
        cacheUniforms: function (e) {
            P.call(this, e), this._uThickness = e.uClearCoatThickness.getInternalArray(), this._uIor = e.uClearCoatIor.getInternalArray(), this._uF0 = e.uClearCoatF0.getInternalArray(), this._uTint = e.uClearCoatTint.getInternalArray(), this._valueRoughness = this.get("roughness"), this._valueThickness = this.get("thickness");
            var t = this.get("reflectivity");
            this._valueIOR = 1.4 * (1 - t) + 1 * t, this._valueF0 = .04 * (1 + t), this.updateTintUniform()
        },
        updateTintUniform: function () {
            var e = this.get("thickness"),
                t = Math.max(20 - e, .01);
            this._valueTint || (this._valueTint = v.vec3.create()), v.vec3.copy(this._valueTint, this.get("tint")), this._valueTint[0] = -Math.log(v.clamp(this._valueTint[0], .01, .99)) / t, this._valueTint[1] = -Math.log(v.clamp(this._valueTint[1], .01, .99)) / t, this._valueTint[2] = -Math.log(v.clamp(this._valueTint[2], .01, .99)) / t
        },
        updateUniforms: function () {
            this._uniformFactor[0] = this._valueFactor, this._uThickness[0] = this._valueThickness, v.vec3.copy(this._uTint, this._valueTint), this._uIor[0] = this._valueIOR, this._uF0[0] = this._valueF0
        }
    }), F.model.validateJSON = function (e, t, i) {
        return M.validateJSON(e, t, i)
    };
    var N = {};
    N.view = w.extend({}), N.model = M.extend({
        isEnableEffective: function () {
            return this.get("material").getChannels().ClearCoat.isEnableEffective()
        }
    });
    var D = {};
    D.view = w.extend({
        initialize: function () {
            w.prototype.initialize.apply(this, arguments), this.model.on("change:flipY", this.updateChannel, this)
        }
    }), D.model = M.extend({
        addUniforms: function (e, t) {
            A.call(this, e, t), e.uClearCoatNormalMapFlipY = v.Uniform.createInt("uClearCoatNormalMapFlipY")
        },
        cacheUniforms: function (e) {
            P.call(this, e), this._uniformFlip = e.uClearCoatNormalMapFlipY.getInternalArray(), this._valueFlip = this.isEnableEffective() && this.get("flipY") ? 1 : 0
        },
        updateUniforms: function () {
            this._uniformFactor[0] = this._valueFactor, this._uniformFlip[0] = this._valueFlip
        },
        isEffective: function () {
            return this.get("material").getChannels().ClearCoat.isEffective() && void 0 !== this.getTextureModel()
        }
    });
    var L = {};
    L.view = w.extend({
        updateChannel: function () {
            w.prototype.updateChannel.call(this), this.model.updateGeometryOffsets(), f.a.redrawShadow()
        }
    }), L.model = M.extend({
        _modelOptionPath: "materials:0.channels.Displacement",
        updateGeometryOffsets: function () {
            var e = v.vec3.create();
            return function () {
                var t = this.isEffective() ? this.getFactor() : 0;
                if (p.a.updateMaxWorldDisplacement(t), 0 !== t)
                    for (var i = this.get("material").get("geometryList"), n = 0, r = i.length; n < r; ++n) {
                        var a = i[n];
                        if (!a._maxScale) {
                            for (var o = a.getWorldMatrices(), s = 0, u = 0, l = o.length; u < l; ++u) v.mat4.getScale(e, o[u]), s = Math.max(s, e[0], e[1], e[2]);
                            a._maxScale = s
                        }
                        var c = t / (a._maxScale || 1);
                        a._displacementFactor = Math.max(a._displacementFactor || 0, c), a.dirtyBound()
                    }
            }
        }(),
        setTextureModel: function (e) {
            return e && e.get("minFilter") === v.Texture.LINEAR_MIPMAP_LINEAR && (e.set("minFilter", v.Texture.LINEAR), e.updateMultiresTexture()), M.prototype.setTextureModel.call(this, e)
        },
        addUniforms: function (e, t) {
            I.model.prototype.addUniforms.call(this, e, t), e.uDisplacementNormal = v.Uniform.createFloat(1, "uDisplacementNormal")
        },
        cacheUniforms: function (e) {
            if (I.model.prototype.cacheUniforms.call(this, e), this._uniformNormal = e.uDisplacementNormal.getInternalArray(), this.isEnableEffective()) {
                var t = p.a.getModelBoxWithoutDisplacement();
                t ? this._valueNormal = 250 * this.get("factor") / t.radius() : p.a.getBoxReady().then(this.cacheUniforms.bind(this, e))
            } else this._valueNormal = 0
        },
        updateUniforms: function () {
            I.model.prototype.updateUniforms.call(this), this._uniformNormal[0] = this._valueNormal
        }
    });
    var k = {};
    k.view = w.extend({
        initialize: function () {
            w.prototype.initialize.apply(this, arguments), this.model.on("change:flipY", this.updateChannel, this)
        }
    }), k.model = M.extend({
        _modelOptionPath: "materials:0.channels.NormalMap",
        addUniforms: function (e, t) {
            A.call(this, e, t), e.uNormalMapFlipY = v.Uniform.createInt("uNormalMapFlipY")
        },
        cacheUniforms: function (e) {
            P.call(this, e), this._uniformFlip = e.uNormalMapFlipY.getInternalArray(), this._valueFlip = this.isEnableEffective() && this.get("flipY") ? 1 : 0
        },
        updateUniforms: function () {
            this._uniformFactor[0] = this._valueFactor, this._uniformFlip[0] = this._valueFlip
        }
    });
    var V = {};
    V.view = w.extend({
        initialize: function () {
            w.prototype.initialize.apply(this, arguments), this.model.on("change:type", this.updateChannel, this)
        }
    }), V.model = E.model.extend({
        _modelOptionPath: "materials:0.channels.EmitColor",
        addUniforms: function (e, t) {
            A.call(this, e, t), e.uEmitMultiplicative = v.Uniform.createInt("uEmitMultiplicative")
        },
        cacheUniforms: function (e) {
            P.call(this, e), this._uniformMultiply = e.uEmitMultiplicative.getInternalArray();
            var t = this.isEnableEffective() && "multiplicative" === this.get("type");
            this._valueMultiply = t ? 1 : 0
        },
        updateUniforms: function () {
            this._uniformFactor[0] = this._valueFactor, this._uniformMultiply[0] = this._valueMultiply
        },
        isEffective: function () {
            return !!this.isActivated() && (0 !== this.get("factor") || "additive" !== this.get("type"))
        }
    });
    var B, U = function () {
            if (B) return B;
            if (B = m.default.instance.getMatcapCollection(), 0 === B.length) {
                B.addNewImage({
                    url: u.a.defaultMatcapUid,
                    name: u.a.defaultMatcapUid,
                    width: 1,
                    height: 1
                }).set("uid", u.a.defaultMatcapUid)
            }
            return B
        },
        G = {};
    G.view = w.extend({
        initialize: function () {
            w.prototype.initialize.apply(this, arguments), this.model.on("change:curvature", this.updateChannel, this)
        }
    }), G.model = E.model.extend({
        _modelOptionPath: "materials:0.channels.Matcap",
        _adaptJSON: function () {},
        initialize: function () {
            if (M.prototype.initialize.apply(this, arguments), !this.get("textureModel")) {
                var e = U(),
                    t = e.get(u.a.defaultMatcapUid);
                t || (t = e.at(0)), this.setChannelJSON({
                    texture: {
                        uid: t.getUID()
                    }
                })
            }
        },
        setTextureModel: function (e) {
            return this.set("textureModel", e), this.trigger("setTextureModel")
        },
        setColor: function (e) {
            return this.set("color", v.vec3.copy(this.get("color") || v.vec3.create(), e)), this.trigger("setColor")
        },
        isEffective: function () {
            return !!this.isActivated()
        },
        addUniforms: function (e, t) {
            A.call(this, e, t), e.uMatcapCurvature = v.Uniform.createFloat("uMatcapCurvature"), e.uMatcapColor = v.Uniform.createFloat3("uMatcapColor")
        },
        cacheUniforms: function (e) {
            P.call(this, e), this._uniformCurvature = e.uMatcapCurvature.getInternalArray(), this._valueCurvature = this.isEnableEffective() ? this.get("curvature") : 0, this._uniformColor = e.uMatcapColor.getInternalArray(), this._valueColor = this.isEnableEffective() ? this.get("color") : v.vec3.ONE
        },
        updateUniforms: function () {
            this._uniformFactor[0] = this._valueFactor, this._uniformCurvature[0] = this._valueCurvature, v.vec3.copy(this._uniformColor, this._valueColor)
        },
        getJSON: function () {
            return M.prototype.getJSON.call(this)
        },
        setChannelJSON: function (e, t, i) {
            return !1 === e.enable && (e.enable = !0), M.prototype.setChannelJSON.call(this, e, U(), i)
        },
        resetToDefaultMatcap: function () {
            this.setChannelJSON({
                texture: {
                    uid: u.a.defaultMatcapUid
                }
            })
        }
    });
    var j = {};
    j.view = w.extend({
        initialize: function () {
            w.prototype.initialize.apply(this, arguments), this.model.on("change:profile", this.updateChannel, this)
        }
    }), j.model = M.extend({
        _modelOptionPath: "materials:0.channels.SubsurfaceScattering",
        initialize: function () {
            M.prototype.initialize.apply(this, arguments), this._initFactorFromBox("factor", .05)
        },
        addUniforms: function (e, t) {
            A.call(this, e, t), e.uSubsurfaceScatteringProfile = v.Uniform.createFloat("uSubsurfaceScatteringProfile")
        },
        cacheUniforms: function (e) {
            P.call(this, e), this._uniformProfile = e.uSubsurfaceScatteringProfile.getInternalArray(), this._valueProfile = this.isEnableEffective() ? this.get("profile") : 1
        },
        updateUniforms: function () {
            this._uniformFactor[0] = this._valueFactor, this._uniformProfile[0] = this._valueProfile
        }
    });
    var z = {};
    z.view = w.extend({
        initialize: function () {
            w.prototype.initialize.apply(this, arguments), this.model.on("change:thicknessFactor", this.updateChannel, this)
        }
    }), z.model = E.model.extend({
        _modelOptionPath: "materials:0.channels.SubsurfaceTranslucency",
        initialize: function () {
            M.prototype.initialize.apply(this, arguments), this._initFactorFromBox("thicknessFactor", .05)
        },
        setTextureModel: G.model.prototype.setTextureModel,
        setColor: G.model.prototype.setColor,
        getJSON: G.model.prototype.getJSON,
        setJSON: G.model.prototype.setJSON,
        _adaptJSON: G.model.prototype._adaptJSON,
        addUniforms: function (e, t) {
            A.call(this, e, t), e.uSubsurfaceTranslucencyColor = v.Uniform.createFloat3("uSubsurfaceTranslucencyColor"), e.uSubsurfaceTranslucencyThicknessFactor = v.Uniform.createFloat("uSubsurfaceTranslucencyThicknessFactor")
        },
        cacheUniforms: function (e) {
            P.call(this, e), this._uniformThicknessFactor = e.uSubsurfaceTranslucencyThicknessFactor.getInternalArray(), this._uniformColor = e.uSubsurfaceTranslucencyColor.getInternalArray(), this._valueColor = this.isEnableEffective() ? this.get("color") : v.vec3.ONE, this._valueThicknessFactor = this.isEnableEffective() ? this.get("thicknessFactor") : 0
        },
        updateUniforms: function () {
            this._uniformFactor[0] = this._valueFactor, this._uniformThicknessFactor[0] = this._valueThicknessFactor, v.vec3.copy(this._uniformColor, this._valueColor)
        }
    });
    var H = {};
    H.view = w.extend({}), H.model = E.model.extend({
        initialize: function () {
            b.prototype.initialize.apply(this, arguments)
        },
        setInspectorSRGB: function (e) {
            this._srgb = e
        },
        getSRGB: function () {
            return !!this._srgb
        },
        setTextureModel: G.model.prototype.setTextureModel,
        setColor: G.model.prototype.setColor,
        addUniforms: function (e, t) {
            A.call(this, e, t), e.uInspectorInvert = v.Uniform.createInt("uInspectorInvert"), e.uInspectorMaskThreshold = v.Uniform.createFloat("uInspectorMaskThreshold"), e.uInspectorColor = v.Uniform.createFloat3("uInspectorColor")
        },
        cacheUniforms: function (e) {
            P.call(this, e), this._uniformInvert = e.uInspectorInvert.getInternalArray(), this._uniformMaskThreshold = e.uInspectorMaskThreshold.getInternalArray(), this._uniformColor = e.uInspectorColor.getInternalArray()
        },
        updateUniforms: function () {
            this._uniformFactor[0] = this._valueFactor, this._uniformInvert[0] = this.get("invert") ? 1 : 0, this._uniformMaskThreshold[0] = this.get("maskThreshold"), v.vec3.copy(this._uniformColor, this.getColor())
        },
        setChannelJSON: function (e, t) {
            if (void 0 !== e.enable && this.setEnable(e.enable), void 0 !== e.factor && this.setFactor(e.factor), e.color && this.setColor(e.color), e.texture) {
                this._createTextureModel(e.texture, t) || this.setColor(e.color || v.vec3.fromValues(1, 1, 1))
            }
            return void 0 !== e.invert && this.set("invert", e.invert), void 0 !== e.maskThreshold && this.set("maskThreshold", e.maskThreshold), []
        },
        getJSON: function () {
            var e = {},
                t = this.get("textureModel");
            t && (e.texture = t.getJSON());
            var i = this.get("color");
            return i && (e.color = i), e.factor = this.get("factor"), e.enable = this.get("enable"), e.invert = this.get("invert"), e.maskThreshold = this.get("maskThreshold"), e
        }
    });
    var W = {
        DiffusePBR: E,
        AlbedoPBR: E,
        SpecularPBR: E,
        GlossinessPBR: T,
        RoughnessPBR: T,
        MetalnessPBR: T,
        SpecularF0: T,
        CavityPBR: T,
        Matcap: G,
        SubsurfaceTranslucency: z,
        DiffuseColor: E,
        SpecularColor: E,
        DiffuseIntensity: E,
        SpecularHardness: T,
        SubsurfaceScattering: j,
        Displacement: L,
        NormalMap: k,
        AOPBR: O,
        BumpMap: I,
        EmitColor: V,
        Opacity: R,
        ClearCoat: F,
        ClearCoatRoughness: N,
        ClearCoatNormalMap: D,
        Inspector: H
    };
    t.default = W
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(44),
        a = n.a.osg,
        o = function (e) {
            this._duration = void 0 === e ? 1 : e, this.reset()
        };
    a.createPrototypeObject(o, {
        getDuration: function () {
            return this._duration
        },
        setDuration: function (e) {
            this._duration = e
        },
        reset: function () {
            this._startTime = -1, this._finished = !1, this._ratio = 0, r.a.draw()
        },
        finished: function () {},
        interpolate: function (e, t, i) {
            if (this._finished) return 1;
            this._startTime < 0 && (this._startTime = e);
            var n = Math.min(this._duration, e - this._startTime),
                r = 0 === this._duration ? 1 : n / this._duration;
            return this._ratio = r, (r >= 1 || 0 === this._duration) && (this._finished = !0, this.finished(t, i)), r
        },
        update: function (e, t) {
            return this.interpolate(t.getFrameStamp().getSimulationTime(), e, t), !0
        }
    }), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(923),
        a = i(85),
        o = i(88),
        s = n.a.osg,
        u = s.Uniform.createFloat4("uColor"),
        l = new r.a(u.getInternalArray(), 1),
        c = function () {
            s.StateSet.call(this), this.init()
        };
    c.updateCallback = l, s.createPrototypeObject(c, s.objectInherit(s.StateSet.prototype, {
        setRenderBinVR: function (e) {
            var t = e ? a.a.TRANSPARENT_NO_EARLYZ_POST : a.a.WIREFRAME;
            this.setRenderBinDetails(t, "RenderBin")
        },
        init: function () {
            this.setRenderBinDetails(a.a.WIREFRAME, "RenderBin"), this.setAttributeAndModes(o.a.DEPTH_LEQUAL_WRITE), this.setAttributeAndModes(o.a.BLEND_SUBSTRACTIVE), this.setShaderGeneratorName("wireframe"), this.addUniform(u), this.addUpdateCallback(l)
        },
        setWireframeColorSmooth: function (e) {
            l.setColorTarget(e)
        },
        setWireframeColor: function (e) {
            u.setFloat4(e)
        },
        setWireframeEnable: function (e, t) {
            if (!e) return void l.hide();
            !0 === l._finished && (u.setFloat3(t), u.getInternalArray()[3] = 0), l.show(t[3])
        }
    })), t.a = c
}, function (e, t, i) {
    "use strict";
    var n = i(24),
        r = i.n(n),
        a = i(5),
        o = i.n(a),
        s = i(0),
        u = (i.n(s), i(9)),
        l = i(79),
        c = i(423),
        h = i(1299),
        d = i(1300),
        f = i(1302),
        p = i(152),
        m = u.a.osg,
        g = 1,
        v = function () {
            m.NodeVisitor.call(this, m.NodeVisitor.TRAVERSE_PARENTS), this._material = void 0, this._manager = void 0
        };
    m.createPrototypeObject(v, m.objectInherit(m.NodeVisitor.prototype, {
        setManager: function (e) {
            this._manager = e
        },
        reset: function () {
            this.nodePath.length = 0, this._material = void 0
        },
        apply: function (e) {
            if (!this._material) {
                var t = e.getStateSet();
                t && (this._material = this._manager.getMaterialByStateSet(t)), this._material || this.traverse(e)
            }
        }
    }));
    var _ = function (e, t) {
        m.NodeVisitor.call(this), this._manager = e, this._useVertexAlpha = t, this._stackMaterial = []
    };
    m.createPrototypeObject(_, m.objectInherit(m.NodeVisitor.prototype, {
        apply: function (e) {
            var t = e.getStateSet(),
                i = t && this._manager.getMaterialByStateSet(t);
            if (i && this._stackMaterial.push(i), e instanceof m.Geometry && this._stackMaterial.length > 0) {
                var n = this._stackMaterial[this._stackMaterial.length - 1];
                e.getVertexAttributeList().Color && (n.set("hasVertexColor", !0), !n.get("hasVertexAlpha") && e.userDataMap.hasVertexAlpha && (n.set("hasVertexAlpha", !0), n.set("vertexAlphaEnable", this._useVertexAlpha))), e.userDataMap && (n.set("hasPoints", e.userDataMap.hasPoints), n.set("hasTriangles", e.userDataMap.hasTriangles), n.set("hasLines", e.userDataMap.hasLines)), n.get("geometryList").push(e)
            }
            this.traverse(e), i && this._stackMaterial.pop()
        }
    }));
    var b = r.a.Model.extend({
        initialize: function () {
            this._materialByStateSetID = {}, this._materialNames = {
                material_: 0
            }
        },
        getImageCollection: function () {
            return this._imageCollection || u.a.osg.error("ImageCollection not initialized in MaterialManager, something is wrong"), this._imageCollection
        },
        setImageCollection: function (e) {
            this._imageCollection = e
        },
        getMatcapCollection: function () {
            return this._matcapCollection || u.a.osg.error("matcapCollection not initialized in MaterialManager, somewhing wrong"), this._matcapCollection
        },
        setMatcapCollection: function (e) {
            this._matcapCollection = e
        },
        setNewMaterial: function (e, t) {
            this.attributes[e] = t;
            var i = t.get("stateSetID");
            void 0 !== i && (this._materialByStateSetID[i] = t)
        },
        addMaterial: function (e) {
            var t = new h.a,
                i = this.getImageCollection();
            return t.setMaterialJSON(e, i), new d.a({
                model: t
            }), this.setNewMaterial(e.id, t), t
        },
        getMaterials: function () {
            return this.attributes
        },
        getMaterialStateID: function (e) {
            if (void 0 !== e._materialID) return e._materialID;
            var t = e.getUserData();
            if (t)
                for (var i = t.length - 1; i >= 0; --i)
                    if ("UniqueID" === t[i].Name) {
                        e._materialID = parseInt(t[i].Value, 10);
                        break
                    } return void 0 === e._materialID && (void 0 !== e._uniqueID ? e._materialID = e._uniqueID : (u.a.osg.warn("v0 StateSet detected"), e._materialID = g++)), e._materialID
        },
        getMaterialByStateSetID: function (e) {
            return void 0 !== e ? this._materialByStateSetID[e] : void 0
        },
        getMaterialByStateSet: function (e) {
            return this.getMaterialByStateSetID(this.getMaterialStateID(e))
        },
        _deleteMaterialById: function (e) {
            var t = this.attributes[e];
            t && delete this._materialByStateSetID[t.get("stateSetID")], delete this.attributes[e]
        },
        removeMaterialByStateSetID: function (e) {
            var t = this.attributes;
            for (var i in t) t[i].get("stateSetID") === e && this._deleteMaterialById(i)
        },
        removeMaterialByStateSet: function (e) {
            var t = this.attributes;
            for (var i in t) {
                if (t[i].get("stateSet") === e) return void this._deleteMaterialById(i)
            }
        },
        removeUnboundMaterial: function () {
            var e = this.attributes;
            for (var t in e) {
                e[t].get("stateSet") || this._deleteMaterialById(t)
            }
        },
        getMaxUvCount: function () {
            var e = this.attributes,
                t = 0;
            for (var i in e) {
                var n = e[i];
                if (!n.get("uidUniqueMerged")) {
                    var r = n.get("texCoordUnitList").length;
                    r > t && (t = r)
                }
            }
            return t
        },
        createMaterial: function (e, t) {
            void 0 === t && (t = e.getOrCreateStateSet());
            var i = new h.a;
            new d.a({
                model: i
            });
            var n = Object(f.a)();
            return i.set("id", n), i.set("stateSetID", this.getMaterialStateID(t)), i.set("name", this.getUniqueMaterialName(t.getAttributeMap().Material, t, e)), this.setNewMaterial(n, i), i
        },
        getUniqueMaterialName: function (e, t, i) {
            var n = this._materialNames,
                r = e && e.getAttribute() ? e.getAttribute().getName() : void 0;
            return void 0 === r && (r = void 0 !== t.getName() ? t.getName() : i.getName()), void 0 === r ? "material_" + n.material_++ : (void 0 === n[r] ? n[r] = 0 : r += "_" + n[r]++, r)
        },
        setWorkFlowMetalSpec: function (e, t) {
            var i = this.attributes;
            for (var n in i) i[n].setWorkFlowMetalSpec(e, t)
        },
        setWorkFlowRoughGloss: function (e, t) {
            var i = this.attributes;
            for (var n in i) i[n].setWorkFlowRoughGloss(e, t)
        },
        overrideMaterialChannels: function (e) {
            if (!Object(l.a)() && e.materialShowcase) {
                var t = e.materialDisplacement,
                    i = e.materialDisplacementFactor,
                    n = e.materialNormal,
                    r = e.materialDiffuse,
                    a = e.materialMetalness,
                    o = e.materialRoughness,
                    u = e.materialGlossiness,
                    c = e.materialSpecular,
                    h = e.materialEmissive,
                    d = e.materialTransparency,
                    f = e.materialCavity,
                    p = e.materialAO,
                    m = e.materialF0,
                    g = e.materialNames || "main_material",
                    v = g.split(";");
                if (e.substanceDisplacement && void 0 !== t) {
                    var _ = this.attributes["ae605e73-2987-4b0f-b25b-bdf1dc02e6ed"];
                    _ || (_ = Object(s.find)(this.attributes, function (e) {
                        return "Sides" === e.get("name")
                    })), _ && this._replaceChannelURL(_.getChannels(), "Displacement", t, !0, i)
                }
                for (var b in this.attributes) {
                    var S = this.attributes[b];
                    if (-1 !== v.indexOf(S.get("name"))) {
                        var x = S.getChannels();
                        r && (this._replaceChannelURL(x, "DiffuseColor", r), this._replaceChannelURL(x, "AlbedoPBR", r), this._replaceChannelURL(x, "DiffusePBR", r)), void 0 !== m && (m.length ? this._replaceChannelURL(x, "SpecularF0", m) : (x.SpecularF0.reset(), x.SpecularF0.setFactor(.5))), void 0 !== n && this._replaceChannelURL(x, "NormalMap", n, !0), void 0 !== t && this._replaceChannelURL(x, "Displacement", t, !0, i), void 0 !== f && this._replaceChannelURL(x, "CavityPBR", f, !0), void 0 !== h && this._replaceChannelURL(x, "EmitColor", h, !0), void 0 !== d && this._replaceChannelURL(x, "Opacity", d, !0), void 0 !== p && (this._replaceChannelURL(x, "AOPBR", p, !0), this._replaceChannelURL(x, "DiffuseIntensity", p, !0)), (c || a) && (this._replaceChannelURL(x, "SpecularPBR", c), this._replaceChannelURL(x, "MetalnessPBR", a), S.setWorkFlowMetalSpec(Boolean(a))), (o || u) && (this._replaceChannelURL(x, "RoughnessPBR", o), this._replaceChannelURL(x, "GlossinessPBR", u), S.setWorkFlowRoughGloss(Boolean(o)))
                    }
                }
            }
        },
        enforceWorkflowPerMaterial: function () {
            var e = this.attributes;
            for (var t in e) e[t].enforceWorkflow()
        },
        _replaceChannelURL: function (e, t, i, n, r) {
            var a = e[t];
            if (!i || !i.length) return void a.setEnable(!1);
            var o = this.getImageCollection(),
                s = o.addNewImage({
                    url: i,
                    name: i,
                    width: 1,
                    height: 1
                });
            a.setupTextureModel({
                image: s
            }), n && a.setEnable(!0), a.setFactor(void 0 === r ? 1 : r)
        },
        tagMaterialWithGeometryInfo: function (e, t) {
            var i = new _(this, t);
            e.accept(i)
        },
        updateTexCoordUnitList: function () {
            var e = this.attributes;
            for (var t in e) e[t].updateTexCoordUnitList()
        },
        findFirstMaterial: function () {
            var e = new v;
            return function (t) {
                var i = t.length,
                    n = t[i - 1];
                if (n._mostInfluencedRig) return e.reset(), e.setManager(this), n._mostInfluencedRig.accept(e), e._material;
                for (var r = i - 1; r >= 0; --r) {
                    var a = t[r].getStateSet();
                    if (a) {
                        var o = this.getMaterialByStateSet(a);
                        if (o) return o
                    }
                }
            }
        }(),
        getJSON: function () {
            var e = {},
                t = this.attributes;
            for (var i in t) e[i] = t[i].getJSON();
            return e
        },
        editorGetJSON: function () {
            var e = {},
                t = this.getImageCollection(),
                i = this.getMatcapCollection();
            for (var n in this.attributes) {
                var r = this.attributes[n].getJSON(),
                    a = r.channels;
                for (var o in a) {
                    var s = a[o];
                    if (s.texture) {
                        var u = "Matcap" === o ? i : t,
                            l = u.get(s.texture.uid),
                            c = l.get("name");
                        s.texture.name = c, delete s.texture.uid, delete s.texture.texCoordUnit, delete s.texture.textureTarget
                    }
                }
                e[n] = {
                    shadeless: r.shadeless,
                    name: r.name,
                    cullFace: r.cullFace,
                    reflection: r.reflection,
                    channels: a
                }
            }
            return e
        },
        editorSetJSON: function (e) {
            var t = this.getImageCollection(),
                i = this.getMatcapCollection(),
                n = [];
            for (var r in this.attributes) {
                var a = e[r];
                a && n.push(function (e, n) {
                    for (var r = [], a = 0, s = p.a.length; a < s; a++) {
                        var u = p.a[a],
                            l = e.channels[u];
                        if (l && l.texture && l.texture.name) {
                            var c = "Matcap" === u ? i : t,
                                h = c.where({
                                    name: l.texture.name
                                })[0];
                            h ? l.texture.uid = h.getUID() : (e.channels[u] = void 0, r.push("texture " + l.texture.name + " not found in the current scene, skipping channel " + u + " for material " + n.get("name")))
                        }
                    }
                    var d = n.setMaterialJSON(e, t, {
                        validate: !0
                    });
                    return d ? o.a.reject(d) : o.a.resolve(r)
                }(a, this.attributes[r]))
            }
            return o.a.all(n)
        }
    });
    b.createMaterialModel = function (e) {
        var t = new h.a;
        new d.a({
            model: t
        });
        var i = e.getName();
        return i && t.set("name", i), (new c.a).setMaterialModel(t), t.setStateSet(e), t
    }, t.a = b
}, function (e, t, i) {
    "use strict";
    i.d(t, "b", function () {
        return x
    }), i.d(t, "a", function () {
        return y
    }), i.d(t, "d", function () {
        return C
    }), i.d(t, "c", function () {
        return b
    });
    var n = i(9),
        r = i(584),
        a = i(69),
        o = i(20),
        s = i(582),
        u = i(635),
        l = i(88),
        c = i(179),
        h = n.a.osg,
        d = Object(o.a)().shadow,
        f = Object(o.a)().shadowAtlas,
        p = f ? 7 : 12,
        m = Object(o.a)().shadowTextureSize;
    n.a.osgShadow.ShadowMap.prototype._preventTextureBindingDuringShadowCasting = function () {
        for (var e = Object(s.a)(), t = h.StateAttribute.OVERRIDE_ON, i = 0; i < e; i++) this._casterStateSet.setTextureAttributeAndModes(i, h.Texture.textureNull, t)
    };
    var g, v, _, b = function (e) {
        return g = new n.a.osgShadow.ShadowSettings, g.setLight(e), g.setShadowCastShaderGeneratorName("shadowcast"), g.setCastsShadowDrawTraversalMask(a.a.SHADOW), g.setCastsShadowBoundsTraversalMask(a.a.SHADOW_BOUNDS), g.userShadowCasterVisitor = !1, g.kernelSizePCF = Object(o.a)().shadowPCF, g.fakePCF = !1, g.setTextureSize(Object(o.a)().shadowTextureSize), g
    };
    f && (v = b(), v.atlasSize = 2 * m, v.setTextureSize(m), _ = new n.a.osgShadow.ShadowMapAtlas(v), _.setTextureUnitBase(p));
    var S = c.a.uShadowMapSize.getInternalArray();
    S[0] = m, S[1] = m;
    var x = function (e, t, i) {
            var a = new h.MatrixTransform;
            a.setName(e + " - LightNode " + t), a.getOrCreateStateSet().setAttributeAndModes(l.a.DEPTH_DISABLE);
            var c = new r.a(t);
            i && c.setLightType(i), c.setName(e + " - Light " + t), h.vec3.copy(c.getAmbient(), h.vec3.ZERO), h.vec3.copy(c.getSpecular(), h.vec3.ZERO), c.setLinearAttenuation(0);
            var f = new h.LightSource;
            if (f.setName("skfb" + e + " - LightSource " + t), f.setLight(c), !d) return {
                node: a,
                light: c,
                lightSource: f,
                shadowSettings: _ ? v : b(c),
                enableShadow: !1
            };
            var m, g;
            if (_ ? (g = v, m = _.addLight(c)) : (g = b(c), m = new n.a.osgShadow.ShadowMap(g), m.setTextureUnitBase(p), m.setContinuousUpdate(!1), m.setTextureSize(Object(o.a)().shadowTextureSize)), m.setJitterOffset(Object(o.a)().shadowJitterOffset), Object(o.a)().stats) {
                var S = m.getCamera(),
                    x = u.a.getTimerGPU();
                S.setInitialDrawCallback(function () {
                    x.start("ShadowMap"), x.start("ShadowMap" + t)
                }), S.setFinalDrawCallback(function () {
                    x.end("ShadowMap" + t), x.end("ShadowMap")
                })
            }
            return {
                node: a,
                light: c,
                lightSource: f,
                shadowSettings: g,
                shadowMap: m,
                enableShadow: d && Object(s.a)() > p
            }
        },
        y = function (e, t) {
            d && (t.setContinuousUpdate(!1), f ? (e.addShadowTechnique(_), _.addShadowMap(t)) : e.addShadowTechnique(t))
        },
        C = function (e, t) {
            f ? _.removeShadowMap(t) : e.removeShadowTechnique(t)
        }
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = n.a.osg,
        a = n.a.osgAnimation,
        o = function (e) {
            for (var t = 0, i = e.length; t < i; ++t) {
                var n, o = e[t];
                if (o instanceof a.Bone) n = a.UpdateBone;
                else {
                    if (!(o instanceof r.MatrixTransform)) continue;
                    n = a.UpdateMatrixTransform
                }
                for (var s = o.getUpdateCallbackList(), u = 0, l = s.length; u < l; ++u)
                    if (s[u] instanceof n) return !0
            }
            return !1
        };
    t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(20),
        a = n.a.osg,
        o = function (e) {
            a.StateAttribute.call(this), this._enable = !e && Object(r.a)().zz
        };
    a.createPrototypeStateAttribute(o, a.objectInherit(a.StateAttribute.prototype, {
        attributeType: "VertexCompression",
        cloneType: function () {
            return new o(!0)
        },
        isEnabled: function () {
            return this._enable
        },
        getHash: function () {
            return "VCMP" + (this._enable ? 1 : 0)
        }
    }), "osg", "VertexCompression"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = n.a.osg,
        a = {};
    a.base64 = function (e, t) {
        return "data:" + e + ";base64," + t
    }, a.isMobile = function () {
        var e = !1;
        return function (t) {
            (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0, 4))) && (e = !0)
        }(navigator.userAgent || navigator.vendor || window.opera), e
    }, a.isFirefox = function () {
        return /firefox/i.test(navigator.userAgent)
    }, a.isIOS = function () {
        return /(iPad|iPhone|iPod)/g.test(navigator.userAgent)
    }, a.isIFrame = function () {
        try {
            return window.self !== window.top
        } catch (e) {
            return !0
        }
    }, a.appendQueryParameter = function (e, t, i) {
        return e += (e.indexOf("?") < 0 ? "?" : "&") + t + "=" + i
    }, a.getQueryParameter = function (e) {
        e = e.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
        var t = new RegExp("[\\?&]" + e + "=([^&#]*)"),
            i = t.exec(location.search);
        return null === i ? "" : decodeURIComponent(i[1].replace(/\+/g, " "))
    }, a.isLandscapeMode = function () {
        return 90 === window.orientation || -90 === window.orientation
    }, a.getScreenWidth = function () {
        return Math.max(window.screen.width, window.screen.height) * window.devicePixelRatio
    }, a.getScreenHeight = function () {
        return Math.min(window.screen.width, window.screen.height) * window.devicePixelRatio
    }, a.projectionMatrixToVector_ = function (e, t) {
        var i = t || {},
            n = i.xScale || 1,
            a = i.yScale || 1,
            o = i.xTrans || 0,
            s = i.yTrans || 0,
            u = r.vec4.create();
        return u[0] = e[0] * n * .5, u[1] = e[5] * a * .5, u[2] = .5 * (e[8] - 1 - o), u[3] = .5 * (e[9] - 1 - s), u
    }, a.leftProjectionVectorToRight_ = function (e) {
        return r.vec4.fromValues(e[0], e[1], -e[2] - 1, e[3])
    }, t.a = a
}, function (e, t, i) {
    "use strict";
    i.d(t, "b", function () {
        return h
    });
    var n, r, a, o = i(20),
        s = i(44),
        u = document.createElement("canvas"),
        l = document.createElement("canvas"),
        c = function (e, t, i, n) {
            u.width === t && u.height === i || (n.width = t, n.height = i, u.width = t, u.height = i, r = new Uint8Array(4 * t * i));
            var a = e.getGraphicContext(),
                o = a.checkFramebufferStatus(a.FRAMEBUFFER);
            if (o !== a.FRAMEBUFFER_COMPLETE) return console.error("FRAMEBUFFER status invalid.", o);
            a.flush(), a.finish(), a.readPixels(0, 0, t, i, a.RGBA, a.UNSIGNED_BYTE, r);
            var s = u.getContext("2d"),
                l = s.getImageData(0, 0, t, i);
            l.data.set(r), s.putImageData(l, 0, 0);
            var c = n.getContext("2d");
            c.clearRect(0, 0, t, i), c.fillStyle = "transparent", c.fillRect(0, 0, t, i), c.save(), c.globalCompositeOperation = "copy", c.scale(1, -1), c.drawImage(u, 0, 0, t, i, 0, -i, t, i), c.restore()
        },
        h = function (e, t, i, r) {
            return r || (r = l), c(e, t, i, r), Object(o.a)().downloadPicture && (n || (n = document.createElement("a"), document.body.appendChild(n), n.style.display = "none"), n.href = r.toDataURL("image/jpeg"), n.download = "image.jpg", n.click()), r
        },
        d = function (e) {
            e.getScene().updateSceneGraph(e.getUpdateVisitor());
            var t = e.getCamera().getRenderer();
            t.cull(), t.draw()
        },
        f = function (e, t, i) {
            var n = e.getFeatures(),
                r = e.getSuperSample(),
                o = e.getViewerOSGJS(),
                u = e.getFeaturesManager().getNodeGizmo(),
                l = o.getCamera();
            for (var c in n) n[c].prepareForScreenShot();
            a = void 0, u && u.getNodeMask() && (a = u.getNodeMask(), u.setNodeMask(0)), e.trigger("resizeViewer", t, i), o.updateViewport(), s.a.setPoseForScreenshot(!0), o.checkNeedToDoFrame(), d(o), l.setFinalDrawCallback(function (e) {
                r.isEnabled() || h(e, t, i)
            })
        },
        p = function (e) {
            var t = e.getFeatures(),
                i = e.getViewerOSGJS(),
                n = e.getFeaturesManager().getNodeGizmo(),
                r = i.getCamera();
            s.a.setPoseForScreenshot(!1), r.setFinalDrawCallback(void 0);
            for (var o in t) t[o].resetAfterScreenShot();
            a && n.setNodeMask(a), e.trigger("resizeViewerOnNextFrame", -1, -1)
        },
        m = function (e, t, i, n) {
            var r = i.getSuperSample(),
                a = i.getViewerOSGJS();
            if (e && t || (e = a.getCanvasWidth(), t = a.getCanvasHeight()), f(i, e, t), r.canBeEnabled())
                for (r.forceEnable(); r.isEnabled();) r.updateFrame(), d(a);
            else d(a);
            return p(i), n || (a.updateViewport(), i.getFeatures().inspector.getModel().trigger("change:viewerToCanvasRatio")), l
        };
    t.a = m
}, , function (e, t, i) {
    "use strict";
    var n = i(3),
        r = i.n(n);
    t.a = {
        onFullScreenChange: function (e) {
            var t = r()(document);
            t.on("fullscreenchange", e), t.on("webkitfullscreenchange", e), t.on("MSFullscreenchange", e), t.on("mozfullscreenchange", e)
        },
        offFullScreenChange: function (e) {
            var t = r()(document);
            t.off("fullscreenchange", e), t.off("webkitfullscreenchange", e), t.off("MSFullscreenchange", e), t.off("mozfullscreenchange", e)
        },
        hasFullscreen: function () {
            return document.fullscreenEnabled || document.webkitFullscreenEnabled || document.msFullscreenEnabled || document.mozFullScreenEnabled
        },
        isFullscreen: function () {
            return document.fullScreen || document.mozFullScreen || void 0 !== document.msFullscreenElement && null !== document.msFullscreenElement || document.webkitIsFullScreen
        },
        requestFullscreen: function (e) {
            e.requestFullscreen ? e.requestFullscreen() : e.webkitRequestFullscreen ? e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT) : e.msRequestFullscreen ? e.msRequestFullscreen() : e.mozRequestFullScreen && e.mozRequestFullScreen()
        },
        exitFullscreen: function () {
            document.exitFullscreen ? document.exitFullscreen() : document.webkitExitFullscreen ? document.webkitExitFullscreen() : document.msExitFullscreen ? document.msExitFullscreen() : document.mozCancelFullScreen && document.mozCancelFullScreen()
        }
    }
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(161),
        a = n.a.osg,
        o = function () {
            r.a.apply(this, arguments)
        };
    a.setStateAttributeConfig(o, {
        attribute: ["VertexCompression", "SketchfabMaterial", "Morph", "Skinning", "PointSize"],
        textureAttribute: ["Texture"]
    }), a.createPrototypeObject(o, a.objectInherit(r.a.prototype, {
        getCompilerName: function () {
            return "EarlyZ"
        },
        getFragmentMain: function () {
            return "earlyz.frag"
        },
        getVertexMain: function () {
            return "earlyz.vert"
        },
        defineChannels: function () {
            var e = this._channels;
            e && (this.defineChannel(e.Opacity), this.defineChannel(e.Displacement), this.defineChannel(e.SubsurfaceScattering))
        }
    })), t.a = o
}, , , , , , , , , , , function (e, t, i) {
    "use strict";
    var n = i(1066),
        r = i(1262),
        a = i(1281),
        o = i(1303),
        s = i(1306),
        u = i(1309),
        l = i(1313),
        c = i(1322),
        h = i(1331),
        d = i(1334),
        f = i(1346),
        p = i(1351),
        m = i(1395),
        g = i(1400),
        v = i(1422),
        _ = i(1427),
        b = i(1435),
        S = i(1443);
    t.a = [n.a, r.a, a.a, o.a, s.a, u.a, l.a, c.a, h.a, d.a, f.a, p.a, m.a, g.a, v.a, _.a, b.a, S.a]
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(3)),
        a = i.n(r),
        o = i(38),
        s = i.n(o),
        u = i(424),
        l = i.n(u),
        c = i(8),
        h = i(53),
        d = i(25),
        f = i(307),
        p = i(79),
        m = i(2),
        g = i(13),
        v = i(677),
        _ = i(475),
        b = i(67),
        S = i(600),
        x = i(91),
        y = i(62),
        C = i(1460),
        T = i(1461),
        w = i(1462),
        M = i(940),
        E = i(1464),
        A = i(1465),
        P = i(1466),
        R = i(1467),
        O = i(1468),
        I = i(678),
        F = i(1469),
        N = i(1470),
        D = i(752),
        L = i(47),
        k = i(1471),
        V = i(942),
        B = i(20),
        U = i(717),
        G = i(163),
        j = i(639),
        z = i(14),
        H = i(445),
        W = (i.n(H), z.a.shortcuts),
        q = new l.a({
            device: "WEB",
            listen: !0
        });
    t.a = c.a.extend({
        subviews: {},
        events: {
            'click [data-action="start"]': "onStart",
            'click [data-action="stop"]': "onStop",
            click: "globalCloseEvent",
            touchend: "globalCloseEvent",
            'click [data-action="inspector"]': "toggleInspector"
        },
        templates: {
            viewerMode: m.default.getFromMacro("skfb_front/macros/viewer", "help_viewer_mode"),
            viewerVr: m.default.getFromMacro("skfb_front/macros/viewer", "help_vr_mode")
        },
        initialize: function () {
            c.a.prototype.initialize.apply(this, arguments), this.proxySettings = new y.a({
                shadingStyle: null,
                viewerMode: null,
                wireframeColor: null,
                wireframeEnable: null,
                hasWireframe: null,
                annotationsVisible: null,
                textureQuality: null,
                speed: null,
                cycleMode: null,
                fps: null
            }), this.initializeMandatorySubviews(), this.initializeHashMessages(), this.initializeSoundManager(), this.delegateGlobalMoveEvent(), this.delegateSubviews(), this.isVR() && s.a.apple.device && this.hackIosCanvasRender(), s.a.any || !v.a || Object(B.a)().transparent || this.hackDesktopSafariCanvasBackground()
        },
        _createSubview: function (e, t, i) {
            return this.subviews[e] = new t(Object(n.extend)({}, {
                viewer: this,
                widgets: this.subviews
            }, i)), this.subviews[e]
        },
        globalCloseEvent: function (e) {
            a()(e.target).hasClass("has-menu") || a()(e.target).parents(".has-menu").length || (this.subviews.hotspots && this.subviews.hotspots.toggleAnnotationList(!1), this.subviews.gui.closeMenus())
        },
        delegateGlobalMoveEvent: function () {
            var e = function (e) {
                    "canvas" === e.target.tagName.toLowerCase() && (clearTimeout(this._showGuiTimeout), clearTimeout(this._hideGuiTimeout), this._hideGuiTimeout = setTimeout(function () {
                        this.$el.addClass("moving")
                    }.bind(this), 150))
                },
                t = function (e) {
                    "canvas" === e.target.tagName.toLowerCase() && (clearTimeout(this._hideGuiTimeout), clearTimeout(this._showGuiTimeout), e.preventDefault(), this._showGuiTimeout = setTimeout(function () {
                        this.$el.hasClass("moving") && this.$el.removeClass("moving")
                    }.bind(this), 500))
                },
                i = function (e) {
                    var t = e.relatedTarget || e.toElement;
                    s.a.any || (clearTimeout(this.globalIdleTimeout), this.$el.find(t).length || (this.globalIdleTimeout = setTimeout(this.onGlobalIdleTimeout.bind(this), 3500)))
                },
                r = function () {
                    clearTimeout(this.globalIdleTimeout), (this.$el.hasClass("idle") || this.$el.hasClass("moving")) && (this.$el.removeClass("idle moving"), Object(n.each)(this.subviews, function (e) {
                        e.trigger("idle", !1)
                    }))
                };
            if (!Object(p.a)()) {
                var o;
                this.el.addEventListener("touchmove", this.preventScroll.bind(this), {
                    passive: !1
                }), this.$el.on("mousedown touchstart", e.bind(this)), this.$el.on("mouseup touchend", t.bind(this)), this.$el.on("mousewheel", function (e) {
                    "canvas" === e.target.tagName.toLowerCase() && (this.$el.addClass("moving"), clearTimeout(o), o = setTimeout(function () {
                        this.$el.removeClass("moving")
                    }.bind(this), 300))
                }.bind(this)), a()(this.el).on("mouseout", i.bind(this)), a()(this.el).on("mouseenter mousein", r.bind(this))
            }
        },
        preventScroll: function (e) {
            if (e.target.classList.contains("canvas")) return e.preventDefault();
            var t = void 0 !== e.target.dataset.hotspotTarget;
            this.subviews && this.subviews.helpOverlay && !this.subviews.helpOverlay.isVisible() && !t && e.preventDefault()
        },
        onGlobalIdleTimeout: function () {
            Object(p.a)() || (this.$el.addClass("idle"), Object(n.each)(this.subviews, function (e) {
                e.trigger("idle", !0)
            }))
        },
        initializeMandatorySubviews: function () {
            this._createSubview("gui", C.a, {
                el: this.$el
            }), this._createSubview("loading", T.a, {
                el: this.$(".loading-container"),
                color: Object(j.b)(Object(B.a)().uiColor)
            }), this._createSubview("hint", w.a, {
                el: this.$el,
                fallback: !Object(f.a)()
            }), this._createSubview("generalControls", M.a, {
                el: Object(f.a)() ? this.$(".general-controls") : this.$(".fallback .controls"),
                fallback: !Object(f.a)()
            }), this._createSubview("header", E.a, {
                el: this.$(".titlebar")
            }), this._createSubview("snapshot", A.a, {
                el: this.$el
            }), this._createSubview("helpOverlay", P.a, {
                el: this.$(".help.overlay")
            }), this._createSubview("hotspotsOverlay", R.a, {
                el: this.$(".hotspots-overlay")
            }), this._createSubview("helperVrOverlay", I.a.extend({
                setUrl: function (e) {
                    this.$(".url").attr("href", e).text(e)
                }
            }), {
                el: this.$(".helper-vr-overlay")
            }), this._createSubview("osd", F.a, {
                el: this.$el
            })
        },
        initShortcuts: function () {
            this.viewerRenderingShortcuts = new _.a(W.viewerRendering), this.viewerRenderingShortcuts.on("toggleWireframe", function () {
                if (this.proxySettings.get("hasWireframe")) {
                    var e = !this.proxySettings.get("wireframeEnable");
                    g.a.modelViewerWireframeShortcut(e), this.proxySettings.set("wireframeEnable", e)
                }
            }.bind(this)), this.viewerRenderingShortcuts.on("inspector", this.toggleInspector, this), this.viewerRenderingShortcuts.listen([this.viewerRenderingShortcuts.getShortcut("toggleWireframe"), this.viewerRenderingShortcuts.getShortcut("inspector")]), this.viewerRenderingShortcuts.on("defaultRenderingMode", function () {
                this.proxySettings.set("shadingStyle", "lit")
            }.bind(this)), this.viewerRenderingShortcuts.on("shadelessRenderingMode", function () {
                this.proxySettings.set("shadingStyle", "shadeless")
            }.bind(this)), this.viewerRenderingShortcuts.on("matcapRenderingMode", function () {
                this.proxySettings.set("shadingStyle", "matcap")
            }.bind(this)), this.updateShorcuts()
        },
        updateShorcuts: function () {
            "lit" === this._currentModel.get("options").shading.type || Object(p.a)() ? this.viewerRenderingShortcuts.listen([this.viewerRenderingShortcuts.getShortcut("defaultRenderingMode"), this.viewerRenderingShortcuts.getShortcut("shadelessRenderingMode"), this.viewerRenderingShortcuts.getShortcut("matcapRenderingMode")]) : this.viewerRenderingShortcuts.stopListening(["defaultRenderingMode", "shadelessRenderingMode", "matcapRenderingMode"])
        },
        blurHotspots: function () {
            this.subviews.hotspots && (this.subviews.hotspots.hideTooltips(), this.subviews.hotspots.currentHotspot = -1, this.subviews.hotspots.renderControl())
        },
        initializeHashMessages: function () {
            Object(B.a)().isApp && q.on("message:vrMode", function (e) {
                var t = parseInt(e.data.vrMode, 10);
                this.blurHotspots(), this.scene.getFeatures().webVR.getModel().set("enable", !!t), e.removeFromHash()
            }.bind(this))
        },
        initializeHotspotsSubviews: function (e) {
            var t = this;
            i.e(16).then(i.bind(null, 1719)).then(function (i) {
                var n = i.default,
                    r = t.scene.getFeatures().hotspot,
                    a = r.getModel();
                t._createSubview("hotspots", n, {
                    el: t.$el,
                    model: a,
                    container: t.$(".hotspots"),
                    fallback: !Object(f.a)()
                }), "function" == typeof e && e()
            })
        },
        initializeAnimationSubviews: function (e) {
            var t = this;
            i.e(25).then(i.bind(null, 1720)).then(function (i) {
                var n = i.default,
                    r = t.scene.getFeatures().animation.getModel();
                t._createSubview("animationControls", n, {
                    el: t.$(".animation-controls"),
                    model: r,
                    currentModel: t._currentModel,
                    enabled: !t.isVR()
                }), "function" == typeof e && e()
            })
        },
        delegateSubviews: function () {
            this.isVR() ? (this.subviews.gui.disable(), this.subviews.header.disable()) : (this.subviews.loading.on("loaded", setTimeout.bind(window, this.subviews.gui.enable.bind(this.subviews.gui), 500)), this.subviews.header.enable()), this.subviews.loading.on("loaded", function () {
                Object(B.a)().transparent || this.$el.addClass("transparent-pattern")
            }.bind(this))
        },
        onStart: function () {
            this.start(), this._startTracked || (this._startTracked = !0)
        },
        start: function (e) {
            this.$el.addClass("started"), !0 === e ? g.a.modelEmbedAutostart(this._currentUid) : g.a.modelEmbedPlayButtonClicked(this._currentUid), this.$el.hasClass("transparent") || this.$el.addClass("transparent-pattern"), this._options && this.load();
            var t = this.scene && this.scene.getViewerOSGJS && this.scene.getViewerOSGJS();
            return t && L.a.getHasAnimation().then(function (e) {
                if (e) {
                    var i = this.scene.getFeatures().animation,
                        n = i.getModel();
                    this._wasPlaying && (n.set("playing", !0), this._wasPlaying = void 0)
                }
                t.run()
            }.bind(this)), S.a.setEnabled(!0), this.trigger("started"), this
        },
        onStop: function () {
            this.subviews.modelInspector && (this.subviews.modelInspector.close(), a()(".summary").removeClass("shifted"), a()(".watermark").removeClass("shifted-watermark")), this.stop()
        },
        stop: function () {
            var e = this._currentModel ? this._currentModel.get("uid") : this._currentUid;
            g.a.modelEmbedStopButtonClicked(e), this.$el.removeClass("started");
            var t = this.scene && this.scene.getViewerOSGJS && this.scene.getViewerOSGJS();
            return t && (L.a.getHasAnimation().then(function (e) {
                if (e) {
                    var t = this.scene.getFeatures().animation,
                        i = t.getModel();
                    this._wasPlaying = i.get("playing"), this._wasPlaying && i.set("playing", !1)
                }
            }.bind(this)), t.stop()), this.subviews.hotspots && this.subviews.hotspots.triggerHotspotCycle(!1), S.a.setEnabled(!1), this.trigger("stopped"), this
        },
        load: function () {
            if (this._options) {
                var e = this._options;
                this._options = null, this.scene && (this.scene.drop(), this.scene = null), this.subviews.loading.reset(), this.$el.removeClass("model-loaded"), this.$el.addClass("model-loading"), y.a.get(e.uid).then(this.onModelLoad.bind(this, e))
            }
        },
        lookat: function (e, t, i) {
            void 0 === i && (i = 1);
            var n = this.scene.getFeatures(),
                r = n.camera.getModel();
            r.set("animationDuration", i), r.setTargetAndEye(t, e)
        },
        isVR: function () {
            return this.scene ? this.scene.getFeatures().webVR.getModel().get("enable") : Object(B.a)().cardboard > 0
        },
        isCardboard: function () {
            return Object(B.a)().cardboard > 0
        },
        onModelLoad: function (e, t) {
            G.a.client.setTagsContext({
                frontend: "3d"
            }), this._currentModel = t, t.hit();
            var i = this.scene = this.createScene(t, e);
            if (this.subviews.loading.handleLoading({
                    model: t,
                    scene: i
                }), i.run(), !Object(f.a)()) return void this.$el.addClass("fallback-mode");
            this.initShortcuts(), this.initViewerFeatures(), this.subviews.hint.show(), this.trigger("model-loaded"), G.a.client.setTagsContext({
                frontend: "web"
            })
        },
        errorHandler: function (e) {
            if (e instanceof d.c) {
                var t, i, r, a, o, s = Object(x.e)(e.account);
                switch (e.feature) {
                    case "sound":
                        i = "sound track", r = "sounds", o = Object(x.b)(e.account);
                        break;
                    case "hotspot":
                        i = "annotation", r = "annotations", o = Object(x.a)(e.account);
                        break;
                    default:
                        throw e
                }
                o ? (a = ["You have reached the maximum number of <b>" + i + "s</b> allowed by Sketchfab.", "Have custom needs?"], t = {
                    href: "mailto:{{ ENTERPRISE_ADDRESS }}?Subject=Custom needs - " + i,
                    text: "Contact us"
                }) : (a = ["You have reached the maximum number of <b>" + e.limitReached + " " + i + b.g(e.limitReached) + "</b> allowed by your plan.", "To add a new " + i + ", you need to upgrade to " + s + " plan."], t = {
                    href: "/plans",
                    text: "Upgrade to " + s
                }), new D.a(Object(n.extend)(e, {
                    popupSubTitle: "You cannot add a new " + i,
                    popupMessages: a,
                    additionalButton: t,
                    popupImg: r
                })).open()
            } else this.subviews.osd.show(e.message, arguments)
        },
        setScene: function (e) {
            if (this.scene) throw new Error("It is currently impossible to reset a scene");
            return this._options = e, this._currentUid = e.uid, this
        },
        createScene: function (e, t) {
            if (Object(f.a)()) {
                var i = {};
                return i.el = this.$(".webgl"), i.features = t.features, i.widgetAPI = t.widgetAPI, i.model = e, i.viewerAPI = t.viewerAPI, L.a.getPolygon().then(function (e) {
                    g.a.modelViewerPolygonLoaded(e.time)
                }), L.a.getWireframe().then(function (e) {
                    g.a.modelViewerWireframeLoaded(e.time)
                }), L.a.getLowResLoaded().then(function (e) {
                    g.a.modelViewerLowResTexturesLoaded(e.time, e.count)
                }), L.a.getHighResLoaded().then(function (e) {
                    g.a.modelViewerHighResTexturesLoaded(e.time, e.count)
                }), L.a.getModelDisplayed().then(function (e) {
                    g.a.modelViewerModelDisplayed(e.time)
                }), new V.a(i)
            }
            return g.a.modelViewerFallbackDisplayed(e.get("uid")), new k.a({
                model: e,
                el: this.$(".fallback"),
                features: t.features
            })
        },
        initViewerFeatures: function () {
            this.initializeSound(), L.a.getModelDisplayed().then(function () {
                L.a.getHasAnimation().then(function (e) {
                    e && this.initializeAnimation()
                }.bind(this)), this.initializeHotspots(), this.initializeShading(), this.initializeViewerMode(), this.initializeTextureQuality(), this.initializeVr(), this.initializeModelInspector()
            }.bind(this))
        },
        initializeHotspots: function () {
            var e = this.scene.getFeatures().hotspot,
                t = e && e.getModel();
            t && this.initializeHotspotsSubviews(function () {
                var e = this.subviews.hotspots;
                t.setUpdateCallback(e.refreshHotspots.bind(e));
                var i = t.get("hotspots");
                i.on("add remove sort change:title change:description change:position", e.refreshHotspots, e), i.on("add remove sort change:name", e.updateHotspotsControls, e), i.on("add remove", Object(n.debounce)(this.subviews.generalControls.renderSettings, 100), this.subviews.generalControls), i.on("select", e.onHotspotSelected, e), i.on("add", e.showAnnotations, e), i.on("remove", function () {
                    0 === i.length && e.hideAnnotations()
                }), this.proxySettings.on("change:annotationsVisible", function () {
                    i.length && this.proxySettings.get("annotationsVisible") ? e.showAnnotations() : e.hideAnnotations()
                }.bind(this)), this.proxySettings.set("annotationsVisible", t.get("visible"), {
                    silent: !0
                }), e.refreshHotspots(), e.updateHotspotsControls(), L.a.getFirstCameraAnimation().then(function () {
                    if (t.on("hotspot-error", this.errorHandler.bind(this)), !0 === Object(B.a)().annotationCycleAutostart) {
                        var e = Math.max(Object(B.a)().annotation, 1);
                        i.trigger("select", i.at(e - 1)), this.subviews.hotspots.triggerHotspotCycle(!0)
                    } else Object(B.a)().annotation > 0 && i.trigger("select", i.at(Object(B.a)().annotation - 1))
                }.bind(this))
            }.bind(this))
        },
        initializeAnimation: function () {
            var e = this.scene.getFeatures().animation,
                t = e.getModel();
            this.initializeAnimationSubviews(function () {
                this.$el.addClass("has-animation"), this.subviews.generalControls.setHasAnimations(!0), this.proxySettings.set("speed", t.get("speed")), this.proxySettings.set("cycleMode", t.get("cycleMode")), this.proxySettings.set("fps", t.get("fps")), this.proxySettings.on("change:speed", function (e, i) {
                    t.set("speed", i)
                }), this.proxySettings.on("change:cycleMode", function (e, i) {
                    t.set("cycleMode", i)
                }), this.proxySettings.on("change:fps", function (e, i) {
                    t.set("fps", i)
                }), t.on("change:fps", function (e, t) {
                    this.proxySettings.set("fps", t)
                }.bind(this)), this.$(".osd").addClass("padded"), this.$(".timeline").removeClass("disabled")
            }.bind(this))
        },
        isFeatureAvailable: function (e, t, i) {
            return e && t && 0 !== i.length
        },
        initializeModelInspector: function () {
            var e = this.scene.getFeatures().inspector,
                t = this.proxySettings,
                i = this.$(".model-inspector");
            if (!this.isFeatureAvailable(Object(B.a)().uiInspector, e, i)) return void this.$('[data-action="inspector"]').hide();
            var n = e.getModel();
            this._createSubview("modelInspector", O.a, {
                model: n,
                inspectableTextures: Object(p.a)() || this.scene.model.get("isInspectable"),
                wireframeModel: t,
                osd: this.subviews.osd,
                el: i
            }), Object(B.a)().uiInspectorOpen && this.toggleInspector(), this.subviews.generalControls.listenTo(n, "change:uiVisible", function (e, t) {
                this.$('[data-action="inspector"]').toggleClass("active", t), a()(".summary").toggleClass("shifted", t), a()(".controls").toggleClass("shifted", t)
            }.bind(this)), Object(p.a)() && this.listenTo(n, "change:uiVisible", function (e, t) {
                var i = this.scene._widgetAPI,
                    n = this.subviews.modelInspector.model;
                t ? (n.initAvailableView(), i.alert("To edit the model, close the Inspector.", {
                    continue: !0,
                    continueLabel: "Close Inspector"
                }).then(function () {
                    this.$("canvas").focus(), this.toggleInspector()
                }.bind(this)).catch(function (e) {
                    if ("Resuming editor" !== e) throw e
                })) : i.resume()
            }.bind(this))
        },
        toggleInspector: function () {
            this.subviews.modelInspector && (g.a.modelViewerInspectorButtonClicked(), this.subviews.modelInspector.toggle(), this.subviews.snapshot.$(".snapshot.widget").toggle(), this.subviews.header.$(".actions").toggle())
        },
        initializeTextureQuality: function () {
            var e = this,
                t = this.scene.getFeatures().quality;
            if (t) {
                var i = t.getModel();
                i.get("promiseReady").then(function (e) {
                    this.subviews.generalControls.generateTextureQualitySettings(e), this.subviews.generalControls.settings.onTextureQualityReady.call(this.subviews.generalControls.settings, e)
                }.bind(this)), this.proxySettings.on("change:textureQuality", function () {
                    var t = parseInt(this.get("textureQuality"), 10);
                    window.requestAnimationFrame(function () {
                        i.set("level", t)
                    });
                    var n = e.subviews.generalControls.getSettingLabelForValue("textureQuality", t + "");
                    e.$(".control-badge").text(n).addClass("active")
                })
            }
        },
        initializeViewerMode: function () {
            var e = this.scene.getFeatures().camera;
            if (e) {
                var t = e.getModel(),
                    i = t.get("indexManipulator");
                this.proxySettings.set("viewerMode", i), this.subviews.gui.renderSetting("viewerMode", i), this.proxySettings.on("change:viewerMode", function () {
                    t.set("indexManipulator", parseInt(this.proxySettings.get("viewerMode"), 10)), this.scene.getFeaturesManager().focusOnSavedCamera(1), this.$("canvas").focus()
                }.bind(this))
            }
        },
        initializeShading: function () {
            var e = this.scene.getFeatures().shadingStyle;
            if (e) {
                var t = e.getModel(),
                    i = this,
                    n = function () {
                        i.proxySettings.set("shadingStyle", t.get("type")), i.proxySettings.set("wireframeColor", t.get("wireframeColor")), i.proxySettings.set("wireframeEnable", t.get("wireframeEnable")), i.proxySettings.set("hasWireframe", t.get("hasWireframe")), i.subviews.gui.renderSetting("wireframeColor", i.proxySettings.get("wireframeColor")), i.subviews.gui.renderSetting("wireframeEnable", i.proxySettings.get("wireframeEnable") ? 1 : 0), i.subviews.gui.renderSetting("hasWireframe", i.proxySettings.get("hasWireframe") ? 1 : 0), i.subviews.gui.renderSetting("shadingStyle", i.proxySettings.get("shadingStyle"))
                    };
                n(), this.proxySettings.listenTo(t, "change", n), this.proxySettings.on("change:shadingStyle", function () {
                    t.set("type", this.get("shadingStyle"))
                }), this.proxySettings.on("change:wireframeColor", function () {
                    this.get("wireframeEnable") ? t.setWireframeColorSmooth(this.get("wireframeColor")) : t.set("wireframeColor", this.get("wireframeColor"))
                }), this.proxySettings.on("change:wireframeEnable", function () {
                    t.set("wireframeEnable", !!this.get("wireframeEnable"))
                })
            }
        },
        initializeVr: function () {
            if (this.isVR()) {
                this.$el.addClass("vr-mode");
                if (1 === h.a.get("sf_show_vr_hint", 1)) {
                    var e = this.templates.viewerVr([U.a.hasFullscreen()]);
                    this.subviews.osd.show(e, {
                        duration: 5e3
                    })
                }
                h.a.set("sf_show_vr_hint", 0, {
                    expires: 504e5
                })
            } else Object(B.a)().vrLinkNavigation && this.subviews.osd.show(s.a.any ? "Tap on Screen or Press any button to switch to VR" : "Press Enter to switch to VR", {
                duration: 5e3
            })
        },
        initializeSoundManager: function () {
            this.proxySettings.on("sound-error", this.errorHandler.bind(this)), this.proxySettings.on("sound-hide", this.subviews.osd.hide.bind(this.subviews.osd)), this.proxySettings.on("sound-show", this.subviews.osd.show.bind(this.subviews.osd)), S.a.setProxyModel(this.proxySettings)
        },
        initializeSound: function () {
            var e = this.scene.getFeatures().sound;
            if (e) {
                var t = e.getModel(),
                    i = t.get("soundtracks"),
                    n = this._createSubview("sound", N.a, {
                        el: this.$(".general-controls .volume"),
                        model: t
                    });
                i.on("add", n.show, n), i.on("remove", function () {
                    0 === i.length && n.hide()
                }), i.length && t.get("visible") && n.show(), t.on("sound-error", this.errorHandler.bind(this))
            }
        },
        hackDesktopSafariCanvasBackground: function () {
            this.$("canvas").parent().css({
                backgroundColor: "#000"
            })
        },
        hackIosCanvasRender: function () {
            Object(n.defer)(function () {
                a()("canvas")[0].style.width = a()("canvas")[0].clientWidth + 1 + "px", Object(n.defer)(function () {
                    a()("canvas")[0].style.width = a()("canvas")[0].clientWidth - 1 + "px", a()("canvas")[0].style.width = ""
                })
            })
        }
    })
}, , , , , , , , , , , , , , , , , , , , function (e, t, i) {
    "use strict";
    t.a = function (e, t) {
        var i, n, r = e.length,
            a = t.length,
            o = [];
        if (!r) return a;
        if (!a) return r;
        for (i = 0; i <= r; i++) o[i] = [i];
        for (n = 0; n <= a; n++) o[0][n] = n;
        for (n = 1; n <= a; n++)
            for (i = 1; i <= r; i++) e[i - 1] === t[n - 1] ? o[i][n] = o[i - 1][n - 1] : o[i][n] = Math.min(o[i - 1][n], o[i][n - 1], o[i - 1][n - 1]) + 1;
        return o[r][a]
    }
}, function (e, t, i) {
    "use strict";
    t.a = function (e) {
        return e = e.substring(e.lastIndexOf("/") + 1), e = e.split("."), e = e[e.length > 1 ? e.length - 2 : e.length - 1], e.split("_").pop().toLowerCase()
    }
}, function (e, t, i) {
    "use strict";
    var n = i(266),
        r = i(267),
        a = i(2),
        o = i(6),
        s = i(1),
        u = o.a.extend({
            displayName: "UpgradePlanPopupContent",
            optionTypes: {
                popupSubTitle: s.b.string.isRequired
            },
            events: {
                "click .upgrade-additional-callback": "additionalButtonCallback"
            },
            additionalButtonCallback: function () {
                this.options.additionalButton & "function" == typeof this.options.additionalButton.callback && this.options.additionalButton.callback.apply(this, arguments)
            },
            template: function () {
                return a.default.getFromString('            {% if options.popupImg %}<div class="illustration --{{ options.popupImg }}"></div>{% endif %}            <p class="title">{{ options.popupSubTitle }}</p>            <div class="infos">                {% for message in options.popupMessages %}                    <p>{{message|safe}}</p>                {% endfor %}            </div>            <div class="actions">                {% if options.nextPlan %}                    <div class="btn-wrapper">                        <a class="button btn-huge btn-important upgrade-link" href="/plans" target="_blank">Upgrade to {{ options.nextPlan }}</a>                    </div>                {% endif %}                {% if options.additionalButton %}                    <div class="btn-wrapper">                        <a class="button btn-large btn-primary upgrade-additional-callback"                        {% if options.additionalButton.href %}href="{{ options.additionalButton.href }}" target="_blank"{% endif %}>{{ options.additionalButton.text }}</a>                    </div>                {% endif %}            </div>            ', {
                    options: this.options
                })
            }
        });
    t.a = Object(n.a)(o.a.extend({
        template: function () {
            return a.default.getFromString("{{ components.popup | component }}", {
                components: this.createChildrenComponents({
                    popup: {
                        viewClass: r.a,
                        options: {
                            title: "",
                            className: "upgrade-plan-popup",
                            child: {
                                viewClass: u,
                                options: {
                                    popupImg: this.options.popupImg,
                                    popupSubTitle: this.options.popupSubTitle,
                                    popupMessages: this.options.popupMessages,
                                    nextPlan: this.options.nextPlan,
                                    additionalButton: this.options.additionalButton
                                }
                            }
                        }
                    }
                })
            })
        }
    }))
}, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , function (e, t, i) {
    "use strict";
    t.a = {
        name: "OpenSceneGraph",
        version: "0.2.9",
        author: "Cedric Pinson <trigrou@trigrou.com> (http://cedricpinson.com)"
    }
}, function (e, t, i) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: !0
    });
    var n = i(679),
        r = i(1078),
        a = i(1079),
        o = i(362),
        s = i(317),
        u = i(447),
        l = i(178),
        c = i(680),
        h = i(197),
        d = i(1080),
        f = i(611),
        p = i(571),
        m = i(449),
        g = i(849),
        v = i(573),
        _ = i(850),
        b = i(574),
        S = i(365),
        x = i(856),
        y = i(291),
        C = i(289),
        T = i(1085),
        w = i(363),
        M = i(857),
        E = i(160),
        A = i(10),
        P = i(406),
        R = i(448),
        O = i(1086),
        I = i(858),
        F = i(1087),
        N = i(619),
        D = i(683),
        L = i(1088),
        k = i(684),
        V = i(859),
        B = i(446),
        U = i(198),
        G = i(318),
        j = i(290),
        z = i(614),
        H = i(137),
        W = i(84),
        q = i(36),
        X = i(102),
        Y = i(612),
        K = i(685),
        $ = i(681),
        Q = i(1089),
        J = i(450),
        Z = i(1090),
        ee = i(686),
        te = i(138),
        ie = i(292),
        ne = i(682),
        re = i(575),
        ae = i(851),
        oe = i(616),
        se = i(320),
        ue = i(407),
        le = i(860),
        ce = i(861),
        he = i(92),
        de = i(615),
        fe = i(288),
        pe = i(852),
        me = i(118),
        ge = i(1093),
        ve = i(316),
        _e = i(1094),
        be = i(108),
        Se = i(862),
        xe = i(12),
        ye = i(421),
        Ce = i(688),
        Te = i(177),
        we = i(315),
        Me = i(863),
        Ee = i(613),
        Ae = i(319),
        Pe = {};
    Pe.AutoTransform = n.a, Pe.BillboardAttribute = r.a, Pe.BlendColor = a.a, Pe.BlendFunc = o.a, Pe.BoundingBox = s.a, Pe.BoundingSphere = u.a, Pe.BufferArray = l.a, Pe.BufferArrayProxy = c.a, Pe.ColorMask = d.a, Pe.Camera = h.a, Pe.ColorMask = d.a, Pe.ComputeBoundsVisitor = f.default, xe.a.objectMix(Pe, p.a), Pe.CullFace = m.a, Pe.CullingSet = g.a, Pe.CullSettings = v.a, Pe.CullStack = _.a, Pe.CullVisitor = b.a, Pe.Depth = S.a, Pe.DrawArrayLengths = x.a, Pe.DrawArrays = y.a, Pe.DrawElements = C.a, Pe.EllipsoidModel = T.a, Pe.WGS_84_RADIUS_EQUATOR = T.a.WGS_84_RADIUS_EQUATOR, Pe.WGS_84_RADIUS_POLAR = T.a.WGS_84_RADIUS_POLAR, Pe.FrameBufferObject = w.a, Pe.FrameStamp = M.a, Pe.Geometry = E.a, Pe.GLObject = P.a, Pe.Image = R.a, Pe.ImageStream = O.a, Pe.KdTree = I.a, Pe.KdTreeBuilder = F.a, Pe.Light = N.a, Pe.LightSource = D.a, Pe.LineWidth = L.a, Pe.Lod = k.a, Pe.Material = V.default, xe.a.objectMix(Pe, B.a), Pe.MatrixTransform = U.a, Pe.PooledResource = G.a, Pe.PooledArray = j.a, Pe.PooledMap = z.a, Pe.Node = H.a, Pe.NodeVisitor = W.a, xe.a.objectMix(Pe, q.a), Pe.Object = X.a, Pe.Options = Y.a, Pe.PagedLOD = K.a, Pe.Plane = J.a, Pe.PointSizeAttribute = Q.a, Pe.Polytope = $.a, Pe.primitiveSet = te.a, Pe.primitiveFunctor = Z.a, Pe.primitiveIndexFunctor = ee.a, Pe.Program = ie.a, Pe.Projection = ne.a, Pe.RenderBin = re.a, Pe.RenderLeaf = ae.a, Pe.RenderStage = oe.a, Pe.Shader = se.a, xe.a.objectMix(Pe, ue.a), Pe.StackObjectPairPool = le.a, Pe.State = ce.a, Pe.StateAttribute = he.a, Pe.StateGraph = de.a, Pe.StateSet = fe.a, Pe.Scissor = Ce.a, Pe.Switch = pe.a, Pe.Texture = me.default, Pe.TextureCubeMap = ge.a, Pe.Transform = ve.a, Pe.TriangleIndexFunctor = _e.a, Pe.Uniform = be.a, Pe.UpdateVisitor = Se.a, xe.a.objectMix(Pe, xe.a), Pe.Viewport = ye.a, Pe.VertexArrayObject = Ee.a, Pe.vec2 = A.a.vec2, Pe.vec3 = A.a.vec3, Pe.vec4 = A.a.vec4, Pe.quat = A.a.quat, Pe.mat3 = A.a.mat3, Pe.mat4 = A.a.mat4, Pe.Transform.RELATIVE_RF = Te.a.RELATIVE_RF, Pe.Transform.ABSOLUTE_RF = Te.a.ABSOLUTE_RF, Pe.Timer = we.a, Pe.TimerGPU = Me.a, Pe.WebGLCaps = Ae.a, t.default = Pe
}, function (e, t, i) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: !0
    });
    var n = [],
        r = function (e, t) {
            n[e] = t
        },
        a = function (e) {
            return n[e]
        };
    t.default = {
        applyFunctionArray: n,
        registerApplyFunction: r,
        getApplyFunction: a
    }
}, function (e, t, i) {
    var n = i(361),
        r = {};
    r.create = function () {
        var e = new n.ARRAY_TYPE(9);
        return e[0] = 1, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 1, e[5] = 0, e[6] = 0, e[7] = 0, e[8] = 1, e
    }, r.fromMat4 = function (e, t) {
        return e[0] = t[0], e[1] = t[1], e[2] = t[2], e[3] = t[4], e[4] = t[5], e[5] = t[6], e[6] = t[8], e[7] = t[9], e[8] = t[10], e
    }, r.clone = function (e) {
        var t = new n.ARRAY_TYPE(9);
        return t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[3], t[4] = e[4], t[5] = e[5], t[6] = e[6], t[7] = e[7], t[8] = e[8], t
    }, r.copy = function (e, t) {
        return e[0] = t[0], e[1] = t[1], e[2] = t[2], e[3] = t[3], e[4] = t[4], e[5] = t[5], e[6] = t[6], e[7] = t[7], e[8] = t[8], e
    }, r.fromValues = function (e, t, i, r, a, o, s, u, l) {
        var c = new n.ARRAY_TYPE(9);
        return c[0] = e, c[1] = t, c[2] = i, c[3] = r, c[4] = a, c[5] = o, c[6] = s, c[7] = u, c[8] = l, c
    }, r.set = function (e, t, i, n, r, a, o, s, u, l) {
        return e[0] = t, e[1] = i, e[2] = n, e[3] = r, e[4] = a, e[5] = o, e[6] = s, e[7] = u, e[8] = l, e
    }, r.identity = function (e) {
        return e[0] = 1, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 1, e[5] = 0, e[6] = 0, e[7] = 0, e[8] = 1, e
    }, r.transpose = function (e, t) {
        if (e === t) {
            var i = t[1],
                n = t[2],
                r = t[5];
            e[1] = t[3], e[2] = t[6], e[3] = i, e[5] = t[7], e[6] = n, e[7] = r
        } else e[0] = t[0], e[1] = t[3], e[2] = t[6], e[3] = t[1], e[4] = t[4], e[5] = t[7], e[6] = t[2], e[7] = t[5], e[8] = t[8];
        return e
    }, r.invert = function (e, t) {
        var i = t[0],
            n = t[1],
            r = t[2],
            a = t[3],
            o = t[4],
            s = t[5],
            u = t[6],
            l = t[7],
            c = t[8],
            h = c * o - s * l,
            d = -c * a + s * u,
            f = l * a - o * u,
            p = i * h + n * d + r * f;
        return p ? (p = 1 / p, e[0] = h * p, e[1] = (-c * n + r * l) * p, e[2] = (s * n - r * o) * p, e[3] = d * p, e[4] = (c * i - r * u) * p, e[5] = (-s * i + r * a) * p, e[6] = f * p, e[7] = (-l * i + n * u) * p, e[8] = (o * i - n * a) * p, e) : null
    }, r.adjoint = function (e, t) {
        var i = t[0],
            n = t[1],
            r = t[2],
            a = t[3],
            o = t[4],
            s = t[5],
            u = t[6],
            l = t[7],
            c = t[8];
        return e[0] = o * c - s * l, e[1] = r * l - n * c, e[2] = n * s - r * o, e[3] = s * u - a * c, e[4] = i * c - r * u, e[5] = r * a - i * s, e[6] = a * l - o * u, e[7] = n * u - i * l, e[8] = i * o - n * a, e
    }, r.determinant = function (e) {
        var t = e[0],
            i = e[1],
            n = e[2],
            r = e[3],
            a = e[4],
            o = e[5],
            s = e[6],
            u = e[7],
            l = e[8];
        return t * (l * a - o * u) + i * (-l * r + o * s) + n * (u * r - a * s)
    }, r.multiply = function (e, t, i) {
        var n = t[0],
            r = t[1],
            a = t[2],
            o = t[3],
            s = t[4],
            u = t[5],
            l = t[6],
            c = t[7],
            h = t[8],
            d = i[0],
            f = i[1],
            p = i[2],
            m = i[3],
            g = i[4],
            v = i[5],
            _ = i[6],
            b = i[7],
            S = i[8];
        return e[0] = d * n + f * o + p * l, e[1] = d * r + f * s + p * c, e[2] = d * a + f * u + p * h, e[3] = m * n + g * o + v * l, e[4] = m * r + g * s + v * c, e[5] = m * a + g * u + v * h, e[6] = _ * n + b * o + S * l, e[7] = _ * r + b * s + S * c, e[8] = _ * a + b * u + S * h, e
    }, r.mul = r.multiply, r.translate = function (e, t, i) {
        var n = t[0],
            r = t[1],
            a = t[2],
            o = t[3],
            s = t[4],
            u = t[5],
            l = t[6],
            c = t[7],
            h = t[8],
            d = i[0],
            f = i[1];
        return e[0] = n, e[1] = r, e[2] = a, e[3] = o, e[4] = s, e[5] = u, e[6] = d * n + f * o + l, e[7] = d * r + f * s + c, e[8] = d * a + f * u + h, e
    }, r.rotate = function (e, t, i) {
        var n = t[0],
            r = t[1],
            a = t[2],
            o = t[3],
            s = t[4],
            u = t[5],
            l = t[6],
            c = t[7],
            h = t[8],
            d = Math.sin(i),
            f = Math.cos(i);
        return e[0] = f * n + d * o, e[1] = f * r + d * s, e[2] = f * a + d * u, e[3] = f * o - d * n, e[4] = f * s - d * r, e[5] = f * u - d * a, e[6] = l, e[7] = c, e[8] = h, e
    }, r.scale = function (e, t, i) {
        var n = i[0],
            r = i[1];
        return e[0] = n * t[0], e[1] = n * t[1], e[2] = n * t[2], e[3] = r * t[3], e[4] = r * t[4], e[5] = r * t[5], e[6] = t[6], e[7] = t[7], e[8] = t[8], e
    }, r.fromTranslation = function (e, t) {
        return e[0] = 1, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 1, e[5] = 0, e[6] = t[0], e[7] = t[1], e[8] = 1, e
    }, r.fromRotation = function (e, t) {
        var i = Math.sin(t),
            n = Math.cos(t);
        return e[0] = n, e[1] = i, e[2] = 0, e[3] = -i, e[4] = n, e[5] = 0, e[6] = 0, e[7] = 0, e[8] = 1, e
    }, r.fromScaling = function (e, t) {
        return e[0] = t[0], e[1] = 0, e[2] = 0, e[3] = 0, e[4] = t[1], e[5] = 0, e[6] = 0, e[7] = 0, e[8] = 1, e
    }, r.fromMat2d = function (e, t) {
        return e[0] = t[0], e[1] = t[1], e[2] = 0, e[3] = t[2], e[4] = t[3], e[5] = 0, e[6] = t[4], e[7] = t[5], e[8] = 1, e
    }, r.fromQuat = function (e, t) {
        var i = t[0],
            n = t[1],
            r = t[2],
            a = t[3],
            o = i + i,
            s = n + n,
            u = r + r,
            l = i * o,
            c = n * o,
            h = n * s,
            d = r * o,
            f = r * s,
            p = r * u,
            m = a * o,
            g = a * s,
            v = a * u;
        return e[0] = 1 - h - p, e[3] = c - v, e[6] = d + g, e[1] = c + v, e[4] = 1 - l - p, e[7] = f - m, e[2] = d - g, e[5] = f + m, e[8] = 1 - l - h, e
    }, r.normalFromMat4 = function (e, t) {
        var i = t[0],
            n = t[1],
            r = t[2],
            a = t[3],
            o = t[4],
            s = t[5],
            u = t[6],
            l = t[7],
            c = t[8],
            h = t[9],
            d = t[10],
            f = t[11],
            p = t[12],
            m = t[13],
            g = t[14],
            v = t[15],
            _ = i * s - n * o,
            b = i * u - r * o,
            S = i * l - a * o,
            x = n * u - r * s,
            y = n * l - a * s,
            C = r * l - a * u,
            T = c * m - h * p,
            w = c * g - d * p,
            M = c * v - f * p,
            E = h * g - d * m,
            A = h * v - f * m,
            P = d * v - f * g,
            R = _ * P - b * A + S * E + x * M - y * w + C * T;
        return R ? (R = 1 / R, e[0] = (s * P - u * A + l * E) * R, e[1] = (u * M - o * P - l * w) * R, e[2] = (o * A - s * M + l * T) * R, e[3] = (r * A - n * P - a * E) * R, e[4] = (i * P - r * M + a * w) * R, e[5] = (n * M - i * A - a * T) * R, e[6] = (m * C - g * y + v * x) * R, e[7] = (g * S - p * C - v * b) * R, e[8] = (p * y - m * S + v * _) * R, e) : null
    }, r.str = function (e) {
        return "mat3(" + e[0] + ", " + e[1] + ", " + e[2] + ", " + e[3] + ", " + e[4] + ", " + e[5] + ", " + e[6] + ", " + e[7] + ", " + e[8] + ")"
    }, r.frob = function (e) {
        return Math.sqrt(Math.pow(e[0], 2) + Math.pow(e[1], 2) + Math.pow(e[2], 2) + Math.pow(e[3], 2) + Math.pow(e[4], 2) + Math.pow(e[5], 2) + Math.pow(e[6], 2) + Math.pow(e[7], 2) + Math.pow(e[8], 2))
    }, r.add = function (e, t, i) {
        return e[0] = t[0] + i[0], e[1] = t[1] + i[1], e[2] = t[2] + i[2], e[3] = t[3] + i[3], e[4] = t[4] + i[4], e[5] = t[5] + i[5], e[6] = t[6] + i[6], e[7] = t[7] + i[7], e[8] = t[8] + i[8], e
    }, r.subtract = function (e, t, i) {
        return e[0] = t[0] - i[0], e[1] = t[1] - i[1], e[2] = t[2] - i[2], e[3] = t[3] - i[3], e[4] = t[4] - i[4], e[5] = t[5] - i[5], e[6] = t[6] - i[6], e[7] = t[7] - i[7], e[8] = t[8] - i[8], e
    }, r.sub = r.subtract, r.multiplyScalar = function (e, t, i) {
        return e[0] = t[0] * i, e[1] = t[1] * i, e[2] = t[2] * i, e[3] = t[3] * i, e[4] = t[4] * i, e[5] = t[5] * i, e[6] = t[6] * i, e[7] = t[7] * i, e[8] = t[8] * i, e
    }, r.multiplyScalarAndAdd = function (e, t, i, n) {
        return e[0] = t[0] + i[0] * n, e[1] = t[1] + i[1] * n, e[2] = t[2] + i[2] * n, e[3] = t[3] + i[3] * n, e[4] = t[4] + i[4] * n, e[5] = t[5] + i[5] * n, e[6] = t[6] + i[6] * n, e[7] = t[7] + i[7] * n, e[8] = t[8] + i[8] * n, e
    }, r.exactEquals = function (e, t) {
        return e[0] === t[0] && e[1] === t[1] && e[2] === t[2] && e[3] === t[3] && e[4] === t[4] && e[5] === t[5] && e[6] === t[6] && e[7] === t[7] && e[8] === t[8]
    }, r.equals = function (e, t) {
        var i = e[0],
            r = e[1],
            a = e[2],
            o = e[3],
            s = e[4],
            u = e[5],
            l = e[6],
            c = e[7],
            h = e[8],
            d = t[0],
            f = t[1],
            p = t[2],
            m = t[3],
            g = t[4],
            v = t[5],
            _ = e[6],
            b = t[7],
            S = t[8];
        return Math.abs(i - d) <= n.EPSILON * Math.max(1, Math.abs(i), Math.abs(d)) && Math.abs(r - f) <= n.EPSILON * Math.max(1, Math.abs(r), Math.abs(f)) && Math.abs(a - p) <= n.EPSILON * Math.max(1, Math.abs(a), Math.abs(p)) && Math.abs(o - m) <= n.EPSILON * Math.max(1, Math.abs(o), Math.abs(m)) && Math.abs(s - g) <= n.EPSILON * Math.max(1, Math.abs(s), Math.abs(g)) && Math.abs(u - v) <= n.EPSILON * Math.max(1, Math.abs(u), Math.abs(v)) && Math.abs(l - _) <= n.EPSILON * Math.max(1, Math.abs(l), Math.abs(_)) && Math.abs(c - b) <= n.EPSILON * Math.max(1, Math.abs(c), Math.abs(b)) && Math.abs(h - S) <= n.EPSILON * Math.max(1, Math.abs(h), Math.abs(S))
    }, e.exports = r
}, function (e, t, i) {
    var n = i(361),
        r = {};
    r.create = function () {
        var e = new n.ARRAY_TYPE(3);
        return e[0] = 0, e[1] = 0, e[2] = 0, e
    }, r.clone = function (e) {
        var t = new n.ARRAY_TYPE(3);
        return t[0] = e[0], t[1] = e[1], t[2] = e[2], t
    }, r.fromValues = function (e, t, i) {
        var r = new n.ARRAY_TYPE(3);
        return r[0] = e, r[1] = t, r[2] = i, r
    }, r.copy = function (e, t) {
        return e[0] = t[0], e[1] = t[1], e[2] = t[2], e
    }, r.set = function (e, t, i, n) {
        return e[0] = t, e[1] = i, e[2] = n, e
    }, r.add = function (e, t, i) {
        return e[0] = t[0] + i[0], e[1] = t[1] + i[1], e[2] = t[2] + i[2], e
    }, r.subtract = function (e, t, i) {
        return e[0] = t[0] - i[0], e[1] = t[1] - i[1], e[2] = t[2] - i[2], e
    }, r.sub = r.subtract, r.multiply = function (e, t, i) {
        return e[0] = t[0] * i[0], e[1] = t[1] * i[1], e[2] = t[2] * i[2], e
    }, r.mul = r.multiply, r.divide = function (e, t, i) {
        return e[0] = t[0] / i[0], e[1] = t[1] / i[1], e[2] = t[2] / i[2], e
    }, r.div = r.divide, r.ceil = function (e, t) {
        return e[0] = Math.ceil(t[0]), e[1] = Math.ceil(t[1]), e[2] = Math.ceil(t[2]), e
    }, r.floor = function (e, t) {
        return e[0] = Math.floor(t[0]), e[1] = Math.floor(t[1]), e[2] = Math.floor(t[2]), e
    }, r.min = function (e, t, i) {
        return e[0] = Math.min(t[0], i[0]), e[1] = Math.min(t[1], i[1]), e[2] = Math.min(t[2], i[2]), e
    }, r.max = function (e, t, i) {
        return e[0] = Math.max(t[0], i[0]), e[1] = Math.max(t[1], i[1]), e[2] = Math.max(t[2], i[2]), e
    }, r.round = function (e, t) {
        return e[0] = Math.round(t[0]), e[1] = Math.round(t[1]), e[2] = Math.round(t[2]), e
    }, r.scale = function (e, t, i) {
        return e[0] = t[0] * i, e[1] = t[1] * i, e[2] = t[2] * i, e
    }, r.scaleAndAdd = function (e, t, i, n) {
        return e[0] = t[0] + i[0] * n, e[1] = t[1] + i[1] * n, e[2] = t[2] + i[2] * n, e
    }, r.distance = function (e, t) {
        var i = t[0] - e[0],
            n = t[1] - e[1],
            r = t[2] - e[2];
        return Math.sqrt(i * i + n * n + r * r)
    }, r.dist = r.distance, r.squaredDistance = function (e, t) {
        var i = t[0] - e[0],
            n = t[1] - e[1],
            r = t[2] - e[2];
        return i * i + n * n + r * r
    }, r.sqrDist = r.squaredDistance, r.length = function (e) {
        var t = e[0],
            i = e[1],
            n = e[2];
        return Math.sqrt(t * t + i * i + n * n)
    }, r.len = r.length, r.squaredLength = function (e) {
        var t = e[0],
            i = e[1],
            n = e[2];
        return t * t + i * i + n * n
    }, r.sqrLen = r.squaredLength, r.negate = function (e, t) {
        return e[0] = -t[0], e[1] = -t[1], e[2] = -t[2], e
    }, r.inverse = function (e, t) {
        return e[0] = 1 / t[0], e[1] = 1 / t[1], e[2] = 1 / t[2], e
    }, r.normalize = function (e, t) {
        var i = t[0],
            n = t[1],
            r = t[2],
            a = i * i + n * n + r * r;
        return a > 0 && (a = 1 / Math.sqrt(a), e[0] = t[0] * a, e[1] = t[1] * a, e[2] = t[2] * a), e
    }, r.dot = function (e, t) {
        return e[0] * t[0] + e[1] * t[1] + e[2] * t[2]
    }, r.cross = function (e, t, i) {
        var n = t[0],
            r = t[1],
            a = t[2],
            o = i[0],
            s = i[1],
            u = i[2];
        return e[0] = r * u - a * s, e[1] = a * o - n * u, e[2] = n * s - r * o, e
    }, r.lerp = function (e, t, i, n) {
        var r = t[0],
            a = t[1],
            o = t[2];
        return e[0] = r + n * (i[0] - r), e[1] = a + n * (i[1] - a), e[2] = o + n * (i[2] - o), e
    }, r.hermite = function (e, t, i, n, r, a) {
        var o = a * a,
            s = o * (2 * a - 3) + 1,
            u = o * (a - 2) + a,
            l = o * (a - 1),
            c = o * (3 - 2 * a);
        return e[0] = t[0] * s + i[0] * u + n[0] * l + r[0] * c, e[1] = t[1] * s + i[1] * u + n[1] * l + r[1] * c, e[2] = t[2] * s + i[2] * u + n[2] * l + r[2] * c, e
    }, r.bezier = function (e, t, i, n, r, a) {
        var o = 1 - a,
            s = o * o,
            u = a * a,
            l = s * o,
            c = 3 * a * s,
            h = 3 * u * o,
            d = u * a;
        return e[0] = t[0] * l + i[0] * c + n[0] * h + r[0] * d, e[1] = t[1] * l + i[1] * c + n[1] * h + r[1] * d, e[2] = t[2] * l + i[2] * c + n[2] * h + r[2] * d, e
    }, r.random = function (e, t) {
        t = t || 1;
        var i = 2 * n.RANDOM() * Math.PI,
            r = 2 * n.RANDOM() - 1,
            a = Math.sqrt(1 - r * r) * t;
        return e[0] = Math.cos(i) * a, e[1] = Math.sin(i) * a, e[2] = r * t, e
    }, r.transformMat4 = function (e, t, i) {
        var n = t[0],
            r = t[1],
            a = t[2],
            o = i[3] * n + i[7] * r + i[11] * a + i[15];
        return o = o || 1, e[0] = (i[0] * n + i[4] * r + i[8] * a + i[12]) / o, e[1] = (i[1] * n + i[5] * r + i[9] * a + i[13]) / o, e[2] = (i[2] * n + i[6] * r + i[10] * a + i[14]) / o, e
    }, r.transformMat3 = function (e, t, i) {
        var n = t[0],
            r = t[1],
            a = t[2];
        return e[0] = n * i[0] + r * i[3] + a * i[6], e[1] = n * i[1] + r * i[4] + a * i[7], e[2] = n * i[2] + r * i[5] + a * i[8], e
    }, r.transformQuat = function (e, t, i) {
        var n = t[0],
            r = t[1],
            a = t[2],
            o = i[0],
            s = i[1],
            u = i[2],
            l = i[3],
            c = l * n + s * a - u * r,
            h = l * r + u * n - o * a,
            d = l * a + o * r - s * n,
            f = -o * n - s * r - u * a;
        return e[0] = c * l + f * -o + h * -u - d * -s, e[1] = h * l + f * -s + d * -o - c * -u, e[2] = d * l + f * -u + c * -s - h * -o, e
    }, r.rotateX = function (e, t, i, n) {
        var r = [],
            a = [];
        return r[0] = t[0] - i[0], r[1] = t[1] - i[1], r[2] = t[2] - i[2], a[0] = r[0], a[1] = r[1] * Math.cos(n) - r[2] * Math.sin(n), a[2] = r[1] * Math.sin(n) + r[2] * Math.cos(n), e[0] = a[0] + i[0], e[1] = a[1] + i[1], e[2] = a[2] + i[2], e
    }, r.rotateY = function (e, t, i, n) {
        var r = [],
            a = [];
        return r[0] = t[0] - i[0], r[1] = t[1] - i[1], r[2] = t[2] - i[2], a[0] = r[2] * Math.sin(n) + r[0] * Math.cos(n), a[1] = r[1], a[2] = r[2] * Math.cos(n) - r[0] * Math.sin(n), e[0] = a[0] + i[0], e[1] = a[1] + i[1], e[2] = a[2] + i[2], e
    }, r.rotateZ = function (e, t, i, n) {
        var r = [],
            a = [];
        return r[0] = t[0] - i[0], r[1] = t[1] - i[1], r[2] = t[2] - i[2], a[0] = r[0] * Math.cos(n) - r[1] * Math.sin(n), a[1] = r[0] * Math.sin(n) + r[1] * Math.cos(n), a[2] = r[2], e[0] = a[0] + i[0], e[1] = a[1] + i[1], e[2] = a[2] + i[2], e
    }, r.forEach = function () {
        var e = r.create();
        return function (t, i, n, r, a, o) {
            var s, u;
            for (i || (i = 3), n || (n = 0), u = r ? Math.min(r * i + n, t.length) : t.length, s = n; s < u; s += i) e[0] = t[s], e[1] = t[s + 1], e[2] = t[s + 2], a(e, e, o), t[s] = e[0], t[s + 1] = e[1], t[s + 2] = e[2];
            return t
        }
    }(), r.angle = function (e, t) {
        var i = r.fromValues(e[0], e[1], e[2]),
            n = r.fromValues(t[0], t[1], t[2]);
        r.normalize(i, i), r.normalize(n, n);
        var a = r.dot(i, n);
        return a > 1 ? 0 : Math.acos(a)
    }, r.str = function (e) {
        return "vec3(" + e[0] + ", " + e[1] + ", " + e[2] + ")"
    }, r.exactEquals = function (e, t) {
        return e[0] === t[0] && e[1] === t[1] && e[2] === t[2]
    }, r.equals = function (e, t) {
        var i = e[0],
            r = e[1],
            a = e[2],
            o = t[0],
            s = t[1],
            u = t[2];
        return Math.abs(i - o) <= n.EPSILON * Math.max(1, Math.abs(i), Math.abs(o)) && Math.abs(r - s) <= n.EPSILON * Math.max(1, Math.abs(r), Math.abs(s)) && Math.abs(a - u) <= n.EPSILON * Math.max(1, Math.abs(a), Math.abs(u))
    }, e.exports = r
}, function (e, t, i) {
    var n = i(361),
        r = {};
    r.create = function () {
        var e = new n.ARRAY_TYPE(4);
        return e[0] = 0, e[1] = 0, e[2] = 0, e[3] = 0, e
    }, r.clone = function (e) {
        var t = new n.ARRAY_TYPE(4);
        return t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[3], t
    }, r.fromValues = function (e, t, i, r) {
        var a = new n.ARRAY_TYPE(4);
        return a[0] = e, a[1] = t, a[2] = i, a[3] = r, a
    }, r.copy = function (e, t) {
        return e[0] = t[0], e[1] = t[1], e[2] = t[2], e[3] = t[3], e
    }, r.set = function (e, t, i, n, r) {
        return e[0] = t, e[1] = i, e[2] = n, e[3] = r, e
    }, r.add = function (e, t, i) {
        return e[0] = t[0] + i[0], e[1] = t[1] + i[1], e[2] = t[2] + i[2], e[3] = t[3] + i[3], e
    }, r.subtract = function (e, t, i) {
        return e[0] = t[0] - i[0], e[1] = t[1] - i[1], e[2] = t[2] - i[2], e[3] = t[3] - i[3], e
    }, r.sub = r.subtract, r.multiply = function (e, t, i) {
        return e[0] = t[0] * i[0], e[1] = t[1] * i[1], e[2] = t[2] * i[2], e[3] = t[3] * i[3], e
    }, r.mul = r.multiply, r.divide = function (e, t, i) {
        return e[0] = t[0] / i[0], e[1] = t[1] / i[1], e[2] = t[2] / i[2], e[3] = t[3] / i[3], e
    }, r.div = r.divide, r.ceil = function (e, t) {
        return e[0] = Math.ceil(t[0]), e[1] = Math.ceil(t[1]), e[2] = Math.ceil(t[2]), e[3] = Math.ceil(t[3]), e
    }, r.floor = function (e, t) {
        return e[0] = Math.floor(t[0]), e[1] = Math.floor(t[1]), e[2] = Math.floor(t[2]), e[3] = Math.floor(t[3]), e
    }, r.min = function (e, t, i) {
        return e[0] = Math.min(t[0], i[0]), e[1] = Math.min(t[1], i[1]), e[2] = Math.min(t[2], i[2]), e[3] = Math.min(t[3], i[3]), e
    }, r.max = function (e, t, i) {
        return e[0] = Math.max(t[0], i[0]), e[1] = Math.max(t[1], i[1]), e[2] = Math.max(t[2], i[2]), e[3] = Math.max(t[3], i[3]), e
    }, r.round = function (e, t) {
        return e[0] = Math.round(t[0]), e[1] = Math.round(t[1]), e[2] = Math.round(t[2]), e[3] = Math.round(t[3]), e
    }, r.scale = function (e, t, i) {
        return e[0] = t[0] * i, e[1] = t[1] * i, e[2] = t[2] * i, e[3] = t[3] * i, e
    }, r.scaleAndAdd = function (e, t, i, n) {
        return e[0] = t[0] + i[0] * n, e[1] = t[1] + i[1] * n, e[2] = t[2] + i[2] * n, e[3] = t[3] + i[3] * n, e
    }, r.distance = function (e, t) {
        var i = t[0] - e[0],
            n = t[1] - e[1],
            r = t[2] - e[2],
            a = t[3] - e[3];
        return Math.sqrt(i * i + n * n + r * r + a * a)
    }, r.dist = r.distance, r.squaredDistance = function (e, t) {
        var i = t[0] - e[0],
            n = t[1] - e[1],
            r = t[2] - e[2],
            a = t[3] - e[3];
        return i * i + n * n + r * r + a * a
    }, r.sqrDist = r.squaredDistance, r.length = function (e) {
        var t = e[0],
            i = e[1],
            n = e[2],
            r = e[3];
        return Math.sqrt(t * t + i * i + n * n + r * r)
    }, r.len = r.length, r.squaredLength = function (e) {
        var t = e[0],
            i = e[1],
            n = e[2],
            r = e[3];
        return t * t + i * i + n * n + r * r
    }, r.sqrLen = r.squaredLength, r.negate = function (e, t) {
        return e[0] = -t[0], e[1] = -t[1], e[2] = -t[2], e[3] = -t[3], e
    }, r.inverse = function (e, t) {
        return e[0] = 1 / t[0], e[1] = 1 / t[1], e[2] = 1 / t[2], e[3] = 1 / t[3], e
    }, r.normalize = function (e, t) {
        var i = t[0],
            n = t[1],
            r = t[2],
            a = t[3],
            o = i * i + n * n + r * r + a * a;
        return o > 0 && (o = 1 / Math.sqrt(o), e[0] = i * o, e[1] = n * o, e[2] = r * o, e[3] = a * o), e
    }, r.dot = function (e, t) {
        return e[0] * t[0] + e[1] * t[1] + e[2] * t[2] + e[3] * t[3]
    }, r.lerp = function (e, t, i, n) {
        var r = t[0],
            a = t[1],
            o = t[2],
            s = t[3];
        return e[0] = r + n * (i[0] - r), e[1] = a + n * (i[1] - a), e[2] = o + n * (i[2] - o), e[3] = s + n * (i[3] - s), e
    }, r.random = function (e, t) {
        return t = t || 1, e[0] = n.RANDOM(), e[1] = n.RANDOM(), e[2] = n.RANDOM(), e[3] = n.RANDOM(), r.normalize(e, e), r.scale(e, e, t), e
    }, r.transformMat4 = function (e, t, i) {
        var n = t[0],
            r = t[1],
            a = t[2],
            o = t[3];
        return e[0] = i[0] * n + i[4] * r + i[8] * a + i[12] * o, e[1] = i[1] * n + i[5] * r + i[9] * a + i[13] * o, e[2] = i[2] * n + i[6] * r + i[10] * a + i[14] * o, e[3] = i[3] * n + i[7] * r + i[11] * a + i[15] * o, e
    }, r.transformQuat = function (e, t, i) {
        var n = t[0],
            r = t[1],
            a = t[2],
            o = i[0],
            s = i[1],
            u = i[2],
            l = i[3],
            c = l * n + s * a - u * r,
            h = l * r + u * n - o * a,
            d = l * a + o * r - s * n,
            f = -o * n - s * r - u * a;
        return e[0] = c * l + f * -o + h * -u - d * -s, e[1] = h * l + f * -s + d * -o - c * -u, e[2] = d * l + f * -u + c * -s - h * -o, e[3] = t[3], e
    }, r.forEach = function () {
        var e = r.create();
        return function (t, i, n, r, a, o) {
            var s, u;
            for (i || (i = 4), n || (n = 0), u = r ? Math.min(r * i + n, t.length) : t.length, s = n; s < u; s += i) e[0] = t[s], e[1] = t[s + 1], e[2] = t[s + 2], e[3] = t[s + 3], a(e, e, o), t[s] = e[0], t[s + 1] = e[1], t[s + 2] = e[2], t[s + 3] = e[3];
            return t
        }
    }(), r.str = function (e) {
        return "vec4(" + e[0] + ", " + e[1] + ", " + e[2] + ", " + e[3] + ")"
    }, r.exactEquals = function (e, t) {
        return e[0] === t[0] && e[1] === t[1] && e[2] === t[2] && e[3] === t[3]
    }, r.equals = function (e, t) {
        var i = e[0],
            r = e[1],
            a = e[2],
            o = e[3],
            s = t[0],
            u = t[1],
            l = t[2],
            c = t[3];
        return Math.abs(i - s) <= n.EPSILON * Math.max(1, Math.abs(i), Math.abs(s)) && Math.abs(r - u) <= n.EPSILON * Math.max(1, Math.abs(r), Math.abs(u)) && Math.abs(a - l) <= n.EPSILON * Math.max(1, Math.abs(a), Math.abs(l)) && Math.abs(o - c) <= n.EPSILON * Math.max(1, Math.abs(o), Math.abs(c))
    }, e.exports = r
}, function (e, t, i) {
    "use strict";
    var n = function () {
        var e = function (e) {
                return '<div style="margin: auto; width:500px;z-index:10000;margin-top:20em;text-align:center;">' + e + "</div>"
            },
            t = 'This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>',
            i = 'It doesn\'t appear your computer can support WebGL.<br/><a href="http://get.webgl.org">Click here for more information.</a>',
            n = !0,
            r = function (r, a, s) {
                function u(r) {
                    if (n) {
                        var a = document.getElementsByTagName("body")[0];
                        if (a) {
                            var o = window.WebGLRenderingContext ? i : t;
                            r && (o += "<br/><br/>Status: " + r), a.innerHTML = e(o)
                        }
                    }
                }
                s = s || u, r.addEventListener && r.addEventListener("webglcontextcreationerror", function (e) {
                    s(e.statusMessage)
                }, !1);
                var l = o(r, a);
                return l || s(""), l
            },
            a = function (e, t, i) {
                for (var n = null, r = 0; r < i.length; ++r) {
                    try {
                        n = e.getContext(i[r], t)
                    } catch (e) {}
                    if (n) break
                }
                return n
            },
            o = function (e, t) {
                var i;
                if (t && t.webgl2) {
                    if (n = !1, i = a(e, t, ["webgl2", "experimental-webgl2"])) return i;
                    n = !0
                }
                return a(e, t, ["webgl", "experimental-webgl", "webkit-3d", "moz-webgl"])
            };
        return {
            create3DContext: o,
            setupWebGL: r
        }
    }();
    window.requestAnimationFrame || (window.requestAnimationFrame = function () {
        return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function (e, t) {
            window.setTimeout(e, 1e3 / 60)
        }
    }()), window.cancelRequestAnimFrame || (window.cancelAnimationFrame = function () {
        return window.cancelAnimationFrame || window.webkitCancelRequestAnimationFrame || window.mozCancelRequestAnimationFrame || window.oCancelRequestAnimationFrame || window.msCancelRequestAnimationFrame || clearTimeout
    }()), Date.now || (Date.now = function () {
        return (new Date).getTime()
    }), t.a = n
}, function (e, t, i) {
    "use strict";
    var n = i(681),
        r = function () {
            this._mask = r.DEFAULT_CULLING, this._frustum = new n.a
        };
    r.prototype = {
        reset: function () {
            this._mask = r.DEFAULT_CULLING, this._frustum.clear()
        },
        setCullingMask: function (e) {
            this._mask = e
        },
        getCullingMask: function () {
            return this._mask
        },
        setFrustum: function (e) {
            this._frustum = e
        },
        getFrustum: function () {
            return this._frustum
        },
        getCurrentResultMask: function () {
            return this._frustum.getCurrentMask()
        },
        pushCurrentMask: function () {
            this._frustum.pushCurrentMask()
        },
        popCurrentMask: function () {
            this._frustum.popCurrentMask()
        },
        resetCullingMask: function () {
            this._frustum.setResultMask(this._frustum.getCurrentMask())
        },
        isBoundingBoxCulled: function (e) {
            return !(!(this._mask & r.VIEW_FRUSTUM_CULLING) || this._frustum.containsBoundingBox(e))
        },
        isBoundingSphereCulled: function (e) {
            return !(!(this._mask & r.VIEW_FRUSTUM_CULLING) || this._frustum.containsBoundingSphere(e))
        },
        isVerticesCulled: function (e) {
            return !(!(this._mask & r.VIEW_FRUSTUM_CULLING) || this._frustum.containsVertices(e))
        }
    }, r.NO_CULLING = 0, r.VIEW_FRUSTUM_LEFT_CULLING = 1, r.VIEW_FRUSTUM_RIGHT_CULLING = 2, r.VIEW_FRUSTUM_TOP_CULLING = 3, r.VIEW_FRUSTUM_BOTTOM_CULLING = 4, r.NEAR_PLANE_CULLING = 5, r.FAR_PLANE_CULLING = 6, r.VIEW_FRUSTUM_SIDES_CULLING = r.VIEW_FRUSTUM_LEFT_CULLING | r.VIEW_FRUSTUM_RIGHT_CULLING | r.VIEW_FRUSTUM_BOTTOM_CULLING | r.VIEW_FRUSTUM_TOP_CULLING, r.VIEW_FRUSTUM_CULLING = r.VIEW_FRUSTUM_SIDES_CULLING | r.NEAR_PLANE_CULLING | r.FAR_PLANE_CULLING, r.DEFAULT_CULLING = r.VIEW_FRUSTUM_SIDES_CULLING, r.ENABLE_ALL_CULLING = r.VIEW_FRUSTUM_CULLING, t.a = r
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(447),
        a = i(197),
        o = i(571),
        s = i(573),
        u = i(849),
        l = i(10),
        c = i(450),
        h = i(316),
        d = i(177),
        f = i(290),
        p = i(318),
        m = i(614),
        g = function () {
            return new u.a
        },
        v = function () {
            this._modelViewMatrixStack = new f.a, this._projectionMatrixStack = new f.a, this._viewportStack = new f.a, this._cullingSetStack = new f.a, this._frustumVolume = -1, this._bbCornerFar = 0, this._bbCornerNear = 0, this._pooledMatrix = new p.a(l.c.create), this._pooledCullingSet = new p.a(g), this._cameraIndexStack = new f.a, this._cameraModelViewIndexStack = new f.a, this._cameraMatrixInverse = new m.a, this._cameraMatrixInverseRoot = void 0
        };
    n.a.createPrototypeObject(v, n.a.objectInherit(s.a.prototype, {
        reset: function () {
            this._modelViewMatrixStack.reset(), this._projectionMatrixStack.reset(), this._cullingSetStack.reset(), this._pooledMatrix.reset(), this._pooledCullingSet.reset(), this._cameraModelViewIndexStack.reset(), this._cameraIndexStack.reset(), this._cameraMatrixInverse.reset(), this._cameraMatrixInverseRoot = void 0
        },
        getProjectionMatrixStack: function () {
            return this._projectionMatrixStack
        },
        getCurrentProjectionMatrix: function () {
            return this._projectionMatrixStack.back()
        },
        getCurrentModelViewMatrix: function () {
            return this._modelViewMatrixStack.back()
        },
        getCameraInverseMatrix: function () {
            if (!this._cameraIndexStack.getLength()) return this._cameraMatrixInverseRoot;
            var e = this._cameraIndexStack.back(),
                t = this.getNodePath()[e],
                i = t.getInstanceID(),
                n = this._cameraMatrixInverse.getMap(),
                r = n[i];
            if (void 0 === r) {
                var a = this._cameraModelViewIndexStack.back(),
                    o = this._modelViewMatrixStack.getArray()[a];
                r = this._pooledMatrix.getOrCreateObject(), l.c.invert(r, o), this._cameraMatrixInverse.set(i, r)
            }
            return r
        },
        getCurrentModelMatrix: function () {
            var e = this.getCameraInverseMatrix(),
                t = this._pooledMatrix.getOrCreateObject();
            return l.c.mul(t, e, this.getCurrentModelViewMatrix())
        },
        getCurrentViewMatrix: function () {
            var e = this._modelViewMatrixStack.getArray();
            return this._cameraIndexStack.getLength() ? e[this._cameraModelViewIndexStack.back()] : e[0]
        },
        getViewport: function () {
            if (0 !== this._viewportStack.getLength()) return this._viewportStack.back()
        },
        getLookVectorLocal: function (e) {
            var t = this.getCurrentModelViewMatrix();
            return l.f.set(e, -t[2], -t[6], -t[10])
        },
        pushViewport: function (e) {
            this._viewportStack.push(e)
        },
        popViewport: function () {
            this._viewportStack.pop()
        },
        getFrustumPlanes: function () {
            var e = l.c.create();
            return function (t, i, n, r) {
                l.c.mul(e, i, n);
                var a = !!r,
                    o = t[0];
                o[0] = e[3] - e[0], o[1] = e[7] - e[4], o[2] = e[11] - e[8], o[3] = e[15] - e[12];
                var s = t[1];
                s[0] = e[3] + e[0], s[1] = e[7] + e[4], s[2] = e[11] + e[8], s[3] = e[15] + e[12];
                var u = t[2];
                u[0] = e[3] + e[1], u[1] = e[7] + e[5], u[2] = e[11] + e[9], u[3] = e[15] + e[13];
                var h = t[3];
                if (h[0] = e[3] - e[1], h[1] = e[7] - e[5], h[2] = e[11] - e[9], h[3] = e[15] - e[13], a) {
                    var d = t[4];
                    d[0] = e[3] - e[2], d[1] = e[7] - e[6], d[2] = e[11] - e[10], d[3] = e[15] - e[14];
                    var f = t[5];
                    f[0] = e[3] + e[2], f[1] = e[7] + e[6], f[2] = e[11] + e[10], f[3] = e[15] + e[14]
                }
                for (var p = r ? 6 : 4, m = 0; m < p; m++) c.a.normalizeEquation(t[m])
            }
        }(),
        pushCullingSet: function () {
            var e = this._pooledCullingSet.getOrCreateObject();
            this._enableFrustumCulling && (l.c.getFrustumPlanes(e.getFrustum().getPlanes(), this.getCurrentProjectionMatrix(), this.getCurrentModelViewMatrix(), !1), e.getFrustum().setupMask(4)), this._cullingSetStack.push(e)
        },
        popCullingSet: function () {
            return this._cullingSetStack.pop()
        },
        getCurrentCullingSet: function () {
            return this._cullingSetStack.back()
        },
        pushCurrentMask: function () {
            var e = this.getCurrentCullingSet();
            e && e.pushCurrentMask()
        },
        popCurrentMask: function () {
            var e = this.getCurrentCullingSet();
            e && e.popCurrentMask()
        },
        isVerticesCulled: function (e) {
            return !!this._enableFrustumCulling && this.getCurrentCullingSet().isVerticesCulled(e)
        },
        isBoundingBoxCulled: function (e) {
            return !!this._enableFrustumCulling && (e.valid() && this.getCurrentCullingSet().isBoundingBoxCulled(e))
        },
        isBoundingSphereCulled: function (e) {
            return !!this._enableFrustumCulling && (e.valid() && this.getCurrentCullingSet().isBoundingSphereCulled(e))
        },
        isCulled: function () {
            var e = new r.a;
            return function (t, i) {
                if (!this._enableFrustumCulling) return !1;
                if (t.isCullingActive()) {
                    if (0 === this.getCurrentCullingSet().getCurrentResultMask()) return !1;
                    var n = this._pooledMatrix.getOrCreateObject();
                    l.c.identity(n);
                    var r = i.length;
                    return t instanceof h.a && r--, o.a.computeLocalToWorld(i, !0, n, r), t.getBound().transformMat4(e, n), this.getCurrentCullingSet().isBoundingSphereCulled(e)
                }
                return this.getCurrentCullingSet().resetCullingMask(), !1
            }
        }(),
        pushModelViewMatrix: function () {
            var e = l.f.create();
            return function (t) {
                var i = this.getNodePath(),
                    n = i.length;
                if (n) {
                    var r = n - 1;
                    i[r].getTypeID() === a.a.getTypeID() && i[r].getReferenceFrame() === d.a.ABSOLUTE_RF && (this._cameraIndexStack.push(r), this._cameraModelViewIndexStack.push(this._modelViewMatrixStack.getLength()))
                } else {
                    var o = this._pooledMatrix.getOrCreateObject();
                    l.c.invert(o, t), this._cameraMatrixInverseRoot = o
                }
                this._modelViewMatrixStack.push(t), this.getLookVectorLocal(e), this._bbCornerFar = (e[0] >= 0 ? 1 : 0) | (e[1] >= 0 ? 2 : 0) | (e[2] >= 0 ? 4 : 0), this._bbCornerNear = 7 & ~this._bbCornerFar
            }
        }(),
        popModelViewMatrix: function () {
            var e = l.f.create();
            return function () {
                var t = this.getNodePath(),
                    i = t.length - 1;
                this._cameraIndexStack.getLength() && i === this._cameraIndexStack.back() && (this._cameraIndexStack.pop(), this._cameraModelViewIndexStack.pop()), this._modelViewMatrixStack.pop(), this._modelViewMatrixStack.getLength() ? this.getLookVectorLocal(e) : l.f.set(e, 0, 0, -1), this._bbCornerFar = (e[0] >= 0 ? 1 : 0) | (e[1] >= 0 ? 2 : 0) | (e[2] >= 0 ? 4 : 0), this._bbCornerNear = 7 & ~this._bbCornerFar
            }
        }(),
        pushProjectionMatrix: function (e) {
            this._projectionMatrixStack.push(e), this._frustumVolume = -1, this.pushCullingSet()
        },
        popProjectionMatrix: function () {
            this._projectionMatrixStack.pop(), this._frustumVolume = -1, this.popCullingSet()
        }
    }), "osg", "CullStack"), t.a = v
}, function (e, t, i) {
    "use strict";
    var n = i(615),
        r = [function (e, t, i, n, r) {
            e.applyModelViewMatrix(t, i), e.applyProjectionMatrix(r)
        }, function (e, t, i, n, r) {
            var a = e.getGraphicContext(),
                o = e.applyModelViewMatrix(t, i);
            if (e.applyProjectionMatrix(r), o) {
                var s = e._modelMatrix;
                s.setMatrix4(i), s.apply(a, this.modelUniform)
            }
        }, function (e, t, i, n, r) {
            var a = e.getGraphicContext(),
                o = e.applyModelViewMatrix(t, i);
            if (e.applyProjectionMatrix(r), o) {
                var s = e._viewMatrix;
                s.setMatrix4(n), s.apply(a, this.viewUniform)
            }
        }, function (e, t, i, n, r) {
            var a = e.getGraphicContext(),
                o = e.applyModelViewMatrix(t, i);
            if (e.applyProjectionMatrix(r), o) {
                var s = e._modelMatrix;
                s.setMatrix4(i), s.apply(a, this.modelUniform);
                var u = e._viewMatrix;
                u.setMatrix4(n), u.apply(a, this.viewUniform)
            }
        }],
        a = function (e, t) {
            this.modelUniform = t._uniformsCache[e._modelMatrix.getName()], this.viewUniform = t._uniformsCache[e._viewMatrix.getName()];
            var i = 0;
            this.modelUniform && (i = 1), this.viewUniform && (i |= 2), this.apply = r[i]
        },
        o = function () {
            this._parent = void 0, this._geometry = void 0, this._depth = 0, this._projection = void 0, this._view = void 0, this._model = void 0, this._modelView = void 0
        };
    o.prototype = {
        reset: function () {
            this._parent = void 0, this._geometry = void 0, this._depth = 0, this._projection = void 0, this._view = void 0, this._model = void 0, this._modelView = void 0
        },
        init: function (e, t, i, n, r, a, o) {
            this._parent = e, this._geometry = t, this._depth = o, this._projection = i, this._view = n, this._model = a, this._modelView = r
        },
        drawGeometry: function () {
            return function (e) {
                var t = e.getLastProgramApplied(),
                    i = t.getInstanceID(),
                    n = e.getCacheUniformsApplyRenderLeaf(),
                    r = n[i];
                r || (r = new a(e, t), n[i] = r), r.apply(e, this._modelView, this._model, this._view, this._projection), this._geometry.drawImplementation(e)
            }
        }(),
        render: function () {
            var e = 0,
                t = -1;
            return function (i, r) {
                var a, o, s = this._parent,
                    u = s._parent,
                    l = s._stateset;
                void 0 !== r ? (a = r._parent, o = a._parent, o !== u ? (n.a.moveStateGraph(i, o, u), i.applyStateSet(l)) : s !== a ? i.applyStateSet(l) : i._stateSetStackChanged(e, t) && i.applyStateSet(l)) : (n.a.moveStateGraph(i, void 0, u), i.applyStateSet(l)), i._setStateSetsDrawID(++e), t = i.getStateSetStackSize(), this.drawGeometry(i)
            }
        }()
    }, t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(137),
        a = i(84),
        o = function () {
            r.a.call(this), this._values = []
        };
    n.a.createPrototypeNode(o, n.a.objectInherit(r.a.prototype, {
        addChild: function (e, t) {
            return r.a.prototype.addChild.call(this, e), void 0 === t && (t = !0), this.children.length > this._values.length ? this._values.push(t) : this._values[this.children.length - 1] = t, !0
        },
        setValue: function (e, t) {
            e < this._values.length && (this._values[e] = t)
        },
        getValue: function (e) {
            if (e < this._values.length) return this._values[e]
        },
        setAllChildrenOff: function () {
            for (var e = 0; e < this._values.length; ++e) this._values[e] = !1
        },
        setAllChildrenOn: function () {
            for (var e = 0; e < this._values.length; ++e) this._values[e] = !0
        },
        traverse: function () {
            return function (e) {
                switch (e.traversalMode) {
                    case a.a.TRAVERSE_ALL_CHILDREN:
                        for (var t = 0; t < this.children.length; ++t) this.children[t].accept(e);
                        break;
                    case a.a.TRAVERSE_ACTIVE_CHILDREN:
                        var i = this.children.length;
                        for (this._values.length < i && (i = this._values.length), t = 0; t < i; ++t) !0 === this._values[t] && this.children[t].accept(e)
                }
            }
        }()
    }), "osg", "Switch"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(451),
        a = i(84),
        o = i(36),
        s = i(102),
        u = function () {
            a.a.call(this)
        };
    n.a.createPrototypeObject(u, n.a.objectInherit(a.a.prototype, {
        apply: function (e) {
            if (e.getTypeID() === r.a.getTypeID()) {
                for (var t = !1, i = e.getChildren(), n = 0, a = e.getChildren().length; n < a; n++) {
                    if (i[n].getTypeID() === r.a.getTypeID()) {
                        if (t) return void o.a.warn("Warning: a Bone was found after a non-Bone child within a Skeleton. Children of a Bone must be ordered with all child Bones first for correct update order.")
                    } else t = !0
                }
                this.traverse(e)
            }
        }
    }), "osgAnimation", "ValidateSkeletonVisitor");
    var l = function (e, t) {
            return (e instanceof r.a ? 0 : 1) - (t instanceof r.a ? 0 : 1)
        },
        c = function () {
            this._needValidate = !0
        };
    n.a.createPrototypeObject(c, n.a.objectInherit(s.a.prototype, {
        needToValidate: function () {
            return this._needValidate
        },
        update: function (e, t) {
            if (this._needValidate && t.getVisitorType() === a.a.UPDATE_VISITOR && e.className && "Skeleton" === e.className()) {
                for (var i = new u, n = e.getChildren(), r = 0, o = n.length; r < o; r++) {
                    n[r].accept(i)
                }
                n.sort(l), this._needValidate = !1
            }
            return !0
        }
    }), "osgAnimation", "UpdateSkeleton"), t.a = c
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(92),
        a = i(108),
        o = function (e, t) {
            r.a.call(this), this._nbTarget = e, this._enable = !t, this._targetNames = {}, this._hashNames = "", this._hash = "", this._dirtyHash = !0
        };
    o.uniforms = {}, n.a.createPrototypeStateAttribute(o, n.a.objectInherit(r.a.prototype, {
        attributeType: "Morph",
        cloneType: function () {
            return new o(void 0, !0)
        },
        hasTarget: function (e) {
            return !!this._targetNames[e]
        },
        copyTargetNames: function (e) {
            for (var t = this._targetNames, i = "", n = t.length = e.length, r = 0; r < n; ++r) {
                var a = e[r];
                t[a] = !0, i += a
            }
            this._hashNames = i, this._dirtyHash = !0
        },
        getOrCreateUniforms: function () {
            var e = o,
                t = this.getNumTargets();
            return e.uniforms[t] ? e.uniforms[t] : (e.uniforms[t] = {
                uTargetWeights: a.a.createFloat4("uTargetWeights")
            }, e.uniforms[t])
        },
        setNumTargets: function (e) {
            this._nbTarget = e, this._dirtyHash = !0
        },
        getNumTargets: function () {
            return this._nbTarget
        },
        setTargetWeights: function (e) {
            this._targetWeights = e
        },
        getTargetWeights: function () {
            return this._targetWeights
        },
        isEnabled: function () {
            return this._enable
        },
        getHash: function () {
            return this._dirtyHash ? (this._hash = this._computeInternalHash(), this._dirtyHash = !1, this._hash) : this._hash
        },
        _computeInternalHash: function () {
            return this.getTypeMember() + this._hashNames + this.getNumTargets() + this.isEnabled()
        },
        apply: function () {
            if (this._enable) {
                this.getOrCreateUniforms().uTargetWeights.setFloat4(this._targetWeights)
            }
        }
    }), "osgAnimation", "MorphAttribute"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(92),
        a = i(108),
        o = function (e, t) {
            r.a.call(this), this._enable = !e, this._boneUniformSize = t, this._dirtyHash = !0, this._hash = ""
        };
    o.uniforms = {}, o.maxBoneUniformSize = 1, o.maxBoneUniformAllowed = 1 / 0, n.a.createPrototypeStateAttribute(o, n.a.objectInherit(r.a.prototype, {
        attributeType: "Skinning",
        cloneType: function () {
            return new o(!0)
        },
        getBoneUniformSize: function () {
            return void 0 !== this._boneUniformSize ? this._boneUniformSize : o.maxBoneUniformSize
        },
        getOrCreateUniforms: function () {
            var e = o,
                t = this.getBoneUniformSize();
            return e.uniforms[t] ? e.uniforms[t] : (e.uniforms[t] = {
                uBones: a.a.createFloat4Array("uBones", t)
            }, e.uniforms[t])
        },
        setMatrixPalette: function (e) {
            this._matrixPalette = e, void 0 === this._boneUniformSize && (o.maxBoneUniformSize = Math.max(o.maxBoneUniformSize, e.length / 4), o.maxBoneUniformSize = Math.min(o.maxBoneUniformAllowed, o.maxBoneUniformSize))
        },
        getMatrixPalette: function () {
            return this._matrixPalette
        },
        isEnabled: function () {
            return this._enable
        },
        getHash: function () {
            return this._dirtyHash ? (this._hash = this._computeInternalHash(), this._dirtyHash = !0, this._hash) : this._hash
        },
        _computeInternalHash: function () {
            return this.getTypeMember() + this.getBoneUniformSize() + this.isEnabled()
        },
        apply: function () {
            this._enable && this.getOrCreateUniforms().uBones.getInternalArray().set(this._matrixPalette)
        }
    }), "osgAnimation", "SkinningAttribute"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = function (e, t, i) {
        this._mode = e, this._first = t, this._arrayLengths = i.slice(0)
    };
    n.prototype = {
        draw: function (e) {
            for (var t = e.getGraphicContext(), i = this._mode, n = this._first, r = this._arrayLengths, a = 0, o = r.length; a < o; a++) {
                var s = r[a];
                t.drawArrays(i, n, s), n += s
            }
        },
        getMode: function () {
            return this._mode
        },
        getNumIndices: function () {
            for (var e = 0, t = this._arrayLengths, i = 0, n = t.length; i < n; i++) e += t[i];
            return e
        },
        getCount: function () {
            return this.getNumIndices()
        },
        getArrayLengths: function () {
            return this._arrayLengths
        },
        getFirst: function () {
            return this._first
        },
        setFirst: function (e) {
            this._first = e
        }
    }, t.a = n
}, function (e, t, i) {
    "use strict";
    var n = function () {
        this._frame = 0, this._startSimulation = 0, this._currentSimulation = 0, this._deltaTime = 0
    };
    n.prototype = {
        setReferenceTime: function (e) {
            this._startSimulation = e
        },
        getReferenceTime: function () {
            return this._startSimulation
        },
        setSimulationTime: function (e) {
            this._currentSimulation = e
        },
        getSimulationTime: function () {
            return this._currentSimulation
        },
        setDeltaTime: function (e) {
            this._deltaTime = e
        },
        getDeltaTime: function () {
            return this._deltaTime
        },
        setFrameNumber: function (e) {
            this._frame = e
        },
        getFrameNumber: function () {
            return this._frame
        }
    }, t.a = n
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(10),
        a = i(317),
        o = i(686),
        s = i(138),
        u = i(36),
        l = function (e, t) {
            this._bb = new a.a, this._first = e, this._second = t, this._nodeRayStart = r.f.create(), this._nodeRayEnd = r.f.create()
        },
        c = function () {
            this._numVertexIndices = 0
        };
    c.prototype = {
        apply: function (e) {
            e.getAttributes().Vertex && Object(o.a)(e, this)
        },
        operatorPoint: function () {
            this._numVertexIndices += 2
        },
        operatorLine: function () {
            this._numVertexIndices += 3
        },
        operatorTriangle: function () {
            this._numVertexIndices += 4
        }
    };
    var h = function (e) {
        this._buildKdTree = e, this._numIndices = 0
    };
    h.prototype = {
        apply: function (e) {
            e.getAttributes().Vertex && Object(o.a)(e, this)
        },
        operatorPoint: function (e) {
            var t = this._buildKdTree._kdTree.getVertices(),
                i = 3 * e;
            this._buildKdTree._kdTree.addPoint(e), this._buildKdTree._primitiveIndices[this._numIndices] = this._numIndices;
            var n = this._buildKdTree._centers,
                r = 3 * this._numIndices;
            n[r] = t[i], n[r + 1] = t[i + 1], n[r + 2] = t[i + 2], this._numIndices++
        },
        operatorLine: function (e, t) {
            if (e !== t) {
                var i = this._buildKdTree._kdTree.getVertices(),
                    n = 3 * e,
                    r = 3 * t;
                this._buildKdTree._kdTree.addLine(e, t);
                var a = this._numIndices;
                this._buildKdTree._primitiveIndices[a] = a;
                var o = 3 * a,
                    s = i[n],
                    u = i[n + 1],
                    l = i[n + 2],
                    c = i[r],
                    h = i[r + 1],
                    d = i[r + 2],
                    f = s < c ? s : c,
                    p = u < h ? u : h,
                    m = l < d ? l : d,
                    g = s > c ? s : c,
                    v = u > h ? u : h,
                    _ = l > d ? l : d,
                    b = this._buildKdTree._centers;
                b[o] = .5 * (f + g), b[o + 1] = .5 * (p + v), b[o + 2] = .5 * (m + _), this._numIndices++
            }
        },
        operatorTriangle: function (e, t, i) {
            if (e !== t && e !== i && t !== i) {
                var n = this._buildKdTree._kdTree.getVertices(),
                    r = 3 * e,
                    a = 3 * t,
                    o = 3 * i;
                this._buildKdTree._kdTree.addTriangle(e, t, i);
                var s = this._numIndices;
                this._buildKdTree._primitiveIndices[s] = s;
                var u = 3 * s,
                    l = n[r],
                    c = n[r + 1],
                    h = n[r + 2],
                    d = n[a],
                    f = n[a + 1],
                    p = n[a + 2],
                    m = n[o],
                    g = n[o + 1],
                    v = n[o + 2],
                    _ = l < d ? l < m ? l : m : d < m ? d : m,
                    b = c < f ? c < g ? c : g : f < g ? f : g,
                    S = h < p ? h < v ? h : v : p < v ? p : v,
                    x = l > d ? l > m ? l : m : d > m ? d : m,
                    y = c > f ? c > g ? c : g : f > g ? f : g,
                    C = h > p ? h > v ? h : v : p > v ? p : v,
                    T = this._buildKdTree._centers;
                T[u] = .5 * (_ + x), T[u + 1] = .5 * (b + y), T[u + 2] = .5 * (S + C), this._numIndices++
            }
        }
    };
    var d = function (e) {
        this._kdTree = e, this._bb = new a.a, this._primitiveIndices = void 0, this._centers = void 0, this._axisOrder = r.f.create(), this._stackLength = 0
    };
    d.prototype = {
        build: function (e, t) {
            var i = e._targetNumTrianglesPerLeaf,
                n = t.getVertexAttributeList().Vertex;
            if (!n) return !1;
            var r = n.getElements();
            if (!r) return !1;
            var o = r.length / 3;
            if (o < i) return !1;
            this._bb.copy(t.getBoundingBox()), this._kdTree.setVertices(r), this.computeDivisions(e), e._numVerticesProcessed += o;
            for (var u = 0, d = t.getPrimitiveSetList(), f = d.length, p = 0; p < f; p++) {
                var m = d[p],
                    g = m.getMode();
                g === s.a.TRIANGLE_STRIP || g === s.a.TRIANGLE_FAN ? u += 3 * Math.abs(m.getCount() - 2) : u += 3 * m.getCount()
            }
            var v = new c(this);
            v.apply(t);
            var _ = v._numVertexIndices;
            this._primitiveIndices = new Uint32Array(u / 3), this._centers = new Float32Array(u), this._kdTree.setPrimitiveIndices(new Uint32Array(u));
            var b = o > 65535 ? new Uint32Array(_) : new Uint16Array(_);
            this._kdTree.setVertexIndices(b);
            var S = new h(this);
            S.apply(t);
            var x = this._kdTree.getPrimitiveIndices().slice(0, this._kdTree.getNumPrimitiveIndices());
            this._kdTree.setPrimitiveIndices(x);
            var y = this._kdTree.getVertexIndices().slice(0, this._kdTree.getNumVertexIndices());
            this._kdTree.setVertexIndices(y), this._primitiveIndices = this._primitiveIndices.slice(0, S._numIndices), this._centers = this._centers.slice(0, 3 * S._numIndices);
            var C = new l(-1, this._primitiveIndices.length);
            C._bb.copy(this._bb);
            var T = this._kdTree.addNode(C),
                w = new a.a;
            w.copy(this._bb), this.divide(e, w, T, 0);
            var M = this._kdTree.getPrimitiveIndices();
            for (f = this._primitiveIndices.length, p = 0; p < f; ++p) this._primitiveIndices[p] = M[this._primitiveIndices[p]];
            return this._kdTree.setPrimitiveIndices(this._primitiveIndices), this._kdTree.getNodes().length > 0
        },
        computeDivisions: function (e) {
            this._stackLength = e._maxNumLevels;
            var t = this._bb._max,
                i = this._bb._min,
                n = t[0] - i[0],
                r = t[1] - i[1],
                a = t[2] - i[2],
                o = this._axisOrder;
            o[0] = n >= r && n >= a ? 0 : r >= a ? 1 : 2, o[2] = n < r && n < a ? 0 : r < a ? 1 : 2;
            var s = o[0] + o[2];
            o[1] = 3 === s ? 0 : 2 === s ? 1 : 2
        },
        divide: function (e, t, i, n) {
            var r = this._kdTree,
                a = this._primitiveIndices,
                o = r.getNodes(),
                s = o[i],
                u = s._first,
                c = s._second,
                h = n < this._stackLength && u < 0 && c > e._targetNumTrianglesPerLeaf,
                d = -u - 1,
                f = d + c - 1;
            if (!h) return u < 0 && this.computeNodeBox(s, d, f), i;
            if (u >= 0) return i;
            for (var p = this._axisOrder[n % 3], m = t._min[p], g = t._max[p], v = .5 * (m + g), _ = 0, b = 0, S = !1, x = d, y = f, C = this._centers; x < y;) {
                for (; x < y && C[3 * a[x] + p] <= v;) ++x;
                for (; x < y && C[3 * a[y] + p] > v;) --y;
                if (x < y) {
                    var T = a[x];
                    a[x] = a[y], a[y] = T, ++x, --y
                }
            }
            x === y && (C[3 * a[x] + p] <= v ? ++x : --y), y - d <= -1 ? (_ = 0, b = i, S = !0) : f - x <= -1 ? (_ = i, b = 0, S = !0) : (_ = r.addNode(new l(-d - 1, y - d + 1)), b = r.addNode(new l(-x - 1, f - x + 1)));
            var w = t._max[p];
            t._max[p] = v;
            var M = 0 !== _ ? this.divide(e, t, _, n + 1) : 0;
            t._max[p] = w, w = t._min[p], t._min[p] = v;
            var E = 0 !== b ? this.divide(e, t, b, n + 1) : 0;
            if (t._min[p] = w, !S) {
                s._first = M, s._second = E, S = !0;
                var A = s._bb;
                A.init(), 0 !== M && A.expandByBoundingBox(o[M]._bb), 0 !== E && A.expandByBoundingBox(o[E]._bb)
            }
            return i
        },
        computeNodeBox: function (e, t, i) {
            for (var n = 1 / 0, r = 1 / 0, a = 1 / 0, o = -1 / 0, s = -1 / 0, u = -1 / 0, l = this._kdTree.getVertexIndices(), c = this._kdTree.getPrimitiveIndices(), h = this._kdTree.getVertices(), d = t; d <= i; ++d)
                for (var f = c[this._primitiveIndices[d]], p = l[f++], m = 0; m < p; ++m) {
                    var g = 3 * l[f++],
                        v = h[g],
                        _ = h[g + 1],
                        b = h[g + 2];
                    v < n && (n = v), _ < r && (r = _), b < a && (a = b), v > o && (o = v), _ > s && (s = _), b > u && (u = b)
                }
            var S = e._bb,
                x = S._min,
                y = S._max;
            x[0] = n - 1e-6, x[1] = r - 1e-6, x[2] = a - 1e-6, y[0] = o + 1e-6, y[1] = s + 1e-6, y[2] = u + 1e-6
        }
    };
    var f = function () {
        this._vertices = null, this._kdNodes = [], this._primitiveIndices = void 0, this._vertexIndices = void 0, this._numVertexIndices = 0, this._numPrimitiveIndices = 0
    };
    n.a.createPrototypeObject(f, {
        getVertices: function () {
            return this._vertices
        },
        setVertices: function (e) {
            this._vertices = e
        },
        getNumPrimitiveIndices: function () {
            return this._numPrimitiveIndices
        },
        getNumVertexIndices: function () {
            return this._numVertexIndices
        },
        setPrimitiveIndices: function (e) {
            this._primitiveIndices = e
        },
        getPrimitiveIndices: function () {
            return this._primitiveIndices
        },
        setVertexIndices: function (e) {
            this._vertexIndices = e
        },
        getVertexIndices: function () {
            return this._vertexIndices
        },
        getNodes: function () {
            return this._kdNodes
        },
        addPoint: function (e) {
            var t = this._numVertexIndices;
            this._primitiveIndices[this._numPrimitiveIndices++] = t, this._vertexIndices[this._numVertexIndices++] = 1, this._vertexIndices[this._numVertexIndices++] = e
        },
        addLine: function (e, t) {
            var i = this._numVertexIndices;
            this._primitiveIndices[this._numPrimitiveIndices++] = i, this._vertexIndices[this._numVertexIndices++] = 2, this._vertexIndices[this._numVertexIndices++] = e, this._vertexIndices[this._numVertexIndices++] = t
        },
        addTriangle: function (e, t, i) {
            var n = this._numVertexIndices;
            this._primitiveIndices[this._numPrimitiveIndices++] = n, this._vertexIndices[this._numVertexIndices++] = 3, this._vertexIndices[this._numVertexIndices++] = e, this._vertexIndices[this._numVertexIndices++] = t, this._vertexIndices[this._numVertexIndices++] = i
        },
        addNode: function (e) {
            return this._kdNodes.push(e), this._kdNodes.length - 1
        },
        build: function (e, t) {
            return new d(this).build(e, t)
        },
        _intersectFunctor: function (e, t) {
            var i = -t._first - 1,
                n = i + t._second,
                r = this._vertexIndices;
            e.setVertices(this._vertices), e.setPrimitiveIndex(i);
            for (var a = i; a < n; ++a) {
                var o = this._primitiveIndices[a],
                    s = r[o++];
                3 === s ? e.operatorTriangle(r[o], r[o + 1], r[o + 2]) : 2 === s ? e.operatorLine(r[o], r[o + 1]) : 1 === s ? e.operatorPoint(r[o]) : u.a.error("KdTree::intersect() unsupported vertices count :" + s)
            }
        },
        intersect: function (e, t) {
            if (t._first < 0) return void this._intersectFunctor(e, t);
            e.enter(t._bb) && (t._first > 0 && this.intersect(e, this._kdNodes[t._first]), t._second > 0 && this.intersect(e, this._kdNodes[t._second]), e.leave())
        },
        intersectLineSegment: function (e, t, i, n) {
            if (t._first < 0) return void this._intersectFunctor(e, t);
            var a = t._nodeRayStart,
                o = t._nodeRayEnd;
            r.f.copy(a, i), r.f.copy(o, n);
            var s, u = this._kdNodes;
            t._first > 0 && (s = u[t._first], e.enter(s._bb, a, o) && this.intersectLineSegment(e, s, a, o)), t._second > 0 && (r.f.copy(a, i), r.f.copy(o, n), s = u[t._second], e.enter(s._bb, a, o) && this.intersectLineSegment(e, s, a, o))
        }
    }, "osg", "KdTree"), t.a = f
}, function (e, t, i) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: !0
    });
    var n = i(12),
        r = i(92),
        a = i(10),
        o = i(108),
        s = function () {
            r.a.call(this), this._ambient = a.g.fromValues(.2, .2, .2, 1), this._diffuse = a.g.fromValues(.8, .8, .8, 1), this._specular = a.g.fromValues(0, 0, 0, 1), this._emission = a.g.fromValues(0, 0, 0, 1), this._shininess = 12.5
        };
    n.a.createPrototypeStateAttribute(s, n.a.objectInherit(r.a.prototype, {
        attributeType: "Material",
        cloneType: function () {
            return new s
        },
        getParameterName: function (e) {
            return "u" + this.getType() + "_" + e
        },
        getOrCreateUniforms: function () {
            var e = s;
            return e.uniforms ? e.uniforms : (e.uniforms = {
                ambient: o.a.createFloat4("uMaterialAmbient"),
                diffuse: o.a.createFloat4("uMaterialDiffuse"),
                specular: o.a.createFloat4("uMaterialSpecular"),
                emission: o.a.createFloat4("uMaterialEmission"),
                shininess: o.a.createFloat1("uMaterialShininess")
            }, e.uniforms)
        },
        setEmission: function (e) {
            a.g.copy(this._emission, e)
        },
        getEmission: function () {
            return this._emission
        },
        setAmbient: function (e) {
            a.g.copy(this._ambient, e)
        },
        getAmbient: function () {
            return this._ambient
        },
        setSpecular: function (e) {
            a.g.copy(this._specular, e)
        },
        getSpecular: function () {
            return this._specular
        },
        setDiffuse: function (e) {
            a.g.copy(this._diffuse, e)
        },
        getDiffuse: function () {
            return this._diffuse
        },
        setShininess: function (e) {
            this._shininess = e
        },
        getShininess: function () {
            return this._shininess
        },
        setTransparency: function (e) {
            this._diffuse[3] = 1 - e
        },
        getTransparency: function () {
            return this._diffuse[3]
        },
        apply: function () {
            var e = this.getOrCreateUniforms();
            e.ambient.setFloat4(this._ambient), e.diffuse.setFloat4(this._diffuse), e.specular.setFloat4(this._specular), e.emission.setFloat4(this._emission), e.shininess.setFloat(this._shininess)
        }
    }), "osg", "Material"), t.default = s
}, function (e, t, i) {
    "use strict";
    var n = function () {
        this._globalDefault = void 0, this._lastApplied = void 0, this._changed = !1, this._values = [], this._back = void 0, this._length = 0
    };
    n.prototype = {
        getLength: function () {
            return this._length
        },
        push: function (e, t) {
            var i;
            this._length === this._values.length ? (i = {
                object: e,
                value: t
            }, this._values.push(i)) : (i = this._values[this._length], i.object = e, i.value = t), this._back = i, this._length++
        },
        pop: function () {
            if (this._length) {
                var e = this._values;
                this._length--;
                var t = e[this._length];
                return this._back = this._length ? e[this._length - 1] : void 0, t
            }
        }
    }, t.a = n
}, function (e, t, i) {
    "use strict";
    var n = i(10),
        r = i(36),
        a = i(102),
        o = i(292),
        s = i(92),
        u = i(290),
        l = i(860),
        c = i(108),
        h = i(12),
        d = i(319),
        f = i(1092),
        p = [void 0, function (e, t) {
            return e[0] === t[0] || (t[0] = e[0], !1)
        }, function (e, t) {
            return e[0] === t[0] && e[1] === t[1] || (t[0] = e[0], t[1] = e[1], !1)
        }, function (e, t) {
            return e[0] === t[0] && e[1] === t[1] && e[2] === t[2] || (t[0] = e[0], t[1] = e[1], t[2] = e[2], !1)
        }, function (e, t) {
            return e[0] === t[0] && e[1] === t[1] && e[2] === t[2] && e[3] === t[3] || (t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[3], !1)
        }],
        m = function (e) {
            a.a.call(this), this._excludeUniforms = {
                uProjectionMatrix: !0,
                uModelMatrix: !0,
                uViewMatrix: !0,
                uModelViewMatrix: !0,
                uModelNormalMatrix: !0,
                uModelViewNormalMatrix: !0,
                uArrayColorEnabled: !0
            }, this._graphicContext = void 0, this._shaderGeneratorProxy = e, void 0 === e && console.break(), this._currentVAO = null, this._currentIndexVBO = null, this._stateSets = new u.a, this._shaderGeneratorNames = new l.a, this._uniforms = {}, this._textureAttributeArrayList = [], this._attributeArray = [], this._projectionMatrix = c.a.createMatrix4(n.c.create(), "uProjectionMatrix"), this._modelMatrix = c.a.createMatrix4(n.c.create(), "uModelMatrix"), this._viewMatrix = c.a.createMatrix4(n.c.create(), "uViewMatrix"), this._modelViewMatrix = c.a.createMatrix4(n.c.create(), "uModelViewMatrix"), this._modelNormalMatrix = c.a.createMatrix3(n.b.create(), "uModelNormalMatrix"), this._modelViewNormalMatrix = c.a.createMatrix3(n.b.create(), "uModelViewNormalMatrix");
            var t = new l.a;
            t._globalDefault = c.a.createFloat1(0, "uArrayColorEnabled"), this._uniforms.ArrayColorEnabled = t, this._previousColorAttribPair = {}, this._vertexAttribMap = {}, this._vertexAttribMap._disable = [], this._vertexAttribMap._keys = [], this._frameStamp = void 0, this._programCommonUniformsCache = {}, this._lastAppliedModelViewMatrix = void 0, this._lastAppliedProjectionMatrix = void 0, this._program = void 0;
            var i = new o.a;
            this.applyAttribute(i), this._programType = h.a.getOrCreateStateAttributeTypeMemberIndex(i), this._programAttribute = this._attributeArray[this._programType], this._numPushStateSet = 0, this._numApply = 0, this._programUniformCache = [], this._cacheUniformId = 0, this._stateCache = new f.a, this.resetStats()
        };
    h.a.createPrototypeObject(m, h.a.objectInherit(a.a.prototype, {
        getExcludeUniforms: function () {
            return this._excludeUniforms
        },
        resetCaches: function () {
            this._currentVAO = null, this._currentIndexVBO = null, this._previousColorAttribPair = {}, this._vertexAttribMap = {}, this._vertexAttribMap._disable = [], this._vertexAttribMap._keys = [], this._programCommonUniformsCache = {}
        },
        applyColorMask: function (e) {
            this._stateCache.applyColorMaskAttribute(e)
        },
        applyBlendFunc: function (e) {
            this._stateCache.applyBlendFuncAttribute(e)
        },
        applyCullFace: function (e) {
            this._stateCache.applyCullFaceAttribute(e)
        },
        applyDepth: function (e) {
            this._stateCache.applyDepthAttribute(e)
        },
        applyViewport: function (e) {
            this._stateCache.applyViewportAttribute(e)
        },
        applyScissor: function (e) {
            this._stateCache.applyScissorAttribute(e)
        },
        viewport: function (e, t, i, n) {
            this._stateCache.viewport(e, t, i, n)
        },
        depthMask: function (e) {
            this._stateCache.depthMask(e)
        },
        clearDepth: function (e) {
            this._stateCache.clearDepth(e)
        },
        clearColor: function (e) {
            this._stateCache.clearColor(e)
        },
        clear: function (e) {
            this._stateCache.clear(this._graphicContext, e)
        },
        drawGeometry: function (e) {
            this._stateCache.drawGeometry(this._graphicContext, e)
        },
        getCacheUniformsApplyRenderLeaf: function () {
            return this._programCommonUniformsCache
        },
        setGraphicContext: function (e) {
            this._graphicContext = e, this._extVAO = d.a.instance(e).getWebGLExtension("OES_vertex_array_object")
        },
        getGraphicContext: function () {
            return this._graphicContext
        },
        getShaderGeneratorProxy: function () {
            return this._shaderGeneratorProxy
        },
        pushCheckOverride: function (e, t, i) {
            var n = this._evaluateOverrideObjectOnStack(e, t, i);
            n !== t ? e.push(n, e._back.value) : e.push(t, i)
        },
        _evaluateOverrideObjectOnStack: function (e, t, i) {
            var n = e._back;
            return 0 === e._length ? t : n.value & s.a.OVERRIDE && !(i & s.a.PROTECTED) ? n.object : t
        },
        pushStateSet: function (e) {
            this._numPushStateSet++, this._stateSets.push(e), this.pushAttributeMap(this._attributeArray, e._attributeArray, e._activeAttribute);
            for (var t = e._textureAttributeArrayList, i = e._activeTextureAttributeUnit, n = e._activeTextureAttribute, r = 0, a = i.length; r < a; r++) {
                var o = i[r],
                    s = t[o],
                    u = this.getOrCreateTextureAttributeArray(o);
                this.pushAttributeMap(u, s, n)
            }
            e.hasUniform() && this.pushUniformsList(this._uniforms, e.getUniformList());
            var l = e.getShaderGeneratorPair();
            l && this.pushCheckOverride(this._shaderGeneratorNames, l.getShaderGeneratorName(), l.getValue())
        },
        getStateSetStackSize: function () {
            return this._stateSets.getLength()
        },
        insertStateSet: function () {
            var e = new u.a,
                t = e.getArray();
            return function (i, n) {
                e.reset();
                for (var r = this.getStateSetStackSize(); r > i;) e.push(this._stateSets.back()), this.popStateSet(), r--;
                this.pushStateSet(n);
                for (var a = e._length - 1; a >= 0; a--) this.pushStateSet(t[a])
            }
        }(),
        removeStateSet: function () {
            var e = new u.a,
                t = e.getArray();
            return function (i) {
                var n = this.getStateSetStackSize();
                if (i >= n) return void r.a.warn("Warning State:removeStateSet " + i + " out of range");
                for (e.reset(); n - 1 > i;) e.push(this._stateSets.back()), this.popStateSet(), n--;
                this.popStateSet();
                for (var a = e._length - 1; a >= 0; a--) this.pushStateSet(t[a])
            }
        }(),
        resetCacheFrame: function () {
            this._lastAppliedModelViewMatrix = this._lastAppliedProjectionMatrix = void 0
        },
        resetStats: function () {
            this._numApply = 0, this._numPushStateSet = 0
        },
        applyProgram: function (e) {
            this._program !== e && (this._program = e, this.getGraphicContext().useProgram(e))
        },
        applyModelViewMatrix: function () {
            var e = n.b.create();
            return function (t, i) {
                if (this._lastAppliedModelViewMatrix === t) return !1;
                var r = this.getLastProgramApplied(),
                    a = r.getUniformsCache(),
                    o = this._modelViewMatrix,
                    s = a.uModelViewMatrix,
                    u = this.getGraphicContext();
                s && (o.setMatrix4(t), o.apply(u, s));
                var l;
                if (this._lastAppliedModelViewMatrix) {
                    for (var c = this._lastAppliedModelViewMatrix, h = 0; h < 11; h++)
                        if (t[h] !== c[h]) {
                            l = !0;
                            break
                        }
                } else l = !0;
                return l && (o = this._modelViewNormalMatrix, s = a.uModelViewNormalMatrix, s && (n.b.normalFromMat4(e, t), o.setMatrix3(e), o.apply(u, s)), (s = a.uModelNormalMatrix) && (n.b.normalFromMat4(e, i), o.setMatrix3(e), o.apply(u, s))), this._lastAppliedModelViewMatrix = t, !0
            }
        }(),
        applyProjectionMatrix: function (e) {
            if (this._lastAppliedProjectionMatrix !== e) {
                this._lastAppliedProjectionMatrix = e;
                var t = this.getLastProgramApplied(),
                    i = this._projectionMatrix,
                    n = t.getUniformsCache()[i.getName()];
                n && (i.setMatrix4(e), i.apply(this.getGraphicContext(), n))
            }
        },
        getCurrentShaderGeneratorStateSet: function (e) {
            var t = this._programAttribute,
                i = e._attributeArray[this._programType];
            if (!(0 !== t._length && t._back.value !== s.a.OFF || i && i.getValue() !== s.a.OFF)) {
                var n, r = e.getShaderGeneratorPair(),
                    a = this._shaderGeneratorNames;
                if (r) {
                    var o = r.getValue(),
                        u = r.getShaderGeneratorName();
                    n = this._evaluateOverrideObjectOnStack(this._shaderGeneratorNames, u, o)
                } else a._length && (n = a._back.object);
                var l = n;
                return this._shaderGeneratorProxy.getShaderGenerator(l)
            }
        },
        _applyAttributeMapStateSet: function (e, t) {
            for (var i = e.length > t.length ? e.length : t.length, n = 0, r = i; n < r; n++) {
                var a, o = n,
                    s = o < e.length ? e[o] : void 0,
                    u = o < t.length ? t[o] : void 0,
                    l = !!s,
                    c = l && s._changed;
                if (u || c) {
                    var h = u ? u.getAttribute() : void 0;
                    if (l)
                        if (h) {
                            var d = u.getValue();
                            a = this._evaluateOverrideObjectOnStack(s, h, d), a !== h ? s._changed && (this._applyAttributeStack(a, s), s._changed = !1) : this._applyAttributeStack(a, s) && (s._changed = !0)
                        } else s._length ? (s._changed = !1, this._applyAttributeStack(s._back.object, s)) : (s._changed = !1, this._applyAttributeStack(s._globalDefault, s));
                    else s = this._createAttributeStack(e, o, h.cloneType()), s._changed = !0, this._applyAttributeStack(h, s)
                }
            }
        },
        _applyTextureAttributeMapListStateSet: function (e, t) {
            for (var i, n, r, a = 0; a < 16; a++) {
                var o = a;
                i = o < e.length ? e[o] : void 0;
                var s = o < t.length ? t[o] : void 0;
                if (i || s) {
                    n = r = 0, i ? (r = i.length, s && (n = s.length)) : (i = this.getOrCreateTextureAttributeArray(o), n = s.length);
                    for (var u = r > n ? r : n, l = 0; l < u; l++) {
                        var c, h = l,
                            d = h < r ? i[h] : void 0,
                            f = s && h < s.length ? s[h] : void 0,
                            p = !!d,
                            m = p && d._changed;
                        if (f || m) {
                            var g = f ? f.getAttribute() : void 0;
                            if (p)
                                if (g) {
                                    var v = f.getValue();
                                    c = this._evaluateOverrideObjectOnStack(d, g, v), c !== g ? d._changed && (this._applyTextureAttribute(o, c, d), d._changed = !1) : this._applyTextureAttribute(o, c, d) && (d._changed = !0)
                                } else d._length ? (d._changed = !1, this._applyTextureAttribute(o, d._back.object, d)) : (d._changed = !1, this._applyTextureAttribute(o, d._globalDefault, d));
                            else c = f.getAttribute(), d = this._createAttributeStack(i, h, c.cloneType()), d._changed = !0, this._applyTextureAttribute(o, c, d)
                        }
                    }
                }
            }
        },
        applyStateSet: function (e) {
            this._numApply++;
            var t = this.getLastProgramApplied();
            this._currentShaderGenerator = this.getCurrentShaderGeneratorStateSet(e), this._applyAttributeMapStateSet(this._attributeArray, e._attributeArray), this._applyTextureAttributeMapListStateSet(this._textureAttributeArrayList, e._textureAttributeArrayList);
            var i;
            if (this._currentShaderGenerator) {
                var n = this._currentShaderGenerator.getOrCreateProgram(this);
                this.applyAttribute(n), i = n, this._applyGeneratedProgramUniforms(n, e)
            } else i = this.getLastProgramApplied(), this._applyCustomProgramUniforms(i, e);
            t !== i && (this._lastAppliedModelViewMatrix = void 0, this._lastAppliedProjectionMatrix = void 0)
        },
        popAllStateSets: function () {
            for (; this._stateSets._length;) this.popStateSet()
        },
        popStateSet: function () {
            if (this._stateSets._length) {
                var e = this._stateSets.pop();
                this.popAttributeMap(this._attributeArray, e._attributeArray, e._activeAttribute);
                for (var t = e._textureAttributeArrayList, i = e._activeTextureAttributeUnit, n = e._activeTextureAttribute, r = 0, a = i.length; r < a; r++) {
                    var o = i[r],
                        s = t[o],
                        u = this._textureAttributeArrayList[o];
                    this.popAttributeMap(u, s, n)
                }
                e.hasUniform() && this.popUniformsList(this._uniforms, e.getUniformList()), e.getShaderGeneratorPair() && this._shaderGeneratorNames.pop()
            }
        },
        _createAttributeStack: function (e, t, i) {
            h.a.arrayDense(t, e);
            var n = new l.a;
            return n._globalDefault = i, e[t] = n, n
        },
        haveAppliedAttribute: function (e) {
            if (e) {
                var t = this._attributeArray,
                    i = h.a.getOrCreateStateAttributeTypeMemberIndex(e),
                    n = i < t.length ? t[i] : void 0;
                n || (n = this._createAttributeStack(t, i, e.cloneType())), n._lastApplied = e, n._changed = !0
            }
        },
        applyAttribute: function (e) {
            var t = h.a.getOrCreateStateAttributeTypeMemberIndex(e),
                i = this._attributeArray,
                n = t < i.length ? i[t] : void 0;
            n || (n = this._createAttributeStack(i, t, e.cloneType())), n._changed = !0, this._applyAttributeStack(e, n)
        },
        _applyAttributeStack: function (e, t) {
            return t._lastApplied !== e && (e.apply && e.apply(this), t._lastApplied = e, !0)
        },
        _applyTextureAttribute: function (e, t, i) {
            if (i._lastApplied === t) return !1;
            if (i._lastApplied = t, !t.apply) return !0;
            var n = this.getGraphicContext();
            return n.activeTexture(n.TEXTURE0 + e), t.apply(this, e), !0
        },
        applyTextureAttribute: function (e, t) {
            var i = h.a.getOrCreateTextureStateAttributeTypeMemberIndex(t),
                n = this.getOrCreateTextureAttributeArray(e),
                r = n[i];
            r || (r = this._createAttributeStack(n, i, t.cloneType())), r._changed = !0, this._applyTextureAttribute(e, t, r)
        },
        getLastProgramApplied: function () {
            return this._programAttribute._lastApplied
        },
        applyDefault: function () {
            this.popAllStateSets(), this._currentShaderGenerator = void 0, this.applyAttributeMap(this._attributeArray), this.applyTextureAttributeMapList(this._textureAttributeArrayList)
        },
        applyAttributeMap: function (e) {
            for (var t, i = 0, n = e.length; i < n; i++)
                if (t = e[i]) {
                    var r;
                    r = t._length ? t._back.object : t._globalDefault, t._changed && (t._lastApplied !== r && (r.apply && r.apply(this), t._lastApplied = r), t._changed = !1)
                }
        },
        pushUniformsList: function (e, t) {
            var i, n;
            for (var r in t) {
                var a = t[r];
                n = a.getUniform(), i = n.getName(), e[i] || this._createAttributeStack(e, i, n), this.pushCheckOverride(e[i], n, a.getValue())
            }
        },
        popUniformsList: function (e, t) {
            for (var i in t) e[i].pop()
        },
        applyTextureAttributeMapList: function (e) {
            for (var t, i = this._graphicContext, n = 0, r = e.length; n < r; n++)
                if (t = e[n])
                    for (var a = 0, o = t.length; a < o; a++) {
                        var s = t[a];
                        if (s) {
                            var u;
                            u = s._length ? s._back.object : s._globalDefault, s._changed && (s._lastApplied !== u && (i.activeTexture(i.TEXTURE0 + n), u.apply(this, n), s._lastApplied = u), s._changed = !1)
                        }
                    }
        },
        setGlobalDefaultAttribute: function (e) {
            var t = h.a.getOrCreateStateAttributeTypeMemberIndex(e);
            t >= this._attributeArray.length || !this._attributeArray[t] ? this._createAttributeStack(this._attributeArray, t, e) : this._attributeArray[t]._globalDefault = e
        },
        getGlobalDefaultAttribute: function (e) {
            var t = this._attributeArray,
                i = h.a.getIdFromTypeMember(e);
            if (!(void 0 === i || i >= t.length)) return t[i] ? t[i]._globalDefault : void 0
        },
        setGlobalDefaultTextureAttribute: function (e, t) {
            var i = this.getOrCreateTextureAttributeArray(e),
                n = h.a.getOrCreateTextureStateAttributeTypeMemberIndex(t);
            n >= i.length || !i[n] ? this._createAttributeStack(i, n, t) : i[n]._globalDefault = t
        },
        getGlobalDefaultTextureAttribute: function (e, t) {
            var i = this.getOrCreateTextureAttributeArray(e),
                n = h.a.getTextureIdFromTypeMember(t);
            if (!(void 0 === n || n >= i.length)) return i[n] ? i[n]._globalDefault : void 0
        },
        getOrCreateTextureAttributeArray: function (e) {
            return h.a.arrayDense(e, this._textureAttributeArrayList), this._textureAttributeArrayList[e] || (this._textureAttributeArrayList[e] = []), this._textureAttributeArrayList[e]
        },
        pushAttributeMap: function (e, t, i) {
            for (var n, r = t.length, a = e.length, o = 0, s = i.length; o < s; o++) {
                var u = i[o],
                    l = u < r ? t[u] : void 0,
                    c = l.getAttribute();
                n = u < a ? e[u] : void 0, n || (n = this._createAttributeStack(e, u, c.cloneType())), this.pushCheckOverride(n, c, l.getValue()), n._changed = !0
            }
        },
        popAttributeMap: function (e, t, i) {
            for (var n = 0, r = i.length; n < r; n++) {
                var a = i[n],
                    o = e[a];
                o.pop(), o._changed = !0
            }
        },
        setIndexArray: function (e) {
            var t = this._graphicContext;
            this._currentIndexVBO !== e && (e.bind(t), this._currentIndexVBO = e), e.isDirty() && e.compile(t)
        },
        lazyDisablingOfVertexAttributes: function () {
            for (var e = this._vertexAttribMap._keys, t = 0, i = e.length; t < i; t++) {
                var n = e[t];
                this._vertexAttribMap[n] && (this._vertexAttribMap._disable[n] = !0)
            }
        },
        enableVertexColor: function () {
            var e = this._programAttribute._lastApplied;
            if (e.getUniformsCache().uArrayColorEnabled && e.getAttributesCache().Color) {
                var t = this._uniforms.ArrayColorEnabled._globalDefault;
                this._previousColorAttribPair[e.getInstanceID()] || (t.setFloat(1), t.apply(this.getGraphicContext(), e.getUniformsCache().uArrayColorEnabled), this._previousColorAttribPair[e.getInstanceID()] = !0)
            }
        },
        disableVertexColor: function () {
            var e = this._programAttribute._lastApplied;
            if (e.getUniformsCache().uArrayColorEnabled && e.getAttributesCache().Color) {
                var t = this._uniforms.ArrayColorEnabled._globalDefault;
                this._previousColorAttribPair[e.getInstanceID()] && (t.setFloat(0), t.apply(this.getGraphicContext(), e.getUniformsCache().uArrayColorEnabled), this._previousColorAttribPair[e.getInstanceID()] = !1)
            }
        },
        applyDisablingOfVertexAttributes: function () {
            for (var e = this._vertexAttribMap._keys, t = 0, i = e.length; t < i; t++)
                if (!0 === this._vertexAttribMap._disable[e[t]]) {
                    var n = e[t];
                    this._graphicContext.disableVertexAttribArray(n), this._vertexAttribMap._disable[n] = !1, this._vertexAttribMap[n] = !1
                }
        },
        clearVertexAttribCache: function () {
            for (var e = this._vertexAttribMap, t = e._keys, i = 0, n = t.length; i < n; i++) {
                var r = t[i];
                e[r] = void 0, e._disable[r] = !1
            }
            this._vertexAttribMap._disable.length = 0, this._vertexAttribMap._keys.length = 0
        },
        setVertexArrayObject: function (e) {
            return this._currentVAO !== e && (this._currentVAO = e, e ? e.bind(this._graphicContext) : (this._graphicContext.bindVertexArray(null), this.clearVertexAttribCache()), this._currentIndexVBO = void 0, !0)
        },
        setVertexAttribArray: function (e, t) {
            var i = this._vertexAttribMap;
            i._disable[e] = !1;
            var n = this._graphicContext,
                r = !1;
            t.isDirty() && (t.bind(n), t.compile(n), r = !0);
            var a = i[e];
            a !== t && (r || t.bind(n), a || (n.enableVertexAttribArray(e), void 0 === a && i._keys.push(e)), i[e] = t, n.vertexAttribPointer(e, t.getGlItemSize(), t.getGlType(), t.getGlNormalize(), 0, 0))
        },
        _getActiveUniformsFromProgramAttributes: function (e, t) {
            var i = this._attributeArray,
                n = e.getTrackAttributes().attributeKeys;
            if (n.length > 0)
                for (var r = 0, a = n.length; r < a; r++) {
                    var o = n[r],
                        s = this.typeMember[o],
                        u = i[s];
                    if (u) {
                        var l = u._globalDefault;
                        if (l.getOrCreateUniforms) {
                            var c = l.getOrCreateUniforms();
                            for (var h in c) t.push(c[h])
                        }
                    }
                }
        },
        _getActiveUniformsFromProgramTextureAttributes: function (e, t) {
            var i = e.getTrackAttributes().textureAttributeKeys;
            if (i)
                for (var n = 0, r = i.length; n < r; n++) {
                    var a = i[n];
                    if (a) {
                        var o = this._textureAttributeArrayList[n];
                        if (o)
                            for (var s = 0, u = a.length; s < u; s++) {
                                var l = a[s],
                                    c = o[l];
                                if (c) {
                                    var h = c._globalDefault;
                                    if (h.getOrCreateUniforms) {
                                        var d = h.getOrCreateUniforms();
                                        for (var f in d) t.push(d[f])
                                    }
                                }
                            }
                    }
                }
        },
        _cacheUniformsForCustomProgram: function (e, t) {
            this._getActiveUniformsFromProgramAttributes(e, t), this._getActiveUniformsFromProgramTextureAttributes(e, t);
            for (var i = this._graphicContext, n = {}, r = 0, a = t.length; r < a; r++) {
                var o = t[r],
                    s = o.getName(),
                    u = i.getUniformLocation(e._program, s);
                void 0 !== u && null !== u && (n[s] = o)
            }
            e.trackUniforms = n
        },
        _applyCustomProgramUniforms: function () {
            var e = [];
            return function (t, i) {
                e.length = 0, void 0 !== t.getTrackAttributes() && void 0 === t.trackUniforms && this._cacheUniformsForCustomProgram(t, e);
                var n, r = t.getUniformsCache(),
                    a = this._uniforms;
                t.trackUniforms && (n = t.trackUniforms);
                var o;
                for (var s in r) {
                    var u = r[s],
                        l = a[s],
                        c = i && i.uniforms[s];
                    if (l || c)
                        if (c) {
                            var h = i.uniforms[s],
                                d = h.getValue(),
                                f = h.getUniform();
                            o = l ? this._evaluateOverrideObjectOnStack(l, f, d) : f
                        } else o = l._length ? l._back.object : l._globalDefault;
                    else {
                        if (void 0 === n) {
                            this._checkErrorUniform(s);
                            continue
                        }
                        o = n[s]
                    }
                    o.apply(this._graphicContext, u)
                }
            }
        }(),
        _checkErrorUniform: function (e) {
            var t = e.substr(7);
            this._textureAttributeArrayList[t] && e === "Texture" + t || this._excludeUniforms[e] || (this._excludeUniforms[e] = 1, r.a.error("Uniform not in the scene hierarchy : " + e))
        },
        _computeForeignUniforms: function (e, t) {
            var i = [];
            for (var n in e) {
                void 0 !== e[n] && void 0 === t[n] && (this._excludeUniforms[n] || i.push(n))
            }
            return i
        },
        _removeUniformsNotRequiredByProgram: function (e, t) {
            for (var i in e) {
                var n = t[i];
                void 0 !== n && null !== n || delete e[i]
            }
        },
        _cacheUniformsForGeneratedProgram: function (e) {
            var t = e.getUniformsCache(),
                i = e.getActiveUniforms(),
                n = this._computeForeignUniforms(t, i);
            e.setForeignUniforms(n), this._removeUniformsNotRequiredByProgram(i, t)
        },
        _copyUniformEntry: function (e) {
            var t, i = e.getInternalArray();
            return i.length < 16 && (t = new i.constructor(i.length)), t
        },
        _initUniformCache: function (e) {
            var t, i, n, r, a, o, s = e.getActiveUniforms(),
                u = e.getForeignUniforms(),
                l = this._uniforms,
                c = [],
                h = [];
            if (e._cacheUniformId = this._cacheUniformId++, this._programUniformCache[e._cacheUniformId] = {}, u.length)
                for (n = c, t = 0, i = u.length; t < i; t++) {
                    r = u[t];
                    var d = l[r];
                    d && (o = d._globalDefault, a = this._copyUniformEntry(o), n.push(a))
                }
            for (var f in s) o = s[f], a = this._copyUniformEntry(o), h.push(a);
            this._programUniformCache[e._cacheUniformId].foreign = c, this._programUniformCache[e._cacheUniformId].active = h
        },
        _checkCacheAndApplyUniform: function (e, t, i, n, r) {
            var a, o = e.getInternalArray(),
                s = o.length;
            if (s <= 4) {
                var u = t[i];
                a = p[s](o, u)
            } else a = !1;
            if (!a) {
                var l = n[r];
                e.apply(this._graphicContext, l)
            }
        },
        _applyGeneratedProgramUniforms: function (e, t) {
            var i, n, r, a, o = this._uniforms,
                s = e.getForeignUniforms();
            if (!s) {
                if (this._cacheUniformsForGeneratedProgram(e), s = e.getForeignUniforms(), t) {
                    var u = t.uniforms;
                    for (a = 0; a < s.length; a++) n = s[a], o[n] || u[n] && (i = u[n].getUniform(), this._createAttributeStack(o, n, i))
                }
                this._initUniformCache(e)
            }
            var l = e.getUniformsCache(),
                c = e.getActiveUniforms(),
                h = this._programUniformCache[e._cacheUniformId].active,
                d = this._programUniformCache[e._cacheUniformId].foreign,
                f = 0;
            for (var p in c) i = c[p], this._checkCacheAndApplyUniform(i, h, f, l, p), f++;
            f = 0;
            var m = s.length;
            for (a = 0; a < m; a++) {
                n = s[a], r = o[n];
                var g = t && t.uniforms[n];
                if (g || r) {
                    if (g) {
                        var v = t.uniforms[n],
                            _ = v.getValue(),
                            b = v.getUniform();
                        i = this._evaluateOverrideObjectOnStack(r, b, _)
                    } else r._length ? i = r._back.object : (i = r._globalDefault, this._checkErrorUniform(n));
                    this._checkCacheAndApplyUniform(i, d, f, l, n), f++
                } else this._checkErrorUniform(n)
            }
        },
        _setStateSetsDrawID: function (e) {
            for (var t = this._stateSets.getArray(), i = 0, n = this._stateSets.length; i < n; i++) t[i].setDrawID(e)
        },
        _stateSetStackChanged: function (e, t) {
            var i = this._stateSets.getArray(),
                n = this._stateSets.length;
            if (t !== n) return !0;
            for (var r = 0; r < n; r++)
                if (e !== i[r].getDrawID()) return !0;
            return !1
        }
    }), "osg", "State"), t.a = m
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(84),
        a = function () {
            r.a.call(this), this.visitorType = r.a.UPDATE_VISITOR, this._numUpdateCallback = 0
        };
    n.a.createPrototypeObject(a, n.a.objectInherit(r.a.prototype, {
        resetStats: function () {
            this._numUpdateCallback = 0
        },
        apply: function (e) {
            var t = e.getStateSet();
            if (t && t.requiresUpdateTraversal()) {
                var i = t.getUpdateCallbackList(),
                    n = i.length;
                if (n) {
                    this._numUpdateCallback += n;
                    for (var r = 0, a = n; r < a; r++) i[r].update(t, this)
                }
            }
            for (var o = e.getUpdateCallbackList(), s = o.length, u = 0; u < s; u++)
                if (this._numUpdateCallback++, !o[u].update(e, this)) return;
            e.getNumChildrenRequiringUpdateTraversal() > 0 && this.traverse(e)
        }
    }), "osg", "NodeVisitor"), t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(36),
        r = i(319),
        a = function (e) {
            this._enabled = !1, this.reset(e)
        };
    a.FRAME_COUNT = 0, a.instance = function (e, t) {
        return a._instance ? e && (a._instance.getContext() !== e || t) && (a._instance.setContext(e), a._instance.reset(e)) : a._instance = new a(e), a._instance
    }, a.prototype = {
        reset: function (e) {
            if (e) {
                var t = r.a.instance(e).getDisjointTimerQuery();
                if (!t) return this;
                if (e.getQueryParameter || (e.getQueryParameter = t.getQueryObjectEXT.bind(t)), this._hasTimeElapsed = e.getQuery(t.TIME_ELAPSED_EXT, t.QUERY_COUNTER_BITS_EXT) >= 30, this._hasTimeStamp = e.getQuery(t.TIMESTAMP_EXT, t.QUERY_COUNTER_BITS_EXT) >= 30, !this._hasTimeElapsed && !this._hasTimeStamp) return this;
                this._hasTimeStamp || n.a.debug("Warning: do not use interleaved GPU query"), this._ext = t, this._gl = e, this._enabled = !0
            }
            this._frameAverageCount = 10, this._glQueries = [], this._queriesByID = {}, this._userQueries = [], this._queryCount = 0, this._nbOpened = 0
        },
        getContext: function () {
            return this._gl
        },
        setContext: function (e) {
            this._gl = e
        },
        setFrameAverageCount: function (e) {
            this._frameAverageCount = e
        },
        clearQueries: function () {
            for (var e = this._glQueries, t = 0, i = e.length; t < i; ++t) {
                var n = e[t];
                this._gl.deleteQuery(n._pollingStartQuery), n._pollingEndQuery && this._gl.deleteQuery(n)
            }
            this._userQueries.length = 0, this._glQueries.length = 0, this._queriesByID = {}
        },
        supportTimeStamp: function () {
            return this._hasTimeStamp
        },
        enable: function () {
            this._enabled = !!this._ext
        },
        disable: function () {
            this._enabled = !1
        },
        isEnabled: function () {
            return this._enabled
        },
        setCallback: function (e) {
            this._callback = e
        },
        createUserQuery: function (e) {
            var t;
            return t = this._hasTimeStamp ? this.createGLQuery() : {
                _startIndex: 0,
                _endIndex: 0
            }, t._id = e, t._frame = a.FRAME_COUNT, t._isOpened = !0, t._siblings = [], t
        },
        createGLQuery: function () {
            var e = {};
            return e._isWaiting = !1, e._pollingStartQuery = void 0, e._pollingEndQuery = void 0, e._averageTimer = 0, e._resultCount = 0, this._hasTimeStamp && (e._pollingEndQuery = this._gl.createQuery()), e._pollingStartQuery = this._gl.createQuery(), this._glQueries.push(e), e
        },
        getOrCreateLastGLQuery: function () {
            var e = this._glQueries[this._queryCount - 1];
            return e || (e = this._glQueries[this._queryCount - 1] = this.createGLQuery())
        },
        beginCurrentQuery: function () {
            if (0 !== this._nbOpened) {
                this._queryCount++;
                var e = this.getOrCreateLastGLQuery();
                e._isWaiting || this._gl.beginQuery(this._ext.TIME_ELAPSED_EXT, e._pollingStartQuery)
            }
        },
        endCurrentQuery: function () {
            0 !== this._nbOpened && (this.getOrCreateLastGLQuery()._isWaiting || this._gl.endQuery(this._ext.TIME_ELAPSED_EXT))
        },
        getAvailableQueryByID: function (e) {
            var t = this._queriesByID[e];
            if (!t) return t = this._queriesByID[e] = this.createUserQuery(e), this._userQueries.push(t), t;
            if (t._frame === a.FRAME_COUNT) {
                if (t._isOpened) return t;
                for (var i = t._siblings, n = 0, r = i.length; n < r; ++n) {
                    var o = i[n];
                    if (o._frame !== a.FRAME_COUNT || o._isOpened) return o._frame = a.FRAME_COUNT, o
                }
                var s = this.createUserQuery();
                return i.push(s), s
            }
            return t._frame = a.FRAME_COUNT, t
        },
        start: function (e) {
            if (this._enabled) {
                var t = this.getAvailableQueryByID(e);
                t._isOpened = !0, this._hasTimeStamp ? t._isWaiting || this._ext.queryCounterEXT(t._pollingStartQuery, this._ext.TIMESTAMP_EXT) : (this.endCurrentQuery(), this._nbOpened++, t._startIndex = this._queryCount, this.beginCurrentQuery())
            }
        },
        end: function (e) {
            if (this._enabled) {
                var t = this.getAvailableQueryByID(e);
                t._isOpened = !1, this._hasTimeStamp ? t._isWaiting || this._ext.queryCounterEXT(t._pollingEndQuery, this._ext.TIMESTAMP_EXT) : (this.endCurrentQuery(), t._endIndex = this._queryCount, this._nbOpened--, this.beginCurrentQuery())
            }
        },
        computeQueryAverageTime: function (e) {
            for (var t = 0, i = this._glQueries, n = e._startIndex; n < e._endIndex; ++n) {
                var r = i[n]._averageTimer;
                if (r < 0) return -1;
                t += r
            }
            return t
        },
        computeFullAverageTime: function (e) {
            var t = this.computeQueryAverageTime(e);
            if (t < 0) return -1;
            for (var i = e._siblings, n = 0, r = i.length; n < r; ++n) {
                var o = i[n];
                if (o._frame === a.FRAME_COUNT - 1) {
                    var s = this.computeQueryAverageTime(o);
                    if (s < 0) return -1;
                    t += s
                }
            }
            return t
        },
        pollQueries: function () {
            if (a.FRAME_COUNT++, this._queryCount = 0, this._nbOpened = 0, this._enabled && this._callback) {
                var e, t = this._glQueries,
                    i = t.length;
                if (this._gl.getParameter(this._ext.GPU_DISJOINT_EXT))
                    for (e = 0; e < i; ++e) t[e]._isWaiting = !1;
                else {
                    for (e = 0; e < i; ++e) this.pollQuery(t[e]);
                    var n = this._userQueries,
                        r = n.length;
                    for (e = 0; e < r; ++e) {
                        var o = n[e],
                            s = this.computeFullAverageTime(o);
                        s > 0 && this._callback(s, o._id)
                    }
                }
            }
        },
        pollQuery: function (e) {
            e._isWaiting = !1;
            var t = this._hasTimeStamp ? e._pollingEndQuery : e._pollingStartQuery;
            if (!this._gl.getQueryParameter(t, this._gl.QUERY_RESULT_AVAILABLE)) return e._isWaiting = !0, 0;
            var i;
            if (this._hasTimeStamp) {
                var n = this._gl.getQueryParameter(e._pollingStartQuery, this._gl.QUERY_RESULT);
                i = this._gl.getQueryParameter(t, this._gl.QUERY_RESULT) - n
            } else i = this._gl.getQueryParameter(t, this._gl.QUERY_RESULT);
            return e._resultCount++, e._resultCount > this._frameAverageCount && (e._averageTimer = 0, e._resultCount = 1), e._averageTimer = e._averageTimer + (i - e._averageTimer) / e._resultCount, e._averageTimer
        }
    }, t.a = a
}, function (e, t, i) {
    "use strict";
    t.a = {
        Vec3: 0,
        Quat: 1,
        Float: 2,
        FloatCubicBezier: 3,
        Vec3CubicBezier: 4,
        QuatSlerp: 5,
        Matrix: 6,
        Count: 7
    }
}, function (e, t, i) {
    "use strict";
    var n = i(36),
        r = i(12),
        a = i(102),
        o = i(10),
        s = i(453),
        u = i(620),
        l = i(866),
        c = i(867),
        h = i(408),
        d = i(621),
        f = i(618),
        p = i(576),
        m = {
            lerp: function (e, t, i) {
                return e + (t - e) * i
            },
            init: function () {
                return 0
            },
            copy: function (e, t) {
                return t
            },
            create: function () {
                return 0
            }
        },
        g = [];
    g[s.a.ChannelType.Float] = 1, g[s.a.ChannelType.FloatCubicBezier] = 1, g[s.a.ChannelType.Vec3] = 3, g[s.a.ChannelType.Vec3CubicBezier] = 3, g[s.a.ChannelType.Quat] = 4, g[s.a.ChannelType.QuatSlerp] = 4, g[s.a.ChannelType.Matrix] = 16;
    var v = [];
    v.length = s.a.ChannelType.Count, v[s.a.ChannelType.Vec3] = o.f, v[s.a.ChannelType.Quat] = o.d, v[s.a.ChannelType.QuatSlerp] = o.d, v[s.a.ChannelType.Float] = m, v[s.a.ChannelType.FloatCubicBezier] = m, v[s.a.ChannelType.Vec3CubicBezier] = o.f, v[s.a.ChannelType.Matrix] = o.c;
    var _ = function () {
        a.a.call(this), this._simulationTime = 0, this._pauseTime = 0, this._timeFactor = 1, this._startTime = 0, this._instanceAnimations = {}, this._startAnimations = {}, this._targets = [], this._targetsMap = {}, this._targetsByTypes = [], this._targetsByTypes.length = s.a.ChannelType.Count;
        for (var e = 0, t = this._targetsByTypes.length; e < t; e++) this._targetsByTypes[e] = [];
        this._activeAnimations = {}, this._activeAnimationList = [], this._activeChannelsByTypes = [], this._activeChannelsByTypes.length = s.a.ChannelType.Count;
        for (var i = 0, n = this._activeChannelsByTypes.length; i < n; i++) this._activeChannelsByTypes[i] = [];
        this._animationsUpdateCallback = {}, this._animationsUpdateCallbackArray = [], this._animationsToRegister = [], this._pause = !1, this._dirty = !1, this._seekTime = -1
    };
    r.a.createPrototypeObject(_, r.a.objectInherit(a.a.prototype, {
        init: function (e) {
            this._simulationTime = 0, this._pauseTime = 0, this._timeFactor = 1, this._startTime = 0, this._instanceAnimations = {}, this._startAnimations = {}, this._resetTargets(), this._activeAnimations = {}, this._activeAnimationList.length = 0;
            for (var t = 0, i = this._activeChannelsByTypes.length; t < i; t++) this._activeChannelsByTypes[t].length = 0;
            this._animationsUpdateCallback = {}, this._animationsUpdateCallbackArray.length = 0, this._pause = !1, this._seekTime = -1, this.addAnimations(e)
        },
        addAnimations: function (e) {
            var t = this._addAnimation(e);
            Array.prototype.push.apply(this._animationsToRegister, t), this._dirty = !0, this._registerAnimations()
        },
        update: function (e, t) {
            this._dirty && (this._findAnimationUpdateCallback(e), this._registerTargetFoundInAnimationCallback(), this._registerAnimations());
            var i = t.getFrameStamp().getSimulationTime();
            return -1 !== this._seekTime && (this._pauseTime = -this._seekTime + this._startTime + i), this._seekTime = -1, this._pause ? this._pauseTime = i - this._simulationTime + this._startTime : this._simulationTime = this._startTime + (i - this._pauseTime), this.updateManager(this._simulationTime * this._timeFactor), !0
        },
        updateManager: function (e) {
            this._processStartAnimation(e);
            for (var t = s.a.ChannelType.Count, i = 0; i < t; i++) {
                var n = this._activeChannelsByTypes[i];
                this._updateChannelsType(e, n, l.a[i])
            }
            for (var r = 0; r < t; r++) {
                var a = this._targetsByTypes[r];
                this._updateTargetType(a, v[r])
            }
            for (var o = 0, u = this._animationsUpdateCallbackArray.length; o < u; o++) {
                this._animationsUpdateCallbackArray[o].computeChannels()
            }
            this._removeFinishedAnimation(e)
        },
        togglePause: function () {
            this._pause = !this._pause, this._pause || (this._seekTime = this._simulationTime)
        },
        getSimulationTime: function () {
            return this._simulationTime
        },
        setSimulationTime: function (e) {
            this._simulationTime = e
        },
        setSeekTime: function (e) {
            this._simulationTime = e, this._seekTime = e
        },
        stopAnimation: function (e) {
            for (var t = this._activeAnimationList, i = 0, n = t.length; i < n; ++i)
                if (t[i].name === e) return this._removeActiveChannels(this._instanceAnimations[e]), this._activeAnimations[e] = void 0, void t.splice(i, 1)
        },
        stopAllAnimation: function () {
            for (var e = this._activeAnimationList, t = 0, i = e.length; t < i; ++t) {
                var n = e[t].name;
                this._removeActiveChannels(this._instanceAnimations[n]), this._activeAnimations[n] = void 0
            }
            e.length = 0
        },
        setTimeFactor: function (e) {
            var t = e / this._timeFactor;
            this._startTime += (this._simulationTime - this._simulationTime * t) / t, this._timeFactor = e, this._pause && (this._simulationTime += (this._simulationTime - this._simulationTime * t) / t)
        },
        getTimeFactor: function () {
            return this._timeFactor
        },
        isPlaying: function (e) {
            return !!this._activeAnimations[e]
        },
        playAnimationObject: function (e) {
            var t = this._instanceAnimations[e.name];
            if (!t) return void n.a.info("no animation " + e.name + " found");
            this.isPlaying(e.name) || (t.priority = void 0 === e.priority ? 0 : e.priority, t.weight = void 0 === e.weight ? 1 : e.weight, t.loop = void 0 === e.loop || e.loop, this._startAnimations[t.name] = t)
        },
        playAnimation: function (e, t, i, n) {
            var r;
            return r = "object" == typeof e ? e : {
                name: e,
                priority: i,
                weight: n,
                loop: t
            }, this.playAnimationObject(r)
        },
        getAnimations: function () {
            return this._instanceAnimations
        },
        _registerAnimations: function () {
            if (this._targets.length) {
                for (var e = 0, t = this._animationsToRegister.length; e < t; e++) {
                    var i = this._animationsToRegister[e];
                    this._registerInstanceAnimation(i)
                }
                this._animationsToRegister.length = 0, this._dirty = !1
            }
        },
        _registerInstanceAnimation: function (e) {
            for (var t = e.channels, i = 0, r = t.length; i < r; i++) {
                var a = t[i],
                    o = a.channel.target,
                    s = a.channel.name,
                    u = o + "." + s;
                this._targetMap[u] ? a.targetID = this._targetMap[u].id : n.a.warn("registerInstanceAnimation did not find targetName (" + u + ") in the scene graph")
            }
            return !0
        },
        _findAnimationUpdateCallback: function (e) {
            var t = new c.a;
            e.accept(t), this._animationsUpdateCallback = t.getAnimationUpdateCallbackMap()
        },
        _registerTargetFoundInAnimationCallback: function () {
            this._resetTargets();
            var e, t, i, r = 0,
                a = this._targetMap,
                o = this._targets,
                s = function (e, t) {
                    if (a[e]) t !== a[e] && n.a.warn("detected differents target instance with the same name (" + e + ")");
                    else {
                        a[e] = t, t.id = r++, o.push(t);
                        var i = t.type;
                        this._targetsByTypes[i].push(t)
                    }
                }.bind(this);
            for (var u in this._animationsUpdateCallback) {
                var l = this._animationsUpdateCallback[u];
                if (l instanceof p.a || l instanceof f.a) {
                    var c = l.getStackedTransforms(),
                        h = c.length;
                    if (!h) continue;
                    this._animationsUpdateCallbackArray.push(l);
                    for (var m = 0; m < h; m++) {
                        var g = c[m];
                        e = g.getTarget(), t = g.getName(), i = l.getName() + "." + t, s(i, e, t)
                    }
                } else if (l instanceof d.a) {
                    var v = l.getNumTarget();
                    if (!v) continue;
                    this._animationsUpdateCallbackArray.push(l);
                    for (var _ = 0; _ < v; _++) t = l.getTargetName(_), i = t + "." + _, e = l.getTarget(_), s(i, e, t)
                }
            }
        },
        _addAnimation: function (e) {
            for (var t = [], i = 0, n = e.length; i < n; i++) {
                var r = e[i],
                    a = r.name;
                if (!this._instanceAnimations[a]) {
                    var o = u.a.createInstanceAnimation(r);
                    this._instanceAnimations[a] = o, t.push(o)
                }
            }
            return t
        },
        _addActiveChannels: function (e, t) {
            for (var i = t.channels, n = 0, r = i.length; n < r; n++) {
                var a = i[n],
                    o = a.channel.type;
                a.t = e, a.instanceAnimation = t;
                var s = a.targetID;
                s !== h.a.InvalidTargetID && (this._activeChannelsByTypes[o].push(a), this._targets[s].channels.push(a))
            }
        },
        _removeActiveChannels: function (e) {
            for (var t = e.channels, i = 0, n = t.length; i < n; i++) {
                var r = t[i],
                    a = r.channel.type,
                    o = r.targetID;
                if (o !== h.a.InvalidTargetID) {
                    var s = this._targets[o].channels,
                        u = s.indexOf(r);
                    s.splice(u, 1);
                    var l = this._activeChannelsByTypes[a],
                        c = l.indexOf(r);
                    l.splice(c, 1)
                }
            }
        },
        _updateTargetType: function (e, t) {
            for (var i = 0, n = e.length; i < n; i++) {
                var r = e[i],
                    a = r.channels,
                    o = a.length;
                if (0 === o) r.value = t.copy(r.value, r.defaultValue);
                else if (1 === o) r.value = t.copy(r.value, a[0].value);
                else {
                    r.value = t.init(r.value);
                    for (var s = 0, u = 0, l = a.length; u < l; u++) {
                        var c = a[u],
                            h = c.weight;
                        if (0 !== (s += h) && 0 !== h) {
                            var d = h / s;
                            r.value = t.lerp(r.value, r.value, c.value, d)
                        }
                    }
                }
            }
        },
        _updateChannelsType: function (e, t, i) {
            for (var n = 0, r = t.length; n < r; n++) {
                var a = t[n],
                    o = a.instanceAnimation,
                    s = o.loop,
                    u = e - a.t;
                s && o.duration > 0 && (u %= o.duration), i(u + o.firstKeyTime, a)
            }
        },
        _removeFinishedAnimation: function (e) {
            for (var t = this._activeAnimationList, i = 0; i < t.length;) {
                var n = t[i],
                    r = n.name;
                e > n.end && !1 === n.loop ? (this._removeActiveChannels(n), this._activeAnimations[r] = void 0, t.splice(i, 1)) : i++
            }
        },
        _addActiveAnimation: function (e, t) {
            this._activeAnimations[t.name] = t;
            var i = this._instanceAnimations[t.name];
            i.start = e, i.end = e + i.duration, this._addActiveChannels(e, i), this._activeAnimationList.push(i)
        },
        _processStartAnimation: function (e) {
            if (this._targets.length) {
                var t;
                for (t in this._startAnimations) {
                    var i = this._startAnimations[t],
                        n = i.name;
                    this.isPlaying(n) || this._addActiveAnimation(e, i)
                }
                void 0 !== t && (this._startAnimations = {})
            }
        },
        _resetTargets: function () {
            this._targetMap = {}, this._targets.length = 0;
            for (var e = 0, t = this._targetsByTypes.length; e < t; e++) this._targetsByTypes[e].length = 0
        },
        resetUpdateCallbacks: function () {
            for (var e = this._animationsUpdateCallbackArray, t = 0, i = e.length; t < i; t++) e[t].reset()
        },
        resetAllStackedTransforms: function () {
            n.a.warn("Uses resetUpdateCallback instead"), this.resetUpdateCallbacks()
        },
        setAnimationLerpEndStart: function (e, t) {
            var i = e.channels;
            void 0 === e.originalDuration && (e.originalDuration = e.duration), e.duration = e.originalDuration + t;
            for (var n = e.firstKeyTime, r = e.originalDuration, a = 0, o = i.length; a < o; ++a) {
                var s = i[a].channel;
                if (!(Math.abs(s.start - n) > .01 || Math.abs(s.duration - r) > .01)) {
                    void 0 === s.originalEnd && (s.originalEnd = s.end), s.end = s.originalEnd + t;
                    var u = g[s.type],
                        l = s.times.buffer.byteLength / 4;
                    if (0 === t) s.keys = new Float32Array(s.keys.buffer, 0, (l - 1) * u), s.times = new Float32Array(s.times.buffer, 0, l - 1);
                    else {
                        s.keys = new Float32Array(s.keys.buffer, 0, l * u);
                        for (var c = (l - 1) * u, h = 0; h < u; ++h) s.keys[c + h] = s.keys[h];
                        s.times = new Float32Array(s.times.buffer, 0, l), s.times[l - 1] = s.times[l - 2] + t
                    }
                }
            }
        }
    }), "osgAnimation", "BasicAnimationManager"), _.TypeToSize = g, t.a = _
}, function (e, t, i) {
    "use strict";
    var n = i(10),
        r = i(453),
        a = function (e, t, i) {
            i[0] = t[e++], i[1] = t[e++], i[2] = t[e++]
        },
        o = function (e, t, i) {
            i[0] = t[e++], i[1] = t[e++], i[2] = t[e++], i[3] = t[e++]
        },
        s = function (e, t) {
            var i = t.channel,
                n = t.value,
                r = i.keys,
                o = i.times;
            if (e >= o[o.length - 1]) return t.key = 0, void a(r.length - 3, r, n);
            if (e <= o[0]) return t.key = 0, void a(0, r, n);
            var s = t.key;
            if (e > o[s])
                for (; o[s + 1] < e;) s++;
            else if (e < o[s])
                for (; o[s] > e;) s--;
            var u = o[s],
                l = o[s + 1],
                c = 3 * s,
                h = r[c++],
                d = r[c++],
                f = r[c++],
                p = r[c++],
                m = r[c++],
                g = r[c++],
                v = (e - u) / (l - u);
            n[0] = h + (p - h) * v, n[1] = d + (m - d) * v, n[2] = f + (g - f) * v, t.key = s
        },
        u = function () {
            var e = n.d.create32(),
                t = n.d.create32();
            return function (i, r) {
                var a = r.channel,
                    s = r.value,
                    u = a.keys,
                    l = a.times;
                if (i >= l[l.length - 1]) return r.key = 0, void o(u.length - 4, u, s);
                if (i <= l[0]) return r.key = 0, void o(0, u, s);
                var c = r.key;
                if (i > l[c])
                    for (; l[c + 1] < i;) c++;
                else if (i < l[c])
                    for (; l[c] > i;) c--;
                var h = l[c],
                    d = l[c + 1],
                    f = 4 * c;
                e[0] = u[f++], e[1] = u[f++], e[2] = u[f++], e[3] = u[f++], t[0] = u[f++], t[1] = u[f++], t[2] = u[f++], t[3] = u[f++];
                var p = (i - h) / (d - h);
                n.d.nlerp(s, e, t, p), r.key = c
            }
        }(),
        l = function () {
            var e = n.d.create32(),
                t = n.d.create32();
            return function (i, r) {
                var a = r.channel,
                    s = r.value,
                    u = a.keys,
                    l = a.times;
                if (i >= l[l.length - 1]) return r.key = 0, void o(u.length - 4, u, s);
                if (i <= l[0]) return r.key = 0, void o(0, u, s);
                var c = r.key;
                if (i > l[c])
                    for (; l[c + 1] < i;) c++;
                else if (i < l[c])
                    for (; l[c] > i;) c--;
                var h = l[c],
                    d = l[c + 1],
                    f = 4 * c;
                e[0] = u[f++], e[1] = u[f++], e[2] = u[f++], e[3] = u[f++], t[0] = u[f++], t[1] = u[f++], t[2] = u[f++], t[3] = u[f++];
                var p = (i - h) / (d - h);
                n.d.slerp(s, e, t, p), r.key = c
            }
        }(),
        c = function (e, t) {
            var i = t.channel,
                n = t.value,
                r = i.keys,
                a = i.times;
            if (e >= a[a.length - 1]) return t.key = 0, void(t.value = r[r.length - 1]);
            if (e <= a[0]) return t.key = 0, void(t.value = r[0]);
            var o = t.key;
            if (e > a[o])
                for (; a[o + 1] < e;) o++;
            else if (e < a[o])
                for (; a[o] > e;) o--;
            var s = a[o],
                u = a[o + 1],
                l = o,
                c = r[l++];
            n = c + (r[l++] - c) * ((e - s) / (u - s)), t.key = o, t.value = n
        },
        h = function (e, t) {
            var i = t.channel,
                n = t.value,
                r = i.keys,
                a = i.times;
            if (e >= a[a.length - 1]) return t.key = 0, void(t.value = r[r.length - 3]);
            if (e <= a[0]) return t.key = 0, void(t.value = r[0]);
            var o = t.key;
            if (e > a[o])
                for (; a[o + 1] < e;) o++;
            else if (e < a[o])
                for (; a[o] > e;) o--;
            var s = (e - a[o]) / (a[o + 1] - a[o]),
                u = 1 - s,
                l = u * u,
                c = l * u,
                h = s * s,
                d = 3 * o;
            n = r[d] * c + r[d + 1] * (3 * s * l) + r[d + 2] * (3 * h * u) + r[d + 3] * (h * s), t.key = o, t.value = n
        },
        d = function () {
            var e = n.f.create(),
                t = n.f.create(),
                i = n.f.create(),
                r = n.f.create();
            return function (o, s) {
                var u = s.channel,
                    l = s.value,
                    c = u.keys,
                    h = u.times;
                if (o >= h[h.length - 1]) return s.key = 0, void a(c.length - 9, c, l);
                if (o <= h[0]) return s.key = 0, void a(0, c, l);
                var d = s.key;
                if (o > h[d])
                    for (; h[d + 1] < o;) d++;
                else if (o < h[d])
                    for (; h[d] > o;) d--;
                var f = (o - h[d]) / (h[d + 1] - h[d]),
                    p = 1 - f,
                    m = p * p,
                    g = m * p,
                    v = f * f,
                    _ = 9 * d;
                n.f.scale(e, n.f.set(e, c[_++], c[_++], c[_++]), g), n.f.scale(t, n.f.set(t, c[_++], c[_++], c[_++]), 3 * f * m), n.f.scale(i, n.f.set(i, c[_++], c[_++], c[_++]), 3 * v * p), n.f.scale(r, n.f.set(r, c[_++], c[_++], c[_++]), v * f), l[0] = e[0] + t[0] + i[0] + r[0], l[1] = e[1] + t[1] + i[1] + r[1], l[2] = e[2] + t[2] + i[2] + r[2], s.key = d
            }
        }(),
        f = r.a.ChannelType,
        p = {};
    p[f.Vec3] = s, p[f.Quat] = u, p[f.QuatSlerp] = l, p[f.Float] = c, p[f.FloatCubicBezier] = h, p[f.Vec3CubicBezier] = d, p.Vec3LerpInterpolator = s, p.QuatLerpInterpolator = u, p.QuatSlerpInterpolator = l, p.FloatLerpInterpolator = c, p.FloatCubicBezierInterpolator = h, p.Vec3CubicBezierInterpolator = d, t.a = p
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(84),
        a = i(577),
        o = function () {
            r.a.call(this), this._animationUpdateCallback = {}
        };
    n.a.createPrototypeObject(o, n.a.objectInherit(r.a.prototype, {
        getAnimationUpdateCallbackMap: function () {
            return this._animationUpdateCallback
        },
        apply: function (e) {
            for (var t = e.getUpdateCallbackList(), i = 0, n = t.length; i < n; i++) {
                var r = t[i];
                r instanceof a.a && (this._animationUpdateCallback[r.getInstanceID()] = r)
            }
            this.traverse(e)
        }
    }), "osgAnimation", "CollectAnimationUpdateCallbackVisitor"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(102),
        a = i(10),
        o = i(408),
        s = function (e, t) {
            r.a.call(this), this._target = o.a.createMatrixTarget(t || a.c.IDENTITY), e && this.setName(e)
        };
    n.a.createPrototypeObject(s, n.a.objectInherit(r.a.prototype, {
        init: function (e) {
            this.setMatrix(e), a.c.copy(this._target.defaultValue, e)
        },
        getTarget: function () {
            return this._target
        },
        getMatrix: function () {
            return this._target.value
        },
        setMatrix: function (e) {
            a.c.copy(this._target.value, e)
        },
        resetToDefaultValue: function () {
            this.setMatrix(this._target.defaultValue)
        },
        applyToMatrix: function (e) {
            a.c.mul(e, e, this._target.value)
        }
    }), "osgAnimation", "StackedMatrix"), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(102),
        a = i(10),
        o = i(408),
        s = a.d.create(),
        u = function (e, t) {
            r.a.call(this), this._target = o.a.createQuatTarget(t || s), e && this.setName(e)
        };
    n.a.createPrototypeObject(u, n.a.objectInherit(r.a.prototype, {
        init: function (e) {
            this.setQuaternion(e), a.d.copy(this._target.defaultValue, e)
        },
        setQuaternion: function (e) {
            a.d.copy(this._target.value, e)
        },
        getTarget: function () {
            return this._target
        },
        resetToDefaultValue: function () {
            this.setQuaternion(this._target.defaultValue)
        },
        applyToMatrix: function () {
            var e = a.c.create();
            return function (t) {
                var i = e;
                a.c.fromQuat(i, this._target.value), a.c.mul(t, t, i)
            }
        }()
    }), "osgAnimation", "StackedQuaternion"), t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(102),
        a = i(10),
        o = i(408),
        s = function (e, t) {
            r.a.call(this), this._target = o.a.createVec3Target(t || a.f.ZERO), e && this.setName(e)
        };
    n.a.createPrototypeObject(s, n.a.objectInherit(r.a.prototype, {
        init: function (e) {
            this.setTranslate(e), a.f.copy(this._target.defaultValue, e)
        },
        setTranslate: function (e) {
            a.f.copy(this._target.value, e)
        },
        getTarget: function () {
            return this._target
        },
        resetToDefaultValue: function () {
            this.setTranslate(this._target.defaultValue)
        },
        applyToMatrix: function (e) {
            a.c.translate(e, e, this._target.value)
        }
    }), "osgAnimation", "StackedTranslate"), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(5),
        r = i.n(n),
        a = function (e, t) {
            return new r.a(function (i, n) {
                var r = new XMLHttpRequest;
                r.open("GET", e, !0);
                var a = t && t.responseType ? t.responseType.toLowerCase() : void 0;
                a && (r.responseType = a), t && t.progress && r.addEventListener("progress", t.progress, !1), r.addEventListener("error", n, !1), r.addEventListener("load", function () {
                    i("arraybuffer" === r.responseType || "blob" === r.responseType ? r.response : r.responseText)
                }), r.send(null)
            })
        },
        o = function (e, t) {
            return new r.a(function (i) {
                var n = t && t.responseType ? t.responseType.toLowerCase() : void 0,
                    r = new window.FileReader;
                r.onload = function (e) {
                    i(e.target.result)
                }, n ? "arraybuffer" === n ? r.readAsArrayBuffer(e) : "blob" === n ? i(e) : "string" === n ? r.readAsText(e) : r.readAsDataURL(e) : r.readAsText(e)
            })
        },
        s = function (e, t) {
            return "string" == typeof e ? a(e, t) : o(e, t)
        };
    t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(5),
        r = i.n(n),
        a = i(12),
        o = i(84),
        s = i(685),
        u = i(315),
        l = function () {
            o.a.call(this, o.a.TRAVERSE_ALL_CHILDREN), this._activePagedLODList = void 0, this._frameNumber = 0
        };
    a.a.createPrototypeObject(l, a.a.objectInherit(o.a.prototype, {
        apply: function (e) {
            e.getTypeID() === s.a.getTypeID() && (e.setFrameNumberOfLastTraversal(this._frameNumber), this._activePagedLODList.add(e)), this.traverse(e)
        },
        set: function (e, t) {
            this._activePagedLODList = e, this._frameNumber = t
        }
    }), "osgDB", "FindPagedLODsVisitor");
    var c = function () {
        o.a.call(this, o.a.TRAVERSE_ALL_CHILDREN)
    };
    a.a.createPrototypeObject(c, a.a.objectInherit(o.a.prototype, {
        apply: function (e) {
            e.releaseGLObjects(), this.traverse(e)
        }
    }), "osgDB", "ReleaseVisitor");
    var h = function () {
        o.a.call(this, o.a.TRAVERSE_ALL_CHILDREN), this._childrenList = []
    };
    a.a.createPrototypeObject(h, a.a.objectInherit(o.a.prototype, {
        apply: function (e) {
            e.getTypeID() === s.a.getTypeID() && (this._childrenList.push(e), this._markRequestsExpired(e)), this.traverse(e)
        },
        removeExpiredChildrenAndFindPagedLODs: function (e, t, i, n) {
            if (!e.children.length) return !1;
            var r = n.length;
            e.removeExpiredChildren(t, i, n);
            for (var a = r; a < n.length; a++) n[a].accept(this);
            return r !== n.length
        },
        _markRequestsExpired: function (e) {
            for (var t, i = e._perRangeDataList.length, n = 0; n < i; n++) void 0 !== (t = e.getDatabaseRequest(n)) && (t._groupExpired = !0, t._loadedModel = null)
        },
        reset: function () {
            this._childrenList.length = 0
        }
    }), "osgDB", "ExpiredPagedLODVisitor");
    var d = function (e, t) {
            return t._timeStamp - e._timeStamp
        },
        f = function (e, t) {
            var i = e._timeStamp - t._timeStamp;
            return 0 === i && (i = e._priority - t._priority), i
        },
        p = function () {
            this._pendingRequests = [], this._pendingNodes = [], this._loading = !1, this._progressCallback = void 0, this._lastCB = !0, this._activePagedLODList = new Set, this._childrenToRemoveList = new Set, this._downloadingRequestsNumber = 0, this._maxRequestsPerFrame = 10, this._acceptNewRequests = !0, this._releaseVisitor = new c, this._expiredPagedLODVisitor = new h, this._findPagedLODsVisitor = new l, this._targetMaximumNumberOfPagedLOD = 75, this._elapsedTime = 0, this._beginTime = 0, this._availableTime = 0
        },
        m = function () {
            this._loadedModel = void 0, this._group = void 0, this._url = void 0, this._function = void 0, this._timeStamp = 0, this._groupExpired = !1, this._priority = 0
        };
    a.a.createPrototypeObject(p, {
        setTargetMaximumNumberOfPageLOD: function (e) {
            this._targetMaximumNumberOfPagedLOD = e
        },
        getTargetMaximumNumberOfPageLOD: function () {
            return this._targetMaximumNumberOfPagedLOD
        },
        setAcceptNewDatabaseRequests: function (e) {
            this._acceptNewRequests = e
        },
        getAcceptNewDatabaseRequests: function () {
            return this._acceptNewRequests
        },
        reset: function () {
            this._pendingRequests = [], this._pendingNodes = [], this._loading = !1, this._lastCB = !0, this._activePagedLODList.clear(), this._childrenToRemoveList.clear(), this._downloadingRequestsNumber = 0, this._maxRequestsPerFrame = 10, this._acceptNewRequests = !0, this._targetMaximumNumberOfPagedLOD = 75
        },
        updateSceneGraph: function (e) {
            void 0 !== this._progressCallback && this.executeProgressCallback(), this.removeExpiredSubgraphs(e, .0025), this.takeRequests(), this.addLoadedDataToSceneGraph(e, .005)
        },
        executeProgressCallback: function () {
            this._pendingRequests.length > 0 || this._pendingNodes.length > 0 ? (this._progressCallback(this._pendingRequests.length + this._downloadingRequestsNumber, this._pendingNodes.length), this._lastCB = !1) : this._lastCB || (this._progressCallback(this._pendingRequests.length + this._downloadingRequestsNumber, this._pendingNodes.length), this._lastCB = !0)
        },
        setMaxRequestsPerFrame: function (e) {
            this._maxRequestsPerFrame = e
        },
        getMaxRequestsPerFrame: function () {
            return this._maxRequestsPerFrame
        },
        getRequestListSize: function () {
            return this._pendingRequests.length + this._downloadingRequestsNumber
        },
        setProgressCallback: function (e) {
            this._progressCallback = e
        },
        addLoadedDataToSceneGraph: function (e, t) {
            if (!this._pendingNodes.length || t <= 0) return 0;
            var i = 0,
                n = u.a.instance().tick();
            this._pendingNodes.sort(d);
            for (var r = 0; r < this._pendingNodes.length; r++) {
                if (i > t) return 0;
                var a = this._pendingNodes.shift(),
                    o = e.getFrameNumber(),
                    s = e.getSimulationTime();
                if (!1 === a._groupExpired) {
                    var l = a._group;
                    l.setTimeStamp(l.children.length, s), l.setFrameNumber(l.children.length, o), l.addChildNode(a._loadedModel), this._activePagedLODList.has(l) ? this.registerPagedLODs(a._loadedModel, o) : this.registerPagedLODs(l, o)
                } else a._loadedModel = void 0, a = void 0;
                i = u.a.instance().deltaS(n, u.a.instance().tick())
            }
            return t -= i
        },
        isLoading: function () {
            return this._loading
        },
        registerPagedLODs: function (e, t) {
            e && (this._findPagedLODsVisitor.set(this._activePagedLODList, t), e.accept(this._findPagedLODsVisitor))
        },
        requestNodeFile: function (e, t, i, n, r) {
            if (this._acceptNewRequests) {
                var a = new m;
                return a._group = i, a._function = e, a._url = t, a._timeStamp = n, a._priority = r, this._pendingRequests.push(a), a
            }
        },
        takeRequests: function () {
            if (this._pendingRequests.length) {
                var e = Math.min(this._maxRequestsPerFrame, this._pendingRequests.length);
                this._pendingRequests.sort(f);
                for (var t = 0; t < e; t++) this._downloadingRequestsNumber++, this.processRequest(this._pendingRequests.shift())
            }
        },
        processRequest: function (e) {
            this._loading = !0;
            var t = this;
            if (e._groupExpired) return t._downloadingRequestsNumber--, void(this._loading = !1);
            void 0 !== e._function ? this.loadNodeFromFunction(e._function, e._group).then(function (i) {
                t._downloadingRequestsNumber--, e._loadedModel = i, t._pendingNodes.push(e), t._loading = !1
            }) : "" !== e._url && this.loadNodeFromURL(e._url).then(function (i) {
                t._downloadingRequestsNumber--, e._loadedModel = i, t._pendingNodes.push(e), t._loading = !1
            })
        },
        loadNodeFromFunction: function (e, t) {
            var i = e(t);
            return i ? i && i.then ? i : r.a.resolve(i) : r.a.reject()
        },
        loadNodeFromURL: function (e) {
            return i(422).default.readNodeURL(e)
        },
        releaseGLExpiredSubgraphs: function (e) {
            return this._availableTime = e, !this._childrenToRemoveList.size || e <= 0 ? 0 : (this._elapsedTime = 0, this._beginTime = u.a.instance().tick(), this._childrenToRemoveList.forEach(this._releaseExpiredSubgraphs, this), this._availableTime -= this._elapsedTime, this._availableTime)
        },
        _releaseExpiredSubgraphs: function (e) {
            this._elapsedTime > this._availableTime || (this._childrenToRemoveList.delete(e), e.accept(this._releaseVisitor), e.removeChildren(), e = null, this._elapsedTime = u.a.instance().deltaS(this._beginTime, u.a.instance().tick()))
        },
        removeExpiredSubgraphs: function (e, t) {
            if (0 === e.getFrameNumber()) return 0;
            var i = this._activePagedLODList.size - this._targetMaximumNumberOfPagedLOD,
                n = e.getSimulationTime() - .1,
                r = e.getFrameNumber() - 1;
            return i > 0 && (t = this.removeExpiredChildren(i, n, r, t)), t
        },
        removeExpiredChildren: function (e, t, i, n) {
            var r = 0,
                a = u.a.instance().tick(),
                o = this,
                s = [],
                l = this._expiredPagedLODVisitor;
            return l.reset(), this._activePagedLODList.forEach(function (c) {
                if (r > n) return 0;
                if (e < 0) return n;
                if (i < c.getFrameNumberOfLastTraversal()) return n;
                l.removeExpiredChildrenAndFindPagedLODs(c, t, i, s);
                for (var h = 0; h < l._childrenList.length; h++) o._activePagedLODList.delete(l._childrenList[h]), e--;
                for (h = 0; h < s.length; h++) o._childrenToRemoveList.add(s[h]);
                l._childrenList.length = 0, s.length = 0, r = u.a.instance().deltaS(a, u.a.instance().tick())
            }), n -= r
        }
    }, "osgDB", "DatabasePager"), t.a = p
}, function (e, t, i) {
    "use strict";
    var n = i(5),
        r = i.n(n),
        a = i(12),
        o = i(36),
        s = i(623),
        u = i(453),
        l = i(620),
        c = i(422),
        h = i(868),
        d = i(689),
        f = i(364),
        p = i(160),
        m = a.a.rejectObject,
        g = {},
        v = function () {},
        _ = c.default.registry();
    _.registerObject("osgAnimation.Vec3LerpChannel", v), _.registerObject("osgAnimation.FloatLerpChannel", v), _.registerObject("osgAnimation.QuatSlerpChannel", v), _.registerObject("osgAnimation.QuatLerpChannel", v), _.registerObject("osgAnimation.FloatCubicBezierChannel", v), _.registerObject("osgAnimation.Vec3CubicBezierChannel", v), _.registerObject("osgAnimation.StackedMatrixElement", h.a), _.registerObject("osgAnimation.StackedScaleElement", d.a), g.Animation = function (e) {
        var t = e.getJSON();
        if (void 0 === t.Name || !t.Channels || 0 === t.Channels.length) return m("Animation", t);
        for (var i = [], n = 0, a = t.Channels.length; n < a; n++) {
            var o = e.setJSON(t.Channels[n]).readObject();
            i.push(o)
        }
        return r.a.all(i).then(function (e) {
            return l.a.createAnimation(e, t.Name)
        })
    }, g.StandardVec3Channel = function (e, t, i) {
        var n = e.getJSON();
        if (!(void 0 !== n.TargetName && n.KeyFrames && n.Name && n.KeyFrames.Time && n.KeyFrames.Key && 3 === n.KeyFrames.Key.length)) return m("StandardVec3Channel", n);
        var a = e.setJSON(n.KeyFrames.Time).readBufferArray(),
            o = e.setJSON(n.KeyFrames.Key[0]).readBufferArray(),
            s = e.setJSON(n.KeyFrames.Key[1]).readBufferArray(),
            u = e.setJSON(n.KeyFrames.Key[2]).readBufferArray();
        return r.a.all([a, o, s, u]).then(function (e) {
            for (var r = e[0].getElements(), a = e[1].getElements(), o = e[2].getElements(), s = e[3].getElements(), u = r.length, l = new Float32Array(new ArrayBuffer(4 * (u + 1) * 3), 0, 3 * u), c = new Float32Array(new ArrayBuffer(4 * (u + 1)), 0, u), h = 0; h < u; h++) {
                var d = 3 * h;
                c[h] = r[h], l[d++] = a[h], l[d++] = o[h], l[d] = s[h]
            }
            return i(l, c, n.TargetName, n.Name, t), t
        })
    }, g.StandardQuatChannel = function (e, t, i) {
        var n = e.getJSON();
        if (!(void 0 !== n.TargetName && n.KeyFrames && n.Name && n.KeyFrames.Time && n.KeyFrames.Key && 4 === n.KeyFrames.Key.length)) return m("StandardQuatChannel", n);
        var a = e.setJSON(n.KeyFrames.Time).readBufferArray(),
            o = e.setJSON(n.KeyFrames.Key[0]).readBufferArray(),
            s = e.setJSON(n.KeyFrames.Key[1]).readBufferArray(),
            u = e.setJSON(n.KeyFrames.Key[2]).readBufferArray(),
            l = e.setJSON(n.KeyFrames.Key[3]).readBufferArray();
        return r.a.all([a, o, s, u, l]).then(function (e) {
            for (var r = e[0].getElements(), a = e[1].getElements(), o = e[2].getElements(), s = e[3].getElements(), u = e[4].getElements(), l = r.length, c = new Float32Array(new ArrayBuffer(4 * (l + 1) * 4), 0, 4 * l), h = new Float32Array(new ArrayBuffer(4 * (l + 1)), 0, l), d = 0; d < l; d++) {
                var f = 4 * d;
                h[d] = r[d], c[f++] = a[d], c[f++] = o[d], c[f++] = s[d], c[f] = u[d]
            }
            return i(c, h, n.TargetName, n.Name, t), t
        })
    }, g.StandardFloatChannel = function (e, t, i) {
        var n = e.getJSON();
        if (!(void 0 !== n.TargetName && n.KeyFrames && n.Name && n.KeyFrames.Time && n.KeyFrames.Key)) return m("StandardFloatChannel", n);
        var a = e.setJSON(n.KeyFrames.Time).readBufferArray(),
            o = e.setJSON(n.KeyFrames.Key).readBufferArray();
        return r.a.all([a, o]).then(function (e) {
            for (var r = e[0].getElements(), a = e[1].getElements(), o = r.length, s = new Float32Array(new ArrayBuffer(4 * (o + 1)), 0, o), u = new Float32Array(new ArrayBuffer(4 * (o + 1)), 0, o), l = 0; l < o; l++) u[l] = r[l], s[l] = a[l];
            return i(s, u, n.TargetName, n.Name, t), t
        })
    }, g.Vec3LerpChannel = function (e, t) {
        return g.StandardVec3Channel(e, t, u.a.createVec3Channel)
    }, g.QuatLerpChannel = function (e, t) {
        return g.StandardQuatChannel(e, t, u.a.createQuatChannel)
    }, g.QuatSlerpChannel = function (e, t) {
        return g.StandardQuatChannel(e, t, u.a.createQuatChannel)
    }, g.FloatLerpChannel = function (e, t) {
        return g.StandardFloatChannel(e, t, u.a.createFloatChannel)
    }, g.FloatCubicBezierChannel = function (e, t) {
        var i = e.getJSON();
        if (!(void 0 !== i.TargetName && i.KeyFrames && i.Name && i.KeyFrames.Time && i.KeyFrames.Position && i.KeyFrames.ControlPointOut && i.KeyFrames.ControlPointIn)) return m("FloatCubicBezierChannel", i);
        var n, a = [],
            o = window.Object.keys(i.KeyFrames);
        for (n = 0; n < o.length; n++) a.push(e.setJSON(i.KeyFrames[o[n]]).readBufferArray());
        return r.a.all(a).then(function (e) {
            var r = e[0].getElements(),
                a = e[1].getElements(),
                o = e[2].getElements(),
                s = e[3].getElements(),
                l = s.length,
                c = new Float32Array(new ArrayBuffer(4 * (l + 1) * 3), 0, 3 * l),
                h = new Float32Array(new ArrayBuffer(4 * (l + 1)), 0, l);
            for (n = 0; n < l; n++) {
                var d = 3 * n;
                h[n] = s[n], c[d++] = o[n], c[d++] = r[n], c[d] = a[n]
            }
            return u.a.createFloatCubicBezierChannel(c, h, i.TargetName, i.Name, t), t
        })
    }, g.Vec3CubicBezierChannel = function (e, t) {
        var i = e.getJSON();
        if (!(void 0 !== i.TargetName && i.KeyFrames && i.Name && i.KeyFrames.Time && i.KeyFrames.Position && i.KeyFrames.ControlPointOut && i.KeyFrames.ControlPointIn && 3 === i.KeyFrames.Position.length && 3 === i.KeyFrames.ControlPointIn.length && 3 === i.KeyFrames.ControlPointOut.length)) return m("Vec3CubicBezierChannel", i);
        var n, a = [],
            o = window.Object.keys(i.KeyFrames);
        for (n = 0; n < o.length; n++) {
            var s = o[n],
                l = i.KeyFrames[s];
            "Time" !== s ? (a.push(e.setJSON(l[0]).readBufferArray()), a.push(e.setJSON(l[1]).readBufferArray()), a.push(e.setJSON(l[2]).readBufferArray())) : a.push(e.setJSON(l).readBufferArray())
        }
        return r.a.all(a).then(function (e) {
            var r = e[0].getElements(),
                a = e[1].getElements(),
                o = e[2].getElements(),
                s = e[3].getElements(),
                l = e[4].getElements(),
                c = e[5].getElements(),
                h = e[6].getElements(),
                d = e[7].getElements(),
                f = e[8].getElements(),
                p = e[9].getElements(),
                m = p.length,
                g = new Float32Array(new ArrayBuffer(4 * (m + 1) * 9), 0, 9 * m),
                v = new Float32Array(new ArrayBuffer(4 * (m + 1)), 0, m);
            for (n = 0; n < m; n++) {
                var _ = 9 * n;
                v[n] = p[n], g[_++] = h[n], g[_++] = d[n], g[_++] = f[n], g[_++] = r[n], g[_++] = a[n], g[_++] = o[n], g[_++] = s[n], g[_++] = l[n], g[_] = c[n]
            }
            return u.a.createVec3CubicBezierChannel(g, v, i.TargetName, i.Name, t), t
        })
    }, g.BasicAnimationManager = function (e, t) {
        var i = e.getJSON();
        if (!i.Animations) return m("BasicAnimationManager", i);
        s.a.Object(e, t);
        for (var n = [], a = 0, u = i.Animations.length; a < u; a++) {
            var l = e.setJSON(i.Animations[a]).readObject();
            l.isRejected() ? o.a.warn("An Animation failed on the parsing!") : n.push(l)
        }
        return r.a.all(n).then(function (e) {
            return t.init(e), t
        })
    }, g.UpdateMatrixTransform = function (e, t) {
        var i = e.getJSON();
        if ( /*!jsonObj.Name ||*/ !i.StackedTransforms) return m("UpdateMatrixTransform", i);
        s.a.Object(e, t);
        var n, a, u = [];
        for (n = 0, a = i.StackedTransforms.length; n < a; n++) {
            var l = e.setJSON(i.StackedTransforms[n]).readObject();
            l.isRejected() ? o.a.warn("A stacked transforms failed on the parsing!") : u.push(l)
        }
        return r.a.all(u).then(function (e) {
            var i = t.getStackedTransforms();
            for (n = 0, a = e.length; n < a; n++) i.push(e[n]);
            return t.computeChannels(), t
        })
    }, g.StackedTranslate = function (e, t) {
        var i = e.getJSON();
        return i.Name && i.Translate ? (s.a.Object(e, t), t.init(i.Translate), r.a.resolve(t)) : m("StackedTranslate", i)
    }, g.StackedQuaternion = function (e, t) {
        var i = e.getJSON();
        return i.Name && i.Quaternion ? (s.a.Object(e, t), t.init(i.Quaternion), r.a.resolve(t)) : m("StackedQuaternion", i)
    }, g.StackedRotateAxis = function (e, t) {
        var i = e.getJSON();
        return i.Axis && void 0 !== i.Angle ? (s.a.Object(e, t), t.init(i.Axis, i.Angle), r.a.resolve(t)) : m("StackedRotateAxis", i)
    }, g.StackedMatrix = function (e, t) {
        var i = e.getJSON();
        return i.Name && i.Matrix ? (s.a.Object(e, t), t.init(i.Matrix), r.a.resolve(t)) : m("StackedMatrix", i)
    }, g.StackedScale = function (e, t) {
        var i = e.getJSON();
        return i.Name && i.Scale ? (s.a.Object(e, t), t.init(i.Scale), r.a.resolve(t)) : m("StackedScale", i)
    }, g.Bone = function (e, t) {
        var i = e.getJSON();
        if (!i.InvBindMatrixInSkeletonSpace) return m("Bone", i);
        var n = s.a.MatrixTransform(e, t);
        if (t.setInvBindMatrixInSkeletonSpace(i.InvBindMatrixInSkeletonSpace), i.BoundingBox) {
            var r = t.getBoneBoundingBox();
            r.setMax(i.BoundingBox.max), r.setMin(i.BoundingBox.min)
        }
        return n
    }, g.UpdateBone = g.UpdateMatrixTransform, g.UpdateSkeleton = function (e, t) {
        return s.a.Object(e, t), r.a.resolve(t)
    }, g.Skeleton = s.a.MatrixTransform, g.RigGeometry = function (e, t) {
        var i = e.getJSON();
        if (!i.SourceGeometry) return m("RigGeometry", i);
        i.BoneMap || o.a.warn("No boneMap found in a RigGeometry !");
        var n = s.a.Geometry(e, t);
        t._boneNameID = i.BoneMap;
        var a, u = i.SourceGeometry["osg.Geometry"];
        return u ? (e.setJSON(u), t.setSourceGeometry(new p.a), a = s.a.Geometry(e, t.getSourceGeometry())) : (u = i.SourceGeometry["osgAnimation.MorphGeometry"], u ? (e.setJSON(u), t.setSourceGeometry(new f.a), a = g.MorphGeometry(e, t.getSourceGeometry())) : o.a.warn("SourceGeometry type no recognized")), void 0 === t._uniqueID && (t._uniqueID = u.UniqueID), r.a.all([n, a]).then(function () {
            return t.mergeChildrenData(), t
        })
    }, g.MorphGeometry = function (e, t) {
        var i = e.getJSON();
        if (!i.MorphTargets) return m("MorphGeometry", i);
        var n = i.MorphTargets,
            a = [];
        a.push(s.a.Geometry(e, t));
        for (var o = 0, u = n.length; o < u; o++) a.push(e.setJSON(n[o]).readObject());
        return r.a.all(a).then(function (e) {
            for (var t = e[0], i = t.getMorphTargets(), n = 1, r = e.length; n < r; n++) i.push(e[n]);
            return t.mergeChildrenVertexAttributeList(), t
        })
    }, g.UpdateMorph = function (e, t) {
        var i = e.getJSON();
        if (!i.TargetMap) return m("UpdateMorph", i);
        s.a.Object(e, t);
        for (var n = window.Object.keys(i.TargetMap), a = 0, o = n.length; a < o; a++) {
            var u = n[a];
            t.addTarget(i.TargetMap[u], parseInt(u, 10))
        }
        return r.a.resolve(t)
    }, g.StackedMatrixElement = g.StackedMatrix, g.StackedScaleElement = g.StackedScale, t.a = g
}, function (e, t, i) {
    "use strict";
    var n = i(5),
        r = i.n(n),
        a = i(623),
        o = i(36),
        s = i(875),
        u = {};
    u.Text = function (e, t) {
        var i = e.getJSON();
        if (!i.Text) return r.a.reject();
        var n = a.a.Node(e, t);
        if (t.setColor(i.Color), t.setText(i.Text), t.setAutoRotateToScreen(i.AutoRotateToScreen), t.setPosition(i.Position), t.setCharacterSize(i.CharacterSize), "VERTICAL" === i.Layout) return o.a.error("Vertical Alignment not supported"), r.a.reject();
        var u = i.Alignment;
        return i.Alignment.indexOf("BASE_LINE") > -1 && ("LEFT_BASE_LINE" === i.Alignment ? u = s.a.LEFT_CENTER : "CENTER_BASE_LINE" === i.Alignment ? u = s.a.CENTER_CENTER : "RIGHT_BASE_LINE" === i.Alignment ? u = s.a.RIGHT_CENTER : "LEFT_BOTTOM_BASE_LINE" === i.Alignment ? u = s.a.LEFT_BOTTOM : "CENTER_BOTTOM_BASE_LINE" === i.Alignment ? u = s.a.CENTER_BOTTOM : "RIGHT_BOTTOM_BASE_LINE" === i.Alignment && (u = s.a.RIGHT_BOTTOM)), t.setAlignment(u), t.setLayout(i.Layout), n
    }, t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(574),
        r = i(12),
        a = i(10),
        o = i(679),
        s = i(198),
        u = i(407),
        l = i(118),
        c = i(362),
        h = i(84),
        d = i(137),
        f = function (e) {
            o.a.call(this), this._canvas = document.createElement("canvas"), this._context = this._canvas.getContext("2d"), this._matrixTransform = new s.a, this.addChild(this._matrixTransform), this._text = "", void 0 !== e && (this._text = e), this._font = "monospace", this._color = a.g.fromValues(0, 0, 0, 1), this._fillStyle = "rgba( 0, 0, 0, 1 )", this._context.textAlign = "center", this._textX = void 0, this._context.baseLine = "middle", this._textY = void 0, this._characterSize = 1, this._characterSizeMode = f.OBJECT_COORDS, this._fontSize = 32, this._geometry = void 0, this._autoRotateToScreen = !1, this._position = a.f.create(), this._layout = f.LEFT_TO_RIGHT, this._alignment = f.CENTER_CENTER, this._forcePowerOfTwo = !1, this._texture = new l.default, this.drawText(), this._dirty = !1, this._previousModelView = a.c.create()
        };
    f.OBJECT_COORDS = 0, f.SCREEN_COORDS = 1, f.OBJECT_COORDS_WITH_MAXIMUM_SCREEN_SIZE_CAPPED_BY_FONT_HEIGHT = 2, f.LEFT_TO_RIGHT = "ltr", f.RIGHT_TO_LEFT = "rtl", f.LEFT_TOP = 0, f.LEFT_CENTER = 1, f.LEFT_BOTTOM = 2, f.CENTER_TOP = 3, f.CENTER_CENTER = 4, f.CENTER_BOTTOM = 5, f.RIGHT_TOP = 6, f.RIGHT_CENTER = 7, f.RIGHT_BOTTOM = 8, r.a.createPrototypeNode(f, r.a.objectInherit(o.a.prototype, {
        drawText: function () {
            if (void 0 !== this._geometry && (this._matrixTransform.removeChild(this._geometry), this._geometry.releaseGLObjects()), this._text) {
                this.setTextProperties(), this._canvas.width = this._context.measureText(this._text).width, this._canvas.height = 2 * this._fontSize, this._forcePowerOfTwo && (this._canvas.width = this._nextPowerOfTwo(this._canvas.width), this._canvas.height = this._nextPowerOfTwo(this._canvas.height)), this.setTextProperties(), this._context.clearRect(0, 0, this._canvas.width, this._canvas.height), this._context.fillText(this._text, this._textX, this._textY);
                var e = this._canvas.width / this._canvas.height,
                    t = this._characterSize * e;
                this._geometry = u.a.createTexturedQuadGeometry(-t / 2, -this._characterSize / 2, 0, t, 0, 0, 0, this._characterSize, 0), this._texture.setTextureSize(this._canvas.width, this._canvas.height), this._texture.setMinFilter("LINEAR"), this._texture.setMagFilter("LINEAR"), this._texture.setImage(this._canvas);
                var i = this._geometry.getOrCreateStateSet();
                i.setTextureAttributeAndModes(0, this._texture), i.setRenderingHint("TRANSPARENT_BIN"), i.setAttributeAndModes(new c.a(c.a.ONE, c.a.ONE_MINUS_SRC_ALPHA)), this._matrixTransform.addChild(this._geometry), this.dirtyBound()
            }
        },
        setText: function (e) {
            this._text = e, this._dirty = !0
        },
        getText: function () {
            return this._text
        },
        setFont: function (e) {
            this._font = e, this._dirty = !0
        },
        setColor: function (e) {
            this._color = e, this._fillStyle = "rgba(" + Math.round(255 * e[0]) + "," + Math.round(255 * e[1]) + "," + Math.round(255 * e[2]) + "," + e[3] + ")", this._context.fillStyle = this._fillStyle, this._context.fillText(this._text, this._textX, this._textY)
        },
        getColor: function () {
            return this._color
        },
        setCharacterSize: function (e) {
            this._characterSize = e, this._characterSizeMode !== f.OBJECT_COORDS && (a.c.fromScaling(this._matrixTransform.getMatrix(), [this._characterSize, this._characterSize, this._characterSize]), this._characterSizeMode === f.OBJECT_COORDS_WITH_MAXIMUM_SCREEN_SIZE_CAPPED_BY_FONT_HEIGHT && this.setMaximumScale(this._characterSize)), this._dirty = !0
        },
        getCharacterSize: function () {
            return this._characterSize
        },
        setCharacterSizeMode: function (e) {
            this._characterSizeMode = e, this._characterSizeMode !== f.OBJECT_COORDS ? (a.c.fromScaling(this._matrixTransform.getMatrix(), [this._characterSize, this._characterSize, this._characterSize]), this.setAutoScaleToScreen(!0), this.setMaximumScale(Number.MAX_VALUE), this._characterSizeMode === f.OBJECT_COORDS_WITH_MAXIMUM_SCREEN_SIZE_CAPPED_BY_FONT_HEIGHT && this.setMaximumScale(this._characterSize)) : (this._matrixTransform.setMatrix(a.c.create()), this.setAutoScaleToScreen(!1)), this._dirty = !0
        },
        getCharacterSizeMode: function () {
            return this._characterSizeMode
        },
        setFontResolution: function (e) {
            this._fontSize = e, this._dirty = !0
        },
        getFontResolution: function () {
            return this._fontSize
        },
        setPosition: function (e) {
            this._position = e, a.c.fromTranslation(this.getMatrix(), e)
        },
        getPosition: function () {
            return this._position
        },
        setTextProperties: function () {
            this._context.fillStyle = this._fillStyle, this._setAlignmentValues(this._alignment), this._context.font = this._fontSize + "px " + this._font, this._context.direction = this._layout
        },
        setAutoRotateToScreen: function (e) {
            o.a.prototype.setAutoRotateToScreen.call(this, e), this._dirty = !0
        },
        getAutoRotateToScreen: function () {
            return this._autoRotateToScreen
        },
        setLayout: function (e) {
            this._layout = "string" == typeof e ? f[e] : e, this._dirty = !0
        },
        getLayout: function () {
            return this._layout
        },
        setAlignment: function (e) {
            this._alignment = "string" == typeof e ? f[e] : e, this._dirty = !0
        },
        getAlignment: function () {
            return this._alignment
        },
        accept: function () {
            return function (e) {
                if (this._dirty && (this.drawText(), this._dirty = !1), e.getVisitorType() === h.a.CULL_VISITOR) {
                    var t = e.getViewport().width(),
                        i = e.getViewport().height(),
                        n = e.getCurrentProjectionMatrix(),
                        r = e.getCurrentModelViewMatrix(),
                        o = this._position,
                        s = this._firstTimeToInitEyePoint;
                    if (this._firstTimeToInitEyePoint || (a.c.exactEquals(r, this._previousModelView) ? t !== this._previousWidth || i !== this._previousHeight ? s = !0 : a.c.exactEquals(n, this._previousProjection) ? a.f.exactEquals(o, this._previousPosition) || (s = !0) : s = !0 : s = !0), this._firstTimeToInitEyePoint = !1, s) {
                        if (this._autoScaleToScreen) {
                            var u = e.getViewport(),
                                l = this.computePixelSizeVector(u, n, r),
                                c = a.g.fromValues(this._position[0], this._position[1], this._position[2], 1),
                                f = a.g.dot(c, l);
                            f = .48 / f;
                            var p = 1 / f;
                            if (this._autoScaleTransitionWidthRatio > 0) {
                                var m, g, v;
                                if (this._minimumScale > 0) {
                                    var _ = this._minimumScale,
                                        b = this._maximumScale < Number.MAX_VALUE ? this._minimumScale + (this._maximumScale - this._minimumScale) * this._autoScaleTransitionWidthRatio : this._minimumScale * (1 + this._autoScaleTransitionWidthRatio);
                                    m = 1 / (4 * (b - _)), g = 1 - 2 * m * b, v = _ + g * g / (4 * m);
                                    p < -g / (2 * m) ? p = this._minimumScale : p < b && (p = v + g * p + m * (p * p))
                                }
                                if (this._maximumScale < Number.MAX_VALUE) {
                                    var S = this._maximumScale,
                                        x = this._minimumScale > 0 ? this._maximumScale + (this._minimumScale - this._maximumScale) * this._autoScaleTransitionWidthRatio : this._maximumScale * (1 - this._autoScaleTransitionWidthRatio);
                                    m = 1 / (4 * (x - S)), g = 1 - 2 * m * x, v = S + g * g / (4 * m);
                                    p > -g / (2 * m) ? p = this._maximumScale : p > x && (p = v + g * p + m * (p * p))
                                }
                            }
                            this.setScale(p)
                        }
                        if (this._autoRotateToScreen) {
                            var y = a.d.create(),
                                C = e.getCurrentModelViewMatrix();
                            a.c.getRotation(y, C), this.setRotation(a.d.invert(y, y))
                        }
                        this._previousWidth = t, this._previousHeight = i, a.f.copy(this._previousPosition, o), a.c.copy(this._previousProjection, n), a.c.copy(this._previousModelView, r)
                    }
                }
                d.a.prototype.accept.call(this, e)
            }
        }(),
        _setAlignmentValues: function (e) {
            switch (e) {
                case f.LEFT_TOP:
                    this._context.textAlign = "left", this._textX = 0, this._context.textBaseline = "top", this._textY = 0;
                    break;
                case f.LEFT_CENTER:
                    this._context.textAlign = "left", this._textX = 0, this._context.textBaseline = "middle", this._textY = this._canvas.height / 2;
                    break;
                case f.LEFT_BOTTOM:
                    this._context.textAlign = "left", this._textX = 0, this._context.textBaseline = "bottom", this._textY = this._canvas.height;
                    break;
                case f.CENTER_TOP:
                    this._context.textAlign = "center", this._textX = this._canvas.width / 2, this._context.textBaseline = "top", this._textY = 0;
                    break;
                case f.CENTER_CENTER:
                    this._context.textAlign = "center", this._textX = this._canvas.width / 2, this._context.textBaseline = "middle", this._textY = this._canvas.height / 2;
                    break;
                case f.CENTER_BOTTOM:
                    this._context.textAlign = "center", this._textX = this._canvas.width / 2, this._context.textBaseline = "bottom", this._textY = this._canvas.height;
                    break;
                case f.RIGHT_TOP:
                    this._context.textAlign = "right", this._textX = this._canvas.width, this._context.textBaseline = "top", this._textY = 0;
                    break;
                case f.RIGHT_CENTER:
                    this._context.textAlign = "right", this._textX = this._canvas.width, this._context.textBaseline = "middle", this._textY = this._canvas.height / 2;
                    break;
                case f.RIGHT_BOTTOM:
                    this._context.textAlign = "right", this._textX = this._canvas.width, this._context.textBaseline = "bottom", this._textY = this._canvas.height
            }
        },
        setForcePowerOfTwo: function (e) {
            this._forcePowerOfTwo = e
        },
        getForcePowerOfTwo: function () {
            return this._forcePowerOfTwo
        },
        _nextPowerOfTwo: function (e) {
            var t = e;
            return t--, t |= t >> 1, t |= t >> 2, t |= t >> 4, t |= t >> 8, t |= t >> 16, ++t
        }
    }), "osgText", "Text"), n.a.registerApplyFunction(f.nodeTypeID, n.a.getApplyFunction(o.a.nodeTypeID)), t.a = f
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(10),
        a = i(627),
        o = function () {
            a.a.Intersection.call(this), this._localIntersectionNormal = r.f.clone(r.f.ONE), this._i1 = -1, this._i2 = -1, this._i3 = -1, this._r1 = 0, this._r2 = 0, this._r3 = 0
        },
        s = function () {
            a.a.call(this), this._threshold = 0, this._d = r.f.create(), this._length = 0, this._invLength = 0, this._start = r.f.create(), this._end = r.f.create(), this._dInvX = r.f.create(), this._dInvY = r.f.create(), this._dInvZ = r.f.create(), this._hit = !1
        };
    n.a.createPrototypeObject(s, n.a.objectInherit(a.a.prototype, {
        set: function (e, t, i) {
            this._start = e, this._end = t, r.f.sub(this._d, t, e), this._length = r.f.length(this._d), this._invLength = 0 !== this._length ? 1 / this._length : 0, r.f.scale(this._d, this._d, this._invLength), 0 !== this._d[0] && r.f.scale(this._dInvX, this._d, 1 / this._d[0]), 0 !== this._d[1] && r.f.scale(this._dInvY, this._d, 1 / this._d[1]), 0 !== this._d[2] && r.f.scale(this._dInvZ, this._d, 1 / this._d[2]), void 0 !== i && (this._threshold = i)
        },
        enter: function (e, t, i) {
            var n = e._min,
                a = n[0],
                o = n[1],
                s = n[2],
                u = e._max,
                l = u[0],
                c = u[1],
                h = u[2],
                d = this._dInvX,
                f = this._dInvY,
                p = this._dInvZ;
            if (t[0] <= i[0]) {
                if (i[0] < a) return !1;
                if (t[0] > l) return !1;
                t[0] < a && r.f.scaleAndAdd(t, t, d, a - t[0]), i[0] > l && r.f.scaleAndAdd(i, t, d, l - t[0])
            } else {
                if (t[0] < a) return !1;
                if (i[0] > l) return !1;
                i[0] < a && r.f.scaleAndAdd(i, t, d, a - t[0]), t[0] > l && r.f.scaleAndAdd(t, t, d, l - t[0])
            }
            if (t[1] <= i[1]) {
                if (i[1] < o) return !1;
                if (t[1] > c) return !1;
                t[1] < o && r.f.scaleAndAdd(t, t, f, o - t[1]), i[1] > c && r.f.scaleAndAdd(i, t, f, c - t[1])
            } else {
                if (t[1] < o) return !1;
                if (i[1] > c) return !1;
                i[1] < o && r.f.scaleAndAdd(i, t, f, o - t[1]), t[1] > c && r.f.scaleAndAdd(t, t, f, c - t[1])
            }
            if (t[2] <= i[2]) {
                if (i[2] < s) return !1;
                if (t[2] > h) return !1;
                t[2] < s && r.f.scaleAndAdd(t, t, p, s - t[2]), i[2] > h && r.f.scaleAndAdd(i, t, p, h - t[2])
            } else {
                if (t[2] < s) return !1;
                if (i[2] > h) return !1;
                i[2] < s && r.f.scaleAndAdd(i, t, p, s - t[2]), t[2] > h && r.f.scaleAndAdd(t, t, p, h - t[2])
            }
            return !0
        },
        intersectPoint: function () {
            var e = r.f.create(),
                t = r.f.create();
            return function (i, n) {
                var a = this._start;
                r.f.sub(e, i, a), r.f.sub(t, this._end, a);
                var s = r.f.dot(e, t) * this._invLength * this._invLength;
                if (!((s < 0 ? r.f.sqrLen(e) : s > 1 ? r.f.sqrDist(i, this._end) : r.f.sqrLen(r.f.scaleAndAdd(e, e, t, -s))) > this._threshold * this._threshold)) {
                    var u = this.initIntersection(new o);
                    u._i1 = n, u._r1 = 1, r.f.scaleAndAdd(u._localIntersectionPoint, a, t, s), u._ratio = s
                }
            }
        }(),
        intersectLine: function () {
            var e = r.f.create(),
                t = r.f.create(),
                i = r.f.create(),
                n = r.f.create(),
                a = r.f.create();
            return function (s, u, l, c) {
                r.f.sub(e, u, s), r.f.sub(t, this._end, this._start), r.f.sub(i, s, this._start);
                var h, d, f = r.f.dot(e, e),
                    p = r.f.dot(e, t),
                    m = r.f.dot(t, t),
                    g = r.f.dot(e, i),
                    v = r.f.dot(t, i),
                    _ = f * m - p * p,
                    b = _,
                    S = _;
                _ < 1e-8 ? (h = 0, b = 1, d = v, S = m) : (h = p * v - m * g, d = f * v - p * g, h < 0 ? (h = 0, d = v, S = m) : h > b && (h = b, d = v + p, S = m)), d < 0 ? (d = 0, -g < 0 ? h = 0 : -g > f ? h = b : (h = -g, b = f)) : d > S && (d = S, -g + p < 0 ? h = 0 : -g + p > f ? h = b : (h = -g + p, b = f));
                var x = Math.abs(h) < 1e-8 ? 0 : h / b,
                    y = Math.abs(d) < 1e-8 ? 0 : d / S;
                if (r.f.scaleAndAdd(n, s, e, x), r.f.scaleAndAdd(a, this._start, t, y), !(r.f.sqrDist(n, a) > this._threshold * this._threshold)) {
                    var C = this.initIntersection(new o);
                    C._i1 = l, C._i2 = c, C._r1 = 1 - y, C._r2 = y, r.f.copy(C._localIntersectionPoint, a), C._ratio = y
                }
            }
        }(),
        intersectTriangle: function () {
            var e = r.f.create(),
                t = r.f.create(),
                i = r.f.create(),
                n = r.f.create(),
                a = r.f.create(),
                s = r.f.create();
            return function (u, l, c, h, d, f) {
                var p = this._d;
                r.f.sub(t, c, u), r.f.sub(i, l, u), r.f.cross(a, p, t);
                var m = r.f.dot(a, i);
                if (!(m > -1e-20 && m < 1e-20)) {
                    var g = 1 / m;
                    r.f.sub(n, this._start, u);
                    var v = r.f.dot(a, n) * g;
                    if (!(v < 0 || v > 1)) {
                        r.f.cross(s, n, i);
                        var _ = r.f.dot(s, p) * g;
                        if (!(_ < 0 || v + _ > 1)) {
                            var b = r.f.dot(s, t) * g;
                            if (!(b < 1e-20 || b > this._length)) {
                                var S = 1 - v - _,
                                    x = v,
                                    y = _,
                                    C = b * this._invLength,
                                    T = u[0] * S + l[0] * x + c[0] * y,
                                    w = u[1] * S + l[1] * x + c[1] * y,
                                    M = u[2] * S + l[2] * x + c[2] * y;
                                r.f.cross(e, i, t), r.f.normalize(e, e);
                                var E = this.initIntersection(new o);
                                E._i1 = h, E._i2 = d, E._i3 = f, E._r1 = S, E._r2 = x, E._r3 = y, r.f.set(E._localIntersectionPoint, T, w, M), r.f.copy(E._localIntersectionNormal, e), E._ratio = C, E._backface = r.c.determinant(E._matrix) * m < 0
                            }
                        }
                    }
                }
            }
        }(),
        operatorPoint: function (e) {
            this._threshold <= 0 || a.a.prototype.operatorPoint.call(this, e)
        },
        operatorLine: function (e, t) {
            this._threshold <= 0 || a.a.prototype.operatorLine.call(this, e, t)
        }
    }), "osgUtil", "LineSegmentIntersectFunctor"), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(10),
        a = i(681),
        o = i(450),
        s = i(625),
        u = i(878),
        l = function () {
            s.a.call(this), this._index = 0, this._polytope = new a.a, this._iPolytope = new a.a, this._referencePlane = r.g.create(), this._iReferencePlane = r.g.create()
        },
        c = function (e, t, i) {
            var n = t[0],
                r = t[1],
                a = t[2],
                o = t[3];
            e[0] = i[0] * n + i[1] * r + i[2] * a + i[3] * o, e[1] = i[4] * n + i[5] * r + i[6] * a + i[7] * o, e[2] = i[8] * n + i[9] * r + i[10] * a + i[11] * o, e[3] = i[12] * n + i[13] * r + i[14] * a + i[15] * o
        };
    n.a.createPrototypeObject(l, n.a.objectInherit(s.a.prototype, {
        setPolytope: function (e) {
            this._polytope.setPlanes(e);
            for (var t = [], i = 0; i < e.length; ++i) {
                var n = e[i];
                t[i] = r.g.copy(this._iPolytope.getPlanes()[i] || o.a.create(), n)
            }
            this._iPolytope.setPlanes(t), r.g.copy(this._referencePlane, e[e.length - 1]), r.g.copy(this._iReferencePlane, this._referencePlane)
        },
        getPolytope: function () {
            return this._iPolytope
        },
        setPolytopeFromWindowCoordinates: function (e, t, i, n) {
            this.setPolytope([r.g.fromValues(1, 0, 0, -e), r.g.fromValues(-1, 0, 0, i), r.g.fromValues(0, 1, 0, -t), r.g.fromValues(0, -1, 0, n), r.g.fromValues(0, 0, 1, 0)])
        },
        intersectBoundingBox: function (e) {
            return this._iPolytope.containsBoundingBox(e)
        },
        intersectBoundingSphere: function (e) {
            return this._iPolytope.containsBoundingSphere(e)
        },
        intersect: function () {
            var e = new u.a;
            return function (t, i) {
                e.setGeometry(i), e.setIntersectionVisitor(t), e.setIntersector(this);
                var n = i.getShape();
                n ? n.intersect(e, n.getNodes()[0]) : (i.computeTransformedVertices && e.setVertices(i.computeTransformedVertices()), e.apply(i)), e.reset()
            }
        }(),
        setCurrentTransformation: function (e) {
            for (var t = this._polytope.getPlanes(), i = this._iPolytope.getPlanes(), n = 0, a = t.length; n < a; n++) {
                var o = i[n] = i[n] || r.g.create();
                c(o, t[n], e), r.g.scale(o, o, 1 / r.f.len(o))
            }
            c(this._iReferencePlane, this._referencePlane, e), r.g.scale(this._iReferencePlane, this._iReferencePlane, 1 / r.f.len(this._iReferencePlane))
        }
    }), "osgUtil", "PolytopeIntersector"), t.a = l
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(10),
        a = i(450),
        o = i(627),
        s = function () {
            o.a.Intersection.call(this), this._intersectionPoints = [], this._distance = 0, this._maxDistance = 0, this._numIntersectionPoints = 0
        },
        u = function () {
            o.a.call(this), this._src = [], this._dest = [], this._maxNumIntersectionsPoints = 6
        };
    n.a.createPrototypeObject(u, n.a.objectInherit(o.a.prototype, {
        reset: function () {
            o.a.prototype.reset.call(this), this._src = [], this._dest = []
        },
        enter: function (e) {
            return !!this._intersector.getPolytope().containsBoundingBox(e) && (this._intersector.getPolytope().pushCurrentMask(), !0)
        },
        leave: function () {
            this._intersector.getPolytope().popCurrentMask()
        },
        addIntersection: function () {
            this._src = n.a.arrayUniq(this._src);
            for (var e = this._src, t = r.f.create(), i = -Number.MAX_VALUE, o = this._intersector._iReferencePlane, u = 0; u < e.length; ++u) {
                r.f.add(t, t, e[u]);
                var l = a.a.distanceToPlane(o, e[u]);
                l > i && (i = l)
            }
            r.f.scale(t, t, 1 / e.length);
            var c = this.initIntersection(new s);
            c._distance = a.a.distanceToPlane(o, t), c._maxDistance = i, r.f.copy(c._localIntersectionPoint, t);
            var h = this._maxNumIntersectionsPoints;
            for (c._numIntersectionPoints = e.length < h ? e.length : h, u = 0; u < c._numIntersectionPoints; ++u) c._intersectionPoints.push(r.f.clone(this._src[u]))
        },
        contains: function () {
            var e = this._intersector.getPolytope(),
                t = e.getPlanes(),
                i = e.getCurrentMask();
            if (!i) return !0;
            for (var n = 1, o = 0; o < t.length; ++o)
                if (i & 0 === n) n <<= 1;
                else {
                    this._dest = [];
                    for (var s = t[o], u = this._src[0], l = a.a.distanceToPlane(s, u), c = 1; c < this._src.length; ++c) {
                        var h = this._src[c],
                            d = a.a.distanceToPlane(s, h);
                        if (l >= 0 && this._dest.push(r.f.clone(u)), l * d < 0) {
                            var f = l - d,
                                p = l / f,
                                m = r.f.add(r.f.create(), r.f.scale(r.f.create(), u, 1 - p), r.f.scale(r.f.create(), h, p));
                            this._dest.push(m)
                        }
                        l = d, u = h
                    }
                    if (l >= 0 && this._dest.push(r.f.clone(u)), this._dest.length <= 1) return !1;
                    var g = this._src.slice();
                    this._src = this._dest.slice(), this._dest = g
                } return !0
        },
        containsPoint: function (e) {
            return !!this._intersector.getPolytope().containsVertex(e) && (this._src = [], this._src[0] = e, !0)
        },
        containsLine: function (e, t) {
            return this._src = [], this._src[0] = e, this._src[1] = t, this._src[2] = e, this.contains()
        },
        containsTriangle: function (e, t, i) {
            return this._src = [], this._src[0] = e, this._src[1] = t, this._src[2] = i, this._src[3] = e, this.contains()
        },
        intersectPoint: function (e) {
            this.containsPoint(e) && this.addIntersection()
        },
        intersectLine: function (e, t) {
            this.containsLine(e, t) && this.addIntersection()
        },
        intersectTriangle: function (e, t, i) {
            this.containsTriangle(e, t, i) && this.addIntersection()
        }
    }), "osgUtil", "PolytopeIntersectFunctor"), t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(693),
        r = i(114),
        a = i(12),
        o = function (e) {
            n.a.call(this, e), this._timer = !1
        };
    a.a.createPrototypeObject(o, a.a.objectInherit(n.a.prototype, {
        _initInputs: function () {
            n.a.prototype._initInputs.call(this, r.a.CAD_MANIPULATOR_MOUSEKEYBOARD, r.a.CAD_MANIPULATOR_RESETTOHOME), this._manipulator.getInputManager().group(r.a.CAD_MANIPULATOR_MOUSEKEYBOARD).addMappings({
                savePosition: "mousemove"
            }, this)
        },
        zoom: function (e) {
            var t = -e.deltaY / this._zoomFactor,
                i = this._manipulator,
                n = i.getZoomInterpolator().getTarget()[0] - t;
            if (i.getZoomInterpolator().setTarget(n), !1 === this._timer) {
                this._timer = !0;
                var r = this;
                this._timerRef && clearTimeout(this._timerRef), this._timerRef = setTimeout(function () {
                    r._timer = !1
                }, 200), i.computeIntersections(e.glX, e.glY)
            }
        },
        savePosition: function (e) {
            this._lastX = e.glX, this._lastY = e.glY
        },
        setMode: function (e, t, i) {
            this._inMotion || this._manipulator.computeIntersections(this._lastX, this._lastY), n.a.prototype.setMode.call(this, e, t, i)
        },
        center: function (e) {
            var t = this._manipulator;
            t.getZoomInterpolator().set(0);
            var i = t.getZoomInterpolator().getTarget()[0] - 10;
            t.getZoomInterpolator().setTarget(i), t.computeIntersections(e.glX, e.glY)
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    t.a = {
        ROTATE: 0,
        PAN: 1,
        ZOOM: 2
    }
}, function (e, t, i) {
    "use strict";
    var n = i(628),
        r = i(114),
        a = i(12),
        o = function (e) {
            n.a.call(this, e), this._timer = !1
        };
    a.a.createPrototypeObject(o, a.a.objectInherit(n.a.prototype, {
        _initInputs: function () {
            n.a.prototype._initInputs.call(this, r.a.CAD_MANIPULATOR_TOUCH)
        },
        startMotion: function (e, t, i) {
            n.a.prototype.startMotion.call(this, e, t, i), this._manipulator.computeIntersections(i.glX, i.glY)
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(628),
        r = i(114),
        a = i(12),
        o = function (e) {
            n.a.call(this, e), this._timer = !1
        };
    a.a.createPrototypeObject(o, a.a.objectInherit(n.a.prototype, {
        _initInputs: function () {
            n.a.prototype._initInputs.call(this, r.a.FPS_MANIPULATOR_TOUCH)
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(366),
        r = i(12),
        a = i(10),
        o = i(114),
        s = a.d.create(),
        u = a.f.create(),
        l = function (e) {
            n.a.call(this, e), this.init()
        };
    r.a.createPrototypeObject(l, r.a.objectInherit(n.a.prototype, {
        init: function () {
            this._pos = a.f.create(), this._quat = a.d.create();
            var e = this._manipulator.getInputManager();
            e.group(o.a.FPS_MANIPULATOR_WEBVR).addMappings({
                update: "vrdisplayposechanged"
            }, this), e.setEnable(o.a.FPS_MANIPULATOR_WEBVR, !1)
        },
        update: function (e) {
            var t = e.pose.orientation;
            t && (e.sitToStandMatrix && (t = a.c.getRotation(s, e.sitToStandMatrix), a.d.mul(t, t, e.pose.orientation)), this._quat[0] = t[0], this._quat[1] = -t[2], this._quat[2] = t[1], this._quat[3] = t[3]);
            var i = e.pose.position;
            i && (e.sitToStandMatrix && (i = a.f.transformMat4(u, i, e.sitToStandMatrix)), this._pos[0] = i[0] * e.worldFactor, this._pos[1] = -i[2] * e.worldFactor, this._pos[2] = i[1] * e.worldFactor), this._manipulator.setPoseVR(this._quat, this._pos)
        }
    })), t.a = l
}, function (e, t, i) {
    "use strict";
    var n = i(366),
        r = i(12),
        a = i(114),
        o = function (e) {
            n.a.call(this, e), this.init()
        };
    r.a.createPrototypeObject(o, r.a.objectInherit(n.a.prototype, {
        init: function () {
            this._delay = .15, this._stepFactor = 1, this._looking = !1;
            var e = this._manipulator.getInputManager();
            e.group(a.a.FPS_MANIPULATOR_MOUSEKEYBOARD).addMappings({
                startLookAt: "mousedown",
                lookAt: "mousemove",
                stopLookAt: ["mouseup", "mouseout"],
                goForward: ["keydown w", "keydown z", "keydown ArrowUp"],
                goBackward: ["keydown s", "keydown ArrowDown"],
                goLeft: ["keydown a", "keydown q", "keydown ArrowLeft"],
                goRight: ["keydown d", "keydown ArrowRight"],
                stopMoving: ["keyup w", "keyup z", "keyup ArrowUp", "keyup s", "keyup ArrowDown"],
                stopStrafing: ["keyup a", "keyup q", "keyup ArrowLeft", "keyup d", "keyup ArrowRight"],
                changeStepFactor: "wheel"
            }, this), e.group(a.a.FPS_MANIPULATOR_RESETTOHOME).addMappings({
                reset: "keydown space"
            }, this)
        },
        setEnable: function (e) {
            e || (this._buttonup = !0), n.a.prototype.setEnable.call(this, e)
        },
        setManipulator: function (e) {
            this._manipulator = e, this._manipulator.setStepFactor(this._stepFactor)
        },
        stopLookAt: function () {
            this._looking = !1
        },
        startLookAt: function (e) {
            this._manipulator.getLookPositionInterpolator().set(e.canvasX, -e.canvasY), this._looking = !0
        },
        lookAt: function (e) {
            this._looking && (this._manipulator.getLookPositionInterpolator().setDelay(this._delay), this._manipulator.getLookPositionInterpolator().setTarget(e.canvasX, -e.canvasY))
        },
        changeStepFactor: function (e) {
            this._stepFactor = Math.min(Math.max(.001, this._stepFactor + .01 * e.deltaY), 4), this._manipulator.setStepFactor(this._stepFactor)
        },
        reset: function () {
            this._manipulator.computeHomePosition()
        },
        goForward: function () {
            this._manipulator.getForwardInterpolator().setDelay(this._delay), this._manipulator.getForwardInterpolator().setTarget(1)
        },
        goBackward: function () {
            this._manipulator.getForwardInterpolator().setDelay(this._delay), this._manipulator.getForwardInterpolator().setTarget(-1)
        },
        goLeft: function () {
            this._manipulator.getSideInterpolator().setDelay(this._delay), this._manipulator.getSideInterpolator().setTarget(-1)
        },
        goRight: function () {
            this._manipulator.getSideInterpolator().setDelay(this._delay), this._manipulator.getSideInterpolator().setTarget(1)
        },
        stopMoving: function () {
            this._manipulator.getForwardInterpolator().setDelay(this._delay), this._manipulator.getForwardInterpolator().setTarget(0)
        },
        stopStrafing: function () {
            this._manipulator.getSideInterpolator().setDelay(this._delay), this._manipulator.getSideInterpolator().setTarget(0)
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(10),
        a = i(624),
        o = i(886),
        s = i(887),
        u = i(628),
        l = i(693),
        c = i(888),
        h = i(629),
        d = i(114),
        f = function (e) {
            a.a.call(this, e), this._homePosition = r.f.create(), this._frustum = {}, this.init()
        };
    f.AvailableControllerList = ["StandardMouseKeyboard", "GamePad", "Hammer", "DeviceOrientation", "WebVR"], f.ControllerList = ["StandardMouseKeyboard", "GamePad", "Hammer", "DeviceOrientation", "WebVR"];
    var p = 2 * Math.PI,
        m = function (e, t) {
            return e < t + 1e-5
        };
    n.a.createPrototypeObject(f, n.a.objectInherit(a.a.prototype, {
        init: function () {
            this._distance = 25, this._target = r.f.create(), this._upz = r.f.fromValues(0, 0, 1), r.f.init(this._target);
            var e = r.c.fromRotation(r.c.create(), -Math.PI, this._upz),
                t = r.c.fromRotation(r.c.create(), Math.PI / 10, r.f.fromValues(1, 0, 0));
            this._rotation = r.c.create(), r.c.mul(this._rotation, e, t), this._time = 0, this._vrMatrix = r.c.create(), this._rotate = new h.a(2), this._pan = new h.a(2), this._zoom = new h.a(1), this._minSpeed = 1e-4, this._scaleMouseMotion = 1, this._inverseMatrix = r.c.create(), this._autoPushTarget = !0, this._limitPitchUp = .5 * Math.PI * .9, this._limitPitchDown = -this._limitPitchUp, this._limitYawLeft = -Math.PI, this._limitYawRight = -this._limitYawLeft, this._limitZoomIn = 1e-4, this._limitZoomOut = 1 / 0, this._constrainYaw = !1, this._constrainPitch = !1, this._constrainYaw = !1, this._constrainZoom = !1;
            var i = this;
            f.ControllerList.forEach(function (e) {
                void 0 !== f[e] && (i._controllerList[e] ? i._controllerList[e].init() : i._controllerList[e] = new f[e](i))
            })
        },
        setLimitPitchUp: function (e) {
            this._limitPitchUp = e
        },
        setLimitPitchDown: function (e) {
            this._limitPitchDown = e
        },
        setLimitYawLeft: function (e) {
            this._limitYawLeft = e, this._constrainYaw = !0
        },
        setLimitYawRight: function (e) {
            this._limitYawRight = e, this._constrainYaw = !0
        },
        setLimitZoomOut: function (e) {
            this._limitZoomOut = e, this._constrainZoom = !0
        },
        setLimitZoomIn: function (e) {
            this._limitZoomIn = e, this._constrainZoom = !0
        },
        setConstrainPitch: function (e) {
            this._constrainPitch = e, this._previousPitch = void 0
        },
        isConstrainPitch: function () {
            return this._constrainPitch
        },
        setConstrainYaw: function (e) {
            this._constrainYaw = e, this._previousYaw = void 0
        },
        isConstrainYaw: function () {
            return this._constrainYaw
        },
        setConstrainZoom: function (e) {
            this._constrainZoom = e
        },
        isConstrainZoom: function () {
            return this._constrainZoom
        },
        setDelay: function (e) {
            this._rotate.setDelay(e), this._pan.setDelay(e), this._zoom.setDelay(e)
        },
        reset: function () {
            this.init()
        },
        setTarget: function (e) {
            r.f.copy(this._target, e);
            var t = r.f.create();
            this.getEyePosition(t), this._distance = r.f.distance(e, t)
        },
        setEyePosition: function () {
            var e = r.f.create(),
                t = r.f.create(),
                i = r.f.create();
            return function (n) {
                var a = this._rotation,
                    o = this._target;
                r.f.sub(e, n, o), r.f.normalize(e, e), r.f.cross(t, e, this._upz), r.f.normalize(t, t), r.f.cross(i, t, e), r.f.normalize(i, i), a[0] = t[0], a[1] = e[0], a[2] = i[0], a[3] = 0, a[4] = t[1], a[5] = e[1], a[6] = i[1], a[7] = 0, a[8] = t[2], a[9] = e[2], a[10] = i[2], a[11] = 0, a[12] = 0, a[13] = 0, a[14] = 0, a[15] = 1, this._distance = r.f.distance(o, n)
            }
        }(),
        setEnable: function (e) {
            this.getInputManager().setEnable(d.a.ORBIT_MANIPULATOR, e)
        },
        computeHomePosition: function (e) {
            var t = this.getHomeBoundingSphere(e);
            t && t.valid() && (this.setDistance(this.getHomeDistance(t)), this.setTarget(t.center()))
        },
        getHomePosition: function () {
            if (void 0 !== this._node) {
                var e = this._target,
                    t = this.getDistance();
                this.computeEyePosition(e, t, this._homePosition)
            }
            return this._homePosition
        },
        setMinSpeed: function (e) {
            this._minSpeed = e
        },
        getMinSpeed: function () {
            return this._minSpeed
        },
        setDistance: function (e) {
            this._distance = e
        },
        getDistance: function () {
            return this._distance
        },
        getSpeedFactor: function () {
            return Math.max(this._distance, this._minSpeed)
        },
        computePan: function () {
            var e = r.c.create(),
                t = r.f.create(),
                i = r.f.create();
            return function (n, a) {
                var o = this._camera.getProjectionMatrix(),
                    s = 1 === o[15] ? 1 : 2 / o[5],
                    u = this.getSpeedFactor() * s;
                a *= u, n *= u, r.c.invert(e, this._rotation), t[0] = e[0], t[1] = e[1], t[2] = e[2], r.f.normalize(t, t), i[0] = e[8], i[1] = e[9], i[2] = e[10], r.f.normalize(i, i), r.f.scale(t, t, -n), r.f.scale(i, i, a), r.f.add(this._target, this._target, t), r.f.add(this._target, this._target, i)
            }
        }(),
        computeRotation: function () {
            var e = r.f.fromValues(1, 0, 0);
            return function (t, i) {
                var n = Math.atan(-this._rotation[6] / this._rotation[5]);
                isNaN(n) && (n = 0);
                var a = this._computePitch(n, i),
                    o = t / 10,
                    s = Math.atan2(this._rotation[4], this._rotation[0]),
                    u = this._computeYaw(s, o);
                r.c.fromRotation(this._rotation, -a, e), r.c.rotate(this._rotation, this._rotation, -u, this._upz)
            }
        }(),
        _computePitch: function (e, t) {
            var i = e + t / 10;
            return Math.min(Math.max(i, this._limitPitchDown), this._limitPitchUp)
        },
        _computeYaw: function (e, t) {
            var i = e + t,
                n = this._limitYawLeft,
                r = this._limitYawRight;
            if (this._constrainYaw) {
                if (r < n && (i > Math.PI && (e -= p, i -= p), i < -Math.PI && (e += p, i += p)), 0 === t) {
                    var a = !1;
                    a = n > r ? i < n && i > r : i < n || i > r, a && (i = Math.abs(i - n) > Math.abs(i - r) ? r : n)
                }
                t > 0 && m(e, r) && i > r ? i = r : t < 0 && m(n, e) && i < n && (i = n)
            }
            return i
        },
        computeZoom: function (e) {
            this.zoom(e)
        },
        setAutoPushTarget: function (e) {
            this._autoPushTarget = e
        },
        zoom: function () {
            var e = r.f.create();
            return function (t) {
                var i = this._distance + this.getSpeedFactor() * (t - 1);
                this._autoPushTarget && i < this._limitZoomIn && (r.f.sub(e, this._target, this.getEyePosition(e)), r.f.normalize(e, e), r.f.scale(e, e, this._limitZoomIn - i), r.f.add(this._target, this._target, e));
                var n = this._constrainZoom ? this._limitZoomIn : 1e-4,
                    a = this._constrainZoom ? this._limitZoomOut : 1 / 0;
                this._distance = Math.max(n, Math.min(a, i))
            }
        }(),
        getRotateInterpolator: function () {
            return this._rotate
        },
        getPanInterpolator: function () {
            return this._pan
        },
        getZoomInterpolator: function () {
            return this._zoom
        },
        getTarget: function (e) {
            return r.f.copy(e, this._target)
        },
        getEyePosition: function (e) {
            return this.computeEyePosition(this._target, this._distance, e), e
        },
        computeEyePosition: function () {
            var e = r.f.create(),
                t = r.c.create();
            return function (i, n, a) {
                r.c.invert(t, this._rotation), e[1] = n, r.f.transformMat4(a, e, t), r.f.add(a, i, a)
            }
        }(),
        update: function () {
            var e = r.f.create();
            return function (t) {
                var i, n = t.getFrameStamp().getDeltaTime();
                i = this._rotate.update(n), this.computeRotation(.1 * -i[0] * this._scaleMouseMotion, .1 * -i[1] * this._scaleMouseMotion);
                i = this._pan.update(n), this.computePan(.002 * -i[0], .002 * -i[1]), i = this._zoom.update(n), this.computeZoom(1 + i[0] / 10);
                var a = this._target,
                    o = this._distance;
                r.c.invert(this._inverseMatrix, this._rotation), r.c.mul(this._inverseMatrix, this._vrMatrix, this._inverseMatrix), r.f.set(e, 0, o, 0), r.f.transformMat4(e, e, this._inverseMatrix), r.c.lookAt(this._inverseMatrix, r.f.add(e, a, e), a, this._upz)
            }
        }(),
        setPoseVR: function (e) {
            r.c.fromQuat(this._vrMatrix, e)
        }
    }), "osgGA", "OrbitManipulator"), f.DeviceOrientation = o.a, f.GamePad = s.a, f.Hammer = u.a, f.WebVR = c.a, f.StandardMouseKeyboard = l.a, t.a = f
}, function (e, t, i) {
    "use strict";
    var n = i(366),
        r = i(12),
        a = i(10),
        o = i(694),
        s = i(114),
        u = function (e) {
            n.a.call(this, e), this.init()
        };
    r.a.createPrototypeObject(u, r.a.objectInherit(n.a.prototype, {
        init: function () {
            this._quat = a.d.create(), this._pos = a.f.create(), this._deviceOrientation = void 0, this._screenOrientation = void 0;
            var e = this._manipulator.getInputManager();
            e.group(s.a.ORBIT_MANIPULATOR_DEVICEORIENTATION).addMappings({
                setDeviceOrientation: "deviceorientation",
                setScreenOrientation: "orientationchange"
            }, this), e.setEnable(s.a.ORBIT_MANIPULATOR_DEVICEORIENTATION, !1)
        },
        setDeviceOrientation: function (e) {
            if (this._deviceOrientation || (this._deviceOrientation = {}), this._deviceOrientation.alpha = e.alpha, this._deviceOrientation.beta = e.beta, this._deviceOrientation.gamma = e.gamma, e.screenOrientation) return void this.setScreenOrientation(e);
            this._update()
        },
        setScreenOrientation: function (e) {
            this._screenOrientation = e.screenOrientation, this._update()
        },
        _update: function () {
            this._deviceOrientation && this._screenOrientation && (o.a.computeQuaternion(this._quat, this._deviceOrientation, this._screenOrientation), this._manipulator.setPoseVR(this._quat, this._pos))
        }
    })), t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(366),
        r = i(12),
        a = i(10),
        o = i(114),
        s = function (e) {
            n.a.call(this, e), this.init()
        };
    r.a.createPrototypeObject(s, r.a.objectInherit(n.a.prototype, {
        init: function () {
            this._delay = .15, this._zoomFactor = .5, this._rotateFactor = 5, this._panFactor = 10, this._rotate = this._manipulator.getRotateInterpolator(), this._zoom = this._manipulator.getZoomInterpolator(), this._pan = this._manipulator.getPanInterpolator(), this._rotate.setDelay(this._delay), this._zoom.setDelay(this._delay), this._pan.setDelay(this._delay);
            var e = this._manipulator.getInputManager();
            e.group(o.a.ORBIT_MANIPULATOR_GAMEPAD).addMappings({
                addZoom: "axis 3",
                addRotateX: "axis 0",
                addRotateY: "axis 1"
            }, this), e.group(o.a.ORBIT_MANIPULATOR_GAMEPAD).addMappings({
                panUp: "buttonvalue 12"
            }, this.pan.bind(this, a.e.fromValues(0, 1))), e.group(o.a.ORBIT_MANIPULATOR_GAMEPAD).addMappings({
                panDown: "buttonvalue 13"
            }, this.pan.bind(this, a.e.fromValues(0, -1))), e.group(o.a.ORBIT_MANIPULATOR_GAMEPAD).addMappings({
                panLeft: "buttonvalue 14"
            }, this.pan.bind(this, a.e.fromValues(1, 0))), e.group(o.a.ORBIT_MANIPULATOR_GAMEPAD).addMappings({
                panRight: "buttonvalue 15"
            }, this.pan.bind(this, a.e.fromValues(-1, 0)))
        },
        pan: function (e) {
            var t = this._pan.getTarget();
            this._pan.setTarget(t[0] - e[0] * this._panFactor, t[1] + e[1] * this._panFactor)
        },
        addZoom: function (e) {
            this._zoom.addTarget(-e.value * this._zoomFactor)
        },
        addRotateX: function (e) {
            this._rotate.addTarget(-e.value * this._rotateFactor)
        },
        addRotateY: function (e) {
            this._rotate.addTarget(0, e.value * this._rotateFactor)
        }
    })), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(366),
        r = i(12),
        a = i(10),
        o = i(114),
        s = a.d.create(),
        u = a.f.create(),
        l = function (e) {
            n.a.call(this, e), this.init()
        };
    r.a.createPrototypeObject(l, r.a.objectInherit(n.a.prototype, {
        init: function () {
            this._pos = a.f.create(), this._quat = a.d.create();
            var e = this._manipulator.getInputManager();
            e.group(o.a.ORBIT_MANIPULATOR_WEBVR).addMappings({
                update: "vrdisplayposechanged"
            }, this), e.setEnable(o.a.ORBIT_MANIPULATOR_WEBVR, !1)
        },
        update: function (e) {
            var t = e.pose.orientation;
            t && (e.sitToStandMatrix && (t = a.c.getRotation(s, e.sitToStandMatrix), a.d.mul(t, t, e.pose.orientation)), this._quat[0] = t[0], this._quat[1] = -t[2], this._quat[2] = t[1], this._quat[3] = t[3]);
            var i = e.pose.position;
            i && (e.sitToStandMatrix && (i = a.f.transformMat4(u, i, e.sitToStandMatrix)), this._pos[0] = i[0] * e.worldFactor, this._pos[1] = -i[2] * e.worldFactor, this._pos[2] = i[1] * e.worldFactor), this._manipulator.setPoseVR(this._quat, this._pos)
        }
    })), t.a = l
}, function (e, t, i) {
    "use strict";
    var n = i(407),
        r = function (e, t) {
            var i, n;
            t ? (i = t[0], n = t[1]) : (i = e[14] / (e[10] - 1), n = e[14] / (1 + e[10]));
            var r = i * (e[8] - 1) / e[0],
                a = i * (1 + e[8]) / e[0],
                o = i * (1 + e[9]) / e[5],
                s = i * (e[9] - 1) / e[5],
                u = n * (e[8] - 1) / e[0],
                l = n * (1 + e[8]) / e[0],
                c = n * (1 + e[9]) / e[5],
                h = n * (e[9] - 1) / e[5],
                d = this.getAttributes().Vertex,
                f = d.getElements();
            f[0] = r, f[1] = s, f[2] = -i, f[3] = a, f[4] = s, f[5] = -i, f[6] = a, f[7] = o, f[8] = -i, f[9] = r, f[10] = o, f[11] = -i, f[12] = u, f[13] = h, f[14] = -n, f[15] = l, f[16] = h, f[17] = -n, f[18] = l, f[19] = c, f[20] = -n, f[21] = u, f[22] = c, f[23] = -n, d.dirty()
        },
        a = function () {
            var e = n.a.createBoundingBoxGeometry();
            return e.updateGeometry = r, e
        };
    t.a = {
        createDebugFrustumGeometry: a
    }
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(84),
        a = i(364),
        o = function (e) {
            r.a.call(this, r.a.TRAVERSE_ALL_CHILDREN), this._selectables = e, this._nodeList = [], this._linkList = [], this._uniqueNodes = new window.Set, this._uniqueEdges = new window.Set
        };
    n.a.createPrototypeObject(o, n.a.objectInherit(r.a.prototype, {
        getColorFromClassName: function (e) {
            switch (e) {
                case "ShadowedScene":
                    return "#3D3D3D";
                case "Camera":
                    return "#AB7BCF";
                case "RenderBin":
                    return "#59778B";
                case "LightSource":
                    return "#53967D";
                case "RenderStage":
                    return "#DDCC55";
                case "RenderLeaf":
                case "Geometry":
                    return "#FFCC55";
                case "RigGeometry":
                    return "#DD8800";
                case "MorphGeometry":
                    return "#AA5500";
                case "MatrixTransform":
                    return "#CE697E";
                case "StateSet":
                    return "#0099FF";
                case "StateGraph":
                case "Skeleton":
                    return "#96999E";
                case "Bone":
                    return "#A9DEAA";
                case "Node":
                    return "#FFFFFF";
                default:
                    return "#FF00AA"
            }
        },
        createGraph: function (e) {
            this.reset(), e.accept(this)
        },
        reset: function () {
            this._nodeList.length = 0, this._linkList.length = 0, this._uniqueNodes.clear(), this._uniqueEdges.clear()
        },
        apply: function (e) {
            if (!e._isNormalDebug) {
                if (this._uniqueNodes.has(e.getInstanceID()) || (this._uniqueNodes.add(e.getInstanceID()), this._nodeList.push(e)), this.nodePath.length >= 2) {
                    var t = this.nodePath[this.nodePath.length - 2].getInstanceID(),
                        i = e.getInstanceID(),
                        n = t + "+" + i;
                    this._uniqueEdges.has(n) || (this._linkList.push({
                        parentNode: t,
                        childrenNode: i
                    }), this._uniqueEdges.add(n))
                }
                this.traverse(e)
            }
        },
        createMatrixGrid: function (e, t) {
            var i = "";
            return i += "<table><tr><td>" + t[0] + "</td>", i += "<td>" + t[4] + "</td>", i += "<td>" + t[8] + "</td>", i += "<td>" + t[12] + "</td></tr>", i += "<tr><td>" + t[1] + "</td>", i += "<td>" + t[5] + "</td>", i += "<td>" + t[9] + "</td>", i += "<td>" + t[13] + "</td></tr>", i += "<tr><td>" + t[2] + "</td>", i += "<td>" + t[6] + "</td>", i += "<td>" + t[10] + "</td>", i += "<td>" + t[14] + "</td></tr>", i += "<tr><td>" + t[3] + "</td>", i += "<td>" + t[7] + "</td>", i += "<td>" + t[11] + "</td>", i += "<td>" + t[15] + "</td></tr></table>"
        },
        getLabel: function (e) {
            var t = e.className() + " (" + e.getInstanceID() + ")";
            return e.getName && e.getName() && (t += "\n" + e.getName()), t
        },
        generateNode: function (e, t) {
            var i = "";
            t.getMatrix && t.getMatrix() && (i += "<br /><br />" + this.createMatrixGrid(t, t.getMatrix())), this._selectables.set(t.getInstanceID().toString(), t), e.addNode(t.getInstanceID(), {
                label: this.getLabel(t),
                description: i,
                style: "fill: " + this.getColorFromClassName(t.className()) + ";stroke-width: 0px;"
            })
        },
        generateStateSet: function (e, t) {
            var i = t.getStateSet(),
                n = i.getInstanceID(),
                r = this.getLabel(i);
            r += "\nNbTexture : " + i.getNumTextureAttributeLists(), e.hasNode(n) || (this._selectables.set(n.toString(), i), e.addNode(n, {
                label: r,
                style: "fill: " + this.getColorFromClassName(i.className()) + ";stroke-width: 0px;"
            })), e.addEdge(null, t.getInstanceID(), n, {
                style: "stroke: " + this.getColorFromClassName(i.className()) + ";"
            })
        },
        generateSourceGeometry: function (e, t) {
            var i = t.getSourceGeometry(),
                n = i.getInstanceID();
            this._selectables.set(n.toString(), i), e.addNode(n, {
                label: this.getLabel(i),
                style: "fill: " + this.getColorFromClassName(i.className()) + ";stroke-width: 0px;"
            }), e.addEdge(null, t.getInstanceID(), n, {
                style: "stroke: " + this.getColorFromClassName(i.className()) + ";"
            })
        },
        generateNodeAndLink: function (e) {
            for (var t = 0, i = this._nodeList.length; t < i; t++) {
                var n = this._nodeList[t];
                this.generateNode(e, n), n.getStateSet() && this.generateStateSet(e, n), n.getSourceGeometry && n.getSourceGeometry() instanceof a.a && this.generateSourceGeometry(e, n)
            }
            for (var r = 0, o = this._linkList.length; r < o; r++) e.addEdge(null, this._linkList[r].parentNode, this._linkList[r].childrenNode)
        }
    }), "osgUtil", "DisplayGraphNode"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(892),
        r = i(1109),
        a = i(687),
        o = {};
    o.ShaderGenerator = n.a, o.ShaderGeneratorProxy = r.a, o.shaderProcessor = a.a, t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(36),
        a = i(292),
        o = i(320),
        s = function () {
            this._cache = {}, this._ShaderCompiler = void 0
        };
    s.prototype = {
        setShaderCompiler: function (e) {
            this._ShaderCompiler = e, e._validAttributeTypeMemberCache || this._computeStateAttributeCache(e)
        },
        getShaderCompiler: function () {
            return this._ShaderCompiler
        },
        filterAttributeTypes: function (e) {
            return !(!e.isEnabled || e.isEnabled())
        },
        getActiveAttributeList: function (e, t) {
            for (var i = "", n = e._attributeArray, r = this._ShaderCompiler._validAttributeTypeMemberCache, a = 0, o = r.length; a < o; a++) {
                var s = r[a],
                    u = s < n.length ? n[s] : void 0;
                if (u) {
                    var l = u._lastApplied;
                    l && !this.filterAttributeTypes(l) && (i += l.getHash(), t.push(l))
                }
            }
            return i
        },
        getActiveAttributeListCache: function (e) {
            for (var t = "", i = this._ShaderCompiler._validAttributeTypeMemberCache, n = 0, r = i.length; n < r; n++) {
                var a = i[n],
                    o = a < e._attributeArray.length ? e._attributeArray[a] : void 0;
                if (o) {
                    var s = o._lastApplied;
                    if (!s || this.filterAttributeTypes(s)) continue;
                    t += o._lastApplied.getHash()
                }
            }
            return t
        },
        getActiveTextureAttributeListCache: function (e) {
            for (var t = "", i = this._ShaderCompiler._validTextureAttributeTypeMemberCache, n = e._textureAttributeArrayList, r = 0; r < n.length; r++) {
                var a = n[r];
                if (a)
                    for (var o = a.length, s = 0; s < i.length; s++) {
                        var u = i[s],
                            l = u < o ? a[u] : void 0;
                        if (l) {
                            var c = l._lastApplied;
                            if (!c || this.filterAttributeTypes(c) || c.isTextureNull()) continue;
                            t += c.getHash()
                        }
                    }
            }
            return t
        },
        getActiveTextureAttributeList: function (e, t) {
            var i, n, r = "",
                a = e._textureAttributeArrayList,
                o = this._ShaderCompiler._validTextureAttributeTypeMemberCache;
            for (i = 0, n = a.length; i < n; i++) {
                var s = a[i];
                if (s) {
                    t[i] = [];
                    for (var u = 0, l = o.length; u < l; u++) {
                        var c = o[u],
                            h = c < s.length ? s[c] : void 0;
                        if (h) {
                            var d = h._lastApplied;
                            !d || this.filterAttributeTypes(d) || d.isTextureNull() || (r += d.getHash(), t[i].push(d))
                        }
                    }
                }
            }
            return r
        },
        getActiveUniforms: function (e, t, i) {
            for (var n = {}, r = 0, a = t.length; r < a; r++) {
                var o = t[r];
                if (o.getOrCreateUniforms) {
                    var s = o.getOrCreateUniforms();
                    if (void 0 !== s)
                        for (var u in s) {
                            var l = s[u];
                            n[l.getName()] = l
                        }
                }
            }
            for (var c = 0, h = i.length; c < h; c++) {
                var d = i[c];
                if (d)
                    for (var f = 0, p = d.length; f < p; f++) {
                        var m = d[f],
                            g = m.getOrCreateUniforms(c);
                        for (var v in g) {
                            var _ = g[v];
                            n[_.getName()] = _
                        }
                    }
            }
            return n
        },
        _computeStateAttributeCache: function (e) {
            var t, i, a, o, s, u = e.stateAttributeConfig.attribute || [],
                l = [];
            for (i = 0, a = u.length; i < a; i++) t = u[i], void 0 !== (s = n.a.getIdFromTypeMember(t)) && (-1 !== l.indexOf(s) ? r.a.warn("Compiler " + e.name + " contains duplicate attribute entry " + t + ", check the Compiler configuration") : l.push(s));
            for (o = new Uint8Array(l), e._validAttributeTypeMemberCache = o, u = e.stateAttributeConfig.textureAttribute || [], l = [], i = 0, a = u.length; i < a; i++) t = u[i], s = n.a.getTextureIdFromTypeMember(t), -1 !== l.indexOf(s) ? r.a.warn("Compiler " + e.name + " contains duplicate texture attribute entry " + t + ", check the Compiler configuration") : l.push(s);
            o = new Uint8Array(l), e._validTextureAttributeTypeMemberCache = o
        },
        _createWaitingProgram: function (e, t, i) {
            var n = new a.a(new o.a(o.a.VERTEX_SHADER, "attribute vec3 Vertex;uniform mat4 uModelViewMatrix;uniform mat4 uProjectionMatrix;void main(void) {  gl_Position = vec4(10.0,10.0,10.0,1.0);}\n"), new o.a(o.a.FRAGMENT_SHADER, "#define SHADER_NAME WaitSafe\nprecision lowp float; void main(void) { gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);}\n"));
            return this.getActiveAttributeList(e, t), n.setActiveUniforms(this.getActiveUniforms(e, t, i)), n.generated = !0, n.apply(e), n
        },
        getOrCreateProgram: function () {
            var e = [],
                t = [];
            return function (i) {
                var n = this.getActiveAttributeListCache(i) + this.getActiveTextureAttributeListCache(i),
                    r = this._getProgram(n, i, t, e);
                return void 0 !== r ? r : this._createProgram(n, i, t, e)
            }
        }(),
        _getProgram: function (e) {
            return this._cache[e]
        },
        _createProgram: function (e, t, i, n) {
            i.length = 0, n.length = 0, this.getActiveAttributeList(t, i), this.getActiveTextureAttributeList(t, n);
            var r = this._ShaderCompiler,
                s = new r(i, n),
                u = s.createFragmentShader(),
                l = s.createVertexShader(),
                c = new a.a(new o.a(o.a.VERTEX_SHADER, l), new o.a(o.a.FRAGMENT_SHADER, u));
            return c.hash = e, c.setActiveUniforms(this.getActiveUniforms(t, i, n)), c.generated = !0, this._cache[e] = c, c.apply(t), c
        },
        resetCache: function () {
            this._cache = {}
        }
    }, t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(102),
        a = i(872),
        o = function () {
            r.a.call(this), this._databasePager = new a.a, this._sceneData = void 0
        };
    n.a.createPrototypeObject(o, n.a.objectInherit(r.a.prototype, {
        getSceneData: function () {
            return this._sceneData
        },
        setSceneData: function (e) {
            this._sceneData = e
        },
        setDatabasePager: function (e) {
            this._databasePager = e
        },
        getDatabasePager: function () {
            return this._databasePager
        },
        updateSceneGraph: function (e) {
            this._databasePager && this._databasePager.updateSceneGraph(e.getFrameStamp()), this._sceneData && this._sceneData.accept(e)
        }
    }), "osgViewer", "Scene"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n, r, a, o = i(178),
        s = i(160),
        u = i(138),
        l = i(291),
        c = i(289),
        h = i(292),
        d = i(320),
        f = function () {
            if (n) return n;
            var e = "#define SHADER_NAME GizmoLine3D",
                t = ["attribute vec3 Vertex;", "uniform mat4 uModelViewMatrix;", "uniform mat4 uProjectionMatrix;", e, "", "void main(void) {", "  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex, 1.0);", "}"].join("\n"),
                i = ["uniform vec4 uColor;", e, "", "void main(void) {", "  gl_FragColor = uColor;", "}"].join("\n");
            return n = new h.a(new d.a(d.a.VERTEX_SHADER, t), new d.a(d.a.FRAGMENT_SHADER, i))
        },
        p = function () {
            if (r) return r;
            var e = "#define SHADER_NAME GizmoLine2D",
                t = ["attribute vec2 Vertex;", e, "", "void main(void) {", "  gl_Position = vec4(Vertex, 0.0, 1.0);", "}"].join("\n"),
                i = [e, "", "void main(void) {", "  gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);", "}"].join("\n");
            return r = new h.a(new d.a(d.a.VERTEX_SHADER, t), new d.a(d.a.FRAGMENT_SHADER, i))
        },
        m = function () {
            if (a) return a;
            var e = "#define SHADER_NAME GizmoQuadCircle",
                t = ["attribute vec3 Vertex;", "uniform mat4 uModelViewMatrix;", "uniform mat4 uProjectionMatrix;", "varying vec3 vViewVertex;", e, "", "void main(void) {", "  vViewVertex = Vertex;", "  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex, 1.0);", "}"].join("\n"),
                i = ["uniform float uAngle;", "uniform vec3 uBase;", "varying vec3 vViewVertex;", "const float PI = 3.14159265358979323846264;", "const float PI2 = PI * 2.0;", e, "", "void main(void) {", "  if(length(vViewVertex) > 0.5)", "    discard;", "  vec3 vn = normalize(vViewVertex);", "  float angle = atan(uBase.y * vn.x - uBase.x * vn.y, dot(uBase, vn));", "  if(angle > 0.0) {", "    if(uAngle >= 0.0 && angle > uAngle) discard;", "    if(uAngle < -PI && angle < uAngle + PI2) discard;", "    if(uAngle < 0.0 && uAngle > -PI) discard;", "  }", "  if(angle < 0.0) {", "    if(uAngle <= 0.0 && angle < uAngle) discard;", "    if(uAngle > PI && angle > uAngle - PI2) discard;", "    if(uAngle > 0.0 && uAngle < PI) discard;", "  }", "  gl_FragColor = vec4(1.0, 1.0, 0.0, 0.5);", "}"].join("\n");
            return a = new h.a(new d.a(d.a.VERTEX_SHADER, t), new d.a(d.a.FRAGMENT_SHADER, i))
        },
        g = function () {
            n = void 0, r = void 0, a = void 0
        },
        v = function () {
            var e = new s.a;
            e.getAttributes().Vertex = new o.a(o.a.ARRAY_BUFFER, new Float32Array(4), 2);
            var t = new l.a(u.a.LINES, 0, 2);
            return e.getPrimitives().push(t), e.getOrCreateStateSet().setAttributeAndModes(p()), e
        },
        _ = function (e, t, i, n, r) {
            var a = void 0 !== e ? e : 1,
                l = void 0 !== t ? t : .2,
                h = void 0 !== i ? i : 6,
                d = void 0 !== n ? n : 64,
                p = void 0 !== r ? r : 2 * Math.PI,
                m = (h + 1) * (d + 1),
                g = h * d * 2,
                v = new s.a,
                _ = new Float32Array(3 * m),
                b = new Uint16Array(3 * g);
            p = p || 2 * Math.PI;
            var S = 0,
                x = 0,
                y = 0,
                C = 0;
            for (C = 0; C <= h; ++C)
                for (y = 0; y <= d; ++y) {
                    var T = y / d * p,
                        w = C / h * Math.PI * 2;
                    x = 3 * S, _[x] = (a + l * Math.cos(w)) * Math.cos(T), _[x + 1] = (a + l * Math.cos(w)) * Math.sin(T), _[x + 2] = l * Math.sin(w), S++
                }
            for (S = 0, C = 1; C <= h; ++C)
                for (y = 1; y <= d; ++y) x = 6 * S, b[x] = (d + 1) * C + y - 1, b[x + 1] = b[x + 3] = (d + 1) * (C - 1) + y - 1, b[x + 2] = b[x + 5] = (d + 1) * C + y, b[x + 4] = (d + 1) * (C - 1) + y, S++;
            return v.getAttributes().Vertex = new o.a(o.a.ARRAY_BUFFER, _, 3), v.getOrCreateStateSet().setAttributeAndModes(f()), v.getPrimitives().push(new c.a(u.a.TRIANGLES, new o.a(o.a.ELEMENT_ARRAY_BUFFER, b, 1))), v
        },
        b = function (e, t, i, n, r, a, l) {
            var h = void 0 !== e ? e : 1,
                d = void 0 !== t ? t : 1,
                p = void 0 !== i ? i : 5,
                m = void 0 !== n ? n : 32,
                g = void 0 !== r ? r : 1,
                v = void 0 === a || a,
                _ = void 0 === l || l;
            v = v && h > 0, _ = _ && d > 0;
            var b = .5 * p,
                S = (g + 1) * (m + 1),
                x = g * m * 2;
            v && (S += 1, x += m), _ && (S += 1, x += m);
            var y = new s.a,
                C = new Float32Array(3 * S),
                T = new Uint16Array(3 * x),
                w = 0,
                M = 0,
                E = 0,
                A = 0;
            for (E = 0; E <= g; E++) {
                var P = E / g,
                    R = P * (d - h) + h;
                for (A = 0; A <= m; A++) {
                    var O = A / m;
                    M = 3 * w, C[M] = R * Math.sin(O * Math.PI * 2), C[M + 1] = R * Math.cos(O * Math.PI * 2), C[M + 2] = -P * p + b, w++
                }
            }
            for (w = 0, A = 0; A < m; A++)
                for (E = 0; E < g; E++) M = 6 * w, T[M] = (m + 1) * E + A, T[M + 1] = T[M + 3] = (m + 1) * (E + 1) + A, T[M + 2] = T[M + 5] = (m + 1) * E + A + 1, T[M + 4] = (m + 1) * (E + 1) + A + 1, w++;
            w *= 2;
            var I;
            if (v)
                for (I = (_ ? C.length - 6 : C.length - 3) / 3, C[3 * I + 2] = b, A = 0; A < m; A++) M = 3 * w, T[M] = A, T[M + 1] = A + 1, T[M + 2] = I, w++;
            if (_) {
                I = (C.length - 3) / 3, C[3 * I + 2] = -b;
                var F = (m + 1) * E;
                for (A = 0; A < m; A++) M = 3 * w, T[M] = F + A + 1, T[M + 1] = F + A, T[M + 2] = I, w++
            }
            return y.getAttributes().Vertex = new o.a(o.a.ARRAY_BUFFER, C, 3), y.getOrCreateStateSet().setAttributeAndModes(f()), y.getPrimitives().push(new c.a(u.a.TRIANGLES, new o.a(o.a.ELEMENT_ARRAY_BUFFER, T, 1))), y
        },
        S = function (e, t, i) {
            for (var n = new s.a, r = new Float32Array(3 * e), a = i || 2 * Math.PI, c = 0; c < e; ++c) {
                var h = 3 * c,
                    d = a * c / e;
                r[h] = Math.cos(d) * t, r[h + 1] = Math.sin(d) * t
            }
            n.getAttributes().Vertex = new o.a(o.a.ARRAY_BUFFER, r, 3);
            var p = new l.a(u.a.LINE_STRIP, 0, e);
            return n.getOrCreateStateSet().setAttributeAndModes(f()), n.getPrimitives().push(p), n
        },
        x = function (e, t) {
            var i = e ? .5 * e : .5,
                n = t ? .5 * t : .5,
                r = new s.a,
                a = new Float32Array(12);
            a[0] = -i, a[1] = -n, a[3] = i, a[4] = -n, a[6] = -i, a[7] = n, a[9] = i, a[10] = n, r.getAttributes().Vertex = new o.a(o.a.ARRAY_BUFFER, a, 3);
            var c = new l.a(u.a.TRIANGLE_STRIP, 0, 4);
            return r.getOrCreateStateSet().setAttributeAndModes(f()), r.getPrimitives().push(c), r
        },
        y = function () {
            var e = x();
            return e.getOrCreateStateSet().setAttributeAndModes(m()), e
        },
        C = {};
    C.createCircleGeometry = S, C.createCylinderGeometry = b, C.createTorusGeometry = _, C.createDebugLineGeometry = v, C.createPlaneGeometry = x, C.createQuadCircleGeometry = y, C.resetPrograms = g, t.a = C
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(362),
        a = i(197),
        o = i(449),
        s = i(365),
        u = i(198),
        l = i(292),
        c = i(320),
        h = i(316),
        d = i(118),
        f = i(10),
        p = i(896),
        m = i(897),
        g = i(698),
        v = i(898),
        _ = i(579),
        b = i(580),
        S = i(407),
        x = i(317),
        y = i(114),
        C = function () {
            var e = ["attribute vec4 Vertex;", "uniform mat4 uModelViewMatrix;", "uniform mat4 uProjectionMatrix;", "", "varying vec2 vTexCoord0;", "", "void main(void) {", "  vTexCoord0 = Vertex.zw;", "  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xy,0.0, 1.0));", "}"].join("\n"),
                t = ["#define SHADER_NAME STATS", "varying vec2 vTexCoord0;", "uniform sampler2D Texture0;", "void main(void) {", "  vec4 color = vec4(1.0);", "  vec2 uv =  vTexCoord0;", "  int isText = 0;", "  if ( uv.y < 0.0 ) {", "     isText = 1;", "     uv.y = -uv.y;", "  }", "  if ( uv.y >= " + (p.a.backgroundColor - 1).toFixed(1) + " ) {", "     color = vec4(0.0,0.0,0.0,0.5);", "     uv.y -= " + p.a.backgroundColor.toFixed(1) + ";", "  } else if ( uv.y >= " + (p.a.redColor - 1).toFixed(1) + " ) {", "     color = vec4(1.0,0.0,0.0,1.0);", "     uv.y -= " + p.a.redColor.toFixed(1) + ";", "  } else if ( uv.y == " + (p.a.greyColor - 1).toFixed(1) + " ) {", "     color = vec4(0.5,0.5,0.5,1.0);", "     uv.y -= " + p.a.greyColor.toFixed(1) + ";", "  } else {", "     uv.y -= " + p.a.whiteColor.toFixed(1) + ";", "  }", "  if ( isText == 1 ) {", "     color *= texture2D( Texture0, uv.xy);", "  }", "  gl_FragColor = color;", "}"].join("\n");
            return new l.a(new c.a("VERTEX_SHADER", e), new c.a("FRAGMENT_SHADER", t))
        },
        T = function (e, t) {
            this._captionsBuffer = void 0, this._valuesBuffer = void 0, this._dirtyCaptions = !0, this._dirtyValues = !0, this._viewer = e, this._labelMaxWidth = 0, this._viewport = e.getCamera().getViewport(), this._node = void 0, this._text = void 0, this._offsetGroup = void 0, this._counters = {}, this._groups = {}, this._updates = [], this._displayableCounters = {}, this._x = 0, this._y = 0, this._width = 0, this._height = 0, this._maxCaptionTextLength = 32, this._lineFactor = 1.1, this._displayFilter = [], this._backgroundWidth = 0, this._backgroundHeight = 0, this._bufferStats = new p.a, this._historyGraph = {}, this._graphToDisplay = [], this._valuesMaxWidth = 72, this._showGraph = !1, this._backgroundPicking = S.a.createTexturedQuadGeometry(0, 0, 0, 10, 0, 0, 0, 10, 0), this._backgroundPicking.setName("osgStats-Background-picking"), this._dragStop = f.e.create(), this._dragStart = f.e.create(), this._startTransformation = f.c.create(), this._init(t)
        };
    n.a.createPrototypeObject(T, {
        getCounter: function (e) {
            return this._counters[e] || (this._counters[e] = new m.a({
                caption: e,
                average: !0
            })), this._counters[e]
        },
        getBufferStats: function () {
            return this._bufferStats
        },
        addConfig: function (e) {
            if (!e.init || e.init()) {
                for (var t in e.values) {
                    var i = e.values[t],
                        n = new m.a(i);
                    this._counters[t] = n
                }
                if (e.groups)
                    for (var r = 0; r < e.groups.length; r++) {
                        var a = e.groups[r],
                            o = {
                                caption: a.caption,
                                values: a.values,
                                textCursorY: new Float32Array(a.values.length)
                            },
                            s = a.name ? a.name : a.caption;
                        this._groups[s] = o
                    }
                e.update && this._updates.push(e.update)
            }
        },
        reset: function () {
            this._bufferStats.resetCaptions(), this._bufferStats.resetValues(), this._dirtyCaptions = !0, this._dirtyValue = !0, this._bufferStats.resize(this._bufferStats._maxNbVertexes)
        },
        update: function () {
            for (var e = 0; e < this._updates.length; e++) this._updates[e](this);
            this._dirtyValues = !0, (this._checkViewportChanged() || this._checkCounterDisplayableChanged()) && (this._dirtyCaptions = !0), this._dirtyCaptions && (this._bufferStats.resetCaptions(), this._generateCaptions(), this._dirtyCaptions = !1), this._dirtyValues && (this._bufferStats.resetValues(), this._generateValues(), this._dirtyValues = !1)
        },
        getNode: function () {
            return this._node
        },
        setShowFilter: function (e) {
            if (this._dirtyCaptions = !0, !e) return void(this._displayFilter.length = 0);
            this._displayFilter = e.slice()
        },
        _init: function (e) {
            var t = new a.a;
            t.setRenderOrder(a.a.POST_RENDER, 0), t.setReferenceFrame(h.a.ABSOLUTE_RF), t.setClearMask(0);
            var i = new u.a;
            i.setName("StatsNode"), i.addChild(this._backgroundPicking), this._nodeTransform = i, this._backgroundPicking.setNodeMask(0), t.addChild(i), t.setName("osgStats"), t.setViewport(this._viewport), this._node = t, this._text = new v.a;
            var n = 12;
            if (e) {
                var l = e.getString("statsFilter");
                if (l) {
                    var c = l.split(";");
                    this.setShowFilter(c)
                }
                var f = e.getNumber("statsFontSize");
                void 0 !== f && (n = f), this._showGraph = e.getBoolean("statsShowGraph")
            }
            var p = new d.default;
            p.setMinFilter(d.default.NEAREST), p.setMagFilter(d.default.NEAREST), this._text.setFontSize(n * this._viewer.getCanvasPixelRatio()), this._text.getCanvas().then(function (e) {
                this._dirtyCaptions = !0;
                var t = this._bufferStats.getGeometry();
                t.setNodeMask(-32769), i.addChild(t), p.setImage(e), t.setBound(new x.a)
            }.bind(this)), i.getOrCreateStateSet().setAttributeAndModes(C()), i.getOrCreateStateSet().setAttributeAndModes(new o.a(o.a.DISABLE));
            var m = new r.a("SRC_ALPHA", "ONE_MINUS_SRC_ALPHA");
            i.getOrCreateStateSet().setAttributeAndModes(m), i.getOrCreateStateSet().setAttributeAndModes(new s.a(s.a.DISABLE)), i.getOrCreateStateSet().setTextureAttributeAndModes(0, p);
            var g = this._viewer.getGraphicContext().canvas;
            this._canvas = g;
            var _ = this._viewer.getInputManager();
            _.group(y.a.STATS).addMappings({
                onMouseMove: ["mousemove", "touchmove"],
                onMouseDown: ["mousedown", "touchstart"],
                onMouseUp: ["mouseup", "mouseout", "touchend", "touchcancel"]
            }, this), _.setPriority(y.a.STATS, _.getHigherPriority(y.a.SCENE))
        },
        onMouseDown: function (e) {
            var t = this.computeNearestIntersection(e);
            this._onStats = !!t.length, this._onStats && (this._viewer.getInputManager().setEnable(y.a.SCENE, !1), f.c.copy(this._startTransformation, this._nodeTransform.getMatrix()), f.e.set(this._dragStart, e.canvasX, e.canvasY), this._dragStop[1] = this._dragStart[1])
        },
        onMouseMove: function () {
            var e = f.f.create();
            return function (t) {
                if (this._onStats) {
                    f.e.set(this._dragStop, t.canvasX, t.canvasY);
                    var i = this._dragStop[1] - this._dragStart[1];
                    f.c.translate(this._nodeTransform.getMatrix(), this._startTransformation, f.f.set(e, 0, -i, 0))
                }
            }
        }(),
        onMouseUp: function () {
            this._viewer.getInputManager().setEnable(y.a.SCENE, !0), this._onStats = !1
        },
        computeNearestIntersection: function () {
            var e = new b.a,
                t = f.f.create(),
                i = f.f.create(),
                n = new _.a;
            return n.setIntersector(e),
                function (r) {
                    var a = r.glX,
                        o = r.glY;
                    e.reset(), e.set(f.f.set(t, a, o, 0), f.f.set(i, a, o, 1)), n.reset(), this._backgroundPicking.setNodeMask(32768), n.setTraversalMask(32768), this._node.accept(n);
                    var s = e.getIntersections();
                    return this._backgroundPicking.setNodeMask(0), s
                }
        }(),
        _updateBackgroundPicking: function (e, t, i, n) {
            var r = this._backgroundPicking.getVertexAttributeList().Vertex.getElements();
            r[0] = e, r[1] = t + n, r[3] = e, r[4] = t, r[6] = e + i, r[7] = t, r[9] = e + i, r[10] = t + n, this._backgroundPicking.getVertexAttributeList().Vertex.dirty(), this._backgroundPicking.dirtyBound()
        },
        _generateCaptions: function () {
            var e = this._text.getCharacterHeight(),
                t = 0,
                i = this._viewport.height() - e;
            this._labelMaxWidth = 0, this._bufferStats.generateBackground(0, this._viewport.height() - this._backgroundHeight, this._backgroundWidth, this._backgroundHeight), this._updateBackgroundPicking(0, this._viewport.height() - this._backgroundHeight, this._backgroundWidth, this._backgroundHeight);
            var n = this._displayFilter;
            for (var r in this._groups)
                if (!r || !n.length || -1 !== n.indexOf(r)) {
                    var a = this._groups[r],
                        o = "--- " + a.caption + " ---",
                        s = this._bufferStats.generateText(t, i, o, this._text, p.a.whiteColor);
                    this._labelMaxWidth = Math.max(s, this._labelMaxWidth), t = 0, i -= this._lineFactor * e;
                    for (var u = 0; u < a.values.length; u++) {
                        var l = a.values[u],
                            c = this._counters[l];
                        if (c && c.isDisplayable()) {
                            a.textCursorY[u] = i;
                            for (var h = c._caption, d = h.length / this._maxCaptionTextLength, f = 0; f < d; f++) {
                                var m = f * this._maxCaptionTextLength,
                                    g = h.substr(m, this._maxCaptionTextLength);
                                s = this._bufferStats.generateText(t, i, g, this._text, p.a.whiteColor), this._labelMaxWidth = Math.max(s, this._labelMaxWidth), i -= e, t = 0
                            }
                        }
                    }
                    i -= e
                } this._bufferStats.captionsEnd()
        },
        _generateValues: function () {
            var e, t = this._text.getCharacterWidth(),
                i = this._labelMaxWidth + 2 * t,
                n = this._valuesMaxWidth + 2 * t,
                r = this._text.getCharacterHeight(),
                a = i,
                o = this._displayFilter,
                s = 0;
            for (var u in this._groups)
                if (!u || !o.length || -1 !== o.indexOf(u)) {
                    var l = this._groups[u];
                    a = i;
                    for (var c = 0; c < l.values.length; c++) {
                        var h = l.values[c],
                            d = this._counters[h];
                        if (d && d.isDisplayable()) {
                            var f, m = d.getAverageMs() ? d.getAverageValue() : d.getValue();
                            f = Number.isInteger(m) ? m.toString() : m.toFixed(2), e = l.textCursorY[c];
                            var v = p.a.whiteColor,
                                _ = d.getOver(),
                                b = d.getBelow();
                            0 !== _ ? v = m > _ ? p.a.redColor : v : 0 !== b && (v = m < b ? p.a.redColor : v);
                            var S = this._bufferStats.generateText(a, e, f, this._text, v);
                            s = Math.max(S, s), this._showGraph && d._graph && (this._historyGraph[h] || (this._historyGraph[h] = new g.a), this._graphToDisplay.push(this._historyGraph[h]), this._historyGraph[h].setDisplayPosition(i + n, e), this._historyGraph[h].addValue(m, v)), a = i
                        }
                    }
                } this._bufferStats.valuesEnd(), this._valuesMaxWidth = s;
            for (var x = 0; x < this._graphToDisplay.length; x++) {
                var y = this._graphToDisplay[x];
                this._bufferStats.generateGraph(y, r - 2)
            }
            var C = i + n;
            this._graphToDisplay.length && (C += 2 * g.a.maxGraphValue + 1);
            var T = this._viewport.height() - e;
            this._backgroundWidth === C && this._backgroundHeight === T || (this._backgroundWidth = C, this._backgroundHeight = T, this._dirtyCaptions = !0), this._graphToDisplay.length = 0, this._bufferStats.graphsEnd(), this._bufferStats.update()
        },
        _checkCounterDisplayableChanged: function () {
            var e = !1;
            for (var t in this._counters) {
                var i = this._counters[t];
                this._displayableCounters[t] !== i.isDisplayable() && (this._displayableCounters[t] = i.isDisplayable(), e = !0)
            }
            return e
        },
        _checkViewportChanged: function () {
            var e = this._viewport.x(),
                t = this._viewport.y(),
                i = this._viewport.width(),
                n = this._viewport.height();
            if (e !== this._x || t !== this._y || i !== this._width || n !== this._height) {
                this._x = e, this._y = t, this._width = i, this._height = n;
                var r = this._node;
                return f.c.ortho(r.getProjectionMatrix(), this._x, this._width, this._y, this._height, -5, 5), !0
            }
            return !1
        }
    }), t.a = T
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(178),
        a = i(160),
        o = i(138),
        s = i(289),
        u = i(291),
        l = i(36),
        c = i(698),
        h = function () {
            this._usageHint = r.a.DYNAMIC_DRAW;
            this._nbVertexes = 0, this._maxNbVertexes = 0, this._captionNbVertexes = 0, this._valuesNbVertexes = 0, this._graphsNbVertexes = 0, this.resize(6560)
        };
    h.backgroundColor = 10, h.redColor = 7, h.greyColor = 4, h.whiteColor = 1, n.a.createPrototypeObject(h, {
        getGeometry: function () {
            return this._geometry
        },
        generateBackground: function (e, t, i, n) {
            var r = this._vertexes;
            this._nbVertexes += 4, r[0] = e, r[1] = t, r[2] = 0, r[3] = h.backgroundColor;
            var a = e + i,
                o = t + n;
            r[4] = e, r[5] = o, r[6] = 0, r[7] = h.backgroundColor, r[8] = a, r[9] = o, r[10] = 0, r[11] = h.backgroundColor, r[12] = a, r[13] = t, r[14] = 0, r[15] = h.backgroundColor
        },
        generateCharacter: function (e, t, i, n, r, a, o) {
            var s = this._vertexes,
                u = this._nbVertexes;
            this._nbVertexes += 4;
            var l = 4 * u;
            s[l++] = e, s[l++] = t, s[l++] = r, s[l++] = -(0 + o);
            var c = e + i,
                h = t + n;
            s[l++] = e, s[l++] = h, s[l++] = r, s[l++] = -(1 + o), s[l++] = c, s[l++] = h, s[l++] = a, s[l++] = -(1 + o), s[l++] = c, s[l++] = t, s[l++] = a, s[l++] = -(0 + o)
        },
        generateText: function (e, t, i, n, r) {
            var a = i.length;
            this._nbVertexes + 4 * a >= this._maxNbVertexes && this.resize(2 * this._maxNbVertexes);
            for (var o = n._characterSizeUV, s = n._characterWidth, u = n._characterHeight, l = 0; l < a; l++) {
                var c = i.charCodeAt(l),
                    h = n.getCharacterUV(c);
                this.generateCharacter(e, t, s, u, h, h + o, r), e += s
            }
            return a * s
        },
        generateGraph: function (e, t) {
            this._nbVertexes + 2 * c.a.maxGraphValue >= this._maxNbVertexes && this.resize(2 * this._maxNbVertexes);
            var i = this._vertexes,
                n = this._nbVertexes,
                r = e.getValues(),
                a = r.length,
                o = e.getIndex(),
                s = e.getX(),
                u = e.getY();
            this._nbVertexes += 2 * a;
            for (var l = 0; l < a; l++) {
                var d = (o + l) % a,
                    f = r[d],
                    p = n + 2 * l,
                    m = 4 * p,
                    g = f,
                    v = h.greyColor;
                g >= h.redColor && (v = h.redColor, g -= h.redColor), g > 1 && (g = 1), g *= t, g < 1 && (g = 1), i[m] = s + 2 * l, i[m + 1] = u, i[m + 2] = 0, i[m + 3] = v, i[m + 4] = s + 2 * l, i[m + 5] = u + g, i[m + 6] = 0, i[m + 7] = v
            }
        },
        resize: function (e) {
            l.a.log("resize buffer to " + e), this._maxNbVertexes = e;
            var t = new Float32Array(4 * e);
            this._vertexes && t.set(this._vertexes), this._vertexes = t;
            var i = Math.ceil(e / 4);
            this._indexes = new Uint16Array(6 * i);
            for (var n = 0, c = 0; n < i; n++) this._indexes[c++] = 4 * n + 0, this._indexes[c++] = 4 * n + 1, this._indexes[c++] = 4 * n + 3, this._indexes[c++] = 4 * n + 3, this._indexes[c++] = 4 * n + 1, this._indexes[c++] = 4 * n + 2;
            if (this._geometry) return this._geometry.getAttributes().Vertex.setElements(this._vertexes), void this._characterPrimitive.getIndices().setElements(this._indexes);
            this._geometry = new a.a, this._geometry.setName("osgStats-Stats"), this._geometry.getAttributes().Vertex = new r.a(r.a.ARRAY_BUFFER, this._vertexes, 4, !0);
            var h = new r.a(r.a.ELEMENT_ARRAY_BUFFER, this._indexes, 1);
            this._geometry.getAttributes().Vertex.setUsage(this._usageHint);
            var d = new s.a(o.a.TRIANGLES, h);
            this._characterPrimitive = d, this._geometry.getPrimitives().push(this._characterPrimitive);
            var f = new u.a(o.a.LINES, 0, 0);
            this._graphPrimitive = f, this._geometry.getPrimitives().push(this._graphPrimitive)
        },
        update: function () {
            var e = this._captionNbVertexes + this._valuesNbVertexes;
            this._characterPrimitive.setCount(e / 4 * 6), this._graphPrimitive.setCount(this._graphsNbVertexes), this._graphPrimitive.setFirst(e), this._geometry.getAttributes().Vertex.dirty()
        },
        resetCaptions: function () {
            this._nbVertexes = 0, this._captionNbVertexes = 0
        },
        resetValues: function () {
            this._nbVertexes = this._captionNbVertexes, this._valuesNbVertexes = 0, this._graphsNbVertexes = 0
        },
        captionsEnd: function () {
            this._captionNbVertexes = this._nbVertexes
        },
        valuesEnd: function () {
            this._valuesNbVertexes = this._nbVertexes - this._captionNbVertexes
        },
        graphsEnd: function () {
            this._graphsNbVertexes = this._nbVertexes - (this._valuesNbVertexes + this._captionNbVertexes)
        },
        getCharacterPrimitive: function () {
            return this._characterPrimitive
        },
        getGraphPrimitive: function () {
            return this._graphPrimitive
        },
        getNbVertexes: function () {
            return this._nbVertexes
        }
    }), t.a = h
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = window.performance,
        a = function (e) {
            this._caption = e.caption, this._accumValue = 0, this._accumSamples = 0, this._accumStart = 0, this._value = 0, this._averageValue = 0, this._time = 0, this._avgMs = 0, this._over = e.over > 0 ? e.over : 0, this._below = e.below > 0 ? e.below : 0, this._graph = !!e.graph, e.average && (this._avgMs = e.avgMs ? e.avgMs : 1e3), this._display = !1
        };
    n.a.createPrototypeObject(a, {
        isDisplayable: function () {
            return this._display
        },
        setDisplayable: function (e) {
            this._display = e
        },
        getOver: function () {
            return this._over
        },
        getBelow: function () {
            return this._below
        },
        getGraph: function () {
            return this._graph
        },
        getAverageMs: function () {
            return this._avgMs
        },
        getAverageValue: function () {
            return this._averageValue
        },
        getValue: function () {
            return this._value
        },
        average: function (e) {
            if (this._avgMs) {
                this._accumValue += e, this._accumSamples++;
                var t = r.now();
                t - this._accumStart > this._avgMs && (this._averageValue = this._accumValue / this._accumSamples, this._accumValue = 0, this._accumStart = t, this._accumSamples = 0)
            }
        },
        start: function () {
            this._display = !0, this._time = r.now()
        },
        end: function () {
            this._value = r.now() - this._time, this.average(this._value)
        },
        set: function (e) {
            this._display = !0, this._value = e, this.average(e)
        },
        tick: function () {
            this.end(), this.start()
        },
        frame: function () {
            var e = r.now() - this._time;
            this.set(1e3 / e), this.start()
        }
    }), t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(5),
        a = i.n(r),
        o = i(36),
        s = function (e) {
            var t = document.getElementsByTagName("body")[0],
                i = document.createElement("div"),
                n = document.createTextNode("M");
            i.appendChild(n), i.setAttribute("style", e), t.appendChild(i);
            var r = i.offsetHeight;
            return t.removeChild(i), r
        },
        u = function (e) {
            return new a.a(function (t, i) {
                window.WebFontConfig = {
                    google: {
                        families: [e + ":200"]
                    },
                    active: function () {
                        t(e)
                    },
                    inactive: function (e) {
                        i("loadFont error:" + e)
                    }
                };
                var n = document.createElement("script"),
                    r = document.scripts[0];
                n.src = "https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js", n.async = !0, n.onerror = function () {
                    i()
                }, r.parentNode.insertBefore(n, r)
            })
        },
        l = function () {
            this._canvas = void 0, this._characterHeight = 0, this._characterWidth = 0, this._fontSize = 16, this._fontFamily = "Source Code Pro", this._characterFirstCode = " ".charCodeAt(), this._characterLastCode = "z".charCodeAt(), this._characterSizeUV = 0, this._backgroundColor = "rgba(0,0,0,0.0)", this._createCanvas()
        };
    n.a.createPrototypeObject(l, {
        setFontSize: function (e) {
            this._fontSize = e
        },
        getCharacterWidth: function () {
            return this._characterWidth
        },
        getCharacterHeight: function () {
            return this._characterHeight
        },
        getCanvas: function () {
            return this._promise
        },
        getCharacterUV: function (e) {
            return (e - this._characterFirstCode) * this._characterSizeUV
        },
        _fillCanvas: function (e, t) {
            var i = t + "px",
                n = "font-family: " + e + "; font-size: " + i + ";",
                r = s(n);
            o.a.debug(e + " " + i + " ==> " + r + " pixels high."), this._characterHeight = Math.ceil(r);
            var a = t + "px '" + e + "'",
                u = document.createElement("canvas"),
                l = u.getContext("2d");
            this._canvas = u, l.font = a, l.textBaseline = "middle", this._characterWidth = l.measureText(" ").width, this._characterWidth = Math.ceil(this._characterWidth);
            var c = this._characterLastCode - this._characterFirstCode + 1;
            o.a.info("Stats character size " + this._characterWidth + " x " + this._characterHeight + " texture width " + this._characterWidth * c), u.width = Math.ceil(this._characterWidth * c), u.height = this._characterHeight, this._characterSizeUV = this._characterWidth / u.width, l.font = a, l.textBaseline = "middle", l.fillStyle = "rgb(255,255,255)";
            for (var h = this._characterFirstCode, d = 0; h <= this._characterLastCode; h++, d++) {
                var f = String.fromCharCode(h),
                    p = d * this._characterWidth,
                    m = this._characterHeight / 2;
                l.fillText(f, p, m)
            }
            return u
        },
        _createCanvas: function () {
            this._promise = u(this._fontFamily).then(function (e) {
                return this._fillCanvas(e, this._fontSize)
            }.bind(this)).catch(function () {
                return this._fillCanvas("Courier New", this._fontSize)
            }.bind(this))
        }
    }), t.a = l
}, function (e, t, i) {
    "use strict";
    var n = {
            frame: {
                caption: "Total frame time",
                over: 16,
                average: !0,
                graph: !0,
                max: 4
            },
            stats: {
                caption: "stats",
                over: 1,
                graph: !0
            },
            fps: {
                caption: "Framerate (FPS)",
                below: 30,
                average: !0
            },
            raf: {
                caption: "Time since last rAF",
                average: !0,
                avgMs: 500
            },
            update: {
                caption: "update",
                average: !0,
                graph: !0
            },
            cull: {
                caption: "cull",
                average: !0,
                graph: !0,
                max: 16
            },
            render: {
                caption: "render",
                average: !0,
                graph: !0
            },
            glframe: {
                caption: "glframe",
                average: !0,
                graph: !0
            },
            textureused: {
                caption: "texture used"
            },
            texturereserved: {
                caption: "texture reserved"
            },
            texturetotal: {
                caption: "texture total"
            },
            pushstateset: {
                caption: "num pushStateSet"
            },
            applyStateSet: {
                caption: "num applyStateSet"
            },
            updatecallback: {
                caption: "num updateCallback"
            },
            cullcamera: {
                caption: "camera"
            },
            cullmatrixtransform: {
                caption: "matrixTransform"
            },
            cullprojection: {
                caption: "projection"
            },
            cullnode: {
                caption: "node"
            },
            culllightsource: {
                caption: "lightSource"
            },
            cullgeometry: {
                caption: "geometry"
            }
        },
        r = [{
            name: "framerate",
            caption: "Framerate",
            values: ["fps", "raf"]
        }, {
            name: "frameBudget",
            caption: "Frame Budget",
            base: "frame",
            values: ["frame", "update", "cull", "render", "glframe", "stats"]
        }, {
            name: "sceneGraph",
            caption: "Scene Graph ",
            values: ["pushstateset", "updatecallback", "applyStateSet"]
        }, {
            name: "cullVisitor",
            caption: "Cull",
            values: ["cullnode", "cullmatrixtransform", "cullcamera", "culllighsource", "cullprojection", "cullgeometry"]
        }, {
            name: "texture",
            caption: "Texture Memory",
            values: ["texturereserved", "textureused", "texturetotal"]
        }],
        a = {
            values: n,
            groups: r
        };
    t.a = a
}, function (e, t, i) {
    "use strict";
    var n = window.WebGLRenderingContext,
        r = window.WebGL2RenderingContext,
        a = [n, r],
        o = function (e, t) {
            return function () {
                t.apply(this, arguments), e.apply(this, arguments)
            }
        },
        s = 0,
        u = 0,
        l = 0,
        c = 0,
        h = 0,
        d = 0,
        f = 0,
        p = 0,
        m = 0,
        g = 0,
        v = function () {
            for (var e = !1, t = 0; t < a.length; t++) {
                var i = a[t];
                i && (e = !0, i.prototype.drawArrays = o(i.prototype.drawArrays, function () {
                    s++, arguments[0] === this.POINTS ? d += arguments[2] : h += arguments[2]
                }), i.prototype.drawElements = o(i.prototype.drawElements, function () {
                    u++, c += arguments[1] / 3, h += arguments[1]
                }), i.prototype.useProgram = o(i.prototype.useProgram, function () {
                    l++
                }), i.prototype.bindTexture = o(i.prototype.bindTexture, function () {
                    f++
                }))
            }
            return e
        },
        _ = function (e) {
            var t = e.getBufferStats(),
                i = t.getNbVertexes(),
                n = t.getCharacterPrimitive(),
                r = t.getGraphPrimitive();
            u -= 1, r.getCount() && (s -= 1), f -= 2, l -= 1, h -= n.getCount() + r.getCount(), c -= n.getCount() / 3, p = i, m = n.getCount() / 3, g = r.getCount() / 2, e.getCounter("glDrawCalls").set(u + s), e.getCounter("glDrawElements").set(u), e.getCounter("glDrawArrays").set(s), e.getCounter("glBindTexture").set(f), e.getCounter("glUseProgram").set(l), e.getCounter("glFaces").set(c), e.getCounter("glVertices").set(h), e.getCounter("glPoints").set(d), e.getCounter("statsVertices").set(p), e.getCounter("statsFaces").set(m), e.getCounter("statsLines").set(g), p = 0, m = 0, g = 0, s = 0, u = 0, l = 0, c = 0, h = 0, d = 0, f = 0
        }.bind(this),
        b = {
            values: {
                glDrawCalls: {
                    caption: "drawCalls"
                },
                glDrawElements: {
                    caption: "drawElements"
                },
                glDrawArrays: {
                    caption: "drawArrays"
                },
                glBindTexture: {
                    caption: "bindTexture"
                },
                glUseProgram: {
                    caption: "useProgram"
                },
                glFaces: {
                    caption: "totalFaces"
                },
                glVertices: {
                    caption: "totalVertices"
                },
                glPoints: {
                    caption: "totalPoints"
                },
                statsFaces: {
                    caption: "statsFaces"
                },
                statsVertices: {
                    caption: "statsVertices"
                },
                statsLines: {
                    caption: "statsLines"
                }
            },
            groups: [{
                name: "webgl",
                caption: "WebGL",
                values: ["glDrawCalls", "glDrawElements", "glDrawArrays", "glUseProgram", "glBindTexture", "glFaces", "glVertices", "glPoints", "statsVertices", "statsFaces", "statsLines"]
            }],
            update: _,
            init: v
        };
    t.a = b
}, function (e, t, i) {
    "use strict";
    var n = i(36),
        r = void 0,
        a = Math.log(1024),
        o = function (e) {
            var t = Math.floor(Math.log(e) / a);
            return 0 === e && (t = 1), Math.round(100 * e / Math.pow(1024, t)) / 100
        },
        s = function () {
            return window.performance && window.performance.memory && (r = window.performance.memory), r && 0 !== r.totalJSHeapSize || n.a.warn("Stats will not report memory, not supported by your browse"), !!r
        },
        u = function (e) {
            var t = 0,
                i = 0;
            r && (t = o(r.usedJSHeapSize), i = o(r.totalJSHeapSize)), e.getCounter("browserMemory").set(t), e.getCounter("browserMemoryTotal").set(i)
        },
        l = {
            values: {
                browserMemory: {
                    caption: "Used Memory",
                    average: !0,
                    avgMs: 1e3
                },
                browserMemoryTotal: {
                    caption: "Total Memory"
                }
            },
            groups: [{
                name: "browser",
                caption: "Browser",
                values: ["browserMemory", "browserMemoryTotal"]
            }],
            update: u,
            init: s
        };
    t.a = l
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(92),
        a = function (e, t) {
            r.a.call(this), this._enable = !e, this._shadowReceiveAttribute = t, this._dirtyHash = !0, this._hash = ""
        };
    n.a.createPrototypeStateAttribute(a, n.a.objectInherit(r.a.prototype, {
        attributeType: "ShadowCast",
        cloneType: function () {
            return new a(!0)
        },
        setReceiveAttribute: function (e) {
            this._shadowReceiveAttribute = e
        },
        getReceiveAttribute: function () {
            return this._shadowReceiveAttribute
        },
        getDefines: function () {
            return this._shadowReceiveAttribute.getDefines()
        },
        _computeInternalHash: function () {
            return "ShadowCast" + this._enable + this._shadowReceiveAttribute.getPrecision()
        },
        getHash: function () {
            return this._shadowReceiveAttribute && this._shadowReceiveAttribute._dirtyHash && (this._receiveAttributeDirty = !0), this._dirtyHash ? (this._hash = this._computeInternalHash(), this._dirtyHash = !1, this._hash) : this._hash
        },
        isEnabled: function () {
            return this._enable
        }
    }), "osgShadow", "ShadowCastAttribute"), t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(362),
        r = i(197),
        a = i(365),
        o = i(619),
        s = i(683),
        u = i(84),
        l = i(12),
        c = function (e) {
            u.a.call(this), this._noCastMask = e, this._nodeList = []
        };
    l.a.createPrototypeObject(c, l.a.objectInherit(u.a.prototype, {
        reset: function () {
            this._nodeList = []
        },
        removeNodeFromCasting: function (e) {
            var t = e.getNodeMask(); - 1 === t ? (t = this._noCastMask, e.setNodeMask(t), this._nodeList.push(e)) : 0 != (t & ~this._noCastMask) && (e.setNodeMask(t | this._noCastMask), this._nodeList.push(e))
        },
        apply: function (e) {
            var t = e.getStateSet();
            if (t) {
                var i = t.getAttribute("BlendFunc");
                if (void 0 !== i && i.getSource() !== n.a.DISABLE) {
                    var u = t.getAttribute("Depth");
                    if (u && (u.getFunc() === a.a.DISABLE || !1 === u.getWriteMask())) return void this.removeNodeFromCasting(e)
                }
            }
            return e.getTypeID() === o.a.typeID || e.getTypeID() === s.a.typeID ? void this.removeNodeFromCasting(e) : e.getTypeID() === r.a.typeID && e.isRenderToTextureCamera() ? void this.removeNodeFromCasting(e) : void this.traverse(e)
        },
        setNoCastMask: function (e) {
            this._noCastMask = e
        },
        restore: function () {
            for (var e = 0, t = this._nodeList.length; e < t; e++) {
                var i = this._nodeList[e],
                    n = i.getNodeMask();
                n === this._noCastMask ? i.setNodeMask(-1) : i.setNodeMask(n & ~this._noCastMask)
            }
        }
    }), "osgShadow", "ShadowCasterVisitor"), t.a = c
}, function (e, t, i) {
    "use strict";
    var n = i(197),
        r = i(574),
        a = i(362),
        o = i(365),
        s = i(363),
        u = i(10),
        l = i(198),
        c = i(36),
        h = i(407),
        d = i(92),
        f = i(288),
        p = i(889),
        m = i(118),
        g = i(316),
        v = i(108),
        _ = i(12),
        b = i(138),
        S = i(421),
        x = i(319),
        y = i(905),
        C = i(902),
        T = i(699),
        w = i(700),
        M = i(688),
        E = function (e) {
            this._shadowTechnique = e
        };
    _.a.createPrototypeObject(E, {
        cull: function (e, t) {
            this._shadowTechnique.getShadowedScene().nodeTraverse(t);
            var i = t.getCurrentCullingSet(),
                n = t.getCurrentProjectionMatrix(),
                r = t.getComputedNear(),
                a = t.getComputedFar();
            return r === 1 / 0 && a === -1 / 0 ? (this._shadowTechnique.markSceneAsNoShadow(), !1) : (u.c.getFrustumPlanes(i.getFrustum().getPlanes(), n, t.getCurrentModelViewMatrix(), !1), i.getFrustum().setupMask(6), this._shadowTechnique.setLightFrustum(i.getFrustum(), r, a), !1)
        }
    }, "osgShadow", "CameraCullCallback");
    var A = function (e, t) {
        T.a.call(this), this._projectionMatrix = u.c.create(), this._projection = u.f.create(), this._viewMatrix = u.c.create(), this._lightNumberArrayIndex = -1, this._lightUp = u.f.fromValues(0, 0, 1), this._light = e.light, this._cameraShadow = new n.a, this._cameraShadow.setCullCallback(new E(this)), this._cameraShadow.setRenderOrder(n.a.PRE_RENDER, 0), this._cameraShadow.setReferenceFrame(g.a.ABSOLUTE_RF), this._cameraShadow.setClearColor(u.g.fromValues(1, 1, 1, 1)), t ? this._texture = t : (this._texture = new w.a, this._textureUnitBase = 4, this._textureUnit = this._textureUnitBase, this._textureMagFilter = void 0, this._textureMinFilter = void 0), this._textureSize = 256;
        var i = v.a.createFloat2("RenderSize");
        this._texelSizeUniform = v.a.createFloat1(1 / this._textureSize, "texelSize"), this._renderSize = i.getInternalArray(), this._renderSize[0] = this._renderSize[1] = this._textureSize, this._receivingStateset = void 0, this._casterStateSet = new f.a, this._casterStateSet.addUniform(v.a.createFloat1(0, "exponent0")), this._casterStateSet.addUniform(v.a.createFloat1(0, "exponent1")), this._casterStateSet.addUniform(v.a.createFloat1(.005, "bias")), this._casterStateSet.addUniform(this._texelSizeUniform), this._casterStateSet.addUniform(i), this._casterStateSet.setAttributeAndModes(new o.a(o.a.LESS), d.a.ON | d.a.OVERRIDE), this._casterStateSet.setAttributeAndModes(new a.a, d.a.ON | d.a.OVERRIDE), this._shadowReceiveAttribute = new y.a(this._light.getLightNumber()), this._casterStateSet.setAttributeAndModes(this._shadowReceiveAttribute, d.a.ON | d.a.OVERRIDE), this._shadowCastShaderGeneratorName = "ShadowCast";
        var r = v.a.createFloat4("uShadowDepthRange");
        this._casterStateSet.addUniform(r), this._depthRange = r.getInternalArray(), this._depthRange[0] = .001, this._depthRange[1] = 1e3, this._worldLightPos = u.g.create(), this._worldLightPos[3] = 0, this._worldLightDir = u.g.create(), this._worldLightDir[3] = 1, this._castsShadowDrawTraversalMask = 4294967295, this._castsShadowBoundsTraversalMask = 4294967295, this._tmpVec = u.f.create(), this._tmpVecBis = u.f.create(), this._tmpVecTercio = u.f.create(), this._tmpMatrix = u.c.create(), e && this.setShadowSettings(e), this._infiniteFrustum = !0;
        var s = new C.a(!1, this._shadowReceiveAttribute);
        this._casterStateSet.setAttributeAndModes(s, d.a.ON | d.a.OVERRIDE), this._casterStateSet.setShaderGeneratorName(this._shadowCastShaderGeneratorName, d.a.OVERRIDE | d.a.ON), this._debug = !1
    };
    _.a.createPrototypeObject(A, _.a.objectInherit(T.a.prototype, {
        getDepthRange: function () {
            return this._depthRange
        },
        setLightFrustum: function (e, t, i) {
            this._lightFrustum = e, this._depthRange[0] = t, this._depthRange[1] = i, this.nearFarBounding(), this._debug && (this._debugGeomFrustum.updateGeometry(this._projectionMatrix, this._depthRange), u.c.invert(this._debugNodeFrustum.getMatrix(), this._viewMatrix))
        },
        getCamera: function () {
            return this._cameraShadow
        },
        getTexture: function () {
            return this._texture
        },
        isDirty: function () {
            return this._dirty
        },
        setTextureUnitBase: function (e) {
            this._textureUnitBase = e, this._textureUnit = e
        },
        setShadowSettings: function (e) {
            e && (this._light = e.light, this._shadowCastShaderGeneratorName = e.getShadowCastShaderGeneratorName(), this.setCastsShadowDrawTraversalMask(e.castsShadowDrawTraversalMask), this.setCastsShadowBoundsTraversalMask(e.castsShadowBoundsTraversalMask), this.setLight(this._light), this.setTextureSize(e.textureSize), this.setTexturePrecision(e.textureType), this.setKernelSizePCF(e.kernelSizePCF), this.setBias(e.bias), this.setNormalBias(e.normalBias))
        },
        setCastsShadowDrawTraversalMask: function (e) {
            this._castsShadowDrawTraversalMask = e
        },
        getCastsShadowDrawTraversalMask: function () {
            return this._castsDrawShadowTraversalMask
        },
        setCastsShadowBoundsTraversalMask: function (e) {
            this._castsShadowBoundsTraversalMask = e
        },
        getCastsShadowBoundsTraversalMask: function () {
            return this._castsShadowBoundsTraversalMask
        },
        getNormalBias: function () {
            return this._shadowReceiveAttribute.getNormalBias()
        },
        setNormalBias: function (e) {
            this._shadowReceiveAttribute.setNormalBias(e)
        },
        getJitterOffset: function () {
            return this._shadowReceiveAttribute.getJitterOffset()
        },
        setJitterOffset: function (e) {
            this._shadowReceiveAttribute.setJitterOffset(e)
        },
        getBias: function () {
            return this._shadowReceiveAttribute.getBias()
        },
        setBias: function (e) {
            this._shadowReceiveAttribute.setBias(e), this._casterStateSet.getUniformList().bias.getUniform().setFloat(e)
        },
        getKernelSizePCF: function () {
            return this._shadowReceiveAttribute.getKernelSizePCF()
        },
        setKernelSizePCF: function (e) {
            this._shadowReceiveAttribute.setKernelSizePCF(e)
        },
        setShadowedScene: function (e) {
            T.a.prototype.setShadowedScene.call(this, e), this._receivingStateset = this._shadowedScene.getReceivingStateSet(), this.dirty()
        },
        checkLightNumber: function () {
            var e = this._light.getLightNumber();
            this._shadowReceiveAttribute.getLightNumber() !== e && this._receivingStateset.getAttribute(this._shadowReceiveAttribute.getTypeMember()) === this._shadowReceiveAttribute && this._receivingStateset.removeAttribute(this._shadowReceiveAttribute.getTypeMember()), this._texture && !this._texture.hasLightNumber(e) && this._receivingStateset.getTextureAttribute(this._textureUnit, this._texture.getTypeMember()) === this._texture && this._receivingStateset.removeTextureAttribute(this._textureUnit, this._texture.getTypeMember())
        },
        _rebindFbo: function () {
            this._cameraShadow.detachAll(), this._cameraShadow.attachTexture(s.a.COLOR_ATTACHMENT0, this._texture), this._cameraShadow.attachRenderBuffer(s.a.DEPTH_ATTACHMENT, s.a.DEPTH_COMPONENT16)
        },
        init: function (e, t, i) {
            if (this._shadowedScene) {
                this._needRedraw = !0, this.checkLightNumber();
                var n = this._light.getLightNumber();
                e ? (this._texture = e, this._lightNumberArrayIndex = t, this._textureUnit = i, this._shadowReceiveAttribute.setAtlas(!0)) : (this.initTexture(), this._rebindFbo(), this._textureUnit = this._textureUnitBase + n, this._texture.setLightNumber(n), this._texture.setName("ShadowTexture" + this._textureUnit), this._shadowReceiveAttribute.setAtlas(!1)), this._cameraShadow.setName("light_shadow_camera" + this._light.getName()), this._shadowReceiveAttribute.setLightNumber(n);
                var r = d.a.OVERRIDE | d.a.ON;
                this._receivingStateset.setAttributeAndModes(this._shadowReceiveAttribute, r), this._preventTextureBindingDuringShadowCasting(), this._casterStateSet.setTextureAttributeAndModes(this._textureUnit, m.default.textureNull, d.a.PROTECTED), this._receivingStateset.setTextureAttributeAndModes(this._textureUnit, this._texture, r), this._dirty = !1
            }
        },
        _preventTextureBindingDuringShadowCasting: function () {
            for (var e = x.a.instance().getWebGLParameter("MAX_TEXTURE_IMAGE_UNITS"), t = 0; t < e; t++) this._casterStateSet.setTextureAttributeAndModes(t, m.default.textureNull, d.a.OVERRIDE | d.a.ON)
        },
        valid: function () {
            return !0
        },
        updateShadowTechnique: function (e, t, i) {
            var n = this._cameraShadow,
                r = this._texture;
            if (n && r) {
                var a = n.getViewport();
                if (a || (a = new S.a, n.setViewport(a)), t) {
                    var o = n.getScissor();
                    o || (o = new M.a(t[0], t[1], t[2], t[3]), n.setScissor(o)), a.x() === t[0] && a.y() === t[1] && a.width() === t[2] && a.height() === t[3] || (n.setFrameBufferObject(i), a.setViewport(t[0], t[1], t[2], t[3]), o.setScissor(t[0], t[1], t[2], t[3]))
                } else a.width() === r.getWidth() && a.height() === r.getHeight() || (this._rebindFbo(), a.setViewport(0, 0, r.getWidth(), r.getHeight()))
            }
        },
        updateShadowTechnic: function () {
            c.a.log("ShadowMap.updateShadowTechnic() is deprecated, use updateShadowTechnique instead"), this.updateShadowTechnique()
        },
        setTextureFiltering: function () {
            var e;
            switch (this.getTexturePrecision()) {
                case "HALF_FLOAT":
                    e = m.default.HALF_FLOAT;
                    break;
                case "FLOAT":
                    e = m.default.FLOAT;
                    break;
                default:
                case "UNSIGNED_BYTE":
                    e = m.default.UNSIGNED_BYTE
            }
            this._texture.setInternalFormatType(e), this._texture.setMinFilter(m.default.NEAREST), this._texture.setMagFilter(m.default.NEAREST), this._textureMagFilter = m.default.NEAREST, this._textureMinFilter = m.default.NEAREST
        },
        initTexture: function () {
            if (this._dirty) {
                this._texture || (this._texture = new w.a, this._textureUnit = this._textureUnitBase), this._texture.setTextureSize(this._textureSize, this._textureSize), this._texelSizeUniform.setFloat(1 / this._textureSize), this._renderSize[0] = this._textureSize, this._renderSize[1] = this._textureSize;
                var e;
                e = m.default.RGBA, this.setTextureFiltering(), this._texture.setInternalFormat(e), this._texture.setWrapS(m.default.CLAMP_TO_EDGE), this._texture.setWrapT(m.default.CLAMP_TO_EDGE), this._texture.dirty()
            }
        },
        setTexturePrecision: function (e) {
            e !== this._shadowReceiveAttribute.getPrecision() && (this._shadowReceiveAttribute.setPrecision(e), this.dirty())
        },
        getTexturePrecision: function () {
            return this._shadowReceiveAttribute.getPrecision()
        },
        setTextureSize: function (e) {
            e !== this._textureSize && (this._textureSize = e, this.dirty())
        },
        getCasterStateSet: function () {
            return this._casterStateSet
        },
        setLight: function (e) {
            e && e !== this._light && (this._light = e, this.dirty())
        },
        getUp: function (e) {
            return Math.abs(u.f.dot(this._lightUp, e)) >= 1 && (1 === this._lightUp[0] ? (this._lightUp[0] = 0, this._lightUp[1] = 1, this._lightUp[2] = 0) : (this._lightUp[0] = 1, this._lightUp[1] = 0, this._lightUp[2] = 0)), this._lightUp
        },
        nearFarBounding: function () {
            var e = this._depthRange[0],
                t = this._depthRange[1],
                i = A.EPSILON;
            t < e - i ? (this._emptyCasterScene = !0, t = 1, e = i) : e < i && (e = i), this._depthRange[0] = e, this._depthRange[1] = t
        },
        makePerspectiveFromBoundingBox: function (e, t, i, n, r, a) {
            var o = e.center(this._tmpVec),
                s = e.radius(),
                l = A.EPSILON,
                c = l,
                h = 1;
            this._radius = s;
            var d = u.f.distance(o, i);
            d <= s ? (c = l, h = d + s) : (c = d - s, h = d + s), this._depthRange[0] = c, this._depthRange[1] = h, this.nearFarBounding();
            var f = this._depthRange[0] * Math.tan(t * Math.PI / 180);
            f = f > s ? s : f;
            var p = f,
                m = -p,
                g = f,
                v = -g,
                _ = this.getUp(n);
            this._infiniteFrustum ? u.c.infiniteFrustum(a, v, g, m, p, this._depthRange[0]) : u.c.frustum(a, v, g, m, p, this._depthRange[0], this._depthRange[1]), this._projection[0] = this._projectionMatrix[0], this._projection[1] = this._projectionMatrix[5], this._projection[2] = 0, u.c.lookAtDirection(r, i, n, _)
        },
        makeOrthoFromBoundingBox: function (e, t, i, n) {
            var r = e.center(this._tmpVecTercio),
                a = e.radius(),
                o = a + a,
                s = 1e-4,
                l = o + 1e-4,
                c = this._tmpVec;
            u.f.scaleAndAdd(c, r, t, -o), s = a, l += a;
            s < .001 * l && (s = .001 * l);
            var h = this.getUp(t);
            u.c.lookAtDirection(i, c, t, h);
            var d, f;
            f = a, d = f, u.c.ortho(n, -d, d, -f, f, s, l), this._projection[0] = d, this._projection[1] = f, this._projection[2] = 1, this._depthRange[0] = s, this._depthRange[1] = l
        },
        aimShadowCastingCamera: function (e, t) {
            var i = this._light;
            if (!i) return void(this._emptyCasterScene = !0);
            var n = this._cameraShadow,
                r = this._worldLightPos,
                a = this._worldLightDir;
            u.c.copy(this._projectionMatrix, n.getProjectionMatrix()), u.c.copy(this._viewMatrix, n.getViewMatrix());
            for (var o, s = this._projectionMatrix, l = this._viewMatrix, h = e.getCurrentRenderBin().getPositionedAttribute(), d = h.getArray(), f = 0; f < h.getLength(); f++) {
                var p = d[f],
                    m = p[1],
                    g = p[0];
                if (m === i) {
                    o = g;
                    break
                }
            }
            if (void 0 === o) return c.a.warn("light isnt inside children of shadowedScene Node"), void(this._emptyCasterScene = !0);
            var v = this._tmpMatrix;
            if (u.c.invert(v, e.getCurrentModelViewMatrix()), this._light.isDirectionLight()) u.g.transformMat4(r, i.getPosition(), o), u.g.transformMat4(r, r, v), u.f.scale(r, r, -1), u.f.normalize(r, r), this.makeOrthoFromBoundingBox(t, r, l, s), this._debug && u.c.invert(this._debugNodeFrustum.getMatrix(), l);
            else {
                u.c.mul(this._tmpMatrix, v, o);
                var _ = this._tmpMatrix;
                u.f.transformMat4(r, i.getPosition(), _), _[12] = 0, _[13] = 0, _[14] = 0, u.c.invert(_, _), u.c.transpose(_, _), u.f.copy(a, i.getDirection()), u.g.transformMat4(a, a, _), u.f.normalize(a, a), this.makePerspectiveFromBoundingBox(t, i.getSpotCutoff(), r, a, l, s)
            }
            u.c.copy(n.getProjectionMatrix(), this._projectionMatrix), u.c.copy(n.getViewMatrix(), this._viewMatrix)
        },
        frameShadowCastingFrustum: function (e) {
            this._infiniteFrustum || r.a.prototype.clampProjectionMatrix(this._projectionMatrix, this._depthRange[0], this._depthRange[1], e.getNearFarRatio(), this._depthRange);
            var t = this._cameraShadow;
            u.c.copy(t.getProjectionMatrix(), this._projectionMatrix), u.c.copy(t.getViewMatrix(), this._viewMatrix), this.setShadowUniformsReceive(!1)
        },
        setShadowUniformsReceive: function (e) {
            if (e && u.e.set(this._depthRange, 0, 0), -1 !== this._lightNumberArrayIndex) {
                var t = this._light.getLightNumber();
                this._texture.setViewMatrix(t, this._viewMatrix), this._texture.setProjection(t, this._projection), this._texture.setDepthRange(t, this._depthRange)
            } else this._texture.setViewMatrix(this._viewMatrix), this._texture.setProjection(this._projection), this._texture.setDepthRange(this._depthRange)
        },
        markSceneAsNoShadow: function () {
            this.setShadowUniformsReceive(!0), this._needRedraw = !1
        },
        cullShadowCasting: function (e, t) {
            if (this._debug) {
                var i = t.getMin(),
                    n = t.getMax();
                t.center(this._tmpVec);
                var r = this._debugNodeSceneCast.getMatrix();
                u.c.fromScaling(r, [n[0] - i[0], n[1] - i[1], n[2] - i[2], 1]), u.c.setTranslation(r, this._tmpVec)
            }
            if (this._emptyCasterScene = !1, this.aimShadowCastingCamera(e, t), this._emptyCasterScene) return void this.markSceneAsNoShadow();
            var a = e.getTraversalMask();
            e.setTraversalMask(this._castsShadowDrawTraversalMask), e.pushStateSet(this._casterStateSet), this._cameraShadow.setEnableFrustumCulling(!0), this._cameraShadow.setComputeNearFar(!0), this._debug && this._debugNode.accept(e), this._cameraShadow.accept(e), this.nearFarBounding(), this.frameShadowCastingFrustum(e), this._cameraShadow.setComputeNearFar(!1), e.popStateSet(), e.setTraversalMask(a), this._needRedraw = !1
        },
        cleanReceivingStateSet: function (e) {
            if (this._receivingStateset) {
                if (this._receivingStateset.getAttribute(this._shadowReceiveAttribute.getTypeMember()) === this._shadowReceiveAttribute && this._receivingStateset.removeAttribute(this._shadowReceiveAttribute.getTypeMember()), e) return;
                this._texture && this._receivingStateset.getTextureAttribute(this._textureUnit, this._texture.getTypeMember()) === this._texture && this._receivingStateset.removeTextureAttribute(this._textureUnit, this._texture.getTypeMember())
            }
        },
        cleanSceneGraph: function (e) {
            this._needRedraw = !0, this.cleanReceivingStateSet(e), this._texture = void 0, this._shadowedScene = void 0
        },
        setDebug: function (e) {
            e && !this._debug && (this._debugNode || (this._debugGeomFrustum = p.a.createDebugFrustumGeometry(), this._debugGeomSceneCast = h.a.createBoundingBoxGeometry(), this._debugGeomSceneCast.getPrimitives()[0].mode = b.a.LINES, this._debugNode = new l.a, this._debugNodeFrustum = new l.a, this._debugNodeSceneCast = new l.a, this._debugNodeFrustum.addChild(this._debugGeomFrustum), this._debugNodeSceneCast.addChild(this._debugGeomSceneCast), this._debugNode.addChild(this._debugNodeFrustum), this._debugNode.addChild(this._debugNodeSceneCast))), this._debug = e
        },
        getDebug: function () {
            return this._debug
        },
        getLightNumber: function () {
            return this._light.getLightNumber()
        },
        getLight: function () {
            return this._light
        }
    }), "osgShadow", "ShadowMap"), A.EPSILON = .005, t.a = A
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(92),
        a = i(108),
        o = function (e, t) {
            r.a.call(this), this._lightNumber = e, this._bias = .001, this._normalBias = void 0, this._precision = "UNSIGNED_BYTE", this._kernelSizePCF = void 0, this._fakePCF = !0, this._jitterOffset = "none", this._enable = !t, this._isAtlasTexture = !1, this._dirtyHash = !0, this._hash = ""
        };
    o.uniforms = {}, n.a.createPrototypeStateAttribute(o, n.a.objectInherit(r.a.prototype, {
        attributeType: "ShadowReceive",
        cloneType: function () {
            return new o(this._lightNumber, !0)
        },
        getTypeMember: function () {
            return this.attributeType + this.getLightNumber()
        },
        getLightNumber: function () {
            return this._lightNumber
        },
        getUniformName: function (e) {
            return "u" + (this.getType() + this.getLightNumber().toString()) + "_" + e
        },
        getAtlas: function () {
            return this._isAtlasTexture
        },
        setAtlas: function (e) {
            this._isAtlasTexture = e
        },
        setBias: function (e) {
            this._bias = e
        },
        getBias: function () {
            return this._bias
        },
        setNormalBias: function (e) {
            this._normalBias = e
        },
        getNormalBias: function () {
            return this._normalBias
        },
        setJitterOffset: function (e) {
            this._jitterOffset = e
        },
        getJitterOffset: function () {
            return this._jitterOffset
        },
        getKernelSizePCF: function () {
            return this._kernelSizePCF
        },
        setKernelSizePCF: function (e) {
            this._kernelSizePCF = e, this._dirtyHash = !0
        },
        setPrecision: function (e) {
            this._precision = e, this._dirtyHash = !0
        },
        getPrecision: function () {
            return this._precision
        },
        setLightNumber: function (e) {
            this._lightNumber = e, this._dirtyHash = !0
        },
        getOrCreateUniforms: function () {
            var e = o,
                t = this.getTypeMember();
            return e.uniforms[t] ? e.uniforms[t] : (e.uniforms[t] = {
                bias: a.a.createFloat(this.getUniformName("bias")),
                normalBias: a.a.createFloat(this.getUniformName("normalBias"))
            }, e.uniforms[t])
        },
        getDefines: function () {
            var e = [];
            switch (this.getKernelSizePCF()) {
                case "4Tap(16texFetch)":
                    e.push("#define _PCFx4");
                    break;
                case "9Tap(36texFetch)":
                    e.push("#define _PCFx9");
                    break;
                case "16Tap(64texFetch)":
                    e.push("#define _PCFx25");
                    break;
                default:
                case "1Tap(4texFetch)":
                    e.push("#define _PCFx1")
            }
            return "UNSIGNED_BYTE" !== this.getPrecision() && e.push("#define _FLOATTEX"), this.getAtlas() && e.push("#define _ATLAS_SHADOW"), this.getNormalBias() && e.push("#define _NORMAL_OFFSET"), "none" !== this.getJitterOffset() && e.push("#define _JITTER_OFFSET"), e
        },
        apply: function () {
            if (this._enable) {
                var e = this.getOrCreateUniforms();
                e.normalBias.setFloat(this._normalBias), e.bias.setFloat(this._bias)
            }
        },
        isEnabled: function () {
            return this._enable
        },
        getHash: function () {
            return this._dirtyHash ? (this._hash = this._computeInternalHash(), this._dirtyHash = !1, this._hash) : this._hash
        },
        _computeInternalHash: function () {
            return this.getTypeMember() + "_" + this.getKernelSizePCF()
        }
    }), "osgShadow", "ShadowReceiveAttribute"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(36),
        r = i(118),
        a = i(700),
        o = i(108),
        s = i(12),
        u = i(10),
        l = function () {
            r.default.call(this), this._uniforms = {}, this._lightNumberArray = [], this._viewMatrices = [], this._projection = [], this._depthRanges = [], this._mapSizes = [], this._renderSize = u.e.create(), this._dirtyHash = !0, this._hash = ""
        };
    l.uniforms = {}, s.a.createPrototypeStateAttribute(l, s.a.objectInherit(r.default.prototype, {
        cloneType: function () {
            return new l
        },
        getLightNumberArray: function () {
            return this._lightNumberArray
        },
        hasLightNumber: function (e) {
            return -1 !== this._lightNumberArray.indexOf(e)
        },
        setLightNumberArray: function (e) {
            this._lightNumberArray = e, this._dirtyHash = !0
        },
        getUniformName: function (e, t) {
            return "uShadow_" + this.getType() + e.toString() + "_" + t
        },
        setInternalFormatType: function (e) {
            r.default.prototype.setInternalFormatType.call(this, e), this._dirtyHash = !0
        },
        createUniforms: function (e, t) {
            t["ViewRight_" + e] = o.a.createFloat4(this.getUniformName(e, "viewRight")), t["ViewUp_" + e] = o.a.createFloat4(this.getUniformName(e, "viewUp")), t["ViewLook_" + e] = o.a.createFloat4(this.getUniformName(e, "viewLook")), t["Projection_" + e] = o.a.createFloat3(this.getUniformName(e, "projection")), t["DepthRange_" + e] = o.a.createFloat2(this.getUniformName(e, "depthRange")), t["MapSize_" + e] = o.a.createFloat4(this.getUniformName(e, "mapSize")), t["RenderSize_" + e] = t.RenderSize
        },
        getOrCreateUniforms: function (e) {
            var t = l;
            if (n.a.assert(void 0 !== e || 0 !== this._lightNumberArray.length), void 0 !== t.uniforms[e]) return t.uniforms[e];
            var i = t.uniforms[e] = {},
                r = o.a.createFloat2(this.getUniformName(0, "renderSize"));
            i.RenderSize = r;
            for (var a = 0, s = this._lightNumberArray.length; a < s; a++) this.createUniforms(this._lightNumberArray[a], i);
            var u = "Texture" + e,
                c = o.a.createInt1(e, u);
            return i[u] = c, t.uniforms[e]
        },
        setViewMatrix: function (e, t) {
            this._viewMatrices[e] = t
        },
        setProjection: function (e, t) {
            this._projection[e] = t
        },
        setDepthRange: function (e, t) {
            this._depthRanges[e] = t
        },
        setLightShadowMapSize: function (e, t) {
            this._mapSizes[e] = t
        },
        apply: function (e, t) {
            if (r.default.prototype.apply.call(this, e, t), 0 !== this._lightNumberArray.length) {
                for (var i = this.getOrCreateUniforms(t), n = 0, o = this._lightNumberArray.length; n < o; n++) {
                    var s = this._lightNumberArray[n];
                    i["ViewRight_" + s] || this.createUniforms(s, i), a.a.prototype._updateViewMatrixUniforms.call(this, this._viewMatrices[s], i["ViewRight_" + s], i["ViewUp_" + s], i["ViewLook_" + s]), i["Projection_" + s].setFloat3(this._projection[s]), i["DepthRange_" + s].setFloat2(this._depthRanges[s]), i["MapSize_" + s].setFloat4(this._mapSizes[s])
                }
                i.RenderSize.setFloat2(this._renderSize)
            }
        },
        setTextureSize: function (e, t) {
            this._renderSize[0] = 1 / e, this._renderSize[1] = 1 / t, r.default.prototype.setTextureSize.call(this, e, t), this.dirty()
        },
        _computeInternalHash: function () {
            for (var e = this.getTypeMember(), t = 0, i = this._lightNumberArray.length; t < i; t++) e += "_" + this._lightNumberArray[t];
            return e += "_" + this._type
        },
        getHash: function () {
            return this._dirtyHash ? (this._hash = this._computeInternalHash(), this._dirtyHash = !1, this._hash) : this._hash
        }
    }), "osgShadow", "ShadowTextureAtlas"), t.a = l
}, function (e, t, i) {
    "use strict";
    i.d(t, "b", function () {
        return u
    }), i.d(t, "a", function () {
        return s
    });
    var n = i(163),
        r = i(34),
        a = !0,
        o = 0,
        s = function (e) {
            a = e
        },
        u = function (e) {
            var t, s, u, l, c, h, d, f, p, m = function () {
                t = e.osg.WebGLCaps.instance(), s = t.getWebGLParameter("UNMASKED_RENDERER_WEBGL"), u = t.getWebGLParameter("UNMASKED_VENDOR_WEBGL"), l = t.getWebGLParameter("MAX_VARYING_VECTORS"), c = t.getWebGLParameter("MAX_VERTEX_ATTRIBS"), h = t.getWebGLParameter("MAX_FRAGMENT_UNIFORM_VECTORS"), d = t.getWebGLParameter("MAX_VERTEX_UNIFORM_VECTORS"), f = i(38), p = f.apple.device
            };
            e.osg.Program.registerErrorCallback(function (e, i, f) {
                if (a) {
                    if (!(!f || 0 === f.length) && -1 === f.indexOf("Internal linking error")) {
                        t || m();
                        var g = "Shader Error: ";
                        if (g += f, !p)
                            if (s && (g += "\n" + s), u && (g += "\n" + u), 30 !== l && (g += "\nVarying: " + l), e && (16 !== c && (g += "\nAttributes:" + c), 4096 !== d && (g += "\nVertUnif:" + d)), 1024 !== h && (g += "\nFragUnif:" + h), t.isWebGL2()) g += "\nWebGL2";
                            else {
                                var v, _ = t.getWebGLExtensions(),
                                    b = ["EXT_shader_texture_lod", "OES_standard_derivatives", "OES_vertex_array_object", "EXT_texture_filter_anisotropic"];
                                for (v = 0; v < b.length; v++) {
                                    var S = b[v];
                                    _[S] && (g += "\n" + S.substring(S.indexOf("_") + 1))
                                }
                                var x = ["hasLinearFloatRTT", "hasLinearHalfFloatRTT", "hasHalfFloatRTT", "hasFloatRTT"];
                                for (v; v < x.length; v++) {
                                    var y = x[v];
                                    t[y]() && (g += "\n" + y.substring(3))
                                }
                            } e && (g += "\nVS\n" + e), i && (g += "\nFS\n " + i);
                        var C = "errorLogs ";
                        h < 64 && (C = "ultraLowGPU");
                        var T = {
                            tags: {
                                shaderErrors: C
                            }
                        };
                        if (n.a.client.captureMessage(g, T), o++, o > 2 && (a = !1), o > 1) {
                            var w = new r.default({
                                title: "3D/WebGL context error",
                                text: "An error occurred while rendering the model. It might not look as expected.",
                                safe: !0,
                                buttons: {
                                    continue: !0,
                                    continueLabel: "OK",
                                    cancel: !1
                                }
                            });
                            w.open().then(function () {
                                w.close()
                            }.bind(this))
                        }
                    }
                }
            })
        }
}, function (e, t, i) {
    "use strict";

    function n(e) {
        r.copy(e, this)
    }
    var r = i(455);
    e.exports = n
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t) {
        t || (t = {}), "function" == typeof t && (t = {
            cmp: t
        });
        var i = "boolean" == typeof t.cycles && t.cycles,
            n = t.cmp && function (e) {
                return function (t) {
                    return function (i, n) {
                        var r = {
                                key: i,
                                value: t[i]
                            },
                            a = {
                                key: n,
                                value: t[n]
                            };
                        return e(r, a)
                    }
                }
            }(t.cmp),
            r = [];
        return function e(t) {
            if (t && t.toJSON && "function" == typeof t.toJSON && (t = t.toJSON()), void 0 !== t) {
                if ("number" == typeof t) return isFinite(t) ? "" + t : "null";
                if ("object" != typeof t) return JSON.stringify(t);
                var a, o;
                if (Array.isArray(t)) {
                    for (o = "[", a = 0; a < t.length; a++) a && (o += ","), o += e(t[a]) || "null";
                    return o + "]"
                }
                if (null === t) return "null";
                if (-1 !== r.indexOf(t)) {
                    if (i) return JSON.stringify("__cycle__");
                    throw new TypeError("Converting circular structure to JSON")
                }
                var s = r.push(t) - 1,
                    u = Object.keys(t).sort(n && n(t));
                for (o = "", a = 0; a < u.length; a++) {
                    var l = u[a],
                        c = e(t[l]);
                    c && (o && (o += ","), o += JSON.stringify(l) + ":" + c)
                }
                return r.splice(s, 1), "{" + o + "}"
            }
        }(e)
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        function n(e) {
            for (var t = e.rules, i = 0; i < t.length; i++)
                if (r(t[i])) return !0
        }

        function r(t) {
            return void 0 !== e.schema[t.keyword] || t.implements && a(t)
        }

        function a(t) {
            for (var i = t.implements, n = 0; n < i.length; n++)
                if (void 0 !== e.schema[i[n]]) return !0
        }
        var o = "",
            s = !0 === e.schema.$async,
            u = e.util.schemaHasRulesExcept(e.schema, e.RULES.all, "$ref"),
            l = e.self._getId(e.schema);
        if (e.isTop && (o += " var validate = ", s && (e.async = !0, o += "async "), o += "function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ", l && (e.opts.sourceCode || e.opts.processCode) && (o += " /*# sourceURL=" + l + " */ ")), "boolean" == typeof e.schema || !u && !e.schema.$ref) {
            var c, h = e.level,
                d = e.dataLevel,
                f = e.schema["false schema"],
                p = e.schemaPath + e.util.getProperty("false schema"),
                m = e.errSchemaPath + "/false schema",
                g = !e.opts.allErrors,
                v = "data" + (d || ""),
                _ = "valid" + h;
            if (!1 === e.schema) {
                e.isTop ? g = !0 : o += " var " + _ + " = false; ";
                var b = b || [];
                b.push(o), o = "", !1 !== e.createErrors ? (o += " { keyword: '" + (c || "false schema") + "' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(m) + " , params: {} ", !1 !== e.opts.messages && (o += " , message: 'boolean schema is false' "), e.opts.verbose && (o += " , schema: false , parentSchema: validate.schema" + e.schemaPath + " , data: " + v + " "), o += " } ") : o += " {} ";
                var S = o;
                o = b.pop(), !e.compositeRule && g ? e.async ? o += " throw new ValidationError([" + S + "]); " : o += " validate.errors = [" + S + "]; return false; " : o += " var err = " + S + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "
            } else e.isTop ? o += s ? " return data; " : " validate.errors = null; return true; " : o += " var " + _ + " = true; ";
            return e.isTop && (o += " }; return validate; "), o
        }
        if (e.isTop) {
            var x = e.isTop,
                h = e.level = 0,
                d = e.dataLevel = 0,
                v = "data";
            e.rootId = e.resolve.fullPath(e.self._getId(e.root.schema)), e.baseId = e.baseId || e.rootId, delete e.isTop, e.dataPathArr = [void 0], o += " var vErrors = null; ", o += " var errors = 0;     ", o += " if (rootData === undefined) rootData = data; "
        } else {
            var h = e.level,
                d = e.dataLevel,
                v = "data" + (d || "");
            if (l && (e.baseId = e.resolve.url(e.baseId, l)), s && !e.async) throw new Error("async schema in sync schema");
            o += " var errs_" + h + " = errors;"
        }
        var c, _ = "valid" + h,
            g = !e.opts.allErrors,
            y = "",
            C = "",
            T = e.schema.type,
            w = Array.isArray(T);
        if (w && 1 == T.length && (T = T[0], w = !1), e.schema.$ref && u) {
            if ("fail" == e.opts.extendRefs) throw new Error('$ref: validation keywords used in schema at path "' + e.errSchemaPath + '" (see option extendRefs)');
            !0 !== e.opts.extendRefs && (u = !1, e.logger.warn('$ref: keywords ignored in schema at path "' + e.errSchemaPath + '"'))
        }
        if (e.schema.$comment && e.opts.$comment && (o += " " + e.RULES.all.$comment.code(e, "$comment")), T) {
            if (e.opts.coerceTypes) var M = e.util.coerceToTypes(e.opts.coerceTypes, T);
            var E = e.RULES.types[T];
            if (M || w || !0 === E || E && !n(E)) {
                var p = e.schemaPath + ".type",
                    m = e.errSchemaPath + "/type",
                    p = e.schemaPath + ".type",
                    m = e.errSchemaPath + "/type",
                    A = w ? "checkDataTypes" : "checkDataType";
                if (o += " if (" + e.util[A](T, v, !0) + ") { ", M) {
                    var P = "dataType" + h,
                        R = "coerced" + h;
                    o += " var " + P + " = typeof " + v + "; ", "array" == e.opts.coerceTypes && (o += " if (" + P + " == 'object' && Array.isArray(" + v + ")) " + P + " = 'array'; "), o += " var " + R + " = undefined; ";
                    var O = "",
                        I = M;
                    if (I)
                        for (var F, N = -1, D = I.length - 1; N < D;) F = I[N += 1], N && (o += " if (" + R + " === undefined) { ", O += "}"), "array" == e.opts.coerceTypes && "array" != F && (o += " if (" + P + " == 'array' && " + v + ".length == 1) { " + R + " = " + v + " = " + v + "[0]; " + P + " = typeof " + v + ";  } "), "string" == F ? o += " if (" + P + " == 'number' || " + P + " == 'boolean') " + R + " = '' + " + v + "; else if (" + v + " === null) " + R + " = ''; " : "number" == F || "integer" == F ? (o += " if (" + P + " == 'boolean' || " + v + " === null || (" + P + " == 'string' && " + v + " && " + v + " == +" + v + " ", "integer" == F && (o += " && !(" + v + " % 1)"), o += ")) " + R + " = +" + v + "; ") : "boolean" == F ? o += " if (" + v + " === 'false' || " + v + " === 0 || " + v + " === null) " + R + " = false; else if (" + v + " === 'true' || " + v + " === 1) " + R + " = true; " : "null" == F ? o += " if (" + v + " === '' || " + v + " === 0 || " + v + " === false) " + R + " = null; " : "array" == e.opts.coerceTypes && "array" == F && (o += " if (" + P + " == 'string' || " + P + " == 'number' || " + P + " == 'boolean' || " + v + " == null) " + R + " = [" + v + "]; ");
                    o += " " + O + " if (" + R + " === undefined) {   ";
                    var b = b || [];
                    b.push(o), o = "", !1 !== e.createErrors ? (o += " { keyword: '" + (c || "type") + "' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(m) + " , params: { type: '", o += w ? "" + T.join(",") : "" + T, o += "' } ", !1 !== e.opts.messages && (o += " , message: 'should be ", o += w ? "" + T.join(",") : "" + T, o += "' "), e.opts.verbose && (o += " , schema: validate.schema" + p + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + v + " "), o += " } ") : o += " {} ";
                    var S = o;
                    o = b.pop(), !e.compositeRule && g ? e.async ? o += " throw new ValidationError([" + S + "]); " : o += " validate.errors = [" + S + "]; return false; " : o += " var err = " + S + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", o += " } else {  ";
                    var L = d ? "data" + (d - 1 || "") : "parentData",
                        k = d ? e.dataPathArr[d] : "parentDataProperty";
                    o += " " + v + " = " + R + "; ", d || (o += "if (" + L + " !== undefined)"), o += " " + L + "[" + k + "] = " + R + "; } "
                } else {
                    var b = b || [];
                    b.push(o), o = "", !1 !== e.createErrors ? (o += " { keyword: '" + (c || "type") + "' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(m) + " , params: { type: '", o += w ? "" + T.join(",") : "" + T, o += "' } ", !1 !== e.opts.messages && (o += " , message: 'should be ", o += w ? "" + T.join(",") : "" + T, o += "' "), e.opts.verbose && (o += " , schema: validate.schema" + p + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + v + " "), o += " } ") : o += " {} ";
                    var S = o;
                    o = b.pop(), !e.compositeRule && g ? e.async ? o += " throw new ValidationError([" + S + "]); " : o += " validate.errors = [" + S + "]; return false; " : o += " var err = " + S + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "
                }
                o += " } "
            }
        }
        if (e.schema.$ref && !u) o += " " + e.RULES.all.$ref.code(e, "$ref") + " ", g && (o += " } if (errors === ", o += x ? "0" : "errs_" + h, o += ") { ", C += "}");
        else {
            var V = e.RULES;
            if (V)
                for (var E, B = -1, U = V.length - 1; B < U;)
                    if (E = V[B += 1], n(E)) {
                        if (E.type && (o += " if (" + e.util.checkDataType(E.type, v) + ") { "), e.opts.useDefaults && !e.compositeRule)
                            if ("object" == E.type && e.schema.properties) {
                                var f = e.schema.properties,
                                    G = Object.keys(f),
                                    j = G;
                                if (j)
                                    for (var z, H = -1, W = j.length - 1; H < W;) {
                                        z = j[H += 1];
                                        var q = f[z];
                                        if (void 0 !== q.default) {
                                            var X = v + e.util.getProperty(z);
                                            o += "  if (" + X + " === undefined) " + X + " = ", "shared" == e.opts.useDefaults ? o += " " + e.useDefault(q.default) + " " : o += " " + JSON.stringify(q.default) + " ", o += "; "
                                        }
                                    }
                            } else if ("array" == E.type && Array.isArray(e.schema.items)) {
                            var Y = e.schema.items;
                            if (Y)
                                for (var q, N = -1, K = Y.length - 1; N < K;)
                                    if (q = Y[N += 1], void 0 !== q.default) {
                                        var X = v + "[" + N + "]";
                                        o += "  if (" + X + " === undefined) " + X + " = ", "shared" == e.opts.useDefaults ? o += " " + e.useDefault(q.default) + " " : o += " " + JSON.stringify(q.default) + " ", o += "; "
                                    }
                        }
                        var $ = E.rules;
                        if ($)
                            for (var Q, J = -1, Z = $.length - 1; J < Z;)
                                if (Q = $[J += 1], r(Q)) {
                                    var ee = Q.code(e, Q.keyword, E.type);
                                    ee && (o += " " + ee + " ", g && (y += "}"))
                                } if (g && (o += " " + y + " ", y = ""), E.type && (o += " } ", T && T === E.type && !M)) {
                            o += " else { ";
                            var p = e.schemaPath + ".type",
                                m = e.errSchemaPath + "/type",
                                b = b || [];
                            b.push(o), o = "", !1 !== e.createErrors ? (o += " { keyword: '" + (c || "type") + "' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(m) + " , params: { type: '", o += w ? "" + T.join(",") : "" + T, o += "' } ", !1 !== e.opts.messages && (o += " , message: 'should be ", o += w ? "" + T.join(",") : "" + T, o += "' "), e.opts.verbose && (o += " , schema: validate.schema" + p + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + v + " "), o += " } ") : o += " {} ";
                            var S = o;
                            o = b.pop(), !e.compositeRule && g ? e.async ? o += " throw new ValidationError([" + S + "]); " : o += " validate.errors = [" + S + "]; return false; " : o += " var err = " + S + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", o += " } "
                        }
                        g && (o += " if (errors === ", o += x ? "0" : "errs_" + h, o += ") { ", C += "}")
                    }
        }
        return g && (o += " " + C + " "), x ? (s ? (o += " if (errors === 0) return data;           ", o += " else throw new ValidationError(vErrors); ") : (o += " validate.errors = vErrors; ", o += " return errors === 0;       "), o += " }; return validate;") : o += " var " + _ + " = errors === errs_" + h + ";", o = e.util.cleanUpCode(o), x && (o = e.util.finalCleanUpCode(o, s)), o
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n, r, a = " ",
            o = e.level,
            s = e.dataLevel,
            u = e.schema[t],
            l = e.schemaPath + e.util.getProperty(t),
            c = e.errSchemaPath + "/" + t,
            h = !e.opts.allErrors,
            d = "data" + (s || ""),
            f = e.opts.$data && u && u.$data;
        f ? (a += " var schema" + o + " = " + e.util.getData(u.$data, s, e.dataPathArr) + "; ", r = "schema" + o) : r = u;
        var p = "maximum" == t,
            m = p ? "exclusiveMaximum" : "exclusiveMinimum",
            g = e.schema[m],
            v = e.opts.$data && g && g.$data,
            _ = p ? "<" : ">",
            b = p ? ">" : "<",
            n = void 0;
        if (v) {
            var S = e.util.getData(g.$data, s, e.dataPathArr),
                x = "exclusive" + o,
                y = "exclType" + o,
                C = "exclIsNumber" + o,
                T = "op" + o,
                w = "' + " + T + " + '";
            a += " var schemaExcl" + o + " = " + S + "; ", S = "schemaExcl" + o, a += " var " + x + "; var " + y + " = typeof " + S + "; if (" + y + " != 'boolean' && " + y + " != 'undefined' && " + y + " != 'number') { ";
            var n = m,
                M = M || [];
            M.push(a), a = "", !1 !== e.createErrors ? (a += " { keyword: '" + (n || "_exclusiveLimit") + "' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(c) + " , params: {} ", !1 !== e.opts.messages && (a += " , message: '" + m + " should be boolean' "), e.opts.verbose && (a += " , schema: validate.schema" + l + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + d + " "), a += " } ") : a += " {} ";
            var E = a;
            a = M.pop(), !e.compositeRule && h ? e.async ? a += " throw new ValidationError([" + E + "]); " : a += " validate.errors = [" + E + "]; return false; " : a += " var err = " + E + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", a += " } else if ( ", f && (a += " (" + r + " !== undefined && typeof " + r + " != 'number') || "), a += " " + y + " == 'number' ? ( (" + x + " = " + r + " === undefined || " + S + " " + _ + "= " + r + ") ? " + d + " " + b + "= " + S + " : " + d + " " + b + " " + r + " ) : ( (" + x + " = " + S + " === true) ? " + d + " " + b + "= " + r + " : " + d + " " + b + " " + r + " ) || " + d + " !== " + d + ") { var op" + o + " = " + x + " ? '" + _ + "' : '" + _ + "='; ", void 0 === u && (n = m, c = e.errSchemaPath + "/" + m, r = S, f = v)
        } else {
            var C = "number" == typeof g,
                w = _;
            if (C && f) {
                var T = "'" + w + "'";
                a += " if ( ", f && (a += " (" + r + " !== undefined && typeof " + r + " != 'number') || "), a += " ( " + r + " === undefined || " + g + " " + _ + "= " + r + " ? " + d + " " + b + "= " + g + " : " + d + " " + b + " " + r + " ) || " + d + " !== " + d + ") { "
            } else {
                C && void 0 === u ? (x = !0, n = m, c = e.errSchemaPath + "/" + m, r = g, b += "=") : (C && (r = Math[p ? "min" : "max"](g, u)), g === (!C || r) ? (x = !0, n = m, c = e.errSchemaPath + "/" + m, b += "=") : (x = !1, w += "="));
                var T = "'" + w + "'";
                a += " if ( ", f && (a += " (" + r + " !== undefined && typeof " + r + " != 'number') || "), a += " " + d + " " + b + " " + r + " || " + d + " !== " + d + ") { "
            }
        }
        n = n || t;
        var M = M || [];
        M.push(a), a = "", !1 !== e.createErrors ? (a += " { keyword: '" + (n || "_limit") + "' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(c) + " , params: { comparison: " + T + ", limit: " + r + ", exclusive: " + x + " } ", !1 !== e.opts.messages && (a += " , message: 'should be " + w + " ", a += f ? "' + " + r : r + "'"), e.opts.verbose && (a += " , schema:  ", a += f ? "validate.schema" + l : "" + u, a += "         , parentSchema: validate.schema" + e.schemaPath + " , data: " + d + " "), a += " } ") : a += " {} ";
        var E = a;
        return a = M.pop(), !e.compositeRule && h ? e.async ? a += " throw new ValidationError([" + E + "]); " : a += " validate.errors = [" + E + "]; return false; " : a += " var err = " + E + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", a += " } ", h && (a += " else { "), a
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n, r, a = " ",
            o = e.level,
            s = e.dataLevel,
            u = e.schema[t],
            l = e.schemaPath + e.util.getProperty(t),
            c = e.errSchemaPath + "/" + t,
            h = !e.opts.allErrors,
            d = "data" + (s || ""),
            f = e.opts.$data && u && u.$data;
        f ? (a += " var schema" + o + " = " + e.util.getData(u.$data, s, e.dataPathArr) + "; ", r = "schema" + o) : r = u;
        var p = "maxItems" == t ? ">" : "<";
        a += "if ( ", f && (a += " (" + r + " !== undefined && typeof " + r + " != 'number') || "), a += " " + d + ".length " + p + " " + r + ") { ";
        var n = t,
            m = m || [];
        m.push(a), a = "", !1 !== e.createErrors ? (a += " { keyword: '" + (n || "_limitItems") + "' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(c) + " , params: { limit: " + r + " } ", !1 !== e.opts.messages && (a += " , message: 'should NOT have ", a += "maxItems" == t ? "more" : "less", a += " than ", a += f ? "' + " + r + " + '" : "" + u, a += " items' "), e.opts.verbose && (a += " , schema:  ", a += f ? "validate.schema" + l : "" + u, a += "         , parentSchema: validate.schema" + e.schemaPath + " , data: " + d + " "), a += " } ") : a += " {} ";
        var g = a;
        return a = m.pop(), !e.compositeRule && h ? e.async ? a += " throw new ValidationError([" + g + "]); " : a += " validate.errors = [" + g + "]; return false; " : a += " var err = " + g + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", a += "} ", h && (a += " else { "), a
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n, r, a = " ",
            o = e.level,
            s = e.dataLevel,
            u = e.schema[t],
            l = e.schemaPath + e.util.getProperty(t),
            c = e.errSchemaPath + "/" + t,
            h = !e.opts.allErrors,
            d = "data" + (s || ""),
            f = e.opts.$data && u && u.$data;
        f ? (a += " var schema" + o + " = " + e.util.getData(u.$data, s, e.dataPathArr) + "; ", r = "schema" + o) : r = u;
        var p = "maxLength" == t ? ">" : "<";
        a += "if ( ", f && (a += " (" + r + " !== undefined && typeof " + r + " != 'number') || "), !1 === e.opts.unicode ? a += " " + d + ".length " : a += " ucs2length(" + d + ") ", a += " " + p + " " + r + ") { ";
        var n = t,
            m = m || [];
        m.push(a), a = "", !1 !== e.createErrors ? (a += " { keyword: '" + (n || "_limitLength") + "' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(c) + " , params: { limit: " + r + " } ", !1 !== e.opts.messages && (a += " , message: 'should NOT be ", a += "maxLength" == t ? "longer" : "shorter", a += " than ", a += f ? "' + " + r + " + '" : "" + u, a += " characters' "), e.opts.verbose && (a += " , schema:  ", a += f ? "validate.schema" + l : "" + u, a += "         , parentSchema: validate.schema" + e.schemaPath + " , data: " + d + " "), a += " } ") : a += " {} ";
        var g = a;
        return a = m.pop(), !e.compositeRule && h ? e.async ? a += " throw new ValidationError([" + g + "]); " : a += " validate.errors = [" + g + "]; return false; " : a += " var err = " + g + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", a += "} ", h && (a += " else { "), a
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n, r, a = " ",
            o = e.level,
            s = e.dataLevel,
            u = e.schema[t],
            l = e.schemaPath + e.util.getProperty(t),
            c = e.errSchemaPath + "/" + t,
            h = !e.opts.allErrors,
            d = "data" + (s || ""),
            f = e.opts.$data && u && u.$data;
        f ? (a += " var schema" + o + " = " + e.util.getData(u.$data, s, e.dataPathArr) + "; ", r = "schema" + o) : r = u;
        var p = "maxProperties" == t ? ">" : "<";
        a += "if ( ", f && (a += " (" + r + " !== undefined && typeof " + r + " != 'number') || "), a += " Object.keys(" + d + ").length " + p + " " + r + ") { ";
        var n = t,
            m = m || [];
        m.push(a), a = "", !1 !== e.createErrors ? (a += " { keyword: '" + (n || "_limitProperties") + "' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(c) + " , params: { limit: " + r + " } ", !1 !== e.opts.messages && (a += " , message: 'should NOT have ", a += "maxProperties" == t ? "more" : "less", a += " than ", a += f ? "' + " + r + " + '" : "" + u, a += " properties' "), e.opts.verbose && (a += " , schema:  ", a += f ? "validate.schema" + l : "" + u, a += "         , parentSchema: validate.schema" + e.schemaPath + " , data: " + d + " "), a += " } ") : a += " {} ";
        var g = a;
        return a = m.pop(), !e.compositeRule && h ? e.async ? a += " throw new ValidationError([" + g + "]); " : a += " validate.errors = [" + g + "]; return false; " : a += " var err = " + g + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", a += "} ", h && (a += " else { "), a
    }
}, function (e, t, i) {
    "use strict";
    var n = i(0);
    i.n(n);
    t.a = {
        addNewImage: function (e) {
            if (!this.model) throw new Error("This collection must implement a model.");
            var t, i = e.uid;
            i ? t = i.replace(/tmp_/, "") : (t = e.id || Object(n.uniqueId)(), i = "tmp_" + t);
            var r = new this.model({
                images: [{
                    uid: i,
                    url: e.url,
                    width: e.width,
                    height: e.height
                }],
                uid: i,
                id: t,
                name: e.name || "newImage",
                imageFile: e.imageFile
            });
            return this.set(r, {
                merge: !0,
                add: !0,
                remove: !1
            }), r
        }
    }
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = n.a.osg,
        a = function () {
            r.TextureCubeMap.call(this), this._imageProxy = void 0
        };
    r.createPrototypeStateAttribute(a, r.objectInherit(r.TextureCubeMap.prototype, {
        getHash: function () {
            return "osgSketchfabTexture"
        }
    }), "osgSketchfab", "TextureCubeMap"), a.dummyTexture = new a, a.dummyTexture.setTextureSize(1, 1), t.a = a
}, function (e, t, i) {
    "use strict";
    var n = 3.14159265359,
        r = {},
        a = function (e, t, i, a, o, s) {
            a = a || .25, o = o || 720;
            var u = Math.cos(.01745329251 * a),
                l = 0,
                c = r.table;
            if (void 0 === c)
                for (c = r.table = new Float32Array(1801779), r.nphi = o, r.epsilon = a, l = 0; l < 1801779; ++l) c[l] = 1 / 0;
            var h = n / (o - 1),
                d = 1.57079632679 / (o - 1),
                f = s ? 3 : 2,
                p = o !== r.nphi || a !== r.epsilon,
                m = e.length / f;
            for (l = 0; l < m; ++l) {
                var g = l * i,
                    v = l * f,
                    _ = e[v],
                    b = e[v + 1];
                4 !== i || s || (t[g + 3] = 1024 & _ ? -1 : 1, _ &= -1025);
                var S, x, y, C = 3 * (_ + o * b),
                    T = C >= 1801779;
                if (p || T || c[C] === 1 / 0) {
                    var w = _ * h,
                        M = Math.cos(w),
                        E = Math.sin(w);
                    w += d;
                    var A = (u - M * Math.cos(w)) / Math.max(1e-5, E * Math.sin(w));
                    A > 1 ? A = 1 : A < -1 && (A = -1);
                    var P = 6.28318530718 * b / Math.ceil(n / Math.max(1e-5, Math.acos(A)));
                    S = E * Math.cos(P), x = E * Math.sin(P), y = M, T || p || (c[C] = S, c[C + 1] = x, c[C + 2] = y)
                } else S = c[C], x = c[C + 1], y = c[C + 2];
                if (s) {
                    var R = 47938362584151635e-21 * e[v + 2],
                        O = Math.sin(R);
                    t[g] = O * S, t[g + 1] = O * x, t[g + 2] = O * y, t[g + 3] = Math.cos(R)
                } else t[g] = S, t[g + 1] = x, t[g + 2] = y
            }
            return t
        };
    t.a = a
}, function (e, t, i) {
    "use strict";
    var n = function (e, t, i, n, r) {
        for (var a = e.length / r, o = 0; o < a; ++o)
            for (var s = o * r, u = 0; u < r; ++u) t[s + u] = i[u] + e[s + u] * n[u];
        return t
    };
    t.a = n
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = n.a.osg,
        a = function (e, t, i) {
            for (var n = new r[i](t), a = 0, o = 0; a !== t;) {
                var s = 0,
                    u = 0;
                do {
                    s |= (127 & e[o]) << u, u += 7
                } while (0 != (128 & e[o++]));
                n[a++] = s
            }
            if ("U" !== i[0])
                for (var l = 0; l < t; ++l) {
                    var c = n[l];
                    n[l] = c >> 1 ^ -(1 & c)
                }
            return n
        };
    t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(9)),
        a = i(11),
        o = i(705),
        s = i(77),
        u = r.a.osg,
        l = Object(n.invert)(u.Texture),
        c = ["magFilter", "minFilter", "wrapS", "wrapT", "textureTarget", "internalFormat"],
        h = a.a.extend({
            initialize: function () {
                if (a.a.prototype.initialize.apply(this, arguments), !this.attributes.image) return void u.error("no image found in attributes, TextureModel invalid");
                var e = o.a.createValidOptionsForMaterial(this.attributes);
                this.set(e), this.setMultiresTextureFromValidOptions(e), void 0 === this.get("texCoordUnit") && this.set("texCoordUnit", 0), this.bind("change:image", this.updateMultiresTexture, this)
            },
            getImageModel: function () {
                return this.get("image")
            },
            setImageModel: function (e) {
                this.set("image", e)
            },
            getResourceManager: function () {
                return this._resourceManager || s.default.instance
            },
            getMultiresTexture: function () {
                return this.get("multiresTexture")
            },
            getURL: function () {
                console.trace("dont call TextureModel.getURL")
            },
            setMultiresTextureFromValidOptions: function (e) {
                var t = this.get("image").getUID(),
                    i = this.getResourceManager().getOrCreateMultiresTexture(t, e);
                i && this.set("multiresTexture", i.resource)
            },
            updateMultiresTexture: function () {
                this.setMultiresTextureFromValidOptions(o.a.createValidOptionsForMaterial(this.attributes))
            },
            isLuminance: function () {
                return this.get("internalFormat") === u.Texture.LUMINANCE
            },
            isAlpha: function () {
                return this.get("internalFormat") === u.Texture.ALPHA
            },
            getUID: function () {
                return this.getImageModel().getUID()
            },
            getJSON: function () {
                for (var e = {}, t = 0, i = c.length; t < i; ++t) {
                    var n = c[t];
                    e[n] = l[this.get(n)]
                }
                return e.texCoordUnit = this.get("texCoordUnit"), e.uid = this.getUID(), e
            }
        });
    t.a = h
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(47),
        a = i(69),
        o = i(20),
        s = i(321),
        u = i(85),
        l = i(88),
        c = i(120),
        h = i(1260),
        d = i.n(h),
        f = i(1261),
        p = i.n(f),
        m = n.a.osg,
        g = n.a.osgUtil,
        v = n.a.osgAnimation,
        _ = a.a.SHADOW_CAST | a.a.PICK_GEOMETRY_ANIMATED;
    v.MorphGeometry.MAX_MORPH_GPU = Math.min(4, Object(o.a)().morphGpu);
    var b = g.IntersectionVisitor.prototype.enter;
    g.IntersectionVisitor.prototype.enter = function (e) {
        return !!e._forceEnterIntersection || b.call(this, e)
    };
    var S = function () {};
    m.createPrototypeObject(S, {
        cull: function () {
            return !1
        }
    }, "osgSketchfab", "HideCullCallback");
    var x, y = new S,
        C = function () {
            return x || (x = c.a.createShader(d.a, p.a, "debug/skeleton", "debugSkeleton"))
        },
        T = m.vec3.create(),
        w = m.vec3.create(),
        M = function (e) {
            e.center(T), m.vec3.sub(w, e.getMax(), e.getMin());
            var t = m.createTexturedBoxGeometry(T[0], T[1], T[2], w[0], w[1], w[2]);
            return t.setName("BoneBox"), t.getOrCreateStateSet().setShaderGeneratorName("debugBoneBox"), 3 !== Object(o.a)().showBones && t.setCullCallback(y), t._isBoneBox = !0, t.setNodeMask(a.a.PICK_GEOMETRY_RIG_BOX | a.a.SHADOW_BOUNDS), t
        },
        E = function (e) {
            for (var t = g.GizmoGeometry.createCylinderGeometry(.1 * e, .02 * e, e), i = t.getAttributes().Vertex.getElements(), n = 0, r = i.length / 3; n < r; ++n) i[3 * n + 2] += .5 * e;
            return t._isSkeleton = !0, t
        },
        A = function (e) {
            m.NodeVisitor.call(this), this._visitedNodes = {}, this._drawNames = e;
            var t = m.StateAttribute.OVERRIDE_ON,
                i = this._geoStateSet = new m.StateSet;
            i.setAttributeAndModes(C()), i.setAttributeAndModes(l.a.DEPTH_ALWAYS, t), i.setRenderBinDetails(u.a.DEBUG_2, "RenderBin"), s.a.set("hasExtra", !0)
        };
    m.createPrototypeObject(A, m.objectInherit(m.NodeVisitor.prototype, {
        drawBone: function () {
            var e = m.vec3.create(),
                t = m.vec3.fromValues(0, 0, 1),
                i = m.quat.create();
            return function (n) {
                var r = n.getChildren();
                if (r.length)
                    for (var a = 0; a < r.length; ++a) {
                        var o = r[a];
                        if (o instanceof v.Bone != !1) {
                            m.vec3.transformMat4(e, m.vec3.set(e, 0, 0, 0), o.getMatrix());
                            var s = E(m.vec3.len(e));
                            s.setStateSet(this._geoStateSet), s._boundingBoxComputed = !0, s._boundingSphereComputed = !0;
                            var u = new m.MatrixTransform;
                            m.quat.rotationTo(i, t, m.vec3.normalize(e, e)), m.mat4.fromRotationTranslation(u.getMatrix(), i, m.vec3.ZERO);
                            var l = m.Uniform.createFloat4("uColor"),
                                c = l.getInternalArray(),
                                h = n.getOrCreateDebugColor();
                            c[0] = .9 * h[0], c[1] = .9 * h[1], c[2] = .9 * h[2], c[3] = 1, u.getOrCreateStateSet().addUniform(l);
                            var d = "Debug " + n.getName();
                            u.setName(d), s.setName(d), u.addChild(s), n.addChild(u)
                        }
                    }
            }
        }(),
        apply: function (e) {
            var t = e.getInstanceID();
            this._visitedNodes[t] || (this._visitedNodes[t] = !0, e instanceof v.Bone && this._drawNames[e.getName()] && this.drawBone(e), this.traverse(e))
        }
    }), "osgSketchfab", "DrawBoneVisitor");
    var P = function (e, t) {
        m.NodeVisitor.call(this), this._wirePromise = r.a.getWireframeOptimized(), this._wireNodes = t.getOrCreateScene().getWireframeNodes(), this.nodeMaskOverride = -1, this._visitedNodes = {}, this._drawBoneNames = {}, this._rigIndexed = [], this._boneGeomIndexed = [], this._skls = e;
        var i = t.getFeatures().material.getModel(),
            n = m.WebGLCaps.instance();
        this._maxVA = n.getWebGLParameter("MAX_VERTEX_ATTRIBS");
        var a = 0;
        a += 1, a += 1, a += 1, a += 3, a += 3, a += 4, a += 4, a += 4, a += 4, a += 1, a += 1, a += 1, a += 1, a += 1, a += 1, a += 1, a += 1, a += 1, a += 1, a += 1 * i.getMaxUvCount(), a = Math.ceil(a);
        var s = n.getWebGLParameter("MAX_VERTEX_UNIFORM_VECTORS");
        s = Math.min(s, Object(o.a)().maxVertexUniforms), this._maxBones = Math.floor((s - a) / 3), v.SkinningAttribute.maxBoneUniformAllowed = 3 * this._maxBones, this._minUniformsRequired = a + 39
    };
    m.createPrototypeObject(P, m.objectInherit(m.NodeVisitor.prototype, {
        createSplitRigGeometry: function (e) {
            var t = new v.RigGeometry;
            t.setName("Split (" + e.getInstanceID() + ")"), t.setStateSet(e.getStateSet()), t.setUserData(e.getUserData()), t.userDataMap = e.userDataMap, t.setSourceGeometry(e.getSourceGeometry()), t._forceEnterIntersection = !0, t.setNodeMask(e.getNodeMask());
            var i = e.getVertexAttributeList(),
                n = t.getVertexAttributeList();
            for (var r in i) n[r] = i[r];
            var a = i.Bones.getElements(),
                o = new a.constructor(a.length);
            n.Bones = new m.BufferArray(m.BufferArray.ARRAY_BUFFER, o, i.Bones.getItemSize(), !0), t.userDataMap.wireframe && this._wireNodes.push(t);
            var s = t.userDataMap.rigIndex;
            return void 0 !== s && (this._rigIndexed[s] = t), t._boundingSphereComputed = !0, t._boundingBoxComputed = !0, t
        },
        checkVertex: function (e, t) {
            var i = t.baseBones,
                n = t.baseWeights,
                r = t.mappedUsedBones,
                a = 0;
            return n[e] && !r[i[e]] && a++, n[e + 1] && !r[i[e + 1]] && a++, n[e + 2] && !r[i[e + 2]] && a++, n[e + 3] && !r[i[e + 3]] && a++, a
        },
        tagBoneVertex: function (e, t) {
            var i = t.baseBones,
                n = t.baseWeights,
                r = t.mappedUsedBones,
                a = t.boneNameID,
                o = t.boneToName,
                s = i[e];
            n[e] && !r[s] && (a[o[s]] = t.nbUsedBones, r[s] = ++t.nbUsedBones), t.newBones[e] = r[s] - 1, s = i[e + 1], n[e + 1] && !r[s] && (a[o[s]] = t.nbUsedBones, r[s] = ++t.nbUsedBones), t.newBones[e + 1] = r[s] - 1, s = i[e + 2], n[e + 2] && !r[s] && (a[o[s]] = t.nbUsedBones, r[s] = ++t.nbUsedBones), t.newBones[e + 2] = r[s] - 1, s = i[e + 3], n[e + 3] && !r[s] && (a[o[s]] = t.nbUsedBones, r[s] = ++t.nbUsedBones), t.newBones[e + 3] = r[s] - 1
        },
        splitTriangle: function (e, t, i, n) {
            if (n.currentIdPrimitive++, e === t || e === i || t === i || n.processedPrimitive[n.currentIdPrimitive - 1]) return !0;
            var r = n.nbUsedBones,
                a = this.checkVertex(4 * e, n);
            if (r + a < this._maxBones && (a += this.checkVertex(4 * t, n)), r + a < this._maxBones && (a += this.checkVertex(4 * i, n)), r + a >= this._maxBones) return void(n.finished = !1);
            this.tagBoneVertex(4 * e, n), this.tagBoneVertex(4 * t, n), this.tagBoneVertex(4 * i, n);
            var o = n.first + n.countIdPrimitive;
            n.countIdPrimitive += 3, n.newIndexesElements[o] = e, n.newIndexesElements[o + 1] = t, n.newIndexesElements[o + 2] = i, n.processedPrimitive[n.currentIdPrimitive - 1] = 1
        },
        splitLine: function (e, t, i) {
            if (i.currentIdPrimitive++, e === t || i.processedPrimitive[i.currentIdPrimitive - 1]) return !0;
            var n = i.nbUsedBones,
                r = this.checkVertex(4 * e, i);
            if (n + r < this._maxBones && (r += this.checkVertex(4 * t, i)), n + r >= this._maxBones) return void(i.finished = !1);
            this.tagBoneVertex(4 * e, i), this.tagBoneVertex(4 * t, i);
            var a = i.first + i.countIdPrimitive;
            i.countIdPrimitive += 2, i.newIndexesElements[a] = e, i.newIndexesElements[a + 1] = t, i.processedPrimitive[i.currentIdPrimitive - 1] = 1
        },
        callbackDrawElementsTriangles: function (e, t, i) {
            for (var n = 0; n < e; n += 3) this.splitTriangle(t[n], t[n + 1], t[n + 2], i)
        },
        callbackDrawElementsTriangleStrip: function (e, t, i) {
            for (var n = 2, r = 0; n < e; ++n, ++r) n % 2 ? this.splitTriangle(t[r], t[r + 2], t[r + 1], i) : this.splitTriangle(t[r], t[r + 1], t[r + 2], i)
        },
        callbackDrawElementsLines: function (e, t, i) {
            for (var n = 0; n < e; n += 2) this.splitLine(t[n], t[n + 1], i)
        },
        splitPrimitive: function (e, t) {
            e.finished = !0;
            var i = e.baseRig,
                n = e.primitive,
                r = this.createSplitRigGeometry(i);
            e.boneNameID = r._boneNameID, e.newBones = r.getVertexAttributeList().Bones.getElements(), e.mappedUsedBones = new Uint32Array(t), e.nbUsedBones = 0, e.currentIdPrimitive = 0, e.countIdPrimitive = 0;
            var a = n.getIndices().getElements(),
                o = n.getCount(),
                s = n.getMode();
            if (s === m.primitiveSet.TRIANGLE_STRIP ? this.callbackDrawElementsTriangleStrip(o, a, e) : s === m.primitiveSet.TRIANGLES ? this.callbackDrawElementsTriangles(o, a, e) : this.callbackDrawElementsLines(o, a, e), 0 === e.countIdPrimitive) {
                var u = "Only " + this._maxBones + " bones supported per draw call (min is 13)";
                return u += "\nMinium uniforms count should be " + this._minUniformsRequired, console.warn(u), !1
            }
            var l = new m.DrawElements(s === m.primitiveSet.LINES ? m.primitiveSet.LINES : m.primitiveSet.TRIANGLES, e.newIndexesBuffer);
            l.setFirst(e.first * e.newIndexesElements.BYTES_PER_ELEMENT), l.setCount(e.countIdPrimitive), e.first += e.countIdPrimitive, r.getPrimitives().push(l);
            for (var c = i.getParents(), h = c.length, d = 0; d < h; ++d) c[d].addChild(r);
            return !e.finished
        },
        getBoneToNames: function (e, t) {
            for (var i = t.length, n = new Array(i), r = 0; r < i; ++r) {
                var a = t[r];
                n[e[a]] = a
            }
            return n
        },
        splitRigGeometry: function (e) {
            for (var t = e._boneNameID, i = Object.keys(t), n = i.length, r = e.getPrimitives(), a = r.length, o = {
                    baseRig: e,
                    baseWeights: e.getVertexAttributeList().Weights.getElements(),
                    baseBones: e.getVertexAttributeList().Bones.getElements(),
                    boneToName: this.getBoneToNames(e._boneNameID, i)
                }, s = 0; s < a; ++s) {
                var u = r[s],
                    l = u.getMode();
                if (0 !== u.getCount())
                    if (u instanceof m.DrawElements != !1)
                        if (l === m.primitiveSet.TRIANGLE_STRIP || l === m.primitiveSet.TRIANGLES || l === m.primitiveSet.LINES) {
                            var c = u.getIndices(),
                                h = c.getElements(),
                                d = l === m.primitiveSet.TRIANGLE_STRIP ? 3 : 1;
                            for (o.newIndexesElements = new h.constructor(u.getCount() * d), o.newIndexesBuffer = new m.BufferArray(m.BufferArray.ELEMENT_ARRAY_BUFFER, o.newIndexesElements, c.getItemSize(), !0), o.first = u.getFirst(), o.processedPrimitive = new Uint8Array(u.getCount()), o.primitive = u; this.splitPrimitive(o, n););
                            o.newIndexesBuffer.setElements(o.newIndexesElements.subarray(0, o.first))
                        } else m.error("Split rigged primitives mode not yet handled : ", l);
                else m.error("Split rigged primitives type not yet handled", u)
            }
        },
        handleRigGeometry: function (e) {
            var t = e._boneNameID,
                i = Object(o.a)().showBones,
                n = e.userDataMap.wireframe,
                r = e.userDataMap.rigIndex;
            if (void 0 !== r && (this._rigIndexed[r] = e), 1 === i || 2 === i)
                if (n) e.setCullCallback(y);
                else {
                    2 !== i && e.setNodeMask(0);
                    var a = this._drawBoneNames;
                    for (var s in t) a[s] = !0
                }
            else this._maxBones < Object.keys(t).length && (n ? (e._boundingBoxComputed = !0, e._boundingSphereComputed = !0, this._wirePromise.then(this.splitRigGeometry.bind(this, e))) : this.splitRigGeometry(e), e.setCullCallback(y));
            this.tagForceIntersection()
        },
        tagForceIntersection: function () {
            for (var e = this._skls[this._skls.length - 1], t = 1 + this.nodePath.indexOf(e); t < this.nodePath.length; ++t) this.nodePath[t]._forceEnterIntersection = !0
        },
        popTargetAttribute: function (e, t, i) {
            for (var n = t.getMorphTargets(), r = n.length, a = e.getVertexAttributeList(), o = t.getVertexAttributeList(), s = 0; s < r; ++s) {
                delete n[s].getVertexAttributeList()[i];
                var u = i + "_" + s;
                delete a[u], a !== o && delete o[u]
            }
        },
        computeUsedVA: function (e, t, i, n) {
            var r = Object.keys(e).length - Object.keys(t).length * (i.length - Math.min(n, i.length));
            return e.Color || r++, r
        },
        handleMorphGeometry: function (e, t) {
            var i = t.getMaximumPossibleMorphGPU(),
                n = t.getMorphTargets(),
                r = n[0].getVertexAttributeList(),
                a = e.getVertexAttributeList(),
                o = this.computeUsedVA(a, r, n, i),
                s = this._maxVA;
            if (!(o <= s || a.Tangent_1 && (this.popTargetAttribute(e, t, "Tangent"), (o = this.computeUsedVA(a, r, n, i)) <= s) || a.Normal_1 && (this.popTargetAttribute(e, t, "Normal"), (o = this.computeUsedVA(a, r, n, i)) <= s))) {
                for (; i > 0;)
                    if (i--, t.setMaximumPossibleMorphGPU(i), (o = this.computeUsedVA(a, r, n, i)) <= s) return;
                console.warn("Too much vertex attributes!")
            }
        },
        apply: function (e) {
            var t = e.getInstanceID();
            if (!this._visitedNodes[t]) {
                this._visitedNodes[t] = !0;
                var i = e instanceof v.RigGeometry,
                    n = i ? e.getSourceGeometry() : e,
                    r = n instanceof v.MorphGeometry;
                if (i && e.separateStaticBoxInGeometry(), !r && !i || e.userDataMap.wireframe || e.setNodeMask(_), r && this.handleMorphGeometry(e, n), i) this.handleRigGeometry(e);
                else if (e instanceof v.Bone) {
                    var a = e.getBoneBoundingBox();
                    if (a.valid()) {
                        var o = M(a);
                        e.addChild(o);
                        var s = e.userDataMap.rigIndex;
                        void 0 !== s && this._boneGeomIndexed.push(o)
                    }
                } else e instanceof v.Skeleton && this._skls.push(e);
                this.traverse(e)
            }
        }
    }), "osgSketchfab", "InitVisitor");
    var R = {};
    R.DrawBones = A, R.hideCullCallback = y, R.init = function (e, t) {
        var i = new P(e, t),
            n = t.getRootModel();
        m.time("InitGraphAnimation"), n.accept(i), m.timeEnd("InitGraphAnimation");
        for (var r = i._boneGeomIndexed, a = i._rigIndexed, o = r.length, s = 0; s < o; ++s) {
            var u = r[s];
            u._mostInfluencedRig = a[u.getParents()[0].userDataMap.rigIndex]
        }
        Object.keys(i._drawBoneNames).length > 0 && n.accept(new A(i._drawBoneNames))
    }, t.a = R
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(409),
        a = n.a.osg,
        o = function () {
            r.a.apply(this, arguments), this._metaMapColor = {
                kd: "DiffuseColor",
                ka: "EmitColor",
                ks: "SpecularColor"
            }, this._metaMapFactor = {
                ns: "SpecularHardness",
                tr: "Opacity",
                d: "Opacity"
            }, this._metaMapTexture = {
                map_ka: "EmitColor",
                map_kd: "DiffuseColor",
                map_occlusion: "DiffuseIntensity",
                map_d: "Opacity",
                map_ks: "SpecularColor",
                map_ns: "SpecularHardness",
                map_normal: "NormalMap",
                bump: "BumpMap"
            }
        };
    a.createPrototypeObject(o, a.objectInherit(r.a.prototype, {
        checkOpacityFactor: function (e) {
            var t = e.getChannels().Opacity;
            t.getFactor() < .001 && t.setFactor(1)
        },
        setMaterialChannelColor: function (e, t, i, n) {
            var r = t.getChannels()[i];
            r.setColor && r.setColor(n), r.setEnable(!0), "SpecularColor" === i && r.setFactor(1)
        },
        setMaterialChannelFactor: function (e, t, i, n) {
            var r = t.getChannels()[i];
            if (r.setFactor(n), r.setEnable(!0), "SpecularHardness" === i) {
                var a = void 0 !== e.ks ? JSON.parse(e.ks) : [0, 0, 0];
                this.setGlossinessPBRFromSpecularGlossiness(t, a, n)
            }
        },
        processMaterial: function (e, t, i) {
            var n = this.createMaterial(e, t);
            this.setChannelsFromMetaDataColor(i, n), this.setChannelsFromMetaDataFactor(i, n), this.setChannelsFromMetaDataTexture(i, t, n), this.checkOpacityFactor(n), t.removeAttribute("Material"), n.setStateSet(t)
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(708),
        a = i(44),
        o = n.a.osg,
        s = function (e, t) {
            this._color = e, this._colorDelta = o.vec4.create(), this._lastRatio = 0, r.a.call(this, t), this._finished = !0, this._disableAfterFinished = !1, this._finishCallback = void 0, this._lastFrame = 0
        };
    o.createPrototypeObject(s, o.objectInherit(r.a.prototype, {
        hide: function () {
            o.vec3.init(this._colorDelta), this._colorDelta[3] = -this._color[3], this._disableAfterFinished = !0, this._lastRatio = 0, this.reset()
        },
        show: function (e) {
            o.vec3.init(this._colorDelta), this._colorDelta[3] = void 0 !== e ? e : 1 - this._color[3], this._disableAfterFinished = !1, this._lastRatio = 0, this.reset()
        },
        setColorTarget: function (e) {
            o.vec4.sub(this._colorDelta, e, this._color), this._disableAfterFinished = !1, this._lastRatio = 0, this.reset()
        },
        setFinishCallback: function (e) {
            this._finishCallback = e
        },
        finished: function () {
            !0 === this._disableAfterFinished && this._finishCallback && this._finishCallback()
        },
        update: function (e, t) {
            if (!0 === this._finished) return !0;
            a.a.draw();
            var i = t.getFrameStamp(),
                n = i.getFrameNumber();
            if (this._lastFrame === n) return !0;
            this._lastFrame = n;
            var r = i.getSimulationTime(),
                s = this.interpolate(r, e, t);
            s = o.smoothStep(0, 1, s);
            var u = s - this._lastRatio;
            return this._lastRatio = s, o.vec4.scaleAndAdd(this._color, this._color, this._colorDelta, u), !0
        }
    })), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(423),
        a = i(1301),
        o = i(582),
        s = i(85),
        u = i(321),
        l = i(47),
        c = i(152),
        h = i(585),
        d = i(88),
        f = i(20),
        p = n.a.osg,
        m = p.Texture.textureNull,
        g = d.a.CULL_BACK,
        v = d.a.CULL_DISABLE,
        _ = new p.PointSizeAttribute,
        b = new p.PointSizeAttribute;
    b.setCircleShape(!0);
    var S = function (e) {
        this._stateSet = void 0, this._materialModel = e, this._material = new r.a, this._material.setMaterialModel(this._materialModel), this._material.setStateSetContext(this);
        var t = new p.Texture;
        t.setImage(new Uint8Array(12), p.Texture.RGB), t.setTextureSize(4, 1), t.setMinFilter(p.Texture.NEAREST), t.setMagFilter(p.Texture.NEAREST), this._colorAtlas = new a.a(t), this._colorAtlas.setIsColorAtlas(!0), this._packedMaterialTextureCache = {}, this._maxTextureUnits = Object(o.a)()
    };
    S.cachedSquarePoint = _, S.cachedCirclePoint = b, S.prototype = {
        dirtyMaterial: function () {
            this._material && this._material.dirtyMaterial()
        },
        getStateSet: function () {
            return this._stateSet
        },
        getChannelPacking: function (e) {
            var t = this._packedMaterialTextureCache[e];
            return t.getChannelPacking && t.getChannelPacking(e)
        },
        setStateSet: function (e) {
            this._stateSet = e, e.getAttribute("SketchfabMaterial") || (this._material.setName(e.getName()), e.setAttributeAndModes(this._material));
            for (var t = 0, i = e.getNumTextureAttributeLists(); t < i; t++) e.removeTextureAttribute(t, "Texture")
        },
        setStateSetAlphaBlending: function () {
            this._stateSet && (this._stateSet.setRenderBinDetails(s.a.TRANSPARENT, "DepthSortedBin"), u.a.registerStateSetIsTransparent(this._stateSet, !0), u.a.registerStateSetIsRefraction(this._stateSet, !1))
        },
        setStateSetOpaque: function () {
            this._stateSet && (this._stateSet.setRenderBinDetails(s.a.OPAQUE, "RenderBin"), u.a.registerStateSetIsTransparent(this._stateSet, !1), u.a.registerStateSetIsRefraction(this._stateSet, !1))
        },
        setStateSetRefraction: function () {
            this._stateSet && (this._stateSet.setRenderBinDetails(s.a.REFRACTION, "RenderBin"), u.a.registerStateSetIsTransparent(this._stateSet, !1), u.a.registerStateSetIsRefraction(this._stateSet, !0))
        },
        setCullface: function (e) {
            this._stateSet && (this._stateSet.setAttributeAndModes(e ? g : v), this._material.dirtyMaterial())
        },
        setPointCircle: function (e) {
            this._stateSet && (this._stateSet.setAttributeAndModes(e ? b : _), this._material.dirtyMaterial())
        },
        isFreeSlot: function (e, t) {
            return void 0 === e || e === m || (!(!e.getChannelCount || 0 !== e.getChannelCount()) || !(!t || e !== this._colorAtlas))
        },
        isProtectedUnit: function (e) {
            return !(!u.a.get("protectDepthAndColorUnit") || 4 !== e && 5 !== e) || (6 === e || 8 === e || Object(f.a)().shadowAtlas && 7 === e)
        },
        _getFirstFreeUnit: function (e) {
            for (; this.isProtectedUnit(e);) e++;
            return Math.min(e, this._maxTextureUnits - 1)
        },
        getAvailableTextureUnit: function (e, t) {
            for (var i = t === this._colorAtlas, n = t === m, r = this._stateSet, a = r.getNumTextureAttributeLists(), o = this._getFirstFreeUnit(a), s = -1, u = 0; u <= o; ++u)
                if (!this.isProtectedUnit(u)) {
                    var l = r.getTextureAttribute(u, "Texture");
                    if (-1 === s && this.isFreeSlot(l, i) && (s = u, i || n)) break;
                    if (!n && !i && l && l.packChannelIfPossible && l.packChannelIfPossible(e, t)) {
                        s = u;
                        break
                    }
                } return s
        },
        setPackedMaterialTextureToStateSet: function (e, t) {
            var i = e.getName(),
                n = this._packedMaterialTextureCache[i];
            n && n instanceof a.a && (n.removeChannel(i), h.a.removePackedTexture(n));
            var r = this.getAvailableTextureUnit(i, t);
            if (r < 0) return this._packedMaterialTextureCache[i] = m, void this._material.setChannelMapping(i, -1);
            var o = this._stateSet.getTextureAttribute(r, "Texture");
            t === this._colorAtlas ? o = this._colorAtlas : o && o !== this._colorAtlas || (o = new a.a), o.setName("Texture" + r), this._material.setChannelMapping(i, t === m ? -1 : r), this._packedMaterialTextureCache[i] = o, o && o.addChannel && t !== m && o.addChannel(i, t);
            var s = o instanceof a.a,
                u = s && o.isProtectedTexture(),
                l = u ? p.StateAttribute.PROTECTED : p.StateAttribute.ON;
            this._stateSet.setTextureAttributeAndModes(r, o, l), s && h.a.addPackedTexture(o)
        },
        setTexture: function (e) {
            var t = e.getTextureModel(),
                i = t.getImageModel(),
                n = t.getMultiresTexture();
            if (i && n) {
                this.setPackedMaterialTextureToStateSet(e, n), n.isTextureNull() && n.setTextureSize(1, 1);
                var r = l.a.getLowResLoaded();
                if (r.isFulfilled()) return n.setImageMaxSupported();
                n.setImageSmallest().promise.then(function () {
                    r.then(n.setImageMaxSupported.bind(n))
                })
            }
        },
        setColor: function (e) {
            var t = c.a.getColorPacking(e.getName());
            if (t < 0) return void this.setPackedMaterialTextureToStateSet(e, m);
            var i = e.getColor();
            t *= 3;
            var n = this._colorAtlas.getTexture(),
                r = n.getImage().getImage();
            r[t] = Math.round(255 * i[0]), r[t + 1] = Math.round(255 * i[1]), r[t + 2] = Math.round(255 * i[2]), n.dirty(), this.setPackedMaterialTextureToStateSet(e, this._colorAtlas)
        },
        setChannelEnable: function (e, t) {
            return !1 === t ? this.setPackedMaterialTextureToStateSet(e, m) : e.getTextureModel() ? this.setTexture(e) : void this.setColor(e)
        },
        setChannelOpacity: function (e, t) {
            var i = e.getTransparency(),
                n = "additive" === i,
                r = "alphaBlend" === i,
                a = "alphaMask" === i,
                o = "dithering" === i,
                s = "refraction" === i;
            return this._material && this._material.updateOpacity(), !1 === t || a || o ? this.setStateSetOpaque() : r || n ? this.setStateSetAlphaBlending() : s ? this.setStateSetRefraction() : void p.warn("Unknow alpha type : " + i)
        },
        updateChannel: function (e) {
            if (this._stateSet) {
                var t = e.isEffective();
                this.setChannelEnable(e, t);
                var i = e.getName();
                "Opacity" === i && this.setChannelOpacity(e, t), "SubsurfaceScattering" === i && (u.a.registerStateSetIsScattering(this._stateSet, t), this._materialModel.getChannels().Opacity.trigger("updateChannel")), this._material.dirtyMaterial()
            }
        }
    }, t.a = S
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(77),
        a = i(120),
        o = i(634),
        s = i(88),
        u = i(926),
        l = i.n(u),
        c = i(927),
        h = i.n(c),
        d = n.a.osg,
        f = {},
        p = function (e, t) {
            if (f[e]) return f[e];
            var i = e.toLowerCase();
            return f[e] = a.a.createShader(l.a, h.a, i, t, e), f[e]
        },
        m = function () {
            return p("LINE", "LightingLineGizmo")
        },
        g = function () {
            return p("HEMI", "LightingHemiGizmo")
        },
        v = function () {
            return p("ICON", "LightingIcon")
        },
        _ = s.a.BLEND_SUBSTRACTIVE,
        b = {},
        S = function (e) {
            if (b[e]) return b[e];
            var t = o.a.iconsLight[e];
            t || (t = o.a.iconsLight.DIRECTION);
            var i = r.default.instance,
                n = i.getOrCreateTexture(t, {
                    internalFormat: d.Texture.RGBA
                });
            return b[e] = n.texture, n.texture
        },
        x = {};
    x.createIconGeometry = function () {
        var e = d.createTexturedQuadGeometry(-.5, -.5, 0, 1, 0, 0, 0, 1, 0),
            t = e.getOrCreateStateSet();
        return t.setTextureAttributeAndModes(1, S("DIRECTION")), t.addUniform(d.Uniform.createInt(1, "uTextureIcon")), t.setAttributeAndModes(_), t.setAttributeAndModes(v()), e.setLightType = function (e) {
            t.setTextureAttributeAndModes(1, S(e))
        }, e
    }, x.createDirectionalGeometry = function (e) {
        for (var t = void 0 === e ? -1 : -e, i = t / 15, n = 2 * Math.PI, r = new Float32Array(180), a = 0; a < 5; ++a) {
            var o = 6 * a,
                s = n * a / 5;
            r[o] = r[o + 3] = Math.cos(s) * i, r[o + 1] = r[o + 4] = Math.sin(s) * i, r[o + 5] = t
        }
        var u = new d.DrawArrays(d.primitiveSet.LINES, 0, 30),
            l = new d.Geometry;
        return l.getAttributes().Vertex = new d.BufferArray(d.BufferArray.ARRAY_BUFFER, r, 3), l.getPrimitives().push(u), l.getOrCreateStateSet().setAttributeAndModes(m()), l.getOrCreateStateSet().setAttributeAndModes(_), l
    }, x.createSpotGeometry = function (e) {
        var t = void 0 === e ? -1 : -e,
            i = 2 * Math.PI,
            n = new d.Geometry,
            r = new Float32Array(300),
            a = n.getAttributes().Vertex = new d.BufferArray(d.BufferArray.ARRAY_BUFFER, r, 3),
            o = 0,
            s = new Uint16Array(50);
        for (o = 0; o < 50; ++o) s[o] = 2 * o + 1;
        var u = new d.DrawElements(d.primitiveSet.LINE_LOOP, new d.BufferArray(d.BufferArray.ELEMENT_ARRAY_BUFFER, s, 1)),
            l = new Uint16Array(10);
        for (o = 0; o < 5; ++o) l[2 * o] = 20 * o, l[2 * o + 1] = 20 * o + 1;
        var c = new d.DrawElements(d.primitiveSet.LINES, new d.BufferArray(d.BufferArray.ELEMENT_ARRAY_BUFFER, l, 1));
        return n.getPrimitives().push(c, u), n.getOrCreateStateSet().setAttributeAndModes(m()), n.getOrCreateStateSet().setAttributeAndModes(_), n.updateCone = function (e, s) {
            var u = s ? 2 * -s : t,
                l = Math.cos(e) * u,
                c = Math.sin(e) * u;
            for (o = 0; o < 50; ++o) {
                var h = 6 * o,
                    d = i * o / 50;
                r[h + 3] = Math.cos(d) * c, r[h + 4] = Math.sin(d) * c, r[h + 5] = l
            }
            a.dirty(), n.dirtyBound()
        }, n.updateCone(.1), n
    }, x.createHemiGeometry = function (e) {
        for (var t = void 0 === e ? -1 : -e, i = new d.Geometry, n = new Float32Array(450), r = Math.PI, a = 0; a < 50; ++a) {
            var o = 3 * a,
                s = r * a / 49,
                u = Math.cos(s),
                l = Math.sin(s);
            n[o] = u * t, n[o + 2] = -l * t, n[150 + o + 1] = u * t, n[150 + o + 2] = -l * t, s = 2 * r * a / 49, n[300 + o] = Math.cos(s) * t, n[300 + o + 1] = Math.sin(s) * t
        }
        i.getAttributes().Vertex = new d.BufferArray(d.BufferArray.ARRAY_BUFFER, n, 3);
        var c = new d.DrawArrays(d.primitiveSet.LINE_STRIP, 0, 50),
            h = new d.DrawArrays(d.primitiveSet.LINE_STRIP, 50, 50),
            f = new d.DrawArrays(d.primitiveSet.LINE_STRIP, 100, 50);
        i.getPrimitives().push(c, h, f);
        var p = i.getOrCreateStateSet();
        return p.setAttributeAndModes(g()), p.setAttributeAndModes(_), p.addUniform(d.Uniform.createFloat(-t, "uRadius")), i
    }, x.createPointGeometry = function () {
        var e = 2 * Math.PI,
            t = new d.Geometry,
            i = new Float32Array(1350),
            n = t.getAttributes().Vertex = new d.BufferArray(d.BufferArray.ARRAY_BUFFER, i, 3),
            r = new d.DrawArrays(d.primitiveSet.LINE_STRIP, 0, 50),
            a = new d.DrawArrays(d.primitiveSet.LINE_STRIP, 50, 50),
            o = new d.DrawArrays(d.primitiveSet.LINE_STRIP, 100, 50);
        return t.getPrimitives().push(r, a, o), t.getOrCreateStateSet().setAttributeAndModes(m()), t.getOrCreateStateSet().setAttributeAndModes(_), t.updateRadius = function (r) {
            for (var a = 0; a < 50; ++a) {
                var o = 3 * a,
                    s = e * a / 49;
                i[o] = i[150 + o] = i[300 + o + 1] = Math.cos(s) * r, i[o + 1] = i[150 + o + 2] = i[300 + o + 2] = Math.sin(s) * r
            }
            n.dirty(), t.dirtyBound()
        }, t.updateRadius(1), t
    }, t.a = x
}, function (e, t) {
    e.exports = "#ifdef ICON\nattribute vec2 TexCoord0;\nvarying vec2 vTexCoord0;\n#endif\n\n#ifdef HEMI\nvarying vec3 vLocalVertex;\n#endif\n\nattribute vec3 Vertex;\n\nvarying vec4 vViewPos;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n#ifdef ICON\n  vTexCoord0 = TexCoord0;\n#endif\n\n#ifdef HEMI\n  vLocalVertex = Vertex;\n#endif\n\n  vViewPos = uModelViewMatrix * vec4(Vertex.xyz, 1.0);\n  gl_Position = uProjectionMatrix * vViewPos;\n}\n"
}, function (e, t) {
    e.exports = '#pragma include "utils/functions.glsl"\n#pragma include "utils/decodeDepth.glsl"\n\n#ifdef HEMI\nuniform vec4 uGround;\nvarying vec3 vLocalVertex;\nuniform float uRadius;\n#endif\n\n#ifdef ICON\nuniform sampler2D uTextureIcon;\nvarying vec2 vTexCoord0;\nuniform int uEnable;\n#endif\n\nvarying vec4 vViewPos;\nuniform vec2 uNearFar;\nuniform sampler2D uTextureDepth;\nuniform vec2 uGlobalTexSize;\nuniform vec2 uGlobalTexRatio;\n\nuniform vec4 uColor;\n\nvoid main(void) {\n  float distDepth = distanceToDepth(uTextureDepth, uGlobalTexRatio * gl_FragCoord.xy / uGlobalTexSize, vViewPos, uNearFar);\n  float alpha = distDepth < 0.0 ? 1.0 : 0.1;\n\n  // handles colors with values higher than 1\n  vec3 normColor = uColor.rgb / max(max(1.0, uColor.r), max(uColor.g, uColor.b));\n\n#ifdef HEMI\n  gl_FragColor = vec4(mix(uGround.rgb, normColor, vLocalVertex.z / uRadius), alpha);\n#endif\n\n#ifdef LINE\n  gl_FragColor = vec4(normColor, alpha);\n#endif\n\n#ifdef ICON\n  gl_FragColor = vec4(float(uEnable) * normColor, alpha) * texture2D(uTextureIcon, vTexCoord0);\n#endif\n\n  gl_FragColor.rgb *= gl_FragColor.a;\n\n  gl_FragColor.rgb = sRGBToLinear(gl_FragColor.rgb);\n}\n'
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = n.a.osg,
        a = {
            ambient: r.Uniform.createInt1(0, "uAmbient"),
            texture0: r.Uniform.createInt1(0, "uTexture0"),
            backgroundExposure: r.Uniform.createFloat(1, "uBackgroundExposure"),
            size: r.Uniform.createFloat(1, "uSize"),
            color: r.Uniform.createFloat3(r.vec3.fromValues(0, 0, 1), "uBackgroundColor"),
            scale: r.Uniform.createFloat2(r.vec2.fromValues(1, 1), "uFixedScale")
        };
    t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = n.a.osg,
        a = {
            environmentTransform: r.Uniform.createMatrix3("uEnvironmentTransform"),
            exposure: r.Uniform.createFloat1(1, "uEnvironmentExposure"),
            diffuseSPH: r.Uniform.createFloat3Array(new Float32Array(27), "uDiffuseSPH"),
            textureSpecular: r.Uniform.createInt1("sEnvironmentSpecular"),
            textureSpecularPBR: r.Uniform.createInt1("sSpecularPBR"),
            textureIntegrateBRDF: r.Uniform.createInt1("sIntegrateBRDF"),
            factorShadowEnv0: r.Uniform.createFloat(0, "uFactorShadowEnv0")
        };
    t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(69),
        a = i(85),
        o = i(1337),
        s = i(3),
        u = i.n(s),
        l = i(931),
        c = (i.n(l), n.a.osg),
        h = n.a.osgUtil,
        d = c.createTexturedQuadGeometry(-.5, -.5, 0, 1, 0, 0, 0, 1, 0),
        f = h.GizmoGeometry.createCylinderGeometry(.0025, .0025, 1, 8, 1, !1, !1),
        p = new c.MatrixTransform;
    p.getMatrix()[14] = .5, p.addChild(f), f._boundingBoxComputed = !0, f._boundingSphereComputed = !0;
    var m = function (e, t) {
        c.Node.call(this), this._idHotspot = e, this._viewer = t, this._hotspotMT = new c.MatrixTransform, this._cardPanel = new o.a, this._lineToCardMT = new c.MatrixTransform, this._hotspotMT.addChild(d), this.addChild(this._hotspotMT), this.addChild(this._lineToCardMT), this.addChild(this._cardPanel), this._cardPanel.setVisible(!1), this._lineToCardMT.setNodeMask(0), this._worldTeleportPos = void 0, this._cardInitialized = !1, this._texCard = new c.Texture, this._texCard.setTextureSize(1, 1), this._canTeleport = !1, this._uAlpha = void 0, this._color = void 0, this._lineToCardMT.addChild(p), this._hotspotMT._boundingBoxComputed = !0, this._hotspotMT._boundingSphereComputed = !0, this.init()
    };
    m.COLOR_NORMAL = c.vec3.fromValues(1, 1, 1), m.COLOR_HOVERED = c.vec3.fromValues(0, .8, 1), m.COLOR_DRAG_OK = c.vec3.fromValues(0, .4, 1), m.COLOR_DRAG_FAIL = c.vec3.fromValues(.8, .2, .2), m.initLineShader = function (e) {
        var t = f.getOrCreateStateSet();
        t.setAttributeAndModes(e), t.addUniform(c.Uniform.createFloat4(c.vec4.fromValues(.03, .59, .78, .4), "uLineColor")), t.setRenderBinDetails(a.a.TOOLTIP, "RenderBin")
    }, c.createPrototypeNode(m, c.objectInherit(c.Node.prototype, {
        init: function () {
            var e = this.getOrCreateStateSet();
            e.addUniform(c.Uniform.createFloat(this._idHotspot, "uHotspotIndex"));
            var t = c.Uniform.createFloat3(c.vec3.fromValues(1, 1, 1), "uColor");
            this._color = t.getInternalArray(), e.addUniform(t)
        },
        getIndex: function () {
            return this._idHotspot
        },
        getHotspotMatrix: function () {
            return this._hotspotMT.getMatrix()
        },
        getColor: function () {
            return this._color
        },
        isFullyVisibleCard: function () {
            return this._cardPanel.isVisible()
        },
        isVisibleCard: function () {
            return this._cardPanel.isHinted() || this._cardPanel.isVisible()
        },
        canTeleport: function () {
            return this._canTeleport && !this.isFullyVisibleCard()
        },
        setWorldTeleportPosition: function () {
            var e = c.vec3.create(),
                t = c.vec3.create(),
                i = c.vec3.create();
            return function (n, r, a) {
                if (!this.isFullyVisibleCard()) {
                    var o = this._cardPanel.getMatrix();
                    this._worldTeleportPos = c.vec3.copy(this._worldTeleportPos || c.vec3.create(), r), c.vec3.copy(i, r), i[2] += 1.5 * a, c.vec3.sub(t, n, i), t[2] = 0, c.vec3.normalize(t, t), c.vec3.scale(t, t, 1 * a), c.vec3.add(t, i, t), this.lookToWorld(o, t, i, a), c.vec3.sub(e, r, n);
                    var s = c.vec3.length(e);
                    c.vec3.sub(e, r, t);
                    var u = c.vec3.length(e),
                        l = s < u ? -1 : 1;
                    t[2] += .5 * l * .5625 * a;
                    var h = this._lineToCardMT.getMatrix();
                    this.lookToWorld(h, n, t, 1);
                    var d = c.vec3.dist(t, n);
                    c.vec3.set(e, a, a, d), c.mat4.scale(h, h, e), this._cardPanel.dirtyBound()
                }
            }
        }(),
        setCardVisibilityListener: function (e) {
            this._cardVisibilityListener = e
        },
        setVisibleCard: function (e) {
            this._isCardInitialized || this.initCard(), this._cardPanel.setVisible(e), this._lineToCardMT.setNodeMask(e ? r.a.NO_PICK : 0), this._cardVisibilityListener && this._cardVisibilityListener(this, e)
        },
        setVisible: function (e) {
            this.setNodeMask(e ? r.a.NO_PICK : 0)
        },
        setHovered: function (e) {
            this._isCardInitialized || this.initCard(), c.vec3.copy(this.getColor(), e ? m.COLOR_HOVERED : m.COLOR_NORMAL), this.isFullyVisibleCard() || (this._cardPanel.setHinted(e), this._lineToCardMT.setNodeMask(e ? r.a.NO_PICK : 0))
        },
        initCard: function () {
            var e = u()(".hotspots"),
                t = u()(e.get(0).childNodes[this._idHotspot]),
                i = this._viewer.getFeatures().hotspot._views[0]._hotspots;
            this._setDescriptionStyle(t, {
                width: "1024px",
                lineHeight: "2",
                fontSize: "38px"
            });
            var n = t.find(".description").outerHeight() + 4 * t.find(".title").outerHeight(),
                r = Math.max(1, Math.round(n / 576) + (n % 576 > 0 ? 1 : 0));
            this._setDescriptionStyle(t, null), this._cardPanel.initialize("skfb_front/macros/hotspot", {
                hotspotIndex: this._idHotspot,
                displayNavigation: i.length && i.length > 1,
                column: r,
                widthContent: 1024 * r,
                title: t.find(".title")[0].innerText,
                description: t.find(".description").html()
            }), this._isCardInitialized = !0
        },
        _setDescriptionStyle: function (e, t) {
            e.find(".description").css({
                width: null !== t ? t.width : "",
                lineHeight: null !== t ? t.lineHeight : "",
                fontSize: null !== t ? t.fontSize : ""
            })
        },
        updateCardHit: function (e) {
            this._hoveredCard = this._cardPanel.updateHit(e)
        },
        onCardHit: function (e) {
            this._isCallbackSetup || (this._setupCallback(e), this._isCallbackSetup = !0), this._hoveredCard ? this._cardPanel.click() : this._cardPanel.setVisible(!1)
        },
        _setupCallback: function (e) {
            this._cardPanel.setClickAction("closeButton", function () {
                this.setVisibleCard(!1)
            }.bind(this)), this._cardPanel.setClickAction("nextButton", function () {
                e.goToNextHotspot()
            }), this._cardPanel.setClickAction("prevButton", function () {
                e.goToPrevHotspot()
            })
        },
        lookToWorld: function () {
            var e = c.vec3.create(),
                t = c.vec3.fromValues(0, 0, -1),
                i = c.mat4.fromXRotation(c.mat4.create(), Math.PI);
            return function (n, r, a, o) {
                c.mat4.lookAt(n, r, a, t), c.mat4.multiply(n, i, n), c.mat4.invert(n, n), c.mat4.scale(n, n, c.vec3.set(e, o, o, o))
            }
        }(),
        updatePositionVR: function (e, t, i, n) {
            var r = this._hotspotMT.getMatrix(),
                a = e.get("lastComputedWorldPosition");
            i = Math.max(1.5 * i, .1 * n), i = Math.min(4 * i, i), this.lookToWorld(r, a, t, i);
            var o = 1 / 0;
            this._worldTeleportPos && (o = c.vec2.dist(this._worldTeleportPos, t));
            var s = o < .5 * n;
            this._canTeleport = !s, this._hotspotMT.dirtyBound()
        },
        updatePosition: function () {
            var e = c.vec3.create();
            return function (t, i, n, r) {
                var a = this._hotspotMT.getMatrix(),
                    o = t.get("lastComputedWorldPosition");
                c.mat4.copy(a, r), c.vec3.set(e, n, n, n), c.mat4.scale(a, a, e), c.mat4.setTranslation(a, o), this.isVisibleCard() && this.setVisibleCard(!1), this._hotspotMT.dirtyBound()
            }
        }()
    }), "osgSketchfab", "Hotspot"), t.a = m
}, function (e, t) {
    ! function () {
        (window.nunjucksPrecompiled = window.nunjucksPrecompiled || {})["skfb_front/macros/hotspot.jinja"] = function () {
            function e(e, t, i, n, r) {
                var a = null,
                    o = null;
                try {
                    var s = null,
                        u = n.makeMacro([], ["options"], function (r) {
                            var s = i;
                            i = new n.Frame, r = r || {}, r.hasOwnProperty("caller") && i.set("caller", r.caller), i.set("options", r.hasOwnProperty("options") ? r.options : {});
                            var u = "";
                            u += "\n";
                            var l;
                            l = 30, i.set("width_before", l, !0), i.topLevel && t.setVariable("width_before", l), i.topLevel && t.addExport("width_before", l), u += "\n";
                            var c;
                            c = 960, i.set("width_next", c, !0), i.topLevel && t.setVariable("width_next", c), i.topLevel && t.addExport("width_next", c), u += '\n        <div class="vr-hotspot-content" style="width:', u += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "widthContent"), e.opts.autoescape), u += 'px;" id="hotspot', u += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "hotspotIndex"), e.opts.autoescape), u += '">\n            <div class="cell" id="default" style="width:1024px;height:576px;position:absolute;top:0;left:0"></div>', i = i.push();
                            var h = (a = 5, o = 32, n.callWrap(n.contextOrFrameLookup(t, i, "range"), "range", t, [0, n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "column")]));
                            if (h)
                                for (var d = h.length, f = 0; f < h.length; f++) {
                                    var p = h[f];
                                    i.set("column", p), i.set("loop.index", f + 1), i.set("loop.index0", f), i.set("loop.revindex", d - f), i.set("loop.revindex0", d - f - 1), i.set("loop.first", 0 === f), i.set("loop.last", f === d - 1), i.set("loop.length", d), u += '<div class="page" id="column', u += n.suppressValue(p, e.opts.autoescape), u += '" style="width:1024px;height:576px;position:absolute;top:0;left:', u += n.suppressValue(1024 * p, e.opts.autoescape), u += 'px; overflow: visible">', p > 0 && (u += '<div style="width:40px;height:40px;position:absolute;top:250px;left:30px" class="vr-icon vr-icon-arrow-left-white"></div>\n                        <button id="prevPage" style="opacity:0; height: 100%; width:10%; top:0; position: absolute; left: 0;"></button>');
                                    var m;
                                    if (m = n.contextOrFrameLookup(t, i, "width_before") + 1024, i.set("width_before", m, !0), i.topLevel && t.setVariable("width_before", m), i.topLevel && t.addExport("width_before", m), u += '\n                    <div class="vr-hotspot-title">', u += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "title"), e.opts.autoescape), u += "</div>", p < 1 && (u += '<div class="vr-hotspot-description" style="column-count:', u += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "column"), e.opts.autoescape), u += ";width:", u += n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "widthContent"), e.opts.autoescape), u += 'px">', u += n.suppressValue(e.getFilter("safe").call(t, n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "description")), e.opts.autoescape), u += "</div>"), p + 1 < n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "column")) {
                                        u += '<button id="nextPage" style="opacity:0; height: 100%; width:10%; top:0; position: absolute; right: 0;"></button>\n                        <div style="width:40px;height:40px;position:absolute;top:250px;left:960px" class="vr-icon vr-icon-arrow-right-white"></div>\n                        ';
                                        var g;
                                        g = n.contextOrFrameLookup(t, i, "width_next") + 1024, i.set("width_next", g, !0), i.topLevel && t.setVariable("width_next", g), i.topLevel && t.addExport("width_next", g)
                                    }
                                    u += '<div class="vr-hotspot-footer">\n                        <div class="vr-hotspot-container-button" >', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "displayNavigation") ? u += '<button id="prevButton" class="vr-hotspot-button">Prev</button>\n                                <button id="closeButton" class="vr-hotspot-button">Close annotation</button>\n                                <button id="nextButton" class="vr-hotspot-button">Next</button>' : u += '<button id="closeButton" class="vr-hotspot-button">Close annotation</button>', u += "</div>\n                    </div>\n                </div>"
                                }
                            return i = i.pop(), u += "</div>\n", i = s, new n.SafeString(u)
                        });
                    t.addExport("panel"), t.setVariable("panel", u), s ? s.rootRenderFunc(e, t, i, n, r) : r(null, "")
                } catch (e) {
                    r(n.handleError(e, a, o))
                }
            }
            return {
                root: e
            }
        }()
    }()
}, function (e, t) {
    e.exports = "attribute vec3 Vertex;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying float vHeight;\n\nvoid main(void) {\n  vHeight = Vertex.z;\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xyz, 1.0));\n}\n"
}, function (e, t) {
    e.exports = 'uniform vec3 uColor;\nuniform float uAlpha;\nuniform int uOutputLinear;\n\nvarying float vHeight;\n\n#pragma include "utils/functions.glsl"\n\nvoid main(void) {\n  vec4 color = vec4(uColor, 1.0) * uAlpha * smoothstep(1.0, 0.0, pow(vHeight, 0.3));\n\n  gl_FragColor = uOutputLinear == 0 ? linearTosRGB(color) : color;\n}\n'
}, function (e, t) {
    e.exports = "attribute vec3 Vertex;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec3 vLocalVertex;\n\nvoid main(void) {\n  vLocalVertex = Vertex;\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xyz, 1.0));\n}\n"
}, function (e, t) {
    e.exports = 'varying vec3 vLocalVertex;\n\nuniform int uOutputLinear;\nuniform float uAlpha;\n\n#pragma include "utils/functions.glsl"\n\nvoid main(void) {\n  vec4 color = linearTosRGB(vec4(0.1, 0.66, 0.85, 1.0)) * (smoothstep(1.0, 0.0, vLocalVertex.y) * smoothstep(1.0, 0.0, abs(vLocalVertex.x * 4.0))) * uAlpha;\n\n  gl_FragColor = color;\n}\n'
}, function (e, t) {
    ! function () {
        (window.nunjucksPrecompiled = window.nunjucksPrecompiled || {})["skfb_front/macros/vr/vr-menu.jinja"] = function () {
            function e(e, t, i, n, r) {
                var a = "";
                try {
                    var o = null,
                        s = n.makeMacro([], ["options"], function (e) {
                            var r = i;
                            i = new n.Frame, e = e || {}, e.hasOwnProperty("caller") && i.set("caller", e.caller), i.set("options", e.hasOwnProperty("options") ? e.options : {});
                            var a = "";
                            return a += '\n\n<div style="width:700px;">', n.memberLookup(n.contextOrFrameLookup(t, i, "options"), "hasHotspotsNavigation") && (a += '<div class="vr-menu-row">\n            <button  id="vrPrevButton" class="vr-button vr-button-small">\n                <div style="width:100px;height:100px;margin:auto" class="vr-icon vr-icon-arrow-left-white"></div>                \n            </button>\n            <span class="vr-localize-icon">\n                <div style="width:100px;height:100px;margin:auto" class="vr-icon vr-icon-map-marker-white"></div>                                \n            </span>\n            <button id="vrNextButton" class="vr-button vr-button-small">\n                <div style="width:100px;height:100px;margin:auto" class="vr-icon vr-icon-arrow-right-white"></div>                                \n            </button>\n        </div>'), a += '<button id="vrHomeButton" class="vr-button">Home</button>\n    <button id="vrHelpButton" class="vr-button">Help</button>\n    <button id="vrExitButton" class="vr-button vr-round-button">\n        <div style="width:100px;height:100px;margin:auto" class="vr-icon vr-icon-times-white"></div>            \n    </button>\n</div>\n', i = r, new n.SafeString(a)
                        });
                    t.addExport("panel"), t.setVariable("panel", s), a += "\n", o ? o.rootRenderFunc(e, t, i, n, r) : r(null, a)
                } catch (e) {
                    r(n.handleError(e, null, null))
                }
            }
            return {
                root: e
            }
        }()
    }()
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(85),
        a = n.a.osg,
        o = n.a.osgUtil,
        s = function () {
            o.DisplayNormalVisitor.call(this), this._tangentStateSet.setRenderBinDetails(r.a.DEBUG, "RenderBin"), this._normalStateSet.setRenderBinDetails(r.a.DEBUG, "RenderBin")
        };
    a.createPrototypeObject(s, a.objectInherit(o.DisplayNormalVisitor.prototype, {
        apply: function (e, t) {
            e instanceof a.Geometry && e.getCullCallback() || o.DisplayNormalVisitor.prototype.apply.call(this, e, t)
        }
    })), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = n.a.osg,
        a = r.mat4.fromRotation(r.mat4.create(), .5 * Math.PI, r.vec3.fromValues(1, 0, 0)),
        o = r.mat4.fromRotation(r.mat4.create(), .5 * -Math.PI, r.vec3.fromValues(1, 0, 0)),
        s = function () {
            window.updateARKit = this._onARKitEvent.bind(this), this._cameraListeners = [], this._planeListeners = []
        };
    s.prototype = {
        update: function () {
            if (!this._lastARKitData) return !0;
            for (var e = 0; e < this._cameraListeners.length; e++) this._cameraListeners[e].onCameraChange(this._lastARKitData.camera, this._lastARKitData.projection);
            if (this._lastARKitData.planes.length)
                for (var t = 0; t < this._planeListeners.length; t++) this._planeListeners[t].onPlanesChange(this._lastARKitData.planes);
            return !0
        },
        _onARKitEvent: function (e) {
            this._lastARKitData = e
        },
        getCameraMatrix: function (e, t) {
            r.mat4.multiply(e, t, o)
        },
        getMatrixTransformFromARPlane: function () {
            var e = r.vec3.create(),
                t = r.mat4.create();
            return function (i, n) {
                r.vec3.set(e, n.center[0], n.center[1], n.center[2]), r.mat4.fromTranslation(i, e), r.mat4.multiply(i, n.transform, i);
                var o = r.vec3.set(e, n.extent[0], 1, n.extent[2]);
                r.mat4.multiply(i, i, r.mat4.fromScaling(t, o)), r.mat4.multiply(i, a, i)
            }
        }(),
        addCameraListener: function (e) {
            this._cameraListeners.push(e)
        },
        addPlaneListener: function (e) {
            this._planeListeners.push(e)
        }
    };
    var u = new s;
    t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(24),
        r = i.n(n),
        a = i(3),
        o = i.n(a),
        s = i(0),
        u = (i.n(s), i(180));
    t.a = u.a.extend({
        el: ['<div class="widget slider-widget">', '          <div class="widget-wrapper">', '              <div class="bar">', '                  <div class="slide">', '                      <div class="cursor"></div>', "                  </div>", "              </div>", "          </div>", "      </div>"].join(""),
        events: Object(s.extend)({}, u.a.prototype.events, {
            "mousedown .bar": "trackDrag",
            "mousedown .cursor": "cursorDrag",
            "touchstart .bar": "trackDrag",
            "touchstart .cursor": "cursorDrag"
        }),
        constructor: function (e, t) {
            t = Object(s.defaults)(t || {}, {
                model: new r.a.Model,
                name: "value",
                minimum: 0,
                maximum: 1,
                step: .01,
                orientation: "horizontal"
            }), u.a.prototype.constructor.call(this, e, t), void 0 === this.get() && this.set(0)
        },
        initialize: function () {
            this.$slide = this.$(".slide"), "vertical" === this.options.orientation && this.$el.addClass("--vertical"), this.started = !1, this.render()
        },
        delegateEvents: function () {
            u.a.prototype.delegateEvents.apply(this, arguments), o()(window).on("mousemove.delegateEvents" + this.cid, this.moveEvent.bind(this)), o()(window).on("mouseup.delegateEvents" + this.cid, this.stopEvent.bind(this)), o()(window).on("touchmove.delegateEvents" + this.cid, this.moveEvent.bind(this)), o()(window).on("touchend.delegateEvents" + this.cid, this.stopEvent.bind(this))
        },
        undelegateEvents: function () {
            u.a.prototype.undelegateEvents.apply(this, arguments), o()(window).off(".delegateEvents" + this.cid)
        },
        render: function () {
            var e = this.options.maximum - this.options.minimum,
                t = (this.get() - this.options.minimum) / e * 100,
                i = {};
            "vertical" === this.options.orientation ? i.height = t + "%" : i.width = t + "%", this.$slide.css(i)
        },
        startEvent: function (e) {
            e.preventDefault(), this.$el.addClass("fast"), this.started = !0
        },
        stopEvent: function (e) {
            this.started && (e.preventDefault(), this.$el.removeClass("fast"), this.started = !1)
        },
        moveEvent: function (e) {
            this.started && (e.preventDefault(), this.selectEvent(e))
        },
        selectEvent: function (e) {
            e.preventDefault();
            var t, i;
            if ("horizontal" === this.options.orientation) {
                var n = this.$el.offset().left,
                    r = this.$el.width();
                i = e.pageX, void 0 === i && (i = e.originalEvent.touches[0].pageX), t = (i - n) / r
            } else if ("vertical" === this.options.orientation) {
                var a = this.$el.offset().top,
                    o = this.$el.height();
                i = e.pageY, i || (i = e.originalEvent.touches[0].pageY), t = (a + o - i) / o
            }
            t = Math.min(Math.max(0, t), 1), t = this.options.minimum + t * (this.options.maximum - this.options.minimum), this.change(t)
        },
        cursorDrag: function (e) {
            this.startEvent(e), e.stopPropagation()
        },
        trackDrag: function (e) {
            this.startEvent(e), this.moveEvent(e)
        }
    })
}, function (e, t, i) {
    "use strict";
    i.d(t, "b", function () {
        return C
    });
    var n = i(3),
        r = i.n(n),
        a = i(0),
        o = (i.n(a), i(2)),
        s = i(38),
        u = i.n(s),
        l = i(342),
        c = i(13),
        h = i(475),
        d = i(53),
        f = i(20),
        p = i(271),
        m = i(1463),
        g = i(22),
        v = i(4),
        _ = i(717),
        b = i(100),
        S = i(14),
        x = S.a.shortcuts;
    Object(f.a)().uiInspector ? (x.inspectorControl.shortcuts[0].keyCombinations = "1", x.inspectorControl.shortcuts[1].keyCombinations = "2", x.inspectorControl.shortcuts[2].keyCombinations = "3", x.inspectorControl.shortcuts[3].keyCombinations = "4", x.viewerRendering.shortcuts[0].keyCombinations = "", x.viewerRendering.shortcuts[1].keyCombinations = "", x.viewerRendering.shortcuts[2].keyCombinations = "", x.viewerRendering.shortcuts[3].keyCombinations = "5") : (x.inspectorControl.shortcuts[0].keyCombinations = "", x.inspectorControl.shortcuts[1].keyCombinations = "", x.inspectorControl.shortcuts[2].keyCombinations = "", x.inspectorControl.shortcuts[3].keyCombinations = "");
    var y = new h.a(x.viewerRendering),
        C = function (e) {
            var t = [{
                    title: "Off",
                    className: "colors-none",
                    dataSetting: "wireframeEnable",
                    dataValue: "0"
                }, {
                    title: "Black",
                    className: "colors-black",
                    dataSetting: "wireframeColor",
                    dataValue: "000000FF"
                }, {
                    title: "White",
                    className: "colors-white",
                    dataSetting: "wireframeColor",
                    dataValue: "ffffffFF"
                }, {
                    title: "Red",
                    className: "colors-red",
                    dataSetting: "wireframeColor",
                    dataValue: "ff0000FF"
                }, {
                    title: "Blue",
                    className: "colors-blue",
                    dataSetting: "wireframeColor",
                    dataValue: "0000FFFF"
                }, {
                    title: "Green",
                    className: "colors-green",
                    dataSetting: "wireframeColor",
                    dataValue: "00FF00FF"
                }, {
                    title: "Yellow",
                    className: "colors-yellow",
                    dataSetting: "wireframeColor",
                    dataValue: "FFFF00FF"
                }],
                i = o.default.getFromString('<a           class="{{ className }} {{ "active" if isActive else "" }}"           data-setting="{{ dataSetting }}"           data-value="{{ dataValue }}"           title="{{ title }}">        </a>');
            return o.default.getFromString('<p class="wireframe-title">        Wireframe         <span class="shortcut" title="Keyboard shortcut">           {{ shortcut | safe }}        </span>        </p>        <div class="wireframe-colors">           {{ colorItems | safe }}        </div>')({
                shortcut: y.getShortDescriptionById("toggleWireframe"),
                colorItems: t.map(function (t) {
                    return i(Object(a.extend)({}, t, {
                        isActive: e.wireframeColor === t.dataValue
                    }))
                }).join("")
            })
        },
        T = function (e) {
            var t = o.default.getFromString('    <div class="setting-list-header">               <a class="back control-menu-back">Back</a>               <span class="setting-list-header-help">Key</span>           </div>            <ul class="setting-list" data-setting="{{ name }}">                {{ listItems | safe }}            </ul>            {{ wireframe | safe }}'),
                i = e.viewerSettings.hasWireframe,
                n = e.viewerSettings.wireframeColor;
            return t(Object(a.extend)({}, e, {
                wireframe: i ? C({
                    wireframeColor: n
                }) : ""
            }))
        },
        w = {};
    Object(f.a)().uiInspector || (w.shadingStyle = {
        label: "Rendering",
        settings: [{
            label: "Lit",
            value: "lit",
            shortcut: y.getShortDescriptionById("defaultRenderingMode")
        }, {
            label: "Shadeless",
            value: "shadeless",
            shortcut: y.getShortDescriptionById("shadelessRenderingMode")
        }, {
            label: "MatCap",
            value: "matcap",
            shortcut: y.getShortDescriptionById("matcapRenderingMode")
        }],
        paneTemplate: T,
        order: 2
    }), t.a = p.a.extend({
        events: {
            "click .help": "onHelpClick",
            "click .vr": "onVrClick",
            "click .fullscreen": "onFullscreenClick",
            "click .theatre": "onTheatreClick",
            "touchend .control.tooltip": "replaceDOMElement"
        },
        constructor: function () {
            this.fullScreenChange = this.fullScreenChange.bind(this), this.onVrClick = this.onVrClick.bind(this), this.onFullscreenClick = this.onFullscreenClick.bind(this), this.onTheatreClick = this.onTheatreClick.bind(this), p.a.prototype.constructor.apply(this, arguments)
        },
        initialize: function () {
            p.a.prototype.initialize.apply(this, arguments), this.enableVR = !1, this.wasClicked = this.$el.parents(".model-container").hasClass("theatre"), !_.a.hasFullscreen() && Object(l.default)() && window.self === window.top && (this.viewer.$el.addClass("no-fullscreen"), this.viewer.$el.find(".controls .settings").addClass("shift-menu-left")), this.initializeTheatreMode(), this.viewer.on("model-loaded", this.updateNavigationSettings.bind(this))
        },
        delegateEvents: function () {
            p.a.prototype.delegateEvents.apply(this, arguments), this.onFullScreenChange(this.fullScreenChange), this.viewer.proxySettings.on("change", this.renderSettings, this), this.viewer.on("model-loaded", this.setModelListeners.bind(this))
        },
        undelegateEvents: function () {
            if (p.a.prototype.undelegateEvents.apply(this, arguments), !this.$el) return this;
            this.offFullScreenChange(this.fullScreenChange), this.viewer.proxySettings.off("change", this.renderSettings, this), this.viewer.on("model-loaded", this.removeModelListeners.bind(this))
        },
        setModelListeners: function () {
            this.viewer.scene.getFeatures().animation.getModel().get("animations").on("add remove reset", this.renderSettings, this);
            var e = this.viewer.scene.getFeatures().camera.getModel();
            this.listenTo(e, "change:useCameraConstraints", this.updateNavigationSettings.bind(this))
        },
        removeModelListeners: function () {
            this.viewer.scene.getFeatures().animation.getModel().get("animations").off("add remove reset", this.renderSettings, this);
            var e = this.viewer.scene.getFeatures().camera.getModel();
            this.stopListening(e, "change:useCameraConstraints", this.updateNavigationSettings.bind(this))
        },
        setHasAnimations: function (e) {
            this.hasAnimations = e
        },
        getSettingLabelForValue: function (e, t) {
            return Object(a.find)(w[e].settings, function (e) {
                return e.value === t
            }).label
        },
        getEmbedUrl: function (e) {
            var t = g.b.craft(Object(a.extend)({}, Object(b.a)(location.search), e || {}));
            return this.viewer._currentModel.get("embedUrl") + "?" + t
        },
        onHelpClick: function (e) {
            e.preventDefault(), e.stopPropagation(), c.a.modelViewerHelpButtonCliked(), this.viewer.subviews.helpOverlay.show()
        },
        generateTextureQualitySettings: function (e) {
            w.textureQuality = {
                label: "Textures",
                group: "textureQuality",
                settings: [{
                    label: "LD",
                    value: "0"
                }, {
                    label: "SD",
                    value: "1"
                }, {
                    label: "HD",
                    value: "2"
                }],
                order: 5
            };
            var t = ["low", "mid", "high"],
                i = 0;
            t.forEach(function (t, n) {
                if (!e[t]) {
                    w.textureQuality.settings.splice(n - i, 1), i++
                }
            }.bind(this)), Object(a.last)(w.textureQuality.settings).label = "HD", this.renderSettings()
        },
        updateNavigationSettings: function () {
            this.viewer.scene.getFeatures().camera.getModel().get("useCameraConstraints") ? delete w.viewerMode : w.viewerMode || (w.viewerMode = {
                label: "Navigation",
                settings: [{
                    label: "Orbit",
                    value: "0"
                }, {
                    label: "First Person",
                    value: "1"
                }],
                order: 4
            }), this.renderSettings()
        },
        renderSettings: function () {
            if (Object(a.isEmpty)(w)) return void this.$(".control.settings").hide();
            this.$(".control.settings").show(), this.settings || (this.settings = new m.a({
                el: this.$(".settings-menu"),
                viewer: this.viewer,
                settings: w
            })), this.settings.render()
        },
        onVrClick: function (e) {
            e.stopPropagation(), this.widgets.hotspots && (this.widgets.hotspots.hideTooltips(), this.widgets.hotspots.currentHotspot = -1, this.widgets.hotspots.renderControl());
            var t = this.viewer.scene.getFeatures().webVR.getModel();
            void 0 !== navigator.getVRDisplays ? (t.set("enable", !t.get("enable")), c.a.modelViewerVrButtonClicked("nativeVR")) : u.a.any ? (this.fullscreenVR(e), c.a.modelViewerVrButtonClicked("mobile")) : (this.openVrInstructions(), c.a.modelViewerVrButtonClicked("desktop"))
        },
        openVrWindow: function () {
            this.viewer._currentModel && window.open(this.getEmbedUrl({
                cardboard: 1,
                autostart: 1
            }), "skfbCardboard", "menubar=no,toolbar=no")
        },
        openVrInstructions: function () {
            this.viewer._currentModel.sharing().then(function () {
                var e = this.viewer._currentModel.get("sharing").shortUrl;
                this.viewer.subviews.helperVrOverlay.setUrl(e), this.viewer.subviews.helperVrOverlay.show()
            }.bind(this))
        },
        initializeTheatreMode: function () {
            this._theatreActive = "false" !== d.a.get("sb_theatre_mode", "false")
        },
        isTheatreActive: function () {
            return this._theatreActive
        },
        onTheatreClick: function (e) {
            e.stopPropagation(), e.preventDefault();
            var t = this.isTheatreActive(),
                i = v.a.me().get("isAnonymous"),
                n = i && !this.wasClicked;
            return this.wasClicked = !0, this.viewer.trigger(t && !n ? "leaveTheatreMode" : "enterTheatreMode"), d.a.set("sb_theatre_mode", !t), this._theatreActive = !t, !1
        },
        onFullscreenClick: function (e, t) {
            if (e.stopPropagation(), _.a.hasFullscreen()) {
                var i = _.a.isFullscreen();
                c.a.modelViewerFullscreenButtonClicked(!i), i ? _.a.exitFullscreen() : _.a.requestFullscreen(this.viewer.el)
            } else t ? this.openVrWindow() : this.openFakeFullscreen()
        },
        openFakeFullscreen: function () {
            this.viewer._currentModel && (u.a.any ? window.open(this.getEmbedUrl()) : window.open(this.getEmbedUrl(), "skfbFullscreenFallback", "menubar=no,toolbar=no"))
        },
        onFullScreenChange: function (e) {
            _.a.onFullScreenChange(e)
        },
        offFullScreenChange: function (e) {
            _.a.offFullScreenChange(e)
        },
        fullScreenChange: function () {
            r()('[data-action="fullscreen"] > .icon').toggleClass("icon-fullscreen-icon").toggleClass("icon-fullscreen-off-icon"), this.viewer.$el.toggleClass("fullscreen", _.a.isFullscreen()), this.viewer.scene.trigger("resizeViewerOnNextFrame", -1, -1);
            var e = this.viewer.scene.getFeatures().webVR;
            if (e) {
                var t = e.getModel();
                _.a.isFullscreen() ? !0 === this.enableVR && t.set("enable", !0) : !0 === this.enableVR && (t.set("enable", !1), this.enableVR = !1)
            }
        },
        fullscreenVR: function (e) {
            return this.enableVR = !0, this.onFullscreenClick(e, !0)
        },
        replaceDOMElement: Object(a.debounce)(function (e) {
            var t = e.target.parentElement,
                i = e.target.nextSibling;
            t && (t.removeChild(e.target), Object(a.defer)(function () {
                t.insertBefore(e.target, i)
            }))
        }, 2e3)
    })
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(9)),
        a = r.a.osg,
        o = function (e) {
            this._model = void 0 !== e ? e.model : void 0, this._viewer = void 0 !== e ? e.viewer : void 0, this._scene = void 0 !== e ? e.scene : void 0, this._widgetAPI = void 0 !== e ? e.widgetAPI : void 0, this._features = {}
        };
    o.prototype = {
        getModel: function () {
            return this._model
        },
        getFeatures: function () {
            return this._features
        },
        getViewer: function () {
            return this._viewer
        },
        getScene: function () {
            return this._scene
        },
        getWidgetAPI: function () {
            return this._widgetAPI
        },
        addFeature: function (e) {
            if (e) {
                var t = e.getName();
                this._features[t] ? a.error("Feature already added" + t) : this._features[t] = e
            }
            return this._features
        },
        getModelByName: function (e) {
            if (e) {
                var t = Object(n.find)(this._features, function (t) {
                    var i = t.getModel();
                    return !(!i || !i.getName) && i.getName() === e
                });
                return t ? t.getModel() : void 0
            }
        },
        getViewsByName: function (e) {
            if (e) {
                var t = [];
                return Object(n.forEach)(this._features, function (i) {
                    if (i) {
                        var n = i._views.filter(function (t) {
                            return !!t.getName && t.getName() === e
                        });
                        Array.prototype.push.apply(t, n)
                    }
                }), t
            }
        }
    }, t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(572),
        r = i(5),
        a = i.n(r),
        o = i(0),
        s = (i.n(o), i(424)),
        u = i.n(s),
        l = i(9),
        c = i(14),
        h = i(8),
        d = i(79),
        f = i(181),
        p = i(313),
        m = i(715),
        g = i(583),
        v = i(1474),
        _ = i(77),
        b = i(941),
        S = i(1475),
        x = i(1477),
        y = i(582),
        C = i(20),
        T = i(44),
        w = i(1480),
        M = i(101),
        E = i(635),
        A = i(47),
        P = i(103),
        R = i(86),
        O = i(1496),
        I = i(585),
        F = i(704),
        N = i(709),
        D = i(163),
        L = i(199),
        k = i(147),
        V = i(907),
        B = i(944),
        U = l.a.osg,
        G = l.a.osgViewer,
        j = new u.a({
            device: "VWR"
        }),
        z = function (e) {
            if (e.byteLength) return Array.prototype.slice.call(e)
        },
        H = function (e) {
            return Object(o.cloneDeepWith)(e, z)
        },
        W = function (e) {
            this._dataScene = e, this._modelFile = this.selectModelFile(), this._rootModel = new U.Node, this._rootModel.setName("Scene - Root"), this._polygonNode = new U.Node, this._polygonNode.setName("Scene - PolygonNode"), this._wireframeNodes = [], this._resourcePromises = [], this._cleanLegacyAbsoluteUrl()
        };
    W.prototype = {
        addResourcePromise: function (e) {
            this._resourcePromises.push(e)
        },
        getJSON: function () {
            return this._dataScene
        },
        getPolygonURL: function () {
            return this._modelFile.osgjsUrl
        },
        getWireframeURL: function () {
            return this._modelFile.wireframeUrl
        },
        getOsgjsSize: function () {
            return this._modelFile.osgjsSize
        },
        getPolygonSize: function () {
            return this._modelFile.modelSize
        },
        getWireframeSize: function () {
            return this._modelFile.wireframeSize
        },
        getResourceManager: function () {
            return this._resourceManager || _.default.instance
        },
        getRootModel: function () {
            return this._rootModel
        },
        getWireframeNodes: function () {
            return this._wireframeNodes
        },
        createOptionDownload: function (e, t, i) {
            return {
                node: i,
                progress: t,
                binarySize: "polygon" === e ? this.getPolygonSize() : this.getWireframeSize(),
                binaryKey: e,
                osgjsSize: this.getOsgjsSize(),
                osgjsKey: "osgjs",
                secondary: !1
            }
        },
        loadPolygon: function (e, t, i, n) {
            var r = this.createOptionDownload("polygon", e, this._polygonNode);
            if (t) {
                var a = n ? e : void 0;
                r.wireframeOptions = this.createOptionDownload("wireframe", a), r.wireframeOptions.startPromise = i, r.wireframeOptions.deferDownload = new R.a, r.wireframeOptions.nodes = this.getWireframeNodes(), n && this._resourcePromises.push(r.wireframeOptions.deferDownload);
                var o = U.Timer.instance().tick();
                r.wireframeOptions.deferDownload.then(function () {
                    A.a.resolveWireframe({
                        time: U.Timer.instance().tick() - o
                    })
                })
            }
            var s = this.getResourceManager().getOrCreateModel(this.getPolygonURL(), r);
            return this.getRootModel().addChild(this._polygonNode), this.getResourceManager().run(), s.promise
        },
        loadWireframeLegacy: function (e) {
            var t = this.createOptionDownload("wireframe", e, new U.Node);
            t.node.setStateSet(new N.a);
            var i = this.getResourceManager().getOrCreateModel(this.getWireframeURL(), t);
            return this.getWireframeNodes().push(t.node), this.getRootModel().addChild(t.node), i.promise
        },
        selectModelFile: function () {
            var e = Object(d.a)() || Object(C.a)().apiVersion || Object(M.a)() ? 0 : 1;
            void 0 !== Object(C.a)().modelOptimization && (e = Object(C.a)().modelOptimization ? 1 : 0);
            for (var t = this._dataScene.files, i = 0; i < t.length; ++i)
                if (t[i].flag === e) return t[i];
            return t[0]
        },
        _cleanLegacyAbsoluteUrl: function () {
            var e = this._dataScene.options && this._dataScene.options.materials;
            if (e) {
                var t = this.getPolygonURL(),
                    i = t.substr(0, t.lastIndexOf("/") + 1);
                for (var n in e) {
                    var r = e[n].channels;
                    for (var a in r) {
                        var o = r[a],
                            s = o.texture;
                        s && (s.image && (s.image = i.concat(s.image)), s.url && (s.url = i.concat(s.url)))
                    }
                }
            }
        }
    };
    var q = h.a.extend({
        initialize: function () {
            if (h.a.prototype.initialize.apply(this, arguments), !this.options.model) throw new Error("no model provided to ViewerWebGL");
            Object(C.a)().preferOriginalNormalMap = this.options.model.get("preferOriginalNormalMap"), D.a.client.setTagsContext({
                frontend: "3d"
            }), this._root = null, this._features = this.options.features, this._widgetAPI = this.options.widgetAPI, this._viewerAPI = this.options.viewerAPI, this._progressManager = new O.a(this.trigger.bind(this)), this._widgetAPI && this._widgetAPI.getTabbedWidget().model.on("change", T.a.draw), _.default.instance.setModelUid(this.model.get("uid")), this._featuresInstancied = {};
            var e = this.$(".canvas"),
                t = e[0];
            t.oncontextmenu = function () {
                return !1
            }, this._initOptions(), U.Geometry.enableVAO = Object(C.a)().useVao, (0 === Object(C.a)().asyncShader || Object(k.a)()) && A.a.resolveAsyncShaderCompilation();
            var i = this._viewer = new G.Viewer(t, {
                powerPreference: Object(C.a)().powerPreference,
                antialias: !1,
                depth: !1,
                stencil: !1,
                alpha: this._requireAlphaContext(),
                premultipliedAlpha: !0,
                fullscreen: !1,
                overrideDevicePixelRatio: Object(C.a)().pratio,
                preserveDrawingBuffer: Object(C.a)().preserveDrawingBuffer,
                enableFrustumCulling: !1,
                maxDevicePixelRatio: 1.5,
                InputSources: {
                    Mouse: {
                        scrollwheel: Object(C.a)().scrollwheel
                    },
                    Keyboard: {
                        sourceElement: e[0]
                    },
                    WebVR: {
                        pollInterval: -1
                    },
                    GamePad: {
                        enable: !1
                    }
                }
            });
            L.a.init(i.getInputManager()), i.getState().getExcludeUniforms().uDrawOpaque = !0, i.getState().getExcludeUniforms().uQVT = !0, i.getState().getExcludeUniforms().uQVS = !0, i.getState().getExcludeUniforms().uQW = !0, i.getViewerStats() && i.getViewerStats().addConfig(this._createOptionStats());
            var n = U.TimerGPU.instance();
            Object(C.a)().webglTimerGpu && (n.setFrameAverageCount(20), n.enable()), E.a.setTimerGPU(n);
            var r = Object(f.a)();
            this._contextLostCount = r ? 0 : Object(C.a)().webglRestore, this._restoreContextBinded = this.restoreContext.bind(this), i.setContextRestoreCallback(this.requestRestoreContext.bind(this)), i.setContextLostCallback(function () {
                return U.warn("Context Lost"), Object(V.a)(!1), this._contextLostCount++, !0
            }.bind(this)), w.a.register(i.getState().getShaderGeneratorProxy());
            for (var a = Object(y.a)(), o = i.getState(), s = 0; s < a; s++) o.setGlobalDefaultTextureAttribute(s, U.Texture.textureNull);
            i.requestContinuousUpdate(Object(C.a)().continuousRender), e[0].setAttribute("tabindex", "0"), i.init();
            var u = this.getCamera();
            u.getRenderer().setCullVisitor(new g.a), i.setupManipulator(), this._rootScene = new U.MatrixTransform, this._rootScene.setName("Root scene"), u.setClearColor(U.vec4.fromValues(.25, .3, .3, 1)), i.setSceneData(this._rootScene), T.a.setViewer(i), this._superSample = new v.a(this), T.a.setSuperSample(this._superSample), this._superSample.setRoot(this._rootScene), i.getManipulator().computeHomePosition(), Object(C.a)().forceMs ? i._requestAnimationFrame = function (e) {
                window.setTimeout(e, Object(C.a)().forceMs)
            } : i._requestAnimationFrame = p.a.get(), Object(C.a)().asyncShader && this._setShaderAsyncCompilation(), i.run(), this._currentScene = void 0, D.a.client.setTagsContext({
                frontend: "web"
            })
        },
        _initOptions: function () {
            var e = this.options.model;
            void 0 === e.get("options").version && (e.get("options").version = c.a.optionsVersion), U.time("processModelJSON"), Object(S.a)(e), U.timeEnd("processModelJSON"), Object(C.a)().processOptions && e.set("options", {
                version: c.a.optionsVersion,
                sound: {},
                orientation: {},
                wireframe: {},
                scene: {},
                hotspot: {},
                materials: {},
                environment: {},
                vr: {},
                camera: {},
                lighting: {},
                background: {},
                shading: {},
                animation: {}
            })
        },
        updateProgress: function (e, t, i) {
            this._progressManager.updateProgress(e, t, i)
        },
        setFakeSecondaryProgress: function (e, t) {
            this._progressManager.setFakeProgress(e, !0, t)
        },
        setFakePrimaryProgress: function (e, t) {
            this._progressManager.setFakeProgress(e, !1, t)
        },
        setFakeProgress: function (e, t, i) {
            this._progressManager.setFakeProgress(e, t, i)
        },
        requestRestoreContext: function () {
            if (this._contextLostCount < 3) return void this.restoreContext();
            new(0, i(34).default)({
                title: "3D/WebGL context error",
                text: "Your browser seems to have hit its 3D capability limit. The page needs to be reloaded to fix this. <br/>If the problems persists, you can try to close other tabs with 3D/WebGL or restart your browser entirely.",
                safe: !0,
                buttons: {
                    continue: !0,
                    continueLabel: "Reload Current Page",
                    cancel: !1
                }
            }).open().then(function () {
                window.location.reload()
            }.bind(this))
        },
        restoreContext: function () {
            if (Object(F.b)()) return void document.addEventListener(Object(F.a)(), this._restoreContextBinded);
            if (this._featuresManager) {
                var e = this._featuresManager._features;
                if (e) {
                    if (e.postProcess) {
                        var t = e.postProcess.getModel();
                        t.set("enable", !1), t.set("enable", !0)
                    }
                    e.quality && e.material && (e.quality.getModel().trigger("updateTexelPolicy"), I.a.resetCaches(), I.a.packAllMaterialsTextures(e.material.getModel().getMaterials())), T.a.draw(), document.removeEventListener(Object(F.a)(), this._restoreContextBinded)
                }
            }
        },
        getModelUID: function () {
            return this.model.get("uid")
        },
        _requireAlphaContext: function () {
            if (Object(d.a)() || Object(C.a)().transparent || Object(C.a)().arkit) return !0;
            var e = this.options.model.get("options");
            return "none" === (e && e.background && e.background.enable)
        },
        _getLower: function (e, t) {
            for (var i = [], n = 0, r = e.length; n < r; ++n) i.push(e[n]), t[i[n]] = {
                caption: e[n],
                average: !0
            };
            return i
        },
        _createOptionStats: function () {
            var e = ["EarlyOpaque", "EarlyTransparency", "ShadingOpaque", "ShadingTransparency", "ShadingRefraction", "Extra"],
                t = ["ShadowMap0", "ShadowMap1", "ShadowMap2", "ShadowMap3"],
                i = ["Total GL", "Shading", "PostProcess", "ShadowMap"],
                n = {};
            return {
                values: n,
                groups: [{
                    name: i[0],
                    caption: "GL Total (ms)",
                    values: this._getLower(i, n)
                }, {
                    name: i[1],
                    caption: "GL Shading (ms)",
                    values: this._getLower(e, n)
                }, {
                    name: i[2],
                    caption: "GL PostProcess (ms)",
                    values: []
                }, {
                    name: i[3],
                    caption: "GL ShadowMap (ms)",
                    values: this._getLower(t, n)
                }]
            }
        },
        setOptionStatsPostProcess: function (e) {
            var t = {},
                i = [{
                    name: "PostProcess",
                    caption: "GL PostProcess (ms)",
                    values: this._getLower(e, t)
                }],
                n = this._viewer.getViewerStats();
            n.addConfig({
                values: t,
                groups: i
            }), n.update()
        },
        getRootUserData: function () {
            return this._currentScene ? this.getRootModel().userDataMap || {} : {}
        },
        getRootScene: function () {
            return this._rootScene
        },
        getRootModel: function () {
            return this._currentScene.getRootModel()
        },
        getWidth: function () {
            return this._viewer.getCanvasWidth()
        },
        getHeight: function () {
            return this._viewer.getCanvasHeight()
        },
        getOptions: function () {
            return this.options
        },
        isViewerReady: function () {
            return A.a.getModelDisplayed()
        },
        getViewerAPI: function () {
            return this._viewerAPI
        },
        createContext: function (e) {
            return new b.a({
                model: e.model,
                viewer: this,
                scene: e.scene,
                widgetAPI: this._widgetAPI
            })
        },
        loadWireframeLegacy: function (e, t) {
            var i = e.loadWireframeLegacy(t),
                n = U.Timer.instance().tick();
            return i.then(function () {
                A.a.resolveWireframe({
                    time: U.Timer.instance().tick() - n
                })
            }), i
        },
        _dataSizePromisesResolve: function (e) {
            A.a.resolveDataSizeOSGJS(e.getOsgjsSize()), A.a.resolveDataSizePolygon(e.getPolygonSize()), A.a.getHasSound().then(function (e) {
                var t = 0;
                if (e) {
                    this.getFeatures().sound.getModel("soundtracks").get("soundtracks").each(function (e) {
                        var i = e.get("size");
                        i && (t += i)
                    })
                }
                A.a.resolveDataSizeSound(t)
            }.bind(this))
        },
        hasIntegratedWireframe: function () {
            var e = this._currentScene;
            return !e._modelFile.wireframeUrl || !e._modelFile.wireframeSize
        },
        run: function () {
            var e = this.options.model,
                t = this,
                n = this.getOrCreateScene(e.toJSON()),
                r = e.get("options"),
                o = n.getJSON().animationCount > 0 || Object(d.a)() && r.animation && r.animation.order && e.get("options").animation.order.length > 0;
            A.a.resolveHasAnimation(o), this._dataSizePromisesResolve(n);
            var s = this.createContext({
                    model: e,
                    scene: n
                }),
                u = n._resourcePromises,
                l = Object(C.a)().preload,
                c = n._modelFile,
                h = !0 === e.get("options").wireframe.enable && !0 === l && void 0 !== c.wireframeSize && c.wireframeSize > 0,
                f = this.hasIntegratedWireframe();
            A.a.resolveDataSizeWireframe(c.wireframeSize || 0);
            var p = h ? a.a.resolve() : A.a.getHighResLoaded(),
                m = n.loadPolygon(this.updateProgress.bind(this), f, p, h);
            u.push(m);
            var g = U.Timer.instance().tick();
            m.then(function () {
                A.a.resolvePolygon({
                    time: U.Timer.instance().tick() - g
                })
            }), !f && h && u.push(this.loadWireframeLegacy(n, this.updateProgress.bind(this))), Object(C.a)().cleanShader && u.push(i.e(14).then(function () {
                window.glslesPreprocessor = i(1718)
            }.bind(null, i)).catch(i.oe)), U.time("createAndInitFeatures"), t._features.forEach(function (e) {
                t.addFeature(e, s)
            }), U.timeEnd("createAndInitFeatures"), this._progressManager.initPrimaryProgress(n.getOsgjsSize(), n.getPolygonSize(), h ? n.getWireframeSize() : 0);
            var v;
            Object(F.b)() && (v = setInterval(function () {
                T.a.draw()
            }, 200), A.a.getInitialTextureBoundPromise().then(function () {
                clearInterval(v)
            })), a.a.all(u).then(this._launchViewer.bind(this, s, f, h, g)), this._featuresInstancied = s.getFeatures();
            var _ = this._featuresInstancied.material.getModel().getMaterials();
            return I.a.setMaterials(_), A.a.getModelDisplayed()
        },
        _setShaderAsyncCompilation: function () {
            A.a.getMaterial().then(function () {
                var e = this._viewer.getCamera();
                e.setFinalDrawCallback(function () {
                    return Object(B.b)() > 0 ? (Object(B.d)(), void this._viewer.requestRedraw()) : Object(B.b)() < 0 ? void this._viewer.requestRedraw() : (e.setFinalDrawCallback(void 0), void A.a.resolveAsyncShaderCompilation())
                }.bind(this))
            }.bind(this))
        },
        _launchViewer: function (e, t, i, r) {
            U.time("featureFinished"), this.featureFinished(e, this._rootScene), U.timeEnd("featureFinished"), t || i || A.a.getHighResLoaded().then(this.loadWireframeLegacy.bind(this, this._currentScene, void 0)), U.time("wait async"), (A.a.getAsyncShaderCompilation().isFulfilled() ? A.a.getInitialTextureBoundPromise() : a.a.all([A.a.getAsyncShaderCompilation(), A.a.getInitialTextureBoundPromise()])).then(function () {
                this.trigger("primary-progress", {
                    progress: 1
                }), U.timeEnd("wait async"), n.default.logBound(P.a.getModelBoxWithoutDisplacement()), n.default.showMessage(), this._onViewerLaunched(r)
            }.bind(this))
        },
        _startAnimation: function () {
            this._featuresInstancied.animation.getModel().trigger("afterFirstVisibleFrame")
        },
        _afterTabVisible: function () {
            var e, t = Object(F.a)();
            e = function () {
                this._featuresManager.setInitialAnimation(), this._startAnimation(), document.removeEventListener(t, e)
            }.bind(this), document.addEventListener(t, e)
        },
        _hasFocusTab: function () {
            var e = Object(F.a)();
            return !Object(F.b)() || !e
        },
        _onViewerLaunched: function (e) {
            var t = this._hasFocusTab();
            if (t && this._featuresManager.setInitialAnimation(), this.drawFrame(), t ? this._startAnimation() : this._afterTabVisible(), A.a.resolveModelDisplayed({
                    time: U.Timer.instance().tick() - e
                }), this.trigger("success"), this.trigger("viewerready"), Object(C.a)().messaging) {
                j.createMessage({
                    data: "ready"
                }).appendToHash()
            }
        },
        onFail: function (e, t) {
            U.error(t.stack), e.reject(t), this.trigger("failure")
        },
        addFeature: function (e, t) {
            if (!e) return console.warn("Feature undefined!"), !0;
            var i = new e;
            if (i.init(t), Object(d.a)()) {
                var n = i.getModel(),
                    r = i.getName();
                n.editorSetJSON && !window.editorModels[r] && (window.editorModels[r] = {
                    setJSON: this._makeCallbackSetJSON(n),
                    getJSON: this._makeCallbackGetJSON(n)
                })
            }
        },
        _makeCallbackSetJSON: function (e) {
            return function (t) {
                var i = e.editorSetJSON(H(t));
                return i && i.then ? i : i ? a.a.reject(i) : a.a.resolve()
            }
        },
        _makeCallbackGetJSON: function (e) {
            return function () {
                var t = e.editorGetJSON();
                return a.a.resolve(H(t))
            }
        },
        drawFrame: function () {
            this._viewer.requestRedraw(), this._viewer.frame()
        },
        getCanvas: function () {
            return this._viewer.getGraphicContext().canvas
        },
        getInputManager: function () {
            return this._viewer.getInputManager()
        },
        setTimeline: function (e) {
            this._timeline = e
        },
        getTimeline: function () {
            return this._timeline
        },
        getScreenShot: function (e, t, i) {
            return Object(m.a)(e, t, this, i)
        },
        getCamera: function () {
            return this._viewer.getCamera()
        },
        getFeatures: function () {
            return this._featuresInstancied
        },
        getSuperSample: function () {
            return this._superSample
        },
        getFeaturesManager: function () {
            return this._featuresManager
        },
        getViewerOSGJS: function () {
            return this._viewer
        },
        getOrCreateScene: function (e) {
            if (this._currentScene) return this._currentScene;
            var t = new W(e);
            return t.getResourceManager().setStateContextOSG(this._viewer.getState()), this._currentScene = t, t
        },
        featureFinished: function (e, t) {
            return this._featuresManager = new x.a(this, e), this._featuresManager.finished(t)
        },
        getOptionsJSON: function () {
            var e = this.getFeatures(),
                t = {};
            t.version = c.a.optionsVersion, t.background = e.background.getModel().getJSON(), t.environment = e.environment.getModel().getJSON(), t.lighting = e.lighting.getModel().getJSON(), t.materials = e.material.getModel().getJSON(), t.orientation = e.orientation.getModel().getJSON(), t.camera = e.camera.getModel().getJSON(), t.animation = e.animation.getModel().getJSON(), t.hotspot = e.hotspot.getModel().getJSON(), t.vr = e.webVR.getModel().getJSON(), t.scene = t.scene || {}, t.scene.postProcess = e.postProcess.getModel().getJSON(), t.scene.sssProfiles = e.postProcess.getModel().getProfilesJSON(), t.sound = e.sound.getModel().getJSON(), t.ground = e.ground.getModel().getJSON();
            var i = e.shadingStyle.getModel().getJSON();
            return t.shading = i.shading, t.wireframe = i.wireframe, S.a.readOptions(t)
        }
    });
    t.a = q
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(44),
        a = n.a.osg,
        o = n.a.osgUtil,
        s = o.NodeGizmo,
        u = function () {
            s.apply(this, arguments), this._forcePicking = !1
        };
    a.createPrototypeNode(u, a.objectInherit(s.prototype, {
        setForcePicking: function (e) {
            this._forcePicking = e
        },
        onMouseUp: function (e) {
            this.isEditing() && r.a.draw();
            var t = this._attachedNode;
            s.prototype.onMouseUp.call(this, e), t !== this._attachedNode && r.a.draw(), this._forcePicking && !this._attachedNode && (this._attachedNode = t)
        },
        onMouseMove: function (e) {
            var t = this._hoverNode;
            s.prototype.onMouseMove.call(this, e), this.isEditing() && r.a.redrawShadow(), (this.isEditing() || t !== this._hoverNode) && r.a.draw()
        }
    }), "osgSketchfab", "NodeGizmo"), t.a = u
}, function (e, t, i) {
    "use strict";
    i.d(t, "b", function () {
        return a
    }), i.d(t, "a", function () {
        return o
    }), i.d(t, "d", function () {
        return s
    }), i.d(t, "c", function () {
        return u
    });
    var n = i(47),
        r = -1,
        a = function () {
            return r
        },
        o = function (e) {
            r += e
        },
        s = function () {
            r = 0
        },
        u = function () {
            return n.a.getInitialTextureBoundPromise().isFulfilled()
        }
}, function (e, t, i) {
    e.exports = i.p + "sketchfab-white-white-a67a66d0659dfcc7a39aefd3c415435d.svg"
}, function (e, t, i) {
    e.exports = i.p + "sketchfab-blue-white-c2ea5d067dbe2a711f547cb07163e424.svg"
}, function (e, t, i) {
    e.exports = i.p + "cardboard-instructions-c04f2ea47a37bada5956a3e0acd288d3.svg"
}, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(11)),
        a = i(145),
        o = i(598),
        s = i(14);
    t.a = r.a.extend(Object(n.extend)({}, a.a, {
        endpoint: function () {
            return "/environments/" + this.get("uid")
        }
    }), Object(o.a)({
        fileTypes: s.a.environmentFiletypes,
        maxFileSize: s.a.maxEnvironmentFilesize
    }))
}, function (e, t, i) {
    "use strict";
    var n = i(49),
        r = i.n(n),
        a = i(3),
        o = i.n(a),
        s = i(11),
        u = i(631),
        l = i(598),
        c = i(14);
    t.a = s.a.extend({
        save: function (e, t) {
            null != e && "object" !== (void 0 === e ? "undefined" : r()(e)) || (t = e);
            var i = new FormData;
            return i.append("imageFile", this.get("imageFile")), i.append("modelUid", t.modelUID), o.a.ajax({
                url: this.url(),
                data: i,
                processData: !1,
                contentType: !1,
                type: "POST"
            })
        },
        endpoint: function () {
            return "/backgrounds" + (this.isNew() ? "" : "/" + this.get("uid"))
        }
    }, Object(l.a)({
        fileTypes: c.a.backgroundFiletypes,
        maxFileSize: c.a.maxBackgroundFilesize
    })).extend(u.a)
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(599)),
        a = i(42),
        o = i(1),
        s = i(986),
        u = i(915),
        l = i(374);
    t.a = a.a.extend(Object(n.extend)({
        optionTypes: {
            modelUid: o.b.string
        },
        model: r.a,
        url: function () {
            return Object(l.a)("textures", this.options.modelUid, this.options.checkPrefetch)
        },
        comparator: function (e, t) {
            return "None" === e.get("label") ? -1 : "None" === t.get("label") ? 1 : Object(s.a)(e.get("label"), t.get("label"))
        },
        isValid: function () {
            this.each(function (e) {
                e.isValid()
            })
        },
        getImageFromURL: function (e) {
            var t = e.split("/").pop();
            return this.find(function (e) {
                var i = !1;
                return e.get("images").forEach(function (e) {
                    i || -1 !== e.url.indexOf(t) && (i = !0)
                }), i
            })
        }
    }, u.a))
}, function (e, t, i) {
    "use strict";

    function n(e, t) {
        var i, r, o = /(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,
            s = /(^[ ]*|[ ]*$)/g,
            u = /(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,
            l = /^0x[0-9a-f]+$/i,
            c = /^0/,
            h = function (e) {
                return n.insensitive && ("" + e).toLowerCase() || "" + e
            },
            d = h(e).slice(0, 50).replace(s, "") || "",
            f = h(t).slice(0, 50).replace(s, "") || "",
            p = d.replace(o, "\0$1\0").replace(/\0$/, "").replace(/^\0/, "").split("\0"),
            m = f.replace(o, "\0$1\0").replace(/\0$/, "").replace(/^\0/, "").split("\0"),
            g = parseInt(d.match(l)) || 1 !== p.length && d.match(u) && Date.parse(d),
            v = parseInt(f.match(l)) || g && f.match(u) && Date.parse(f) || null;
        if (v) {
            if (g < v) return -1;
            if (g > v) return 1
        }
        for (var _ = 0, b = Math.max(p.length, m.length); _ < b; _++) {
            if (i = !(p[_] || "").match(c) && parseFloat(p[_]) || p[_] || 0, r = !(m[_] || "").match(c) && parseFloat(m[_]) || m[_] || 0, isNaN(i) !== isNaN(r)) return isNaN(i) ? 1 : -1;
            if ((void 0 === i ? "undefined" : a()(i)) !== (void 0 === r ? "undefined" : a()(r)) && (i += "", r += ""), i < r) return -1;
            if (i > r) return 1
        }
        return 0
    }
    var r = i(49),
        a = i.n(r);
    t.a = n
}, function (e, t, i) {
    "use strict";
    var n = i(49),
        r = i.n(n),
        a = i(5),
        o = i.n(a),
        s = i(3),
        u = i.n(s),
        l = i(11),
        c = i(631),
        h = i(598),
        d = i(14);
    t.a = l.a.extend({
        endpoint: function () {
            return "/matcaps" + (this.isNew() ? "" : "/" + this.get("uid"))
        },
        save: function (e, t) {
            null != e && "object" !== (void 0 === e ? "undefined" : r()(e)) || (t = e);
            var i = new FormData;
            return i.append("imageFile", this.get("imageFile"), this.get("name")), i.append("modelUid", t.modelUID), o.a.resolve(u.a.ajax({
                url: this.url(),
                data: i,
                processData: !1,
                contentType: !1,
                type: "POST"
            }))
        },
        getProxyImage: function () {
            var e = this.findImageSmallest();
            return e || console.error("MISSING IMAGE DATA!"), {
                label: this.get("name"),
                value: this.get("uid") || this.get("id"),
                image: e.url,
                imageModel: this,
                deletable: !this.get("isDefault")
            }
        }
    }, Object(h.a)({
        fileTypes: d.a.matcapFiletypes,
        maxFileSize: d.a.maxMatcapFilesize
    })).extend(c.a)
}, function (e, t, i) {
    "use strict";
    t.a = ["4024128cf8904b69946e891caac5f305", "b83e3a8794ae47e0b4039e7fdb031602", "16cdcddf277d423d99094f8db0c731e9", "efd4ef0fc18a4ec0a1313d782fade965", "675ff0f13b474c62947097939fe9aa1e", "df5b82c5ccec42cbb9c5ba9528f0be52", "491ddabd93aa49ecb5ad36538f7d00e3", "02751cd893a14f3986fb17a90245f64f", "78a54c2fd53a4ba4891a4bbdac7f30f7", "956bb00775a044e7afdd1c17f6bdab63", "003c1543cd754a19a0e14bc89726ccf5", "268447ca0a954f44b06d1387863d114e", "80fba9759ab94307a782f38d359b8ea8", "e73867d210de4bc2b5eb261738cf3e79", "2e9c3708feb74137b0436f946b8b66b8", "591b2c2db5744df1803a09d477f5a2c7"]
}, , , , function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(71)),
        a = i(939),
        o = i(13);
    t.a = a.a.extend({
        el: ['<div class="widget slider-widget volume-slider-widget">', '          <div class="widget-wrapper">', '              <a class="fa fa-volume-up"></a>', '              <div class="bar">', '                  <div class="slide">', '                      <div class="cursor"></div>', "                  </div>", "              </div>", "          </div>", "      </div>"].join(""),
        events: Object(n.extend)({}, a.a.prototype.events, {
            "click .fa": "onoff",
            "touchstart .fa": "onoff"
        }),
        constructor: function (e, t) {
            t = Object(n.defaults)(t || {}, {
                name: "volume",
                minimum: 0,
                maximum: 1,
                step: .1
            }), a.a.prototype.constructor.call(this, e, t)
        },
        initialize: function () {
            a.a.prototype.initialize.apply(this, arguments), this.isMute = 0 === this.get(), this.value = this.get(), this.model.on("change:" + this.options.name, Object(r.a)(function () {
                0 === this.get() ? (this.isMute = !0, this.mute(this.$(".fa"))) : this.isMute && (this.isMute = !1, this.unmute(this.$(".fa")))
            }.bind(this)))
        },
        mute: function (e) {
            e.removeClass("fa-volume-up").addClass("fa-volume-off")
        },
        unmute: function (e) {
            e.removeClass("fa-volume-off").addClass("fa-volume-up")
        },
        onoff: function () {
            this.isMute ? (0 !== this.value && null !== this.value || (this.value = 1), this.model.set("mute", !1), this.set(this.value), this.model.set("playing", !0), o.a.modelViewerMuteButtonClicked(0)) : (this.value = this.get(), this.set(0), this.model.set("mute", !0), o.a.modelViewerMuteButtonClicked(1))
        },
        cursorDrag: function () {
            a.a.prototype.cursorDrag.apply(this, arguments), this.value = null
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(90),
        r = i(1456),
        a = {
            FeatureName: "saveUI",
            ModelName: "Material",
            ViewListType: [r.a]
        };
    t.a = n.a.create(a)
}, function (e, t, i) {
    "use strict";
    var n = i(49),
        r = i.n(n),
        a = i(11),
        o = i(17);
    t.a = a.a.extend({
        save: function (e, t) {
            return null != e && "object" !== (void 0 === e ? "undefined" : r()(e)) || (t = e), o.a.createThumbnail({
                imageFile: this.get("imageFile"),
                source: this.get("source"),
                modelUid: t.modelUID
            })
        },
        endpoint: function () {
            return "/thumbnails"
        }
    })
}, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , function (e, t, i) {
    "use strict";
    var n = i(670),
        r = i(42),
        a = i(1),
        o = i(374);
    t.a = r.a.extend({
        optionTypes: {
            modelUid: a.b.string
        },
        comparator: "order",
        model: n.a,
        url: function () {
            return Object(o.a)("hotspots", this.options.modelUid, this.options.checkPrefetch)
        }
    })
}, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , function (e, t, i) {
    "use strict";
    var n = i(90),
        r = i(1067),
        a = i(1193),
        o = i(47),
        s = {
            FeatureName: "animation",
            ModelType: r.a,
            ViewListType: [a.a]
        },
        u = !1;
    o.a.getHasAnimation().then(function (e) {
        e && (u = e)
    });
    var l = n.a.create(s);
    l.prototype.prepareForScreenShot = function () {
        return !!u && (this._oldPlayingAnimation = this.getModel().get("playing"), this.getModel().set("playing", !1), !0)
    }, l.prototype.resetAfterScreenShot = function () {
        this._oldPlayingAnimation && this.getModel().set("playing", !0)
    }, t.a = l
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(149)),
        a = i(79),
        o = i(77),
        s = i(20),
        u = i(101),
        l = r.a.extend({
            getModelOptionPath: function () {
                return "animation"
            },
            defaults: function () {
                var e = this.getResourceManager().getAnimationCollection(),
                    t = [];
                return Object(a.a)() || (t = e.remove(e.where({
                    isEnabled: !1
                }))), {
                    animations: e,
                    disabledAnimations: t,
                    currentUID: "-1",
                    playing: !0,
                    fps: -1,
                    progress: 0
                }
            },
            getName: function () {
                return "Animation"
            },
            getResourceManager: function () {
                return this._resourceManager || o.default.instance
            },
            getAnimationByUID: function (e) {
                return this.get("animations").find(function (t) {
                    return t.get("uid") === e
                })
            },
            getCurrentAnimation: function () {
                return this.getAnimationByUID(this.get("currentUID"))
            },
            canActivateTAA: function () {
                return !this.isPlaying() || Object(s.a)().taaAnimation
            },
            isPlaying: function () {
                return !!this.get("animations").length && (!!this.get("playing") && "-1" !== this.get("currentUID"))
            },
            getEnabledAnimationsCount: function () {
                return this.get("animations").where({
                    isEnabled: !0
                }).length
            },
            getFirstEnabledAnimation: function () {
                for (var e = this.get("animations"), t = e.length, i = 0; i < t; ++i) {
                    var n = e.at(i);
                    if (n && n.get("isEnabled")) return n
                }
            },
            init: function (e) {
                this._viewer = e.getViewer();
                var t = e.getModel().get("options"),
                    i = t.animation;
                i && i.order && (this.setJSON(i), this.set("playing", Object(s.a)().animationAutoplay))
            },
            setJSON: function (e, t) {
                var i = t || {};
                i.ignore = ["order"], r.a.prototype.setJSON.call(this, e, i);
                var a = this.get("animations"),
                    o = Object(n.invert)(e.order);
                a.forEach(function (e) {
                    e.set("order", parseInt(o[e.get("uid")], 10))
                }), a.sort()
            },
            getJSON: function () {
                for (var e = r.a.prototype.getJSON.call(this), t = this.get("animations").pluck("uid"), i = this.get("disabledAnimations"), n = 0; n < i.length; ++n) t.push(i[n].get("uid"));
                return e.order = t, !Object(u.a)() && this.getEnabledAnimationsCount() && (e.initializeWithRestPose = "-1" === this.get("currentUID")), e
            }
        });
    t.a = l
}, function (e, t, i) {
    "use strict";
    var n = i(1069),
        r = (i.n(n), i(842)),
        a = i(843),
        o = i(1095),
        s = i(1098),
        u = i(1100),
        l = i(1104),
        c = i(1116),
        h = i(891),
        d = i(1126),
        f = i(1131),
        p = i(1132),
        m = i(1133),
        g = i(1134),
        v = i(907),
        _ = r.a;
    _.osg = a.default, _.osgAnimation = o.a, _.osgDB = s.a, _.osgGA = u.a, _.osgUtil = l.a, _.osgViewer = c.a, _.osgShader = h.a, _.osgShadow = d.a, _.osgStats = f.a, _.osgText = p.a, _.osgWrappers = m.a, _.osgPlugins = g.a, _.InputGroups = c.a.InputGroups, _.globalify = function () {
        window.osg = _.osg, window.osgAnimation = _.osgAnimation, window.osgDB = _.osgDB, window.osgGA = _.osgGA, window.osgUtil = _.osgUtil, window.osgViewer = _.osgViewer, window.osgShader = _.osgShader, window.osgShadow = _.osgShadow, window.osgStats = _.osgStats, window.osgText = _.osgText, window.osgWrappers = _.osgWrappers, window.osgPlugins = _.osgPlugins, window.InputGroups = _.InputGroups
    }, Object(v.b)(_), t.a = _
}, function (e, t) {
    function i(e, t) {
        t = t || {
            bubbles: !1,
            cancelable: !1,
            detail: void 0
        };
        var i = document.createEvent("CustomEvent");
        return i.initCustomEvent(e, t.bubbles, t.cancelable, t.detail), i
    }
    if (window.Set && window.Map && window.Uint8ClampedArray) {
        if (Math.sign || (Math.sign = function (e) {
                return e > 0 ? 1 : e < 0 ? -1 : 0
            }), Math.log2 || (Math.log2 = function (e) {
                return Math.log(e) * Math.LOG2E
            }), Math.log10 || (Math.log10 = function (e) {
                return Math.log(e) * Math.LOG10E
            }), String.prototype.endsWith || (String.prototype.endsWith = function (e) {
                return this.slice(-e.length) === e
            }), String.prototype.startsWith || (String.prototype.startsWith = function (e) {
                return this.slice(0, e.length) === e
            }), !Float32Array.prototype.slice) {
            var n = function (e, t) {
                return new this.constructor(this.subarray(e, t))
            };
            Int8Array.prototype.slice = n, Uint8Array.prototype.slice = n, Uint8ClampedArray.prototype.slice = n, Int16Array.prototype.slice = n, Uint16Array.prototype.slice = n, Int32Array.prototype.slice = n, Uint32Array.prototype.slice = n, Float32Array.prototype.slice = n, Float64Array.prototype.slice = n
        }
        if (!new window.Set(["test"]).has("test")) {
            var r = window.Set;
            window.Set = function (e) {
                var t = new r;
                if (e)
                    for (var i = 0; i < e.length; ++i) t.add(e[i]);
                return t
            }
        }
        "object" == typeof window.Event && (i.prototype = window.Event.prototype, window.Event = i)
    }
}, function (e, t, i) {
    t.glMatrix = i(361), t.mat2 = i(1071), t.mat2d = i(1072), t.mat3 = i(845), t.mat4 = i(1073), t.quat = i(1074), t.vec2 = i(1075), t.vec3 = i(846), t.vec4 = i(847)
}, function (e, t, i) {
    var n = i(361),
        r = {};
    r.create = function () {
        var e = new n.ARRAY_TYPE(4);
        return e[0] = 1, e[1] = 0, e[2] = 0, e[3] = 1, e
    }, r.clone = function (e) {
        var t = new n.ARRAY_TYPE(4);
        return t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[3], t
    }, r.copy = function (e, t) {
        return e[0] = t[0], e[1] = t[1], e[2] = t[2], e[3] = t[3], e
    }, r.identity = function (e) {
        return e[0] = 1, e[1] = 0, e[2] = 0, e[3] = 1, e
    }, r.fromValues = function (e, t, i, r) {
        var a = new n.ARRAY_TYPE(4);
        return a[0] = e, a[1] = t, a[2] = i, a[3] = r, a
    }, r.set = function (e, t, i, n, r) {
        return e[0] = t, e[1] = i, e[2] = n, e[3] = r, e
    }, r.transpose = function (e, t) {
        if (e === t) {
            var i = t[1];
            e[1] = t[2], e[2] = i
        } else e[0] = t[0], e[1] = t[2], e[2] = t[1], e[3] = t[3];
        return e
    }, r.invert = function (e, t) {
        var i = t[0],
            n = t[1],
            r = t[2],
            a = t[3],
            o = i * a - r * n;
        return o ? (o = 1 / o, e[0] = a * o, e[1] = -n * o, e[2] = -r * o, e[3] = i * o, e) : null
    }, r.adjoint = function (e, t) {
        var i = t[0];
        return e[0] = t[3], e[1] = -t[1], e[2] = -t[2], e[3] = i, e
    }, r.determinant = function (e) {
        return e[0] * e[3] - e[2] * e[1]
    }, r.multiply = function (e, t, i) {
        var n = t[0],
            r = t[1],
            a = t[2],
            o = t[3],
            s = i[0],
            u = i[1],
            l = i[2],
            c = i[3];
        return e[0] = n * s + a * u, e[1] = r * s + o * u, e[2] = n * l + a * c, e[3] = r * l + o * c, e
    }, r.mul = r.multiply, r.rotate = function (e, t, i) {
        var n = t[0],
            r = t[1],
            a = t[2],
            o = t[3],
            s = Math.sin(i),
            u = Math.cos(i);
        return e[0] = n * u + a * s, e[1] = r * u + o * s, e[2] = n * -s + a * u, e[3] = r * -s + o * u, e
    }, r.scale = function (e, t, i) {
        var n = t[0],
            r = t[1],
            a = t[2],
            o = t[3],
            s = i[0],
            u = i[1];
        return e[0] = n * s, e[1] = r * s, e[2] = a * u, e[3] = o * u, e
    }, r.fromRotation = function (e, t) {
        var i = Math.sin(t),
            n = Math.cos(t);
        return e[0] = n, e[1] = i, e[2] = -i, e[3] = n, e
    }, r.fromScaling = function (e, t) {
        return e[0] = t[0], e[1] = 0, e[2] = 0, e[3] = t[1], e
    }, r.str = function (e) {
        return "mat2(" + e[0] + ", " + e[1] + ", " + e[2] + ", " + e[3] + ")"
    }, r.frob = function (e) {
        return Math.sqrt(Math.pow(e[0], 2) + Math.pow(e[1], 2) + Math.pow(e[2], 2) + Math.pow(e[3], 2))
    }, r.LDU = function (e, t, i, n) {
        return e[2] = n[2] / n[0], i[0] = n[0], i[1] = n[1], i[3] = n[3] - e[2] * i[1], [e, t, i]
    }, r.add = function (e, t, i) {
        return e[0] = t[0] + i[0], e[1] = t[1] + i[1], e[2] = t[2] + i[2], e[3] = t[3] + i[3], e
    }, r.subtract = function (e, t, i) {
        return e[0] = t[0] - i[0], e[1] = t[1] - i[1], e[2] = t[2] - i[2], e[3] = t[3] - i[3], e
    }, r.sub = r.subtract, r.exactEquals = function (e, t) {
        return e[0] === t[0] && e[1] === t[1] && e[2] === t[2] && e[3] === t[3]
    }, r.equals = function (e, t) {
        var i = e[0],
            r = e[1],
            a = e[2],
            o = e[3],
            s = t[0],
            u = t[1],
            l = t[2],
            c = t[3];
        return Math.abs(i - s) <= n.EPSILON * Math.max(1, Math.abs(i), Math.abs(s)) && Math.abs(r - u) <= n.EPSILON * Math.max(1, Math.abs(r), Math.abs(u)) && Math.abs(a - l) <= n.EPSILON * Math.max(1, Math.abs(a), Math.abs(l)) && Math.abs(o - c) <= n.EPSILON * Math.max(1, Math.abs(o), Math.abs(c))
    }, r.multiplyScalar = function (e, t, i) {
        return e[0] = t[0] * i, e[1] = t[1] * i, e[2] = t[2] * i, e[3] = t[3] * i, e
    }, r.multiplyScalarAndAdd = function (e, t, i, n) {
        return e[0] = t[0] + i[0] * n, e[1] = t[1] + i[1] * n, e[2] = t[2] + i[2] * n, e[3] = t[3] + i[3] * n, e
    }, e.exports = r
}, function (e, t, i) {
    var n = i(361),
        r = {};
    r.create = function () {
        var e = new n.ARRAY_TYPE(6);
        return e[0] = 1, e[1] = 0, e[2] = 0, e[3] = 1, e[4] = 0, e[5] = 0, e
    }, r.clone = function (e) {
        var t = new n.ARRAY_TYPE(6);
        return t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[3], t[4] = e[4], t[5] = e[5], t
    }, r.copy = function (e, t) {
        return e[0] = t[0], e[1] = t[1], e[2] = t[2], e[3] = t[3], e[4] = t[4], e[5] = t[5], e
    }, r.identity = function (e) {
        return e[0] = 1, e[1] = 0, e[2] = 0, e[3] = 1, e[4] = 0, e[5] = 0, e
    }, r.fromValues = function (e, t, i, r, a, o) {
        var s = new n.ARRAY_TYPE(6);
        return s[0] = e, s[1] = t, s[2] = i, s[3] = r, s[4] = a, s[5] = o, s
    }, r.set = function (e, t, i, n, r, a, o) {
        return e[0] = t, e[1] = i, e[2] = n, e[3] = r, e[4] = a, e[5] = o, e
    }, r.invert = function (e, t) {
        var i = t[0],
            n = t[1],
            r = t[2],
            a = t[3],
            o = t[4],
            s = t[5],
            u = i * a - n * r;
        return u ? (u = 1 / u, e[0] = a * u, e[1] = -n * u, e[2] = -r * u, e[3] = i * u, e[4] = (r * s - a * o) * u, e[5] = (n * o - i * s) * u, e) : null
    }, r.determinant = function (e) {
        return e[0] * e[3] - e[1] * e[2]
    }, r.multiply = function (e, t, i) {
        var n = t[0],
            r = t[1],
            a = t[2],
            o = t[3],
            s = t[4],
            u = t[5],
            l = i[0],
            c = i[1],
            h = i[2],
            d = i[3],
            f = i[4],
            p = i[5];
        return e[0] = n * l + a * c, e[1] = r * l + o * c, e[2] = n * h + a * d, e[3] = r * h + o * d, e[4] = n * f + a * p + s, e[5] = r * f + o * p + u, e
    }, r.mul = r.multiply, r.rotate = function (e, t, i) {
        var n = t[0],
            r = t[1],
            a = t[2],
            o = t[3],
            s = t[4],
            u = t[5],
            l = Math.sin(i),
            c = Math.cos(i);
        return e[0] = n * c + a * l, e[1] = r * c + o * l, e[2] = n * -l + a * c, e[3] = r * -l + o * c, e[4] = s, e[5] = u, e
    }, r.scale = function (e, t, i) {
        var n = t[0],
            r = t[1],
            a = t[2],
            o = t[3],
            s = t[4],
            u = t[5],
            l = i[0],
            c = i[1];
        return e[0] = n * l, e[1] = r * l, e[2] = a * c, e[3] = o * c, e[4] = s, e[5] = u, e
    }, r.translate = function (e, t, i) {
        var n = t[0],
            r = t[1],
            a = t[2],
            o = t[3],
            s = t[4],
            u = t[5],
            l = i[0],
            c = i[1];
        return e[0] = n, e[1] = r, e[2] = a, e[3] = o, e[4] = n * l + a * c + s, e[5] = r * l + o * c + u, e
    }, r.fromRotation = function (e, t) {
        var i = Math.sin(t),
            n = Math.cos(t);
        return e[0] = n, e[1] = i, e[2] = -i, e[3] = n, e[4] = 0, e[5] = 0, e
    }, r.fromScaling = function (e, t) {
        return e[0] = t[0], e[1] = 0, e[2] = 0, e[3] = t[1], e[4] = 0, e[5] = 0, e
    }, r.fromTranslation = function (e, t) {
        return e[0] = 1, e[1] = 0, e[2] = 0, e[3] = 1, e[4] = t[0], e[5] = t[1], e
    }, r.str = function (e) {
        return "mat2d(" + e[0] + ", " + e[1] + ", " + e[2] + ", " + e[3] + ", " + e[4] + ", " + e[5] + ")"
    }, r.frob = function (e) {
        return Math.sqrt(Math.pow(e[0], 2) + Math.pow(e[1], 2) + Math.pow(e[2], 2) + Math.pow(e[3], 2) + Math.pow(e[4], 2) + Math.pow(e[5], 2) + 1)
    }, r.add = function (e, t, i) {
        return e[0] = t[0] + i[0], e[1] = t[1] + i[1], e[2] = t[2] + i[2], e[3] = t[3] + i[3], e[4] = t[4] + i[4], e[5] = t[5] + i[5], e
    }, r.subtract = function (e, t, i) {
        return e[0] = t[0] - i[0], e[1] = t[1] - i[1], e[2] = t[2] - i[2], e[3] = t[3] - i[3], e[4] = t[4] - i[4], e[5] = t[5] - i[5], e
    }, r.sub = r.subtract, r.multiplyScalar = function (e, t, i) {
        return e[0] = t[0] * i, e[1] = t[1] * i, e[2] = t[2] * i, e[3] = t[3] * i, e[4] = t[4] * i, e[5] = t[5] * i, e
    }, r.multiplyScalarAndAdd = function (e, t, i, n) {
        return e[0] = t[0] + i[0] * n, e[1] = t[1] + i[1] * n, e[2] = t[2] + i[2] * n, e[3] = t[3] + i[3] * n, e[4] = t[4] + i[4] * n, e[5] = t[5] + i[5] * n, e
    }, r.exactEquals = function (e, t) {
        return e[0] === t[0] && e[1] === t[1] && e[2] === t[2] && e[3] === t[3] && e[4] === t[4] && e[5] === t[5]
    }, r.equals = function (e, t) {
        var i = e[0],
            r = e[1],
            a = e[2],
            o = e[3],
            s = e[4],
            u = e[5],
            l = t[0],
            c = t[1],
            h = t[2],
            d = t[3],
            f = t[4],
            p = t[5];
        return Math.abs(i - l) <= n.EPSILON * Math.max(1, Math.abs(i), Math.abs(l)) && Math.abs(r - c) <= n.EPSILON * Math.max(1, Math.abs(r), Math.abs(c)) && Math.abs(a - h) <= n.EPSILON * Math.max(1, Math.abs(a), Math.abs(h)) && Math.abs(o - d) <= n.EPSILON * Math.max(1, Math.abs(o), Math.abs(d)) && Math.abs(s - f) <= n.EPSILON * Math.max(1, Math.abs(s), Math.abs(f)) && Math.abs(u - p) <= n.EPSILON * Math.max(1, Math.abs(u), Math.abs(p))
    }, e.exports = r
}, function (e, t, i) {
    var n = i(361),
        r = {
            scalar: {},
            SIMD: {}
        };
    r.create = function () {
        var e = new n.ARRAY_TYPE(16);
        return e[0] = 1, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 0, e[5] = 1, e[6] = 0, e[7] = 0, e[8] = 0, e[9] = 0, e[10] = 1, e[11] = 0, e[12] = 0, e[13] = 0, e[14] = 0, e[15] = 1, e
    }, r.clone = function (e) {
        var t = new n.ARRAY_TYPE(16);
        return t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[3], t[4] = e[4], t[5] = e[5], t[6] = e[6], t[7] = e[7], t[8] = e[8], t[9] = e[9], t[10] = e[10], t[11] = e[11], t[12] = e[12], t[13] = e[13], t[14] = e[14], t[15] = e[15], t
    }, r.copy = function (e, t) {
        return e[0] = t[0], e[1] = t[1], e[2] = t[2], e[3] = t[3], e[4] = t[4], e[5] = t[5], e[6] = t[6], e[7] = t[7], e[8] = t[8], e[9] = t[9], e[10] = t[10], e[11] = t[11], e[12] = t[12], e[13] = t[13], e[14] = t[14], e[15] = t[15], e
    }, r.fromValues = function (e, t, i, r, a, o, s, u, l, c, h, d, f, p, m, g) {
        var v = new n.ARRAY_TYPE(16);
        return v[0] = e, v[1] = t, v[2] = i, v[3] = r, v[4] = a, v[5] = o, v[6] = s, v[7] = u, v[8] = l, v[9] = c, v[10] = h, v[11] = d, v[12] = f, v[13] = p, v[14] = m, v[15] = g, v
    }, r.set = function (e, t, i, n, r, a, o, s, u, l, c, h, d, f, p, m, g) {
        return e[0] = t, e[1] = i, e[2] = n, e[3] = r, e[4] = a, e[5] = o, e[6] = s, e[7] = u, e[8] = l, e[9] = c, e[10] = h, e[11] = d, e[12] = f, e[13] = p, e[14] = m, e[15] = g, e
    }, r.identity = function (e) {
        return e[0] = 1, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 0, e[5] = 1, e[6] = 0, e[7] = 0, e[8] = 0, e[9] = 0, e[10] = 1, e[11] = 0, e[12] = 0, e[13] = 0, e[14] = 0, e[15] = 1, e
    }, r.scalar.transpose = function (e, t) {
        if (e === t) {
            var i = t[1],
                n = t[2],
                r = t[3],
                a = t[6],
                o = t[7],
                s = t[11];
            e[1] = t[4], e[2] = t[8], e[3] = t[12], e[4] = i, e[6] = t[9], e[7] = t[13], e[8] = n, e[9] = a, e[11] = t[14], e[12] = r, e[13] = o, e[14] = s
        } else e[0] = t[0], e[1] = t[4], e[2] = t[8], e[3] = t[12], e[4] = t[1], e[5] = t[5], e[6] = t[9], e[7] = t[13], e[8] = t[2], e[9] = t[6], e[10] = t[10], e[11] = t[14], e[12] = t[3], e[13] = t[7], e[14] = t[11], e[15] = t[15];
        return e
    }, r.SIMD.transpose = function (e, t) {
        var i, n, r, a, o, s, u, l, c, h;
        return i = SIMD.Float32x4.load(t, 0), n = SIMD.Float32x4.load(t, 4), r = SIMD.Float32x4.load(t, 8), a = SIMD.Float32x4.load(t, 12), o = SIMD.Float32x4.shuffle(i, n, 0, 1, 4, 5), s = SIMD.Float32x4.shuffle(r, a, 0, 1, 4, 5), u = SIMD.Float32x4.shuffle(o, s, 0, 2, 4, 6), l = SIMD.Float32x4.shuffle(o, s, 1, 3, 5, 7), SIMD.Float32x4.store(e, 0, u), SIMD.Float32x4.store(e, 4, l), o = SIMD.Float32x4.shuffle(i, n, 2, 3, 6, 7), s = SIMD.Float32x4.shuffle(r, a, 2, 3, 6, 7), c = SIMD.Float32x4.shuffle(o, s, 0, 2, 4, 6), h = SIMD.Float32x4.shuffle(o, s, 1, 3, 5, 7), SIMD.Float32x4.store(e, 8, c), SIMD.Float32x4.store(e, 12, h), e
    }, r.transpose = n.USE_SIMD ? r.SIMD.transpose : r.scalar.transpose, r.scalar.invert = function (e, t) {
        var i = t[0],
            n = t[1],
            r = t[2],
            a = t[3],
            o = t[4],
            s = t[5],
            u = t[6],
            l = t[7],
            c = t[8],
            h = t[9],
            d = t[10],
            f = t[11],
            p = t[12],
            m = t[13],
            g = t[14],
            v = t[15],
            _ = i * s - n * o,
            b = i * u - r * o,
            S = i * l - a * o,
            x = n * u - r * s,
            y = n * l - a * s,
            C = r * l - a * u,
            T = c * m - h * p,
            w = c * g - d * p,
            M = c * v - f * p,
            E = h * g - d * m,
            A = h * v - f * m,
            P = d * v - f * g,
            R = _ * P - b * A + S * E + x * M - y * w + C * T;
        return R ? (R = 1 / R, e[0] = (s * P - u * A + l * E) * R, e[1] = (r * A - n * P - a * E) * R, e[2] = (m * C - g * y + v * x) * R, e[3] = (d * y - h * C - f * x) * R, e[4] = (u * M - o * P - l * w) * R, e[5] = (i * P - r * M + a * w) * R, e[6] = (g * S - p * C - v * b) * R, e[7] = (c * C - d * S + f * b) * R, e[8] = (o * A - s * M + l * T) * R, e[9] = (n * M - i * A - a * T) * R, e[10] = (p * y - m * S + v * _) * R, e[11] = (h * S - c * y - f * _) * R, e[12] = (s * w - o * E - u * T) * R, e[13] = (i * E - n * w + r * T) * R, e[14] = (m * b - p * x - g * _) * R, e[15] = (c * x - h * b + d * _) * R, e) : null
    }, r.SIMD.invert = function (e, t) {
        var i, n, r, a, o, s, u, l, c, h, d = SIMD.Float32x4.load(t, 0),
            f = SIMD.Float32x4.load(t, 4),
            p = SIMD.Float32x4.load(t, 8),
            m = SIMD.Float32x4.load(t, 12);
        return o = SIMD.Float32x4.shuffle(d, f, 0, 1, 4, 5), n = SIMD.Float32x4.shuffle(p, m, 0, 1, 4, 5), i = SIMD.Float32x4.shuffle(o, n, 0, 2, 4, 6), n = SIMD.Float32x4.shuffle(n, o, 1, 3, 5, 7), o = SIMD.Float32x4.shuffle(d, f, 2, 3, 6, 7), a = SIMD.Float32x4.shuffle(p, m, 2, 3, 6, 7), r = SIMD.Float32x4.shuffle(o, a, 0, 2, 4, 6), a = SIMD.Float32x4.shuffle(a, o, 1, 3, 5, 7), o = SIMD.Float32x4.mul(r, a), o = SIMD.Float32x4.swizzle(o, 1, 0, 3, 2), s = SIMD.Float32x4.mul(n, o), u = SIMD.Float32x4.mul(i, o), o = SIMD.Float32x4.swizzle(o, 2, 3, 0, 1), s = SIMD.Float32x4.sub(SIMD.Float32x4.mul(n, o), s), u = SIMD.Float32x4.sub(SIMD.Float32x4.mul(i, o), u), u = SIMD.Float32x4.swizzle(u, 2, 3, 0, 1), o = SIMD.Float32x4.mul(n, r), o = SIMD.Float32x4.swizzle(o, 1, 0, 3, 2), s = SIMD.Float32x4.add(SIMD.Float32x4.mul(a, o), s), c = SIMD.Float32x4.mul(i, o), o = SIMD.Float32x4.swizzle(o, 2, 3, 0, 1), s = SIMD.Float32x4.sub(s, SIMD.Float32x4.mul(a, o)), c = SIMD.Float32x4.sub(SIMD.Float32x4.mul(i, o), c), c = SIMD.Float32x4.swizzle(c, 2, 3, 0, 1), o = SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(n, 2, 3, 0, 1), a), o = SIMD.Float32x4.swizzle(o, 1, 0, 3, 2), r = SIMD.Float32x4.swizzle(r, 2, 3, 0, 1), s = SIMD.Float32x4.add(SIMD.Float32x4.mul(r, o), s), l = SIMD.Float32x4.mul(i, o), o = SIMD.Float32x4.swizzle(o, 2, 3, 0, 1), s = SIMD.Float32x4.sub(s, SIMD.Float32x4.mul(r, o)), l = SIMD.Float32x4.sub(SIMD.Float32x4.mul(i, o), l), l = SIMD.Float32x4.swizzle(l, 2, 3, 0, 1), o = SIMD.Float32x4.mul(i, n), o = SIMD.Float32x4.swizzle(o, 1, 0, 3, 2), l = SIMD.Float32x4.add(SIMD.Float32x4.mul(a, o), l), c = SIMD.Float32x4.sub(SIMD.Float32x4.mul(r, o), c), o = SIMD.Float32x4.swizzle(o, 2, 3, 0, 1), l = SIMD.Float32x4.sub(SIMD.Float32x4.mul(a, o), l), c = SIMD.Float32x4.sub(c, SIMD.Float32x4.mul(r, o)), o = SIMD.Float32x4.mul(i, a), o = SIMD.Float32x4.swizzle(o, 1, 0, 3, 2), u = SIMD.Float32x4.sub(u, SIMD.Float32x4.mul(r, o)), l = SIMD.Float32x4.add(SIMD.Float32x4.mul(n, o), l), o = SIMD.Float32x4.swizzle(o, 2, 3, 0, 1), u = SIMD.Float32x4.add(SIMD.Float32x4.mul(r, o), u), l = SIMD.Float32x4.sub(l, SIMD.Float32x4.mul(n, o)), o = SIMD.Float32x4.mul(i, r), o = SIMD.Float32x4.swizzle(o, 1, 0, 3, 2), u = SIMD.Float32x4.add(SIMD.Float32x4.mul(a, o), u), c = SIMD.Float32x4.sub(c, SIMD.Float32x4.mul(n, o)), o = SIMD.Float32x4.swizzle(o, 2, 3, 0, 1), u = SIMD.Float32x4.sub(u, SIMD.Float32x4.mul(a, o)), c = SIMD.Float32x4.add(SIMD.Float32x4.mul(n, o), c), h = SIMD.Float32x4.mul(i, s), h = SIMD.Float32x4.add(SIMD.Float32x4.swizzle(h, 2, 3, 0, 1), h), h = SIMD.Float32x4.add(SIMD.Float32x4.swizzle(h, 1, 0, 3, 2), h), o = SIMD.Float32x4.reciprocalApproximation(h), h = SIMD.Float32x4.sub(SIMD.Float32x4.add(o, o), SIMD.Float32x4.mul(h, SIMD.Float32x4.mul(o, o))), (h = SIMD.Float32x4.swizzle(h, 0, 0, 0, 0)) ? (SIMD.Float32x4.store(e, 0, SIMD.Float32x4.mul(h, s)), SIMD.Float32x4.store(e, 4, SIMD.Float32x4.mul(h, u)), SIMD.Float32x4.store(e, 8, SIMD.Float32x4.mul(h, l)), SIMD.Float32x4.store(e, 12, SIMD.Float32x4.mul(h, c)), e) : null
    }, r.invert = n.USE_SIMD ? r.SIMD.invert : r.scalar.invert, r.scalar.adjoint = function (e, t) {
        var i = t[0],
            n = t[1],
            r = t[2],
            a = t[3],
            o = t[4],
            s = t[5],
            u = t[6],
            l = t[7],
            c = t[8],
            h = t[9],
            d = t[10],
            f = t[11],
            p = t[12],
            m = t[13],
            g = t[14],
            v = t[15];
        return e[0] = s * (d * v - f * g) - h * (u * v - l * g) + m * (u * f - l * d), e[1] = -(n * (d * v - f * g) - h * (r * v - a * g) + m * (r * f - a * d)), e[2] = n * (u * v - l * g) - s * (r * v - a * g) + m * (r * l - a * u), e[3] = -(n * (u * f - l * d) - s * (r * f - a * d) + h * (r * l - a * u)), e[4] = -(o * (d * v - f * g) - c * (u * v - l * g) + p * (u * f - l * d)), e[5] = i * (d * v - f * g) - c * (r * v - a * g) + p * (r * f - a * d), e[6] = -(i * (u * v - l * g) - o * (r * v - a * g) + p * (r * l - a * u)), e[7] = i * (u * f - l * d) - o * (r * f - a * d) + c * (r * l - a * u), e[8] = o * (h * v - f * m) - c * (s * v - l * m) + p * (s * f - l * h), e[9] = -(i * (h * v - f * m) - c * (n * v - a * m) + p * (n * f - a * h)), e[10] = i * (s * v - l * m) - o * (n * v - a * m) + p * (n * l - a * s), e[11] = -(i * (s * f - l * h) - o * (n * f - a * h) + c * (n * l - a * s)), e[12] = -(o * (h * g - d * m) - c * (s * g - u * m) + p * (s * d - u * h)), e[13] = i * (h * g - d * m) - c * (n * g - r * m) + p * (n * d - r * h), e[14] = -(i * (s * g - u * m) - o * (n * g - r * m) + p * (n * u - r * s)), e[15] = i * (s * d - u * h) - o * (n * d - r * h) + c * (n * u - r * s), e
    }, r.SIMD.adjoint = function (e, t) {
        var i, n, r, a, o, s, u, l, c, h, d, f, p, i = SIMD.Float32x4.load(t, 0),
            n = SIMD.Float32x4.load(t, 4),
            r = SIMD.Float32x4.load(t, 8),
            a = SIMD.Float32x4.load(t, 12);
        return c = SIMD.Float32x4.shuffle(i, n, 0, 1, 4, 5), s = SIMD.Float32x4.shuffle(r, a, 0, 1, 4, 5), o = SIMD.Float32x4.shuffle(c, s, 0, 2, 4, 6), s = SIMD.Float32x4.shuffle(s, c, 1, 3, 5, 7), c = SIMD.Float32x4.shuffle(i, n, 2, 3, 6, 7), l = SIMD.Float32x4.shuffle(r, a, 2, 3, 6, 7), u = SIMD.Float32x4.shuffle(c, l, 0, 2, 4, 6), l = SIMD.Float32x4.shuffle(l, c, 1, 3, 5, 7), c = SIMD.Float32x4.mul(u, l), c = SIMD.Float32x4.swizzle(c, 1, 0, 3, 2), h = SIMD.Float32x4.mul(s, c), d = SIMD.Float32x4.mul(o, c), c = SIMD.Float32x4.swizzle(c, 2, 3, 0, 1), h = SIMD.Float32x4.sub(SIMD.Float32x4.mul(s, c), h), d = SIMD.Float32x4.sub(SIMD.Float32x4.mul(o, c), d), d = SIMD.Float32x4.swizzle(d, 2, 3, 0, 1), c = SIMD.Float32x4.mul(s, u), c = SIMD.Float32x4.swizzle(c, 1, 0, 3, 2), h = SIMD.Float32x4.add(SIMD.Float32x4.mul(l, c), h), p = SIMD.Float32x4.mul(o, c), c = SIMD.Float32x4.swizzle(c, 2, 3, 0, 1), h = SIMD.Float32x4.sub(h, SIMD.Float32x4.mul(l, c)), p = SIMD.Float32x4.sub(SIMD.Float32x4.mul(o, c), p), p = SIMD.Float32x4.swizzle(p, 2, 3, 0, 1), c = SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s, 2, 3, 0, 1), l), c = SIMD.Float32x4.swizzle(c, 1, 0, 3, 2), u = SIMD.Float32x4.swizzle(u, 2, 3, 0, 1), h = SIMD.Float32x4.add(SIMD.Float32x4.mul(u, c), h), f = SIMD.Float32x4.mul(o, c), c = SIMD.Float32x4.swizzle(c, 2, 3, 0, 1), h = SIMD.Float32x4.sub(h, SIMD.Float32x4.mul(u, c)), f = SIMD.Float32x4.sub(SIMD.Float32x4.mul(o, c), f), f = SIMD.Float32x4.swizzle(f, 2, 3, 0, 1), c = SIMD.Float32x4.mul(o, s), c = SIMD.Float32x4.swizzle(c, 1, 0, 3, 2), f = SIMD.Float32x4.add(SIMD.Float32x4.mul(l, c), f), p = SIMD.Float32x4.sub(SIMD.Float32x4.mul(u, c), p), c = SIMD.Float32x4.swizzle(c, 2, 3, 0, 1), f = SIMD.Float32x4.sub(SIMD.Float32x4.mul(l, c), f), p = SIMD.Float32x4.sub(p, SIMD.Float32x4.mul(u, c)), c = SIMD.Float32x4.mul(o, l), c = SIMD.Float32x4.swizzle(c, 1, 0, 3, 2), d = SIMD.Float32x4.sub(d, SIMD.Float32x4.mul(u, c)), f = SIMD.Float32x4.add(SIMD.Float32x4.mul(s, c), f), c = SIMD.Float32x4.swizzle(c, 2, 3, 0, 1), d = SIMD.Float32x4.add(SIMD.Float32x4.mul(u, c), d), f = SIMD.Float32x4.sub(f, SIMD.Float32x4.mul(s, c)), c = SIMD.Float32x4.mul(o, u), c = SIMD.Float32x4.swizzle(c, 1, 0, 3, 2), d = SIMD.Float32x4.add(SIMD.Float32x4.mul(l, c), d), p = SIMD.Float32x4.sub(p, SIMD.Float32x4.mul(s, c)), c = SIMD.Float32x4.swizzle(c, 2, 3, 0, 1), d = SIMD.Float32x4.sub(d, SIMD.Float32x4.mul(l, c)), p = SIMD.Float32x4.add(SIMD.Float32x4.mul(s, c), p), SIMD.Float32x4.store(e, 0, h), SIMD.Float32x4.store(e, 4, d), SIMD.Float32x4.store(e, 8, f), SIMD.Float32x4.store(e, 12, p), e
    }, r.adjoint = n.USE_SIMD ? r.SIMD.adjoint : r.scalar.adjoint, r.determinant = function (e) {
        var t = e[0],
            i = e[1],
            n = e[2],
            r = e[3],
            a = e[4],
            o = e[5],
            s = e[6],
            u = e[7],
            l = e[8],
            c = e[9],
            h = e[10],
            d = e[11],
            f = e[12],
            p = e[13],
            m = e[14],
            g = e[15];
        return (t * o - i * a) * (h * g - d * m) - (t * s - n * a) * (c * g - d * p) + (t * u - r * a) * (c * m - h * p) + (i * s - n * o) * (l * g - d * f) - (i * u - r * o) * (l * m - h * f) + (n * u - r * s) * (l * p - c * f)
    }, r.SIMD.multiply = function (e, t, i) {
        var n = SIMD.Float32x4.load(t, 0),
            r = SIMD.Float32x4.load(t, 4),
            a = SIMD.Float32x4.load(t, 8),
            o = SIMD.Float32x4.load(t, 12),
            s = SIMD.Float32x4.load(i, 0),
            u = SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s, 0, 0, 0, 0), n), SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s, 1, 1, 1, 1), r), SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s, 2, 2, 2, 2), a), SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s, 3, 3, 3, 3), o))));
        SIMD.Float32x4.store(e, 0, u);
        var l = SIMD.Float32x4.load(i, 4),
            c = SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l, 0, 0, 0, 0), n), SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l, 1, 1, 1, 1), r), SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l, 2, 2, 2, 2), a), SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l, 3, 3, 3, 3), o))));
        SIMD.Float32x4.store(e, 4, c);
        var h = SIMD.Float32x4.load(i, 8),
            d = SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h, 0, 0, 0, 0), n), SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h, 1, 1, 1, 1), r), SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h, 2, 2, 2, 2), a), SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h, 3, 3, 3, 3), o))));
        SIMD.Float32x4.store(e, 8, d);
        var f = SIMD.Float32x4.load(i, 12),
            p = SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f, 0, 0, 0, 0), n), SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f, 1, 1, 1, 1), r), SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f, 2, 2, 2, 2), a), SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f, 3, 3, 3, 3), o))));
        return SIMD.Float32x4.store(e, 12, p), e
    }, r.scalar.multiply = function (e, t, i) {
        var n = t[0],
            r = t[1],
            a = t[2],
            o = t[3],
            s = t[4],
            u = t[5],
            l = t[6],
            c = t[7],
            h = t[8],
            d = t[9],
            f = t[10],
            p = t[11],
            m = t[12],
            g = t[13],
            v = t[14],
            _ = t[15],
            b = i[0],
            S = i[1],
            x = i[2],
            y = i[3];
        return e[0] = b * n + S * s + x * h + y * m, e[1] = b * r + S * u + x * d + y * g, e[2] = b * a + S * l + x * f + y * v, e[3] = b * o + S * c + x * p + y * _, b = i[4], S = i[5], x = i[6], y = i[7], e[4] = b * n + S * s + x * h + y * m, e[5] = b * r + S * u + x * d + y * g, e[6] = b * a + S * l + x * f + y * v, e[7] = b * o + S * c + x * p + y * _, b = i[8], S = i[9], x = i[10], y = i[11], e[8] = b * n + S * s + x * h + y * m, e[9] = b * r + S * u + x * d + y * g, e[10] = b * a + S * l + x * f + y * v, e[11] = b * o + S * c + x * p + y * _, b = i[12], S = i[13], x = i[14], y = i[15], e[12] = b * n + S * s + x * h + y * m, e[13] = b * r + S * u + x * d + y * g, e[14] = b * a + S * l + x * f + y * v, e[15] = b * o + S * c + x * p + y * _, e
    }, r.multiply = n.USE_SIMD ? r.SIMD.multiply : r.scalar.multiply, r.mul = r.multiply, r.scalar.translate = function (e, t, i) {
        var n, r, a, o, s, u, l, c, h, d, f, p, m = i[0],
            g = i[1],
            v = i[2];
        return t === e ? (e[12] = t[0] * m + t[4] * g + t[8] * v + t[12], e[13] = t[1] * m + t[5] * g + t[9] * v + t[13], e[14] = t[2] * m + t[6] * g + t[10] * v + t[14], e[15] = t[3] * m + t[7] * g + t[11] * v + t[15]) : (n = t[0], r = t[1], a = t[2], o = t[3], s = t[4], u = t[5], l = t[6], c = t[7], h = t[8], d = t[9], f = t[10], p = t[11], e[0] = n, e[1] = r, e[2] = a, e[3] = o, e[4] = s, e[5] = u, e[6] = l, e[7] = c, e[8] = h, e[9] = d, e[10] = f, e[11] = p, e[12] = n * m + s * g + h * v + t[12], e[13] = r * m + u * g + d * v + t[13], e[14] = a * m + l * g + f * v + t[14], e[15] = o * m + c * g + p * v + t[15]), e
    }, r.SIMD.translate = function (e, t, i) {
        var n = SIMD.Float32x4.load(t, 0),
            r = SIMD.Float32x4.load(t, 4),
            a = SIMD.Float32x4.load(t, 8),
            o = SIMD.Float32x4.load(t, 12),
            s = SIMD.Float32x4(i[0], i[1], i[2], 0);
        t !== e && (e[0] = t[0], e[1] = t[1], e[2] = t[2], e[3] = t[3], e[4] = t[4], e[5] = t[5], e[6] = t[6], e[7] = t[7], e[8] = t[8], e[9] = t[9], e[10] = t[10], e[11] = t[11]), n = SIMD.Float32x4.mul(n, SIMD.Float32x4.swizzle(s, 0, 0, 0, 0)), r = SIMD.Float32x4.mul(r, SIMD.Float32x4.swizzle(s, 1, 1, 1, 1)), a = SIMD.Float32x4.mul(a, SIMD.Float32x4.swizzle(s, 2, 2, 2, 2));
        var u = SIMD.Float32x4.add(n, SIMD.Float32x4.add(r, SIMD.Float32x4.add(a, o)));
        return SIMD.Float32x4.store(e, 12, u), e
    }, r.translate = n.USE_SIMD ? r.SIMD.translate : r.scalar.translate, r.scalar.scale = function (e, t, i) {
        var n = i[0],
            r = i[1],
            a = i[2];
        return e[0] = t[0] * n, e[1] = t[1] * n, e[2] = t[2] * n, e[3] = t[3] * n, e[4] = t[4] * r, e[5] = t[5] * r, e[6] = t[6] * r, e[7] = t[7] * r, e[8] = t[8] * a, e[9] = t[9] * a, e[10] = t[10] * a, e[11] = t[11] * a, e[12] = t[12], e[13] = t[13], e[14] = t[14], e[15] = t[15], e
    }, r.SIMD.scale = function (e, t, i) {
        var n, r, a, o = SIMD.Float32x4(i[0], i[1], i[2], 0);
        return n = SIMD.Float32x4.load(t, 0), SIMD.Float32x4.store(e, 0, SIMD.Float32x4.mul(n, SIMD.Float32x4.swizzle(o, 0, 0, 0, 0))), r = SIMD.Float32x4.load(t, 4), SIMD.Float32x4.store(e, 4, SIMD.Float32x4.mul(r, SIMD.Float32x4.swizzle(o, 1, 1, 1, 1))), a = SIMD.Float32x4.load(t, 8), SIMD.Float32x4.store(e, 8, SIMD.Float32x4.mul(a, SIMD.Float32x4.swizzle(o, 2, 2, 2, 2))), e[12] = t[12], e[13] = t[13], e[14] = t[14], e[15] = t[15], e
    }, r.scale = n.USE_SIMD ? r.SIMD.scale : r.scalar.scale, r.rotate = function (e, t, i, r) {
        var a, o, s, u, l, c, h, d, f, p, m, g, v, _, b, S, x, y, C, T, w, M, E, A, P = r[0],
            R = r[1],
            O = r[2],
            I = Math.sqrt(P * P + R * R + O * O);
        return Math.abs(I) < n.EPSILON ? null : (I = 1 / I, P *= I, R *= I, O *= I, a = Math.sin(i), o = Math.cos(i), s = 1 - o, u = t[0], l = t[1], c = t[2], h = t[3], d = t[4], f = t[5], p = t[6], m = t[7], g = t[8], v = t[9], _ = t[10], b = t[11], S = P * P * s + o, x = R * P * s + O * a, y = O * P * s - R * a, C = P * R * s - O * a, T = R * R * s + o, w = O * R * s + P * a, M = P * O * s + R * a, E = R * O * s - P * a, A = O * O * s + o, e[0] = u * S + d * x + g * y, e[1] = l * S + f * x + v * y, e[2] = c * S + p * x + _ * y, e[3] = h * S + m * x + b * y, e[4] = u * C + d * T + g * w, e[5] = l * C + f * T + v * w, e[6] = c * C + p * T + _ * w, e[7] = h * C + m * T + b * w, e[8] = u * M + d * E + g * A, e[9] = l * M + f * E + v * A, e[10] = c * M + p * E + _ * A, e[11] = h * M + m * E + b * A, t !== e && (e[12] = t[12], e[13] = t[13], e[14] = t[14], e[15] = t[15]), e)
    }, r.scalar.rotateX = function (e, t, i) {
        var n = Math.sin(i),
            r = Math.cos(i),
            a = t[4],
            o = t[5],
            s = t[6],
            u = t[7],
            l = t[8],
            c = t[9],
            h = t[10],
            d = t[11];
        return t !== e && (e[0] = t[0], e[1] = t[1], e[2] = t[2], e[3] = t[3], e[12] = t[12], e[13] = t[13], e[14] = t[14], e[15] = t[15]), e[4] = a * r + l * n, e[5] = o * r + c * n, e[6] = s * r + h * n, e[7] = u * r + d * n, e[8] = l * r - a * n, e[9] = c * r - o * n, e[10] = h * r - s * n, e[11] = d * r - u * n, e
    }, r.SIMD.rotateX = function (e, t, i) {
        var n = SIMD.Float32x4.splat(Math.sin(i)),
            r = SIMD.Float32x4.splat(Math.cos(i));
        t !== e && (e[0] = t[0], e[1] = t[1], e[2] = t[2], e[3] = t[3], e[12] = t[12], e[13] = t[13], e[14] = t[14], e[15] = t[15]);
        var a = SIMD.Float32x4.load(t, 4),
            o = SIMD.Float32x4.load(t, 8);
        return SIMD.Float32x4.store(e, 4, SIMD.Float32x4.add(SIMD.Float32x4.mul(a, r), SIMD.Float32x4.mul(o, n))), SIMD.Float32x4.store(e, 8, SIMD.Float32x4.sub(SIMD.Float32x4.mul(o, r), SIMD.Float32x4.mul(a, n))), e
    }, r.rotateX = n.USE_SIMD ? r.SIMD.rotateX : r.scalar.rotateX, r.scalar.rotateY = function (e, t, i) {
        var n = Math.sin(i),
            r = Math.cos(i),
            a = t[0],
            o = t[1],
            s = t[2],
            u = t[3],
            l = t[8],
            c = t[9],
            h = t[10],
            d = t[11];
        return t !== e && (e[4] = t[4], e[5] = t[5], e[6] = t[6], e[7] = t[7], e[12] = t[12], e[13] = t[13], e[14] = t[14], e[15] = t[15]), e[0] = a * r - l * n, e[1] = o * r - c * n, e[2] = s * r - h * n, e[3] = u * r - d * n, e[8] = a * n + l * r, e[9] = o * n + c * r, e[10] = s * n + h * r, e[11] = u * n + d * r, e
    }, r.SIMD.rotateY = function (e, t, i) {
        var n = SIMD.Float32x4.splat(Math.sin(i)),
            r = SIMD.Float32x4.splat(Math.cos(i));
        t !== e && (e[4] = t[4], e[5] = t[5], e[6] = t[6], e[7] = t[7], e[12] = t[12], e[13] = t[13], e[14] = t[14], e[15] = t[15]);
        var a = SIMD.Float32x4.load(t, 0),
            o = SIMD.Float32x4.load(t, 8);
        return SIMD.Float32x4.store(e, 0, SIMD.Float32x4.sub(SIMD.Float32x4.mul(a, r), SIMD.Float32x4.mul(o, n))), SIMD.Float32x4.store(e, 8, SIMD.Float32x4.add(SIMD.Float32x4.mul(a, n), SIMD.Float32x4.mul(o, r))), e
    }, r.rotateY = n.USE_SIMD ? r.SIMD.rotateY : r.scalar.rotateY, r.scalar.rotateZ = function (e, t, i) {
        var n = Math.sin(i),
            r = Math.cos(i),
            a = t[0],
            o = t[1],
            s = t[2],
            u = t[3],
            l = t[4],
            c = t[5],
            h = t[6],
            d = t[7];
        return t !== e && (e[8] = t[8], e[9] = t[9], e[10] = t[10], e[11] = t[11], e[12] = t[12], e[13] = t[13], e[14] = t[14], e[15] = t[15]), e[0] = a * r + l * n, e[1] = o * r + c * n, e[2] = s * r + h * n, e[3] = u * r + d * n, e[4] = l * r - a * n, e[5] = c * r - o * n, e[6] = h * r - s * n, e[7] = d * r - u * n, e
    }, r.SIMD.rotateZ = function (e, t, i) {
        var n = SIMD.Float32x4.splat(Math.sin(i)),
            r = SIMD.Float32x4.splat(Math.cos(i));
        t !== e && (e[8] = t[8], e[9] = t[9], e[10] = t[10], e[11] = t[11], e[12] = t[12], e[13] = t[13], e[14] = t[14], e[15] = t[15]);
        var a = SIMD.Float32x4.load(t, 0),
            o = SIMD.Float32x4.load(t, 4);
        return SIMD.Float32x4.store(e, 0, SIMD.Float32x4.add(SIMD.Float32x4.mul(a, r), SIMD.Float32x4.mul(o, n))), SIMD.Float32x4.store(e, 4, SIMD.Float32x4.sub(SIMD.Float32x4.mul(o, r), SIMD.Float32x4.mul(a, n))), e
    }, r.rotateZ = n.USE_SIMD ? r.SIMD.rotateZ : r.scalar.rotateZ, r.fromTranslation = function (e, t) {
        return e[0] = 1, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 0, e[5] = 1, e[6] = 0, e[7] = 0, e[8] = 0, e[9] = 0, e[10] = 1, e[11] = 0, e[12] = t[0], e[13] = t[1], e[14] = t[2], e[15] = 1, e
    }, r.fromScaling = function (e, t) {
        return e[0] = t[0], e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 0, e[5] = t[1], e[6] = 0, e[7] = 0, e[8] = 0, e[9] = 0, e[10] = t[2], e[11] = 0, e[12] = 0, e[13] = 0, e[14] = 0, e[15] = 1, e
    }, r.fromRotation = function (e, t, i) {
        var r, a, o, s = i[0],
            u = i[1],
            l = i[2],
            c = Math.sqrt(s * s + u * u + l * l);
        return Math.abs(c) < n.EPSILON ? null : (c = 1 / c, s *= c, u *= c, l *= c, r = Math.sin(t), a = Math.cos(t), o = 1 - a, e[0] = s * s * o + a, e[1] = u * s * o + l * r, e[2] = l * s * o - u * r, e[3] = 0, e[4] = s * u * o - l * r, e[5] = u * u * o + a, e[6] = l * u * o + s * r, e[7] = 0, e[8] = s * l * o + u * r, e[9] = u * l * o - s * r, e[10] = l * l * o + a, e[11] = 0, e[12] = 0, e[13] = 0, e[14] = 0, e[15] = 1, e)
    }, r.fromXRotation = function (e, t) {
        var i = Math.sin(t),
            n = Math.cos(t);
        return e[0] = 1, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 0, e[5] = n, e[6] = i, e[7] = 0, e[8] = 0, e[9] = -i, e[10] = n, e[11] = 0, e[12] = 0, e[13] = 0, e[14] = 0, e[15] = 1, e
    }, r.fromYRotation = function (e, t) {
        var i = Math.sin(t),
            n = Math.cos(t);
        return e[0] = n, e[1] = 0, e[2] = -i, e[3] = 0, e[4] = 0, e[5] = 1, e[6] = 0, e[7] = 0, e[8] = i, e[9] = 0, e[10] = n, e[11] = 0, e[12] = 0, e[13] = 0, e[14] = 0, e[15] = 1, e
    }, r.fromZRotation = function (e, t) {
        var i = Math.sin(t),
            n = Math.cos(t);
        return e[0] = n, e[1] = i, e[2] = 0, e[3] = 0, e[4] = -i, e[5] = n, e[6] = 0, e[7] = 0, e[8] = 0, e[9] = 0, e[10] = 1, e[11] = 0, e[12] = 0, e[13] = 0, e[14] = 0, e[15] = 1, e
    }, r.fromRotationTranslation = function (e, t, i) {
        var n = t[0],
            r = t[1],
            a = t[2],
            o = t[3],
            s = n + n,
            u = r + r,
            l = a + a,
            c = n * s,
            h = n * u,
            d = n * l,
            f = r * u,
            p = r * l,
            m = a * l,
            g = o * s,
            v = o * u,
            _ = o * l;
        return e[0] = 1 - (f + m), e[1] = h + _, e[2] = d - v, e[3] = 0, e[4] = h - _, e[5] = 1 - (c + m), e[6] = p + g, e[7] = 0, e[8] = d + v, e[9] = p - g, e[10] = 1 - (c + f), e[11] = 0, e[12] = i[0], e[13] = i[1], e[14] = i[2], e[15] = 1, e
    }, r.getTranslation = function (e, t) {
        return e[0] = t[12], e[1] = t[13], e[2] = t[14], e
    }, r.getRotation = function (e, t) {
        var i = t[0] + t[5] + t[10],
            n = 0;
        return i > 0 ? (n = 2 * Math.sqrt(i + 1), e[3] = .25 * n, e[0] = (t[6] - t[9]) / n, e[1] = (t[8] - t[2]) / n, e[2] = (t[1] - t[4]) / n) : t[0] > t[5] & t[0] > t[10] ? (n = 2 * Math.sqrt(1 + t[0] - t[5] - t[10]), e[3] = (t[6] - t[9]) / n, e[0] = .25 * n, e[1] = (t[1] + t[4]) / n, e[2] = (t[8] + t[2]) / n) : t[5] > t[10] ? (n = 2 * Math.sqrt(1 + t[5] - t[0] - t[10]), e[3] = (t[8] - t[2]) / n, e[0] = (t[1] + t[4]) / n, e[1] = .25 * n, e[2] = (t[6] + t[9]) / n) : (n = 2 * Math.sqrt(1 + t[10] - t[0] - t[5]), e[3] = (t[1] - t[4]) / n, e[0] = (t[8] + t[2]) / n, e[1] = (t[6] + t[9]) / n, e[2] = .25 * n), e
    }, r.fromRotationTranslationScale = function (e, t, i, n) {
        var r = t[0],
            a = t[1],
            o = t[2],
            s = t[3],
            u = r + r,
            l = a + a,
            c = o + o,
            h = r * u,
            d = r * l,
            f = r * c,
            p = a * l,
            m = a * c,
            g = o * c,
            v = s * u,
            _ = s * l,
            b = s * c,
            S = n[0],
            x = n[1],
            y = n[2];
        return e[0] = (1 - (p + g)) * S, e[1] = (d + b) * S, e[2] = (f - _) * S, e[3] = 0, e[4] = (d - b) * x, e[5] = (1 - (h + g)) * x, e[6] = (m + v) * x, e[7] = 0, e[8] = (f + _) * y, e[9] = (m - v) * y, e[10] = (1 - (h + p)) * y, e[11] = 0, e[12] = i[0], e[13] = i[1], e[14] = i[2], e[15] = 1, e
    }, r.fromRotationTranslationScaleOrigin = function (e, t, i, n, r) {
        var a = t[0],
            o = t[1],
            s = t[2],
            u = t[3],
            l = a + a,
            c = o + o,
            h = s + s,
            d = a * l,
            f = a * c,
            p = a * h,
            m = o * c,
            g = o * h,
            v = s * h,
            _ = u * l,
            b = u * c,
            S = u * h,
            x = n[0],
            y = n[1],
            C = n[2],
            T = r[0],
            w = r[1],
            M = r[2];
        return e[0] = (1 - (m + v)) * x, e[1] = (f + S) * x, e[2] = (p - b) * x, e[3] = 0, e[4] = (f - S) * y, e[5] = (1 - (d + v)) * y, e[6] = (g + _) * y, e[7] = 0, e[8] = (p + b) * C, e[9] = (g - _) * C, e[10] = (1 - (d + m)) * C, e[11] = 0, e[12] = i[0] + T - (e[0] * T + e[4] * w + e[8] * M), e[13] = i[1] + w - (e[1] * T + e[5] * w + e[9] * M), e[14] = i[2] + M - (e[2] * T + e[6] * w + e[10] * M), e[15] = 1, e
    }, r.fromQuat = function (e, t) {
        var i = t[0],
            n = t[1],
            r = t[2],
            a = t[3],
            o = i + i,
            s = n + n,
            u = r + r,
            l = i * o,
            c = n * o,
            h = n * s,
            d = r * o,
            f = r * s,
            p = r * u,
            m = a * o,
            g = a * s,
            v = a * u;
        return e[0] = 1 - h - p, e[1] = c + v, e[2] = d - g, e[3] = 0, e[4] = c - v, e[5] = 1 - l - p, e[6] = f + m, e[7] = 0, e[8] = d + g, e[9] = f - m, e[10] = 1 - l - h, e[11] = 0, e[12] = 0, e[13] = 0, e[14] = 0, e[15] = 1, e
    }, r.frustum = function (e, t, i, n, r, a, o) {
        var s = 1 / (i - t),
            u = 1 / (r - n),
            l = 1 / (a - o);
        return e[0] = 2 * a * s, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 0, e[5] = 2 * a * u, e[6] = 0, e[7] = 0, e[8] = (i + t) * s, e[9] = (r + n) * u, e[10] = (o + a) * l, e[11] = -1, e[12] = 0, e[13] = 0, e[14] = o * a * 2 * l, e[15] = 0, e
    }, r.perspective = function (e, t, i, n, r) {
        var a = 1 / Math.tan(t / 2),
            o = 1 / (n - r);
        return e[0] = a / i, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 0, e[5] = a, e[6] = 0, e[7] = 0, e[8] = 0, e[9] = 0, e[10] = (r + n) * o, e[11] = -1, e[12] = 0, e[13] = 0, e[14] = 2 * r * n * o, e[15] = 0, e
    }, r.perspectiveFromFieldOfView = function (e, t, i, n) {
        var r = Math.tan(t.upDegrees * Math.PI / 180),
            a = Math.tan(t.downDegrees * Math.PI / 180),
            o = Math.tan(t.leftDegrees * Math.PI / 180),
            s = Math.tan(t.rightDegrees * Math.PI / 180),
            u = 2 / (o + s),
            l = 2 / (r + a);
        return e[0] = u, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 0, e[5] = l, e[6] = 0, e[7] = 0, e[8] = -(o - s) * u * .5, e[9] = (r - a) * l * .5, e[10] = n / (i - n), e[11] = -1, e[12] = 0, e[13] = 0, e[14] = n * i / (i - n), e[15] = 0, e
    }, r.ortho = function (e, t, i, n, r, a, o) {
        var s = 1 / (t - i),
            u = 1 / (n - r),
            l = 1 / (a - o);
        return e[0] = -2 * s, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 0, e[5] = -2 * u, e[6] = 0, e[7] = 0, e[8] = 0, e[9] = 0, e[10] = 2 * l, e[11] = 0, e[12] = (t + i) * s, e[13] = (r + n) * u, e[14] = (o + a) * l, e[15] = 1, e
    }, r.lookAt = function (e, t, i, a) {
        var o, s, u, l, c, h, d, f, p, m, g = t[0],
            v = t[1],
            _ = t[2],
            b = a[0],
            S = a[1],
            x = a[2],
            y = i[0],
            C = i[1],
            T = i[2];
        return Math.abs(g - y) < n.EPSILON && Math.abs(v - C) < n.EPSILON && Math.abs(_ - T) < n.EPSILON ? r.identity(e) : (d = g - y, f = v - C, p = _ - T, m = 1 / Math.sqrt(d * d + f * f + p * p), d *= m, f *= m, p *= m, o = S * p - x * f, s = x * d - b * p, u = b * f - S * d, m = Math.sqrt(o * o + s * s + u * u), m ? (m = 1 / m, o *= m, s *= m, u *= m) : (o = 0, s = 0, u = 0), l = f * u - p * s, c = p * o - d * u, h = d * s - f * o, m = Math.sqrt(l * l + c * c + h * h), m ? (m = 1 / m, l *= m, c *= m, h *= m) : (l = 0, c = 0, h = 0), e[0] = o, e[1] = l, e[2] = d, e[3] = 0, e[4] = s, e[5] = c, e[6] = f, e[7] = 0, e[8] = u, e[9] = h, e[10] = p, e[11] = 0, e[12] = -(o * g + s * v + u * _), e[13] = -(l * g + c * v + h * _), e[14] = -(d * g + f * v + p * _), e[15] = 1, e)
    }, r.str = function (e) {
        return "mat4(" + e[0] + ", " + e[1] + ", " + e[2] + ", " + e[3] + ", " + e[4] + ", " + e[5] + ", " + e[6] + ", " + e[7] + ", " + e[8] + ", " + e[9] + ", " + e[10] + ", " + e[11] + ", " + e[12] + ", " + e[13] + ", " + e[14] + ", " + e[15] + ")"
    }, r.frob = function (e) {
        return Math.sqrt(Math.pow(e[0], 2) + Math.pow(e[1], 2) + Math.pow(e[2], 2) + Math.pow(e[3], 2) + Math.pow(e[4], 2) + Math.pow(e[5], 2) + Math.pow(e[6], 2) + Math.pow(e[7], 2) + Math.pow(e[8], 2) + Math.pow(e[9], 2) + Math.pow(e[10], 2) + Math.pow(e[11], 2) + Math.pow(e[12], 2) + Math.pow(e[13], 2) + Math.pow(e[14], 2) + Math.pow(e[15], 2))
    }, r.add = function (e, t, i) {
        return e[0] = t[0] + i[0], e[1] = t[1] + i[1], e[2] = t[2] + i[2], e[3] = t[3] + i[3], e[4] = t[4] + i[4], e[5] = t[5] + i[5], e[6] = t[6] + i[6], e[7] = t[7] + i[7], e[8] = t[8] + i[8], e[9] = t[9] + i[9], e[10] = t[10] + i[10], e[11] = t[11] + i[11], e[12] = t[12] + i[12], e[13] = t[13] + i[13], e[14] = t[14] + i[14], e[15] = t[15] + i[15], e
    }, r.subtract = function (e, t, i) {
        return e[0] = t[0] - i[0], e[1] = t[1] - i[1], e[2] = t[2] - i[2], e[3] = t[3] - i[3], e[4] = t[4] - i[4], e[5] = t[5] - i[5], e[6] = t[6] - i[6], e[7] = t[7] - i[7], e[8] = t[8] - i[8], e[9] = t[9] - i[9], e[10] = t[10] - i[10], e[11] = t[11] - i[11], e[12] = t[12] - i[12], e[13] = t[13] - i[13], e[14] = t[14] - i[14], e[15] = t[15] - i[15], e
    }, r.sub = r.subtract, r.multiplyScalar = function (e, t, i) {
        return e[0] = t[0] * i, e[1] = t[1] * i, e[2] = t[2] * i, e[3] = t[3] * i, e[4] = t[4] * i, e[5] = t[5] * i, e[6] = t[6] * i, e[7] = t[7] * i, e[8] = t[8] * i, e[9] = t[9] * i, e[10] = t[10] * i, e[11] = t[11] * i, e[12] = t[12] * i, e[13] = t[13] * i, e[14] = t[14] * i, e[15] = t[15] * i, e
    }, r.multiplyScalarAndAdd = function (e, t, i, n) {
        return e[0] = t[0] + i[0] * n, e[1] = t[1] + i[1] * n, e[2] = t[2] + i[2] * n, e[3] = t[3] + i[3] * n, e[4] = t[4] + i[4] * n, e[5] = t[5] + i[5] * n, e[6] = t[6] + i[6] * n, e[7] = t[7] + i[7] * n, e[8] = t[8] + i[8] * n, e[9] = t[9] + i[9] * n, e[10] = t[10] + i[10] * n, e[11] = t[11] + i[11] * n, e[12] = t[12] + i[12] * n, e[13] = t[13] + i[13] * n, e[14] = t[14] + i[14] * n, e[15] = t[15] + i[15] * n, e
    }, r.exactEquals = function (e, t) {
        return e[0] === t[0] && e[1] === t[1] && e[2] === t[2] && e[3] === t[3] && e[4] === t[4] && e[5] === t[5] && e[6] === t[6] && e[7] === t[7] && e[8] === t[8] && e[9] === t[9] && e[10] === t[10] && e[11] === t[11] && e[12] === t[12] && e[13] === t[13] && e[14] === t[14] && e[15] === t[15]
    }, r.equals = function (e, t) {
        var i = e[0],
            r = e[1],
            a = e[2],
            o = e[3],
            s = e[4],
            u = e[5],
            l = e[6],
            c = e[7],
            h = e[8],
            d = e[9],
            f = e[10],
            p = e[11],
            m = e[12],
            g = e[13],
            v = e[14],
            _ = e[15],
            b = t[0],
            S = t[1],
            x = t[2],
            y = t[3],
            C = t[4],
            T = t[5],
            w = t[6],
            M = t[7],
            E = t[8],
            A = t[9],
            P = t[10],
            R = t[11],
            O = t[12],
            I = t[13],
            F = t[14],
            N = t[15];
        return Math.abs(i - b) <= n.EPSILON * Math.max(1, Math.abs(i), Math.abs(b)) && Math.abs(r - S) <= n.EPSILON * Math.max(1, Math.abs(r), Math.abs(S)) && Math.abs(a - x) <= n.EPSILON * Math.max(1, Math.abs(a), Math.abs(x)) && Math.abs(o - y) <= n.EPSILON * Math.max(1, Math.abs(o), Math.abs(y)) && Math.abs(s - C) <= n.EPSILON * Math.max(1, Math.abs(s), Math.abs(C)) && Math.abs(u - T) <= n.EPSILON * Math.max(1, Math.abs(u), Math.abs(T)) && Math.abs(l - w) <= n.EPSILON * Math.max(1, Math.abs(l), Math.abs(w)) && Math.abs(c - M) <= n.EPSILON * Math.max(1, Math.abs(c), Math.abs(M)) && Math.abs(h - E) <= n.EPSILON * Math.max(1, Math.abs(h), Math.abs(E)) && Math.abs(d - A) <= n.EPSILON * Math.max(1, Math.abs(d), Math.abs(A)) && Math.abs(f - P) <= n.EPSILON * Math.max(1, Math.abs(f), Math.abs(P)) && Math.abs(p - R) <= n.EPSILON * Math.max(1, Math.abs(p), Math.abs(R)) && Math.abs(m - O) <= n.EPSILON * Math.max(1, Math.abs(m), Math.abs(O)) && Math.abs(g - I) <= n.EPSILON * Math.max(1, Math.abs(g), Math.abs(I)) && Math.abs(v - F) <= n.EPSILON * Math.max(1, Math.abs(v), Math.abs(F)) && Math.abs(_ - N) <= n.EPSILON * Math.max(1, Math.abs(_), Math.abs(N))
    }, e.exports = r
}, function (e, t, i) {
    var n = i(361),
        r = i(845),
        a = i(846),
        o = i(847),
        s = {};
    s.create = function () {
        var e = new n.ARRAY_TYPE(4);
        return e[0] = 0, e[1] = 0, e[2] = 0, e[3] = 1, e
    }, s.rotationTo = function () {
        var e = a.create(),
            t = a.fromValues(1, 0, 0),
            i = a.fromValues(0, 1, 0);
        return function (n, r, o) {
            var u = a.dot(r, o);
            return u < -.999999 ? (a.cross(e, t, r), a.length(e) < 1e-6 && a.cross(e, i, r), a.normalize(e, e), s.setAxisAngle(n, e, Math.PI), n) : u > .999999 ? (n[0] = 0, n[1] = 0, n[2] = 0, n[3] = 1, n) : (a.cross(e, r, o), n[0] = e[0], n[1] = e[1], n[2] = e[2], n[3] = 1 + u, s.normalize(n, n))
        }
    }(), s.setAxes = function () {
        var e = r.create();
        return function (t, i, n, r) {
            return e[0] = n[0], e[3] = n[1], e[6] = n[2], e[1] = r[0], e[4] = r[1], e[7] = r[2], e[2] = -i[0], e[5] = -i[1], e[8] = -i[2], s.normalize(t, s.fromMat3(t, e))
        }
    }(), s.clone = o.clone, s.fromValues = o.fromValues, s.copy = o.copy, s.set = o.set, s.identity = function (e) {
        return e[0] = 0, e[1] = 0, e[2] = 0, e[3] = 1, e
    }, s.setAxisAngle = function (e, t, i) {
        i *= .5;
        var n = Math.sin(i);
        return e[0] = n * t[0], e[1] = n * t[1], e[2] = n * t[2], e[3] = Math.cos(i), e
    }, s.getAxisAngle = function (e, t) {
        var i = 2 * Math.acos(t[3]),
            n = Math.sin(i / 2);
        return 0 != n ? (e[0] = t[0] / n, e[1] = t[1] / n, e[2] = t[2] / n) : (e[0] = 1, e[1] = 0, e[2] = 0), i
    }, s.add = o.add, s.multiply = function (e, t, i) {
        var n = t[0],
            r = t[1],
            a = t[2],
            o = t[3],
            s = i[0],
            u = i[1],
            l = i[2],
            c = i[3];
        return e[0] = n * c + o * s + r * l - a * u, e[1] = r * c + o * u + a * s - n * l, e[2] = a * c + o * l + n * u - r * s, e[3] = o * c - n * s - r * u - a * l, e
    }, s.mul = s.multiply, s.scale = o.scale, s.rotateX = function (e, t, i) {
        i *= .5;
        var n = t[0],
            r = t[1],
            a = t[2],
            o = t[3],
            s = Math.sin(i),
            u = Math.cos(i);
        return e[0] = n * u + o * s, e[1] = r * u + a * s, e[2] = a * u - r * s, e[3] = o * u - n * s, e
    }, s.rotateY = function (e, t, i) {
        i *= .5;
        var n = t[0],
            r = t[1],
            a = t[2],
            o = t[3],
            s = Math.sin(i),
            u = Math.cos(i);
        return e[0] = n * u - a * s, e[1] = r * u + o * s, e[2] = a * u + n * s, e[3] = o * u - r * s, e
    }, s.rotateZ = function (e, t, i) {
        i *= .5;
        var n = t[0],
            r = t[1],
            a = t[2],
            o = t[3],
            s = Math.sin(i),
            u = Math.cos(i);
        return e[0] = n * u + r * s, e[1] = r * u - n * s, e[2] = a * u + o * s, e[3] = o * u - a * s, e
    }, s.calculateW = function (e, t) {
        var i = t[0],
            n = t[1],
            r = t[2];
        return e[0] = i, e[1] = n, e[2] = r, e[3] = Math.sqrt(Math.abs(1 - i * i - n * n - r * r)), e
    }, s.dot = o.dot, s.lerp = o.lerp, s.slerp = function (e, t, i, n) {
        var r, a, o, s, u, l = t[0],
            c = t[1],
            h = t[2],
            d = t[3],
            f = i[0],
            p = i[1],
            m = i[2],
            g = i[3];
        return a = l * f + c * p + h * m + d * g, a < 0 && (a = -a, f = -f, p = -p, m = -m, g = -g), 1 - a > 1e-6 ? (r = Math.acos(a), o = Math.sin(r), s = Math.sin((1 - n) * r) / o, u = Math.sin(n * r) / o) : (s = 1 - n, u = n), e[0] = s * l + u * f, e[1] = s * c + u * p, e[2] = s * h + u * m, e[3] = s * d + u * g, e
    }, s.sqlerp = function () {
        var e = s.create(),
            t = s.create();
        return function (i, n, r, a, o, u) {
            return s.slerp(e, n, o, u), s.slerp(t, r, a, u), s.slerp(i, e, t, 2 * u * (1 - u)), i
        }
    }(), s.invert = function (e, t) {
        var i = t[0],
            n = t[1],
            r = t[2],
            a = t[3],
            o = i * i + n * n + r * r + a * a,
            s = o ? 1 / o : 0;
        return e[0] = -i * s, e[1] = -n * s, e[2] = -r * s, e[3] = a * s, e
    }, s.conjugate = function (e, t) {
        return e[0] = -t[0], e[1] = -t[1], e[2] = -t[2], e[3] = t[3], e
    }, s.length = o.length, s.len = s.length, s.squaredLength = o.squaredLength, s.sqrLen = s.squaredLength, s.normalize = o.normalize, s.fromMat3 = function (e, t) {
        var i, n = t[0] + t[4] + t[8];
        if (n > 0) i = Math.sqrt(n + 1), e[3] = .5 * i, i = .5 / i, e[0] = (t[5] - t[7]) * i, e[1] = (t[6] - t[2]) * i, e[2] = (t[1] - t[3]) * i;
        else {
            var r = 0;
            t[4] > t[0] && (r = 1), t[8] > t[3 * r + r] && (r = 2);
            var a = (r + 1) % 3,
                o = (r + 2) % 3;
            i = Math.sqrt(t[3 * r + r] - t[3 * a + a] - t[3 * o + o] + 1), e[r] = .5 * i, i = .5 / i, e[3] = (t[3 * a + o] - t[3 * o + a]) * i, e[a] = (t[3 * a + r] + t[3 * r + a]) * i, e[o] = (t[3 * o + r] + t[3 * r + o]) * i
        }
        return e
    }, s.str = function (e) {
        return "quat(" + e[0] + ", " + e[1] + ", " + e[2] + ", " + e[3] + ")"
    }, s.exactEquals = o.exactEquals, s.equals = o.equals, e.exports = s
}, function (e, t, i) {
    var n = i(361),
        r = {};
    r.create = function () {
        var e = new n.ARRAY_TYPE(2);
        return e[0] = 0, e[1] = 0, e
    }, r.clone = function (e) {
        var t = new n.ARRAY_TYPE(2);
        return t[0] = e[0], t[1] = e[1], t
    }, r.fromValues = function (e, t) {
        var i = new n.ARRAY_TYPE(2);
        return i[0] = e, i[1] = t, i
    }, r.copy = function (e, t) {
        return e[0] = t[0], e[1] = t[1], e
    }, r.set = function (e, t, i) {
        return e[0] = t, e[1] = i, e
    }, r.add = function (e, t, i) {
        return e[0] = t[0] + i[0], e[1] = t[1] + i[1], e
    }, r.subtract = function (e, t, i) {
        return e[0] = t[0] - i[0], e[1] = t[1] - i[1], e
    }, r.sub = r.subtract, r.multiply = function (e, t, i) {
        return e[0] = t[0] * i[0], e[1] = t[1] * i[1], e
    }, r.mul = r.multiply, r.divide = function (e, t, i) {
        return e[0] = t[0] / i[0], e[1] = t[1] / i[1], e
    }, r.div = r.divide, r.ceil = function (e, t) {
        return e[0] = Math.ceil(t[0]), e[1] = Math.ceil(t[1]), e
    }, r.floor = function (e, t) {
        return e[0] = Math.floor(t[0]), e[1] = Math.floor(t[1]), e
    }, r.min = function (e, t, i) {
        return e[0] = Math.min(t[0], i[0]), e[1] = Math.min(t[1], i[1]), e
    }, r.max = function (e, t, i) {
        return e[0] = Math.max(t[0], i[0]), e[1] = Math.max(t[1], i[1]), e
    }, r.round = function (e, t) {
        return e[0] = Math.round(t[0]), e[1] = Math.round(t[1]), e
    }, r.scale = function (e, t, i) {
        return e[0] = t[0] * i, e[1] = t[1] * i, e
    }, r.scaleAndAdd = function (e, t, i, n) {
        return e[0] = t[0] + i[0] * n, e[1] = t[1] + i[1] * n, e
    }, r.distance = function (e, t) {
        var i = t[0] - e[0],
            n = t[1] - e[1];
        return Math.sqrt(i * i + n * n)
    }, r.dist = r.distance, r.squaredDistance = function (e, t) {
        var i = t[0] - e[0],
            n = t[1] - e[1];
        return i * i + n * n
    }, r.sqrDist = r.squaredDistance, r.length = function (e) {
        var t = e[0],
            i = e[1];
        return Math.sqrt(t * t + i * i)
    }, r.len = r.length, r.squaredLength = function (e) {
        var t = e[0],
            i = e[1];
        return t * t + i * i
    }, r.sqrLen = r.squaredLength, r.negate = function (e, t) {
        return e[0] = -t[0], e[1] = -t[1], e
    }, r.inverse = function (e, t) {
        return e[0] = 1 / t[0], e[1] = 1 / t[1], e
    }, r.normalize = function (e, t) {
        var i = t[0],
            n = t[1],
            r = i * i + n * n;
        return r > 0 && (r = 1 / Math.sqrt(r), e[0] = t[0] * r, e[1] = t[1] * r), e
    }, r.dot = function (e, t) {
        return e[0] * t[0] + e[1] * t[1]
    }, r.cross = function (e, t, i) {
        var n = t[0] * i[1] - t[1] * i[0];
        return e[0] = e[1] = 0, e[2] = n, e
    }, r.lerp = function (e, t, i, n) {
        var r = t[0],
            a = t[1];
        return e[0] = r + n * (i[0] - r), e[1] = a + n * (i[1] - a), e
    }, r.random = function (e, t) {
        t = t || 1;
        var i = 2 * n.RANDOM() * Math.PI;
        return e[0] = Math.cos(i) * t, e[1] = Math.sin(i) * t, e
    }, r.transformMat2 = function (e, t, i) {
        var n = t[0],
            r = t[1];
        return e[0] = i[0] * n + i[2] * r, e[1] = i[1] * n + i[3] * r, e
    }, r.transformMat2d = function (e, t, i) {
        var n = t[0],
            r = t[1];
        return e[0] = i[0] * n + i[2] * r + i[4], e[1] = i[1] * n + i[3] * r + i[5], e
    }, r.transformMat3 = function (e, t, i) {
        var n = t[0],
            r = t[1];
        return e[0] = i[0] * n + i[3] * r + i[6], e[1] = i[1] * n + i[4] * r + i[7], e
    }, r.transformMat4 = function (e, t, i) {
        var n = t[0],
            r = t[1];
        return e[0] = i[0] * n + i[4] * r + i[12], e[1] = i[1] * n + i[5] * r + i[13], e
    }, r.forEach = function () {
        var e = r.create();
        return function (t, i, n, r, a, o) {
            var s, u;
            for (i || (i = 2), n || (n = 0), u = r ? Math.min(r * i + n, t.length) : t.length, s = n; s < u; s += i) e[0] = t[s], e[1] = t[s + 1], a(e, e, o), t[s] = e[0], t[s + 1] = e[1];
            return t
        }
    }(), r.str = function (e) {
        return "vec2(" + e[0] + ", " + e[1] + ")"
    }, r.exactEquals = function (e, t) {
        return e[0] === t[0] && e[1] === t[1]
    }, r.equals = function (e, t) {
        var i = e[0],
            r = e[1],
            a = t[0],
            o = t[1];
        return Math.abs(i - a) <= n.EPSILON * Math.max(1, Math.abs(i), Math.abs(a)) && Math.abs(r - o) <= n.EPSILON * Math.max(1, Math.abs(r), Math.abs(o))
    }, e.exports = r
}, function (e, t, i) {
    "use strict";
    t.a = {
        ArrayType: Float64Array
    }
}, function (e, t, i) {
    "use strict";
    var n = i(36),
        r = i(315),
        a = function (e, t, i, n) {
            this._target = e, this._internalFormat = t, this._width = i, this._height = n, this._size = 0, this.computeSize()
        };
    a.prototype = {
        match: function (e) {
            return e._target === this._target && e._internalFormat === this._internalFormat && e._width === this._width && e._height === this._height
        },
        computeSize: function () {
            var e = i(118).default,
                t = 0;
            switch (this._internalFormat) {
                case 1:
                case e.ALPHA:
                case e.LUMINANCE:
                    t = 8;
                    break;
                case e.LUMINANCE_ALPHA:
                case 2:
                    t = 16;
                    break;
                case e.RGB:
                case 3:
                    t = 24;
                    break;
                case e.RGBA:
                case 4:
                    t = 32
            }
            var n = Math.ceil(this._width * this._height * t) / 8;
            this._target === e.TEXTURE_CUBE_MAP && (n *= 6), n += n / 3, this._size = n
        },
        getSize: function () {
            return this._size
        }
    }, a.getHash = function () {
        var e = Array.prototype.slice.call(arguments),
            t = "";
        return e.forEach(function (e) {
            t += e
        }), t
    };
    var o = function (e, t, i) {
        this._texture = e, this._id = t, this._textureSet = i
    };
    o.prototype = {
        target: function () {
            return this._textureSet._profile._target
        },
        id: function () {
            return this._id
        },
        getTextureSet: function () {
            return this._textureSet
        },
        reset: function () {
            this._textureObject = null, this._texture = void 0
        },
        bind: function (e) {
            e.bindTexture(this.target(), this._id)
        }
    };
    var s = function (e) {
        this._profile = e, this._usedTextureObjects = [], this._orphanedTextureObjects = []
    };
    s.prototype = {
        getProfile: function () {
            return this._profile
        },
        getUsedTextureObjects: function () {
            return this._usedTextureObjects
        },
        getOrphanedTextureObjects: function () {
            return this._orphanedTextureObjects
        },
        takeOrGenerate: function (e, t) {
            var i;
            if (this._orphanedTextureObjects.length > 0) return i = this.takeFromOrphans(), i._texture = t, this._usedTextureObjects.push(i), i;
            var n = e.createTexture();
            return i = new o(t, n, this), this._usedTextureObjects.push(i), i
        },
        takeFromOrphans: function () {
            if (this._orphanedTextureObjects.length) return this._orphanedTextureObjects.pop()
        },
        orphan: function (e) {
            var t = this._usedTextureObjects.indexOf(e); - 1 !== t && (this._orphanedTextureObjects.push(this._usedTextureObjects[t]), this._usedTextureObjects.splice(t, 1))
        },
        flushDeletedTextureObjects: function (e, t) {
            if (t <= 0) return t;
            var i, n = this._orphanedTextureObjects.length,
                a = 0,
                o = r.a.instance().tick();
            for (i = 0; i < n && a < t; i++) e.deleteTexture(this._orphanedTextureObjects[i].id()), this._orphanedTextureObjects[i].reset(), a = r.a.instance().deltaS(o, r.a.instance().tick());
            return this._orphanedTextureObjects.splice(0, i), t - a
        },
        flushAllDeletedTextureObjects: function (e) {
            for (var t = this._orphanedTextureObjects.length, i = this.getProfile().getSize(), r = 0, a = t; r < a; ++r) e.deleteTexture(this._orphanedTextureObjects[r].id()), this._orphanedTextureObjects[r].reset();
            this._orphanedTextureObjects.length = 0, n.a.info("TextureManager: released " + t + " with " + t * i / 1048576 + " MB")
        },
        onLostContext: function () {
            var e, t;
            for (t = this._orphanedTextureObjects.length, e = 0; e < t; ++e) this._orphanedTextureObjects[e].reset();
            for (this._orphanedTextureObjects.length = 0, t = this._usedTextureObjects.length, e = 0; e < t; ++e) this._usedTextureObjects[e].reset();
            this._usedTextureObjects.length = 0
        }
    };
    var u = function () {
        this._textureSetMap = {}
    };
    u.prototype = {
        generateTextureObject: function (e, t, i, n, r, o) {
            var u = a.getHash(i, n, r, o);
            return void 0 === this._textureSetMap[u] && (this._textureSetMap[u] = new s(new a(i, n, r, o))), this._textureSetMap[u].takeOrGenerate(e, t)
        },
        updateStats: function (e, t) {
            var i = 0,
                n = 0;
            for (var r in this._textureSetMap) {
                var a = this._textureSetMap[r].getProfile(),
                    o = a.getSize(),
                    s = this._textureSetMap[r].getUsedTextureObjects().length,
                    u = this._textureSetMap[r].getOrphanedTextureObjects().length;
                i += s * o, n += u * o
            }
            var l = 1048576;
            t.getCounter("textureused").set(i / l), t.getCounter("texturereserved").set(n / l), t.getCounter("texturetotal").set((i + n) / l)
        },
        reportStats: function () {
            var e = 0;
            for (var t in this._textureSetMap) {
                var i = this._textureSetMap[t].getProfile(),
                    r = i.getSize() / 1048576,
                    a = this._textureSetMap[t].getUsedTextureObjects().length;
                r *= a, e += r, n.a.notice(String(r) + " MB with " + a + " texture of " + i._width + "x" + i._height + " " + i._internalFormat)
            }
            n.a.notice(String(e) + " MB in total")
        },
        flushAllDeletedTextureObjects: function (e) {
            for (var t in this._textureSetMap) this._textureSetMap[t].flushAllDeletedTextureObjects(e)
        },
        onLostContext: function (e) {
            for (var t in this._textureSetMap) this._textureSetMap[t].onLostContext(e)
        },
        flushDeletedTextureObjects: function (e, t) {
            var i = t;
            for (var n in this._textureSetMap)
                if ((i = this._textureSetMap[n].flushDeletedTextureObjects(e, i)) <= 0) break;
            return i
        },
        releaseTextureObject: function (e) {
            if (e) {
                e.getTextureSet().orphan(e)
            }
        }
    }, t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(92),
        a = function () {
            r.a.call(this), this._attributeEnable = !1
        };
    n.a.createPrototypeStateAttribute(a, n.a.objectInherit(r.a.prototype, {
        attributeType: "Billboard",
        cloneType: function () {
            return new a
        },
        setEnabled: function (e) {
            this._attributeEnable = e
        },
        isEnabled: function () {
            return this._attributeEnable
        },
        apply: function () {}
    }), "osg", "Billboard"), t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(92),
        a = i(10),
        o = function (e) {
            r.a.call(this), this._constantColor = a.g.create(), a.g.set(this._constantColor, 1, 1, 1, 1), void 0 !== e && this.setConstantColor(e)
        };
    n.a.createPrototypeStateAttribute(o, n.a.objectInherit(r.a.prototype, {
        attributeType: "BlendColor",
        cloneType: function () {
            return new o
        },
        setConstantColor: function (e) {
            a.g.copy(this._constantColor, e)
        },
        getConstantColor: function () {
            return this._constantColor
        },
        apply: function (e) {
            e.getGraphicContext().blendColor(this._constantColor[0], this._constantColor[1], this._constantColor[2], this._constantColor[3])
        }
    }), "osg", "BlendColor"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(92),
        a = function (e, t, i, n) {
            r.a.call(this), this._red = !0, this._green = !0, this._blue = !0, this._alpha = !0, void 0 !== e && void 0 !== t && void 0 !== i && this.setMask(e, t, i, n)
        };
    n.a.createPrototypeStateAttribute(a, n.a.objectInherit(r.a.prototype, {
        attributeType: "ColorMask",
        cloneType: function () {
            return new a
        },
        setMask: function (e, t, i, n) {
            this._red = !!e, this._green = !!t, this._blue = !!i, this._alpha = !!n
        },
        apply: function (e) {
            e.applyColorMask(this)
        }
    }), "osg", "ColorMask"), t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(36),
        a = i(102),
        o = i(1082),
        s = function () {
            a.a.call(this)
        };
    n.a.createPrototypeObject(s, n.a.objectInherit(a.a.prototype, {
        init: function (e) {
            var t = new o.a;
            if (e.getParents().length > 1 && r.a.warn("A RigGeometry should not have multi parent ( " + e.getName() + " )"), e.getParents()[0].accept(t), !t._root) return void r.a.warn("A RigGeometry did not find a parent skeleton for RigGeometry ( " + e.getName() + " )");
            e.setSkeleton(t._root), e.setPathToSkeleton(t._pathToRoot)
        },
        update: function (e) {
            if (e && "RigGeometry" !== e.className()) return !0;
            var t = e;
            return t.getSkeleton() || 0 === t.getParents().length || this.init(t), !t.getSkeleton() || (t.getNeedToComputeMatrix() && t.computeMatrixFromRootSkeleton(), t.update(), !0)
        }
    }), "osgAnimation", "UpdateRigGeometry"), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(84),
        a = i(617),
        o = function () {
            r.a.call(this, r.a.TRAVERSE_PARENTS), this._root = void 0, this._pathToRoot = void 0
        };
    n.a.createPrototypeObject(o, n.a.objectInherit(r.a.prototype, {
        apply: function (e) {
            if (!this._root) return e.typeID === a.a.typeID ? (this._root = e, void(this._pathToRoot = this.nodePath.slice(1))) : void this.traverse(e)
        }
    }), "osgAnimation", "FindNearestParentSkeleton"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(10),
        r = i(92),
        a = i(855),
        o = i(1084),
        s = function () {
            this._isInitialized = !1, this._bones = []
        };
    s.prototype = {
        computeBonePalette: function (e, t) {
            var i = this._bones;
            for (var n in e) {
                var r = t[n],
                    a = e[n];
                void 0 !== r && (i[r] = a)
            }
            return i
        },
        init: function (e) {
            var t = new o.a;
            e.getSkeleton().accept(t);
            var i = t.getBoneMap();
            this.computeBonePalette(i, e._boneNameID);
            var n = 3 * this._bones.length,
                s = this._skinningAttribute = new a.a;
            return s.setMatrixPalette(new Float32Array(4 * n)), e.getStateSetAnimation().setAttributeAndModes(s, r.a.ON), this._isInitialized = !0, !0
        },
        computeMatrixPalette: function () {
            var e = n.c.create();
            return function (t, i) {
                for (var r = this._bones, a = this._skinningAttribute.getMatrixPalette(), o = 0, s = 0, u = r.length; s < u; s++) {
                    var l = r[s],
                        c = l.getInvBindMatrixInSkeletonSpace(),
                        h = l.getMatrixInSkeletonSpace();
                    n.c.mul(e, h, c), n.c.mul(e, i, e), n.c.mul(e, e, t), a[o++] = e[0], a[o++] = e[4], a[o++] = e[8], a[o++] = e[12], a[o++] = e[1], a[o++] = e[5], a[o++] = e[9], a[o++] = e[13], a[o++] = e[2], a[o++] = e[6], a[o++] = e[10], a[o++] = e[14]
                }
            }
        }(),
        update: function (e) {
            this._isInitialized || this.init(e), this.computeMatrixPalette(e.getMatrixFromSkeletonToGeometry(), e.getInvMatrixFromSkeletonToGeometry())
        }
    }, t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(84),
        a = i(36),
        o = i(451),
        s = function () {
            r.a.call(this, r.a.TRAVERSE_ALL_CHILDREN), this._boneMap = {}
        };
    n.a.createPrototypeObject(s, n.a.objectInherit(r.a.prototype, {
        apply: function (e) {
            if (e.typeID === o.a.typeID) {
                var t = e.getName();
                t ? this._boneMap[t] = e : a.a.warn("found Bone without name")
            }
            this.traverse(e)
        },
        getBoneMap: function () {
            return this._boneMap
        }
    }), "osgAnimation", "CollectBoneVisitor"), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(10),
        r = function () {
            this._radiusEquator = r.WGS_84_RADIUS_EQUATOR, this._radiusPolar = r.WGS_84_RADIUS_POLAR, this.computeCoefficients()
        };
    r.WGS_84_RADIUS_EQUATOR = 6378137, r.WGS_84_RADIUS_POLAR = 6356752.3142, r.prototype = {
        setRadiusEquator: function (e) {
            this._radiusEquator = e, this.computeCoefficients()
        },
        getRadiusEquator: function () {
            return this._radiusEquator
        },
        setRadiusPolar: function (e) {
            this._radiusPolar = e, this.computeCoefficients()
        },
        getRadiusPolar: function () {
            return this._radiusPolar
        },
        convertLatLongHeightToXYZ: function (e, t, i, n) {
            var r = Math.sin(e),
                a = Math.cos(e),
                o = this._radiusEquator / Math.sqrt(1 - this._eccentricitySquared * r * r),
                s = (o + i) * a * Math.cos(t),
                u = (o + i) * a * Math.sin(t),
                l = (o * (1 - this._eccentricitySquared) + i) * r;
            return n[0] = s, n[1] = u, n[2] = l, n
        },
        convertXYZToLatLongHeight: function (e, t, i, n) {
            var r = Math.sqrt(e * e + t * t),
                a = Math.atan2(i * this._radiusEquator, r * this._radiusPolar),
                o = (this._radiusEquator * this._radiusEquator - this._radiusPolar * this._radiusPolar) / (this._radiusPolar * this._radiusPolar),
                s = Math.sin(a),
                u = Math.cos(a),
                l = Math.atan((i + o * this._radiusPolar * s * s * s) / (r - this._eccentricitySquared * this._radiusEquator * u * u * u)),
                c = Math.atan2(t, e),
                h = Math.sin(l),
                d = this._radiusEquator / Math.sqrt(1 - this._eccentricitySquared * h * h),
                f = Math.cos(l);
            0 === f && (f = 1);
            var p = r / f - d;
            return n[0] = l, n[1] = c, n[2] = p, n
        },
        computeLocalUpVector: function (e, t, i) {
            var r, a, o = this.convertXYZToLatLongHeight(e, t, i, n.f.create());
            return r = o[0], a = o[1], [Math.cos(a) * Math.cos(r), Math.sin(a) * Math.cos(r), Math.sin(r)]
        },
        isWGS84: function () {
            return this._radiusEquator === r.WGS_84_RADIUS_EQUATOR && this._radiusPolar === r.WGS_84_RADIUS_POLAR
        },
        computeCoefficients: function () {
            var e = (this._radiusEquator - this._radiusPolar) / this._radiusEquator;
            this._eccentricitySquared = 2 * e - e * e
        },
        computeLocalToWorldTransformFromLatLongHeight: function (e, t, i, r) {
            var a = this.convertLatLongHeightToXYZ(e, t, i, r);
            return n.c.fromTranslation(r, a), this.computeCoordinateFrame(e, t, r), r
        },
        computeLocalToWorldTransformFromXYZ: function (e, t, i) {
            var r = this.convertXYZToLatLongHeight(e, t, i, n.f.create()),
                a = n.c.fromTranslation(n.c.create(), n.f.fromValues(e, t, i));
            return this.computeCoordinateFrame(r[0], r[1], a), a
        },
        computeCoordinateFrame: function () {
            var e = n.f.create(),
                t = n.f.create(),
                i = n.f.create();
            return function (r, a, o) {
                e[0] = Math.cos(a) * Math.cos(r), e[1] = Math.sin(a) * Math.cos(r), e[2] = Math.sin(r), t[0] = -Math.sin(a), t[1] = -Math.cos(a), n.f.cross(i, e, t), n.c.set(o, t[0], t[1], t[2], 0, i[0], i[1], i[2], 0, e[0], e[1], e[2], 0, 0, 0, 0, 1)
            }
        }()
    }, t.a = r
}, function (e, t, i) {
    "use strict";
    var n = i(5),
        r = i.n(n),
        a = i(12),
        o = i(448),
        s = function (e) {
            o.a.call(this, e), this._canPlayDefered = void 0
        };
    s.PAUSE = 0, s.PLAYING = 1, a.a.createPrototypeObject(s, a.a.objectInherit(o.a.prototype, {
        isDirty: function () {
            return this._status === s.PLAYING
        },
        setImage: function (e) {
            o.a.prototype.setImage.call(this, e), this._status = s.STOP, e.addEventListener("ended", function () {
                this._imageObject.loop || this.stop()
            }.bind(this), !0), this.dirty()
        },
        setLooping: function (e) {
            this._imageObject.loop = e
        },
        play: function () {
            this._imageObject.play(), this._status = s.PLAYING
        },
        stop: function () {
            this._imageObject.pause(), this._status = s.PAUSE
        },
        whenReady: function () {
            if (!this._imageObject) return r.a.reject();
            var e = this;
            return new r.a(function (t) {
                e._canPlayDefered || (e._canPlayDefered = t, e._imageObject.readyState > 3 ? e._canPlayDefered(e) : e._imageObject.addEventListener("canplaythrough", e._canPlayDefered.bind(e._canPlayDefered, e), !0))
            })
        }
    }), "osg", "ImageStream"), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(84),
        a = i(858),
        o = function (e) {
            if (r.a.call(this), this._buildOptions = {
                    _numVerticesProcessed: 0,
                    _targetNumTrianglesPerLeaf: 50,
                    _maxNumLevels: 20
                }, e) {
                var t = e._targetNumTrianglesPerLeaf,
                    i = e._maxNumLevels;
                void 0 !== t && (this._buildOptions._targetNumTrianglesPerLeaf = t), void 0 !== i && (this._buildOptions._maxNumLevels = i)
            }
        };
    n.a.createPrototypeObject(o, n.a.objectInherit(r.a.prototype, {
        apply: function (e) {
            if (e.getShape) {
                if (void 0 === e.getShape()) {
                    var t = new a.a;
                    t.build(this._buildOptions, e) && e.setShape(t)
                }
            }
            this.traverse(e)
        }
    }), "osg", "KdTreeBuilder"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(92),
        a = function (e) {
            r.a.call(this), this.lineWidth = 1, void 0 !== e && (this.lineWidth = e)
        };
    n.a.createPrototypeStateAttribute(a, n.a.objectInherit(r.a.prototype, {
        attributeType: "LineWidth",
        cloneType: function () {
            return new a
        },
        apply: function (e) {
            e.getGraphicContext().lineWidth(this.lineWidth)
        }
    }), "osg", "LineWidth"), t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(92),
        a = i(108),
        o = function (e) {
            r.a.call(this), this._enable = !e, this._pointSize = 1, this._circleShape = !1, this._dirtyHash = !0, this._hash = ""
        };
    n.a.createPrototypeStateAttribute(o, n.a.objectInherit(r.a.prototype, {
        attributeType: "PointSize",
        cloneType: function () {
            return new o(!0)
        },
        setCircleShape: function (e) {
            this._circleShape = e, this._dirtyHash = !0
        },
        isCircleShape: function () {
            return this._circleShape
        },
        setEnabled: function (e) {
            this._enable = e, this._dirtyHash = !0
        },
        isEnabled: function () {
            return this._enable
        },
        setPointSize: function (e) {
            this._pointSize = e
        },
        getOrCreateUniforms: function () {
            var e = o;
            return e.uniforms ? e.uniforms : (e.uniforms = {
                pointSize: a.a.createFloat(1, "uPointSize")
            }, e.uniforms)
        },
        getHash: function () {
            return this._dirtyHash ? (this._hash = this._computeInternalHash(), this._dirtyHash = !1, this._hash) : this._hash
        },
        _computeInternalHash: function () {
            return this.getTypeMember() + (this.isEnabled() ? "1" : "0") + (this._circleShape ? "1" : "0")
        },
        apply: function () {
            if (this._enable) {
                this.getOrCreateUniforms().pointSize.setFloat(this._pointSize)
            }
        }
    }), "osg", "PointSizeAttribute"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(10),
        r = i(138),
        a = i(289),
        o = i(291),
        s = [],
        u = [];
    s[r.a.POINTS] = function () {
        var e = n.f.create();
        return function (t, i, n, r, a) {
            for (var o = t + i, s = t; s < o; ++s) {
                var u = 3 * n[s];
                e[0] = a[u], e[1] = a[u + 1], e[2] = a[u + 2], r.operatorPoint(e)
            }
        }
    }(), s[r.a.LINES] = function () {
        var e = n.f.create(),
            t = n.f.create();
        return function (i, n, r, a, o) {
            for (var s = i + n, u = i; u < s - 1; u += 2) {
                var l = 3 * r[u];
                e[0] = o[l], e[1] = o[l + 1], e[2] = o[l + 2], l = 3 * r[u + 1], t[0] = o[l], t[1] = o[l + 1], t[2] = o[l + 2], a.operatorLine(e, t)
            }
        }
    }(), s[r.a.LINE_STRIP] = function () {
        var e = n.f.create(),
            t = n.f.create();
        return function (i, n, r, a, o) {
            for (var s = i + n, u = i; u < s - 1; ++u) {
                var l = 3 * r[u];
                e[0] = o[l], e[1] = o[l + 1], e[2] = o[l + 2], l = 3 * r[u + 1], t[0] = o[l], t[1] = o[l + 1], t[2] = o[l + 2], a.operatorLine(e, t)
            }
        }
    }(), s[r.a.LINE_LOOP] = function () {
        var e = n.f.create(),
            t = n.f.create();
        return function (i, n, r, a, o) {
            for (var s = i + n - 1, u = i; u < s; ++u) {
                var l = 3 * r[u];
                e[0] = o[l], e[1] = o[l + 1], e[2] = o[l + 2], l = 3 * r[u + 1], t[0] = o[l], t[1] = o[l + 1], t[2] = o[l + 2], a.operatorLine(e, t)
            }
            s = 3 * r[s], e[0] = o[s], e[1] = o[s + 1], e[2] = o[s + 2];
            var c = 3 * r[0];
            t[0] = o[c], t[1] = o[c + 1], t[2] = o[c + 2], a.operatorLine(e, t)
        }
    }(), s[r.a.TRIANGLES] = function () {
        var e = n.f.create(),
            t = n.f.create(),
            i = n.f.create();
        return function (n, r, a, o, s) {
            for (var u = n + r, l = n; l < u; l += 3) {
                var c = 3 * a[l];
                e[0] = s[c], e[1] = s[c + 1], e[2] = s[c + 2], c = 3 * a[l + 1], t[0] = s[c], t[1] = s[c + 1], t[2] = s[c + 2], c = 3 * a[l + 2], i[0] = s[c], i[1] = s[c + 1], i[2] = s[c + 2], o.operatorTriangle(e, t, i)
            }
        }
    }(), s[r.a.TRIANGLE_STRIP] = function () {
        var e = n.f.create(),
            t = n.f.create(),
            i = n.f.create();
        return function (n, r, a, o, s) {
            for (var u = 2, l = n; u < r; ++u, ++l) {
                var c = 3 * a[l];
                e[0] = s[c], e[1] = s[c + 1], e[2] = s[c + 2], c = 3 * a[l + 1], t[0] = s[c], t[1] = s[c + 1], t[2] = s[c + 2], c = 3 * a[l + 2], i[0] = s[c], i[1] = s[c + 1], i[2] = s[c + 2], u % 2 ? o.operatorTriangle(e, i, t) : o.operatorTriangle(e, t, i)
            }
        }
    }(), s[r.a.TRIANGLE_FAN] = function () {
        var e = n.f.create(),
            t = n.f.create(),
            i = n.f.create();
        return function (n, r, a, o, s) {
            for (var u = a[n], l = 2, c = n + 1; l < r; ++l, ++c) {
                e[0] = s[u], e[1] = s[u + 1], e[2] = s[u + 2];
                var h = 3 * a[c];
                t[0] = s[h], t[1] = s[h + 1], t[2] = s[h + 2], h = 3 * a[c + 1], i[0] = s[h], i[1] = s[h + 1], i[2] = s[h + 2], o.operatorTriangle(e, t, i)
            }
        }
    }(), u[r.a.POINTS] = function () {
        var e = n.f.create();
        return function (t, i, n, r) {
            for (var a = t; a < t + i; ++a) {
                var o = 3 * a;
                e[0] = r[o], e[1] = r[o + 1], e[2] = r[o + 2], n.operatorPoint(e)
            }
        }
    }(), u[r.a.LINES] = function () {
        var e = n.f.create(),
            t = n.f.create();
        return function (i, n, r, a) {
            for (var o = i; o < i + n - 1; o += 2) {
                var s = 3 * o;
                e[0] = a[s], e[1] = a[s + 1], e[2] = a[s + 2], s = 3 * (o + 1), t[0] = a[s], t[1] = a[s + 1], t[2] = a[s + 2], r.operatorLine(e, t)
            }
        }
    }(), u[r.a.LINE_STRIP] = function () {
        var e = n.f.create(),
            t = n.f.create();
        return function (i, n, r, a) {
            for (var o = i; o < i + n - 1; ++o) {
                var s = 3 * o;
                e[0] = a[s], e[1] = a[s + 1], e[2] = a[s + 2], s = 3 * (o + 1), t[0] = a[s], t[1] = a[s + 1], t[2] = a[s + 2], r.operatorLine(e, t)
            }
        }
    }(), u[r.a.LINE_LOOP] = function () {
        var e = n.f.create(),
            t = n.f.create();
        return function (i, n, r, a) {
            for (var o = i + n - 1, s = i; s < o; ++s) {
                var u = 3 * s;
                e[0] = a[u], e[1] = a[u + 1], e[2] = a[u + 2], u = 3 * (s + 1), t[0] = a[u], t[1] = a[u + 1], t[2] = a[u + 2], r.operatorLine(e, t)
            }
            o *= 3, e[0] = a[o], e[1] = a[o + 1], e[2] = a[o + 2], i *= 3, t[0] = a[i], t[1] = a[i + 1], t[2] = a[i + 2], r.operatorLine(e, t)
        }
    }(), u[r.a.TRIANGLES] = function () {
        var e = n.f.create(),
            t = n.f.create(),
            i = n.f.create();
        return function (n, r, a, o) {
            for (var s = n; s < n + r; s += 3) {
                var u = 3 * s;
                e[0] = o[u], e[1] = o[u + 1], e[2] = o[u + 2], u = 3 * (s + 1), t[0] = o[u], t[1] = o[u + 1], t[2] = o[u + 2], u = 3 * (s + 2), i[0] = o[u], i[1] = o[u + 1], i[2] = o[u + 2], a.operatorTriangle(e, t, i)
            }
        }
    }(), u[r.a.TRIANGLE_STRIP] = function () {
        var e = n.f.create(),
            t = n.f.create(),
            i = n.f.create();
        return function (n, r, a, o) {
            for (var s = 2, u = n; s < r; ++s, ++u) {
                var l = 3 * u;
                e[0] = o[l], e[1] = o[l + 1], e[2] = o[l + 2], l = 3 * (u + 1), t[0] = o[l], t[1] = o[l + 1], t[2] = o[l + 2], l = 3 * (u + 2), i[0] = o[l], i[1] = o[l + 1], i[2] = o[l + 2], s % 2 ? a.operatorTriangle(e, i, t) : a.operatorTriangle(e, t, i)
            }
        }
    }(), u[r.a.TRIANGLE_FAN] = function () {
        var e = n.f.create(),
            t = n.f.create(),
            i = n.f.create();
        return function (n, r, a, o) {
            for (var s = 2, u = n + 1; s < r; ++s, ++u) {
                e[0] = o[n], e[1] = o[n + 1], e[2] = o[n + 2];
                var l = 3 * u;
                t[0] = o[l], t[1] = o[l + 1], t[2] = o[l + 2], l = 3 * (u + 1), i[0] = o[l], i[1] = o[l + 1], i[2] = o[l + 2], a.operatorTriangle(e, t, i)
            }
        }
    }();
    var l = function (e, t, i) {
        var n = e.getPrimitiveSetList();
        if (n)
            for (var r, l = n.length, c = 0; c < l; c++) {
                var h = n[c];
                if (h instanceof a.a) {
                    if (r = s[h.getMode()]) {
                        var d = h.indices.getElements();
                        r(h.getFirst() / d.BYTES_PER_ELEMENT, h.getCount(), d, t, i)
                    }
                } else h instanceof o.a && (r = u[h.getMode()]) && r(h.getFirst(), h.getCount(), t, i)
            }
    };
    t.a = l
}, function (e, t, i) {
    "use strict";
    var n = function (e, t) {
            return "core_" + t
        },
        r = function (e, t) {
            return "#define " + t
        },
        a = "(GL_EXT_shader_texture_lod|GL_OES_standard_derivatives|GL_EXT_draw_buffers|GL_EXT_frag_depth;)",
        o = new RegExp("#\\s*extension\\s+" + a + ".*", "g"),
        s = new RegExp(a, "g"),
        u = function (e) {
            return e = e.replace(o, r), e = e.replace(s, n)
        },
        l = [],
        c = function (e, t) {
            var i = "glFragData_" + t;
            return l[t] = "layout(location = " + t + ") out vec4 " + i + ";", i
        },
        h = function (e, t) {
            return e = e.replace(/attribute\s+/g, "in "), e = e.replace(/varying\s+/g, t ? "in " : "out "), e = e.replace(/(texture2D|textureCube)\s*\(/g, "texture("), e = e.replace(/(textureCubeLodEXT)\s*\(/g, "textureLod("), e = u(e), t && (l.length = 0, e = e.replace(/gl_FragData\s*\[\s*(\d+)\s*\]/g, c), l.length || l.push("out vec4 glFragColor_0;"), e = e.replace(/gl_FragColor/g, "glFragColor_0"), e = e.replace(/void\s+main\s*\(/g, l.join("\n") + "\nvoid main(")), e
        };
    t.a = h
}, function (e, t, i) {
    "use strict";
    var n = i(365),
        r = i(362),
        a = i(449),
        o = function () {
            return {
                buffer: {
                    separate: !1,
                    enable: !1,
                    sourceFactor: r.a.ONE,
                    destinationFactor: r.a.ZERO,
                    sourceFactorAlpha: r.a.ONE,
                    destinationFactorAlpha: r.a.ZERO
                },
                state: {
                    separate: void 0,
                    enable: !1,
                    sourceFactor: void 0,
                    destinationFactor: void 0,
                    sourceFactorAlpha: void 0,
                    destinationFactorAlpha: void 0
                },
                changed: !0
            }
        },
        s = function () {
            return {
                buffer: {
                    func: n.a.LESS,
                    enable: !1,
                    near: 0,
                    far: 1
                },
                state: {
                    func: void 0,
                    enable: !1,
                    near: void 0,
                    far: void 0
                },
                changed: !0
            }
        },
        u = function () {
            return {
                buffer: {
                    enable: !1,
                    mode: a.a.BACK
                },
                state: {
                    enable: !1,
                    mode: void 0
                },
                changed: !0
            }
        },
        l = function () {
            return {
                buffer: {
                    enable: !1,
                    x: 0,
                    y: 0,
                    width: 640,
                    height: 480
                },
                state: {
                    enable: !1,
                    x: void 0,
                    y: void 0,
                    width: void 0,
                    height: void 0
                },
                changed: !0
            }
        },
        c = function () {
            return {
                buffer: {
                    red: !0,
                    green: !0,
                    blue: !0,
                    alpha: !0
                },
                state: {
                    red: void 0,
                    green: void 0,
                    blue: void 0,
                    alpha: void 0
                },
                changed: !0
            }
        },
        h = function () {
            return {
                buffer: {
                    x: 0,
                    y: 0,
                    width: 640,
                    height: 480
                },
                state: {
                    x: void 0,
                    y: void 0,
                    width: void 0,
                    height: void 0
                },
                changed: !0
            }
        },
        d = function () {
            return {
                state: {
                    value: !0
                },
                buffer: {
                    value: void 0
                },
                changed: !0
            }
        },
        f = function () {
            return {
                buffer: {
                    value: 1
                },
                state: {
                    value: void 0
                },
                changed: !0
            }
        },
        p = function () {
            return {
                buffer: {
                    red: 0,
                    green: 0,
                    blue: 0,
                    alpha: 0
                },
                state: {
                    red: void 0,
                    green: void 0,
                    blue: void 0,
                    alpha: void 0
                },
                changed: !0
            }
        },
        m = function () {
            this._stateClearColor = p(), this._stateClearDepth = f(), this._stateDepthMask = d(), this._stateViewport = h(), this._stateColorMask = c(), this._stateScissor = l(), this._stateDepth = s(), this._stateCullFace = u(), this._stateBlendFunc = o()
        };
    m.prototype = {
        clearColor: function (e) {
            var t = this._stateClearColor,
                i = t.buffer,
                n = t.state;
            t.changed = !1, i.red = e[0], i.green = e[1], i.blue = e[2], i.alpha = e[3], n.red === e[0] && n.green === e[1] && n.blue === e[2] && n.alpha === e[3] || (t.changed = !0)
        },
        applyClearColor: function (e) {
            var t = this._stateClearColor,
                i = t.state,
                n = t.buffer;
            t.changed = !1, i.red = n.red, i.green = n.green, i.blue = n.blue, i.alpha = n.alpha, e.clearColor(i.red, i.green, i.blue, i.alpha)
        },
        clearDepth: function (e) {
            var t = this._stateClearDepth,
                i = t.buffer,
                n = t.state;
            t.changed = !1, i.value = e, n.value !== e && (t.changed = !0)
        },
        applyClearDepth: function (e) {
            var t = this._stateClearDepth,
                i = t.buffer,
                n = t.state;
            t.changed = !1, n.value = i.value, e.clearDepth(n.value)
        },
        depthMask: function (e) {
            var t = this._stateDepthMask,
                i = t.buffer,
                n = t.state;
            t.changed = !1, i.value = e, n.value !== e && (t.changed = !0)
        },
        applyDepthMask: function (e) {
            var t = this._stateDepthMask,
                i = t.buffer,
                n = t.state;
            t.changed = !1, n.value = i.value, e.depthMask(n.value)
        },
        applyViewportAttribute: function (e) {
            this.viewport(e._x, e._y, e._width, e._height)
        },
        viewport: function (e, t, i, n) {
            var r = this._stateViewport,
                a = r.buffer,
                o = r.state;
            r.changed = !1, a.x = e, a.y = t, a.width = i, a.height = n, o.x === e && o.y === t && o.width === i && o.height === n || (r.changed = !0)
        },
        applyViewport: function (e) {
            var t = this._stateViewport,
                i = t.buffer,
                n = t.state;
            t.changed = !1, n.x = i.x, n.y = i.y, n.width = i.width, n.height = i.height, e.viewport(n.x, n.y, n.width, n.height)
        },
        applyColorMaskAttribute: function (e) {
            var t = this._stateColorMask,
                i = t.buffer,
                n = t.state;
            t.changed = !1, i.red = e._red, i.green = e._green, i.blue = e._blue, i.alpha = e._alpha, n.red === e._red && n.green === e._green && n.blue === e._blue && n.alpha === e._alpha || (t.changed = !0)
        },
        applyColorMask: function (e) {
            var t = this._stateColorMask,
                i = t.buffer,
                n = t.state;
            t.changed = !1, n.red = i.red, n.green = i.green, n.blue = i.blue, n.alpha = i.alpha, e.colorMask(n.red, n.green, n.blue, n.alpha)
        },
        applyScissorAttribute: function (e) {
            var t = -1 !== e._x,
                i = this._stateScissor,
                n = i.buffer,
                r = i.state;
            i.changed = !1, n.enable = t, n.x = e._x, n.y = e._y, n.width = e._width, n.height = e._height, r.enable === t && r.x === e._x && r.y === e._y && r.width === e._width && r.height === e._height || (i.changed = !0)
        },
        applyScissor: function (e) {
            var t = this._stateScissor,
                i = t.buffer,
                n = t.state;
            t.changed = !1, n.enable !== i.enable && (n.enable = i.enable, n.enable ? e.enable(e.SCISSOR_TEST) : e.disable(e.SCISSOR_TEST)), n.enable && (n.x === i.x && n.y === i.y && n.width === i.width && n.height === i.height || (n.x = i.x, n.y = i.y, n.width = i.width, n.height = i.height, e.scissor(n.x, n.y, n.width, n.height)))
        },
        applyCullFaceAttribute: function (e) {
            var t = this._stateCullFace,
                i = t.buffer,
                n = t.state,
                r = e._mode !== a.a.DISABLE;
            t.changed = !1, i.enable = r, i.mode = e._mode, n.enable === r && n.mode === e._mode || (t.changed = !0)
        },
        applyCullFace: function (e) {
            var t = this._stateCullFace,
                i = t.buffer,
                n = t.state;
            t.changed = !1, n.enable !== i.enable && (n.enable = i.enable, n.enable ? e.enable(e.CULL_FACE) : e.disable(e.CULL_FACE)), n.enable && n.mode !== i.mode && (n.mode = i.mode, e.cullFace(n.mode))
        },
        applyDepthAttribute: function (e) {
            var t = e._func !== n.a.DISABLE,
                i = this._stateDepth,
                r = i.buffer,
                a = i.state;
            i.changed = !1, r.enable = t, r.func = e._func, r.far = e._far, r.near = e._near, a.enable === t && a.func === e._func && a.near === e._near && a.far === e._far || (i.changed = !0), this.depthMask(e._writeMask)
        },
        applyDepth: function (e) {
            var t = this._stateDepth,
                i = t.buffer,
                n = t.state;
            t.changed = !1, n.enable !== i.enable && (n.enable = i.enable, n.enable ? e.enable(e.DEPTH_TEST) : e.disable(e.DEPTH_TEST)), n.enable && (n.func !== i.func && (n.func = i.func, e.depthFunc(n.func)), n.near === i.near && n.far === i.far || (n.far = i.far, n.near = i.near, e.depthRange(n.near, n.far)))
        },
        applyBlendFuncAttribute: function (e) {
            var t = this._stateBlendFunc,
                i = t.buffer,
                n = t.state,
                a = e._sourceFactor !== r.a.DISABLE && e._destinationFactor !== r.a.DISABLE;
            t.changed = !1, i.enable = a, i.separate = e._separate, i.sourceFactor = e._sourceFactor, i.destinationFactor = e._destinationFactor, i.sourceFactorAlpha = e._sourceFactorAlpha, i.destinationFactorAlpha = e._destinationFactorAlpha, n.enable === a && n.sourceFactor === e._sourceFactor && n.destinationFactor === e._destinationFactor && n.sourceFactorAlpha === e._sourceFactorAlpha && n.destinationFactorAlpha === e._destinationFactorAlpha || (t.changed = !0)
        },
        applyBlendFunc: function (e) {
            var t = this._stateBlendFunc,
                i = t.buffer,
                n = t.state;
            t.changed = !1, n.enable !== i.enable && (n.enable = i.enable, n.enable ? e.enable(e.BLEND) : e.disable(e.BLEND)), n.enable && (n.separate = i.separate, n.separate ? n.sourceFactor === i.sourceFactor && n.destinationFactor === i.destinationFactor && n.sourceFactorAlpha === i.sourceFactorAlpha && n.destinationFactorAlpha === i.destinationFactorAlpha || (n.sourceFactor = i.sourceFactor, n.destinationFactor = i.destinationFactor, n.sourceFactorAlpha = i.sourceFactorAlpha, n.destinationFactorAlpha = i.destinationFactorAlpha, e.blendFuncSeparate(n.sourceFactor, n.destinationFactor, n.sourceFactorAlpha, n.destinationFactorAlpha)) : n.sourceFactor === i.sourceFactor && n.destinationFactor === i.destinationFactor || (n.sourceFactor = i.sourceFactor, n.destinationFactor = i.destinationFactor, e.blendFunc(n.sourceFactor, n.destinationFactor)))
        },
        applyClearStates: function (e) {
            this._stateDepthMask.changed && this.applyDepthMask(e), this._stateScissor.changed && this.applyScissor(e), this._stateClearColor.changed && this.applyClearColor(e), this._stateClearDepth.changed && this.applyClearDepth(e), this._stateColorMask.changed && this.applyColorMask(e)
        },
        applyDrawStates: function (e) {
            this._stateViewport.changed && this.applyViewport(e), this._stateScissor.changed && this.applyScissor(e), this._stateDepth.changed && this.applyDepth(e), this._stateDepthMask.changed && this.applyDepthMask(e), this._stateCullFace.changed && this.applyCullFace(e), this._stateBlendFunc.changed && this.applyBlendFunc(e), this._stateColorMask.changed && this.applyColorMask(e)
        },
        clear: function (e, t) {
            this.applyClearStates(e), e.clear(t)
        },
        drawGeometry: function (e) {
            this.applyDrawStates(e)
        }
    }, t.a = m
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(448),
        a = i(36),
        o = i(118),
        s = function () {
            o.default.call(this), this._images = {};
            for (var e = 0; e < 6; e++) this._images[o.default.TEXTURE_CUBE_MAP_POSITIVE_X + e] = new r.a
        };
    n.a.createPrototypeStateAttribute(s, n.a.objectInherit(o.default.prototype, {
        setDefaultParameters: function () {
            o.default.prototype.setDefaultParameters.call(this), this._textureTarget = o.default.TEXTURE_CUBE_MAP, this._flipY = !1
        },
        invalidate: function () {
            o.default.prototype.invalidate.call(this);
            for (var e = o.default.TEXTURE_CUBE_MAP_POSITIVE_X; e < o.default.TEXTURE_CUBE_MAP_POSITIVE_X + 6; e++) {
                var t = this._images[e];
                this._images[o.default.TEXTURE_CUBE_MAP_POSITIVE_X].getImage() && t.dirty()
            }
            this.dirty()
        },
        cloneType: function () {
            return new s
        },
        setImage: function (e, t, i) {
            var n = e;
            "string" == typeof n && (n = o.default[n]), this._images[n].setImage(t, i), this.setImageFormat(i), this.setTextureSize(this._images[n].getWidth(), this._images[n].getHeight()), this._textureNull = !1, this.dirty()
        },
        getImage: function (e) {
            return this._images[e].getImage()
        },
        initCubemapContent: function (e) {
            var t = this._internalFormat;
            return this.applyTexImage2D(e, e.TEXTURE_CUBE_MAP_POSITIVE_X, 0, t, this._textureWidth, this._textureHeight, 0, t, this._type, null), this.applyTexImage2D(e, e.TEXTURE_CUBE_MAP_NEGATIVE_X, 0, t, this._textureWidth, this._textureHeight, 0, t, this._type, null), this.applyTexImage2D(e, e.TEXTURE_CUBE_MAP_POSITIVE_Y, 0, t, this._textureWidth, this._textureHeight, 0, t, this._type, null), this.applyTexImage2D(e, e.TEXTURE_CUBE_MAP_NEGATIVE_Y, 0, t, this._textureWidth, this._textureHeight, 0, t, this._type, null), this.applyTexImage2D(e, e.TEXTURE_CUBE_MAP_POSITIVE_Z, 0, t, this._textureWidth, this._textureHeight, 0, t, this._type, null), this.applyTexImage2D(e, e.TEXTURE_CUBE_MAP_NEGATIVE_Z, 0, t, this._textureWidth, this._textureHeight, 0, t, this._type, null), !0
        },
        generateMipmap: function (e, t) {
            if (this.hasMipmapFilter()) {
                if (this._images[o.default.TEXTURE_CUBE_MAP_POSITIVE_X].hasMipmap())
                    for (var i = 0; i < 6; i++) {
                        var n = this._images[o.default.TEXTURE_CUBE_MAP_POSITIVE_X + i];
                        n.hasMipmap() || a.a.error("mipmap not set correctly for TextureCubemap");
                        for (var r = this._internalFormat, s = 1; s < n.getMipmap().length; s++) {
                            var u = n.getMipmap()[s].getWidth();
                            this.applyTexImage2D(e, e.TEXTURE_CUBE_MAP_POSITIVE_X + i, s, r, u, u, 0, r, this._type, n.getMipmap()[s].getImage())
                        }
                    } else e.generateMipmap(t);
                this._dirtyMipmap = !1
            }
        },
        applyImageTarget: function (e, t, i) {
            var n = this._images[i];
            return n.getImage() && n.isReady() ? n.isDirty() ? (this.setTextureSize(n.getWidth(), n.getHeight()), n.setDirty(!1), n.isTypedArray() ? this.applyTexImage2D(e, i, 0, t, this._textureWidth, this._textureHeight, 0, t, this._type, n.getImage()) : this.applyTexImage2D(e, i, 0, t, t, this._type, n.getImage()), !this._unrefImageDataAfterApply || this.hasMipmap() && n.hasMipmap() || n.release(), 1) : 1 : 0
        },
        initCubemapContentImage: function (e) {
            var t = this._internalFormat,
                i = 0;
            return i += this.applyImageTarget(e, t, e.TEXTURE_CUBE_MAP_POSITIVE_X), i += this.applyImageTarget(e, t, e.TEXTURE_CUBE_MAP_NEGATIVE_X), i += this.applyImageTarget(e, t, e.TEXTURE_CUBE_MAP_POSITIVE_Y), i += this.applyImageTarget(e, t, e.TEXTURE_CUBE_MAP_NEGATIVE_Y), i += this.applyImageTarget(e, t, e.TEXTURE_CUBE_MAP_POSITIVE_Z), 6 === (i += this.applyImageTarget(e, t, e.TEXTURE_CUBE_MAP_NEGATIVE_Z))
        },
        apply: function (e) {
            var t = e.getGraphicContext();
            if (this._dirtyTextureObject && (this.releaseGLObjects(), this.setGraphicContext(t)), void 0 === this._textureObject || this.isDirty())
                if (this._textureNull) t.bindTexture(this._textureTarget, null);
                else {
                    this._textureObject || (this.computeTextureFormat(), this.init(e)), this._textureObject.bind(t);
                    var i;
                    i = this._images[o.default.TEXTURE_CUBE_MAP_POSITIVE_X].getImage() ? this.initCubemapContentImage(t) : this.initCubemapContent(t), i && (this._dirty = !1, this.applyFilterParameter(t, this._textureTarget), this.generateMipmap(t, this._textureTarget))
                }
            else this._textureObject.bind(t), this.isDirtyMipmap() && this.generateMipmap(t, this._textureTarget)
        }
    }), "osg", "TextureCubeMap"), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(138),
        r = i(289),
        a = i(291),
        o = function () {},
        s = o.functorDrawElements = [],
        u = o.functorDrawArrays = [];
    s[n.a.TRIANGLES] = function (e, t, i, n) {
        for (var r = e + t, a = e; a < r; a += 3) n(i[a], i[a + 1], i[a + 2])
    }, s[n.a.TRIANGLE_STRIP] = function (e, t, i, n) {
        for (var r = 2, a = e; r < t; ++r, ++a) r % 2 ? n(i[a], i[a + 2], i[a + 1]) : n(i[a], i[a + 1], i[a + 2])
    }, s[n.a.TRIANGLE_FAN] = function (e, t, i, n) {
        for (var r = i[e], a = 2, o = e + 1; a < t; ++a, ++o) n(r, i[o], i[o + 1])
    }, u[n.a.TRIANGLES] = function (e, t, i) {
        for (var n = 2, r = e; n < t; n += 3, r += 3) i(r, r + 1, r + 2)
    }, u[n.a.TRIANGLE_STRIP] = function (e, t, i) {
        for (var n = 2, r = e; n < t; ++n, ++r) n % 2 ? i(r, r + 2, r + 1) : i(r, r + 1, r + 2)
    }, u[n.a.TRIANGLE_FAN] = function (e, t, i) {
        for (var n = 2, r = e + 1; n < t; ++n, ++r) i(e, r, r + 1)
    }, o.prototype = {
        init: function (e, t) {
            this._geom = e, this._cb = t
        },
        apply: function () {
            var e = this._geom,
                t = e.getPrimitiveSetList();
            if (t)
                for (var i, n = this._cb, o = t.length, l = 0; l < o; l++) {
                    var c = t[l];
                    if (c instanceof r.a) {
                        if (i = s[c.getMode()]) {
                            var h = c.indices.getElements();
                            i(c.getFirst() / h.BYTES_PER_ELEMENT, c.getCount(), h, n)
                        }
                    } else c instanceof a.a && (i = u[c.getMode()]) && i(c.getFirst(), c.getCount(), n)
                }
        }
    }, t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(620),
        a = i(855),
        o = i(577),
        s = i(865),
        u = i(451),
        l = i(453),
        c = i(867),
        h = i(1096),
        d = i(866),
        f = i(854),
        p = i(364),
        m = i(452),
        g = i(617),
        v = i(868),
        _ = i(869),
        b = i(1097),
        S = i(689),
        x = i(870),
        y = i(618),
        C = i(576),
        T = i(621),
        w = i(853),
        M = {};
    n.a.objectMix(M, h.a), n.a.objectMix(M, d.a), M.Animation = r.a, M.SkinningAttribute = a.a, M.AnimationUpdateCallback = o.a, M.BasicAnimationManager = s.a, M.Bone = u.a, M.Channel = l.a, M.CollectAnimationUpdateCallbackVisitor = c.a, M.MorphAttribute = f.a, M.MorphGeometry = p.a, M.RigGeometry = m.a, M.Skeleton = g.a, M.StackedMatrix = v.a, M.StackedQuaternion = _.a, M.StackedRotateAxis = b.a, M.StackedScale = S.a, M.StackedTranslate = x.a, M.UpdateBone = y.a, M.UpdateMatrixTransform = C.a, M.UpdateMorph = T.a, M.UpdateSkeleton = w.a, t.a = M
}, function (e, t, i) {
    "use strict";

    function n(e) {
        return e
    }

    function r(e) {
        return e * e
    }

    function a(e) {
        return e * e * e
    }

    function o(e) {
        return e * e * e * e
    }

    function s(e) {
        return e * e * e * e * e
    }

    function u(e) {
        return e * e * e * e * e * e
    }

    function l(e) {
        return e * e * e * e * e * e * e
    }

    function c(e) {
        return e * e * e * e * e * e * e * e
    }

    function h(e) {
        var t = e - 1;
        return 1 - t * t
    }

    function d(e) {
        var t = e - 1;
        return 1 + t * t * t
    }

    function f(e) {
        var t = e - 1;
        return 1 - t * t * t * t
    }

    function p(e) {
        var t = e - 1;
        return 1 + t * t * t * t * t
    }

    function m(e) {
        var t = e - 1;
        return 1 - t * t * t * t * t * t
    }

    function g(e) {
        var t = e - 1;
        return 1 + t * t * t * t * t * t * t
    }

    function v(e) {
        var t = e - 1;
        return 1 - t * t * t * t * t * t * t * t
    }

    function _(e) {
        var t = e - 1,
            i = 2 * e;
        return i < 1 ? e * i : 1 - t * t * 2
    }

    function b(e) {
        var t = e - 1,
            i = 2 * e;
        return i < 1 ? e * i * i : 1 + t * t * t * 4
    }

    function S(e) {
        var t = e - 1,
            i = 2 * e;
        return i < 1 ? e * i * i * i : 1 - t * t * t * t * 8
    }

    function x(e) {
        var t = e - 1,
            i = 2 * e;
        return i < 1 ? e * i * i * i * i : 1 + t * t * t * t * t * 16
    }

    function y(e) {
        var t = e - 1,
            i = 2 * e;
        return i < 1 ? e * i * i * i * i * i : 1 - t * t * t * t * t * t * 32
    }

    function C(e) {
        var t = e - 1,
            i = 2 * e;
        return i < 1 ? e * i * i * i * i * i * i : 1 + t * t * t * t * t * t * t * 64
    }

    function T(e) {
        var t = e - 1,
            i = 2 * e;
        return i < 1 ? e * i * i * i * i * i * i * i : 1 - t * t * t * t * t * t * t * t * 128
    }

    function w(e) {
        var t = 1.70158;
        return e * e * (e * (t + 1) - t)
    }

    function M(e) {
        var t = e - 1,
            i = 2 * e,
            n = 2.5949095;
        return e < .5 ? e * i * (i * (n + 1) - n) : 1 + 2 * t * t * (2 * t * (n + 1) + n)
    }

    function E(e) {
        var t = e - 1,
            i = 1.70158;
        return 1 + t * t * (t * (i + 1) + i)
    }

    function A(e) {
        return 1 - Math.sqrt(1 - e * e)
    }

    function P(e) {
        var t = e - 1,
            i = 2 * e;
        return i < 1 ? .5 * (1 - Math.sqrt(1 - i * i)) : .5 * (Math.sqrt(1 - 4 * t * t) + 1)
    }

    function R(e) {
        var t = e - 1;
        return Math.sqrt(1 - t * t)
    }

    function O(e) {
        return -1 * Math.pow(2, 10 * e) * Math.sin(2 * (e - 1 - .075) * Math.PI / .3)
    }

    function I(e) {
        return Math.pow(2, -10 * e) * Math.sin((e - .075) * (2 * Math.PI) / .3) + 1
    }

    function F(e) {
        return (e *= 2) < 1 ? 1 * Math.pow(2, 10 * e) * -.5 * Math.sin(2 * (e - 1 - .45) * Math.PI / .45) : 1 * Math.pow(2, -10 * (e -= 1)) * Math.sin(2 * (e - .45) * Math.PI / .45) * .5 + 1
    }

    function N(e) {
        return e < 1 / 2.75 ? 7.5625 * e * e : e < 2 / 2.75 ? 7.5625 * (e -= 1.5 / 2.75) * e + .75 : e < 2.5 / 2.75 ? 7.5625 * (e -= 2.25 / 2.75) * e + .9375 : 7.5625 * (e -= 2.625 / 2.75) * e + .984375
    }

    function D(e) {
        return (e = 1 - e) < 1 / 2.75 ? 1 - 7.5625 * e * e : e < 2 / 2.75 ? 1 - (7.5625 * (e -= 1.5 / 2.75) * e + .75) : e < 2.5 / 2.75 ? 1 - (7.5625 * (e -= 2.25 / 2.75) * e + .9375) : 1 - (7.5625 * (e -= 2.625 / 2.75) * e + .984375)
    }

    function L(e) {
        var t;
        return e < .5 ? (t = !0, e = 1 - 2 * e) : e = 2 * e - 1, e < 1 / 2.75 ? e *= 7.5625 * e : e = e < 2 / 2.75 ? 7.5625 * (e -= 1.5 / 2.75) * e + .75 : e < 2.5 / 2.75 ? 7.5625 * (e -= 2.25 / 2.75) * e + .9375 : 7.5625 * (e -= 2.625 / 2.75) * e + .984375, t ? .5 * (1 - e) : .5 * e + .5
    }
    t.a = {
        easeLinear: n,
        easeOutQuad: h,
        easeInQuad: r,
        easeInOutQuad: _,
        easeOutCubic: d,
        easeInCubic: a,
        easeInOutCubic: b,
        easeOutQuart: f,
        easeInQuart: o,
        easeInOutQuart: S,
        easeOutQuintic: p,
        easeInQuintic: s,
        easeInOutQuintic: x,
        easeOutSextic: m,
        easeInSextic: u,
        easeInOutSextic: y,
        easeOutSeptic: g,
        easeInSeptic: l,
        easeInOutSeptic: C,
        easeOutOctic: v,
        easeInOctic: c,
        easeInOutOctic: T,
        easeOutBack: E,
        easeInBack: w,
        easeInOutBack: M,
        easeOutCircle: R,
        easeInCircle: A,
        easeInOutCircle: P,
        easeOutElastic: I,
        easeInElastic: O,
        easeInOutElastic: F,
        easeOutBounce: N,
        easeInBounce: D,
        easeInOutBounce: L
    }
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(102),
        a = i(10),
        o = i(408),
        s = function (e, t, i) {
            r.a.call(this), this._axis = a.f.fromValues(0, 0, 1), t && a.f.copy(this._axis, t), this._target = o.a.createFloatTarget("number" == typeof i ? i : 0), e && this.setName(e)
        };
    n.a.createPrototypeObject(s, n.a.objectInherit(r.a.prototype, {
        init: function (e, t) {
            this.setAxis(e), this.setAngle(t), this._target.defaultValue = t
        },
        setAxis: function (e) {
            a.f.copy(this._axis, e)
        },
        setAngle: function (e) {
            this._target.value = e
        },
        getTarget: function () {
            return this._target
        },
        resetToDefaultValue: function () {
            this.setAngle(this._target.defaultValue)
        },
        applyToMatrix: function () {
            var e = a.c.create(),
                t = a.d.create();
            return function (i) {
                var n = this._axis,
                    r = t,
                    o = e,
                    s = this._target.value;
                a.d.setAxisAngle(r, n, s), a.c.fromQuat(o, r), a.c.mul(i, i, o)
            }
        }()
    }), "osgAnimation", "StackedRotateAxis"), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(690),
        a = i(422),
        o = i(872),
        s = i(623),
        u = i(873),
        l = i(874),
        c = i(578),
        h = i(622),
        d = i(871),
        f = i(691),
        p = i.n(f),
        m = {};
    m.Input = r.default, n.a.objectMix(m, a.default), m.DatabasePager = o.a, m.ObjectWrapper.serializers.osg = s.a, m.ObjectWrapper.serializers.osgAnimation = u.a, m.ObjectWrapper.serializers.osgText = l.a, m.Registry = c.a, m.fileHelper = h.a, m.requestFile = d.a, n.a.objectMix(m, p.a), t.a = m
}, function (e, t, i) {
    "use strict";
    var n = {
        prefixURL: "",
        databasePath: "",
        progressXHRCallback: void 0,
        readNodeURL: void 0,
        readImageURL: void 0,
        readBinaryArrayURL: void 0,
        imageLoadingUsePromise: !0,
        imageOnload: void 0,
        imageCrossOrigin: void 0
    };
    t.a = n
}, function (e, t, i) {
    "use strict";
    var n = i(692),
        r = i.n(n),
        a = i(1101),
        o = i(879),
        s = i(881),
        u = i(1102),
        l = i(694),
        c = i(882),
        h = i(884),
        d = i(883),
        f = i(624),
        p = i(885),
        m = i(886),
        g = i(887),
        v = i(628),
        _ = i(693),
        b = i(888),
        S = i(1103),
        x = i(880),
        y = i(366),
        C = {};
    r.a.NO_MOUSEEVENTS = !0, C.CADManipulator = a.a, C.getCADManipulatorStandardMouseKeyboardController = function () {
        return o.a
    }, C.getCADManipulatorHammerController = function () {
        return s.a
    }, C.FirstPersonManipulator = u.a, C.getFirstPersonDeviceOrientationController = function () {
        return l.a
    }, C.getFirstPersonManipulatorHammerController = function () {
        return c.a
    }, C.getFirstPersonStandardMouseKeyboardControllerClass = function () {
        return h.a
    }, C.getFirstPersonWebVRControllerClass = function () {
        return d.a
    }, C.Manipulator = f.a, C.OrbitManipulator = p.a, C.getOrbitManipulatorDeviceOrientationController = function () {
        return m.a
    }, C.getOrbitManipulatorGamePadController = function () {
        return g.a
    }, C.getOrbitManipulatorHammerController = function () {
        return v.a
    }, C.getOrbitManipulatorStandardMouseKeyboardController = function () {
        return _.a
    }, C.getOrbitManipulatorWebVRController = function () {
        return b.a
    }, C.SwitchManipulator = S.a, C.OrbitManipulator.Rotate = x.a.ROTATE, C.OrbitManipulator.Pan = x.a.PAN, C.OrbitManipulator.Zoom = x.a.ZOOM, C.Controller = y.a, t.a = C
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(624),
        a = i(579),
        o = i(580),
        s = i(877),
        u = i(571),
        l = i(10),
        c = i(879),
        h = i(881),
        d = i(629),
        f = i(626),
        p = i(114),
        m = function (e) {
            r.a.call(this, e), this._tmpHomePosition = l.f.create(), this._intersectionVisitor = new a.a, this._lineSegmentIntersector = new o.a, this._polytopeIntersector = void 0, this._usePolytopeIntersector = !1, this._primitiveMask = f.a.ALL_PRIMITIVES, this.init()
        };
    m.Interpolator = function () {
        this._current = l.e.create(), this._target = l.e.create(), this._delta = l.e.create(), this._reset = !1, this.reset(), this._width = void 0, this._height = void 0
    }, m.Interpolator.prototype = {
        setWidth: function (e) {
            this._width = e
        },
        setHeight: function (e) {
            this._height = e
        },
        reset: function () {
            for (var e = 0, t = this._current.length; e < t; e++) this._current[e] = this._target[e] = 0;
            this._reset = !0
        },
        update: function () {
            var e, t;
            return e = void 0 === this._width ? 0 : (this._target[0] - this._current[0]) / this._width, this._delta[0] = e, this._current[0] = this._target[0], t = void 0 === this._height ? 0 : (this._target[1] - this._current[1]) / this._height, this._delta[1] = t, this._current[1] = this._target[1], this._delta
        },
        set: function () {
            for (var e = 0, t = this._current.length; e < t; e++) this._current[e] = this._target[e] = arguments[e];
            this._reset = !1
        },
        isReset: function () {
            return this._reset
        },
        getCurrent: function () {
            return this._current
        },
        setTarget: function () {
            for (var e = 0, t = this._target.length; e < t; e++) this._reset ? this._target[e] = this._current[e] = arguments[e] : this._target[e] = arguments[e];
            this._reset = !1
        },
        addTarget: function () {
            for (var e = 0; e < arguments.length; e++) this._target[e] += arguments[e]
        },
        getTarget: function () {
            return this._target
        },
        getDelta: function () {
            return this._delta
        }
    }, m.AvailableControllerList = ["StandardMouseKeyboard", "Hammer"], m.ControllerList = ["StandardMouseKeyboard", "Hammer"], n.a.createPrototypeObject(m, n.a.objectInherit(r.a.prototype, {
        init: function () {
            this._distance = 25, this._target = l.f.create(), this._upz = l.f.fromValues(0, 0, 1), this._right = l.f.fromValues(1, 0, 0), l.f.init(this._target);
            var e = l.c.fromRotation(l.c.create(), -Math.PI, this._upz),
                t = l.c.fromRotation(l.c.create(), Math.PI / 10, this._right);
            this._rotation = l.c.create(), l.c.mul(this._rotation, e, t), this._time = 0, this._rotate = new m.Interpolator, this._pan = new m.Interpolator, this._zoom = new d.a(1), this._panFactor = 1.5, this._rotateFactor = 1, this._zoomFactor = 1, this._inverseMatrix = l.c.create(), this._homeEye = void 0, this._homeCenter = void 0, this._homeUp = l.f.fromValues(0, 0, 1), this._orientation = l.d.create(), this._pivotPoint = l.f.create(), this._eye = void 0, this._zoomDir = l.f.create();
            var i = this;
            m.ControllerList.forEach(function (e) {
                void 0 !== m[e] && (i._controllerList[e] ? i._controllerList[e].init() : i._controllerList[e] = new m[e](i))
            })
        },
        setViewer: function (e) {
            this._viewer = e
        },
        reset: function () {
            this.init()
        },
        setEnable: function (e) {
            this.getInputManager().setEnable(p.a.CAD_MANIPULATOR, e)
        },
        setNode: function (e) {
            this._node = e
        },
        setPivotPoint: function (e) {
            l.f.copy(this._pivotPoint, e)
        },
        setTarget: function () {
            var e = l.f.create();
            return function (t) {
                l.f.copy(this._target, t), this.getEyePosition(e), this._distance = l.f.distance(t, e)
            }
        }(),
        setEyePosition: function (e) {
            l.f.copy(this._eye, e), this._distance = l.f.distance(this._target, e)
        },
        setHomePosition: function (e, t, i) {
            this._homeEye = e, this._homeCenter = t, this._homeUp = i
        },
        computeHomePosition: function () {
            var e = l.f.create(),
                t = l.f.create(),
                i = l.f.create(),
                n = l.c.create();
            return function (r) {
                var a = this.getHomeBoundingSphere(r);
                if (a) {
                    this.setDistance(this.getHomeDistance(a)), this.setTarget(a.center()), this.setPivotPoint(a.center()), void 0 === this._homeEye && (this._homeEye = l.f.create(), this.getEyePosition(this._homeEye)), void 0 === this._homeCenter && (this._homeCenter = l.f.create(), l.f.copy(this._homeCenter, a.center())), void 0 === this._eye && (this._eye = l.f.create()), l.f.copy(this._eye, this._homeEye), l.f.copy(this._target, this._homeCenter), l.f.copy(this._upz, this._homeUp), l.c.copy(n, this._rotation);
                    var o = this._target,
                        s = this._eye;
                    l.f.sub(e, o, s), l.f.normalize(e, e), l.f.cross(t, e, this._upz), l.f.normalize(t, t), l.f.cross(i, t, e), l.f.normalize(i, i), n[0] = t[0], n[1] = i[0], n[2] = -e[0], n[3] = 0, n[4] = t[1], n[5] = i[1], n[6] = -e[1], n[7] = 0, n[8] = t[2], n[9] = i[2], n[10] = -e[2], n[11] = 0, n[12] = 0, n[13] = 0, n[14] = 0, n[15] = 1, l.c.getRotation(this._orientation, n), l.d.invert(this._orientation, this._orientation)
                }
            }
        }(),
        setZoomFactor: function (e) {
            this._zoomFactor = e
        },
        setRotateFactor: function (e) {
            this._rotateFactor = e
        },
        setPanFactor: function (e) {
            this._panFactor = e
        },
        setDistance: function (e) {
            this._distance = e
        },
        setUsePolytopeIntersector: function (e) {
            this._usePolytopeIntersector = e
        },
        getUsePolytopeIntersector: function () {
            return this._usePolytopeIntersector
        },
        getDistance: function () {
            return this._distance
        },
        zoom: function (e) {
            this._distance = e
        },
        getRotateInterpolator: function () {
            return this._rotate
        },
        getPanInterpolator: function () {
            return this._pan
        },
        getZoomInterpolator: function () {
            return this._zoom
        },
        getIntersectionVisitor: function () {
            return this._intersectionVisitor
        },
        getLineSegmentIntersector: function () {
            return this._lineSegmentIntersector
        },
        getOrCreatePolytopeIntersector: function () {
            return void 0 === this._polytopeIntersector && (this._polytopeIntersector = new s.a, this._polytopeIntersector.setIntersectionLimit(f.a.LIMIT_ONE_PER_DRAWABLE), this._polytopeIntersector.setPrimitiveMask(f.a.POINT_PRIMITIVES | f.a.LINE_PRIMITIVES)), this._polytopeIntersector
        },
        getTarget: function (e) {
            return l.f.copy(e, this._target), e
        },
        getEyePosition: function (e) {
            void 0 === this._eye ? this.computeEyePosition(this._target, this._distance, e) : l.f.copy(e, this._eye)
        },
        computeEyePosition: function () {
            var e = l.f.create(),
                t = l.c.create();
            return function (i, n, r) {
                l.c.invert(t, this._rotation), e[1] = n, l.f.transformMat4(r, e, t), l.f.add(r, i, r)
            }
        }(),
        computePan: function () {
            var e = l.f.create(),
                t = l.f.create(),
                i = l.f.create();
            return function (n, r, a) {
                var o = l.f.length(l.f.sub(i, this._eye, this._pivotPoint)) / this._panFactor;
                o < 10 && (o = 10), e[0] = n * o / 2, e[1] = r * o / 2, e[2] = 0, l.f.transformMat4(t, e, a), l.f.add(this._eye, this._eye, t)
            }
        }(),
        computeZoom: function () {
            var e = l.f.create(),
                t = l.f.create();
            return function (i) {
                var n = i * this._zoomFactor;
                l.f.sub(e, this._pivotPoint, this._eye), l.f.add(this._eye, this._eye, l.f.scale(t, e, n))
            }
        }(),
        computeRotation: function () {
            var e = l.f.create(),
                t = l.f.create(),
                i = l.f.create(),
                n = l.f.create(),
                r = l.d.create(),
                a = l.d.create(),
                o = l.d.create(),
                s = l.f.create(),
                u = l.f.create();
            return function (c, h) {
                l.f.transformQuat(t, this._right, this._orientation), l.f.normalize(e, t), l.f.sub(i, this._eye, this._pivotPoint);
                var d = l.f.dot(e, i);
                l.f.sub(n, i, l.f.scale(u, e, d));
                var f = l.f.fromValues(-n[0], -n[1], 0),
                    p = Math.atan2(-n[2], l.f.length(f));
                h = Math.max(-Math.PI / 2 + .01, Math.min(Math.PI / 2 - .01, p + h)) - p, l.d.setAxisAngle(r, t, h * this._rotateFactor), l.d.setAxisAngle(a, this._upz, c * this._rotateFactor), l.d.mul(o, a, r), l.f.transformQuat(s, i, o), l.f.add(this._eye, s, this._pivotPoint), l.d.mul(this._orientation, a, this._orientation), l.f.transformQuat(t, this._right, this._orientation), l.d.setAxisAngle(r, t, h * this._rotateFactor), l.d.mul(this._orientation, r, this._orientation)
            }
        }(),
        update: function () {
            var e = l.c.create(),
                t = l.c.create();
            return function (i) {
                var n = i.getFrameStamp().getDeltaTime(),
                    r = this._rotate.update();
                this.computeRotation(10 * -r[0], 10 * r[1]), l.c.fromQuat(e, this._orientation);
                var a = this._pan.update();
                this.computePan(10 * -a[0], 10 * -a[1], e), r = this._zoom.update(n), this.computeZoom(-r[0] / 10), l.c.fromTranslation(t, this._eye), l.c.mul(this._inverseMatrix, t, e), l.c.invert(this._inverseMatrix, this._inverseMatrix)
            }
        }(),
        getInverseMatrix: function () {
            return this._inverseMatrix
        },
        computeIntersections: function () {
            var e = [],
                t = l.f.create();
            return function (i, n) {
                var r = this._camera.getView(),
                    a = this._camera,
                    o = a.getViewport().width(),
                    s = a.getViewport().height();
                this._rotate.setWidth(o), this._rotate.setHeight(s), this._pan.setWidth(o), this._pan.setHeight(s);
                var c, h;
                if (0 != (this._primitiveMask & f.a.TRIANGLE_PRIMITIVES) && (e = r.computeIntersections(i, n), e.length > 0 && (c = e[0]._localIntersectionPoint, e[0]._nodePath.shift(), h = u.a.computeLocalToWorld(e[0]._nodePath), l.f.transformMat4(t, c, h), this.setPivotPoint(t))), 0 === e.length && this._usePolytopeIntersector) {
                    var d = this.getOrCreatePolytopeIntersector();
                    d.reset(), d.setPolytopeFromWindowCoordinates(i - 5, n - 5, i + 5, n + 5);
                    var p = this._intersectionVisitor;
                    p.setIntersector(d), r.getCamera().accept(p), e = d.getIntersections(), e.sort(function (e, t) {
                        return e._distance - t._distance
                    }), e.length > 0 && (c = e[0]._localIntersectionPoint, e[0]._nodePath.shift(), h = u.a.computeLocalToWorld(e[0]._nodePath), l.f.transformMat4(t, c, h), this.setPivotPoint(t))
                }
            }
        }(),
        getPositionRelativeToCanvas: function () {
            var e = l.e.create(),
                t = l.e.create();
            return function (i, n) {
                var r = this._camera._graphicContext.canvas;
                this.getOffsetRect(r, e);
                var a = r.width / r.clientWidth,
                    o = r.height / r.clientHeight;
                return t[0] = (i - e[1]) * a, t[1] = (r.clientHeight - (n - e[0])) * o, t
            }
        }(),
        getCanvasCenter: function () {
            var e = l.e.create(),
                t = l.e.create();
            return function () {
                var i = this._camera.getGraphicContext().canvas;
                this.getOffsetRect(i, e);
                var n = i.width / i.clientWidth,
                    r = i.height / i.clientHeight;
                return t[0] = i.clientWidth / 2 * n, t[1] = i.clientHeight / 2 * r, t
            }
        }(),
        getOffsetRect: function (e, t) {
            var i = e.getBoundingClientRect(),
                n = document.body,
                r = document.documentElement,
                a = window.pageYOffset || r.scrollTop || n.scrollTop,
                o = window.pageXOffset || r.scrollLeft || n.scrollLeft,
                s = r.clientTop || n.clientTop || 0,
                u = r.clientLeft || n.clientLeft || 0,
                l = i.top + a - s,
                c = i.left + o - u;
            return t[0] = Math.round(l), t[1] = Math.round(c), t
        }
    }), "osgGA", "CADManipulator"), m.StandardMouseKeyboard = c.a, m.Hammer = h.a, t.a = m
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(624),
        a = i(10),
        o = i(694),
        s = i(882),
        u = i(883),
        l = i(884),
        c = i(629),
        h = i(114),
        d = function (e) {
            r.a.call(this, e), this.init()
        };
    d.AvailableControllerList = ["StandardMouseKeyboard", "WebVR", "DeviceOrientation", "Hammer"], d.ControllerList = ["StandardMouseKeyboard", "WebVR", "DeviceOrientation", "Hammer"], n.a.createPrototypeObject(d, n.a.objectInherit(r.a.prototype, {
        computeHomePosition: function (e) {
            var t = this.getHomeBoundingSphere(e);
            if (t && t.valid()) {
                this._distance = this.getHomeDistance(t);
                var i = t.center();
                a.f.scale(this._eye, this._direction, -this._distance), a.f.add(this._eye, i, this._eye), this.setTarget(i)
            }
        },
        init: function () {
            this._direction = a.f.fromValues(0, 1, 0), this._eye = a.f.fromValues(0, 25, 10), this._up = a.f.fromValues(0, 0, 1), this._distance = 1, this._forward = new c.a(1), this._side = new c.a(1), this._lookPosition = new c.a(2), this._pan = new c.a(2), this._zoom = new c.a(1), this._stepFactor = 1, this._angleVertical = 0, this._angleHorizontal = 0, this._tmpGetTargetDir = a.f.create(), this._vrEnable = !1, this._vrRot = a.d.create(), this._vrPos = a.f.create(), this._vrTrans = a.f.create();
            var e = this;
            this._controllerList = {}, d.ControllerList.forEach(function (t) {
                void 0 !== d[t] && (e._controllerList[t] ? e._controllerList[t].init() : e._controllerList[t] = new d[t](e))
            })
        },
        setDelay: function (e) {
            this._forward.setDelay(e), this._side.setDelay(e), this._lookPosition.setDelay(e), this._pan.setDelay(e), this._zoom.setDelay(e)
        },
        getEyePosition: function (e) {
            return e[0] = this._eye[0], e[1] = this._eye[1], e[2] = this._eye[2], e
        },
        setEyePosition: function (e) {
            return this._eye[0] = e[0], this._eye[1] = e[1], this._eye[2] = e[2], this
        },
        getTarget: function (e) {
            var t = a.f.scale(this._tmpGetTargetDir, this._direction, this._distance);
            return a.f.add(e, this._eye, t), e
        },
        setEnable: function (e) {
            this.getInputManager().setEnable(h.a.FPS_MANIPULATOR, e)
        },
        setTarget: function (e) {
            var t = this._tmpGetTargetDir;
            a.f.sub(t, e, this._eye), t[2] = 0, a.f.normalize(t, t), this._angleHorizontal = Math.acos(t[1]), t[0] < 0 && (this._angleHorizontal = -this._angleHorizontal), a.f.sub(t, e, this._eye), a.f.normalize(t, t), this._angleVertical = -Math.asin(t[2]), a.f.copy(this._direction, t)
        },
        getLookPositionInterpolator: function () {
            return this._lookPosition
        },
        getSideInterpolator: function () {
            return this._side
        },
        getForwardInterpolator: function () {
            return this._forward
        },
        getPanInterpolator: function () {
            return this._pan
        },
        getZoomInterpolator: function () {
            return this._zoom
        },
        getRotateInterpolator: function () {
            return this._lookPosition
        },
        computeRotation: function () {
            var e = a.c.create(),
                t = a.c.create(),
                i = a.f.fromValues(1, 0, 0),
                n = a.f.fromValues(0, 1, 0),
                r = a.f.fromValues(0, 0, 1),
                o = .5 * Math.PI;
            return function (s, u) {
                this._angleVertical += .01 * u, this._angleHorizontal -= .01 * s, this._angleVertical > o ? this._angleVertical = o : this._angleVertical < -o && (this._angleVertical = -o), this._vrEnable ? (a.f.transformQuat(this._direction, n, this._vrRot), a.f.normalize(this._direction, this._direction), a.f.transformQuat(this._up, r, this._vrRot)) : (a.c.fromRotation(e, -this._angleVertical, i), a.c.fromRotation(t, -this._angleHorizontal, r), a.c.mul(t, t, e), a.f.transformMat4(this._direction, n, t), a.f.normalize(this._direction, this._direction), a.f.transformMat4(this._up, r, t))
            }
        }(),
        reset: function () {
            this.init()
        },
        setDistance: function (e) {
            this._distance = e
        },
        getDistance: function () {
            return this._distance
        },
        setStepFactor: function (e) {
            this._stepFactor = e
        },
        computePosition: function () {
            var e = a.e.create();
            return function (t) {
                this._forward.update(t), this._side.update(t);
                var i = this._distance < .001 ? .001 : this._distance,
                    n = this._camera.getProjectionMatrix(),
                    r = 1 === n[15] ? 1 : 2 / n[5];
                e[0] = this._forward.getCurrent()[0], e[1] = this._side.getCurrent()[0];
                var o = a.e.sqrLen(e);
                o > 1 && a.e.scale(e, e, 1 / Math.sqrt(o));
                var s = this._pan.update(t),
                    u = this._zoom.update(t),
                    l = this._stepFactor * i * r * t,
                    c = this._stepFactor * i * r * .005;
                this.moveForward(e[0] * l - u[0] * c * 20), this.strafe(e[1] * l - s[0] * c), this.strafeVertical(-s[1] * c), this._vrEnable && (a.f.add(this._eye, this._eye, this._vrTrans), a.f.init(this._vrTrans))
            }
        }(),
        update: function () {
            var e = a.f.create();
            return function (t) {
                var i = t.getFrameStamp().getDeltaTime(),
                    n = this._lookPosition.update(i);
                this.computeRotation(.5 * -n[0], .5 * -n[1]), this.computePosition(i), a.f.add(e, this._eye, this._direction), a.c.lookAt(this._inverseMatrix, this._eye, e, this._up), this._vrEnable = !1
            }
        }(),
        setPoseVR: function (e, t) {
            this._vrEnable = !0, a.d.copy(this._vrRot, e), a.f.sub(this._vrTrans, t, this._vrPos), a.f.copy(this._vrPos, t)
        },
        moveForward: function () {
            var e = a.f.create();
            return function (t) {
                a.f.normalize(e, this._direction), a.f.scale(e, e, t), a.f.add(this._eye, this._eye, e)
            }
        }(),
        strafe: function () {
            var e = a.f.create();
            return function (t) {
                a.f.cross(e, this._direction, this._up), a.f.normalize(e, e), a.f.scale(e, e, t), a.f.add(this._eye, this._eye, e)
            }
        }(),
        strafeVertical: function () {
            var e = a.f.create();
            return function (t) {
                a.f.normalize(e, this._up), a.f.scale(e, e, t), a.f.add(this._eye, this._eye, e)
            }
        }()
    }), "osgGA", "FirstPersonManipulator"), d.DeviceOrientation = o.a, d.Hammer = s.a, d.WebVR = u.a, d.StandardMouseKeyboard = l.a, t.a = d
}, function (e, t, i) {
    "use strict";
    var n = i(36),
        r = function (e) {
            this._manipulatorList = [], this._currentManipulator = void 0, this._inputManager = e
        };
    r.prototype = {
        getCamera: function () {
            return this.getCurrentManipulator().getCamera()
        },
        setCamera: function (e) {
            for (var t = this.getManipulatorList(), i = 0, n = t.length; i < n; ++i) t[i].setCamera(e)
        },
        update: function (e) {
            var t = this.getCurrentManipulator();
            if (void 0 !== t) return t.update(e)
        },
        getInputManager: function () {
            return this._inputManager
        },
        setEnable: function (e) {
            this.getCurrentManipulator().setEnable(e)
        },
        getNode: function () {
            return this.getCurrentManipulator()._node
        },
        setNode: function (e) {
            for (var t = this.getManipulatorList(), i = 0, n = t.length; i < n; ++i) t[i].setNode(e)
        },
        getControllerList: function () {
            return this.getCurrentManipulator().getControllerList()
        },
        getNumManipulator: function () {
            return this._manipulatorList.length
        },
        addManipulator: function (e) {
            this._manipulatorList.push(e), void 0 === this._currentManipulator && this.setManipulatorIndex(0)
        },
        getManipulatorList: function () {
            return this._manipulatorList
        },
        setManipulatorIndex: function (e) {
            this._currentManipulator = e
        },
        getCurrentManipulatorIndex: function () {
            return this._currentManipulator
        },
        getCurrentManipulator: function () {
            return this._manipulatorList[this._currentManipulator]
        },
        reset: function () {
            this.getCurrentManipulator().reset()
        },
        computeHomePosition: function (e) {
            var t = this.getCurrentManipulator();
            void 0 !== t && t.computeHomePosition(e)
        },
        getInverseMatrix: function () {
            var e = this.getCurrentManipulator();
            if (void 0 !== e) return e.getInverseMatrix()
        },
        getHomeBound: function (e) {
            return n.a.warn("Please use getHomeBoundingSphere instead"), this.getHomeBoundingSphere(e)
        },
        getHomeBoundingSphere: function (e) {
            return this.getCurrentManipulator().getHomeBoundingSphere(e)
        },
        getHomeDistance: function (e) {
            return this.getCurrentManipulator().getHomeDistance(e)
        }
    }, t.a = r
}, function (e, t, i) {
    "use strict";
    var n = i(1105),
        r = i(889),
        a = i(629),
        o = i(1106),
        s = i(1107),
        u = i(695),
        l = i(627),
        c = i(625),
        h = i(579),
        d = i(580),
        f = i(876),
        p = i(12),
        m = i(1110),
        g = i(894),
        v = i(877),
        _ = i(878),
        b = i(1111),
        S = i(1113),
        x = i(1114),
        y = i(1115),
        C = i(626),
        T = {};
    T.ComposerPostProcess = n.a, p.a.objectMix(T, r.a), T.DelayInterpolator = a.a, T.DisplayNormalVisitor = o.a, T.DisplayGeometryVisitor = s.a, T.DisplayGraph = u.a, T.IntersectFunctor = l.a, T.Intersector = c.a, T.IntersectionVisitor = h.a, T.LineSegmentIntersector = d.a, T.LineSegmentIntersectFunctor = f.a, T.NodeGizmo = m.a, T.GizmoGeometry = g.a, T.WebVRCustom = x.a, T.PolytopeIntersector = v.a, T.PolytopeIntersectFunctor = _.a, T.SphereIntersector = b.a, T.TangentSpaceGenerator = S.a, T.WebVR = y.a, T.NO_LIMIT = C.a.NO_LIMIT, T.LIMIT_ONE_PER_DRAWABLE = C.a.LIMIT_ONE_PER_DRAWABLE, T.LIMIT_ONE = C.a.LIMIT_ONE, T.POINT_PRIMITIVES = C.a.POINT_PRIMITIVES, T.LINE_PRIMITIVES = C.a.LINE_PRIMITIVES, T.TRIANGLE_PRIMITIVES = C.a.TRIANGLE_PRIMITIVES, T.ALL_PRIMITIVES = C.a.ALL_PRIMITIVES, t.a = T
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(137),
        a = i(449),
        o = i(365),
        s = i(118),
        u = i(108),
        l = i(288),
        c = i(197),
        h = i(363),
        d = i(421),
        f = i(292),
        p = i(320),
        m = i(407),
        g = i(177),
        v = i(687),
        _ = function () {
            r.a.call(this), this._feedbackSwapped = !1, this._syncFeedbackUniforms = !1, this._syncOnNextFrame = !1, this._lastXratio = 1, this._lastYratio = 1, this._xViewportRatio = 1, this._yViewportRatio = 1, this._xTextureRatio = 1, this._yTextureRatio = 1, this._finalPassUpScaleToScreen = !0, this._methodWrapUV = 0, this._thresholdWrapUV = 1, this._texInfos = void 0, this._screenWidth = this._screenHeight = 0, this._feedbackData = {}, this._cameras = [], this._stateSets = [], this._textureUniforms = [], this._programs = {}, this._externalTextures = {}, this._internalPasses = [], this._textures = {}, this._userTextures = {}, this._currentPoolIndex = 0, this._texturePool = {}, this._firstTexture = "", this._offScreen = !1;
            var e = this.getOrCreateStateSet();
            e.setAttributeAndModes(new o.a(o.a.DISABLE)), e.setAttributeAndModes(new a.a(a.a.BACK)), this.setCullCallback(this)
        };
    _.VertexShader = ["attribute vec3 Vertex;", "void main(void) {", "    gl_Position = vec4(Vertex * 2.0 - 1.0, 1.0);", "}", "", "#define SHADER_NAME %name%", ""].join("\n"), _.FragmentShader = ["uniform float uRGBMRange;", "vec2 gTexCoord;", "%uniforms%", "", '#pragma include "utils/functions.glsl"', "", "%header%", "", "%texturesColorSpace%", "", "%functionBodies%", "", "void main(void) {", "    gTexCoord = gl_FragCoord.xy / uTextureOutputSize.xy;", "    vec4 color = %firstFunc%(%firstArg%);", "    %optionalFuncs%", "    %colorSpaces%", "    gl_FragColor = color;", "}", "", "#define SHADER_NAME %name%", ""].join("\n"), n.a.createPrototypeObject(_, n.a.objectInherit(r.a.prototype, {
        setOffscreen: function (e) {
            this._offScreen = e
        },
        clear: function () {
            this._textures = {}, this._internalPasses.length = 0, this._firstTexture = "";
            for (var e in this._texturePool) this._texturePool[e].usage = -1;
            this._feedbackData = {}, this._cameras.length = 0, this._stateSets.length = 0, this._textureUniforms.length = 0, this.removeChildren()
        },
        clearShaderCache: function () {
            this._programs = {}
        },
        getGlobalXRatio: function () {
            return this._xViewportRatio * this._xTextureRatio
        },
        getGlobalYRatio: function () {
            return this._yViewportRatio * this._yTextureRatio
        },
        setFinalPassUpScaleToScreen: function (e) {
            this._finalPassUpScaleToScreen = e
        },
        _enforceFromInputParameter: function (e, t) {
            var i = t.name,
                n = this._textures[i],
                r = this._textures[i + "FeedbackTexture"],
                a = t[e];
            void 0 !== a && (void 0 !== n[e] && n[e] !== a && console.error("Mismatch on parameter " + e + " : " + i), n[e] = a, r && (r[e] = a))
        },
        _updatePassInfoFromInputs: function (e, t, i) {
            var n = this._textures[t],
                r = i.srgb;
            i.srgb = void 0;
            for (var a = 0; a < e.textures.length; a++) {
                var o = e.textures[a];
                this._renameTextureAlias(o, t, i.name);
                var s = o.name;
                if (!this._externalTextures[s]) {
                    this._usages[s] = (this._usages[s] || 0) + 1;
                    var u = o.srgb;
                    this._enforceFromInputParameter("filter", o), this._enforceFromInputParameter("rgbm", o), this._enforceFromInputParameter("srgb", o);
                    var l = this._textures[s];
                    if (!l) {
                        var c = s.substring(0, s.indexOf("FeedbackTexture"));
                        l = this._textures[c]
                    }
                    void 0 !== r && void 0 !== u && r !== u && (l.encodeSRGB = !0), this._setInferredParameter("rgbmInferred", "rgbm", n, l), this._setInferredParameter("srgbInferred", "srgb", n, l)
                }
            }
            void 0 === i.srgb && (i.srgb = void 0 === n.srgb ? n.srgbInferred : n.srgb)
        },
        _setInferredParameter: function (e, t, i, n) {
            void 0 === i[e] && (i[e] = void 0 === n[t] ? n[e] : n[t])
        },
        _createTextureOut: function (e, t, i) {
            var n = {
                    srgb: e.out.srgb,
                    rgbm: e.out.rgbm,
                    filter: e.out.filter,
                    type: e.out.type
                },
                r = e.out.type !== s.default.UNSIGNED_BYTE;
            return void 0 === n.rgbm && (i || r) && (n.rgbm = !1), void 0 === n.srgb && (i ? n.srgb = !0 : (n.rgbm || r) && (n.srgb = !1)), n
        },
        _processUserPasses: function (e) {
            e = this._internalPasses.concat(e);
            for (var t = this._preprocessUserPasses(e), i = t.length, n = [], r = {
                    name: this._firstTexture,
                    srgb: void 0
                }, a = {}, o = 0; o < i; o++) {
                var s = t[o],
                    u = o === i - 1;
                if (u || !this._collapsePasses(s, t[o + 1])) {
                    var l = s.out.name,
                        c = "%next" === l;
                    c && (l = s.funcs.join("_"), a[l] ? l += a[l]++ : a[l] = 1);
                    var h = this._createTextureOut(s, l, u);
                    this._textures[l] = h, this._updatePassInfoFromInputs(s, l, r), s.feedbackLoop && (this._textures[l + "FeedbackTexture"] = {
                        srgb: h.srgb,
                        rgbm: h.rgbm,
                        srgbInferred: h.srgbInferred,
                        rgbmInferred: h.rgbmInferred,
                        filter: h.filter
                    }), c && (r.name = l, s.out.name = l), n.push(s)
                } else t.splice(o + 1, 1), i--, o--
            }
            return n
        },
        _hasFreeTexture: function (e, t, i) {
            if (e === i.name && this._texturePool[e]) return e;
            if (!i.immuable)
                for (var n in this._texturePool) {
                    var r = this._texturePool[n];
                    if (r.reusable && (!(r.usage > 0) && r.texture.divisor === i.divisor && r.texture.getInternalFormatType() === i.type)) {
                        if (-1 === r.usage) return r.texture.getMinFilter() !== t && (r.texture.setMinFilter(t), r.texture.setMagFilter(t)), n;
                        if (r.texture.getMinFilter() === t) return n
                    }
                }
        },
        _setOrCreateTextureKey: function (e, t, i) {
            var n = "linear" === this._textures[t].filter,
                r = n ? s.default.LINEAR : s.default.NEAREST,
                a = this._hasFreeTexture(t, r, i);
            if (a) return this._texturePool[a].usage = e, void(this._textures[t].key = a);
            a = i.immuable ? t : "key" + this._currentPoolIndex++, this._texturePool[a] = {
                usage: e,
                texture: this._createTexture(t, i.divisor, i.type, r),
                immuable: i.immuable,
                reusable: i.reusable
            }, -1 === i.divisor && (this._texturePool[a].width = i.width, this._texturePool[a].height = i.height), this._textures[t].key = a
        },
        _addStateSet: function (e, t) {
            for (var i = 0; i < e.funcs.length; i++) {
                var n = e.funcs[i].name;
                this._stateSets[n] = t
            }
        },
        _addTextureToStateSet: function (e, t, i, n, r) {
            t.addUniform(u.a.createInt1(i, e.uniformName));
            var a, o = e.name;
            if (void 0 !== this._textures[o]) {
                var s = this._textures[o].key;
                a = this._texturePool[s].texture
            } else a = this._externalTextures[o];
            if (this._addTextureUniforms(e.uniformName, a, t, n, r), "TexturePrevious" === e.uniformName) return i;
            t.setTextureAttributeAndModes(i, a)
        },
        _getUniformName: function (e) {
            return "u" + e[0].toUpperCase() + e.slice(1)
        },
        _addTextureUniforms: function (e, t, i, n, r) {
            var a = this._getUniformName(e),
                o = u.a.createFloat2(a + "Size"),
                s = u.a.createFloat2(a + "Ratio");
            i.addUniform(o), i.addUniform(s), n.push(o), n.push(s), this._textureUniforms.push({
                size: o,
                ratio: s,
                texture: t,
                isFeedback: !!r
            })
        },
        _checkInferredParameters: function () {
            for (var e in this._textures) {
                var t = this._textures[e];
                void 0 === t.srgb && (t.srgb = t.srgbInferred), void 0 === t.rgbm && (t.rgbm = t.rgbmInferred)
            }
        },
        _buildPass: function (e, t) {
            var i = t[e],
                n = i.out.name;
            this._setOrCreateTextureKey(this._usages[n], n, i.out);
            var r = i.out.name + "FeedbackTexture";
            if (i.feedbackLoop && this._setOrCreateTextureKey(this._usages[r], r, i.out), !i.funcs.length) {
                var a = this._textures[n].key;
                return void(this._userTextures[n] = this._texturePool[a].texture)
            }
            var o = new l.a;
            this._addStateSet(i, o);
            var s;
            for (s = 0; s < i.uniforms.length; s++) o.addUniform(i.uniforms[s]);
            var u = [],
                c = void 0;
            for (s = 0; s < i.textures.length; s++) {
                var h = i.textures[s],
                    d = h.name === r;
                if (!d && !this._externalTextures[h.name]) {
                    var f = this._textures[h.name].key;
                    this._texturePool[f].usage--
                }
                var p = this._addTextureToStateSet(h, o, s, u, d);
                if (void 0 !== p && (c = p), void 0 !== this._feedbackData[h.name]) {
                    var m = {
                        stateSet: o,
                        textureUnit: s
                    };
                    this._feedbackData[h.name].nextPasses.push(m)
                }
            }
            var g = void 0;
            if (e !== t.length - 1 || this._offScreen) {
                var v = this._textures[n].key;
                g = this._texturePool[v].texture
            }
            this._addTextureUniforms("TextureOutput", g, o, u), o.setAttributeAndModes(this._createProgram(i, u)), i.feedbackLoop ? this._feedbackData[n] = this._createFeedbackLoopCameras(n, o, g, c) : this.addChild(this._createCamera(n, o, g))
        },
        _buildGraphFromPasses: function (e) {
            for (var t = 0; t < e.length; t++) this._buildPass(t, e)
        },
        build: function (e) {
            this._usages = {};
            var t = this._processUserPasses(e);
            this._checkInferredParameters(t), this._buildGraphFromPasses(t), this.resize(this._screenWidth, this._screenHeight)
        },
        _createFeedbackLoopCameras: function (e, t, i, n) {
            var a = this._textures[e + "FeedbackTexture"].key,
                o = this._texturePool[a].texture,
                s = new r.a;
            s.setStateSet(t);
            var u = this._createFeedbackLoopCamera(e, i, o, n),
                l = this._createFeedbackLoopCamera(e + "FeedbackTexture", o, i, n);
            l.setNodeMask(0), s.addChild(u), s.addChild(l), this.addChild(s);
            var c = {};
            return c.camera1 = u, c.camera2 = l, c.texture1 = i, c.texture2 = o, c.nextPasses = [], c
        },
        _createFeedbackLoopCamera: function (e, t, i, n) {
            var r = new l.a;
            r.setTextureAttributeAndModes(n, i);
            var a = this._createCamera(e, r, t);
            return a.setStateSet(r), a
        },
        _createCamera: function (e, t, i) {
            var n = new c.a;
            n.setName(e), n.setStateSet(t), n.setClearMask(0), n.setReferenceFrame(g.a.ABSOLUTE_RF), i && (n.setRenderOrder(c.a.PRE_RENDER, 0), n.attachTexture(h.a.COLOR_ATTACHMENT0, i)), n.setViewport(new d.a);
            var r = m.a.createTexturedFullScreenFakeQuadGeometry();
            return r.setName("composer layer"), n.addChild(r), this._cameras.push(n), n
        },
        swapFeedbackLoopTextures: function (e) {
            for (var t in this._feedbackData) {
                var i = this._feedbackData[t];
                i.camera1.setNodeMask(e ? -1 : 0), i.camera2.setNodeMask(e ? 0 : -1);
                for (var n = e ? i.texture1 : i.texture2, r = 0; r < i.nextPasses.length; r++) {
                    var a = i.nextPasses[r];
                    a.stateSet.setTextureAttributeAndModes(a.textureUnit, n)
                }
            }
            this._feedbackSwapped = !0
        },
        _createFuncFromUserData: function (e) {
            var t = "string" == typeof e ? {
                name: e,
                file: e + ".glsl"
            } : e;
            return t.toString = function () {
                return this.name
            }, t
        },
        _createTextureInfoFromUserData: function (e) {
            var t = {
                name: "",
                uniformName: "",
                rgbm: void 0,
                srgb: void 0,
                filter: void 0
            };
            return "string" == typeof e ? t.name = e : (t.name = e.name, e.uniformName && (t.uniformName = e.uniformName), void 0 !== e.rgbm && (t.rgbm = e.rgbm), void 0 !== e.srgb && (t.srgb = e.srgb), void 0 !== e.filter && (t.filter = e.filter)), t
        },
        _preprocessUserPasses: function (e) {
            for (var t = [], i = 0; i < e.length; i++) {
                var n = e[i],
                    r = {};
                if (r.funcs = [], n.func && r.funcs.push(this._createFuncFromUserData(n.func)), r.textures = [], r.feedbackLoop = !1, void 0 !== n.textures) {
                    Array.isArray(n.textures) || (n.textures = [n.textures]);
                    for (var a = 0; a < n.textures.length; a++) {
                        var o = this._createTextureInfoFromUserData(n.textures[a]);
                        "%previous" === o.name && (r.feedbackLoop = !0), r.textures.push(o)
                    }
                }
                "string" == typeof n.header ? r.header = [n.header] : r.header = n.header || [], void 0 !== n.uniforms ? Array.isArray(n.uniforms) ? r.uniforms = n.uniforms : r.uniforms = [n.uniforms] : r.uniforms = [], r.out = n.out, r.out.divisor = r.out.divisor || 1, r.out.type = r.out.type || s.default.UNSIGNED_BYTE, void 0 === r.out.immuable && (r.out.immuable = !1), void 0 === r.out.reusable && (r.out.reusable = !0), (r.feedbackLoop || -1 === r.out.divisor) && (r.out.immuable = !0, r.out.reusable = !1), r.collapsible = n.collapsible || !1, t.push(r)
            }
            return t
        },
        _canBeCollapsed: function (e, t) {
            return e.funcs.length && t.collapsible && "%next" === e.out.name && e.out.divisor === t.out.divisor && e.out.width === e.out.width && e.out.height === e.out.height
        },
        _collapsePasses: function (e, t) {
            return !!this._canBeCollapsed(e, t) && (e.funcs = e.funcs.concat(t.funcs), e.header = e.header.concat(t.header), e.textures = this._mergeWithoutDuplicates(e.textures, t.textures, function (e, t) {
                return e.name === t.name
            }), e.uniforms = this._mergeWithoutDuplicates(e.uniforms, t.uniforms, function (e, t) {
                return e.getName() === t.getName()
            }), !0)
        },
        _renameTextureAlias: function (e, t, i) {
            "%last" === e.name ? (e.name = i, e.uniformName = e.uniformName || "TextureInput") : "%previous" === e.name ? (e.name = t + "FeedbackTexture", e.uniformName = e.uniformName || "TexturePrevious") : e.uniformName || (e.uniformName = e.name)
        },
        _createTexture: function (e, t, i, n) {
            var r = new s.default;
            return r.setTextureSize(1, 1), r.setInternalFormatType(i), r.setInternalFormat(s.default.RGBA), r.setMinFilter(n), r.setMagFilter(n), r.divisor = t, r.setName(e), r
        },
        _computeHashFromPass: function (e) {
            for (var t = "", i = 0; i < e.funcs.length; i++) t += e.funcs[i].name + "_" + e.funcs[i].file + "_";
            for (e.header && (t += e.header.join("_")), i = 0; i < e.textures.length; i++) t += !!e.textures[i].rgbm + "_" + !!e.textures[i].srgb + "_";
            return t += !!e.out.encodeSRGB + "_", t += !!this._textures[e.out.name].rgbm + "_"
        },
        _writeDeclarations: function (e, t, i, n) {
            var r, a = "uniform sampler2D TextureInput;\n";
            for (r = 0; r < i.length; r++) {
                a += "uniform sampler2D " + (i[r].uniformName || i[r].name) + ";\n"
            }
            for (r = 0; r < t.length; r++) {
                var o = t[r];
                a += "uniform " + o.getType() + " " + o.getName() + ";\n"
            }
            return e = e.replace("%uniforms%", a), n && (e = e.replace("%header%", n.join("\n"))), e
        },
        setMethodWrapUV: function (e, t) {
            void 0 !== e && (this._methodWrapUV = e), void 0 !== t && (this._thresholdWrapUV = t), this._texInfos = void 0
        },
        _getInfos: function () {
            if (this._texInfos) return this._texInfos;
            var e = "texture2D(%tex, (uv) * %ratio)",
                t = "texture2D(%tex, (floor((uv) * %size) + 0.5) * %ratio / %size, -99999.0)",
                i = "texture2D(%tex, (uv) * %ratio)",
                n = this._thresholdWrapUV.toExponential();
            if (1 === this._methodWrapUV) {
                var r = "min(uv, 1.0 - " + n + " / %size.xy)";
                e = e.replace(/(uv)/g, r), t = t.replace(/(uv)/g, r), i = i.replace(/(uv)/g, r)
            } else if (2 === this._methodWrapUV) {
                var a = "step((uv).x, 1.0 - " + n + " / %size.x) *";
                a += "step((uv).y, 1.0 - " + n + " / %size.y) * ", e = a + e, t = a + t, i = a + i
            }
            return this._texInfos = {
                TEXTURE_2D: {
                    signature: "TEXTURE_2D_%tex(uv)",
                    body: e
                },
                TEXTURE_2D_NEAREST: {
                    signature: "TEXTURE_2D_NEAREST_%tex(uv)",
                    body: t
                },
                TEXTURE_2D_BIAS: {
                    signature: "TEXTURE_2D_BIAS_%tex(uv, bias)",
                    body: i
                }
            }, this._texInfos
        },
        _extractTextures: function (e) {
            var t = this._getInfos(),
                i = e.match(/TEXTURE_2D(?:_BIAS|_NEAREST)?_\w+\(/g);
            if (!i) return {};
            for (var n = {}, r = 0; r < i.length; r++) {
                var a = i[r].match(/((TEXTURE_2D(?:_BIAS|_NEAREST)?)_(\w+))\(/),
                    o = t[a[2]];
                n[a[1]] = {
                    name: a[3],
                    signature: o.signature,
                    body: o.body
                }
            }
            return n
        },
        _writeFunctionBodies: function (e, t, i, n) {
            for (var r = [], a = "", o = {}, s = 0; s < t.length; s++) {
                a += v.a.getShaderTextPure(t[s].file) + "\n"
            }
            var u = ["utils/functions.glsl"];
            a = v.a.processIncludes(a, u);
            var l = this._extractTextures(a);
            if (n) {
                var c = this._getInfos().TEXTURE_2D;
                l.TEXTURE_2D_TextureInput = {
                    name: "TextureInput",
                    signature: c.signature,
                    body: c.body
                }
            }
            for (var h in l)
                if (!o[h]) {
                    o[h] = !0;
                    for (var d = l[h], f = d.name, p = !1, m = 0; m < i.length; m++) {
                        var g = i[m];
                        if (g.uniformName === f) {
                            var _ = this._textures[g.name];
                            if (_ && _.rgbm) {
                                p = _.rgbm;
                                break
                            }
                        }
                    }
                    var b = d.body;
                    p && (b = "vec4(decodeRGBM(" + b + ", uRGBMRange), 1.0)"), b = "#define " + d.signature + " (" + b + ")";
                    var S = this._getUniformName(f);
                    b = b.replace(/%size/g, S + "Size"), b = b.replace(/%ratio/g, S + "Ratio"), b = b.replace(/%tex/g, f), r.push(b)
                } return e = e.replace("%texturesColorSpace%", r.join("\n")), e.replace("%functionBodies%", a.replace(/\\\n/g, ""))
        },
        _writeMainFunction: function (e, t, i, n) {
            e = e.replace("%firstFunc%", t[0].name);
            var r = i ? "TEXTURE_2D_TextureInput(gTexCoord)" : "";
            e = e.replace("%firstArg%", r);
            for (var a = "", o = 1; o < t.length; o++) a += "\tcolor = " + t[o].name + "(color);\n";
            if (e = e.replace("%optionalFuncs%", a), !0 === this._textures[n].encodeSRGB) {
                a = "\tcolor.rgb = " + (this._textures[n].srgb ? "linearTosRGB" : "sRGBToLinear") + "(color.rgb);\n"
            } else a = "";
            return this._textures[n].rgbm ? a += "\tcolor = encodeRGBM(color.rgb, uRGBMRange);" : a += "", e.replace("%colorSpaces%", a)
        },
        _removeDuplicatedUniforms: function (e) {
            for (var t = e.split("\n"), i = {}, n = t.length, r = 0; r < n; r++) {
                var a = t[r].match(/uniform(?:\s+){1,}\w+(?:\s+){1,}(\w+)/);
                if (null !== a) {
                    var o = a[1];
                    void 0 !== i[o] ? (t.splice(r, 1), n--, r--) : i[o] = !0
                }
            }
            return t.join("\n")
        },
        _createProgram: function (e, t) {
            var i = this._computeHashFromPass(e);
            if (void 0 !== this._programs[i]) return this._programs[i];
            var n = this._writeDeclarations(_.FragmentShader, t, e.textures, e.header);
            n = this._writeFunctionBodies(n, e.funcs, e.textures, e.collapsible), n = this._writeMainFunction(n, e.funcs, e.collapsible, e.out.name), n = n.replace("%name%", e.out.name), n = this._removeDuplicatedUniforms(n);
            var r = _.VertexShader.replace("%name%", e.out.name),
                a = new f.a(new p.a(p.a.VERTEX_SHADER, r), new p.a(p.a.FRAGMENT_SHADER, n));
            return this._programs[i] = a, a
        },
        resize: function (e, t) {
            this.setScreenSize(e, t);
            for (var i in this._texturePool) {
                var n = this._texturePool[i].texture;
                void 0 === this._texturePool[i].width ? n.setTextureSize(this._getTextureSize(e, n.divisor), this._getTextureSize(t, n.divisor)) : n.setTextureSize(this._texturePool[i].width, this._texturePool[i].height)
            }
            this.resizeRatio()
        },
        resizeRatio: function (e, t, i, n) {
            void 0 !== e && (this._xViewportRatio = e), void 0 !== t && (this._yViewportRatio = t), void 0 !== i && (this._xTextureRatio = i), void 0 !== n && (this._yTextureRatio = n), this._resizeViewports(), this._resizeTextureUniforms()
        },
        _resizeViewports: function () {
            for (var e = this.getGlobalXRatio(), t = this.getGlobalYRatio(), i = this._cameras, n = 0; n < i.length; ++n) {
                var r = i[n],
                    a = r.isRenderToTextureCamera(),
                    o = 1;
                if (a) {
                    o = r.getAttachments()[h.a.COLOR_ATTACHMENT0].texture.divisor
                }
                if (n === i.length - 1 && this._finalPassUpScaleToScreen && (e = this._xViewportRatio, t = this._yViewportRatio), -1 !== o) {
                    var s = this._getTextureSize(this._screenWidth, o / e),
                        u = this._getTextureSize(this._screenHeight, o / t);
                    r.getViewport().setViewport(0, 0, s, u)
                }
            }
        },
        _resizeTextureUniforms: function () {
            var e = this.getGlobalXRatio(),
                t = this.getGlobalYRatio(),
                i = this._finalPassUpScaleToScreen ? this._xViewportRatio : e,
                n = this._finalPassUpScaleToScreen ? this._yViewportRatio : t;
            this._syncFeedbackUniforms = !0;
            for (var r = this._textureUniforms, a = 0; a < r.length; ++a) {
                var o = r[a],
                    s = o.size.getInternalArray(),
                    u = o.ratio.getInternalArray();
                if (!o.isFeedback || !s[0]) {
                    u[0] = e, u[1] = t;
                    var l = o.texture;
                    l ? !l.divisor || l.divisor < 0 ? (s[0] = l.getWidth(), s[1] = l.getHeight(), u[0] = u[1] = 1) : (s[0] = e * l.getWidth(), s[1] = t * l.getHeight()) : (s[0] = this._screenWidth * i, s[1] = this._screenHeight * n)
                }
            }
        },
        _resizeFeedbackTextureUniforms: function () {
            for (var e = this._lastXratio, t = this._lastYratio, i = this._textureUniforms, n = 0; n < i.length; ++n) {
                var r = i[n];
                if (r.isFeedback) {
                    var a = r.size.getInternalArray(),
                        o = r.ratio.getInternalArray(),
                        s = r.texture;
                    o[0] = e, o[1] = t, a[0] = e * s.getWidth(), a[1] = t * s.getHeight()
                }
            }
        },
        cull: function () {
            return this._syncOnNextFrame && (this._resizeFeedbackTextureUniforms(), this._syncOnNextFrame = !1), this._syncFeedbackUniforms && this._feedbackSwapped && (this._syncFeedbackUniforms = !1, this._syncOnNextFrame = !0, this._lastXratio = this.getGlobalXRatio(), this._lastYratio = this.getGlobalYRatio()), this._feedbackSwapped = !1, !0
        },
        _mergeWithoutDuplicates: function (e, t, i) {
            for (var n = 0; n < t.length; n++) {
                for (var r = t[n], a = !0, o = 0; o < e.length; o++)
                    if (i(e[o], r)) {
                        a = !1;
                        break
                    } a && e.push(r)
            }
            return e
        },
        _getTextureSize: function (e, t) {
            return Math.max(1, Math.round(e / t))
        },
        setScreenSize: function (e, t) {
            this._screenWidth = e, this._screenHeight = t
        },
        addInternalTexture: function (e) {
            this._internalPasses.push({
                out: {
                    name: e.name,
                    divisor: e.divisor,
                    type: e.type,
                    filter: e.filter,
                    srgb: e.srgb,
                    rgbm: e.rgbm,
                    immuable: e.immuable,
                    reusable: e.reusable
                }
            })
        },
        addExternalTexture: function (e, t) {
            this._externalTextures[e] = t
        },
        setInputTexture: function (e) {
            this._firstTexture = e
        },
        getCameras: function () {
            return this._cameras
        },
        getStateSetPass: function (e) {
            return this._stateSets[e]
        },
        getInternalTexture: function (e) {
            return this._userTextures[e]
        }
    }), "osgUtil", "ComposerPostProcess"), t.a = _
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(84),
        a = i(160),
        o = i(178),
        s = i(291),
        u = i(138),
        l = i(288),
        c = i(108),
        h = i(365),
        d = i(10),
        f = i(452),
        p = i(364),
        m = i(621),
        g = function () {
            r.a.call(this), this._unifScale = c.a.createFloat(1, "uScale");
            var e = this._normalStateSet = new l.a;
            e.addUniform(c.a.createFloat3(d.f.fromValues(1, 0, 0), "uColorDebug")), e.addUniform(this._unifScale), e.setAttributeAndModes(new h.a(h.a.NEVER)), e.setShaderGeneratorName("debugNormal");
            var t = this._tangentStateSet = new l.a;
            t.addUniform(c.a.createFloat3(d.f.fromValues(0, 1, 0), "uColorDebug")), t.addUniform(this._unifScale), t.setAttributeAndModes(new h.a(h.a.NEVER)), t.setShaderGeneratorName("debugTangent")
        };
    n.a.createPrototypeObject(g, n.a.objectInherit(r.a.prototype, {
        setScale: function (e) {
            this._unifScale.setFloat(e)
        },
        setTangentVisibility: function (e) {
            this._tangentStateSet.setAttributeAndModes(new h.a(e ? h.a.LESS : h.a.NEVER))
        },
        setNormalVisibility: function (e) {
            this._normalStateSet.setAttributeAndModes(new h.a(e ? h.a.LESS : h.a.NEVER))
        },
        apply: function (e) {
            if (!e._isVisitedNormalDebug) {
                if (e._isVisitedNormalDebug = !0, e instanceof a.a) return this._createDebugGeom(e, "Normal", this._normalStateSet), void this._createDebugGeom(e, "Tangent", this._tangentStateSet);
                this.traverse(e);
                for (var t = e.getUpdateCallbackList(), i = 0, n = t.length; i < n; ++i) t[i] instanceof m.a && t[i].init(e)
            }
        },
        _createDoubleOffsetArray: function (e) {
            for (var t = new Float32Array(2 * e), i = 0; i < e; ++i) t[2 * i] = 1;
            return new o.a(o.a.ARRAY_BUFFER, t, 1)
        },
        _createDoubledBufferArray: function (e) {
            e.getInitialBufferArray && (e = e.getInitialBufferArray());
            for (var t = e.getItemSize(), i = e.getElements(), n = i.length / t, r = i.constructor, a = new r(2 * i.length), s = 0; s < n; ++s)
                for (var u = s * t, l = 2 * u, c = 0; c < t; ++c) a[l + c] = a[l + c + t] = i[u + c];
            return new o.a(o.a.ARRAY_BUFFER, a, t)
        },
        _addMorphTargets: function (e, t, i) {
            var n = t.getMorphTargets();
            t.setName(e.getName());
            for (var r = e.getMorphTargets(), o = 0, s = r.length; o < s; ++o) {
                var u = r[o],
                    l = u.getVertexAttributeList(),
                    c = new a.a;
                c.setName(u.getName());
                var h = c.getVertexAttributeList();
                h.Vertex = this._createDoubledBufferArray(l.Vertex), l[i] && (h[i] = this._createDoubledBufferArray(l[i])), n.push(c)
            }
            return t.mergeChildrenVertexAttributeList(), t
        },
        _createDebugGeom: function (e, t, i) {
            var n = e.getAttributes(),
                r = n[t];
            if (r) {
                var o = n.Vertex;
                if (o) {
                    var l;
                    e instanceof p.a ? l = e : e.getSourceGeometry && e.getSourceGeometry() instanceof p.a && (l = e.getSourceGeometry());
                    var c = o.getElements().length / o.getItemSize(),
                        h = l ? new p.a : new a.a;
                    h.getAttributes().Vertex = this._createDoubledBufferArray(o), h.getAttributes().Offset = this._createDoubleOffsetArray(c), h.getAttributes()[t] = this._createDoubledBufferArray(r), h.getPrimitives().push(new s.a(u.a.LINES, 0, 2 * c)), l && this._addMorphTargets(l, h, t);
                    var d;
                    if (e instanceof f.a) {
                        var m = new f.a;
                        m.setSourceGeometry(h), m.getVertexAttributeList().Bones = this._createDoubledBufferArray(n.Bones), m.getVertexAttributeList().Weights = this._createDoubledBufferArray(n.Weights), m._rigTransformImplementation = e._rigTransformImplementation, m._stateSetAnimation = e._stateSetAnimation, m.mergeChildrenData(), d = m
                    } else d = h;
                    var g = e.getParents(),
                        v = g.length;
                    d._isVisitedNormalDebug = !0, d._isNormalDebug = !0, d.setStateSet(i);
                    for (var _ = 0; _ < v; ++_) g[_].addChild(d);
                    return d
                }
            }
        }
    }), "osgUtil", "DisplayNormalVisitor"), t.a = g
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(84),
        a = i(160),
        o = i(452),
        s = i(108),
        u = i(288),
        l = i(10),
        c = i(178),
        h = i(291),
        d = i(138),
        f = i(198),
        p = i(365),
        m = function () {
            r.a.call(this), this._debugColor = !0, this._debugSkinning = !1, this._stCenter = new u.a, this._stCenter.setShaderGeneratorName("debugGeometry")
        };
    n.a.createPrototypeObject(m, n.a.objectInherit(r.a.prototype, {
        setGeometryDebug: function (e) {
            this._stCenter.setAttributeAndModes(new p.a(p.a.ALWAYS)), this._debugColor = !0, this._debugSkinning = !1, this.apply(e)
        },
        setSkinningDebug: function (e) {
            this._stCenter.setAttributeAndModes(new p.a(p.a.NEVER)), this._debugColor = !1, this._debugSkinning = !0, this.apply(e)
        },
        disableDebug: function (e) {
            this._stCenter.setAttributeAndModes(new p.a(p.a.NEVER)), this._debugColor = !1, this._debugSkinning = !1, this.apply(e)
        },
        _debugCenterGeometry: function (e, t) {
            var i = e.getBound(),
                n = new Float32Array(18),
                r = .1 * i.radius();
            n[0] = r, n[3] = -r, n[7] = r, n[10] = -r, n[14] = r, n[17] = -r;
            var o = new a.a;
            o.getAttributes().Vertex = new c.a(c.a.ARRAY_BUFFER, n, 3);
            var u = new h.a(d.a.LINES, 0, 6);
            o.getPrimitives().push(u);
            var p = new f.a,
                m = i.center();
            p.getMatrix()[12] = m[0], p.getMatrix()[13] = m[1], p.getMatrix()[14] = m[2], p.addChild(o), this.nodePath[this.nodePath.length - 2].addChild(p), t = l.f.fromValues(.8 * t[0], .8 * t[1], .8 * t[2]), o.getOrCreateStateSet().addUniform(s.a.createFloat3(t, "uColorDebug")), p.setStateSet(this._stCenter), p._isCenterDebug = !0
        },
        _debugRigGeometry: function (e) {
            var t = e.getVertexAttributeList();
            if (!t.BonesColor) {
                for (var i = t.Bones.getElements(), n = t.Weights.getElements(), r = e._rigTransformImplementation._bones, a = i.length / 4, o = new Float32Array(3 * a), s = 0; s < a; ++s) {
                    var u = 4 * s,
                        l = r[i[u]].getOrCreateDebugColor(),
                        h = r[i[u + 1]].getOrCreateDebugColor(),
                        d = r[i[u + 2]].getOrCreateDebugColor(),
                        f = r[i[u + 3]].getOrCreateDebugColor(),
                        p = n[u],
                        m = n[u + 1],
                        g = n[u + 2],
                        v = n[u + 3],
                        _ = 3 * s;
                    o[_] = p * l[0] + m * h[0] + g * d[0] + v * f[0], o[_ + 1] = p * l[1] + m * h[1] + g * d[1] + v * f[1], o[_ + 2] = p * l[2] + m * h[2] + g * d[2] + v * f[2]
                }
                t.BonesColor = new c.a(c.a.ARRAY_BUFFER, o, 3)
            }
        },
        _debugGeometry: function (e) {
            var t = this._debugColor,
                i = this._debugSkinning && e instanceof o.a;
            if (!t && !i) return void(void 0 !== e._originalStateSet && e.setStateSet(e._originalStateSet || void 0));
            void 0 === e._originalStateSet && (e._originalStateSet = e.getStateSet() || null);
            var n = new u.a;
            if (e.setStateSet(n), i) return n.setShaderGeneratorName("debugSkinning"), void this._debugRigGeometry(e);
            var r = l.f.fromValues(Math.random(), Math.random(), Math.random());
            n.addUniform(s.a.createFloat3(r, "uColorDebug")), n.setShaderGeneratorName("debugGeometry"), this._debugCenterGeometry(e, r)
        },
        apply: function (e) {
            e._isNormalDebug || e._isCenterDebug || (e instanceof a.a && this._debugGeometry(e), this.traverse(e))
        }
    }), "osgUtil", "GeometryColorDebugVisitor"), t.a = m
}, function (e, t, i) {
    "use strict";
    var n = i(890),
        r = i(575),
        a = function (e) {
            this._selectables = e, this._nodeList = [], this._linkList = [], this._renderBinMap = new window.Map, this._renderBinStack = [], this._generatorID = 0, this._refID = 0, this._uniqueEdges = new window.Set
        };
    a.prototype = {
        getColorFromClassName: n.a.prototype.getColorFromClassName,
        createGraph: function (e) {
            this.reset(), this.apply(e)
        },
        reset: function () {
            this._renderBinMap.clear(), this._renderBinStack.length = 0, this._generatorID = 0, this._refID++, this._nodeList.length = 0, this._linkList.length = 0, this._uniqueEdges.clear()
        },
        apply: function (e) {
            var t = e.getInstanceID();
            if (this._renderBinMap.has(t) || this._renderBinMap.set(t, e), this._renderBinStack.push(e), e.getPreRenderStageList)
                for (var i = e.getPreRenderStageList(), n = 0, r = i.length; n < r; ++n) this.apply(i[n].renderStage);
            if (this.registerNode(e), e.getPostRenderStageList)
                for (var a = e.getPostRenderStageList(), o = 0, s = a.length; o < s; ++o) this.apply(a[o].renderStage);
            this._renderBinStack.pop()
        },
        registerNode: function (e) {
            var t = e.getInstanceID();
            if (this._nodeList.push(e), e._bins.forEach(function (e, t) {
                    this.apply(t)
                }.bind(this)), e._leafs.length)
                for (var i = 0, n = e._leafs.length; i < n; i++) this.createNodeAndSetID(t, e._leafs[i]);
            var r = this,
                a = {},
                o = function (e) {
                    r.createNodeAndSetID(this.stateGraphID, e)
                }.bind(a),
                s = function (e) {
                    r.createNodeAndSetID(t, e);
                    var i = e._instanceID,
                        n = e.getLeafs();
                    a.stateGraphID = i, n.forEach(o)
                };
            if (e.getStateGraphList().forEach(s), !(this._renderBinStack.length < 2)) {
                var u = this._renderBinStack[this._renderBinStack.length - 2].getInstanceID();
                this.createLink(u, t)
            }
        },
        createLink: function (e, t) {
            var i = e + "+" + t;
            this._uniqueEdges.has(i) || (this._linkList.push({
                parentNode: e,
                childrenNode: t
            }), this._uniqueEdges.add(i))
        },
        createNodeAndSetID: function (e, t) {
            this._nodeList.push(t), (void 0 === t._instanceID || t._instanceID < 0 && t._refID !== this._refID) && (t._instanceID = -1 - this._generatorID++, t._refID = this._refID), this.createLink(e, t._instanceID)
        },
        generateRenderLeaf: function (e, t) {
            var i = t._instanceID,
                n = t._geometry && t._geometry.getName() ? "\n" + t._geometry.getName() : "Geometry",
                r = "RenderLeaf ( " + t._instanceID + " )";
            r += "\n" + n + " ( " + t._geometry.getInstanceID() + " )", this._selectables.set(i.toString(), t), e.addNode(i, {
                label: r,
                description: "",
                style: "fill: " + this.getColorFromClassName("RenderLeaf") + ";stroke-width: 0px;"
            })
        },
        generateStateGraph: function (e, t) {
            var i = t._instanceID,
                n = "StateGraph ( " + t._instanceID + " )";
            n += "\n" + t._leafs._length + " leafs", this._selectables.set(i.toString(), t), e.addNode(i, {
                label: n,
                description: "",
                style: "fill: " + this.getColorFromClassName("StateGraph") + ";stroke-width: 0px;"
            })
        },
        generateRenderStage: function (e, t) {
            var i = t.className() + " ( " + t._instanceID + " )";
            t.getName() && (i += "\n" + t.getName()), i += "\nViewport ( " + t.getViewport().width() + " x " + t.getViewport().height() + " )", this._selectables.set(t.getInstanceID().toString(), t), e.addNode(t.getInstanceID(), {
                label: i,
                description: "",
                style: "fill: " + this.getColorFromClassName(t.className()) + ";stroke-width: 0px;"
            })
        },
        generateRenderBin: function (e, t) {
            var i = t.className() + " ( " + t.getInstanceID() + " )";
            t.getName() && (i += "\n" + t.getName());
            var n = "";
            t.getSortMode() === r.a.SORT_BACK_TO_FRONT && (n = "SortMode: BackToFront");
            var a = "BinNumber: " + t.getBinNumber() + "\n" + n;
            this._selectables.set(t.getInstanceID().toString(), t), e.addNode(t.getInstanceID(), {
                label: i,
                description: a,
                style: "fill: " + this.getColorFromClassName(t.className()) + ";stroke-width: 0px;"
            })
        },
        generateNodeAndLink: function (e) {
            for (var t = 0, i = this._nodeList.length; t < i; t++) {
                var n = this._nodeList[t];
                n._geometry && void 0 !== n._depth ? this.generateRenderLeaf(e, n) : "StateGraph" === n.className() ? this.generateStateGraph(e, n) : "RenderStage" === n.className() ? this.generateRenderStage(e, n) : this.generateRenderBin(e, n)
            }
            for (var r = 0, a = this._linkList.length; r < a; r++) e.addEdge(null, this._linkList[r].parentNode, this._linkList[r].childrenNode)
        }
    }, t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(36),
        r = i(892),
        a = function () {
            return this._generators = {}, this.addShaderGenerator("default", new r.a), this
        };
    a.prototype = {
        getShaderGenerator: function (e) {
            if (!e) return this._generators.default;
            var t = this._generators[e];
            return t || (n.a.error("ShaderGenerator " + e + " does not exist in ShaderGeneratorProxy"), this._generators.default)
        },
        addShaderGenerator: function (e, t) {
            this._generators[e] = t
        }
    }, t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(137),
        r = i(84),
        a = i(198),
        o = i(365),
        s = i(362),
        u = i(449),
        l = i(108),
        c = i(10),
        h = i(579),
        d = i(580),
        f = i(894),
        p = i(177),
        m = i(12),
        g = i(114),
        v = function () {};
    v.prototype = {
        cull: function () {
            return !1
        }
    };
    var _ = new s.a(s.a.SRC_ALPHA, s.a.ONE_MINUS_SRC_ALPHA),
        b = function (e) {
            this._testPlane = e, this._inter = c.f.create(), d.a.call(this)
        };
    m.a.createPrototypeObject(b, m.a.objectInherit(d.a.prototype, {
        setTestPlane: function (e) {
            this._testPlane = e
        },
        getTranslateDistance: function () {
            return this._inter
        },
        enter: function () {
            var e = c.f.create(),
                t = c.f.create();
            return function (i) {
                if (void 0 === i._nbAxis) return !0;
                if (c.f.init(e), e[i._nbAxis] = 1, this._testPlane) {
                    var n = c.f.dot(this._iStart, e),
                        r = c.f.dot(this._iEnd, e);
                    if (n === r) return !1;
                    var a = -n / (r - n);
                    this._inter[0] = this._iStart[0] + (this._iEnd[0] - this._iStart[0]) * a, this._inter[1] = this._iStart[1] + (this._iEnd[1] - this._iStart[1]) * a, this._inter[2] = this._iStart[2] + (this._iEnd[2] - this._iStart[2]) * a
                } else {
                    c.f.normalize(t, c.f.sub(t, this._iEnd, this._iStart));
                    var o = -c.f.dot(t, e),
                        s = c.f.dot(this._iStart, t),
                        u = Math.abs(1 - o * o),
                        l = -c.f.dot(this._iStart, e);
                    c.f.init(this._inter), this._inter[i._nbAxis] = (o * s - l) / u
                }
                return !1
            }
        }(),
        intersectTriangle: function () {},
        intersectLine: function () {},
        intersectPoint: function () {}
    }), "osgUtil", "LineCustomIntersector");
    var S = c.c.create(),
        x = function (e) {
            a.a.call(this), this._tmask = 1, this._autoInsertMT = !1, this._correctPivotOnAutoInsert = !1, this._viewer = e, this._canvas = e.getGraphicContext().canvas, this._rotateNode = new a.a, this._translateNode = new a.a, this._planeNode = new a.a, this._rotateInLocal = !0, this._translateInLocal = !0, this._showAngle = new a.a, this._downCanvasCoord = c.e.create(), this._hoverNode = null, this._keepHoverColor = c.g.create(), this._isEditing = !1, this._editLineOrigin = c.f.create(), this._editLineDirection = c.f.create(), this._editOffset = c.f.create(), this._editLocal = c.c.create(), this._editWorldTrans = c.c.create(), this._editWorldScaleRot = c.c.create(), this._editInvWorldScaleRot = c.c.create(), this._debugNode = new n.a, this._lastDistToEye = 0, this._attachedNode = null, this._pivotOffset = c.f.create(), this.attachToNode(null), this._lsi = new b, this._origIntersect = c.f.create(), this._dstIntersect = c.f.create(), this._iv = new h.a, this._iv.setIntersector(this._lsi), this.init()
        };
    x.NO_PICK = 1, x.PICK_ARC_X = 2, x.PICK_ARC_Y = 4, x.PICK_ARC_Z = 8, x.PICK_ARROW_X = 16, x.PICK_ARROW_Y = 32, x.PICK_ARROW_Z = 64, x.PICK_PLANE_X = 128, x.PICK_PLANE_Y = 256, x.PICK_PLANE_Z = 512, x.NO_FULL_CIRCLE = 1024, x.CORRECT_PIVOT = 2048, x.PICK_ARC = x.PICK_ARC_X | x.PICK_ARC_Y | x.PICK_ARC_Z, x.PICK_ARROW = x.PICK_ARROW_X | x.PICK_ARROW_Y | x.PICK_ARROW_Z, x.PICK_PLANE = x.PICK_PLANE_X | x.PICK_PLANE_Y | x.PICK_PLANE_Z, x.PICK_GIZMO = x.PICK_ARC | x.PICK_ARROW | x.PICK_PLANE;
    var y = function () {
        r.a.call(this, r.a.TRAVERSE_PARENTS), this._editableNode = null
    };
    m.a.createPrototypeObject(y, m.a.objectInherit(r.a.prototype, {
        reset: function () {
            r.a.prototype.reset.call(this), this._editableNode = null
        },
        getEditableNode: function () {
            return this._editableNode
        },
        apply: function (e) {
            if (!this._editableNode) {
                var t = e.editMask;
                if (t && t & x.PICK_GIZMO) return void(this._editableNode = e);
                this.traverse(e)
            }
        }
    })), m.a.createPrototypeNode(x, m.a.objectInherit(a.a.prototype, {
        setRotateInLocal: function (e) {
            this._rotateInLocal = e
        },
        setTranslateInLocal: function (e) {
            this._translateInLocal = e
        },
        setTraversalMask: function (e) {
            this._tmask = e
        },
        setAutoMatrixTransformInsertion: function (e) {
            this._autoInsertMT = e
        },
        setCorrectPivotOnAutoInsert: function (e) {
            this._correctPivotOnAutoInsert = e
        },
        isEditing: function () {
            return this._isEditing
        },
        getAttachedNode: function () {
            return this._attachedNode
        },
        init: function () {
            this.getOrCreateStateSet().setAttributeAndModes(new o.a(o.a.DISABLE)), this.getOrCreateStateSet().setAttributeAndModes(new u.a(u.a.DISABLE)), this.addUpdateCallback(this), this.addChild(this.initNodeTranslate()), this.addChild(this.initNodeTranslatePlane()), this.addChild(this.initNodeRotate()), this._debugNode && (this._debugNode.addChild(f.a.createDebugLineGeometry()), this.addChild(this._debugNode), this._debugNode.setNodeMask(0));
            var e = this._viewer.getInputManager();
            e.group(g.a.NODE_GIZMO).addMappings({
                onMouseMove: "mousemove",
                onMouseDown: "mousedown",
                onMouseUp: ["mouseup", "mouseout"]
            }, this), e.setPriority(g.a.NODE_GIZMO, e.getHigherPriority(g.a.MANIPULATORS))
        },
        _insertEditNode: function (e, t) {
            var i = new a.a;
            return i.editMask = x.PICK_GIZMO, this._correctPivotOnAutoInsert && (i.editMask |= x.CORRECT_PIVOT), e.addChild(i), e.removeChild(t), i.addChild(t), i._isInserted = !0, i
        },
        _findEditNodeFromNodePath: function (e) {
            if (!e) return null;
            var t = e[e.length - 1];
            if (t.editMask) return t;
            if (!this._autoInsertMT) {
                for (var i = e.length - 1; i >= 0; --i) {
                    var n = e[i].editMask;
                    if (n && n & x.PICK_GIZMO) return e[i]
                }
                return null
            }
            var r = e[e.length - 2];
            return r.editMask ? r : this._insertEditNode(r, t)
        },
        _findEditNodeFromNode: function (e) {
            if (!e) return null;
            if (e.editMask) return e;
            if (this._autoInsertMT) {
                for (var t = e.getParents(), i = 0; i < t.length; ++i) {
                    var n = t[i].editMask;
                    if (n && n & x.PICK_GIZMO) return t[i]
                }
                return this._insertEditNode(t[0], e)
            }
            return this._getEditNodeVisitor ? this._getEditNodeVisitor.reset() : this._getEditNodeVisitor = new y, e.accept(this._getEditNodeVisitor), this._getEditNodeVisitor.getEditableNode()
        },
        attachToNodePath: function (e) {
            var t = this._findEditNodeFromNodePath(e);
            this._attachEditNode(t, e && e[e.length - 1])
        },
        attachToNode: function (e) {
            var t = this._findEditNodeFromNode(e);
            this._attachEditNode(t, e)
        },
        _attachEditNode: function (e, t) {
            this._attachedNode = e, e && t && t !== e && e.editMask & x.CORRECT_PIVOT && c.f.copy(this._pivotOffset, t.getBoundingSphere().center()), this.updateGizmoMask()
        },
        updateGizmoMask: function () {
            if (!this._attachedNode) return c.f.init(this._pivotOffset), void this.setNodeMask(0);
            var e = this._attachedNode.editMask;
            this.setNodeMask(e & x.PICK_GIZMO ? x.NO_PICK : 0), this._translateNode.setNodeMask(e & x.PICK_ARROW ? x.PICK_ARROW : 0), this._rotateNode.setNodeMask(e & x.PICK_ARC ? x.PICK_ARC : 0), this._planeNode.setNodeMask(e & x.PICK_PLANE ? x.PICK_PLANE : 0);
            var t = this._translateNode.getChildren();
            t[0].setNodeMask(e & x.PICK_ARROW_X ? x.PICK_ARROW_X : 0), t[1].setNodeMask(e & x.PICK_ARROW_Y ? x.PICK_ARROW_Y : 0), t[2].setNodeMask(e & x.PICK_ARROW_Z ? x.PICK_ARROW_Z : 0);
            var i = this._rotateNode.getChildren();
            i[0].setNodeMask(e & x.NO_FULL_CIRCLE ? 0 : x.NO_PICK), i[1].setNodeMask(e & x.PICK_ARC_X ? x.PICK_ARC_X : 0), i[2].setNodeMask(e & x.PICK_ARC_Y ? x.PICK_ARC_Y : 0), i[3].setNodeMask(e & x.PICK_ARC_Z ? x.PICK_ARC_Z : 0);
            var n = this._planeNode.getChildren();
            n[0].setNodeMask(e & x.PICK_PLANE_X ? x.PICK_PLANE_X : 0), n[1].setNodeMask(e & x.PICK_PLANE_Y ? x.PICK_PLANE_Y : 0), n[2].setNodeMask(e & x.PICK_PLANE_Z ? x.PICK_PLANE_Z : 0)
        },
        onNodeHovered: function () {
            var e = c.g.fromValues(1, 1, 0, 1);
            return function (t) {
                if (this._hoverNode && this._hoverNode.getStateSet().getUniform("uColor").setFloat4(this._keepHoverColor), !t) return void(this._hoverNode = null);
                for (var i = t._nodePath, n = i.length - 1, r = i[n]; void 0 === r._nbAxis;) {
                    if (0 === n) return;
                    r = i[--n]
                }
                var a = r.getStateSet().getUniform("uColor");
                this._hoverNode = r, c.g.copy(this._keepHoverColor, a.getInternalArray()), a.setFloat4(e)
            }
        }(),
        initNodeRotate: function () {
            var e = f.a.createTorusGeometry(1, .01, 6, 64, 2 * Math.PI),
                t = f.a.createTorusGeometry(1, .01, 6, 64, Math.PI),
                i = f.a.createTorusGeometry(1, .1, 6, 64, Math.PI),
                r = new a.a,
                o = new a.a,
                s = new a.a,
                u = new a.a;
            o._nbAxis = 0, s._nbAxis = 1, u._nbAxis = 2;
            var h = new n.a;
            h.setCullCallback(new v), h.addChild(i), e.setNodeMask(x.NO_PICK), t.setNodeMask(x.NO_PICK), o.setNodeMask(x.PICK_ARC_X), s.setNodeMask(x.PICK_ARC_Y), u.setNodeMask(x.PICK_ARC_Z), r.addChild(e), o.addChild(t), s.addChild(t), u.addChild(t), o.addChild(h), s.addChild(h), u.addChild(h), r.getOrCreateStateSet().addUniform(l.a.createFloat4(c.g.fromValues(.2, .2, .2, 1), "uColor")), o.getOrCreateStateSet().addUniform(l.a.createFloat4(c.g.fromValues(1, 0, 0, 1), "uColor")), s.getOrCreateStateSet().addUniform(l.a.createFloat4(c.g.fromValues(0, 1, 0, 1), "uColor")), u.getOrCreateStateSet().addUniform(l.a.createFloat4(c.g.fromValues(0, 0, 1, 1), "uColor"));
            var d = this._showAngle;
            d.getOrCreateStateSet().setAttributeAndModes(_), d.setNodeMask(0), d.getOrCreateStateSet().addUniform(l.a.createFloat3(c.f.fromValues(1, 0, 0), "uBase")), d.getOrCreateStateSet().addUniform(l.a.createFloat(0, "uAngle")), d.addChild(f.a.createQuadCircleGeometry());
            var p = this._rotateNode;
            return p.setNodeMask(x.PICK_ARC), p.addChild(r), p.addChild(o), p.addChild(s), p.addChild(u), p.addChild(d), p
        },
        initNodeTranslate: function () {
            var e = new a.a;
            c.c.fromTranslation(e.getMatrix(), c.f.fromValues(0, 0, 1.65)), e.addChild(f.a.createCylinderGeometry(0, .07, .3, 32, 1, !0, !0));
            var t = new a.a;
            c.c.fromTranslation(t.getMatrix(), c.f.fromValues(0, 0, .75)), t.addChild(f.a.createCylinderGeometry(.01, .01, 1.5, 32, 1, !0, !0));
            var i = new n.a;
            i.addChild(t), i.addChild(e);
            var r = f.a.createCylinderGeometry(.1, .1, 1.3 * 1.1, 32, 1, !0, !0),
                o = new a.a,
                s = new a.a,
                u = new a.a;
            o._nbAxis = 0, s._nbAxis = 1, u._nbAxis = 2, c.c.fromRotation(o.getMatrix(), .5 * Math.PI, c.f.fromValues(0, 1, 0)), c.c.fromRotation(s.getMatrix(), .5 * -Math.PI, c.f.fromValues(1, 0, 0));
            var h = new a.a;
            h.setCullCallback(new v), c.c.fromTranslation(h.getMatrix(), c.f.fromValues(0, 0, 1.215)), h.addChild(r), i.setNodeMask(x.NO_PICK), o.setNodeMask(x.PICK_ARROW_X), s.setNodeMask(x.PICK_ARROW_Y), u.setNodeMask(x.PICK_ARROW_Z), o.addChild(i), s.addChild(i), u.addChild(i), o.addChild(h), s.addChild(h), u.addChild(h), o.getOrCreateStateSet().addUniform(l.a.createFloat4(c.g.fromValues(1, 0, 0, 1), "uColor")), s.getOrCreateStateSet().addUniform(l.a.createFloat4(c.g.fromValues(0, 1, 0, 1), "uColor")), u.getOrCreateStateSet().addUniform(l.a.createFloat4(c.g.fromValues(0, 0, 1, 1), "uColor"));
            var d = this._translateNode;
            return d.setNodeMask(x.PICK_ARROW), d.addChild(o), d.addChild(s), d.addChild(u), d
        },
        initNodeTranslatePlane: function () {
            var e = new a.a;
            c.c.fromTranslation(e.getMatrix(), c.f.fromValues(.5, .5, 0)), c.c.mul(e.getMatrix(), c.c.fromScaling(c.c.create(), c.f.fromValues(.5, .5, 1)), e.getMatrix()), e.addChild(f.a.createPlaneGeometry());
            var t = new a.a,
                i = new a.a,
                n = new a.a;
            t._nbAxis = 0, i._nbAxis = 1, n._nbAxis = 2, c.c.fromRotation(t.getMatrix(), .5 * -Math.PI, c.f.fromValues(0, 1, 0)), c.c.fromRotation(i.getMatrix(), .5 * Math.PI, c.f.fromValues(1, 0, 0)), t.setNodeMask(x.PICK_PLANE_X), i.setNodeMask(x.PICK_PLANE_Y), n.setNodeMask(x.PICK_PLANE_Z), t.addChild(e), i.addChild(e), n.addChild(e), t.getOrCreateStateSet().addUniform(l.a.createFloat4(c.g.fromValues(1, 0, 0, .3), "uColor")), i.getOrCreateStateSet().addUniform(l.a.createFloat4(c.g.fromValues(0, 1, 0, .3), "uColor")), n.getOrCreateStateSet().addUniform(l.a.createFloat4(c.g.fromValues(0, 0, 1, .3), "uColor"));
            var r = this._planeNode;
            return r.setNodeMask(x.PICK_PLANE), r.getOrCreateStateSet().setAttributeAndModes(_), r.addChild(t), r.addChild(i), r.addChild(n), r
        },
        updateArcRotation: function () {
            var e = c.d.create(),
                t = c.d.setAxisAngle(c.d.create(), [0, 1, 0], .5 * -Math.PI),
                i = c.d.setAxisAngle(c.d.create(), [1, 0, 0], .5 * -Math.PI);
            return function (n) {
                var r = this._rotateNode,
                    a = r.getChildren();
                e[0] = -n[1], e[1] = n[0], e[2] = 0, e[3] = 1 + n[2], c.d.normalize(e, e), c.c.fromQuat(a[0].getMatrix(), e), c.d.setAxisAngle(e, [1, 0, 0], Math.atan2(n[2], n[1])), c.d.mul(e, e, t), c.c.fromQuat(a[1].getMatrix(), e), c.d.setAxisAngle(e, [0, 1, 0], Math.atan2(-n[0], -n[2])), c.d.mul(e, e, i), c.c.fromQuat(a[2].getMatrix(), e), c.d.setAxisAngle(e, [0, 0, 1], Math.atan2(-n[0], n[1])), c.c.fromQuat(a[3].getMatrix(), e), a[1].dirtyBound(), a[2].dirtyBound(), a[3].dirtyBound()
            }
        }(),
        getTransformType: function (e) {
            for (var t = e; t.getParents().length > 0;) {
                var i = t.referenceFrame;
                if (void 0 !== i && i === p.a.ABSOLUTE_RF) return p.a.ABSOLUTE_RF;
                t = t.getParents()[0]
            }
            return p.a.RELATIVE_RF
        },
        getAttachedNodeWorldMatrix: function () {
            var e = this._attachedNode.getWorldMatrix(void 0, S);
            return c.c.translate(e, e, this._pivotOffset)
        },
        update: function () {
            var e = c.f.create(),
                t = c.f.create(),
                i = c.f.create(),
                n = c.c.create();
            return function () {
                if (this._attachedNode) {
                    var r = this.getTransformType(this._attachedNode);
                    this.setReferenceFrame(r), this.setCullingActive(r === p.a.RELATIVE_RF);
                    var a = this.getAttachedNodeWorldMatrix();
                    c.c.getTranslation(t, a);
                    var o = 3;
                    if (r === p.a.ABSOLUTE_RF) e[0] = e[1] = e[2] = 0;
                    else {
                        var s = this._viewer.getCamera().getProjectionMatrix(),
                            u = .023 * this._canvas.clientWidth * s[0];
                        this._viewer.getManipulator().getEyePosition(e), this._lastDistToEye = this._isEditing ? this._lastDistToEye : c.f.distance(t, e), o *= this._lastDistToEye / u
                    }
                    var l = this.getMatrix();
                    if (c.c.fromTranslation(l, t), c.f.set(i, o, o, o), c.c.mul(l, l, c.c.fromScaling(n, i)), c.f.sub(e, e, t), c.f.normalize(e, e), this._rotateInLocal || this._translateInLocal) {
                        c.c.getScale(i, a);
                        var h = c.c.fromScaling(n, i);
                        c.c.invert(h, h);
                        var d = c.c.mul(a, a, h);
                        d[12] = d[13] = d[14] = 0, this._translateInLocal && (c.c.copy(this._translateNode.getMatrix(), d), c.c.copy(this._planeNode.getMatrix(), d)), this._rotateInLocal && (c.c.copy(this._rotateNode.getMatrix(), d), c.c.invert(d, d), c.f.transformMat4(e, e, d))
                    } else c.c.identity(this._rotateNode.getMatrix());
                    this.updateArcRotation(e), this._rotateNode.dirtyBound(), this._translateNode.dirtyBound(), this._planeNode.dirtyBound(), this._isEditing && c.c.copy(this._showAngle.getMatrix(), this._hoverNode.getMatrix())
                }
            }
        }(),
        computeNearestIntersection: function () {
            var e = function (e, t) {
                return e._ratio - t._ratio
            };
            return function (t, i) {
                var n = this._viewer,
                    r = this._canvas,
                    a = t.canvasX * (n._canvasWidth / r.clientWidth),
                    o = (r.clientHeight - t.canvasY) * (n._canvasHeight / r.clientHeight),
                    s = this._viewer.computeIntersections(a, o, i);
                if (0 !== s.length) return s.sort(e), s[0]
            }
        }(),
        setOnlyGizmoPicking: function () {
            this._viewer.getCamera().addChild(this), this._viewer.getSceneData().setNodeMask(0), this.setNodeMask(-1)
        },
        setOnlyScenePicking: function () {
            this._viewer.getCamera().removeChild(this), this._viewer.getSceneData().setNodeMask(-1), this.setNodeMask(x.NO_PICK)
        },
        pickGizmo: function (e, t) {
            this.setOnlyGizmoPicking();
            var i = this.computeNearestIntersection(e, t);
            return this.setOnlyScenePicking(), i
        },
        getCanvasPositionFromWorldPoint: function () {
            var e = c.c.create();
            return function (t, i) {
                var n = this._viewer.getCamera(),
                    r = i;
                n.getViewport() ? n.getViewport().computeWindowMatrix(e) : c.c.identity(e), c.c.mul(e, e, n.getProjectionMatrix()), this.getReferenceFrame() === p.a.RELATIVE_RF && c.c.mul(e, e, n.getViewMatrix()), c.f.transformMat4(r, t, e);
                var a = this._viewer,
                    o = this._canvas;
                return r[0] = r[0] / (a._canvasWidth / o.clientWidth), r[1] = o.clientHeight - r[1] / (a._canvasHeight / o.clientHeight), r
            }
        }(),
        onMouseDown: function (e) {
            if (c.e.set(this._downCanvasCoord, e.canvasX, e.canvasY), this._hoverNode && this._attachedNode) {
                this._viewer.setEnableManipulator(!1), this.saveEditMatrices();
                var t = this._hoverNode.getParents()[0].getNodeMask();
                this._isEditing = !0, t & x.PICK_ARC ? (this._translateNode.setNodeMask(0), this._planeNode.setNodeMask(0), this.startRotateEdit(e)) : t & x.PICK_ARROW ? (this._rotateNode.setNodeMask(0), this._planeNode.setNodeMask(0), this.startTranslateEdit(e)) : t & x.PICK_PLANE && (this._rotateNode.setNodeMask(0), this._translateNode.setNodeMask(0), this.startPlaneEdit(e))
            }
        },
        saveEditMatrices: function () {
            c.c.copy(this._editLocal, this._attachedNode.getMatrix());
            var e = this.getAttachedNodeWorldMatrix();
            c.c.fromTranslation(this._editWorldTrans, c.f.fromValues(e[12], e[13], e[14])), c.c.copy(this._editWorldScaleRot, e), this._editWorldScaleRot[12] = this._editWorldScaleRot[13] = this._editWorldScaleRot[14] = 0, c.c.invert(this._editInvWorldScaleRot, this._editWorldScaleRot)
        },
        startRotateEdit: function (e) {
            var t = this._rotateNode.getWorldMatrix(void 0, S),
                i = c.f.create();
            c.f.transformMat4(i, i, t), this.getCanvasPositionFromWorldPoint(i, i);
            var n = this.pickGizmo(e, this._hoverNode.getNodeMask() | x.PICK_ARC);
            if (n) {
                var r = 0 === this._hoverNode._nbAxis ? -1 : 1,
                    a = c.f.create();
                a[0] = r * n._localIntersectionPoint[1], a[1] = -r * n._localIntersectionPoint[0], a[2] = n._localIntersectionPoint[2];
                var o = c.f.create();
                c.f.transformMat4(o, a, this._hoverNode.getMatrix()), c.f.transformMat4(o, o, t), this.getCanvasPositionFromWorldPoint(o, o);
                var s = this._editLineDirection;
                c.e.sub(s, o, i), c.e.normalize(s, s), this._showAngle.setNodeMask(x.NO_PICK), n._localIntersectionPoint[2] = 0;
                var u = this._showAngle.getStateSet();
                u.getUniform("uAngle").setFloat(0), u.getUniform("uBase").setVec3(c.f.normalize(n._localIntersectionPoint, n._localIntersectionPoint)), this._editLineOrigin[0] = e.canvasX, this._editLineOrigin[1] = e.canvasY
            }
        },
        startTranslateEdit: function (e) {
            var t = this._editLineOrigin,
                i = this._editLineDirection,
                n = this._translateNode.getWorldMatrix(void 0, S);
            c.c.getTranslation(t, n), c.f.init(i), i[this._hoverNode._nbAxis] = 1, this._translateInLocal && (c.f.transformMat4(i, i, this._editWorldScaleRot), c.f.normalize(i, i)), c.f.add(i, t, i), this.getCanvasPositionFromWorldPoint(t, t), this.getCanvasPositionFromWorldPoint(i, i), c.e.sub(i, i, t), c.e.normalize(i, i);
            var r = this._editOffset;
            c.e.set(r, e.canvasX, e.canvasY), c.e.sub(r, r, t)
        },
        startPlaneEdit: function (e) {
            var t = this._editLineOrigin,
                i = this._planeNode.getWorldMatrix(void 0, S);
            c.c.getTranslation(t, i), this.getCanvasPositionFromWorldPoint(t, t);
            var n = this._editOffset;
            c.e.set(n, e.canvasX, e.canvasY), c.e.sub(n, n, t)
        },
        drawLineCanvasDebug: function (e, t, i, n) {
            this._debugNode.setNodeMask(x.NO_PICK);
            var r = this._debugNode.getChildren()[0].getAttributes().Vertex;
            r.getElements()[0] = e / this._canvas.clientWidth * 2 - 1, r.getElements()[1] = (this._canvas.clientHeight - t) / this._canvas.clientHeight * 2 - 1, r.getElements()[2] = i / this._canvas.clientWidth * 2 - 1, r.getElements()[3] = (this._canvas.clientHeight - n) / this._canvas.clientHeight * 2 - 1, r.dirty()
        },
        pickAndSelect: function (e) {
            this.setNodeMask(0);
            var t = this.computeNearestIntersection(e, this._tmask);
            this.attachToNodePath(t ? t._nodePath : t)
        },
        onMouseUp: function (e) {
            this._viewer.setEnableManipulator(!0), this._debugNode && this._debugNode.setNodeMask(0);
            var t = c.e.fromValues(e.canvasX, e.canvasY);
            0 === c.e.distance(t, this._downCanvasCoord) && this.pickAndSelect(e), this._showAngle.setNodeMask(0), this._isEditing = !1, this._hoverNode && this.updateGizmoMask()
        },
        onMouseMove: function (e) {
            if (this._attachedNode) {
                var t;
                if (!1 === this._isEditing) return t = this.pickGizmo(e, x.PICK_GIZMO), void this.onNodeHovered(t);
                if (this._hoverNode) {
                    var i = this._hoverNode.getParents()[0];
                    i === this._rotateNode ? this.updateRotateEdit(e) : i === this._translateNode ? this.updateTranslateEdit(e) : i === this._planeNode && this.updatePlaneEdit(e)
                }
            }
        },
        updateRotateEdit: function () {
            var e = c.c.create(),
                t = c.e.create(),
                i = c.f.fromValues(1, 0, 0),
                n = c.f.fromValues(0, 1, 0),
                r = c.f.fromValues(0, 0, 1),
                a = c.f.create();
            return function (o) {
                var s = this._editLineOrigin,
                    u = this._editLineDirection;
                c.e.set(t, o.canvasX, o.canvasY), c.e.sub(t, t, s);
                var l = c.e.dot(t, u);
                if (this._debugNode) {
                    var h = s[0],
                        d = s[1];
                    this.drawLineCanvasDebug(h, d, h + u[0] * l, d + u[1] * l)
                }
                var f = Math.min(this._canvas.clientWidth, this._canvas.clientHeight),
                    p = 7 * l / f;
                p %= 2 * Math.PI;
                var m = this._hoverNode._nbAxis;
                0 === m ? c.c.fromRotation(e, -p, i) : 1 === m ? c.c.fromRotation(e, -p, n) : 2 === m && c.c.fromRotation(e, -p, r), this._showAngle.getOrCreateStateSet().getUniform("uAngle").setFloat(0 === m ? -p : p), this._rotateInLocal || (c.c.mul(e, this._editInvWorldScaleRot, e), c.c.mul(e, e, this._editWorldScaleRot));
                var g = this._attachedNode.getMatrix();
                c.c.translate(g, this._editLocal, this._pivotOffset), c.c.mul(g, g, e), c.c.translate(g, g, c.f.negate(a, this._pivotOffset)), this._attachedNode.dirtyBound()
            }
        }(),
        updateTranslateEdit: function () {
            var e = c.e.create(),
                t = c.f.create();
            return function (i) {
                var n = this._editLineOrigin,
                    r = this._editLineDirection;
                c.e.set(e, i.canvasX, i.canvasY), c.e.sub(e, e, n), c.e.sub(e, e, this._editOffset);
                var a = c.e.dot(e, r);
                e[0] = n[0] + r[0] * a, e[1] = n[1] + r[1] * a, this._debugNode && this.drawLineCanvasDebug(n[0], n[1], e[0], e[1]);
                var o = this._viewer,
                    s = this._canvas,
                    u = e[0] * (o._canvasWidth / s.clientWidth),
                    l = (s.clientHeight - e[1]) * (o._canvasHeight / s.clientHeight);
                if (this._lsi.reset(), this._lsi.setTestPlane(!1), this._lsi.set(c.f.set(this._origIntersect, u, l, 0), c.f.set(this._dstIntersect, u, l, 1)), this._iv.reset(), this._iv.setTraversalMask(this._hoverNode.getNodeMask()), c.c.copy(this.getMatrix(), this._editWorldTrans), this.setOnlyGizmoPicking(), this._viewer._camera.accept(this._iv), this.setOnlyScenePicking(), this._translateInLocal) {
                    c.c.getScale(t, this._editInvWorldScaleRot);
                    var h = this._lsi.getTranslateDistance();
                    c.f.mul(t, t, h)
                } else c.f.transformMat4(t, this._lsi.getTranslateDistance(), this._editInvWorldScaleRot);
                c.c.translate(this._attachedNode.getMatrix(), this._editLocal, t), this._attachedNode.dirtyBound()
            }
        }(),
        updatePlaneEdit: function () {
            var e = c.e.create(),
                t = c.f.create();
            return function (i) {
                c.e.set(e, i.canvasX, i.canvasY), c.e.sub(e, e, this._editOffset);
                var n = this._viewer,
                    r = this._canvas,
                    a = e[0] * (n._canvasWidth / r.clientWidth),
                    o = (r.clientHeight - e[1]) * (n._canvasHeight / r.clientHeight);
                if (this._lsi.reset(), this._lsi.setTestPlane(!0), this._lsi.set(c.f.set(this._origIntersect, a, o, 0), c.f.set(this._dstIntersect, a, o, 1)), this._iv.reset(), this._iv.setTraversalMask(this._hoverNode.getNodeMask()), c.c.copy(this.getMatrix(), this._editWorldTrans), this.setOnlyGizmoPicking(), this._viewer._camera.accept(this._iv), this.setOnlyScenePicking(), this._translateInLocal) {
                    c.c.getScale(t, this._editInvWorldScaleRot);
                    var s = this._lsi.getTranslateDistance();
                    c.f.mul(t, t, s)
                } else c.f.transformMat4(t, this._lsi.getTranslateDistance(), this._editInvWorldScaleRot);
                c.c.translate(this._attachedNode.getMatrix(), this._editLocal, t), this._attachedNode.dirtyBound()
            }
        }()
    }), "osgUtil", "NodeGizmo"), t.a = x
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(10),
        a = i(625),
        o = i(1112),
        s = function () {
            a.a.call(this), this._center = r.f.create(), this._iCenter = r.f.create(), this._radius = 1, this._iRadius = 1
        };
    n.a.createPrototypeObject(s, n.a.objectInherit(a.a.prototype, {
        set: function (e, t) {
            r.f.copy(this._center, e), r.f.copy(this._iCenter, e), this._radius = this._iRadius = t, this.reset()
        },
        setCenter: function (e) {
            r.f.copy(this._center, e), r.f.copy(this._iCenter, e)
        },
        setRadius: function (e) {
            this._radius = this._iRadius = e
        },
        intersectNode: function (e) {
            return this.intersectBoundingSphere(e.getBoundingSphere())
        },
        intersectBoundingSphere: function (e) {
            if (!e.valid()) return !1;
            var t = this._iRadius + e.radius();
            return r.f.sqrDist(e.center(), this._iCenter) <= t * t
        },
        intersect: function () {
            var e = new o.a;
            return function (t, i) {
                e.setGeometry(i), e.setIntersectionVisitor(t), e.setIntersector(this), e.set(this._iCenter, this._iRadius);
                var n = i.getShape();
                n ? n.intersect(e, n.getNodes()[0]) : (i.computeTransformedVertices && e.setVertices(i.computeTransformedVertices()), e.apply(i)), e.reset()
            }
        }(),
        setCurrentTransformation: function () {
            var e = r.f.create();
            return function (t) {
                r.c.invert(t, t), r.f.transformMat4(this._iCenter, this._center, t), r.c.getScale(e, t);
                var i = e[0],
                    n = e[1],
                    a = e[2],
                    o = i > n ? i > a ? i : a : n > a ? n : a;
                this._iRadius = this._radius * o
            }
        }()
    }), "osgUtil", "SphereIntersector"), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(10),
        a = i(627),
        o = function () {
            a.a.Intersection.call(this), this._localIntersectionNormal = r.f.clone(r.f.ONE), this._i1 = -1, this._i2 = -1, this._i3 = -1, this._r1 = 0, this._r2 = 0, this._r3 = 0
        },
        s = function () {
            a.a.apply(this), this._center = void 0, this._radius = 0
        };
    n.a.createPrototypeObject(s, n.a.objectInherit(a.a.prototype, {
        set: function (e, t) {
            this._center = e, this._radius = t
        },
        enter: function (e) {
            for (var t = this._radius * this._radius, i = 0, n = e.getMin(), r = e.getMax(), a = 0, o = 0; o < 3; o++) this._center[o] < n[o] ? (a = this._center[o] - n[o], i += a * a) : this._center[o] > r[o] && (a = this._center[o] - r[o], i += a * a);
            return i <= t
        },
        intersectPoint: function (e, t) {
            var i = r.f.sqrDist(e, this._center);
            if (!(i > this._radius * this._radius)) {
                var n = this.initIntersection(new o);
                n._i1 = t, n._r1 = 1, r.f.copy(n._localIntersectionPoint, e), n._ratio = Math.sqrt(i) / this._radius
            }
        },
        intersectLine: function () {
            var e = r.f.create(),
                t = r.f.create();
            return function (i, n, a, s) {
                r.f.sub(e, this._center, i), r.f.sub(t, n, i);
                var u = r.f.dot(e, t) / r.f.sqrLen(t),
                    l = 1;
                if (!((l = u < 0 ? r.f.sqrLen(e) : u > 1 ? r.f.sqrDist(this._center, n) : r.f.sqrLen(r.f.scaleAndAdd(e, e, t, -u))) > this._radius * this._radius)) {
                    var c = this.initIntersection(new o);
                    c._i1 = a, c._i2 = s, c._r1 = 1 - u, c._r2 = u, r.f.scaleAndAdd(c._localIntersectionPoint, i, t, u), c._ratio = Math.sqrt(l) / this._radius
                }
            }
        }(),
        intersectTriangle: function () {
            var e = r.f.create(),
                t = r.f.create(),
                i = r.f.create();
            return function (n, a, s, u, l, c) {
                if (!this._limitOneIntersection || !this._hit) {
                    r.f.sub(e, a, n), r.f.sub(t, s, n);
                    var h = r.f.sqrLen(e),
                        d = r.f.dot(e, t),
                        f = r.f.sqrLen(t);
                    r.f.sub(i, n, this._center);
                    var p = r.f.dot(i, e),
                        m = r.f.dot(i, t),
                        g = r.f.sqrLen(i),
                        v = Math.abs(h * f - d * d);
                    if (!(v < 1e-10)) {
                        var _, b = d * m - f * p,
                            S = d * p - h * m,
                            x = 4;
                        if (b + S <= v)
                            if (b < 0) S < 0 ? (x = 4, p < 0 ? (S = 0, -p >= h ? (b = 1, _ = h + 2 * p + g) : (b = -p / h, _ = p * b + g)) : (b = 0, m >= 0 ? (S = 0, _ = g) : -m >= f ? (S = 1, _ = f + 2 * m + g) : (S = -m / f, _ = m * S + g))) : (x = 3, b = 0, m >= 0 ? (S = 0, _ = g) : -m >= f ? (S = 1, _ = f + 2 * m + g) : (S = -m / f, _ = m * S + g));
                            else if (S < 0) x = 5, S = 0, p >= 0 ? (b = 0, _ = g) : -p >= h ? (b = 1, _ = h + 2 * p + g) : (b = -p / h, _ = p * b + g);
                        else {
                            x = 0;
                            var y = 1 / v;
                            b *= y, S *= y, _ = b * (h * b + d * S + 2 * p) + S * (d * b + f * S + 2 * m) + g
                        } else {
                            var C, T, w, M;
                            b < 0 ? (x = 2, C = d + p, T = f + m, T > C ? (w = T - C, M = h - 2 * d + f, w >= M ? (b = 1, S = 0, _ = h + 2 * p + g) : (b = w / M, S = 1 - b, _ = b * (h * b + d * S + 2 * p) + S * (d * b + f * S + 2 * m) + g)) : (b = 0, T <= 0 ? (S = 1, _ = f + 2 * m + g) : m >= 0 ? (S = 0, _ = g) : (S = -m / f, _ = m * S + g))) : S < 0 ? (x = 6, C = d + m, T = h + p, T > C ? (w = T - C, M = h - 2 * d + f, w >= M ? (S = 1, b = 0, _ = f + 2 * m + g) : (S = w / M, b = 1 - S, _ = b * (h * b + d * S + 2 * p) + S * (d * b + f * S + 2 * m) + g)) : (S = 0, T <= 0 ? (b = 1, _ = h + 2 * p + g) : p >= 0 ? (b = 0, _ = g) : (b = -p / h, _ = p * b + g))) : (x = 1, w = f + m - d - p, w <= 0 ? (b = 0, S = 1, _ = f + 2 * m + g) : (M = h - 2 * d + f, w >= M ? (b = 1, S = 0, _ = h + 2 * p + g) : (b = w / M, S = 1 - b, _ = b * (h * b + d * S + 2 * p) + S * (d * b + f * S + 2 * m) + g)))
                        }
                        if (!(_ > this._radius * this._radius)) {
                            var E = r.f.create(),
                                A = this.initIntersection(new o);
                            A._i1 = u, A._i2 = l, A._i3 = c, A._r1 = 1 - b - S, A._r2 = b, A._r3 = S;
                            var P = A._localIntersectionPoint;
                            r.f.scaleAndAdd(P, r.f.scaleAndAdd(P, n, e, b), t, S), r.f.cross(A._localIntersectionNormal, e, t), r.f.normalize(E, A._localIntersectionNormal), A._ratio = Math.sqrt(_) / this._radius, A._zone = x
                        }
                    }
                }
            }
        }()
    }), "osgUtil", "SphereIntersectFunctor"), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(178),
        a = i(160),
        o = i(84),
        s = i(138),
        u = i(10),
        l = function () {
            o.a.call(this), this._T = void 0, this._B = void 0, this._N = void 0, this._texCoordUnit = 0
        };
    n.a.createPrototypeObject(l, n.a.objectInherit(o.a.prototype, {
        apply: function (e) {
            e.getTypeID() === a.a.getTypeID() ? this.generate(e, this._texCoordUnit) : this.traverse(e)
        },
        setTexCoordUnit: function (e) {
            this._texCoordUnit = e
        },
        computePrimitiveSet: function (e, t) {
            if (t.getIndices) {
                var i, n = t.getNumIndices(),
                    r = e.getAttributes().Vertex,
                    a = e.getAttributes().Normal,
                    o = e.getAttributes()["TexCoord" + this._texCoordUnit];
                if (t.getMode() === s.a.TRIANGLES)
                    for (i = 0; i < n; i += 3) this.compute(t, r, a, o, i, i + 1, i + 2);
                else if (t.getMode() === s.a.TRIANGLE_STRIP)
                    for (i = 0; i < n - 2; ++i) i % 2 == 0 ? this.compute(t, r, a, o, i, i + 1, i + 2) : this.compute(t, r, a, o, i + 1, i, i + 2)
            }
        },
        generate: function (e, t) {
            if (this._texCoordUnit = t, void 0 === this._texCoordUnit && (this._texCoordUnit = 0), e.getAttributes()["TexCoord" + this._texCoordUnit]) {
                var i = e.getAttributes().Vertex.getElements().length;
                this._T = new n.a.Float32Array(i), this._B = new n.a.Float32Array(i), this._N = new n.a.Float32Array(i), e.getPrimitiveSetList().forEach(function (t) {
                    this.computePrimitiveSet(e, t)
                }, this);
                for (var a = i / 3, o = new n.a.Float32Array(4 * a), s = u.f.create(), l = u.f.create(), c = u.f.create(), h = 0; h < a; h++) {
                    var d = this._T.subarray(3 * h, 3 * h + 3),
                        f = this._N.subarray(3 * h, 3 * h + 3),
                        p = this._B.subarray(3 * h, 3 * h + 3);
                    u.f.normalize(f, f);
                    var m = u.f.dot(f, d);
                    u.f.scale(l, f, m), u.f.sub(s, d, l), u.f.normalize(c, s), u.f.cross(s, f, d);
                    var g = u.f.dot(s, p);
                    g = g < 0 ? -1 : 0, o[4 * h] = c[0], o[4 * h + 1] = c[1], o[4 * h + 2] = c[2], o[4 * h + 3] = g
                }
                e.getAttributes().Normal.setElements(this._N), e.getAttributes().Tangent = new r.a("ARRAY_BUFFER", o, 4)
            }
        },
        compute: function (e, t, i, n, r, a, o) {
            var s, l, c = e.index(r),
                h = e.index(a),
                d = e.index(o),
                f = t.getElements().subarray(3 * c, 3 * c + 3),
                p = t.getElements().subarray(3 * h, 3 * h + 3),
                m = t.getElements().subarray(3 * d, 3 * d + 3),
                g = i.getElements().subarray(3 * c, 3 * c + 3),
                v = i.getElements().subarray(3 * h, 3 * h + 3),
                _ = i.getElements().subarray(3 * d, 3 * d + 3),
                b = n.getElements().subarray(2 * c, 2 * c + 2),
                S = n.getElements().subarray(2 * h, 2 * h + 2),
                x = n.getElements().subarray(2 * d, 2 * d + 2),
                y = u.f.create(),
                C = u.f.create(),
                T = u.f.create(),
                w = u.f.create(),
                M = u.f.create(),
                E = u.f.create(),
                A = u.f.create(),
                P = u.f.create(),
                R = u.f.create();
            u.f.set(P, p[0] - f[0], S[0] - b[0], S[1] - b[1]), u.f.set(R, m[0] - f[0], x[0] - b[0], x[1] - b[1]), u.f.cross(y, P, R), 0 !== y[0] && (u.f.normalize(y, y), l = -y[1] / y[0], s = -y[2] / y[0], M[0] += l, C[0] += s, E[0] += l, T[0] += s, A[0] += l, w[0] += s), u.f.set(P, p[1] - f[1], S[0] - b[0], S[1] - b[1]), u.f.set(R, m[1] - f[1], x[0] - b[0], x[1] - b[1]), u.f.cross(y, P, R), 0 !== y[0] && (u.f.normalize(y, y), l = -y[1] / y[0], s = -y[2] / y[0], M[1] += l, C[1] += s, E[1] += l, T[1] += s, A[1] += l, w[1] += s), u.f.set(P, p[2] - f[2], S[0] - b[0], S[1] - b[1]), u.f.set(R, m[2] - f[2], x[0] - b[0], x[1] - b[1]), u.f.cross(y, P, R), 0 !== y[0] && (u.f.normalize(y, y), l = -y[1] / y[0], s = -y[2] / y[0], M[2] += l, C[2] += s, E[2] += l, T[2] += s, A[2] += l, w[2] += s);
            var O, I, F, N = u.f.create(),
                D = u.f.create();
            u.f.cross(N, g, M), u.f.cross(D, N, g), O = this._T.subarray(3 * c, 3 * c + 3), u.f.add(O, D, O), u.f.cross(N, C, g), u.f.cross(D, g, N), I = this._B.subarray(3 * c, 3 * c + 3), u.f.add(I, D, I), u.f.cross(N, v, E), u.f.cross(D, N, v), O = this._T.subarray(3 * h, 3 * h + 3), u.f.add(O, D, O), u.f.cross(N, T, v), u.f.cross(D, v, N), I = this._B.subarray(3 * h, 3 * h + 3), u.f.add(I, D, I), u.f.cross(N, _, A), u.f.cross(D, N, _), O = this._T.subarray(3 * d, 3 * d + 3), u.f.add(O, D, O), u.f.cross(N, w, _), u.f.cross(D, _, N), I = this._B.subarray(3 * d, 3 * d + 3), u.f.add(I, D, I), F = this._N.subarray(3 * c, 3 * c + 3), u.f.add(F, g, F), F = this._N.subarray(3 * h, 3 * h + 3), u.f.add(F, v, F), F = this._N.subarray(3 * d, 3 * d + 3), u.f.add(F, _, F)
        }
    }), "osgUtil", "TangentSpaceGenerator"), t.a = l
}, function (e, t, i) {
    "use strict";
    var n = i(197),
        r = i(363),
        a = i(10),
        o = i(137),
        s = i(292),
        u = i(320),
        l = i(407),
        c = i(118),
        h = i(316),
        d = i(108),
        f = i(421),
        p = {},
        m = function (e, t, i, n, r) {
            this._viewer = e, this._rttScene = t, this._hmdConfig = i, this._root = n, this._canvas = r, this._width = r.width, this._height = r.height
        };
    m.prototype = {
        update: function () {
            var e = this._canvas,
                t = e.width,
                i = e.height;
            if (t !== this._width || i !== this._height) {
                this._root.removeChildren();
                var n = this._hmdConfig;
                n && n.isCardboard && (n.hResolution = t, n.vResolution = i), this._width = t, this._height = i, p.createScene(this._viewer, this._rttScene, n, this._root)
            }
            return !0
        }
    };
    var g = function (e, t) {
        this._rootView = e, this._offsetView = t
    };
    g.prototype = {
        update: function (e) {
            var t = e.getViewMatrix();
            return a.c.mul(t, this._offsetView, this._rootView), !0
        }
    };
    var v = function (e, t, i, n) {
            var r = t.hResolution / (2 * t.vResolution),
                o = -1 - 4 * (.25 * t.hScreenSize - .5 * t.lensSeparationDistance) / t.hScreenSize,
                s = t.distortionK[0] + t.distortionK[1] * Math.pow(o, 2) + t.distortionK[2] * Math.pow(o, 4) + t.distortionK[3] * Math.pow(o, 6),
                u = 180 / Math.PI * 2 * Math.atan2(t.vScreenSize * s, 2 * t.eyeToScreenDistance),
                l = a.c.perspective(a.c.create(), Math.PI / 180 * u, r, .3, 1e4),
                c = 4 * (.25 * t.hScreenSize - .5 * t.interpupillaryDistance) / t.hScreenSize,
                h = 4 * (.25 * t.hScreenSize - .5 * t.lensSeparationDistance) / t.hScreenSize,
                d = a.c.create(),
                f = a.c.create();
            n.projectionLeft = a.c.mul(d, a.c.fromTranslation(d, a.f.fromValues(c, 0, 0)), l), n.projectionRight = a.c.mul(f, a.c.fromTranslation(f, a.f.fromValues(-c, 0, 0)), l), n.viewLeft = a.c.fromTranslation(a.c.create(), a.f.fromValues(e * t.interpupillaryDistance * .5, 0, 0)), n.viewRight = a.c.fromTranslation(a.c.create(), a.f.fromValues(-e * t.interpupillaryDistance * .5, 0, 0)), i.lensCenterLeft = a.e.fromValues(h, 0), i.lensCenterRight = a.e.fromValues(-h, 0), i.hmdWarpParam = t.distortionK, i.chromAbParam = t.chromaAbParameter, i.scaleIn = a.e.fromValues(1, 1 / r), i.scale = a.e.fromValues(1 / s, 1 * r / s)
        },
        _ = function () {
            var e = ["uniform vec2 uScale;", "uniform vec2 uScaleIn;", "uniform vec2 uLensCenter;", "uniform vec4 uHmdWarpParam;", "uniform vec4 uChromAbParam;", "uniform sampler2D Texture0;", "varying vec2 vTexCoord0;", "void main(void) {", "  vec2 uv = (vTexCoord0 * 2.0) - 1.0;", "  vec2 theta = (uv - uLensCenter) * uScaleIn;", "  float rSq = theta.x * theta.x + theta.y * theta.y;", "  vec2 rvector = theta * (uHmdWarpParam.x + uHmdWarpParam.y * rSq + uHmdWarpParam.z * rSq * rSq + uHmdWarpParam.w * rSq * rSq * rSq);", "  vec2 rBlue = rvector * (uChromAbParam.z + uChromAbParam.w * rSq);", "  vec2 tcBlue = (uLensCenter + uScale * rBlue);", "  tcBlue = (tcBlue + 1.0) * 0.5;", "  if (any(bvec2(clamp(tcBlue, vec2(0.0, 0.0), vec2(1.0, 1.0)) - tcBlue))) {", "    gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);", "    return;", "  }", "  vec2 tcGreen = uLensCenter + uScale * rvector;", "  tcGreen = (tcGreen + 1.0) * 0.5;", "  vec2 rRed = rvector * (uChromAbParam.x + uChromAbParam.y * rSq);", "  vec2 tcRed = uLensCenter + uScale * rRed;", "  tcRed = (tcRed + 1.0) * 0.5;", "  gl_FragColor = vec4(texture2D(Texture0, tcRed).r, texture2D(Texture0, tcGreen).g, texture2D(Texture0, tcBlue).b, 1);", "}", ""].join("\n");
            return new s.a(new u.a(u.a.VERTEX_SHADER, ["attribute vec3 Vertex;", "varying vec2 vTexCoord0;", "void main(void) {", "  gl_Position = vec4(Vertex * 2.0 - 1.0, 1.0);", "  vTexCoord0 = Vertex.xy;", "}", "", "#define SHADER_NAME VRpostProcessing", ""].join("\n")), new u.a(u.a.FRAGMENT_SHADER, e))
        },
        b = function (e) {
            var t = new c.default;
            return t.setTextureSize(e[0], e[1]), t.setMinFilter("LINEAR"), t.setMagFilter("LINEAR"), t
        },
        S = function (e, t, i, r, o, s) {
            var u = new n.a,
                l = t[0],
                c = t[1],
                p = i[0],
                m = i[1];
            !0 === r ? e ? u.setViewport(new f.a(0, 0, p / 2, m)) : u.setViewport(new f.a(p / 2, 0, p / 2, m)) : e ? u.setViewport(new f.a(.5 * p - l, .5 * (m - c), l, c)) : u.setViewport(new f.a(.5 * p, .5 * (m - c), l, c)), a.c.ortho(u.getProjectionMatrix(), -.5, .5, -.5, .5, -5, 5), u.setRenderOrder(n.a.NESTED_RENDER, 0), u.setReferenceFrame(h.a.ABSOLUTE_RF);
            var g = u.getOrCreateStateSet();
            return g.setTextureAttributeAndModes(0, o), g.setAttributeAndModes(_()), g.addUniform(d.a.createFloat2(s.scale, "uScale")), g.addUniform(d.a.createFloat2(s.scaleIn, "uScaleIn")), g.addUniform(d.a.createFloat2(e ? s.lensCenterLeft : s.lensCenterRight, "uLensCenter")), g.addUniform(d.a.createFloat4(s.hmdWarpParam, "uHmdWarpParam")), g.addUniform(d.a.createFloat4(s.chromAbParam, "uChromAbParam")), u
        },
        x = function (e, t) {
            var i = new n.a;
            return i.setName("rtt camera"), i.setViewport(new f.a(0, 0, e.getWidth(), e.getHeight())), i.setProjectionMatrix(t), i.setClearColor(a.g.fromValues(.3, .3, .3, 0)), i.setRenderOrder(n.a.POST_RENDER, 0), i.attachTexture(r.a.COLOR_ATTACHMENT0, e), i.attachRenderBuffer(r.a.DEPTH_ATTACHMENT, r.a.DEPTH_COMPONENT16), i.setReferenceFrame(h.a.ABSOLUTE_RF), i
        };
    p.createScene = function (e, t, i, n, r) {
        var s = p.getDefaultConfig(i),
            u = a.e.fromValues(.5 * s.hResolution, s.vResolution),
            c = a.e.fromValues(.5 * s.hResolution, s.vResolution),
            h = e.getCamera().getViewport(),
            d = a.e.fromValues(h.width(), h.height()),
            f = e.getGraphicContext().canvas;
        s.isCardboard && (d[0] = f.width, d[1] = f.height);
        var _ = void 0 !== r ? r : 1,
            y = {},
            C = {};
        v(_, s, y, C);
        var T = e.getCamera().getViewMatrix(),
            w = n || new o.a;
        w.addUpdateCallback(new m(e, t, i, w, f));
        var M = b(u),
            E = x(M, C.projectionLeft),
            A = S(!0, c, d, s.isCardboard, M, y);
        E.addUpdateCallback(new g(T, C.viewLeft));
        var P = b(u),
            R = x(P, C.projectionRight),
            O = S(!1, c, d, s.isCardboard, P, y);
        return R.addUpdateCallback(new g(T, C.viewRight)), E.addChild(t), R.addChild(t), A.addChild(l.a.createTexturedFullScreenFakeQuadGeometry()), O.addChild(l.a.createTexturedFullScreenFakeQuadGeometry()), w.addChild(E), w.addChild(R), w.addChild(A), w.addChild(O), w
    }, p.getDefaultConfig = function (e) {
        var t = {
            hResolution: 1920,
            vResolution: 1080,
            hScreenSize: .1296,
            vScreenSize: .0729,
            interpupillaryDistance: .064,
            lensSeparationDistance: .0635,
            eyeToScreenDistance: .04,
            distortionK: a.g.fromValues(1, .22, .13, .02),
            chromaAbParameter: a.g.fromValues(.996, -.004, 1.014, 0),
            isCardboard: !1
        };
        return 2 === e || void 0 === e ? t : 1 === e ? (t.hResolution = 1280, t.vResolution = 800, t.hScreenSize = .14976, t.vScreenSize = .0936, t.lensSeparationDistance = .064, t.eyeToScreenDistance = .041, t.distortionK = a.g.fromValues(1, .22, .24, 0), t) : (void 0 !== e.hResolution && (t.hResolution = e.hResolution), void 0 !== e.vResolution && (t.vResolution = e.vResolution), void 0 !== e.hScreenSize && (t.hScreenSize = e.hScreenSize), void 0 !== e.vScreenSize && (t.vScreenSize = e.vScreenSize), void 0 !== e.interpupillaryDistance && (t.interpupillaryDistance = e.interpupillaryDistance), void 0 !== e.lensSeparationDistance && (t.lensSeparationDistance = e.lensSeparationDistance), void 0 !== e.eyeToScreenDistance && (t.eyeToScreenDistance = e.eyeToScreenDistance), void 0 !== e.distortionK && (t.distortionK = e.distortionK), void 0 !== e.chromaAbParameter && (t.chromaAbParameter = e.chromaAbParameter), void 0 !== e.isCardboard && (t.isCardboard = e.isCardboard), t)
    }, t.a = p
}, function (e, t, i) {
    "use strict";
    var n = i(197),
        r = i(363),
        a = i(10),
        o = i(137),
        s = i(292),
        u = i(320),
        l = i(407),
        c = i(118),
        h = i(316),
        d = i(108),
        f = i(421),
        p = function (e, t) {
            this._rootView = e, this._offsetView = t
        };
    p.prototype = {
        update: function (e) {
            var t = e.getViewMatrix();
            return a.c.mul(t, this._offsetView, this._rootView), !0
        }
    };
    var m = function (e) {
            var t = new c.default;
            return t.setTextureSize(e.width, e.height), t.setMinFilter("LINEAR"), t.setMagFilter("LINEAR"), t
        },
        g = function () {
            var e = ["varying vec2 vTexCoord0;", "uniform sampler2D TextureLeft;", "uniform sampler2D TextureRight;", "void main() {", "   if (vTexCoord0.x < 0.5)", "       gl_FragColor = texture2D(TextureLeft, vec2(vTexCoord0.x * 2.0, vTexCoord0.y));", "   else", "       gl_FragColor = texture2D(TextureRight, vec2(vTexCoord0.x * 2.0 - 1.0, vTexCoord0.y));", "}"].join("\n");
            return new s.a(new u.a(u.a.VERTEX_SHADER, ["attribute vec3 Vertex;", "varying vec2 vTexCoord0;", "void main(void) {", "  gl_Position = vec4(Vertex * 2.0 - 1.0, 1.0);", "  vTexCoord0 = Vertex.xy;", "}", "", "#define SHADER_NAME VRpostProcessing", ""].join("\n")), new u.a(u.a.FRAGMENT_SHADER, e))
        },
        v = function (e, t, i) {
            var r = new n.a;
            r.setViewport(i), r.setRenderOrder(n.a.NESTED_RENDER, 0), r.setReferenceFrame(h.a.ABSOLUTE_RF), a.c.ortho(r.getProjectionMatrix(), 0, 1, 0, 1, -5, 5);
            var o = r.getOrCreateStateSet();
            return o.addUniform(d.a.createInt(0, "TextureLeft")), o.addUniform(d.a.createInt(1, "TextureRight")), o.setTextureAttributeAndModes(0, e), o.setTextureAttributeAndModes(1, t), o.setAttributeAndModes(g()), r.addChild(l.a.createTexturedFullScreenFakeQuadGeometry()), r
        },
        _ = function (e, t) {
            var i = new n.a;
            return i.setName("rtt camera"), i.setViewport(new f.a(0, 0, e.getWidth(), e.getHeight())), i.setProjectionMatrix(t), i.setClearColor(a.g.fromValues(.3, .3, .3, 0)), i.setRenderOrder(n.a.POST_RENDER, 0), i.attachTexture(r.a.COLOR_ATTACHMENT0, e), i.attachRenderBuffer(r.a.DEPTH_ATTACHMENT, r.a.DEPTH_COMPONENT16), i.setReferenceFrame(h.a.ABSOLUTE_RF), i
        },
        b = {};
    b.createScene = function (e, t, i, n, r) {
        var s = n || new o.a;
        return i.requestAnimationFrame(function () {
            var n = void 0 !== r ? r : 1,
                o = i.getEyeParameters("left"),
                u = i.getEyeParameters("right"),
                l = new window.VRFrameData;
            i.getFrameData(l);
            var c = a.c.fromTranslation(a.c.create(), a.f.fromValues(-n * o.offset[0], o.offset[1], o.offset[2])),
                h = a.c.fromTranslation(a.c.create(), a.f.fromValues(-n * u.offset[0], u.offset[1], u.offset[2])),
                d = {
                    width: Math.max(o.renderWidth, u.renderWidth),
                    height: Math.max(o.renderHeight, u.renderHeight)
                },
                f = m(d),
                g = m(d),
                b = _(f, l.leftProjectionMatrix),
                S = _(g, l.rightProjectionMatrix),
                x = e.getCamera().getViewMatrix();
            b.addUpdateCallback(new p(x, c)), S.addUpdateCallback(new p(x, h));
            var y = v(f, g, e.getCamera().getViewport());
            b.addChild(t), S.addChild(t), s.addChild(b), s.addChild(S), s.addChild(y)
        }), s
    }, t.a = b
}, function (e, t, i) {
    "use strict";
    var n = i(696),
        r = i(697),
        a = i(1117),
        o = i(893),
        s = i(114),
        u = {};
    u.Renderer = n.default, u.View = r.default, u.Viewer = a.a, u.Scene = o.a, u.InputGroups = s.a, t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(36),
        r = i(10),
        a = i(612),
        o = i(5),
        s = i.n(o),
        u = i(315),
        l = i(863),
        c = i(862),
        h = i(12),
        d = i(406),
        f = i(363),
        p = i(178),
        m = i(613),
        g = i(320),
        v = i(292),
        _ = i(118),
        b = i(885),
        S = i(697),
        x = i(848),
        y = i(1118),
        C = i(895),
        T = i(899),
        w = i(900),
        M = i(901),
        E = i(1119),
        A = i(1120),
        P = i(1121),
        R = i(1122),
        O = i(1123),
        I = i(1124),
        F = i(1125),
        N = i(575),
        D = i(616),
        L = i(615),
        k = function (e, t, i) {
            S.default.call(this), this._startTick = u.a.instance().tick(), this._stats = void 0, this._running = !1, this._canvas = e;
            var n = this.initOptions(t),
                r = this.initWebGLContext(e, n, i);
            if (!r) throw "No WebGL implementation found";
            this._updateVisitor = new c.a, this.setUpView(r.canvas, n), this.initInputManager(n, e), this.initStats(n, e), this._hmd = null, this._requestAnimationFrame = window.requestAnimationFrame.bind(window), this._options = n, this._contextLost = !1, this._forceRestoreContext = !0, this.renderBinded = this.render.bind(this)
        };
    h.a.createPrototypeObject(k, h.a.objectInherit(S.default.prototype, {
        initInputManager: function (e, t) {
            var i = new E.a;
            this._inputManager = i, this._initInputSource(A.a, "Mouse", t, e), this._initInputSource(P.a, "Keyboard", document, e), "ontouchstart" in window && this._initInputSource(F.a, "TouchScreen", t, e), this._initInputSource(R.a, "WebVR", void 0, e), this._initInputSource(I.a, "DeviceOrientation", void 0, e), navigator.getGamepads && this._initInputSource(O.a, "GamePad", void 0, e), i.addMappings({
                "viewer.internals:hmdConnect": "vrdisplayconnected"
            }, function (e) {
                this.setVRDisplay(e.vrDisplay)
            }.bind(this)), i.setParam("pixelRatio", [this._devicePixelRatio, this._devicePixelRatio])
        },
        _initInputSource: function (e, t, i, n) {
            var r = n.InputSources ? n.InputSources[t] : void 0;
            if (r) {
                if (!1 !== r.enable) {
                    var a = r.sourceElement || i;
                    this._inputManager.registerInputSource(new e(a, r))
                }
            } else this._inputManager.registerInputSource(new e(i))
        },
        getInputManager: function () {
            return this._inputManager
        },
        initOptions: function (e) {
            var t = new a.a;
            return e && t.extend(e), t.extendWithOptionsURL(), !0 === t.getBoolean("traceLogCall") && (n.a.traceLogCall = !0), !0 === t.getBoolean("enableFrustumCulling") && this.getCamera().getRenderer().getCullVisitor().setEnableFrustumCulling(!0), t
        },
        initWebGLContext: function (e, t, i) {
            t.get("SimulateWebGLLostContext") && (e = y.a.makeLostContextSimulatingCanvas(e), e.loseContextInNCalls(t.get("SimulateWebGLLostContext")), this._canvas = e);
            var r = x.a.setupWebGL(e, t, i);
            return e.addEventListener("webglcontextlost", function (e) {
                this.contextLost(), !1 !== this._forceRestoreContext && e.preventDefault()
            }.bind(this), !1), e.addEventListener("webglcontextrestored", function () {
                this.contextRestored()
            }.bind(this), !1), (n.a.reportWebGLError || t.get("reportWebGLError")) && (r = y.a.makeDebugContext(r)), this.initWebGLCaps(r), this.setGraphicContext(r), r
        },
        setContextLostCallback: function (e) {
            this._contextLostCallback = e, this._contextLost && (this._forceRestoreContext = e())
        },
        setContextRestoreCallback: function (e) {
            this._contextRestoreCallback = e
        },
        contextLost: function () {
            n.a.log("webgl context lost"), this._contextLostCallback && (this._forceRestoreContext = this._contextLostCallback()), this._contextLost = !0, window.cancelAnimationFrame(this._requestID)
        },
        contextRestored: function () {
            if (!1 === this._forceRestoreContext) return void n.a.log("webgl context restore not supported - please reload the page - ");
            this.restoreContext(), n.a.log("webgl context restored")
        },
        restoreContext: function () {
            var e = this.getGraphicContext();
            g.a.onLostContext(e), v.a.onLostContext(e), p.a.onLostContext(e), m.a.onLostContext(e), f.a.onLostContext(e), _.default.getTextureManager(e).onLostContext(e), d.a.onLostContext(e), this.getCamera().getRenderer().getState().resetCaches(), this.initWebGLCaps(e, !0), this.setGraphicContext(e), l.a.instance(this.getGraphicContext(), !0), this._stats && this._stats.reset(), this._contextLost = !1, this._requestRedraw = !0, this._contextRestoreCallback && this._contextRestoreCallback(e), this._runImplementation()
        },
        init: function () {},
        getUpdateVisitor: function () {
            return this._updateVisitor
        },
        getState: function () {
            return this.getCamera().getRenderer().getState()
        },
        initStats: function (e) {
            var t = l.a.instance(this.getGraphicContext());
            if (!e.getBoolean("stats")) return void t.disable();
            this._stats = new C.a(this, e), this._stats.addConfig(T.a), this._stats.addConfig(w.a), this._stats.addConfig(M.a), this.getCamera().addChild(this._stats.getNode()), t.setCallback(this.callbackTimerGPU.bind(this))
        },
        callbackTimerGPU: function (e, t) {
            this._stats && this._stats.getCounter(t).set(e / 1e6)
        },
        getViewerStats: function () {
            return this._stats
        },
        renderingTraversal: function () {
            if (this.getState()._frameStamp = this._frameStamp, this.getScene().getSceneData() && this.getScene().getSceneData().getBound(), this.getCamera()) {
                var e = this._stats,
                    t = l.a.instance(this.getGraphicContext()),
                    i = this.getCamera().getRenderer();
                if (e && e.getCounter("cull").start(), i.cull(), e && e.getCounter("cull").end(), t.pollQueries(), t.start("glframe"), e && e.getCounter("render").start(), i.draw(), e && e.getCounter("render").end(), t.end("glframe"), e) {
                    var n = i.getCullVisitor();
                    e.getCounter("cullcamera").set(n._numCamera), e.getCounter("cullmatrixtransform").set(n._numMatrixTransform), e.getCounter("cullprojection").set(n._numProjection), e.getCounter("cullnode").set(n._numNode), e.getCounter("culllightsource").set(n._numLightSource), e.getCounter("cullgeometry").set(n._numGeometry), e.getCounter("pushstateset").set(i.getState()._numPushStateSet), e.getCounter("applyStateSet").set(i.getState()._numApply)
                }
            }
        },
        updateTraversal: function () {
            var e = this._stats;
            e && e.getCounter("update").start(), this._updateVisitor.resetStats(), this.getScene().updateSceneGraph(this._updateVisitor), e && e.getCounter("updatecallback").set(this._updateVisitor._numUpdateCallback), this.getDatabasePager().releaseGLExpiredSubgraphs(.005), this.flushDeletedGLObjects(.005), e && e.getCounter("update").end()
        },
        advance: function (e) {
            var t = e;
            void 0 === t && (t = Number.MAX_VALUE);
            var i = this._frameStamp,
                n = i.getFrameNumber();
            i.setFrameNumber(n + 1);
            var r = u.a.instance().deltaS(this._startTick, u.a.instance().tick());
            i.setReferenceTime(r);
            var a = i.getSimulationTime();
            i.setSimulationTime(t === Number.MAX_VALUE ? r : t), i.setDeltaTime(i.getSimulationTime() - a)
        },
        beginFrame: function () {
            var e = this._stats;
            e && (e.getCounter("frame").start(), e.getCounter("raf").tick(), e.getCounter("fps").frame())
        },
        endFrame: function () {
            var e = this.getFrameStamp().getFrameNumber();
            this._stats && (_.default.getTextureManager(this.getGraphicContext()).updateStats(e, this._stats), this._stats.getCounter("stats").start(), this._stats.update(), this._stats.getCounter("stats").end(), this._stats.getCounter("frame").end())
        },
        checkNeedToDoFrame: function () {
            return this._requestContinousUpdate || this._requestRedraw
        },
        frame: function () {
            if (!this._contextLost) {
                this.beginFrame(), this.advance();
                var e = this.updateViewport();
                this._inputManager.update(), this._updateVisitor.setFrameStamp(this.getFrameStamp()), this.getManipulator() && (this.getManipulator().update(this._updateVisitor), r.c.copy(this.getCamera().getViewMatrix(), this.getManipulator().getInverseMatrix())), (this.checkNeedToDoFrame() || e) && (this._requestRedraw = !1, this.updateTraversal(), this.renderingTraversal()), this.endFrame(), this._hmd && this._hmd.isPresenting && this._hmd.submitFrame()
            }
        },
        stop: function () {
            this._running = !1
        },
        isRunning: function () {
            return this._running
        },
        render: function () {
            this.isRunning() && (this._requestID = this._requestAnimationFrame(this.renderBinded, this._canvas), this.frame())
        },
        _runImplementation: function () {
            this.render()
        },
        run: function () {
            this.isRunning() || (this._running = !0, this._runImplementation())
        },
        setVRDisplay: function (e) {
            this._hmd = e
        },
        getVRDisplay: function () {
            return this._hmd
        },
        setPresentVR: function (e) {
            if (!this._hmd) return n.a.warn("no hmd device provided to the viewer!"), s.a.reject();
            if (!this._hmd.capabilities.canPresent) return s.a.reject();
            if (e) {
                this._requestAnimationFrame = this._hmd.requestAnimationFrame.bind(this._hmd);
                var t = [{
                    source: this.getGraphicContext().canvas
                }];
                return this._hmd.requestPresent(t)
            }
            return this._requestAnimationFrame = window.requestAnimationFrame.bind(window), this._hmd.exitPresent()
        },
        setupManipulator: function (e) {
            void 0 === e && (e = new b.a({
                inputManager: this._inputManager
            })), void 0 !== e.setNode ? e.setNode(this.getSceneData()) : e.view = this, e.setCamera(this.getCamera()), this.setManipulator(e)
        },
        updateViewport: function () {
            var e = this.getGraphicContext(),
                t = e.canvas;
            if (!this.computeCanvasSize(t)) return !1;
            var i = this.getCamera(),
                n = i.getViewport(),
                a = n.width(),
                o = n.height(),
                s = t.width / a,
                u = t.height / o,
                l = s / u;
            return n.setViewport(Math.round(n.x() * s), Math.round(n.y() * u), Math.round(n.width() * s), Math.round(n.height() * u)), 1 !== l && r.c.mul(i.getProjectionMatrix(), i.getProjectionMatrix(), r.c.fromScaling(r.c.create(), [1 / l, 1, 1])), !0
        },
        setManipulator: function (e) {
            this.setEnableManipulator(!1), e.getCamera() || e.setCamera(this.getCamera()), e.setEnable(!0), S.default.prototype.setManipulator.call(this, e)
        },
        setEnableManipulator: function (e) {
            this._manipulator && this._manipulator.setEnable(e)
        },
        dispose: function () {
            N.a.clean(), D.a.clean(), L.a.pooledStateGraph.clean()
        }
    }), "osgViewer", "Viewer"), t.a = k
}, function (e, t, i) {
    "use strict";
    var n = function () {
        function e(e) {
            if (null == f) {
                f = {}, p = {};
                for (var t in e) "number" == typeof e[t] && (f[e[t]] = t, p[t] = e[t])
            }
        }

        function t() {
            if (null == f) throw "WebGLDebugUtils.init(ctx) not called"
        }

        function i(e) {
            return t(), void 0 !== f[e]
        }

        function n(e) {
            t();
            var i = f[e];
            return void 0 !== i ? "gl." + i : "/*UNKNOWN WebGL ENUM*/ 0x" + e.toString(16)
        }

        function r(e, t, i, r) {
            var a = d[e];
            if (void 0 !== a) {
                var a = a[t];
                if (void 0 !== a && a[i]) {
                    if ("object" == typeof a[i] && void 0 !== a[i].enumBitwiseOr) {
                        for (var o = a[i].enumBitwiseOr, s = 0, u = [], l = 0; l < o.length; ++l) {
                            var c = p[o[l]];
                            0 != (r & c) && (s |= c, u.push(n(c)))
                        }
                        return s === r ? u.join(" | ") : n(r)
                    }
                    return n(r)
                }
            }
            return null === r ? "null" : void 0 === r ? "undefined" : r.toString()
        }

        function a(e, t) {
            for (var i = "", n = t.length, a = 0; a < n; ++a) i += (0 == a ? "" : ", ") + r(e, n, a, t[a]);
            return i
        }

        function o(e, t, i) {
            e.__defineGetter__(i, function () {
                return t[i]
            }), e.__defineSetter__(i, function (e) {
                t[i] = e
            })
        }

        function s(t, i, a, u) {
            function l(e, t) {
                return function () {
                    a && a(t, arguments);
                    var n = e[t].apply(e, arguments),
                        r = u.getError();
                    return 0 != r && (c[r] = !0, i(r, t, arguments)), n
                }
            }
            u = u || t, e(t), i = i || function (e, t, i) {
                for (var a = "", o = i.length, s = 0; s < o; ++s) a += (0 == s ? "" : ", ") + r(t, o, s, i[s]);
                h("WebGL error " + n(e) + " in " + t + "(" + a + ")")
            };
            var c = {},
                d = {};
            for (var f in t)
                if ("function" == typeof t[f])
                    if ("getExtension" != f) d[f] = l(t, f);
                    else {
                        var p = l(t, f);
                        d[f] = function () {
                            var e = p.apply(t, arguments);
                            return e ? s(e, i, a, u) : null
                        }
                    }
            else o(d, t, f);
            return d.getError = function () {
                for (var e in c)
                    if (c.hasOwnProperty(e) && c[e]) return c[e] = !1, e;
                return t.NO_ERROR
            }, d
        }

        function u(e) {
            var t = !!e.createTransformFeedback;
            t && e.bindVertexArray(null);
            var i = e.getParameter(e.MAX_VERTEX_ATTRIBS),
                n = e.createBuffer();
            e.bindBuffer(e.ARRAY_BUFFER, n);
            for (var r = 0; r < i; ++r) e.disableVertexAttribArray(r), e.vertexAttribPointer(r, 4, e.FLOAT, !1, 0, 0), e.vertexAttrib1f(r, 0), t && e.vertexAttribDivisor(r, 0);
            e.deleteBuffer(n);
            for (var a = e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS), r = 0; r < a; ++r) e.activeTexture(e.TEXTURE0 + r), e.bindTexture(e.TEXTURE_CUBE_MAP, null), e.bindTexture(e.TEXTURE_2D, null), t && (e.bindTexture(e.TEXTURE_2D_ARRAY, null), e.bindTexture(e.TEXTURE_3D, null), e.bindSampler(r, null));
            if (e.activeTexture(e.TEXTURE0), e.useProgram(null), e.bindBuffer(e.ARRAY_BUFFER, null), e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, null), e.bindFramebuffer(e.FRAMEBUFFER, null), e.bindRenderbuffer(e.RENDERBUFFER, null), e.disable(e.BLEND), e.disable(e.CULL_FACE), e.disable(e.DEPTH_TEST), e.disable(e.DITHER), e.disable(e.SCISSOR_TEST), e.blendColor(0, 0, 0, 0), e.blendEquation(e.FUNC_ADD), e.blendFunc(e.ONE, e.ZERO), e.clearColor(0, 0, 0, 0), e.clearDepth(1), e.clearStencil(-1), e.colorMask(!0, !0, !0, !0), e.cullFace(e.BACK), e.depthFunc(e.LESS), e.depthMask(!0), e.depthRange(0, 1), e.frontFace(e.CCW), e.hint(e.GENERATE_MIPMAP_HINT, e.DONT_CARE), e.lineWidth(1), e.pixelStorei(e.PACK_ALIGNMENT, 4), e.pixelStorei(e.UNPACK_ALIGNMENT, 4), e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL, !1), e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !1), e.UNPACK_COLORSPACE_CONVERSION_WEBGL && e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL, e.BROWSER_DEFAULT_WEBGL), e.polygonOffset(0, 0), e.sampleCoverage(1, !1), e.scissor(0, 0, e.canvas.width, e.canvas.height), e.stencilFunc(e.ALWAYS, 0, 4294967295), e.stencilMask(4294967295), e.stencilOp(e.KEEP, e.KEEP, e.KEEP), e.viewport(0, 0, e.canvas.width, e.canvas.height), e.clear(e.COLOR_BUFFER_BIT | e.DEPTH_BUFFER_BIT | e.STENCIL_BUFFER_BIT), t) {
                e.drawBuffers([e.BACK]), e.readBuffer(e.BACK), e.bindBuffer(e.COPY_READ_BUFFER, null), e.bindBuffer(e.COPY_WRITE_BUFFER, null), e.bindBuffer(e.PIXEL_PACK_BUFFER, null), e.bindBuffer(e.PIXEL_UNPACK_BUFFER, null);
                for (var o = e.getParameter(e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS), r = 0; r < o; ++r) e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER, r, null);
                for (var s = e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS), r = 0; r < s; ++r) e.bindBufferBase(e.UNIFORM_BUFFER, r, null);
                e.disable(e.RASTERIZER_DISCARD), e.pixelStorei(e.UNPACK_IMAGE_HEIGHT, 0), e.pixelStorei(e.UNPACK_SKIP_IMAGES, 0), e.pixelStorei(e.UNPACK_ROW_LENGTH, 0), e.pixelStorei(e.UNPACK_SKIP_ROWS, 0), e.pixelStorei(e.UNPACK_SKIP_PIXELS, 0), e.pixelStorei(e.PACK_ROW_LENGTH, 0), e.pixelStorei(e.PACK_SKIP_ROWS, 0), e.pixelStorei(e.PACK_SKIP_PIXELS, 0), e.hint(e.FRAGMENT_SHADER_DERIVATIVE_HINT, e.DONT_CARE)
            }
            for (; e.getError(););
        }

        function l(e) {
            function t(e) {
                return "function" == typeof e ? e : function (t) {
                    e.handleEvent(t)
                }
            }

            function i() {
                for (var e = Object.keys(y), t = 0; t < e.length; ++t) delete y[e[t]]
            }

            function n() {
                ++b, g || _ == b && e.loseContext()
            }

            function r(e, t) {
                var i = e[t];
                return function () {
                    if (n(), !g) {
                        return i.apply(e, arguments)
                    }
                }
            }

            function a() {
                for (var e = 0; e < v.length; ++e) {
                    var t = v[e];
                    t instanceof WebGLBuffer ? c.deleteBuffer(t) : t instanceof WebGLFramebuffer ? c.deleteFramebuffer(t) : t instanceof WebGLProgram ? c.deleteProgram(t) : t instanceof WebGLRenderbuffer ? c.deleteRenderbuffer(t) : t instanceof WebGLShader ? c.deleteShader(t) : t instanceof WebGLTexture ? c.deleteTexture(t) : d && (t instanceof WebGLQuery ? c.deleteQuery(t) : t instanceof WebGLSampler ? c.deleteSampler(t) : t instanceof WebGLSync ? c.deleteSync(t) : t instanceof WebGLTransformFeedback ? c.deleteTransformFeedback(t) : t instanceof WebGLVertexArrayObject && c.deleteVertexArray(t))
                }
            }

            function s(e) {
                return {
                    statusMessage: e,
                    preventDefault: function () {
                        S = !0
                    }
                }
            }

            function l(e) {
                for (var t in e) "function" == typeof e[t] ? h[t] = r(e, t) : o(h, e, t);
                h.getError = function () {
                    if (n(), !g)
                        for (var e; e = c.getError();) y[e] = !0;
                    for (var e in y)
                        if (y[e]) return delete y[e], e;
                    return h.NO_ERROR
                };
                var i = ["createBuffer", "createFramebuffer", "createProgram", "createRenderbuffer", "createShader", "createTexture"];
                d && i.push("createQuery", "createSampler", "fenceSync", "createTransformFeedback", "createVertexArray");
                for (var a = 0; a < i.length; ++a) {
                    var s = i[a];
                    h[s] = function (t) {
                        return function () {
                            if (n(), g) return null;
                            var i = t.apply(e, arguments);
                            return i.__webglDebugContextLostId__ = m, v.push(i), i
                        }
                    }(e[s])
                }
                var u = ["getActiveAttrib", "getActiveUniform", "getBufferParameter", "getContextAttributes", "getAttachedShaders", "getFramebufferAttachmentParameter", "getParameter", "getProgramParameter", "getProgramInfoLog", "getRenderbufferParameter", "getShaderParameter", "getShaderInfoLog", "getShaderSource", "getTexParameter", "getUniform", "getUniformLocation", "getVertexAttrib"];
                d && u.push("getInternalformatParameter", "getQuery", "getQueryParameter", "getSamplerParameter", "getSyncParameter", "getTransformFeedbackVarying", "getIndexedParameter", "getUniformIndices", "getActiveUniforms", "getActiveUniformBlockParameter", "getActiveUniformBlockName");
                for (var a = 0; a < u.length; ++a) {
                    var s = u[a];
                    h[s] = function (t) {
                        return function () {
                            return n(), g ? null : t.apply(e, arguments)
                        }
                    }(h[s])
                }
                var l = ["isBuffer", "isEnabled", "isFramebuffer", "isProgram", "isRenderbuffer", "isShader", "isTexture"];
                d && l.push("isQuery", "isSampler", "isSync", "isTransformFeedback", "isVertexArray");
                for (var a = 0; a < l.length; ++a) {
                    var s = l[a];
                    h[s] = function (t) {
                        return function () {
                            return n(), !g && t.apply(e, arguments)
                        }
                    }(h[s])
                }
                return h.checkFramebufferStatus = function (t) {
                    return function () {
                        return n(), g ? h.FRAMEBUFFER_UNSUPPORTED : t.apply(e, arguments)
                    }
                }(h.checkFramebufferStatus), h.getAttribLocation = function (t) {
                    return function () {
                        return n(), g ? -1 : t.apply(e, arguments)
                    }
                }(h.getAttribLocation), h.getVertexAttribOffset = function (t) {
                    return function () {
                        return n(), g ? 0 : t.apply(e, arguments)
                    }
                }(h.getVertexAttribOffset), h.isContextLost = function () {
                    return g
                }, d && (h.getFragDataLocation = function (t) {
                    return function () {
                        return n(), g ? -1 : t.apply(e, arguments)
                    }
                }(h.getFragDataLocation), h.clientWaitSync = function (t) {
                    return function () {
                        return n(), g ? h.WAIT_FAILED : t.apply(e, arguments)
                    }
                }(h.clientWaitSync), h.getUniformBlockIndex = function (t) {
                    return function () {
                        return n(), g ? h.INVALID_INDEX : t.apply(e, arguments)
                    }
                }(h.getUniformBlockIndex)), h
            }
            var c, h, d, f = [],
                p = [],
                h = {},
                m = 1,
                g = !1,
                v = [],
                _ = 0,
                b = 0,
                S = !1,
                x = 0,
                y = {};
            e.getContext = function (t) {
                return function () {
                    var i = t.apply(e, arguments);
                    if (i instanceof WebGLRenderingContext || window.WebGL2RenderingContext && i instanceof WebGL2RenderingContext) {
                        if (i != c) {
                            if (c) throw "got different context";
                            d = window.WebGL2RenderingContext && i instanceof WebGL2RenderingContext, c = i, h = l(c)
                        }
                        return h
                    }
                    return i
                }
            }(e.getContext);
            var C = function (e) {
                    f.push(t(e))
                },
                T = function (e) {
                    p.push(t(e))
                };
            return function (e) {
                var t = e.addEventListener;
                e.addEventListener = function (i, n, r) {
                    switch (i) {
                        case "webglcontextlost":
                            C(n);
                            break;
                        case "webglcontextrestored":
                            T(n);
                            break;
                        default:
                            t.apply(e, arguments)
                    }
                }
            }(e), e.loseContext = function () {
                if (!g) {
                    for (g = !0, _ = 0, ++m; c.getError(););
                    i(), y[c.CONTEXT_LOST_WEBGL] = !0;
                    var t = s("context lost"),
                        n = f.slice();
                    setTimeout(function () {
                        for (var i = 0; i < n.length; ++i) n[i](t);
                        x >= 0 && setTimeout(function () {
                            e.restoreContext()
                        }, x)
                    }, 0)
                }
            }, e.restoreContext = function () {
                g && p.length && setTimeout(function () {
                    if (!S) throw "can not restore. webglcontestlost listener did not call event.preventDefault";
                    a(), u(c), g = !1, b = 0, S = !1;
                    for (var e = p.slice(), t = s("context restored"), i = 0; i < e.length; ++i) e[i](t)
                }, 0)
            }, e.loseContextInNCalls = function (e) {
                if (g) throw "You can not ask a lost contet to be lost";
                _ = b + e
            }, e.getNumCalls = function () {
                return b
            }, e.setRestoreTimeout = function (e) {
                x = e
            }, e
        }
        var c = function (e) {
                window.console && window.console.log && window.console.log(e)
            },
            h = function (e) {
                window.console && window.console.error ? window.console.error(e) : c(e)
            },
            d = {
                enable: {
                    1: {
                        0: !0
                    }
                },
                disable: {
                    1: {
                        0: !0
                    }
                },
                getParameter: {
                    1: {
                        0: !0
                    }
                },
                drawArrays: {
                    3: {
                        0: !0
                    }
                },
                drawElements: {
                    4: {
                        0: !0,
                        2: !0
                    }
                },
                createShader: {
                    1: {
                        0: !0
                    }
                },
                getShaderParameter: {
                    2: {
                        1: !0
                    }
                },
                getProgramParameter: {
                    2: {
                        1: !0
                    }
                },
                getShaderPrecisionFormat: {
                    2: {
                        0: !0,
                        1: !0
                    }
                },
                getVertexAttrib: {
                    2: {
                        1: !0
                    }
                },
                vertexAttribPointer: {
                    6: {
                        2: !0
                    }
                },
                bindTexture: {
                    2: {
                        0: !0
                    }
                },
                activeTexture: {
                    1: {
                        0: !0
                    }
                },
                getTexParameter: {
                    2: {
                        0: !0,
                        1: !0
                    }
                },
                texParameterf: {
                    3: {
                        0: !0,
                        1: !0
                    }
                },
                texParameteri: {
                    3: {
                        0: !0,
                        1: !0,
                        2: !0
                    }
                },
                copyTexImage2D: {
                    8: {
                        0: !0,
                        2: !0
                    }
                },
                copyTexSubImage2D: {
                    8: {
                        0: !0
                    }
                },
                generateMipmap: {
                    1: {
                        0: !0
                    }
                },
                bindBuffer: {
                    2: {
                        0: !0
                    }
                },
                getBufferParameter: {
                    2: {
                        0: !0,
                        1: !0
                    }
                },
                pixelStorei: {
                    2: {
                        0: !0,
                        1: !0
                    }
                },
                bindRenderbuffer: {
                    2: {
                        0: !0
                    }
                },
                bindFramebuffer: {
                    2: {
                        0: !0
                    }
                },
                checkFramebufferStatus: {
                    1: {
                        0: !0
                    }
                },
                framebufferRenderbuffer: {
                    4: {
                        0: !0,
                        1: !0,
                        2: !0
                    }
                },
                framebufferTexture2D: {
                    5: {
                        0: !0,
                        1: !0,
                        2: !0
                    }
                },
                getFramebufferAttachmentParameter: {
                    3: {
                        0: !0,
                        1: !0,
                        2: !0
                    }
                },
                getRenderbufferParameter: {
                    2: {
                        0: !0,
                        1: !0
                    }
                },
                renderbufferStorage: {
                    4: {
                        0: !0,
                        1: !0
                    }
                },
                clear: {
                    1: {
                        0: {
                            enumBitwiseOr: ["COLOR_BUFFER_BIT", "DEPTH_BUFFER_BIT", "STENCIL_BUFFER_BIT"]
                        }
                    }
                },
                depthFunc: {
                    1: {
                        0: !0
                    }
                },
                blendFunc: {
                    2: {
                        0: !0,
                        1: !0
                    }
                },
                blendFuncSeparate: {
                    4: {
                        0: !0,
                        1: !0,
                        2: !0,
                        3: !0
                    }
                },
                blendEquation: {
                    1: {
                        0: !0
                    }
                },
                blendEquationSeparate: {
                    2: {
                        0: !0,
                        1: !0
                    }
                },
                stencilFunc: {
                    3: {
                        0: !0
                    }
                },
                stencilFuncSeparate: {
                    4: {
                        0: !0,
                        1: !0
                    }
                },
                stencilMaskSeparate: {
                    2: {
                        0: !0
                    }
                },
                stencilOp: {
                    3: {
                        0: !0,
                        1: !0,
                        2: !0
                    }
                },
                stencilOpSeparate: {
                    4: {
                        0: !0,
                        1: !0,
                        2: !0,
                        3: !0
                    }
                },
                cullFace: {
                    1: {
                        0: !0
                    }
                },
                frontFace: {
                    1: {
                        0: !0
                    }
                },
                drawArraysInstancedANGLE: {
                    4: {
                        0: !0
                    }
                },
                drawElementsInstancedANGLE: {
                    5: {
                        0: !0,
                        2: !0
                    }
                },
                blendEquationEXT: {
                    1: {
                        0: !0
                    }
                },
                bufferData: {
                    3: {
                        0: !0,
                        2: !0
                    },
                    4: {
                        0: !0,
                        2: !0
                    },
                    5: {
                        0: !0,
                        2: !0
                    }
                },
                bufferSubData: {
                    3: {
                        0: !0
                    },
                    4: {
                        0: !0
                    },
                    5: {
                        0: !0
                    }
                },
                copyBufferSubData: {
                    5: {
                        0: !0,
                        1: !0
                    }
                },
                getBufferSubData: {
                    3: {
                        0: !0
                    },
                    4: {
                        0: !0
                    },
                    5: {
                        0: !0
                    }
                },
                blitFramebuffer: {
                    10: {
                        8: {
                            enumBitwiseOr: ["COLOR_BUFFER_BIT", "DEPTH_BUFFER_BIT", "STENCIL_BUFFER_BIT"]
                        },
                        9: !0
                    }
                },
                framebufferTextureLayer: {
                    5: {
                        0: !0,
                        1: !0
                    }
                },
                invalidateFramebuffer: {
                    2: {
                        0: !0
                    }
                },
                invalidateSubFramebuffer: {
                    6: {
                        0: !0
                    }
                },
                readBuffer: {
                    1: {
                        0: !0
                    }
                },
                getInternalformatParameter: {
                    3: {
                        0: !0,
                        1: !0,
                        2: !0
                    }
                },
                renderbufferStorageMultisample: {
                    5: {
                        0: !0,
                        2: !0
                    }
                },
                texStorage2D: {
                    5: {
                        0: !0,
                        2: !0
                    }
                },
                texStorage3D: {
                    6: {
                        0: !0,
                        2: !0
                    }
                },
                texImage2D: {
                    9: {
                        0: !0,
                        2: !0,
                        6: !0,
                        7: !0
                    },
                    6: {
                        0: !0,
                        2: !0,
                        3: !0,
                        4: !0
                    },
                    10: {
                        0: !0,
                        2: !0,
                        6: !0,
                        7: !0
                    }
                },
                texImage3D: {
                    10: {
                        0: !0,
                        2: !0,
                        7: !0,
                        8: !0
                    },
                    11: {
                        0: !0,
                        2: !0,
                        7: !0,
                        8: !0
                    }
                },
                texSubImage2D: {
                    9: {
                        0: !0,
                        6: !0,
                        7: !0
                    },
                    7: {
                        0: !0,
                        4: !0,
                        5: !0
                    },
                    10: {
                        0: !0,
                        6: !0,
                        7: !0
                    }
                },
                texSubImage3D: {
                    11: {
                        0: !0,
                        8: !0,
                        9: !0
                    },
                    12: {
                        0: !0,
                        8: !0,
                        9: !0
                    }
                },
                copyTexSubImage3D: {
                    9: {
                        0: !0
                    }
                },
                compressedTexImage2D: {
                    7: {
                        0: !0,
                        2: !0
                    },
                    8: {
                        0: !0,
                        2: !0
                    },
                    9: {
                        0: !0,
                        2: !0
                    }
                },
                compressedTexImage3D: {
                    8: {
                        0: !0,
                        2: !0
                    },
                    9: {
                        0: !0,
                        2: !0
                    },
                    10: {
                        0: !0,
                        2: !0
                    }
                },
                compressedTexSubImage2D: {
                    8: {
                        0: !0,
                        6: !0
                    },
                    9: {
                        0: !0,
                        6: !0
                    },
                    10: {
                        0: !0,
                        6: !0
                    }
                },
                compressedTexSubImage3D: {
                    10: {
                        0: !0,
                        8: !0
                    },
                    11: {
                        0: !0,
                        8: !0
                    },
                    12: {
                        0: !0,
                        8: !0
                    }
                },
                vertexAttribIPointer: {
                    5: {
                        2: !0
                    }
                },
                drawArraysInstanced: {
                    4: {
                        0: !0
                    }
                },
                drawElementsInstanced: {
                    5: {
                        0: !0,
                        2: !0
                    }
                },
                drawRangeElements: {
                    6: {
                        0: !0,
                        4: !0
                    }
                },
                readPixels: {
                    7: {
                        4: !0,
                        5: !0
                    },
                    8: {
                        4: !0,
                        5: !0
                    }
                },
                clearBufferfv: {
                    3: {
                        0: !0
                    },
                    4: {
                        0: !0
                    }
                },
                clearBufferiv: {
                    3: {
                        0: !0
                    },
                    4: {
                        0: !0
                    }
                },
                clearBufferuiv: {
                    3: {
                        0: !0
                    },
                    4: {
                        0: !0
                    }
                },
                clearBufferfi: {
                    4: {
                        0: !0
                    }
                },
                beginQuery: {
                    2: {
                        0: !0
                    }
                },
                endQuery: {
                    1: {
                        0: !0
                    }
                },
                getQuery: {
                    2: {
                        0: !0,
                        1: !0
                    }
                },
                getQueryParameter: {
                    2: {
                        1: !0
                    }
                },
                samplerParameteri: {
                    3: {
                        1: !0,
                        2: !0
                    }
                },
                samplerParameterf: {
                    3: {
                        1: !0
                    }
                },
                getSamplerParameter: {
                    2: {
                        1: !0
                    }
                },
                fenceSync: {
                    2: {
                        0: !0,
                        1: {
                            enumBitwiseOr: []
                        }
                    }
                },
                clientWaitSync: {
                    3: {
                        1: {
                            enumBitwiseOr: ["SYNC_FLUSH_COMMANDS_BIT"]
                        }
                    }
                },
                waitSync: {
                    3: {
                        1: {
                            enumBitwiseOr: []
                        }
                    }
                },
                getSyncParameter: {
                    2: {
                        1: !0
                    }
                },
                bindTransformFeedback: {
                    2: {
                        0: !0
                    }
                },
                beginTransformFeedback: {
                    1: {
                        0: !0
                    }
                },
                transformFeedbackVaryings: {
                    3: {
                        2: !0
                    }
                },
                bindBufferBase: {
                    3: {
                        0: !0
                    }
                },
                bindBufferRange: {
                    5: {
                        0: !0
                    }
                },
                getIndexedParameter: {
                    2: {
                        0: !0
                    }
                },
                getActiveUniforms: {
                    3: {
                        2: !0
                    }
                },
                getActiveUniformBlockParameter: {
                    3: {
                        2: !0
                    }
                }
            },
            f = null,
            p = null;
        return {
            init: e,
            mightBeEnum: i,
            glEnumToString: n,
            glFunctionArgToString: r,
            glFunctionArgsToString: a,
            makeDebugContext: s,
            makeLostContextSimulatingCanvas: l,
            resetToInitialState: u
        }
    }();
    t.a = n
}, function (e, t, i) {
    "use strict";
    var n = i(36),
        r = ["shift", "alt", "ctrl", "meta"],
        a = function (e, t) {
            this._enabled = !0, this._name = t, this._mask = [], this._events = {}, this._mappings = {}, this._inputManager = e, this._boundCallback = this._collectNativeEvents.bind(this), this._priority = 10, this._hasSources = !1
        };
    a.prototype = {
        addMappings: function (e, t) {
            for (var i in e) e[this._name + ":" + i] = e[i], delete e[i];
            this._inputManager.addMappings(e, t)
        },
        _collectNativeEvents: function (e) {
            if (this._enabled && !this._mask.length) {
                var t = this._mappings[e.type];
                if (t)
                    for (var i = 0; i < t.length; i++) {
                        var n = t[i];
                        if (!n._source.isEventRegistered || n._source.isEventRegistered(e, n._parsedEvent)) {
                            if (n._source.populateEvent(e, n), n._nativeEvents || (n._nativeEvents = []), !n._nativeEvents.length) {
                                var r = this._inputManager._queues[n._priority];
                                r || (r = [], this._inputManager._queues[n._priority] = r), r.push(n)
                            }
                            n._nativeEvents.push(e)
                        }
                    }
            }
        },
        _addEvent: function (e, t) {
            var i, n = this._name + ":" + t,
                r = !1,
                a = this._mappings[e.name];
            a ? i = this._findEvent(a, n, e.raw) : (a = [], this._mappings[e.name] = a, r = !0);
            var o = this._events[t];
            o || (o = [], this._events[t] = o), i || (i = new Event(n), a.push(i), o.push(i)), i._parsedEvent = e, i._priority = 10;
            var s = this._inputManager._getSource(e.name);
            s && (this._enabled && r && s.setEnable(e.name, this._boundCallback, !0), this._hasSources = !0, i._source = s)
        },
        _findEvent: function (e, t, i) {
            for (var n = 0; n < e.length; n++) {
                var r = e[n];
                if (r.type === t && r._parsedEvent.raw === i) return r
            }
        },
        _setEnable: function (e) {
            this._enabled = e;
            for (var t in this._mappings) {
                var i = this._mappings[t],
                    n = i[0];
                n._source && n._source.setEnable(t, this._boundCallback, e)
            }
        }
    };
    var o = function () {
        this._groups = {}, this._sources = [], this._queues = [], this._queues[10] = [], this._callbacks = {}, this._params = {}, this._maskedGroups = [], window.dumpInputGroups = this._dumpInputGroups.bind(this), window.dumpEventSequence = this._dumpEventSequence.bind(this)
    };
    o.prototype = {
        registerInputSource: function (e) {
            if (!e.setEnable || !e.supportsEvent || !e.getName) throw "Invalid input target " + JSON.stringify(e);
            this._sources.push(e), e.setInputManager(this)
        },
        getInputSource: function (e) {
            for (var t = 0; t < this._sources.length; t++) {
                var i = this._sources[t];
                if (i.getName() === e) return i
            }
        },
        addMappings: function (e, t) {
            for (var i in e) {
                var n = e[i],
                    r = i.split(":");
                if (2 !== r.length) throw "Mapping should be of the form 'group:methodName': ['nativeevent1’, 'nativeevent2',...] ";
                var a, o = this._getOrCreateGroup(r[0]),
                    s = r[1];
                if (t)
                    if ("object" == typeof t) {
                        if (!(a = t[s]) || "function" != typeof a) throw "Cannot find method " + s + " on " + t;
                        a = a.bind(t)
                    } else {
                        if ("function" != typeof t) throw "Invalid listener " + t;
                        a = t
                    } var u;
                if ("string" == typeof n) u = this._parseNativeEvent(n), o._addEvent(u, s);
                else
                    for (var l = 0; l < n.length; l++) {
                        var c = n[l];
                        u = this._parseNativeEvent(c), o._addEvent(u, s)
                    }
                this._callbacks[o._name + ":" + s] = a
            }
        },
        group: function (e) {
            return this._getOrCreateGroup(e)
        },
        setEnable: function (e, t) {
            var i = this._groups[e];
            i && i._setEnable(t);
            var n;
            for (var r in this._groups) i = this._groups[r], t ? (n = i._mask.indexOf(e)) >= 0 && (i._mask.splice(n, 1), this._maskedGroups.splice(this._maskedGroups.indexOf(e), 1)) : 0 === (n = i._name.indexOf(e)) && "." === i._name[n + e.length] && (i._mask.push(e), this._maskedGroups.push(e));
            if (!t)
                for (var a = 0; a < this._queues.length; a++) {
                    var o = this._queues[a];
                    if (o)
                        for (var s = o.length - 1; s >= 0; s--) {
                            var u = o[s];
                            u.type.indexOf(e) >= 0 && (o.splice(s, 1), u._nativeEvents.length = 0)
                        }
                }
        },
        setPriority: function (e, t) {
            var i = e.split(":");
            if (t < 0) throw "priority must be a positive number";
            var n, r, a, o = this._groups[i[0]];
            if (o && i[1]) {
                for (r = o._events[i[1]], a = 0; a < r.length; a++) n = r[a], n._priority = t;
                o._priority > t && (o._priority = t)
            } else
                for (var s in this._groups)
                    if (o = this._groups[s], o._name.indexOf(e) >= 0)
                        for (var u in o._events)
                            for (r = o._events[u], a = 0; a < r.length; a++) n = r[a], n._priority = t
        },
        getHigherPriority: function (e) {
            var t = 10;
            for (var i in this._groups) {
                var n = this._groups[i];
                n._name.indexOf(e) >= 0 && n._priority < t && (t = n._priority)
            }
            return t > 0 ? t - 1 : 0
        },
        getParam: function (e) {
            return this._params[e]
        },
        setParam: function (e, t) {
            this._params[e] = t
        },
        cleanup: function () {
            for (var e in this._groups) {
                this._groups[e]._setEnable(!1)
            }
        },
        _parseNativeEvent: function (e) {
            var t = e.split(" "),
                i = {};
            i.name = t[0];
            var n;
            for (n = 1; n < t.length; n++) {
                var a = t[n],
                    o = !0;
                0 === a.indexOf("!") && (o = !1, a = a.substring(1, a.length)), r.indexOf(a) >= 0 ? i[a] = o : i.action = a.toLowerCase()
            }
            if (i.action)
                for (n = 0; n < r.length; n++) {
                    var s = r[n];
                    0 === i.action.indexOf(s) && (i[s] = !0)
                }
            return 0 === i.name.indexOf("key") && !i.action && t.length > 1 && (i.action = t[t.length - 1]), i.raw = e, i
        },
        _getOrCreateGroup: function (e) {
            var t = this._groups[e];
            if (!t) {
                t = new a(this, e), this._groups[e] = t;
                for (var i = 0; i < this._maskedGroups.length; i++) {
                    var n = this._maskedGroups[i];
                    0 === e.indexOf(n) && t._mask.push(n)
                }
            }
            return t
        },
        update: function () {
            var e;
            for (e = 0; e < this._sources.length; e++) {
                var t = this._sources[e];
                t.poll && t.poll()
            }
            for (e = 0; e < this._queues.length; e++) {
                var i = this._queues[e];
                if (i) {
                    for (var n = 0; n < i.length; n++) {
                        var r = i[n];
                        this._callbacks[r.type](r), r._nativeEvents.length = 0
                    }
                    i.length = 0
                }
            }
        },
        _getSource: function (e) {
            for (var t = 0; t < this._sources.length; t++) {
                var i = this._sources[t];
                if (i.supportsEvent(e)) return i
            }
        },
        _dumpInputGroups: function (e, t) {
            !0 === e && (t = e, e = void 0);
            for (var i in this._groups)
                if (!(e && i.indexOf(e) < 0)) {
                    var r = this._groups[i],
                        a = r._enabled && !r._mask.length && r._hasSources;
                    if (!t || a) {
                        n.a.groupCollapsed("%c" + i + (a ? " (enabled)" : " (disabled)"), a ? "" : "color: #888888"), n.a.log("enabled:", r._enabled), n.a.log("masks:", r._mask), n.a.log("input sources:", r._hasSources), n.a.group("events");
                        for (var o in r._events) {
                            n.a.groupCollapsed(o);
                            for (var s = r._events[o], u = 0; u < s.length; u++) {
                                var l = s[u],
                                    c = "%c" + l._parsedEvent.raw + " (" + (l._source ? l._source.getName() : "unknown source") + ")",
                                    h = l._source ? "" : "color: #888888";
                                n.a.log(c, h)
                            }
                            n.a.groupCollapsed("function"), n.a.log(this._callbacks[r._name + ":" + o]), n.a.groupEnd(), n.a.groupEnd()
                        }
                        n.a.groupEnd(), n.a.groupEnd()
                    }
                }
        },
        _dumpEventSequence: function (e, t) {
            var i = [];
            !0 === e && (t = e, e = void 0);
            var r;
            for (var a in this._groups) {
                var o = this._groups[a];
                if (r = o._enabled && !o._mask.length && o._hasSources, !t || r)
                    for (var s in o._events) {
                        var u = o._events[s],
                            l = i[u[0]._priority];
                        l || (l = [], i[u[0]._priority] = l);
                        for (var c = 0; c < u.length; c++) {
                            var h = u[c];
                            (!e || e && h._parsedEvent.raw.indexOf(e) >= 0) && l.push({
                                name: h.type,
                                group: o._name,
                                on: h._parsedEvent.raw,
                                enabled: o._enabled && !o._mask.length && !!h._source,
                                source: h._source ? "(" + h._source.getName() + ")" : "(unknown source)"
                            })
                        }
                    }
            }
            for (var d = 0; d < i.length; d++) {
                var f = i[d];
                if (f) {
                    n.a.group("priority " + d);
                    for (var p, m = 0; m < f.length; m++) {
                        var g = f[m];
                        if (0 !== m && p !== g.name && n.a.groupEnd(), p !== g.name) {
                            var v = this._groups[g.group];
                            r = v._enabled && !v._mask.length && v._hasSources, n.a.groupCollapsed("%c" + g.name, r ? "" : "color:#888888")
                        }
                        p = g.name, n.a.groupCollapsed("%c" + g.on + " " + g.source, g.enabled ? "" : "color:#888888"), n.a.log(this._callbacks[g.name]), n.a.groupEnd()
                    }
                    n.a.groupEnd(), n.a.groupEnd()
                }
            }
        }
    }, t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(454),
        a = i(10),
        o = 0 === navigator.platform.indexOf("Mac") ? -1 : -3,
        s = function (e, t) {
            r.a.call(this, e), this._defaultRatio = a.e.fromValues(1, 1), this._supportedEvents = ["click", "contextmenu", "dblclick", "mousedown", "mouseenter", "mouseleave", "mousemove", "mouseover", "mouseout", "mouseup"], t && !1 === t.scrollwheel || this._supportedEvents.push("wheel")
        };
    n.a.createPrototypeObject(s, n.a.objectInherit(r.a.prototype, {
        getName: function () {
            return "Mouse"
        },
        setEnable: function (e, t, i) {
            i ? this._target.addEventListener(e, t) : this._target.removeEventListener(e, t)
        },
        populateEvent: function (e, t) {
            t.canvasX = void 0 === e.offsetX ? e.layerX : e.offsetX, t.canvasY = void 0 === e.offsetY ? e.layerY : e.offsetY;
            var i = this._inputManager.getParam("pixelRatio");
            i || (i = this._defaultRatio), t.glX = t.canvasX * i[0], t.glY = (this._target.clientHeight - t.canvasY) * i[1], t.clientX = e.clientX, t.clientY = e.clientY, t.screenX = e.screenX, t.screenX = e.screenX, t.pageX = e.pageX, t.pageY = e.pageY, t.ctrlKey = e.ctrlKey, t.shiftKey = e.shiftKey, t.altKey = e.altKey, t.metaKey = e.metaKey, t.button = e.button, t.buttons = e.buttons, "wheel" === e.type && (void 0 !== e.wheelDelta ? t.deltaY = e.wheelDelta / 120 : 1 === e.deltaMode ? t.deltaY = e.deltaY / o : t.deltaY = e.deltaY / (10 * o), t.deltaMode = e.deltaMode, t.deltaX = e.deltaX, t.deltaZ = e.deltaZ)
        },
        isEventRegistered: function (e, t) {
            return (!t.action || e.button === parseInt(t.action)) && ((void 0 === t.ctrl || e.ctrlKey === t.ctrl) && ((void 0 === t.shift || e.shiftKey === t.shift) && ((void 0 === t.alt || e.altKey === t.alt) && ((void 0 === t.meta || e.metaKey === t.meta) && (e.preventDefault(), !0)))))
        }
    }), "osgViewer", "InputSourceMouse"), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(454),
        a = function (e) {
            r.a.call(this, e), this._supportedEvents = ["keydown", "keyup", "keypress"]
        };
    n.a.createPrototypeObject(a, n.a.objectInherit(r.a.prototype, {
        getName: function () {
            return "Keyboard"
        },
        setEnable: function (e, t, i) {
            i ? this._target.addEventListener(e, t) : this._target.removeEventListener(e, t)
        },
        populateEvent: function (e, t) {
            t.key = e.key, t.keyCode = e.keyCode, t.code = e.code, t.location = e.location, t.repeat = e.repeat, t.ctrlKey = e.ctrlKey, t.shiftKey = e.shiftKey, t.altKey = e.altKey, t.metaKey = e.metaKey
        },
        isEventRegistered: function (e, t) {
            if (!t.action) return !0;
            if (e.key) return e.key.toLowerCase() === t.action && ((void 0 === t.ctrl || e.ctrlKey === t.ctrl) && ((void 0 === t.shift || e.shiftKey === t.shift) && ((void 0 === t.alt || e.altKey === t.alt) && ((void 0 === t.meta || e.metaKey === t.meta) && (e.preventDefault(), !0)))))
        }
    }), "osgViewer", "InputSourceKeyboard"), t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(454),
        a = i(36),
        o = function (e, t) {
            r.a.call(this), this._supportedEvents = ["vrdisplayposechanged", "vrdisplayconnected", "vrdisplaynotfound", "vrdisplaydisconnected"], this._callbacks = {}, this._events = {};
            for (var i = 0; i < this._supportedEvents.length; i++) {
                var n = this._supportedEvents[i],
                    a = new Event(n);
                this._events[n] = a
            }
            this._nbCallbacks = 0, this._pollInterval = t && void 0 !== t.pollInterval ? t.pollInterval : 3e3
        };
    n.a.createPrototypeObject(o, n.a.objectInherit(r.a.prototype, {
        getName: function () {
            return "WebVR"
        },
        setEnable: function (e, t, i) {
            var n = this._callbacks[e];
            n || (n = [], this._callbacks[e] = n);
            var r = n.indexOf(t);
            i ? r < 0 && (n.push(t), this._nbCallbacks++, this._schedulePolling()) : r >= 0 && (n.splice(r, 1), --this._nbCallbacks || this._cancelPolling())
        },
        populateEvent: function (e, t) {
            if (e.vrDisplay) return void(t.vrDisplay = e.vrDisplay);
            t.pose = e.pose, t.sitToStandMatrix = e.sitToStandMatrix, t.worldFactor = this._inputManager.getParam("worldFactor"), t.worldFactor || (t.worldFactor = 1)
        },
        _schedulePolling: function () {
            this._pollInterval > 0 && void 0 === this._pollingTimeout && (this._pollingTimeout = setInterval(this.pollHeadset.bind(this), this._pollInterval))
        },
        _cancelPolling: function () {
            void 0 !== this._pollingTimeout && clearInterval(this._pollingTimeout)
        },
        pollHeadset: function () {
            if (!navigator.getVRDisplays) return this._hmd = void 0, this._frameData = void 0, void this.triggerNotFoundEvent();
            var e = this;
            navigator.getVRDisplays().then(function (t) {
                if (0 === t.length) return void this.triggerNotFoundEvent();
                if (e._hmd !== t[0]) {
                    a.a.log("Found a VR display");
                    var i = e._events.vrdisplaydisconnected;
                    i.vrDisplay = e._hmd, this._dispatchEvent(i, e._callbacks.vrdisplaydisconnected), i = e._events.vrdisplayconnected, i.vrDisplay = t[0], this._dispatchEvent(i, e._callbacks.vrdisplayconnected), e._hmd = t[0], e._frameData = new window.VRFrameData
                }
            }.bind(this)).catch(function (e) {
                this._hmd = void 0, this._frameData = void 0, this.triggerNotFoundEvent(), a.a.warn(e.message)
            })
        },
        triggerNotFoundEvent: function () {
            if (!(this._pollInterval > 0)) {
                var e = this._events.vrdisplaynotfound;
                this._dispatchEvent(e, this._callbacks.vrdisplaynotfound)
            }
        },
        setPollInterval: function (e) {
            this._pollInterval = e
        },
        _dispatchEvent: function (e, t) {
            if (t)
                for (var i = 0; i < t.length; i++) {
                    var n = t[i];
                    n(e)
                }
        },
        poll: function () {
            if (this._hmd) {
                var e = this._callbacks.vrdisplayposechanged;
                if (e && e.length) {
                    this._hmd.getFrameData(this._frameData);
                    var t = this._frameData.pose;
                    if (t) {
                        var i = this._hmd.stageParameters && this._hmd.stageParameters.sittingToStandingTransform,
                            n = this._events.vrdisplayposechanged;
                        n.pose = t, n.sitToStandMatrix = i, this._dispatchEvent(n, e)
                    }
                }
            }
        }
    }), "osgViewer", "InputSourceWebVR"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(454),
        a = function () {
            r.a.call(this), this._target = window, this._supportedEvents = ["buttondown", "buttonup", "buttonvalue", "axis", "gamepadconnected", "gamepaddisconnected"], this._callbacks = {}, this._nbCallbacks = 0, this._gamePadState = [], this._valueThreshold = .05, window.addEventListener("gamepadconnected", function (e) {
                this._newGamePad(e.gamepad), this._onConnectionStateChange(e, "gamepadconnected")
            }.bind(this)), window.addEventListener("gamepaddisconnected", function (e) {
                this._previousState[e.gamepad.index] = void 0, this._onConnectionStateChange(e, "gamepaddisconnected")
            }.bind(this))
        };
    n.a.createPrototypeObject(a, n.a.objectInherit(r.a.prototype, {
        getName: function () {
            return "GamePad"
        },
        setEnable: function (e, t, i) {
            var n = this._callbacks[e];
            n || (n = [], this._callbacks[e] = n);
            var r = n.indexOf(t);
            i ? r < 0 && (n.push(t), this._nbCallbacks++) : r >= 0 && (n.splice(r, 1), this._nbCallbacks--)
        },
        _onConnectionStateChange: function (e, t) {
            var i = this._callbacks[t];
            i && i(e)
        },
        _newGamePad: function (e) {
            var t = {
                buttons: []
            };
            t._buttonEvents = [], t._axisEvents = [];
            var i;
            for (i = 0; i < e.buttons.length; i++) t._buttonEvents[i] = {
                buttondown: this._initEvent("buttondown", i, e.index, "button"),
                buttonup: this._initEvent("buttonup", i, e.index, "button"),
                buttonvalue: this._initEvent("buttonvalue", i, e.index, "button")
            };
            for (i = 0; i < e.axes.length; i++) t._axisEvents[i] = {
                axis: this._initEvent("axis", i, e.index, "axis")
            };
            this._gamePadState[e.index] = t
        },
        setValueThreshold: function (e) {
            this._valueThreshold = e
        },
        _initEvent: function (e, t, i, n) {
            var r = new Event(e);
            return r[n] = t, r.gamepadIndex = i, r
        },
        populateEvent: function (e, t) {
            t.gamepadIndex = e.gamepadIndex, void 0 !== e.button && (t.button = e.button, t.value = e.value), void 0 !== e.axis && (t.axis = e.axis, t.value = e.value)
        },
        isEventRegistered: function (e, t) {
            if (!t.action) return !0;
            var i = parseInt(t.action);
            return (void 0 === e.button || e.button === i) && (void 0 === e.axis || e.axis === i)
        },
        _fireCallbacks: function (e, t) {
            for (var i = 0; i < e.length; i++) e[i](t)
        },
        poll: function () {
            if (this._nbCallbacks) {
                var e = navigator.getGamepads();
                if (e)
                    for (var t = 0; t < e.length; t++) {
                        var i = e[t];
                        if (i) {
                            var n = this._gamePadState[t];
                            if (n) {
                                var r = this._callbacks.buttondown,
                                    a = this._callbacks.buttonup,
                                    o = this._callbacks.buttonvalue;
                                if (r || a || o)
                                    for (var s = 0; s < i.buttons.length; s++) {
                                        var u = i.buttons[s],
                                            l = n._buttonEvents[s].buttondown;
                                        l.value = u.value;
                                        var c = n._buttonEvents[s].buttonup;
                                        if (c.value = u.value, u.pressed && !n.buttons[s] && (r && r.length && this._fireCallbacks(r, l), n.buttons[s] = u.pressed), !u.pressed && n.buttons[s] && (a && a.length && this._fireCallbacks(a, c), n.buttons[s] = !1), u.pressed && o && o.length) {
                                            var h = n._buttonEvents[s].buttonvalue;
                                            h.value = u.value, Math.abs(u.value) >= this._valueThreshold && this._fireCallbacks(o, h)
                                        }
                                    }
                                var d = this._callbacks.axis;
                                if (d)
                                    for (s = 0; s < i.axes.length; s++) {
                                        var f = i.axes[s],
                                            p = n._axisEvents[s].axis;
                                        p.value = f, Math.abs(f) >= this._valueThreshold && this._fireCallbacks(d, p)
                                    }
                            }
                        }
                    }
            }
        }
    }), "osgViewer", "InputSourceGamePad"), t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(454),
        a = function () {
            r.a.call(this), this._target = window, this._callbacks = [], this._nbCallbacks = 0, this._event = new Event("deviceorientation"), this._supportedEvents = ["deviceorientation", "orientationchange"], this._update = this.onDeviceOrientation.bind(this)
        };
    n.a.createPrototypeObject(a, n.a.objectInherit(r.a.prototype, {
        getName: function () {
            return "DeviceOrientation"
        },
        setEnable: function (e, t, i) {
            if ("orientationchange" === e) return void(i ? this._target.addEventListener(e, t) : this._target.removeEventListener(e, t));
            var n = this._callbacks,
                r = n.indexOf(t);
            i ? r < 0 && (n.push(t), this._nbCallbacks++) : r >= 0 && (n.splice(r, 1), this._nbCallbacks--), 1 === this._nbCallbacks && window.addEventListener(e, this._update), 0 === this._nbCallbacks && window.removeEventListener(e, this._update)
        },
        onDeviceOrientation: function (e) {
            this.populateEvent(e, this._event)
        },
        populateEvent: function (e, t) {
            t.absolute = e.absolute, t.alpha = e.alpha, t.beta = e.beta, t.gamma = e.gamma, t.screenOrientation = window.orientation
        },
        isEventRegistered: function (e) {
            if ("deviceorientation" === e.type) {
                if (null === e.alpha || void 0 === e.alpha) return !1
            } else if (null === window.orientation || void 0 === window.orientation) return !1;
            return !0
        },
        poll: function () {
            if (this._nbCallbacks)
                for (var e = 0; e < this._callbacks.length; e++) this._callbacks[e](this._event)
        }
    }), "osgViewer", "InputSourceDeviceOrientation"), t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(454),
        a = i(692),
        o = i.n(a),
        s = i(10),
        u = function (e) {
            r.a.call(this, e), this._defaultRatio = s.e.fromValues(1, 1), this._hammerEvents = ["pan", "pinch", "press", "rotate", "swipe", "doubletap", "doubletap2fingers", "singletap"], this._supportedEvents = ["touchstart", "touchend", "touchcancel", "touchmove"], this._hammer = new o.a.Manager(e), this._hammer.add(new o.a.Pan), this._hammer.add(new o.a.Pinch), this._hammer.get("pan").set({
                threshold: 0,
                pointers: 0
            });
            var t = this._hammer.get("pinch");
            t.set({
                threshold: .1,
                enable: !1
            }), t.recognizeWith(this._hammer.get("pan")), this._hammer.add(new o.a.Tap({
                event: "doubletap",
                pointers: 1,
                taps: 2,
                time: 250,
                interval: 450,
                threshold: 5,
                posThreshold: 50
            })), this._hammer.add(new o.a.Tap({
                event: "doubletap2fingers",
                pointers: 2,
                taps: 2,
                time: 250,
                interval: 450,
                threshold: 5,
                posThreshold: 50
            })), this._hammer.add(new o.a.Tap({
                event: "singletap",
                pointers: 1,
                taps: 1,
                time: 250,
                interval: 450,
                threshold: 5,
                posThreshold: 20
            }))
        };
    n.a.createPrototypeObject(u, n.a.objectInherit(r.a.prototype, {
        getName: function () {
            return "TouchScreen"
        },
        setEnable: function (e, t, i) {
            this._isNativeEvent(e) ? i ? this._target.addEventListener(e, t) : this._target.removeEventListener(e, t) : (e.indexOf("pinch") >= 0 && i && this._hammer.get("pinch").set({
                enable: !0
            }), i ? this._hammer.on(e, t) : this._hammer.off(e, t))
        },
        populateEvent: function (e, t) {
            if (this._isNativeEvent(e.type)) {
                t.canvasX = t.canvasY = 0;
                for (var i = e.touches.length ? e.touches : e.changedTouches, n = i.length, r = 0; r < n; ++r) t.canvasX += i[r].clientX / n, t.canvasY += i[r].clientY / n;
                t.ctrlKey = e.ctrlKey, t.shiftKey = e.shiftKey, t.altKey = e.altKey, t.metaKey = e.metaKey, t.pointers = e.touches
            } else t.canvasX = e.center.x, t.canvasY = e.center.y, t.scale = e.scale, t.rotation = e.rotation, t.deltaX = e.deltaX, t.deltaY = e.deltaY, t.deltaTime = e.deltaTime, t.direction = e.direction, t.offsetDirection = e.offsetDirection, t.pointers = e.pointers, t.velocity = e.velocity;
            var a = this._target.getBoundingClientRect();
            t.canvasX += -a.left, t.canvasY += -a.top;
            var o = this._inputManager.getParam("pixelRatio");
            o || (o = this._defaultRatio), t.glX = t.canvasX * o[0], t.glY = (this._target.clientHeight - t.canvasY) * o[1]
        },
        _isNativeEvent: function (e) {
            return this._supportedEvents.indexOf(e) >= 0
        },
        isEventRegistered: function (e, t) {
            if (e.preventDefault(), e.pointerType && "touch" !== e.pointerType) return !1;
            if (!t.action) return !0;
            if (isNaN(t.action)) throw "touch action should be a number representing the number of touches";
            var i = e.pointers;
            i || (i = e.touches);
            var n = parseInt(t.action);
            if ("touchend" === e.type || "touchcancel" === e.type) {
                if (i.length >= n) return !1
            } else if (i.length !== n) return !1;
            return !0
        },
        supportsEvent: function (e) {
            var t = r.a.prototype.supportsEvent.call(this, e);
            if (t) return t;
            for (var i = 0; i < this._hammerEvents.length; i++) {
                var n = this._hammerEvents[i];
                if (0 === e.indexOf(n)) return !0
            }
            return !1
        },
        getHammer: function () {
            return this._hammer
        }
    }), "osgViewer", "InputSourceTouchScreen"), t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(902),
        r = i(903),
        a = i(1127),
        o = i(904),
        s = i(1128),
        u = i(905),
        l = i(1129),
        c = i(699),
        h = i(700),
        d = i(906),
        f = i(1130),
        p = {};
    p.ShadowCastAttribute = n.a, p.ShadowReceiveAttribute = u.a, p.ShadowCasterVisitor = r.a, p.ShadowFrustumIntersection = a.a, p.ShadowMap = o.a, p.ShadowMapAtlas = s.a, p.ShadowedScene = f.a, p.ShadowSettings = l.a, p.ShadowTechnique = c.a, p.ShadowTexture = h.a, p.ShadowTextureAtlas = d.a, t.a = p
}, function (e, t, i) {
    "use strict";
    var n = i(317),
        r = i(447),
        a = i(197),
        o = i(160),
        s = i(619),
        u = i(10),
        l = i(318),
        c = i(290),
        h = i(198),
        d = i(84),
        f = i(450),
        p = i(12),
        m = function () {
            d.a.call(this, d.a.TRAVERSE_ALL_CHILDREN), this._pooledMatrix = new l.a(u.c.create), this._matrixStack = new c.a, this._matrixStack.push(u.c.IDENTITY), this._bb = new n.a, this._bs = new r.a
        };
    p.a.createPrototypeObject(m, p.a.objectInherit(d.a.prototype, {
        reset: function (e, t, i, n, r) {
            this.setTraversalMask(e), this._cameraFrustum = i, this._lightFrustum = r, this.getCameraPlaneMaskForLightNear(t, i, n ? 6 : 4), this._pooledMatrix.reset(), this._matrixStack.reset(), this._matrixStack.push(u.c.IDENTITY), this._bb.init()
        },
        getBoundingBox: function () {
            return this._bb
        },
        getCameraPlaneMaskForLightNear: function (e, t, i) {
            var n, r = 1,
                a = 15;
            for (n = 0; n < i; ++n) a = a << 1 | 1;
            var o = t.getPlanes();
            for (n = 0; n < i; ++n) f.a.distanceToPlane(o[n], e) < 0 && (a ^= r), r <<= 1;
            return this._cameraPlaneMaskedByLightNear = a, t.setResultMask(a), t.pushCurrentMask(a), a
        },
        applyTransform: function (e) {
            var t = this._pooledMatrix.getOrCreateObject();
            u.c.copy(t, this._matrixStack.back()), e.computeLocalToWorldMatrix(t, this);
            var i = this._bs;
            e.getBound().transformMat4(this._bs, t), (0 === this._cameraFrustum.getCurrentMask() || this._cameraFrustum.containsBoundingSphere(i)) && (0 === this._lightFrustum.getCurrentMask() || this._lightFrustum.containsBoundingSphere(i)) && (this._cameraFrustum.pushCurrentMask(), this._lightFrustum.pushCurrentMask(), this.pushMatrix(t), this.traverse(e), this._cameraFrustum.popCurrentMask(), this._lightFrustum.popCurrentMask(), this.popMatrix())
        },
        applyBoundingBox: function () {
            var e = new n.a;
            return function (t) {
                var i = this._matrixStack.back();
                u.c.exactEquals(i, u.c.IDENTITY) ? this._bb.expandByBoundingBox(t) : t.valid() && (t.transformMat4(e, i), this._bb.expandByBoundingBox(e))
            }
        }(),
        apply: function (e) {
            var t = e.getTypeID();
            if (e instanceof h.a) return void this.applyTransform(e);
            if (t === o.a.getTypeID()) {
                var i = this._bs;
                if (e.getBound().transformMat4(i, this._matrixStack.back()), 0 !== this._cameraFrustum.getCurrentMask() && !this._cameraFrustum.containsBoundingSphere(i)) return;
                if (0 !== this._lightFrustum.getCurrentMask() && !this._lightFrustum.containsBoundingSphere(i)) return;
                return void this.applyBoundingBox(e.getBoundingBox())
            }
            t === a.a.getTypeID() || s.a.getTypeID(), this.traverse(e)
        },
        pushMatrix: function (e) {
            this._matrixStack.push(e)
        },
        popMatrix: function () {
            this._matrixStack.pop()
        }
    }), "osgShadow", "ComputeMultiFrustumBoundsVisitor"), t.a = m
}, function (e, t, i) {
    "use strict";
    var n = i(36),
        r = i(10),
        a = i(197),
        o = i(12),
        s = i(699),
        u = i(906),
        l = i(904),
        c = i(118),
        h = i(363),
        d = i(108),
        f = i(421),
        p = function (e) {
            this._lights = [], this._shadowMaps = [], this._viewportDimension = [], s.a.apply(this, arguments), this._shadowSettings = e, this._texture = new u.a, this._textureUnitBase = 4, this._textureUnit = this._textureUnitBase, this._textureMagFilter = void 0, this._textureMinFilter = void 0, this._textureSize = 1024, this._shadowMapSize = 256, this._receivingStateset = void 0, e && (this.setShadowSettings(e), e.atlasSize && (this._textureSize = e.atlasSize), e.textureSize && (this._shadowMapSize = e.textureSize)), this._texelSizeUniform = d.a.createFloat1(1 / this._textureSize, "texelSize");
            var t = d.a.createFloat2("RenderSize");
            this._renderSize = t.getInternalArray(), this._renderSize[0] = this._renderSize[1] = this._textureSize, this._numShadowWidth = this._textureSize / this._shadowMapSize, this._numShadowHeight = this._textureSize / this._shadowMapSize, this._cameraClear = new a.a, this._cameraClear.setName("shadowAtlasCameraClear"), this._cameraClear.setRenderOrder(a.a.PRE_RENDER, 0), this._cameraClear.setClearColor(r.g.fromValues(1, 1, 1, 1)), this._cameraClear.setFrameBufferObject(new h.a), this._cameraClear.setClearMask(0)
        };
    o.a.createPrototypeObject(p, o.a.objectInherit(s.a.prototype, {
        getTexture: function () {
            return this._texture
        },
        isDirty: function (e) {
            if (void 0 !== e) return this._shadowMaps[e].isDirty();
            for (var t = 0, i = this._shadowMaps.length; t < i; t++)
                if (this._shadowMaps[t].isDirty()) return !0;
            return !1
        },
        setTextureUnitBase: function (e) {
            this._textureUnitBase = e, this._textureUnit = e;
            for (var t = 0, i = this._shadowMaps.length; t < i; t++) this._shadowMaps[t].setTextureUnitBase(e)
        },
        setShadowSettings: function (e) {
            if (e) {
                this._shadowSettings = e;
                for (var t = 0, i = this._shadowMaps.length; t < i; t++) this._shadowMaps[t].setShadowSettings(e);
                this.setTextureSize(e.textureSize), this.setTexturePrecision(e.textureType)
            }
        },
        setCastsShadowDrawTraversalMask: function (e) {
            for (var t = 0, i = this._shadowMaps.length; t < i; t++) this._shadowMaps[t].setCastsShadowDrawTraversalMask(e)
        },
        getCastsShadowDrawTraversalMask: function (e) {
            return void 0 !== e ? this._shadowMaps[e].getCastsShadowDrawTraversalMask() : 0 !== this._shadowMaps.length ? this._shadowMaps[0].getCastsShadowDrawTraversalMask() : void 0
        },
        setCastsShadowBoundsTraversalMask: function (e) {
            for (var t = 0, i = this._shadowMaps.length; t < i; t++) this._shadowMaps[t].setCastsShadowBoundsTraversalMask(e)
        },
        getCastsShadowBoundsTraversalMask: function (e) {
            return void 0 !== e ? this._shadowMaps[e].getCastsShadowDrawTraversalMask() : 0 !== this._shadowMaps.length ? this._shadowMaps[0].getCastsShadowDrawTraversalMask() : void 0
        },
        getNormalBias: function (e) {
            return void 0 !== e ? this._shadowMaps[e].getNormalBias() : 0 !== this._shadowMaps.length ? this._shadowMaps[0].getNormalBias() : void 0
        },
        setNormalBias: function (e) {
            for (var t = 0, i = this._shadowMaps.length; t < i; t++) this._shadowMaps[t].setNormalBias(e)
        },
        getBias: function (e) {
            return void 0 !== e ? this._shadowMaps[e].getBias() : 0 !== this._shadowMaps.length ? this._shadowMaps[0].getBias() : void 0
        },
        setBias: function (e) {
            for (var t = 0, i = this._shadowMaps.length; t < i; t++) this._shadowMaps[t].setBias(e)
        },
        getKernelSizePCF: function (e) {
            return void 0 !== e ? this._shadowMaps[e].getKernelSizePCF() : 1 !== this._shadowMaps.length ? this._shadowMaps[0].getKernelSizePCF() : void 0
        },
        setKernelSizePCF: function (e) {
            for (var t = 0, i = this._shadowMaps.length; t < i; t++) this._shadowMaps[t].setKernelSizePCF(e)
        },
        setShadowedScene: function (e) {
            s.a.prototype.setShadowedScene.call(this, e), this._receivingStateset = this._shadowedScene.getReceivingStateSet();
            for (var t = 0, i = this._shadowMaps.length; t < i; t++) this._shadowMaps[t].setShadowedScene(e)
        },
        setTexturePrecision: function (e) {
            for (var t = 0, i = this._shadowMaps.length; t < i; t++) this._shadowMaps[t].setTexturePrecision(e)
        },
        getTexturePrecision: function (e) {
            return void 0 !== e ? this._shadowMaps[e].getTexturePrecision() : 1 !== this._shadowMaps.length ? this._shadowMaps[0].getTexturePrecision() : void 0
        },
        setTextureSize: function (e) {
            e !== this._textureSize && (this._shadowMapSize = e, this._numShadowWidth = this._textureSize / this._shadowMapSize, this._numShadowHeight = this._textureSize / this._shadowMapSize, this.dirty())
        },
        getShadowMap: function (e) {
            return this._shadowMaps[e]
        },
        addLight: function (e) {
            if (!e || -1 !== this._lights.indexOf(e)) return n.a.warn("no light or light already added"), -1;
            if (this._lights.length === this._numShadowWidth * this._numShadowHeight) return void n.a.warn("can't allocate shadow for light " + e.getLightNumber() + " ShadowAtlas already full ");
            this._lights.push(e), this._shadowSettings.setLight(e);
            var t = new l.a(this._shadowSettings, this._texture);
            return this._shadowMaps.push(t), this._shadowedScene && t.setShadowedScene(this._shadowedScene), this.recomputeViewports(), t
        },
        init: function () {
            if (this._shadowedScene) {
                this.initTexture();
                for (var e = [], t = 0; t < this._lights.length; t++) e.push(this._lights[t].getLightNumber());
                this._texture.setLightNumberArray(e), this._textureUnit = this._textureUnitBase, this._texture.setName("ShadowTexture" + this._textureUnit);
                var i = d.a.createFloat2("RenderSize");
                this._texelSizeUniform = d.a.createFloat1(1 / this._textureSize, "texelSize"), this._renderSize = i.getInternalArray(), this._renderSize[0] = this._renderSize[1] = this._textureSize, this.recomputeViewports();
                for (var n = 0, r = this._shadowMaps.length; n < r; n++) {
                    var a = this._shadowMaps[n];
                    this._shadowedScene || (this._shadowedScene = a.getShadowedScene(this._shadowedScene)), this._shadowedScene && a.setShadowedScene(this._shadowedScene), a.init(this._texture, n, this._textureUnitBase)
                }
            }
        },
        recomputeViewports: function () {
            for (var e = this._shadowMaps.length, t = e > 2 ? Math.sqrt(2 * Math.ceil(e / 2)) : e, i = t, n = this._textureSize / i, a = this._textureSize / t, o = this._textureSize / n, s = this._textureSize / a, u = 0; u < e; u++) {
                var l = this._shadowMaps[u],
                    c = n * (u % o),
                    h = a * Math.floor(u / s);
                this._viewportDimension.length <= u ? this._viewportDimension.push(r.g.fromValues(c, h, n, a)) : r.g.set(this._viewportDimension[u], c, h, n, a), this._texture.setLightShadowMapSize(this._lights[u].getLightNumber(), this._viewportDimension[u]), l.dirty()
            }
        },
        valid: function () {
            return !0
        },
        updateCameraClear: function () {
            var e = this._cameraClear,
                t = this._texture;
            if (e && t) {
                var i = e.getViewport();
                i || (i = new f.a, e.setViewport(i)), i.width() === t.getWidth() && i.height() === t.getHeight() || (e.detachAll(), e.attachTexture(h.a.COLOR_ATTACHMENT0, t), e.attachRenderBuffer(h.a.DEPTH_ATTACHMENT, h.a.DEPTH_COMPONENT16), e.getViewport().setViewport(0, 0, t.getWidth(), t.getHeight()))
            }
        },
        updateShadowTechnique: function (e) {
            this.updateCameraClear();
            for (var t = this._cameraClear.getFrameBufferObject(), i = 0, n = this._shadowMaps.length; i < n; i++) this._shadowMaps[i].updateShadowTechnique(e, this._viewportDimension[i], t)
        },
        initTexture: function () {
            if (this._dirty) {
                this._texture || (this._texture = new u.a, this._textureUnit = this._textureUnitBase), this._texture.setTextureSize(this._textureSize, this._textureSize), this._texelSizeUniform.setFloat(1 / this._textureSize), this._renderSize[0] = this._textureSize, this._renderSize[1] = this._textureSize;
                var e;
                e = c.default.RGBA, l.a.prototype.setTextureFiltering.call(this), this._texture.setInternalFormat(e), this._texture.setWrapS(c.default.CLAMP_TO_EDGE), this._texture.setWrapT(c.default.CLAMP_TO_EDGE), this._texture.dirty()
            }
        },
        cullShadowCasting: function (e, t) {
            this._cameraClear.accept(e);
            for (var i = 0, n = this._shadowMaps.length; i < n; i++) {
                var r = this._shadowMaps[i];
                (r.isContinuousUpdate() || r.needRedraw()) && r.cullShadowCasting(e, t)
            }
        },
        isContinuousUpdate: function () {
            for (var e = 0, t = this._shadowMaps.length; e < t; e++)
                if (this._shadowMaps[e].isContinuousUpdate()) return !0;
            return !1
        },
        needRedraw: function () {
            for (var e = 0, t = this._shadowMaps.length; e < t; e++)
                if (this._shadowMaps[e].needRedraw()) return !0;
            return !1
        },
        removeShadowMap: function (e) {
            if (this._shadowMaps.length > 0) {
                var t = this._shadowMaps.indexOf(e);
                if (-1 !== t) {
                    this._shadowMaps[t].valid() && this._shadowMaps[t].cleanSceneGraph(!0), this._shadowMaps.splice(t, 1);
                    var i = this._texture.getLightNumberArray();
                    t = i.indexOf(e.getLightNumber()), -1 !== t && i.splice(t, 1);
                    var n = e.getLight();
                    t = this._lights.indexOf(n), -1 !== t && this._lights.splice(t, 1), this._viewportDimension.length > t && this._viewportDimension.splice(t, 1), this.recomputeViewports()
                }
            }
        },
        addShadowMap: function (e) {
            if (!(this._shadowMaps.length > 0 && -1 !== this._shadowMaps.indexOf(e))) {
                this._shadowMaps.push(e);
                var t = e.getLight(); - 1 === this._lights.indexOf(t) && this._lights.push(t), this._shadowedScene && e.setShadowedScene(this._shadowedScene);
                var i = this._texture.getLightNumberArray(); - 1 === i.indexOf(e.getLightNumber()) && i.push(t.getLightNumber()), this.recomputeViewports()
            }
        },
        cleanReceivingStateSet: function () {
            if (this._receivingStateset) {
                this._texture && this._receivingStateset.getTextureAttribute(this._textureUnit, this._texture.getTypeMember()) === this._texture && this._receivingStateset.removeTextureAttribute(this._textureUnit, this._texture.getTypeMember());
                for (var e = 0, t = this._shadowMaps.length; e < t; e++) this._shadowMaps[e].cleanReceivingStateSet()
            }
        },
        cleanSceneGraph: function () {
            this._texture = void 0, this._shadowedScene = void 0
        },
        setDebug: function (e, t) {
            if (t) this._shadowMaps[t].setDebug(e);
            else
                for (var i = 0, n = this._shadowMaps.length; i < n; i++) this._shadowMaps[i].setDebug(e)
        },
        markSceneAsNoShadow: function () {
            for (var e = 0, t = this._shadowMaps.length; e < t; e++) this._shadowMaps[e].markSceneAsNoShadow()
        }
    }), "osgShadow", "ShadowMapAtlas"), t.a = p
}, function (e, t, i) {
    "use strict";
    var n = i(12),
        r = i(118),
        a = ["1Tap(4texFetch)", "4Tap(16texFetch)", "9Tap(36texFetch)", "16Tap(64texFetch)"],
        o = function (e) {
            this.castsShadowDrawTraversalMask = 4294967295, this.castsShadowBoundsTraversalMask = 4294967295, this.textureSize = 1024, this.textureType = "UNSIGNED_BYTE", this.textureFormat = r.default.RGBA, this.shadowProjection = "fov", this.fov = 50, this.kernelSizePCF = "4Tap(4texFetch)", this.bias = .005, this.normalBias = void 0, this.shadowCastShaderGeneratorName = "ShadowCast", n.a.objectMix(this, e)
        };
    o.kernelSizeList = a, o.prototype = {
        setCastsShadowDrawTraversalMask: function (e) {
            this.castsShadowDrawTraversalMask = e
        },
        getCastsShadowDrawTraversalMask: function () {
            return this.castsDrawShadowTraversalMask
        },
        setCastsShadowBoundsTraversalMask: function (e) {
            this.castsShadowBoundsTraversalMask = e
        },
        getCastsShadowBoundsTraversalMask: function () {
            return this.castsShadowBoundsTraversalMask
        },
        setLight: function (e) {
            this.light = e
        },
        getLight: function () {
            return this.light
        },
        setTextureSize: function (e) {
            this.textureSize = e
        },
        getTextureSize: function () {
            return this.textureSize
        },
        setTextureType: function (e) {
            this.textureType = e
        },
        getTextureType: function () {
            return this.textureType
        },
        setTextureFormat: function (e) {
            this.textureFormat = e
        },
        getTextureFormat: function () {
            return this.textureFormat
        },
        setShadowCastShaderGeneratorName: function (e) {
            this.shadowCastShaderGeneratorName = e
        },
        getShadowCastShaderGeneratorName: function () {
            return this.shadowCastShaderGeneratorName
        }
    }, t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(574),
        r = i(10),
        a = i(137),
        o = i(84),
        s = i(288),
        u = i(12),
        l = i(611),
        c = i(903),
        h = function (e) {
            a.a.call(this), this._shadowTechniques = [], this._optimizedFrustum = !1, this._frustumReceivers = [r.g.create(), r.g.create(), r.g.create(), r.g.create(), r.g.create(), r.g.create()], this._tmpMat = r.c.create(), this._receivingStateset = new s.a, this._computeBoundsVisitor = new l.default, this._castsShadowDrawTraversalMask = 4294967295, this._castsShadowBoundsTraversalMask = 4294967295, e && this.setShadowSettings(e)
        };
    u.a.createPrototypeNode(h, u.a.objectInherit(a.a.prototype, {
        getReceivingStateSet: function () {
            return this._receivingStateset
        },
        getShadowTechniques: function () {
            return this._shadowTechniques
        },
        addShadowTechnique: function (e) {
            this._shadowTechniques.length > 0 && -1 !== this._shadowTechniques.indexOf(e) || (this._shadowTechniques.push(e), e.valid() && (e.setShadowedScene(this), e.dirty()))
        },
        removeShadowTechnique: function (e) {
            if (this._shadowTechniques.length > 0) {
                var t = this._shadowTechniques.indexOf(e); - 1 !== t && (this._shadowTechniques[t].valid() && this._shadowTechniques[t].cleanSceneGraph(), this._shadowTechniques.splice(t, 1))
            }
        },
        cleanSceneGraph: function () {
            for (var e = 0, t = this._shadowTechniques.length; e < t; e++) this._shadowTechniques[e] && this._shadowTechniques[e].valid() && this._shadowTechniques[e].cleanSceneGraph()
        },
        dirty: function () {
            for (var e = 0; e < this._shadowTechniques.length; e++) this._shadowTechniques[e].dirty()
        },
        nodeTraverse: function (e) {
            a.a.prototype.traverse.call(this, e)
        },
        setShadowSettings: function (e) {
            this._settings = e, this.setCastsShadowDrawTraversalMask(e.castsShadowDrawTraversalMask), this.setCastsShadowBoundsTraversalMask(e.castsShadowBoundsTraversalMask), !1 !== e.userShadowCasterVisitor && (this._removeNodesNeverCastingVisitor = e.userShadowCasterVisitor || new c.a(this._castsShadowTraversalMask))
        },
        setCastsShadowDrawTraversalMask: function (e) {
            this._castsShadowDrawTraversalMask = e
        },
        getCastsShadowDrawTraversalMask: function () {
            return this._castsDrawShadowTraversalMask
        },
        setCastsShadowBoundsTraversalMask: function (e) {
            this._castsShadowBoundsTraversalMask = e
        },
        getCastsShadowBoundsTraversalMask: function () {
            return this._castsShadowBoundsTraversalMask
        },
        computeShadowedSceneBounds: function () {
            return this._removeNodesNeverCastingVisitor && (this._removeNodesNeverCastingVisitor.setNoCastMask(~(this._castsShadowBoundsTraversalMask | this._castsShadowDrawTraversalMask)), this._removeNodesNeverCastingVisitor.reset(), this.accept(this._removeNodesNeverCastingVisitor)), this._computeBoundsVisitor.setTraversalMask(this._castsShadowBoundsTraversalMask), this._computeBoundsVisitor.reset(), this.accept(this._computeBoundsVisitor), !!this._computeBoundsVisitor.getBoundingBox().valid() || (this._removeNodesNeverCastingVisitor && this._removeNodesNeverCastingVisitor.restore(), !1)
        },
        traverse: function (e) {
            if (e.getVisitorType() === o.a.CULL_VISITOR) {
                var t, i, n = this._shadowTechniques.length;
                n && e.pushStateSet(this._receivingStateset), this.nodeTraverse(e), n && e.popStateSet();
                var r = !1;
                for (t = 0; t < n; t++)(i = this._shadowTechniques[t]) && i.valid() && (i.isDirty() && (r = !0, i.init()), (i.isContinuousUpdate() || i.needRedraw()) && (r = !0));
                if (!r) return;
                if (!this.computeShadowedSceneBounds(e)) {
                    for (t = 0; t < n; t++) i = this._shadowTechniques[t], i.markSceneAsNoShadow();
                    return
                }
                var a = this._computeBoundsVisitor.getBoundingBox(),
                    s = e.getCurrentModelMatrix();
                for (a.transformMat4(a, s), t = 0; t < n; t++) i = this._shadowTechniques[t], (i.isContinuousUpdate() || i.needRedraw()) && (i.updateShadowTechnique(e), i.cullShadowCasting(e, a));
                this._removeNodesNeverCastingVisitor && this._removeNodesNeverCastingVisitor.restore()
            } else this.nodeTraverse(e)
        }
    }), "osgShadow", "ShadowedScene"), n.a.registerApplyFunction(h.nodeTypeID, n.a.getApplyFunction(a.a.nodeTypeID)), t.a = h
}, function (e, t, i) {
    "use strict";
    var n = i(895),
        r = i(896),
        a = i(698),
        o = i(898),
        s = i(897),
        u = i(899),
        l = i(901),
        c = i(900),
        h = {
            Stats: n.a,
            BufferStats: r.a,
            Graph: a.a,
            TextGenerator: o.a,
            Counter: s.a,
            defaultStats: u.a,
            browserStats: l.a,
            glStats: c.a
        };
    t.a = h
}, function (e, t, i) {
    "use strict";
    var n = i(875),
        r = {};
    r.Text = n.a, t.a = r
}, function (e, t, i) {
    "use strict";
    var n = i(623),
        r = i(873),
        a = i(874),
        o = {};
    o.osg = n.a, o.osgAnimation = r.a, o.osgText = a.a, t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(1135),
        r = i(1136),
        a = {};
    a.ReaderWriterGLTF = n.a, a.ReaderWriterZIP = r.a, t.a = a
}, function (e, t, i) {
    "use strict";

    function n(e) {
        for (var t = window.atob(e), i = t.length, n = new Uint8Array(i), r = 0; r < i; r++) n[r] = t.charCodeAt(r);
        return n.buffer
    }
    var r = i(5),
        a = i.n(r),
        o = i(317),
        s = i(288),
        u = i(690),
        l = i(578),
        c = i(865),
        h = i(617),
        d = i(451),
        f = i(870),
        p = i(869),
        m = i(689),
        g = i(452),
        v = i(364),
        _ = i(453),
        b = i(620),
        S = i(36),
        x = i(137),
        y = i(160),
        C = i(118),
        T = i(198),
        w = i(362),
        M = i(449),
        E = i(448),
        A = i(289),
        P = i(138),
        R = i(178),
        O = i(618),
        I = i(621),
        F = i(576),
        N = i(622),
        D = i(108),
        L = i(10),
        k = _.a.createQuatChannel,
        V = _.a.createVec3Channel,
        B = _.a.createFloatChannel,
        U = function () {
            this._filesMap = void 0, this._loadedFiles = void 0, this._bufferViewCache = void 0, this._basicAnimationManager = void 0, this._visitedNodes = void 0, this._animatedNodes = void 0, this._bones = void 0, this._skeletonToInfluenceMap = void 0, this._inputImgReader = void 0, this._localPath = "", this._extensions = [], this._nodeAnimationTypes = void 0, this.init()
        };
    U.WEBGL_COMPONENT_TYPES = {
        5120: Int8Array,
        5121: Uint8Array,
        5122: Int16Array,
        5123: Uint16Array,
        5125: Uint32Array,
        5126: Float32Array
    }, U.TYPE_TABLE = {
        SCALAR: 1,
        VEC2: 2,
        VEC3: 3,
        VEC4: 4,
        MAT2: 4,
        MAT3: 9,
        MAT4: 16
    }, U.ATTRIBUTE_OSGJS_TABLE = {
        POSITION: "Vertex",
        NORMAL: "Normal",
        TANGENT: "Tangent",
        TEXCOORD_0: "TexCoord0",
        TEXCOORD_1: "TexCoord1",
        TEXCOORD_2: "TexCoord2",
        TEXCOORD_3: "TexCoord3",
        TEXCOORD_4: "TexCoord4",
        TEXCOORD_5: "TexCoord5",
        TEXCOORD_6: "TexCoord6",
        TEXCOORD_7: "TexCoord7",
        TEXCOORD_8: "TexCoord8",
        TEXCOORD_9: "TexCoord9",
        TEXCOORD_10: "TexCoord10",
        TEXCOORD_11: "TexCoord11",
        TEXCOORD_12: "TexCoord12",
        TEXCOORD_13: "TexCoord13",
        TEXCOORD_14: "TexCoord14",
        TEXCOORD_15: "TexCoord15",
        COLOR_0: "Color",
        JOINTS_0: "Bones",
        WEIGHTS_0: "Weights"
    }, U.TEXTURE_FORMAT = {
        6406: C.default.ALPHA,
        6407: C.default.RGB,
        6408: C.default.RGBA,
        6409: C.default.LUMINANCE,
        6410: C.default.LUMINANCE_ALPHA
    }, U.TYPE_CHANNEL_PATH = {
        translation: {
            VEC3: V
        },
        scale: {
            VEC3: V
        },
        rotation: {
            VEC4: k
        },
        weights: {
            SCALAR: B
        }
    }, U.TYPE_STACKED_TRANSFORMS = {
        translation: f.a,
        scale: m.a,
        rotation: p.a
    }, U.PBR_SPEC_EXT = "KHR_materials_pbrSpecularGlossiness", U.PBR_SPEC_MODE = "PBR_specular_glossiness", U.PBR_METAL_MODE = "PBR_metal_roughness", U.ALBEDO_TEXTURE_UNIT = 2, U.DIFFUSE_TEXTURE_UNIT = 2, U.SPECULAR_GLOSSINESS_TEXTURE_UNIT = 3, U.METALLIC_ROUGHNESS_TEXTURE_UNIT = 3, U.SPECULAR_TEXTURE_UNIT = 4, U.NORMAL_TEXTURE_UNIT = 5, U.AO_TEXTURE_UNIT = 6, U.EMISSIVE_TEXTURE_UNIT = 7, U.ALBEDO_UNIFORM = "albedoMap", U.METALLIC_ROUGHNESS_UNIFORM = "metallicRoughnessMap", U.SPECULAR_UNIFORM = "specularMap", U.NORMAL_UNIFORM = "normalMap", U.AO_UNIFORM = "aoMap", U.EMISSIVE_UNIFORM = "emissiveMap", U.prototype = {
        init: function () {
            this._glTFJSON = void 0, this._nodeAnimationTypes = [], this._bufferViewCache = {}, this._basicAnimationManager = void 0, this._localPath = "", this._visitedNodes = {}, this._animatedNodes = {}, this._bones = {}, this._skeletonToInfluenceMap = {}, this._stateSetMap = {}, this._filesMap = {}, this._inputReader = new u.default, this._rootStateSet = new s.a, this._defaultBlendFunc = new w.a, this._transparentBlendFunc = new w.a("SRC_ALPHA", "ONE_MINUS_SRC_ALPHA"), this._defaultCullFace = new M.a, this._doubleSideCullFace = new M.a(M.a.DISABLE)
        },
        _preProcessNodes: function () {
            for (var e, t = this._gltfJSON.nodes, i = this._gltfJSON.meshes, n = 0; n < t.length; n++) {
                var r = t[n];
                e = r.name || "", e += "_" + n.toString(), r.osgjsNodeName = e;
                var a = r.children;
                if (a)
                    for (var o = 0; o < a.length; o++) {
                        var s = a[o];
                        t[s].parent = n
                    }
            }
            for (var u = 0; u < i.length; u++) {
                var l = i[u];
                e = l.name || "", e += "_" + u.toString(), l.osgjsNodeName = e
            }
        },
        loadBuffers: a.a.method(function () {
            for (var e = [], t = this._gltfJSON.buffers, i = 0; i < t.length; i++) {
                var n = t[i];
                e.push(this.loadURI(n.uri, {
                    responseType: "arraybuffer"
                }).then(function (e) {
                    n.data = e
                }))
            }
            return a.a.all(e)
        }),
        loadBufferViews: function () {
            for (var e = this._gltfJSON.buffers, t = this._gltfJSON.bufferViews, i = 0; i < t.length; i++) {
                var n = t[i],
                    r = n.buffer,
                    a = e[r],
                    o = n.byteLength || 0,
                    s = n.byteOffset || 0;
                n.data = a.data.slice(s, s + o)
            }
        },
        loadAccessors: function () {
            for (var e = this._gltfJSON.bufferViews, t = this._gltfJSON.accessors, i = 0; i < t.length; i++) {
                var n, r = t[i],
                    a = r.bufferView,
                    o = e[a],
                    s = U.TYPE_TABLE[r.type],
                    u = U.WEBGL_COMPONENT_TYPES[r.componentType],
                    l = u.BYTES_PER_ELEMENT,
                    c = l * s,
                    h = o.byteStride,
                    d = !0 === r.normalized;
                if (h && h !== c) S.a.warn("GLTF interleaved accessors not supported");
                else {
                    var f = new u(o.data, r.byteOffset, r.count * s);
                    n = new R.a(void 0, f, s), n.setNormalize(d)
                }
                r.data = n
            }
        },
        _computeNodeMatrix: function (e) {
            var t;
            if (e.matrix) t = L.c.clone(e.matrix);
            else if (e.translation || e.rotation || e.scale) {
                var i = L.c.IDENTITY,
                    n = L.c.IDENTITY,
                    r = L.c.IDENTITY;
                e.translation && (i = L.c.fromTranslation(L.c.create(), e.translation)), e.rotation && (n = L.c.fromQuat(L.c.create(), e.rotation)), e.scale && (r = L.c.fromScaling(L.c.create(), e.scale)), t = L.c.create(), L.c.multiply(t, n, r), L.c.multiply(t, i, t)
            }
            return t
        },
        loadNodes: function () {
            for (var e = this._gltfJSON.nodes, t = this._gltfJSON.skins, i = this._gltfJSON.meshes, n = 0; n < e.length; n++) {
                var r = e[n];
                if (!r.usedAsBone) {
                    if (void 0 !== r.skin) {
                        var a = t[r.skin],
                            o = a.osgjsNode;
                        a.osgjsNodeAttached || (r.osgjsNode = o, a.osgjsNodeAttached = n);
                        var s = i[r.mesh];
                        s.osgjsGeometry.setBoneNameID(a.osgjsBoneMapID), o.addChild(s.osgjsGeometry)
                    } else(r.matrix || r.translation || r.rotation || r.scale) && (r.osgjsNode = this._createMatrixTransform(n)), void 0 !== r.mesh && (r.osgjsNode ? r.osgjsNode.addChild(i[r.mesh].osgjsGeometry) : r.osgjsNode = i[r.mesh].osgjsGeometry), r.osgjsNode || (r.osgjsNode = new x.a);
                    r.name && r.osgjsNode.setName(r.name)
                }
            }
        },
        _linkNodes: function (e) {
            var t = this._gltfJSON.nodes,
                i = e.children;
            if (i)
                for (var n = 0; n < i.length; n++) {
                    var r = t[i[n]];
                    if (!r.usedAsBone) {
                        var a = r.osgjsNode;
                        a && !e.osgjsNode.hasChild(a) && (e.osgjsNode.addChild(a), this._linkNodes(r))
                    }
                }
        },
        loadSkins: function () {
            var e = this._gltfJSON.skins;
            if (e)
                for (var t = 0; t < e.length; t++) this._processSkin(t)
        },
        loadScenes: function () {
            var e = this._gltfJSON.nodes,
                t = this._gltfJSON.scenes;
            this._osgjsScene = [];
            for (var i = 0; i < t.length; i++) {
                for (var n = t[i], r = n.nodes, a = [], o = 0; o < r.length; o++) {
                    var s = e[r[o]];
                    this._linkNodes(s), a.push(s.osgjsNode)
                }
                var u = a[0];
                if (a.length > 1) {
                    u = new x.a;
                    for (var l = 0; l < a.length; l++) u.addChild(a[l])
                }
                this._osgjsScene.push(u)
            }
        },
        _assignGeometryAttributes: function (e, t, i) {
            var n = this._gltfJSON.accessors;
            for (var r in t) {
                var a = t[r],
                    o = n[a],
                    s = U.ATTRIBUTE_OSGJS_TABLE[r];
                void 0 !== i && (s += "_" + i.toString()), e.getVertexAttributeList()[s] = o.data, o.data._target = R.a.ARRAY_BUFFER
            }
        },
        _assignGeometryPrimitives: function (e, t) {
            var i = this._gltfJSON.accessors,
                n = i[t.indices];
            n.data._target = R.a.ELEMENT_ARRAY_BUFFER;
            var r = void 0 !== t.mode ? t.mode : P.a.TRIANGLES,
                a = new A.a(r, n.data);
            e.getPrimitiveSetList().push(a)
        },
        _getMorphTargetName: function (e, t) {
            return e.osgjsNodeName + "_target_" + t.toString()
        },
        _computeAbsoluteMorphData: function (e, t) {
            var i = this._gltfJSON.accessors;
            for (var n in t) {
                var r = t[n],
                    a = i[r];
                if (!a.morphAbsoluteComputed) {
                    a.morphAbsoluteComputed = !0;
                    for (var o = e[n], s = i[o], u = s.data.getElements(), l = a.data.getElements(), c = u.length, h = 0; h < c; h++) l[h] += u[h]
                }
            }
        },
        _processMorphGeometry: function (e, t) {
            var i = e.primitives[t],
                n = new v.a,
                r = new I.a;
            r.setName(e.osgjsNodeName), n.setName(e.osgjsNodeName);
            for (var a = 0; a < i.targets.length; a++) {
                this._computeAbsoluteMorphData(i.attributes, i.targets[a]);
                var o = this._getMorphTargetName(e, a),
                    s = new y.a;
                s.setName(o), r.addTarget(o, a), this._assignGeometryAttributes(s, i.targets[a]), n.getMorphTargets().push(s)
            }
            this._assignGeometryAttributes(n, i.attributes), this._assignGeometryPrimitives(n, i), n.mergeChildrenVertexAttributeList(), e.osgjsMorphGeometry = n, e.osgjsUpdateMorph = r
        },
        loadMeshes: function () {
            for (var e = this._gltfJSON.meshes, t = this._gltfJSON.materials, i = 0; i < e.length; i++) {
                for (var n = e[i], r = n.name, a = [], s = 0; s < n.primitives.length; s++) {
                    var u = void 0,
                        l = n.primitives[s],
                        c = void 0;
                    if (l.targets && l.targets.length && (this._processMorphGeometry(n, s), u = n.osgjsMorphGeometry, c = n.osgjsUpdateMorph), l.attributes.JOINTS_0) {
                        var h = new g.a;
                        u || (u = new y.a, this._assignGeometryAttributes(u, l.attributes), this._assignGeometryPrimitives(u, l));
                        var d = new o.a;
                        u.computeBoundingBox(d), h.setBound(d), h.setSourceGeometry(u), h.mergeChildrenData(), u = h
                    }
                    u || (u = new y.a, this._assignGeometryAttributes(u, l.attributes), this._assignGeometryPrimitives(u, l)), r && u.setName(r), c && u.addUpdateCallback(c);
                    var f = t[l.material].osgjsStateSet;
                    u.setStateSet(f), u.setUserData(f.getUserData()), a.push(u)
                }
                if (a.length > 1) {
                    for (var p = new x.a, m = 0; m < a.length; m++) p.addChild(a[m]);
                    u = p
                }
                n.osgjsGeometry = u
            }
        },
        loadImages: function () {
            var e = this._gltfJSON.images;
            if (!e) return a.a.resolve();
            for (var t = [], i = 0; i < e.length; i++) {
                var n = e[i],
                    r = window.decodeURI(n.uri),
                    o = this.loadURI(r).then(function (e) {
                        var t = new E.a;
                        t.setImage(e), this.osgjsImage = t
                    }.bind(n));
                t.push(o)
            }
            return a.a.all(t)
        },
        _texture: function (e) {
            var t = this._gltfJSON.textures,
                i = this._gltfJSON.images,
                n = t[e.index],
                r = i[n.source];
            if (n.osgjsTexture) return n.osgjsTexture;
            var a = new C.default;
            if (n.osgjsTexture = a, a.setFlipY(!1), a.setWrapS("REPEAT"), a.setWrapT("REPEAT"), r.osgjsImage) {
                var o = U.TEXTURE_FORMAT[n.format];
                a.setImage(r.osgjsImage, o)
            }
            return a
        },
        _pbrMetallicRoughnessTextureUniforms: function () {
            var e = this._rootStateSet;
            if (!e.getUniformList()[U.ALBEDO_UNIFORM]) {
                var t = D.a.createInt(U.ALBEDO_TEXTURE_UNIT, U.ALBEDO_UNIFORM),
                    i = D.a.createInt(U.METALLIC_ROUGHNESS_TEXTURE_UNIT, U.METALLIC_ROUGHNESS_UNIFORM);
                e.addUniform(t), e.addUniform(i)
            }
        },
        _pbrMetallicRoughness: function (e, t) {
            t.setUserData({
                pbrWorklow: U.PBR_METAL_MODE
            }), this._pbrMetallicRoughnessTextureUniforms();
            var i;
            if (e.baseColorTexture) i = this._texture(e.baseColorTexture), t.setTextureAttributeAndModes(U.ALBEDO_TEXTURE_UNIT, i);
            else if (e.baseColorFactor) {
                var n = D.a.createFloat4(e.baseColorFactor, "uBaseColorFactor");
                t.addUniform(n)
            }
            if (void 0 !== e.metallicFactor) {
                var r = D.a.createFloat1(e.metallicFactor, "uMetallicFactor");
                t.addUniform(r)
            }
            if (void 0 !== e.roughnessFactor) {
                var a = D.a.createFloat1(e.roughnessFactor, "uRoughnessFactor");
                t.addUniform(a)
            }
            e.metallicRoughnessTexture && (i = this._texture(e.metallicRoughnessTexture), t.setTextureAttributeAndModes(U.METALLIC_ROUGHNESS_TEXTURE_UNIT, i))
        },
        _KHR_materials_pbrSpecularGlossinessTextureUniforms: function () {
            if (!this._extensions.KHR_materials_pbrSpecularGlossinessTextureUniforms) {
                this._extensions.KHR_materials_pbrSpecularGlossinessTextureUniforms = !0;
                var e = this._rootStateSet,
                    t = D.a.createInt(U.DIFFUSE_TEXTURE_UNIT, U.ALBEDO_UNIFORM),
                    i = D.a.createInt(U.SPECULAR_GLOSSINESS_TEXTURE_UNIT, U.METALLIC_ROUGHNESS_UNIFORM),
                    n = D.a.createInt(U.SPECULAR_TEXTURE_UNIT, U.SPECULAR_UNIFORM);
                e.addUniform(t), e.addUniform(i), e.addUniform(n)
            }
        },
        _KHR_materials_pbrSpecularGlossiness: function (e, t) {
            t.setUserData({
                pbrWorklow: U.PBR_SPEC_MODE
            }), this._KHR_materials_pbrSpecularGlossinessTextureUniforms();
            var i, n;
            if (e.diffuseTexture ? (i = this._texture(e.diffuseTexture), t.setTextureAttributeAndModes(U.DIFFUSE_TEXTURE_UNIT, i)) : e.diffuseFactor && (n = D.a.createFloat4(e.diffuseFactor, "uBaseColorFactor"), t.addUniform(n)), e.specularFactor && (n = D.a.createFloat3(e.specularFactor, "uSpecularFactor"), t.addUniform(n)), void 0 !== e.glossinessFactor) {
                var r = D.a.createFloat(e.glossinessFactor, "uGlossinessFactor");
                t.addUniform(r)
            }
            e.specularGlossinessTexture && (i = this._texture(e.specularGlossinessTexture), t.setTextureAttributeAndModes(U.SPECULAR_GLOSSINESS_TEXTURE_UNIT, i))
        },
        loadMaterials: function () {
            var e = this._gltfJSON.materials,
                t = !1,
                i = !1,
                n = this._rootStateSet;
            n.addUniform(D.a.createInt(U.EMISSIVE_TEXTURE_UNIT, U.EMISSIVE_UNIFORM)), n.addUniform(D.a.createInt(U.AO_TEXTURE_UNIT, U.AO_UNIFORM)), n.addUniform(D.a.createInt(U.NORMAL_TEXTURE_UNIT, U.NORMAL_UNIFORM)), n.addUniform(D.a.createFloat3(L.f.ZERO, "uEmissiveFactor"));
            for (var r = 0; r < e.length; r++) {
                var a, o = e[r],
                    u = new s.a;
                o.osgjsStateSet = u, o.pbrMetallicRoughness ? this._pbrMetallicRoughness(o.pbrMetallicRoughness, u) : o.extensions.KHR_materials_pbrSpecularGlossiness && this._KHR_materials_pbrSpecularGlossiness(o.extensions.KHR_materials_pbrSpecularGlossiness, u), o.normalTexture && (a = this._texture(o.normalTexture), u.setTextureAttributeAndModes(U.NORMAL_TEXTURE_UNIT, a)), o.occlusionTexture && (a = this._texture(o.occlusionTexture), u.setTextureAttributeAndModes(U.AO_TEXTURE_UNIT, a)), o.emissiveTexture && (a = this._texture(o.emissiveTexture), u.setTextureAttributeAndModes(U.EMISSIVE_TEXTURE_UNIT, a)), o.emissiveFactor && u.addUniform(D.a.createFloat3(o.emissiveFactor, "uEmissiveFactor")), "BLEND" === o.alphaMode && (t = !0, u.setAttributeAndModes(this._transparentBlendFunc), u.setRenderingHint("TRANSPARENT_BIN")), o.doubleSided && (i = !0, u.setAttributeAndModes(this._doubleSideCullFace))
            }
            t && n.setAttributeAndModes(this._defaultBlendFunc), i && n.setAttributeAndModes(this._defaultCullFace)
        },
        _createBone: function (e) {
            var t = this._gltfJSON.nodes,
                i = t[e];
            i.usedAsBone = !0;
            var n = this._nodeAnimationTypes,
                r = new d.a,
                a = i.osgjsNodeName;
            r.setName(a);
            var o = this._computeNodeMatrix(i) || L.c.IDENTITY;
            r.setMatrix(o);
            var s = new O.a;
            if (s.setName(r.getName()), r.addUpdateCallback(s), n[e]) {
                var u = s.getStackedTransforms();
                for (var l in n[e]) {
                    var c = U.TYPE_STACKED_TRANSFORMS[l],
                        h = new c(l);
                    u.push(h)
                }
            }
            return s.setMatrix(o), r
        },
        _createMatrixTransform: function (e) {
            var t = this._gltfJSON.nodes,
                i = t[e],
                n = this._nodeAnimationTypes,
                r = new T.a,
                a = i.osgjsNodeName;
            r.setName(a);
            var o = this._computeNodeMatrix(i) || L.c.IDENTITY;
            if (r.setMatrix(o), n[e]) {
                var s = new F.a;
                s.setName(r.getName()), r.addUpdateCallback(s), s.setMatrix(o);
                var u = s.getStackedTransforms();
                for (var l in n[e]) {
                    var c = U.TYPE_STACKED_TRANSFORMS[l],
                        h = new c(l);
                    u.push(h)
                }
            }
            return r
        },
        _processSkin: function (e) {
            var t, i, n = this._gltfJSON.skins,
                r = this._gltfJSON.nodes,
                a = n[e],
                o = a.joints;
            void 0 !== a.inverseBindMatrices && (t = this._gltfJSON.accessors[a.inverseBindMatrices].data, i = t.getElements().buffer);
            var s = new h.a;
            a.osgjsNode = s, s.setName("skin ID " + e);
            for (var u, l, c, d = {}, f = {}, p = 0; p < o.length; p++) {
                if (u = o[p], c = this._createBone(u), void 0 !== a.inverseBindMatrices) {
                    var m = new Float32Array(i, 16 * p * 4, 16);
                    c.setInvBindMatrixInSkeletonSpace(m)
                }
                d[u] = c, f[c.getName()] = p
            }
            a.osgjsBoneMapID = f;
            for (var g in d) {
                l = r[g];
                var v = l.parent;
                if (c = d[g], void 0 === v || -1 === o.indexOf(v)) s.addChild(c);
                else {
                    d[v].addChild(c)
                }
            }
        },
        loadAnimations: function () {
            var e = this._gltfJSON.animations;
            if (e) {
                for (var t = this._gltfJSON.accessors, i = this._nodeAnimationTypes, n = this._gltfJSON.nodes, r = this._gltfJSON.meshes, a = [], o = 0; o < e.length; o++) {
                    for (var s = e[o].channels, u = e[o].samplers, l = [], h = 0; h < s.length; h++) {
                        var d = s[h],
                            f = u[d.sampler],
                            p = t[f.input].data.getElements(),
                            m = t[f.output],
                            g = m.data.getElements(),
                            v = d.target,
                            _ = U.TYPE_CHANNEL_PATH[v.path][m.type],
                            S = void 0 !== v.node ? v.node : v.id,
                            x = n[S],
                            y = v.path,
                            C = n[S].osgjsNodeName;
                        if ("weights" === y)
                            for (var T = r[x.mesh], w = T.primitives[0].targets.length, M = p.length, E = 0; E < w; E++) {
                                for (var A = new Float32Array(M), P = 0; P < M; P++) A[P] = g[P * w + E];
                                C = this._getMorphTargetName(T, E), l.push(_(A, p, C, E))
                            } else l.push(_(g, p, C, y));
                        i[S] || (i[S] = {}), i[S][y] = !0
                    }
                    var R = "animation-" + o.toString();
                    a.push(b.a.createAnimation(l, R))
                }
                var O = new c.a;
                O.init(a), this._animationManager = O
            }
        },
        loadURI: a.a.method(function (e, t) {
            if ("data:" === e.substr(0, 5)) return n(e);
            var i = this._filesMap[e];
            return void 0 !== i ? i : N.a.requestURI(e, t)
        }),
        readNodeURL: function (e, t) {
            var i = this;
            if (this.init(), t && void 0 !== t.filesMap && Object.keys(t.filesMap).length > 0) {
                this._filesMap = t.filesMap;
                var n = this._filesMap[e];
                return this.readJSON(n, e)
            }
            var r = e.lastIndexOf("/");
            return this._localPath = -1 === r ? "" : e.substr(0, r + 1), N.a.requestURI(e).then(function (e) {
                return i.readJSON(e)
            })
        },
        readJSON: a.a.method(function (e, t) {
            return this._gltfJSON = e, a.a.all([this.loadBuffers(), this.loadImages()]).then(function () {
                this.loadBufferViews(), this.loadAccessors(), this._preProcessNodes(), this.loadMaterials(), this.loadMeshes(), this.loadAnimations(), this.loadSkins(), this.loadNodes(), this.loadScenes();
                var e = new T.a;
                return e.addChild(this._osgjsScene[0]), e.setName(t), this._animationManager && e.addUpdateCallback(this._animationManager), e.setStateSet(this._rootStateSet), e
            }.bind(this))
        })
    }, l.a.instance().addReaderWriter("gltf", new U), t.a = U
}, function (e, t, i) {
    "use strict";
    var n = i(5),
        r = i.n(n),
        a = i(36),
        o = i(622),
        s = i(578),
        u = i(422),
        l = window.JSZip,
        c = function () {
            this._options = void 0, this._filesMap = {}, this._fileName = ""
        };
    c.prototype = {
        readNodeURL: function (e, t) {
            if (void 0 === l) return a.a.error("You need to add JSZip as a dependency"), r.a.reject(this);
            a.a.log("starting to read: " + e);
            var i = this;
            if (t && void 0 !== t.filesMap && void 0 !== t.filesMap[e]) {
                var n = t.filesMap[e];
                return this.readZipFile(n).then(function () {
                    return i._fileName ? u.default.readNodeURL(i._fileName, {
                        filesMap: i._filesMap
                    }) : r.a.reject(i)
                })
            }
            return o.a.requestURI(e, {
                responseType: "blob"
            }).then(function (e) {
                i.readZipFile(e).then(function () {
                    return u.default.readNodeURL(i._fileName, {
                        filesMap: i._filesMap
                    })
                })
            })
        },
        readZipFile: function (e) {
            o.a.unzip(e).then(function (e) {
                for (var t in e) {
                    var i = o.a.getExtension(t);
                    if (void 0 !== s.a.instance().getReaderWriterForExtension(i) || "osgjs" === i) {
                        this._fileName = t;
                        break
                    }
                }
            }.bind(this))
        }
    }, s.a.instance().addReaderWriter("zip", new c), t.a = c
}, function (e, t) {
    e.exports = {
        $schema: "http://json-schema.org/draft-04/schema#",
        id: "http://sketchfab.com/schema/modeloptions",
        title: "Camera settings",
        description: "Camera position and direction",
        type: "object",
        definitions: {
            vec2: {
                type: "array",
                minItems: 2,
                maxItems: 2,
                items: {
                    type: "number"
                }
            },
            vec3: {
                type: "array",
                minItems: 3,
                maxItems: 3,
                items: {
                    type: "number"
                }
            },
            intVec3: {
                type: "array",
                minItems: 3,
                maxItems: 3,
                items: {
                    type: "integer"
                }
            },
            vec4: {
                type: "array",
                minItems: 4,
                maxItems: 4,
                items: {
                    type: "number"
                }
            },
            matrix: {
                type: "array",
                minItems: 16,
                maxItems: 16,
                items: {
                    type: "number"
                }
            },
            quaternion: {
                type: "array",
                minItems: 4,
                maxItems: 4,
                items: {
                    type: "number"
                }
            },
            unitVec3: {
                type: "array",
                minItems: 3,
                maximum: 3,
                items: {
                    $ref: "#/definitions/unitNumber"
                }
            },
            unitVec3Neg: {
                type: "array",
                minItems: 3,
                maximum: 3,
                items: {
                    $ref: "#/definitions/unitNumberNeg"
                }
            },
            unitVec2Neg: {
                type: "array",
                minItems: 2,
                maximum: 2,
                items: {
                    $ref: "#/definitions/unitNumberNeg"
                }
            },
            unitVec4: {
                type: "array",
                minItems: 4,
                maximum: 4,
                items: {
                    $ref: "#/definitions/unitNumber"
                }
            },
            unitNumber: {
                type: "number",
                minimum: 0,
                maximum: 1
            },
            unitNumberNeg: {
                type: "number",
                minimum: -1,
                maximum: 1
            },
            uid: {
                type: "string",
                pattern: "^[A-Fa-f0-9]{32}$"
            },
            uuid: {
                type: "string",
                pattern: "^[A-Fa-f0-9]{8}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{12}$"
            },
            hotspotData: {
                type: "object",
                properties: {
                    geometryUid: {
                        type: "integer"
                    },
                    uid: {
                        $ref: "#/definitions/uid"
                    },
                    indices: {
                        $ref: "#/definitions/intVec3"
                    },
                    barycentricWeights: {
                        $ref: "#/definitions/vec3"
                    },
                    localPosition: {
                        $ref: "#/definitions/vec3"
                    }
                },
                additionalProperties: !1,
                required: ["uid", "geometryUid", "indices", "barycentricWeights", "localPosition"]
            },
            soundtrack: {
                type: "object",
                properties: {
                    uid: {
                        $ref: "#/definitions/uid"
                    },
                    name: {
                        type: "string",
                        default: ""
                    },
                    enable: {
                        type: "boolean",
                        default: !0
                    },
                    position: {
                        $ref: "#/definitions/vec3",
                        default: [0, 0, 0]
                    },
                    distance: {
                        type: "number",
                        minimum: 0,
                        default: -1
                    },
                    distanceMax: {
                        type: "number",
                        minimum: 0,
                        default: -1
                    },
                    distanceModel: {
                        type: "string",
                        default: "exponential"
                    },
                    startTime: {
                        type: "number",
                        minimum: 0,
                        default: 0
                    },
                    volume: {
                        type: "number",
                        minimum: 0,
                        default: 1
                    },
                    ambient: {
                        type: "boolean",
                        default: !0
                    },
                    loop: {
                        type: "boolean",
                        default: !1
                    },
                    snap: {
                        type: "boolean",
                        default: !1
                    },
                    sync: {
                        type: "boolean",
                        default: !1
                    },
                    geometryUid: {
                        type: "integer",
                        default: -1
                    },
                    indices: {
                        $ref: "#/definitions/intVec3",
                        default: [-1, -1, -1]
                    },
                    barycentricWeights: {
                        $ref: "#/definitions/vec3",
                        default: [0, 0, 0]
                    },
                    localPosition: {
                        $ref: "#/definitions/vec3",
                        default: [0, 0, 0]
                    }
                },
                required: ["uid", "name", "enable", "position", "distance", "distanceMax", "distanceModel", "startTime", "volume", "ambient", "loop", "snap", "sync", "geometryUid", "indices", "barycentricWeights", "localPosition"],
                additionalProperties: !1
            },
            light: {
                type: "object",
                properties: {
                    type: {
                        type: "string",
                        enum: ["NONE", "DIRECTION", "POINT", "SPOT", "HEMI"],
                        default: "NONE"
                    },
                    enable: {
                        type: "boolean",
                        default: !0
                    },
                    color: {
                        $ref: "#/definitions/unitVec3",
                        default: [1, 1, 1]
                    },
                    intensity: {
                        type: "number",
                        minimum: 0,
                        default: 1
                    },
                    ground: {
                        $ref: "#/definitions/unitVec3",
                        default: [.3, .2, .2]
                    },
                    intensityGround: {
                        type: "number",
                        minimum: 0,
                        default: 1
                    },
                    matrix: {
                        $ref: "#/definitions/matrix"
                    },
                    falloff: {
                        type: "number",
                        minimum: 0,
                        default: -1
                    },
                    attachedToCamera: {
                        type: "boolean",
                        default: !1
                    },
                    angle: {
                        type: "number",
                        minimum: 0,
                        maximum: 90,
                        default: 45
                    },
                    hardness: {
                        $ref: "#/definitions/unitNumber",
                        default: .5
                    },
                    castShadows: {
                        type: "boolean",
                        default: !0
                    },
                    shadowBias: {
                        $ref: "#/definitions/unitNumber",
                        default: .005
                    }
                },
                required: ["type", "enable", "color", "intensity", "ground", "intensityGround", "matrix", "falloff", "attachedToCamera", "angle", "hardness", "castShadows", "shadowBias"],
                additionalProperties: !1
            },
            texture: {
                type: "object",
                properties: {
                    internalFormat: {
                        type: "string",
                        enum: ["RGB", "ALPHA", "LUMINANCE"]
                    },
                    magFilter: {
                        type: "string",
                        enum: ["LINEAR", "NEAREST"]
                    },
                    minFilter: {
                        type: "string",
                        enum: ["LINEAR", "NEAREST", "LINEAR_MIPMAP_LINEAR", "NEAREST_MIPMAP_LINEAR"]
                    },
                    textureTarget: {
                        type: "string",
                        enum: ["TEXTURE_2D"]
                    },
                    uid: {
                        $ref: "#/definitions/uid"
                    },
                    wrapS: {
                        type: "string",
                        enum: ["CLAMP_TO_EDGE", "REPEAT", "MIRRORED_REPEAT"]
                    },
                    wrapT: {
                        type: "string",
                        enum: ["CLAMP_TO_EDGE", "REPEAT", "MIRRORED_REPEAT"]
                    },
                    texCoordUnit: {
                        type: "integer",
                        minimum: 0
                    }
                },
                required: ["internalFormat", "magFilter", "minFilter", "texCoordUnit", "textureTarget", "uid", "wrapS", "wrapT"],
                additionalProperties: !1
            },
            materialChannel: {
                type: "object",
                properties: {
                    enable: {
                        type: "boolean"
                    },
                    factor: {
                        $ref: "#/definitions/unitNumber"
                    },
                    color: {
                        $ref: "#/definitions/unitVec3"
                    },
                    texture: {
                        $ref: "#/definitions/texture"
                    }
                },
                oneOf: [{
                    required: ["color"]
                }, {
                    required: ["texture"]
                }],
                required: ["enable", "factor"],
                additionalProperties: !1
            },
            materialChannelGrayScale: {
                type: "object",
                properties: {
                    enable: {
                        type: "boolean"
                    },
                    factor: {
                        $ref: "#/definitions/unitNumber"
                    },
                    texture: {
                        $ref: "#/definitions/texture"
                    }
                },
                required: ["enable", "factor"],
                additionalProperties: !1
            },
            cullFace: {
                type: "string",
                enum: ["DISABLE", "BACK"]
            }
        },
        properties: {
            version: {
                type: "integer",
                minimum: 0
            },
            background: {
                type: "object",
                properties: {
                    enable: {
                        type: "string",
                        enum: ["fixed", "environment", "color", "ambient", "none"],
                        default: "fixed"
                    },
                    uid: {
                        $ref: "#/definitions/uid",
                        default: "51af6a870cce449eb75b0345feebaebb"
                    },
                    color: {
                        $ref: "#/definitions/unitVec3",
                        default: [.2, .2, .2]
                    }
                },
                additionalProperties: !1,
                required: ["enable", "uid", "color"]
            },
            lighting: {
                type: "object",
                properties: {
                    enable: {
                        type: "boolean",
                        default: !1
                    },
                    lights: {
                        type: "array",
                        minItems: 3,
                        maxItems: 3,
                        items: {
                            $ref: "#/definitions/light"
                        },
                        additionalItems: !1
                    }
                },
                additionalProperties: !1,
                required: ["lights", "enable"]
            },
            camera: {
                type: "object",
                properties: {
                    position: {
                        $ref: "#/definitions/vec3"
                    },
                    target: {
                        $ref: "#/definitions/vec3"
                    },
                    fov: {
                        type: "number",
                        minimum: 0,
                        maximum: 180,
                        default: 45
                    },
                    nearFarRatio: {
                        type: "number",
                        minimum: 1e-4,
                        maximum: .005,
                        default: .005
                    },
                    useCameraConstraints: {
                        type: "boolean",
                        default: !1
                    },
                    usePanConstraints: {
                        type: "boolean",
                        default: !0
                    },
                    useZoomConstraints: {
                        type: "boolean",
                        default: !1
                    },
                    usePitchConstraints: {
                        type: "boolean",
                        default: !1
                    },
                    useYawConstraints: {
                        type: "boolean",
                        default: !1
                    },
                    zoomIn: {
                        type: "number",
                        minimum: 0,
                        default: 0
                    },
                    zoomOut: {
                        type: "number",
                        minimum: 0,
                        default: -1
                    },
                    left: {
                        type: "number",
                        minimum: -3.141593,
                        maximum: 3.141593,
                        default: -3.141593
                    },
                    right: {
                        type: "number",
                        minimum: -3.141593,
                        maximum: 3.141593,
                        default: 3.141593
                    },
                    up: {
                        type: "number",
                        minimum: -1.570797,
                        maximum: 1.570797,
                        default: 1.555089
                    },
                    down: {
                        type: "number",
                        minimum: -1.570797,
                        maximum: 1.570797,
                        default: -1.555089
                    }
                },
                additionalProperties: !1,
                required: ["position", "target", "fov", "nearFarRatio", "useCameraConstraints", "usePanConstraints", "useZoomConstraints", "usePitchConstraints", "useYawConstraints", "zoomIn", "zoomOut", "left", "right", "up", "down"]
            },
            environment: {
                type: "object",
                properties: {
                    enable: {
                        type: "boolean"
                    },
                    backgroundExposure: {
                        type: "number",
                        minimum: 0,
                        maximum: 2,
                        default: 1
                    },
                    exposure: {
                        type: "number",
                        minimum: 0,
                        maximum: 35
                    },
                    rotation: {
                        type: "number",
                        minimum: 0,
                        maximum: 6.2831853072,
                        default: 0
                    },
                    uid: {
                        $ref: "#/definitions/uid"
                    },
                    blur: {
                        type: "number",
                        minimum: 0,
                        maximum: 1,
                        default: .1
                    },
                    shadowEnable: {
                        type: "boolean"
                    },
                    lightIntensity: {
                        type: "number",
                        minimum: 0,
                        default: 1
                    },
                    shadowBias: {
                        type: "number",
                        minimum: 0,
                        default: .005
                    }
                },
                additionalProperties: !1,
                required: ["enable", "backgroundExposure", "exposure", "rotation", "uid", "blur", "shadowEnable", "lightIntensity", "shadowBias"]
            },
            materials: {
                type: "object",
                patternProperties: {
                    "^[A-Fa-f0-9]{8}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{12}$": {
                        type: "object",
                        properties: {
                            channels: {
                                type: "object",
                                properties: {
                                    Opacity: {
                                        type: "object",
                                        properties: {
                                            enable: {
                                                type: "boolean",
                                                default: !1
                                            },
                                            factor: {
                                                $ref: "#/definitions/unitNumber",
                                                default: 1
                                            },
                                            type: {
                                                type: "string",
                                                enum: ["alphaBlend", "alphaMask", "additive", "dithering", "refraction"],
                                                default: "alphaBlend"
                                            },
                                            invert: {
                                                type: "boolean",
                                                default: !1
                                            },
                                            texture: {
                                                $ref: "#/definitions/texture"
                                            },
                                            ior: {
                                                type: "number",
                                                minimum: 1,
                                                maximum: 2,
                                                default: 1.05
                                            },
                                            roughnessFactor: {
                                                $ref: "#/definitions/unitNumber",
                                                default: 0
                                            },
                                            useMicrosurfaceTexture: {
                                                type: "boolean",
                                                default: !0
                                            },
                                            useNormalOffset: {
                                                type: "boolean",
                                                default: !1
                                            },
                                            useAlbedoTint: {
                                                type: "boolean"
                                            },
                                            thinLayer: {
                                                type: "boolean",
                                                default: !1
                                            },
                                            refractionColor: {
                                                $ref: "#/definitions/unitVec3",
                                                default: [1, 1, 1]
                                            }
                                        },
                                        required: ["enable", "factor", "type", "invert", "ior", "roughnessFactor", "useMicrosurfaceTexture", "useAlbedoTint", "useNormalOffset", "refractionColor", "thinLayer"],
                                        additionalProperties: !1
                                    },
                                    SpecularHardness: {
                                        type: "object",
                                        properties: {
                                            enable: {
                                                type: "boolean",
                                                default: !0
                                            },
                                            factor: {
                                                type: "number",
                                                minimum: 0,
                                                maximum: 1e4,
                                                default: 12.5
                                            },
                                            texture: {
                                                $ref: "#/definitions/texture"
                                            }
                                        },
                                        required: ["enable", "factor"],
                                        additionalProperties: !1
                                    },
                                    BumpMap: {
                                        type: "object",
                                        properties: {
                                            enable: {
                                                type: "boolean",
                                                default: !1
                                            },
                                            factor: {
                                                type: "number",
                                                minimum: 0,
                                                maximum: 10,
                                                default: 1
                                            },
                                            texture: {
                                                $ref: "#/definitions/texture"
                                            }
                                        },
                                        required: ["enable", "factor"],
                                        additionalProperties: !1
                                    },
                                    Displacement: {
                                        type: "object",
                                        properties: {
                                            enable: {
                                                type: "boolean",
                                                default: !1
                                            },
                                            factor: {
                                                type: "number",
                                                minimum: 0,
                                                default: 0
                                            },
                                            texture: {
                                                $ref: "#/definitions/texture"
                                            }
                                        },
                                        required: ["enable", "factor"],
                                        additionalProperties: !1
                                    },
                                    SubsurfaceTranslucency: {
                                        type: "object",
                                        properties: {
                                            enable: {
                                                type: "boolean",
                                                default: !1
                                            },
                                            factor: {
                                                $ref: "#/definitions/unitNumber",
                                                default: 1
                                            },
                                            thicknessFactor: {
                                                type: "number",
                                                minimum: 0,
                                                default: -1
                                            },
                                            color: {
                                                $ref: "#/definitions/unitVec3",
                                                default: [1, .37, .3]
                                            },
                                            texture: {
                                                $ref: "#/definitions/texture"
                                            }
                                        },
                                        required: ["enable", "factor", "thicknessFactor", "color"],
                                        additionalProperties: !1
                                    },
                                    EmitColor: {
                                        type: "object",
                                        properties: {
                                            enable: {
                                                type: "boolean",
                                                default: !1
                                            },
                                            factor: {
                                                type: "number",
                                                minimum: 0,
                                                maximum: 10,
                                                default: 0
                                            },
                                            color: {
                                                $ref: "#/definitions/unitVec3",
                                                default: [1, 1, 1]
                                            },
                                            texture: {
                                                $ref: "#/definitions/texture"
                                            },
                                            type: {
                                                type: "string",
                                                enum: ["additive", "multiplicative"],
                                                default: "additive"
                                            }
                                        },
                                        oneOf: [{
                                            required: ["color"]
                                        }, {
                                            required: ["texture"]
                                        }],
                                        required: ["enable", "factor", "type"],
                                        additionalProperties: !1
                                    },
                                    SubsurfaceScattering: {
                                        type: "object",
                                        properties: {
                                            enable: {
                                                type: "boolean",
                                                default: !1
                                            },
                                            factor: {
                                                type: "number",
                                                minimum: 0,
                                                default: -1
                                            },
                                            texture: {
                                                $ref: "#/definitions/texture"
                                            },
                                            profile: {
                                                type: "integer",
                                                minimum: 1,
                                                maximum: 3,
                                                default: 1
                                            }
                                        },
                                        required: ["enable", "factor", "profile"],
                                        additionalProperties: !1
                                    },
                                    NormalMap: {
                                        type: "object",
                                        properties: {
                                            enable: {
                                                type: "boolean",
                                                default: !1
                                            },
                                            factor: {
                                                $ref: "#/definitions/unitNumber",
                                                default: 1
                                            },
                                            texture: {
                                                $ref: "#/definitions/texture"
                                            },
                                            flipY: {
                                                type: "boolean",
                                                default: !0
                                            }
                                        },
                                        required: ["enable", "factor", "flipY"],
                                        additionalProperties: !1
                                    },
                                    AOPBR: {
                                        type: "object",
                                        properties: {
                                            enable: {
                                                type: "boolean",
                                                default: !1
                                            },
                                            factor: {
                                                $ref: "#/definitions/unitNumber",
                                                default: 1
                                            },
                                            texture: {
                                                $ref: "#/definitions/texture"
                                            },
                                            occludeSpecular: {
                                                type: "boolean",
                                                default: !1
                                            }
                                        },
                                        required: ["enable", "factor", "occludeSpecular"],
                                        additionalProperties: !1
                                    },
                                    Matcap: {
                                        type: "object",
                                        properties: {
                                            enable: {
                                                type: "boolean",
                                                default: !0
                                            },
                                            factor: {
                                                $ref: "#/definitions/unitNumber",
                                                default: 1
                                            },
                                            curvature: {
                                                type: "number",
                                                minimum: 0,
                                                default: 0
                                            },
                                            color: {
                                                $ref: "#/definitions/unitVec3",
                                                default: [1, 1, 1]
                                            },
                                            texture: {
                                                $ref: "#/definitions/texture"
                                            }
                                        },
                                        required: ["texture", "color", "curvature", "enable", "factor"],
                                        additionalProperties: !1
                                    },
                                    ClearCoat: {
                                        type: "object",
                                        properties: {
                                            enable: {
                                                type: "boolean",
                                                default: !1
                                            },
                                            factor: {
                                                $ref: "#/definitions/unitNumber",
                                                default: 1
                                            },
                                            tint: {
                                                $ref: "#/definitions/unitVec3",
                                                default: [.914, .914, .914]
                                            },
                                            thickness: {
                                                type: "number",
                                                minimum: 0,
                                                maximum: 20,
                                                default: 5
                                            },
                                            reflectivity: {
                                                $ref: "#/definitions/unitNumber",
                                                default: 0
                                            },
                                            texture: {
                                                $ref: "#/definitions/texture"
                                            }
                                        },
                                        required: ["enable", "factor", "tint", "thickness", "reflectivity"],
                                        additionalProperties: !1
                                    },
                                    ClearCoatNormalMap: {
                                        type: "object",
                                        properties: {
                                            enable: {
                                                type: "boolean",
                                                default: !0
                                            },
                                            factor: {
                                                $ref: "#/definitions/unitNumber",
                                                default: 1
                                            },
                                            texture: {
                                                $ref: "#/definitions/texture"
                                            },
                                            flipY: {
                                                type: "boolean",
                                                default: !0
                                            }
                                        },
                                        required: ["enable", "factor", "flipY"],
                                        additionalProperties: !1
                                    },
                                    ClearCoatRoughness: {
                                        $ref: "#/definitions/materialChannelGrayScale",
                                        default: {
                                            factor: .04,
                                            enable: !0
                                        }
                                    },
                                    DiffuseColor: {
                                        $ref: "#/definitions/materialChannel",
                                        default: {
                                            color: [1, 1, 1],
                                            factor: 1,
                                            enable: !0
                                        }
                                    },
                                    DiffuseIntensity: {
                                        $ref: "#/definitions/materialChannel",
                                        default: {
                                            color: [1, 1, 1],
                                            factor: 1,
                                            enable: !0
                                        }
                                    },
                                    SpecularColor: {
                                        $ref: "#/definitions/materialChannel",
                                        default: {
                                            color: [.5, .5, .5],
                                            factor: 0,
                                            enable: !0
                                        }
                                    },
                                    DiffusePBR: {
                                        $ref: "#/definitions/materialChannel",
                                        default: {
                                            color: [1, 1, 1],
                                            factor: 1,
                                            enable: !1
                                        }
                                    },
                                    AlbedoPBR: {
                                        $ref: "#/definitions/materialChannel",
                                        default: {
                                            color: [1, 1, 1],
                                            factor: 1,
                                            enable: !0
                                        }
                                    },
                                    SpecularPBR: {
                                        $ref: "#/definitions/materialChannel",
                                        default: {
                                            color: [1, 1, 1],
                                            factor: .05,
                                            enable: !1
                                        }
                                    },
                                    GlossinessPBR: {
                                        $ref: "#/definitions/materialChannelGrayScale",
                                        default: {
                                            factor: .4,
                                            enable: !1
                                        }
                                    },
                                    RoughnessPBR: {
                                        $ref: "#/definitions/materialChannelGrayScale",
                                        default: {
                                            factor: .6,
                                            enable: !0
                                        }
                                    },
                                    MetalnessPBR: {
                                        $ref: "#/definitions/materialChannelGrayScale",
                                        default: {
                                            factor: 0,
                                            enable: !0
                                        }
                                    },
                                    SpecularF0: {
                                        $ref: "#/definitions/materialChannelGrayScale",
                                        default: {
                                            factor: .5,
                                            enable: !0
                                        }
                                    },
                                    CavityPBR: {
                                        $ref: "#/definitions/materialChannelGrayScale",
                                        default: {
                                            factor: 1,
                                            enable: !1
                                        }
                                    }
                                },
                                required: ["DiffuseColor", "DiffuseIntensity", "EmitColor", "NormalMap", "BumpMap", "Displacement", "Opacity", "SpecularColor", "SpecularHardness", "DiffusePBR", "AlbedoPBR", "SpecularPBR", "GlossinessPBR", "RoughnessPBR", "MetalnessPBR", "SpecularF0", "AOPBR", "CavityPBR", "Matcap", "SubsurfaceScattering", "SubsurfaceTranslucency", "ClearCoat", "ClearCoatRoughness", "ClearCoatNormalMap"],
                                additionalProperties: !1
                            },
                            cullFace: {
                                $ref: "#/definitions/cullFace",
                                default: "DISABLE"
                            },
                            id: {
                                $ref: "#/definitions/uuid",
                                default: "0"
                            },
                            name: {
                                type: "string",
                                default: "noname"
                            },
                            reflection: {
                                $ref: "#/definitions/unitNumber",
                                defaults: .3
                            },
                            shadeless: {
                                type: "boolean",
                                default: !1
                            },
                            stateSetID: {
                                type: "integer",
                                default: 0
                            },
                            version: {
                                type: "integer",
                                minimum: 2
                            }
                        },
                        required: ["channels", "cullFace", "id", "name", "reflection", "shadeless", "stateSetID", "version"],
                        additionalProperties: !1
                    }
                },
                properties: {
                    updatedAt: {
                        type: "integer"
                    }
                },
                additionalProperties: !1
            },
            orientation: {
                type: "object",
                properties: {
                    matrix: {
                        $ref: "#/definitions/matrix",
                        default: [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]
                    }
                },
                additionalProperties: !1,
                required: ["matrix"]
            },
            scene: {
                type: "object",
                properties: {
                    sssProfiles: {
                        type: "array",
                        minItems: 3,
                        maxItems: 3,
                        additionalItems: !1,
                        items: [{
                            type: "object",
                            properties: {
                                strength: {
                                    $ref: "#/definitions/unitVec3",
                                    default: [.48, .41, .28]
                                },
                                falloff: {
                                    $ref: "#/definitions/unitVec3",
                                    default: [1, .37, .3]
                                }
                            },
                            additionalProperties: !1,
                            required: ["strength", "falloff"]
                        }, {
                            type: "object",
                            properties: {
                                strength: {
                                    $ref: "#/definitions/unitVec3",
                                    default: [.38, .61, .68]
                                },
                                falloff: {
                                    $ref: "#/definitions/unitVec3",
                                    default: [.5, .67, .6]
                                }
                            },
                            additionalProperties: !1,
                            required: ["strength", "falloff"]
                        }, {
                            type: "object",
                            properties: {
                                strength: {
                                    $ref: "#/definitions/unitVec3",
                                    default: [.88, .61, .28]
                                },
                                falloff: {
                                    $ref: "#/definitions/unitVec3",
                                    default: [.7, .77, .3]
                                }
                            },
                            additionalProperties: !1,
                            required: ["strength", "falloff"]
                        }]
                    },
                    postProcess: {
                        type: "object",
                        properties: {
                            enable: {
                                type: "boolean",
                                default: !0
                            },
                            grain: {
                                type: "object",
                                properties: {
                                    enable: {
                                        type: "boolean",
                                        default: !1
                                    },
                                    animated: {
                                        type: "boolean",
                                        default: !1
                                    },
                                    factor: {
                                        type: "number",
                                        minimum: 0,
                                        maximum: .5,
                                        default: .15
                                    }
                                },
                                additionalProperties: !1,
                                required: ["enable", "animated", "factor"]
                            },
                            sharpen: {
                                type: "object",
                                properties: {
                                    enable: {
                                        type: "boolean",
                                        default: !1
                                    },
                                    factor: {
                                        type: "number",
                                        minimum: 0,
                                        maximum: 5,
                                        default: .2
                                    }
                                },
                                additionalProperties: !1,
                                required: ["enable", "factor"]
                            },
                            chromaticAberration: {
                                type: "object",
                                properties: {
                                    enable: {
                                        type: "boolean",
                                        default: !1
                                    },
                                    factor: {
                                        type: "number",
                                        minimum: 0,
                                        maximum: .1,
                                        default: .05
                                    }
                                },
                                additionalProperties: !1,
                                required: ["enable", "factor"]
                            },
                            vignette: {
                                type: "object",
                                properties: {
                                    enable: {
                                        type: "boolean",
                                        default: !1
                                    },
                                    amount: {
                                        $ref: "#/definitions/unitNumber",
                                        default: .475
                                    },
                                    hardness: {
                                        $ref: "#/definitions/unitNumber",
                                        default: .725
                                    }
                                },
                                additionalProperties: !1,
                                required: ["enable", "amount", "hardness"]
                            },
                            bloom: {
                                type: "object",
                                properties: {
                                    enable: {
                                        type: "boolean",
                                        default: !1
                                    },
                                    factor: {
                                        type: "number",
                                        minimum: 0,
                                        maximum: 2,
                                        default: 0
                                    },
                                    threshold: {
                                        $ref: "#/definitions/unitNumber",
                                        default: .5
                                    },
                                    radius: {
                                        $ref: "#/definitions/unitNumber",
                                        default: .7
                                    }
                                },
                                additionalProperties: !1,
                                required: ["enable", "factor", "threshold", "radius"]
                            },
                            toneMapping: {
                                type: "object",
                                properties: {
                                    enable: {
                                        type: "boolean",
                                        default: !1
                                    },
                                    method: {
                                        type: "string",
                                        enum: ["default", "reinhard", "filmic"],
                                        default: "default"
                                    },
                                    exposure: {
                                        type: "number",
                                        minimum: 0,
                                        maximum: 2,
                                        default: 1
                                    },
                                    brightness: {
                                        type: "number",
                                        minimum: -1,
                                        maximum: 1,
                                        default: 0
                                    },
                                    contrast: {
                                        type: "number",
                                        minimum: -1,
                                        maximum: 1,
                                        default: 0
                                    },
                                    saturation: {
                                        type: "number",
                                        minimum: 0,
                                        maximum: 2,
                                        default: 1
                                    }
                                },
                                additionalProperties: !1,
                                required: ["enable", "method", "exposure", "brightness", "contrast", "saturation"]
                            },
                            colorBalance: {
                                type: "object",
                                properties: {
                                    enable: {
                                        type: "boolean",
                                        default: !1
                                    },
                                    low: {
                                        $ref: "#/definitions/unitVec3Neg"
                                    },
                                    mid: {
                                        $ref: "#/definitions/unitVec3Neg"
                                    },
                                    high: {
                                        $ref: "#/definitions/unitVec3Neg"
                                    }
                                },
                                additionalProperties: !1,
                                required: ["enable", "low", "mid", "high"]
                            },
                            dof: {
                                type: "object",
                                properties: {
                                    enable: {
                                        type: "boolean",
                                        default: !1
                                    },
                                    blurNear: {
                                        $ref: "#/definitions/unitNumber",
                                        default: .5
                                    },
                                    blurFar: {
                                        $ref: "#/definitions/unitNumber",
                                        default: .5
                                    },
                                    focusPoint: {
                                        $ref: "#/definitions/vec3"
                                    }
                                },
                                additionalProperties: !1,
                                required: ["enable", "blurNear", "blurFar", "focusPoint"]
                            },
                            ssr: {
                                type: "object",
                                properties: {
                                    enable: {
                                        type: "boolean",
                                        default: !1
                                    },
                                    factor: {
                                        $ref: "#/definitions/unitNumber",
                                        default: 1
                                    }
                                },
                                additionalProperties: !1,
                                required: ["enable", "factor"]
                            },
                            ssao: {
                                type: "object",
                                properties: {
                                    enable: {
                                        type: "boolean",
                                        default: !1
                                    },
                                    radius: {
                                        type: "number",
                                        minimum: 0,
                                        default: -1
                                    },
                                    intensity: {
                                        type: "number",
                                        minimum: 0,
                                        maximum: 1,
                                        default: .5
                                    },
                                    bias: {
                                        type: "number",
                                        minimum: 0,
                                        default: -1
                                    }
                                },
                                additionalProperties: !1,
                                required: ["enable", "radius", "intensity", "bias"]
                            },
                            taa: {
                                type: "object",
                                properties: {
                                    enable: {
                                        type: "boolean",
                                        default: !0
                                    },
                                    transparent: {
                                        type: "boolean",
                                        default: !0
                                    }
                                },
                                additionalProperties: !1,
                                required: ["enable", "transparent"]
                            }
                        },
                        additionalProperties: !1,
                        required: ["enable", "grain", "sharpen", "chromaticAberration", "vignette", "bloom", "toneMapping", "colorBalance", "dof", "ssr", "ssao", "taa"]
                    }
                },
                additionalProperties: !1,
                required: ["sssProfiles", "postProcess"]
            },
            shading: {
                type: "object",
                properties: {
                    renderer: {
                        type: "string",
                        enum: ["classic", "pbr"],
                        default: "classic"
                    },
                    type: {
                        type: "string",
                        enum: ["lit", "shadeless", "matcap"],
                        default: "lit"
                    },
                    vertexColor: {
                        type: "object",
                        properties: {
                            enable: {
                                type: "boolean",
                                default: !0
                            },
                            useAlpha: {
                                type: "boolean",
                                default: !0
                            },
                            colorSpace: {
                                type: "string",
                                enum: ["linear", "srgb"],
                                defaul: "srgb"
                            }
                        },
                        additionalProperties: !1,
                        required: ["enable", "useAlpha", "colorSpace"]
                    },
                    pointSize: {
                        type: "number",
                        minimum: 0,
                        maximum: 10,
                        default: 0
                    }
                },
                additionalProperties: !1,
                required: ["renderer", "type", "vertexColor", "pointSize"]
            },
            wireframe: {
                type: "object",
                properties: {
                    enable: {
                        type: "boolean",
                        default: !1
                    },
                    color: {
                        type: "string",
                        pattern: "^[A-Fa-f0-9]{8}$",
                        default: "000000FF"
                    }
                },
                additionalProperties: !1,
                required: ["enable", "color"]
            },
            animation: {
                type: "object",
                properties: {
                    order: {
                        type: "array",
                        items: {
                            type: "string"
                        }
                    },
                    speed: {
                        type: "number",
                        minimum: 0,
                        default: 1
                    },
                    cycleMode: {
                        type: "string",
                        enum: ["one", "all", "none"],
                        default: "one"
                    },
                    initializeWithRestPose: {
                        type: "boolean",
                        default: !1
                    }
                },
                additionalProperties: !1,
                required: ["order", "speed", "cycleMode", "initializeWithRestPose"]
            },
            hotspot: {
                type: "object",
                properties: {
                    hotspots: {
                        type: "array",
                        items: {
                            $ref: "#/definitions/hotspotData"
                        }
                    },
                    visible: {
                        type: "boolean"
                    }
                },
                additionalProperties: !1,
                required: ["hotspots", "visible"]
            },
            vr: {
                type: "object",
                properties: {
                    worldFactor: {
                        type: "number",
                        minimum: 0,
                        default: -1
                    },
                    floorHeight: {
                        type: "number",
                        default: 0
                    },
                    displayFloor: {
                        type: "boolean",
                        default: !0
                    },
                    initialCamera: {
                        type: "object",
                        properties: {
                            position: {
                                $ref: "#/definitions/vec3",
                                default: [0, 0, 0]
                            },
                            rotation: {
                                $ref: "#/definitions/vec4",
                                default: [0, 0, 0, 1]
                            }
                        },
                        additionalProperties: !1,
                        required: ["position", "rotation"]
                    }
                },
                additionalProperties: !1,
                required: ["worldFactor", "initialCamera", "floorHeight", "displayFloor"]
            },
            sound: {
                type: "object",
                properties: {
                    soundtracks: {
                        type: "array",
                        minItems: 0,
                        maxItems: 32,
                        items: {
                            $ref: "#/definitions/soundtrack"
                        },
                        additionalItems: !1
                    }
                },
                additionalProperties: !1,
                required: ["soundtracks"]
            },
            ground: {
                type: "object",
                properties: {
                    enable: {
                        type: "boolean",
                        default: !1
                    },
                    opacity: {
                        type: "number",
                        default: 1
                    },
                    fade: {
                        type: "number",
                        default: .25
                    },
                    height: {
                        type: "number",
                        default: 0
                    },
                    size: {
                        type: "number",
                        default: 1.5
                    },
                    shadowMode: {
                        type: "string",
                        enum: ["ShadowCatcher", "BakedAO"],
                        default: "ShadowCatcher"
                    },
                    samplingRange: {
                        type: "number",
                        default: .6
                    },
                    aoTextureUid: {
                        $ref: "#/definitions/uid"
                    }
                },
                additionalProperties: !1,
                required: ["enable", "opacity", "fade", "height", "size", "shadowMode", "samplingRange"]
            }
        }
    }
}, function (e, t, i) {
    "use strict";

    function n(e) {
        if (!(this instanceof n)) return new n(e);
        e = this._opts = V.copy(e) || {}, A(this), this._schemas = {}, this._refs = {}, this._fragments = {}, this._formats = D(e.format);
        var t = this._schemaUriFormat = this._formats["uri-reference"];
        this._schemaUriFormatFunc = function (e) {
            return t.test(e)
        }, this._cache = e.cache || new I, this._loadingSchemas = {}, this._compilations = [], this.RULES = L(), this._getId = v(e), e.loopRequired = e.loopRequired || 1 / 0, "property" == e.errorDataPath && (e._errorDataPathProperty = !0), void 0 === e.serialize && (e.serialize = N), this._metaOpts = E(this), e.formats && w(this), C(this), "object" == typeof e.meta && this.addMetaSchema(e.meta), T(this)
    }

    function r(e, t) {
        var i;
        if ("string" == typeof e) {
            if (!(i = this.getSchema(e))) throw new Error('no schema with key or ref "' + e + '"')
        } else {
            var n = this._addSchema(e);
            i = n.validate || this._compile(n)
        }
        var r = i(t);
        return !0 !== i.$async && (this.errors = i.errors), r
    }

    function a(e, t) {
        var i = this._addSchema(e, void 0, t);
        return i.validate || this._compile(i)
    }

    function o(e, t, i, n) {
        if (Array.isArray(e)) {
            for (var r = 0; r < e.length; r++) this.addSchema(e[r], void 0, i, n);
            return this
        }
        var a = this._getId(e);
        if (void 0 !== a && "string" != typeof a) throw new Error("schema id must be string");
        return t = O.normalizeId(t || a), M(this, t), this._schemas[t] = this._addSchema(e, i, n, !0), this
    }

    function s(e, t, i) {
        return this.addSchema(e, t, i, !0), this
    }

    function u(e, t) {
        var i = e.$schema;
        if (void 0 !== i && "string" != typeof i) throw new Error("$schema must be a string");
        if (!(i = i || this._opts.defaultMeta || l(this))) return this.logger.warn("meta-schema not available"), this.errors = null, !0;
        var n = this._formats.uri;
        this._formats.uri = "function" == typeof n ? this._schemaUriFormatFunc : this._schemaUriFormat;
        var r;
        try {
            r = this.validate(i, e)
        } finally {
            this._formats.uri = n
        }
        if (!r && t) {
            var a = "schema is invalid: " + this.errorsText();
            if ("log" != this._opts.validateSchema) throw new Error(a);
            this.logger.error(a)
        }
        return r
    }

    function l(e) {
        var t = e._opts.meta;
        return e._opts.defaultMeta = "object" == typeof t ? e._getId(t) || t : e.getSchema(G) ? G : void 0, e._opts.defaultMeta
    }

    function c(e) {
        var t = d(this, e);
        switch (typeof t) {
            case "object":
                return t.validate || this._compile(t);
            case "string":
                return this.getSchema(t);
            case "undefined":
                return h(this, e)
        }
    }

    function h(e, t) {
        var i = O.schema.call(e, {
            schema: {}
        }, t);
        if (i) {
            var n = i.schema,
                r = i.root,
                a = i.baseId,
                o = R.call(e, n, r, void 0, a);
            return e._fragments[t] = new F({
                ref: t,
                fragment: !0,
                schema: n,
                root: r,
                baseId: a,
                validate: o
            }), o
        }
    }

    function d(e, t) {
        return t = O.normalizeId(t), e._schemas[t] || e._refs[t] || e._fragments[t]
    }

    function f(e) {
        if (e instanceof RegExp) return p(this, this._schemas, e), p(this, this._refs, e), this;
        switch (typeof e) {
            case "undefined":
                return p(this, this._schemas), p(this, this._refs), this._cache.clear(), this;
            case "string":
                var t = d(this, e);
                return t && this._cache.del(t.cacheKey), delete this._schemas[e], delete this._refs[e], this;
            case "object":
                var i = this._opts.serialize,
                    n = i ? i(e) : e;
                this._cache.del(n);
                var r = this._getId(e);
                r && (r = O.normalizeId(r), delete this._schemas[r], delete this._refs[r])
        }
        return this
    }

    function p(e, t, i) {
        for (var n in t) {
            var r = t[n];
            r.meta || i && !i.test(n) || (e._cache.del(r.cacheKey), delete t[n])
        }
    }

    function m(e, t, i, n) {
        if ("object" != typeof e && "boolean" != typeof e) throw new Error("schema should be object or boolean");
        var r = this._opts.serialize,
            a = r ? r(e) : e,
            o = this._cache.get(a);
        if (o) return o;
        n = n || !1 !== this._opts.addUsedSchema;
        var s = O.normalizeId(this._getId(e));
        s && n && M(this, s);
        var u, l = !1 !== this._opts.validateSchema && !t;
        l && !(u = s && s == O.normalizeId(e.$schema)) && this.validateSchema(e, !0);
        var c = O.ids.call(this, e),
            h = new F({
                id: s,
                schema: e,
                localRefs: c,
                cacheKey: a,
                meta: i
            });
        return "#" != s[0] && n && (this._refs[s] = h), this._cache.put(a, h), l && u && this.validateSchema(e, !0), h
    }

    function g(e, t) {
        function i() {
            var t = e.validate,
                n = t.apply(this, arguments);
            return i.errors = t.errors, n
        }
        if (e.compiling) return e.validate = i, i.schema = e.schema, i.errors = null, i.root = t || i, !0 === e.schema.$async && (i.$async = !0), i;
        e.compiling = !0;
        var n;
        e.meta && (n = this._opts, this._opts = this._metaOpts);
        var r;
        try {
            r = R.call(this, e.schema, t, e.localRefs)
        } finally {
            e.compiling = !1, e.meta && (this._opts = n)
        }
        return e.validate = r, e.refs = r.refs, e.refVal = r.refVal, e.root = r.root, r
    }

    function v(e) {
        switch (e.schemaId) {
            case "auto":
                return S;
            case "id":
                return _;
            default:
                return b
        }
    }

    function _(e) {
        return e.$id && this.logger.warn("schema $id ignored", e.$id), e.id
    }

    function b(e) {
        return e.id && this.logger.warn("schema id ignored", e.id), e.$id
    }

    function S(e) {
        if (e.$id && e.id && e.$id != e.id) throw new Error("schema $id is different from id");
        return e.$id || e.id
    }

    function x(e, t) {
        if (!(e = e || this.errors)) return "No errors";
        t = t || {};
        for (var i = void 0 === t.separator ? ", " : t.separator, n = void 0 === t.dataVar ? "data" : t.dataVar, r = "", a = 0; a < e.length; a++) {
            var o = e[a];
            o && (r += n + o.dataPath + " " + o.message + i)
        }
        return r.slice(0, -i.length)
    }

    function y(e, t) {
        return "string" == typeof t && (t = new RegExp(t)), this._formats[e] = t, this
    }

    function C(e) {
        var t;
        if (e._opts.$data && (t = i(1170), e.addMetaSchema(t, t.$id, !0)), !1 !== e._opts.meta) {
            var n = i(1171);
            e._opts.$data && (n = k(n, z)), e.addMetaSchema(n, G, !0), e._refs["http://json-schema.org/schema"] = G
        }
    }

    function T(e) {
        var t = e._opts.schemas;
        if (t)
            if (Array.isArray(t)) e.addSchema(t);
            else
                for (var i in t) e.addSchema(t[i], i)
    }

    function w(e) {
        for (var t in e._opts.formats) {
            var i = e._opts.formats[t];
            e.addFormat(t, i)
        }
    }

    function M(e, t) {
        if (e._schemas[t] || e._refs[t]) throw new Error('schema with key or id "' + t + '" already exists')
    }

    function E(e) {
        for (var t = V.copy(e._opts), i = 0; i < j.length; i++) delete t[j[i]];
        return t
    }

    function A(e) {
        var t = e._opts.logger;
        if (!1 === t) e.logger = {
            log: P,
            warn: P,
            error: P
        };
        else {
            if (void 0 === t && (t = console), !("object" == typeof t && t.log && t.warn && t.error)) throw new Error("logger must implement log, warn and error methods");
            e.logger = t
        }
    }

    function P() {}
    var R = i(1139),
        O = i(701),
        I = i(1143),
        F = i(908),
        N = i(909),
        D = i(1144),
        L = i(1145),
        k = i(1166),
        V = i(455);
    e.exports = n, n.prototype.validate = r, n.prototype.compile = a, n.prototype.addSchema = o, n.prototype.addMetaSchema = s, n.prototype.validateSchema = u, n.prototype.getSchema = c, n.prototype.removeSchema = f, n.prototype.addFormat = y, n.prototype.errorsText = x, n.prototype._addSchema = m, n.prototype._compile = g, n.prototype.compileAsync = i(1167);
    var B = i(1168);
    n.prototype.addKeyword = B.add, n.prototype.getKeyword = B.get, n.prototype.removeKeyword = B.remove;
    var U = i(703);
    n.ValidationError = U.Validation, n.MissingRefError = U.MissingRef, n.$dataMetaSchema = k;
    var G = "http://json-schema.org/draft-07/schema",
        j = ["removeAdditional", "useDefaults", "coerceTypes"],
        z = ["/properties"]
}, function (e, t, i) {
    "use strict";

    function n(e, t, i, o) {
        function S() {
            var e = U.validate,
                t = e.apply(this, arguments);
            return S.errors = e.errors, t
        }

        function x(e, i, r, a) {
            var o = !i || i && i.schema == e;
            if (i.schema != t.schema) return n.call(R, e, i, r, a);
            var m = !0 === e.$async,
                S = g({
                    isTop: !0,
                    schema: e,
                    isRoot: o,
                    baseId: a,
                    root: i,
                    schemaPath: "",
                    errSchemaPath: "#",
                    errorPath: '""',
                    MissingRefError: p.MissingRef,
                    RULES: j,
                    validate: g,
                    util: f,
                    resolve: d,
                    resolveRef: y,
                    usePattern: E,
                    useDefault: A,
                    useCustomRule: P,
                    opts: O,
                    formats: G,
                    logger: R.logger,
                    self: R
                });
            S = h(I, l) + h(N, s) + h(L, u) + h(V, c) + S, O.processCode && (S = O.processCode(S));
            var x;
            try {
                x = new Function("self", "RULES", "formats", "root", "refVal", "defaults", "customRules", "equal", "ucs2length", "ValidationError", S)(R, j, G, t, I, L, V, _, v, b), I[0] = x
            } catch (e) {
                throw R.logger.error("Error compiling schema, function code:", S), e
            }
            return x.schema = e, x.errors = null, x.refs = F, x.refVal = I, x.root = o ? x : i, m && (x.$async = !0), !0 === O.sourceCode && (x.source = {
                code: S,
                patterns: N,
                defaults: L
            }), x
        }

        function y(e, r, a) {
            r = d.url(e, r);
            var o, s, u = F[r];
            if (void 0 !== u) return o = I[u], s = "refVal[" + u + "]", M(o, s);
            if (!a && t.refs) {
                var l = t.refs[r];
                if (void 0 !== l) return o = t.refVal[l], s = C(r, o), M(o, s)
            }
            s = C(r);
            var c = d.call(R, x, t, r);
            if (void 0 === c) {
                var h = i && i[r];
                h && (c = d.inlineRef(h, O.inlineRefs) ? h : n.call(R, h, t, i, e))
            }
            if (void 0 !== c) return w(r, c), M(c, s);
            T(r)
        }

        function C(e, t) {
            var i = I.length;
            return I[i] = t, F[e] = i, "refVal" + i
        }

        function T(e) {
            delete F[e]
        }

        function w(e, t) {
            var i = F[e];
            I[i] = t
        }

        function M(e, t) {
            return "object" == typeof e || "boolean" == typeof e ? {
                code: t,
                schema: e,
                inline: !0
            } : {
                code: t,
                $async: e && !!e.$async
            }
        }

        function E(e) {
            var t = D[e];
            return void 0 === t && (t = D[e] = N.length, N[t] = e), "pattern" + t
        }

        function A(e) {
            switch (typeof e) {
                case "boolean":
                case "number":
                    return "" + e;
                case "string":
                    return f.toQuotedString(e);
                case "object":
                    if (null === e) return "null";
                    var t = m(e),
                        i = k[t];
                    return void 0 === i && (i = k[t] = L.length, L[i] = e), "default" + i
            }
        }

        function P(e, t, i, n) {
            var r = e.definition.validateSchema;
            if (r && !1 !== R._opts.validateSchema) {
                if (!r(t)) {
                    var a = "keyword schema is invalid: " + R.errorsText(r.errors);
                    if ("log" != R._opts.validateSchema) throw new Error(a);
                    R.logger.error(a)
                }
            }
            var o, s = e.definition.compile,
                u = e.definition.inline,
                l = e.definition.macro;
            if (s) o = s.call(R, t, i, n);
            else if (l) o = l.call(R, t, i, n), !1 !== O.validateSchema && R.validateSchema(o, !0);
            else if (u) o = u.call(R, n, e.keyword, t, i);
            else if (!(o = e.definition.validate)) return;
            if (void 0 === o) throw new Error('custom keyword "' + e.keyword + '"failed to compile');
            var c = V.length;
            return V[c] = o, {
                code: "customRule" + c,
                validate: o
            }
        }
        var R = this,
            O = this._opts,
            I = [void 0],
            F = {},
            N = [],
            D = {},
            L = [],
            k = {},
            V = [];
        t = t || {
            schema: e,
            refVal: I,
            refs: F
        };
        var B = r.call(this, e, t, o),
            U = this._compilations[B.index];
        if (B.compiling) return U.callValidate = S;
        var G = this._formats,
            j = this.RULES;
        try {
            var z = x(e, t, i, o);
            U.validate = z;
            var H = U.callValidate;
            return H && (H.schema = z.schema, H.errors = null, H.refs = z.refs, H.refVal = z.refVal, H.root = z.root, H.$async = z.$async, O.sourceCode && (H.source = z.source)), z
        } finally {
            a.call(this, e, t, o)
        }
    }

    function r(e, t, i) {
        var n = o.call(this, e, t, i);
        return n >= 0 ? {
            index: n,
            compiling: !0
        } : (n = this._compilations.length, this._compilations[n] = {
            schema: e,
            root: t,
            baseId: i
        }, {
            index: n,
            compiling: !1
        })
    }

    function a(e, t, i) {
        var n = o.call(this, e, t, i);
        n >= 0 && this._compilations.splice(n, 1)
    }

    function o(e, t, i) {
        for (var n = 0; n < this._compilations.length; n++) {
            var r = this._compilations[n];
            if (r.schema == e && r.root == t && r.baseId == i) return n
        }
        return -1
    }

    function s(e, t) {
        return "var pattern" + e + " = new RegExp(" + f.toQuotedString(t[e]) + ");"
    }

    function u(e) {
        return "var default" + e + " = defaults[" + e + "];"
    }

    function l(e, t) {
        return void 0 === t[e] ? "" : "var refVal" + e + " = refVal[" + e + "];"
    }

    function c(e) {
        return "var customRule" + e + " = customRules[" + e + "];"
    }

    function h(e, t) {
        if (!e.length) return "";
        for (var i = "", n = 0; n < e.length; n++) i += t(n, e);
        return i
    }
    var d = i(701),
        f = i(455),
        p = i(703),
        m = i(909),
        g = i(910),
        v = f.ucs2length,
        _ = i(702),
        b = p.Validation;
    e.exports = n
}, function (e, t, i) { /** @license URI.js v4.2.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */
    ! function (e, i) {
        i(t)
    }(0, function (e) {
        "use strict";

        function t() {
            for (var e = arguments.length, t = Array(e), i = 0; i < e; i++) t[i] = arguments[i];
            if (t.length > 1) {
                t[0] = t[0].slice(0, -1);
                for (var n = t.length - 1, r = 1; r < n; ++r) t[r] = t[r].slice(1, -1);
                return t[n] = t[n].slice(1), t.join("")
            }
            return t[0]
        }

        function i(e) {
            return "(?:" + e + ")"
        }

        function n(e) {
            return void 0 === e ? "undefined" : null === e ? "null" : Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()
        }

        function r(e) {
            return e.toUpperCase()
        }

        function a(e) {
            return void 0 !== e && null !== e ? e instanceof Array ? e : "number" != typeof e.length || e.split || e.setInterval || e.call ? [e] : Array.prototype.slice.call(e) : []
        }

        function o(e, t) {
            var i = e;
            if (t)
                for (var n in t) i[n] = t[n];
            return i
        }

        function s(e) {
            var n = t("[0-9]", "[A-Fa-f]"),
                r = i(i("%[EFef]" + n + "%" + n + n + "%" + n + n) + "|" + i("%[89A-Fa-f]" + n + "%" + n + n) + "|" + i("%" + n + n)),
                a = "[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",
                o = t("[\\:\\/\\?\\#\\[\\]\\@]", a),
                s = e ? "[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]" : "[]",
                u = e ? "[\\uE000-\\uF8FF]" : "[]",
                l = t("[A-Za-z]", "[0-9]", "[\\-\\.\\_\\~]", s),
                c = i("[A-Za-z]" + t("[A-Za-z]", "[0-9]", "[\\+\\-\\.]") + "*"),
                h = i(i(r + "|" + t(l, a, "[\\:]")) + "*"),
                d = (i(i("25[0-5]") + "|" + i("2[0-4][0-9]") + "|" + i("1[0-9][0-9]") + "|" + i("[1-9][0-9]") + "|[0-9]"), i(i("25[0-5]") + "|" + i("2[0-4][0-9]") + "|" + i("1[0-9][0-9]") + "|" + i("0?[1-9][0-9]") + "|0?0?[0-9]")),
                f = i(d + "\\." + d + "\\." + d + "\\." + d),
                p = i(n + "{1,4}"),
                m = i(i(p + "\\:" + p) + "|" + f),
                g = i(i(p + "\\:") + "{6}" + m),
                v = i("\\:\\:" + i(p + "\\:") + "{5}" + m),
                _ = i(i(p) + "?\\:\\:" + i(p + "\\:") + "{4}" + m),
                b = i(i(i(p + "\\:") + "{0,1}" + p) + "?\\:\\:" + i(p + "\\:") + "{3}" + m),
                S = i(i(i(p + "\\:") + "{0,2}" + p) + "?\\:\\:" + i(p + "\\:") + "{2}" + m),
                x = i(i(i(p + "\\:") + "{0,3}" + p) + "?\\:\\:" + p + "\\:" + m),
                y = i(i(i(p + "\\:") + "{0,4}" + p) + "?\\:\\:" + m),
                C = i(i(i(p + "\\:") + "{0,5}" + p) + "?\\:\\:" + p),
                T = i(i(i(p + "\\:") + "{0,6}" + p) + "?\\:\\:"),
                w = i([g, v, _, b, S, x, y, C, T].join("|")),
                M = i(i(l + "|" + r) + "+"),
                E = (i(w + "\\%25" + M), i(w + i("\\%25|\\%(?!" + n + "{2})") + M)),
                A = i("[vV]" + n + "+\\." + t(l, a, "[\\:]") + "+"),
                P = i("\\[" + i(E + "|" + w + "|" + A) + "\\]"),
                R = i(i(r + "|" + t(l, a)) + "*"),
                O = i(P + "|" + f + "(?!" + R + ")|" + R),
                I = i("[0-9]*"),
                F = i(i(h + "@") + "?" + O + i("\\:" + I) + "?"),
                N = i(r + "|" + t(l, a, "[\\:\\@]")),
                D = i(N + "*"),
                L = i(N + "+"),
                k = i(i(r + "|" + t(l, a, "[\\@]")) + "+"),
                V = i(i("\\/" + D) + "*"),
                B = i("\\/" + i(L + V) + "?"),
                U = i(k + V),
                G = i(L + V),
                j = "(?!" + N + ")",
                z = (i(V + "|" + B + "|" + U + "|" + G + "|" + j), i(i(N + "|" + t("[\\/\\?]", u)) + "*")),
                H = i(i(N + "|[\\/\\?]") + "*"),
                W = i(i("\\/\\/" + F + V) + "|" + B + "|" + G + "|" + j),
                q = i(c + "\\:" + W + i("\\?" + z) + "?" + i("\\#" + H) + "?"),
                X = i(i("\\/\\/" + F + V) + "|" + B + "|" + U + "|" + j),
                Y = i(X + i("\\?" + z) + "?" + i("\\#" + H) + "?");
            i(q + "|" + Y), i(c + "\\:" + W + i("\\?" + z) + "?"), i(i("\\/\\/(" + i("(" + h + ")@") + "?(" + O + ")" + i("\\:(" + I + ")") + "?)") + "?(" + V + "|" + B + "|" + G + "|" + j + ")"), i("\\?(" + z + ")"), i("\\#(" + H + ")"), i(i("\\/\\/(" + i("(" + h + ")@") + "?(" + O + ")" + i("\\:(" + I + ")") + "?)") + "?(" + V + "|" + B + "|" + U + "|" + j + ")"), i("\\?(" + z + ")"), i("\\#(" + H + ")"), i(i("\\/\\/(" + i("(" + h + ")@") + "?(" + O + ")" + i("\\:(" + I + ")") + "?)") + "?(" + V + "|" + B + "|" + G + "|" + j + ")"), i("\\?(" + z + ")"), i("\\#(" + H + ")"), i("(" + h + ")@"), i("\\:(" + I + ")");
            return {
                NOT_SCHEME: new RegExp(t("[^]", "[A-Za-z]", "[0-9]", "[\\+\\-\\.]"), "g"),
                NOT_USERINFO: new RegExp(t("[^\\%\\:]", l, a), "g"),
                NOT_HOST: new RegExp(t("[^\\%\\[\\]\\:]", l, a), "g"),
                NOT_PATH: new RegExp(t("[^\\%\\/\\:\\@]", l, a), "g"),
                NOT_PATH_NOSCHEME: new RegExp(t("[^\\%\\/\\@]", l, a), "g"),
                NOT_QUERY: new RegExp(t("[^\\%]", l, a, "[\\:\\@\\/\\?]", u), "g"),
                NOT_FRAGMENT: new RegExp(t("[^\\%]", l, a, "[\\:\\@\\/\\?]"), "g"),
                ESCAPE: new RegExp(t("[^]", l, a), "g"),
                UNRESERVED: new RegExp(l, "g"),
                OTHER_CHARS: new RegExp(t("[^\\%]", l, o), "g"),
                PCT_ENCODED: new RegExp(r, "g"),
                IPV4ADDRESS: new RegExp("^(" + f + ")$"),
                IPV6ADDRESS: new RegExp("^\\[?(" + w + ")" + i(i("\\%25|\\%(?!" + n + "{2})") + "(" + M + ")") + "?\\]?$")
            }
        }

        function u(e) {
            throw new RangeError(k[e])
        }

        function l(e, t) {
            for (var i = [], n = e.length; n--;) i[n] = t(e[n]);
            return i
        }

        function c(e, t) {
            var i = e.split("@"),
                n = "";
            return i.length > 1 && (n = i[0] + "@", e = i[1]), e = e.replace(L, "."), n + l(e.split("."), t).join(".")
        }

        function h(e) {
            for (var t = [], i = 0, n = e.length; i < n;) {
                var r = e.charCodeAt(i++);
                if (r >= 55296 && r <= 56319 && i < n) {
                    var a = e.charCodeAt(i++);
                    56320 == (64512 & a) ? t.push(((1023 & r) << 10) + (1023 & a) + 65536) : (t.push(r), i--)
                } else t.push(r)
            }
            return t
        }

        function d(e) {
            var t = e.charCodeAt(0);
            return t < 16 ? "%0" + t.toString(16).toUpperCase() : t < 128 ? "%" + t.toString(16).toUpperCase() : t < 2048 ? "%" + (t >> 6 | 192).toString(16).toUpperCase() + "%" + (63 & t | 128).toString(16).toUpperCase() : "%" + (t >> 12 | 224).toString(16).toUpperCase() + "%" + (t >> 6 & 63 | 128).toString(16).toUpperCase() + "%" + (63 & t | 128).toString(16).toUpperCase()
        }

        function f(e) {
            for (var t = "", i = 0, n = e.length; i < n;) {
                var r = parseInt(e.substr(i + 1, 2), 16);
                if (r < 128) t += String.fromCharCode(r), i += 3;
                else if (r >= 194 && r < 224) {
                    if (n - i >= 6) {
                        var a = parseInt(e.substr(i + 4, 2), 16);
                        t += String.fromCharCode((31 & r) << 6 | 63 & a)
                    } else t += e.substr(i, 6);
                    i += 6
                } else if (r >= 224) {
                    if (n - i >= 9) {
                        var o = parseInt(e.substr(i + 4, 2), 16),
                            s = parseInt(e.substr(i + 7, 2), 16);
                        t += String.fromCharCode((15 & r) << 12 | (63 & o) << 6 | 63 & s)
                    } else t += e.substr(i, 9);
                    i += 9
                } else t += e.substr(i, 3), i += 3
            }
            return t
        }

        function p(e, t) {
            function i(e) {
                var i = f(e);
                return i.match(t.UNRESERVED) ? i : e
            }
            return e.scheme && (e.scheme = String(e.scheme).replace(t.PCT_ENCODED, i).toLowerCase().replace(t.NOT_SCHEME, "")), void 0 !== e.userinfo && (e.userinfo = String(e.userinfo).replace(t.PCT_ENCODED, i).replace(t.NOT_USERINFO, d).replace(t.PCT_ENCODED, r)), void 0 !== e.host && (e.host = String(e.host).replace(t.PCT_ENCODED, i).toLowerCase().replace(t.NOT_HOST, d).replace(t.PCT_ENCODED, r)), void 0 !== e.path && (e.path = String(e.path).replace(t.PCT_ENCODED, i).replace(e.scheme ? t.NOT_PATH : t.NOT_PATH_NOSCHEME, d).replace(t.PCT_ENCODED, r)), void 0 !== e.query && (e.query = String(e.query).replace(t.PCT_ENCODED, i).replace(t.NOT_QUERY, d).replace(t.PCT_ENCODED, r)), void 0 !== e.fragment && (e.fragment = String(e.fragment).replace(t.PCT_ENCODED, i).replace(t.NOT_FRAGMENT, d).replace(t.PCT_ENCODED, r)), e
        }

        function m(e) {
            return e.replace(/^0*(.*)/, "$1") || "0"
        }

        function g(e, t) {
            var i = e.match(t.IPV4ADDRESS) || [],
                n = O(i, 2),
                r = n[1];
            return r ? r.split(".").map(m).join(".") : e
        }

        function v(e, t) {
            var i = e.match(t.IPV6ADDRESS) || [],
                n = O(i, 3),
                r = n[1],
                a = n[2];
            if (r) {
                for (var o = r.toLowerCase().split("::").reverse(), s = O(o, 2), u = s[0], l = s[1], c = l ? l.split(":").map(m) : [], h = u.split(":").map(m), d = t.IPV4ADDRESS.test(h[h.length - 1]), f = d ? 7 : 8, p = h.length - f, v = Array(f), _ = 0; _ < f; ++_) v[_] = c[_] || h[p + _] || "";
                d && (v[f - 1] = g(v[f - 1], t));
                var b = v.reduce(function (e, t, i) {
                        if (!t || "0" === t) {
                            var n = e[e.length - 1];
                            n && n.index + n.length === i ? n.length++ : e.push({
                                index: i,
                                length: 1
                            })
                        }
                        return e
                    }, []),
                    S = b.sort(function (e, t) {
                        return t.length - e.length
                    })[0],
                    x = void 0;
                if (S && S.length > 1) {
                    var y = v.slice(0, S.index),
                        C = v.slice(S.index + S.length);
                    x = y.join(":") + "::" + C.join(":")
                } else x = v.join(":");
                return a && (x += "%" + a), x
            }
            return e
        }

        function _(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
                i = {},
                n = !1 !== t.iri ? R : P;
            "suffix" === t.reference && (e = (t.scheme ? t.scheme + ":" : "") + "//" + e);
            var r = e.match($);
            if (r) {
                Q ? (i.scheme = r[1], i.userinfo = r[3], i.host = r[4], i.port = parseInt(r[5], 10), i.path = r[6] || "", i.query = r[7], i.fragment = r[8], isNaN(i.port) && (i.port = r[5])) : (i.scheme = r[1] || void 0, i.userinfo = -1 !== e.indexOf("@") ? r[3] : void 0, i.host = -1 !== e.indexOf("//") ? r[4] : void 0, i.port = parseInt(r[5], 10), i.path = r[6] || "", i.query = -1 !== e.indexOf("?") ? r[7] : void 0, i.fragment = -1 !== e.indexOf("#") ? r[8] : void 0, isNaN(i.port) && (i.port = e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/) ? r[4] : void 0)), i.host && (i.host = v(g(i.host, n), n)), void 0 !== i.scheme || void 0 !== i.userinfo || void 0 !== i.host || void 0 !== i.port || i.path || void 0 !== i.query ? void 0 === i.scheme ? i.reference = "relative" : void 0 === i.fragment ? i.reference = "absolute" : i.reference = "uri" : i.reference = "same-document", t.reference && "suffix" !== t.reference && t.reference !== i.reference && (i.error = i.error || "URI is not a " + t.reference + " reference.");
                var a = K[(t.scheme || i.scheme || "").toLowerCase()];
                if (t.unicodeSupport || a && a.unicodeSupport) p(i, n);
                else {
                    if (i.host && (t.domainHost || a && a.domainHost)) try {
                        i.host = Y.toASCII(i.host.replace(n.PCT_ENCODED, f).toLowerCase())
                    } catch (e) {
                        i.error = i.error || "Host's domain name can not be converted to ASCII via punycode: " + e
                    }
                    p(i, P)
                }
                a && a.parse && a.parse(i, t)
            } else i.error = i.error || "URI can not be parsed.";
            return i
        }

        function b(e, t) {
            var i = !1 !== t.iri ? R : P,
                n = [];
            return void 0 !== e.userinfo && (n.push(e.userinfo), n.push("@")), void 0 !== e.host && n.push(v(g(String(e.host), i), i).replace(i.IPV6ADDRESS, function (e, t, i) {
                return "[" + t + (i ? "%25" + i : "") + "]"
            })), "number" == typeof e.port && (n.push(":"), n.push(e.port.toString(10))), n.length ? n.join("") : void 0
        }

        function S(e) {
            for (var t = []; e.length;)
                if (e.match(J)) e = e.replace(J, "");
                else if (e.match(Z)) e = e.replace(Z, "/");
            else if (e.match(ee)) e = e.replace(ee, "/"), t.pop();
            else if ("." === e || ".." === e) e = "";
            else {
                var i = e.match(te);
                if (!i) throw new Error("Unexpected dot segment condition");
                var n = i[0];
                e = e.slice(n.length), t.push(n)
            }
            return t.join("")
        }

        function x(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
                i = t.iri ? R : P,
                n = [],
                r = K[(t.scheme || e.scheme || "").toLowerCase()];
            if (r && r.serialize && r.serialize(e, t), e.host)
                if (i.IPV6ADDRESS.test(e.host));
                else if (t.domainHost || r && r.domainHost) try {
                e.host = t.iri ? Y.toUnicode(e.host) : Y.toASCII(e.host.replace(i.PCT_ENCODED, f).toLowerCase())
            } catch (i) {
                e.error = e.error || "Host's domain name can not be converted to " + (t.iri ? "Unicode" : "ASCII") + " via punycode: " + i
            }
            p(e, i), "suffix" !== t.reference && e.scheme && (n.push(e.scheme), n.push(":"));
            var a = b(e, t);
            if (void 0 !== a && ("suffix" !== t.reference && n.push("//"), n.push(a), e.path && "/" !== e.path.charAt(0) && n.push("/")), void 0 !== e.path) {
                var o = e.path;
                t.absolutePath || r && r.absolutePath || (o = S(o)), void 0 === a && (o = o.replace(/^\/\//, "/%2F")), n.push(o)
            }
            return void 0 !== e.query && (n.push("?"), n.push(e.query)), void 0 !== e.fragment && (n.push("#"), n.push(e.fragment)), n.join("")
        }

        function y(e, t) {
            var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                n = arguments[3],
                r = {};
            return n || (e = _(x(e, i), i), t = _(x(t, i), i)), i = i || {}, !i.tolerant && t.scheme ? (r.scheme = t.scheme, r.userinfo = t.userinfo, r.host = t.host, r.port = t.port, r.path = S(t.path || ""), r.query = t.query) : (void 0 !== t.userinfo || void 0 !== t.host || void 0 !== t.port ? (r.userinfo = t.userinfo, r.host = t.host, r.port = t.port, r.path = S(t.path || ""), r.query = t.query) : (t.path ? ("/" === t.path.charAt(0) ? r.path = S(t.path) : (void 0 === e.userinfo && void 0 === e.host && void 0 === e.port || e.path ? e.path ? r.path = e.path.slice(0, e.path.lastIndexOf("/") + 1) + t.path : r.path = t.path : r.path = "/" + t.path, r.path = S(r.path)), r.query = t.query) : (r.path = e.path, void 0 !== t.query ? r.query = t.query : r.query = e.query), r.userinfo = e.userinfo, r.host = e.host, r.port = e.port), r.scheme = e.scheme), r.fragment = t.fragment, r
        }

        function C(e, t, i) {
            var n = o({
                scheme: "null"
            }, i);
            return x(y(_(e, n), _(t, n), n, !0), n)
        }

        function T(e, t) {
            return "string" == typeof e ? e = x(_(e, t), t) : "object" === n(e) && (e = _(x(e, t), t)), e
        }

        function w(e, t, i) {
            return "string" == typeof e ? e = x(_(e, i), i) : "object" === n(e) && (e = x(e, i)), "string" == typeof t ? t = x(_(t, i), i) : "object" === n(t) && (t = x(t, i)), e === t
        }

        function M(e, t) {
            return e && e.toString().replace(t && t.iri ? R.ESCAPE : P.ESCAPE, d)
        }

        function E(e, t) {
            return e && e.toString().replace(t && t.iri ? R.PCT_ENCODED : P.PCT_ENCODED, f)
        }

        function A(e) {
            var t = f(e);
            return t.match(le) ? t : e
        }
        var P = s(!1),
            R = s(!0),
            O = function () {
                function e(e, t) {
                    var i = [],
                        n = !0,
                        r = !1,
                        a = void 0;
                    try {
                        for (var o, s = e[Symbol.iterator](); !(n = (o = s.next()).done) && (i.push(o.value), !t || i.length !== t); n = !0);
                    } catch (e) {
                        r = !0, a = e
                    } finally {
                        try {
                            !n && s.return && s.return()
                        } finally {
                            if (r) throw a
                        }
                    }
                    return i
                }
                return function (t, i) {
                    if (Array.isArray(t)) return t;
                    if (Symbol.iterator in Object(t)) return e(t, i);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }(),
            I = function (e) {
                if (Array.isArray(e)) {
                    for (var t = 0, i = Array(e.length); t < e.length; t++) i[t] = e[t];
                    return i
                }
                return Array.from(e)
            },
            F = 2147483647,
            N = /^xn--/,
            D = /[^\0-\x7E]/,
            L = /[\x2E\u3002\uFF0E\uFF61]/g,
            k = {
                overflow: "Overflow: input needs wider integers to process",
                "not-basic": "Illegal input >= 0x80 (not a basic code point)",
                "invalid-input": "Invalid input"
            },
            V = Math.floor,
            B = String.fromCharCode,
            U = function (e) {
                return String.fromCodePoint.apply(String, I(e))
            },
            G = function (e) {
                return e - 48 < 10 ? e - 22 : e - 65 < 26 ? e - 65 : e - 97 < 26 ? e - 97 : 36
            },
            j = function (e, t) {
                return e + 22 + 75 * (e < 26) - ((0 != t) << 5)
            },
            z = function (e, t, i) {
                var n = 0;
                for (e = i ? V(e / 700) : e >> 1, e += V(e / t); e > 455; n += 36) e = V(e / 35);
                return V(n + 36 * e / (e + 38))
            },
            H = function (e) {
                var t = [],
                    i = e.length,
                    n = 0,
                    r = 128,
                    a = 72,
                    o = e.lastIndexOf("-");
                o < 0 && (o = 0);
                for (var s = 0; s < o; ++s) e.charCodeAt(s) >= 128 && u("not-basic"), t.push(e.charCodeAt(s));
                for (var l = o > 0 ? o + 1 : 0; l < i;) {
                    for (var c = n, h = 1, d = 36;; d += 36) {
                        l >= i && u("invalid-input");
                        var f = G(e.charCodeAt(l++));
                        (f >= 36 || f > V((F - n) / h)) && u("overflow"), n += f * h;
                        var p = d <= a ? 1 : d >= a + 26 ? 26 : d - a;
                        if (f < p) break;
                        var m = 36 - p;
                        h > V(F / m) && u("overflow"), h *= m
                    }
                    var g = t.length + 1;
                    a = z(n - c, g, 0 == c), V(n / g) > F - r && u("overflow"), r += V(n / g), n %= g, t.splice(n++, 0, r)
                }
                return String.fromCodePoint.apply(String, t)
            },
            W = function (e) {
                var t = [];
                e = h(e);
                var i = e.length,
                    n = 128,
                    r = 0,
                    a = 72,
                    o = !0,
                    s = !1,
                    l = void 0;
                try {
                    for (var c, d = e[Symbol.iterator](); !(o = (c = d.next()).done); o = !0) {
                        var f = c.value;
                        f < 128 && t.push(B(f))
                    }
                } catch (e) {
                    s = !0, l = e
                } finally {
                    try {
                        !o && d.return && d.return()
                    } finally {
                        if (s) throw l
                    }
                }
                var p = t.length,
                    m = p;
                for (p && t.push("-"); m < i;) {
                    var g = F,
                        v = !0,
                        _ = !1,
                        b = void 0;
                    try {
                        for (var S, x = e[Symbol.iterator](); !(v = (S = x.next()).done); v = !0) {
                            var y = S.value;
                            y >= n && y < g && (g = y)
                        }
                    } catch (e) {
                        _ = !0, b = e
                    } finally {
                        try {
                            !v && x.return && x.return()
                        } finally {
                            if (_) throw b
                        }
                    }
                    var C = m + 1;
                    g - n > V((F - r) / C) && u("overflow"), r += (g - n) * C, n = g;
                    var T = !0,
                        w = !1,
                        M = void 0;
                    try {
                        for (var E, A = e[Symbol.iterator](); !(T = (E = A.next()).done); T = !0) {
                            var P = E.value;
                            if (P < n && ++r > F && u("overflow"), P == n) {
                                for (var R = r, O = 36;; O += 36) {
                                    var I = O <= a ? 1 : O >= a + 26 ? 26 : O - a;
                                    if (R < I) break;
                                    var N = R - I,
                                        D = 36 - I;
                                    t.push(B(j(I + N % D, 0))), R = V(N / D)
                                }
                                t.push(B(j(R, 0))), a = z(r, C, m == p), r = 0, ++m
                            }
                        }
                    } catch (e) {
                        w = !0, M = e
                    } finally {
                        try {
                            !T && A.return && A.return()
                        } finally {
                            if (w) throw M
                        }
                    }++r, ++n
                }
                return t.join("")
            },
            q = function (e) {
                return c(e, function (e) {
                    return N.test(e) ? H(e.slice(4).toLowerCase()) : e
                })
            },
            X = function (e) {
                return c(e, function (e) {
                    return D.test(e) ? "xn--" + W(e) : e
                })
            },
            Y = {
                version: "2.1.0",
                ucs2: {
                    decode: h,
                    encode: U
                },
                decode: H,
                encode: W,
                toASCII: X,
                toUnicode: q
            },
            K = {},
            $ = /^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,
            Q = void 0 === "".match(/(){0}/)[1],
            J = /^\.\.?\//,
            Z = /^\/\.(\/|$)/,
            ee = /^\/\.\.(\/|$)/,
            te = /^\/?(?:.|\n)*?(?=\/|$)/,
            ie = {
                scheme: "http",
                domainHost: !0,
                parse: function (e, t) {
                    return e.host || (e.error = e.error || "HTTP URIs must have a host."), e
                },
                serialize: function (e, t) {
                    return e.port !== ("https" !== String(e.scheme).toLowerCase() ? 80 : 443) && "" !== e.port || (e.port = void 0), e.path || (e.path = "/"), e
                }
            },
            ne = {
                scheme: "https",
                domainHost: ie.domainHost,
                parse: ie.parse,
                serialize: ie.serialize
            },
            re = {},
            ae = "[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",
            oe = "[0-9A-Fa-f]",
            se = i(i("%[EFef][0-9A-Fa-f]%" + oe + oe + "%" + oe + oe) + "|" + i("%[89A-Fa-f][0-9A-Fa-f]%" + oe + oe) + "|" + i("%" + oe + oe)),
            ue = t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]", '[\\"\\\\]'),
            le = new RegExp(ae, "g"),
            ce = new RegExp(se, "g"),
            he = new RegExp(t("[^]", "[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]", "[\\.]", '[\\"]', ue), "g"),
            de = new RegExp(t("[^]", ae, "[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]"), "g"),
            fe = de,
            pe = {
                scheme: "mailto",
                parse: function (e, t) {
                    var i = e,
                        n = i.to = i.path ? i.path.split(",") : [];
                    if (i.path = void 0, i.query) {
                        for (var r = !1, a = {}, o = i.query.split("&"), s = 0, u = o.length; s < u; ++s) {
                            var l = o[s].split("=");
                            switch (l[0]) {
                                case "to":
                                    for (var c = l[1].split(","), h = 0, d = c.length; h < d; ++h) n.push(c[h]);
                                    break;
                                case "subject":
                                    i.subject = E(l[1], t);
                                    break;
                                case "body":
                                    i.body = E(l[1], t);
                                    break;
                                default:
                                    r = !0, a[E(l[0], t)] = E(l[1], t)
                            }
                        }
                        r && (i.headers = a)
                    }
                    i.query = void 0;
                    for (var f = 0, p = n.length; f < p; ++f) {
                        var m = n[f].split("@");
                        if (m[0] = E(m[0]), t.unicodeSupport) m[1] = E(m[1], t).toLowerCase();
                        else try {
                            m[1] = Y.toASCII(E(m[1], t).toLowerCase())
                        } catch (e) {
                            i.error = i.error || "Email address's domain name can not be converted to ASCII via punycode: " + e
                        }
                        n[f] = m.join("@")
                    }
                    return i
                },
                serialize: function (e, t) {
                    var i = e,
                        n = a(e.to);
                    if (n) {
                        for (var o = 0, s = n.length; o < s; ++o) {
                            var u = String(n[o]),
                                l = u.lastIndexOf("@"),
                                c = u.slice(0, l).replace(ce, A).replace(ce, r).replace(he, d),
                                h = u.slice(l + 1);
                            try {
                                h = t.iri ? Y.toUnicode(h) : Y.toASCII(E(h, t).toLowerCase())
                            } catch (e) {
                                i.error = i.error || "Email address's domain name can not be converted to " + (t.iri ? "Unicode" : "ASCII") + " via punycode: " + e
                            }
                            n[o] = c + "@" + h
                        }
                        i.path = n.join(",")
                    }
                    var f = e.headers = e.headers || {};
                    e.subject && (f.subject = e.subject), e.body && (f.body = e.body);
                    var p = [];
                    for (var m in f) f[m] !== re[m] && p.push(m.replace(ce, A).replace(ce, r).replace(de, d) + "=" + f[m].replace(ce, A).replace(ce, r).replace(fe, d));
                    return p.length && (i.query = p.join("&")), i
                }
            },
            me = /^([^\:]+)\:(.*)/,
            ge = {
                scheme: "urn",
                parse: function (e, t) {
                    var i = e.path && e.path.match(me),
                        n = e;
                    if (i) {
                        var r = t.scheme || n.scheme || "urn",
                            a = i[1].toLowerCase(),
                            o = i[2],
                            s = r + ":" + (t.nid || a),
                            u = K[s];
                        n.nid = a, n.nss = o, n.path = void 0, u && (n = u.parse(n, t))
                    } else n.error = n.error || "URN can not be parsed.";
                    return n
                },
                serialize: function (e, t) {
                    var i = t.scheme || e.scheme || "urn",
                        n = e.nid,
                        r = i + ":" + (t.nid || n),
                        a = K[r];
                    a && (e = a.serialize(e, t));
                    var o = e,
                        s = e.nss;
                    return o.path = (n || t.nid) + ":" + s, o
                }
            },
            ve = /^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,
            _e = {
                scheme: "urn:uuid",
                parse: function (e, t) {
                    var i = e;
                    return i.uuid = i.nss, i.nss = void 0, t.tolerant || i.uuid && i.uuid.match(ve) || (i.error = i.error || "UUID is not valid."), i
                },
                serialize: function (e, t) {
                    var i = e;
                    return i.nss = (e.uuid || "").toLowerCase(), i
                }
            };
        K[ie.scheme] = ie, K[ne.scheme] = ne, K[pe.scheme] = pe, K[ge.scheme] = ge, K[_e.scheme] = _e, e.SCHEMES = K, e.pctEncChar = d, e.pctDecChars = f, e.parse = _, e.removeDotSegments = S, e.serialize = x, e.resolveComponents = y, e.resolve = C, e.normalize = T, e.equal = w, e.escapeComponent = M, e.unescapeComponent = E, Object.defineProperty(e, "__esModule", {
            value: !0
        })
    })
}, function (e, t, i) {
    "use strict";
    e.exports = function (e) {
        for (var t, i = 0, n = e.length, r = 0; r < n;) i++, (t = e.charCodeAt(r++)) >= 55296 && t <= 56319 && r < n && 56320 == (64512 & (t = e.charCodeAt(r))) && r++;
        return i
    }
}, function (e, t, i) {
    "use strict";

    function n(e, t, i, o, s, u, l, c, h) {
        if (i && "object" == typeof i && !Array.isArray(i)) {
            t(i, o, s, u, l, c, h);
            for (var d in i) {
                var f = i[d];
                if (Array.isArray(f)) {
                    if (d in a.arrayKeywords)
                        for (var p = 0; p < f.length; p++) n(e, t, f[p], o + "/" + d + "/" + p, s, o, d, i, p)
                } else if (d in a.propsKeywords) {
                    if (f && "object" == typeof f)
                        for (var m in f) n(e, t, f[m], o + "/" + d + "/" + r(m), s, o, d, i, m)
                } else(d in a.keywords || e.allKeys && !(d in a.skipKeywords)) && n(e, t, f, o + "/" + d, s, o, d, i)
            }
        }
    }

    function r(e) {
        return e.replace(/~/g, "~0").replace(/\//g, "~1")
    }
    var a = e.exports = function (e, t, i) {
        "function" == typeof t && (i = t, t = {}), n(t, i, e, "", e)
    };
    a.keywords = {
        additionalItems: !0,
        items: !0,
        contains: !0,
        additionalProperties: !0,
        propertyNames: !0,
        not: !0
    }, a.arrayKeywords = {
        items: !0,
        allOf: !0,
        anyOf: !0,
        oneOf: !0
    }, a.propsKeywords = {
        definitions: !0,
        properties: !0,
        patternProperties: !0,
        dependencies: !0
    }, a.skipKeywords = {
        enum: !0,
        const: !0,
        required: !0,
        maximum: !0,
        minimum: !0,
        exclusiveMaximum: !0,
        exclusiveMinimum: !0,
        multipleOf: !0,
        maxLength: !0,
        minLength: !0,
        pattern: !0,
        format: !0,
        maxItems: !0,
        minItems: !0,
        uniqueItems: !0,
        maxProperties: !0,
        minProperties: !0
    }
}, function (e, t, i) {
    "use strict";
    var n = e.exports = function () {
        this._cache = {}
    };
    n.prototype.put = function (e, t) {
        this._cache[e] = t
    }, n.prototype.get = function (e) {
        return this._cache[e]
    }, n.prototype.del = function (e) {
        delete this._cache[e]
    }, n.prototype.clear = function () {
        this._cache = {}
    }
}, function (e, t, i) {
    "use strict";

    function n(e) {
        return e = "full" == e ? "full" : "fast", h.copy(n[e])
    }

    function r(e) {
        return e % 4 == 0 && (e % 100 != 0 || e % 400 == 0)
    }

    function a(e) {
        var t = e.match(d);
        if (!t) return !1;
        var i = +t[1],
            n = +t[2],
            a = +t[3];
        return n >= 1 && n <= 12 && a >= 1 && a <= (2 == n && r(i) ? 29 : f[n])
    }

    function o(e, t) {
        var i = e.match(p);
        if (!i) return !1;
        var n = i[1],
            r = i[2],
            a = i[3],
            o = i[5];
        return (n <= 23 && r <= 59 && a <= 59 || 23 == n && 59 == r && 60 == a) && (!t || o)
    }

    function s(e) {
        var t = e.split(T);
        return 2 == t.length && a(t[0]) && o(t[1], !0)
    }

    function u(e) {
        return e.length <= 255 && m.test(e)
    }

    function l(e) {
        return w.test(e) && g.test(e)
    }

    function c(e) {
        if (M.test(e)) return !1;
        try {
            return new RegExp(e), !0
        } catch (e) {
            return !1
        }
    }
    var h = i(455),
        d = /^(\d\d\d\d)-(\d\d)-(\d\d)$/,
        f = [0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31],
        p = /^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d:\d\d)?$/i,
        m = /^[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*$/i,
        g = /^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@\/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@\/?]|%[0-9a-f]{2})*)?$/i,
        v = /^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@\/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@\/?]|%[0-9a-f]{2})*)?$/i,
        _ = /^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#.\/;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,
        b = /^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,
        S = /^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,
        x = /^(?:\/(?:[^~\/]|~0|~1)*)*$/,
        y = /^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,
        C = /^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~\/]|~0|~1)*)*)$/;
    e.exports = n, n.fast = {
        date: /^\d\d\d\d-[0-1]\d-[0-3]\d$/,
        time: /^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d:\d\d)?$/i,
        "date-time": /^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d:\d\d)$/i,
        uri: /^(?:[a-z][a-z0-9+-.]*:)(?:\/?\/)?[^\s]*$/i,
        "uri-reference": /^(?:(?:[a-z][a-z0-9+-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,
        "uri-template": _,
        url: b,
        email: /^[a-z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,
        hostname: m,
        ipv4: /^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,
        ipv6: /^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,
        regex: c,
        uuid: S,
        "json-pointer": x,
        "json-pointer-uri-fragment": y,
        "relative-json-pointer": C
    }, n.full = {
        date: a,
        time: o,
        "date-time": s,
        uri: l,
        "uri-reference": v,
        "uri-template": _,
        url: b,
        email: /^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&''*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,
        hostname: u,
        ipv4: /^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,
        ipv6: /^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,
        regex: c,
        uuid: S,
        "json-pointer": x,
        "json-pointer-uri-fragment": y,
        "relative-json-pointer": C
    };
    var T = /t|\s/i,
        w = /\/|:/,
        M = /[^\\]\\Z/
}, function (e, t, i) {
    "use strict";
    var n = i(1146),
        r = i(455).toHash;
    e.exports = function () {
        var e = [{
                type: "number",
                rules: [{
                    maximum: ["exclusiveMaximum"]
                }, {
                    minimum: ["exclusiveMinimum"]
                }, "multipleOf", "format"]
            }, {
                type: "string",
                rules: ["maxLength", "minLength", "pattern", "format"]
            }, {
                type: "array",
                rules: ["maxItems", "minItems", "items", "contains", "uniqueItems"]
            }, {
                type: "object",
                rules: ["maxProperties", "minProperties", "required", "dependencies", "propertyNames", {
                    properties: ["additionalProperties", "patternProperties"]
                }]
            }, {
                rules: ["$ref", "const", "enum", "not", "anyOf", "oneOf", "allOf", "if"]
            }],
            t = ["type", "$comment"],
            i = ["$schema", "$id", "id", "$data", "title", "description", "default", "definitions", "examples", "readOnly", "writeOnly", "contentMediaType", "contentEncoding", "additionalItems", "then", "else"],
            a = ["number", "integer", "string", "array", "object", "boolean", "null"];
        return e.all = r(t), e.types = r(a), e.forEach(function (i) {
            i.rules = i.rules.map(function (i) {
                var r;
                if ("object" == typeof i) {
                    var a = Object.keys(i)[0];
                    r = i[a], i = a, r.forEach(function (i) {
                        t.push(i), e.all[i] = !0
                    })
                }
                return t.push(i), e.all[i] = {
                    keyword: i,
                    code: n[i],
                    implements: r
                }
            }), e.all.$comment = {
                keyword: "$comment",
                code: n.$comment
            }, i.type && (e.types[i.type] = i)
        }), e.keywords = r(t.concat(i)), e.custom = {}, e
    }
}, function (e, t, i) {
    "use strict";
    e.exports = {
        $ref: i(1147),
        allOf: i(1148),
        anyOf: i(1149),
        $comment: i(1150),
        const: i(1151),
        contains: i(1152),
        dependencies: i(1153),
        enum: i(1154),
        format: i(1155),
        if: i(1156),
        items: i(1157),
        maximum: i(911),
        minimum: i(911),
        maxItems: i(912),
        minItems: i(912),
        maxLength: i(913),
        minLength: i(913),
        maxProperties: i(914),
        minProperties: i(914),
        multipleOf: i(1158),
        not: i(1159),
        oneOf: i(1160),
        pattern: i(1161),
        properties: i(1162),
        propertyNames: i(1163),
        required: i(1164),
        uniqueItems: i(1165),
        validate: i(910)
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n, r, a = " ",
            o = e.level,
            s = e.dataLevel,
            u = e.schema[t],
            l = e.errSchemaPath + "/" + t,
            c = !e.opts.allErrors,
            h = "data" + (s || ""),
            d = "valid" + o;
        if ("#" == u || "#/" == u) e.isRoot ? (n = e.async, r = "validate") : (n = !0 === e.root.schema.$async, r = "root.refVal[0]");
        else {
            var f = e.resolveRef(e.baseId, u, e.isRoot);
            if (void 0 === f) {
                var p = e.MissingRefError.message(e.baseId, u);
                if ("fail" == e.opts.missingRefs) {
                    e.logger.error(p);
                    var m = m || [];
                    m.push(a), a = "", !1 !== e.createErrors ? (a += " { keyword: '$ref' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(l) + " , params: { ref: '" + e.util.escapeQuotes(u) + "' } ", !1 !== e.opts.messages && (a += " , message: 'can\\'t resolve reference " + e.util.escapeQuotes(u) + "' "), e.opts.verbose && (a += " , schema: " + e.util.toQuotedString(u) + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + h + " "), a += " } ") : a += " {} ";
                    var g = a;
                    a = m.pop(), !e.compositeRule && c ? e.async ? a += " throw new ValidationError([" + g + "]); " : a += " validate.errors = [" + g + "]; return false; " : a += " var err = " + g + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", c && (a += " if (false) { ")
                } else {
                    if ("ignore" != e.opts.missingRefs) throw new e.MissingRefError(e.baseId, u, p);
                    e.logger.warn(p), c && (a += " if (true) { ")
                }
            } else if (f.inline) {
                var v = e.util.copy(e);
                v.level++;
                var _ = "valid" + v.level;
                v.schema = f.schema, v.schemaPath = "", v.errSchemaPath = u;
                var b = e.validate(v).replace(/validate\.schema/g, f.code);
                a += " " + b + " ", c && (a += " if (" + _ + ") { ")
            } else n = !0 === f.$async || e.async && !1 !== f.$async, r = f.code
        }
        if (r) {
            var m = m || [];
            m.push(a), a = "", e.opts.passContext ? a += " " + r + ".call(this, " : a += " " + r + "( ", a += " " + h + ", (dataPath || '')", '""' != e.errorPath && (a += " + " + e.errorPath);
            a += " , " + (s ? "data" + (s - 1 || "") : "parentData") + " , " + (s ? e.dataPathArr[s] : "parentDataProperty") + ", rootData)  ";
            var S = a;
            if (a = m.pop(), n) {
                if (!e.async) throw new Error("async schema referenced by sync schema");
                c && (a += " var " + d + "; "), a += " try { await " + S + "; ", c && (a += " " + d + " = true; "), a += " } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ", c && (a += " " + d + " = false; "), a += " } ", c && (a += " if (" + d + ") { ")
            } else a += " if (!" + S + ") { if (vErrors === null) vErrors = " + r + ".errors; else vErrors = vErrors.concat(" + r + ".errors); errors = vErrors.length; } ", c && (a += " else { ")
        }
        return a
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n = " ",
            r = e.schema[t],
            a = e.schemaPath + e.util.getProperty(t),
            o = e.errSchemaPath + "/" + t,
            s = !e.opts.allErrors,
            u = e.util.copy(e),
            l = "";
        u.level++;
        var c = "valid" + u.level,
            h = u.baseId,
            d = !0,
            f = r;
        if (f)
            for (var p, m = -1, g = f.length - 1; m < g;) p = f[m += 1], e.util.schemaHasRules(p, e.RULES.all) && (d = !1, u.schema = p, u.schemaPath = a + "[" + m + "]", u.errSchemaPath = o + "/" + m, n += "  " + e.validate(u) + " ", u.baseId = h, s && (n += " if (" + c + ") { ", l += "}"));
        return s && (n += d ? " if (true) { " : " " + l.slice(0, -1) + " "), n = e.util.cleanUpCode(n)
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n = " ",
            r = e.level,
            a = e.dataLevel,
            o = e.schema[t],
            s = e.schemaPath + e.util.getProperty(t),
            u = e.errSchemaPath + "/" + t,
            l = !e.opts.allErrors,
            c = "data" + (a || ""),
            h = "valid" + r,
            d = "errs__" + r,
            f = e.util.copy(e),
            p = "";
        f.level++;
        var m = "valid" + f.level;
        if (o.every(function (t) {
                return e.util.schemaHasRules(t, e.RULES.all)
            })) {
            var g = f.baseId;
            n += " var " + d + " = errors; var " + h + " = false;  ";
            var v = e.compositeRule;
            e.compositeRule = f.compositeRule = !0;
            var _ = o;
            if (_)
                for (var b, S = -1, x = _.length - 1; S < x;) b = _[S += 1], f.schema = b, f.schemaPath = s + "[" + S + "]", f.errSchemaPath = u + "/" + S, n += "  " + e.validate(f) + " ", f.baseId = g, n += " " + h + " = " + h + " || " + m + "; if (!" + h + ") { ", p += "}";
            e.compositeRule = f.compositeRule = v, n += " " + p + " if (!" + h + ") {   var err =   ", !1 !== e.createErrors ? (n += " { keyword: 'anyOf' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(u) + " , params: {} ", !1 !== e.opts.messages && (n += " , message: 'should match some schema in anyOf' "), e.opts.verbose && (n += " , schema: validate.schema" + s + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + c + " "), n += " } ") : n += " {} ", n += ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", !e.compositeRule && l && (e.async ? n += " throw new ValidationError(vErrors); " : n += " validate.errors = vErrors; return false; "), n += " } else {  errors = " + d + "; if (vErrors !== null) { if (" + d + ") vErrors.length = " + d + "; else vErrors = null; } ", e.opts.allErrors && (n += " } "), n = e.util.cleanUpCode(n)
        } else l && (n += " if (true) { ");
        return n
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n = " ",
            r = e.schema[t],
            a = e.errSchemaPath + "/" + t,
            o = (e.opts.allErrors, e.util.toQuotedString(r));
        return !0 === e.opts.$comment ? n += " console.log(" + o + ");" : "function" == typeof e.opts.$comment && (n += " self._opts.$comment(" + o + ", " + e.util.toQuotedString(a) + ", validate.root.schema);"), n
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n = " ",
            r = e.level,
            a = e.dataLevel,
            o = e.schema[t],
            s = e.schemaPath + e.util.getProperty(t),
            u = e.errSchemaPath + "/" + t,
            l = !e.opts.allErrors,
            c = "data" + (a || ""),
            h = "valid" + r,
            d = e.opts.$data && o && o.$data;
        d && (n += " var schema" + r + " = " + e.util.getData(o.$data, a, e.dataPathArr) + "; "), d || (n += " var schema" + r + " = validate.schema" + s + ";"), n += "var " + h + " = equal(" + c + ", schema" + r + "); if (!" + h + ") {   ";
        var f = f || [];
        f.push(n), n = "", !1 !== e.createErrors ? (n += " { keyword: 'const' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(u) + " , params: { allowedValue: schema" + r + " } ", !1 !== e.opts.messages && (n += " , message: 'should be equal to constant' "), e.opts.verbose && (n += " , schema: validate.schema" + s + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + c + " "), n += " } ") : n += " {} ";
        var p = n;
        return n = f.pop(), !e.compositeRule && l ? e.async ? n += " throw new ValidationError([" + p + "]); " : n += " validate.errors = [" + p + "]; return false; " : n += " var err = " + p + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", n += " }", l && (n += " else { "), n
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n = " ",
            r = e.level,
            a = e.dataLevel,
            o = e.schema[t],
            s = e.schemaPath + e.util.getProperty(t),
            u = e.errSchemaPath + "/" + t,
            l = !e.opts.allErrors,
            c = "data" + (a || ""),
            h = "valid" + r,
            d = "errs__" + r,
            f = e.util.copy(e);
        f.level++;
        var p = "valid" + f.level,
            m = "i" + r,
            g = f.dataLevel = e.dataLevel + 1,
            v = "data" + g,
            _ = e.baseId,
            b = e.util.schemaHasRules(o, e.RULES.all);
        if (n += "var " + d + " = errors;var " + h + ";", b) {
            var S = e.compositeRule;
            e.compositeRule = f.compositeRule = !0, f.schema = o, f.schemaPath = s, f.errSchemaPath = u, n += " var " + p + " = false; for (var " + m + " = 0; " + m + " < " + c + ".length; " + m + "++) { ", f.errorPath = e.util.getPathExpr(e.errorPath, m, e.opts.jsonPointers, !0);
            var x = c + "[" + m + "]";
            f.dataPathArr[g] = m;
            var y = e.validate(f);
            f.baseId = _, e.util.varOccurences(y, v) < 2 ? n += " " + e.util.varReplace(y, v, x) + " " : n += " var " + v + " = " + x + "; " + y + " ", n += " if (" + p + ") break; }  ", e.compositeRule = f.compositeRule = S, n += "  if (!" + p + ") {"
        } else n += " if (" + c + ".length == 0) {";
        var C = C || [];
        C.push(n), n = "", !1 !== e.createErrors ? (n += " { keyword: 'contains' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(u) + " , params: {} ", !1 !== e.opts.messages && (n += " , message: 'should contain a valid item' "), e.opts.verbose && (n += " , schema: validate.schema" + s + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + c + " "), n += " } ") : n += " {} ";
        var T = n;
        return n = C.pop(), !e.compositeRule && l ? e.async ? n += " throw new ValidationError([" + T + "]); " : n += " validate.errors = [" + T + "]; return false; " : n += " var err = " + T + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", n += " } else { ", b && (n += "  errors = " + d + "; if (vErrors !== null) { if (" + d + ") vErrors.length = " + d + "; else vErrors = null; } "), e.opts.allErrors && (n += " } "), n = e.util.cleanUpCode(n)
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n = " ",
            r = e.level,
            a = e.dataLevel,
            o = e.schema[t],
            s = e.schemaPath + e.util.getProperty(t),
            u = e.errSchemaPath + "/" + t,
            l = !e.opts.allErrors,
            c = "data" + (a || ""),
            h = "errs__" + r,
            d = e.util.copy(e),
            f = "";
        d.level++;
        var p = "valid" + d.level,
            m = {},
            g = {},
            v = e.opts.ownProperties;
        for (x in o) {
            var _ = o[x],
                b = Array.isArray(_) ? g : m;
            b[x] = _
        }
        n += "var " + h + " = errors;";
        var S = e.errorPath;
        n += "var missing" + r + ";";
        for (var x in g)
            if (b = g[x], b.length) {
                if (n += " if ( " + c + e.util.getProperty(x) + " !== undefined ", v && (n += " && Object.prototype.hasOwnProperty.call(" + c + ", '" + e.util.escapeQuotes(x) + "') "), l) {
                    n += " && ( ";
                    var y = b;
                    if (y)
                        for (var C, T = -1, w = y.length - 1; T < w;) {
                            C = y[T += 1], T && (n += " || ");
                            var M = e.util.getProperty(C),
                                E = c + M;
                            n += " ( ( " + E + " === undefined ", v && (n += " || ! Object.prototype.hasOwnProperty.call(" + c + ", '" + e.util.escapeQuotes(C) + "') "), n += ") && (missing" + r + " = " + e.util.toQuotedString(e.opts.jsonPointers ? C : M) + ") ) "
                        }
                    n += ")) {  ";
                    var A = "missing" + r,
                        P = "' + " + A + " + '";
                    e.opts._errorDataPathProperty && (e.errorPath = e.opts.jsonPointers ? e.util.getPathExpr(S, A, !0) : S + " + " + A);
                    var R = R || [];
                    R.push(n), n = "", !1 !== e.createErrors ? (n += " { keyword: 'dependencies' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(u) + " , params: { property: '" + e.util.escapeQuotes(x) + "', missingProperty: '" + P + "', depsCount: " + b.length + ", deps: '" + e.util.escapeQuotes(1 == b.length ? b[0] : b.join(", ")) + "' } ", !1 !== e.opts.messages && (n += " , message: 'should have ", 1 == b.length ? n += "property " + e.util.escapeQuotes(b[0]) : n += "properties " + e.util.escapeQuotes(b.join(", ")), n += " when property " + e.util.escapeQuotes(x) + " is present' "), e.opts.verbose && (n += " , schema: validate.schema" + s + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + c + " "), n += " } ") : n += " {} ";
                    var O = n;
                    n = R.pop(), !e.compositeRule && l ? e.async ? n += " throw new ValidationError([" + O + "]); " : n += " validate.errors = [" + O + "]; return false; " : n += " var err = " + O + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "
                } else {
                    n += " ) { ";
                    var I = b;
                    if (I)
                        for (var C, F = -1, N = I.length - 1; F < N;) {
                            C = I[F += 1];
                            var M = e.util.getProperty(C),
                                P = e.util.escapeQuotes(C),
                                E = c + M;
                            e.opts._errorDataPathProperty && (e.errorPath = e.util.getPath(S, C, e.opts.jsonPointers)), n += " if ( " + E + " === undefined ", v && (n += " || ! Object.prototype.hasOwnProperty.call(" + c + ", '" + e.util.escapeQuotes(C) + "') "), n += ") {  var err =   ", !1 !== e.createErrors ? (n += " { keyword: 'dependencies' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(u) + " , params: { property: '" + e.util.escapeQuotes(x) + "', missingProperty: '" + P + "', depsCount: " + b.length + ", deps: '" + e.util.escapeQuotes(1 == b.length ? b[0] : b.join(", ")) + "' } ", !1 !== e.opts.messages && (n += " , message: 'should have ", 1 == b.length ? n += "property " + e.util.escapeQuotes(b[0]) : n += "properties " + e.util.escapeQuotes(b.join(", ")), n += " when property " + e.util.escapeQuotes(x) + " is present' "), e.opts.verbose && (n += " , schema: validate.schema" + s + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + c + " "), n += " } ") : n += " {} ", n += ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "
                        }
                }
                n += " }   ", l && (f += "}", n += " else { ")
            } e.errorPath = S;
        var D = d.baseId;
        for (var x in m) {
            var _ = m[x];
            e.util.schemaHasRules(_, e.RULES.all) && (n += " " + p + " = true; if ( " + c + e.util.getProperty(x) + " !== undefined ", v && (n += " && Object.prototype.hasOwnProperty.call(" + c + ", '" + e.util.escapeQuotes(x) + "') "), n += ") { ", d.schema = _, d.schemaPath = s + e.util.getProperty(x), d.errSchemaPath = u + "/" + e.util.escapeFragment(x), n += "  " + e.validate(d) + " ", d.baseId = D, n += " }  ", l && (n += " if (" + p + ") { ", f += "}"))
        }
        return l && (n += "   " + f + " if (" + h + " == errors) {"), n = e.util.cleanUpCode(n)
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n = " ",
            r = e.level,
            a = e.dataLevel,
            o = e.schema[t],
            s = e.schemaPath + e.util.getProperty(t),
            u = e.errSchemaPath + "/" + t,
            l = !e.opts.allErrors,
            c = "data" + (a || ""),
            h = "valid" + r,
            d = e.opts.$data && o && o.$data;
        d && (n += " var schema" + r + " = " + e.util.getData(o.$data, a, e.dataPathArr) + "; ");
        var f = "i" + r,
            p = "schema" + r;
        d || (n += " var " + p + " = validate.schema" + s + ";"), n += "var " + h + ";", d && (n += " if (schema" + r + " === undefined) " + h + " = true; else if (!Array.isArray(schema" + r + ")) " + h + " = false; else {"), n += h + " = false;for (var " + f + "=0; " + f + "<" + p + ".length; " + f + "++) if (equal(" + c + ", " + p + "[" + f + "])) { " + h + " = true; break; }", d && (n += "  }  "), n += " if (!" + h + ") {   ";
        var m = m || [];
        m.push(n), n = "", !1 !== e.createErrors ? (n += " { keyword: 'enum' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(u) + " , params: { allowedValues: schema" + r + " } ", !1 !== e.opts.messages && (n += " , message: 'should be equal to one of the allowed values' "), e.opts.verbose && (n += " , schema: validate.schema" + s + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + c + " "), n += " } ") : n += " {} ";
        var g = n;
        return n = m.pop(), !e.compositeRule && l ? e.async ? n += " throw new ValidationError([" + g + "]); " : n += " validate.errors = [" + g + "]; return false; " : n += " var err = " + g + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", n += " }", l && (n += " else { "), n
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n = " ",
            r = e.level,
            a = e.dataLevel,
            o = e.schema[t],
            s = e.schemaPath + e.util.getProperty(t),
            u = e.errSchemaPath + "/" + t,
            l = !e.opts.allErrors,
            c = "data" + (a || "");
        if (!1 === e.opts.format) return l && (n += " if (true) { "), n;
        var h, d = e.opts.$data && o && o.$data;
        d ? (n += " var schema" + r + " = " + e.util.getData(o.$data, a, e.dataPathArr) + "; ", h = "schema" + r) : h = o;
        var f = e.opts.unknownFormats,
            p = Array.isArray(f);
        if (d) {
            var m = "format" + r,
                g = "isObject" + r,
                v = "formatType" + r;
            n += " var " + m + " = formats[" + h + "]; var " + g + " = typeof " + m + " == 'object' && !(" + m + " instanceof RegExp) && " + m + ".validate; var " + v + " = " + g + " && " + m + ".type || 'string'; if (" + g + ") { ", e.async && (n += " var async" + r + " = " + m + ".async; "), n += " " + m + " = " + m + ".validate; } if (  ", d && (n += " (" + h + " !== undefined && typeof " + h + " != 'string') || "), n += " (", "ignore" != f && (n += " (" + h + " && !" + m + " ", p && (n += " && self._opts.unknownFormats.indexOf(" + h + ") == -1 "), n += ") || "), n += " (" + m + " && " + v + " == '" + i + "' && !(typeof " + m + " == 'function' ? ", e.async ? n += " (async" + r + " ? await " + m + "(" + c + ") : " + m + "(" + c + ")) " : n += " " + m + "(" + c + ") ", n += " : " + m + ".test(" + c + "))))) {"
        } else {
            var m = e.formats[o];
            if (!m) {
                if ("ignore" == f) return e.logger.warn('unknown format "' + o + '" ignored in schema at path "' + e.errSchemaPath + '"'), l && (n += " if (true) { "), n;
                if (p && f.indexOf(o) >= 0) return l && (n += " if (true) { "), n;
                throw new Error('unknown format "' + o + '" is used in schema at path "' + e.errSchemaPath + '"')
            }
            var g = "object" == typeof m && !(m instanceof RegExp) && m.validate,
                v = g && m.type || "string";
            if (g) {
                var _ = !0 === m.async;
                m = m.validate
            }
            if (v != i) return l && (n += " if (true) { "), n;
            if (_) {
                if (!e.async) throw new Error("async format in sync schema");
                var b = "formats" + e.util.getProperty(o) + ".validate";
                n += " if (!(await " + b + "(" + c + "))) { "
            } else {
                n += " if (! ";
                var b = "formats" + e.util.getProperty(o);
                g && (b += ".validate"), n += "function" == typeof m ? " " + b + "(" + c + ") " : " " + b + ".test(" + c + ") ", n += ") { "
            }
        }
        var S = S || [];
        S.push(n), n = "", !1 !== e.createErrors ? (n += " { keyword: 'format' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(u) + " , params: { format:  ", n += d ? "" + h : "" + e.util.toQuotedString(o), n += "  } ", !1 !== e.opts.messages && (n += " , message: 'should match format \"", n += d ? "' + " + h + " + '" : "" + e.util.escapeQuotes(o), n += "\"' "), e.opts.verbose && (n += " , schema:  ", n += d ? "validate.schema" + s : "" + e.util.toQuotedString(o), n += "         , parentSchema: validate.schema" + e.schemaPath + " , data: " + c + " "), n += " } ") : n += " {} ";
        var x = n;
        return n = S.pop(), !e.compositeRule && l ? e.async ? n += " throw new ValidationError([" + x + "]); " : n += " validate.errors = [" + x + "]; return false; " : n += " var err = " + x + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", n += " } ", l && (n += " else { "), n
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n = " ",
            r = e.level,
            a = e.dataLevel,
            o = e.schema[t],
            s = e.schemaPath + e.util.getProperty(t),
            u = e.errSchemaPath + "/" + t,
            l = !e.opts.allErrors,
            c = "data" + (a || ""),
            h = "valid" + r,
            d = "errs__" + r,
            f = e.util.copy(e);
        f.level++;
        var p = "valid" + f.level,
            m = e.schema.then,
            g = e.schema.else,
            v = void 0 !== m && e.util.schemaHasRules(m, e.RULES.all),
            _ = void 0 !== g && e.util.schemaHasRules(g, e.RULES.all),
            b = f.baseId;
        if (v || _) {
            var S;
            f.createErrors = !1, f.schema = o, f.schemaPath = s, f.errSchemaPath = u, n += " var " + d + " = errors; var " + h + " = true;  ";
            var x = e.compositeRule;
            e.compositeRule = f.compositeRule = !0, n += "  " + e.validate(f) + " ", f.baseId = b, f.createErrors = !0, n += "  errors = " + d + "; if (vErrors !== null) { if (" + d + ") vErrors.length = " + d + "; else vErrors = null; }  ", e.compositeRule = f.compositeRule = x, v ? (n += " if (" + p + ") {  ", f.schema = e.schema.then, f.schemaPath = e.schemaPath + ".then", f.errSchemaPath = e.errSchemaPath + "/then", n += "  " + e.validate(f) + " ", f.baseId = b, n += " " + h + " = " + p + "; ", v && _ ? (S = "ifClause" + r, n += " var " + S + " = 'then'; ") : S = "'then'", n += " } ", _ && (n += " else { ")) : n += " if (!" + p + ") { ", _ && (f.schema = e.schema.else, f.schemaPath = e.schemaPath + ".else", f.errSchemaPath = e.errSchemaPath + "/else", n += "  " + e.validate(f) + " ", f.baseId = b, n += " " + h + " = " + p + "; ", v && _ ? (S = "ifClause" + r, n += " var " + S + " = 'else'; ") : S = "'else'", n += " } "), n += " if (!" + h + ") {   var err =   ", !1 !== e.createErrors ? (n += " { keyword: 'if' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(u) + " , params: { failingKeyword: " + S + " } ", !1 !== e.opts.messages && (n += " , message: 'should match \"' + " + S + " + '\" schema' "), e.opts.verbose && (n += " , schema: validate.schema" + s + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + c + " "), n += " } ") : n += " {} ", n += ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", !e.compositeRule && l && (e.async ? n += " throw new ValidationError(vErrors); " : n += " validate.errors = vErrors; return false; "), n += " }   ", l && (n += " else { "), n = e.util.cleanUpCode(n)
        } else l && (n += " if (true) { ");
        return n
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n = " ",
            r = e.level,
            a = e.dataLevel,
            o = e.schema[t],
            s = e.schemaPath + e.util.getProperty(t),
            u = e.errSchemaPath + "/" + t,
            l = !e.opts.allErrors,
            c = "data" + (a || ""),
            h = "valid" + r,
            d = "errs__" + r,
            f = e.util.copy(e),
            p = "";
        f.level++;
        var m = "valid" + f.level,
            g = "i" + r,
            v = f.dataLevel = e.dataLevel + 1,
            _ = "data" + v,
            b = e.baseId;
        if (n += "var " + d + " = errors;var " + h + ";", Array.isArray(o)) {
            var S = e.schema.additionalItems;
            if (!1 === S) {
                n += " " + h + " = " + c + ".length <= " + o.length + "; ";
                var x = u;
                u = e.errSchemaPath + "/additionalItems", n += "  if (!" + h + ") {   ";
                var y = y || [];
                y.push(n), n = "", !1 !== e.createErrors ? (n += " { keyword: 'additionalItems' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(u) + " , params: { limit: " + o.length + " } ", !1 !== e.opts.messages && (n += " , message: 'should NOT have more than " + o.length + " items' "), e.opts.verbose && (n += " , schema: false , parentSchema: validate.schema" + e.schemaPath + " , data: " + c + " "), n += " } ") : n += " {} ";
                var C = n;
                n = y.pop(), !e.compositeRule && l ? e.async ? n += " throw new ValidationError([" + C + "]); " : n += " validate.errors = [" + C + "]; return false; " : n += " var err = " + C + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", n += " } ", u = x, l && (p += "}", n += " else { ")
            }
            var T = o;
            if (T)
                for (var w, M = -1, E = T.length - 1; M < E;)
                    if (w = T[M += 1], e.util.schemaHasRules(w, e.RULES.all)) {
                        n += " " + m + " = true; if (" + c + ".length > " + M + ") { ";
                        var A = c + "[" + M + "]";
                        f.schema = w, f.schemaPath = s + "[" + M + "]", f.errSchemaPath = u + "/" + M, f.errorPath = e.util.getPathExpr(e.errorPath, M, e.opts.jsonPointers, !0), f.dataPathArr[v] = M;
                        var P = e.validate(f);
                        f.baseId = b, e.util.varOccurences(P, _) < 2 ? n += " " + e.util.varReplace(P, _, A) + " " : n += " var " + _ + " = " + A + "; " + P + " ", n += " }  ", l && (n += " if (" + m + ") { ", p += "}")
                    } if ("object" == typeof S && e.util.schemaHasRules(S, e.RULES.all)) {
                f.schema = S, f.schemaPath = e.schemaPath + ".additionalItems", f.errSchemaPath = e.errSchemaPath + "/additionalItems", n += " " + m + " = true; if (" + c + ".length > " + o.length + ") {  for (var " + g + " = " + o.length + "; " + g + " < " + c + ".length; " + g + "++) { ", f.errorPath = e.util.getPathExpr(e.errorPath, g, e.opts.jsonPointers, !0);
                var A = c + "[" + g + "]";
                f.dataPathArr[v] = g;
                var P = e.validate(f);
                f.baseId = b, e.util.varOccurences(P, _) < 2 ? n += " " + e.util.varReplace(P, _, A) + " " : n += " var " + _ + " = " + A + "; " + P + " ", l && (n += " if (!" + m + ") break; "), n += " } }  ", l && (n += " if (" + m + ") { ", p += "}")
            }
        } else if (e.util.schemaHasRules(o, e.RULES.all)) {
            f.schema = o, f.schemaPath = s, f.errSchemaPath = u, n += "  for (var " + g + " = 0; " + g + " < " + c + ".length; " + g + "++) { ", f.errorPath = e.util.getPathExpr(e.errorPath, g, e.opts.jsonPointers, !0);
            var A = c + "[" + g + "]";
            f.dataPathArr[v] = g;
            var P = e.validate(f);
            f.baseId = b, e.util.varOccurences(P, _) < 2 ? n += " " + e.util.varReplace(P, _, A) + " " : n += " var " + _ + " = " + A + "; " + P + " ", l && (n += " if (!" + m + ") break; "), n += " }"
        }
        return l && (n += " " + p + " if (" + d + " == errors) {"), n = e.util.cleanUpCode(n)
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n, r = " ",
            a = e.level,
            o = e.dataLevel,
            s = e.schema[t],
            u = e.schemaPath + e.util.getProperty(t),
            l = e.errSchemaPath + "/" + t,
            c = !e.opts.allErrors,
            h = "data" + (o || ""),
            d = e.opts.$data && s && s.$data;
        d ? (r += " var schema" + a + " = " + e.util.getData(s.$data, o, e.dataPathArr) + "; ", n = "schema" + a) : n = s, r += "var division" + a + ";if (", d && (r += " " + n + " !== undefined && ( typeof " + n + " != 'number' || "), r += " (division" + a + " = " + h + " / " + n + ", ", e.opts.multipleOfPrecision ? r += " Math.abs(Math.round(division" + a + ") - division" + a + ") > 1e-" + e.opts.multipleOfPrecision + " " : r += " division" + a + " !== parseInt(division" + a + ") ", r += " ) ", d && (r += "  )  "), r += " ) {   ";
        var f = f || [];
        f.push(r), r = "", !1 !== e.createErrors ? (r += " { keyword: 'multipleOf' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(l) + " , params: { multipleOf: " + n + " } ", !1 !== e.opts.messages && (r += " , message: 'should be multiple of ", r += d ? "' + " + n : n + "'"), e.opts.verbose && (r += " , schema:  ", r += d ? "validate.schema" + u : "" + s, r += "         , parentSchema: validate.schema" + e.schemaPath + " , data: " + h + " "), r += " } ") : r += " {} ";
        var p = r;
        return r = f.pop(), !e.compositeRule && c ? e.async ? r += " throw new ValidationError([" + p + "]); " : r += " validate.errors = [" + p + "]; return false; " : r += " var err = " + p + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", r += "} ", c && (r += " else { "), r
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n = " ",
            r = e.level,
            a = e.dataLevel,
            o = e.schema[t],
            s = e.schemaPath + e.util.getProperty(t),
            u = e.errSchemaPath + "/" + t,
            l = !e.opts.allErrors,
            c = "data" + (a || ""),
            h = "errs__" + r,
            d = e.util.copy(e);
        d.level++;
        var f = "valid" + d.level;
        if (e.util.schemaHasRules(o, e.RULES.all)) {
            d.schema = o, d.schemaPath = s, d.errSchemaPath = u, n += " var " + h + " = errors;  ";
            var p = e.compositeRule;
            e.compositeRule = d.compositeRule = !0, d.createErrors = !1;
            var m;
            d.opts.allErrors && (m = d.opts.allErrors, d.opts.allErrors = !1), n += " " + e.validate(d) + " ", d.createErrors = !0, m && (d.opts.allErrors = m), e.compositeRule = d.compositeRule = p, n += " if (" + f + ") {   ";
            var g = g || [];
            g.push(n), n = "", !1 !== e.createErrors ? (n += " { keyword: 'not' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(u) + " , params: {} ", !1 !== e.opts.messages && (n += " , message: 'should NOT be valid' "), e.opts.verbose && (n += " , schema: validate.schema" + s + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + c + " "), n += " } ") : n += " {} ";
            var v = n;
            n = g.pop(), !e.compositeRule && l ? e.async ? n += " throw new ValidationError([" + v + "]); " : n += " validate.errors = [" + v + "]; return false; " : n += " var err = " + v + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", n += " } else {  errors = " + h + "; if (vErrors !== null) { if (" + h + ") vErrors.length = " + h + "; else vErrors = null; } ", e.opts.allErrors && (n += " } ")
        } else n += "  var err =   ", !1 !== e.createErrors ? (n += " { keyword: 'not' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(u) + " , params: {} ", !1 !== e.opts.messages && (n += " , message: 'should NOT be valid' "), e.opts.verbose && (n += " , schema: validate.schema" + s + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + c + " "), n += " } ") : n += " {} ", n += ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", l && (n += " if (false) { ");
        return n
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n = " ",
            r = e.level,
            a = e.dataLevel,
            o = e.schema[t],
            s = e.schemaPath + e.util.getProperty(t),
            u = e.errSchemaPath + "/" + t,
            l = !e.opts.allErrors,
            c = "data" + (a || ""),
            h = "valid" + r,
            d = "errs__" + r,
            f = e.util.copy(e),
            p = "";
        f.level++;
        var m = "valid" + f.level,
            g = f.baseId,
            v = "prevValid" + r,
            _ = "passingSchemas" + r;
        n += "var " + d + " = errors , " + v + " = false , " + h + " = false , " + _ + " = null; ";
        var b = e.compositeRule;
        e.compositeRule = f.compositeRule = !0;
        var S = o;
        if (S)
            for (var x, y = -1, C = S.length - 1; y < C;) x = S[y += 1], e.util.schemaHasRules(x, e.RULES.all) ? (f.schema = x, f.schemaPath = s + "[" + y + "]", f.errSchemaPath = u + "/" + y, n += "  " + e.validate(f) + " ", f.baseId = g) : n += " var " + m + " = true; ", y && (n += " if (" + m + " && " + v + ") { " + h + " = false; " + _ + " = [" + _ + ", " + y + "]; } else { ", p += "}"), n += " if (" + m + ") { " + h + " = " + v + " = true; " + _ + " = " + y + "; }";
        return e.compositeRule = f.compositeRule = b, n += p + "if (!" + h + ") {   var err =   ", !1 !== e.createErrors ? (n += " { keyword: 'oneOf' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(u) + " , params: { passingSchemas: " + _ + " } ", !1 !== e.opts.messages && (n += " , message: 'should match exactly one schema in oneOf' "), e.opts.verbose && (n += " , schema: validate.schema" + s + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + c + " "), n += " } ") : n += " {} ", n += ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", !e.compositeRule && l && (e.async ? n += " throw new ValidationError(vErrors); " : n += " validate.errors = vErrors; return false; "), n += "} else {  errors = " + d + "; if (vErrors !== null) { if (" + d + ") vErrors.length = " + d + "; else vErrors = null; }", e.opts.allErrors && (n += " } "), n
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n, r = " ",
            a = e.level,
            o = e.dataLevel,
            s = e.schema[t],
            u = e.schemaPath + e.util.getProperty(t),
            l = e.errSchemaPath + "/" + t,
            c = !e.opts.allErrors,
            h = "data" + (o || ""),
            d = e.opts.$data && s && s.$data;
        d ? (r += " var schema" + a + " = " + e.util.getData(s.$data, o, e.dataPathArr) + "; ", n = "schema" + a) : n = s;
        var f = d ? "(new RegExp(" + n + "))" : e.usePattern(s);
        r += "if ( ", d && (r += " (" + n + " !== undefined && typeof " + n + " != 'string') || "), r += " !" + f + ".test(" + h + ") ) {   ";
        var p = p || [];
        p.push(r), r = "", !1 !== e.createErrors ? (r += " { keyword: 'pattern' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(l) + " , params: { pattern:  ", r += d ? "" + n : "" + e.util.toQuotedString(s), r += "  } ", !1 !== e.opts.messages && (r += " , message: 'should match pattern \"", r += d ? "' + " + n + " + '" : "" + e.util.escapeQuotes(s), r += "\"' "), e.opts.verbose && (r += " , schema:  ", r += d ? "validate.schema" + u : "" + e.util.toQuotedString(s), r += "         , parentSchema: validate.schema" + e.schemaPath + " , data: " + h + " "), r += " } ") : r += " {} ";
        var m = r;
        return r = p.pop(), !e.compositeRule && c ? e.async ? r += " throw new ValidationError([" + m + "]); " : r += " validate.errors = [" + m + "]; return false; " : r += " var err = " + m + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", r += "} ", c && (r += " else { "), r
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n = " ",
            r = e.level,
            a = e.dataLevel,
            o = e.schema[t],
            s = e.schemaPath + e.util.getProperty(t),
            u = e.errSchemaPath + "/" + t,
            l = !e.opts.allErrors,
            c = "data" + (a || ""),
            h = "errs__" + r,
            d = e.util.copy(e),
            f = "";
        d.level++;
        var p = "valid" + d.level,
            m = "key" + r,
            g = "idx" + r,
            v = d.dataLevel = e.dataLevel + 1,
            _ = "data" + v,
            b = "dataProperties" + r,
            S = Object.keys(o || {}),
            x = e.schema.patternProperties || {},
            y = Object.keys(x),
            C = e.schema.additionalProperties,
            T = S.length || y.length,
            w = !1 === C,
            M = "object" == typeof C && Object.keys(C).length,
            E = e.opts.removeAdditional,
            A = w || M || E,
            P = e.opts.ownProperties,
            R = e.baseId,
            O = e.schema.required;
        if (O && (!e.opts.$data || !O.$data) && O.length < e.opts.loopRequired) var I = e.util.toHash(O);
        if (n += "var " + h + " = errors;var " + p + " = true;", P && (n += " var " + b + " = undefined;"), A) {
            if (n += P ? " " + b + " = " + b + " || Object.keys(" + c + "); for (var " + g + "=0; " + g + "<" + b + ".length; " + g + "++) { var " + m + " = " + b + "[" + g + "]; " : " for (var " + m + " in " + c + ") { ", T) {
                if (n += " var isAdditional" + r + " = !(false ", S.length)
                    if (S.length > 8) n += " || validate.schema" + s + ".hasOwnProperty(" + m + ") ";
                    else {
                        var F = S;
                        if (F)
                            for (var N, D = -1, L = F.length - 1; D < L;) N = F[D += 1], n += " || " + m + " == " + e.util.toQuotedString(N) + " "
                    } if (y.length) {
                    var k = y;
                    if (k)
                        for (var V, B = -1, U = k.length - 1; B < U;) V = k[B += 1], n += " || " + e.usePattern(V) + ".test(" + m + ") "
                }
                n += " ); if (isAdditional" + r + ") { "
            }
            if ("all" == E) n += " delete " + c + "[" + m + "]; ";
            else {
                var G = e.errorPath,
                    j = "' + " + m + " + '";
                if (e.opts._errorDataPathProperty && (e.errorPath = e.util.getPathExpr(e.errorPath, m, e.opts.jsonPointers)), w)
                    if (E) n += " delete " + c + "[" + m + "]; ";
                    else {
                        n += " " + p + " = false; ";
                        var z = u;
                        u = e.errSchemaPath + "/additionalProperties";
                        var H = H || [];
                        H.push(n), n = "", !1 !== e.createErrors ? (n += " { keyword: 'additionalProperties' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(u) + " , params: { additionalProperty: '" + j + "' } ", !1 !== e.opts.messages && (n += " , message: '", e.opts._errorDataPathProperty ? n += "is an invalid additional property" : n += "should NOT have additional properties", n += "' "), e.opts.verbose && (n += " , schema: false , parentSchema: validate.schema" + e.schemaPath + " , data: " + c + " "), n += " } ") : n += " {} ";
                        var W = n;
                        n = H.pop(), !e.compositeRule && l ? e.async ? n += " throw new ValidationError([" + W + "]); " : n += " validate.errors = [" + W + "]; return false; " : n += " var err = " + W + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", u = z, l && (n += " break; ")
                    }
                else if (M)
                    if ("failing" == E) {
                        n += " var " + h + " = errors;  ";
                        var q = e.compositeRule;
                        e.compositeRule = d.compositeRule = !0, d.schema = C, d.schemaPath = e.schemaPath + ".additionalProperties", d.errSchemaPath = e.errSchemaPath + "/additionalProperties", d.errorPath = e.opts._errorDataPathProperty ? e.errorPath : e.util.getPathExpr(e.errorPath, m, e.opts.jsonPointers);
                        var X = c + "[" + m + "]";
                        d.dataPathArr[v] = m;
                        var Y = e.validate(d);
                        d.baseId = R, e.util.varOccurences(Y, _) < 2 ? n += " " + e.util.varReplace(Y, _, X) + " " : n += " var " + _ + " = " + X + "; " + Y + " ", n += " if (!" + p + ") { errors = " + h + "; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete " + c + "[" + m + "]; }  ", e.compositeRule = d.compositeRule = q
                    } else {
                        d.schema = C, d.schemaPath = e.schemaPath + ".additionalProperties", d.errSchemaPath = e.errSchemaPath + "/additionalProperties", d.errorPath = e.opts._errorDataPathProperty ? e.errorPath : e.util.getPathExpr(e.errorPath, m, e.opts.jsonPointers);
                        var X = c + "[" + m + "]";
                        d.dataPathArr[v] = m;
                        var Y = e.validate(d);
                        d.baseId = R, e.util.varOccurences(Y, _) < 2 ? n += " " + e.util.varReplace(Y, _, X) + " " : n += " var " + _ + " = " + X + "; " + Y + " ", l && (n += " if (!" + p + ") break; ")
                    } e.errorPath = G
            }
            T && (n += " } "), n += " }  ", l && (n += " if (" + p + ") { ", f += "}")
        }
        var K = e.opts.useDefaults && !e.compositeRule;
        if (S.length) {
            var $ = S;
            if ($)
                for (var N, Q = -1, J = $.length - 1; Q < J;) {
                    N = $[Q += 1];
                    var Z = o[N];
                    if (e.util.schemaHasRules(Z, e.RULES.all)) {
                        var ee = e.util.getProperty(N),
                            X = c + ee,
                            te = K && void 0 !== Z.default;
                        d.schema = Z, d.schemaPath = s + ee, d.errSchemaPath = u + "/" + e.util.escapeFragment(N), d.errorPath = e.util.getPath(e.errorPath, N, e.opts.jsonPointers), d.dataPathArr[v] = e.util.toQuotedString(N);
                        var Y = e.validate(d);
                        if (d.baseId = R, e.util.varOccurences(Y, _) < 2) {
                            Y = e.util.varReplace(Y, _, X);
                            var ie = X
                        } else {
                            var ie = _;
                            n += " var " + _ + " = " + X + "; "
                        }
                        if (te) n += " " + Y + " ";
                        else {
                            if (I && I[N]) {
                                n += " if ( " + ie + " === undefined ", P && (n += " || ! Object.prototype.hasOwnProperty.call(" + c + ", '" + e.util.escapeQuotes(N) + "') "), n += ") { " + p + " = false; ";
                                var G = e.errorPath,
                                    z = u,
                                    ne = e.util.escapeQuotes(N);
                                e.opts._errorDataPathProperty && (e.errorPath = e.util.getPath(G, N, e.opts.jsonPointers)), u = e.errSchemaPath + "/required";
                                var H = H || [];
                                H.push(n), n = "", !1 !== e.createErrors ? (n += " { keyword: 'required' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(u) + " , params: { missingProperty: '" + ne + "' } ", !1 !== e.opts.messages && (n += " , message: '", e.opts._errorDataPathProperty ? n += "is a required property" : n += "should have required property \\'" + ne + "\\'", n += "' "), e.opts.verbose && (n += " , schema: validate.schema" + s + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + c + " "), n += " } ") : n += " {} ";
                                var W = n;
                                n = H.pop(), !e.compositeRule && l ? e.async ? n += " throw new ValidationError([" + W + "]); " : n += " validate.errors = [" + W + "]; return false; " : n += " var err = " + W + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", u = z, e.errorPath = G, n += " } else { "
                            } else l ? (n += " if ( " + ie + " === undefined ", P && (n += " || ! Object.prototype.hasOwnProperty.call(" + c + ", '" + e.util.escapeQuotes(N) + "') "), n += ") { " + p + " = true; } else { ") : (n += " if (" + ie + " !== undefined ", P && (n += " &&   Object.prototype.hasOwnProperty.call(" + c + ", '" + e.util.escapeQuotes(N) + "') "), n += " ) { ");
                            n += " " + Y + " } "
                        }
                    }
                    l && (n += " if (" + p + ") { ", f += "}")
                }
        }
        if (y.length) {
            var re = y;
            if (re)
                for (var V, ae = -1, oe = re.length - 1; ae < oe;) {
                    V = re[ae += 1];
                    var Z = x[V];
                    if (e.util.schemaHasRules(Z, e.RULES.all)) {
                        d.schema = Z, d.schemaPath = e.schemaPath + ".patternProperties" + e.util.getProperty(V), d.errSchemaPath = e.errSchemaPath + "/patternProperties/" + e.util.escapeFragment(V), n += P ? " " + b + " = " + b + " || Object.keys(" + c + "); for (var " + g + "=0; " + g + "<" + b + ".length; " + g + "++) { var " + m + " = " + b + "[" + g + "]; " : " for (var " + m + " in " + c + ") { ", n += " if (" + e.usePattern(V) + ".test(" + m + ")) { ", d.errorPath = e.util.getPathExpr(e.errorPath, m, e.opts.jsonPointers);
                        var X = c + "[" + m + "]";
                        d.dataPathArr[v] = m;
                        var Y = e.validate(d);
                        d.baseId = R, e.util.varOccurences(Y, _) < 2 ? n += " " + e.util.varReplace(Y, _, X) + " " : n += " var " + _ + " = " + X + "; " + Y + " ", l && (n += " if (!" + p + ") break; "), n += " } ", l && (n += " else " + p + " = true; "), n += " }  ", l && (n += " if (" + p + ") { ", f += "}")
                    }
                }
        }
        return l && (n += " " + f + " if (" + h + " == errors) {"), n = e.util.cleanUpCode(n)
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n = " ",
            r = e.level,
            a = e.dataLevel,
            o = e.schema[t],
            s = e.schemaPath + e.util.getProperty(t),
            u = e.errSchemaPath + "/" + t,
            l = !e.opts.allErrors,
            c = "data" + (a || ""),
            h = "errs__" + r,
            d = e.util.copy(e);
        d.level++;
        var f = "valid" + d.level;
        if (e.util.schemaHasRules(o, e.RULES.all)) {
            d.schema = o, d.schemaPath = s, d.errSchemaPath = u;
            var p = "key" + r,
                m = "idx" + r,
                g = "i" + r,
                v = "' + " + p + " + '",
                _ = d.dataLevel = e.dataLevel + 1,
                b = "data" + _,
                S = "dataProperties" + r,
                x = e.opts.ownProperties,
                y = e.baseId;
            n += " var " + h + " = errors; ", x && (n += " var " + S + " = undefined; "), n += x ? " " + S + " = " + S + " || Object.keys(" + c + "); for (var " + m + "=0; " + m + "<" + S + ".length; " + m + "++) { var " + p + " = " + S + "[" + m + "]; " : " for (var " + p + " in " + c + ") { ", n += " var startErrs" + r + " = errors; ";
            var C = p,
                T = e.compositeRule;
            e.compositeRule = d.compositeRule = !0;
            var w = e.validate(d);
            d.baseId = y, e.util.varOccurences(w, b) < 2 ? n += " " + e.util.varReplace(w, b, C) + " " : n += " var " + b + " = " + C + "; " + w + " ", e.compositeRule = d.compositeRule = T, n += " if (!" + f + ") { for (var " + g + "=startErrs" + r + "; " + g + "<errors; " + g + "++) { vErrors[" + g + "].propertyName = " + p + "; }   var err =   ", !1 !== e.createErrors ? (n += " { keyword: 'propertyNames' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(u) + " , params: { propertyName: '" + v + "' } ", !1 !== e.opts.messages && (n += " , message: 'property name \\'" + v + "\\' is invalid' "), e.opts.verbose && (n += " , schema: validate.schema" + s + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + c + " "), n += " } ") : n += " {} ", n += ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", !e.compositeRule && l && (e.async ? n += " throw new ValidationError(vErrors); " : n += " validate.errors = vErrors; return false; "), l && (n += " break; "), n += " } }"
        }
        return l && (n += "  if (" + h + " == errors) {"), n = e.util.cleanUpCode(n)
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n = " ",
            r = e.level,
            a = e.dataLevel,
            o = e.schema[t],
            s = e.schemaPath + e.util.getProperty(t),
            u = e.errSchemaPath + "/" + t,
            l = !e.opts.allErrors,
            c = "data" + (a || ""),
            h = "valid" + r,
            d = e.opts.$data && o && o.$data;
        d && (n += " var schema" + r + " = " + e.util.getData(o.$data, a, e.dataPathArr) + "; ");
        var f = "schema" + r;
        if (!d)
            if (o.length < e.opts.loopRequired && e.schema.properties && Object.keys(e.schema.properties).length) {
                var p = [],
                    m = o;
                if (m)
                    for (var g, v = -1, _ = m.length - 1; v < _;) {
                        g = m[v += 1];
                        var b = e.schema.properties[g];
                        b && e.util.schemaHasRules(b, e.RULES.all) || (p[p.length] = g)
                    }
            } else var p = o;
        if (d || p.length) {
            var S = e.errorPath,
                x = d || p.length >= e.opts.loopRequired,
                y = e.opts.ownProperties;
            if (l)
                if (n += " var missing" + r + "; ", x) {
                    d || (n += " var " + f + " = validate.schema" + s + "; ");
                    var C = "i" + r,
                        T = "schema" + r + "[" + C + "]",
                        w = "' + " + T + " + '";
                    e.opts._errorDataPathProperty && (e.errorPath = e.util.getPathExpr(S, T, e.opts.jsonPointers)), n += " var " + h + " = true; ", d && (n += " if (schema" + r + " === undefined) " + h + " = true; else if (!Array.isArray(schema" + r + ")) " + h + " = false; else {"), n += " for (var " + C + " = 0; " + C + " < " + f + ".length; " + C + "++) { " + h + " = " + c + "[" + f + "[" + C + "]] !== undefined ", y && (n += " &&   Object.prototype.hasOwnProperty.call(" + c + ", " + f + "[" + C + "]) "), n += "; if (!" + h + ") break; } ", d && (n += "  }  "), n += "  if (!" + h + ") {   ";
                    var M = M || [];
                    M.push(n), n = "", !1 !== e.createErrors ? (n += " { keyword: 'required' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(u) + " , params: { missingProperty: '" + w + "' } ", !1 !== e.opts.messages && (n += " , message: '", e.opts._errorDataPathProperty ? n += "is a required property" : n += "should have required property \\'" + w + "\\'", n += "' "), e.opts.verbose && (n += " , schema: validate.schema" + s + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + c + " "), n += " } ") : n += " {} ";
                    var E = n;
                    n = M.pop(), !e.compositeRule && l ? e.async ? n += " throw new ValidationError([" + E + "]); " : n += " validate.errors = [" + E + "]; return false; " : n += " var err = " + E + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", n += " } else { "
                } else {
                    n += " if ( ";
                    var A = p;
                    if (A)
                        for (var P, C = -1, R = A.length - 1; C < R;) {
                            P = A[C += 1], C && (n += " || ");
                            var O = e.util.getProperty(P),
                                I = c + O;
                            n += " ( ( " + I + " === undefined ", y && (n += " || ! Object.prototype.hasOwnProperty.call(" + c + ", '" + e.util.escapeQuotes(P) + "') "), n += ") && (missing" + r + " = " + e.util.toQuotedString(e.opts.jsonPointers ? P : O) + ") ) "
                        }
                    n += ") {  ";
                    var T = "missing" + r,
                        w = "' + " + T + " + '";
                    e.opts._errorDataPathProperty && (e.errorPath = e.opts.jsonPointers ? e.util.getPathExpr(S, T, !0) : S + " + " + T);
                    var M = M || [];
                    M.push(n), n = "", !1 !== e.createErrors ? (n += " { keyword: 'required' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(u) + " , params: { missingProperty: '" + w + "' } ", !1 !== e.opts.messages && (n += " , message: '", e.opts._errorDataPathProperty ? n += "is a required property" : n += "should have required property \\'" + w + "\\'", n += "' "), e.opts.verbose && (n += " , schema: validate.schema" + s + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + c + " "), n += " } ") : n += " {} ";
                    var E = n;
                    n = M.pop(), !e.compositeRule && l ? e.async ? n += " throw new ValidationError([" + E + "]); " : n += " validate.errors = [" + E + "]; return false; " : n += " var err = " + E + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", n += " } else { "
                }
            else if (x) {
                d || (n += " var " + f + " = validate.schema" + s + "; ");
                var C = "i" + r,
                    T = "schema" + r + "[" + C + "]",
                    w = "' + " + T + " + '";
                e.opts._errorDataPathProperty && (e.errorPath = e.util.getPathExpr(S, T, e.opts.jsonPointers)), d && (n += " if (" + f + " && !Array.isArray(" + f + ")) {  var err =   ", !1 !== e.createErrors ? (n += " { keyword: 'required' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(u) + " , params: { missingProperty: '" + w + "' } ", !1 !== e.opts.messages && (n += " , message: '", e.opts._errorDataPathProperty ? n += "is a required property" : n += "should have required property \\'" + w + "\\'", n += "' "), e.opts.verbose && (n += " , schema: validate.schema" + s + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + c + " "), n += " } ") : n += " {} ", n += ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if (" + f + " !== undefined) { "), n += " for (var " + C + " = 0; " + C + " < " + f + ".length; " + C + "++) { if (" + c + "[" + f + "[" + C + "]] === undefined ", y && (n += " || ! Object.prototype.hasOwnProperty.call(" + c + ", " + f + "[" + C + "]) "), n += ") {  var err =   ", !1 !== e.createErrors ? (n += " { keyword: 'required' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(u) + " , params: { missingProperty: '" + w + "' } ", !1 !== e.opts.messages && (n += " , message: '", e.opts._errorDataPathProperty ? n += "is a required property" : n += "should have required property \\'" + w + "\\'", n += "' "), e.opts.verbose && (n += " , schema: validate.schema" + s + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + c + " "), n += " } ") : n += " {} ", n += ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ", d && (n += "  }  ")
            } else {
                var F = p;
                if (F)
                    for (var P, N = -1, D = F.length - 1; N < D;) {
                        P = F[N += 1];
                        var O = e.util.getProperty(P),
                            w = e.util.escapeQuotes(P),
                            I = c + O;
                        e.opts._errorDataPathProperty && (e.errorPath = e.util.getPath(S, P, e.opts.jsonPointers)), n += " if ( " + I + " === undefined ", y && (n += " || ! Object.prototype.hasOwnProperty.call(" + c + ", '" + e.util.escapeQuotes(P) + "') "), n += ") {  var err =   ", !1 !== e.createErrors ? (n += " { keyword: 'required' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(u) + " , params: { missingProperty: '" + w + "' } ", !1 !== e.opts.messages && (n += " , message: '", e.opts._errorDataPathProperty ? n += "is a required property" : n += "should have required property \\'" + w + "\\'", n += "' "), e.opts.verbose && (n += " , schema: validate.schema" + s + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + c + " "), n += " } ") : n += " {} ", n += ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "
                    }
            }
            e.errorPath = S
        } else l && (n += " if (true) {");
        return n
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n, r = " ",
            a = e.level,
            o = e.dataLevel,
            s = e.schema[t],
            u = e.schemaPath + e.util.getProperty(t),
            l = e.errSchemaPath + "/" + t,
            c = !e.opts.allErrors,
            h = "data" + (o || ""),
            d = "valid" + a,
            f = e.opts.$data && s && s.$data;
        if (f ? (r += " var schema" + a + " = " + e.util.getData(s.$data, o, e.dataPathArr) + "; ", n = "schema" + a) : n = s, (s || f) && !1 !== e.opts.uniqueItems) {
            f && (r += " var " + d + "; if (" + n + " === false || " + n + " === undefined) " + d + " = true; else if (typeof " + n + " != 'boolean') " + d + " = false; else { "), r += " var i = " + h + ".length , " + d + " = true , j; if (i > 1) { ";
            var p = e.schema.items && e.schema.items.type,
                m = Array.isArray(p);
            if (!p || "object" == p || "array" == p || m && (p.indexOf("object") >= 0 || p.indexOf("array") >= 0)) r += " outer: for (;i--;) { for (j = i; j--;) { if (equal(" + h + "[i], " + h + "[j])) { " + d + " = false; break outer; } } } ";
            else {
                r += " var itemIndices = {}, item; for (;i--;) { var item = " + h + "[i]; ";
                var g = "checkDataType" + (m ? "s" : "");
                r += " if (" + e.util[g](p, "item", !0) + ") continue; ", m && (r += " if (typeof item == 'string') item = '\"' + item; "), r += " if (typeof itemIndices[item] == 'number') { " + d + " = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "
            }
            r += " } ", f && (r += "  }  "), r += " if (!" + d + ") {   ";
            var v = v || [];
            v.push(r), r = "", !1 !== e.createErrors ? (r += " { keyword: 'uniqueItems' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(l) + " , params: { i: i, j: j } ", !1 !== e.opts.messages && (r += " , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "), e.opts.verbose && (r += " , schema:  ", r += f ? "validate.schema" + u : "" + s, r += "         , parentSchema: validate.schema" + e.schemaPath + " , data: " + h + " "), r += " } ") : r += " {} ";
            var _ = r;
            r = v.pop(), !e.compositeRule && c ? e.async ? r += " throw new ValidationError([" + _ + "]); " : r += " validate.errors = [" + _ + "]; return false; " : r += " var err = " + _ + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", r += " } ", c && (r += " else { ")
        } else c && (r += " if (true) { ");
        return r
    }
}, function (e, t, i) {
    "use strict";
    var n = ["multipleOf", "maximum", "exclusiveMaximum", "minimum", "exclusiveMinimum", "maxLength", "minLength", "pattern", "additionalItems", "maxItems", "minItems", "uniqueItems", "maxProperties", "minProperties", "required", "additionalProperties", "enum", "format", "const"];
    e.exports = function (e, t) {
        for (var i = 0; i < t.length; i++) {
            e = JSON.parse(JSON.stringify(e));
            var r, a = t[i].split("/"),
                o = e;
            for (r = 1; r < a.length; r++) o = o[a[r]];
            for (r = 0; r < n.length; r++) {
                var s = n[r],
                    u = o[s];
                u && (o[s] = {
                    anyOf: [u, {
                        $ref: "https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#"
                    }]
                })
            }
        }
        return e
    }
}, function (e, t, i) {
    "use strict";
    (function (t) {
        function n(e, i, a) {
            function o(e) {
                var i = e.$schema;
                return i && !u.getSchema(i) ? n.call(u, {
                    $ref: i
                }, !0) : t.resolve()
            }

            function s(e) {
                try {
                    return u._compile(e)
                } catch (t) {
                    if (t instanceof r) return function (t) {
                        function n() {
                            delete u._loadingSchemas[a]
                        }

                        function r(e) {
                            return u._refs[e] || u._schemas[e]
                        }
                        var a = t.missingSchema;
                        if (r(a)) throw new Error("Schema " + a + " is loaded but " + t.missingRef + " cannot be resolved");
                        var l = u._loadingSchemas[a];
                        return l || (l = u._loadingSchemas[a] = u._opts.loadSchema(a), l.then(n, n)), l.then(function (e) {
                            if (!r(a)) return o(e).then(function () {
                                r(a) || u.addSchema(e, a, void 0, i)
                            })
                        }).then(function () {
                            return s(e)
                        })
                    }(t);
                    throw t
                }
            }
            var u = this;
            if ("function" != typeof this._opts.loadSchema) throw new Error("options.loadSchema should be a function");
            "function" == typeof i && (a = i, i = void 0);
            var l = o(e).then(function () {
                var t = u._addSchema(e, void 0, i);
                return t.validate || s(t)
            });
            return a && l.then(function (e) {
                a(null, e)
            }, a), l
        }
        var r = i(703).MissingRef;
        e.exports = n
    }).call(t, i(93))
}, function (e, t, i) {
    "use strict";

    function n(e, t) {
        function i(e, t, i) {
            for (var n, a = 0; a < r.length; a++) {
                var o = r[a];
                if (o.type == t) {
                    n = o;
                    break
                }
            }
            n || (n = {
                type: t,
                rules: []
            }, r.push(n));
            var u = {
                keyword: e,
                definition: i,
                custom: !0,
                code: s,
                implements: i.implements
            };
            n.rules.push(u), r.custom[e] = u
        }

        function n(e) {
            if (!r.types[e]) throw new Error("Unknown type " + e)
        }
        var r = this.RULES;
        if (r.keywords[e]) throw new Error("Keyword " + e + " is already defined");
        if (!o.test(e)) throw new Error("Keyword " + e + " is not a valid identifier");
        if (t) {
            if (t.macro && void 0 !== t.valid) throw new Error('"valid" option cannot be used with macro keywords');
            var a = t.type;
            if (Array.isArray(a)) {
                var u, l = a.length;
                for (u = 0; u < l; u++) n(a[u]);
                for (u = 0; u < l; u++) i(e, a[u], t)
            } else a && n(a), i(e, a, t);
            var c = !0 === t.$data && this._opts.$data;
            if (c && !t.validate) throw new Error('$data support: "validate" function is not defined');
            var h = t.metaSchema;
            h && (c && (h = {
                anyOf: [h, {
                    $ref: "https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#"
                }]
            }), t.validateSchema = this.compile(h, !0))
        }
        return r.keywords[e] = r.all[e] = !0, this
    }

    function r(e) {
        var t = this.RULES.custom[e];
        return t ? t.definition : this.RULES.keywords[e] || !1
    }

    function a(e) {
        var t = this.RULES;
        delete t.keywords[e], delete t.all[e], delete t.custom[e];
        for (var i = 0; i < t.length; i++)
            for (var n = t[i].rules, r = 0; r < n.length; r++)
                if (n[r].keyword == e) {
                    n.splice(r, 1);
                    break
                } return this
    }
    var o = /^[a-z_$][a-z0-9_$-]*$/i,
        s = i(1169);
    e.exports = {
        add: n,
        get: r,
        remove: a
    }
}, function (e, t, i) {
    "use strict";
    e.exports = function (e, t, i) {
        var n, r, a = " ",
            o = e.level,
            s = e.dataLevel,
            u = e.schema[t],
            l = e.schemaPath + e.util.getProperty(t),
            c = e.errSchemaPath + "/" + t,
            h = !e.opts.allErrors,
            d = "data" + (s || ""),
            f = "valid" + o,
            p = "errs__" + o,
            m = e.opts.$data && u && u.$data;
        m ? (a += " var schema" + o + " = " + e.util.getData(u.$data, s, e.dataPathArr) + "; ", r = "schema" + o) : r = u;
        var g, v, _, b, S, x = this,
            y = "definition" + o,
            C = x.definition,
            T = "";
        if (m && C.$data) {
            S = "keywordValidate" + o;
            var w = C.validateSchema;
            a += " var " + y + " = RULES.custom['" + t + "'].definition; var " + S + " = " + y + ".validate;"
        } else {
            if (!(b = e.useCustomRule(x, u, e.schema, e))) return;
            r = "validate.schema" + l, S = b.code, g = C.compile, v = C.inline, _ = C.macro
        }
        var M = S + ".errors",
            E = "i" + o,
            A = "ruleErr" + o,
            P = C.async;
        if (P && !e.async) throw new Error("async keyword in sync schema");
        if (v || _ || (a += M + " = null;"), a += "var " + p + " = errors;var " + f + ";", m && C.$data && (T += "}", a += " if (" + r + " === undefined) { " + f + " = true; } else { ", w && (T += "}", a += " " + f + " = " + y + ".validateSchema(" + r + "); if (" + f + ") { ")), v) C.statements ? a += " " + b.validate + " " : a += " " + f + " = " + b.validate + "; ";
        else if (_) {
            var R = e.util.copy(e),
                T = "";
            R.level++;
            var O = "valid" + R.level;
            R.schema = b.validate, R.schemaPath = "";
            var I = e.compositeRule;
            e.compositeRule = R.compositeRule = !0;
            var F = e.validate(R).replace(/validate\.schema/g, S);
            e.compositeRule = R.compositeRule = I, a += " " + F
        } else {
            var N = N || [];
            N.push(a), a = "", a += "  " + S + ".call( ", e.opts.passContext ? a += "this" : a += "self", g || !1 === C.schema ? a += " , " + d + " " : a += " , " + r + " , " + d + " , validate.schema" + e.schemaPath + " ", a += " , (dataPath || '')", '""' != e.errorPath && (a += " + " + e.errorPath);
            var D = s ? "data" + (s - 1 || "") : "parentData",
                L = s ? e.dataPathArr[s] : "parentDataProperty";
            a += " , " + D + " , " + L + " , rootData )  ";
            var k = a;
            a = N.pop(), !1 === C.errors ? (a += " " + f + " = ", P && (a += "await "), a += k + "; ") : P ? (M = "customErrors" + o, a += " var " + M + " = null; try { " + f + " = await " + k + "; } catch (e) { " + f + " = false; if (e instanceof ValidationError) " + M + " = e.errors; else throw e; } ") : a += " " + M + " = null; " + f + " = " + k + "; "
        }
        if (C.modifying && (a += " if (" + D + ") " + d + " = " + D + "[" + L + "];"), a += "" + T, C.valid) h && (a += " if (true) { ");
        else {
            a += " if ( ", void 0 === C.valid ? (a += " !", a += _ ? "" + O : "" + f) : a += " " + !C.valid + " ", a += ") { ", n = x.keyword;
            var N = N || [];
            N.push(a), a = "";
            var N = N || [];
            N.push(a), a = "", !1 !== e.createErrors ? (a += " { keyword: '" + (n || "custom") + "' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(c) + " , params: { keyword: '" + x.keyword + "' } ", !1 !== e.opts.messages && (a += " , message: 'should pass \"" + x.keyword + "\" keyword validation' "), e.opts.verbose && (a += " , schema: validate.schema" + l + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + d + " "), a += " } ") : a += " {} ";
            var V = a;
            a = N.pop(), !e.compositeRule && h ? e.async ? a += " throw new ValidationError([" + V + "]); " : a += " validate.errors = [" + V + "]; return false; " : a += " var err = " + V + ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";
            var B = a;
            a = N.pop(), v ? C.errors ? "full" != C.errors && (a += "  for (var " + E + "=" + p + "; " + E + "<errors; " + E + "++) { var " + A + " = vErrors[" + E + "]; if (" + A + ".dataPath === undefined) " + A + ".dataPath = (dataPath || '') + " + e.errorPath + "; if (" + A + ".schemaPath === undefined) { " + A + '.schemaPath = "' + c + '"; } ', e.opts.verbose && (a += " " + A + ".schema = " + r + "; " + A + ".data = " + d + "; "), a += " } ") : !1 === C.errors ? a += " " + B + " " : (a += " if (" + p + " == errors) { " + B + " } else {  for (var " + E + "=" + p + "; " + E + "<errors; " + E + "++) { var " + A + " = vErrors[" + E + "]; if (" + A + ".dataPath === undefined) " + A + ".dataPath = (dataPath || '') + " + e.errorPath + "; if (" + A + ".schemaPath === undefined) { " + A + '.schemaPath = "' + c + '"; } ', e.opts.verbose && (a += " " + A + ".schema = " + r + "; " + A + ".data = " + d + "; "), a += " } } ") : _ ? (a += "   var err =   ", !1 !== e.createErrors ? (a += " { keyword: '" + (n || "custom") + "' , dataPath: (dataPath || '') + " + e.errorPath + " , schemaPath: " + e.util.toQuotedString(c) + " , params: { keyword: '" + x.keyword + "' } ", !1 !== e.opts.messages && (a += " , message: 'should pass \"" + x.keyword + "\" keyword validation' "), e.opts.verbose && (a += " , schema: validate.schema" + l + " , parentSchema: validate.schema" + e.schemaPath + " , data: " + d + " "), a += " } ") : a += " {} ", a += ";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ", !e.compositeRule && h && (e.async ? a += " throw new ValidationError(vErrors); " : a += " validate.errors = vErrors; return false; ")) : !1 === C.errors ? a += " " + B + " " : (a += " if (Array.isArray(" + M + ")) { if (vErrors === null) vErrors = " + M + "; else vErrors = vErrors.concat(" + M + "); errors = vErrors.length;  for (var " + E + "=" + p + "; " + E + "<errors; " + E + "++) { var " + A + " = vErrors[" + E + "]; if (" + A + ".dataPath === undefined) " + A + ".dataPath = (dataPath || '') + " + e.errorPath + ";  " + A + '.schemaPath = "' + c + '";  ', e.opts.verbose && (a += " " + A + ".schema = " + r + "; " + A + ".data = " + d + "; "), a += " } } else { " + B + " } "), a += " } ", h && (a += " else { ")
        }
        return a
    }
}, function (e, t) {
    e.exports = {
        $schema: "http://json-schema.org/draft-07/schema#",
        $id: "https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#",
        description: "Meta-schema for $data reference (JSON Schema extension proposal)",
        type: "object",
        required: ["$data"],
        properties: {
            $data: {
                type: "string",
                anyOf: [{
                    format: "relative-json-pointer"
                }, {
                    format: "json-pointer"
                }]
            }
        },
        additionalProperties: !1
    }
}, function (e, t) {
    e.exports = {
        $schema: "http://json-schema.org/draft-07/schema#",
        $id: "http://json-schema.org/draft-07/schema#",
        title: "Core schema meta-schema",
        definitions: {
            schemaArray: {
                type: "array",
                minItems: 1,
                items: {
                    $ref: "#"
                }
            },
            nonNegativeInteger: {
                type: "integer",
                minimum: 0
            },
            nonNegativeIntegerDefault0: {
                allOf: [{
                    $ref: "#/definitions/nonNegativeInteger"
                }, {
                    default: 0
                }]
            },
            simpleTypes: {
                enum: ["array", "boolean", "integer", "null", "number", "object", "string"]
            },
            stringArray: {
                type: "array",
                items: {
                    type: "string"
                },
                uniqueItems: !0,
                default: []
            }
        },
        type: ["object", "boolean"],
        properties: {
            $id: {
                type: "string",
                format: "uri-reference"
            },
            $schema: {
                type: "string",
                format: "uri"
            },
            $ref: {
                type: "string",
                format: "uri-reference"
            },
            $comment: {
                type: "string"
            },
            title: {
                type: "string"
            },
            description: {
                type: "string"
            },
            default: !0,
            readOnly: {
                type: "boolean",
                default: !1
            },
            examples: {
                type: "array",
                items: !0
            },
            multipleOf: {
                type: "number",
                exclusiveMinimum: 0
            },
            maximum: {
                type: "number"
            },
            exclusiveMaximum: {
                type: "number"
            },
            minimum: {
                type: "number"
            },
            exclusiveMinimum: {
                type: "number"
            },
            maxLength: {
                $ref: "#/definitions/nonNegativeInteger"
            },
            minLength: {
                $ref: "#/definitions/nonNegativeIntegerDefault0"
            },
            pattern: {
                type: "string",
                format: "regex"
            },
            additionalItems: {
                $ref: "#"
            },
            items: {
                anyOf: [{
                    $ref: "#"
                }, {
                    $ref: "#/definitions/schemaArray"
                }],
                default: !0
            },
            maxItems: {
                $ref: "#/definitions/nonNegativeInteger"
            },
            minItems: {
                $ref: "#/definitions/nonNegativeIntegerDefault0"
            },
            uniqueItems: {
                type: "boolean",
                default: !1
            },
            contains: {
                $ref: "#"
            },
            maxProperties: {
                $ref: "#/definitions/nonNegativeInteger"
            },
            minProperties: {
                $ref: "#/definitions/nonNegativeIntegerDefault0"
            },
            required: {
                $ref: "#/definitions/stringArray"
            },
            additionalProperties: {
                $ref: "#"
            },
            definitions: {
                type: "object",
                additionalProperties: {
                    $ref: "#"
                },
                default: {}
            },
            properties: {
                type: "object",
                additionalProperties: {
                    $ref: "#"
                },
                default: {}
            },
            patternProperties: {
                type: "object",
                additionalProperties: {
                    $ref: "#"
                },
                propertyNames: {
                    format: "regex"
                },
                default: {}
            },
            dependencies: {
                type: "object",
                additionalProperties: {
                    anyOf: [{
                        $ref: "#"
                    }, {
                        $ref: "#/definitions/stringArray"
                    }]
                }
            },
            propertyNames: {
                $ref: "#"
            },
            const: !0,
            enum: {
                type: "array",
                items: !0,
                minItems: 1,
                uniqueItems: !0
            },
            type: {
                anyOf: [{
                    $ref: "#/definitions/simpleTypes"
                }, {
                    type: "array",
                    items: {
                        $ref: "#/definitions/simpleTypes"
                    },
                    minItems: 1,
                    uniqueItems: !0
                }]
            },
            format: {
                type: "string"
            },
            contentMediaType: {
                type: "string"
            },
            contentEncoding: {
                type: "string"
            },
            if: {
                $ref: "#"
            },
            then: {
                $ref: "#"
            },
            else: {
                $ref: "#"
            },
            allOf: {
                $ref: "#/definitions/schemaArray"
            },
            anyOf: {
                $ref: "#/definitions/schemaArray"
            },
            oneOf: {
                $ref: "#/definitions/schemaArray"
            },
            not: {
                $ref: "#"
            }
        },
        default: !0
    }
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(9)),
        a = i(630),
        o = i(1173),
        s = i(1174),
        u = i(1177),
        l = r.a.osg,
        c = function (e, t, i) {
            i ? l.error("ResourceLoader: " + e + " failed " + t + " error " + i) : l.error("ResourceLoader: " + e + " failed " + t)
        },
        h = function () {
            this._nbThreads = 5, this._processing = [], this._queue = [], this._finished = [], this._running = !1
        };
    h.prototype = {
        checkResource: function (e) {
            var t;
            return [this._processing, this._queue, this._finished].forEach(function (i) {
                t || (t = Object(n.find)(i, function (t) {
                    return t._url === e
                }))
            }), t
        },
        run: function () {
            this._running = !0, this.runPendingProcess()
        },
        runPendingProcess: function () {
            for (; this._processing.length < this._nbThreads && this._queue.length > 0;) {
                var e = this._queue.shift();
                this._processing.push(e), e.start()
            }
        },
        queue: function (e) {
            e.start || (console.log(e.url), e = new a.a(e.url, e.response)), this._queue.push(e);
            var t = e.getPromise();
            return t.finally(function () {
                t.isFulfilled() && this._finished.push(e), this._processing.splice(this._processing.indexOf(e), 1), this.runPendingProcess()
            }.bind(this)), this._running && this.runPendingProcess(), e
        },
        getModel: function (e, t) {
            var i = this.checkResource(e);
            return i || (i = this.queue(new o.a(e, "text", t)), i.getPromise().catch(function (t) {
                c(e, "model", t)
            }), i)
        },
        getImage: function (e, t) {
            var i = this.checkResource(e);
            if (i) return i;
            var n = t || {};
            return "data:image" === e.substr(0, "data:image".length) || (n.crossOrigin = "anonymous"), i = this.queue(new s.a(e, n)), i.getPromise().catch(function () {
                c(e, "image")
            }), i
        },
        getBinaryArray: function (e, t) {
            var i = this.checkResource(e);
            return i || (i = this.queue(new u.a(e, t)), i.getPromise().catch(function (t) {
                c(e, "binary array", t)
            }), i)
        }
    }, t.a = h
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(630)),
        a = function () {
            r.a.apply(this, arguments)
        };
    a.prototype = Object(n.extend)({}, r.a.prototype, {
        load: function () {
            this._model = this._xhr.response, this._defer.resolve(this._model)
        },
        getModel: function () {
            return this._model
        }
    }), t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(9)),
        a = i(631),
        o = i(630),
        s = i(20),
        u = i(1175),
        l = i.n(u),
        c = i(1176),
        h = i.n(c),
        d = i(44),
        f = r.a.osg,
        p = {},
        m = {},
        g = parseInt((/Chrome\/([0-9]+)/.exec(navigator.userAgent) || [0, 0])[1], 10),
        v = Object(s.a)().asyncImage;
    v && (v = window.Worker && window.fetch && window.createImageBitmap && g >= 52);
    var _ = [];
    window.closeBitmaps = function () {
        _.forEach(function (e) {
            e.close()
        })
    };
    var b = function (e) {
            var t = 0,
                i = Math.max(2, Math.min(4, navigator.hardwareConcurrency || 2)),
                n = [],
                r = URL.createObjectURL(new Blob([e], {
                    type: "text/javascript"
                }));
            return function () {
                var e = n[t];
                return e || (e = n[t] = new Worker(r), e.onmessage = function (e) {
                    var t = e.data,
                        i = t.uid,
                        n = m[i];
                    t.bitmap ? (n.setImage(t.bitmap), _.push(t.bitmap)) : (n.setImage(t.img), n.setWidth(t.width), n.setHeight(t.height)), p[i]()
                }), t = (t + 1) % i, e
            }
        },
        S = b(l.a),
        x = b(h.a),
        y = function (e, t) {
            o.a.call(this, e, "blob", t), this._responseType = "arraybuffer"
        };
    y.prototype = Object(n.extend)({}, o.a.prototype, {
        isVideo: function (e) {
            return a.a.isVideoURL(e)
        },
        createVideo: function () {
            var e = document.createElement("video");
            return document.body.appendChild(e), e.style.display = "none", e
        },
        start: function () {
            var e = this.getURL();
            if (this.isVideo(e)) {
                var t = this.createVideo();
                return this._osgjsImage = new f.ImageStream(t), window.video = this._osgjsImage, t.preload = "auto", t.crossOrigin = "anonymous", t.src = e, void this._osgjsImage.whenReady().then(function (e) {
                    e.play(), this._defer.resolve(this._osgjsImage)
                }.bind(this))
            }
            this._osgjsImage = new f.Image;
            var i = this._options;
            return i.panoramaLUV || i.integrateBRDFLUV || i.cubemapLUV ? void o.a.prototype.start.call(this) : (d.a.draw(), this._url.endsWith(".astc.gz") ? (i.astc = !0, void o.a.prototype.start.call(this)) : this._url.endsWith(".svg") ? (i.svg = !0, void this.loadImage()) : i.decodeAsync && v ? void this.loadImageAsync() : void this.loadImage())
        },
        load: function () {
            var e = this._options;
            e.panoramaLUV || e.integrateBRDFLUV ? this.loadLUV() : e.cubemapLUV ? this.loadCubemapLUV() : e.astc && this.loadAstc()
        },
        loadImageAsync: function () {
            p[this._url] = this._defer.resolve.bind(this._defer, this._osgjsImage), m[this._url] = this._osgjsImage, x().postMessage({
                uid: this._url,
                url: this._url
            })
        },
        loadAstc: function () {
            var e = this._xhr.response;
            p[this._url] = this._defer.resolve.bind(this._defer, this._osgjsImage), m[this._url] = this._osgjsImage, S().postMessage({
                uid: this._url,
                buffer: e,
                swizzle: !0,
                nbComponents: 3
            }, [e])
        },
        svgToCanvas: function () {
            var e = document.createElement("canvas"),
                t = Object(s.a)().svgSize;
            e.width = t, e.height = t;
            var i = e.getContext("2d");
            this._htmlImage.width = t, this._htmlImage.height = t, i.drawImage(this._htmlImage, 0, 0, t, t), this._osgjsImage.setImage(e)
        },
        loadImage: function () {
            this._htmlImage = new Image, this._options.crossOrigin && (this._htmlImage.crossOrigin = this._options.crossOrigin), this._htmlImage.addEventListener("load", function () {
                this._options.svg && this.svgToCanvas(), this._defer.resolve(this._osgjsImage)
            }.bind(this)), this._htmlImage.onerror = function () {
                this._htmlImage._aborted ? this._defer.cancel(this._osgjsImage) : this._defer.reject(this._osgjsImage)
            }.bind(this), this._htmlImage.src = this._url, this._osgjsImage.setImage(this._htmlImage)
        },
        abort: function () {
            this._htmlImage ? (this._htmlImage.src = "", this._htmlImage._aborted = !0) : o.a.prototype.abort.call(this)
        },
        loadLUV: function () {
            var e, t = this._xhr.response,
                i = Math.sqrt(t.byteLength / 4);
            e = this._options.integrateBRDFLUV ? new Uint8Array(t) : this.deinterleaveImage4(i, new Uint8Array(t), new Uint8Array(t.byteLength));
            var n = this._osgjsImage;
            n.setImage(e), n.setWidth(i), n.setHeight(i), this._defer.resolve(this._osgjsImage)
        },
        loadCubemapLUV: function () {
            for (var e = this._xhr.response, t = Math.log(this._options.size) / Math.LN2, i = 0, n = {}, r = 0; r <= t && !(i >= e.byteLength); r++)
                for (var a = Math.pow(2, t - r), o = 0; o < 6; o++) {
                    n[f.Texture.TEXTURE_CUBE_MAP_POSITIVE_X + o] || (n[f.Texture.TEXTURE_CUBE_MAP_POSITIVE_X + o] = []);
                    var s = a * a * 4,
                        u = new Uint8Array(s);
                    this.deinterleaveImage4(a, new Uint8Array(e, i, s), u);
                    var l = new f.Image;
                    l.setImage(u), l.setWidth(a), l.setHeight(a), n[f.Texture.TEXTURE_CUBE_MAP_POSITIVE_X + o].push(l), i += s
                }
            this._defer.resolve(n)
        },
        deinterleaveImage4: function (e, t, i) {
            for (var n = e * e, r = 2 * e * e, a = 3 * e * e, o = 0, s = 0; s < n; s++) i[o++] = t[s], i[o++] = t[s + n], i[o++] = t[s + r], i[o++] = t[s + a];
            return i
        },
        getImage: function () {
            return this._osgjsImage
        }
    }), t.a = y
}, function (e, t) {
    e.exports = "(function webpackUniversalModuleDefinition(root, factory) {\n  if(typeof exports === 'object' && typeof module === 'object')\n    module.exports = factory();\n  else if(typeof define === 'function' && define.amd)\n    define([], factory);\n  else {\n    var a = factory();\n    for(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n  }\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/  // The module cache\n/******/  var installedModules = {};\n\n/******/  // The require function\n/******/  function __webpack_require__(moduleId) {\n\n/******/    // Check if module is in cache\n/******/    if(installedModules[moduleId])\n/******/      return installedModules[moduleId].exports;\n\n/******/    // Create a new module (and put it into the cache)\n/******/    var module = installedModules[moduleId] = {\n/******/      exports: {},\n/******/      id: moduleId,\n/******/      loaded: false\n/******/    };\n\n/******/    // Execute the module function\n/******/    modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n/******/    // Flag the module as loaded\n/******/    module.loaded = true;\n\n/******/    // Return the exports of the module\n/******/    return module.exports;\n/******/  }\n\n\n/******/  // expose the modules object (__webpack_modules__)\n/******/  __webpack_require__.m = modules;\n\n/******/  // expose the module cache\n/******/  __webpack_require__.c = installedModules;\n\n/******/  // __webpack_public_path__\n/******/  __webpack_require__.p = \"\";\n\n/******/  // Load entry module and return exports\n/******/  return __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n  'use strict';\n\n  var decompressor = __webpack_require__( 1 );\n\n  /*jshint worker: true */\n\n  self.onmessage = function ( event ) {\n      var input = event.data;\n      var result = decompressor.decompress( input.buffer );\n\n      var img = new Uint8Array( result.img.buffer );\n      var width = result.width;\n      var height = result.height;\n\n      if ( input.swizzle ) {\n          var nbComponents = input.nbComponents || 3;\n          var nbPixel = width * height * 4;\n          for ( var i = 0, j = 0; i < nbPixel; i += 4, j += nbComponents ) {\n              var r = img[ i ];\n              var a = img[ i + 3 ];\n\n              var x = ( r / 255.0 ) * 2.0 - 1.0;\n              var y = ( a / 255.0 ) * 2.0 - 1.0;\n              var z = Math.sqrt( 1.0 - x * x - y * y );\n              z = Math.round( ( z * 0.5 + 0.5 ) * 255.0 );\n\n              img[ j ] = r;\n              img[ j + 1 ] = a;\n              img[ j + 2 ] = z;\n          }\n\n          img = img.subarray( 0, width * height * nbComponents );\n      }\n\n      postMessage( {\n          img: img,\n          width: width,\n          height: height,\n          uid: input.uid || 'uid'\n      }, [ img.buffer ] );\n  };\n\n  /*jshint worker: false */\n\n  module.exports = {\n      astcDecompressor: decompressor\n  };\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n  'use strict';\n\n  var precompute = __webpack_require__(2);\n  var cacheUnquantizeSimple = precompute.cacheUnquantizeSimple;\n  var cacheUnquantizeTrits = precompute.cacheUnquantizeTrits;\n  var cacheUnquantizeQuints = precompute.cacheUnquantizeQuints;\n  var cacheDecodeSimple = precompute.cacheDecodeSimple;\n  var cacheDecodeTrits = precompute.cacheDecodeTrits;\n  var cacheDecodeQuints = precompute.cacheDecodeQuints;\n\n  var bitUtils = __webpack_require__(3);\n  var popCount = bitUtils.popCount;\n  var readBits = bitUtils.readBits;\n  var writeBits = bitUtils.writeBits;\n  var extractBits = bitUtils.extractBits;\n  var replicateBits = bitUtils.replicateBits;\n  var bitTransferSigned = bitUtils.bitTransferSigned;\n  var reverseU8Array = bitUtils.reverseU8Array;\n\n\n  // Counting how many bits have been read for each block\n  // the value is reseted when computing a new block\n  var bitsReadCount = 0;\n  // Counting how many bits have been written\n  // useful when extracting color endpoint data\n  var bitsWrittenCount = 0;\n  // Counting how many bits have been read in the\n  // current block color data stream\n  var colorDataBitsRead = 0;\n  // Keeping track of the current index\n  // when calling the computeEndpoints routine\n  var decodedColorValuesIdx = 0;\n\n  // Contains the information\n  // of the current processed block\n  var CURRENT_BLOCK_INFO = {};\n  // Describes how trit/quint/bit is packed\n  // for a single encoded integer in the maxWeightQuintsTritsMapper\n  var TRIT_IDX = 0;\n  var QUINT_IDX = 1;\n  var BIT_IDX = 2;\n\n  // Maximum number of encoded values = 288\n  var resultDecodedStorage = new Uint16Array(288 * 6);\n  var subDecodedValue = new Array(8);\n  var classSelectorBitsArray = new Uint8Array(4);\n  var colorModeLSB = new Uint8Array(4);\n  var texelWeightData = new Uint8Array(16);\n  var colorEndpointData = new Uint8Array(16);\n  var endpoints = new Uint8Array(4 * 2 * 4);\n  var blockPixelsOutput = null;\n\n  /**\n   * Encodes a given value into its quints/trits/bits representation\n   * @param  {uint} val the value to encode\n   * @return {Object} contains the number of trits/quints/bits to encode the given value.\n   */\n  var getEncodedInteger = function(val) {\n    var encodedInt = {\n      trits: 0,\n      quints: 0,\n      bits: 0,\n      tritValue: 0,\n      quintValue: 0,\n      bitValue: 0\n    };\n    while (val > 0) {\n      var check = val + 1;\n\n      if (!(check & (check - 1))) {\n        encodedInt.bits = popCount(val);\n        return encodedInt;\n      }\n      if ((check % 3 === 0) && !(Math.floor(check / 3) & Math.floor((check / 3) - 1))) {\n        encodedInt.bits = popCount(Math.floor(check / 3 - 1));\n        encodedInt.trits = 1;\n        return encodedInt;\n      }\n      if ((check % 5 === 0) && !(Math.floor(check / 5) & Math.floor((check / 5) - 1))) {\n        encodedInt.bits = popCount(Math.floor(check / 5 - 1));\n        encodedInt.quints = 1;\n        return encodedInt;\n      }\n\n      val--;\n    }\n    return encodedInt;\n  };\n\n  var replicateBits0816Map = new Uint16Array(256);\n  for (var i = 0; i < 256; ++i)\n    replicateBits0816Map[i] = replicateBits(i, 8, 16);\n\n  var maxWeightQuintsTritsMapper = new Uint16Array(256 * 3);\n  var idx = 0;\n  for (var i = 0; i < 256; i++) {\n    var encodedInt = getEncodedInteger(i);\n    maxWeightQuintsTritsMapper[idx + TRIT_IDX] = encodedInt.trits;\n    maxWeightQuintsTritsMapper[idx + QUINT_IDX] = encodedInt.quints;\n    maxWeightQuintsTritsMapper[idx + BIT_IDX] = encodedInt.bits;\n\n    idx += 3;\n  }\n\n  /**\n   * Gives additional precision to RGB colors near gray\n   * pixel is changed in-place in the endpoints array\n   * Refers to ASTC specifications (Section 3.8)\n   * @param  {int} a the alpha channel component\n   * @param  {int} r the red channel component\n   * @param  {int} g the green channel component\n   * @param  {int} b the blue channel component\n   */\n  var blueContract = function(a, r, g, b) {\n    var idx = endpoints.currIdx;\n    endpoints[idx] = a;\n    endpoints[idx + 1] = (r + b) >> 1;\n    endpoints[idx + 2] = (g + b) >> 1;\n    endpoints[idx + 3] = b;\n  };\n\n  /**\n   * Expands a given seed\n   * Refers to ASTC specifications (Section 3.15)\n   * @param  {uint32} p the seed to expand\n   * @return {uint32} the processed expanded seed\n   */\n  var hash52 = function(p) {\n    p ^= (p >>> 15) >>> 0;\n    p -= (p << 17) >>> 0;\n    p += (p << 7) >>> 0;\n    p += (p << 4) >>> 0;\n    p ^= (p >>> 5) >>> 0;\n    p += (p << 16) >>> 0;\n    p ^= (p >>> 7) >>> 0;\n    p ^= (p >>> 3) >>> 0;\n    p ^= (p << 6) >>> 0;\n    p ^= (p >>> 17) >>> 0;\n\n    return p;\n  };\n\n  /**\n   * Computes the partition index for a given texel\n   * @param  {uint32} seed partition pattern index\n   * @param  {int} x texel x position withing the block\n   * @param  {int} y texel y position withing the block\n   * @param  {int} z texel z position withing the block\n   * @param  {uint} partitionCount maximum number of existing partitions\n   * @param  {bool} smallBlock set to true, number of texel in the block is less than 31\n   * @return {uint} the partition index of the given texel\n   */\n\n  var seedsPartitionTable = new Uint8Array(12);\n\n  var precomputeSelectPartition = function(seed, partitionCount) {\n\n    // Refers to ASTC specifications (Section 3.15)\n    seed += (partitionCount - 1) * 1024;\n    var seedUint32 = seed >>> 0;\n\n    var rnum = hash52(seedUint32);\n\n    // The seeds values should be saved in an uint8 variable\n    seedsPartitionTable[0] = rnum & 0xF;\n    seedsPartitionTable[1] = (rnum >> 4) & 0xF;\n    seedsPartitionTable[2] = (rnum >> 8) & 0xF;\n    seedsPartitionTable[3] = (rnum >> 12) & 0xF;\n    seedsPartitionTable[4] = (rnum >> 16) & 0xF;\n    seedsPartitionTable[5] = (rnum >> 20) & 0xF;\n    seedsPartitionTable[6] = (rnum >> 24) & 0xF;\n    seedsPartitionTable[7] = (rnum >> 28) & 0xF;\n    seedsPartitionTable[8] = (rnum >> 18) & 0xF;\n    seedsPartitionTable[9] = (rnum >> 22) & 0xF;\n    seedsPartitionTable[10] = (rnum >> 26) & 0xF;\n    seedsPartitionTable[11] = ((rnum >> 30) | (rnum << 2)) & 0xF;\n\n    seedsPartitionTable[0] *= seedsPartitionTable[0];\n    seedsPartitionTable[1] *= seedsPartitionTable[1];\n    seedsPartitionTable[2] *= seedsPartitionTable[2];\n    seedsPartitionTable[3] *= seedsPartitionTable[3];\n    seedsPartitionTable[4] *= seedsPartitionTable[4];\n    seedsPartitionTable[5] *= seedsPartitionTable[5];\n    seedsPartitionTable[6] *= seedsPartitionTable[6];\n    seedsPartitionTable[7] *= seedsPartitionTable[7];\n    seedsPartitionTable[8] *= seedsPartitionTable[8];\n    seedsPartitionTable[9] *= seedsPartitionTable[9];\n    seedsPartitionTable[10] *= seedsPartitionTable[10];\n    seedsPartitionTable[11] *= seedsPartitionTable[11];\n\n    var sh1 = 0;\n    var sh2 = 0;\n    var sh3 = 0;\n    if (seed & 1) {\n      sh1 = (seed & 2) ? 4 : 5;\n      sh2 = (partitionCount === 3) ? 6 : 5;\n    } else {\n      sh1 = (partitionCount === 3) ? 6 : 5;\n      sh2 = (seed & 2) ? 4 : 5;\n    }\n    sh3 = (seed & 0x10) ? sh1 : sh2;\n\n    seedsPartitionTable[0] >>= sh1;\n    seedsPartitionTable[1] >>= sh2;\n    seedsPartitionTable[2] >>= sh1;\n    seedsPartitionTable[3] >>= sh2;\n    seedsPartitionTable[4] >>= sh1;\n    seedsPartitionTable[5] >>= sh2;\n    seedsPartitionTable[6] >>= sh1;\n    seedsPartitionTable[7] >>= sh2;\n    seedsPartitionTable[8] >>= sh3;\n    seedsPartitionTable[9] >>= sh3;\n    seedsPartitionTable[10] >>= sh3;\n    seedsPartitionTable[11] >>= sh3;\n\n    return rnum;\n  };\n\n  var selectPartition = function(rnum, x, y, z, partitionCount, smallBlock) {\n    if (partitionCount === 1)\n      return 0;\n\n    if (smallBlock) {\n      x <<= 1;\n      y <<= 1;\n      z <<= 1;\n    }\n\n    var a = seedsPartitionTable[0] * x + seedsPartitionTable[1] * y + seedsPartitionTable[10] * z + (rnum >> 14);\n    var b = seedsPartitionTable[2] * x + seedsPartitionTable[3] * y + seedsPartitionTable[11] * z + (rnum >> 10);\n    var c = seedsPartitionTable[4] * x + seedsPartitionTable[5] * y + seedsPartitionTable[8] * z + (rnum >> 6);\n    var d = seedsPartitionTable[6] * x + seedsPartitionTable[7] * y + seedsPartitionTable[9] * z + (rnum >> 2);\n\n    a &= 0x3F;\n    b &= 0x3F;\n    c &= 0x3F;\n    d &= 0x3F;\n\n    if (partitionCount < 4)\n      d = 0;\n    if (partitionCount < 3)\n      c = 0;\n\n    if (a >= b && a >= c && a >= d)\n      return 0;\n    else if (b >= c && b >= d)\n      return 1;\n    else if (c >= d)\n      return 2;\n\n    return 3;\n  };\n\n  /**\n   * Simple swap util procedure swapping to cells in a given array\n   * @param  {array} array contains the cells to swap\n   * @param  {uint} i the first index\n   * @param  {uint} j the second index\n   */\n  var swapCell = function(array, i, j) {\n    var a = array[i];\n    array[i] = array[j];\n    array[j] = a;\n  };\n\n  /**\n   * Computes the total number of bits required to encoded\n   * the same encoded integer a given amount of times.\n   * @param  {uint} nbValues the number of encoded values\n   * @param  {[type]} encodedInteger the encoded value\n   * @return {uint} the number of bits to encoded nbValues of encodedInteger\n   */\n  var getBitsNbrFromEncodedInt = function(nbValues, trits, quints, bits) {\n    var totalBits = bits * nbValues;\n\n    if (trits)\n      totalBits += Math.floor((nbValues * 8 + 4) / 5);\n    else if (quints)\n      totalBits += Math.floor((nbValues * 7 + 2) / 3);\n\n    return totalBits;\n  };\n\n  /**\n   * Computes the number of weight values\n   * available in a given block\n   * @param  {Object} blockInfo the block info containing block size, max weight, etc...\n   * @return {uint} the number of weight values encoded inside the block\n   */\n  var getNumberWeightValues = function(blockInfo) {\n    var nbValues = blockInfo.width * blockInfo.height;\n    if (blockInfo.dualPlane)\n      nbValues *= 2;\n\n    // max nbValues = 12*12*2\n    return nbValues;\n  };\n\n\n  /**\n   * Computes the total number of bits needed to\n   * encode all the weights using Integer Sequence Encoding\n   * @param  {Object} blockInfo the block info containing block size, max weight, etc...\n   * @return {uint} the number of required bits to encoded the weights.\n   */\n  var getPackedBitSize = function(blockInfo) {\n    var nbValues = getNumberWeightValues(blockInfo);\n\n    var idx = blockInfo.maxWeight * 3;\n    var trits = maxWeightQuintsTritsMapper[idx + TRIT_IDX];\n    var quints = maxWeightQuintsTritsMapper[idx + QUINT_IDX];\n    var bits = maxWeightQuintsTritsMapper[idx + BIT_IDX];\n\n    return getBitsNbrFromEncodedInt(nbValues, trits, quints, bits);\n  };\n\n  /**\n   * Reads n values from a given array\n   * @param  {array} decodedColorValues the array to read\n   * @param  {uint} n the number of array cells to read\n   * @return {array} sub-array containing the read data\n   */\n  var readNDecodedColor = function(decodedColorValues, n) {\n    for (var i = 0; i < n; ++i)\n      subDecodedValue[i] = decodedColorValues[decodedColorValuesIdx++];\n    return subDecodedValue;\n  };\n\n  /**\n   * Clamps a pixel to the [0...255] range\n   * @param  {uint} beginIdx the index of the pixel alpha channel\n   * in the endpoints global array\n   */\n  var clampPixel = function(beginIdx) {\n    for (var i = 0; i < 4; ++i)\n      endpoints[beginIdx + i] = Math.max(0, Math.min(255, endpoints[beginIdx + i]));\n  };\n\n  /**\n   * Fills the endpoints global array with the given channel colors\n   * @param  {int} a the alpha channel component\n   * @param  {int} r the red channel component\n   * @param  {int} g the green channel component\n   * @param  {int} b the blue channel component\n   */\n  var fillEndpointsWithPixel = function(a, r, g, b) {\n    var idx = endpoints.currIdx;\n    endpoints[idx] = a;\n    endpoints[idx + 1] = r;\n    endpoints[idx + 2] = g;\n    endpoints[idx + 3] = b;\n  };\n\n  /**\n   * Parses the first 16 bytes a buffer\n   * considering it as an ASTC file buffer.\n   * @param  {ArrayBuffer} imgBuffer buffer containing the ASTC raw data\n   * @return {Object} contains data about the compressed image\n   */\n  var parseHeader = function(imgBuffer) {\n    var header = {};\n\n    var u8buffer = new Uint8Array(imgBuffer);\n    var u32Buffer = new Uint32Array(imgBuffer);\n\n    header.magic = u32Buffer[0];\n\n    var littleEndian = u8buffer[0] === (header.magic & 0xFF);\n\n    var isFormatCorrect = false;\n    if (littleEndian && header.magic === 0x5CA1AB13)\n      isFormatCorrect = true;\n    else if (!littleEndian && header.magic === 0x13ABA15C)\n      isFormatCorrect = true;\n\n    if (!isFormatCorrect)\n      console.error('The ASTC header does not meet the requirements.');\n\n    header.blockDimX = u8buffer[4];\n    header.blockDimY = u8buffer[5];\n    header.blockDimZ = u8buffer[6];\n\n    if (header.blockDimX > 12 || header.blockDimY > 12)\n      console.error('Incorrect ASTC file: block can not be larger than 12x12 pixels.');\n    if (header.blockDimZ > 1)\n      console.error('3D ASTC file are not supported.');\n\n    // Image width\n    header.xSize = u8buffer[7] + (u8buffer[8] << 8) + (u8buffer[9] << 16);\n    // Image height\n    header.ySize = u8buffer[10] + (u8buffer[11] << 8) + (u8buffer[12] << 16);\n    // Image depth\n    header.zSize = u8buffer[13] + (u8buffer[14] << 8) + (u8buffer[15] << 16);\n\n    if (header.zSize > 1)\n      console.error('3D ASTC file are not supported.');\n\n    return header;\n  };\n\n  /**\n   * Computes the layout of 2D block\n   * @param  {uint} blockModeBits extracted 11 first bit of the block\n   * @return {int} contains the layout of the block [0...9]\n   */\n  var findBlockLayout = function(blockModeBits) {\n    var layout = -1;\n\n    // Layout is in [0-4]\n    if ((blockModeBits & 0x1) || blockModeBits & 0x2) {\n      // layout is in [2-4]\n      if (blockModeBits & 0x8) {\n        // layout is in [3-4]\n        if (blockModeBits & 0x4)\n          layout = (blockModeBits & 0x100) ? 4 : 3;\n        else\n          layout = 2;\n      }\n      // layout is in [0-1]\n      else\n        layout = blockModeBits & 0x4 ? 1 : 0;\n\n      return layout;\n    }\n\n    // Layout is in [7-9]\n    if (blockModeBits & 0x100) {\n      // Layout [7-8]\n      if (blockModeBits & 0x80) {\n        if ((blockModeBits & 0x40))\n          console.error('Invalid block layout found.');\n        layout = (blockModeBits & 0x20) ? 8 : 7;\n      } else\n        layout = 9;\n\n      return layout;\n    }\n\n    layout = (blockModeBits & 0x80) ? 6 : 5;\n    return layout;\n  };\n\n  /**\n   * Extracts data regarding how block data are organized\n   * @param  {Uint8Array} u8buffer the ASTC raw data\n   * @param  {uint} blockId the first byte id of the current block\n   * @return {Object} contains block related data (void extent, maximum weight, etc;..)\n   */\n  var getBlockInfo = function(u8buffer, blockId) {\n    var blockInfo = CURRENT_BLOCK_INFO;\n    blockInfo.isVoidExtent = false;\n    blockInfo.error = false;\n\n    // Get the 'block mode' represented by the last 11 bits\n    var blockModeBits = readBits(u8buffer, blockId, bitsReadCount, 11);\n    bitsReadCount += 11;\n\n    // Checks the 9 least significant bits\n    // allowing to know if the block is a void-extent block (uniform color)\n    if ((blockModeBits & 0x01FF) === 0x1FC) {\n      blockInfo.isVoidExtent = true;\n      return blockInfo;\n    }\n\n    // Checks the first reserved pattern\n    // (xxxxx0000)\n    if ((blockModeBits & 0xF) === 0) {\n      blockInfo.error = true;\n      console.log('Warning: Block layout is reserved (xxxxx0000)');\n    }\n\n    // Checks the second reserved pattern\n    // (111xxxx00)\n    if ((blockModeBits & 0x3) === 0 &&\n      (blockModeBits & 0x1C0) === 0x1C0) {\n      blockInfo.error = true;\n      console.log('Warning: Block layout is reserved (111xxxx00)');\n    }\n\n    var layout = findBlockLayout(blockModeBits);\n    if (layout < 0)\n      console.error('Invalid block layout found.');\n\n    // Retrieves the R least significant bit according\n    // to the current block layout\n    var R = !!(blockModeBits & 0x10);\n    if (layout < 5)\n      R |= (blockModeBits & 0x3) << 1;\n    else\n      R |= (blockModeBits & 0xC) >> 1;\n\n    if (R < 2 || R > 7)\n      console.error('Invalid block mode. The file is not encoded in ASTC or corrupted.');\n\n    var a = 0;\n    var b = 0;\n    // Computes weights grid dimension\n    // Refers to ASTC specifications(Table 11)\n    switch (layout) {\n      case 0:\n        a = (blockModeBits >> 5) & 0x3;\n        b = (blockModeBits >> 7) & 0x3;\n        blockInfo.width = b + 4;\n        blockInfo.height = a + 2;\n        break;\n      case 1:\n        a = (blockModeBits >> 5) & 0x3;\n        b = (blockModeBits >> 7) & 0x3;\n        blockInfo.width = b + 8;\n        blockInfo.height = a + 2;\n        break;\n      case 2:\n        a = (blockModeBits >> 5) & 0x3;\n        b = (blockModeBits >> 7) & 0x3;\n        blockInfo.width = a + 2;\n        blockInfo.height = b + 8;\n        break;\n      case 3:\n        a = (blockModeBits >> 5) & 0x3;\n        b = (blockModeBits >> 7) & 0x1;\n        blockInfo.width = a + 2;\n        blockInfo.height = b + 6;\n        break;\n      case 4:\n        a = (blockModeBits >> 5) & 0x3;\n        b = (blockModeBits >> 7) & 0x1;\n        blockInfo.width = b + 2;\n        blockInfo.height = a + 2;\n        break;\n      case 5:\n        a = (blockModeBits >> 5) & 0x3;\n        blockInfo.width = 12;\n        blockInfo.height = a + 2;\n        break;\n      case 6:\n        a = (blockModeBits >> 5) & 0x3;\n        blockInfo.width = a + 2;\n        blockInfo.height = 12;\n        break;\n      case 7:\n        blockInfo.width = 6;\n        blockInfo.height = 10;\n        break;\n      case 8:\n        blockInfo.width = 10;\n        blockInfo.height = 6;\n        break;\n      case 9:\n        a = (blockModeBits >> 5) & 0x3;\n        b = (blockModeBits >> 9) & 0x3;\n        blockInfo.width = a + 6;\n        blockInfo.height = b + 6;\n        break;\n      default:\n        console.error('The block layout is not recognized. Layout should be [0-9].');\n    }\n\n    // The dual plane mode bit is the most significant bit\n    blockInfo.dualPlane = (layout !== 9) && (blockModeBits & 0x400);\n    // The high precision mode bit is the second most significant bit\n    blockInfo.highPrecisionRange = (layout !== 9) && (blockModeBits & 0x200);\n\n    // Selects the appropriate weight range\n    if (blockInfo.highPrecisionRange) {\n      var highWeightRanges = [9, 11, 15, 19, 23, 31];\n      blockInfo.maxWeight = highWeightRanges[R - 2];\n    } else {\n      var weightRanges = [1, 2, 3, 4, 5, 7];\n      blockInfo.maxWeight = weightRanges[R - 2];\n    }\n\n    return blockInfo;\n  };\n\n  /**\n   * Decodes a trit in colorData raw data\n   * @param  {Uint8Array} colorData encoded raw data\n   * @param  {uint} nbBitsPerValue number of bits\n   * on which the integer is encoded\n   * @param  {array} resultStorage contains decoded integer,\n   * the decoded trit will be pushed back at the end of this procedure\n   */\n\n  var lsbDecodingValues = new Uint8Array(5);\n  var msbDecodingValues = new Uint8Array(5);\n\n  var decodeTrit = function(colorData, nbBitsPerValue) {\n    var m = lsbDecodingValues;\n    var t = msbDecodingValues;\n    var T = 0;\n\n    // Refers to ASTC specifications (Table 17)\n    m[0] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    T = readBits(colorData, 0, colorDataBitsRead, 2);\n    colorDataBitsRead += 2;\n\n    m[1] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    T |= readBits(colorData, 0, colorDataBitsRead, 2) << 2;\n    colorDataBitsRead += 2;\n\n    m[2] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    T |= readBits(colorData, 0, colorDataBitsRead, 1) << 4;\n    colorDataBitsRead += 1;\n\n    m[3] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    T |= readBits(colorData, 0, colorDataBitsRead, 2) << 5;\n    colorDataBitsRead += 2;\n\n    m[4] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    T |= readBits(colorData, 0, colorDataBitsRead, 1) << 7;\n    colorDataBitsRead += 1;\n\n    var C = 0 >>> 0;\n    if (extractBits(T, 2, 4) === 7) {\n      C = (extractBits(T, 5, 7) << 2) | extractBits(T, 0, 1);\n      t[3] = 2;\n      t[4] = 2;\n    } else {\n      C = extractBits(T, 0, 4);\n      if (extractBits(T, 5, 6) === 3) {\n        t[4] = 2;\n        t[3] = extractBits(T, 7, 7);\n      } else {\n        t[4] = extractBits(T, 7, 7);\n        t[3] = extractBits(T, 5, 6);\n      }\n    }\n\n    if (extractBits(C, 0, 1) === 3) {\n      t[2] = 2;\n      t[1] = extractBits(C, 4, 4);\n      t[0] = (extractBits(C, 3, 3) << 1) | (extractBits(C, 2, 2) & ~extractBits(C, 3, 3));\n    } else if (extractBits(C, 2, 3) === 3) {\n      t[2] = 2;\n      t[1] = 2;\n      t[0] = extractBits(C, 0, 1);\n    } else {\n      t[2] = extractBits(C, 4, 4);\n      t[1] = extractBits(C, 2, 3);\n      t[0] = (extractBits(C, 1, 1) << 1) | (extractBits(C, 0, 0) & ~extractBits(C, 1, 1));\n    }\n\n    for (var i = 0; i < 5; ++i) {\n      var idx = resultDecodedStorage.currIndex;\n      resultDecodedStorage[idx] = 1;\n      resultDecodedStorage[idx + 1] = 0;\n      resultDecodedStorage[idx + 2] = nbBitsPerValue;\n      resultDecodedStorage[idx + 3] = t[i];\n      resultDecodedStorage[idx + 4] = 0;\n      resultDecodedStorage[idx + 5] = m[i];\n\n      resultDecodedStorage.currIndex += 6;\n    }\n  };\n\n  /**\n   * Decodes a quint in colorData raw data\n   * @param  {Uint8Array} colorData encoded raw data\n   * @param  {uint} nbBitsPerValue number of bits\n   * on which the integer is encoded\n   * @param  {array} resultStorage contains decoded integer,\n   * the decoded quint will be pushed back at the end of this procedure\n   */\n  var decodeQuint = function(colorData, nbBitsPerValue) {\n    var m = lsbDecodingValues;\n    var q = msbDecodingValues;\n    var Q = 0;\n\n    // Refers to ASTC specifications (Table 18)\n    m[0] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    Q = readBits(colorData, 0, colorDataBitsRead, 3);\n    colorDataBitsRead += 3;\n\n    m[1] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    Q |= readBits(colorData, 0, colorDataBitsRead, 2) << 3;\n    colorDataBitsRead += 2;\n\n    m[2] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    Q |= readBits(colorData, 0, colorDataBitsRead, 2) << 5;\n    colorDataBitsRead += 2;\n\n    if (extractBits(Q, 1, 2) === 3 && extractBits(Q, 5, 6) === 0) {\n      q[0] = 4;\n      q[1] = 4;\n      q[2] = (extractBits(Q, 0, 0) << 2) | ((extractBits(Q, 4, 4) & ~extractBits(Q, 0, 0)) << 1) | (extractBits(Q, 3, 3) & ~extractBits(Q, 0, 0));\n    } else {\n      var C = 0 >>> 0;\n      if (extractBits(Q, 1, 2) === 3) {\n        q[2] = 4;\n        C = (extractBits(Q, 3, 4) << 3) | ((~extractBits(Q, 5, 6) & 3) << 1) | (extractBits(Q, 0, 0));\n      } else {\n        q[2] = extractBits(Q, 5, 6);\n        C = extractBits(Q, 0, 4);\n      }\n\n      if (extractBits(C, 0, 2) === 5) {\n        q[1] = 4;\n        q[0] = extractBits(C, 3, 4);\n      } else {\n        q[1] = extractBits(C, 3, 4);\n        q[0] = extractBits(C, 0, 2);\n      }\n    }\n\n    for (var i = 0; i < 3; ++i) {\n      var idx = resultDecodedStorage.currIndex;\n      resultDecodedStorage[idx] = 0;\n      resultDecodedStorage[idx + 1] = 1;\n      resultDecodedStorage[idx + 2] = nbBitsPerValue;\n      resultDecodedStorage[idx + 3] = 0;\n      resultDecodedStorage[idx + 4] = q[i];\n      resultDecodedStorage[idx + 5] = m[i];\n\n      resultDecodedStorage.currIndex += 6;\n    }\n  };\n\n  /**\n   * Decodes nbValues of colorData raw data\n   * according to its max range value\n   * @param  {Uint8Array} colorData encoded raw data\n   * @param  {uint} range max value of the Integere Sequence\n   * @param  {uint} nbValues contains the number of values to decode\n   * @return {array} contains decoded integer\n   */\n  var decodeIntegerSequence = function(colorData, range, nbValues) {\n    var baseIdx = range * 3;\n    var trits = maxWeightQuintsTritsMapper[baseIdx + TRIT_IDX];\n    var quints = maxWeightQuintsTritsMapper[baseIdx + QUINT_IDX];\n    var bits = maxWeightQuintsTritsMapper[baseIdx + BIT_IDX];\n\n    resultDecodedStorage.currIndex = 0;\n\n    var nbDecodedValues = 0;\n    while (nbDecodedValues < nbValues) {\n\n      if (quints === 0 && trits === 0) {\n        var idx = resultDecodedStorage.currIndex;\n        resultDecodedStorage[idx] = trits;\n        resultDecodedStorage[idx + 1] = quints;\n        resultDecodedStorage[idx + 2] = bits;\n        resultDecodedStorage[idx + 3] = 0;\n        resultDecodedStorage[idx + 4] = 0;\n        resultDecodedStorage[idx + 5] = readBits(colorData, 0, colorDataBitsRead, bits);\n        colorDataBitsRead += bits;\n\n        resultDecodedStorage.currIndex += 6;\n\n        nbDecodedValues++;\n      } else if (quints === 1 && trits === 0) {\n        decodeQuint(colorData, bits);\n        nbDecodedValues += 3;\n      } else {\n        decodeTrit(colorData, bits);\n        nbDecodedValues += 5;\n      }\n    }\n  };\n\n  /**\n   * Decodes color from the colorData encoded Integer Sequence\n   * @param  {Uint8Array} colorData encoded color raw data\n   * @param  {array} colorModes contains the color for each partition\n   * @param  {uint} nbPartitions Number of available partitions\n   * @param  {uint} colorDataBits remaining bits number on which color data are encoded\n   * @return {array} decoded endpoints value in the [0...255] range\n   */\n\n  var endpointValuesOutput = new Uint8Array(32);\n\n  var decodeColorValues = function(colorData, colorModes, nbPartitions, colorDataBits) {\n    var trits = 0;\n    var quints = 0;\n    var bits = 0;\n    var i = 0;\n    // Computes the number of endpoint by using the associated class\n    // max endpoint values = 32\n    var nbEndpointValues = 0;\n    for (i = 0; i < nbPartitions; ++i)\n      nbEndpointValues += ((colorModes[i] >> 2) + 1) << 1;\n\n    // Finds the max range for each color endpoints\n    var range = 256;\n    while (--range > 0) {\n\n      var idx = range * 3;\n      trits = maxWeightQuintsTritsMapper[idx + TRIT_IDX];\n      quints = maxWeightQuintsTritsMapper[idx + QUINT_IDX];\n      bits = maxWeightQuintsTritsMapper[idx + BIT_IDX];\n\n      var bitsNbr = getBitsNbrFromEncodedInt(nbEndpointValues, trits, quints, bits);\n      if (bitsNbr <= colorDataBits) {\n        // Some integers share the same encoding\n        // this piece of code finds the smallest one\n        while (--range > 0) {\n          var newIdx = range * 3;\n          var newTrits = maxWeightQuintsTritsMapper[newIdx + TRIT_IDX];\n          var newQuints = maxWeightQuintsTritsMapper[newIdx + QUINT_IDX];\n          var newBits = maxWeightQuintsTritsMapper[newIdx + BIT_IDX];\n\n          if (newTrits !== trits || newQuints !== quints || newBits !== bits)\n            break;\n        }\n\n        range++;\n        break;\n      }\n    }\n\n    // Decodes the integer sequence based on the range and\n    // the number of values\n    var endpointIdx = 0;\n    decodeIntegerSequence(colorData, range, nbEndpointValues);\n\n    for (i = 0; i < nbEndpointValues * 6; i += 6) {\n      var bitLength = resultDecodedStorage[i + BIT_IDX];\n      var bitValue = resultDecodedStorage[i + BIT_IDX + 3];\n\n      // Refers to ASTC specifications(Section 3.11)\n      var result;\n      if (resultDecodedStorage[i + TRIT_IDX]) result = cacheDecodeTrits[bitLength + resultDecodedStorage[i + TRIT_IDX + 3] * 7 + bitValue * 21];\n      else if (resultDecodedStorage[i + QUINT_IDX]) result = cacheDecodeQuints[bitLength + resultDecodedStorage[i + QUINT_IDX + 3] * 6 + bitValue * 30];\n      else result = cacheDecodeSimple[bitLength + bitValue * 9];\n\n      endpointValuesOutput[endpointIdx++] = result;\n    }\n\n    // Makes sure each decoded value is not ambiguous\n    for (i = 0; i < nbEndpointValues; ++i)\n      if (endpointValuesOutput[i] > 255)\n        console.error('Decoded endpoint value can not be above 255.');\n  };\n\n  /**\n   * Computes the two color endpoint values\n   * from the decoded Integer Sequence data\n   * @param  {[type]} endpointColorValues [description]\n   * @param  {[type]} colorMode           [description]\n   */\n  var computeColorEndpointsLDR = function(endpointColorValues, colorMode) {\n    var v = 0;\n    var currIdx = 0;\n\n    switch (colorMode) {\n      case 0:\n        v = readNDecodedColor(endpointColorValues, 2);\n        fillEndpointsWithPixel(0xFF, v[0], v[0], v[0]);\n        endpoints.currIdx += 4;\n        fillEndpointsWithPixel(0xFF, v[1], v[1], v[1]);\n        endpoints.currIdx += 4;\n        break;\n      case 1:\n        v = readNDecodedColor(endpointColorValues, 2);\n        var L0 = (v[0] >> 2) | (v[1] & 0xC0);\n        var L1 = Math.max(L0 + (v[1] & 0x3F), 0xFF);\n\n        fillEndpointsWithPixel(0xFF, L0, L0, L0);\n        endpoints.currIdx += 4;\n        fillEndpointsWithPixel(0xFF, L1, L1, L1);\n        endpoints.currIdx += 4;\n        break;\n      case 4:\n        v = readNDecodedColor(endpointColorValues, 4);\n\n        fillEndpointsWithPixel(v[2], v[0], v[0], v[0]);\n        endpoints.currIdx += 4;\n        fillEndpointsWithPixel(v[3], v[1], v[1], v[1]);\n        endpoints.currIdx += 4;\n        break;\n      case 5:\n        v = readNDecodedColor(endpointColorValues, 4);\n\n        bitTransferSigned(v, 1, 0);\n        bitTransferSigned(v, 3, 2);\n\n        currIdx = endpoints.currIdx;\n\n        fillEndpointsWithPixel(v[2], v[0], v[0], v[0]);\n        endpoints.currIdx += 4;\n\n        fillEndpointsWithPixel(v[2] + v[3], v[0] + v[1], v[0] + v[1], v[0] + v[1]);\n        endpoints.currIdx += 4;\n\n        clampPixel(currIdx);\n        clampPixel(currIdx + 4);\n        break;\n      case 6:\n        v = readNDecodedColor(endpointColorValues, 4);\n\n        fillEndpointsWithPixel(0xFF, v[0] * v[3] >> 8, v[1] * v[3] >> 8, v[2] * v[3] >> 8);\n        endpoints.currIdx += 4;\n        fillEndpointsWithPixel(0xFF, v[0], v[1], v[2]);\n        endpoints.currIdx += 4;\n        break;\n      case 8:\n        v = readNDecodedColor(endpointColorValues, 6);\n        if (v[1] + v[3] + v[5] >= v[0] + v[2] + v[4]) {\n          fillEndpointsWithPixel(0xFF, v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n          fillEndpointsWithPixel(0xFF, v[1], v[3], v[5]);\n          endpoints.currIdx += 4;\n        } else {\n          blueContract(0xFF, v[1], v[3], v[5]);\n          endpoints.currIdx += 4;\n          blueContract(0xFF, v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n        }\n        break;\n      case 9:\n        v = readNDecodedColor(endpointColorValues, 6);\n\n        bitTransferSigned(v, 1, 0);\n        bitTransferSigned(v, 3, 2);\n        bitTransferSigned(v, 5, 4);\n\n        currIdx = endpoints.currIdx;\n\n        if (v[1] + v[3] + v[5] >= 0) {\n          fillEndpointsWithPixel(0xFF, v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n\n          fillEndpointsWithPixel(0xFF, v[0] + v[1], v[2] + v[3], v[4] + v[5]);\n          endpoints.currIdx += 4;\n        } else {\n          blueContract(0xFF, v[0] + v[1], v[2] + v[3], v[4] + v[5]);\n          endpoints.currIdx += 4;\n\n          blueContract(0xFF, v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n        }\n        clampPixel(currIdx);\n        clampPixel(currIdx + 4);\n        break;\n      case 10:\n        v = readNDecodedColor(endpointColorValues, 6);\n\n        fillEndpointsWithPixel(v[4], v[0] * v[3] >> 8, v[1] * v[3] >> 8, v[2] * v[3] >> 8);\n        endpoints.currIdx += 4;\n        fillEndpointsWithPixel(v[5], v[0], v[1], v[2]);\n        endpoints.currIdx += 4;\n        break;\n      case 12:\n        v = readNDecodedColor(endpointColorValues, 8);\n        if (v[1] + v[3] + v[5] >= v[0] + v[2] + v[4]) {\n          fillEndpointsWithPixel(v[6], v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n          fillEndpointsWithPixel(v[7], v[1], v[3], v[5]);\n          endpoints.currIdx += 4;\n        } else {\n          blueContract(v[7], v[1], v[3], v[5]);\n          endpoints.currIdx += 4;\n          blueContract(v[6], v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n        }\n        break;\n      case 13:\n        v = readNDecodedColor(endpointColorValues, 8);\n\n        bitTransferSigned(v, 1, 0);\n        bitTransferSigned(v, 3, 2);\n        bitTransferSigned(v, 5, 4);\n        bitTransferSigned(v, 7, 6);\n\n        currIdx = endpoints.currIdx;\n\n        if (v[1] + v[3] + v[5] >= 0) {\n          fillEndpointsWithPixel(v[6], v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n\n          fillEndpointsWithPixel(v[7] + v[6], v[0] + v[1], v[2] + v[3], v[4] + v[5]);\n          endpoints.currIdx += 4;\n        } else {\n          blueContract(v[6] + v[7], v[0] + v[1], v[2] + v[3], v[4] + v[5]);\n          endpoints.currIdx += 4;\n\n          blueContract(v[6], v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n        }\n        clampPixel(currIdx);\n        clampPixel(currIdx + 4);\n        break;\n      default:\n        console.error('Unsupported color endpoint mode. Only LDR modes are supported.');\n    }\n  };\n\n  /**\n   * Unquantizes a single texel returning it to a standard\n   * [0...64] range according to its trit/quint/bit encoding\n   * @param  {uint} val the decoded integer\n   * @return {uint} the unquantized weight in the range [0...64]\n   */\n  var unquantizeTexel = function(i) {\n    var bitLength = resultDecodedStorage[i + BIT_IDX];\n    var bitValue = resultDecodedStorage[i + BIT_IDX + 3];\n\n    // Refers to ASTC specifications (Section 3.11)\n    if (resultDecodedStorage[i + TRIT_IDX]) return cacheUnquantizeTrits[bitLength + resultDecodedStorage[i + TRIT_IDX + 3] * 4 + bitValue * 12];\n    if (resultDecodedStorage[i + QUINT_IDX]) return cacheUnquantizeQuints[bitLength + resultDecodedStorage[i + QUINT_IDX + 3] * 3 + bitValue * 15];\n    return cacheUnquantizeSimple[bitLength + bitValue * 8];\n  };\n\n  /**\n   * Returns weights in a standard range [0...64]\n   * @param  {array} weightValues contains the decoded\n   * Integer Sequence of the weight data\n   * @param  {uint} blockId the current block index\n   * @param  {uint} blockWidth the width of the blocks\n   * @param  {uint} blockHeight the height of the blocks\n   * @return {array} multidimensional array containing the weights\n   * for both planes\n   */\n\n  var unquantizedOutput = new Uint8Array(2 * 144);\n  var infilledWeightsOutput = new Uint8Array(2 * 144);\n\n  var unquantizeWeights = function(blockInfo, blockWidth, blockHeight, nbWeightValues) {\n\n    var bw = blockInfo.width;\n    var bh = blockInfo.height;\n    var bwh = bw * bh;\n\n    var i = 0;\n    var end = 0;\n\n    if (blockInfo.dualPlane) {\n      end = Math.min(nbWeightValues * 2, bwh);\n      for (i = 0; i < end; ++i) {\n        unquantizedOutput[i] = unquantizeTexel(i * 12);\n        unquantizedOutput[i + 144] = unquantizeTexel(i * 12 + 6);\n      }\n\n    } else {\n      // Unquantizes the whole weight grid\n      end = Math.min(nbWeightValues, bwh);\n      for (i = 0; i < end; ++i) {\n        unquantizedOutput[i] = unquantizeTexel(i * 6);\n      }\n    }\n\n    // Applies the weight infill procedure\n    // Refers to ASTC specifications (Section 3.12)\n    // 3D blocks are not handled for the moment\n    var Ds = ((1024 + (blockWidth / 2)) / (blockWidth - 1)) >>> 0;\n    var Dt = ((1024 + (blockHeight / 2)) / (blockHeight - 1)) >>> 0;\n    var dPlane = (blockInfo.dualPlane) ? 2 : 1;\n\n    for (var planeId = 0; planeId < dPlane; ++planeId) {\n      var idp = planeId * 144;\n      for (var t = 0; t < blockHeight; ++t) {\n        for (var s = 0; s < blockWidth; ++s) {\n          var cs = Ds * s;\n          var ct = Dt * t;\n\n          var gs = (cs * (bw - 1) + 32) >> 6;\n          var gt = (ct * (bh - 1) + 32) >> 6;\n\n          var js = gs >> 4;\n          var fs = gs & 0xF;\n\n          var jt = gt >> 4;\n          var ft = gt & 0x0F;\n\n          var w11 = (fs * ft + 8) >> 4;\n          var w10 = (ft - w11) >>> 0;\n          var w01 = (fs - w11) >>> 0;\n          var w00 = (16 - fs - ft + w11) >>> 0;\n\n          var v0 = js + jt * bw;\n\n          var val = 8;\n          var vid = v0;\n          if (vid < bwh) val += w00 * unquantizedOutput[vid + idp];\n\n          vid = v0 + 1;\n          if (vid < bwh) val += w01 * unquantizedOutput[vid + idp];\n\n          vid = v0 + bw;\n          if (vid < bwh) val += w10 * unquantizedOutput[vid + idp];\n\n          vid = v0 + bw + 1;\n          if (vid < bwh) val += w11 * unquantizedOutput[vid + idp];\n\n          infilledWeightsOutput[t * blockWidth + s + idp] = val >> 4;\n        }\n      }\n    }\n  };\n\n  /**\n   * Decompresses a single void-extent block,\n   * in other words, a block containing only one color\n   * @param  {Uint8Array} u8buffer the ASTC raw data\n   * @param  {uint} blockId the current block index\n   * @param  {uint} blockWidth the width of the blocks\n   * @param  {uint} blockHeight the height of the blocks\n   * @return {array} containing blockWidth * blockHeight Pixels\n   */\n  var decompressVoidExtent = function(u8buffer, blockId, blockInfo, blockWidth, blockHeight) {\n    // Do not read extra data\n    bitsReadCount += 53;\n\n    var r16 = readBits(u8buffer, blockId, bitsReadCount, 16);\n    bitsReadCount += 16;\n    var g16 = readBits(u8buffer, blockId, bitsReadCount, 16);\n    bitsReadCount += 16;\n    var b16 = readBits(u8buffer, blockId, bitsReadCount, 16);\n    bitsReadCount += 16;\n    var a16 = readBits(u8buffer, blockId, bitsReadCount, 16);\n    bitsReadCount += 16;\n\n    if (bitsReadCount !== 128)\n      console.error('Invalid void-extent bits reading.');\n\n    var nbPixel = blockWidth * blockHeight * 4;\n    for (var i = 0; i < nbPixel; i += 4) {\n      blockPixelsOutput[i] = extractBits(a16, 0, 7);\n      blockPixelsOutput[i + 1] = extractBits(r16, 0, 7);\n      blockPixelsOutput[i + 2] = extractBits(g16, 0, 7);\n      blockPixelsOutput[i + 3] = extractBits(b16, 0, 7);\n    }\n  };\n\n  /**\n   * Decompresses a single block by returning\n   * the error color (0xFF, 0xFF, 0x00, 0xFF)\n   * @param  {uint} blockWidth the width of the blocks\n   * @param  {uint} blockHeight the height of the blocks\n   * @return {array} containing blockWidth * blockHeight Pixels\n   */\n  var getErrorPixelBlock = function(blockWidth, blockHeight) {\n    var nbPixel = blockWidth * blockHeight * 4;\n    for (var i = 0; i < nbPixel; i += 4) {\n      blockPixelsOutput[i] = 0xFF;\n      blockPixelsOutput[i + 1] = 0xFF;\n      blockPixelsOutput[i + 2] = 0x00;\n      blockPixelsOutput[i + 3] = 0xFF;\n    }\n  };\n\n  /**\n   * Decompresses a single block by retrieving\n   * the block layout as well as the number of partitions,\n   * the color endpoints and weights data.\n   * @param  {Uint8Array} u8buffer the ASTC raw data\n   * @param  {uint} blockId the current block index\n   * @param  {uint} blockWidth the width of the blocks\n   * @param  {uint} blockHeight the height of the blocks\n   * @return {array} containing blockWidth * blockHeight Pixels\n   */\n  var decompressBlock = function(u8buffer, blockId, blockWidth, blockHeight) {\n    bitsReadCount = 0;\n    bitsWrittenCount = 0;\n    colorDataBitsRead = 0;\n    decodedColorValuesIdx = 0;\n\n    var i = 0;\n    var CEM = 0;\n    var blockInfo = getBlockInfo(u8buffer, blockId);\n\n    if (blockInfo.error)\n      return getErrorPixelBlock(blockWidth, blockHeight);\n\n    // Handles the case whenever the block is filled with only one color\n    if (blockInfo.isVoidExtent)\n      return decompressVoidExtent(u8buffer, blockId, blockInfo, blockWidth, blockHeight);\n\n    if (blockInfo.width > blockWidth)\n      console.error('Texel weight grid width can not be larger than the block width.');\n    if (blockInfo.height > blockHeight)\n      console.error('Texel weight grid height can not be larger than the block height.');\n\n    // Extracts the partitions number\n    var nbPartitions = readBits(u8buffer, blockId, bitsReadCount, 2) + 1;\n    bitsReadCount += 2;\n\n    if (nbPartitions > 4)\n      console.error('The block partitions number is too high.');\n    if (nbPartitions === 4 && blockInfo.dualPlane)\n      return getErrorPixelBlock(blockWidth, blockHeight);\n\n    // Reads the extra configuration field\n    // At most 4 modes describing how color data is encoded\n    var colorEndpointModes = [0, 0, 0, 0];\n    var partitionIndex = -1;\n    var planeIndex = -1;\n    var cemBits = 0;\n    if (nbPartitions === 1) {\n      colorEndpointModes[0] = readBits(u8buffer, blockId, bitsReadCount, 4);\n      bitsReadCount += 4;\n      partitionIndex = 0;\n    } else {\n      // Reads 10 bits containing the partition index\n      partitionIndex = readBits(u8buffer, blockId, bitsReadCount, 10);\n      bitsReadCount += 10;\n      // Reads 6 bits containing the cem extra\n      cemBits = readBits(u8buffer, blockId, bitsReadCount, 6);\n      bitsReadCount += 6;\n    }\n    var baseMode = (cemBits & 3);\n\n    // Computes remaining bits containing color endpoint data\n    //var numberWeightBits = getPackedBitSize(blockInfo);\n    var remainingBits = 128 - getPackedBitSize(blockInfo) - bitsReadCount;\n    var dualPlaneSelectorBits = (blockInfo.dualPlane) ? 2 : 0;\n    remainingBits -= dualPlaneSelectorBits;\n\n    // Gets extra bits number according to CEM\n    // mode 0 does not need any extra CEM bits\n    var extraCEMbitsNb = 0;\n    if (baseMode) {\n      if (nbPartitions === 2)\n        extraCEMbitsNb = 2;\n      else if (nbPartitions === 3)\n        extraCEMbitsNb = 5;\n      else if (nbPartitions === 4)\n        extraCEMbitsNb = 8;\n    }\n    remainingBits -= extraCEMbitsNb;\n\n    // Reads color data\n    // read data are written to a buffer for later use\n    var colorDataBits = remainingBits;\n    for (i = 0; i < 16; ++i)\n      colorEndpointData[i] = 0;\n\n    while (remainingBits > 0) {\n      var bitsNb = Math.min(remainingBits, 8);\n      var bits = readBits(u8buffer, blockId, bitsReadCount, bitsNb);\n      bitsReadCount += bitsNb;\n\n      writeBits(colorEndpointData, bits, bitsNb, bitsWrittenCount);\n      bitsWrittenCount += bitsNb;\n\n      remainingBits -= 8;\n    }\n\n    planeIndex = readBits(u8buffer, blockId, bitsReadCount, dualPlaneSelectorBits);\n    bitsReadCount += dualPlaneSelectorBits;\n\n    // Reads extra CEM data\n    if (baseMode) {\n      var extraCEMbits = readBits(u8buffer, blockId, bitsReadCount, extraCEMbitsNb);\n      bitsReadCount += extraCEMbitsNb;\n\n      CEM = (extraCEMbits << 6) | cemBits;\n      CEM >>= 2;\n\n      // Extracts the class selector bit by bit\n      var C = classSelectorBitsArray;\n      var M = colorModeLSB;\n      for (i = 0; i < nbPartitions; ++i) {\n        C[i] = CEM & 1;\n        CEM >>= 1;\n      }\n      // Extracts the color endoint mode low bits\n      /*for (i = 0; i < nbPartitions; ++i) {\n        M[i] = CEM & 3;\n        CEM >>= 2;\n        if (M[i] > 3)\n          console.error(  'Error while extracting the color endpoint mode LSB.'); \n      }*/\n      for (i = 0; i < nbPartitions; ++i) {\n        M[i] = CEM & 3;\n        CEM >>= 2;\n        if (M[i] > 3)\n          console.error('Error while extracting the color endpoint mode LSB.');\n\n        colorEndpointModes[i] = baseMode;\n        if (!(C[i]))\n          colorEndpointModes[i] -= 1;\n        colorEndpointModes[i] <<= 2;\n        colorEndpointModes[i] |= M[i];\n      }\n    } else if (nbPartitions > 1) {\n      CEM = cemBits >> 2;\n      for (i = 0; i < nbPartitions; ++i)\n        colorEndpointModes[i] = CEM;\n    }\n\n    // Makes sure the extracted data obtained until here is correct\n    var blockBitsRead = bitsReadCount + getPackedBitSize(blockInfo);\n\n    for (i = 0; i < nbPartitions; ++i)\n      if (colorEndpointModes[i] >= 16)\n        console.error('The color endpoint mode ' + colorEndpointModes[i] + ' is not correct.');\n\n    if (blockBitsRead < 128)\n      console.error('The current block as not been read entirely. (' + blockBitsRead + ' read)');\n    else if (blockBitsRead > 128)\n      console.error('Too many bits have been read for the current block. (' + blockBitsRead + ' read)');\n\n    // Decodes color data\n    decodeColorValues(colorEndpointData, colorEndpointModes, nbPartitions, colorDataBits);\n\n    // Computes endpoint for all partitions\n    endpoints.currIdx = 0;\n    for (i = 0; i < nbPartitions; i++)\n      computeColorEndpointsLDR(endpointValuesOutput, colorEndpointModes[i]);\n\n    // Reads remaining bits containing packed texel weight data\n    // This code can be factorized with the color data reading above\n    var texelWeightDataIndex = 0;\n    for (i = 0; i < 16; ++i)\n      texelWeightData[texelWeightDataIndex++] = u8buffer[blockId + i];\n\n    // Reverses the textWeightData array\n    // and each byte\n    reverseU8Array(texelWeightData);\n\n    var weightPackedSize = getPackedBitSize(blockInfo);\n    var clearByteStart = (weightPackedSize >> 3) + 1;\n    var nbBytesToClean = 16 - clearByteStart;\n    texelWeightData[clearByteStart - 1] &= (1 << (weightPackedSize % 8)) - 1;\n    for (i = 0; i < nbBytesToClean; ++i)\n      texelWeightData[clearByteStart + i] = 0;\n\n    // Decodes the weight\n    colorDataBitsRead = 0;\n    var nbWeightValues = getNumberWeightValues(blockInfo);\n    decodeIntegerSequence(texelWeightData, blockInfo.maxWeight, nbWeightValues);\n\n    unquantizeWeights(blockInfo, blockWidth, blockHeight, nbWeightValues);\n\n    // Interpolates colors\n    var smallBlock = (blockHeight * blockWidth) < 32;\n    var rnum = precomputeSelectPartition(partitionIndex, nbPartitions);\n    for (var j = 0; j < blockHeight; j++) {\n      for (i = 0; i < blockWidth; i++) {\n        var partition = selectPartition(rnum, i, j, 0, nbPartitions, smallBlock);\n        if (partition >= nbPartitions)\n          console.error('The block partition index can not be larger or equal to the number of partitions.');\n\n        var rowIndex = (j * blockWidth + i) * 4;\n        var endpointBaseIdx = partition * 8;\n        for (var c = 0; c < 4; ++c) {\n          var C0 = endpoints[endpointBaseIdx + c] >>> 0;\n          C0 = replicateBits0816Map[C0];\n\n          var C1 = endpoints[endpointBaseIdx + c + 4] >>> 0;\n          C1 = replicateBits0816Map[C1];\n\n          var plane = 0 >>> 0;\n          if (blockInfo.dualPlane && (((planeIndex + 1) & 3) === c))\n            plane = 1;\n\n          var weight = infilledWeightsOutput[j * blockWidth + i + plane * 144];\n          var color = Math.floor(((C0 * (64 - weight) + C1 * weight + 32) / 64));\n\n          if (color === 65535)\n            blockPixelsOutput[rowIndex + c] = 255;\n          else\n            blockPixelsOutput[rowIndex + c] = Math.round(255.0 * (color / 65536.0));\n        }\n      }\n    }\n  };\n\n  /**\n   * Decompresses a complete buffer containing ASTC file raw data\n   * @param  {ArrayBuffer} contains the compressed ASTC raw data\n   * @return {Object} contains the uncompressed image buffer\n   * as well as the image dimensions\n   */\n  // TODO export\n  var decompress = function(imgBuffer) {\n    var u8buffer = new Uint8Array(imgBuffer);\n\n    // Retrieves the header\n    var header = parseHeader(imgBuffer);\n\n    var imgWidth = header.xSize;\n    var imgHeight = header.ySize;\n    var halfImgHeight = (imgHeight >> 1);\n\n    var blockWidth = header.blockDimX;\n    var blockHeight = header.blockDimY;\n\n    var firstBlockIndex = 16;\n    var blockNb = 0;\n\n    // Initializes temp storages used\n    // in helper functions\n    blockPixelsOutput = new Uint8Array(blockWidth * blockHeight * 4);\n\n    var j = 0;\n    var i = 0;\n    var resultImg = new Uint8ClampedArray(imgWidth * imgHeight * 4);\n\n    for (j = 0; j < imgHeight; j += blockHeight) {\n      for (i = 0; i < imgWidth; i += blockWidth) {\n\n        var currentBlockIndex = firstBlockIndex + blockNb * 16;\n        // Decompresses the current block\n        decompressBlock(u8buffer, currentBlockIndex, blockWidth, blockHeight);\n\n        var widthBound = Math.min(blockWidth, imgWidth - i);\n        var heightBound = Math.min(blockHeight, imgHeight - j);\n        var rowIndex = (j * imgWidth + i) * 4;\n        for (var jj = 0; jj < heightBound; jj++) {\n          var destId = rowIndex + jj * imgWidth * 4;\n          var srcId = jj * blockWidth * 4;\n\n          for (var x = 0; x < widthBound * 4; x += 4) {\n            resultImg[destId + x] = blockPixelsOutput[srcId + x + 1];\n            resultImg[destId + x + 1] = blockPixelsOutput[srcId + x + 2];\n            resultImg[destId + x + 2] = blockPixelsOutput[srcId + x + 3];\n            resultImg[destId + x + 3] = blockPixelsOutput[srcId + x];\n          }\n        }\n\n        ++blockNb;\n      }\n    }\n\n    // Flips the image using the Y-axis\n    for (j = 0; j < halfImgHeight; j++) {\n      for (i = 0; i < imgWidth; i++) {\n        var beginByte = (j * imgWidth + i) * 4;\n        var endByte = ((imgHeight - j - 1) * imgWidth + i) * 4;\n\n        swapCell(resultImg, beginByte, endByte);\n        swapCell(resultImg, beginByte + 1, endByte + 1);\n        swapCell(resultImg, beginByte + 2, endByte + 2);\n        swapCell(resultImg, beginByte + 3, endByte + 3);\n      }\n    }\n\n    var result = {};\n    result.img = resultImg;\n    result.width = imgWidth;\n    result.height = imgHeight;\n\n    return result;\n  };\n\n  module.exports = {\n    decompress: decompress\n  };\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n  'use strict';\n\n  var replicateBits = __webpack_require__(3).replicateBits;\n\n  // Describes how to unpack trit/quint\n  // with no additional bits\n  var WEIGHT_TRIT_RANGE = [0, 32, 63];\n  var WEIGHT_QUINT_RANGE = [0, 16, 32, 47, 63];\n\n  ///////////////////\n  // CACHE UNQUANTIZE\n  ///////////////////\n\n  // -----------------\n  // UNQUANTIZE SIMPLE\n  // -----------------\n  var cacheUnquantizeSimple = new Uint8Array(256 * 8);\n  for (var bitValue = 0; bitValue < 256; ++bitValue) {\n    for (var bitLength = 1; bitLength < 8; ++bitLength) {\n\n      var result = replicateBits(bitValue, bitLength, 6);\n      if (result > 32) result++;\n\n      cacheUnquantizeSimple[bitLength + bitValue * 8] = result;\n    }\n  }\n\n  // ----------------\n  // UNQUANTIZE TRITS\n  // ----------------\n  var cacheUnquantizeTrits = new Uint8Array(256 * 3 * 4);\n  for (var bitValue = 0; bitValue < 256; ++bitValue) {\n    for (var tri = 0; tri < 3; ++tri) {\n      for (var bitLength = 0; bitLength < 4; ++bitLength) {\n\n        var C = 0;\n        var B = 0;\n        var result;\n        switch (bitLength) {\n          case 0:\n            result = WEIGHT_TRIT_RANGE[tri];\n            break;\n          case 1:\n            C = 50;\n            break;\n          case 2:\n            C = 23;\n            var bBit = (bitValue >> 1) & 1;\n            B = (bBit << 6) | (bBit << 2) | bBit;\n            break;\n          case 3:\n            C = 11;\n            var cbBits = (bitValue >> 1) & 3;\n            B = (cbBits << 5) | cbBits;\n            break;\n        }\n\n        if (bitLength > 0) {\n          var A = bitValue % 2 ? 127 : 0;\n          result = tri * C + B;\n          result ^= A;\n          result = (A & 0x20) | (result >> 2);\n        }\n\n        if (result > 32) result++;\n\n        cacheUnquantizeTrits[bitLength + tri * 4 + bitValue * 12] = result;\n      }\n    }\n  }\n\n  // -----------------\n  // UNQUANTIZE QUINTS\n  // -----------------\n  var cacheUnquantizeQuints = new Uint8Array(256 * 5 * 3);\n  for (var bitValue = 0; bitValue < 256; ++bitValue) {\n    for (var quint = 0; quint < 5; ++quint) {\n      for (var bitLength = 0; bitLength < 3; ++bitLength) {\n\n        var C = 0;\n        var B = 0;\n        var result;\n        switch (bitLength) {\n          case 0:\n            result = WEIGHT_QUINT_RANGE[quint];\n            break;\n          case 1:\n            C = 28;\n            break;\n          case 2:\n            C = 13;\n            var bBits = (bitValue >> 1) & 1;\n            B = (bBits << 6) | (bBits << 1);\n            break;\n        }\n\n        if (bitLength > 0) {\n          var A = bitValue % 2 ? 127 : 0;\n          result = quint * C + B;\n          result ^= A;\n          result = (A & 0x20) | (result >> 2);\n        }\n\n        if (result > 32) result++;\n\n        cacheUnquantizeQuints[bitLength + quint * 3 + bitValue * 15] = result;\n      }\n    }\n  }\n\n  ///////////////\n  // CACHE DECODE\n  ///////////////\n\n  // -------------\n  // DECODE SIMPLE\n  // -------------\n  var cacheDecodeSimple = new Uint8Array(256 * 9);\n  for (var bitValue = 0; bitValue < 256; ++bitValue) {\n    for (var bitLength = 1; bitLength < 9; ++bitLength) {\n      cacheDecodeSimple[bitLength + bitValue * 9] = replicateBits(bitValue, bitLength, 8);\n    }\n  }\n\n  // ----------------\n  // UNQUANTIZE TRITS\n  // ----------------\n  var cacheDecodeTrits = new Uint8Array(256 * 3 * 7);\n  for (var bitValue = 0; bitValue < 256; ++bitValue) {\n    for (var tri = 0; tri < 3; ++tri) {\n      for (var bitLength = 0; bitLength < 7; ++bitLength) {\n\n        var C = 0;\n        var B = 0;\n        var result;\n        switch (bitLength) {\n          case 1:\n            C = 204;\n            break;\n          case 2:\n            C = 93;\n            // b000b0bb0\n            var bBit = (bitValue >> 1) & 1;\n            B = (bBit << 8) | (bBit << 4) | (bBit << 2) | (bBit << 1);\n            break;\n          case 3:\n            C = 44;\n            // cb000cbcb\n            var cbBit = (bitValue >> 1) & 3;\n            B = (cbBit << 7) | (cbBit << 2) | cbBit;\n            break;\n          case 4:\n            C = 22;\n            // dcb000dcb\n            var dcbBit = (bitValue >> 1) & 7;\n            B = (dcbBit << 6) | dcbBit;\n            break;\n          case 5:\n            C = 11;\n            // edcb000ed\n            var edcbBit = (bitValue >> 1) & 0xF;\n            B = (edcbBit << 5) | (edcbBit >> 2);\n            break;\n          case 6:\n            C = 5;\n            // fedcb000f\n            var fedcbBit = (bitValue >> 1) & 0x1F;\n            B = (fedcbBit << 4) | (fedcbBit >> 4);\n            break;\n        }\n\n        if (bitLength > 0) {\n          var A = bitValue % 2 ? 511 : 0;\n          result = (tri * C + B) >>> 0;\n          result ^= A;\n          result = (A & 0x80) | (result >> 2);\n        }\n\n        cacheDecodeTrits[bitLength + tri * 7 + bitValue * 21] = result;\n      }\n    }\n  }\n\n  // -----------------\n  // UNQUANTIZE QUINTS\n  // -----------------\n  var cacheDecodeQuints = new Uint8Array(256 * 5 * 6);\n  for (var bitValue = 0; bitValue < 256; ++bitValue) {\n    for (var quint = 0; quint < 5; ++quint) {\n      for (var bitLength = 0; bitLength < 6; ++bitLength) {\n\n        var C = 0;\n        var B = 0;\n        var result;\n        switch (bitLength) {\n          case 1:\n            C = 113;\n            break;\n          case 2:\n            C = 54;\n            // b0000bb00\n            var bBit = (bitValue >> 1) & 1;\n            B = (bBit << 8) | (bBit << 3) | (bBit << 2);\n            break;\n          case 3:\n            C = 26;\n            // cb0000cbc\n            var cbBit = (bitValue >> 1) & 3;\n            B = (cbBit << 7) | (cbBit << 1) | (cbBit >> 1);\n            break;\n          case 4:\n            C = 13;\n            // dcb0000dc\n            var dcbBit = (bitValue >> 1) & 7;\n            B = (dcbBit << 6) | (dcbBit >> 1);\n            break;\n          case 5:\n            C = 6;\n            // edcb0000e\n            var edcbBit = (bitValue >> 1) & 0xF;\n            B = (edcbBit << 5) | (edcbBit >> 3);\n            break;\n        }\n\n        if (bitLength > 0) {\n          var A = bitValue % 2 ? 511 : 0;\n          result = (quint * C + B) >>> 0;\n          result ^= A;\n          result = (A & 0x80) | (result >> 2);\n        }\n\n        cacheDecodeQuints[bitLength + quint * 6 + bitValue * 30] = result;\n      }\n    }\n  }\n\n\n  // TOTO module exports\n  module.exports = {\n    cacheUnquantizeSimple: cacheUnquantizeSimple,\n    cacheUnquantizeTrits: cacheUnquantizeTrits,\n    cacheUnquantizeQuints: cacheUnquantizeQuints,\n    cacheDecodeSimple: cacheDecodeSimple,\n    cacheDecodeTrits: cacheDecodeTrits,\n    cacheDecodeQuints: cacheDecodeQuints\n  };\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n  'use strict';\n\n  /**\n   * Creates a binary mask between two given bounds\n   * @param  {int} a starting bit\n   * @param  {int} b ending bit\n   * @return {int} mask integer containing binary 1 between a and b\n   */\n  var createMask = function(a, b) {\n    var r = 0;\n    for (var i = a; i <= b; ++i)\n      r |= 1 << i;\n\n    return r;\n  };\n\n  /**\n   * Applies the Hamming weight algorithm: looks for the number of bits set to 1\n   * @param  {int} value\n   * @return {int} the number of bits set to 1\n   */\n  var popCount = function(value) {\n    var i = 0;\n    for (; value; ++i)\n      value &= value - 1;\n    return i;\n  };\n\n  /**\n   * Extracts bits from a bounded range\n   * @param  {int} value representing the integer value where the bits are extracted\n   * @param  {int} start the index of the starting bit\n   * @param  {int} stop  the index of the ending bit\n   * @return {int} the integer composed by the extracted bits\n   */\n  var extractBits = function(value, start, stop) {\n    return (value & createMask(start, stop)) >> start;\n  };\n\n\n  /**\n   * Replicates the n lower bits until the given bit index\n   * @param  {int} val contains the bits to replicate\n   * @param  {int} bitsNb describes the number of lower bits to replicate\n   * @param  {int} endBit the \"index\" of the included final bit\n   * @return {int} result containing a number made of the replicated bits\n   */\n  var replicateBits = function(val, bitsNb, endBit) {\n    // Extracts the bitsNb lower bits from the val value\n    var extractedBits = val & ((1 << bitsNb) - 1);\n    var result = extractedBits;\n    var resultLength = bitsNb;\n\n    while (resultLength < endBit) {\n\n      var extractedBitsShift = 0;\n      if (bitsNb > endBit - resultLength) {\n        var newShift = endBit - resultLength;\n        extractedBitsShift = bitsNb - newShift;\n        bitsNb = newShift;\n      }\n\n      // Shifts the result to \"add\" the pattern\n      result <<= bitsNb;\n      result |= extractedBits >> extractedBitsShift;\n      resultLength += bitsNb;\n    }\n\n    return result;\n  };\n\n  /**\n   * Transfers one bit from an integer to another\n   * @param  {array} array containing the two cells to transfer\n   * @param  {uint} i1 the index of the first cell\n   * @param  {uint} i2 the index of the second cell\n   */\n  var bitTransferSigned = function(array, i1, i2) {\n    var a = array[i1];\n    var b = array[i2];\n\n    b >>= 1;\n    b |= a & 0x80;\n    a >>= 1;\n    a &= 0x3F;\n    if (a & 0x20)\n      a -= 0x40;\n\n    array[i1] = a;\n    array[i2] = b;\n  };\n\n  /**\n   * Reads at most 30 bits from the given U8Int array\n   * @param  {U8IntArray} u8buffer buffer containing data to read\n   * @param  {int} beginByteId first byte at which the reading should begin\n   * @param  {int} bitsOffset nth bits at which the reading should begin\n   * @param  {int} bitsNb number of bits to read\n   * @return {int} an integer containing the read bits\n   */\n  var readBits = function(u8buffer, beginByteId, bitsOffset, bitsNb) {\n    if (bitsNb > 30)\n      console.error('The reader can not read more than 30 bits in a row.');\n    if (bitsNb <= 0)\n      return 0;\n\n    // Updates the total number of extracted bits\n    // for the current block\n    //bitsReadCount += bitsNb;\n\n    var bitsReadResult = 0;\n    var offsetByteId = beginByteId + Math.floor(bitsOffset / 8);\n    var endByteId = beginByteId + Math.floor((bitsOffset + bitsNb) / 8);\n    var bornInfBit = bitsOffset % 8;\n    var bornSupBit = (bitsOffset + bitsNb - 1) % 8;\n\n    // Simple reading where data lies on the same byte\n    if (offsetByteId === endByteId)\n      return (u8buffer[offsetByteId] & createMask(bornInfBit, bornSupBit)) >> bornInfBit;\n\n    // Recreates the integer by shifting bytes\n    // the created integer is at most a 24bits integer\n    var shift = 8;\n    bitsReadResult += u8buffer[offsetByteId];\n    for (var i = offsetByteId + 1; i <= endByteId; ++i) {\n      bitsReadResult += u8buffer[i] << shift;\n      shift *= 2;\n    }\n\n    bitsReadResult = (bitsReadResult & createMask(bornInfBit, bornInfBit + bitsNb - 1)) >> bornInfBit;\n\n    return bitsReadResult;\n  };\n\n  /**\n   * Write a given value in colorEndpointData at the byte index\n   * computed from the number of bits currently written.\n   * It is important to note that the number of bits to write in\n   * a row never exceed the size of a byte (8 bits)\n   * @param  {Uint8Array} colorEndpointData destination byte array\n   * @param  {int} bits the value to write\n   * @param  {uint} bitsNb the number of bits to write\n   * @param  {uint} bitsWritten the current number of bits written\n   */\n  var writeBits = function(colorEndpointData, bits, bitsNb, bitsWritten) {\n    colorEndpointData[Math.floor(bitsWritten / 8)] = bits;\n  };\n\n  /**\n   * Reverses the bits in a byte\n   * @param  {uint8} b the byte to reverse\n   * @return {uint32} the reversed byte not casted\n   */\n  var reverseByte = function(b) {\n    // Converts x to a 32 bits unsigned integer\n    b = b >>> 0;\n    return ((b * 0x0802 & 0x22110) | (b * 0x8020 & 0x88440)) * 0x10101 >> 16;\n  };\n\n  /**\n   * Reverses each byte just as the global bytes order\n   * @param  {Uint8Array} u8array the array to reverse\n   */\n  var reverseU8Array = function(u8array) {\n    for (var i = 0; i < u8array.length / 2; ++i) {\n      var a = reverseByte(u8array[i]);\n      var b = reverseByte(u8array[u8array.length - 1 - i]);\n\n      u8array[i] = b;\n      u8array[u8array.length - 1 - i] = a;\n    }\n  };\n\n  module.exports = {\n    popCount: popCount,\n    readBits: readBits,\n    writeBits: writeBits,\n    extractBits: extractBits,\n    replicateBits: replicateBits,\n    bitTransferSigned: bitTransferSigned,\n    reverseU8Array: reverseU8Array\n  };\n\n/***/ }\n/******/ ])\n});\n;"
}, function (e, t) {
    e.exports = "/*jshint worker: true */\n\nself.onmessage = function(event) {\n    var data = event.data;\n\n    var opt = {\n        imageOrientation: 'flipY',\n        premultiplyAlpha: 'none',\n        colorSpaceConversion: 'none'\n    };\n\n    self.fetch(data.url).then(function(response) {\n        response.blob().then(function(blob) {\n            self.createImageBitmap(blob, opt).then(function(bitmap) {\n                postMessage(\n                    {\n                        bitmap: bitmap,\n                        url: data.url,\n                        uid: data.uid\n                    },\n                    [bitmap]\n                );\n            });\n        });\n    });\n};\n\n/*jshint worker: false */\n"
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(630)),
        a = function (e, t) {
            r.a.call(this, e, "arraybuffer", t)
        };
    a.prototype = Object(n.extend)({}, r.a.prototype, {
        load: function () {
            var e = this.getXHR().response;
            this._defer.resolve(e)
        }
    }), t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(983),
        r = i(42),
        a = i(1),
        o = i(374);
    t.a = r.a.extend({
        optionTypes: {
            modelUid: a.b.string
        },
        model: n.a,
        url: function () {
            return Object(o.a)("environments", this.options.modelUid, this.options.checkPrefetch)
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(984),
        r = i(42),
        a = i(1),
        o = i(374);
    t.a = r.a.extend({
        optionTypes: {
            modelUid: a.b.string
        },
        model: n.a,
        url: function () {
            return Object(o.a)("backgrounds", this.options.modelUid, this.options.checkPrefetch)
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(987)),
        a = i(42),
        o = i(1),
        s = i(915),
        u = i(374);
    t.a = a.a.extend(Object(n.extend)({
        optionTypes: {
            modelUid: o.b.string
        },
        model: r.a,
        url: function () {
            return Object(u.a)("matcaps", this.options.modelUid, this.options.checkPrefetch)
        }
    }, s.a))
}, function (e, t, i) {
    "use strict";
    var n = i(1182),
        r = i(42),
        a = i(1),
        o = i(374);
    t.a = r.a.extend({
        optionTypes: {
            modelUid: a.b.string
        },
        comparator: "order",
        model: n.a,
        _trashbin: [],
        url: function () {
            return Object(o.a)("animations", this.options.modelUid, this.options.checkPrefetch)
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(5),
        r = i.n(n),
        a = i(11),
        o = i(17);
    t.a = a.a.extend({
        defaults: {
            name: "",
            uid: "",
            duration: 0,
            isLoop: !1,
            isEnabled: !0
        },
        endpoint: function () {
            return "/animations/" + this.get("uid")
        },
        registerOptions: function () {
            this._lastOptions = {
                name: this.get("name"),
                isLoop: this.get("isLoop"),
                isEnabled: this.get("isEnabled")
            }
        },
        hasChangedOptions: function () {
            if (!this._lastOptions) return !0;
            var e = this._lastOptions;
            for (var t in e)
                if (e[t] !== this.get(t)) return !0;
            return !1
        },
        save: function () {
            return this.hasChangedOptions() ? (this.registerOptions(), o.a.patchAnimation(this.get("uid"), {
                name: this.get("name"),
                isLoop: this.get("isLoop"),
                isEnabled: this.get("isEnabled")
            })) : r.a.resolve()
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(706),
        r = i(42),
        a = i(1),
        o = i(374);
    t.a = r.a.extend({
        optionTypes: {
            modelUid: a.b.string
        },
        comparator: "order",
        model: n.a,
        url: function () {
            return Object(o.a)("sounds", this.options.modelUid, this.options.checkPrefetch)
        },
        modelId: function (e) {
            return e.cid
        },
        triggerEditTrack: function (e) {
            this.trigger("editTrack", e)
        },
        triggerDeleteTrack: function (e) {
            this.trigger("removeTrack", e)
        },
        triggerDuplicateTrack: function (e) {
            this.trigger("duplicateTrack", e)
        },
        triggerSelectTrack: function (e) {
            this.trigger("select", e)
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(20),
        a = i(47),
        o = i(230),
        s = i(1185),
        u = i(1190),
        l = i(1192),
        c = n.a.osg,
        h = n.a.osgDB,
        d = function (e, t) {
            for (var i = e.getPrimitiveSetList(), n = 0, r = i.length; n < r; ++n) {
                var a = i[n];
                if (!(a instanceof c.DrawArrays || a instanceof c.DrawArrayLengths)) {
                    var o = a.getIndices();
                    o.getInitialBufferArray && (o = o.getInitialBufferArray());
                    var s = t[o.getInstanceID()];
                    return s.inlined ? "" : s.vb.File
                }
            }
            var u = e.getVertexAttributeList().Vertex;
            u.getInitialBufferArray && (u = u.getInitialBufferArray());
            var l = t[u.getInstanceID()];
            return l.inlined ? "" : l.vb.File
        },
        f = "",
        p = function (e, t) {
            var i = t.wireframeOptions && t.wireframeOptions.nodes,
                n = [],
                a = [],
                s = [],
                u = "",
                l = "",
                c = o.a.instanceIDGeometryMap;
            for (var h in c) {
                var p = c[h];
                0 !== p.getPrimitiveSetList().length || Object(r.a)().keepEmptyGeometries ? 1 !== p.userDataMap.wireframe ? (a.push(p), u || (u = d(p, e)) === f && (u = "")) : (s.push(p), i && i.push(p), p.setNodeMask(0), l || (l = d(p, e))) : n.push(p)
            }
            f = u || f;
            for (var m = 0, g = n.length; m < g; ++m)
                for (var v = n[m], _ = v.getParents(), b = _.length - 1; b >= 0; --b) _[b].removeChild(v);
            return {
                urlPolygon: t.prefixURL + u,
                urlWireframe: t.prefixURL + l,
                namePolygon: u,
                nameWireframe: l,
                polygons: a,
                wireframes: s
            }
        },
        m = function (e, t, i, n) {
            var r = "Uncompress " + n;
            c.time(r);
            for (var a = 0; a < e.length; ++a) Object(s.a)(e[a], t, i);
            Object(l.a)(e), Object(u.a)(), c.timeEnd(r)
        },
        g = function (e, t, i, n) {
            if (n) {
                var r = "Download " + e.nameWireframe + " (Async)";
                n.startPromise.then(function () {
                    var a = i.getBinaryArray(e.urlWireframe, n).getPromise();
                    c.time(r), a.then(function (i) {
                        c.timeEnd(r), m(e.wireframes, t, i, e.nameWireframe), n.deferDownload.resolve()
                    })
                })
            }
        },
        v = function (e, t, i, n, r) {
            var a = t.bufferMap,
                o = p(a, t);
            if (!o.namePolygon) return m(o.polygons, a, null, r), i.addChild(e), i;
            var s = "Download " + o.namePolygon + " (Async)",
                u = n.getBinaryArray(o.urlPolygon, t).getPromise();
            return c.time(s), u.then(function (r) {
                return c.timeEnd(s), m(o.polygons, a, r, o.namePolygon), g(o, a, n, t.wireframeOptions), i.addChild(e), i
            })
        },
        _ = function (e, t) {
            var i = "UserDataVisitor " + t;
            c.time(i);
            var n = new o.a;
            e.accept(n), c.timeEnd(i)
        },
        b = function (e, t, i, n, r) {
            t.size = t.binarySize, t.progressKey = t.binaryKey;
            var o = "JSON.parse " + r,
                s = "osgDB.parseSceneGraph " + r + " (Async)";
            c.time(o);
            var u = JSON.parse(e);
            return c.timeEnd(o), a.a.OSG_VERSION = u.Version, c.time(s), h.parseSceneGraph(u, t).then(function (e) {
                return c.timeEnd(s), _(e, r), v(e, t, i, n, r)
            })
        },
        S = function (e, t, i, n, r) {
            i.size = i.osgjsSize, i.progressKey = i.osgjsKey;
            var a = t.split("/").pop(),
                o = "Download " + a + " (Async)";
            return c.time(o), e.then(function (e) {
                return c.timeEnd(o), b(e, i, n, r, a)
            })
        };
    t.a = S
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(917),
        a = i(1186),
        o = i(1187),
        s = i(1188),
        u = i(918),
        l = i(919),
        c = i(1189),
        h = i(20),
        d = n.a.osg,
        f = n.a.osgWrappers.osg.functionSortAttributes,
        p = {
            Vertex: 1,
            Normal: 2,
            TexCoord: 4,
            Color: 8,
            Triangle: 16,
            Tangent: 32
        },
        m = {
            quantization: 1,
            prediction: 2,
            delta: 4
        },
        g = {
            delta: 1,
            highWatermark: 2,
            implicit: 4
        },
        v = function (e) {
            return -1 !== e.indexOf("TexCoord") ? p.TexCoord : p[e]
        },
        _ = function (e, t, i, n, r) {
            var s, u = t.vb,
                h = u.Offset ? u.Offset : 0,
                f = e.getIndices();
            s = u.Encoding && "varint" === u.Encoding ? Object(l.a)(new Uint8Array(r, h), f.getItemSize() * u.Size, t.type) : new d[t.type](r, h, f.getItemSize() * u.Size), 1 === s.BYTES_PER_ELEMENT && (s = new Uint16Array(s));
            var p = i.attributes,
                m = v("Triangle"),
                _ = s,
                b = e.getMode() === d.primitiveSet.TRIANGLE_STRIP;
            if (0 == (p & m) || !b && e.getMode() !== d.primitiveSet.TRIANGLES) return s instanceof Uint16Array == !1 && (_ = new Uint16Array(s.buffer, s.byteOffset, s.length), _.set(s)), f.setElements(_), void e.setIndices(f);
            var S = i.triangle_mode,
                x = 0;
            if (S & g.implicit && b && (x = o.a.IMPLICIT_HEADER_LENGTH + s[o.a.IMPLICIT_HEADER_MASK_LENGTH], _ = new Uint16Array(s[o.a.IMPLICIT_HEADER_PRIMITIVE_LENGTH])), S & g.delta && Object(a.a)(s, x), S & g.implicit && b && Object(o.a)(s, _, x, S & g.highWatermark), S & g.highWatermark && Object(c.a)(_, _, n), _ instanceof Uint16Array == !1) {
                var y = _;
                _ = new Uint16Array(y.buffer, y.byteOffset, y.length), _.set(y)
            }
            f.setElements(_), e.setIndices(f)
        },
        b = d.vec3.create(),
        S = d.vec3.create(),
        x = function (e, t, i, n, r) {
            var a = "Vertex" === n ? "vtx_" : "uv_" + n.substr(8) + "_",
                o = e & m.quantization && void 0 !== r[a + "bbl_x"],
                s = t instanceof Float32Array == !0;
            if (!o && s) return t;
            var l = 4 === t.BYTES_PER_ELEMENT ? new Float32Array(t.buffer, t.byteOffset, t.length) : new Float32Array(t.length);
            return o ? (b[0] = r[a + "bbl_x"], b[1] = r[a + "bbl_y"], S[0] = r[a + "h_x"], S[1] = r[a + "h_y"], 3 === i && (b[2] = r[a + "bbl_z"], S[2] = r[a + "h_z"]), Object(u.a)(t, l, b, S, i)) : (l.set(t), l)
        },
        y = function (e, t) {
            if (4 === t.BYTES_PER_ELEMENT && Object(h.a)().convertVertexColor8Bit) {
                for (var i = t.length, n = new Uint8Array(t.buffer, t.byteOffset, i), r = 0; r < i; ++r) n[r] = Math.round(255 * Math.max(0, Math.min(1, t[r])));
                t = n
            }
            return 1 === t.BYTES_PER_ELEMENT && e.setNormalize(!0), t
        },
        C = function (e, t) {
            if (1 === t.BYTES_PER_ELEMENT) return t;
            for (var i = 0, n = t.length; i < n; ++i)
                if (t[i] > 255) return t;
            var r = new Uint8Array(t.buffer, t.byteOffset, n);
            return r.set(t), r
        },
        T = function (e, t, i, n, a, o) {
            var u, c = t.vb,
                h = e.getItemSize(),
                f = c.Size,
                p = c.Offset ? c.Offset : 0;
            if (u = c.Encoding && "varint" === c.Encoding ? Object(l.a)(new Uint8Array(o, p), h * f, t.type) : new d[t.type](o, p, h * f), 0 == (n.attributes & v(i))) return "Color" === i ? u = y(e, u) : "Bones" === i && (u = C(0, u)), void e.setElements(u);
            if ("Normal" === i) return e.setElements(Object(r.a)(u, new Float32Array(3 * f), 3, n.epsilon, n.nphi)), void e.setItemSize(3);
            if ("Tangent" === i) return e.setElements(Object(r.a)(u, new Float32Array(4 * f), 4, n.epsilon, n.nphi)), void e.setItemSize(4);
            var g = null;
            if ("Vertex" === i) g = n.vertex_mode;
            else if (-1 !== i.indexOf("TexCoord")) {
                var _ = "uv_" + i.substr(8) + "_mode";
                g = void 0 !== n[_] ? n[_] : n.vertex_mode
            }
            g & m.prediction && void 0 !== a && Object(s.a)(u, h, a.getElements()), e.setElements(x(g, u, h, i, n))
        },
        w = function (e, t, i) {
            for (var n, r = e.userDataMap, a = e.getPrimitiveSetList(), o = [0], s = 0, u = a.length; s < u; ++s) {
                var l = a[s];
                if (!(l instanceof d.DrawArrays || l instanceof d.DrawArrayLengths)) {
                    var c = l.getIndices();
                    c.getInitialBufferArray && (c = c.getInitialBufferArray());
                    var h = t[c.getInstanceID()];
                    !0 !== h.visited && (h.visited = !0, h.inlined ? (c.setElements(new Uint16Array(h.inlined)), l.setIndices(c)) : (_(l, h, r, o, i), l.getMode() === d.primitiveSet.TRIANGLE_STRIP && (n = c)))
                }
            }
            for (s = u - 1; s >= 0; s--) l = a[s], l.getCount() || a.splice(s, 1);
            return n
        },
        M = function (e, t, i, n) {
            var r = e.userDataMap,
                a = e.getVertexAttributeList(),
                o = Object.keys(a);
            o.sort(f);
            for (var s = o.length, u = 0; u < s; ++u) {
                var l = o[u],
                    c = a[l];
                c.getInitialBufferArray && (c = c.getInitialBufferArray());
                var h = t[c.getInstanceID()];
                if (!0 !== h.visited)
                    if (h.visited = !0, h.inlined) c.setElements(new Float32Array(h.inlined));
                    else {
                        var d = r,
                            p = l.indexOf("_");
                        if (-1 !== p) {
                            var m = l.slice(p + 1);
                            d = r["morph_" + m], l = l.slice(0, p)
                        }
                        T(c, h, l, d, n, i)
                    }
            }
        },
        E = function (e, t, i) {
            var n = w(e, t, i);
            M(e, t, i, n)
        };
    t.a = E
}, function (e, t, i) {
    "use strict";
    var n = function (e, t) {
        for (var i = t || 0, n = e.length, r = e[i], a = i + 1; a < n; ++a) {
            var o = e[a];
            r = e[a] = r + (o >> 1 ^ -(1 & o))
        }
        return e
    };
    t.a = n
}, function (e, t, i) {
    "use strict";
    var n = function (e, t, i, r) {
        for (var a = e[n.IMPLICIT_HEADER_EXPECTED_INDEX], o = e[n.IMPLICIT_HEADER_MASK_LENGTH], s = new Uint32Array(e.subarray(n.IMPLICIT_HEADER_LENGTH, o + n.IMPLICIT_HEADER_LENGTH)), u = 32 * o - t.length, l = 0; l < o; ++l)
            for (var c = s[l], h = 32 * l, d = l === o - 1 ? u : 0, f = d; f < 32; ++f, ++h) t[h] = c & 1 << 31 >>> f ? e[i++] : r ? a : a++;
        return t
    };
    n.IMPLICIT_HEADER_PRIMITIVE_LENGTH = 0, n.IMPLICIT_HEADER_MASK_LENGTH = 1, n.IMPLICIT_HEADER_EXPECTED_INDEX = 2, n.IMPLICIT_HEADER_LENGTH = 3, t.a = n
}, function (e, t, i) {
    "use strict";
    var n = function (e, t, i) {
        var n = e.length / t,
            r = new Uint8Array(n),
            a = i.length - 1;
        r[i[0]] = 1, r[i[1]] = 1, r[i[2]] = 1;
        for (var o = 2; o < a; ++o) {
            var s = o - 2,
                u = i[s],
                l = i[s + 1],
                c = i[s + 2],
                h = i[s + 3];
            if (1 !== r[h]) {
                r[h] = 1, u *= t, l *= t, c *= t, h *= t;
                for (var d = 0; d < t; ++d) e[h + d] = e[h + d] + e[l + d] + e[c + d] - e[u + d]
            }
        }
        return e
    };
    t.a = n
}, function (e, t, i) {
    "use strict";
    var n = function (e, t, i) {
        for (var n = i[0], r = e.length, a = 0; a < r; ++a) {
            var o = n - e[a];
            t[a] = o, n <= o && (n = o + 1)
        }
        return i[0] = n, t
    };
    t.a = n
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(230),
        a = i(423),
        o = n.a.osg,
        s = [o.primitiveSet.TRIANGLES, o.primitiveSet.TRIANGLE_STRIP, o.primitiveSet.TRIANGLE_FAN],
        u = [o.primitiveSet.LINES, o.primitiveSet.LINE_LOOP, o.primitiveSet.LINE_STRIP],
        l = function (e, t) {
            var i = t.getItemSize(),
                n = t.getElements(),
                r = 1;
            1 === n.BYTES_PER_ELEMENT ? r = 255 : 2 === n.BYTES_PER_ELEMENT && (r = 65535);
            var o = !1,
                s = n.length,
                u = 0;
            if (4 === i) {
                var l = !0,
                    c = !0;
                for (u = 3; u < s; u += 4) {
                    var h = n[u];
                    if (0 !== h && (l = !1), h !== r && (c = !1), !l && !c) break
                }
                if (l && 4 === i)
                    for (u = 3; u < s; u += 4) n[u] = r;
                o = !l && !c
            }
            var d = !0;
            if (!o) {
                var f = !0;
                for (u = 0; u < s && (n[u] !== r && (f = !1), n[u + 1] !== r && (f = !1), n[u + 2] !== r && (f = !1), f); u += i);
                f && delete e.getVertexAttributeList().Color, d = !f
            }
            o && (a.a.hasVertexAlpha = e.userDataMap.hasVertexAlpha = !0), d && (a.a.hasVertexColor = !0)
        },
        c = function (e) {
            for (var t = e.getPrimitiveSetList(), i = t.length, n = !1, a = !1, l = !1, c = void 0 !== e.getVertexAttributeList().Normal, h = 0; h < i; ++h) {
                var d = t[h].getMode();
                0 !== t[h].getCount() && (n || (n = d === o.primitiveSet.POINTS), l || (l = -1 !== s.indexOf(d)), a || (a = -1 !== u.indexOf(d)))
            }
            r.a.hasPoints || (r.a.hasPoints = n), r.a.hasTriangles || (r.a.hasTriangles = l), r.a.hasLines || (r.a.hasLines = a), r.a.hasVertexNormals || (r.a.hasVertexNormals = c), e.userDataMap.hasPoints = n, e.userDataMap.hasTriangles = l, e.userDataMap.hasLines = a
        },
        h = function () {
            for (var e in r.a.instanceIDGeometryMap) {
                var t = r.a.instanceIDGeometryMap[e];
                if (!t.userDataMap.wireframe) {
                    var i = t.getVertexAttributeList().Color;
                    i && l(t, i), c(t)
                }
            }
            r.a.instanceIDGeometryMap = {}
        };
    t.a = h
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = n.a.osg,
        a = function () {
            r.ComputeBoundsVisitor.call(this), this._minBox = new r.BoundingBox, this._visitedBuffers = {}
        };
    r.createPrototypeObject(a, r.objectInherit(r.ComputeBoundsVisitor.prototype, {
        getPreciseBox: function () {
            return this._minBox
        },
        apply: function (e) {
            if (e instanceof r.Transform) return void this.applyTransform(e);
            if (e instanceof r.Geometry) {
                var t = this._matrixStack.getLength(),
                    i = t > 0 ? this._matrixStack.back() : r.mat4.IDENTITY,
                    n = e.getVertexAttributeList().Vertex,
                    a = this._visitedBuffers[n.getInstanceID()];
                if (a && r.mat4.exactEquals(a.matrix, i)) return;
                var o = e.computeTransformedVertices ? e.computeTransformedVertices() : n.getElements();
                this._visitedBuffers[n.getInstanceID()] = {
                    buffer: o,
                    matrix: r.mat4.copy(r.mat4.create(), i)
                };
                for (var s = i[0], u = i[1], l = i[2], c = i[3], h = i[4], d = i[5], f = i[6], p = i[7], m = i[8], g = i[9], v = i[10], _ = i[11], b = i[12], S = i[13], x = i[14], y = i[15], C = 1 / 0, T = 1 / 0, w = 1 / 0, M = -1 / 0, E = -1 / 0, A = -1 / 0, P = 0, R = o.length; P < R; P += 3) {
                    var O = o[P],
                        I = o[P + 1],
                        F = o[P + 2],
                        N = c * O + p * I + _ * F + y || 1,
                        D = (s * O + h * I + m * F + b) / N,
                        L = (u * O + d * I + g * F + S) / N,
                        k = (l * O + f * I + v * F + x) / N;
                    D < C && (C = D), L < T && (T = L), k < w && (w = k), D > M && (M = D), L > E && (E = L), k > A && (A = k)
                }
                var V = this._minBox.getMin(),
                    B = this._minBox.getMax();
                return C < V[0] && (V[0] = C), T < V[1] && (V[1] = T), w < V[2] && (V[2] = w), M > B[0] && (B[0] = M), E > B[1] && (B[1] = E), void(A > B[2] && (B[2] = A))
            }
            this.traverse(e)
        }
    })), t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(572),
        a = i(20),
        o = n.a.osg,
        s = {},
        u = function (e) {
            for (var t = o.vec3.create(), i = 0, n = e.length; i < n; i += 3)
                if (isFinite(e[i]) && isFinite(e[i + 1]) && isFinite(e[i + 2])) {
                    t[0] = e[i], t[1] = e[i + 1], t[2] = e[i + 2];
                    break
                } return t
        },
        l = function (e) {
            var t = e.getVertexAttributeList(),
                i = t.Vertex;
            if (void 0 !== i.processedNaN) return i.processedNaN;
            i.processedNaN = !1;
            for (var n, r = i.getInstanceID(), a = i.getElements(), o = 0, l = a.length; o < l; o += 3) isFinite(a[o]) && isFinite(a[o + 1]) && isFinite(a[o + 2]) || (i.processedNaN = !0, n || (n = u(a)), a[o] = n[0], a[o + 1] = n[1], a[o + 2] = n[2], s[r] || (s[r] = {}), s[r][o / 3] = !0);
            return i.processedNaN
        },
        c = function (e, t, i) {
            e[i] || t.push(i)
        },
        h = function (e, t, i, n) {
            e[i] || e[n] || t.push(i, n)
        },
        d = function (e, t, i, n, r) {
            e[i] || e[n] || e[r] || t.push(i, n, r)
        },
        f = function (e) {
            if (l(e) || Object(a.a)().forceTriangles) {
                var t = e.getVertexAttributeList().Vertex,
                    i = s[t.getInstanceID()] || {},
                    n = [],
                    r = [],
                    u = [],
                    f = {
                        operatorPoint: c.bind(this, i, n),
                        operatorLine: h.bind(this, i, r),
                        operatorTriangle: d.bind(this, i, u)
                    };
                o.primitiveIndexFunctor(e, f);
                var p = e.getPrimitiveSetList();
                p.length = 0;
                var m, g;
                n.length && (g = new Uint16Array(n), m = new o.BufferArray(o.BufferArray.ELEMENT_ARRAY_BUFFER, g, 1), p.push(new o.DrawElements(o.primitiveSet.POINTS, m))), r.length && (g = new Uint16Array(r), m = new o.BufferArray(o.BufferArray.ELEMENT_ARRAY_BUFFER, g, 1), p.push(new o.DrawElements(o.primitiveSet.LINES, m))), u.length && (g = new Uint16Array(u), m = new o.BufferArray(o.BufferArray.ELEMENT_ARRAY_BUFFER, g, 1), p.push(new o.DrawElements(o.primitiveSet.TRIANGLES, m)))
            }
        },
        p = function (e) {
            for (var t = !1, i = 0, n = e.length; i < n; ++i) t = f(e[i]) || t;
            t && r.default.logMessage("NaN values detected in vertices!")
        };
    t.a = p
}, function (e, t, i) {
    "use strict";
    var n = (i(1194), i(5)),
        r = i.n(n),
        a = i(9),
        o = i(47),
        s = i(8),
        u = i(921),
        l = i(44),
        c = i(230),
        h = i(20),
        d = a.a.osg,
        f = a.a.osgAnimation,
        p = a.a.osgWrappers,
        m = p.osg,
        g = s.a.extend({
            initialize: function () {
                s.a.prototype.initialize.apply(this, arguments);
                var e = this.model;
                e.bind("change:playing", this.onPlayingChanged, this), e.bind("change:speed", this.onSpeedChanged, this), e.bind("change:currentUID", this.onCurrentAnimationChanged, this), e.bind("afterFirstVisibleFrame", this.onAfterFirstVisibleFrame, this), e.bind("seek", this.onSeek, this), this._manager = null, this._idLoop = 0, this._loopEnded = !1, this._skeletons = [], this._viewer = this.options.context.getViewer(), this._firstAnimationPlayed = !1, this._animationPromises = [], this._hookBasicAnimationManager(o.a.getPolygon()), o.a.getMaterial().then(this._initAnimation.bind(this)), o.a.getModelDisplayed().then(this._resolveAllAnimations.bind(this))
            },
            onAfterFirstVisibleFrame: function () {
                this._manager && (this.model.set("playing", Object(h.a)().animationAutoplay), this.onCurrentAnimationChanged())
            },
            _resolveAllAnimations: function () {
                0 === this._animationPromises.length ? (o.a.resolveFirstAnimation(), o.a.resolveAllAnimations()) : r.a.all(this._animationPromises).then(o.a.resolveAllAnimations.bind(o.a))
            },
            _initAnimation: function () {
                if (!this._manager) return void o.a.getWireframeOptimized().then(o.a.resolveWireframeOptimizedSplit.bind(o.a));
                this.onSpeedChanged(), u.a.init(this._skeletons, this._viewer), o.a.getWireframeOptimized().then(o.a.resolveWireframeOptimizedSplit.bind(o.a))
            },
            _getHookUpdateManager: function () {
                var e = this,
                    t = f.BasicAnimationManager.prototype.updateManager;
                return function (i) {
                    var n = e.getCurrentInstanceAnimation();
                    return !(n && !e._loopEnded) || (-1 === this._seekTime && this._pause || l.a.draw(), i = e._detectAnimationEnd(i, n), i = e._snapTimeOnFrame(i, n), t.call(this, i))
                }
            },
            _snapTimeOnFrame: function (e, t) {
                var i = this.model.get("fps");
                if (i <= 0) return e;
                var n = 1 / i,
                    r = (e - t.start) % n;
                return r > .5 * n ? e + n - r : e - r
            },
            _detectAnimationEnd: function (e, t) {
                var i = Math.max(0, e - t.start),
                    n = i % t.duration * 100 / t.duration,
                    r = Math.floor(i / t.duration);
                return r <= this._idLoop ? (this._idLoop = r, this.model.set("progress", n), e) : (this._onAnimationEnd(), t = this.getCurrentInstanceAnimation(), this._loopEnded ? (e = t.duration - .01, this.model.set("progress", 100)) : (this._idLoop = r, e = t.start, this.model.set("progress", 0)), e)
            },
            _onAnimationEnd: function () {
                var e = this.model.get("cycleMode");
                if ("one" === e) return void this.model.trigger("cycleMode");
                for (var t, i = this.model.get("animations"), n = i.indexOf(this.getCurrentAnimation()), r = "-1", a = n + 1, o = i.length; a < o; ++a)
                    if ((t = i.at(a)) && t.get("isEnabled")) {
                        r = t.get("uid");
                        break
                    } if ("-1" === r && "all" === e) {
                    var s = this.model.getFirstEnabledAnimation();
                    r = s ? s.get("uid") : "-1"
                }
                "-1" !== r ? this.model.set("currentUID", r) : (this.model.set("playing", !1), this._loopEnded = !0)
            },
            _debugSnapKeyFrameHook: function () {
                if (Object(h.a)().snapKeyframe) {
                    f.BasicAnimationManager.prototype._updateChannelsType = function (e, t, i) {
                        for (var n = 0, r = t.length; n < r; n++) {
                            var a = t[n],
                                o = a.instanceAnimation,
                                s = o.loop,
                                u = e - a.t;
                            s && o.duration > 0 && (u %= o.duration), u += o.firstKeyTime;
                            var l = a.channel;
                            if (u > l.start && u < l.end) {
                                var c = l.times,
                                    h = a.key;
                                if (u > c[h])
                                    for (; c[h + 1] < u;) h++;
                                else if (u < c[h])
                                    for (; c[h] > u;) h--;
                                var d = c[h],
                                    f = c[h + 1];
                                u = Math.abs(u - d) < Math.abs(u - f) ? d : f
                            }
                            i(u, a)
                        }
                    }
                }
            },
            _hookBasicAnimationManager: function (e) {
                var t = this,
                    i = this._animationPromises,
                    n = this._getHookUpdateManager();
                this._debugSnapKeyFrameHook(), p.osgAnimation.BasicAnimationManager = function (a, s) {
                    var u = a.getJSON();
                    return u.Animations ? (m.Object(a, s), o.a.OSG_VERSION < 8 ? r.a.resolve(s) : t._manager ? (d.error("More than one basicAnimationManager !"), r.a.resolve(s)) : (t._manager = s, t.model.get("playing") || s.togglePause(), s.updateManager = n, e.then(function () {
                        var e = a.getOptions();
                        e.progress = void 0;
                        for (var n = u.Animations.length, r = 0; r < n; ++r) {
                            var o = u.Animations[r],
                                s = a.setJSON(o["osgAnimation.Animation"].UserDataContainer).readUserDataContainer(),
                                l = c.a.convertUserDataToObject(s),
                                h = t.model.getAnimationByUID(l.AnimationUID);
                            if (h) {
                                e.currentAnimationUID = h.get("url");
                                var f = a.setJSON(o).readObject();
                                f.isRejected() ? d.Notify.warn("An Animation failed on the parsing!") : (f.then(t.onAddAnimation.bind(t, r, l)), i.push(f))
                            }
                        }
                    }), r.a.resolve(s))) : r.a.reject(new Error)
                }
            },
            onAddAnimation: function (e, t, i) {
                var n = t.AnimationUID;
                i.name = n, i.duration || (i.duration = 2.5, i.still = !0), this._manager.addAnimations([i]), 0 === i.duration && (this._manager.getAnimations()[n].duration = 2.5);
                var r = this.model;
                r.trigger("change:animations");
                var a = r.getAnimationByUID(n);
                a.on("change:isLoop", this.onAnimationChangeLoop.bind(this)), a.get("isLoop") && this.onAnimationChangeLoop(a), this.model.get("currentUID") === n && this.onCurrentAnimationChanged(), this._firstAnimationPlayed || (this._playFirstAnimation(n) && (this._firstAnimationPlayed = !0, this.model.set("currentUID", n)), o.a.getModelDisplayed().then(o.a.resolveFirstAnimation.bind(o.a)))
            },
            _playFirstAnimation: function (e) {
                if (this.model.get("initializeWithRestPose")) return !1;
                var t = this.model.getFirstEnabledAnimation();
                return t && e === t.get("uid")
            },
            onAnimationChangeLoop: function (e) {
                var t = this._manager.getAnimations()[e.get("uid")];
                this._manager.setAnimationLerpEndStart(t, e.get("isLoop") ? 1 / 30 : 0)
            },
            onCurrentAnimationChanged: function () {
                this._loopEnded = !1, this._idLoop = 0;
                var e = this._manager;
                if (e.stopAllAnimation(), e.resetUpdateCallbacks(), this.getCurrentAnimation()) {
                    var t = this.getCurrentInstanceAnimation();
                    t && (e.playAnimation(t), e.setSeekTime(t.start))
                }
                l.a.draw()
            },
            getCurrentAnimation: function () {
                return this.model.getCurrentAnimation()
            },
            getCurrentInstanceAnimation: function () {
                var e = this.getCurrentAnimation();
                return e ? this._manager.getAnimations()[e.get("uid")] : void 0
            },
            onPlayingChanged: function () {
                if (this._loopEnded) {
                    this._loopEnded = !1;
                    var e = this.model.getFirstEnabledAnimation().get("uid") || "-1";
                    e === this.getCurrentAnimation().get("uid") ? this.model.trigger("seek", 0) : this.model.set("currentUID", e)
                }
                this._manager.togglePause(), l.a.draw()
            },
            onSeek: function (e) {
                var t = this.getCurrentInstanceAnimation();
                if (t) {
                    this._loopEnded = !1;
                    var i = Math.min(t.duration - .01, t.duration * e / 100);
                    this._manager.setSeekTime(t.start + i / this._manager.getTimeFactor()), l.a.draw(), l.a.redrawShadow()
                }
            },
            onSpeedChanged: function () {
                this._manager.setTimeFactor(this.model.get("speed"))
            }
        });
    t.a = g
}, function (e, t, i) {
    "use strict";
    var n = i(5),
        r = i.n(n),
        a = i(9),
        o = i(230),
        s = i(77),
        u = i(1195),
        l = i(1196),
        c = i(1197),
        h = i(919),
        d = i(918),
        f = i(917),
        p = a.a.osg,
        m = a.a.osgDB,
        g = a.a.osgAnimation,
        v = a.a.osgWrappers.osgAnimation,
        _ = g.Channel,
        b = function () {},
        S = m.registry();
    S.registerObject("osgAnimation.Vec3LerpChannelCompressedPacked", b), S.registerObject("osgAnimation.Vec3LerpChannelCompressed", b), S.registerObject("osgAnimation.Vec3LerpChannelPacked", b), S.registerObject("osgAnimation.QuatSlerpChannelCompressedPacked", b), S.registerObject("osgAnimation.QuatSlerpChannelCompressed", b), S.registerObject("osgAnimation.QuatSlerpChannelPacked", b), S.registerObject("osgAnimation.FloatLerpChannelCompressedPacked", b), S.registerObject("osgAnimation.FloatLerpChannelCompressed", b), S.registerObject("osgAnimation.FloatLerpChannelPacked", b);
    var x = {},
        y = (new s.default)._resourceLoader,
        C = {
            quantization: 1,
            prediction: 2,
            delta: 4,
            quat: 8,
            deltaTime: 16
        },
        T = function (e, t, i, n, r, a) {
            var o, s = t.ItemSize,
                m = Object.keys(t.Array)[0],
                g = t.Array[m],
                v = g.Offset ? g.Offset : 0,
                _ = g.Size,
                b = i.channel_mode || 0,
                S = !!(1 === a ? b & C.deltaTime : b & C.delta),
                x = new ArrayBuffer(4 * (S ? _ + 2 : _ + 1) * a),
                y = new Float32Array(x, S ? 4 * a : 0, _ * a);
            return o = g.Encoding && "varint" === g.Encoding ? Object(h.a)(new Uint8Array(e, v), s * _, m) : new p[m](e, v, s * _), 4 === a && b & C.quat ? (r && (o = Object(u.a)(o, new Float32Array(o.length), s)), Object(f.a)(o, y, a, i.epsilon, i.nphi, !0), S && (y = new Float32Array(x, 0, (_ + 1) * a), y[0] = i.ox, y[1] = i.oy, y[2] = i.oz, y[3] = i.ow, Object(c.a)(y)), y) : (r && 1 !== a ? Object(u.a)(o, y, s) : y.set(o), n ? (3 === a && b & C.quantization && Object(d.a)(y, y, [i.bx, i.by, i.bz], [i.hx, i.hy, i.hz], a), S && (y = new Float32Array(x, 0, (_ + 1) * a), 3 === a ? (y[0] = i.ox, y[1] = i.oy, y[2] = i.oz) : y[0] = i.ot, Object(l.a)(y, s)), y) : y)
        },
        w = function (e, t, i, n, a, s) {
            var u = e.getJSON();
            if (!(void 0 !== u.TargetName && u.KeyFrames && u.Name && u.KeyFrames.Time && u.KeyFrames.Key)) return r.a.reject(new Error);
            var l = u.UserDataContainer,
                c = l ? o.a.convertUserDataToObject(e.setJSON(l).readUserDataContainer()) : x;
            return y.getBinaryArray(e.getOptions().currentAnimationUID).getPromise().then(function (e) {
                var r = T(e, u.KeyFrames.Time, c, n, !1, 1),
                    o = T(e, u.KeyFrames.Key, c, n, a, s);
                return i(o, r, u.TargetName, u.Name, t), t
            })
        };
    v.Vec3LerpChannel = function (e, t) {
        return w(e, t, _.createVec3Channel, !1, !1, 3)
    }, v.Vec3LerpChannelCompressedPacked = function (e, t) {
        return w(e, t, _.createVec3Channel, !0, !0, 3)
    }, v.Vec3LerpChannelCompressed = function (e, t) {
        return w(e, t, _.createVec3Channel, !0, !1, 3)
    }, v.Vec3LerpChannelPacked = function (e, t) {
        return w(e, t, _.createVec3Channel, !1, !0, 3)
    }, v.QuatSlerpChannel = function (e, t) {
        return w(e, t, _.createQuatChannel, !1, !1, 4)
    }, v.QuatSlerpChannelCompressedPacked = function (e, t) {
        return w(e, t, _.createQuatChannel, !0, !0, 4)
    }, v.QuatSlerpChannelCompressed = function (e, t) {
        return w(e, t, _.createQuatChannel, !0, !1, 4)
    }, v.QuatSlerpChannelPacked = function (e, t) {
        return w(e, t, _.createQuatChannel, !1, !0, 4)
    }, v.FloatLerpChannel = function (e, t) {
        return w(e, t, _.createFloatChannel, !1, !1, 1)
    }, v.FloatLerpChannelCompressedPacked = function (e, t) {
        return w(e, t, _.createFloatChannel, !0, !0, 1)
    }, v.FloatLerpChannelCompressed = function (e, t) {
        return w(e, t, _.createFloatChannel, !0, !1, 1)
    }, v.FloatLerpChannelPacked = function (e, t) {
        return w(e, t, _.createFloatChannel, !1, !0, 1)
    }
}, function (e, t, i) {
    "use strict";
    var n = function (e, t, i) {
        for (var n = e.length / i, r = 0; r < n; ++r)
            for (var a = r * i, o = 0; o < i; ++o) t[a + o] = e[r + n * o];
        return t
    };
    t.a = n
}, function (e, t, i) {
    "use strict";
    var n = function (e, t) {
        for (var i = t || 1, n = 1, r = e.length / i; n < r; ++n)
            for (var a = (n - 1) * i, o = n * i, s = 0; s < i; ++s) e[o + s] += e[a + s];
        return e
    };
    t.a = n
}, function (e, t, i) {
    "use strict";
    var n = function (e) {
        for (var t = 1, i = e.length / 4; t < i; ++t) {
            var n = 4 * (t - 1),
                r = 4 * t,
                a = e[n],
                o = e[n + 1],
                s = e[n + 2],
                u = e[n + 3],
                l = e[r],
                c = e[r + 1],
                h = e[r + 2],
                d = e[r + 3];
            e[r] = a * d + o * h - s * c + u * l, e[r + 1] = -a * h + o * d + s * l + u * c, e[r + 2] = a * c - o * l + s * d + u * h, e[r + 3] = -a * l - o * c - s * h + u * d
        }
        return e
    };
    t.a = n
}, function (e, t) {
    e.exports = "#define PI 3.141593\n#define saturate(_x) clamp(_x, 0., 1.)\n"
}, function (e, t) {
    e.exports = "// approximation such as http://chilliant.blogspot.fr/2012/08/srgb-approximations-for-hlsl.html\n// introduced slightly darker colors and more slight banding in the darks.\n\n// so we stick with the reference implementation (except we don't check if color >= 0.0):\n// https://www.khronos.org/registry/gles/extensions/EXT/EXT_sRGB.txt\n#define LIN_SRGB(x) x < 0.0031308 ? x * 12.92 : 1.055 * pow(x, 1.0/2.4) - 0.055\n#define SRGB_LIN(x) x < 0.04045 ? x * (1.0 / 12.92) : pow((x + 0.055) * (1.0 / 1.055), 2.4)\n\nfloat linearTosRGB(const in float color) { return LIN_SRGB(color); }\nvec3 linearTosRGB(const in vec3 color) { return vec3(LIN_SRGB(color.r), LIN_SRGB(color.g), LIN_SRGB(color.b)); }\nvec4 linearTosRGB(const in vec4 color) { return vec4(LIN_SRGB(color.r), LIN_SRGB(color.g), LIN_SRGB(color.b), color.a); }\n\nfloat sRGBToLinear(const in float color) { return SRGB_LIN(color); }\nvec3 sRGBToLinear(const in vec3 color) { return vec3(SRGB_LIN(color.r), SRGB_LIN(color.g), SRGB_LIN(color.b)); }\nvec4 sRGBToLinear(const in vec4 color) { return vec4(SRGB_LIN(color.r), SRGB_LIN(color.g), SRGB_LIN(color.b), color.a); }\n\n//http://graphicrants.blogspot.fr/2009/04/rgbm-color-encoding.html\nvec3 RGBMToRGB( const in vec4 rgba ) {\n    const float maxRange = 8.0;\n    return rgba.rgb * maxRange * rgba.a;\n}\n\nconst mat3 LUVInverse = mat3( 6.0013, -2.700, -1.7995, -1.332, 3.1029, -5.7720, 0.3007, -1.088, 5.6268 );\n\nvec3 LUVToRGB( const in vec4 vLogLuv ) {\n    float Le = vLogLuv.z * 255.0 + vLogLuv.w;\n    vec3 Xp_Y_XYZp;\n    Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n    Xp_Y_XYZp.z = Xp_Y_XYZp.y / vLogLuv.y;\n    Xp_Y_XYZp.x = vLogLuv.x * Xp_Y_XYZp.z;\n    vec3 vRGB = LUVInverse * Xp_Y_XYZp;\n    return max(vRGB, 0.0);\n}\n\n// http://graphicrants.blogspot.fr/2009/04/rgbm-color-encoding.html\nvec4 encodeRGBM(const in vec3 color, const in float range) {\n    if(range <= 0.0) return vec4(color, 1.0);\n    vec4 rgbm;\n    vec3 col = color / range;\n    rgbm.a = clamp( max( max( col.r, col.g ), max( col.b, 1e-6 ) ), 0.0, 1.0 );\n    rgbm.a = ceil( rgbm.a * 255.0 ) / 255.0;\n    rgbm.rgb = col / rgbm.a;\n    return rgbm;\n}\n\nvec3 decodeRGBM(const in vec4 color, const in float range) {\n    if(range <= 0.0) return color.rgb;\n    return range * color.rgb * color.a;\n}\n"
}, function (e, t) {
    e.exports = "#extension GL_OES_standard_derivatives : enable\n\n%UNROLL 4%\n#ifdef HAS_SHADOW_%ID%\n    uniform float uShadowReceive%ID%_bias;\n    uniform float uStaticFrameNumShadow%ID%;\n    uniform vec2 uShadow_Texture%ID%_depthRange;\n    uniform vec3 uShadow_Texture%ID%_projection;\n    uniform vec4 uShadow_Texture%ID%_viewLook;\n    uniform vec4 uShadow_Texture%ID%_viewRight;\n    uniform vec4 uShadow_Texture%ID%_viewUp;\n\n    #ifdef _ATLAS_SHADOW\n        uniform vec4 uShadow_Texture%ID%_mapSize;\n    #else\n        uniform vec2 uShadow_Texture%ID%_renderSize;\n    #endif\n#endif // HAS_SHADOW\n%%\n\n// TODO rename sampler uniform to be better and sync with light number (e.g: sShadow0, sShadow1, etc)\n#ifdef _ATLAS_SHADOW\n    uniform vec2 uShadow_Texture0_renderSize;\n    uniform sampler2D Texture7;\n#else\n    #ifdef HAS_SHADOW_0\n        uniform sampler2D Texture12;\n        #define TEX_SHADOW_0 Texture12\n    #endif\n    #ifdef HAS_SHADOW_1\n        uniform sampler2D Texture13;\n        #define TEX_SHADOW_1 Texture13\n    #endif\n    #ifdef HAS_SHADOW_2\n        uniform sampler2D Texture14;\n        #define TEX_SHADOW_2 Texture14\n    #endif\n    #ifdef HAS_SHADOW_3\n        uniform sampler2D Texture15;\n        #define TEX_SHADOW_3 Texture15\n    #endif\n#endif // _ATLAS_SHADOW\n\n#ifdef _OUT_DISTANCE\n#define OPT_ARG_outDistance ,out float outDistance\n#define OPT_INSTANCE_ARG_outDistance ,outDistance\n#else\n#define OPT_ARG_outDistance\n#define OPT_INSTANCE_ARG_outDistance\n#endif\n\n#ifdef _ATLAS_SHADOW\n#define OPT_ARG_atlasSize ,const in vec4 atlasSize\n#else\n#define OPT_ARG_atlasSize\n#endif\n\n#ifdef _NORMAL_OFFSET\n#define OPT_ARG_normalBias ,const in float normalBias\n#else\n#define OPT_ARG_normalBias\n#endif\n\n#ifdef _JITTER_OFFSET\n#define OPT_ARG_jitter ,const in float jitter\n#define OPT_INSTANCE_ARG_jitter ,jitter\n#else\n#define OPT_ARG_jitter\n#define OPT_INSTANCE_ARG_jitter\n#endif\n\n#pragma include \"shadowing/tapPCF.glsl\"\n\nfloat shadowReceive(const in bool lighted,\n                    const in vec3 normalWorld,\n                    const in vec3 vertexWorld,\n\n                    const in sampler2D shadowTexture,\n\n                    const in vec2 shadowSize,\n                    const in vec3 shadowProjection,\n\n                    const in vec4 shadowViewRight,\n                    const in vec4 shadowViewUp,\n                    const in vec4 shadowViewLook,\n\n\n                    const in vec2 shadowDepthRange,\n                    const in float shadowBias\n                    OPT_ARG_atlasSize\n                    OPT_ARG_normalBias\n                    OPT_ARG_outDistance\n                    OPT_ARG_jitter) {\n\n    // 0 for early out\n    bool earlyOut = false;\n\n    // Calculate shadow amount\n    float shadow = 1.0;\n\n    if (!lighted) {\n        shadow = 0.0;\n#ifndef _OUT_DISTANCE\n        earlyOut = true;\n#endif // _OUT_DISTANCE\n    }\n\n    if (shadowDepthRange.x == shadowDepthRange.y) {\n        earlyOut = true;\n    }\n\n    vec4 shadowVertexEye;\n    vec4 shadowNormalEye;\n    float shadowReceiverZ = 0.0;\n    vec4 shadowVertexProjected;\n    vec2 shadowUV;\n    float N_Dot_L;\n    float invDepthRange;\n\n    if (!earlyOut) {\n\n        shadowVertexEye.x = dot(shadowViewRight.xyz, vertexWorld.xyz) + shadowViewRight.w;\n        shadowVertexEye.y = dot(shadowViewUp.xyz, vertexWorld.xyz) + shadowViewUp.w;\n        shadowVertexEye.z = dot(shadowViewLook.xyz, vertexWorld.xyz) + shadowViewLook.w;\n        shadowVertexEye.w = 1.0;\n\n\n        // derivated, only need z.\n        //vec3 shadowLightDir = vec3(0.0, 0.0, 1.0); // in shadow view light is camera\n        //shadowNormalEye =  shadowViewMatrix * normalFront;\n        //shadowNormalEye.x = dot(shadowViewRight.xyz, normalWorld.xyz);\n        //shadowNormalEye.y = dot(shadowViewUp.xyz, normalWorld.xyz);\n        shadowNormalEye.z = dot(shadowViewLook.xyz, normalWorld.xyz);\n        //shadowNormalEye.w = 0.0;\n\n        //N_Dot_L = dot(shadowNormalEye.xyz, shadowLightDir);\n        N_Dot_L = shadowNormalEye.z;\n\n        if (!earlyOut) {\n\n            invDepthRange = 1.0 / (shadowDepthRange.y - shadowDepthRange.x);\n\n#ifdef _NORMAL_OFFSET\n\n            // http://www.dissidentlogic.com/old/images/NormalOffsetShadows/GDC_Poster_NormalOffset.png\n            float normalOffsetScale = clamp(1.0  - N_Dot_L, 0.0 , 1.0);\n            normalOffsetScale *= abs((shadowVertexEye.z - shadowDepthRange.x) * invDepthRange);\n            normalOffsetScale *= max(shadowProjection.x, shadowProjection.y);\n            normalOffsetScale *= normalBias * invDepthRange;\n\n\n            vec4 shadowNormalShift =  vec4(normalWorld, 0.0) * normalOffsetScale;\n            shadowNormalEye.x = dot(shadowViewRight.xyz, shadowNormalShift.xyz);\n            shadowNormalEye.y = dot(shadowViewUp.xyz, shadowNormalShift.xyz);\n            shadowNormalEye.z = dot(shadowViewLook.xyz, shadowNormalShift.xyz);\n            shadowNormalEye.w = 0.0;\n\n            vec4 viewShadow = shadowVertexEye + shadowNormalEye;\n#else\n            vec4 viewShadow = shadowVertexEye;\n#endif\n\n\n            if (shadowProjection.z == 0.0){\n\n               // X, 0, 0, 0,\n               // 0, Y, 0, 0,\n               // 0, 0, -1, -1,\n               // 0, 0, -2.0*znear, 0\n               // mat4 shadowProjectionMatrix;\n               // shadowProjectionMatrix[0] = vec4(shadowProjection.x, 0.0, 0.0, 0.0 );\n               // shadowProjectionMatrix[1] = vec4(0.0, shadowProjection.y, 0.0, 0.0 );\n               // shadowProjectionMatrix[2] = vec4(0.0, 0.0, -1.0, -1.0 );\n               // shadowProjectionMatrix[3] = vec4(0.0, 0.0, -2.0*shadowDepthRange.x, 0.0 );\n               // shadowVertexProjected = shadowProjectionMatrix * shadowVertexEye;\n\n               // derivated optimisation\n               shadowVertexProjected.x = shadowProjection.x * viewShadow.x;\n               shadowVertexProjected.y = shadowProjection.y * viewShadow.y;\n\n               shadowVertexProjected.z = - viewShadow.z - (2.0 * shadowDepthRange.x * viewShadow.w);\n               shadowVertexProjected.w = - viewShadow.z;\n\n            }\n            else{\n                // lr = 1/(left-right);\n                // bt = 1/(bottom-top);\n                // nf = 1/(near-far);\n                // -2*lr,           0,               0,              0,\n                // 0,               -2*bt,           0,              0,\n                // 0,               0,               2*nf,           0.0,\n                // (left+right)*lr, (top+bottom)*bt, (far+near)*nf), 1\n                // here left = -right && top = -bottom\n                // float lr = 1.0 / (-2.0 * shadowProjection.x);\n                // float bt = 1.0 / (-2.0 * shadowProjection.y);\n                // float nf = 1.0 / (shadowDepthRange.x - shadowDepthRange.y);\n                float nfNeg = 1.0 / (shadowDepthRange.x - shadowDepthRange.y);\n                float nfPos = (shadowDepthRange.x + shadowDepthRange.y)*nfNeg;\n\n                //mat4 shadowProjectionMatrix;\n                //shadowProjectionMatrix[0] = vec4(1.0 / shadowProjection.x, 0.0,     0.0,  0.0 );\n                //shadowProjectionMatrix[1] = vec4(0.0,     1.0 / shadowProjection.y, 0.0,  0.0 );\n                //shadowProjectionMatrix[2] = vec4(0.0,     0.0, 2.0*nfNeg, 0.0 );\n                //shadowProjectionMatrix[3] = vec4(0.0,     0.0, nfPos, 1.0 );\n                //shadowdertexProjected = shadowProjectionMatrix * shadowVertexEye;\n\n                // derivated optimisation\n                shadowVertexProjected.x = viewShadow.x / shadowProjection.x;\n                shadowVertexProjected.y = viewShadow.y / shadowProjection.y;\n\n                shadowVertexProjected.z = 2.0 * nfNeg* viewShadow.z + nfPos * viewShadow.w;\n                shadowVertexProjected.w = viewShadow.w;\n\n            }\n\n\n            if (shadowVertexProjected.w < 0.0) {\n                earlyOut = true; // notably behind camera\n            }\n\n        }\n\n        if (!earlyOut) {\n\n            shadowUV.xy = shadowVertexProjected.xy / shadowVertexProjected.w;\n            shadowUV.xy = shadowUV.xy * 0.5 + 0.5;// mad like\n\n            if (any(bvec4 ( shadowUV.x > 1., shadowUV.x < 0., shadowUV.y > 1., shadowUV.y < 0.))) {\n                earlyOut = true;// limits of light frustum\n            }\n\n            // most precision near 0, make sure we are near 0 and in [0,1]\n            shadowReceiverZ = - shadowVertexEye.z;\n            shadowReceiverZ =  (shadowReceiverZ - shadowDepthRange.x) * invDepthRange;\n\n            if(shadowReceiverZ < 0.0) {\n                earlyOut = true; // notably behind camera\n            }\n\n        }\n    }\n\n    // pcf pbias to add on offset\n    vec2 shadowBiasPCF = vec2 (0.);\n\n#ifdef GL_OES_standard_derivatives\n#ifdef _RECEIVERPLANEDEPTHBIAS\n    vec2 biasUV;\n\n    vec3 texCoordDY = dFdx(shadowVertexEye.xyz);\n    vec3 texCoordDX = dFdy(shadowVertexEye.xyz);\n\n    biasUV.x = texCoordDY.y * texCoordDX.z - texCoordDX.y * texCoordDY.z;\n    biasUV.y = texCoordDX.x * texCoordDY.z - texCoordDY.x * texCoordDX.z;\n    biasUV *= 1.0 / ((texCoordDX.x * texCoordDY.y) - (texCoordDX.y * texCoordDY.x));\n\n    // Static depth biasing to make up for incorrect fractional sampling on the shadow map grid\n    float fractionalSamplingError = dot(vec2(1.0, 1.0) * shadowSize.xy, abs(biasUV));\n    float receiverDepthBias = min(fractionalSamplingError, 0.01);\n\n    shadowBiasPCF.x = biasUV.x;\n    shadowBiasPCF.y = biasUV.y;\n\n    shadowReceiverZ += receiverDepthBias;\n\n#else // _RECEIVERPLANEDEPTHBIAS\n    shadowBiasPCF.x = clamp(dFdx(shadowReceiverZ) * shadowSize.x, -1.0, 1.0 );\n    shadowBiasPCF.y = clamp(dFdy(shadowReceiverZ) * shadowSize.y, -1.0, 1.0 );\n#endif\n\n#endif // GL_OES_standard_derivatives\n\n\n    vec4 clampDimension;\n\n#ifdef _ATLAS_SHADOW\n    shadowUV.xy  = ((shadowUV.xy * atlasSize.zw ) + atlasSize.xy) * shadowSize.xy;\n\n    // clamp uv bias/filters by half pixel to avoid point filter on border\n    clampDimension.xy = atlasSize.xy + vec2(0.5);\n    clampDimension.zw = (atlasSize.xy + atlasSize.zw) - vec2(0.5);\n\n    clampDimension = clampDimension * shadowSize.xyxy;\n#else\n    clampDimension = vec4(0.0, 0.0, 1.0, 1.0);\n#endif // _RECEIVERPLANEDEPTHBIAS\n\n\n    // now that derivatives is done and we don't access any mipmapped/texgrad texture we can early out\n    // see http://teknicool.tumblr.com/post/77263472964/glsl-dynamic-branching-and-texture-samplers\n    if (earlyOut) {\n        // empty statement because of weird gpu intel bug\n    } else {\n\n        // depth bias: fighting shadow acne (depth imprecsion z-fighting)\n        // cosTheta is dot( n, l ), clamped between 0 and 1\n        // float shadowBias = 0.005*tan(acos(N_Dot_L));\n        // same but 4 cycles instead of 15\n        float depthBias = 0.05 * sqrt( 1.0 - N_Dot_L * N_Dot_L) / clamp(N_Dot_L, 0.0005, 1.0);\n\n        // That makes sure that plane perpendicular to light doesn't flicker due to\n        // selfshadowing and 1 = dot(Normal, Light) using a min bias\n        depthBias = clamp(depthBias, 0.00005, 2.0 * shadowBias);\n\n        // shadowZ must be clamped to [0,1]\n        // otherwise it's not comparable to shadow caster depth map\n        // which is clamped to [0,1]\n        // Not doing that makes ALL shadowReceiver > 1.0 black\n        // because they ALL becomes behind any point in Caster depth map\n        shadowReceiverZ = clamp(shadowReceiverZ, 0.0, 1.0 -depthBias) - depthBias;\n\n        // Now computes Shadow\n        float res = getShadowPCF(shadowTexture,\n                                 shadowSize,\n                                 shadowUV,\n                                 shadowReceiverZ,\n                                 shadowBiasPCF,\n                                 clampDimension\n                                 OPT_INSTANCE_ARG_outDistance\n                                 OPT_INSTANCE_ARG_jitter);\n#ifdef _OUT_DISTANCE\n        if (lighted) shadow = res;\n        outDistance *= shadowDepthRange.y - shadowDepthRange.x; // world space distance\n#else\n        shadow = res;\n#endif  // _OUT_DISTANCE\n    }\n\n    return shadow;\n\n}\n"
}, function (e, t) {
    e.exports = "float decodeFloatRGBA(const in vec4 rgba) {\n    return dot(rgba, vec4(1.0, 1.0 / 255.0, 1.0 / 65025.0, 1.0 / 16581375.0));\n}\n\nfloat getSingleFloatFromTex(const in sampler2D depths, const in vec2 uv){\n#ifndef _FLOATTEX\n    return  decodeFloatRGBA(texture2D(depths, uv));\n#else\n    return texture2D(depths, uv).x;\n#endif\n}\n\n// simulation of texture2Dshadow glsl call on HW\n// http://codeflow.org/entries/2013/feb/15/soft-shadow-mapping/\nfloat texture2DCompare(const in sampler2D depths,\n                       const in vec2 uv,\n                       const in float compare,\n                       const in vec4 clampDimension){\n    float depth = getSingleFloatFromTex(depths, clamp(uv, clampDimension.xy, clampDimension.zw));\n    return compare - depth;\n}\n\n#ifdef _JITTER_OFFSET\n// TODO could be in a random.glsl file\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Private/Random.ush#L27\nfloat shadowInterleavedGradientNoise(const in vec2 fragCoord, const in float frameMod) {\n    vec3 magic = vec3(0.06711056, 0.00583715, 52.9829189);\n    return fract(magic.z * fract(dot(fragCoord.xy + frameMod * vec2(47.0, 17.0) * 0.695, magic.xy)));\n}\n#endif\n\n// simulates linear fetch like texture2d shadow\nfloat texture2DShadowLerp(\n    const in sampler2D depths,\n    const in vec2 size,\n    const in vec2 uv,\n    const in float compare,\n    const in vec4 clampDimension\n    OPT_ARG_outDistance\n    OPT_ARG_jitter){\n\n    vec2 centroidCoord = uv / size.xy;\n\n#ifdef _JITTER_OFFSET\n    if (jitter > 0.0){\n        centroidCoord += shadowInterleavedGradientNoise(gl_FragCoord.xy, jitter);\n    }\n#endif\n\n    centroidCoord = centroidCoord + 0.5;\n    vec2 f = fract(centroidCoord);\n    vec2 centroidUV = floor(centroidCoord) * size.xy;\n\n    vec4 fetches;\n    const vec2 shift  = vec2(1.0, 0.0);\n    fetches.x = texture2DCompare(depths, centroidUV + size.xy * shift.yy, compare, clampDimension);\n    fetches.y = texture2DCompare(depths, centroidUV + size.xy * shift.yx, compare, clampDimension);\n    fetches.z = texture2DCompare(depths, centroidUV + size.xy * shift.xy, compare, clampDimension);\n    fetches.w = texture2DCompare(depths, centroidUV + size.xy * shift.xx, compare, clampDimension);\n\n#ifdef _OUT_DISTANCE\n    float _a = mix(fetches.x, fetches.y, f.y);\n    float _b = mix(fetches.z, fetches.w, f.y);\n    outDistance = mix(_a, _b, f.x);\n#endif\n\n    vec4 st = step(fetches, vec4(0.0));\n\n    float a = mix(st.x, st.y, f.y);\n    float b = mix(st.z, st.w, f.y);\n    return mix(a, b, f.x);\n}\n"
}, function (e, t) {
    e.exports = '#pragma include "shadowing/shadowLinearSoft.glsl"\n\nfloat getShadowPCF(\n    const in sampler2D depths,\n    const in vec2 size,\n    const in vec2 uv,\n    const in float compare,\n    const in vec2 biasPCF,\n    const in vec4 clampDimension\n    OPT_ARG_outDistance\n    OPT_ARG_jitter) {\n\n     float res = 0.0;\n\n     res += texture2DShadowLerp(depths, size, uv + biasPCF, compare, clampDimension OPT_INSTANCE_ARG_outDistance OPT_INSTANCE_ARG_jitter);\n\n\n#if defined(_PCFx1)\n\n#else\n\n    float dx0 = -size.x;\n    float dy0 = -size.y;\n    float dx1 = size.x;\n    float dy1 = size.y;\n\n#define TSF(o1,o2) texture2DShadowLerp(depths, size, uv + vec2(o1, o2) + biasPCF, compare, clampDimension OPT_INSTANCE_ARG_outDistance OPT_INSTANCE_ARG_jitter)\n\n    res += TSF(dx0, dx0);\n    res += TSF(dx0, .0);\n    res += TSF(dx0, dx1);\n\n#if defined(_PCFx4)\n\n    res /=4.0;\n\n#elif defined(_PCFx9)\n    res += TSF(.0, dx0);\n    res += TSF(.0, dx1);\n\n    res += TSF(dx1, dx0);\n    res += TSF(dx1, .0);\n    res += TSF(dx1, dx1);\n\n\n    res /=9.0;\n\n#elif defined(_PCFx25)\n\n    float dx02 = 2.0*dx0;\n    float dy02 = 2.0*dy0;\n    float dx2 = 2.0*dx1;\n    float dy2 = 2.0*dy1;\n\n    // complete row above\n    res += TSF(dx0, dx02);\n    res += TSF(dx0, dx2);\n\n    res += TSF(.0, dx02);\n    res += TSF(.0, dx2);\n\n    res += TSF(dx1, dx02);\n    res += TSF(dx1, dx2);\n\n    // two new col\n    res += TSF(dx02, dx02);\n    res += TSF(dx02, dx0);\n    res += TSF(dx02, .0);\n    res += TSF(dx02, dx1);\n    res += TSF(dx02, dx2);\n\n    res += TSF(dx2, dx02);\n    res += TSF(dx2, dx0);\n    res += TSF(dx2, .0);\n    res += TSF(dx2, dx1);\n    res += TSF(dx2, dx2);\n\n\n    res/=25.0;\n\n#endif\n\n#undef TSF\n\n#endif\n    return res;\n}\n/////// end Tap\n'
}, function (e, t) {
    e.exports = "#define LIGHT_SPOT 0\n#define LIGHT_POINT 1\n#define LIGHT_DIRECTION 2\n#define LIGHT_HEMI 3\n\n%UNROLL 4%\n#ifdef LIGHT_TYPE_%ID%\n    uniform vec4 uSketchfabLight%ID%_diffuse;\n\n    #if LIGHT_TYPE_%ID% == LIGHT_DIRECTION\n        uniform vec3 uSketchfabLight%ID%_viewDirection;\n    #elif LIGHT_TYPE_%ID% == LIGHT_SPOT\n        uniform vec3 uSketchfabLight%ID%_viewDirection;\n        uniform vec4 uSketchfabLight%ID%_viewPosition;\n        uniform float uSketchfabLight%ID%_spotBlend;\n        uniform float uSketchfabLight%ID%_spotCutOff;\n        uniform vec4 uSketchfabLight%ID%_attenuation;\n    #elif LIGHT_TYPE_%ID% == LIGHT_POINT\n        uniform vec4 uSketchfabLight%ID%_viewPosition;\n        uniform vec4 uSketchfabLight%ID%_attenuation;\n    #elif LIGHT_TYPE_%ID% == LIGHT_HEMI\n        uniform vec4 uSketchfabLight%ID%_ground;\n        uniform vec3 uSketchfabLight%ID%_viewDirection;\n    #endif\n#endif // LIGHT_TYPE\n%%\n\nfloat getLightAttenuation(const in float dist, const in vec4 lightAttenuation) {\n    // lightAttenuation(constantEnabled, linearEnabled, quadraticEnabled)\n    // TODO find a vector alu instead of 4 scalar\n    float constant = lightAttenuation.x;\n    float linear = lightAttenuation.y * dist;\n    float quadratic = lightAttenuation.z * dist * dist;\n    return 1.0 / (constant + linear + quadratic);\n}\n\nvoid precomputeSpot(\n        const in vec3 normal,\n        const in vec3 viewVertex,\n                          \n        const in vec3 lightViewDirection,\n        const in vec4 lightAttenuation,\n        const in vec3 lightViewPosition,\n        const in float lightSpotCutOff,\n        const in float lightSpotBlend,\n                          \n        out float attenuation,\n        out vec3 eyeLightDir,\n        out float dotNL) {\n\n    eyeLightDir = lightViewPosition - viewVertex;\n    float dist = length(eyeLightDir);\n    eyeLightDir = dist > 0.0 ? eyeLightDir / dist : vec3( 0.0, 1.0, 0.0 );\n\n    float cosCurAngle = dot(-eyeLightDir, lightViewDirection);\n    float spot = cosCurAngle * smoothstep(0.0, 1.0, (cosCurAngle - lightSpotCutOff) / lightSpotBlend);\n\n    dotNL = dot(eyeLightDir, normal);\n    attenuation = spot * getLightAttenuation(dist, lightAttenuation);\n}\n\nvoid precomputePoint(\n        const in vec3 normal,\n        const in vec3 viewVertex,\n\n        const in vec4 lightAttenuation,\n        const in vec3 lightViewPosition,\n\n        out float attenuation,\n        out vec3 eyeLightDir,\n        out float dotNL) {\n\n    eyeLightDir = lightViewPosition - viewVertex;\n    float dist = length(eyeLightDir);\n\n    attenuation = getLightAttenuation(dist, lightAttenuation);\n    eyeLightDir = dist > 0.0 ? eyeLightDir / dist :  vec3( 0.0, 1.0, 0.0 );\n    dotNL = dot(eyeLightDir, normal);\n}\n\nvoid precomputeSun(\n        const in vec3 normal,\n        const in vec3 lightViewDirection,\n  \n        out float attenuation,\n        out vec3 eyeLightDir,\n        out float dotNL) {\n\n    attenuation = 1.0;\n    eyeLightDir = -lightViewDirection;\n    dotNL = dot(eyeLightDir, normal);\n}"
}, function (e, t) {
    e.exports = '#pragma include "utils/lightCommon.glsl"\n\n////////////////\n// COOK TORRANCE\n////////////////\nvec3 specularCookTorrance(\n        const in vec3 normal,\n        const in vec3 lightDir,\n        const in vec3 eyeVector,\n        const in float materialShininess,\n        const in vec3 materialSpecular,\n        const in vec3 lightSpecular) {\n  \n    vec3 h = normalize(eyeVector + lightDir);\n    float nh = dot(normal, h);\n    float specfac = 0.0;\n\n    if(nh > 0.0) {\n        float nv = max( dot(normal, eyeVector), 0.0 );\n        float i = pow(nh, materialShininess);\n        i = i / (0.1 + nv);\n        specfac = i;\n    }\n    // ugly way to fake an energy conservation (mainly to avoid super bright stuffs with low glossiness)\n    float att = materialShininess > 100.0 ? 1.0 : smoothstep(0.0, 1.0, materialShininess * 0.01);\n    return specfac * materialSpecular * lightSpecular * att;\n}\n\nvec3 lambert(const in float dotNL,  const in vec3 materialDiffuse, const in vec3 lightDiffuse) {\n    return dotNL * materialDiffuse * lightDiffuse;\n}\n\nvoid computeLightLambertCookTorrance(\n        const in vec3 normal,\n        const in vec3 eyeVector,\n        const in float dotNL,\n        const in float attenuation,\n\n        const in vec3 materialDiffuse,\n        const in vec3 materialSpecular,\n        const in float materialShininess,\n\n        const in vec3 lightDiffuse,\n        const in vec3 lightSpecular,\n        const in vec3 eyeLightDir,\n\n        out vec3 diffuseOut,\n        out vec3 specularOut,\n        out bool lighted) {\n\n    lighted = dotNL > 0.0;\n    if (lighted == false) {\n        specularOut = diffuseOut = vec3(0.0);\n        return;\n    }\n\n    specularOut = attenuation * specularCookTorrance(normal, eyeLightDir, eyeVector, materialShininess, materialSpecular, lightSpecular);\n    diffuseOut = attenuation * lambert(dotNL, materialDiffuse, lightDiffuse);\n}\n\n///////\n// HEMI\n///////\nvoid hemiLight(\n        const in vec3 normal,\n        const in vec3 eyeVector,\n        const in float dotNL,\n        const in vec3 eyeLightDir,\n\n        const in vec3 materialDiffuse,\n        const in vec3 materialSpecular,\n        const in float materialShininess,\n\n        const in vec3 lightDiffuse,\n        const in vec3 lightGround,\n\n        out vec3 diffuseOut,\n        out vec3 specularOut,\n        out bool lighted) {\n\n    lighted = false;\n    float weight = 0.5 * dotNL + 0.5;\n    diffuseOut = materialDiffuse * mix(lightGround, lightDiffuse, weight);\n\n    // same cook-torrance as above for sky/ground\n    float skyWeight = 0.5 * dot(normal, normalize(eyeVector + eyeLightDir)) + 0.5;\n    float gndWeight = 0.5 * dot(normal, normalize(eyeVector - eyeLightDir)) + 0.5;\n    float skySpec = pow(skyWeight, materialShininess);\n    float skyGround = pow(gndWeight, materialShininess);\n    float divisor = (0.1 + max( dot(normal, eyeVector), 0.0 ));\n    float att = materialShininess > 100.0 ? 1.0 : smoothstep(0.0, 1.0, materialShininess * 0.01);\n    \n    specularOut = lightDiffuse * materialSpecular * weight * att * (skySpec + skyGround) / divisor;\n}\n'
}, function (e, t) {
    e.exports = '#pragma include "utils/common.glsl"\n#pragma include "utils/lightCommon.glsl"\n\nvec4 precomputeGGX(const in vec3 normal, const in vec3 eyeVector, const in float roughness) {\n    float NoV = saturate(dot(normal, eyeVector));\n    float r2 = roughness * roughness;\n    return vec4(r2, r2 * r2, NoV, NoV * (1.0 - r2));\n}\n\n// Walter et al. 2007, "Microfacet models for refraction through rough surfaces"\nfloat D_GGX(const vec4 precomputeGGX, const float NoH) {\n    float a2 = precomputeGGX.y;\n    float d = (NoH * a2 - NoH) * NoH + 1.0;\n    return a2 / (PI * d * d);\n}\n\n// Schlick 1994, "An Inexpensive BRDF Model for Physically-Based Rendering"\nvec3 F_Schlick(const vec3 f0, const float f90, const in float VoH) {\n    float VoH5 = pow(1.0 - VoH, 5.0);\n    return f90 * VoH5 + (1.0 - VoH5) * f0;\n}\n\n// greyscale f0 version (clearcoat)\nfloat F_Schlick(const float f0, const float f90, const in float VoH) {\n    return f0 + (f90 - f0) * pow(1.0 - VoH, 5.0);\n}\n\n// Heitz 2014, "Understanding the Masking-Shadowing Function in Microfacet-Based BRDFs"\nfloat V_SmithCorrelated(const vec4 precomputeGGX, const float NoL) {\n    float a = precomputeGGX.x;\n    float smithV = NoL * (precomputeGGX.w + a);\n    float smithL = precomputeGGX.z * (NoL * (1.0 - a) + a);\n    return 0.5 / (smithV + smithL);\n    // same as\n    // Hammon 2017, "PBR Diffuse Lighting for GGX+Smith Microsurfaces"\n    // return 0.5 / mix(2.0 * NoL * NoV, NoL + NoV, precomputeGGX.y)\n}\n\nvec3 specularLobe(const vec4 precomputeGGX, const vec3 normal, const vec3 eyeVector, const vec3 eyeLightDir, const vec3 specular, const float NoL, const float f90) {\n    vec3 H = normalize(eyeVector + eyeLightDir);\n    float NoH = saturate(dot(normal, H));\n    float VoH = saturate(dot(eyeLightDir, H));\n\n    // distribution / visibility / fresnel\n    float D = D_GGX(precomputeGGX, NoH);\n    float V = V_SmithCorrelated(precomputeGGX, NoL);\n    vec3 F = F_Schlick(specular, f90, VoH);\n\n    return (D * V * PI) * F; // we multipy by PI because our diffuse is not divided by PI\n}\n\n// pure compute Light PBR\nvoid computeLightLambertGGX(\n    const in vec3 normal,\n    const in vec3 eyeVector,\n    const in float NoL,\n    const in vec4 precomputeGGX,\n\n    const in vec3 diffuse,\n    const in vec3 specular,\n\n    const in float attenuation,\n    const in vec3 lightColor,\n    const in vec3 eyeLightDir,\n    const in float f90,\n\n    out vec3 diffuseOut,\n    out vec3 specularOut,\n    out bool lighted) {\n\n    lighted = NoL > 0.0;\n    if (lighted == false) {\n        specularOut = diffuseOut = vec3(0.0);\n        return;\n    }\n\n    vec3 colorAttenuate = attenuation * NoL * lightColor;\n    specularOut = colorAttenuate * specularLobe(precomputeGGX, normal, eyeVector, eyeLightDir, specular, NoL, f90);\n    diffuseOut = colorAttenuate * diffuse;\n}\n'
}, function (e, t) {
    e.exports = '#pragma include "utils/common.glsl"\n#pragma include "utils/lightCommon.glsl"\n\n///////////////////////////\n/// SUBSURFACE TRANSLUCENCY\n///////////////////////////\nvec3 computeLightSSS(\n        const in float dotNL,\n        const in float attenuation,\n        const in float thicknessFactor,\n        const in vec3 translucencyColor,\n        const in float translucencyFactor,\n        const in float shadowDistance,\n        const in vec3 diffuse,\n        const in vec3 lightColor) {\n\n    // http://blog.stevemcauley.com/2011/12/03/energy-conserving-wrapped-diffuse/\n    // float scatter = 0.5;\n    // float wrap = saturate((dotNL + scatter) / ((1.0 + scatter) * (1.0 + scatter)));\n\n    // https://github.com/iryoku/separable-sss/blob/master/SeparableSSS.h#L362\n    float wrap = saturate(0.3 - dotNL);\n    float thickness = max(0.0, shadowDistance / max(0.001, thicknessFactor));\n\n    // http://www.crytek.com/download/2014_03_25_CRYENGINE_GDC_Schultz.pdf\n    // skin approximation vec3(0.98, 0.3, 0.2)\n    float finalAttenuation = translucencyFactor * attenuation * wrap;\n    return finalAttenuation * lightColor * diffuse * exp(-thickness / max(translucencyColor, vec3(0.001))); \n}\n'
}, function (e, t) {
    e.exports = "//////////////////////////////\n// UN-OPTIMIZED VERSION (WITH IF)\n//////////////////////////////\n\n// //http://http.developer.nvidia.com/GPUGems/gpugems_ch04.html\n// mat4 getMat4FromVec4(const int index, inout mat4 myMat) {\n//     // We have to use a global variable because we can't access dynamically\n//     // matrix is transpose so we should do vec * matrix\n//     myMat[0] = uBones[index];\n//     myMat[1] = uBones[index + 1];\n//     myMat[2] = uBones[index + 2];\n//     return myMat;\n// }\n\n// mat4 skinning( const in vec4 weights, const in vec4 bonesIndex ) {\n//     ivec4 idx =  3 * ivec4(bonesIndex);\n//     mat4 tmpMat = mat4(1.0);\n//     mat4 outMat = mat4(0.0);\n\n//     // we handle negative weights\n//     if(all(equal(weights, vec4(0.0)))) return tmpMat;\n\n//     if(weights.x != 0.0) outMat += weights.x * getMat4FromVec4(idx.x, tmpMat);\n//     if(weights.y != 0.0) outMat += weights.y * getMat4FromVec4(idx.y, tmpMat);\n//     if(weights.z != 0.0) outMat += weights.z * getMat4FromVec4(idx.z, tmpMat);\n//     if(weights.w != 0.0) outMat += weights.w * getMat4FromVec4(idx.w, tmpMat);\n//     return outMat;\n// }\n\n//////////////////////////////\n// UN-OPTIMIZED VERSION (NO IF)\n//////////////////////////////\n\nmat4 skinning(const in vec4 weights, const in vec4 bonesIndex) {\n    ivec4 idx =  3 * ivec4(bonesIndex);\n    mat4 tmpMat = mat4(1.0);\n\n    // if sum is 0, return identity\n    vec4 absWeights = -abs(weights);\n    mat4 outMat = step(0.0, absWeights.x + absWeights.y + absWeights.z + absWeights.w) * tmpMat;\n\n    // we handle negative weights\n    // outMat[3][3] += weights.x + weights.y + weights.z + weights.w;\n\n    tmpMat[0] = uBones[idx.x];\n    tmpMat[1] = uBones[idx.x + 1];\n    tmpMat[2] = uBones[idx.x + 2];\n    outMat += weights.x * tmpMat;\n\n    tmpMat[0] = uBones[idx.y];\n    tmpMat[1] = uBones[idx.y + 1];\n    tmpMat[2] = uBones[idx.y + 2];\n    outMat += weights.y * tmpMat;\n\n    tmpMat[0] = uBones[idx.z];\n    tmpMat[1] = uBones[idx.z + 1];\n    tmpMat[2] = uBones[idx.z + 2];\n    outMat += weights.z * tmpMat;\n\n    tmpMat[0] = uBones[idx.w];\n    tmpMat[1] = uBones[idx.w + 1];\n    tmpMat[2] = uBones[idx.w + 2];\n    outMat += weights.w * tmpMat;\n\n    return outMat;\n}\n"
}, function (e, t) {
    e.exports = "vec3 morphing(const in vec4 weights, const in vec3 vertex, const in vec3 target0) {\n    return mix(vertex, target0, weights[0]);\n}\n\nvec3 morphing(const in vec4 weights, const in vec3 vertex, const in vec3 target0, const in vec3 target1) {\n    vec3 vecOut = vertex * (1.0 - ( weights[0] + weights[1]));\n    vecOut += target0 * weights[0];\n    vecOut += target1 * weights[1];\n    return vecOut;\n}\n\nvec3 morphing(const in vec4 weights, const in vec3 vertex, const in vec3 target0, const in vec3 target1, const in vec3 target2) {\n    vec3 vecOut = vertex * (1.0 - ( weights[0] + weights[1] + weights[2]));\n    vecOut += target0 * weights[0];\n    vecOut += target1 * weights[1];\n    vecOut += target2 * weights[2];\n    return vecOut;\n}\n\nvec3 morphing(const in vec4 weights,const in vec3 vertex,const in vec3 target0,const in vec3 target1,const in vec3 target2,const in vec3 target3) {\n    vec3 vecOut = vertex * (1.0 - ( weights[0] + weights[1] + weights[2] + weights[3]));\n    vecOut += target0 * weights[0];\n    vecOut += target1 * weights[1];\n    vecOut += target2 * weights[2];\n    vecOut += target3 * weights[3];\n    return vecOut;\n}\n"
}, function (e, t) {
    e.exports = 'uniform float uEnvironmentExposure;\r\nuniform mat3 uEnvironmentTransform;\r\nuniform vec2 uTextureEnvironmentSpecularPBRLodRange;\r\nuniform vec2 uTextureEnvironmentSpecularPBRTextureSize;\r\nuniform vec3 uDiffuseSPH[9];\r\n\r\n#ifdef HAS_ENVIRONMENT_BRDF\r\nuniform sampler2D sIntegrateBRDF;\r\n#endif\r\n\r\nvec3 computeDiffuseSPH(const in vec3 normal) {\r\n    vec3 n = uEnvironmentTransform * normal;\r\n    // https://github.com/cedricpinson/envtools/blob/master/Cubemap.cpp#L523\r\n    vec3 result =\r\n        uDiffuseSPH[0] +\r\n        uDiffuseSPH[1] * n.y +\r\n        uDiffuseSPH[2] * n.z +\r\n        uDiffuseSPH[3] * n.x +\r\n        uDiffuseSPH[4] * n.y * n.x +\r\n        uDiffuseSPH[5] * n.y * n.z +\r\n        uDiffuseSPH[6] * (3.0 * n.z * n.z - 1.0) +\r\n        uDiffuseSPH[7] * (n.z * n.x) +\r\n        uDiffuseSPH[8] * (n.x * n.x - n.y * n.y);\r\n     return max(result, vec3(0.0));\r\n}\r\n\r\n#ifndef HAS_LEGACY_CLASSIC\r\n\r\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Private/BRDF.ush#L202\r\nvec3 integrateBRDF(const in vec3 specular, const in float roughness, const in float NoV, const in float f90) {\r\n#ifdef HAS_ENVIRONMENT_BRDF\r\n    vec4 rgba = texture2D(sIntegrateBRDF, vec2(NoV, roughness));\r\n    float b = (rgba[3] * 65280.0 + rgba[2] * 255.0);\r\n    float a = (rgba[1] * 65280.0 + rgba[0] * 255.0);\r\n    const float div = 1.0 / 65535.0;\r\n    return (specular * a + b * f90) * div;\r\n#else\r\n    // https://www.unrealengine.com/blog/physically-based-shading-on-mobile\r\n    // TODO should we use somehow specular f0 ?\r\n    const vec4 c0 = vec4(-1.0, -0.0275, -0.572, 0.022);\r\n    const vec4 c1 = vec4(1.0, 0.0425, 1.04, -0.04);\r\n    vec4 r = roughness * c0 + c1;\r\n    float a004 = min(r.x * r.x, exp2(-9.28 * NoV)) * r.x + r.y;\r\n    vec2 AB = vec2(-1.04, 1.04) * a004 + r.zw;\r\n    return specular * AB.x + AB.y * f90;\r\n#endif\r\n}\r\n\r\n// Frostbite, Lagarde paper p67\r\n// http://www.frostbite.com/wp-content/uploads/2014/11/course_notes_moving_frostbite_to_pbr.pdf\r\nfloat linRoughnessToMipmap(const in float roughnessLinear) {\r\n    return sqrt(roughnessLinear);\r\n}\r\n\r\n#ifdef ENV_CUBEMAP\r\nuniform samplerCube sSpecularPBR;\r\n#pragma include "utils/cubemapLod.glsl"\r\n#endif\r\n\r\n#ifdef ENV_PANORAMA\r\nuniform sampler2D sSpecularPBR;\r\n#pragma include "utils/panoramaLod.glsl"\r\n#endif\r\n\r\nvec3 getSpecularDominantDir(const in vec3 N, const in vec3 R, const in float realRoughness) {\r\n    float smoothness = 1.0 - realRoughness;\r\n    float lerpFactor = smoothness * (sqrt(smoothness) + realRoughness);\r\n    // The result is not normalized as we fetch in a cubemap\r\n    return mix(N, R, lerpFactor);\r\n}\r\n\r\nvec3 getPrefilteredEnvMapColor(const in vec3 normal, const in vec3 eyeVector, const in float roughness, const in vec3 frontNormal) {\r\n    float NoV = dot(normal, eyeVector);\r\n    vec3 R = normalize(NoV * 2.0 * normal - eyeVector);\r\n    R = getSpecularDominantDir(normal, R, roughness);\r\n\r\n#ifdef ENV_CUBEMAP\r\n    vec3 prefilteredColor = prefilterEnvMapCube(roughness, uEnvironmentTransform * R);\r\n#else\r\n    vec3 prefilteredColor = prefilterEnvMapPanorama(roughness, uEnvironmentTransform * R);\r\n#endif\r\n\r\n    // http://marmosetco.tumblr.com/post/81245981087\r\n    // marmoset uses 1.3, we force it to 1.0\r\n    float factor = clamp(1.0 + dot(R, frontNormal), 0.0, 1.0);\r\n    prefilteredColor *= factor * factor;\r\n    return prefilteredColor;\r\n}\r\n\r\nvec3 computeIBLSpecularUE4(const in vec3 normal, const in vec3 eyeVector, const in float roughness, const in vec3 specular, const in vec3 frontNormal, const in float f90) {\r\n    float NoV = dot(normal, eyeVector);\r\n    return getPrefilteredEnvMapColor(normal, eyeVector, roughness, frontNormal) * integrateBRDF(specular, roughness, NoV, f90);\r\n}\r\n\r\n#endif'
}, function (e, t) {
    e.exports = '#pragma include "utils/functions.glsl"\r\n\r\nvec2 computeUVForMipmap(const in float level, const in vec2 uv) {\r\n    // width for level\r\n    float widthForLevel = exp2(uTextureEnvironmentSpecularPBRLodRange.x - level);\r\n\r\n    // the height locally for the level in pixel\r\n    // to opimitize a bit we scale down the v by two in the inputs uv\r\n    float heightForLevel = widthForLevel * 0.5;\r\n\r\n    // compact version\r\n    float texelSize = 1.0 / uTextureEnvironmentSpecularPBRTextureSize.x;\r\n    vec2 uvSpaceLocal =  vec2(1.0) + uv * vec2(widthForLevel - 2.0, heightForLevel - 2.0);\r\n    uvSpaceLocal.y += uTextureEnvironmentSpecularPBRTextureSize.x - widthForLevel;\r\n    return uvSpaceLocal * texelSize;\r\n}\r\n\r\n//for y up\r\nvec2 normalToPanoramaUVY(const in vec3 dir) {\r\n    float n = length(dir.xz);\r\n\r\n    // to avoid bleeding the max(-1.0,dir.x / n) is needed\r\n    vec2 pos = vec2((n > 0.0000001) ? max(-1.0, dir.x / n) : 0.0, dir.y);\r\n\r\n    // fix edge bleeding\r\n    if (pos.x > 0.0) pos.x = min(0.999999, pos.x);\r\n\r\n    pos = acos(pos) * 0.3183098861837907; // inv_pi\r\n\r\n    pos.x = (dir.z > 0.0) ? pos.x * 0.5 : 1.0 - (pos.x * 0.5);\r\n\r\n    // shift u to center the panorama to -z\r\n    pos.x = mod(pos.x - 0.25 + 1.0, 1.0);\r\n    pos.y = 1.0 - pos.y;\r\n    return pos;\r\n}\r\n\r\nvec3 prefilterEnvMapPanorama(const in float rLinear, const in vec3 R) {\r\n    float lod = min(uTextureEnvironmentSpecularPBRLodRange.x, linRoughnessToMipmap(rLinear) * uTextureEnvironmentSpecularPBRLodRange.y);\r\n    vec2 uvBase = normalToPanoramaUVY(R);\r\n\r\n    // // we scale down v here because it avoid to do twice in sub functions\r\n    // uvBase.y *= 0.5;\r\n\r\n    vec3 texel0 = LUVToRGB(texture2D(sSpecularPBR, computeUVForMipmap(floor(lod), uvBase)));\r\n    vec3 texel1 = LUVToRGB(texture2D(sSpecularPBR, computeUVForMipmap(ceil(lod), uvBase)));\r\n\r\n    return mix(texel0, texel1, fract(lod));\r\n}\r\n'
}, function (e, t) {
    e.exports = '#pragma include "utils/functions.glsl"\r\n\r\n#extension GL_EXT_shader_texture_lod : enable\r\nvec3 prefilterEnvMapCube(const in float rLinear, const in vec3 R) {\r\n    vec3 dir = R;\r\n    float lod = min(uTextureEnvironmentSpecularPBRLodRange.x, linRoughnessToMipmap(rLinear) * uTextureEnvironmentSpecularPBRLodRange.y);\r\n\r\n    // http://seblagarde.wordpress.com/2012/06/10/amd-cubemapgen-for-physically-based-rendering/\r\n    float scale = 1.0 - exp2(lod) / uTextureEnvironmentSpecularPBRTextureSize.x;\r\n    vec3 absDir = abs(dir);\r\n    float M = max(max(absDir.x, absDir.y), absDir.z);\r\n\r\n    if (absDir.x != M) dir.x *= scale;\r\n    if (absDir.y != M) dir.y *= scale;\r\n    if (absDir.z != M) dir.z *= scale;\r\n\r\n    return LUVToRGB(textureCubeLodEXT(sSpecularPBR, dir, lod));\r\n}\r\n'
}, function (e, t) {
    e.exports = '#pragma include "utils/functions.glsl"\n\n// used by background.frag\nvec3 textureCubeFixed(const in samplerCube tex, const in vec3 R, const in float size) {\n    vec3 dir = R;\n    float scale = 1.0 - 1.0 / size;\n    // http://seblagarde.wordpress.com/2012/06/10/amd-cubemapgen-for-physically-based-rendering/\n    vec3 absDir = abs(dir);\n    float M = max(max(absDir.x, absDir.y), absDir.z);\n\n    if (absDir.x != M) dir.x *= scale;\n    if (absDir.y != M) dir.y *= scale;\n    if (absDir.z != M) dir.z *= scale;\n\n    return LUVToRGB(textureCube(tex, dir));\n}\n'
}, function (e, t) {
    e.exports = "\n// white vs interleaved vs blue noise\n// https://blog.demofox.org/2017/10/31/animating-noise-for-integration-over-time/\n\n// to test in a shadertoy\n// https://www.shadertoy.com/view/lsdfD4\n\n// https://www.shadertoy.com/view/4djSRW\n// most combinations are possible : in[1,2,3] -> out[1,2,3]\n#define INT_SCALE1 .1031\nfloat pseudoRandom(const in vec2 fragCoord) {\n    vec3 p3  = fract(vec3(fragCoord.xyx) * INT_SCALE1);\n    p3 += dot(p3, p3.yzx + 19.19);\n    return fract((p3.x + p3.y) * p3.z);\n}\n\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Private/Random.ush#L27\nfloat interleavedGradientNoise(const in vec2 fragCoord, const in float frameMod) {\n    vec3 magic = vec3(0.06711056, 0.00583715, 52.9829189);\n    return fract(magic.z * fract(dot(fragCoord.xy + frameMod * vec2(47.0, 17.0) * 0.695, magic.xy)));\n}\n\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Private/MaterialTemplate.ush#L1863\n// we slighty change it by multiplying by 1.2 (to match with other noise), otherwise the range seems to be between [0 - 0.83]\nfloat ditheringNoise(const in vec2 fragCoord, const in float frameMod) {\n    // float fm = mod(frameMod, 2.0) == 0.0 ? 1.0 : -1.0;\n    float fm = frameMod;\n    float dither5 = fract((fragCoord.x + fragCoord.y * 2.0 - 1.5 + fm) / 5.0);\n    float noise = fract(dot(vec2(171.0, 231.0) / 71.0, fragCoord.xy));\n    return (dither5 * 5.0 + noise) * (1.2 / 6.0);\n}\n\nvoid ditheringMaskingDiscard(\n    const in vec4 fragCoord,\n    const in int dithering,\n    const in float alpha,\n    const in float factor,\n\n    const in float thinLayer,\n\n    const in float frameMod,\n    const in vec2 nearFar,\n\n    const in vec4 halton) {\n\n    if (dithering != 1) {\n        if (alpha < factor) discard;\n        return;\n    }\n\n    float rnd;\n\n    if (thinLayer == 0.0) {\n        float linZ = (1.0 / fragCoord.w - nearFar.x) / (nearFar.y - nearFar.x);\n        float sliceZ = floor(linZ * 500.0) / 500.0;\n        rnd = interleavedGradientNoise(fragCoord.xy + sliceZ, frameMod);\n    } else {\n        rnd = pseudoRandom(fragCoord.xy + halton.xy * 1000.0 + fragCoord.z * (abs(halton.z) == 2.0 ? 1000.0 : 1.0));\n    }\n\n    if (alpha * factor < rnd) discard;\n}\n"
}, function (e, t) {
    e.exports = "#extension GL_OES_standard_derivatives : enable\n\nuniform float uMatcapCurvature;\nuniform mat4 uProjectionMatrix;\n\n// http://madebyevan.com/shaders/curvature/\nfloat getCurvature(const in vec3 normal) {\n#ifndef GL_OES_standard_derivatives\n    return 1.0;\n#else\n  if (uMatcapCurvature == 0.0) return 1.0;\n\n  // Compute curvature\n  vec3 dx = dFdx(normal);\n  vec3 dy = dFdy(normal);\n  vec3 xneg = normal - dx;\n  vec3 xpos = normal + dx;\n  vec3 yneg = normal - dy;\n  vec3 ypos = normal + dy;\n\n  float factor =  uMatcapCurvature / (length(vViewVertex.xyz) * atan(-1.0 / uProjectionMatrix[2][3]));\n  float curvature = (cross(xneg, xpos).y - cross(yneg, ypos).x) * factor;\n\n  float curvDirt = clamp(-curvature * 1.5, 0.0, 1.0);\n  float curvEdge = clamp(curvature * 2.5, 0.0, 1.0);\n\n  float factorDirt = mix(1.0, 0.3, curvDirt);\n  float factorEdge = 2.0;\n\n  return mix(factorDirt, factorEdge, curvEdge);\n#endif\n}\n"
}, function (e, t) {
    e.exports = '#pragma include "utils/encodeDecode.glsl"\n#pragma include "utils/decodeDepth.glsl"\n\n// manual refract mostly to re-use dot(I, N)\nvec3 batchRefract(const in vec3 I, const in vec3 N , const in float eta, const in float dotNI) {\n    float k = 1.0 - eta * eta * (1.0 - dotNI * dotNI);\n    return (k < 0.0) ? vec3(0.0) :  eta * I - (eta * dotNI + sqrt(k)) * N;\n}\n\nuniform float uOpacityIOR;\nuniform vec3 uOpacityRefractionColor;\n\nuniform float uBoxRadius;\nuniform int uIsVr;\nuniform sampler2D uTextureToBeRefracted;\nuniform vec2 uTextureToBeRefractedSize;\nuniform mat4 uProjectionMatrix;\nuniform vec4 uPreviousHalton;\nuniform vec2 uPreviousGlobalTexRatio;\nuniform vec2 uPreviousGlobalTexSize;\nuniform vec2 uGlobalTexSize;\n\n#ifndef HAS_REFRACTION_NORMAL_OFFSET\n    uniform sampler2D uTextureMipmapDepth;\n    uniform vec2 uNearFar;\n    uniform vec2 uGlobalTexRatio;\n    uniform mat4 uReprojectViewProj;\n    uniform vec4 uTaaCornersCSLeft[2];\n#endif\n\nvec3 refraction(\n    const in float roughness,\n    const in vec3 normalSurface,\n\n#ifdef HAS_REFRACTION_NORMAL_OFFSET\n    const in vec3 normalVertex\n#else\n    const in vec3 eyeVector\n#endif\n)\n\n{\n\n#ifdef HAS_REFRACTION_NORMAL_OFFSET\n    // no reprojection and no depth compare for the normal offset version (not worth it as for the moment)\n    vec2 uv = gl_FragCoord.xy / uGlobalTexSize.xy + (normalVertex.xy - normalSurface.xy) * (uOpacityIOR - 1.0);\n#else\n    float dotNI = -dot(eyeVector, normalSurface);\n\n    // compute UV at distortion point\n    // https://en.wikibooks.org/wiki/GLSL_Programming/Unity/Curved_Glass\n    vec3 pos = vViewVertex.xyz + uBoxRadius * batchRefract(-eyeVector, normalSurface, 1.0 / uOpacityIOR, dotNI);\n    pos = (uProjectionMatrix * vec4(pos, 1.0)).xyw; // we discard z and only keep the perspective divide\n    vec2 uv = 0.5 + 0.5 * pos.xy / pos.z;\n\n    if (uIsVr == 1) {\n        // no reprojection in vr (would require another uTaaCornersCSRight uniform)\n        uv.x *= 0.5;\n        if (gl_FragCoord.x > uGlobalTexSize.x * 0.5) uv.x += 0.5;\n    } else {\n        // we discard refraction on pixels that are in front of refracted surface by\n        // comparing current pixel depth with depth at refraction point\n        // if we are on the background we take the depth of the current position\n        #ifdef DEPTH_MIPMAP\n            vec3 pack = texture2D(uTextureMipmapDepth, uPreviousGlobalTexRatio * vec2(uv.x, (1.0 - uv.y) * 0.5)).xyz;\n            float depthRefracted = pack.x == 1.0 ? (-vViewVertex.z - uNearFar.x) / (uNearFar.y - uNearFar.x) : decode24(pack);\n        #else\n            vec4 pack = texture2D(uTextureMipmapDepth, uGlobalTexRatio * uv);\n            float depthRefracted = pack.x == 1.0 ? (-vViewVertex.z - uNearFar.x) / (uNearFar.y - uNearFar.x) : decodeDepth(pack);\n        #endif\n\n        // compute view space refracted position from depth\n        vec4 AB = mix(uTaaCornersCSLeft[0], uTaaCornersCSLeft[1], uv.x);\n        pos = vec3(mix(AB.xy, AB.zw, uv.y), 1.0) * -(uNearFar.x + (uNearFar.y - uNearFar.x) * depthRefracted);\n\n        // pos is computed with last frame projection which is not entirely correct\n        if (dot(pos.xyz - vViewVertex.xyz, normalSurface) > 0.00001) {\n            uv = gl_FragCoord.xy / uGlobalTexSize.xy;\n        } else {\n            // reproject view vector\n            pos = (uReprojectViewProj * vec4(pos, 1.0)).xyw;\n            uv.xy = 0.5 + 0.5 * pos.xy / pos.z;\n        }\n    }\n#endif\n\n    // unjitter (so that the refraction is stable when doing supersampling)\n    uv -= 0.5 * uPreviousHalton.xy / uPreviousGlobalTexSize.xy;\n\n    // repeat mirror for out of screen fetches (it\'s better than a sudden cut)\n    // we can\'t simply use MIRRORED_REPEAT because of manual mipmap\n    uv = abs(uv); \n    if (uv.x > 1.0) uv.x -= 2.0 * (uv.x - 1.0);\n    if (uv.y > 1.0) uv.y -= 2.0 * (uv.y - 1.0);\n\n    // adjusts roughness-to-mipmap depending of distance from surface (aka: consistent blurring even when we unzoom)\n    float adjustRoughness = clamp(uProjectionMatrix[1][1] / 12.0 * uBoxRadius / -vViewVertex.z, 0.0, 1.0);\n    float adjustFactor = 0.05; // the higher it is, the sharper it will be when we are far away\n    adjustRoughness = (1.0 + adjustFactor) * adjustRoughness / (adjustFactor + adjustRoughness);\n\n    // roughness support\n    float maxLod = 7.0;\n    float lodLevel = maxLod * min(0.99, roughness * adjustRoughness); // same as in pbr\n\n    float lowerLevel = floor(lodLevel);\n    float higherLevel = min(maxLod, lowerLevel + 1.0);\n    float lerpFactor = lodLevel - lowerLevel; // [0,1]\n\n    // see packMipmapRefraction.glsl\n    // mipmap packing of refracted texture (the packing is not optimal and is a bit naive):\n    // level0: (1-uv)/2\n    // level1: (3-uv)/4\n    // level2: (7-uv)/8\n    // level3: (15-uv)/16\n    // level4: (31-uv)/32\n    // etc...\n\n    float powLevel = pow(2.0, higherLevel);\n\n    // border pixel issue with bilinear...\n    vec2 pixelSize = 2.0 * powLevel / uTextureToBeRefractedSize;\n    uv = max(pixelSize, min(1.0 - pixelSize, uv));\n\n    // lower uv\n    vec2 uvLower = vec2(2.0 * uv.x, powLevel - 1.0 - uv.y) * uPreviousGlobalTexRatio.xy / powLevel;\n\n    // higher uv\n    powLevel *= 2.0;\n    vec2 uvHigher = vec2(2.0 * uv.x, powLevel - 1.0 - uv.y) * uPreviousGlobalTexRatio.xy / powLevel;\n\n    // manual lerp, mixing rgbm colors exhibits visible seams\n    vec3 fetch = mix(decodeRGBM(texture2D(uTextureToBeRefracted, uvLower), 7.0), decodeRGBM(texture2D(uTextureToBeRefracted, uvHigher), 7.0), lerpFactor);\n\n#ifndef HAS_REFRACTION_NORMAL_OFFSET\n    // reduce bright fresnel effect, it darkens/accentuates the edges in some cases (very rough surface)\n    fetch.rgb -= fetch.rgb * pow(clamp(1.0 + dotNI, 0.0, 1.0), 4.0);\n#endif\n\n    return uOpacityRefractionColor * fetch.rgb;\n}\n'
}, function (e, t) {
    e.exports = '#pragma include "utils/lightsPBR.glsl"\n\n//https://en.wikipedia.org/wiki/Beer%E2%80%93Lambert_law for translucent material absorbtion\nvec3 beerLambert(const float NoV, const float NoL, const vec3 tint, const float d) {\n    // exp(tint * -distance * density)\n    return exp(tint * -(d * ((NoL + NoV) / max(NoL * NoV, 1e-3))));\n}\n\nvec3 getClearCoatAbsorbtion(const in float NoV, const in float NoL, const in float clearCoatFactor) {\n    return mix(vec3(1.0), beerLambert(NoV, NoL, uClearCoatTint, uClearCoatThickness), clearCoatFactor);\n}\n\n// compute Light PBR for clearCoat layer\nvoid computeLightLambertGGXClearCoat(\n    const in float ccNoV,\n    const in vec3 normal,\n    const in vec3 eyeVector,\n    const in float dotNL,\n    const in vec4 precomputeGGX,\n\n    const in float attenuation,\n    const in vec3 lightColor,\n    const in vec3 eyeLightDir,\n\n    const in float clearCoatFactor,\n\n    out vec3 clearCoatSpecular,\n    out vec3 clearCoatAttenuation) {\n\n    if (dotNL <= 0.0) {\n        clearCoatSpecular = vec3(0.0);\n        clearCoatAttenuation = vec3(0.0);\n        return;\n    }\n\n    float ccNoL = saturate(dot(normal, -refract(eyeLightDir, normal, 1.0 / uClearCoatIor)));\n    vec3 clearCoatAbsorption = getClearCoatAbsorbtion(ccNoV, ccNoL, clearCoatFactor);\n\n    vec3 H = normalize(eyeVector + eyeLightDir);\n    float NoH = saturate(dot(normal, H));\n    float VoH = saturate(dot(eyeLightDir, H));\n\n    // distribution / visibility / fresnel\n    float D = D_GGX(precomputeGGX, NoH);\n    float V = V_SmithCorrelated(precomputeGGX, ccNoL);\n    float F = F_Schlick(uClearCoatF0, 1.0, VoH);\n\n    clearCoatSpecular = (attenuation * dotNL * clearCoatFactor * D * V * PI * F) * lightColor;\n    clearCoatAttenuation = (1.0 - F * clearCoatFactor) * clearCoatAbsorption;\n}\n'
}, function (e, t) {
    e.exports = '#pragma include "utils/decodeDepth.glsl"\n#pragma include "utils/rand.glsl"\n\n#define SSR_STEPS 8\n\n#define LOD_COLOR 7.0\n#define LOD_DEPTH 5.0\n\nuniform int uDrawOpaque;\nuniform float uFrameModTaaSS;\nuniform float uQuality;\nuniform float uSsrFactor;\n\nuniform sampler2D uTextureToBeRefracted;\nuniform sampler2D uTextureMipmapDepth;\n\nuniform vec2 uTextureToBeRefractedSize;\nuniform vec2 uPreviousGlobalTexRatio;\nuniform vec2 uPreviousGlobalTexSize;\nuniform vec2 uNearFar;\nuniform vec2 uGlobalTexRatio;\nuniform vec4 uTaaCornersCSLeft[2];\n\nuniform mat4 uProjectionMatrix;\nuniform mat4 uReprojectViewProj;\nuniform mat4 uPreviousViewInvView;\nuniform mat4 uPreviousProjection; // DEPTH_MIPMAP\n\nvec3 computeLodNearestPixelSizePowLevel(const in float lodLevelIn, const in float maxLod, const in vec2 size) {\n    float lodLevel = min(maxLod - 0.01, lodLevelIn);\n    float lowerLevel = floor(lodLevel);\n    float higherLevel = min(maxLod, lowerLevel + 1.0);\n\n    float powLevel = pow(2.0, higherLevel);\n    vec2 pixelSize = 2.0 * powLevel / size;\n\n    if (lodLevel - lowerLevel > 0.5) powLevel *= 2.0;\n    return vec3(pixelSize, powLevel);\n}\n\n// lerping between 2 mipmap is too costly (with no notable quality gain in the end)\nvec2 computeLodUVNearest(const in vec2 uvIn, const in vec3 pixelSizePowLevel) {\n    // border pixel issue with bilinear...\n    vec2 uv = max(pixelSizePowLevel.xy, min(1.0 - pixelSizePowLevel.xy, uvIn));\n    return vec2(2.0 * uv.x, pixelSizePowLevel.z - 1.0 - uv.y) / pixelSizePowLevel.z;\n}\n\nfloat fetchDepthLod(const in vec2 uv, const in vec3 pixelSizePowLevel) {\n#ifdef DEPTH_MIPMAP\n    vec2 uvNearest = computeLodUVNearest(uv, pixelSizePowLevel);\n    float depth =  decodeDepth(texture2D(uTextureMipmapDepth, uvNearest * uPreviousGlobalTexRatio));\n#else\n    float depth = decodeDepth(texture2D(uTextureMipmapDepth, uv * uGlobalTexRatio));\n#endif\n\n    if (depth >= 1.0) return -uNearFar.y * 100.0; // very far so it won\'t reflect background\n    return -uNearFar.x - depth * (uNearFar.y - uNearFar.x);\n}\n\nvec4 fetchDepthLod(const in vec4 uv0, const in vec4 uv1, const in vec3 pixelSizePowLevel) {\n    vec4 result = vec4(0.0);\n    result.x = fetchDepthLod(uv0.xy, pixelSizePowLevel);\n    result.y = fetchDepthLod(uv0.zw, pixelSizePowLevel);\n    result.z = fetchDepthLod(uv1.xy, pixelSizePowLevel);\n    result.w = fetchDepthLod(uv1.zw, pixelSizePowLevel);\n    return result;\n}\n\nvec3 ssrViewToScreen(const in mat4 projection, const in vec3 viewVertex) {\n    vec4 projected = projection * vec4(viewVertex, 1.0);\n    return vec3(0.5 + 0.5 * projected.xy / projected.w, projected.w);\n}\n\nvec3 fetchColorLod(const in float level, const in vec2 uv) {\n    vec3 pixelSizePowLevel = computeLodNearestPixelSizePowLevel(LOD_COLOR * level, LOD_COLOR, uPreviousGlobalTexSize); \n    vec2 uvNearest = computeLodUVNearest(uv, pixelSizePowLevel);\n    return decodeRGBM(texture2D(uTextureToBeRefracted, uvNearest * uPreviousGlobalTexRatio), 7.0);\n}\n\n// #define HASHSCALE1 .1031\n// #define HASHSCALE3 vec3(.1031, .1030, .0973)\n// #define HASHSCALE4 vec4(.1031, .1030, .0973, .1099)\n\n// vec2 hash23(vec3 p3)\n// {\n//     p3 = fract(p3 * HASHSCALE3);\n//     p3 += dot(p3, p3.yzx + 19.19);\n//     return fract((p3.xx + p3.yz) * p3.zy);\n// }\n\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Private/ScreenSpaceReflections.usf#L143\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Private/MonteCarlo.ush#L169\nvec3 unrealImportanceSampling(const in float frameMod, const in vec3 tangentX, const in vec3 tangentY, const in vec3 tangentZ, const in vec3 eyeVector, const in float rough4) {\n    vec2 E;\n\n    // could be improved (visible patterns)\n    E.x = interleavedGradientNoise(gl_FragCoord.yx, frameMod);\n    E.y = fract(E.x * 52.9829189);\n    // E = hash23(vec3(gl_FragCoord.xy + frameMod * 150.2420, frameMod * 100.0));\n\n    // Reduces BRDF tail is noisy, we clamp it\n    // https://www.slideshare.net/DICEStudio/stochastic-screenspace-reflections#p=67\n    E.y = mix(E.y, 1.0, 0.7);\n\n    float phi = 2.0 * 3.14159 * E.x;\n    // float cosTheta = sqrt((1.0 - E.y) / (1.0 + (rough4 - 1.0) * E.y)); // ggx (long tail, more noisy)\n    float cosTheta = pow(max(E.y, 0.000001), rough4 / (2.0 - rough4)); // blinn\n    float sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n\n    vec3 h = vec3(sinTheta * cos(phi), sinTheta * sin(phi), cosTheta);\n    h = h.x * tangentX + h.y * tangentY + h.z * tangentZ;\n    return normalize((2.0 * dot(eyeVector, h)) * h - eyeVector);\n}\n\nfloat getStepOffset(const in float frameMod) {\n    return (interleavedGradientNoise(gl_FragCoord.xy, frameMod) - 0.5);\n}\n\nvec3 computeRayDirUV(const in vec3 rayOriginUV, const in float rayLen, const in vec3 rayDirView) {\n#ifdef DEPTH_MIPMAP\n    vec3 rayDirUV = ssrViewToScreen(uPreviousProjection, vViewVertex.xyz + rayDirView * rayLen);\n#else\n    vec3 rayDirUV = ssrViewToScreen(uProjectionMatrix, vViewVertex.xyz + rayDirView * rayLen);\n#endif\n\n    rayDirUV.z = 1.0 / rayDirUV.z;\n    rayDirUV -= rayOriginUV;\n\n    // clip the line to the viewport edges\n    // https://github.com/godotengine/godot/blob/master/drivers/gles3/shaders/screen_space_reflection.glsl#L124\n    float scaleMaxX = min(1.0, 0.99 * (1.0 - rayOriginUV.x) / max(1e-5, rayDirUV.x));\n    float scaleMaxY = min(1.0, 0.99 * (1.0 - rayOriginUV.y) / max(1e-5, rayDirUV.y));\n    float scaleMinX = min(1.0, 0.99 * rayOriginUV.x / max(1e-5, -rayDirUV.x));\n    float scaleMinY = min(1.0, 0.99 * rayOriginUV.y / max(1e-5, -rayDirUV.y));\n    return rayDirUV * min(scaleMaxX, scaleMaxY) * min(scaleMinX, scaleMinY);\n}\n\n#define SSR_RAY_FETCH(void) \\\nsampleUV = rayOriginUV + rayDirUV * diffSampleW.y; \\\ndepth = fetchDepthLod(sampleUV.xy, pixelSizePowLevel); \\\ndepthDiff = -1.0 / sampleUV.z - depth; \\\nhit = abs(depthDiff + depthTolerance) < depthTolerance; \\\ntimeLerp = clamp(diffSampleW.x / (diffSampleW.x - depthDiff), 0.0, 1.0); \\\nhitTime = hit ? (diffSampleW.y + timeLerp * invNumSteps - invNumSteps) : 1.0; \\\ndiffSampleW.z = min(diffSampleW.z, hitTime); \\\ndiffSampleW.x = depthDiff; \\\ndiffSampleW.y += invNumSteps; \\\n\n#define SSR_RAY_UNROLLED(void) \\\nSSR_RAY_FETCH() \\\nSSR_RAY_FETCH() \\\nSSR_RAY_FETCH() \\\nSSR_RAY_FETCH() \\\nSSR_RAY_FETCH() \\\nSSR_RAY_FETCH() \\\nSSR_RAY_FETCH() \\\nSSR_RAY_FETCH() \\\n\nvec4 rayTraceUnrealSimple(\n    const in vec3 rayOriginUV,\n    const in float rayLen,\n    in float depthTolerance,\n    const in vec3 rayDirView,\n\n    const in float roughness,\n    const in float frameMod) {\n\n    vec3 pixelSizePowLevel = computeLodNearestPixelSizePowLevel(LOD_DEPTH * roughness, LOD_DEPTH, uTextureToBeRefractedSize); \n\n    float invNumSteps = 1.0 / float(SSR_STEPS);\n    if (uQuality > 1.0) invNumSteps /= 2.0;\n\n    depthTolerance *= invNumSteps;\n\n    vec3 rayDirUV = computeRayDirUV(rayOriginUV, rayLen, rayDirView);\n\n    float sampleTime = getStepOffset(frameMod) * invNumSteps + invNumSteps;\n    vec3 diffSampleW = vec3(0.0, sampleTime, 1.0);\n\n    vec3 sampleUV;\n    float depth, depthDiff, timeLerp, hitTime;\n    bool hit;\n\n    SSR_RAY_UNROLLED()\n    if (uQuality > 1.0) { SSR_RAY_UNROLLED() }\n\n    // alternative : ray refinement around the intersected cell\n    // if (uQuality > 1.0) {\n    //     rayOriginUV = rayOriginUV + rayDirUV * diffSampleW.z - rayDirUV * invNumSteps * 0.5;\n    //     diffSampleW = vec3(0.0, sampleTime, 1.0);\n    //     rayDirUV *= invNumSteps;\n    //     depthTolerance *= invNumSteps;\n    //     SSR_RAY_UNROLLED()\n    // }\n\n    return vec4(rayOriginUV + rayDirUV * diffSampleW.z, 1.0 - diffSampleW.z);\n}\n\nvec4 fetchColorContribution(\n    in vec4 resRay,\n    const in float maskSsr,\n    const in vec3 specularEnvironment,\n    const in vec3 specularColor,\n    const in float roughness) {\n\n    // reprojection\n    vec4 AB = mix(uTaaCornersCSLeft[0], uTaaCornersCSLeft[1], resRay.x);\n    resRay.xyz = vec3(mix(AB.xy, AB.zw, resRay.y), 1.0) * -1.0 / resRay.z;\n    resRay.xyz = (uReprojectViewProj * vec4(resRay.xyz, 1.0)).xyw;\n    resRay.xy /= resRay.z;\n\n    // fade edge of screen\n    float maskEdge = clamp(6.0 - 6.0 * max(abs(resRay.x), abs(resRay.y)), 0.0, 1.0);\n\n    resRay.xy = 0.5 + 0.5 * resRay.xy;\n\n    vec3 fetchColor = specularColor * fetchColorLod(roughness * (1.0 - resRay.w), resRay.xy);\n\n    // fade ray count\n    // maskEdge *= resRay.w;\n\n    return vec4(mix(specularEnvironment, fetchColor, maskSsr * maskEdge), 1.0);\n}\n\nvec3 ssr(const in vec3 specularEnvironment, const in vec3 specularColor, const in float roughness, const in vec3 normal, const in vec3 eyeVector) {\n\n#if (defined(HAS_OPACITY_BLEND_OR_ADDITIVE) || defined(HAS_OPACITY_REFRACTION)) && !defined(HAS_SSR_TRANSPARENT)\n    // no ssr for transparent pxiels for now (mainly performance reason)\n    if (uDrawOpaque == 0) return specularEnvironment;\n#endif\n\n    vec4 result = vec4(0.0);\n\n    // precompute importance sampling roughness^4\n    float rough4 = roughness * roughness;\n    rough4 = rough4 * rough4;\n\n    // precompute importance sampling basis tangent\n    vec3 upVector = abs(normal.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\n    vec3 tangentX = normalize(cross(upVector, normal));\n    vec3 tangentY = cross(normal, tangentX);\n\n    // fade ray that points toward camera\n    float maskSsr = uSsrFactor * clamp(-4.0 * dot(eyeVector, normal) + 3.8, 0.0, 1.0);\n    maskSsr *= clamp(4.7 - roughness * 5.0, 0.0, 1.0); // fade out ssr for high roughness values\n\n    // compute ray uv origin\n    vec3 rayOriginUV = ssrViewToScreen(uProjectionMatrix, vViewVertex.xyz);\n    rayOriginUV.z = 1.0 / rayOriginUV.z;\n\n    // direction of reflection\n    vec3 rayDirView = unrealImportanceSampling(uFrameModTaaSS, tangentX, tangentY, normal, eyeVector, rough4);\n\n    // if reflection is toward us, we cast [near, vertex], otherwise [vertex, far]\n    float rayLen = mix(uNearFar.y + vViewVertex.z, -vViewVertex.z - uNearFar.x, rayDirView.z * 0.5 + 0.5);\n    float depthTolerance = 0.5 * rayLen;\n\n    // ray under the surface (normalmap or inverted normal)\n    if (dot(rayDirView, normal) > 0.001 && maskSsr > 0.0) {\n        vec4 resRay = rayTraceUnrealSimple(rayOriginUV, rayLen, depthTolerance, rayDirView, roughness, uFrameModTaaSS);\n        if (resRay.w > 0.0) result += fetchColorContribution(resRay, maskSsr, specularEnvironment, specularColor, roughness);\n    }\n\n    // if (uQuality > 0.4) {\n    //     for (int i = 1; i < 4; ++i) {\n    //         float frameRay = frameMod + float(i) * 50.0;\n    //         rayDirView = unrealImportanceSampling(frameRay, tangentX, tangentY, normal, eyeVector, rough4);\n    //         rayLen = mix(uNearFar.y + vViewVertex.z, -vViewVertex.z - uNearFar.x, rayDirView.z * 0.5 + 0.5);\n    //         depthTolerance = 0.5 * rayLen;\n\n    //         if (dot(rayDirView, normal) > 0.001) {\n    //             vec4 resRay = rayTraceUnrealSimple(rayOriginUV, rayLen, depthTolerance, rayDirView, roughness, frameRay);\n    //             if (resRay.w > 0.0) result += fetchColorContribution(resRay, maskSsr, specularEnvironment, specularColor, roughness);\n    //         }\n    //     }\n    // }\n\n    return result.w > 0.0 ? result.rgb / result.w : specularEnvironment;\n}\n'
}, function (e, t) {
    e.exports = '#define MIN_ROUGHNESS 0.045\n\n#pragma include "utils/functions.glsl"\n\n#ifdef HAS_OPACITY_REFRACTION\n    float gRefractionRoughness; // global variable (simpler to handle in order to re-use rough/gloss fetch)\n#endif\n\n#ifdef HAS_VERTEX_COLOR\n    varying vec4 vColor;\n\n    vec3 getVertexColor() {\n        return COLOR_CONVERT_VERTEX_COLOR(vColor.rgb);\n    }\n#endif\n\n// METALNESS WORKFLOW\n#ifdef HAS_ALBEDOPBR\n    uniform float uAlbedoPBRFactor;\n    \n    vec3 getMaterialAlbedo() {\n        vec3 albedo;\n        #ifdef SAMPLER_ALBEDOPBR\n            albedo = uAlbedoPBRFactor * COLOR_CONVERT_ALBEDOPBR(texture2D(SAMPLER_ALBEDOPBR, UV_ALBEDOPBR).PACK_ALBEDOPBR);\n        #else\n            albedo = vec3(uAlbedoPBRFactor);\n        #endif\n\n        #ifdef HAS_VERTEX_COLOR\n            albedo *= getVertexColor();\n        #endif\n\n        return albedo;\n    }\n#endif\n\n#ifdef HAS_METALNESSPBR\n    uniform float uMetalnessPBRFactor;\n    \n    float getMaterialMetalness() {\n        #ifdef SAMPLER_METALNESSPBR\n            return uMetalnessPBRFactor * COLOR_CONVERT_METALNESSPBR(texture2D(SAMPLER_METALNESSPBR, UV_METALNESSPBR).PACK_METALNESSPBR);\n        #else\n            return uMetalnessPBRFactor;\n        #endif\n    }\n#endif\n\n#ifdef HAS_SPECULARF0\n    uniform float uSpecularF0Factor;\n    \n    float getMaterialF0() {\n        #ifdef SAMPLER_SPECULARF0\n            return uSpecularF0Factor * COLOR_CONVERT_SPECULARF0(texture2D(SAMPLER_SPECULARF0, UV_SPECULARF0).PACK_SPECULARF0);\n        #else\n            return uSpecularF0Factor;\n        #endif\n    }\n#endif\n\n// SPECULAR WORKFLOW\n#ifdef HAS_DIFFUSEPBR\n    uniform float uDiffusePBRFactor;\n    \n    vec3 getMaterialDiffuse() {\n        vec3 diffuse;\n        #ifdef SAMPLER_DIFFUSEPBR\n            diffuse = uDiffusePBRFactor * COLOR_CONVERT_DIFFUSEPBR(texture2D(SAMPLER_DIFFUSEPBR, UV_DIFFUSEPBR).PACK_DIFFUSEPBR);\n        #else\n            diffuse = vec3(uDiffusePBRFactor);\n        #endif\n\n        #ifdef HAS_VERTEX_COLOR\n            diffuse *= getVertexColor();\n        #endif\n\n        return diffuse;\n    }\n#endif\n\n#ifdef HAS_SPECULARPBR\n    uniform float uSpecularPBRFactor;\n    \n    vec3 getMaterialSpecular() {\n        #ifdef SAMPLER_SPECULARPBR\n            return uSpecularPBRFactor * COLOR_CONVERT_SPECULARPBR(texture2D(SAMPLER_SPECULARPBR, UV_SPECULARPBR).PACK_SPECULARPBR);\n        #else\n            return vec3(uSpecularPBRFactor);\n        #endif\n    }\n#endif\n\n// MICROSURFACE\n#ifdef HAS_ROUGHNESSPBR\n    uniform float uRoughnessPBRFactor;\n    \n    float getMaterialRoughness() {\n        #ifdef SAMPLER_ROUGHNESSPBR\n            float fetch = COLOR_CONVERT_ROUGHNESSPBR(texture2D(SAMPLER_ROUGHNESSPBR, UV_ROUGHNESSPBR).PACK_ROUGHNESSPBR);\n\n            #ifdef HAS_REFRACTION_MICROSURFACE\n                gRefractionRoughness *= fetch;\n            #endif\n\n            return uRoughnessPBRFactor * fetch;\n        #else\n            return uRoughnessPBRFactor;\n        #endif\n    }\n#endif\n\n#ifdef HAS_GLOSSINESSPBR\n    uniform float uGlossinessPBRFactor;\n    \n    float getMaterialGlossiness() {\n        #ifdef SAMPLER_GLOSSINESSPBR\n            float fetch = COLOR_CONVERT_GLOSSINESSPBR(texture2D(SAMPLER_GLOSSINESSPBR, UV_GLOSSINESSPBR).PACK_GLOSSINESSPBR);\n\n            #ifdef HAS_REFRACTION_MICROSURFACE\n                gRefractionRoughness = mix(1.0 - fetch, 1.0, gRefractionRoughness);\n            #endif\n\n            return uGlossinessPBRFactor * fetch;\n        #else\n            return uGlossinessPBRFactor;\n        #endif\n    }\n#endif\n\n\n#ifdef HAS_EMITCOLOR\n    uniform float uEmitColorFactor;\n    uniform int uEmitMultiplicative;\n\n    vec3 getMaterialEmitColor() {\n        #ifdef SAMPLER_EMITCOLOR\n            return uEmitColorFactor * COLOR_CONVERT_EMITCOLOR(texture2D(SAMPLER_EMITCOLOR, UV_EMITCOLOR).PACK_EMITCOLOR);\n        #else\n            return vec3(0.0);\n        #endif\n    }\n#endif\n\n#ifdef HAS_AOPBR\n    uniform float uAOPBRFactor;\n    uniform int uAOPBROccludeSpecular;\n\n    float getMaterialAO() {\n        return mix(1.0, COLOR_CONVERT_AOPBR(texture2D(SAMPLER_AOPBR, UV_AOPBR).PACK_AOPBR), uAOPBRFactor);\n    }\n#endif\n\n#ifdef HAS_CAVITYPBR\n    uniform float uCavityPBRFactor;\n\n    float getMaterialCavity() {\n        return mix(1.0, COLOR_CONVERT_CAVITYPBR(texture2D(SAMPLER_CAVITYPBR, UV_CAVITYPBR).PACK_CAVITYPBR), uCavityPBRFactor);\n    }\n#endif\n\n#ifdef HAS_SUBSURFACETRANSLUCENCY\n    uniform float uSubsurfaceTranslucencyFactor;\n    uniform float uSubsurfaceTranslucencyThicknessFactor;\n    uniform vec3 uSubsurfaceTranslucencyColor;\n    \n    float getMaterialTranslucency() {\n        #ifdef SAMPLER_SUBSURFACETRANSLUCENCY\n            return uSubsurfaceTranslucencyFactor * COLOR_CONVERT_SUBSURFACETRANSLUCENCY(texture2D(SAMPLER_SUBSURFACETRANSLUCENCY, UV_SUBSURFACETRANSLUCENCY).PACK_SUBSURFACETRANSLUCENCY);\n        #else\n            return uSubsurfaceTranslucencyFactor;\n        #endif\n    }\n#endif\n\n#ifdef HAS_NORMALMAP\n    uniform float uNormalMapFactor;\n    uniform int uNormalMapFlipY;\n\n    vec3 getMaterialNormalMap() {\n        vec3 nmap = COLOR_CONVERT_NORMALMAP(texture2D(SAMPLER_NORMALMAP, UV_NORMALMAP).PACK_NORMALMAP) * 2.0 - 1.0;\n        nmap.y = uNormalMapFlipY == 1 ? -nmap.y : nmap.y;\n        return nmap;\n    }\n#endif\n\n#ifdef HAS_BUMPMAP\n    uniform float uBumpMapFactor;\n    uniform vec2 uBumpMapSize;\n\n    vec2 getMaterialBumpMap() {\n        vec2 bump;\n        vec3 invSize = vec3(1.0 / uBumpMapSize, 0.0);\n        return uBumpMapFactor * vec2(COLOR_CONVERT_BUMPMAP(texture2D(SAMPLER_BUMPMAP, UV_BUMPMAP - invSize.xz).PACK_BUMPMAP)\n                                    - COLOR_CONVERT_BUMPMAP(texture2D(SAMPLER_BUMPMAP, UV_BUMPMAP + invSize.xz).PACK_BUMPMAP),\n                                    COLOR_CONVERT_BUMPMAP(texture2D(SAMPLER_BUMPMAP, UV_BUMPMAP - invSize.zy).PACK_BUMPMAP)\n                                    -COLOR_CONVERT_BUMPMAP(texture2D(SAMPLER_BUMPMAP, UV_BUMPMAP + invSize.zy).PACK_BUMPMAP));\n    }\n#endif\n\n#ifdef HAS_SUBSURFACESCATTERING\n    uniform float uSubsurfaceScatteringProfile;\n    uniform float uSubsurfaceScatteringFactor;\n    uniform float uScatteringFactorPacker;\n    \n    float getMaterialScattering() {\n        #ifdef SAMPLER_SUBSURFACESCATTERING\n            return uScatteringFactorPacker * uSubsurfaceScatteringFactor * COLOR_CONVERT_SUBSURFACESCATTERING(texture2D(SAMPLER_SUBSURFACESCATTERING, UV_SUBSURFACESCATTERING).PACK_SUBSURFACESCATTERING);\n        #else\n            return uScatteringFactorPacker * uSubsurfaceScatteringFactor;\n        #endif\n    }\n#endif\n\n#ifdef HAS_OPACITY\n    uniform float uOpacityFactor;\n    uniform int uOpacityInvert;\n\n    #ifdef HAS_OPACITY_MASK_OR_DITHER\n        uniform float uOpacityThinLayer;\n        uniform int uOpacityDithering;\n    #endif\n\n    #ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n        uniform int uOpacityAdditive;\n    #endif\n\n    #ifdef HAS_OPACITY_REFRACTION\n        uniform float uOpacityRoughnessFactor;\n    #endif\n\n    float getMaterialOpacity() {\n        float alpha = 1.0;\n    \n        #ifdef SAMPLER_OPACITY\n            alpha = COLOR_CONVERT_OPACITY(texture2D(SAMPLER_OPACITY, UV_OPACITY).PACK_OPACITY);\n            if (uOpacityInvert == 1) alpha = 1.0 - alpha;\n        #endif\n\n        #ifndef HAS_OPACITY_MASK_OR_DITHER\n            alpha *= uOpacityFactor;\n        #endif\n\n        #ifdef HAS_VERTEX_ALPHA\n            alpha *= vColor.a;\n        #endif\n\n        return alpha;\n    }\n#endif // HAS_OPACITY\n\n\n#ifdef HAS_CLEARCOAT\n    uniform vec3 uClearCoatTint;\n    uniform float uClearCoatThickness;\n    uniform float uClearCoatIor;\n    uniform float uClearCoatFactor;\n    uniform float uClearCoatF0;\n    \n    float getMaterialClearCoat() {\n        #ifdef SAMPLER_CLEARCOAT\n            return uClearCoatFactor * COLOR_CONVERT_CLEARCOAT(texture2D(SAMPLER_CLEARCOAT, UV_CLEARCOAT).PACK_CLEARCOAT);\n        #else\n            return uClearCoatFactor;\n        #endif\n    }\n#endif\n\n#ifdef HAS_CLEARCOATROUGHNESS\n    uniform float uClearCoatRoughnessFactor;\n    \n    float getMaterialClearCoatRoughness() {\n        #ifdef SAMPLER_CLEARCOATROUGHNESS\n            return uClearCoatRoughnessFactor * COLOR_CONVERT_CLEARCOATROUGHNESS(texture2D(SAMPLER_CLEARCOATROUGHNESS, UV_CLEARCOATROUGHNESS).PACK_CLEARCOATROUGHNESS);\n        #else\n            return uClearCoatRoughnessFactor;\n        #endif\n    }\n#endif\n\n#ifdef HAS_CLEARCOATNORMALMAP\n    uniform float uClearCoatNormalMapFactor;\n    uniform int uClearCoatNormalMapFlipY;\n    \n    vec3 getMaterialClearCoatNormal() {\n        vec3 nmap = COLOR_CONVERT_CLEARCOATNORMALMAP(texture2D(SAMPLER_CLEARCOATNORMALMAP, UV_CLEARCOATNORMALMAP).PACK_CLEARCOATNORMALMAP) * 2.0 - 1.0;\n        nmap.y = uClearCoatNormalMapFlipY == 1 ? -nmap.y : nmap.y;\n        return nmap;\n    }\n#endif\n\n/////////////////\n// LEGACY CLASSIC\n/////////////////\n#ifdef HAS_LEGACY_CLASSIC\n    uniform vec2 uTextureEnvironmentSpecularTextureSize;\n    uniform samplerCube sEnvironmentSpecular;\n    uniform mat3 uEnvironmentTransform;\n\n    uniform float uReflection;\n\n    uniform float uDiffuseColorFactor;\n    uniform float uDiffuseIntensityFactor;\n        vec3 getMaterialLegacyDiffuse() {\n        vec3 diffuse = vec3(0.0);\n        #if defined(SAMPLER_DIFFUSECOLOR)\n            diffuse = uDiffuseColorFactor * COLOR_CONVERT_DIFFUSECOLOR(texture2D(SAMPLER_DIFFUSECOLOR, UV_DIFFUSECOLOR).PACK_DIFFUSECOLOR);\n        #elif defined(HAS_DIFFUSECOLOR)\n            diffuse = vec3(uDiffuseColorFactor);\n        #endif\n\n        #ifdef HAS_VERTEX_COLOR\n            diffuse *= getVertexColor();\n        #endif\n\n        #ifdef HAS_DIFFUSEINTENSITY\n            #ifdef SAMPLER_DIFFUSEINTENSITY\n                diffuse *= uDiffuseIntensityFactor * COLOR_CONVERT_DIFFUSEINTENSITY(texture2D(SAMPLER_DIFFUSEINTENSITY, UV_DIFFUSEINTENSITY).PACK_DIFFUSEINTENSITY);\n            #else\n                diffuse *= uDiffuseIntensityFactor;\n            #endif\n        #endif\n\n        return diffuse;\n    }\n\n    uniform float uSpecularColorFactor;\n        vec3 getMaterialLegacySpecular() {\n        #if defined(SAMPLER_SPECULARCOLOR)\n            return uSpecularColorFactor * COLOR_CONVERT_SPECULARCOLOR(texture2D(SAMPLER_SPECULARCOLOR, UV_SPECULARCOLOR).PACK_SPECULARCOLOR);\n        #elif defined(HAS_SPECULARCOLOR)\n            return vec3(uSpecularColorFactor);\n        #else\n            return vec3(0.0);\n        #endif\n    }\n\n    uniform float uSpecularHardnessFactor;\n    float getMaterialLegacyShininess() {\n        #if defined(SAMPLER_SPECULARHARDNESS)\n            return uSpecularHardnessFactor * COLOR_CONVERT_SPECULARHARDNESS(texture2D(SAMPLER_SPECULARHARDNESS, UV_SPECULARHARDNESS).PACK_SPECULARHARDNESS);\n        #elif defined(HAS_SPECULARHARDNESS)\n            return uSpecularHardnessFactor;\n        #else\n            return 0.0;\n        #endif\n    }\n\n#endif'
}, function (e, t) {
    e.exports = "// version for vertex shader\nvec3 bumpMap(const in vec4 tangent, const in vec3 normal, const in vec2 gradient) {\n    vec3 tang =  normalize(tangent.xyz);\n    vec3 binormal = tangent.w * normalize(cross(normal, tang));\n    return normalize(normal + gradient.x * tang + gradient.y * binormal);\n}\n\n// #define transformNormal(f, tn, tex, b, n) n = f * n.xy; n = normalize(tex.x * t.xyz + tex.y * b + tex.z * n)\nvec3 transformNormal(const in float factor, in vec3 normal, const in vec3 t, const in vec3 b, in vec3 n) {\n    normal.xy = factor * normal.xy;\n    return normalize(normal.x * t + normal.y * b + normal.z * n);\n}\n\n// #define transformBump(tex, t, b, n) n = normalize(tex.x * t.xyz + tex.y * b + n)\nvec3 transformBump(in vec2 bump, const in vec3 t, const in vec3 b, in vec3 n) {\n    return normalize(bump.x * t + bump.y * b + n);\n}\n"
}, function (e, t) {
    e.exports = "float checkerboard(const in vec2 uv, const in vec4 halton) {\n    return mod(step(halton.z, 0.0) + floor(uv.x) + floor(uv.y), 2.0);\n}\n"
}, function (e, t) {
    e.exports = "int decodeProfile(const in vec4 pack) {\n    float packValue = floor(pack.b * 255.0 + 0.5);\n    // we extract the 2 lowest bits\n    float profile = mod(packValue, 2.0);\n    profile += mod(packValue - profile, 4.0);\n    return int(profile);\n}\n\nfloat decodeDepth(const in vec4 pack) {\n    if(decodeProfile(pack) == 0){\n        const vec3 decode = 1.0 / vec3(1.0, 255.0, 65025.0);\n        return dot(pack.rgb, decode);\n    }\n\n    return pack.r + pack.g / 255.0;\n}\n\nfloat decodeScatter(const in vec4 pack) {\n    float scatter = pack.b - mod(pack.b, 4.0 / 255.0);\n    return scatter * 255.0 / 4.0 / 63.0;\n}\n\nfloat decodeAlpha(const in vec4 pack) {\n    return pack.a;\n}\n\nfloat distanceToDepth(const in sampler2D depth, const in vec2 uv, const in vec4 viewPos, const vec2 nearFar) {\n    float fragDepth = clamp( (-viewPos.z * viewPos.w - nearFar.x) / (nearFar.y - nearFar.x), 0.0, 1.0);\n    return fragDepth - decodeDepth(texture2D(depth, uv));\n}\n"
}, function (e, t) {
    e.exports = "// random links on packing :\n// cesium attributes packing\n// https://cesiumjs.org/2015/05/18/Vertex-Compression/\n\n// float packing in 24 bits or 32 bits\n// https://skytiger.wordpress.com/2010/12/01/packing-depth-into-color/\n\nvec4 encodeDepthAlphaProfileScatter(const in float depth, const in float alpha, const in float profile, const in float scatter) {\n    vec4 pack = vec4(0.0);\n\n    // opacity in alpha\n    pack.a = alpha;\n\n    if(profile == 0.0) {\n        const vec3 code = vec3(1.0, 255.0, 65025.0);\n        pack.rgb = vec3(code * depth);\n        pack.gb = fract(pack.gb);\n        pack.rg -= pack.gb * (1.0 / 256.0);\n    } else {\n        // depth in rg\n        pack.g = fract(depth * 255.0);\n        pack.r = depth - pack.g / 255.0;\n\n        // scatter 6 bits\n        pack.b = floor(0.5 + scatter * 63.0) * 4.0 / 255.0;\n    }\n\n    // profile on 2 lower bits\n    pack.b -= mod(pack.b, 4.0 / 255.0);\n    pack.b += profile / 255.0; // 3 profile possible for sss\n\n    return pack;\n}\n"
}, function (e, t) {
    e.exports = "vec3 encode24(const in float x){\n    const vec3 code = vec3(1.0, 255.0, 65025.0);\n    vec3 pack = vec3(code * x);\n    pack.gb = fract(pack.gb);\n    pack.rg -= pack.gb * (1.0 / 256.0);\n    return pack;\n}\n\nfloat decode24(const in vec3 x) {\n    const vec3 decode = 1.0 / vec3(1.0, 255.0, 65025.0);\n    return dot(x, decode);\n}\n"
}, function (e, t) {
    e.exports = "float getLuminance(const in vec3 color) {\n    // http://stackoverflow.com/questions/596216/formula-to-determine-brightness-of-rgb-color\n    const vec3 colorBright = vec3(0.2126, 0.7152, 0.0722);\n    return dot(color, colorBright);\n}\n"
}, function (e, t) {
    e.exports = 'uniform float uDisplay2D;\nuniform float uPointSize;\n\nuniform vec2 uGlobalTexRatio;\nuniform vec2 uGlobalTexSize;\nuniform vec4 uHalton;\n\nuniform mat3 uModelNormalMatrix;\nuniform mat3 uModelViewNormalMatrix;\n\nuniform mat4 uProjectionMatrix;\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uModelViewMatrix;\n\n// in case of srgbToLinear texfetch\n#ifdef HAS_DISPLACEMENT\n#pragma include "utils/functions.glsl"\n#endif\n\n#ifdef IS_IOS\ninvariant gl_Position;\n#endif\n\n\n#if defined(HAS_COMPRESSION) && !defined(HAS_MORPHING)\n    #define HAS_POSITION_COMPRESSION\n#endif\n\n/////////////////////////////////////\n// ATTRIBUTES (NORMAL/VERTEX/TANGENT)\n/////////////////////////////////////\n\n#ifdef HAS_ZW_COMPRESSION\n    attribute vec4 Vertex;\n#else\n    attribute vec3 Vertex;\n#endif\n\n// need normal to displace vertex\n#if defined(HAS_VIEW_NORMAL) || defined(HAS_MODEL_NORMAL) || defined(HAS_SKETCHFAB_DISPLACEMENT)\n\n    #ifdef HAS_POSITION_COMPRESSION\n        attribute vec2 Normal;\n    #else\n        attribute vec3 Normal;\n    #endif\n\n    #define NEED_LOCAL_NORMAL\n#endif\n\n// if no normalmap, correct the normal with displacement (as bump)\n#if defined(HAS_DISPLACEMENT) && !defined(HAS_NORMALMAP) && (defined(HAS_MODEL_NORMAL) || defined(HAS_VIEW_NORMAL))\n    #define CORRECT_BUMP_NORMAL\n#endif\n\n// need tangent to correct normal\n#if defined(HAS_VIEW_TANGENT) || defined(HAS_MODEL_TANGENT) || defined(CORRECT_BUMP_NORMAL)\n\n    #ifdef HAS_POSITION_COMPRESSION\n        attribute vec3 Tangent;\n    #else\n        attribute vec4 Tangent;\n    #endif\n\n    #define NEED_LOCAL_TANGENT\n#endif\n\n#ifdef HAS_VERTEX_COLOR\n    attribute vec4 Color;\n#endif\n\n////////////////////\n// VARYING/VARIABLES\n////////////////////\n\n// view\n#ifdef HAS_VIEW_VERTEX\n    varying vec4 vViewVertex;\n#else\n    vec4 vViewVertex;\n#endif\n\n#ifdef HAS_VIEW_NORMAL\n    varying vec3 vViewNormal;\n#endif\n\n#ifdef HAS_VIEW_TANGENT\n    varying vec4 vViewTangent;\n#endif\n\n// model\n#if defined(HAS_MODEL_VERTEX)\n    varying vec3 vModelVertex;\n#elif defined(HAS_DISPLACEMENT)\n    vec3 vModelVertex;\n#endif\n\n#if defined(HAS_MODEL_NORMAL)\n    varying vec3 vModelNormal;\n#elif defined(HAS_SKETCHFAB_DISPLACEMENT)\n    vec3 vModelNormal;\n#endif\n\n#if defined(HAS_MODEL_TANGENT)\n    varying vec3 vModelTangent;\n#endif\n\n#ifdef HAS_VERTEX_COLOR\n    varying vec4 vColor;\n    uniform float uArrayColorEnabled;\n#endif\n\n////////////\n// ANIMATION\n////////////\n\n#ifdef HAS_MORPHING\n    uniform vec4 uTargetWeights;\n\n%UNROLL 4%\n    #if NUM_TARGETS > %ID%\n        attribute vec3 Vertex_%ID%;\n        #define ARG_MORPH_VERTEX_%ID% , Vertex_%ID%\n\n        #ifdef HAS_MORPHING_NORMAL\n            attribute vec3 Normal_%ID%;\n            #define ARG_MORPH_NORMAL_%ID% , Normal_%ID%\n        #endif\n\n        #ifdef HAS_MORPHING_TANGENT\n            attribute vec3 Tangent_%ID%;\n            #define ARG_MORPH_TANGENT_%ID% , Tangent_%ID%.xyz\n        #endif\n    #else\n        #define ARG_MORPH_VERTEX_%ID%\n        #define ARG_MORPH_NORMAL_%ID%\n        #define ARG_MORPH_TANGENT_%ID%\n    #endif\n%%\n\n    #pragma include "utils/morphing.glsl"\n#endif\n\n#ifdef HAS_SKINNING\n    #ifndef NUM_BONES\n        #define NUM_BONES 1\n    #endif\n\n    attribute vec4 Bones;\n    attribute vec4 Weights;\n    uniform vec4 uBones[NUM_BONES];\n\n    #pragma include "utils/skinning.glsl"\n#endif\n\n#ifdef HAS_DISPLACEMENT\n    uniform float uDisplacementFactor;\n#endif\n\n#ifdef CORRECT_BUMP_NORMAL\n    uniform float uDisplacementNormal;\n    uniform vec2 uDisplacementSize;\n    #pragma include "utils/normalBump.glsl"\n#endif\n\n#ifdef HAS_POSITION_COMPRESSION\n    uniform vec3 uQVT;\n    uniform vec3 uQVS;\n\n    #ifdef HAS_OCT_COMPRESSION\n        #define UNCOMPRESS_DIR(n) n.z = 1.0 - abs(n.x) - abs(n.y); n.xy = n.z >= 0.0 ? n.xy : (1.0 - abs(n.yx)) * sign(n.xy);\n    #else\n        #define UNCOMPRESS_DIR(n) n.z = dot(n.xy, n.xy); n.xyz = vec3(2.0 * n.xy * sqrt(1.0 - n.z), 1.0 - 2.0 * n.z);\n    #endif\n#endif\n\n// attribute -> morph -> skin -> model -> displace -> view -> screen\n// localVertex = skin(morph(Vertex))\n// modelVertex = displacement(modelMatrix * localVertex)\n// viewVertex = viewMatrix * modelVertex\n\nvoid main() {\n#ifdef ASSIGN_UV\n    ASSIGN_UV\n#endif\n\n#ifdef HAS_VERTEX_COLOR\n    vColor = uArrayColorEnabled == 1.0 ? Color : vec4(1.0);\n#endif\n\n#ifdef HAS_SKINNING\n    mat4 boneMatrix = skinning(Weights, Bones);\n#endif\n\n    /////////////////////\n    // LOCAL/MODEL VERTEX\n    /////////////////////\n    vec3 localVertex = Vertex.xyz;\n#ifdef HAS_POSITION_COMPRESSION\n    #ifdef HAS_ZW_COMPRESSION\n        localVertex += Vertex.w;\n    #endif\n    localVertex = localVertex * uQVS RAND_SCALE + uQVT;\n#endif\n\n#ifdef HAS_MORPHING\n    localVertex = morphing(uTargetWeights, localVertex ARG_MORPH_VERTEX_0 ARG_MORPH_VERTEX_1 ARG_MORPH_VERTEX_2 ARG_MORPH_VERTEX_3);\n#endif\n\n#ifdef HAS_SKINNING\n    localVertex = (vec4(localVertex, 1.0) * boneMatrix).xyz;\n#endif\n\n#if defined(HAS_MODEL_VERTEX) || defined(HAS_DISPLACEMENT)\n    vModelVertex = (uModelMatrix * vec4(localVertex, 1.0)).xyz;\n#endif\n\n#if (defined(NEED_LOCAL_NORMAL) && defined(HAS_MORPHING_NORMAL)) || (defined(NEED_LOCAL_TANGENT) && defined(HAS_MORPHING_TANGENT))\n    // normalize weights for direction morphing\n    vec4 nTargetWeights = abs(uTargetWeights);\n    nTargetWeights = uTargetWeights / max(1.0, nTargetWeights.x + nTargetWeights.y + nTargetWeights.z + nTargetWeights.w);\n#endif\n\n    /////////\n    // NORMAL\n    /////////\n#ifdef NEED_LOCAL_NORMAL\n    #ifdef HAS_POSITION_COMPRESSION\n        vec3 localNormal = Normal.xyy;\n        UNCOMPRESS_DIR(localNormal);\n    #else\n        vec3 localNormal = Normal;\n    #endif\n\n    #ifdef HAS_MORPHING_NORMAL\n        localNormal = morphing(nTargetWeights, localNormal ARG_MORPH_NORMAL_0 ARG_MORPH_NORMAL_1 ARG_MORPH_NORMAL_2 ARG_MORPH_NORMAL_3);\n    #endif\n\n    #ifdef HAS_SKINNING\n        localNormal = (vec4(localNormal, 0.0) * boneMatrix).xyz;\n    #endif\n\n    #if defined(HAS_MORPHING) || defined(HAS_SKINNING)\n        localNormal.xyz = normalize(localNormal);\n    #endif\n\n    #if defined(HAS_MODEL_NORMAL) || defined(HAS_SKETCHFAB_DISPLACEMENT)\n        vModelNormal = uModelNormalMatrix * localNormal;\n    #endif\n\n    // view normal computed later if we need to correct it (displacement)\n    #if defined(HAS_VIEW_NORMAL) && !defined(CORRECT_BUMP_NORMAL)\n        vViewNormal = uModelViewNormalMatrix * localNormal;\n    #endif\n#endif\n\n    //////////\n    // TANGENT\n    //////////\n#ifdef NEED_LOCAL_TANGENT\n    #ifdef HAS_POSITION_COMPRESSION\n        vec4 localTangent = Tangent.xyzz;\n        UNCOMPRESS_DIR(localTangent);\n    #else\n        vec4 localTangent = Tangent;\n    #endif\n\n    #ifdef HAS_MORPHING_TANGENT\n        localTangent.xyz = morphing(nTargetWeights, localTangent.xyz ARG_MORPH_TANGENT_0 ARG_MORPH_TANGENT_1 ARG_MORPH_TANGENT_2 ARG_MORPH_TANGENT_3);\n    #endif\n\n    #ifdef HAS_SKINNING\n        localTangent.xyz = (vec4(localTangent.xyz, 0.0) * boneMatrix).xyz;\n    #endif\n\n    #if defined(HAS_MORPHING) || defined(HAS_SKINNING)\n        localTangent.xyz = normalize(localTangent.xyz);\n    #endif\n\n    #ifdef HAS_MODEL_TANGENT\n        vModelTangent = vec4(uModelNormalMatrix * localTangent.xyz, localTangent.w).xyz;\n    #endif\n\n    #ifdef HAS_VIEW_TANGENT\n        vViewTangent = vec4(uModelViewNormalMatrix * localTangent.xyz, localTangent.w);\n    #endif\n#endif\n\n    //////////////////\n    // DISPLACE VERTEX\n    //////////////////\n#ifdef HAS_DISPLACEMENT\n    float displacement = (COLOR_CONVERT_DISPLACEMENT(texture2D(SAMPLER_DISPLACEMENT, UV_DISPLACEMENT).PACK_DISPLACEMENT) - 0.5) * uDisplacementFactor;\n    #ifdef HAS_SKETCHFAB_DISPLACEMENT\n        vModelVertex += normalize(vModelNormal) * displacement;\n    #else\n        vModelVertex += vec3(0.0, 0.0, 1.0) * (vModelVertex.z > 0.01 ? displacement : 0.0);\n    #endif\n    vViewVertex = uViewMatrix * vec4(vModelVertex, 1.0);\n#else\n    vViewVertex = uModelViewMatrix * vec4(localVertex, 1.0);\n#endif\n\n    //////////////////\n    // DISPLACE NORMAL\n    //////////////////\n#ifdef CORRECT_BUMP_NORMAL\n    // if there is no normal map, use displacement to correct normal\n    vec3 invSize = vec3(1.0 / uDisplacementSize, 0.0);\n    vec2 gradient = vec2(COLOR_CONVERT_DISPLACEMENT(texture2D(SAMPLER_DISPLACEMENT, UV_DISPLACEMENT - invSize.xz).PACK_DISPLACEMENT)\n                        - COLOR_CONVERT_DISPLACEMENT(texture2D(SAMPLER_DISPLACEMENT, UV_DISPLACEMENT + invSize.xz).PACK_DISPLACEMENT),\n                        COLOR_CONVERT_DISPLACEMENT(texture2D(SAMPLER_DISPLACEMENT, UV_DISPLACEMENT - invSize.zy).PACK_DISPLACEMENT)\n                        -COLOR_CONVERT_DISPLACEMENT(texture2D(SAMPLER_DISPLACEMENT, UV_DISPLACEMENT + invSize.zy).PACK_DISPLACEMENT));\n\n    localNormal = bumpMap(localTangent, localNormal, uDisplacementNormal * gradient);\n\n    #if defined(HAS_VIEW_NORMAL)\n        vModelNormal = uModelNormalMatrix * localNormal;\n    #endif\n\n    #ifdef HAS_VIEW_NORMAL\n        vViewNormal = uModelViewNormalMatrix * localNormal;\n    #endif\n#endif\n\n    ///////////////////////\n    // PROJECTION JITTERING (could be done on the CPU)\n    ///////////////////////\n    mat4 jitteredProjection = uProjectionMatrix;\n#if defined(WIREFRAME)\n    vViewVertex.w += 0.005 / uProjectionMatrix[1][1];\n#elif defined(SHADOW_CAST)\n    float doPersp = jitteredProjection[3][3] == 0.0 ? 1.0 : 0.0;\n    vec2 jitter = (abs(uHalton.z) == 2.0 ? 1.0 : 0.0) * (uHalton.xy / uShadowMapSize.xy);\n    jitteredProjection[2].xy += doPersp * jitter;\n    jitteredProjection[3].xy += (1.0 - doPersp) * jitter;\n#else\n    jitteredProjection[2].xy += (1.0 - uDisplay2D) * (uHalton.xy * uGlobalTexRatio.xy / uGlobalTexSize.xy);\n#endif\n\n    gl_Position = jitteredProjection * vViewVertex;\n\n#ifdef HAS_POINT_SIZE\n    gl_PointSize = min(64.0, max(1.0, -uPointSize / vViewVertex.z));\n#else\n    gl_PointSize = 1.0;\n#endif\n\n// probably not the best solution (in case you need custom things while including base.vert)\n#ifdef INJECT_VERT\n    INJECT_VERT\n#endif\n}\n'
}, function (e, t) {
    e.exports = '#define HAS_VIEW_VERTEX\n#pragma include "base.vert"\n'
}, function (e, t) {
    e.exports = '// opacity\nuniform vec4 uHalton;\nuniform vec2 uNearFar;\nuniform float uFrameMod;\nuniform int uDrawOpaque;\n\nvarying vec4 vViewVertex;\n\n#pragma include "utils/encodeDepth.glsl"\n\n#pragma include "utils/material.glsl"\n\n#ifdef HAS_OPACITY\n#pragma include "utils/rand.glsl"\n#endif\n\nvoid main() {\n#ifdef HAS_POINT_CIRCLE\n    if (length(2.0 * gl_PointCoord - 1.0) > 1.0) discard;\n#endif\n\n#ifdef HAS_OPACITY_MASK_OR_DITHER\n    ditheringMaskingDiscard(gl_FragCoord, uOpacityDithering, getMaterialOpacity(), uOpacityFactor, uOpacityThinLayer, uFrameMod, uNearFar, uHalton);\n#endif\n\n    float alpha = 1.0;\n#if defined(HAS_OPACITY_BLEND_OR_ADDITIVE) || defined(HAS_OPACITY_REFRACTION)\n    alpha = getMaterialOpacity();\n    if (uDrawOpaque == 1 && alpha < EPSILON_ALPHA) discard;\n    alpha = uDrawOpaque == 1 ? 1.0 : alpha;\n#endif\n\n    float depth = (-vViewVertex.z - uNearFar.x) / (uNearFar.y - uNearFar.x);\n    float scatter = 0.0;\n    float profile = 0.0;\n\n#ifdef HAS_SUBSURFACESCATTERING\n    scatter = getMaterialScattering();\n    profile = uSubsurfaceScatteringProfile;\n#endif\n\n    gl_FragColor = encodeDepthAlphaProfileScatter(depth, alpha, profile, scatter);\n}\n'
}, function (e, t) {
    e.exports = '#define HAS_VIEW_NORMAL\n#define HAS_VIEW_VERTEX\n#pragma include "base.vert"\n'
}, function (e, t) {
    e.exports = 'uniform float uRGBMRange;\nuniform int uOutputLinear;\n\n// stuffs (ssr, opacity, scattering)\nuniform vec4 uHalton;\nuniform vec2 uNearFar;\nuniform float uFrameMod;\nuniform int uDrawOpaque;\n\n// shadow signature...\n#ifdef HAS_SUBSURFACETRANSLUCENCY\n    #define _OUT_DISTANCE\n    #define OPT_DISTANCE shadowDistance,\n#else\n    #define OPT_DISTANCE\n#endif\n\n//////////\n// VARYING\n//////////\nvarying vec4 vViewVertex;\nvarying vec3 vViewNormal;\n\n#ifdef HAS_SHADOW\n    varying vec3 vModelNormal;\n    varying vec3 vModelVertex;\n#endif\n\n#ifdef HAS_VIEW_TANGENT\n    varying vec4 vViewTangent;\n#endif\n\n#pragma include "utils/common.glsl"\n\n#pragma include "utils/functions.glsl"\n\n#pragma include "utils/material.glsl"\n\n// TODO ifdef around pragma include can result in error (files being included multiple times can be ignored)\n#pragma include "utils/decodeDepth.glsl"\n\n#pragma include "utils/rand.glsl"\n\n#ifdef HAS_VIEW_TANGENT\n#pragma include "utils/normalBump.glsl"\n#endif\n\n#ifdef HAS_SHADOW\n#pragma include "shadowing/shadowReceive.glsl"\n#endif\n\n// /!\\ (lightsPBR is also included in clearcoat file, and ifdef around pragma include is not reliable)\n#if defined(HAS_LIGHT) || defined(HAS_CLEARCOAT)\n#pragma include "utils/lightsPBR.glsl"\n#endif\n\n#ifdef HAS_ENVIRONMENT\n#pragma include "utils/environment.glsl"\n#endif\n\n#ifdef HAS_SUBSURFACETRANSLUCENCY\n#pragma include "utils/lightsSSS.glsl"\n#endif\n\n#ifdef HAS_SUBSURFACESCATTERING\n#pragma include "utils/checkerboard.glsl"\n#endif\n\n#ifdef HAS_CLEARCOAT\n#pragma include "utils/clearCoat.glsl"\n#endif\n\n// #ifdef HAS_OPACITY_MASK_OR_DITHER\n// #pragma include "utils/rand.glsl"\n// #endif\n\n#ifdef HAS_OPACITY_REFRACTION\n#pragma include "utils/refraction.glsl"\n#endif\n\n#ifdef HAS_SSR\n#pragma include "utils/ssr.glsl"\n#endif\n\nfloat specularOcclusion(const in int occlude, const in float ao, const in vec3 normal, const in vec3 eyeVector) {\n    if (occlude == 0) return 1.0;\n    // Yoshiharu Gotanda\'s specular occlusion approximation:\n    // cf http://research.tri-ace.com/Data/cedec2011_RealtimePBR_Implementation_e.pptx pg59\n    float d = dot(normal, eyeVector) + ao;\n    return clamp((d * d) - 1.0 + ao, 0.0, 1.0);\n}\n\nfloat adjustRoughnessNormalMap(const in float roughness, const in vec3 normal) {\n    // Based on The Order : 1886 SIGGRAPH course notes implementation (page 21 notes)\n    float nlen2 = dot(normal, normal);\n    if (nlen2 < 1.0) {\n        float nlen = sqrt(nlen2);\n        float kappa = (3.0 * nlen -  nlen2 * nlen) / (1.0 - nlen2);\n        // http://www.frostbite.com/2014/11/moving-frostbite-to-pbr/\n        // page 91 : they use 0.5/kappa instead\n        return min(1.0, sqrt(roughness * roughness + 1.0 / kappa));\n    }\n    return roughness;\n}\n\nvoid main() {\n    //////////////////\n    // OPACITY DISCARD\n    //////////////////\n#ifdef HAS_POINT_CIRCLE\n    if (length(2.0 * gl_PointCoord - 1.0) > 1.0) discard;\n#endif\n\n#ifdef HAS_OPACITY_MASK_OR_DITHER\n    ditheringMaskingDiscard(gl_FragCoord, uOpacityDithering, getMaterialOpacity(), uOpacityFactor, uOpacityThinLayer, uFrameMod, uNearFar, uHalton);\n#endif\n\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    float alpha = getMaterialOpacity();\n    float alphaFinal = alpha * float(1 - uOpacityAdditive);\n    if (alpha == 0.0 || (uDrawOpaque == 1 && alphaFinal < EPSILON_ALPHA) || (uDrawOpaque == 0 && alphaFinal >= EPSILON_ALPHA)) discard;\n#endif\n\n    // /!\\ because of refraction roughness, this part should be done before the call to getMetalness/getSpecular\n#ifdef HAS_OPACITY_REFRACTION\n    gRefractionRoughness = uOpacityRoughnessFactor;\n    float alphaRefraction = getMaterialOpacity();\n    if ((uDrawOpaque == 1 && alphaRefraction < EPSILON_ALPHA) || (uDrawOpaque == 0 && alphaRefraction >= EPSILON_ALPHA)) discard;\n#endif\n\n    ///////////\n    // GEOMETRY\n    ///////////\n    // https://twitter.com/pyalot/status/711956736639418369\n    vec3 eyeVector = -normalize(vViewVertex.xyz);\n    vec3 frontNormal = normalize(gl_FrontFacing ? vViewNormal : -vViewNormal);\n\n#ifdef HAS_VIEW_TANGENT\n    vec4 tangent = gl_FrontFacing ? vViewTangent : -vViewTangent;\n    tangent.xyz = normalize(tangent.xyz);\n    vec3 binormal = normalize(cross(frontNormal, tangent.xyz)) * tangent.w;\n#endif\n\n    ///////////\n    // MATERIAL\n    ///////////\n#if defined(HAS_LEGACY_CLASSIC)\n    vec3 materialDiffuse = getMaterialLegacyDiffuse();\n    vec3 materialSpecular = getMaterialLegacySpecular();\n#elif defined(HAS_METALNESSPBR)\n    float f0 = 0.08 * getMaterialF0();\n    float metal = getMaterialMetalness();\n\n    #ifdef HAS_OPACITY_REFRACTION\n        metal *= alphaRefraction;\n    #endif\n\n    vec3 materialDiffuse = getMaterialAlbedo();\n    vec3 materialSpecular = mix(vec3(f0), materialDiffuse, metal);\n    materialDiffuse *= 1.0 - metal;\n#else\n    vec3 materialSpecular = getMaterialSpecular();\n    vec3 materialDiffuse = getMaterialDiffuse();\n\n    #ifdef HAS_OPACITY_REFRACTION\n        materialSpecular *= mix(0.08, 1.0, alphaRefraction);\n    #endif\n#endif // HAS_METALNESSPBR\n\n#if defined(HAS_ENVIRONMENT) || defined(HAS_LIGHT)\n    float materialF90 = clamp(50.0 * materialSpecular.g, 0.0, 1.0);\n#endif\n\n#if defined(HAS_LEGACY_CLASSIC)\n    float materialShininess = getMaterialLegacyShininess();\n    float materialRoughness = 0.0;\n#elif defined(HAS_ROUGHNESSPBR)\n    float materialRoughness = getMaterialRoughness();\n#else\n    float materialRoughness = 1.0 - getMaterialGlossiness();\n#endif // HAS_ROUGHNESSPBR\n\n    materialRoughness = max(MIN_ROUGHNESS, materialRoughness);\n\n#ifdef HAS_AOPBR\n    float materialAO = getMaterialAO();\n#endif\n\n#ifdef HAS_EMITCOLOR\n    vec3 materialEmit = getMaterialEmitColor();\n#endif\n\n#ifdef HAS_CAVITYPBR\n    float materialCavity = getMaterialCavity();\n#endif\n\n#ifdef HAS_SUBSURFACETRANSLUCENCY\n    float materialTranslucency = getMaterialTranslucency();\n#endif\n\n    vec3 materialNormal = frontNormal;\n#ifdef HAS_NORMALMAP\n    materialNormal = getMaterialNormalMap();\n    materialRoughness = adjustRoughnessNormalMap(materialRoughness, materialNormal);\n    materialNormal = transformNormal(uNormalMapFactor, materialNormal, tangent.xyz, binormal, frontNormal);\n#endif\n\n#ifdef HAS_BUMPMAP\n    materialNormal = transformBump(getMaterialBumpMap(), tangent.xyz, binormal, frontNormal);\n#endif\n\n#ifdef HAS_CLEARCOAT\n    float materialClearCoat = getMaterialClearCoat();\n    float materialClearCoatRoughness = getMaterialClearCoatRoughness();\n    #ifdef HAS_CLEARCOATNORMALMAP\n        vec3 materialClearCoatNormal = transformNormal(uClearCoatNormalMapFactor, getMaterialClearCoatNormal(), tangent.xyz, binormal, frontNormal);\n    #else\n        vec3 materialClearCoatNormal = frontNormal;\n    #endif\n#endif // HAS_CLEARCOAT\n\n    vec3 diffuse = vec3(0.0);\n    vec3 specular = vec3(0.0);\n\n#if defined(HAS_CLEARCOAT) && (defined(HAS_ENVIRONMENT) || defined(HAS_LIGHT))\n    float ccNoV = saturate(dot(materialClearCoatNormal, -refract(eyeVector, materialClearCoatNormal, 1.0 / uClearCoatIor)));\n#endif\n\n    //////////////\n    // ENVIRONMENT\n    //////////////\n#ifdef HAS_ENVIRONMENT\n    diffuse = materialDiffuse * computeDiffuseSPH(materialNormal);\n\n    #ifdef HAS_LEGACY_CLASSIC\n        specular = materialSpecular * textureCubeFixed(sEnvironmentSpecular, uEnvironmentTransform * normalize((2.0 * clamp(dot(materialNormal, eyeVector), 0.0, 1.0)) * materialNormal - eyeVector), uTextureEnvironmentSpecularTextureSize.x);\n    #else\n        specular = computeIBLSpecularUE4(materialNormal, eyeVector, materialRoughness, materialSpecular, frontNormal, materialF90);\n    #endif\n\n    #ifdef HAS_CLEARCOAT\n        float ccF0 = materialClearCoat * F_Schlick(uClearCoatF0, 1.0, ccNoV);\n        vec3 ccAbsorbtion = getClearCoatAbsorbtion(ccNoV, ccNoV, materialClearCoat);\n        specular = mix(specular * ccAbsorbtion, getPrefilteredEnvMapColor(materialClearCoatNormal, eyeVector, materialClearCoatRoughness, frontNormal), ccF0);\n        diffuse *= ccAbsorbtion * (1.0 - ccF0);\n    #endif\n\n    float aoSpec = 1.0;\n    #ifdef HAS_LEGACY_CLASSIC\n        aoSpec = uReflection;\n        specular *= aoSpec;\n    #endif\n\n    #ifdef HAS_AOPBR\n        diffuse *= uEnvironmentExposure * materialAO;\n        aoSpec = specularOcclusion(uAOPBROccludeSpecular, materialAO, materialNormal, eyeVector);\n        specular *= uEnvironmentExposure * aoSpec;\n    #else\n        diffuse *= uEnvironmentExposure;\n        specular *= uEnvironmentExposure;\n    #endif // HAS_AOPBR\n\n    #ifdef HAS_SSR\n        #ifdef HAS_CLEARCOAT\n            vec3 normalSsr = normalize(mix(materialNormal, materialClearCoatNormal, materialClearCoat * 0.5));\n            float roughnessSsr = mix(materialRoughness, materialClearCoatRoughness, materialClearCoat);\n            vec3 specularSsr = aoSpec * materialSpecular * mix(vec3(1.0), ccAbsorbtion, materialClearCoat);\n            specular = ssr(specular, specularSsr, roughnessSsr, normalSsr, eyeVector);\n        #else\n            specular = ssr(specular, materialSpecular * aoSpec, materialRoughness, materialNormal, eyeVector);\n        #endif\n    #endif // HAS_SSR\n#endif // HAS_ENVIRONMENT\n\n    /////////////////////////\n    // LIGHTING AND SHADOWING\n    /////////////////////////\n#ifdef HAS_LIGHT\n    float attenuation, dotNL;\n    vec3 eyeLightDir;\n    bool lighted;\n    vec3 lightSpecular;\n    vec3 lightDiffuse;\n    vec4 prepGGX = precomputeGGX(materialNormal, eyeVector, materialRoughness);\n\n    #ifdef HAS_CLEARCOAT\n        vec4 prepGGXClearCoat = precomputeGGX(materialClearCoatNormal, eyeVector, materialClearCoatRoughness);\n        vec3 ccSpecular;\n        vec3 ccAttenuation;\n    #endif\n#endif\n\n#ifdef HAS_SHADOW\n    float shadow;\n    vec3 modelNormal = normalize(gl_FrontFacing ? vModelNormal : -vModelNormal);\n\n    #ifdef HAS_SUBSURFACETRANSLUCENCY\n        float shadowDistance;\n    #endif\n#endif // HAS_SHADOW\n\n%UNROLL 4%\n#ifdef LIGHT_TYPE_%ID%\n\n    #if LIGHT_TYPE_%ID% == LIGHT_SPOT\n        precomputeSpot(materialNormal, vViewVertex.xyz, uSketchfabLight%ID%_viewDirection, uSketchfabLight%ID%_attenuation, uSketchfabLight%ID%_viewPosition.xyz, uSketchfabLight%ID%_spotCutOff, uSketchfabLight%ID%_spotBlend, attenuation, eyeLightDir, dotNL);\n    #elif LIGHT_TYPE_%ID% == LIGHT_POINT\n        precomputePoint(materialNormal, vViewVertex.xyz, uSketchfabLight%ID%_attenuation, uSketchfabLight%ID%_viewPosition.xyz, attenuation, eyeLightDir, dotNL);\n    #elif LIGHT_TYPE_%ID% == LIGHT_DIRECTION\n        precomputeSun(materialNormal, uSketchfabLight%ID%_viewDirection, attenuation, eyeLightDir, dotNL);\n    #elif LIGHT_TYPE_%ID% == LIGHT_HEMI\n        precomputeSun(materialNormal, uSketchfabLight%ID%_viewDirection, attenuation, eyeLightDir, dotNL);\n    #endif\n\n    #ifdef HAS_LEGACY_CLASSIC\n        #if LIGHT_TYPE_%ID% == LIGHT_HEMI\n            hemiLight(materialNormal, eyeVector, dotNL, eyeLightDir, materialDiffuse, materialSpecular, materialShininess, uSketchfabLight%ID%_diffuse.rgb, uSketchfabLight%ID%_ground.rgb, lightDiffuse, lightSpecular, lighted);\n        #else\n            computeLightLambertCookTorrance(materialNormal, eyeVector, dotNL, attenuation, materialDiffuse, materialSpecular, materialShininess, uSketchfabLight%ID%_diffuse.rgb, uSketchfabLight%ID%_diffuse.rgb, eyeLightDir, lightDiffuse, lightSpecular, lighted);\n        #endif\n    #else\n        computeLightLambertGGX(materialNormal, eyeVector, dotNL, prepGGX, materialDiffuse, materialSpecular, attenuation, uSketchfabLight%ID%_diffuse.rgb, eyeLightDir, materialF90, lightDiffuse, lightSpecular, lighted);\n    #endif\n\n    #ifdef HAS_CLEARCOAT\n        computeLightLambertGGXClearCoat(ccNoV, materialClearCoatNormal, eyeVector, dot(materialClearCoatNormal, eyeLightDir), prepGGXClearCoat, attenuation, uSketchfabLight%ID%_diffuse.rgb, eyeLightDir, materialClearCoat, ccSpecular, ccAttenuation);\n        lightDiffuse *= ccAttenuation;\n        lightSpecular = ccSpecular + lightSpecular * ccAttenuation;\n    #endif\n\n    #ifdef HAS_SHADOW_%ID%\n        #ifdef _ATLAS_SHADOW\n            shadow = shadowReceive(lighted, modelNormal, vModelVertex, Texture7, uShadow_Texture0_renderSize, uShadow_Texture%ID%_projection, uShadow_Texture%ID%_viewRight, uShadow_Texture%ID%_viewUp, uShadow_Texture%ID%_viewLook, uShadow_Texture%ID%_depthRange, uShadowReceive%ID%_bias, uShadow_Texture%ID%_mapSize, OPT_DISTANCE uStaticFrameNumShadow%ID%);\n        #else\n            shadow = shadowReceive(lighted, modelNormal, vModelVertex, TEX_SHADOW_%ID%, uShadow_Texture%ID%_renderSize, uShadow_Texture%ID%_projection, uShadow_Texture%ID%_viewRight, uShadow_Texture%ID%_viewUp, uShadow_Texture%ID%_viewLook, uShadow_Texture%ID%_depthRange, uShadowReceive%ID%_bias, OPT_DISTANCE uStaticFrameNumShadow%ID%);\n        #endif // _ATLAS_SHADOW\n\n        lightDiffuse *= shadow;\n        lightSpecular *= shadow;\n\n        #ifdef HAS_SUBSURFACETRANSLUCENCY\n            lightDiffuse += computeLightSSS(dotNL, attenuation, uSubsurfaceTranslucencyThicknessFactor, uSubsurfaceTranslucencyColor, materialTranslucency, shadowDistance, materialDiffuse, uSketchfabLight%ID%_diffuse.rgb);\n        #endif\n    #endif // HAS_SHADOW\n\n    diffuse += lightDiffuse;\n    specular += lightSpecular;\n#endif // LIGHT_TYPE\n%%\n\n    /////////////\n    // REFRACTION\n    /////////////\n#ifdef HAS_OPACITY_REFRACTION\n    #ifdef HAS_REFRACTION_NORMAL_OFFSET\n        vec3 refractLight = refraction(gRefractionRoughness, materialNormal, frontNormal);\n    #else\n        vec3 refractLight = refraction(gRefractionRoughness, materialNormal, eyeVector);\n    #endif\n\n    #ifdef HAS_REFRACTION_ALBEDO_TINT\n        refractLight *= materialDiffuse;\n    #endif\n\n    diffuse = mix(refractLight, diffuse, alphaRefraction);\n#endif // HAS_OPACITY_REFRACTION\n\n    //////////////////////\n    // SCATTERING AND EMIT\n    //////////////////////\n#ifdef HAS_SUBSURFACESCATTERING\n    #ifdef HAS_EMITCOLOR\n        diffuse = uEmitMultiplicative == 1 ? diffuse * materialEmit : diffuse + materialEmit;\n        if (uEmitMultiplicative == 1) specular *= materialEmit;\n    #endif\n    vec3 frag = mix(specular, diffuse, checkerboard(gl_FragCoord.xy, uHalton));\n#else\n    vec3 frag = diffuse + specular;\n    #ifdef HAS_EMITCOLOR\n        frag = uEmitMultiplicative == 1 ? frag * materialEmit : frag + materialEmit;\n    #endif\n#endif // HAS_SUBSURFACESCATTERING\n\n#ifdef HAS_CAVITYPBR\n    frag *= materialCavity;\n#endif\n\n    // premult\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    frag *= alpha;\n#endif\n\n    if (uOutputLinear != 1) frag = linearTosRGB(frag);\n\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    gl_FragColor = uDrawOpaque == 1 ? encodeRGBM(frag, uRGBMRange) : vec4(frag, alphaFinal);\n#else\n    gl_FragColor = encodeRGBM(frag, uRGBMRange);\n#endif\n}\n'
}, function (e, t) {
    e.exports = '#pragma include "base.vert"\n'
}, function (e, t) {
    e.exports = "uniform vec3 uOutlineColor;\n\nvoid main() {\n#ifdef HAS_POINT_CIRCLE\n    if (length(2.0 * gl_PointCoord - 1.0) > 1.0) discard;\n#endif\n\n    gl_FragColor = vec4(uOutlineColor, 1.0);\n}\n"
}, function (e, t) {
    e.exports = '#define HAS_VIEW_NORMAL\n#define HAS_VIEW_VERTEX\n#pragma include "base.vert"\n'
}, function (e, t) {
    e.exports = 'uniform float uRGBMRange;\nuniform int uOutputLinear;\n\n// stuffs (ssr, opacity, scattering)\nuniform vec4 uHalton;\nuniform vec2 uNearFar;\nuniform float uFrameMod;\nuniform int uDrawOpaque;\n\nuniform vec3 uMatcapColor;\n\n//////////\n// VARYING\n//////////\nvarying vec4 vViewVertex;\nvarying vec3 vViewNormal;\n\n#ifdef HAS_VIEW_TANGENT\nvarying vec4 vViewTangent;\n#endif\n\n#pragma include "utils/common.glsl"\n\n#pragma include "utils/functions.glsl"\n\n#pragma include "utils/material.glsl"\n\n#pragma include "utils/curvature.glsl"\n\n// TODO ifdef around pragma include can result in error (files being included multiple times can be ignored)\n#pragma include "utils/decodeDepth.glsl"\n\n#pragma include "utils/rand.glsl"\n\n#ifdef HAS_VIEW_TANGENT\n#pragma include "utils/normalBump.glsl"\n#endif\n\n#ifdef HAS_OPACITY_REFRACTION\n#pragma include "utils/refraction.glsl"\n#endif\n\nvoid main() {\n    //////////////////\n    // OPACITY DISCARD\n    //////////////////\n#ifdef HAS_POINT_CIRCLE\n    if (length(2.0 * gl_PointCoord - 1.0) > 1.0) discard;\n#endif\n\n#ifdef HAS_OPACITY_MASK_OR_DITHER\n    ditheringMaskingDiscard(gl_FragCoord, uOpacityDithering, getMaterialOpacity(), uOpacityFactor, uOpacityThinLayer, uFrameMod, uNearFar, uHalton);\n#endif\n\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    float alpha = getMaterialOpacity();\n    float alphaFinal = alpha * float(1 - uOpacityAdditive);\n    if (alpha == 0.0 || (uDrawOpaque == 1 && alphaFinal < EPSILON_ALPHA) || (uDrawOpaque == 0 && alphaFinal >= EPSILON_ALPHA)) discard;\n#endif\n\n// /!\\ because of refraction roughness, this part should be done before the call to getMetalness/getSpecular\n#ifdef HAS_OPACITY_REFRACTION\n    gRefractionRoughness = uOpacityRoughnessFactor;\n    float alphaRefraction = getMaterialOpacity();\n    if ((uDrawOpaque == 1 && alphaRefraction < EPSILON_ALPHA) || (uDrawOpaque == 0 && alphaRefraction >= EPSILON_ALPHA)) discard;\n#endif\n\n    ///////////\n    // GEOMETRY\n    ///////////\n    vec3 eyeVector = -normalize(vViewVertex.xyz);\n    vec3 frontNormal = normalize(gl_FrontFacing ? vViewNormal : -vViewNormal);\n\n#ifdef HAS_VIEW_TANGENT\n    vec4 tangent = gl_FrontFacing ? vViewTangent : -vViewTangent;\n    tangent.xyz = normalize(tangent.xyz);\n    vec3 binormal = normalize(cross(frontNormal, tangent.xyz)) * tangent.w;\n#endif\n\n    ///////////\n    // MATERIAL\n    ///////////\n    vec3 materialNormal = frontNormal;\n#ifdef HAS_NORMALMAP\n    materialNormal = getMaterialNormalMap();\n    materialNormal = transformNormal(uNormalMapFactor, materialNormal, tangent.xyz, binormal, frontNormal);\n#endif\n\n#ifdef HAS_BUMPMAP\n    materialNormal = transformBump(getMaterialBumpMap(), tangent.xyz, binormal, frontNormal);\n#endif\n\n    vec3 materialDiffuse = uMatcapColor;\n#ifdef HAS_VERTEX_COLOR\n    materialDiffuse *= getVertexColor();\n#endif\n\n    vec3 nm_x = vec3(-eyeVector.z, 0.0, eyeVector.x);\n    vec3 nm_y = cross(nm_x, eyeVector);\n    vec2 uvMatcap = vec2(dot(materialNormal.xz, -nm_x.xz), dot(materialNormal, nm_y)) * 0.5 + 0.5;\n    vec3 diffuse = materialDiffuse * sRGBToLinear(texture2D(SAMPLER_MATCAP, uvMatcap).rgb) * getCurvature(materialNormal);\n\n    /////////////\n    // REFRACTION\n    /////////////\n#ifdef HAS_OPACITY_REFRACTION\n\n#ifdef HAS_REFRACTION_NORMAL_OFFSET\n    vec3 refractLight = refraction(uOpacityRoughnessFactor, materialNormal, frontNormal);\n#else\n    vec3 refractLight = refraction(uOpacityRoughnessFactor, materialNormal, eyeVector);\n#endif\n\n#ifdef HAS_REFRACTION_ALBEDO_TINT\n    refractLight *= materialDiffuse;\n#endif\n\n    diffuse = mix(refractLight, diffuse, alphaRefraction);\n#endif // HAS_OPACITY_REFRACTION\n\n    vec3 frag = diffuse;\n\n// premult\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    frag *= alpha;\n#endif\n\n    if (uOutputLinear != 1) frag = linearTosRGB(frag);\n\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    gl_FragColor = uDrawOpaque == 1 ? encodeRGBM(frag, uRGBMRange) : vec4(frag, alphaFinal);\n#else\n    gl_FragColor = encodeRGBM(frag, uRGBMRange);\n#endif\n}\n'
}, function (e, t) {
    e.exports = '#pragma include "pbr.vert"\n'
}, function (e, t) {
    e.exports = 'uniform float uRGBMRange;\nuniform int uOutputLinear;\n\n// stuffs (ssr, opacity, scattering)\nuniform vec4 uHalton;\nuniform vec2 uNearFar;\nuniform float uFrameMod;\nuniform int uDrawOpaque;\n\n//////////\n// VARYING\n//////////\n\n#ifdef HAS_OPACITY_REFRACTION\n    varying vec3 vViewNormal;\n    varying vec4 vViewVertex;\n#endif\n\n#pragma include "utils/common.glsl"\n#pragma include "utils/functions.glsl"\n#pragma include "utils/material.glsl"\n#pragma include "utils/decodeDepth.glsl"\n#pragma include "utils/rand.glsl"\n\n#ifdef HAS_OPACITY_REFRACTION\n    #pragma include "utils/refraction.glsl"\n#endif\n\nvoid main() {\n    //////////////////\n    // OPACITY DISCARD\n    //////////////////\n#ifdef HAS_POINT_CIRCLE\n    if (length(2.0 * gl_PointCoord - 1.0) > 1.0) discard;\n#endif\n\n#ifdef HAS_OPACITY_MASK_OR_DITHER\n    ditheringMaskingDiscard(gl_FragCoord, uOpacityDithering, getMaterialOpacity(), uOpacityFactor, uOpacityThinLayer, uFrameMod, uNearFar, uHalton);\n#endif\n\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    float alpha = getMaterialOpacity();\n    float alphaFinal = alpha * float(1 - uOpacityAdditive);\n    if (alpha == 0.0 || (uDrawOpaque == 1 && alphaFinal < EPSILON_ALPHA) || (uDrawOpaque == 0 && alphaFinal >= EPSILON_ALPHA)) discard;\n#endif\n\n    // /!\\ because of refraction roughness, this part should be done before the call to getMetalness/getSpecular\n#ifdef HAS_OPACITY_REFRACTION\n    gRefractionRoughness = uOpacityRoughnessFactor;\n    float alphaRefraction = getMaterialOpacity();\n    if ((uDrawOpaque == 1 && alphaRefraction < EPSILON_ALPHA) || (uDrawOpaque == 0 && alphaRefraction >= EPSILON_ALPHA)) discard;\n#endif\n\n    ///////////\n    // GEOMETRY\n    ///////////\n#ifdef HAS_OPACITY_REFRACTION\n    vec3 eyeVector = -normalize(vViewVertex.xyz);\n    vec3 frontNormal = normalize(gl_FrontFacing ? vViewNormal : -vViewNormal);\n#endif\n\n    ///////////\n    // MATERIAL\n    ///////////\n#if defined(HAS_LEGACY_CLASSIC)\n    vec3 materialDiffuse = getMaterialLegacyDiffuse();\n#elif defined(HAS_ALBEDOPBR)\n    vec3 materialDiffuse = getMaterialAlbedo();\n#else\n    vec3 materialDiffuse = getMaterialDiffuse();\n#endif\n\n#ifdef HAS_AOPBR\n    float materialAO = getMaterialAO();\n#endif\n\n#ifdef HAS_EMITCOLOR\n    vec3 materialEmit = getMaterialEmitColor();\n#endif\n\n#ifdef HAS_CAVITYPBR\n    float materialCavity = getMaterialCavity();\n#endif\n\n    vec3 diffuse = materialDiffuse;\n\n#ifdef HAS_AOPBR\n    diffuse *= materialAO;\n#endif\n\n    /////////////\n    // REFRACTION\n    /////////////\n#ifdef HAS_OPACITY_REFRACTION\n    #ifdef HAS_REFRACTION_NORMAL_OFFSET\n        vec3 refractLight = refraction(uOpacityRoughnessFactor, frontNormal, frontNormal);\n    #else\n        vec3 refractLight = refraction(uOpacityRoughnessFactor, frontNormal, eyeVector);\n    #endif\n\n    #ifdef HAS_REFRACTION_ALBEDO_TINT\n        refractLight *= materialDiffuse;\n    #endif\n\n    diffuse = mix(refractLight, diffuse, alphaRefraction);\n#endif // HAS_OPACITY_REFRACTION\n\n    vec3 frag = diffuse;\n\n#ifdef HAS_EMITCOLOR\n    frag = uEmitMultiplicative == 1 ? frag * materialEmit : frag + materialEmit;\n#endif\n\n#ifdef HAS_CAVITYPBR\n    frag *= materialCavity;\n#endif\n\n    // premult\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    frag *= alpha;\n#endif\n\n    if (uOutputLinear != 1) frag = linearTosRGB(frag);\n\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    gl_FragColor = uDrawOpaque == 1 ? encodeRGBM(frag, uRGBMRange) : vec4(frag, alphaFinal);\n#else\n    gl_FragColor = encodeRGBM(frag, uRGBMRange);\n#endif\n}\n'
}, function (e, t) {
    e.exports = '#define WIREFRAME\n#pragma include "base.vert"\n'
}, function (e, t) {
    e.exports = "uniform vec4 uColor;\n\nvoid main() {\n    gl_FragColor = vec4(uColor.rgb * uColor.a, uColor.a);\n}\n"
}, function (e, t) {
    e.exports = '#pragma include "base.vert"\n'
}, function (e, t) {
    e.exports = 'uniform float uRGBMRange;\nuniform int uOutputLinear;\n\n// stuffs (ssr, opacity, scattering)\nuniform vec4 uHalton;\nuniform vec2 uNearFar;\nuniform float uFrameMod;\nuniform int uDrawOpaque;\n\nuniform float uDisplay2D;\nuniform float uDisplayVertexAlpha;\n\nuniform float uInspectorFactor;\nuniform int uInspectorInvert;\nuniform float uInspectorMaskThreshold;\nuniform vec3 uInspectorColor;\n\n#pragma include "utils/functions.glsl"\n#pragma include "utils/material.glsl"\n#pragma include "utils/rand.glsl"\n\nvoid main() {\n    //////////////////\n    // OPACITY DISCARD\n    //////////////////\n#ifdef HAS_POINT_CIRCLE\n    if (length(2.0 * gl_PointCoord - 1.0) > 1.0) discard;\n#endif\n\n#ifdef HAS_OPACITY_MASK_OR_DITHER\n    if (uDisplay2D == 0.0) ditheringMaskingDiscard(gl_FragCoord, uOpacityDithering, getMaterialOpacity(), uOpacityFactor, uOpacityThinLayer, uFrameMod, uNearFar, uHalton);\n#endif\n\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    float alpha = 1.0;\n    float alphaFinal = 1.0;\n\n    if (uDisplay2D == 0.0) {\n        alpha = getMaterialOpacity();\n        alphaFinal = alpha * float(1 - uOpacityAdditive);\n    }\n\n    if (alpha == 0.0 || (uDrawOpaque == 1 && alphaFinal < EPSILON_ALPHA) || (uDrawOpaque == 0 && alphaFinal >= EPSILON_ALPHA)) discard;\n#endif\n\n    ///////////\n    // MATERIAL\n    ///////////\n    vec3 frag = vec3(0.0);\n#ifdef HAS_INSPECTOR\n    frag = uInspectorFactor * COLOR_CONVERT_INSPECTOR(texture2D(SAMPLER_INSPECTOR, UV_INSPECTOR).PACK_INSPECTOR);\n    if (uInspectorInvert == 1) frag = 1.0 - frag;\n\n    if (uInspectorMaskThreshold > 0.0 && uDisplay2D == 0.0) frag = frag.x < uInspectorMaskThreshold ? vec3(0.0) : vec3(1.0);\n\n    #ifdef HAS_VERTEX_COLOR\n        #ifdef HAS_VERTEX_ALPHA\n            frag *= getVertexColor();\n        #else\n            frag *= uDisplayVertexAlpha == 0.0 ? getVertexColor() : sRGBToLinear(vColor.aaa);\n        #endif\n    #endif\n\n    // we want to display the linear textures as srgb textures, see comment in channelFactoryViewModel\n    #ifdef CONVERT_INSPECTOR_TO_LINEAR\n        frag = sRGBToLinear(frag);\n    #endif\n\n    #ifdef HAS_INSPECTOR_TEXTURE\n        frag *= uInspectorColor;\n    #endif\n#endif\n\n    // premult\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    frag *= alpha;\n#endif\n\n    if (uOutputLinear != 1) frag = linearTosRGB(frag);\n\n    if (uDisplay2D == 1.0) {\n        gl_FragColor = vec4(frag, 1.0);\n        return;\n    }\n\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    gl_FragColor = uDrawOpaque == 1 ? encodeRGBM(frag, uRGBMRange) : vec4(frag, alphaFinal);\n#else\n    gl_FragColor = encodeRGBM(frag, uRGBMRange);\n#endif\n}\n'
}, function (e, t) {
    e.exports = 'uniform vec2 uShadowMapSize;\n#define SHADOW_CAST\n#define HAS_VIEW_VERTEX\n#pragma include "base.vert"\n'
}, function (e, t) {
    e.exports = '// opacity\nuniform vec4 uHalton;\nuniform vec2 uNearFar;\nuniform float uFrameMod;\nuniform int uDrawOpaque;\n\nuniform vec4 uShadowDepthRange;\n\nvarying vec4 vViewVertex;\n\n#ifdef HAS_OPACITY\n#pragma include "utils/material.glsl"\n#pragma include "utils/rand.glsl"\n#endif\n\nvec4 encodeFloatRGBA( float v ) {\n    vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * v;\n    enc = fract(enc);\n    enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);\n    return enc;\n}\n\nvoid main() {\n#ifdef HAS_OPACITY_MASK_OR_DITHER\n    ditheringMaskingDiscard(gl_FragCoord, uOpacityDithering, getMaterialOpacity(), uOpacityFactor, uOpacityThinLayer, uFrameMod, uNearFar, uHalton);\n#endif\n\n#if defined(HAS_OPACITY_BLEND_OR_ADDITIVE) || defined(HAS_OPACITY_REFRACTION)\n    if (getMaterialOpacity() < EPSILON_ALPHA) discard;\n#endif\n\n    gl_FragColor = encodeFloatRGBA((-vViewVertex.z - uShadowDepthRange.x) / (uShadowDepthRange.y - uShadowDepthRange.x));\n}\n'
}, function (e, t) {
    e.exports = '#pragma include "base.vert"\n'
}, function (e, t) {
    e.exports = '\n#pragma include "shadowing/shadowReceive.glsl"\n\nvarying vec3 vModelNormal;\nvarying vec3 vModelVertex;\n\nvoid main() {\n    vec3 modelNormal = normalize(gl_FrontFacing ? vModelNormal : -vModelNormal);\n    #ifdef _ATLAS_SHADOW\n        float shadow = shadowReceive(true, modelNormal, vModelVertex, Texture7, uShadow_Texture0_renderSize, uShadow_Texture0_projection, uShadow_Texture0_viewRight, uShadow_Texture0_viewUp, uShadow_Texture0_viewLook, uShadow_Texture0_depthRange, uShadowReceive0_bias, uShadow_Texture0_mapSize, uStaticFrameNumShadow0);\n    #else\n        float shadow = shadowReceive(true, modelNormal, vModelVertex, Texture12, uShadow_Texture0_renderSize, uShadow_Texture0_projection, uShadow_Texture0_viewRight, uShadow_Texture0_viewUp, uShadow_Texture0_viewLook, uShadow_Texture0_depthRange, uShadowReceive0_bias, uStaticFrameNumShadow0);\n    #endif\n\n    // not much blending, so no need to convert to srgb\n    // gl_FragColor = vec4(0.0, 0.0, 0.0, linearTosRGB(0.5 - shadow));\n    gl_FragColor = vec4(0.0, 0.0, 0.0, 0.5 - shadow);\n}\n'
}, function (e, t) {
    e.exports = '#define HAS_VERTEX_COLOR\n#define HAS_VIEW_VERTEX\n#define HAS_VIEW_NORMAL\n#pragma include "base.vert"\n'
}, function (e, t) {
    e.exports = '#define MIN_ROUGHNESS 0.045\n\nuniform float uRGBMRange;\nuniform int uOutputLinear;\n\nvarying vec4 vViewVertex;\nvarying vec3 vViewNormal;\nvarying vec4 vColor;\n\nuniform float uNormalSign;\nuniform vec3 uAlbedo;\nuniform float uRoughness;\nuniform float uMetalness;\n\nvec3 lightDir = normalize(vec3(0.0, 0.3, 0.9));\nvec3 lightColor = vec3(0.7, 0.7, 0.9);\n\n#pragma include "utils/functions.glsl"\n\n#pragma include "utils/lightsPBR.glsl"\n\nvoid main() {\n    vec3 eyeVector = -normalize(vViewVertex.xyz);\n    vec3 materialNormal = uNormalSign * normalize(gl_FrontFacing ? vViewNormal : -vViewNormal);\n\n    // material\n    float f0 = 0.04;\n    vec3 materialDiffuse = uAlbedo * vColor.r;\n    vec3 materialSpecular = mix(vec3(f0), materialDiffuse, uMetalness);\n    materialDiffuse *= 1.0 - uMetalness;\n    float materialRoughness = max(MIN_ROUGHNESS, uRoughness);\n    float materialF90 = clamp(50.0 * materialSpecular.g, 0.0, 1.0);\n\n    // precompute light\n    float attenuation, dotNL;\n    vec3 eyeLightDir;\n    bool lighted;\n    vec3 lightSpecular;\n    vec3 lightDiffuse;\n    vec4 prepGGX = precomputeGGX(materialNormal, eyeVector, materialRoughness);\n\n    // shading\n    attenuation = 1.0;\n    dotNL = dot(lightDir, materialNormal);\n    computeLightLambertGGX(materialNormal, eyeVector, dotNL, prepGGX, materialDiffuse, materialSpecular, attenuation, lightColor, lightDir, materialF90, lightDiffuse, lightSpecular, lighted);\n\n    vec3 frag = lightDiffuse + lightSpecular;\n    if (uOutputLinear != 1) frag = linearTosRGB(frag);\n    gl_FragColor = encodeRGBM(frag, uRGBMRange);\n}\n'
}, function (e, t) {
    e.exports = '#define HAS_VIEW_NORMAL\n#pragma include "base.vert"\n'
}, function (e, t) {
    e.exports = 'uniform float uRGBMRange;\n\nvarying vec3 vViewNormal;\n\n#pragma include "utils/functions.glsl"\n\nvoid main(void) {\n   gl_FragColor = encodeRGBM(0.5 * vec3(abs(dot(vViewNormal.xyz, vec3(0.3, 0.6, 0.9)))), uRGBMRange);\n}\n'
}, function (e, t) {
    e.exports = 'attribute float Offset;\nuniform float uScale;\n\n#define HAS_MODEL_VERTEX\n#define HAS_MODEL_NORMAL\n\n#define INJECT_VERT gl_Position = uProjectionMatrix * uViewMatrix * vec4(Offset == 1.0 ? vModelVertex + normalize(vModelNormal) * uScale : vModelVertex, 1.0);\n\n#pragma include "base.vert"\n'
}, function (e, t) {
    e.exports = "uniform vec3 uColorDebug;\n\nvoid main(void) {\n   gl_FragColor = vec4(uColorDebug, 1.0);\n}\n"
}, function (e, t) {
    e.exports = 'attribute float Offset;\nuniform float uScale;\n\n#define HAS_MODEL_VERTEX\n#define HAS_MODEL_TANGENT\n\n#define INJECT_VERT gl_Position = uProjectionMatrix * uViewMatrix * vec4(Offset == 1.0 ? vModelVertex + normalize(vModelTangent) * uScale : vModelVertex, 1.0);\n\n#pragma include "base.vert"\n'
}, function (e, t) {
    e.exports = "uniform vec3 uColorDebug;\n\nvoid main(void) {\n   gl_FragColor = vec4(uColorDebug, 1.0);\n}\n"
}, function (e, t) {
    e.exports = 'attribute vec3 BonesColor;\nvarying vec3 vBonesColor;\n\n#define INJECT_VERT vBonesColor = BonesColor;\n\n#pragma include "base.vert"\n'
}, function (e, t) {
    e.exports = "varying vec3 vBonesColor;\n\nvoid main(void) {\n   gl_FragColor = vec4(vBonesColor, 1.0);\n}\n"
}, function (e, t) {
    e.exports = '#pragma include "base.vert"\n'
}, function (e, t) {
    e.exports = "uniform vec3 uColorDebug;\n\nvoid main(void) {\n   gl_FragColor = vec4(uColorDebug, 1.0);\n}\n"
}, function (e, t) {
    e.exports = '#pragma include "base.vert"\n'
}, function (e, t) {
    e.exports = '#pragma include "utils/encodeDepth.glsl"\nuniform vec2 uNearFar;\nvarying vec4 vViewVertex;\n\nuniform float uGroundFade;\nuniform float uGroundOpacity;\nuniform float uChanging;\n\nvarying vec2 vTexCoord0;\n\n#ifdef PASS_THROUGH\n    float getShadow(){\n       return 1.0;\n    }\n#endif\n\n#ifdef SHADOW_CATCHER\n\n    varying vec3 vModelNormal;\n    varying vec3 vModelVertex;\n\n    #define OPT_DISTANCE\n    #pragma include "shadowing/shadowReceive.glsl"\n\n    #pragma include "utils/getLuminance.glsl"\n\n    %UNROLL 4%\n    #ifdef LIGHT_TYPE_%ID%\n        uniform vec4 uSketchfabLight%ID%_diffuse;\n    #endif\n    %%\n\n\n    float getShadow(){\n        float shadow = 0.0;\n        vec3 modelNormal = normalize(gl_FrontFacing ? vModelNormal : -vModelNormal);\n        bool lighted = true;\n\n        float weight;\n        float sumWeights = 0.0;\n\n        %UNROLL 4%\n        #ifdef LIGHT_TYPE_%ID%\n            #ifdef HAS_SHADOW_%ID%\n                weight = getLuminance(uSketchfabLight%ID%_diffuse.rgb);\n                #ifdef _ATLAS_SHADOW\n                    shadow += weight * shadowReceive(lighted, modelNormal, vModelVertex, Texture7, uShadow_Texture0_renderSize, uShadow_Texture%ID%_projection, uShadow_Texture%ID%_viewRight, uShadow_Texture%ID%_viewUp, uShadow_Texture%ID%_viewLook, uShadow_Texture%ID%_depthRange, uShadowReceive%ID%_bias, uShadow_Texture%ID%_mapSize, OPT_DISTANCE uStaticFrameNumShadow%ID%);\n                #else\n                    shadow += weight * shadowReceive(lighted, modelNormal, vModelVertex, TEX_SHADOW_%ID%, uShadow_Texture%ID%_renderSize, uShadow_Texture%ID%_projection, uShadow_Texture%ID%_viewRight, uShadow_Texture%ID%_viewUp, uShadow_Texture%ID%_viewLook, uShadow_Texture%ID%_depthRange, uShadowReceive%ID%_bias, OPT_DISTANCE uStaticFrameNumShadow%ID%);\n                #endif // _ATLAS_SHADOW\n                sumWeights += weight;\n            #endif // HAS_SHADOW\n        #endif // LIGHT_TYPE\n        %%\n\n        #ifdef HAS_SHADOW\n            shadow /= sumWeights;\n        #else\n            shadow = 1.0;\n        #endif\n\n        return shadow;\n    }\n#endif\n\n#ifdef BAKED_AO\n    #pragma include "utils/encodeDecode.glsl"\n    uniform sampler2D uTexture;\n\n    float getShadow(){\n        return decode24(texture2D(uTexture, vTexCoord0).rgb);\n    }\n#endif\n\n#ifdef DISPLAY_PLANE\n    const float gridSize = 10.0;\n    const vec4 overlayColor = vec4(0.109,0.664,0.848,1.0);\n#endif\n\nuniform float uWidgetFade;\n\nvoid main() {\n    float shadow = getShadow();\n    #ifndef DISPLAY_PLANE\n\t    if (shadow >= 0.99) discard;\n    #endif\n    vec2 centerUV = vTexCoord0 * 2.0 - 1.0;\n    float fade = clamp(1.0 - dot(centerUV, centerUV) * (pow(10.0, uGroundFade) - 1.0) , 0.0, 1.0);\n\n    float alpha = (1.0 - shadow) * uGroundOpacity * fade;\n    gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0) * uGroundOpacity * fade * alpha;\n\n\n    #ifdef DISPLAY_PLANE\n        float gridValue = clamp(step(0.03,fract(vTexCoord0.x * gridSize))\n            * step(0.03,fract(vTexCoord0.y * gridSize)),0.0,1.0)\n            * step(vTexCoord0.x,0.997)\n            * step(vTexCoord0.y,0.997);\n\n        gl_FragColor = mix(overlayColor * fade, gl_FragColor, uWidgetFade) * vec4(gridValue,gridValue,gridValue,1.0);\n    #endif\n\n}\n'
}, function (e, t) {
    e.exports = '#pragma include "base.vert"\n'
}, function (e, t) {
    e.exports = '#pragma include "utils/encodeDecode.glsl"\n\n// opacity\nuniform vec4 uHalton;\nuniform vec2 uNearFar;\nuniform float uFrameMod;\nuniform int uDrawOpaque;\n\n#ifdef HAS_OPACITY\n#pragma include "utils/material.glsl"\n#pragma include "utils/rand.glsl"\n#endif\n\nvoid main(void) {\n    #ifdef HAS_OPACITY_MASK_OR_DITHER\n        ditheringMaskingDiscard(gl_FragCoord, uOpacityDithering, getMaterialOpacity(), uOpacityFactor, uOpacityThinLayer, uFrameMod, uNearFar, uHalton);\n    #endif\n\n    #if defined(HAS_OPACITY_BLEND_OR_ADDITIVE) || defined(HAS_OPACITY_REFRACTION)\n        if (getMaterialOpacity() < EPSILON_ALPHA) discard;\n    #endif\n\n    // Depth in clip space\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\n    gl_FragColor.rgb = encode24(depth);\n    gl_FragColor.a = 1.0;\n\n}\n'
}, function (e, t) {
    e.exports = '#pragma include "base.vert"\n'
}, function (e, t) {
    e.exports = "uniform vec4 uColor;\n\nvoid main(void) {\n   gl_FragColor = uColor;\n}\n"
}, function (e, t, i) {
    "use strict";
    var n = i(90),
        r = i(1263),
        a = i(1264),
        o = {
            FeatureName: "camera",
            ModelType: r.a,
            ViewListType: [a.a]
        },
        s = n.a.create(o);
    s.prototype.getManipulator = function () {
        return this._views[0]._switchManipulator
    }, s.prototype.canMoveTarget = function () {
        return this._views[0].canMoveTarget()
    }, s.prototype.getNode = function () {
        return this._views[0].getNode()
    }, s.prototype.getWidgetNode = function () {
        return this._views[0].getWidgetNode()
    }, t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(149),
        a = i(20),
        o = i(5),
        s = i.n(o),
        u = i(103),
        l = i(0),
        c = (i.n(l), n.a.osg),
        h = Math.PI / 2,
        d = r.a.extend({
            getModelOptionPath: function () {
                return "camera"
            },
            defaults: {
                webVR: !1,
                indexManipulator: "fps" === Object(a.a)().navigation ? 1 : 0,
                node: void 0,
                minSpeed: .1,
                displayGizmo: !1,
                animationEye: c.vec3.create(),
                animationTarget: c.vec3.create(),
                animationDuration: 1,
                enableCameraConstraints: !0,
                offset: 0,
                angle: 2 * Math.PI
            },
            getName: function () {
                return "Camera"
            },
            setTargetAndEye: function (e, t, i) {
                return this.set("animationTarget", e), this.set("animationEye", t), this.trigger("setTargetAndEye", i)
            },
            init: function (e) {
                this._viewer = e.getViewer();
                var t = e.getModel().get("options"),
                    i = t.camera;
                this.set("enableCameraConstraints", Object(a.a)().cameraConstraints);
                var n = this._getUrlOptions(),
                    r = Object(l.merge)(i, n);
                this.setJSON(r), this.yawLeftRightToAngleOffset(), this.on("change:zoomIn", this.checkOverLap.bind(this, "zoomOut", "zoomIn", "zoomOut")), this.on("change:zoomOut", this.checkOverLap.bind(this, "zoomOut", "zoomIn", "zoomIn")), this.on("change:up", this.checkOverLap.bind(this, "up", "down", "down")), this.on("change:down", this.checkOverLap.bind(this, "up", "down", "up")), this.on("change:offset", this.yawAngleOffsetToLeftRight.bind(this)), this.on("change:angle", this.yawAngleOffsetToLeftRight.bind(this))
            },
            shouldPlayFirstCameraAnimation: function () {
                return !0 === Object(a.a)().camera && !this.get("useCameraConstraints")
            },
            initAfterFirstFrame: function () {
                var e = Math.floor(u.a.getModelBoxWithoutDisplacement().radius() * (180 - this.get("fov"))); - 1 === this.get("zoomOut") && this.set("zoomOut", e), -1 === this.get("zoomIn") && this.set("zoomIn", e), this.set("maxZoom", e), this.trigger("uiReady")
            },
            _getUrlOptions: function () {
                var e = {
                    usePanConstraints: Object(a.a)().orbitConstraintPan,
                    zoomIn: Object(a.a)().orbitConstraintZoomIn,
                    zoomOut: Object(a.a)().orbitConstraintZoomOut,
                    left: Object(a.a)().orbitConstraintYawLeft,
                    right: Object(a.a)().orbitConstraintYawRight,
                    up: Object(a.a)().orbitConstraintPitchUp,
                    down: Object(a.a)().orbitConstraintPitchDown
                };
                return e.useZoomConstraints = void 0 !== e.zoomOut || void 0 !== e.zoomIn || void 0, e.useYawConstraints = void 0 !== e.left || void 0 !== e.right || void 0, e.usePitchConstraints = void 0 !== e.up || void 0 !== e.down || void 0, e.useCameraConstraints = e.useZoomConstraints || e.useYawConstraints || e.usePitchConstraints || e.usePanConstraints, e
            },
            getCameraPosition: function (e, t) {
                var i = this._viewer.getFeaturesManager();
                if (i && (i.getCameraWithoutAutospin(e, t), 0 !== this.get("indexManipulator") && this.get("node"))) {
                    var n = this.get("node").getMinimumBound(),
                        r = c.vec3.dist(e, n.center()),
                        a = Math.max(.1 * n.radius(), r);
                    c.vec3.sub(t, t, e), c.vec3.normalize(t, t), c.vec3.scale(t, t, a), c.vec3.add(t, e, t)
                }
            },
            saveCameraPosition: function () {
                if (this.get("useCameraConstraints") && !this.get("enableCameraConstraints")) return void this.getCameraPosition(this.get("position"), c.vec3.create());
                this.getCameraPosition(this.get("position"), this.get("target"))
            },
            validateEyeTarget: function (e, t) {
                var i = c.vec3.dist(e, t);
                if (i <= 1e-8) return !1;
                var n = this.get("node").getMinimumBound().radius();
                return i <= .001 * n && (c.vec3.sub(t, t, e), c.vec3.scale(t, t, .01 * n / i), c.vec3.add(t, e, t)), !0
            },
            editorGetJSON: function () {
                return this.getJSON()
            },
            editorSetJSON: function (e) {
                var t = {
                        validate: !0
                    },
                    i = this.setJSON(e, t);
                return i || s.a.resolve(!0)
            },
            range: function (e) {
                return "[" + e.min + ", " + e.max + "]"
            },
            limits: function () {
                return {
                    zoomIn: {
                        min: 0,
                        max: this.get("maxZoom")
                    },
                    zoomOut: {
                        min: 0,
                        max: this.get("maxZoom")
                    },
                    offset: {
                        min: 0,
                        max: 2 * Math.PI
                    },
                    angle: {
                        min: 0,
                        max: 2 * Math.PI
                    },
                    up: {
                        min: -h,
                        max: h
                    },
                    down: {
                        min: -h,
                        max: h
                    },
                    fov: {
                        min: 1,
                        max: 179
                    },
                    nearFarRatio: {
                        min: 1e-4,
                        max: .005
                    }
                }
            },
            yawAngleOffsetToLeftRight: function () {
                var e = this.get("offset"),
                    t = this.get("angle"),
                    i = e - t / 2,
                    n = 0;
                t === 2 * Math.PI && (n = -.001);
                var r = e + t / 2 + n;
                i >= Math.PI && (i -= 2 * Math.PI), r >= Math.PI && (r -= 2 * Math.PI), this.set("left", i), this.set("right", r)
            },
            yawLeftRightToAngleOffset: function () {
                var e = this._getYawValue(this.get("left")),
                    t = this._getYawValue(this.get("right")),
                    i = this.computeAngleOffset(e, t);
                this.set("angle", i[0]), this.set("offset", i[1])
            },
            _getYawValue: function (e) {
                return e <= -3.14 ? -Math.PI : e >= 3.14 ? Math.PI : void 0
            },
            computeAngleOffset: function (e, t) {
                var i = t - e;
                i < 0 && (i += 2 * Math.PI);
                var n = e + i / 2;
                return n < 0 && (n += 2 * Math.PI), [i, n]
            },
            checkOverLap: function (e, t, i) {
                var n = this.get(e),
                    r = this.get(t);
                r > n && this.set(i, i === e ? r : n)
            }
        });
    t.a = d
}, function (e, t, i) {
    "use strict";
    var n = i(8),
        r = i(633),
        a = i(1267),
        o = i(47),
        s = i(79),
        u = i(147),
        l = i(44),
        c = i(9),
        h = i(69),
        d = i(1280),
        f = c.a.osg,
        p = c.a.InputGroups,
        m = Math.PI / 180,
        g = n.a.extend({
            initialize: function () {
                n.a.prototype.initialize.apply(this, arguments);
                var e = this.model;
                if (e.bind("change:indexManipulator", this.onIndexManipulatorChanged, this), e.bind("change:node", this.onNodeChanged, this), e.bind("change:minSpeed", this.onNodeChanged, this), e.bind("change:webVR", this.setVR, this), e.bind("change:fov", this.onFov, this), e.bind("change:nearFarRatio", this.onNearFarRatio, this), e.bind("change:animationDuration", this.onDurationChanged, this), e.bind("change:easingFunction", this.onEasingChanged, this), e.bind("setTargetAndEye", this.onTargetAndEyeChanged, this), e.bind("change:useCameraConstraints", this._onUseCamConstrainsToggle, this), e.bind("change:usePanConstraints", this.refreshConstraints, this), e.bind("change:useZoomConstraints", this.refreshConstraints, this), e.bind("change:zoomIn", this.refreshConstraints, this), e.bind("change:zoomOut", this.refreshConstraints, this), e.bind("change:usePitchConstraints", this.refreshConstraints, this), e.bind("change:right", this.refreshConstraints, this), e.bind("change:useYawConstraints", this.refreshConstraints, this), e.bind("change:up", this.refreshConstraints, this), e.bind("change:down", this.refreshConstraints, this), e.bind("targetChanged", this.onTargetChanged, this), e.bind("refreshConstraints", this.refreshConstraints, this), e.bind("saveZoomIn", this._saveZoom.bind(this, "zoomIn")), e.bind("saveZoomOut", this._saveZoom.bind(this, "zoomOut")), e.bind("change:displayGizmo", this._updateGizmoDisplay.bind(this)), this._viewer = this.options.context.getViewer(), this._viewerOSGJS = this._viewer.getViewerOSGJS(), this._switchManipulator = new r.a(this._viewer.getInputManager(), this.cameraMove.bind(this)), this._viewerOSGJS.setupManipulator(this._switchManipulator), this._featureNode = new f.Node("Camera"), this._callbackCameraAnimation = new d.a(this._switchManipulator, e.get("animationDuration"), this.cameraMove.bind(this)), this._featureNode.addUpdateCallback(this._callbackCameraAnimation), this.model.bind("change:enableCameraConstraints", this.focusOnTarget, this), this.onIndexManipulatorChanged(), this._dolly = !1, this.onFov(), this.onNearFarRatio(), this._dolly = !0, o.a.getFirstCameraAnimation().then(function () {
                        !e.get("webVR") && this.model.get("useCameraConstraints") && (this._updateGizmoDisplay(), this.focusOnTarget(), this._switchManipulator.getOrbitManipulator().enableRecenter(!this.model.get("useCameraConstraints")), this.initFeatureBridge())
                    }.bind(this)), !Object(u.a)()) {
                    this._cameraIdle = !0;
                    var t = l.a.getFrameTimeAverage();
                    this.cameraIdleNessDetectBinded = this.cameraIdleNessDetect.bind(this), this.timer = window.setTimeout(this.cameraIdleNessDetectBinded, t)
                }
            },
            initFeatureBridge: function () {
                this.model._viewer.getFeatures().inspector.getModel().bind("change:uiVisible", this._onInspectorVisiblilityChange.bind(this))
            },
            _onInspectorVisiblilityChange: function (e) {
                var t = e.get("uiVisible");
                this.model.set("enableCameraConstraints", !t)
            },
            setVR: function () {
                var e = this._viewerOSGJS.getManipulator(),
                    t = this.model.get("webVR");
                e.setDelay(t ? 1 : .15);
                var i = this._viewerOSGJS.getInputManager();
                if (this._viewerOSGJS.requestContinuousUpdate(!0), t) {
                    this.lastMode = this.model.get("indexManipulator");
                    var n = this._viewerOSGJS.getVRDisplay(),
                        a = !!n,
                        o = !a;
                    if (!o) {
                        var s = n.displayName.toLowerCase(); - 1 === s.indexOf("cardboard") && -1 === s.indexOf("samsung") || (o = !0)
                    }
                    i.setEnable(p.FPS_MANIPULATOR_TOUCH, !1), i.setEnable(p.FPS_MANIPULATOR_WEBVR, a), i.setEnable(p.FPS_MANIPULATOR_DEVICEORIENTATION, !a), this.model.set("indexManipulator", r.a.FPS)
                } else i.setEnable(p.FPS_MANIPULATOR_TOUCH, !0), i.setEnable(p.FPS_MANIPULATOR_WEBVR, !1), i.setEnable(p.FPS_MANIPULATOR_DEVICEORIENTATION, !1), void 0 !== this.lastMode && this.model.set("indexManipulator", this.lastMode);
                var u = this._viewer.getFeatures();
                !u || u.webVR && u.webVR.getModel().get("modeLauncher") || e.computeHomePosition()
            },
            onDurationChanged: function () {
                this._callbackCameraAnimation.setDuration(this.model.get("animationDuration"))
            },
            onEasingChanged: function () {
                this._callbackCameraAnimation.setEasingFunction(this.model.get("easingFunction"))
            },
            onTargetAndEyeChanged: function (e) {
                this._callbackCameraAnimation.setTargetAndEye(this.model.get("animationTarget"), this.model.get("animationEye"), e)
            },
            canMoveTarget: function () {
                return this.model.get("indexManipulator") === r.a.FPS || !this._switchManipulator.getOrbitManipulator().isConstrainPan()
            },
            onFov: function () {
                var e = this._viewer.getCamera(),
                    t = e.getViewport(),
                    i = t.width() / t.height();
                if (f.mat4.perspective(e.getProjectionMatrix(), this.model.get("fov") * m, i, 1, 1e3), this._dolly) {
                    var n = this.options.context.getViewer().getViewerOSGJS().getManipulator(),
                        r = n.getCurrentManipulator();
                    if (r) {
                        var a = r.getHomeBoundingSphere();
                        a && n.setDistance(r.getHomeDistance(a))
                    }
                }
                this.model.saveCameraPosition(), l.a.draw()
            },
            onNearFarRatio: function () {
                this.model.set("minSpeed", 15 * this.model.get("nearFarRatio")), l.a.draw()
            },
            getNode: function () {
                return this._featureNode
            },
            getWidgetNode: function () {
                return this._widgetNode || (this._widgetNode = new f.Node, this._widgetNode.setNodeMask(0)), this._widgetNode
            },
            onIndexManipulatorChanged: function () {
                this._switchManipulator.setManipulatorIndex(this.model.get("indexManipulator"))
            },
            onNodeChanged: function () {
                if (this._dolly) {
                    var e = this._switchManipulator;
                    e.setNode(this.model.get("node"));
                    var t = e.getOrbitManipulator(),
                        i = this._switchManipulator.getHomeBoundingSphere().radius();
                    t.setMinSpeed(this.model.get("minSpeed") * i)
                }
            },
            focusOnTarget: function () {
                this.model.get("enableCameraConstraints") && this.lookatTarget(), this.refreshConstraints()
            },
            lookatTarget: function () {
                var e = f.vec3.create();
                return function () {
                    this._switchManipulator.getOrbitManipulator().getEyePosition(e), this._viewer.getFeaturesManager().focusOnTargetAndEye(this.model.get("target"), e, .3, !0)
                }
            }(),
            onTargetChanged: function () {
                this.model.get("usePanConstraints") && this.model.get("enableCameraConstraints") && this.focusOnTarget()
            },
            _initGizmo: function () {
                this._widgetNode = new f.Camera, this._widgetNode.setName("Camera - Constraints - Widgets"), this._featureNode.addChild(this._widgetNode), this._widgetNode.setNearFarRatio(5e-5), this._widgetNode.setNodeMask(h.a.NO_SHADOW), this._gizmo = new a.a(this._switchManipulator.getOrbitManipulator(), this.model), this._widgetNode.addChild(this._gizmo), this._widgetNode.addUpdateCallback(this)
            },
            _updateGizmoDisplay: function () {
                if (o.a.getFirstCameraAnimation().isFulfilled()) {
                    var e = this.model.get("displayGizmo");
                    !this._gizmo && e && (this._initGizmo(), this.refreshConstraints(), Object(s.a)() && this._gizmo.setPivotSelected(this.model.get("useCameraConstraints"))), this._gizmo && this._gizmo.setVisible(e)
                }
            },
            _onUseCamConstrainsToggle: function () {
                var e = this.model.get("useCameraConstraints");
                this._gizmo && this._gizmo.setPivotSelected(e), this.refreshConstraints(), this._switchManipulator.getOrbitManipulator().enableRecenter(!e)
            },
            refreshConstraints: function () {
                o.a.getFirstCameraAnimation().isFulfilled() && this.applyConstraints()
            },
            applyConstraints: function () {
                if (!this._hasHotSpots()) {
                    var e = this.model,
                        t = e.getInstance();
                    e.get("enableCameraConstraints") && this._applyModel(t);
                    var i = this._switchManipulator.getOrbitManipulator();
                    i.setLimitYawLeft(t.left), i.setLimitYawRight(t.right), i.setConstrainYaw(t.useYawConstraints);
                    var n = .5 * Math.PI * .99;
                    i.setLimitPitchDown(Math.min(n, Math.max(-n, t.down))), i.setLimitPitchUp(Math.min(n, Math.max(-n, t.up))), i.setConstrainPitch(t.usePitchConstraints), -1 === t.zoomOut && (t.zoomOut = 1 / 0), i.setLimitZoomOut(t.zoomOut), i.setConstrainZoom(t.useZoomConstraints);
                    var r = !(t.usePanConstraints && e.get("enableCameraConstraints") && e.get("useCameraConstraints"));
                    if (t.zoomIn > 0) i.setLimitZoomIn(t.zoomIn);
                    else {
                        var a = this._switchManipulator.getHomeBoundingSphere().radius();
                        i.setLimitZoomIn(.001 * a)
                    }
                    i.setAutoPushTarget(r && !t.useZoomConstraints), i.setConstrainPan(!r), i.setPanConstraintTarget(e.get("target")), this._gizmo && (this._gizmo.updateConstraints(), r || this.lookatTarget()), l.a.draw()
                }
            },
            update: function () {
                if (this._hasHotSpots()) return !1;
                var e = this._viewer.getOptions().widgetAPI,
                    t = e && e.getTabbedWidget().get();
                return this.model.get("displayGizmo") && this._gizmo.update(this._viewer.getCamera()), "scene" === t ? this._currentTab !== t && this.model.trigger("TabEnter") : this._currentTab !== t && (this.model.trigger("TabLeave"), this.model.set("displayGizmo", !1)), this._currentTab = t, !0
            },
            _hasHotSpots: function () {
                var e = this._viewer.getFeatures().hotspot.getModel(),
                    t = e.get("hotspots").length && e.get("visible");
                return t && this.model.get("useCameraConstraints") && (this.model.set("useCameraConstraints", !1), Object(s.a)() && this.model.trigger("ForceDisable")), t
            },
            _applyModel: function (e) {
                var t = this.model;
                t.get("useCameraConstraints") && (e.useCameraConstraints = !0, e.usePanConstraints = t.get("usePanConstraints"), e.useZoomConstraints = t.get("useZoomConstraints"), e.useZoomConstraints && (e.zoomIn = t.get("zoomIn"), e.zoomOut = t.get("zoomOut")), e.useYawConstraints = t.get("useYawConstraints"), e.useYawConstraints && (e.left = Math.max(t.get("left"), -3.14159265), e.right = Math.min(t.get("right"), 3.14159265)), e.usePitchConstraints = t.get("usePitchConstraints"), e.usePitchConstraints && (e.up = t.get("up"), e.down = t.get("down")))
            },
            _saveZoom: function (e) {
                var t = this.model.limits(),
                    i = Math.max(this._switchManipulator.getOrbitManipulator().getDistance(), t[e].min);
                this.model.set(e, i)
            },
            cameraMove: function (e) {
                e && l.a.draw(), this._cameraMoved = f.Timer.instance().tick(), this._cameraIdle && (this._viewer.trigger("cameraStart"), this._cameraIdle = !1)
            },
            cameraIdleNessDetect: function () {
                var e = 2 * l.a.getFrameTimeAverage();
                this.timer = window.setTimeout(this.cameraIdleNessDetectBinded, e), f.Timer.instance().tick() - this._cameraMoved - e <= e || this._cameraIdle || (this._viewer.trigger("cameraStop"), this._cameraIdle = !0)
            }
        });
    t.a = g
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(20),
        a = n.a.osg,
        o = n.a.osgGA,
        s = function (e) {
            o.FirstPersonManipulator.call(this, e);
            var t = Math.max(0, Math.min(4, Object(r.a)().fpsSpeed / 25));
            this._stepFactor = t, this.getControllerList().StandardMouseKeyboard._stepFactor = t, this._postMultRotate = a.quat.create(), this._resetInitialVR = !1, this._lookPosition._delay = .25
        };
    a.createPrototypeObject(s, a.objectInherit(o.FirstPersonManipulator.prototype, {
        getPostMultRotate: function () {
            return this._postMultRotate
        },
        setResetInitialRotationVR: function (e) {
            this._resetInitialVR = e, e || a.quat.identity(this._postMultRotate)
        },
        setNode: function (e) {
            o.FirstPersonManipulator.prototype.setNode.call(this, e);
            var t = this.getHomeBoundingSphere();
            t && t.valid() && (this._distance = this.getHomeDistance(t))
        },
        setInitialPoseVR: function () {
            var e = a.quat.create(),
                t = a.mat4.create(),
                i = a.vec3.fromValues(0, 0, 1);
            return function (n, r) {
                a.mat4.lookAt(t, n, r, i), a.mat4.invert(t, t), a.mat4.getRotation(e, t), e[1] = e[0] = 0, a.quat.normalize(e, e), a.quat.copy(this._postMultRotate, e), this.setEyePosition(n), this.setTarget(r), this.setResetInitialRotationVR(!0)
            }
        }(),
        setPoseVR: function () {
            var e = a.vec3.create();
            return function (t, i) {
                this._resetInitialVR && (a.quat.invert(this._vrRot, t), this._vrRot[0] = this._vrRot[1] = 0, a.quat.normalize(this._vrRot, this._vrRot), a.quat.multiply(this._postMultRotate, this._vrRot, this._postMultRotate)), a.quat.multiply(this._vrRot, this._postMultRotate, t), a.vec3.transformQuat(e, i, this._postMultRotate), this._resetInitialVR ? (a.vec3.set(this._vrTrans, 0, 0, 0), this._resetInitialVR = !1) : a.vec3.sub(this._vrTrans, e, this._vrPos), a.vec3.copy(this._vrPos, e), this._vrEnable = !0
            }
        }()
    }), "osgSketchfab", "FirstPersonManipulator"), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = .5 * Math.PI * .99,
        a = n.a.osg,
        o = n.a.osgGA,
        s = function (e) {
            o.OrbitManipulator.call(this, e), this.setLimitPitchUp(r), this.setLimitPitchDown(-r), this._enableRecenter = !0, this._zoomEMA = 0, this._pitchEMA = 0, this._yawEMA = 0, this._panVEMA = 0, this._panHEMA = 0, this._constrainPan = !1, this._constrainedTarget = a.vec3.create()
        };
    a.createPrototypeObject(s, a.objectInherit(o.OrbitManipulator.prototype, {
        setEyePosition: function () {
            var e = a.vec3.create(),
                t = a.vec3.create(),
                i = a.vec3.create();
            return function (n, r) {
                var o = this._rotation,
                    s = this._target;
                if (a.vec3.sub(e, n, s), a.vec3.normalize(e, e), r) {
                    var u = a.vec3.dot(e, this._upz);
                    if (Math.abs(u) > .99) {
                        var l = Math.sqrt((1 - .9801) / (e[0] * e[0] + e[1] * e[1]));
                        e[0] *= l, e[1] *= l, e[2] = .99 * Math.sign(u)
                    }
                }
                a.vec3.cross(t, e, this._upz), a.vec3.normalize(t, t), a.vec3.cross(i, t, e), a.vec3.normalize(i, i), o[0] = t[0], o[1] = e[0], o[2] = i[0], o[3] = 0, o[4] = t[1], o[5] = e[1], o[6] = i[1], o[7] = 0, o[8] = t[2], o[9] = e[2], o[10] = i[2], o[11] = 0, o[12] = 0, o[13] = 0, o[14] = 0, o[15] = 1, this._distance = a.vec3.dist(s, n)
            }
        }(),
        enableRecenter: function (e) {
            this._enableRecenter = e
        },
        computeHomePosition: function (e) {
            this._enableRecenter && o.OrbitManipulator.prototype.computeHomePosition.call(this, e)
        },
        _computeEMA: function (e, t) {
            return 0 === t ? e : .2 * e + .8 * t
        },
        _getLimitReached: function (e, t, i) {
            return Math.abs(e - i) < .001 ? i : Math.abs(e - t) < .001 ? t : void 0
        },
        computeZoom: function (e) {
            if (o.OrbitManipulator.prototype.computeZoom.call(this, e), this._constrainZoom) {
                e -= 1;
                var t = 1;
                e < 0 && (e = -e, t = -1);
                var i = this.getSpeedFactor() * e,
                    n = this._getLimitReached(this.getDistance(), this._limitZoomIn, this._limitZoomOut);
                void 0 !== n && (void 0 === this._prevDistance && (this._prevDistance = n), i = i / (1 + i) * (.1 * this.getDistance()), this._zoomEMA = this._computeEMA(i, this._zoomEMA), t < 0 && this._prevDistance > n || t > 0 && this._prevDistance < n ? this._distance = this._prevDistance + this.getSpeedFactor() * e * t : this._distance = n + this._zoomEMA * t), this._prevDistance = this._distance
            }
        },
        _computePitch: function (e, t) {
            var i;
            if (e = void 0 !== this._previousPitch ? this._previousPitch : e, i = o.OrbitManipulator.prototype._computePitch.call(this, e, t), !this._constrainPitch || 0 === t) return this._previousPitch = void 0, i;
            this._previousPitch = i;
            var n = t / 10;
            n = n / (1 + n) * .5;
            var a = this._getLimitReached(i, this._limitPitchUp, this._limitPitchDown);
            return void 0 !== a && (this._pitchEMA = this._computeEMA(n, this._pitchEMA), i = a + this._pitchEMA), Math.max(Math.min(i, r), -r)
        },
        _computeYaw: function (e, t) {
            var i;
            if (e = void 0 !== this._previousYaw ? this._previousYaw : e, i = o.OrbitManipulator.prototype._computeYaw.call(this, e, t), !this._constrainYaw || 0 === t) return this._previousYaw = void 0, i;
            this._previousYaw = i;
            var n = t / 10;
            n = n / (1 + n) * 3;
            var r = this._getLimitReached(i, this._limitYawLeft, this._limitYawRight);
            return void 0 !== r && (this._yawEMA = this._computeEMA(n, this._yawEMA), i = r + this._yawEMA), i
        },
        computePan: function (e, t) {
            !this._constrainPan || 0 === e && 0 === t || (this._panVEMA = this._computeEMA(e / (1 + e) * .5, this._panVEMA), this._panHEMA = this._computeEMA(t / (1 + t) * .5, this._panHEMA), e = this._panVEMA, t = this._panHEMA, a.vec3.copy(this._target, this._constrainedTarget)), o.OrbitManipulator.prototype.computePan.call(this, e, t)
        },
        setConstrainPan: function (e) {
            this._constrainPan = e
        },
        isConstrainPan: function () {
            return this._constrainPan
        },
        setPanConstraintTarget: function (e) {
            a.vec3.copy(this._constrainedTarget, e)
        }
    }), "osgSketchfab", "OrbitManipulator"), t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(69),
        a = i(120),
        o = i(85),
        s = i(77),
        u = i(44),
        l = i(634),
        c = i(444),
        h = i(159),
        d = i(88),
        f = i(199),
        p = i(1278),
        m = i.n(p),
        g = i(1279),
        v = i.n(g),
        _ = n.a.osg,
        b = n.a.osgUtil,
        S = n.a.InputGroups,
        x = _.vec4.fromValues(.309375, .8640625, 1, 1),
        y = _.vec4.fromValues(1, 1, 0, 1),
        C = _.vec3.fromValues(-1, 0, 0),
        T = _.vec3.fromValues(.05, .05, .05),
        w = 2 * Math.PI,
        M = d.a.BLEND_SUBSTRACTIVE,
        E = d.a.DEPTH_DISABLE,
        A = _.StateAttribute.ON,
        P = function (e, t) {
            return (e % t + t) % t
        },
        R = function (e, t) {
            _.MatrixTransform.call(this), this.setName("Camera - Constraints Gizmo"), this._manipulator = e, this._model = t, this._defaults = this._model.getInstance();
            var i = this._model.computeAngleOffset(this._defaults.left, this._defaults.right);
            this._defaults.angle = i[0], this._defaults.offset = i[1], this._circleGeom = b.GizmoGeometry.createCircleGeometry(128, 1, 2.015 * Math.PI), this._arcGeom = b.GizmoGeometry.createCircleGeometry(64, 1, 1.015 * Math.PI), this._pivotNode = new _.MatrixTransform, this._arcNode = new _.MatrixTransform, this._circleNode = new _.MatrixTransform, this._circleNode.setName("Camera - Constraints Gizmo - circleNode"), this._pivotNode.addChild(this._arcNode), this._pivotNode.addChild(this._circleNode), this._arcCenter = this._makeArc(this._arcGeom), this._arcLeft = this._makeArc(this._arcGeom, -Math.PI), this._arcRight = this._makeArc(this._arcGeom, Math.PI), this._arcHalfLeft = this._makeArc(this._arcGeom, .5 * -Math.PI), this._arcHalfRight = this._makeArc(this._arcGeom, .5 * Math.PI), this._circleCenter = this._makeCircle(), this._circleUp = this._makeCircle(), this._circleDown = this._makeCircle(), this._pivotNode.editMask = b.NodeGizmo.PICK_ARROW | b.NodeGizmo.PICK_PLANE, this.addChild(this._pivotNode), this.setGizmoStateset(x), this._makeCenter(), this._geomHandle = new _.createTexturedBoxGeometry(0, 0, 0, .02, .02, .02), this._handleCenter = this._makeHandle("handleCenter"), this._handleUp = this._makeHandle("handleUp"), this._handleDown = this._makeHandle("handleDown"), this._handleLeft = this._makeHandle("handleLeft"), this._handleRight = this._makeHandle("handleRight"), this._startCoord = _.vec2.create(), f.a.initCamera(this), this.setVisible(!1)
        };
    R.prototype = _.objectInherit(_.MatrixTransform.prototype, {
        _makeArc: function (e, t) {
            var i = new _.MatrixTransform,
                n = new _.MatrixTransform;
            return n.addChild(e), _.mat4.fromRotation(n.getMatrix(), .5 * -Math.PI, _.vec3.fromValues(0, 1, 0)), t && _.mat4.fromZRotation(i.getMatrix(), t), i.addChild(n), this._arcNode.addChild(i), i
        },
        _makeCircle: function () {
            var e = new _.MatrixTransform;
            return this._circleNode.addChild(e), e.addChild(this._circleGeom), e
        },
        _makeCenter: function () {
            this._centerNode = new _.MatrixTransform, this._pivotNode.addChild(this._centerNode);
            var e = this._centerNode.getOrCreateStateSet(),
                t = a.a.getOrCreateShader(m.a, v.a, "icon", "CamConstraintsIcon", "ICON");
            e.setAttributeAndModes(t), this._centerIcon = this._addIcon(this._centerNode, l.a.iconCamCenter, "center")
        },
        _makeHandle: function (e) {
            var t = new _.MatrixTransform;
            t.setName(e), t.setNodeMask(-1), t.addChild(this._geomHandle), _.mat4.fromTranslation(t.getMatrix(), C);
            var i = t.getOrCreateStateSet();
            return this._setupColorAndAlpha(x, 1, i), i.addUniform(_.Uniform.createFloat(1, "uUp")), i.addUniform(_.Uniform.createFloat(-1, "uDown")), this._circleNode.addChild(t), t
        },
        _getIconGeom: function () {
            return this._quadGeom || (this._quadGeom = _.createTexturedQuadGeometry(-.5, -.5, 0, 1, 0, 0, 0, 1, 0), this._quadGeom.setNodeMask(-1), this._quadGeom.setName("iconGeom")), this._quadGeom
        },
        _addIcon: function (e, t, i) {
            var n = new _.MatrixTransform;
            n.addChild(this._getIconGeom()), n.setName(i + "Icon"), e.addChild(n);
            var r = s.default.instance.getOrCreateTexture(t, {
                    internalFormat: _.Texture.RGBA
                }),
                a = n.getOrCreateStateSet();
            return a.setTextureAttributeAndModes(0, r.texture, A), a.addUniform(_.Uniform.createInt(0, "uTextureIcon")), this._setupColorAndAlpha(x, 1, a), n
        },
        _getGizmo: function () {
            var e = this._model._viewer.getFeaturesManager();
            return e ? e.getNodeGizmo() : null
        },
        setPivotSelected: function (e) {
            this._getGizmo().attachToNode(e ? this._centerNode : void 0)
        },
        setGizmoStateset: function (e) {
            this._circleGeom.getOrCreateStateSet().removeAttribute("Program"), this._arcGeom.getOrCreateStateSet().removeAttribute("Program");
            var t = this._pivotNode.getOrCreateStateSet();
            t.setRenderBinDetails(o.a.EDITOR_GIZMO, "RenderBin"), t.setAttributeAndModes(a.a.getOrCreateShader(m.a, v.a, "gizmo", "CamConstraintsGizmo"), A), t.setAttributeAndModes(M, A), t.setAttributeAndModes(E, A), this._setupColorAndAlpha(e, .4, t), this._setupColorAndAlpha(e, 1, this._circleDown.getOrCreateStateSet()), this._setupColorAndAlpha(e, 1, this._circleUp.getOrCreateStateSet()), this._setupColorAndAlpha(e, 1, this._arcLeft.getOrCreateStateSet()), this._setupColorAndAlpha(e, 1, this._arcRight.getOrCreateStateSet());
            var i = this._arcNode.getOrCreateStateSet();
            this._uUp = _.Uniform.createFloat(1, "uUp"), i.addUniform(this._uUp), this._uDown = _.Uniform.createFloat(-1, "uDown"), i.addUniform(this._uDown);
            var n = this._circleNode.getOrCreateStateSet();
            this._uHUp = _.Uniform.createFloat(1, "uUp"), n.addUniform(this._uHUp), n.addUniform(_.Uniform.createFloat(-1, "uDown"))
        },
        _setupColorAndAlpha: function (e, t, i) {
            i.addUniform(_.Uniform.createFloat4(e, "uColor")), i.addUniform(_.Uniform.createFloat(t, "uAlpha"))
        },
        setVisible: function (e) {
            this.setNodeMask(e ? r.a.NO_SHADOW : 0), e ? this._manipulator.getInputManager().setEnable(S.CAMERA_GIZMO, !0) : this._manipulator.getInputManager().setEnable(S.CAMERA_GIZMO, !1)
        },
        motion: function () {
            var e = _.vec2.create();
            return function (t) {
                if (_.vec2.set(e, t.canvasX, t.canvasY), this._dragging) return void this._onDrag(e);
                if (h.a.isInitialized()) {
                    var i = h.a.computeNearestIntersection2D(e[0], e[1], r.a.PICK, this);
                    if (!i) return void this._onHover();
                    var n = i._nodePath.length,
                        a = i._nodePath[n - 1];
                    if (a === this._getIconGeom() || a === this._geomHandle) {
                        var o = i._nodePath[n - 2];
                        this._onHover(o)
                    }
                }
            }
        }(),
        _onDrag: function () {
            var e = _.vec3.create(),
                t = _.vec3.create();
            return function (i) {
                var n = this._model._viewer.getCanvas(),
                    r = n.height,
                    a = this._model.get("usePitchConstraints"),
                    o = this._model.get("useYawConstraints");
                if (a) {
                    var s = (this._startCoord[1] - i[1]) / r * 2;
                    if (this._dragging === this._handleUp) return void this._model.set("up", Math.asin(_.clamp(this._startModel.up + s, -1, 1)));
                    if (this._dragging === this._handleDown) return void this._model.set("down", Math.asin(_.clamp(this._startModel.down + s, -1, 1)))
                }
                if (o) {
                    this._getDragPosition(t, i), _.vec3.sub(e, t, this._model.get("target")), _.vec3.normalize(e, e);
                    var u = this._startModel.a1,
                        l = Math.atan2(e[0], e[1]),
                        c = Math.sign(_.vec3.cross(e, this._startModel.baseDir, e)[2]),
                        h = 0,
                        d = this._model.get("angle");
                    if (this._dragging === this._handleLeft) return h = this._clampAngle(2 * (l - u), -c, d), void this._model.set("angle", h);
                    if (l > 0 && (l -= w), this._dragging === this._handleRight) return h = this._clampAngle(2 * (u - l), c, d), void this._model.set("angle", h);
                    this._dragging === this._handleCenter && this._model.set("offset", P(this._startModel.offset + (u - l), w))
                }
            }
        }(),
        _getDragPosition: function () {
            var e = _.vec3.create(),
                t = _.vec3.create(),
                i = _.vec3.create(),
                n = _.vec3.create(),
                r = _.vec3.create(),
                a = _.vec3.create();
            return function (o, s) {
                c.a.canvasCoordToGL(s[0], s[1], n), n[2] = 0, h.a.getWorldPositionFromScreenPoint(n, e), n[2] = 1, h.a.getWorldPositionFromScreenPoint(n, t), _.vec3.sub(a, t, e), _.vec3.normalize(a, a), _.vec3.set(r, 0, 0, 1);
                var u = -this._startModel.startPosition[2],
                    l = _.vec3.dot(r, a);
                if (Math.abs(l) < .05) {
                    var d = this._startModel.startPosition;
                    _.vec3.sub(r, d, this._model.get("target")), r[2] = 0, _.vec3.normalize(r, r), _.vec3.set(i, d[0], d[1], 0), i[2] = 0, u = -_.vec3.dot(r, i), l = _.vec3.dot(r, a)
                }
                var f = -(_.vec3.dot(r, e) + u),
                    p = f / l;
                return _.vec3.scaleAndAdd(o, e, a, p), o
            }
        }(),
        _clampAngle: function (e, t, i) {
            return e = P(e, w), t < 0 ? i < w - i ? 0 : w : e
        },
        startDrag: function () {
            var e = _.vec3.create(),
                t = _.vec3.create(),
                i = _.mat4.create();
            return function (n) {
                this._hovered && this._hovered !== this._centerNode && (this._dragging = this._hovered, _.vec2.set(this._startCoord, n.canvasX, n.canvasY), this._handleCenter.getWorldMatrix(this, i), _.mat4.getTranslation(e, i), _.vec3.sub(t, e, this._model.get("target")), _.vec3.normalize(t, t), this._dragging.getWorldMatrix(this, i), _.mat4.getTranslation(e, i), this._startModel = {
                    up: Math.sin(this._model.get("up")),
                    down: Math.sin(this._model.get("down")),
                    offset: this._model.get("offset"),
                    angle: this._model.get("angle"),
                    startPosition: e,
                    baseDir: t,
                    a1: Math.atan2(t[0], t[1])
                }, this._manipulator.getInputManager().setEnable(S.MANIPULATORS, !1), this._savedEnableState = this._model.get("enableCameraConstraints"), this._model.set("enableCameraConstraints", !1))
            }
        }(),
        endDrag: function (e) {
            this._dragging && (this._manipulator.getInputManager().setEnable(S.MANIPULATORS, !0), this._dragging = void 0, this.motion(e), this._model.set("enableCameraConstraints", this._savedEnableState))
        },
        _onHover: function (e) {
            if (e !== this._hovered) {
                if (this._hovered && (this._changeColor(this._hovered.getStateSet(), x), this._changeColor(this._circleUp.getStateSet(), x), this._changeColor(this._arcLeft.getStateSet(), x), this._changeColor(this._arcRight.getStateSet(), x), this._changeColor(this._circleDown.getStateSet(), x), u.a.draw()), !e) return void(this._hovered = void 0);
                switch (this._hovered = e, this._changeColor(e.getStateSet(), y), e) {
                    case this._handleCenter:
                        this._changeColor(this._circleDown.getStateSet(), y), this._changeColor(this._circleUp.getStateSet(), y), this._changeColor(this._arcLeft.getStateSet(), y), this._changeColor(this._arcRight.getStateSet(), y);
                        break;
                    case this._handleUp:
                        this._changeColor(this._circleUp.getStateSet(), y);
                        break;
                    case this._handleDown:
                        this._changeColor(this._circleDown.getStateSet(), y);
                        break;
                    case this._handleLeft:
                        this._changeColor(this._arcLeft.getStateSet(), y);
                        break;
                    case this._handleRight:
                        this._changeColor(this._arcRight.getStateSet(), y)
                }
                u.a.draw()
            }
        },
        _changeColor: function (e, t) {
            var i = e.getUniform("uColor").getInternalArray();
            _.vec4.copy(i, t)
        },
        update: function () {
            var e = _.vec4.create(),
                t = _.vec3.create(),
                i = _.vec3.create();
            return function (n) {
                var r = n.getViewport(),
                    a = r.width() / r.height(),
                    o = _.mat4.getScale(e, n.getProjectionMatrix())[0],
                    s = Math.max(1.2, a * (1.1 + .2 / o) * o);
                this._manipulator.getEyePosition(t);
                var u = this._model.get("target"),
                    l = this._getGizmo();
                l.isEditing() ? (_.mat4.getTranslation(u, l.getMatrix()), this._needsCameraUpdate = !0) : this._needsCameraUpdate && (this._needsCameraUpdate = !1, this._model.trigger("targetChanged"));
                var c = _.vec3.dist(t, u) / s,
                    h = this._pivotNode.getMatrix();
                _.vec3.set(i, c, c, c), _.mat4.fromTranslation(h, u), _.mat4.scale(h, h, i);
                var d = this._centerNode.getMatrix();
                _.mat4.invert(d, n.getViewMatrix()), _.mat4.setTranslation(d, _.vec3.ZERO), _.mat4.scale(d, d, T), this._pivotNode.dirtyBound(), this._centerNode.dirtyBound()
            }
        }(),
        updateConstraints: function () {
            var e = this._model.get("usePitchConstraints"),
                t = this._model.get("useYawConstraints"),
                i = e ? this._model.get("up") : this._defaults.up,
                n = e ? this._model.get("down") : this._defaults.down,
                r = .5 * (i + n);
            this._updatePitchWidget(this._circleUp, i), this._updatePitchWidget(this._circleDown, n), this._updatePitchWidget(this._circleCenter, r);
            var a = t ? this._model.get("offset") : this._defaults.offset,
                o = t ? this._model.get("angle") : this._defaults.angle,
                s = .5 * o;
            e || t ? (this._circleNode.setNodeMask(-1), this._arcNode.setNodeMask(-1), _.mat4.fromZRotation(this._circleNode.getMatrix(), a - .5 * Math.PI), _.mat4.fromZRotation(this._arcCenter.getMatrix(), a), _.mat4.fromZRotation(this._arcLeft.getMatrix(), a - s), _.mat4.fromZRotation(this._arcRight.getMatrix(), a + s), _.mat4.fromZRotation(this._arcHalfLeft.getMatrix(), a - .5 * s), _.mat4.fromZRotation(this._arcHalfRight.getMatrix(), a + .5 * s)) : (this._circleNode.setNodeMask(0), this._arcNode.setNodeMask(0)), this._updateHandles(e, t, i, n, r, s), _.mat4.fromTranslation(this._pivotNode.getMatrix(), this._model.get("target")), this._uUp.getInternalArray()[0] = Math.sin(i), this._uDown.getInternalArray()[0] = Math.sin(n), this._uHUp.getInternalArray()[0] = -Math.cos(.5 * o), this.dirtyBound(), this._pivotNode.dirtyBound(), this._circleNode.dirtyBound(), u.a.draw()
        },
        _updateHandles: function (e, t, i, n, r, a) {
            if (e) {
                this._handleUp.setNodeMask(-1), this._handleDown.setNodeMask(-1);
                var o = i - n;
                this._updateHandleWidget(this._handleUp, o < .07 ? r + .035 : i, 0), this._updateHandleWidget(this._handleDown, o < .07 ? r - .035 : n, 0)
            } else this._handleUp.setNodeMask(0), this._handleDown.setNodeMask(0);
            t ? (this._handleRight.setNodeMask(-1), this._handleLeft.setNodeMask(-1), this._handleCenter.setNodeMask(-1), a = a < .035 ? .035 : a, a = a > Math.PI - .035 ? Math.PI - .035 : a, this._updateHandleWidget(this._handleRight, r, a), this._updateHandleWidget(this._handleLeft, r, -a), this._updateHandleWidget(this._handleCenter, r, 0)) : (this._handleRight.setNodeMask(0), this._handleLeft.setNodeMask(0), this._handleCenter.setNodeMask(0))
        },
        _updateHandleWidget: function (e, t, i) {
            var n = e.getMatrix();
            _.mat4.fromZRotation(n, i), _.mat4.rotateY(n, n, t), _.mat4.translate(n, n, C), e.dirtyBound()
        },
        _updatePitchWidget: function () {
            var e = _.vec3.create(),
                t = _.vec3.create();
            return function (i, n) {
                var r = i.getMatrix(),
                    a = Math.sin(n),
                    o = Math.cos(n);
                _.vec3.set(e, 0, 0, a), _.vec3.set(t, o, o, 1), _.mat4.fromTranslation(r, e), _.mat4.scale(r, r, t)
            }
        }()
    }), t.a = R
}, function (e, t, i) {
    e.exports = i.p + "target-ff54e741c7266e6dc9a8c0538f99c6d0.png"
}, function (e, t, i) {
    e.exports = i.p + "eye-slash-ff805f0fec76820991335845a87896c4.png"
}, function (e, t, i) {
    e.exports = i.p + "Direction-da0354ccc70bc3322aa657cdcd356e39.png"
}, function (e, t, i) {
    e.exports = i.p + "Spot-7484bdcd407b8b2416471e8e6cd23770.png"
}, function (e, t, i) {
    e.exports = i.p + "Point-7493691bc0625a4c8a09393c65c39e5c.png"
}, function (e, t, i) {
    e.exports = i.p + "Hemi-069d53239a191b55450d472c13408320.png"
}, function (e, t, i) {
    e.exports = i.p + "Sound-c9d6e5b9ed6c02f1dfaea84e549485c1.png"
}, function (e, t, i) {
    e.exports = i.p + "Hotspot-f705d389cfa9353c3ab7e6ce58f49b3f.png"
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(583),
        a = i(88),
        o = i(179),
        s = n.a.osg,
        u = {
            DEFAULT: 1,
            EARLYZ_OPAQUE: 2,
            EARLYZ_TRANSPARENT: 4,
            OPAQUE_SHADING: 8,
            TRANSPARENT_SHADING: 16,
            REFRACTION: 32,
            EXTRA: 64,
            SHADOWMAP: 128
        };
    u.ANY_OPAQUE = u.EARLYZ_OPAQUE | u.OPAQUE_SHADING, u.ANY_TRANSPARENT = u.REFRACTION | u.EARLYZ_TRANSPARENT | u.TRANSPARENT_SHADING;
    var l = {
            depth: void 0,
            blend: void 0,
            colorMask: void 0
        },
        c = {
            LAST_LEAF: void 0,
            passTypes: u,
            forceAttribute: l,
            currentPass: u.DEFAULT
        },
        h = r.a.vrConfig,
        d = {},
        f = s.RenderLeaf.prototype.drawGeometry,
        p = s.getOrCreateStateAttributeTypeMemberIndexFromName("SketchfabMaterial"),
        m = function (e, t, i) {
            if (!i) return t.applyAttribute(a.a.CULL_DISABLE), void f.call(e, t);
            var n = c.currentPass,
                r = !1;
            if (n === u.TRANSPARENT_SHADING) {
                var o = t._attributeArray[p],
                    l = o ? o._lastApplied : void 0;
                if (l) {
                    r = !l.getAdditive() && l.getCullFace() === s.CullFace.DISABLE
                }
            }
            r && t.applyAttribute(a.a.CULL_FRONT), f.call(e, t), r && (t.applyAttribute(a.a.CULL_BACK), e._geometry.drawImplementation(t))
        },
        g = function (e, t, i) {
            var n = t.uDrawOpaque;
            if (void 0 !== n) {
                var r = c.currentPass,
                    a = o.a.uDrawOpaque,
                    s = a.getInternalArray(),
                    l = r & u.ANY_TRANSPARENT ? 0 : 1;
                s[0] = l;
                var h = i.getInstanceID();
                d[h] !== l && (d[h] = l, a.apply(e, n))
            }
        },
        v = function (e, t, i) {
            i._QVT && void 0 !== t.uQVT && (o.a.uQVT.setFloat3(i._QVT), o.a.uQVT.apply(e, t.uQVT), o.a.uQVS.setFloat3(i._QVS), o.a.uQVS.apply(e, t.uQVS));
            var n = i._listQuantUV;
            if (n)
                for (var r = 0, a = n.length; r < a; ++r) {
                    var s = n[r],
                        u = s.uniformName,
                        l = t[u];
                    void 0 !== l && (o.a[u].setFloat4(s._QUV), o.a[u].apply(e, l))
                }
        },
        _ = function (e) {
            var t = e._attributeArray[p],
                i = t ? t._lastApplied : void 0;
            if (!i) return !0;
            var n = c.currentPass;
            if (!i.getDepthWrite() && n & u.ANY_OPAQUE) return !1;
            if (!i.getCastShadows() && n & u.SHADOWMAP) return !1;
            if (n !== u.EARLYZ_TRANSPARENT) return !0;
            var r = i.getAdditive(),
                o = r ? a.a.BLEND_ADDITIVE : a.a.BLEND_SUBSTRACTIVE;
            return e.applyAttribute(o), !0
        },
        b = function (e) {
            for (var t = e.getPrimitiveSetList(), i = 0, n = t.length; i < n; ++i)
                if (t[i].getMode() >= s.primitiveSet.TRIANGLES) return !0;
            return !1
        };
    s.RenderLeaf.prototype.drawGeometry = function (e) {
        if (_(e)) {
            l.depth && e.applyAttribute(l.depth), l.blend && e.applyAttribute(l.blend), l.colorMask && e.applyAttribute(l.colorMask);
            var t = e.getGraphicContext(),
                i = e.getLastProgramApplied(),
                n = i.getUniformsCache();
            g(t, n, i), v(t, n, this._geometry);
            var r = b(this._geometry),
                a = c.LAST_LEAF;
            if (!a.isVR) return void m(this, e, r);
            var o = h.leftRenderWidth;
            e.viewport(0, 0, o, h.leftRenderHeight), this._projection = a.leftProjection, this._modelView = a.leftModelView, this._view = a.leftView, m(this, e, r), e.viewport(o, 0, o, h.rightRenderHeight), this._projection = a.rightProjection, this._modelView = a.rightModelView, this._view = a.rightView, m(this, e, r)
        }
    }, t.a = c
}, function (e, t, i) {
    "use strict";
    var n = i(692),
        r = i.n(n),
        a = {
            initGestures: function (e) {
                var t = e.getInputSource("TouchScreen");
                if (t) {
                    var i = t.getHammer();
                    i.get("pan").set({
                        enable: !1
                    });
                    var n = new r.a.Pinch({
                            enable: !0,
                            threshold: .1
                        }),
                        a = new r.a.Pan({
                            event: "panh",
                            direction: r.a.DIRECTION_HORIZONTAL
                        }),
                        o = new r.a.Pan({
                            event: "panv",
                            direction: r.a.DIRECTION_VERTICAL
                        });
                    o.requireFailure(a), a.requireFailure(n), i.add(a), i.add(o), i.add(n)
                }
            }
        };
    t.a = a
}, function (e, t) {
    e.exports = "attribute vec3 Vertex;\n\n#ifdef ICON\n attribute vec2 TexCoord0;\n varying vec2 vTexCoord0;\n#else\n varying vec3 pos;\n#endif\n\n\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n  #ifdef ICON\n    vTexCoord0 = TexCoord0;\n  #else\n    pos = Vertex.xyz;\n  #endif\n\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xyz, 1.0));\n}\n"
}, function (e, t) {
    e.exports = "\nuniform float uAlpha;\n\nuniform vec4 uColor;\n\nuniform float uUp;\nuniform float uDown;\n\n#ifdef ICON\n    uniform sampler2D uTextureIcon;\n    varying vec2 vTexCoord0;\n#else\n    varying vec3 pos;\n#endif\n\nvoid main(void) {\n\n    #ifdef ICON\n        gl_FragColor = vec4(uColor.rgb, uAlpha) * texture2D(uTextureIcon, vTexCoord0);\n    #else\n        float alpha = step(pos.x, uUp) * step(uDown, pos.x);\n        gl_FragColor = vec4(uColor.rgb, uAlpha * alpha);\n    #endif\n\n    gl_FragColor.rgb *= gl_FragColor.a;\n}\n"
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(47),
        a = i(708),
        o = i(633),
        s = n.a.osg,
        u = n.a.osgAnimation,
        l = function (e, t, i) {
            this.cameraUpdateCallback = i, this._fpsDist = -1, this._manipulator = e, this._eyeEnd = s.vec3.create(), this._eyeDeltaLen = 0, this._targetEnd = s.vec3.create(), this._targetDeltaLen = 0, this._lastRatio = 0, this._preventFlip = !1, a.a.call(this, t), this._finished = !0, this._easingFunction = u.easeOutQuart
        };
    s.createPrototypeObject(l, s.objectInherit(a.a.prototype, {
        setTargetAndEye: function () {
            var e = s.vec3.create();
            return function (t, i, n) {
                if (this._preventFlip = n, this._finished) {
                    var r = this._manipulator.getManipulatorList()[o.a.FPS];
                    this._fpsDist = r.getDistance()
                }
                s.vec3.copy(this._eyeEnd, i), this._manipulator.getEyePosition(e), this._eyeDeltaLen = s.vec3.len(s.vec3.sub(e, i, e)), s.vec3.copy(this._targetEnd, t), this._manipulator.getTarget(e), this._targetDeltaLen = s.vec3.len(s.vec3.sub(e, t, e)), this._lastRatio = 0, this.reset()
            }
        }(),
        update: function () {
            var e = s.vec3.create(),
                t = s.vec3.create(),
                i = s.vec3.create(),
                n = s.vec3.create();
            return function (a, u) {
                if (!0 === this._finished) return !0;
                var l = this._manipulator,
                    c = l.getCurrentManipulatorIndex();
                c === o.a.FPS && l.setManipulatorIndex(o.a.ORBIT);
                var h = u.getFrameStamp().getSimulationTime(),
                    d = this.interpolate(h, a, u);
                d = this._easingFunction(d);
                var f = d - this._lastRatio;
                this._lastRatio = d;
                var p = this._manipulator;
                if (p.getEyePosition(e), p.getTarget(t), s.vec3.sub(i, this._targetEnd, t), s.vec3.normalize(i, i), s.vec3.add(n, t, s.vec3.scale(n, i, f * this._targetDeltaLen)), p.setTarget(n), s.vec3.sub(i, this._eyeEnd, e), s.vec3.normalize(i, i), s.vec3.add(n, e, s.vec3.scale(n, i, f * this._eyeDeltaLen)), p.setEyePosition(n, this._preventFlip), c === o.a.FPS) {
                    var m = l.getDistance();
                    l.setManipulatorIndex(c), l.getCurrentManipulator().setDistance(this._finished ? this._fpsDist : m)
                }
                return !0 === this._finished && r.a.resolveFirstCameraAnimation(), this.cameraUpdateCallback(), !0
            }
        }(),
        setEasingFunction: function (e) {
            this._easingFunction = u[e]
        }
    }), "osgSketchfab", "UpdateCallbackCameraAnimation"), t.a = l
}, function (e, t, i) {
    "use strict";
    var n = i(90),
        r = i(1282),
        a = i(710),
        o = a.a.extend({
            _textureTrashbin: [],
            _matcapTrashbin: [],
            getName: function () {
                return "Material"
            }
        }),
        s = {
            FeatureName: "material",
            ModelType: o,
            ViewListType: [r.a]
        },
        u = n.a.create(s);
    u.prototype.getSceneLights = function () {
        return this._views[0].getSceneLights()
    }, t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(5),
        r = i.n(n),
        a = i(9),
        o = i(0),
        s = (i.n(o), i(86)),
        u = i(8),
        l = i(47),
        c = i(20),
        h = i(77),
        d = i(1283),
        f = i(1293),
        p = i(229),
        m = i(152),
        g = i(119),
        v = i(709),
        _ = i(585),
        b = i(1296),
        S = i(101),
        x = i(79),
        y = i(321),
        C = a.a.osg,
        T = u.a.extend({
            getName: function () {
                return "MaterialManagerView3D"
            },
            initialize: function () {
                u.a.prototype.initialize.apply(this, arguments), this.model.bind("change", this.render, this), g.a.bind("change:mask", this.cleanAndApplyMaterials, this), this._sceneLights = [], this._defaultStateSet = void 0, this._defaultMaterial = void 0, this._tracePathVisitor = new f.a, this.model.setImageCollection(this.getTextureCollection()), this.model.setMatcapCollection(this.getMatcapCollection()), this.init()
            },
            init: function () {
                this._context = this.options.context, this._viewer = this._context.getViewer();
                var e = this._context.getScene();
                this._resourceDefer = new s.a, e.addResourcePromise(this._resourceDefer), l.a.getPolygon().then(this.initSceneGraph.bind(this))
            },
            getTextureCollection: function () {
                return this.getResourceManager().getTextureCollection()
            },
            getMatcapCollection: function () {
                return this.getResourceManager().getMatcapCollection()
            },
            getResourceManager: function () {
                return this._resourceManager || h.default.instance
            },
            getOrCreateDefaultStateSet: function () {
                return void 0 === this._defaultStateSet && (this._defaultStateSet = new C.StateSet, this._defaultStateSet._uniqueID = 0), this._defaultStateSet
            },
            setDefaultMaterial: function (e, t) {
                var i = this.getOrCreateDefaultStateSet();
                if (e.setStateSet(i), !this._defaultMaterial) {
                    if (this._defaultMaterial = t.getMaterialByStateSet(i), this._defaultMaterial) {
                        var n = i.getAttributeMap().Material,
                            r = t.getUniqueMaterialName(n, i, e);
                        this._defaultMaterial.set("name", r)
                    } else this._defaultMaterial = t.createMaterial(e, i);
                    this._defaultMaterial.setStateSet(i)
                }
            },
            addDefaultMaterial: function (e, t, i) {
                0 === e.getMaterials().length && this.setDefaultMaterial(t, i);
                for (var n = this._tracePathVisitor.getPathList(), r = 0, a = n.length; r < a; ++r) {
                    for (var o = n[r], s = o.length, u = !1, l = 0; l < s; ++l) {
                        var c = o[l].getStateSet();
                        if (c && c.getAttribute("SketchfabMaterial")) {
                            u = !0;
                            break
                        }
                    }
                    if (!u) {
                        var h = o[s - 1];
                        this.setDefaultMaterial(h, i)
                    }
                }
            },
            _handleCullFace: function (e) {
                var t = this._context.getModel().get("options"),
                    i = e.userDataMap.sourceTool.toLowerCase(),
                    n = Object(c.a)().singleSided,
                    r = -1 !== i.indexOf("sketchup"),
                    a = r && t.version < 6,
                    o = r && Object(S.a)();
                if (void 0 !== n || o || a) {
                    var s = !1 === n ? C.CullFace.DISABLE : C.CullFace.BACK,
                        u = this.model.getMaterials();
                    for (var l in u) u[l].set("cullFace", s)
                }
            },
            processSceneGraph: function (e, t) {
                var i = new d.a(t),
                    n = i.apply(e);
                if (e.accept(this._tracePathVisitor), this.deleteUnusedMaterials(this._tracePathVisitor), this.addDefaultMaterial(n, e, t), this._sceneLights = n.getLights(), this._handleCullFace(e), Object(S.a)() && "substancepainter" === e.userDataMap.source) {
                    this._viewer.getFeatures().shadingStyle.getModel().set("vertexColorEnable", !1)
                }
                return n
            },
            getSceneLights: function () {
                return this._sceneLights
            },
            initSceneGraph: function () {
                var e = this.model,
                    t = this._viewer.getRootModel(),
                    i = this._viewer.getFeatures();
                if (C.time("initSceneGraph - create saved materials"), !1 === Object(c.a)().processMaterial) {
                    var n = this._context.getModel().get("options").materials;
                    for (var r in n) e.addMaterial(n[r])
                }
                C.timeEnd("initSceneGraph - create saved materials"), C.time("initSceneGraph - processSceneGraph");
                var a = this.processSceneGraph(t, e);
                C.timeEnd("initSceneGraph - processSceneGraph"), C.time("initSceneGraph - apply materials"), e.removeUnboundMaterial();
                var o = i.shadingStyle.getModel(),
                    s = o.get("vertexColorEnable") && o.get("vertexColorUseAlpha");
                e.tagMaterialWithGeometryInfo(t, s), this._requestTextures(), e._style = a.getStyle();
                var u = a.hasMetallicWorkflow();
                void 0 !== u && e.setWorkFlowMetalSpec(u, !1), e.overrideMaterialChannels(Object(c.a)()), e.enforceWorkflowPerMaterial(), e.updateTexCoordUnitList(), y.a.set("protectDepthAndColorUnit", this._checkProtectDepthColor()), this.applyMaterials(), this.setWireframeStateSets(), C.timeEnd("initSceneGraph - apply materials"), b.a.optimize(this._tracePathVisitor, this._viewer), i.quality && i.quality.getModel().trigger("updateTexelPolicy"), l.a.resolveMaterial(), _.a.packAllMaterialsTextures(e.getMaterials())
            },
            _checkProtectDepthColor: function () {
                if (window.RunningTests) return !1;
                if (Object(x.a)() || Object(c.a)().materialShowcase || Object(c.a)().apiVersion) return !0;
                if (this._viewer.getFeatures().postProcess.getModel().isEffectiveSsr()) return !0;
                var e = this.model.getMaterials();
                for (var t in e) {
                    var i = e[t],
                        n = i.getChannels().Opacity;
                    if (n.isEffective() && "refraction" === n.getTransparency()) return !0
                }
                return !1
            },
            setWireframeStateSets: function () {
                if (this._viewer.hasIntegratedWireframe()) {
                    var e = 0,
                        t = this.model,
                        i = {},
                        n = this._tracePathVisitor.getPathList(),
                        r = n.length;
                    for (e = 0; e < r; ++e) {
                        var a = n[e],
                            o = a[a.length - 1];
                        if (o instanceof C.Geometry != !1) {
                            var s = o.getVertexAttributeList().Vertex;
                            s && (i[s.getInstanceID()] = a)
                        }
                    }
                    var u = {},
                        l = this._tracePathVisitor.getWireframePathList(),
                        c = this._context.getScene().getWireframeNodes(),
                        h = c.length;
                    for (e = 0; e < h; ++e) {
                        var d = c[e],
                            f = d.getVertexAttributeList(),
                            p = i[f.Vertex.getInstanceID()];
                        if (p) {
                            var m = p[p.length - 1],
                                g = t.findFirstMaterial(p);
                            g.get("wireframeList").push(d);
                            var _ = g.get("stateSet");
                            d._attributes = m.getVertexAttributeList();
                            var b = _.getAttribute("SketchfabMaterial"),
                                S = b.getInstanceID(),
                                x = u[S];
                            x || (x = u[S] = new v.a, x._textureAttributeArrayList = _._textureAttributeArrayList, x._activeTextureAttributeUnit = _._activeTextureAttributeUnit, x._activeTextureAttribute = _._activeTextureAttribute, x.setAttributeAndModes(b), b.getMaterialModel().set("stateSetWireframe", x)), d.setStateSet(x)
                        } else {
                            c.splice(e, 1), e--, h--;
                            for (var y = d.getParents(), T = 0, w = y.length; T < w; ++T) y[T].removeChild(d);
                            for (var M = 0; M < l.length; ++M) {
                                var E = l[M];
                                E[E.length - 1] === d && (l.splice(M, 1), M--)
                            }
                        }
                    }
                }
            },
            deleteUnusedMaterials: function (e) {
                for (var t = e.getStateSetMapNodes(), i = e.getStateSetPathList(), n = e.getStateSetMap(), r = {}, a = 0, o = i.length; a < o; a++) {
                    var s = i[a];
                    if (s.length > 0) {
                        var u = s.length - 1;
                        r[s[u]._uniqueID] = s[u]
                    }
                }
                for (var l in t)
                    if (void 0 === r[l]) {
                        this.model.removeMaterialByStateSet(n[l]);
                        for (var c = 0, h = t[l].length; c < h; c++) {
                            var d = t[l][c];
                            d.setStateSet(void 0)
                        }
                    }
            },
            cleanAndApplyMaterials: function () {
                var e = this.model.getMaterials();
                for (var t in e) {
                    var i = e[t];
                    i.get("stateSet") && i.trigger("change:stateSet")
                }
                this.applyMaterials()
            },
            applyMaterials: function () {
                var e = this.model.getMaterials();
                for (var t in e) {
                    e[t].trigger("apply")
                }
            },
            _requestTexture: function (e, t, i) {
                if (e) {
                    var n = e.getChannels()[t],
                        r = n.getTextureModel();
                    if (r && n.isEffective()) {
                        var a = r.getMultiresTexture();
                        if (a) {
                            if (0 === a.getImageCount()) return void(n.setColor && n.setColor(C.vec3.fromValues(.9, .9, .9)));
                            return (i ? a.getImageSmallest() : a.getImageMaxSupported()).promise
                        }
                    }
                }
            },
            _requestAllTextures: function (e, t) {
                for (var i = [], n = new window.Set, r = 0; r < m.a.length; ++r) {
                    var a = m.a[r];
                    for (var o in e) {
                        var s = e[o],
                            u = this._requestTexture(s, a, t);
                        u && !n.has(u) && (n.add(u), i.push(u))
                    }
                }
                return i
            },
            _resolvePromiseTextures: function (e, t, i) {
                for (var n = (new Date).getTime() - t, r = 0, a = 0, o = e.length; a < o; ++a) !0 !== e[a] && r++;
                (i ? l.a.resolveLowResLoaded : l.a.resolveHighResLoaded)({
                    time: r > 0 ? n : 0,
                    count: r
                })
            },
            requestAllLowResTextures: function (e) {
                return this._requestAllTextures(e, !0)
            },
            requestAllHighResTextures: function (e) {
                for (var t = this._requestAllTextures(e, !1), i = 0, n = 0, r = t.length; n < r; n++) i += t[n].progressSize;
                return l.a.resolveDataSizeTextures(i), t
            },
            _resolvePromiseLowResTextures: function (e, t) {
                return this._resolvePromiseTextures(e, t, !0)
            },
            _resolvePromiseHighResTextures: function (e, t) {
                return this._resolvePromiseTextures(e, t, !1)
            },
            _requestTextures: function () {
                var e = this,
                    t = Object(c.a)(),
                    i = t.preload;
                p.a.WAIT_ANIMATION = !i;
                var n = this.model.toJSON(),
                    a = this.requestAllLowResTextures(n),
                    s = (new Date).getTime();
                i || this._viewer.setFakePrimaryProgress(a, "texture"), r.a.all(Object(o.map)(a, function (e) {
                    return e.reflect()
                })).then(function () {
                    e._resolvePromiseLowResTextures(a, s);
                    var t = (new Date).getTime(),
                        u = e.requestAllHighResTextures(n);
                    e._viewer.setFakeProgress(u, !i, "texture"), r.a.all(Object(o.map)(u, function (e) {
                        return e.reflect()
                    })).then(function () {
                        e._resolvePromiseHighResTextures(u, t), i && e._resourceDefer.resolve()
                    }), i || e._resourceDefer.resolve()
                })
            },
            _getUniqueTextures: function () {
                var e = {},
                    t = this.model.getMaterials(),
                    i = [];
                for (var n in t)
                    for (var r = t[n], a = r.get("stateSet"), o = a.getNumTextureAttributeLists(), s = 0; s < o; ++s) {
                        var u = a.getTextureAttribute(s, "Texture");
                        u && u.getChannelPacking && (u.isTextureNull() || u.isColorAtlas() || e[u.getInstanceID()] || (e[u.getInstanceID()] = !0, i.push(u)))
                    }
                return i
            },
            getOrCreateTexelInfos: function () {
                if (this._infoTex) return this._infoTex;
                for (var e = this._infoTex = {
                        missingTextures: {},
                        gpuTextureCount: 0,
                        gpuPixelCount: 0,
                        min: 1 / 0,
                        max: -1 / 0
                    }, t = {
                        width: 0,
                        height: 0,
                        missingTextures: e.missingTextures
                    }, i = this._getUniqueTextures(), n = i.length, r = 0; r < n; ++r) {
                    t = i[r].getMaxTextureSizePacked(t), e.gpuTextureCount++, e.gpuPixelCount += t.width * t.height;
                    var a = Math.max(t.width, t.height);
                    e.min = Math.min(a, e.min), e.max = Math.max(a, e.max)
                }
                return e
            }
        });
    t.a = T
}, function (e, t, i) {
    "use strict";
    var n = i(1284),
        r = i(1285),
        a = i(230),
        o = i(101),
        s = function (e) {
            this._materialManager = e
        };
    s.prototype = {
        apply: function (e) {
            var t = new n.a;
            e.accept(t);
            var i = t.getSource(),
                s = t.getAuthoringTool();
            i = i ? i.toLowerCase() : "default";
            var u = r.a[i] ? r.a[i] : r.a.default,
                l = new u(this._materialManager, s, i);
            e.accept(l), Object(o.a)() && l.handleSingleMaterialMapping();
            var c = !a.a.hasTriangles && !a.a.hasVertexNormals;
            ("q3d" === i || c) && (l._style = "shadeless");
            var h = e.getUserData() || [];
            return h.push({
                Name: "source",
                Value: i
            }), h.push({
                Name: "authoringTool",
                Value: s
            }), h.push({
                Name: "sourceTool",
                Value: t.getSourceTool()
            }), e.setUserData(h), e.userDataMap = a.a.convertUserDataToObject(h), l
        }
    }, t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = n.a.osg,
        a = function () {
            r.NodeVisitor.call(this, r.NodeVisitor.TRAVERSE_ALL_CHILDREN), this._source = "", this._authoringTool = "", this._sourceTool = ""
        };
    r.createPrototypeObject(a, r.objectInherit(r.NodeVisitor.prototype, {
        getSource: function () {
            return this._source
        },
        getAuthoringTool: function () {
            return this._authoringTool
        },
        getSourceTool: function () {
            return this._sourceTool
        },
        extractSource: function (e) {
            for (var t = 0, i = e.length; t < i; ++t) {
                var n = e[t],
                    r = n.Name;
                "source" === r ? this._source = n.Value : "authoring_tool" === r ? this._authoringTool = n.Value : "source_tool" === r && (this._sourceTool = n.Value)
            }
        },
        checkStateSet: function (e) {
            e && e.getUserData() && this.extractSource(e.getUserData())
        },
        checkNode: function (e) {
            var t = e.getUserData();
            if (!t) {
                if ("LightSource" !== e.className()) return;
                if (!e.getLight()) return;
                if (!(t = e.getLight().getUserData())) return
            }
            this.extractSource(t)
        },
        apply: function (e) {
            this._source || (this.checkNode(e), this._source || (this.checkStateSet(e.getStateSet()), this._source || this.traverse(e)))
        }
    })), t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(1286),
        r = i(1287),
        a = i(1288),
        o = i(1289),
        s = i(1290),
        u = i(1291),
        l = i(922),
        c = i(1292);
    t.a = {
        default: a.a,
        wavefront: l.a,
        blender: n.a,
        ksp: n.a,
        lightwave: s.a,
        minecraft: u.a,
        collada: r.a,
        fbx: o.a,
        substancepainter: r.a,
        mineways: u.a,
        gltf: c.a
    }
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(9)),
        a = i(409),
        o = i(584),
        s = i(230),
        u = r.a.osg,
        l = function () {
            a.a.apply(this, arguments)
        };
    u.createPrototypeObject(l, u.objectInherit(a.a.prototype, {
        _handleCycleDefaultValue: function (e, t, i, n, r, a) {
            if (void 0 !== e)
                if (Array.isArray(e))
                    if ("Opacity" === t)
                        if ("Color" === i) {
                            var o = e[0] * e[1] * e[2] * e[3];
                            1 === o && (o = .15), n[r](t, o)
                        } else n[r](t, e);
            else "SpecularPBR" === t ? "Color" === i ? n[r](t, e) : (e = e[0] * e[1] * e[2] * e[3], n[r](t, e)) : "Color" === i && "NormalMap" === t || n[r](t, e);
            else "setChannelFactor" === r && ("Strength" === i && "Emission" === a && (e /= 10), n[r](t, e))
        },
        _handleCycleLinkSpecular: function (e, t, i, n, r, a) {
            for (var o = 0; o < e.links.length; o++) {
                var s = e.links[o];
                if (s.from_node) {
                    var l = t.nodes[s.from_node],
                        c = l && l.texture_slot,
                        h = l && i.getTextureAttribute(c, "Texture");
                    if (!l || !h) return void u.warn("Missing Texture linked in " + a + " node destined to " + r);
                    var d = this.createTextureOptionsFromTextureOSG(h);
                    if (d) {
                        var f = n.getChannels()[r];
                        f.setupTextureModel(d), f.resetTextureFormat(), f.setTexCoordUnit(c), f.setEnable(!0), this._texturesAssigned.push(h)
                    }
                }
            }
        },
        cyclesNodeToMaterial: function (e, t, i, n, r, a, o) {
            var s = e.nodes[r];
            if (void 0 !== s) {
                if (s.value && !s.inputs) return void t[n](o, s.value);
                for (var u = 0; u < s.inputs.length; u++) {
                    var l = s.inputs[u];
                    if (l.name === a) {
                        var c = l.default_value;
                        if (this._handleCycleDefaultValue(c, o, a, t, n, r), l.links && "SpecularPBR" !== o) return void this._handleCycleLinkSpecular(l, e, i, t, o, r)
                    }
                }
                s = this.findNodeByValueCyclesMetadata(e.nodes, r), s && s.value && t[n](o, s.value)
            }
        },
        findNodeByValueCyclesMetadata: function (e, t) {
            for (var i in e) {
                var n = e[i];
                if (n instanceof Object) {
                    var r = this.findNodeByValueCyclesMetadata(n, t);
                    if (void 0 !== r) return r
                } else if (n === t) return e
            }
        },
        metaDataToMaterial: function (e, t, i, n, r, a) {
            if (void 0 !== e[n]) {
                void 0 === r && (r = n);
                var o = "setChannel" + i;
                if (void 0 === t[o]) return void u.warn("material has not method " + o);
                void 0 === a || !0 === a ? t[o](r, JSON.parse(e[n])) : t[o](r, e[n])
            }
        },
        setTextureFromBlender: function (e, t, i, n, r) {
            var a = this.createTextureOptionsFromTextureOSG(n);
            if (a) {
                var o = e.getChannels()[t];
                o.setFactor(r), o.setupTextureModel(a), o.setTexCoordUnit(i), o.setEnable(!0)
            }
        },
        processDefaultMaterial: function (e, t) {
            t.removeAttribute("Material");
            for (var i = 0, n = t.getNumTextureAttributeLists(); i < n; i++) t.removeTextureAttribute(i, "Texture");
            e.setStateSet(void 0)
        },
        processLightSource: function (e) {
            var t = e.getLight();
            if (t && void 0 !== t.getUserData() && t.typeID !== o.a.typeID) {
                var i = t.getUserData(),
                    n = s.a.convertUserDataToObject(i),
                    r = new o.a;
                "AREA" !== n.Type && "SUN" !== n.Type && "HEMI" !== n.Type || (n.Type = "DIRECTION"), r.setLightType(n.Type), void 0 !== n.SpotSize && r.setSpotCutoff(90 * JSON.parse(n.SpotSize) / Math.PI), void 0 !== n.SpotBlend && r.setSpotBlend(JSON.parse(n.SpotBlend)), u.vec3.scale(r.getDiffuse(), JSON.parse(n.Color), JSON.parse(n.Energy));
                var a = 1 / JSON.parse(n.Distance);
                r.setQuadraticAttenuation(Math.abs(a) === 1 / 0 ? 0 : a), this.pushLight(r)
            }
        },
        processCyclesGraph: function (e, t, i) {
            var n;
            try {
                n = JSON.parse(i.NodeTree)
            } catch (e) {
                return u.warn("error in blender cycle graph json " + e), !0
            }
            if (void 0 === n) return !0;
            this._texturesAssigned = [], this.cyclesNodeToMaterial(n, e, t, "setChannelColor", "Diffuse BSDF", "Color", "DiffusePBR"), this.cyclesNodeToMaterial(n, e, t, "setChannelFactor", "Diffuse BSDF", "Roughness", "RoughnessPBR"), this.cyclesNodeToMaterial(n, e, t, "setChannelColor", "Diffuse BSDF", "Normal", "NormalMap"), this.cyclesNodeToMaterial(n, e, t, "setChannelColor", "Glossy BSDF", "Color", "SpecularPBR"), e.setChannelFactor("SpecularPBR", 1), this.cyclesNodeToMaterial(n, e, t, "setChannelFactor", "Glossy BSDF", "Roughness", "RoughnessPBR"), this.cyclesNodeToMaterial(n, e, t, "setChannelColor", "Glossy BSDF", "Normal", "NormalMap"), this.cyclesNodeToMaterial(n, e, t, "setChannelColor", "Bump", "Height", "NormalMap"), this.cyclesNodeToMaterial(n, e, t, "setChannelFactor", "Bump", "Strength", "NormalMap"), this.cyclesNodeToMaterial(n, e, t, "setChannelColor", "Emission", "Color", "EmitColor"), this.cyclesNodeToMaterial(n, e, t, "setChannelFactor", "Emission", "Strength", "EmitColor"), this.cyclesNodeToMaterial(n, e, t, "setChannelColor", "Ambient Occlusion", "Color", "AOPBR"), this.cyclesNodeToMaterial(n, e, t, "setChannelFactor", "Ambient Occlusion", "Strength", "AOPBR"), this.cyclesNodeToMaterial(n, e, t, "setChannelFactor", "Transparency", "Strength", "Opacity"), this.cyclesNodeToMaterial(n, e, t, "setChannelFactor", "Transparent BSDF", "Color", "Opacity"), this.cyclesNodeToMaterial(n, e, t, "setChannelFactor", "Glass BSDF", "Color", "Opacity");
            for (var r = [], a = 0, o = t.getNumTextureAttributeLists(); a < o; a++) {
                var s = t.getTextureAttribute(a, "Texture");
                s && -1 === this._texturesAssigned.indexOf(s) && r.push(s)
            }
            return this.assignPBRTextureFromFilenames(r, e), e.setWorkFlowMetalSpec(!1, !1), e.setWorkFlowRoughGloss(!0, !1), this._hasMetal = !1, !1
        },
        processMaterial: function (e, t, i) {
            var r = this.createMaterial(e, t),
                a = t.getAttribute("Material"),
                o = a && a.getUserData(),
                l = s.a.convertUserDataToObject(o),
                c = !0;
            l.NodeTree && (c = this.processCyclesGraph(r, t, l)), c && (this.metaDataToMaterial(l, r, "Color", "DiffuseColor"), this.metaDataToMaterial(l, r, "Factor", "DiffuseIntensity", "DiffuseColor"), r.setChannelEnable("DiffuseColor", !0), this.metaDataToMaterial(l, r, "Color", "SpecularColor"), this.metaDataToMaterial(l, r, "Factor", "SpecularIntensity", "SpecularColor"), r.setChannelEnable("SpecularColor", !0), this.metaDataToMaterial(l, r, "Factor", "Emit", "EmitColor"), r.setChannelEnable("EmitColor", !0), this.metaDataToMaterial(l, r, "Factor", "SpecularHardness"), r.setChannelEnable("SpecularHardness", !0), void 0 !== l.Translucency && (r.setChannelFactor("Opacity", 1 - JSON.parse(l.Translucency)), r.setChannelEnable("Opacity", !0)), void 0 !== i.Shadeless && r.set("shadeless", i.Shadeless));
            var h = Object(n.chain)(t.getUserData()).map(function (e) {
                var t = e.Name.substr(0, 2),
                    i = parseInt(t, 10);
                if (!isNaN(i)) return i
            }).without(void 0).uniq().sortBy(function (e) {
                return e
            }).value();
            t.removeAttribute("Material");
            var d = {},
                f = ["DiffuseColor", "DiffuseIntensity", "SpecularColor", "Normal", "Bump", "Translucency", "Alpha", "EmitColor", "SpecularHardness"],
                p = this;
            Object(n.each)(h, function (e) {
                var i = Object(n.chain)(t.getUserData()).filter(function (t) {
                    var i = t.Name.substr(0, 2);
                    return parseInt(i, 10) === e
                }).value();
                Object(n.each)(i, function (e) {
                    var i = e.Name.substr(0, 2),
                        a = parseInt(i, 10),
                        o = t.getTextureAttribute(a, "Texture");
                    if (void 0 === o) return void u.warn("missing texture");
                    d[a] = o;
                    var s = e.Name.substr(3);
                    if (!0 === Object(n.includes)(f, s)) {
                        var l = parseFloat(e.Value);
                        "DiffuseColor" === s ? void 0 !== r.getChannels().DiffuseColor.getTextureModel() && void 0 === r.getChannels().DiffuseIntensity.getTextureModel() && (s = "DiffuseIntensity") : "Alpha" === s ? s = "Opacity" : "Translucency" === s ? (s = "Opacity", l = 1 - l) : "Normal" === s ? s = "NormalMap" : "Bump" === s && (s = "BumpMap"), p.setTextureFromBlender(r, s, a, o, l)
                    } else "UsePremultiplyAlpha" === s ? u.warn("UsePremultiplyAlpha not supported") : "UseAlpha" === s ? u.warn("UseAlpha not supported") : u.warn("channel " + s + " not supported")
                })
            });
            for (var m in d) t.removeTextureAttribute(parseInt(m, 10), "Texture");
            "ksp" === l.source && (-1 === r.attributes.name.toLowerCase().indexOf("wheel") ? r.getChannels().MetalnessPBR.setFactor(1) : r.getChannels().SpecularF0.setFactor(0), -1 !== r.attributes.name.toLowerCase().indexOf("fairing") && r.getChannels().Opacity.setFactor(.25)), r.setStateSet(t)
        }
    })), t.a = l
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(409),
        a = n.a.osg,
        o = function () {
            r.a.apply(this, arguments), this._metaMapColor = {
                emission_color: "EmitColor",
                diffuse_color: "DiffuseColor",
                specular_color: "SpecularColor",
                transparency_color: "Opacity"
            }, this._metaMapFactor = {
                bump_amount: "BumpMap",
                normal_amount: "NormalMap",
                shininess_amount: "SpecularHardness",
                transparency_amount: "Opacity"
            }, this._metaMapTexture = {
                emissive_unit: "EmitColor",
                diffuse_unit: "DiffuseColor",
                specular_unit: "SpecularColor",
                shininess_unit: "SpecularHardness",
                transparency_unit: "Opacity",
                bump_unit: "BumpMap",
                normal_unit: "NormalMap"
            }
        };
    a.createPrototypeObject(o, a.objectInherit(r.a.prototype, {
        setMaterialChannelColor: function (e, t, i, n) {
            var r = t.getChannels()[i];
            if (r.setEnable(!0), "Opacity" === i) return void r.setFactor(n[3]);
            r.setColor && r.setColor(n), "SpecularColor" === i && r.setFactor(1)
        },
        setMaterialChannelFactor: function (e, t, i, n) {
            var r = t.getChannels()[i];
            if (r.setEnable(!0), "SpecularHardness" === i) {
                n *= 128;
                var o = e.specular_color ? JSON.parse(e.specular_color) : a.vec3.ZERO;
                this.setGlossinessPBRFromSpecularGlossiness(t, o, n)
            }
            r.setFactor(n)
        },
        _extractMetaData: function (e, t, i) {
            for (var n in t)
                if (n.startsWith(i)) {
                    var r = n.substr(i.length + 1);
                    e[r] || (e[r] = t[n])
                }
        },
        _cleanMetaData: function (e) {
            var t = {};
            return this._extractMetaData(t, e, "lambert"), this._extractMetaData(t, e, "blinn"), this._extractMetaData(t, e, "phong"), this._extractMetaData(t, e, "extra"), t
        },
        processMaterial: function (e, t, i) {
            var n = this.createMaterial(e, t),
                r = n.getChannels();
            i = this._cleanMetaData(i), this.setChannelsFromMetaDataFactor(i, n), this.setChannelsFromMetaDataColor(i, n), this.setChannelsFromMetaDataTexture(i, t, n), i.transparency_alphamask && r.Opacity.getTextureModel() && r.Opacity.setTransparency("alphaMask"), "substancepainter" === this._source && r.NormalMap.set("flipY", !1), t.removeAttribute("Material"), n.setStateSet(t)
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(409),
        a = n.a.osg,
        o = function () {
            r.a.apply(this, arguments)
        };
    a.createPrototypeObject(o, a.objectInherit(r.a.prototype, {
        processMaterial: function (e, t) {
            return this.processDefaultMaterial(e, t)
        },
        processDefaultMaterial: function (e, t) {
            var i = this.createMaterial(e, t),
                n = t.getAttribute("Material");
            return void 0 !== n && (i.setChannelColor("EmitColor", n.getAmbient()), i.setChannelColor("DiffuseColor", n.getDiffuse()), i.setChannelColor("SpecularColor", n.getSpecular()), i.setChannelFactor("SpecularHardness", n.getShininess()), i.setChannelFactor("Opacity", n.getDiffuse()[3]), i.setChannelEnable("EmitColor", !0), i.setChannelEnable("DiffuseColor", !0), i.setChannelEnable("SpecularColor", !0), i.setChannelEnable("SpecularHardness", !0), i.setChannelEnable("Opacity", !0), t.removeAttribute("Material")), this.mapTexturesOnMaterial(t, i), i.setStateSet(t), i
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(409),
        a = i(584),
        o = i(230),
        s = n.a.osg,
        u = function () {
            r.a.apply(this, arguments), this._textureFactor1 = !0, this._metaMapColor = {
                LambertDiffuseColor: "DiffuseColor",
                LambertEmissiveColor: "EmitColor",
                PhongSpecularColor: "SpecularColor"
            }, this._metaMapFactor = {
                LambertDiffuseFactor: "DiffuseColor",
                LambertBumpFactor: "BumpMap",
                LambertEmissiveFactor: "EmitColor",
                PhongSpecularFactor: "SpecularColor",
                PhongShininess: "SpecularHardness"
            }, this._metaMapTexture = {
                sDiffuse: "DiffuseColor",
                sNormalMap: "NormalMap",
                sBump: "BumpMap",
                sEmissive: "EmitColor",
                sSpecular: "SpecularColor",
                sOpacity: "Opacity",
                sAo: "AOPBR",
                sRoughness: "RoughnessPBR",
                sMetallic: "MetalnessPBR"
            }
        };
    s.createPrototypeObject(u, s.objectInherit(r.a.prototype, {
        setMaterialChannelColor: function (e, t, i, n) {
            var r = t.getChannels()[i];
            r.setColor && r.setColor(n), r.setEnable(!0)
        },
        setMaterialChannelFactor: function (e, t, i, n) {
            var r = t.getChannels()[i];
            if (r.setFactor(n), r.setEnable(!0), "SpecularHardness" === i) {
                var a = e.PhongSpecularColor ? JSON.parse(e.PhongSpecularColor) : [0, 0, 0];
                this.setGlossinessPBRFromSpecularGlossiness(t, a, n)
            }
        },
        processLightSource: function (e) {
            var t = e.getLight();
            if (t) {
                var i = t.getUserData();
                if (void 0 !== i && t.typeID !== a.a.typeID) {
                    var n = o.a.convertUserDataToObject(i),
                        r = new a.a;
                    if ("directional" === n.Type) r.setLightType("DIRECTION");
                    else if ("point" === n.Type) r.setLightType("POINT");
                    else {
                        if ("spot" !== n.Type) return;
                        r.setLightType("SPOT")
                    }
                    if ("spot" === n.Type) {
                        r.setSpotCutoff(JSON.parse(n.OuterAngle) / 2);
                        var u = JSON.parse(n.InnerAngle) / JSON.parse(n.OuterAngle);
                        r.setSpotBlend(u !== u || Math.abs(u) === 1 / 0 ? .5 : Math.min(u, 1))
                    }
                    s.vec3.scale(r.getDiffuse(), JSON.parse(n.Color), JSON.parse(n.Intensity) / 100);
                    var l = 1 / JSON.parse(n.DecayStart);
                    r.setQuadraticAttenuation(Math.abs(l) === 1 / 0 ? 0 : l), this.pushLight(r)
                }
            }
        },
        processMaterial: function (e, t, i) {
            var n = this.createMaterial(e, t);
            if (this.setChannelsFromMetaDataColor(i, n), this.setChannelsFromMetaDataFactor(i, n), this.setChannelsFromMetaDataTexture(i, t, n), i.LambertBumpFactor && !i.sBump && n.getChannels().BumpMap.setEnable(!1), "Tilt Brush" === this._authoringTool) {
                var r = n.getChannels(),
                    a = r.EmitColor;
                if (a.set("type", "multiplicative"), !a.getTextureModel()) {
                    var o = a.getColor();
                    0 === o[0] && 0 === o[1] && 0 === o[2] && a.setColor(s.vec3.ONE)
                }
                r.SpecularF0.setFactor(0), r.RoughnessPBR.setFactor(1);
                var u = i.BlendMode;
                "AlphaMask" === u ? (r.Opacity.setFactor(JSON.parse(i.LambertTransparencyFactor || 0)), r.Opacity.setTransparency("alphaMask")) : "AdditiveBlend" === u ? (r.Opacity.setFactor(1 - JSON.parse(i.LambertTransparencyFactor || 0)), r.Opacity.setTransparency("additive")) : r.Opacity.setEnable(!1)
            }
            t.removeAttribute("Material"), n.setStateSet(t)
        }
    })), t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(409),
        a = n.a.osg,
        o = function () {
            r.a.apply(this, arguments), this._metaMapTexture = {
                diffuse: "DiffuseColor",
                specular: "SpecularColor",
                transparency: "Opacity"
            }
        };
    a.createPrototypeObject(o, a.objectInherit(r.a.prototype, {
        processMaterial: function (e, t, i) {
            var n = this.createMaterial(e, t);
            this.setChannelsFromMetaDataTexture(i, t, n), t.removeAttribute("Material"), n.setStateSet(t)
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(409),
        a = i(922),
        o = i(584),
        s = n.a.osg,
        u = function () {
            r.a.apply(this, arguments), this._metaMapColor = {
                kd: "DiffuseColor"
            }, this._metaMapFactor = {
                tr: "Opacity",
                d: "Opacity"
            }
        };
    s.createPrototypeObject(u, s.objectInherit(a.a.prototype, {
        isSelfIlluminationSurface: function (e) {
            if (!e.length) return !1;
            var t = e[0],
                i = t.getImage().getURL().split("/").pop().split(".").shift();
            return !!(i.match("carrot_crop_(.*)") || i.match("crops_(.*)") || "fern" === i || "dead_shrub" === i || "flower_red" === i || "flower_yellow" === i || "lilypad" === i || "mushroom_brown" === i || "mushroom_red" === i || i.match("netherwart_(.*)") || i.match("potato_crop_(.*)") || i.match("sapling_(.*)") || "tall_grass" === i || "torch" === i || "torch_flame" === i)
        },
        getReferencedTextures: function (e) {
            for (var t = [], i = 0; i < e.getNumTextureAttributeLists(); i++) {
                var n = e.getTextureAttribute(i, "Texture");
                void 0 !== n && ("PackedMaterialTexture" === n.className() && (n = n.getTexture()), t[i] = n)
            }
            return t
        },
        setMaterialChannelTexture: function (e, t, i, n, r, a, o) {
            e.removeTextureAttribute(i, "Texture");
            var u = t.getChannels()[r],
                l = this.createTextureOptionsFromTextureOSG(n);
            l && (l.wrapT = s.Texture[a], l.wrapS = s.Texture[a], o && (l.minFilter = s.Texture.NEAREST_MIPMAP_LINEAR, l.magFilter = s.Texture.NEAREST), u.setupTextureModel(l), u.setTexCoordUnit(0), u.setEnable(!0))
        },
        processMaterial: function (e, t, i) {
            var n = this.createMaterial(e, t);
            this.setChannelsFromMetaDataColor(i, n), this.setChannelsFromMetaDataFactor(i, n), void 0 !== i.ka && (n.setChannelFactor("EmitColor", .1), n.setChannelEnable("EmitColor", !0)), n.setChannelColor("SpecularColor", s.vec3.create()), n.setChannelEnable("SpecularColor", !0), n.setChannelFactor("SpecularHardness", 1), n.setChannelEnable("SpecularHardness", !0), this.checkOpacityFactor(n);
            var r, a, u = "mineways" === i.source,
                l = this.getReferencedTextures(t),
                c = this.isSelfIlluminationSurface(l),
                h = c ? "CLAMP_TO_EDGE" : "REPEAT";
            if (void 0 !== i.map_kd && (r = JSON.parse(i.map_kd), void 0 !== (a = l[r]) && this.setMaterialChannelTexture(t, n, r, a, "DiffuseColor", h, u)), c || (void 0 !== i.map_ke ? (r = JSON.parse(i.map_ke), void 0 !== (a = l[r]) && (this.setMaterialChannelTexture(t, n, r, a, "EmitColor", h, u), n.setChannelFactor("EmitColor", 1))) : void 0 !== i.map_ka ? (r = JSON.parse(i.map_ka), void 0 !== (a = l[r]) && this.setMaterialChannelTexture(t, n, r, a, "EmitColor", h, u)) : (r = JSON.parse(i.map_kd), void 0 !== (a = l[r]) && (this.setMaterialChannelTexture(t, n, r, a, "EmitColor", h, u), n.setChannelFactor("EmitColor", .1)))), c && (n.set("shadeless", !0), n.setChannelFactor("EmitColor", 0), n.setChannelEnable("EmitColor", !0)), void 0 !== i.map_d && (r = JSON.parse(i.map_d), void 0 !== (a = l[r]))) {
                this.setMaterialChannelTexture(t, n, r, a, "Opacity", h, u);
                var d = n.getChannels().Opacity;
                u ? (d.getTextureModel().set("internalFormat", s.Texture.ALPHA), -1 !== n.attributes.name.toLowerCase().indexOf("leaves") && (d.setTransparency("alphaMask"), n.setChannelFactor("Opacity", .2))) : (d.getTextureModel().set("internalFormat", s.Texture.LUMINANCE), d.setTransparency("alphaBlend")), n.set("cullFace", s.CullFace.BACK)
            }
            if (n.setChannelFactor("RoughnessPBR", 1), n.setChannelFactor("SpecularF0", 0), !this._lights.length) {
                var f = new o.a;
                f.setLightType("DIRECTION"), s.vec3.set(f.getDiffuse(), 1, 1, 1), this._lights.push(f), f._worldMatrix = s.mat4.fromRotation(s.mat4.create(), Math.PI / 6, s.vec3.fromValues(1, 1, 0))
            }
            t.removeAttribute("Material"), n.setStateSet(t)
        }
    })), t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(409),
        a = n.a.osg,
        o = function () {
            r.a.apply(this, arguments), this._textureFactor1 = !0, this._metaMapColor = {
                DiffuseColor: "DiffuseColor",
                SpecularPBRColor: "SpecularPBR",
                EmissiveColor: "EmitColor"
            }, this._metaMapFactor = {
                DiffuseFactor: "DiffuseColor",
                EmissiveFactor: "EmitColor",
                MetallicFactor: "MetalnessPBR",
                RoughnessFactor: "RoughnessPBR",
                GlossinessPBRFactor: "GlossinessPBR",
                SpecularPBRFactor: "SpecularPBR",
                AOFactor: "AOPBR",
                NormalFactor: "NormalMap"
            }, this._metaMapTexture = {
                sDiffuse: "DiffuseColor",
                sMetallic: "MetalnessPBR",
                sRoughness: "RoughnessPBR",
                sSpecularPBR: "SpecularPBR",
                sGlossinessPBR: "GlossinessPBR",
                sNormalMap: "NormalMap",
                sEmissive: "EmitColor",
                sOpacity: "Opacity",
                sAO: "AOPBR"
            }
        };
    a.createPrototypeObject(o, a.objectInherit(r.a.prototype, {
        setMaterialChannelColor: function (e, t, i, n) {
            var r = t.getChannels()[i];
            r.getTextureModel() || (r.setColor && r.setColor(n), r.setFactor(1))
        },
        checkWorkflowPBR: function (e) {
            e.sMetallic || e.MetallicFactor || !e.sSpecularPBR && !e.SpecularPBRColor && !e.SpecularPBRFactor ? this._hasMetal = !0 : void 0 === this._hasMetal && (this._hasMetal = !1)
        },
        checkWorkflowRoughGloss: function (e) {
            e.RoughnessPBR || e.RoughnessFactor || !e.GlossinessPBR && !e.GlossinessPBRFactor ? this._globalEnforceRoughness = !0 : void 0 === this._globalEnforceRoughness && (this._globalEnforceRoughness = !1)
        },
        checkAlphaMode: function (e, t) {
            var i = t.getChannels();
            if (e.alphaMode && "OPAQUE" !== e.alphaMode) {
                var n = i.Opacity;
                if (this.hasTextureChannel(t, "DiffuseColor")) {
                    var r = i.DiffuseColor,
                        o = r.getTextureModel().clone();
                    o.set("internalFormat", a.Texture.ALPHA), o.updateMultiresTexture(), n.setTextureModel(o), n.setTexCoordUnit(r.getTexCoordUnit())
                }
                "BLEND" === e.alphaMode ? n.setFactor(JSON.parse(e.OpacityFactor || 1)) : "MASK" === e.alphaMode && (n.setTransparency("alphaMask"), n.setFactor(JSON.parse(e.alphaCutoff || 0))), n.setEnable(!0)
            }
        },
        checkNormalMap: function (e, t) {
            t.getChannels().NormalMap.set("flipY", void 0 !== e.yUp && !1 === JSON.parse(e.yUp))
        },
        checkCullFace: function (e, t) {
            void 0 !== e.doubleSided && !1 !== JSON.parse(e.doubleSided) || t.set("cullFace", a.CullFace.BACK)
        },
        processMaterial: function (e, t, i) {
            var n = this.createMaterial(e, t);
            this.checkWorkflowPBR(i), this.checkWorkflowRoughGloss(i), this.setChannelsFromMetaDataTexture(i, t, n), this.setChannelsFromMetaDataFactor(i, n), this.setChannelsFromMetaDataColor(i, n), this.checkAlphaMode(i, n), this.checkNormalMap(i, n), this.checkCullFace(i, n), n.getChannels().AOPBR.set("occludeSpecular", !0), this.copyDiffuse(n), t.removeAttribute("Material"), n.setStateSet(t)
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = n.a.osg,
        a = function () {
            r.NodeVisitor.call(this, r.NodeVisitor.TRAVERSE_ALL_CHILDREN), this._paths = [], this._pathsStateSet = [], this._currentStateSet = [], this._stateSetMap = {}, this._stateSetMapNodes = {}, this._wireframePaths = [], this._noGeometryPaths = [], this.nodeMaskOverride = -1
        };
    r.createPrototypeObject(a, r.objectInherit(r.NodeVisitor.prototype, {
        getPathList: function () {
            return this._paths
        },
        getStateSetMap: function () {
            return this._stateSetMap
        },
        getStateSetMapNodes: function () {
            return this._stateSetMapNodes
        },
        getStateSetPathList: function () {
            return this._pathsStateSet
        },
        getWireframePathList: function () {
            return this._wireframePaths
        },
        getNoGeometryPathList: function () {
            return this._noGeometryPaths
        },
        apply: function (e) {
            var t = e.getStateSet();
            if (t) {
                var i = t._uniqueID;
                this._stateSetMap[i] || (this._stateSetMap[i] = t, this._stateSetMapNodes[i] = []), this._stateSetMapNodes[i].push(e), this._currentStateSet.push(t)
            }
            e instanceof r.Geometry ? e.userDataMap && e.userDataMap.wireframe ? this._wireframePaths.push(this.nodePath.slice(0)) : (this._pathsStateSet.push(this._currentStateSet.slice(0)), this._paths.push(this.nodePath.slice(0))) : (this.traverse(e), 0 === e.getChildren().length && this._noGeometryPaths.push(this.nodePath.slice(0))), t && this._currentStateSet.pop()
        }
    })), t.a = a
}, function (e, t) {
    e.exports = "attribute vec3 Vertex;\nvarying vec2 vTexCoord0;\n\nvoid main(void) {\n    gl_Position = vec4(Vertex * 2.0 - 1.0, 1.0);\n    vTexCoord0 = Vertex.xy;\n}\n"
}, function (e, t) {
    e.exports = "uniform sampler2D uTexture0;\nuniform sampler2D uTexture1;\nuniform sampler2D uTexture2;\nuniform sampler2D uTexture3;\n\n// vec4 (up to 4 textures input)\n// int meaning :\n// 0 -> read R\n// 1 -> read A\n// 2 -> read RGB\nuniform ivec4 uReadPacking;\n\nvarying vec2 vTexCoord0;\n\nvoid main(void) {\n    // check if we are in a 2 or 4 texture packing pattern\n    if ( uReadPacking.x == 3 ) {\n        gl_FragColor.rgb = texture2D( uTexture0, vTexCoord0 ).aaa;\n        gl_FragColor.a = uReadPacking.y == 0 ? texture2D( uTexture1, vTexCoord0 ).r : texture2D( uTexture1, vTexCoord0 ).a;\n\n    } else if ( uReadPacking.x == 2 ) {\n        gl_FragColor.rgb = texture2D( uTexture0, vTexCoord0 ).rgb;\n        gl_FragColor.a = uReadPacking.y == 0 ? texture2D( uTexture1, vTexCoord0 ).r : texture2D( uTexture1, vTexCoord0 ).a;\n\n    } else {\n        gl_FragColor.r = uReadPacking.x == 0 ? texture2D( uTexture0, vTexCoord0 ).r : texture2D( uTexture0, vTexCoord0 ).a;\n        gl_FragColor.g = uReadPacking.y == 0 ? texture2D( uTexture1, vTexCoord0 ).r : texture2D( uTexture1, vTexCoord0 ).a;\n        gl_FragColor.b = uReadPacking.z == 0 ? texture2D( uTexture2, vTexCoord0 ).r : texture2D( uTexture2, vTexCoord0 ).a;\n        gl_FragColor.a = uReadPacking.w == 0 ? texture2D( uTexture3, vTexCoord0 ).r : texture2D( uTexture3, vTexCoord0 ).a;\n    }\n}"
}, function (e, t, i) {
    "use strict";
    var n, r, a = i(9),
        o = i(47),
        s = i(152),
        u = i(119),
        l = i(20),
        c = i(230),
        h = i(1297),
        d = i(1298),
        f = a.a.osg,
        p = a.a.osgAnimation,
        m = {
            channelTargetNames: {}
        },
        g = function (e) {
            var t = e.getStateSet();
            return t && t.getAttribute("SketchfabMaterial") ? t : void 0
        },
        v = function (e, t) {
            for (var i = t || 0, n = e.length - 1; n >= i; --n) {
                var r = g(e[n]);
                if (r) return r
            }
        },
        _ = function (e) {
            for (var t = 0, i = e.length; t < i; ++t) e[t].removeChildren()
        },
        b = function (e) {
            for (var t = 0, i = e.length - 1; t < i; ++t) e[t].addChild(e[t + 1])
        },
        S = function (e) {
            for (var t = e.length, i = 0; i < t; ++i) _(e[i])
        },
        x = function (e) {
            for (var t = !1, i = m.channelTargetNames, n = 0, r = e.length; n < r; ++n) {
                var a, o = e[n],
                    s = !1;
                if (o instanceof p.Bone) a = p.UpdateBone;
                else {
                    if (!(o instanceof f.MatrixTransform)) continue;
                    a = p.UpdateMatrixTransform, s = !0
                }
                for (var u = o.getUpdateCallbackList(), l = u.length - 1; l >= 0; --l) {
                    var c = u[l];
                    c instanceof a != !1 && (i[c.getName()] || !s ? t = !0 : (c.update(o), o.removeUpdateCallback(c)))
                }
            }
            var h = e[e.length - 1];
            return t || h instanceof p.RigGeometry || h instanceof p.MorphGeometry
        },
        y = function () {
            var e = [];
            return function (t) {
                return e[0] = t, x(e)
            }
        }();
    a.a.osgDB.Input.prototype.getJSON = function () {
        return r = this, this._json.Animations && (n = this._json), this._json
    };
    var C = function (e) {
            var t = m.channelTargetNames;
            if (!n || !n.Animations || o.a.OSG_VERSION < 8) return t;
            for (var i = e.getFeatures().animation.getModel(), a = n.Animations, s = 0, u = a.length; s < u; ++s) {
                var l = a[s]["osgAnimation.Animation"],
                    h = r.setJSON(l.UserDataContainer).readUserDataContainer(),
                    d = c.a.convertUserDataToObject(h);
                if (i.getAnimationByUID(d.AnimationUID))
                    for (var f = l.Channels, p = 0, g = f.length; p < g; ++p) {
                        var v = f[p];
                        t[v[Object.keys(v)[0]].TargetName] = 1
                    }
            }
            return t
        },
        T = function (e, t, i) {
            for (var n = t.length - 1; n >= 0; --n) {
                var r = t[n],
                    a = r.length,
                    o = r[a - 1],
                    s = o._uniqueID;
                if (o.getVertexAttributeList && (s = o.getVertexAttributeList().Vertex.getInstanceID()), e[o._uniqueID] || e[s]) e[s] = !0, i.push(r), t.splice(n, 1);
                else if (o instanceof f.Geometry || o instanceof p.Bone) x(r) && (i.push(r), t.splice(n, 1));
                else {
                    for (var u = a - 2; u >= 0; --u)
                        if (r[u] instanceof p.Bone) {
                            i.push(r);
                            break
                        } t.splice(n, 1)
                }
            }
        },
        w = function (e) {
            var t = e.getFeatures(),
                i = t.hotspot.getModel().get("hotspots"),
                n = i.length,
                r = {},
                a = 0;
            for (a = 0; a < n; ++a) {
                var o = i.at(a).get("geometryUid");
                o >= 0 && (r[o] = !0)
            }
            var s = t.sound.getModel().get("soundtracks"),
                u = s.length;
            for (a = 0; a < u; ++a) {
                var l = s.at(a).get("geometryUid");
                l >= 0 && (r[l] = !0)
            }
            return r
        },
        M = function (e) {
            for (var t = d.a.protectedGeometries, i = 0, n = e.length; i < n; ++i) {
                var r = e[i],
                    a = r[r.length - 1];
                a instanceof f.Geometry && (t[a.getInstanceID()] = !0)
            }
        },
        E = function (e, t, i, n) {
            var r = w(e);
            T(r, t.getPathList(), i), T(r, t.getNoGeometryPathList(), i), T(r, t.getWireframePathList(), n), M(i), M(n)
        },
        A = function (e) {
            for (var t = d.a.multiParentPathFromGeometryID, i = 0, n = e.length; i < n; ++i) {
                for (var r = e[i], a = !1, o = 0, s = r.length; o < s; ++o)
                    if (r[o].getParents().length > 1) {
                        a = !0;
                        break
                    } t[r[r.length - 1].getInstanceID()] = a
            }
        },
        P = function (e) {
            A(e.getPathList()), A(e.getNoGeometryPathList()), A(e.getWireframePathList())
        },
        R = function (e) {
            S(e.getPathList()), S(e.getNoGeometryPathList()), S(e.getWireframePathList())
        },
        O = function (e, t, i, n) {
            var r = 0,
                a = e.length,
                o = i.length,
                s = !1;
            for (r = a - 1; r >= 0; --r) {
                var u = e[r];
                b(u);
                var l = u[0] === t;
                v(u, l ? 1 : 0) || (s = !0), l || t.addChild(u[0])
            }
            for (r = o - 1; r >= 0; --r) {
                var c = i[r];
                b(c), n.push(c[c.length - 1]), c[0] !== t && t.addChild(c[0])
            }
            s || t.setStateSet(void 0)
        },
        I = function (e, t) {
            var i = e.length;
            if (0 !== i)
                for (var n = e[0].indexOf(t), r = t.getStateSet() ? 0 : 1, a = 0; a < i; ++a) {
                    var o = e[a];
                    o.splice(0, n + r)
                }
        },
        F = function (e) {
            for (var t = e.getUpdateCallbackList(), i = 0, n = t.length; i < n; ++i) {
                var r = t[i];
                if (r instanceof p.BasicAnimationManager) return e.removeUpdateCallback(r), r
            }
        },
        N = function (e) {
            for (var t, i, n = e.getPathList(), r = n[0][0], a = r, o = [];;) {
                t = g(a) || t, i = i || F(a);
                var s = a.getChildren();
                if (1 !== s.length) break;
                if (s[0] instanceof p.Skeleton) break;
                if (s[0] instanceof f.Geometry) break;
                if (y(a)) break;
                o.push(a), a = s[0]
            }
            if (r.removeChildren(), i && r.addUpdateCallback(i), r === a) return a;
            for (var u = a.getParents(), l = 0, c = u.length; l < c; ++l) u[l].removeChild(a);
            a.removeChildren(), r.setStateSet(void 0), a.setStateSet(t);
            var h = f.computeLocalToWorld(o);
            if (f.mat4.equals(f.mat4.IDENTITY, h)) r.addChild(a);
            else {
                var d = new f.MatrixTransform;
                d.setName("Optim - RootMatrix"), f.mat4.copy(d.getMatrix(), h), r.addChild(d), d.addChild(a)
            }
            return I(n, a), I(e.getWireframePathList(), a), I(e.getNoGeometryPathList(), a), a
        },
        D = function (e) {
            var t, i = e.getFeatures().material.getModel().attributes,
                n = {},
                r = s.a.length;
            for (var a in i) {
                var o = i[a];
                if (!o.get("uidUniqueMerged")) {
                    var u = o.get("texCoordUnitList");
                    u.length = 0;
                    var l = o.getChannels();
                    for (t = 0; t < r; ++t) {
                        var c = s.a[t],
                            h = l[c];
                        if (h.isEnableEffective() && h.getTextureModel() && "Matcap" !== c) {
                            var d = h.getTexCoordUnit(); - 1 === u.indexOf(d) && u.push(d)
                        }
                    }
                    var f = o.get("geometryList"),
                        p = f.length;
                    for (t = 0; t < p; ++t) {
                        var m = f[t],
                            g = n[m.getInstanceID()];
                        if (g)
                            for (var v = u.length, _ = 0; _ < v; ++_) - 1 === g.uvList.indexOf(u[_]) && g.uvList.push(u[_]);
                        else n[m.getInstanceID()] = {
                            geometry: m,
                            uvList: u.slice()
                        }
                    }
                }
            }
            for (var b in n) {
                var S = n[b],
                    x = S.uvList,
                    y = S.geometry.getVertexAttributeList();
                for (var C in y) - 1 !== C.indexOf("TexCoord") && -1 === x.indexOf(parseInt(C.substring(8))) && delete y[C]
            }
        },
        L = function (e, t) {
            D(t);
            var i = t.getOrCreateScene().getWireframeNodes();
            i.length = 0;
            var n = [],
                r = [],
                a = e.getPathList(),
                s = e.getWireframePathList();
            C(t);
            var u = N(e);
            if (P(e), R(e), E(t, e, n, r), d.a.optimizePaths(u, a), O(n, u, r, i), s.length > 0) {
                var l = i.slice(0);
                o.a.getWireframe().then(function () {
                    for (var e = i.length = l.length, t = 0; t < e; ++t) i[t] = l[t];
                    f.time("optimizer - wireframe"), d.a.optimizeWireframe(u, s, i), f.timeEnd("optimizer - wireframe"), o.a.resolveWireframeOptimized()
                })
            } else o.a.getWireframe().then(function () {
                o.a.resolveWireframeOptimized()
            })
        },
        k = function (e, t) {
            for (var i = t.length, n = 0; n < i; ++n) - 1 === e.indexOf(t[n]) && e.push(t[n]);
            t.length = 0
        },
        V = function (e) {
            var t = e.getFeatures().material.getModel().attributes,
                i = {},
                n = {},
                r = s.a.length,
                a = 0;
            for (var o in t) {
                var l = t[o],
                    c = l.get("stateSet");
                if (!c) return;
                var d = l.getChannels(),
                    p = u.a.get("mask"),
                    m = [];
                m.push(l.get("cullFace") ? 1 : 0), m.push(l.hasOnlyPoints() ? 1 : 0), p & u.a.LIT && m.push(l.get("shadeless") ? 1 : 0), p === u.a.CLASSIC_LIT && m.push(l.get("reflection")), p !== u.a.MATCAP && m.push(l.get("hasVertexColor") ? 1 : 0), d.Opacity.isEffective() && m.push(l.get("hasVertexAlpha") ? 1 : 0);
                for (var g = 0; g < r; ++g) {
                    var v = s.a[g],
                        _ = d[v];
                    if (_.isEnableEffective()) {
                        var b = _.isEffective(),
                            S = b ? JSON.stringify(_.getJSON()) : _.getFactor();
                        m.push(v + S)
                    }
                }
                m = m.join(" / ");
                var x = i[m];
                if (x) {
                    n[c.getInstanceID()] = x.get("stateSet"), a++, x.get("uidListUnusedDuplicates").push(l.get("id")), l.set("uidUniqueMerged", x.get("id"));
                    var y = l.get("stateSetWireframe");
                    if (y) {
                        var C = x.get("stateSetWireframe");
                        n[y.getInstanceID()] = C
                    }
                    k(x.get("geometryList"), l.get("geometryList")), k(x.get("wireframeList"), l.get("wireframeList")), l.get("texCoordUnitList").length = 0
                } else i[m] = l
            }
            var T = Object.keys(n).length,
                w = Object.keys(t).length;
            if (h.a.stats.materialCountBefore = w, h.a.stats.materialCountAfter = w - a, 0 !== T) {
                var M = function () {
                    f.NodeVisitor.call(this)
                };
                f.createPrototypeObject(M, f.objectInherit(f.NodeVisitor.prototype, {
                    apply: function (e) {
                        var t = e.getStateSet();
                        if (t) {
                            var i = n[t.getInstanceID()];
                            i && e.setStateSet(i)
                        }
                        this.traverse(e)
                    }
                }));
                var E = e.getRootModel(),
                    A = new M;
                A.setNodeMaskOverride(-1), E.accept(A)
            }
        },
        B = {};
    B.reports = h.a.stats, B.optimize = function (e, t) {
        Object(l.a)().graphOptimizer || o.a.getWireframe().then(o.a.resolveWireframeOptimized);
        var i = t.getRootModel();
        if (!Object(l.a)().graphOptimizer && !Object(l.a)().mergeMaterials) return void h.a.registerStats(i, "Stats");
        f.time("optimizer"), h.a.registerStats(i, "Before"), Object(l.a)().mergeMaterials && (f.time("optimizer - materials"), V(t), f.timeEnd("optimizer - materials")), Object(l.a)().graphOptimizer && (f.time("optimizer - nodes"), L(e, t), f.timeEnd("optimizer - nodes"), h.a.stats.transparent = d.a.hasTransparency), h.a.registerStats(i, "After"), h.a.computeStats(t), f.timeEnd("optimizer")
    }, t.a = B
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(86),
        a = i(572),
        o = i(119),
        s = i(20),
        u = i(147),
        l = n.a.osg,
        c = n.a.osgAnimation,
        h = function () {
            l.NodeVisitor.call(this), this._stats = {
                nodeCount: 0,
                matrixTransformCount: 0,
                geometryCount: 0,
                boneCount: 0,
                skeletonCount: 0,
                morphGeometryCount: 0,
                rigGeometryCount: 0
            }
        },
        d = new r.a;
    h.stats = window.sketchfabViewerStats = {
        promiseReady: d.promise,
        materialCountBefore: 0,
        materialCountAfter: 0,
        nodeCountBefore: 0,
        nodeCountAfter: 0,
        matrixTransformCountBefore: 0,
        matrixTransformCountAfter: 0,
        geometryCountBefore: 0,
        geometryCountAfter: 0,
        boneCountBefore: 0,
        boneCountAfter: 0,
        skeletonCountBefore: 0,
        skeletonCountAfter: 0,
        morphGeometryCountBefore: 0,
        morphGeometryCountAfter: 0,
        rigGeometryCountBefore: 0,
        rigGeometryCountAfter: 0
    }, h.registerStats = function (e, t) {
        var i = new h;
        e.accept(i);
        var n = i.getStats(),
            r = h.stats;
        r["nodeCount" + t] = n.nodeCount, r["matrixTransformCount" + t] = n.matrixTransformCount, r["geometryCount" + t] = n.geometryCount, r["boneCount" + t] = n.boneCount, r["skeletonCount" + t] = n.skeletonCount, r["morphGeometryCount" + t] = n.morphGeometryCount, r["rigGeometryCount" + t] = n.rigGeometryCount
    };
    var f = function (e) {
        for (var t = ["geometry", "rigGeometry", "morphGeometry"], i = 0, n = 0; n < t.length; ++n) i += h.stats[t[n] + e];
        return i
    };
    h.computeStats = function (e) {
        if (!Object(u.a)() && !window.RunningTests) {
            var t = h.stats;
            if (Object(s.a)().graphOptimizer) {
                var i = f("CountBefore"),
                    n = f("CountAfter");
                a.default.logMessage("Geometry count : before " + i + ", after " + n)
            }
            if (Object(s.a)().mergeMaterials) {
                var r = "Material count : before ";
                r += t.materialCountBefore, r += ", after ", r += t.materialCountAfter, a.default.logMessage(r)
            }
            var l = e.getFeatures(),
                c = l.animation.getModel(),
                p = l.environment.getModel(),
                m = l.lighting.getModel(),
                g = c.getEnabledAnimationsCount(),
                v = 0,
                _ = 0,
                b = 0;
            if (o.a.get("mask") & o.a.LIT) {
                for (var S = m.get("lights"), x = 0, y = S.length; x < y; ++x) {
                    var C = S[x];
                    C && C.get("enable") && "NONE" !== C.get("type") && (b++, C.isCastingShadows() && (_++, (g || C.isAttachedToCamera()) && v++))
                }
                p.get("enable") && (b++, p.get("shadowEnable") && (b++, _++, g && v++)), t.pbr = o.a.get("mask") & o.a.PBR ? 1 : 0
            }
            t.lights = b, t.shadows = _, t.realTimeShadows = v, t.vertexCount = e._currentScene._dataScene.vertexCount;
            var T = t.materialCountAfter / 10;
            T *= b > 0 && t.pbr ? t.lights + t.shadows : 1, T *= t.transparent ? 4 : 1;
            var w = 0;
            w += t.boneCountAfter / 35, w += t.morphGeometryCountAfter / 2, w += t.geometryCountAfter / 5, w += t.vertexCount / 15e4, w += t.matrixTransformCountAfter / 50, w += t.nodeCountAfter / 100, w *= t.realTimeShadows > 0 ? t.realTimeShadows + 1 : 1;
            var M = T + w;
            t.complexity = M, t.shadingComplexity = T, t.meshComplexity = w, d.resolve(t)
        }
    };
    var p = l.Node.typeID,
        m = l.MatrixTransform.typeID,
        g = c.Bone.typeID,
        v = c.Skeleton.typeID,
        _ = l.Geometry.typeID,
        b = c.MorphGeometry.typeID,
        S = c.RigGeometry.typeID;
    l.createPrototypeObject(h, l.objectInherit(l.NodeVisitor.prototype, {
        getStats: function () {
            return this._stats
        },
        apply: function (e) {
            var t = this._stats,
                i = e.typeID;
            e.userDataMap && e.userDataMap.wireframe || (i === p ? t.nodeCount++ : i === m ? t.matrixTransformCount++ : i === _ ? t.geometryCount++ : i === g ? t.boneCount++ : i === v ? t.skeletonCount++ : i === b ? t.morphGeometryCount++ : i === S ? (t.rigGeometryCount++, e.getSourceGeometry().typeID === b && t.morphGeometryCount++) : console.error("Unknown node type ID : " + i + " " + e.className()), this.traverse(e))
        }
    })), t.a = h
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(85),
        a = i(20),
        o = n.a.osg,
        s = o.WebGLCaps.instance().getWebGLExtension("OES_element_index_uint"),
        u = s ? 4294967296 : 65535,
        l = {
            splitLimit: Math.min(Object(a.a)().splitLimit, u),
            limitMergePerMaterial: 100,
            canMergeGeometry: !0,
            isWireframe: !1,
            bakedGeometriesFromID: {},
            hasTransparency: !0,
            multiParentPathFromGeometryID: {},
            protectedGeometries: {}
        },
        c = {};
    c[o.primitiveSet.POINTS] = !0, c[o.primitiveSet.LINES] = !0, c[o.primitiveSet.TRIANGLES] = !0;
    var h = {};
    h[o.primitiveSet.POINTS] = !0, h[o.primitiveSet.LINES] = !0, h[o.primitiveSet.TRIANGLES] = !0, h[o.primitiveSet.TRIANGLE_STRIP] = !0;
    var d = {
            Vertex: 1,
            Normal: 1,
            Tangent: 1
        },
        f = function (e) {
            var t = e.getStateSet();
            return t && t.getAttribute("SketchfabMaterial") ? t : void 0
        },
        p = function (e, t) {
            for (var i = t || 0, n = e.length - 1; n >= i; --n) {
                var r = f(e[n]);
                if (r) return r
            }
        },
        m = function (e, t) {
            var i = e[e.length - 1].getVertexAttributeList().Vertex;
            return t[t.length - 1].getVertexAttributeList().Vertex.getElements().length - i.getElements().length
        },
        g = function (e) {
            return e === r.a.TRANSPARENT
        },
        v = function (e) {
            return e.getVertexAttributeList().Vertex.getElements().length / 3
        },
        _ = function (e) {
            return e[e.length - 1].getVertexAttributeList().Vertex.getElements().length / 3
        },
        b = function (e) {
            var t = e[e.length - 1].getInstanceID(),
                i = l.multiParentPathFromGeometryID;
            return Boolean(i[t])
        },
        S = function (e) {
            return 9 === e.length ? o.mat3.equals(o.mat3.IDENTITY, e) : o.mat4.equals(o.mat4.IDENTITY, e)
        },
        x = function (e, t) {
            t.xmin < e.xmin && (e.xmin = t.xmin), t.ymin < e.ymin && (e.ymin = t.ymin), t.zmin < e.zmin && (e.zmin = t.zmin), t.xmax > e.xmax && (e.xmax = t.xmax), t.ymax > e.ymax && (e.ymax = t.ymax), t.zmax > e.zmax && (e.zmax = t.zmax)
        },
        y = function (e, t) {
            var i = Math.min(e.xmax - e.xmin, t.xmax - t.xmin),
                n = Math.min(e.ymax - e.ymin, t.ymax - t.ymin),
                r = Math.min(e.zmax - e.zmin, t.zmax - t.zmin);
            return x(e, t), i = 0 === i ? 0 : (e.xmax - e.xmin) / i, n = 0 === n ? 0 : (e.ymax - e.ymin) / n, r = 0 === r ? 0 : (e.zmax - e.zmin) / r, Math.max(i, n, r) > Object(a.a)().zratio
        },
        C = function (e, t, i) {
            if (!t._FQU) {
                var n = e.getElements().length,
                    r = Math.min(n, t.getElements().length - i);
                t._boxTest || (t._boxTest = t.computeMinMaxVertex({}, 0, i));
                var a = t.computeMinMaxVertex({}, i, r);
                t._FQU = y(t._boxTest, a)
            }
        },
        T = function (e) {
            if (!l.isWireframe) {
                var t = {};
                t.xmin = 1 / 0, t.ymin = 1 / 0, t.zmin = 1 / 0, t.xmax = -1 / 0, t.ymax = -1 / 0, t.zmax = -1 / 0;
                for (var i = l.bakedGeometriesFromID, n = {}, r = 0, a = e.length; r < a; ++r) {
                    var o = e[r].getVertexAttributeList().Vertex;
                    i[o.getInstanceID()] && (o._minMax || (o._minMax = t, o.computeMinMaxVertex(n), t.xmin === 1 / 0 || t._FQU || o._FQU ? (o._FQU && (t._FQU = !0), x(t, n)) : t._FQU = y(t, n)))
                }
            }
        },
        w = function (e, t, i) {
            var n = e.getElements(),
                r = t.getElements(),
                a = e.getItemSize(),
                o = t.getItemSize();
            if (a === o) return void n.set(r, i);
            for (var s = r.length / o, u = 0; u < s; ++u) {
                var l = u * a,
                    c = u * o;
                n[i + l] = r[c], n[i + l + 1] = r[c + 1], n[i + l + 2] = r[c + 2]
            }
        },
        M = function (e, t, i) {
            var n = t.getVertexAttributeList().Vertex,
                r = e.getVertexAttributeList().Vertex.getElements(),
                a = n.getElements();
            n.setElements(r.subarray(i, i + a.length)), e._boundingBox.copy(t.getBoundingBox()), e._boundingBoxComputed = !0;
            var s = t.getBoundingSphere(),
                u = e._boundingSphere;
            u.set(o.vec3.copy(u.center(), s.center()), s.radius()), e._boundingSphereComputed = !0, n.setElements(a), t.dirtyBound()
        },
        E = function (e, t, i, n) {
            var r = l.bakedGeometriesFromID[t.getInstanceID()];
            if (r || (l.bakedGeometriesFromID[i.getInstanceID()] = !0), r || S(e)) return void(i !== t && w(i, t, n || 0));
            var a = i.getElements();
            n && (a = a.subarray(n));
            for (var s = t.getElements(), u = 9 === e.length ? o.vec3.transformMat3 : o.vec3.transformMat4, c = t.getItemSize(), h = o.vec3.create(), d = Math.min(s.length, a.length), f = 0; f < d; f += c) h[0] = s[f], h[1] = s[f + 1], h[2] = s[f + 2], u(h, h, e), a[f] = h[0], a[f + 1] = h[1], a[f + 2] = h[2], 4 === c && (a[f + 3] = s[f + 3])
        },
        A = function (e, t, i, n) {
            var r = i.getIndices(),
                a = r.getElements(),
                s = a.length,
                u = 0,
                c = i.getMode(),
                d = e[c],
                f = d.primitive,
                p = f.getIndices().getElements(),
                m = f.getCount(),
                g = h[c] && l.canMergeGeometry,
                v = m;
            if (c === o.primitiveSet.TRIANGLE_STRIP && g) {
                var _ = p[m - 1],
                    b = a[0] + n,
                    S = _ !== b && 0 !== m ? 2 : 0,
                    x = m % 2;
                S && (p[m] = _, p[m + 1] = b), x && (p[m + S] = b), v += S + x, p.set(a, v)
            } else p.set(a, v);
            f.setCount(v + s);
            var y = v + s;
            for (u = v; u < y; ++u) p[u] += n;
            g || (i.setIndices(f.getIndices()), i.setCount(s), i.setFirst(v * p.BYTES_PER_ELEMENT), l.canMergeGeometry && t.push(i))
        },
        P = function (e, t, i, n) {
            for (var r = i.length, a = l.canMergeGeometry, s = e.DrawElements, u = e.DrawArrays, c = 0; c < r; ++c) {
                var h = i[c],
                    d = h.getMode();
                if (h instanceof o.DrawElements) A(s, t, h, n);
                else if (h instanceof o.DrawArrays) {
                    var f = u[d];
                    if (a)
                        if (f && f.primitive.count === n && 0 === h.getFirst()) f.primitive.count += h.getCount();
                        else {
                            var p = h.getFirst() + n;
                            t.push(new o.DrawArrays(d, p, h.getCount()))
                        }
                    else h.first += n
                } else if (h instanceof o.DrawArrayLengths)
                    if (a) {
                        var m = h.getFirst() + n,
                            g = h.getArrayLengths().slice();
                        t.push(new o.DrawArrayLengths(d, m, g))
                    } else h.first += n
            }
        },
        R = function (e) {
            for (var t = [{
                    nbVertex: _(e[0]),
                    pathList: [e[0]]
                }], i = e.length, n = 1; n < i; ++n) {
                var r = e[n],
                    a = t[t.length - 1],
                    o = _(r);
                o + a.nbVertex >= l.splitLimit ? t.push({
                    nbVertex: o,
                    pathList: [r]
                }) : (a.nbVertex += o, a.pathList.push(r))
            }
            return t
        },
        O = function (e, t, i) {
            if (!b(e)) return void Array.prototype.push.apply(t, i);
            for (var n = 0, r = i.length; n < r; ++n) {
                var a, s = i[n],
                    u = s.getMode(),
                    l = s.getFirst();
                if (s instanceof o.DrawElements) {
                    var c = s.getIndices(),
                        h = c.getElements(),
                        d = new h.constructor(h),
                        f = c.getItemSize(),
                        p = new o.BufferArray(o.BufferArray.ELEMENT_ARRAY_BUFFER, d, f);
                    a = new o.DrawElements(u, p)
                } else s instanceof o.DrawArrays ? a = new o.DrawArrays(u, l, s.getCount()) : s instanceof o.DrawArrayLengths && (a = new o.DrawArrayLengths(u, l, s.getArrayLengths().slice()));
                t.push(a)
            }
        },
        I = function (e, t) {
            var i = e.getElements(),
                n = i.BYTES_PER_ELEMENT;
            e.setNormalize(4 !== n);
            var r = 1;
            1 === n ? r = 255 : 2 === n && (r = 65535);
            for (var a = i.length, o = e.getItemSize(), s = t * o; s < a; ++s) i[s] = r
        },
        F = function (e, t) {
            var i = new o.Geometry;
            return i.setName(t.getName()), O(e, i.getPrimitiveSetList(), t.getPrimitiveSetList()), i
        },
        N = function (e, t) {
            var i = t.getVertexAttributeList().Color;
            if (i && 4 === i.getItemSize()) return 4;
            for (var n = 0, r = e.length; n < r; ++n) {
                var a = e[n],
                    o = a[a.length - 1],
                    s = o.getVertexAttributeList().Color;
                if (s && 4 === s.getItemSize()) return 4
            }
            return 3
        },
        D = function (e, t, i) {
            var n = e[e.length - 1],
                r = F(e, n),
                a = o.computeLocalToWorld(e),
                s = o.mat3.create();
            o.mat3.normalFromMat4(s, a);
            var u = N(i, n),
                c = t !== v(n),
                h = b(e),
                f = r.getVertexAttributeList(),
                p = n.getVertexAttributeList();
            for (var m in p) {
                var g, _ = p[m],
                    S = d[m],
                    x = "Color" === m,
                    y = x ? u : _.getItemSize();
                if (c) {
                    g = new(x ? _.getElements().constructor : Float32Array)(t * y)
                } else S && h ? g = new Float32Array(_.getElements().length) : f[m] = _;
                if (g) {
                    var C = new o.BufferArray(o.BufferArray.ARRAY_BUFFER, g, y);
                    x && I(C, _.getElements().length / _.getItemSize()), f[m] = C, S || w(C, _, 0)
                }
                if (S) {
                    E("Vertex" === m ? a : s, _, f[m], 0)
                }
            }
            return l.canMergeGeometry || M(r, n, 0), r
        },
        L = function (e, t, i) {
            var n = t[t.length - 1],
                r = e.getVertexAttributeList(),
                a = n.getVertexAttributeList(),
                s = o.computeLocalToWorld(t),
                u = o.mat3.create();
            o.mat3.normalFromMat4(u, s);
            for (var l in a) {
                var c = r[l],
                    h = a[l],
                    f = i * c.getItemSize();
                if (d[l]) {
                    E("Vertex" === l ? s : u, h, c, f), "Vertex" === l && C(h, c, f)
                } else w(c, h, f)
            }
        },
        k = function (e, t, i) {
            for (var n in t)
                if (!e[n]) {
                    var r = t[n].getItemSize(),
                        a = "Color" === n,
                        s = a ? t[n].getElements().constructor : Float32Array,
                        u = new s(i * r),
                        l = new o.BufferArray(o.BufferArray.ARRAY_BUFFER, u, r);
                    e[n] = l, a && I(l, 0)
                }
        },
        V = function (e, t, i, n) {
            for (var r = t.DrawElements, a = t.DrawArrays, s = l.canMergeGeometry, u = 0, d = i.length; u < d; ++u) {
                var f = i[u],
                    p = f.getMode();
                if (f instanceof o.DrawElements) {
                    var m = r[p];
                    if (!m) {
                        var g = f.getIndices().getItemSize(),
                            v = new o.BufferArray(o.BufferArray.ELEMENT_ARRAY_BUFFER, new Uint16Array, g);
                        m = r[p] = {
                            primitive: new o.DrawElements(p, v),
                            lastElement: -1,
                            initCount: 0
                        }, s && e.push(m.primitive)
                    }
                    var _ = m.primitive;
                    if (p === o.primitiveSet.TRIANGLE_STRIP && h[p] && s) {
                        var b = f.getIndices().getElements(),
                            S = b[0] + n,
                            x = m.lastElement !== S && 0 !== _.getCount() ? 2 : 0,
                            y = _.getCount() % 2;
                        _.setCount(_.getCount() + f.getCount() + x + y), m.lastElement = b[b.length - 1] + n
                    } else _.setCount(_.getCount() + f.getCount())
                } else f instanceof o.DrawArrays && c[p] && s && (a[p] || (a[p] = {
                    primitive: new o.DrawArrays(p, 0, 0),
                    initCount: 0
                }, e.push(a[p].primitive)))
            }
        },
        B = function (e) {
            for (var t = {
                    DrawElements: {},
                    DrawArrays: {}
                }, i = l.canMergeGeometry, n = 0, r = e.length; n < r; ++n) {
                var a = e[n],
                    s = a.getMode();
                if (a instanceof o.DrawElements) {
                    var u = a.getIndices().getElements();
                    t.DrawElements[s] = {
                        primitive: a,
                        lastElement: u[u.length - 1],
                        initCount: a.getCount()
                    }
                } else a instanceof o.DrawArrays && c[s] && i && (t.DrawArrays[s] = {
                    primitive: a,
                    first: a.getFirst(),
                    initCount: a.getCount()
                })
            }
            return t
        },
        U = function (e, t) {
            for (var i in e) {
                var n = e[i],
                    r = n.primitive,
                    a = r.getIndices(),
                    o = a.getElements(),
                    s = t >= 65535 ? Uint32Array : Uint16Array;
                a.setElements(new s(r.getCount())), a.getElements().set(o), r.setIndices(a), r.setCount(o.length)
            }
        },
        G = function (e, t, i, n) {
            for (var r = e.getVertexAttributeList(), a = e.getPrimitiveSetList(), o = v(e), s = n, u = 0, l = t.length; u < l; ++u) {
                var c = t[u],
                    h = c[c.length - 1];
                k(r, h.getVertexAttributeList(), o), V(a, i, h.getPrimitiveSetList(), s), s += _(c)
            }
            U(i.DrawElements, o)
        },
        j = function (e) {
            var t = e.DrawElements,
                i = l.canMergeGeometry;
            for (var n in t) {
                var r = t[n];
                i && h[n] || r.primitive.setCount(r.initCount)
            }
        },
        z = function (e, t) {
            var i = e.pathList,
                n = i.pop(),
                r = v(n[n.length - 1]),
                a = D(n, e.nbVertex, i);
            if (t.addChild(a), 0 !== i.length) {
                var o = a.getPrimitiveSetList(),
                    s = B(o);
                G(a, i, s, r);
                for (var u = l.canMergeGeometry, c = 0, h = i.length; c < h; ++c) {
                    var d = i[c];
                    L(a, d, r);
                    var f = d[d.length - 1];
                    if (!u || b(d)) {
                        var p = F(d, f);
                        u || (p._attributes = a.getVertexAttributeList(), t.addChild(p), M(p, f, 3 * r)), f = p
                    }
                    var m = f.getPrimitiveSetList();
                    P(s, o, m, r), r += _(d)
                }
                j(s)
            }
        },
        H = function (e) {
            var t = e.localRoot;
            e.renderPathList.sort(m);
            for (var i = R(e.renderPathList), n = i.length, r = 0; r < n; ++r) z(i[r], t)
        },
        W = function (e, t) {
            for (var i = e.getAttribute("SketchfabMaterial").getMaterialModel(), n = i.get(l.isWireframe ? "wireframeList" : "geometryList"), r = l.protectedGeometries, a = [], o = 0, s = n.length; o < s; ++o) {
                var u = n[o];
                r[u.getInstanceID()] && a.push(u)
            }
            n.length = 0, Array.prototype.push.apply(n, a), Array.prototype.push.apply(n, t.getChildren()), l.isWireframe && i.getChannels().Displacement.updateGeometryOffsets(), T(n)
        },
        q = function (e) {
            var t = e.localRoot,
                i = t.getStateSet(),
                n = i && g(i.getBinNumber());
            n && (l.hasTransparency = !0), l.canMergeGeometry = !n, e.renderPathList.length > l.limitMergePerMaterial && (l.canMergeGeometry = !0), H(e), W(i, t)
        },
        X = function (e, t, i) {
            var n = p(e),
                r = n.getInstanceID(),
                a = t[r];
            a || (t[r] = a = {
                localRoot: new o.Node,
                renderPathList: []
            }, a.localRoot.setStateSet(n), a.localRoot.setName(n.getName()), i.addChild(a.localRoot)), a.renderPathList.push(e), e[0] === i && e.shift()
        };
    l.optimizePaths = function (e, t, i) {
        l.isWireframe = !!i;
        for (var n = {}, r = t.length, a = 0; a < r; ++a) X(t[a], n, e);
        for (var o in n) q(n[o])
    }, l.optimizeWireframe = function (e, t, i) {
        var n = e.getChildren(),
            r = n.length;
        l.optimizePaths(e, t, !0);
        for (var a = n.length, o = r; o < a; ++o) i.push(n[o])
    }, t.a = l
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(149),
        a = i(707),
        o = i(101),
        s = i(152),
        u = n.a.osg,
        l = function (e, t) {
            return e - t
        },
        c = {
            Matcap: "Matcap",
            SubsurfaceScattering: "Subsurface scattering",
            SubsurfaceTranslucency: "Subsurface translucency",
            DiffuseColor: "Diffuse",
            DiffuseIntensity: "Lightmap",
            SpecularColor: "Specular Color",
            SpecularHardness: "Glossiness",
            Displacement: "Displacement",
            NormalMap: "Normal map",
            BumpMap: "Bump map",
            Opacity: "Opacity",
            EmitColor: "Emission",
            DiffusePBR: "Albedo",
            AlbedoPBR: "Base Color",
            SpecularPBR: "Specular",
            GlossinessPBR: "Glossiness",
            RoughnessPBR: "Roughness",
            MetalnessPBR: "Metalness",
            SpecularF0: "Specular F0",
            AOPBR: "Ambient Occlusion",
            CavityPBR: "Cavity",
            ClearCoat: "Clear Coat",
            ClearCoatRoughness: "Clear Coat roughness",
            ClearCoatNormalMap: "Clear Coat normap map"
        },
        h = r.a.extend({
            initDefaults: function (e) {
                var t = e.channels;
                delete e.channels, e.reflection = Object(o.a)() ? .1 : .3, e.verison = 3, r.a.prototype.initDefaults.call(this, e), t.Inspector = {
                    factor: 1,
                    enable: !0,
                    maskThreshold: 0,
                    invert: !1,
                    color: u.vec3.fromValues(1, 1, 1)
                };
                for (var i in t) {
                    var n = t[i];
                    switch (n.name = i, n.material = this, n.displayName = c[i], i) {
                        case "DiffuseColor":
                            n.color = Object(o.a)() ? u.vec3.fromValues(1, 1, 1) : u.vec3.fromValues(.5, .5, .5);
                            break;
                        case "Opacity":
                            n.useAlbedoTint = !Object(o.a)(), n.thinLayer = !Object(o.a)()
                    }
                    t[i] = new a.default[i].model(n)
                }
                this.set("channels", t)
            },
            getModelOptionPath: function () {
                return "materials:0"
            },
            defaults: function () {
                return {
                    geometryList: [],
                    wireframeList: [],
                    texCoordUnitList: [],
                    vertexColorColorSpace: "srgb",
                    vertexColorEnable: !1,
                    vertexAlphaEnable: !1,
                    hasVertexColor: !1,
                    hasVertexAlpha: !1,
                    hasTriangles: !1,
                    hasPoints: !1,
                    hasLines: !1,
                    stateSet: void 0,
                    stateSetWireframe: void 0,
                    uidUniqueMerged: "",
                    uidListUnusedDuplicates: []
                }
            },
            setMaterial: function (e) {
                this.set(e);
                var t = this.getChannels();
                for (var i in e.channels) t[i].set(e.channels[i])
            },
            setMaterialJSON: function (e, t, i) {
                var n = i || {},
                    a = e.channels;
                n.ignore = ["channels"];
                var o = r.a.prototype.setJSON.call(this, e, n);
                if (a) {
                    for (var u = this.getChannels(), l = s.a.length, c = 0; c < l; ++c) {
                        var h = s.a[c],
                            d = a[h];
                        if (d) {
                            var f = u[h];
                            if (f) {
                                var p = f.setChannelJSON(d, t, n);
                                p.length && o.concat(p)
                            }
                        }
                    }
                    return o
                }
            },
            getChannels: function () {
                return this.get("channels")
            },
            setStateSet: function (e) {
                return this.set("stateSet", e), this
            },
            setChannelEnable: function (e, t) {
                var i = this.get("channels");
                return i[e] ? (i[e].setEnable(t), this) : this
            },
            setChannelColor: function (e, t) {
                var i = this.get("channels"),
                    n = i[e];
                return n && n.setColor ? (n.setColor(t), this) : this
            },
            setChannelTexture: function (e, t) {
                var i = this.get("channels");
                return i[e] ? (i[e].setTextureModel(t), this) : this
            },
            setChannelFactor: function (e, t) {
                var i = this.get("channels");
                return i[e] ? (i[e].setFactor(t), this) : this
            },
            getJSON: function () {
                var e = r.a.prototype.getJSON.call(this, {
                    ignore: ["channels"]
                });
                e.version = 3, e.channels = {};
                var t = this.get("channels");
                for (var i in t) "Inspector" !== i && (e.channels[i] = t[i].getJSON());
                return e
            },
            copyDualChannel: function (e, t) {
                var i = this.getChannels(),
                    n = i[e],
                    r = i[t],
                    a = r.getTextureModel(),
                    o = "MetalnessPBR" === e || "SpecularPBR" === e,
                    s = "NormalMap" === e || "BumpMap" === e;
                a ? (a = a.clone(), (o || s) && (a.setImageModel(a.getImageModel()), a.set("internalFormat", "NormalMap" === e || "SpecularPBR" === e ? u.Texture.RGB : u.Texture.LUMINANCE), a.updateMultiresTexture()), n.setTextureModel(a)) : o || (n.setColor ? r.getColor && n.setColor(r.getColor()) : n.setTextureModel(void 0)), s || n.setFactor(r.getFactor())
            },
            isWorkflowMetalness: function () {
                return this.getChannels().MetalnessPBR.getEnable()
            },
            setWorkFlowRoughGloss: function (e, t) {
                var i = e ? "GlossinessPBR" : "RoughnessPBR",
                    n = e ? "RoughnessPBR" : "GlossinessPBR",
                    r = this.getChannels();
                r[i].setEnable(!1), r[n].setEnable(!0), t && this.copyDualChannel(n, i, r)
            },
            setWorkFlowMetalSpec: function (e, t) {
                var i = e ? "DiffusePBR" : "AlbedoPBR",
                    n = e ? "SpecularPBR" : "MetalnessPBR",
                    r = e ? "AlbedoPBR" : "DiffusePBR",
                    a = e ? "MetalnessPBR" : "SpecularPBR",
                    o = this.getChannels();
                o[i].setEnable(!1), o[n].setEnable(!1), o.SpecularF0.setEnable(e), o[r].setEnable(!0), o[a].setEnable(!0), t && (this.copyDualChannel(r, i), this.copyDualChannel(a, n))
            },
            hasOnlyPoints: function () {
                return this.get("hasPoints") && !this.get("hasTriangles") && !this.get("hasLines")
            },
            updateTexCoordUnitList: function () {
                var e = this.get("texCoordUnitList");
                e.length = 0;
                for (var t, i, n = this.get("geometryList"), r = n.length, a = [], o = [], u = 0; u < r; ++u) {
                    var c = n[u].getVertexAttributeList();
                    o.length = 0;
                    for (var h in c) - 1 !== h.indexOf("TexCoord") && o.push(parseInt(h.substring(8)));
                    for (o.sort(l), t = o.length - 1; t >= 0; --t) {
                        var d = o[t],
                            f = c["TexCoord" + d];
                        for (i = 0; i < t; ++i) {
                            var p = o[i];
                            if (f === c["TexCoord" + p]) {
                                var m = a[d];
                                void 0 !== m && m !== p ? -1 === e.indexOf(d) && e.push(d) : a[d] = p;
                                break
                            }
                        }
                        var g = o[i]; - 1 === e.indexOf(g) && e.push(g)
                    }
                }
                if (e.sort(l), 0 !== a.length) {
                    var v = e.length;
                    for (t = 0; t < v; ++t) a[e[t]] = e[t];
                    var _ = this.getChannels(),
                        b = s.a.length;
                    for (t = 0; t < b; ++t) {
                        var S = _[s.a[t]];
                        S.setTexCoordUnit(a[S.getTexCoordUnit()])
                    }
                }
            },
            enforceWorkflow: function () {
                var e = this.getChannels(),
                    t = e.MetalnessPBR.getEnable();
                e.AlbedoPBR.setEnable(t), e.SpecularF0.setEnable(t), e.DiffusePBR.setEnable(!t), e.SpecularPBR.setEnable(!t);
                var i = e.RoughnessPBR.getEnable();
                e.GlossinessPBR.setEnable(!i), e.BumpMap.getEnable() && e.NormalMap.getEnable() && e.BumpMap.setEnable(!1)
            }
        });
    t.a = h
}, function (e, t, i) {
    "use strict";
    var n = i(8),
        r = i(707),
        a = i(924),
        o = i(44),
        s = i(152),
        u = i(119),
        l = n.a.extend({
            initialize: function () {
                n.a.prototype.initialize.apply(this, arguments), this.model.bind("change:stateSet", this.stateSet, this), this.model.bind("change:cullFace", this.onCullFace, this), this.model.bind("change:shadeless", this.onDirty, this), this.model.bind("change:vertexColorEnable", this.onDirty, this), this.model.bind("change:vertexColorColorSpace", this.onDirty, this), this.model.bind("change:vertexAlphaEnable", this.onDirty, this), u.a.bind("change:hasSsr", this.onDirty, this), this.model.bind("change:hasPoints", this.onPrimitive, this), this.model.bind("change:hasTriangles", this.onPrimitive, this), this.model.bind("change:hasLines", this.onPrimitive, this), this.model.bind("apply", this.apply, this), this.model.bind("change", o.a.draw), this._context = new a.a(this.model), this._views = {};
                for (var e = this.model.get("channels"), t = s.a.length, i = 0; i < t; ++i) {
                    var l = s.a[i],
                        c = e[l];
                    this._views[l] = new r.default[l].view({
                        model: c
                    }), this._views[l].stateSetContext = this._context, c.bind("change:enable", this.model.enforceWorkflow, this.model)
                }
            },
            getStateSetContext: function () {
                return this._context
            },
            stateSet: function () {
                var e = this.model.get("stateSet");
                return e.setName(this.model.get("name")), this.getStateSetContext().setStateSet(e), this
            },
            apply: function () {
                for (var e in this._views) this._views[e].updateChannel();
                this.onCullFace(), this.onDirty()
            },
            onDirty: function () {
                this.getStateSetContext().dirtyMaterial()
            },
            onCullFace: function () {
                this.getStateSetContext().setCullface(this.model.get("cullFace"))
            },
            onPrimitive: function () {
                this.getStateSetContext().setPointCircle(this.model.hasOnlyPoints())
            }
        });
    t.a = l
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(229),
        a = i(423),
        o = i(585),
        s = i(152),
        u = i(20),
        l = i(44),
        c = n.a.osg,
        h = "rgba",
        d = {};
    d[c.Texture.LUMINANCE] = "r", d[c.Texture.ALPHA] = "a", d[c.Texture.RGB] = "rgb";
    var f = function (e) {
            c.Texture.call(this), this._texture = e, this._isColorAtlas = !1, this._channels = [], this._packedTextures = {}
        },
        p = function (e, t) {
            var i = s.a.getDefaultComponentCount(e),
                n = s.a.getDefaultComponentCount(t);
            return n === i ? e < t ? 1 : -1 : n - i
        };
    c.createPrototypeStateAttribute(f, c.objectInherit(c.Texture.prototype, {
        attributeType: "Texture",
        invalidate: function () {
            this._isColorAtlas || (this._texture = void 0)
        },
        isColorAtlas: function () {
            return this._isColorAtlas
        },
        setIsColorAtlas: function (e) {
            this._isColorAtlas = e
        },
        getChannelPacking: function (e) {
            var t = this._packedTextures[e];
            return t ? t.pack : ""
        },
        getPackedTextures: function () {
            return this._packedTextures
        },
        getOrderedChannels: function () {
            return this._channels
        },
        getTexture: function () {
            return this._texture || (this._texture = o.a.packTextures(this)), this._texture
        },
        setTexture: function (e) {
            this._texture = e
        },
        getChannelCount: function () {
            return this._channels.length
        },
        addChannel: function (e, t, i) {
            this._packedTextures[e] || (this._packedTextures[e] = {
                texture: t,
                pack: "rgb"
            }, i || this._channels.push(e), this._isColorAtlas || (this._texture = void 0, this.updatePacking()))
        },
        removeChannel: function (e) {
            this._packedTextures[e] && (delete this._packedTextures[e], this._channels.splice(this._channels.indexOf(e), 1), this._isColorAtlas || (this._texture = void 0, this.updatePacking()))
        },
        packChannelIfPossible: function (e, t) {
            if (this._isColorAtlas || !Object(u.a)().materialPacking || t.isVideo()) return !1;
            var i = this._channels,
                n = i.length;
            if (0 === n) return !1;
            for (var r = 4, a = 0; a < n; ++a) r -= this._packedTextures[i[a]].pack.length;
            return 0 !== r && (!(3 === s.a.getDefaultComponentCount(e) && r < 3) && (!!this.isFilteringFriendly(t, this._packedTextures[i[0]].texture) && (i.push(e), this.addChannel(e, t, !0), this.updatePacking(), !0)))
        },
        isFilteringFriendly: function (e, t) {
            return e.getMinFilter() === t.getMinFilter() && (e.getMagFilter() === t.getMagFilter() && (e.getWrapS() === t.getWrapS() && e.getWrapT() === t.getWrapT()))
        },
        getSinglePacking: function (e, t) {
            if ("Opacity" === e) {
                var i = t.getInternalFormat(),
                    n = i && d[t.getInternalFormat()];
                return n && 1 === n.length ? n : "r"
            }
            return "EmitColor" === e && t.getInternalFormat() === c.Texture.ALPHA ? "aaa" : s.a.getDefaultFormatComponent(e)
        },
        updatePacking: function () {
            var e = this._channels,
                t = 0,
                i = e.length;
            if (1 === i) {
                var n = this._packedTextures[e[0]];
                return void(n.pack = this.getSinglePacking(e[0], n.texture))
            }
            e.sort(p);
            for (var r = 0; r < i; ++r) {
                var a = e[r],
                    o = this._packedTextures[a];
                if (o) {
                    var u = s.a.getDefaultFormatComponent(a).length;
                    o.pack = h.substr(t, u), t += u
                }
            }
        },
        getMaxTextureSizePacked: function (e) {
            e.width = 0, e.height = 0;
            for (var t = this._channels, i = t.length, n = 0; n < i; ++n) {
                var r = t[n],
                    a = this._packedTextures[r];
                if (a) {
                    var o = a.texture;
                    if (o.getImageJSONMaxSupported) {
                        var s = o.getImageJSONMaxSupported();
                        if (e.width = Math.max(e.width, s.width), e.height = Math.max(e.height, s.height), !(s.width <= 512 && s.height <= 512)) {
                            var u = o.getImageJSONMaxSupported(512);
                            if (512 !== u.width && 512 !== u.height) {
                                var l = o.getImageModel().getUID(),
                                    c = e.missingTextures[l];
                                c ? -1 === c.indexOf("channelName") && c.push(r) : e.missingTextures[l] = [r]
                            }
                        }
                    }
                }
            }
            return e
        },
        isProtectedTexture: function () {
            for (var e = a.a.compilerChannels[a.a.EARLYZ_COMPILER], t = 0; t < e.length; ++t)
                if (this._packedTextures[e[t]]) return !0;
            return !1
        },
        getImage: function () {
            return this.getTexture().getImage()
        },
        cloneType: function () {
            return new f(new r.a)
        },
        isTextureNull: function () {
            return !(!this._isColorAtlas || 0 !== this._channels.length) || this.getTexture().isTextureNull()
        },
        apply: function (e) {
            var t = e.getGraphicContext();
            this.setGraphicContext(t);
            var i = this.getTexture(),
                n = i._textureObject && !i.isDirty();
            i.apply(e), n || (this._packedTextures.Opacity || this._packedTextures.Displacement) && l.a.redrawShadowNextFrame()
        },
        getHash: function () {
            return ""
        }
    }), "osgSketchfab", "PackedMaterialTexture"), t.a = f
}, function (e, t, i) {
    "use strict";
    t.a = function () {
        return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function (e) {
            var t = 16 * Math.random() | 0;
            return ("x" === e ? t : 3 & t | 8).toString(16)
        })
    }
}, function (e, t, i) {
    "use strict";
    var n = i(90),
        r = i(1304),
        a = i(1305),
        o = {
            FeatureName: "shadingStyle",
            ModelType: r.a,
            ViewListType: [a.a]
        },
        s = n.a.create(o);
    t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(149),
        r = i(47),
        a = i(101),
        o = n.a.extend({
            initialize: function () {
                n.a.prototype.initialize.apply(this, arguments), this._wireframeSchema = this.getSubSchema("wireframe");
                var e = this.getInstance(this._wireframeSchema);
                this.set("wireframeEnable", e.enable), this.set("wireframeColor", e.color)
            },
            getModelOptionPath: function () {
                return "shading"
            },
            defaults: function () {
                return {
                    hasWireframe: !0,
                    hasVertexColor: !1,
                    hasVertexAlpha: !1,
                    hasPoints: !1,
                    hasLines: !1,
                    hasTriangles: !1,
                    webVR: !1
                }
            },
            getName: function () {
                return "ShadingStyle"
            },
            init: function (e) {
                this.set("hasWireframe", !!e.getScene().getWireframeSize()), this.set("vertexColorUseAlpha", Object(a.a)()), this.set("vertexColorColorSpace", Object(a.a)() ? "srgb" : "linear"), this.set("pointSize", Object(a.a)() ? 2 : 0);
                var t = e.getModel().get("options"),
                    i = t.shading,
                    n = t.wireframe;
                i && this.setJSON({
                    shading: i,
                    wireframe: n
                }), Object(a.a)() && r.a.getMaterial().then(function () {
                    var t = e.getFeatures().material.getModel();
                    this.set("renderer", "pbr", {
                        copyChannel: !0,
                        overrideTexture: !1
                    }), t._style && this.set("type", t._style)
                }.bind(this))
            },
            setWireframeColorSmooth: function (e) {
                this.trigger("setWireframeColorSmooth", e)
            },
            setWireframeJSON: function (e, t) {
                if (t && t.validate) {
                    var i = this.validate(e, {
                        schema: this._wireframeSchema
                    });
                    if (i.length) return i.join("\n")
                }
                return void 0 !== e.enable && this.set("wireframeEnable", e.enable), e.color && e.enable && this.set("wireframeColor", e.color), []
            },
            setJSON: function (e, t) {
                var i = n.a.prototype.setJSON.call(this, e.shading, t),
                    r = this.setWireframeJSON(e.wireframe, t);
                return i.concat(r), i
            },
            getJSON: function () {
                return {
                    shading: n.a.prototype.getJSON.call(this),
                    wireframe: {
                        enable: this.get("wireframeEnable"),
                        color: this.get("wireframeColor")
                    }
                }
            },
            editorGetJSON: function () {
                return this.getJSON()
            },
            editorSetJSON: function (e) {
                return this.setJSON(e, {
                    validate: !0
                })
            }
        });
    t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(47),
        a = i(8),
        o = i(709),
        s = i(69),
        u = i(119),
        l = i(44),
        c = i(321),
        h = i(423),
        d = i(230),
        f = i(924),
        p = i(103),
        m = n.a.osg,
        g = a.a.extend({
            initialize: function (e) {
                a.a.prototype.initialize.apply(this, arguments);
                var t = this.model;
                t.bind("change:webVR", this.onWebVRChanged, this), t.bind("change:renderer", this.onRendererChanged, this), t.bind("change:type", this.onShadingChanged, this), t.bind("change:pointSize", this.onPointSizeChanged, this), t.bind("change:wireframeEnable", this.onWireframeEnableChanged, this), t.bind("change:wireframeColor", this.onWireframeColorChanged, this), t.bind("change:vertexColorEnable", this.onVertexColorChanged, this), t.bind("change:vertexColorUseAlpha", this.onVertexColorChanged, this), t.bind("change:vertexColorColorSpace", this.onVertexColorChanged, this), t.bind("setWireframeColorSmooth", this.onSetWireframeColorSmooth, this), this._viewer = e.context.getViewer(), this._viewerOSGJS = this._viewer.getViewerOSGJS(), this._rootStateSet = this._viewerOSGJS.getSceneData().getOrCreateStateSet(), this._rootStateSet.setShaderGeneratorName(this.getCompilerName()), this.updateShadingGlobal(), this._wireframeNodes = e.context.getScene().getWireframeNodes(), r.a.getPolygon().then(function () {
                    this.model.set("hasVertexColor", h.a.hasVertexColor), this.model.set("hasVertexAlpha", h.a.hasVertexAlpha), !1 === h.a.hasVertexColor && this.model.set("vertexColorEnable", !1), !1 === h.a.hasVertexAlpha && this.model.set("vertexColorUseAlpha", !1), this.onVertexColorChanged(), this.model.set("hasPoints", d.a.hasPoints), this.model.set("hasTriangles", d.a.hasTriangles), this.model.set("hasLines", d.a.hasLines)
                }.bind(this)), p.a.getBoxReady().then(this.onPointSizeChanged.bind(this)), r.a.getWireframeOptimizedSplit().then(this.initWireframe.bind(this)), this._viewer.bind("resizeRatio", this.updatePointSize, this), r.a.getMaterial().then(function () {
                    this._viewer.getFeatures().camera.getModel().bind("change:fov", this.onPointSizeChanged, this)
                }.bind(this))
            },
            onWebVRChanged: function () {
                for (var e = this._wireframeNodes, t = 0, i = e.length; t < i; ++t) e[t].getStateSet().setRenderBinVR(this.model.get("webVR"))
            },
            updatePointSize: function () {
                var e = this._viewer.getFeatures(),
                    t = this._viewer.getFeaturesManager(),
                    i = p.a.getModelBoxWithDisplacement().radius();
                i *= this.model.get("pointSize"), i *= 45 / e.camera.getModel().get("fov"), i *= 75e-5 * t.getViewport3d().height(), f.a.cachedSquarePoint.setPointSize(i), f.a.cachedCirclePoint.setPointSize(i)
            },
            onPointSizeChanged: function () {
                this.updatePointSize(), l.a.draw()
            },
            initWireframe: function () {
                var e = !0 === this.model.get("wireframeEnable") ? s.a.NO_PICK_NO_SHADOW : 0;
                this.setWireframeNodesMask(e);
                var t = this.setWireframeNodesMask.bind(this, 0);
                o.a.updateCallback.setFinishCallback(t), this.onWireframeColorChanged(), this.model.get("wireframeEnable") && this.onWireframeEnableChanged()
            },
            setWireframeNodesMask: function (e) {
                for (var t = this._wireframeNodes, i = 0, n = t.length; i < n; ++i) t[i].setNodeMask(e);
                c.a.setWireframe(0 !== e)
            },
            getCompilerName: function () {
                var e = this.model.get("type");
                return "matcap" === e || "inspector" === e ? e : e + "-" + this.model.get("renderer")
            },
            updateShadingGlobal: function () {
                var e, t = this.model.get("type"),
                    i = this.model.get("renderer"),
                    n = "pbr" === i;
                e = "matcap" === t ? u.a.MATCAP : "inspector" === t ? u.a.INSPECTOR : "shadeless" === t ? n ? u.a.PBR_SHADELESS : u.a.CLASSIC_SHADELESS : n ? u.a.PBR_LIT : u.a.CLASSIC_LIT, u.a.set("mask", e)
            },
            _overrideChannelTexture: function (e, t, i) {
                e.getTextureModel() ? !i && t.getTextureModel() || t.setTextureModel(e.getTextureModel().clone()) : !t.getTextureModel() && t.setColor && e.getColor && t.setColor(e.getColor())
            },
            copyChannels: function (e, t, i) {
                var n = {
                    DiffusePBR: "DiffuseColor",
                    AlbedoPBR: "DiffuseColor",
                    AOPBR: "DiffuseIntensity"
                };
                for (var r in n) {
                    var a = t.getChannels(),
                        o = a[r],
                        s = a[n[r]];
                    if ("pbr" !== e) {
                        var u = t.isWorkflowMetalness();
                        (u && "DiffusePBR" !== r || !u && "AlbedoPBR" !== r) && this._overrideChannelTexture(o, s, i)
                    } else this._overrideChannelTexture(s, o, i)
                }
            },
            onRendererChanged: function (e, t, i) {
                this.onShadingChanged();
                var n = this.model.get("renderer"),
                    r = void 0 === i.copyChannel || i.copyChannel,
                    a = void 0 === i.overrideTexture || i.overrideTexture,
                    o = this._viewer.getFeatures().material;
                if (!o) return void m.error("The renderer has been changed before the material feature is initialized");
                var s = o.getModel().attributes,
                    u = this;
                if (r)
                    for (var c in s) u.copyChannels(n, s[c], a);
                l.a.draw()
            },
            onShadingChanged: function () {
                this.updateShadingGlobal(), this._rootStateSet.setShaderGeneratorName(this.getCompilerName()), l.a.draw()
            },
            onWireframeColorChanged: function () {
                for (var e = this._wireframeNodes, t = 0, i = e.length; t < i; ++t) e[t].getStateSet().setWireframeColor(this.getRGBA())
            },
            onSetWireframeColorSmooth: function (e) {
                var t = this.model;
                t.off("change:wireframeColor", this.onWireframeColorChanged, this), t.set("wireframeColor", e), t.bind("change:wireframeColor", this.onWireframeColorChanged, this);
                for (var i = this._wireframeNodes, n = 0, r = i.length; n < r; ++n) i[n].getStateSet().setWireframeColorSmooth(this.getRGBA());
                t.off("change:wireframeColor", this.onWireframeColorChanged, this), t.set("wireframeColor", e), t.on("change:wireframeColor", this.onWireframeColorChanged, this)
            },
            onWireframeEnableChanged: function () {
                this.setWireframeNodesMask(s.a.NO_PICK_NO_SHADOW);
                for (var e = this._wireframeNodes, t = this.model.get("wireframeEnable"), i = 0, n = e.length; i < n; ++i) e[i].getStateSet().setWireframeEnable(t, this.getRGBA())
            },
            getRGBA: function () {
                var e = m.vec4.create();
                return function (t) {
                    var i = t || this.model.get("wireframeColor");
                    return e[0] = parseInt(i.substr(0, 2), 16) / 255, e[1] = parseInt(i.substr(2, 2), 16) / 255, e[2] = parseInt(i.substr(4, 2), 16) / 255, e[3] = parseInt(i.substr(6, 2), 16) / 255, e
                }
            }(),
            _inspectorForceAlpha: function () {
                var e = this._viewer.getFeatures().inspector.getModel();
                return "Default" !== e.get("displayView") && -1 !== e.get("availableDisplayView").indexOf("VertexAlpha")
            },
            onVertexColorChanged: function () {
                var e = this._viewer.getFeatures().material;
                if (e) {
                    var t = this.model.get("vertexColorEnable"),
                        i = this.model.get("vertexColorColorSpace"),
                        n = this.model.get("vertexColorUseAlpha") && (this._inspectorForceAlpha() || t),
                        r = e.getModel().attributes;
                    for (var a in r) {
                        var o = r[a];
                        o.set("vertexColorEnable", t && o.get("hasVertexColor")), o.set("vertexColorColorSpace", i);
                        var s = n && o.get("hasVertexAlpha");
                        o.set("vertexAlphaEnable", s)
                    }
                    l.a.draw()
                }
            }
        });
    t.a = g
}, function (e, t, i) {
    "use strict";
    var n = i(90),
        r = i(1307),
        a = i(1308),
        o = {
            FeatureName: "quality",
            ModelType: r.a,
            ViewListType: [a.a]
        },
        s = n.a.create(o);
    s.prototype.prepareForScreenShot = function () {
        this._model.set("maxQuality", !0)
    }, s.prototype.resetAfterScreenShot = function () {
        this._model.set("maxQuality", !1)
    }, t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(38),
        r = i.n(n),
        a = i(9),
        o = i(11),
        s = i(20),
        u = i(86),
        l = i(79),
        c = a.a.osg,
        h = o.a.extend({
            defaults: function () {
                var e = 1;
                return r.a.any ? e = 0 : Object(l.a)() && (e = 2), this._deferReady = Object(u.a)(), {
                    promiseReady: this._deferReady.promise,
                    level: e,
                    maxQuality: !1,
                    dynamicResolutionScaling: c.vec2.fromValues(1, 1)
                }
            },
            getBudget: function () {
                var e = Object(s.a)();
                return void 0 !== e.pixelBudget ? e.pixelBudget < 0 ? 1 / 0 : e.pixelBudget : this.getBudgetFromLevel(this.get("level"))
            },
            getBudgetFromLevel: function (e) {
                return 0 === e ? 6144 : 1 === e ? 12288 : 1 / 0
            },
            getName: function () {
                return "Quality"
            }
        });
    t.a = h
}, function (e, t, i) {
    "use strict";
    var n = i(8),
        r = i(47),
        a = i(20),
        o = i(632),
        s = i(581),
        u = i(44),
        l = i(9),
        c = l.a.osg,
        h = c.Timer.instance(),
        d = Object(a.a)().drs ? Object(a.a)().drsRatio : 0,
        f = Object(a.a)().drsMin,
        p = 1e3 / Object(a.a)().drsFps,
        m = n.a.extend({
            initialize: function () {
                n.a.prototype.initialize.apply(this, arguments);
                var e = this.options.context;
                this._viewer = e.getViewer(), this._fMaterial = e.getFeatures().material, this._version = e.getModel().get("options").version, this.model.bind("change:level", this.onLevelChanged, this), this.model.bind("updateTexelPolicy", this.updateTexelPolicy, this), this.model.bind("updateDynamicResolutionScaling", this._updatePixelRatio.bind(this)), this._maxSize = Object(o.a)(), this._resumeDrs = 1, this._resumeQuality = 1, this._resumeAfterSSAA = !0, this._drsTest = Object(a.a)().drsTest, this._lastTickIncreaseDrs = 0, this._lastTickIncreasePP = 0, this._continuousDrs = 0, this._continuousQuality = 0, r.a.getFirstCameraAnimation().then(this.initTimers.bind(this))
            },
            initTimers: function () {
                this._lastTick = h.tick(), this._viewer.getRootScene().addUpdateCallback(this)
            },
            _updatePixelRatio: function () {
                var e = this.model.get("dynamicResolutionScaling"),
                    t = this._viewer.getViewerOSGJS().getCanvasPixelRatio(),
                    i = this._viewer.getInputManager().getParam("pixelRatio");
                i[0] = t * e[0], i[1] = t * e[1]
            },
            _forceFullRes: function () {
                if (this.model.get("maxQuality")) return !0;
                var e = this._viewer.getSuperSample();
                return !(!e.isEnabled() && !e.isFakeEnabled()) || !!this._viewer.getFeatures().webVR.getModel().get("enable")
            },
            _sceneBeingDrawn: function () {
                return this._viewer.getFeatures().postProcess.getCamera().getNodeMask()
            },
            _handleQualitySSAA: function () {
                var e = this._viewer.getFeatures(),
                    t = e.postProcess.getModel(),
                    i = this.model.get("dynamicResolutionScaling");
                if (this._forceFullRes()) {
                    if (this._resumeAfterSSAA) return !0;
                    this._resumeQuality = t.getQuality(), this._resumeDrs = i[0], i[0] = 1;
                    var n = this.model.get("maxQuality"),
                        r = n ? 1.01 : Math.max(.5, .3 + this._resumeQuality);
                    return t.setQuality(r), this._resumeAfterSSAA = !0, !0
                }
                return !this._sceneBeingDrawn() || !!this._resumeAfterSSAA && (this._resumeAfterSSAA = !1, i[0] = this._resumeDrs, t.setQuality(this._resumeQuality), this._continuousQuality = this._resumeQuality, this._continuousDrs = this._resumeDrs, !0)
            },
            _updateQuality: function (e, t) {
                if (!this._handleQualitySSAA()) {
                    var i = e - t,
                        n = this._viewer.getFeatures(),
                        r = n.postProcess.getModel(),
                        a = this.model.get("dynamicResolutionScaling"),
                        o = (p - i) / p;
                    this._continuousDrs = this._continuousDrs + this._continuousDrs * d * o, this._continuousDrs = Math.min(1, Math.max(f, this._continuousDrs));
                    var s = Math.min(1, 1.2 * a[0]);
                    if (this._continuousDrs < a[0] ? (a[0] = this._continuousDrs, this._lastTickIncreaseDrs = e) : this._continuousDrs >= s && e - this._lastTickIncreaseDrs > 500 && (a[0] = s, this._lastTickIncreaseDrs = e), this._drsTest) {
                        this._drsTest++, a[0] = this._drsTest % 200 > 100 ? 1 : .3, u.a.draw()
                    }
                    var l = (1e3 / 55 - i) / (1e3 / 55);
                    this._continuousQuality = Math.min(Math.max(0, this._continuousQuality + l), 1);
                    var c = r.getQuality(),
                        h = Math.min(1, c + .2),
                        m = Math.max(0, c - .2);
                    e - this._lastTickIncreasePP > 500 && (this._continuousQuality < m ? (r.setQuality(m), this._lastTickIncreasePP = e) : this._continuousQuality >= h && (r.setQuality(h), this._lastTickIncreasePP = e))
                }
            },
            update: function () {
                var e = this.model.get("dynamicResolutionScaling"),
                    t = e[0],
                    i = h.tick();
                return this._updateQuality(i, this._lastTick), this._lastTick = i, e[1] = e[0], t !== e[0] && this.model.trigger("updateDynamicResolutionScaling"), !0
            },
            getMaterials: function () {
                return this._fMaterial.getModel().attributes
            },
            onLevelChanged: function () {
                this.updateTexelPolicy();
                var e = this._fMaterial._views[0],
                    t = e.requestAllHighResTextures(this._fMaterial.getModel().attributes);
                this._viewer.setFakeSecondaryProgress(t, "texture"), this._fMaterial._views[0].cleanAndApplyMaterials()
            },
            getOrCreateTexelInfos: function () {
                return this._fMaterial._views[0].getOrCreateTexelInfos()
            },
            getMaxSizeFromBudget: function (e) {
                var t = e * e,
                    i = this.getOrCreateTexelInfos();
                if (0 === i.gpuTextureCount || i.gpuPixelCount <= t) return this._maxSize;
                var n = Math.min(this._maxSize, Math.sqrt(t / i.gpuTextureCount));
                return n = s.a.snapToPowerOf2(n, .75), this._version < 2 && (n < 1024 ? n = 512 : n >= 1024 && n < 2048 && (n = 2048)), i.max <= n || i.gpuPixelCount <= n * n ? this._maxSize : n
            },
            _printErrorMissingResolution: function (e) {
                var t = Object.keys(e.missingTextures).length;
                if (0 === t) return 0;
                var i = "",
                    n = e.missingTextures;
                for (var r in n) i += "\n" + r + " (" + n[r].join(", ") + ")";
                return console.error("Multi-resolution textures missing : " + t + i), t
            },
            updateTexelPolicy: function () {
                if (Object(a.a)().imageCompression) {
                    var e = this.getOrCreateTexelInfos(),
                        t = this._printErrorMissingResolution(e);
                    0 === e.gpuTextureCount || t >= e.gpuTextureCount || (this.model.get("promiseReady").isPending() && this.initAvailableTextureQuality(), Object(a.a)().maxTextureSize = this.getMaxSizeFromBudget(this.model.getBudget()))
                }
            },
            initAvailableTextureQuality: function () {
                var e = this.getMaxSizeFromBudget(this.model.getBudgetFromLevel(0)),
                    t = this.getMaxSizeFromBudget(this.model.getBudgetFromLevel(1)),
                    i = {
                        low: !0,
                        mid: t !== e,
                        high: t !== this._maxSize
                    },
                    n = this.model.get("level");
                i.high || 2 !== n || (n = 1), i.mid || 1 !== n || (n = 0), 1 === n && (i.low = !1), this.model.off(null, this.onLevelChanged, this), this.model.set("level", n), this.model.on("change:level", this.onLevelChanged, this), this.model._deferReady.resolve(i)
            }
        });
    t.a = m
}, function (e, t, i) {
    "use strict";
    var n = i(90),
        r = i(1310),
        a = i(1311),
        o = {
            FeatureName: "autospin",
            ModelType: r.a,
            ViewListType: [a.a]
        },
        s = n.a.create(o);
    s.prototype.getNode = function () {
        return this._views[0]._nodeAutospin
    }, t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(24),
        r = i.n(n),
        a = i(20),
        o = r.a.Model.extend({
            defaults: {
                enable: !1,
                paused: !1,
                speed: .6
            },
            getName: function () {
                return "Autospin"
            },
            init: function () {
                var e = Object(a.a)();
                void 0 !== e.autospin && (this.set("enable", !!e.autospin), this.set("speed", e.autospin))
            }
        });
    t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(8),
        a = i(633),
        o = i(1312),
        s = i(47),
        u = i(199),
        l = n.a.osg,
        c = n.a.InputGroups,
        h = r.a.extend({
            initialize: function () {
                r.a.prototype.initialize.apply(this, arguments), this._viewer = this.options.context.getViewer(), this._inputManager = this._viewer.getInputManager();
                var e = this.model;
                e.bind("change:enable", this.onEnableChanged, this), e.bind("change:paused", this.onPausedChanged, this), e.bind("change:speed", this.onSpeedChanged, this), this._nodeAutospin = new l.MatrixTransform, this._nodeAutospin.setName("Feature - Autospin"), this._callbackAutospin = new o.a(e.get("speed"), 1, 1), this._nodeAutospin.addUpdateCallback(this._callbackAutospin), !1 === e.get("enable") && this._callbackAutospin.deactivate(), u.a.initAutospin(this, this.model.get("enable")), s.a.getModelDisplayed().then(this.linkWithEvents.bind(this))
            },
            isOrbit: function () {
                var e = this._viewer.getFeatures().camera;
                return e && e.getModel().get("indexManipulator") === a.a.ORBIT
            },
            linkWithEvents: function () {
                this._viewer.getFeatures().camera.getModel().bind("change:indexManipulator", this.onManipulatorChange.bind(this)), this.onManipulatorChange()
            },
            onManipulatorChange: function () {
                clearTimeout(this._timerAutospin), this.model.set("paused", !this.isOrbit())
            },
            pause: function () {
                clearTimeout(this._timerAutospin), this.model.set("paused", !0)
            },
            resume: function () {
                if (this.isOrbit()) {
                    var e = this.model;
                    this._timerAutospin = setTimeout(function () {
                        e.set("paused", !1)
                    }, 5e3)
                }
            },
            onEnableChanged: function () {
                !0 === this.model.get("enable") ? (this._callbackAutospin.resume(), this._inputManager.setEnable(c.AUTOSPIN, !0)) : (this._callbackAutospin.deactivate(), this._inputManager.setEnable(c.AUTOSPIN, !1))
            },
            onPausedChanged: function () {
                !1 !== this.model.get("enable") && (!0 === this.model.get("paused") ? this._callbackAutospin.pause() : this._callbackAutospin.resume())
            },
            onSpeedChanged: function () {
                this._callbackAutospin.setSpeed(this.model.get("speed"))
            }
        });
    t.a = h
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(44),
        a = n.a.osg,
        o = function (e, t, i) {
            this._speed = void 0 !== e ? e : -.6, this._fadeStart = void 0 !== t ? t : 2, this._fadeEnd = void 0 !== i ? i : 2, this._enable = !0, this._rotation = 0, this._lastTime = -1, this._startTime = 0, this._endTime = 0, this._checkIfFinished = !1, this._fixedCenter = void 0
        };
    a.createPrototypeObject(o, {
        setSpeed: function (e) {
            this._speed = e
        },
        setFadeStart: function (e) {
            this._fadeStart = e
        },
        setFadeEnd: function (e) {
            this._fadeEnd = e
        },
        deactivate: function () {
            this._enable = !1
        },
        resume: function () {
            this._enable = !0, this._checkIfFinished = !1;
            var e = Math.max((this._endTime - this._lastTime) / this._fadeEnd, 0);
            this._startTime = this._lastTime - this._fadeStart * e, this._endTime = this._lastTime, r.a.draw()
        },
        pause: function () {
            var e = Math.min((this._lastTime - this._startTime) / this._fadeStart, 1);
            this._endTime = this._lastTime + this._fadeEnd * e, this._checkIfFinished = !0
        },
        update: function () {
            var e = a.mat4.create();
            return function (t, i) {
                if (!1 === this._enable) return !0;
                r.a.draw();
                var n = i.getFrameStamp().getSimulationTime();
                if (!0 === this._checkIfFinished && this._endTime < n) return this._enable = !1, this._checkIfFinished = !1, this._lastTime = -1, !0;
                if (this._lastTime < 0) return this._lastTime = n, this._startTime = n, !0;
                var o = n - this._lastTime;
                this._lastTime = n, this._endTime > n ? this._rotation += o * a.smoothStep(0, 1, (this._endTime - n) / this._fadeEnd) : n - this._startTime < this._fadeStart ? this._rotation += o * a.smoothStep(0, 1, (n - this._startTime) / this._fadeStart) : this._rotation += o;
                var s = t.getMatrix();
                a.mat4.fromZRotation(s, -this._rotation * this._speed);
                var u = t.getChildren();
                if (u.length > 0) {
                    if (!this._fixedCenter) {
                        var l = u[0].getMinimumBound();
                        l.valid() && (this._fixedCenter = a.vec3.create(), a.vec3.copy(this._fixedCenter, l.center()))
                    }
                    var c = this._fixedCenter || u[0].getMinimumBound().center();
                    a.vec3.negate(c, c), a.mat4.fromTranslation(e, c), a.mat4.multiply(s, s, e), a.vec3.negate(c, c), a.mat4.fromTranslation(e, c), a.mat4.multiply(s, e, s)
                }
                return t.dirtyBound(), !0
            }
        }()
    }, "osgSketchfab", "UpdateCallbackAutospin"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(90),
        r = i(1314),
        a = i(1315),
        o = {
            FeatureName: "orientation",
            ModelType: r.a,
            ViewListType: [a.a]
        },
        s = n.a.create(o);
    s.prototype.getNode = function () {
        return this._views[0].getNodeOrientation()
    }, s.prototype.getWidgetNode = function () {
        return this._views[0].getNodeGrid()
    }, t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(149),
        r = i(9),
        a = i(20),
        o = r.a.osg,
        s = n.a.extend({
            getModelOptionPath: function () {
                return "orientation"
            },
            defaults: {
                showGizmo: !1
            },
            getName: function () {
                return "Orientation"
            },
            init: function (e) {
                this.setJSON(e.getModel().get("options").orientation);
                var t = Object(a.a)().scale,
                    i = this.get("matrix");
                1 !== t && o.mat4.scale(i, i, o.vec3.fromValues(t, t, t))
            },
            editorGetJSON: function () {
                return this.getJSON()
            },
            editorSetJSON: function (e) {
                return this.setJSON(e, {
                    validate: !0
                })
            }
        });
    t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(8),
        a = i(1316),
        o = i(1317),
        s = n.a.osg,
        u = n.a.osgUtil,
        l = r.a.extend({
            initialize: function () {
                r.a.prototype.initialize.apply(this, arguments);
                var e = this.model;
                e.bind("change:matrix", this.onMatrixChanged, this), e.bind("change:showGizmo", this.onGizmoShowChanged, this), e.bind("turn", this.onTurn, this), e.bind("reset", this.onReset, this);
                var t = this.options.context;
                this._viewer = t.getViewer(), this._nodeGrid = new o.a, this._nodeGrid.setName("Node grid"), this._nodeOrientation = new s.MatrixTransform, this._nodeOrientation.setName("Feature - Orientation"), this._nodeOrientation.addChild(this._nodeGrid), this._nodeGizmo = new s.MatrixTransform, this._nodeGizmo.setCullingActive(!1), this._nodeGizmo.editMask = u.NodeGizmo.PICK_ARC | u.NodeGizmo.PICK_ARROW_Z, this._gizmoTra = new s.MatrixTransform, this._gizmoTra.setReferenceFrame(s.Transform.ABSOLUTE_RF), this._gizmoTra.addChild(this._nodeGizmo);
                var i = this.model.get("matrix");
                this._nodeOrientation.setMatrix(i);
                var n = s.mat4.getRotation(s.quat.create(), i);
                s.mat4.fromQuat(this._nodeGizmo.getMatrix(), n);
                var l = this._viewer.getRootModel(),
                    c = this._viewer.getViewerOSGJS().getManipulator();
                this._callbackOrientation = new a.a(c, .5, this, l), this._nodeOrientation.addUpdateCallback(this._callbackOrientation)
            },
            onReset: function () {
                var e = s.mat4.getTranslation(s.vec3.create(), this.model.get("matrix"));
                s.mat4.fromTranslation(this.model.get("matrix"), e), this.onMatrixChanged()
            },
            onTurn: function (e, t) {
                var i = "right" === t ? 1 : -1,
                    n = "x" === e ? i : 0,
                    r = "y" === e ? i : 0,
                    a = "z" === e ? i : 0,
                    o = s.mat4.fromRotation(s.mat4.create(), -Math.PI / 2, s.vec3.fromValues(n, r, a)),
                    u = this.model.get("matrix");
                s.mat4.multiply(u, o, u), this.onMatrixChanged()
            },
            onGizmoShowChanged: function () {
                var e = this.model.get("showGizmo"),
                    t = this._viewer.getFeaturesManager();
                if (t) {
                    var i = t.getNodeGizmo();
                    if (i) {
                        var n = this._nodeGizmo.getMatrix(),
                            r = n[14];
                        s.mat4.copy(n, this.model.get("matrix")), n[12] = 0, n[13] = 0, n[14] = r, i.setForcePicking(e), i.setRotateInLocal(!e), i.setTranslateInLocal(!e), i.attachToNode(e ? this._nodeGizmo : null), this._nodeGrid.showGridTemporary(e ? 0 : 2.5), this._callbackOrientation.setGizmoMode(e)
                    }
                }
            },
            onMatrixChanged: function () {
                this.model.get("showGizmo") || this._nodeGrid.showGridTemporary(2.5), this._callbackOrientation.setQuatTarget(s.mat4.getRotation(s.quat.create(), this.model.get("matrix")))
            },
            getNodeGrid: function () {
                return this._nodeGrid
            },
            getNodeOrientation: function () {
                return this._nodeOrientation
            }
        });
    t.a = l
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(708),
        a = i(44),
        o = i(103),
        s = n.a.osg,
        u = function (e, t, i, n) {
            this._model = i.model, this._manipulator = e, this._applyWithoutTranslation = !1, this._quatCurrent = s.mat4.getRotation(s.quat.create(), this._model.get("matrix")), this._quatTarget = s.quat.create(), this._quatStart = s.quat.create(), this._nodeGrid = i._nodeGrid, r.a.call(this, t), this._finished = !0, this._nodeGizmo = i._nodeGizmo, this._gizmoTra = i._gizmoTra, this._gizmoMode = !1, this._rootModel = n, this._nodeOrientation = i._nodeOrientation, this._features = i.options.context.getFeatures(), this._scaleModel = s.vec3.create(), this._worldCenter = s.vec3.create(), this._negateLocalCenter = s.vec3.create(), o.a.getBoxReady().then(this.initModelBound.bind(this))
        };
    s.createPrototypeObject(u, s.objectInherit(r.a.prototype, {
        setQuatTarget: function (e) {
            s.quat.copy(this._quatStart, this._quatCurrent), s.quat.copy(this._quatTarget, e), this.reset(), this._gizmoMode = !1
        },
        initModelBound: function () {
            var e = o.a.getModelBoxWithoutDisplacement();
            e.center(this._worldCenter);
            var t = this._rootModel.getMinimumBound();
            s.vec3.negate(this._negateLocalCenter, t.center());
            var i = e.radius();
            s.vec3.set(this._scaleModel, i, i, i), this._nodeGizmo.getMatrix()[14] -= .51 * (e.getMax()[2] - e.getMin()[2])
        },
        setGizmoMode: function (e) {
            this._gizmoMode = e, this.rotateNode(this._nodeOrientation)
        },
        getQuatTarget: function () {
            return this._quatTarget
        },
        getQuatStart: function () {
            return this._quatStart
        },
        update: function (e, t) {
            if (this._gizmoMode) return s.mat4.getRotation(this._quatCurrent, this._nodeGizmo.getMatrix()), this.rotateNode(e), !0;
            if (this._finished) return !0;
            a.a.draw();
            var i = t.getFrameStamp().getSimulationTime(),
                n = this.interpolate(i, e, t);
            if (n = s.smoothStep(0, 1, n), s.quat.slerp(this._quatCurrent, this._quatStart, this._quatTarget, n), this.rotateNode(e), this._finished) {
                var r = this._nodeGizmo.getMatrix(),
                    o = r[14];
                s.mat4.fromQuat(r, this._quatCurrent), r[14] = o, this._gizmoMode = this._model.get("showGizmo")
            }
            return !0
        },
        rotateNode: function () {
            var e = s.mat4.create();
            return function (t) {
                var i = this._gizmoTra.getMatrix();
                s.mat4.fromTranslation(i, this._worldCenter);
                var n = t.getMatrix();
                s.mat4.fromQuat(n, this._quatCurrent), s.mat4.mul(n, i, n), s.mat4.translate(n, n, this._negateLocalCenter);
                var r = this._nodeGrid.getMatrix();
                s.mat4.scale(r, i, this._scaleModel), r[14] += this._nodeGizmo.getMatrix()[14], s.mat4.invert(e, n), s.mat4.mul(r, e, r), this.updateShadows(), t.dirtyBound()
            }
        }(),
        updateShadows: function () {
            var e = this._features.environment;
            e && e.getNode().updateShadow();
            var t = this._features.lighting;
            if (t)
                for (var i = t.getModel().get("lights"), n = 0, r = i.length; n < r; ++n) i[n].dirty()
        }
    })), t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(923),
        a = i(120),
        o = i(69),
        s = i(85),
        u = i(88),
        l = i(1318),
        c = i.n(l),
        h = i(1319),
        d = i.n(h),
        f = i(1320),
        p = i.n(f),
        m = i(1321),
        g = i.n(m),
        v = n.a.osg,
        _ = function () {
            v.MatrixTransform.call(this), this._timeGrid = 0;
            var e = v.Uniform.createFloat4(v.vec4.fromValues(.5, .5, .5, 0), "uColor");
            this._callbackColor = new r.a(e.getInternalArray(), 1), this._callbackColor.setFinishCallback(this._disableGrid.bind(this)), this.addUpdateCallback(this._callbackColor);
            var t = this.getOrCreateStateSet();
            t.setAttributeAndModes(u.a.DEPTH_LEQUAL_WRITE), t.setAttributeAndModes(u.a.BLEND_SUBSTRACTIVE), t.setRenderBinDetails(s.a.GRID, "RenderBin"), t.addUniform(e), this._grid = v.createGridGeometry(-1, -1, 0, 2, 0, 0, 0, 2, 0, 10, 10), this._axis = v.createAxisGeometry(1), this.addChild(this._grid), this.addChild(this._axis), this._grid.getOrCreateStateSet().setAttributeAndModes(a.a.createShader(c.a, d.a, "orientation-grid", "Grid")), this._axis.getOrCreateStateSet().setAttributeAndModes(a.a.createShader(p.a, g.a, "orientation-axis", "OrientationAxis")), this._disableGrid()
        };
    v.createPrototypeNode(_, v.objectInherit(v.MatrixTransform.prototype, {
        showGridTemporary: function (e) {
            this._grid.dirtyBound(), this._axis.dirtyBound(), this.setNodeMask(o.a.NO_PICK_NO_SHADOW), this._callbackColor.show(), window.clearTimeout(this._timeGrid), e && (this._timeGrid = window.setTimeout(this.hideGrid.bind(this), 1e3 * e))
        },
        _invalidateNodeBound: function (e) {
            e.dirtyBound(), e.getBoundingBox().init(), e.getBoundingSphere().init()
        },
        _disableGrid: function () {
            this.setNodeMask(0), this._invalidateNodeBound(this._grid), this._invalidateNodeBound(this._axis), this._invalidateNodeBound(this)
        },
        hideGrid: function () {
            this._timeGrid = 0, this._callbackColor.hide()
        }
    }), "osgSketchfab", "Grid"), t.a = _
}, function (e, t) {
    e.exports = "attribute vec3 Vertex;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex, 1.0);\n}\n"
}, function (e, t) {
    e.exports = "uniform vec4 uColor;\n\nvoid main(void) {\n  gl_FragColor = vec4(uColor.xyz * uColor.a, uColor.a);\n}\n"
}, function (e, t) {
    e.exports = "attribute vec3 Vertex;\nattribute vec4 Color;\nvarying vec4 vColor;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n    vColor = Color;\n    gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex, 1.0);\n}\n"
}, function (e, t) {
    e.exports = "uniform vec4 uColor;\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vec4( vec3(vColor) * uColor.a, uColor.a);\n}\n"
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(90)),
        a = i(1323),
        o = i(1325),
        s = {
            FeatureName: "environment",
            ModelType: a.a,
            ViewListType: [o.a]
        },
        u = r.a.create(s);
    u.prototype = Object(n.extend)({}, r.a.prototype, {
        getNode: function () {
            return this._views[0].getNodeEnvironment()
        },
        getRotating: function () {
            return this._views[0].getRotating()
        }
    }), t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(47),
        r = i(149),
        a = i(101),
        o = i(1324),
        s = i(77),
        u = i(988),
        l = i(9),
        c = l.a.osg,
        h = {
            uid: "2fa15e0b1cee45a5b02605a288934e1b",
            brightness: 4.063
        },
        d = r.a.extend({
            _trashbin: [],
            getModelOptionPath: function () {
                return "environment"
            },
            getRandomEnvironment: function () {
                var e = [];
                return this.environmentCollection.each(function (t) {
                    t.get("isDefault") && -1 === u.a.indexOf(t.get("uid")) && e.push({
                        uid: t.get("uid"),
                        brightness: t.get("brightness")
                    })
                }), 0 === e.length ? h : e[Math.round(Math.random() * (e.length - 1))]
            },
            resetToDefaultEnvironment: function () {
                var e = this.getRandomEnvironment();
                return this.set("uid", e.uid), this.set("exposure", e.brightness), this
            },
            defaults: function () {
                return {}
            },
            initDefaults: function (e) {
                e.enable = Object(a.a)(), e.uid = h.uid, e.exposure = h.brightness, e.shadowEnable = Object(a.a)(), r.a.prototype.initDefaults.call(this, e)
            },
            init: function (e) {
                this._context = e, this._viewer = e.getViewer();
                var t = e.getModel().get("options"),
                    i = t.environment,
                    r = void 0 === i.uid;
                i && this.setJSON(i), this.environmentCollection = s.default.instance.getEnvironmentCollection(), r && this.resetToDefaultEnvironment(), this.checkEnvironmentValidity(), Object(a.a)() ? n.a.getPolygon().then(this.updateEnvironmentConfig.bind(this)) : n.a.getPolygon().then(function () {
                    var e = this.getEnvironment();
                    if (!e) return void this.checkEnvironmentValidity();
                    var t = this._getYRotationFromLightDirection(e);
                    this.set("lightRotation", t)
                }.bind(this))
            },
            _getYRotationFromLightDirection: function (e) {
                var t = e.get("lights"),
                    i = 0;
                if (t.length) {
                    var n = c.vec3.clone(t[0].direction);
                    if (Math.abs(n[1]) < .99999) {
                        n[1] = 0, c.vec3.normalize(n, n);
                        var r = Math.acos(n[0]);
                        i = n[2] > 0 ? r : 2 * Math.PI - r
                    }
                }
                return i
            },
            updateEnvironmentConfig: function () {
                var e = this.getEnvironment();
                if (!e) return void this.checkEnvironmentValidity();
                var t = this.get("rotation"),
                    i = this.get("lightRotation"),
                    n = this._getYRotationFromLightDirection(e);
                this.set("lightRotation", n);
                var r = 0;
                void 0 !== i && (r = i - n);
                var s = 2 * Math.PI,
                    u = (s + t + r) % s,
                    l = Object(o.a)(this._viewer.getRootUserData().source)[e.get("uid")];
                l ? (void 0 !== l.environmentExposure && this.set("exposure", parseFloat(l.environmentExposure)), void 0 !== l.lightIntensity && this.set("lightIntensity", parseFloat(l.lightIntensity)), void 0 !== l.brightness && this.set("backgroundExposure", parseFloat(l.brightness)), void 0 !== l.rotation && (u = parseFloat(l.rotation))) : this.set("exposure", parseFloat(e.get("brightness")) || 1), this.set("rotation", u);
                var c = this._viewer.getRootUserData();
                Object(a.a)() && "Tilt Brush" === c.authoringTool && (this.set("uid", "3e2ad3e1f1ea47679f045a7eb0e6af49"), this.set("exposure", .5))
            },
            getEnvironmentCollection: function () {
                return this.environmentCollection
            },
            checkEnvironmentValidity: function () {
                this.getEnvironment() || (this.set("uid", h.uid), this.set("exposure", h.brightness))
            },
            getName: function () {
                return "Environment"
            },
            getEnvironment: function () {
                var e = this.get("uid");
                return this.environmentCollection.find(function (t) {
                    return t.get("uid") === e
                })
            },
            isShadowEnable: function () {
                return this.get("shadowEnable")
            },
            editorGetJSON: function () {
                return this.getJSON()
            },
            editorSetJSON: function (e) {
                return this.setJSON(e, {
                    validate: !0
                })
            }
        });
    t.a = d
}, function (e, t, i) {
    "use strict";
    var n = {
            "80fba9759ab94307a782f38d359b8ea8": {
                rotation: 1.57,
                environmentExposure: 8.5,
                lightIntensity: 1.5,
                brightness: 1
            },
            "2e9c3708feb74137b0436f946b8b66b8": {
                rotation: 1.6,
                environmentExposure: 2.5,
                lightIntensity: 2,
                brightness: 1.12
            },
            "268447ca0a954f44b06d1387863d114e": {
                rotation: 6.25,
                environmentExposure: 1.2,
                lightIntensity: 2.5,
                brightness: 1
            },
            "3e2ad3e1f1ea47679f045a7eb0e6af49": {
                rotation: .3,
                environmentExposure: .59,
                lightIntensity: 2.5,
                brightness: 1
            },
            "2fa15e0b1cee45a5b02605a288934e1b ": {
                rotation: .68,
                environmentExposure: 2.5,
                lightIntensity: 2.5,
                brightness: 1
            },
            "9190e8da70694ef3b9d1d0c01541917e": {
                rotation: 3.24,
                environmentExposure: 1.7,
                lightIntensity: 2.5,
                brightness: .57
            },
            "749a0594343e4ff9a2875cb411d0ad1a": {
                rotation: 4.73,
                environmentExposure: .35,
                lightIntensity: 3,
                brightness: 1
            },
            f2dabeb04674446696486eea67028bd8: {
                rotation: 4.71,
                environmentExposure: .35,
                lightIntensity: 3,
                brightness: 1.5
            },
            df380da788ee444885722735039b0c09: {
                rotation: .27,
                environmentExposure: .55,
                lightIntensity: 3,
                brightness: 1.46
            },
            "16cdcddf277d423d99094f8db0c731e9": {
                rotation: 3.73,
                environmentExposure: 1.5,
                lightIntensity: 2.2,
                brightness: .53
            },
            c281dff366844cbc8b33179337037f42: {
                rotation: 3.64,
                environmentExposure: 4.5,
                lightIntensity: 3,
                brightness: .53
            }
        },
        r = {
            substancepainter: n
        },
        a = {};
    a = {
        e871dd2920334a0f9c3107a00da3c24a: {
            uid: "e871dd2920334a0f9c3107a00da3c24a",
            name: "Gareoult",
            environmentExposure: .7,
            lightIntensity: 3
        },
        "102d22e28ca34190a8470402ccdc35d3": {
            uid: "102d22e28ca34190a8470402ccdc35d3",
            name: "Milkyway",
            environmentExposure: 6.8,
            lightIntensity: 3
        },
        cd5e5b1607d844cdb928e96ff9c36b5c: {
            uid: "cd5e5b1607d844cdb928e96ff9c36b5c",
            name: "QueenMary chimney",
            environmentExposure: 7,
            lightIntensity: 3
        },
        "8653449395004fd58820874bfff93ce7": {
            uid: "8653449395004fd58820874bfff93ce7",
            name: "Kirby_cove",
            environmentExposure: .6,
            lightIntensity: 4
        },
        "3e2ad3e1f1ea47679f045a7eb0e6af49": {
            uid: "3e2ad3e1f1ea47679f045a7eb0e6af49",
            name: "Gdansk shipyard buildings",
            environmentExposure: .4,
            lightIntensity: 3
        },
        d348dfd2a8104ab0b8528f885d645eb3: {
            uid: "d348dfd2a8104ab0b8528f885d645eb3",
            name: "footprint",
            environmentExposure: 1.2,
            lightIntensity: 5
        },
        "2fa15e0b1cee45a5b02605a288934e1b": {
            uid: "2fa15e0b1cee45a5b02605a288934e1b",
            name: "glazed patio by restaurant",
            environmentExposure: 2.7,
            lightIntensity: 3
        },
        "5335c7c5c2434866ac8a442157f24f5e": {
            uid: "5335c7c5c2434866ac8a442157f24f5e",
            name: "tropical ruins",
            environmentExposure: 2,
            lightIntensity: 3
        },
        "9190e8da70694ef3b9d1d0c01541917e": {
            uid: "9190e8da70694ef3b9d1d0c01541917e",
            name: "industrial room",
            environmentExposure: 1,
            lightIntensity: 3
        },
        df380da788ee444885722735039b0c09: {
            uid: "df380da788ee444885722735039b0c09",
            name: "studio",
            environmentExposure: .8,
            lightIntensity: 3
        },
        "4eda3e78ed214dc8852c439dc64b9c9d": {
            uid: "4eda3e78ed214dc8852c439dc64b9c9d",
            name: "road in dordogne",
            environmentExposure: .6,
            lightIntensity: 2.5
        },
        "749a0594343e4ff9a2875cb411d0ad1a": {
            uid: "749a0594343e4ff9a2875cb411d0ad1a",
            name: "road in tenerife mountain",
            environmentExposure: .7,
            lightIntensity: 3.5
        },
        c281dff366844cbc8b33179337037f42: {
            uid: "c281dff366844cbc8b33179337037f42",
            name: "urban exploring interior",
            environmentExposure: 12,
            lightIntensity: 3.3
        },
        "41192cc664484a0fa565da3361d10c9c": {
            uid: "41192cc664484a0fa565da3361d10c9c",
            name: "muir wood",
            environmentExposure: .9,
            lightIntensity: 3
        },
        "5e7120378b00431ea18151e97a8366ec": {
            uid: "5e7120378b00431ea18151e97a8366ec",
            name: "treasure island",
            environmentExposure: .55,
            lightIntensity: 3.5
        },
        e00dc642058b4176a4aaa449ea8ad5f8: {
            uid: "e00dc642058b4176a4aaa449ea8ad5f8",
            name: "trinitatis church",
            environmentExposure: .6,
            lightIntensity: 4
        },
        e2aa1ab3582c4feab7371baf1e4cd734: {
            uid: "e2aa1ab3582c4feab7371baf1e4cd734",
            name: "arche pinetree",
            environmentExposure: 2.3,
            lightIntensity: 3.5
        },
        "2a016b232e444ef3a6ba323c51aa5063": {
            uid: "2a016b232e444ef3a6ba323c51aa5063",
            name: "tokyo bigsight",
            environmentExposure: 2.3,
            lightIntensity: 3.5
        }
    };
    var o = function (e) {
        return r[e] || a
    };
    t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(38)),
        a = i.n(r),
        o = i(5),
        s = i.n(o),
        u = i(9),
        l = i(86),
        c = i(8),
        h = i(47),
        d = i(1326),
        f = i(77),
        p = i(599),
        m = i(119),
        g = i(20),
        v = i(44),
        _ = i(199),
        b = u.a.osg,
        S = u.a.InputGroups,
        x = c.a.extend({
            initialize: function () {
                c.a.prototype.initialize.apply(this, arguments), this._viewer = this.options.context.getViewer(), this._inputManager = this._viewer.getInputManager(), this._nodeEnvironment = new d.a(this._viewer), this._nodeEnvironment.setName("Feature - Environment"), this._backgroundLoaded = {}, this.model.bind("change:enable", this.onEnableChanged, this), this.model.bind("change:exposure", this.onExposureChanged, this), this.model.bind("change:backgroundExposure", this.onExposureChanged, this), this.model.bind("change:rotation", this.onRotationChanged, this), this.model.bind("change:uid", this.onUIDChanged, this), this.model.bind("updateBackground", this.onBackgroundEnableChanged, this), this.model.bind("change:blur", this.onBlurChanged, this), m.a.bind("change:mask", this.onEnvironmentChanged, this), this.model.bind("change", v.a.draw), this._resourceDefer = new l.a, this.options.context.getScene().addResourcePromise(this._resourceDefer), this.model.bind("change:shadowEnable", this.onShadowEnable, this), this.model.bind("change:shadowBias", this.onShadowBiasChanged, this), this.model.bind("change:lightIntensity", this.onLightIntensityChanged, this), h.a.getMaterial().then(function () {
                    this.initEnvironment(), this.initRotateEnvironment()
                }.bind(this))
            },
            getBackgroundEnableType: function () {
                var e = this._viewer.getFeatures().background;
                return e ? e.getModel().getEnableType() : "none"
            },
            isBackgroundEnvironment: function () {
                return "environment" === this.getBackgroundEnableType()
            },
            initEnvironment: function () {
                this.onRotationChanged(), this.onExposureChanged(), this.onEnableChanged(), this.model.get("enable") || h.a.resolveDataSizeEnvironment(0)
            },
            initRotateEnvironment: function () {
                this._viewer.getViewerOSGJS() && (this._rotEnv = !1, this.mx_ = 0, _.a.initEnvironment(this))
            },
            startRotate: function (e) {
                this._rotEnv = !0, this.mx_ = e.canvasX, this._inputManager.setEnable(S.MANIPULATORS, !1)
            },
            _computeDelta: function (e) {
                v.a.draw();
                var t = (e.canvasX - this.mx_) / 100;
                return this.mx_ = e.canvasX, t
            },
            rotateEnv: function (e, t) {
                if (this._rotEnv) {
                    t || (t = this._computeDelta(e));
                    var i = (this.model.get("rotation") + t) % (2 * Math.PI);
                    this.model.set("rotation", i < 0 ? i + 2 * Math.PI : i)
                }
            },
            rotateLight: function () {
                var e = b.mat4.create(),
                    t = b.mat4.create();
                return function (i, n) {
                    if (this._rotEnv) {
                        n || (n = this._computeDelta(i));
                        var r = this.options.context,
                            a = r.getFeatures().lighting;
                        if (a) {
                            var o = this._viewer.getFeaturesManager().getWorldNode(),
                                s = o.getMinimumBound().center();
                            b.mat4.fromZRotation(e, -n % (2 * Math.PI)), b.vec3.negate(s, s), b.mat4.multiply(e, e, b.mat4.fromTranslation(t, s)), b.vec3.negate(s, s), b.mat4.multiply(e, b.mat4.fromTranslation(t, s), e);
                            for (var u = a.getModel().get("lights"), l = 0, c = u.length; l < c; ++l) {
                                var h = u[l];
                                if (!h.isAttachedToCamera()) {
                                    var d = h.get("matrix");
                                    b.mat4.multiply(d, e, d), h.dirty()
                                }
                            }
                        }
                    }
                }
            }(),
            rotateEnvAndLight: function (e) {
                if (this._rotEnv) {
                    var t = this._computeDelta(e);
                    this.rotateEnv(e, t), this.rotateLight(e, t)
                }
            },
            endRotate: function () {
                this._rotEnv && (this._rotEnv = !1, this._inputManager.setEnable(S.MANIPULATORS, !0))
            },
            onUIDChanged: function () {
                this.model.updateEnvironmentConfig(), this.onEnvironmentChanged(), this.onBackgroundEnableChanged()
            },
            getRotating: function () {
                return this._rotEnv
            },
            getNodeEnvironment: function () {
                return this._nodeEnvironment
            },
            getResourceManager: function () {
                return this._resourceManager || f.default.instance
            },
            onEnableChanged: function () {
                this.model.get("enable") ? (this._nodeEnvironment.enable(), this._nodeEnvironment.setLightShadowEnabled(this.model.get("shadowEnable")), this._nodeEnvironment.setLightIntensity(this.model.get("lightIntensity")), this._nodeEnvironment.setShadowBias(this.model.get("shadowBias"))) : (this._nodeEnvironment.disable(), this._nodeEnvironment.setLightShadowEnabled(!1)), this.onEnvironmentChanged()
            },
            onShadowEnable: function () {
                var e = this.getEnvironment().get("lights");
                if (this.model.get("shadowEnable") && (!e || 0 === e.length)) return void this.model.set("shadowEnable", !1);
                this._nodeEnvironment.setLightShadowEnabled(this.model.get("shadowEnable"))
            },
            onShadowBiasChanged: function () {
                this._nodeEnvironment.setShadowBias(this.model.get("shadowBias"))
            },
            onLightIntensityChanged: function () {
                this._nodeEnvironment.setLightIntensity(this.model.get("lightIntensity"))
            },
            onExposureChanged: function () {
                this._nodeEnvironment.setExposure(this.model.get("exposure")), this._nodeEnvironment.setBackgroundExposure(this.model.get("backgroundExposure"))
            },
            onRotationChanged: function () {
                this._nodeEnvironment.updateRotation(this.model.get("rotation"))
            },
            onBlurChanged: function () {
                this.abortLastDownloadEnv(), this.isBackgroundEnvironment() && this.setBackgroundTexture()
            },
            onBackgroundEnableChanged: function () {
                var e = this.getBackgroundEnableType();
                "environment" === e ? this.setBackgroundTexture() : "ambient" === e && this.setBackgroundAmbient()
            },
            resolvePreload: function () {
                this._resourceDefer && (this._resourceDefer.resolve(), this._resourceDefer = void 0)
            },
            onEnvironmentChanged: function () {
                var e = this.getEnvironment();
                if (!e || !this.model.get("enable")) return void this.resolvePreload();
                this._onlyLowRes = !0, this.setEnvironment(e).then(function () {
                    var t = e.get("uid") === this.model.get("uid");
                    Object(g.a)().preload && t || this.resolvePreload(), t && (this._onlyLowRes = !1, this.setEnvironment(e).finally(this.resolvePreload.bind(this)))
                }.bind(this))
            },
            getEnvironment: function () {
                return this.model.getEnvironment()
            },
            getName: function () {
                return "Environment3D"
            },
            abortLastDownloadEnv: function () {
                for (var e = this.model.get("uid"), t = this.model.get("blur"), i = this.getResourceManager()._resourceLoader._processing, n = 0, r = i.length; n < r; ++n) {
                    var a = i[n],
                        o = a.getXHR();
                    o && (void 0 !== a._envUID && a._envUID !== e && o.abort(), void 0 !== a._envBlur && a._envBlur !== t && o.abort())
                }
            },
            setEnvironment: function (e) {
                this.abortLastDownloadEnv();
                var t = [];
                if (m.a.get("mask") & m.a.LIT) {
                    var i = m.a.get("mask") & m.a.PBR;
                    this._nodeEnvironment.setIsPBR(i), this._nodeEnvironment.setDiffuseSPH(e.get("diffuseSPH"));
                    var r = e.get("lights") || [];
                    this._nodeEnvironment.setLightProbes(r, e.id), this.model.get("shadowEnable") && this.model.set("shadowEnable", r.length > 0), this._nodeEnvironment.setDefaultExposure(e.get("brightness")), i ? this.setEnvironmentPBR(e, t) : this.setEnvironmentOld(e, t), this.setProgress(t.slice(), "environment")
                }
                return this.isBackgroundEnvironment() && t.push(this.setBackgroundTexture()), 0 === t.length ? s.a.resolve() : s.a.all(Object(n.map)(t, function (e) {
                    return e.reflect()
                }))
            },
            setEnvironmentPBR: function (e, t) {
                var i = this._nodeEnvironment,
                    r = e.get("textures"),
                    o = !1;
                b.WebGLCaps.instance().getWebGLExtension("EXT_shader_texture_lod") && (o = !0), Object(g.a)().panorama && (o = !1);
                var s = Object(n.find)(r, {
                        encoding: "luv",
                        type: "specular_ue4",
                        format: o ? "cubemap" : "panorama"
                    }),
                    u = this.getImageRes(s),
                    l = {
                        cubemap: o,
                        panoramaLUV: !o,
                        cubemapLUV: o,
                        size: u.width,
                        minFilter: o ? b.Texture.LINEAR_MIPMAP_LINEAR : b.Texture.LINEAR,
                        magFilter: b.Texture.LINEAR,
                        wrapS: b.Texture.CLAMP_TO_EDGE,
                        wrapT: b.Texture.CLAMP_TO_EDGE,
                        transferToGPU: !0,
                        internalFormat: b.Texture.RGBA
                    },
                    c = this.getResourceManager().getOrCreateTexture(u.file, l);
                this.markLastXHR(this.model.get("uid")), c.texture.setFlipY(!o), this._onlyLowRes && i.setSpecularPBRTexture(c.texture, s.limitSize);
                var d = this.getPromiseTexture(c);
                d.then(i.setSpecularPBRTexture.bind(i, c.texture, s.limitSize)), t.push(d);
                var f = u.sizeCompressed;
                if (!a.a.any) {
                    var p = Object(n.find)(r, {
                        type: "brdf_ue4"
                    });
                    l = {
                        integrateBRDFLUV: !0,
                        minFilter: b.Texture.NEAREST,
                        magFilter: b.Texture.NEAREST,
                        wrapS: b.Texture.CLAMP_TO_EDGE,
                        wrapT: b.Texture.CLAMP_TO_EDGE,
                        transferToGPU: !0,
                        internalFormat: b.Texture.RGBA
                    }, u = this.getImageRes(p), f += u.sizeCompressed;
                    var m = this.getResourceManager().getOrCreateTexture(u.file, l);
                    this.markLastXHR(this.model.get("uid")), m.texture.setFlipY(!1), i.setIntegrateBRDFTexture(m.texture);
                    var v = this.getPromiseTexture(m);
                    v.then(i.setIntegrateBRDFTexture.bind(i, m.texture)), t.push(v)
                }
                h.a.resolveDataSizeEnvironment(f)
            },
            getBackgroundResource: function (e, t, i) {
                var r, a = Object(n.find)(e, {
                    encoding: "luv",
                    type: "background",
                    format: "cubemap"
                });
                return r = void 0 !== i ? this.getClosestBlur(a, i) : this.getImageRes(a, 512), t.cubemap = !0, t.cubemapLUV = !0, t.size = r.width, t.minFilter = b.Texture.LINEAR, t.magFilter = b.Texture.LINEAR, t.wrapS = b.Texture.CLAMP_TO_EDGE, t.wrapT = b.Texture.CLAMP_TO_EDGE, t.transferToGPU = !0, t.internalFormat = b.Texture.RGBA, r
            },
            setEnvironmentOld: function (e, t) {
                var i = this._nodeEnvironment,
                    n = {},
                    r = this.getBackgroundResource(e.get("textures"), n),
                    a = this.getResourceManager().getOrCreateTexture(r.file, n);
                this.markLastXHR(this.model.get("uid")), this._onlyLowRes && i.setSpecularTexture(a.texture);
                var o = this.getPromiseTexture(a);
                o.then(i.setSpecularTexture.bind(i, a.texture)), h.a.resolveDataSizeEnvironment(r.sizeCompressed), t.push(o)
            },
            setBackgroundTexture: function () {
                var e = this.getEnvironment();
                if (!e) return s.a.reject(new Error);
                var t = {},
                    i = this.getBackgroundResource(e.get("textures"), t, this.model.get("blur")),
                    n = this._backgroundLoaded;
                if (this.getRequestLowRes()) {
                    if (n[i.file]) return n[i.file].promise;
                    i = this.getBackgroundResource(e.get("textures"), t, 1)
                }
                var r = this._nodeEnvironment,
                    a = this.getResourceManager().getOrCreateTexture(i.file, t);
                this.markLastXHR(this.model.get("uid"), this.model.get("blur"));
                var o = this.getPromiseTexture(a);
                return o.then(function () {
                    r.setBackgroundTexture(a.texture, i.width), n[i.file] = a
                }), this.setProgress(o, "background"), o
            },
            setProgress: function (e, t) {
                var i = this._viewer.setFakeSecondaryProgress.bind(this._viewer, e, t);
                h.a.getHighResLoaded().then(i)
            },
            setBackgroundAmbient: function () {
                var e = this.getEnvironment();
                return e ? (this._nodeEnvironment.setDiffuseSPH(e.get("diffuseSPH")), s.a.resolve()) : s.a.reject(new Error)
            },
            markLastXHR: function (e, t) {
                var i = this.getResourceManager()._resourceLoader._processing;
                if (i.length > 0) {
                    var n = i[i.length - 1];
                    n._envUID = e, void 0 === t || this.getRequestLowRes() || (n._envBlur = t)
                }
            },
            getPromiseTexture: function (e) {
                return this._onlyLowRes || Object(g.a)().preload ? e.promise : s.a.all([e.promise, h.a.getFirstCameraAnimation()])
            },
            getRequestLowRes: function () {
                return this._onlyLowRes && !Object(g.a)().preload
            },
            getImageRes: function (e, t) {
                var i = new p.a(e);
                if (this.getRequestLowRes()) return i.findImageSmallest();
                var n = void 0 !== t ? t : 1 / 0;
                return i.findImageNearestPowerOfTwoUpToResolution(n, n)
            },
            getClosestBlur: function (e, t) {
                for (var i = e.images, n = 0, r = 1 / 0, a = 0, o = i.length; a < o; ++a) {
                    var s = Math.abs(i[a].blur - t);
                    s < r && (n = a, r = s)
                }
                return i[n]
            }
        });
    t.a = x
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(20),
        a = i(584),
        o = i(925),
        s = i(711),
        u = i(1327),
        l = i(69),
        c = i(1330),
        h = i(929),
        d = i(582),
        f = i(119),
        p = i(44),
        m = n.a.osg,
        g = function (e) {
            m.Node.call(this), this.getOrCreateStateSet(), this._enable = !0, this._viewer = e, this._isPBR = !1, this._textureSpecular = void 0, this._textureSpecularUnit = 6, this._textureSpecularPBR = void 0, this._textureIntegrateBRDF = void 0, this._textureSpecularPBRUnit = 6, this._textureIntegrateBRDFUnit = 8, this._nodeBackground = new u.a, this._adjustRotation = m.mat4.fromXRotation(m.mat4.create(), Math.PI / 2), this._root = new m.MatrixTransform, m.mat4.multiply(this._root.getMatrix(), this._root.getMatrix(), this._adjustRotation), this._lightProbes = [];
            var t = Object(s.b)("Environment", 3, a.a.DIRECTION);
            this._light = t.light, this._mtLight = t.node, this._shadow = t.shadowMap, this._mtLight.addChild(t.lightSource), this._lightIntensity = 1, this._lightShadowEnabled = !1, this._shadowBias = 5e-4, this._shadowedScene = void 0, this._lightNodeRoot = new m.MatrixTransform, this._lightNodeRoot.setName("Env Lighting - Light"), m.mat4.copy(this._lightNodeRoot.getMatrix(), this._root.getMatrix()), this._lightNodeRoot.addChild(this._mtLight), this.addUpdateCallback(this), f.a.bind("change:mask", this.updateLightShadow, this)
        };
    m.createPrototypeNode(g, m.objectInherit(m.Node.prototype, {
        getBackground: function () {
            return this._nodeBackground
        },
        enable: function () {
            this._enable = !0, this.setTexturesStateSet(), p.a.draw()
        },
        disable: function () {
            this._enable = !1, this.removeTexturesStateSet(), p.a.draw()
        },
        setBackgroundExposure: function (e) {
            this._nodeBackground.setExposure(e), p.a.draw()
        },
        setBackgroundTexture: function (e, t) {
            this._nodeBackground.setEnvironment(e, t), p.a.draw()
        },
        createCameraNode: function () {
            var e = {},
                t = this,
                i = m.mat4.create(),
                n = h.a.environmentTransform.getInternalArray(),
                r = function () {
                    this.cull = function (r, a) {
                        m.mat4.getPerspective(e, t._mainCamera.getProjectionMatrix()), m.mat4.perspective(a.getCurrentProjectionMatrix(), e.fovy * Math.PI / 180, e.aspectRatio, 1, 1e3), m.mat4.copy(a.getCurrentModelViewMatrix(), t._mainCamera.getViewMatrix()), m.mat4.setTranslation(a.getCurrentModelViewMatrix(), m.vec3.ZERO);
                        var o = a.getCurrentModelViewMatrix();
                        return m.mat4.multiply(i, o, t._root.getMatrix()), m.mat3.fromMat4(n, i), m.mat3.transpose(n, n), !0
                    }
                },
                a = new m.Camera;
            return a.setName("Environment - Camera"), a.setCullCallback(new r), a.setReferenceFrame(m.Transform.ABSOLUTE_RF), a
        },
        init: function (e, t) {
            this._mainCamera = e, this._shadowedScene = t, this._shadowedScene.addChild(this._lightNodeRoot);
            for (var i in h.a) this.getStateSet().addUniform(h.a[i]);
            var n = this.createCameraNode();
            n.setNodeMask(l.a.NO_PICK_NO_SHADOW), this.addChild(n), n.addChild(this._root), this._root.addChild(this._nodeBackground), this.updateTextureUnits(), this.updateLightShadow()
        },
        setLightShadowEnabled: function (e) {
            this._lightShadowEnabled = e && Object(r.a)().shadow, this.updateLightShadow()
        },
        setLightIntensity: function (e) {
            this._lightIntensity = e, this.updateLightColorAndIntensity(), p.a.draw()
        },
        setShadowBias: function (e) {
            this._shadowBias = e, this._shadow && (this._shadow.setBias(e), this._shadow.requestRedraw(), p.a.draw())
        },
        setLightProbes: function (e) {
            this._lightProbes = e, this.updateLightShadow()
        },
        removeTexturesStateSet: function () {
            var e = this.getStateSet();
            e && (this._isPBR ? (this._textureSpecularPBR && e.removeTextureAttribute(this._textureSpecularPBRUnit, this._textureSpecularPBR.getTypeMember()), this._textureIntegrateBRDF && e.removeTextureAttribute(this._textureIntegrateBRDFUnit, this._textureIntegrateBRDF.getTypeMember())) : this._textureSpecular && e.removeTextureAttribute(this._textureSpecularUnit, this._textureSpecular.getTypeMember()))
        },
        setTexturesStateSet: function () {
            var e = this.getStateSet();
            e && (this._isPBR ? (this._textureSpecularPBR && e.setTextureAttributeAndModes(this._textureSpecularPBRUnit, this._textureSpecularPBR), this._textureIntegrateBRDF && e.setTextureAttributeAndModes(this._textureIntegrateBRDFUnit, this._textureIntegrateBRDF)) : this._textureSpecular && e.setTextureAttributeAndModes(this._textureSpecularUnit, this._textureSpecular))
        },
        updateLightColorAndIntensity: function () {
            if (this._light && 0 !== this._lightProbes.length) {
                var e = h.a.exposure.getInternalArray()[0] / this._defaultExposure,
                    t = this._lightProbes[0].color;
                m.vec3.normalize(t, t), m.vec3.scale(this._light.getDiffuse(), t, this._lightIntensity * e)
            }
        },
        setDefaultExposure: function (e) {
            this._defaultExposure = e
        },
        setExposure: function (e) {
            h.a.exposure.setFloat(e), this.updateLightColorAndIntensity()
        },
        updateLightFromProbes: function () {
            var e = this._lightProbes[0].direction,
                t = Math.abs(e[2]) > .999 ? m.vec3.fromValues(0, 1, 0) : m.vec3.fromValues(0, 0, 1),
                i = this._mtLight.getMatrix();
            m.mat4.lookAtDirection(i, m.vec3.ZERO, e, t), m.mat4.invert(i, i), this.updateLightColorAndIntensity(), Object(r.a)().debugEnvShadow && this._debugShadow()
        },
        _debugShadow: function () {
            if (!this._debugDone) {
                this._debugDone = !0;
                var e = m.createAxisGeometry(),
                    t = new m.MatrixTransform;
                t.setMatrix(m.mat4.fromScaling(m.mat4.create(), [100, 100, -500])), m.mat4.setTranslation(t.getMatrix(), [0, 0, 500]), t.addChild(e);
                var i = new o.a.createDirectionalGeometry(5);
                t.addChild(i), t.setNodeMask(l.a.NO_PICK_NO_SHADOW), this._mtLight.addChild(t)
            }
        },
        isUsingLightShadow: function () {
            return f.a.get("mask") & f.a.LIT && this._lightShadowEnabled && this._lightProbes.length > 0
        },
        updateLightShadow: function () {
            if (this._shadowedScene) {
                var e = this.isUsingLightShadow();
                if (this._light.setEnabled(e), Object(s.d)(this._shadowedScene, this._shadow), e) {
                    var t = Object(d.a)();
                    (Object(r.a)().shadowAtlas && t > 7 || t > 12) && Object(s.a)(this._shadowedScene, this._shadow), this._shadow.setBias(this._shadowBias), m.mat4.copy(this._lightNodeRoot.getMatrix(), this._root.getMatrix()), this.updateLightFromProbes(), this._shadow.requestRedraw(), p.a.draw()
                }
            }
        },
        update: function (e, t) {
            if (e.getNumChildrenRequiringUpdateTraversal() > 0 && t.traverse(e), !this._light || !this._shadow) return !1;
            var i = this._viewer.getFeaturesManager();
            return i && i.getShadowForcedUpdate() && this._shadow.requestRedraw(), !1
        },
        updateShadow: function () {
            this._light && this._shadow && this._shadow.requestRedraw()
        },
        updateRotation: function (e) {
            m.mat4.fromZRotation(this._root.getMatrix(), -e), m.mat4.multiply(this._root.getMatrix(), this._root.getMatrix(), this._adjustRotation), m.mat4.copy(this._lightNodeRoot.getMatrix(), this._root.getMatrix()), this._shadow && this._shadow.requestRedraw()
        },
        setDiffuseSPH: function (e) {
            for (var t = h.a.diffuseSPH.getInternalArray(), i = 1 / (2 * Math.sqrt(Math.PI)), n = -.5 * Math.sqrt(3 / Math.PI), r = -n, a = n, o = .5 * Math.sqrt(15 / Math.PI), s = -o, u = .25 * Math.sqrt(5 / Math.PI), l = s, c = .25 * Math.sqrt(15 / Math.PI), d = [i, i, i, n, n, n, r, r, r, a, a, a, o, o, o, s, s, s, u, u, u, l, l, l, c, c, c], f = 0; f < 27; ++f) t[f] = e[f] * d[f]
        },
        setSpecularTexture: function (e) {
            this._enable && (this._textureSpecular = new c.a(e, "Specular"), this._textureSpecular.setIsCubemap(!0), this.updateTextureUnits(), h.a.textureSpecular.setInt(this._textureSpecularUnit), p.a.draw())
        },
        setSpecularPBRTexture: function (e, t) {
            if (this._enable) {
                this._textureSpecularPBR = new c.a(e, "SpecularPBR");
                var i = "TextureCubeMap" === e.className();
                this._textureSpecularPBR.setIsCubemap(i), this._textureSpecularPBR.updateLodRange(t), this.updateTextureUnits(), h.a.textureSpecularPBR.setInt(this._textureSpecularPBRUnit), p.a.draw()
            }
        },
        setIntegrateBRDFTexture: function (e) {
            this._enable && (this._textureIntegrateBRDF = new c.a(e, "IntegrateBRDF"), this.updateTextureUnits(), h.a.textureIntegrateBRDF.setInt(this._textureIntegrateBRDFUnit), p.a.draw())
        },
        updateTextureUnits: function () {
            this.setTexturesStateSet()
        },
        setIsPBR: function (e) {
            this._isPBR = e
        }
    }), "osgSketchfab", "Environment"), t.a = g
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(120),
        a = i(916),
        o = i(928),
        s = i(85),
        u = i(44),
        l = i(88),
        c = i(1328),
        h = i.n(c),
        d = i(1329),
        f = i.n(d),
        p = n.a.osg,
        m = function () {
            p.Node.call(this), this._geometry = p.createTexturedBoxGeometry(0, 0, 0, 5, 5, 5), this._show = "NONE", this._bgEnv = null, this._bgFixed = null, this._texRatio = 1, this._canvasWidth = 1, this._canvasHidth = 1, this.init(), this.hide()
        };
    p.createPrototypeNode(m, p.objectInherit(p.Node.prototype, {
        init: function () {
            var e = this._geometry,
                t = e.getOrCreateStateSet();
            t.setAttributeAndModes(l.a.DEPTH_LEQUAL_BACKGROUND_NO_WRITE, p.StateAttribute.PROTECTED), t.setRenderBinDetails(s.a.BACKGROUND, "RenderBin"), t.setAttributeAndModes(r.a.createShader(h.a, f.a, "environment-background", "Environment")), t.setTextureAttributeAndModes(0, a.a.dummyTexture);
            for (var i in o.a) t.addUniform(o.a[i]);
            this.addChild(e)
        },
        rescale: function (e, t) {
            e && (this._canvasWidth = e), t && (this._canvasHeight = t);
            var i = this._canvasWidth / this._canvasHeight,
                n = o.a.scale.getInternalArray();
            i >= this._texRatio ? (n[0] = 1, n[1] = this._texRatio / i) : (n[0] = i / this._texRatio, n[1] = 1)
        },
        getBackground: function () {
            return this._bgFixed
        },
        getEnvironment: function () {
            return this._bgEnv
        },
        hide: function () {
            this._show = "NONE", this._update()
        },
        showColor: function () {
            this._show = "COLOR", this._update()
        },
        showEnvironment: function () {
            this._show = "ENV", this._update()
        },
        setEnvironment: function (e, t) {
            this._bgEnv = e, void 0 !== t && o.a.size.setFloat(t), this._update()
        },
        setExposure: function (e) {
            o.a.backgroundExposure.setFloat(e)
        },
        showAmbient: function () {
            this._show = "AMBIENT", this._update()
        },
        showBackground: function () {
            this._show = "FIXED", this._update()
        },
        setBackground: function (e) {
            this._texRatio = e.getWidth() / e.getHeight(), this._bgFixed = e, this._update()
        },
        _update: function () {
            if (u.a.draw(), "ENV" !== this._show && "AMBIENT" !== this._show) return void this._geometry.setNodeMask(0);
            this._geometry.setNodeMask(-1), o.a.ambient.getInternalArray()[0] = "AMBIENT" === this._show, this._bgEnv && "ENV" === this._show && this._geometry.getOrCreateStateSet().setTextureAttributeAndModes(0, this._bgEnv)
        }
    }), "osgSketchfab", "Background"), t.a = m
}, function (e, t) {
    e.exports = "attribute vec3 Vertex;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nuniform vec4 uHalton;\nuniform vec2 uGlobalTexSize;\nuniform vec2 uGlobalTexRatio;\n\nvarying vec3 vLocalVertex;\n\nvoid main(void)\n{\n    vLocalVertex = Vertex.rgb;\n\n    mat4 projectionMatrix = uProjectionMatrix;\n    vec2 halt = uGlobalTexRatio.xy * uHalton.xy / uGlobalTexSize.xy;\n    projectionMatrix[2][0] += halt.x;\n    projectionMatrix[2][1] += halt.y;\n\n    gl_Position = (projectionMatrix * (uModelViewMatrix * vec4(Vertex, 1.0))).xyww;\n}\n"
}, function (e, t) {
    e.exports = 'varying vec3 vLocalVertex;\n\n// common stuffs\nuniform int uOutputLinear;\nuniform float uRGBMRange;\n\nuniform float uEnvironmentExposure;\nuniform float uBackgroundExposure;\n\nuniform vec3 uDiffuseSPH[9];\nuniform samplerCube uTexture0;\nuniform float uSize;\nuniform int uAmbient;\n\nuniform float uFrameModTaaSS;\n\n#pragma include "utils/functions.glsl"\n#pragma include "utils/cubemap.glsl"\n#pragma include "utils/rand.glsl"\n\n// sph env\nvec3 evaluateDiffuseSphericalHarmonics(const in vec3 s[9], const in vec3 n) {\n    // https://github.com/cedricpinson/envtools/blob/master/Cubemap.cpp#L523\n    vec3 result = (s[0]+s[1]*n.y+s[2]*n.z+s[3]*n.x+s[4]*n.y*n.x+s[5]*n.y*n.z+s[6]*(3.0*n.z*n.z-1.0)+s[7]*(n.z*n.x)+s[8]*(n.x*n.x-n.y*n.y));\n    return max(result, vec3(0.0));\n}\n\nvoid main(void) {\n\n    vec3 color;\n    if (uAmbient == 1) {\n        vec3 normal = normalize(vLocalVertex + mix(-0.5/255.0, 0.5/255.0, pseudoRandom(gl_FragCoord.xy))*2.0);\n        // vec3 normal = normalize(vLocalVertex + (interleavedGradientNoise(gl_FragCoord.xy, uFrameModTaaSS) - 0.5) * 0.4);\n        color = evaluateDiffuseSphericalHarmonics(uDiffuseSPH, normal);\n    } else {\n        color = textureCubeFixed(uTexture0, normalize(vLocalVertex), uSize);\n    }\n\n    color *= uEnvironmentExposure * uBackgroundExposure;\n\n    if (uOutputLinear == 0 ) color = linearTosRGB(color);\n\n    gl_FragColor = encodeRGBM(color, uRGBMRange);\n}\n'
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(929),
        a = n.a.osg,
        o = function (e, t) {
            this._texture = e, this._channel = t || "Specular", this._isCubemap = !1, this._hash = "Specular" === t ? "EnvSpec" : "SpecularPBR" === t ? "EnvSpecPBR" : "EnvBRDF"
        };
    o.uniforms = {}, a.createPrototypeStateAttribute(o, a.objectInherit(a.Texture.prototype, {
        attributeType: "Texture",
        channelType: ["Specular", "SpecularPBR", "IntegrateBRDF"],
        getUniformName: function (e) {
            return "uTextureEnvironment" + this.getChannel() + e
        },
        getOrCreateUniforms: function () {
            var e = o.uniforms,
                t = this.getChannel();
            if (e[t]) return e[t];
            var i = this._texture;
            return e[t] = {
                size: a.Uniform.createFloat2([i.getWidth(), i.getHeight()], this.getUniformName("TextureSize"))
            }, e[t]
        },
        setIsCubemap: function (e) {
            this._isCubemap = e
        },
        getIsCubemap: function () {
            return this._isCubemap
        },
        getUniforms: function () {
            return r.a
        },
        getTexture: function () {
            return this._texture
        },
        getChannel: function () {
            return this._channel
        },
        cloneType: function () {
            return new o(new a.Texture)
        },
        getHash: function () {
            return this._hash
        },
        updateLodRange: function (e) {
            var t = this.getOrCreateUniforms(),
                i = Math.log(this._texture.getWidth()) / Math.LN2,
                n = i - Math.log(e) / Math.LN2;
            if (t.lodRange) {
                var r = t.lodRange.getInternalArray();
                r[0] = i, r[1] = n
            } else t.lodRange = a.Uniform.createFloat2([i, n], this.getUniformName("LodRange"))
        },
        apply: function (e, t) {
            var i = this._texture;
            void 0 !== i && i.apply(e);
            var n = this.getOrCreateUniforms(t),
                r = n.size.getInternalArray();
            r[0] = i.getWidth(), r[1] = i.getHeight()
        }
    }), "osgSketchfab", "TextureEnvironment"), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(90),
        r = i(1332),
        a = i(1333),
        o = {
            FeatureName: "background",
            ModelType: r.a,
            ViewListType: [a.a]
        };
    t.a = n.a.create(o)
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(47),
        a = i(149),
        o = i(20),
        s = i(101),
        u = i(77),
        l = n.a.osg,
        c = a.a.extend({
            _trashbin: [],
            getModelOptionPath: function () {
                return "background"
            },
            defaults: function () {
                return {
                    webVR: !1
                }
            },
            init: function (e) {
                this.backgroundCollection = u.default.instance.getBackgroundCollection(), this._defaultBackground = this.get("uid"), this.set("enable", Object(s.a)() ? "ambient" : "fixed");
                var t = e.getModel().get("options").background;
                t && this.setJSON(t), Object(o.a)().transparent && this.set("enable", "none");
                var i = e.getViewer();
                Object(s.a)() && r.a.getPolygon().then(function () {
                    "Tilt Brush" === i.getRootUserData().authoringTool && (this.set("enable", "color"), this.set("color", l.vec3.create()))
                }.bind(this))
            },
            getName: function () {
                return "Background"
            },
            setBackground: function (e) {
                return this.setBackgroundUID(e.uid)
            },
            setBackgroundUID: function (e) {
                e && this.set("uid", e)
            },
            getBackground: function () {
                if (this.backgroundCollection) {
                    var e = this.get("uid"),
                        t = this.backgroundCollection.find(function (t) {
                            return t.get("uid") === e || t.get("id") === e
                        });
                    if (t) return t;
                    this.set("uid", this._defaultBackground)
                }
            },
            resetToDefaultBackground: function () {
                return this.set("uid", this._defaultBackground), this
            },
            getEnableType: function () {
                var e = this.get("enable");
                return "fixed" !== e && "none" !== e || !this.get("webVR") || Object(o.a)().vrAr ? e : "ambient"
            },
            getColor: function () {
                return this.get("color")
            },
            validate: function (e, t) {
                var i = a.a.prototype.validate.call(this, e, t),
                    n = this.get("uid");
                if (n !== this._defaultBackground) {
                    this.getBackground() || console.warn("Couldn't find background " + n)
                }
                return i
            },
            editorGetJSON: function () {
                return this.getJSON()
            },
            editorSetJSON: function (e) {
                return this.setJSON(e, {
                    validate: !0
                })
            }
        });
    t.a = c
}, function (e, t, i) {
    "use strict";
    var n = i(86),
        r = i(9),
        a = i(47),
        o = i(8),
        s = i(77),
        u = i(632),
        l = i(44),
        c = r.a.osg,
        h = o.a.extend({
            initialize: function () {
                o.a.prototype.initialize.apply(this, arguments), this.model.bind("change:enable", this.onEnableChanged, this), this.model.bind("change:webVR", this.onEnableChanged, this), this.model.bind("change:uid", this.onBackgroundChanged, this), this.model.bind("change", l.a.draw), this._viewer = this.options.context.getViewer();
                var e = this.options.context.getFeatures().environment;
                e && (this._resourceDefer = new n.a, this.options.context.getScene().addResourcePromise(this._resourceDefer.promise), this._modelEnvironment = e.getModel(), this._nodeBackground = e.getNode().getBackground(), this._nodeBackground.addUpdateCallback(this), a.a.getMaterial().then(this.onEnableChanged.bind(this)))
            },
            getResourceManager: function () {
                return this._resourceManager || s.default.instance
            },
            onBackgroundChanged: function () {
                var e = this.model.getBackground();
                if (e) {
                    var t = this.options.context.getViewer(),
                        i = Math.max(Object(u.a)(t.getWidth()), Object(u.a)(t.getHeight())),
                        n = e.findImageNearestToResolution(i, i),
                        r = n.url;
                    return this.getResources(r)
                }
            },
            getResources: function (e) {
                for (var t = {
                        minFilter: c.Texture.LINEAR,
                        magFilter: c.Texture.LINEAR,
                        transferToGPU: !0,
                        convertNPOT: !1,
                        backgroundUid: this.model.get("uid"),
                        internalFormat: c.Texture.RGB
                    }, i = this.getResourceManager()._resourceLoader._processing, n = 0; n < i.length; ++n) {
                    var r = i[n],
                        o = r._options;
                    o && o.backgroundUid && o.backgroundUid !== this.model.get("uid") && r.abort()
                }
                var s = this.getResourceManager().getOrCreateTexture(e, t);
                s.promise.then(function (e) {
                    this._nodeBackground.setBackground(e), this._nodeBackground.rescale(this._viewWidth, this._viewHeight), this.model.trigger("backgroundUpdated", e), "fixed" === this.model.getEnableType() && this._nodeBackground.showBackground()
                }.bind(this));
                var u = this.options.context.getViewer();
                return this._resourceDefer ? (s.promise.finally(this._resourceDefer.resolve.bind(this._resourceDefer)), this._resourceDefer = void 0) : a.a.getHighResLoaded().then(u.setFakeSecondaryProgress.bind(u, s.promise, "background")), s.promise
            },
            onEnableChanged: function () {
                var e = this.model.getEnableType();
                "color" === e ? this._nodeBackground.showColor() : "fixed" === e ? this._nodeBackground.getBackground() ? this._nodeBackground.showBackground() : void 0 !== this.model.get("uid") && this.onBackgroundChanged() : "environment" === e ? (this._modelEnvironment.trigger("updateBackground"), this._nodeBackground.showEnvironment()) : "ambient" === e ? (this._modelEnvironment.trigger("updateBackground"), this._nodeBackground.showAmbient()) : "none" === e && this._nodeBackground.hide(), this._resourceDefer && (this._resourceDefer.resolve(), this._resourceDefer = void 0)
            },
            requireBiggerTexture: function () {
                var e = this.options.context.getViewer(),
                    t = Math.max(Object(u.a)(e.getWidth()), Object(u.a)(e.getHeight())),
                    i = this.model.getBackground();
                if (i) {
                    var n = i.findImageNearestUpToResolution(t, t);
                    if (void 0 !== this._nodeBackground && !this._nodeBackground.getBackground()) return !1;
                    if (n.width < this._nodeBackground.getBackground().getWidth()) return !1
                }
                return !0
            },
            update: function () {
                if ("fixed" !== this.model.getEnableType()) return !0;
                var e = this._viewer.getCamera().getViewport(),
                    t = e.width(),
                    i = e.height();
                return this._viewWidth === t && this._viewHeight === i || (this._viewWidth = t, this._viewHeight = i, !0 === this.requireBiggerTexture() && this.onBackgroundChanged(), this._nodeBackground.rescale(t, i)), !0
            }
        });
    t.a = h
}, function (e, t, i) {
    "use strict";
    var n = i(90),
        r = i(1335),
        a = i(1336),
        o = {
            FeatureName: "hotspot",
            ModelType: r.a,
            ViewListType: [a.a]
        },
        s = n.a.create(o);
    s.prototype.getNode = function () {
        return this._views[0].getNodeHotspot()
    }, s.prototype.getWidgetNode = function () {
        return this._views[0].getNodeProxy()
    }, t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(149),
        r = i(9),
        a = i(0),
        o = (i.n(a), i(637)),
        s = i(670),
        u = i(77),
        l = i(20),
        c = i(456),
        h = r.a.osg,
        d = function (e) {
            var t = h.vec3.create(),
                i = h.vec3.create();
            e.getFeatures().camera.getModel().getCameraPosition(t, i), this.set("eye", t), this.set("target", i);
            var n = e.getScreenShot(128, 128),
                r = n.toDataURL("image/jpeg");
            this.set("uidImage", void 0), this.set("imageFile", Object(o.a)(r)), this.set("preview", r)
        },
        f = n.a.extend({
            getModelOptionPath: function () {
                return "hotspot"
            },
            defaults: function () {
                return {
                    webVR: !1,
                    currentHotspotIndex: -1
                }
            },
            getName: function () {
                return "Hotspot"
            },
            getResourceManager: function () {
                return this._resourceManager || u.default.instance
            },
            init: function (e) {
                var t = this.getResourceManager().getHotspotCollection();
                this.set("hotspots", t), t.on("remove", this.onRemove, this), this._viewer = e.getViewer(), this.hotspotsToBeDeleted = [];
                var i = e.getModel().get("options"),
                    n = i.hotspot;
                this.setJSON(n)
            },
            onRemove: function (e) {
                e.isNew() || this.hotspotsToBeDeleted.push(e)
            },
            setUpdateCallback: function (e) {
                this.callback = e
            },
            createHotspot: function (e, t) {
                var i = this.get("hotspots"),
                    n = new s.a;
                return n.set("uid", "tmp_" + Object(a.uniqueId)()), Object(c.b)(n, e), i.add(n, {
                    sort: !1
                }), n.set("order", i.indexOf(n)), n.set("refreshAction", d.bind(n, this._viewer)), n.get("refreshAction")(), void 0 === t && i.trigger("select", n), n
            },
            setJSON: function (e, t) {
                if (t && t.validate) {
                    var i = this.validate(e);
                    if (i.length) return i.join("\n")
                }
                void 0 !== Object(l.a)().annotationsVisible ? this.set("visible", Object(l.a)().annotationsVisible) : void 0 !== e.visible ? this.set("visible", e.visible) : this.set("visible", !0);
                var n = e && e.hotspots && Object(a.keyBy)(e.hotspots, "uid"),
                    r = this.get("hotspots");
                return r.each(function (e) {
                    e.collection = null;
                    var t = e.get("images")[0];
                    t && (e.set("uidImage", t.uid), e.set("imageFile", Object(o.a)(t.url)), e.set("preview", t.url)), e.set("refreshAction", d.bind(e, this._viewer));
                    var i = n && n[e.get("uid")];
                    i && (e.set("geometryUid", i.geometryUid), e.set("indices", i.indices), e.set("barycentricWeights", i.barycentricWeights), e.set("localPosition", i.localPosition)), r.add(e)
                }.bind(this)), []
            },
            getJSON: function () {
                var e = [];
                return this.get("hotspots").each(function (t) {
                    var i = {
                        uid: t.get("uid"),
                        geometryUid: t.get("geometryUid"),
                        indices: t.get("indices"),
                        barycentricWeights: t.get("barycentricWeights"),
                        localPosition: t.get("localPosition")
                    };
                    e.push(i)
                }), {
                    hotspots: e,
                    visible: this.get("visible")
                }
            }
        });
    t.a = f
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(8),
        a = i(47),
        o = i(77),
        s = i(120),
        u = i(634),
        l = i(69),
        c = i(44),
        h = i(85),
        d = i(79),
        f = i(13),
        p = i(14),
        m = i(4),
        g = i(321),
        v = i(930),
        _ = i(25),
        b = i(444),
        S = i(159),
        x = i(456),
        y = i(88),
        C = i(199),
        T = i(1342),
        w = i.n(T),
        M = i(1343),
        E = i.n(M),
        A = i(1344),
        P = i.n(A),
        R = i(1345),
        O = i.n(R),
        I = n.a.osg,
        F = n.a.InputGroups,
        N = r.a.extend({
            initialize: function () {
                r.a.prototype.initialize.apply(this, arguments), this._nodeHotspot = new I.Node, this._nodeHotspot.setName("Feature - Hotspot"), this._hotspots = this.model.get("hotspots");
                var e = this._hotspots.length > 0;
                g.a.setHotspot(e), this._hotspots.on("sort", c.a.draw), this._hotspots.on("remove", this.onHotspotRemoved, this), this._hotspots.on("add", this.onHotspotAdded, this), this._hotspots.on("select", this.onHotspotSelected, this), this._hotspots.on("inserted", this.onHotspotInserted, this), this.model.on("change:visible", this.onVisible, this), this._lastSuccessHit = void 0;
                var t = this.options.context;
                this._viewer = t.getViewer(), this._viewerOSGJS = this._viewer.getViewerOSGJS(), this._manipulator = this._viewerOSGJS.getManipulator(), this._inputManager = this._viewerOSGJS.getInputManager(), this._idDragging = -1, this._dragHotspotStarted = !1, this._lastHoveredIndex = -1, this._dragCamera = !1, this._lastCoordNotDragging = I.vec2.create(), this._proxyHotspot = new I.Node, this._proxyHotspot.setName("Hotspot - Proxy"), this._proxyHotspot.setNodeMask(0), this._nodeHotspot.addChild(this._proxyHotspot), this.initHotspotProxy(), this._hotspots.each(this.onHotspotAdded.bind(this)), (e || Object(d.a)()) && a.a.getModelDisplayed().then(this.hotspotReady.bind(this))
            },
            getNodeHotspot: function () {
                return this._nodeHotspot
            },
            getNodeProxy: function () {
                return this._proxyHotspot
            },
            getScreenThresholdHover: function () {
                return 20 * b.a.getPixelRatio()[0]
            },
            onVisible: function () {
                this._proxyHotspot.setNodeMask(this.model.get("visible") ? l.a.NO_SHADOW : 0), c.a.draw()
            },
            hotspotReady: function () {
                C.a.initHotspot(this), this.onVisible();
                var e = this._viewer.getFeaturesManager().getTextureDepth();
                e && this._proxyHotspot.getOrCreateStateSet().setTextureAttributeAndModes(0, e), c.a.draw()
            },
            onHotspotInserted: function () {
                for (var e = 0; e < this._proxyHotspot.children.length; e++) this._proxyHotspot.children[e].initCard()
            },
            initHotspotProxy: function () {
                if (this.model.get("hotspots").length) {
                    this._proxyHotspot.setCullCallback(this);
                    var e = this._proxyHotspot.getOrCreateStateSet();
                    e.setRenderBinDetails(h.a.HOTSPOT, "RenderBin"), e.setAttributeAndModes(y.a.DEPTH_DISABLE), e.setAttributeAndModes(y.a.BLEND_SUBSTRACTIVE);
                    var t = o.default.instance.getOrCreateTexture(u.a.iconHotspot, {
                        internalFormat: I.Texture.RGBA
                    });
                    e.addUniform(I.Uniform.createInt(0, "uTextureDepth")), e.addUniform(I.Uniform.createInt(1, "uTextureHotspot")), e.setTextureAttributeAndModes(1, t.texture), e.setAttributeAndModes(s.a.createShader(w.a, E.a, "hotspot", "Hotspot")), e.setAttributeAndModes(y.a.CULL_DISABLE), v.a.initLineShader(s.a.createShader(P.a, O.a, "hotspotline", "VRHotspotLine")), this._proxyInitialized = !0
                }
            },
            createHotspot: function (e) {
                if ("annotations" === this._viewer.getOptions().widgetAPI.getTabbedWidget().get()) {
                    var t = this.options.context.getModel().get("user").account,
                        i = p.a.maxHotspotsPerModel[t];
                    if (this._hotspots.length >= i) return this.model.trigger("hotspot-error", new _.c(void 0, "hotspot", i, m.a.me().toJSON().account));
                    if (this._viewer.getFeaturesManager()) {
                        var n = S.a.pickNearestSurface(e);
                        n && (this.model.createHotspot(n), f.a.annotationEditorCreateButtonClicked(this.options.context.getModel().get("uid")))
                    }
                }
            },
            getColorHotspot: function (e) {
                return this._proxyHotspot.getChildren()[e].getColor()
            },
            setHotspotHovered: function (e, t) {
                t >= 0 && I.vec3.copy(this.getColorHotspot(t), e ? v.a.COLOR_HOVERED : v.a.COLOR_NORMAL)
            },
            updateCameraDragged: function () {
                var e = I.vec2.create();
                return function (t) {
                    this._dragCamera = this._dragCamera || I.vec2.dist(I.vec2.set(e, t.glX, t.glX), this._lastCoordNotDragging) > 5
                }
            }(),
            hoverHotspot: function (e) {
                var t = this.pickHotspot(e);
                this.setHotspotHovered(0, this._lastHoveredIndex), this.setHotspotHovered(1, t), -1 === this._idDragging && I.vec2.set(this._lastCoordNotDragging, e.glX, e.glY), this._lastHoveredIndex !== t && (-1 !== this._lastHoveredIndex && this._viewer.trigger("annotationMouseLeave", this._lastHoveredIndex), -1 !== t && this._viewer.trigger("annotationMouseEnter", t), this._lastHoveredIndex = t, c.a.draw())
            },
            selectHotspot: function (e) {
                var t = this.pickHotspot(e);
                this._hotspots.trigger("select", this._hotspots.at(t))
            },
            startDrag: function (e) {
                this._idDragging = this.pickHotspot(e), this._dragCamera = !1, I.vec2.set(this._lastCoordNotDragging, e.glX, e.glY), this._idDragging >= 0 && this._inputManager.setEnable(F.MANIPULATORS, !1)
            },
            cancelDrag: function () {
                this._dragCamera = !0, this.stopDrag()
            },
            stopDrag: function () {
                if (this._dragCamera) this._idDragging >= 0 && (this._lastSuccessHit && Object(x.b)(this._hotspots.at(this._idDragging), this._lastSuccessHit), I.vec3.copy(this.getColorHotspot(this._idDragging), v.a.COLOR_NORMAL), c.a.draw(), f.a.annotationEditorPositionMoved(this.options.context.getModel().get("uid")));
                else if (this._hotspots.trigger("select", this._hotspots.at(this._idDragging)), this._idDragging > -1) {
                    var e = this.options.context.getModel().get("uid") + "_" + (this._idDragging + 1);
                    f.a.modelViewerAnnotationClicked(e)
                }
                this._idDragging >= 0 && this._inputManager.setEnable(F.MANIPULATORS, !0), this._dragHotspotStarted = !1, this._dragCamera = !1, this._idDragging = -1
            },
            dragHotspot: function () {
                var e = I.vec3.create();
                return function (t) {
                    if (!(this._idDragging < 0) && (this.updateCameraDragged(t), this._dragHotspotStarted = !0, S.a.isInitialized())) {
                        var i = S.a.pickNearestSurface(t),
                            n = this._hotspots.at(this._idDragging);
                        I.vec3.copy(this.getColorHotspot(this._idDragging), i ? v.a.COLOR_DRAG_OK : v.a.COLOR_DRAG_FAIL), i ? (this._lastSuccessHit = i, Object(x.b)(n, i)) : (I.vec2.set(e, t.glX, t.glY), e[2] = S.a.getScreenPositionFromScenePoint(n.get("position"), I.vec3.create())[2], S.a.getScenePositionFromScreenPoint(e, n.get("position")), n.set("geometryUid", -1)), c.a.draw()
                    }
                }
            }(),
            onHotspotSelected: function () {
                var e = I.vec3.create(),
                    t = I.vec3.create();
                return function (i) {
                    if (!i) return void this._viewer.trigger("annotationSelect", -1);
                    var n = this._viewer.getFeaturesManager();
                    n && (I.vec3.copy(e, i.get("eye")), I.vec3.copy(t, i.get("target")), n.applyAutospinToCamera(e, t), n.focusOnTargetAndEye(t, e, 1.5), this._viewer.trigger("annotationSelect", this._hotspots.indexOf(i)), c.a.draw())
                }
            }(),
            onHotspotAdded: function (e) {
                this._proxyInitialized || this.initHotspotProxy();
                var t = new v.a(this._hotspots.indexOf(e), this._viewer);
                t.setCardVisibilityListener(this._onCardVisibilityChange.bind(this)), this._proxyHotspot.addChild(t), c.a.draw()
            },
            _onCardVisibilityChange: function (e, t) {
                t ? this._viewer.trigger("annotationFocus", e.getIndex()) : this._viewer.trigger("annotationBlur", e.getIndex())
            },
            onHotspotRemoved: function () {
                this.setHotspotHovered(0, this._lastHoveredIndex), this._lastHoveredIndex = -1;
                var e = this._proxyHotspot.getChildren();
                this._proxyHotspot.removeChild(e[e.length - 1]), c.a.draw()
            },
            screenDistanceToHotspot: function () {
                var e = I.vec3.create();
                return function (t, i) {
                    return S.a.getScreenPositionFromWorldPoint(t.get("lastComputedWorldPosition"), e), I.vec2.dist(e, i)
                }
            }(),
            pickHotspot: function () {
                var e = I.vec2.create();
                return function (t) {
                    if (!this._viewer.getFeaturesManager() || !this.model.get("visible")) return -1;
                    I.vec2.set(e, t.glX, t.glY);
                    for (var i = 1 / 0, n = this._hotspots.length, r = -1, a = this.getScreenThresholdHover(), o = this._hotspots, s = 0; s < n; ++s) {
                        var u = o.at(s);
                        if (u.get("visible")) {
                            var l = this.screenDistanceToHotspot(u, e);
                            l < a && l < i && (i = l, r = s)
                        }
                    }
                    return r
                }
            }(),
            cull: function () {
                var e = I.mat4.create(),
                    t = I.quat.create(),
                    i = I.vec3.create();
                return function () {
                    this.model.callback && this.model.callback();
                    var n = this._viewer.getFeaturesManager();
                    if (this._lastHoveredIndex >= 0 && -1 === this._idDragging) {
                        this.screenDistanceToHotspot(this._hotspots.at(this._lastHoveredIndex), this._lastCoordNotDragging) >= this.getScreenThresholdHover() && this.setHotspotHovered(0, this._lastHoveredIndex)
                    }
                    var r = this._hotspots,
                        a = this._proxyHotspot.getChildren(),
                        o = a.length,
                        s = this._viewer.getFeatures(),
                        u = s.webVR.getModel().get("worldFactor"),
                        l = this.model.get("webVR");
                    this._manipulator.getEyePosition(i);
                    var c = n.getIconScaleFov();
                    if (!l) {
                        var h = this._viewer.getCamera();
                        I.mat4.invert(e, h.getViewMatrix()), I.mat4.fromQuat(e, I.mat4.getRotation(t, e))
                    }
                    for (var d = 0; d < o; ++d) {
                        var f = a[d],
                            p = r.at(d);
                        if (p.get("visible")) {
                            f.setVisible(!0), Object(x.d)(p);
                            var m = p.get("lastComputedWorldPosition"),
                                g = I.vec3.dist(m, i) / c;
                            l ? f.updatePositionVR(p, i, g, u) : f.updatePosition(p, i, g, e)
                        } else f.setVisible(!1)
                    }
                    return !0
                }
            }()
        });
    t.a = N
}, function (e, t, i) {
    "use strict";
    var n = i(586),
        r = i(69),
        a = i(9),
        o = a.a.osg,
        s = function (e, t) {
            n.a.call(this, e, t), this._round = .005
        };
    s.prototype = o.objectInherit(n.a.prototype, {
        initialize: function (e, t) {
            n.a.prototype.initialize.call(this, e, t, function () {
                this.setClickAction("nextPage", function () {
                    this.setPage(this._currentPage + 1)
                }.bind(this)), this.setClickAction("prevPage", function () {
                    this.setPage(this._currentPage - 1)
                }.bind(this))
            }.bind(this)), this._nbColumns = t.column, this._currentPage = 0
        },
        setHinted: function (e) {
            this._hinted = e, this.setNodeMask(e ? r.a.NO_PICK : 0), this._uAlpha && (this._uAlpha[0] = .1)
        },
        isHinted: function () {
            return this._hinted
        },
        getNbPage: function () {
            return this._nbColumns
        },
        getCurrentPage: function () {
            return this._currentPage
        },
        setPage: function (e) {
            if (this._currentPage !== e) {
                var t = this.getNbPage(),
                    i = Math.min(t - 1, Math.max(0, e));
                this.setPageForCell("column" + i, "default"), this._currentPage = i
            }
        }
    }), t.a = s
}, function (e, t) {
    e.exports = "attribute vec2 TexCoord0;\nattribute vec3 Vertex;\n\nvarying vec2 vTexCoord0;\n\n// uniform mat4 uModelMatrix;\n// uniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat4 uModelViewMatrix;\n\nvoid main(void) {\n  vTexCoord0 = TexCoord0;\n  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex.xyz, 1.0);\n}\n"
}, function (e, t) {
    e.exports = 'varying vec2 vTexCoord0;\n\nuniform sampler2D uTexturePanel;\nuniform vec4 uHoveredArea;\nuniform float uHoveredOpaque;\nuniform float uAlpha;\nuniform float uRatio;\nuniform float uRound;\nuniform float uVeilFactor;\n\n#pragma include "utils/functions.glsl"\n\n// signed distance to a 2D rounded box\nfloat sdRoundBox( const in vec2 p, const in vec2 b, const in float r ) {\n    vec2 q = abs(p) - b;\n    vec2 m = vec2( min(q.x,q.y), max(q.x,q.y) );\n    float d = (m.x > 0.0) ? length(q) : m.y;\n    return d - r;\n}\n\nvoid main(void) {\n  vec4 color = texture2D(uTexturePanel, vTexCoord0);\n\n  float lerpValue = step(0.0, -vTexCoord0.x);\n  lerpValue += step(1.0, vTexCoord0.x);\n\n  float round = uRound;\n  float left = uHoveredArea.x + round;\n  float right = uHoveredArea.y - round;\n  float top = uHoveredArea.z - round;\n  float bottom = uHoveredArea.w + round;\n\n  vec2 halfSize = abs(vec2(left - right, top - bottom) * 0.5);\n  vec2 center = vec2(halfSize.x + left, halfSize.y + bottom);\n\n  lerpValue += max(0.0, -sign(sdRoundBox( vTexCoord0 - center, halfSize, round)));\n\n  color.rgba = mix(color.rgba, color.rgba + vec4(0.109, 0.664, 0.848, step(0.1, uHoveredOpaque)), lerpValue);\n\n  color.a *= uAlpha;\n  color.rgb *= (color.a * uVeilFactor);\n\n  gl_FragColor = color;\n}\n'
}, function (e, t, i) {
    e.exports = i(1341)
}, function (e, t, i) {
    ! function () {
        var i, n = Array.prototype.forEach,
            r = Object.prototype.hasOwnProperty,
            a = Array.prototype.slice,
            o = 0,
            s = function () {
                return {
                    keys: Object.keys || function (e) {
                        if ("object" != typeof e && "function" != typeof e || null === e) throw new TypeError("keys() called on a non-object");
                        var t, i = [];
                        for (t in e) e.hasOwnProperty(t) && (i[i.length] = t);
                        return i
                    },
                    uniqueId: function (e) {
                        var t = ++o + "";
                        return e ? e + t : t
                    },
                    has: function (e, t) {
                        return r.call(e, t)
                    },
                    each: function (e, t, i) {
                        if (null != e)
                            if (n && e.forEach === n) e.forEach(t, i);
                            else if (e.length === +e.length)
                            for (var r = 0, a = e.length; r < a; r++) t.call(i, e[r], r, e);
                        else
                            for (var o in e) this.has(e, o) && t.call(i, e[o], o, e)
                    },
                    once: function (e) {
                        var t, i = !1;
                        return function () {
                            return i ? t : (i = !0, t = e.apply(this, arguments), e = null, t)
                        }
                    }
                }
            }();
        i = {
            on: function (e, t, i) {
                return l(this, "on", e, [t, i]) && t ? (this._events || (this._events = {}), (this._events[e] || (this._events[e] = [])).push({
                    callback: t,
                    context: i,
                    ctx: i || this
                }), this) : this
            },
            once: function (e, t, i) {
                if (!l(this, "once", e, [t, i]) || !t) return this;
                var n = this,
                    r = s.once(function () {
                        n.off(e, r), t.apply(this, arguments)
                    });
                return r._callback = t, this.on(e, r, i)
            },
            off: function (e, t, i) {
                var n, r, a, o, u, c, h, d;
                if (!this._events || !l(this, "off", e, [t, i])) return this;
                if (!e && !t && !i) return this._events = {}, this;
                for (o = e ? [e] : s.keys(this._events), u = 0, c = o.length; u < c; u++)
                    if (e = o[u], a = this._events[e]) {
                        if (this._events[e] = n = [], t || i)
                            for (h = 0, d = a.length; h < d; h++) r = a[h], (t && t !== r.callback && t !== r.callback._callback || i && i !== r.context) && n.push(r);
                        n.length || delete this._events[e]
                    } return this
            },
            trigger: function (e) {
                if (!this._events) return this;
                var t = a.call(arguments, 1);
                if (!l(this, "trigger", e, t)) return this;
                var i = this._events[e],
                    n = this._events.all;
                return i && c(i, t), n && c(n, arguments), this
            },
            stopListening: function (e, t, i) {
                var n = this._listeners;
                if (!n) return this;
                var r = !t && !i;
                "object" == typeof t && (i = this), e && ((n = {})[e._listenerId] = e);
                for (var a in n) n[a].off(t, i, this), r && delete this._listeners[a];
                return this
            }
        };
        var u = /\s+/,
            l = function (e, t, i, n) {
                if (!i) return !0;
                if ("object" == typeof i) {
                    for (var r in i) e[t].apply(e, [r, i[r]].concat(n));
                    return !1
                }
                if (u.test(i)) {
                    for (var a = i.split(u), o = 0, s = a.length; o < s; o++) e[t].apply(e, [a[o]].concat(n));
                    return !1
                }
                return !0
            },
            c = function (e, t) {
                var i, n = -1,
                    r = e.length,
                    a = t[0],
                    o = t[1],
                    s = t[2];
                switch (t.length) {
                    case 0:
                        for (; ++n < r;)(i = e[n]).callback.call(i.ctx);
                        return;
                    case 1:
                        for (; ++n < r;)(i = e[n]).callback.call(i.ctx, a);
                        return;
                    case 2:
                        for (; ++n < r;)(i = e[n]).callback.call(i.ctx, a, o);
                        return;
                    case 3:
                        for (; ++n < r;)(i = e[n]).callback.call(i.ctx, a, o, s);
                        return;
                    default:
                        for (; ++n < r;)(i = e[n]).callback.apply(i.ctx, t)
                }
            },
            h = {
                listenTo: "on",
                listenToOnce: "once"
            };
        s.each(h, function (e, t) {
            i[t] = function (t, i, n) {
                return (this._listeners || (this._listeners = {}))[t._listenerId || (t._listenerId = s.uniqueId("l"))] = t, "object" == typeof i && (n = this), t[e](i, n, this), this
            }
        }), i.bind = i.on, i.unbind = i.off, i.mixin = function (e) {
            var t = ["on", "once", "off", "trigger", "stopListening", "listenTo", "listenToOnce", "bind", "unbind"];
            return s.each(t, function (t) {
                e[t] = this[t]
            }, this), e
        }, void 0 !== e && e.exports && (t = e.exports = i), t.BackboneEvents = i
    }()
}, function (e, t) {
    e.exports = "attribute vec2 TexCoord0;\nattribute vec3 Vertex;\n\nvarying vec2 vTexCoord0;\nvarying vec4 vViewPos;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nuniform float uHotspotIndex;\n\n// icon size 48 pixel width and 2 pixel padding between them\nconst vec2 ICON_SIZE = 48.0 / vec2(512.0, -256.0);\nconst vec2 ICON_AND_PADDING = ICON_SIZE + 2.0 / vec2(512.0, -256.0);\n\nvoid main(void) {\n  vec2 offset = vec2(mod(uHotspotIndex, 10.0), floor(uHotspotIndex / 10.0));\n  vTexCoord0 = vec2(TexCoord0.x, 1.0 - TexCoord0.y) * ICON_SIZE + offset * ICON_AND_PADDING;\n\n  vViewPos = uModelViewMatrix * vec4(Vertex.xyz, 1.0);\n  gl_Position = uProjectionMatrix * vViewPos;\n}\n"
}, function (e, t) {
    e.exports = '#pragma include "utils/decodeDepth.glsl"\n\nvarying vec2 vTexCoord0;\nvarying vec4 vViewPos;\n\nuniform sampler2D uTextureHotspot;\nuniform vec3 uColor;\n\nuniform sampler2D uTextureDepth;\nuniform vec2 uGlobalTexSize;\nuniform vec2 uGlobalTexRatio;\nuniform vec2 uNearFar;\n\nconst float BIAS_VISIBILITY = 0.05;\n\nvoid main(void) {\n  float distDepth = distanceToDepth(uTextureDepth, uGlobalTexRatio * gl_FragCoord.xy / uGlobalTexSize, vViewPos, uNearFar);\n  float alpha = distDepth < BIAS_VISIBILITY ? 1.0 : 0.1;\n\n  gl_FragColor = vec4(uColor, 1.0) * texture2D(uTextureHotspot, vTexCoord0);\n  gl_FragColor.a *= alpha;\n\n  gl_FragColor.rgb *= gl_FragColor.a;\n}\n'
}, function (e, t) {
    e.exports = "attribute vec3 Vertex;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xyz, 1.0));\n}\n"
}, function (e, t) {
    e.exports = 'uniform vec4 uLineColor;\n\n#pragma include "utils/functions.glsl"\n\nvoid main(void) {\n    vec4 color = sRGBToLinear(uLineColor);\n    color.rgb *= color.a;\n    gl_FragColor = linearTosRGB(color);\n}\n'
}, function (e, t, i) {
    "use strict";
    var n = i(90),
        r = i(1347),
        a = i(1350),
        o = {
            FeatureName: "lighting",
            ModelType: r.a,
            ViewListType: [a.a]
        },
        s = n.a.create(o);
    s.prototype.getNode = function () {
        return this._views[0].getNode()
    }, s.prototype.getNodeShadow = function () {
        return this._views[0].getNodeShadow()
    }, s.prototype.prepareForScreenShot = function () {
        this._views[0].setIsScreenshot(!0)
    }, s.prototype.resetAfterScreenShot = function () {
        this._views[0].setIsScreenshot(!1)
    }, t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(47),
        a = i(149),
        o = i(1348),
        s = i(1349),
        u = i(101),
        l = i(103),
        c = n.a.osg,
        h = a.a.extend({
            defaults: function () {
                return {
                    select: -1,
                    lights: [new o.a(0), new o.a(1), new o.a(2)],
                    webVR: !1,
                    forceShadowRedraw: !1
                }
            },
            getName: function () {
                return "Lighting"
            },
            getDefaultFalloff: function () {
                var e = this._root.getMinimumBound().radius();
                return e < 0 ? 0 : 3.90625 / (e * e)
            },
            setPreset: function (e) {
                s.a[e] || console.error("Preset does not exist: " + e), this.setJSON({
                    enable: this.get("enable"),
                    lights: s.a[e]()
                }, {
                    resetFalloff: !0
                })
            },
            init: function (e) {
                this._viewer = e.getViewer(), this._root = this._viewer.getRootModel(), this.set("enable", !Object(u.a)());
                var t = e.getModel().get("options"),
                    i = t.lighting;
                i && i.lights && (this._ignoreSceneLights = !0, this.setJSON(i)), r.a.getModelDisplayed().then(this.initDepthTexture.bind(this))
            },
            initDepthTexture: function () {
                for (var e = this._viewer.getFeaturesManager().getTextureDepth(), t = this.get("lights"), i = 0; i < 3; ++i) t[i].setDepthTexture(e)
            },
            dirtyScene: function () {
                l.a.getModelBoxWithoutDisplacement() ? this.recomputeLightsPositionAndFalloff() : l.a.getBoxReady().then(this.recomputeLightsPositionAndFalloff.bind(this))
            },
            recomputeLightsPositionAndFalloff: function () {
                for (var e = l.a.getModelBoxWithoutDisplacement(), t = this.get("lights"), i = .8 * e.radius(), n = this.getDefaultFalloff(), r = e.center(c.vec3.create()), a = c.vec3.fromValues(0, 0, i), o = 0; o < 3; ++o) {
                    var s = t[o],
                        u = s.get("matrix");
                    s.get("falloff") < 0 && (s.set("falloff", n), u[12] = r[0], u[13] = r[1], u[14] = r[2], c.mat4.translate(u, u, a)), s.dirty()
                }
            },
            initLights: function (e) {
                var t = 0,
                    i = this.get("lights");
                for (t = 0; t < 3; ++t) i[t].setScene(this._root);
                if (this._ignoreSceneLights) return this.trigger("uiReady");
                var n = e.length;
                if (Object(u.a)()) {
                    if (0 === n) return this.setPreset("ThreePointLight"), this.trigger("uiReady");
                    this.set("enable", !0)
                } else {
                    for (t = 0; t < 3; ++t) i[t].set("castShadows", !1);
                    if (0 === n) return this.setPreset("TwoHeadLightV1"), this.trigger("uiReady");
                    if (n > 3) return this.setPreset("ThreePointLightV2"), this.trigger("uiReady")
                }
                e.sort(function (e, t) {
                    return c.vec3.len(e.getDiffuse()) - c.vec3.len(t.getDiffuse())
                });
                var r = c.vec3.create();
                for (t = 0; t < 3; ++t) {
                    var a = e[t],
                        o = i[t];
                    if (a) {
                        var s = a.getLightType();
                        o.set("type", s), o.set("attachedToCamera", !1), "SPOT" === s && (o.set("angle", Math.min(90, a.getSpotCutoff())), o.set("hardness", a.getSpotBlend()));
                        var l = a.getDiffuse(),
                            h = Math.max(l[0], l[1], l[2], 1);
                        o.set("intensity", h), c.vec3.scale(o.get("color"), l, 1 / h);
                        var d = a.getGround(),
                            f = Math.max(d[0], d[1], d[2], 1);
                        o.set("intensityGround", f), c.vec3.scale(o.get("ground"), d, 1 / f), o.set("falloff", a.getQuadraticAttenuation());
                        var p = o.get("matrix");
                        c.mat4.getScale(r, a._worldMatrix), c.mat4.fromScaling(p, r), c.mat4.invert(p, p), c.mat4.multiply(p, a._worldMatrix, p)
                    } else o.set("falloff", this.getDefaultFalloff()), o.set("type", "NONE")
                }
                return this.trigger("uiReady")
            },
            getJSON: function () {
                var e = {},
                    t = this.get("lights");
                return e.enable = this.get("enable"), e.lights = [t[0].getJSON(), t[1].getJSON(), t[2].getJSON()], e
            },
            setJSON: function (e, t) {
                var i = t || {};
                i.ignore = ["lights"], a.a.prototype.setJSON.call(this, e, i);
                var n = this.get("lights");
                void 0 !== e.enable && this.set("enable", e.enable);
                for (var r = {
                        validate: i.validate
                    }, o = 0; o < 3; ++o) {
                    var s = e.lights[o];
                    if (s) {
                        var u = n[o];
                        u.setUpdateMatrixOnToggleCamera(!1), u.setJSON(s, r), u.setUpdateMatrixOnToggleCamera(!0), t && t.resetFalloff && u.set("falloff", -1), u.get("falloff") < 0 && this.dirtyScene()
                    }
                }
            },
            editorGetJSON: function () {
                return this.getJSON()
            },
            editorSetJSON: function (e) {
                return this.setJSON(e, {
                    validate: !0,
                    resetFalloff: !0
                })
            }
        });
    t.a = h
}, function (e, t, i) {
    "use strict";
    var n = i(149),
        r = i(9),
        a = i(711),
        o = i(925),
        s = i(69),
        u = i(119),
        l = i(44),
        c = i(229),
        h = i(20),
        d = r.a.osg,
        f = r.a.osgUtil,
        p = n.a.extend({
            getModelOptionPath: function () {
                return "#.definitions.light"
            },
            defaults: function () {
                return {
                    matrixPrev: d.mat4.create(),
                    shadowNormalBias: Object(h.a)().shadowNormalOffset ? .075 : void 0
                }
            },
            initialize: function () {
                n.a.prototype.initialize.apply(this, arguments), u.a.bind("change:mask", this.dirty, this), this.createNode(arguments[0])
            },
            createNode: function (e) {
                this._mtLight = new d.MatrixTransform, this._mtLight.setName("Lighting - Mt");
                var t = Object(a.b)("Lighting", e);
                this._shadowMap = t.shadowMap, this._light = t.light, this._lightSource = t.lightSource, this._node = t.node, this._enableShadow = t.enableShadow, this._mtQuad = new d.MatrixTransform, this._mtQuad.setName("Lighting - TransformIcon " + e), this._quadGeom = o.a.createIconGeometry(), this._quadGeom.setName("Lighting -  GeomIcon " + e), this._pointGeom = new o.a.createPointGeometry, this._dirGeom = new o.a.createDirectionalGeometry(5), this._spotGeom = new o.a.createSpotGeometry(5), this._hemiGeom = new o.a.createHemiGeometry(4), this._hemiGeom.getOrCreateStateSet().addUniform(d.Uniform.createFloat4(d.vec4.fromValues(0, 0, 1, 1), "uGround")), this._scale = new d.MatrixTransform, this._scale.setName("Lighting - ScaleIcon " + e), this._mtEditLight = new d.MatrixTransform, this._mtEditLight.getOrCreateStateSet().setTextureAttributeAndModes(0, c.a.dummyTexture), this._mtEditLight.setName("Lighting - MtEditLight " + e);
                var i = this._mtEditLight.getOrCreateStateSet();
                i.addUniform(d.Uniform.createFloat4(d.vec4.fromValues(1, 1, 1, 1), "uColor")), i.addUniform(d.Uniform.createInt(1, "uEnable")), i.addUniform(d.Uniform.createInt(0, "uAttachedToCamera")), i.addUniform(d.Uniform.createInt(0, "uTextureDepth")), this._node.addChild(this._mtLight), this._node.addChild(this._mtEditLight), this._mtLight.addChild(this._lightSource), this._mtEditLight.addChild(this._scale), this._mtEditLight.addChild(this._spotGeom), this._mtEditLight.addChild(this._pointGeom), this._scale.addChild(this._mtQuad), this._scale.addChild(this._dirGeom), this._scale.addChild(this._hemiGeom), this._mtQuad.addChild(this._quadGeom), this._dirty = !0, this._updateMatrixOnToggleCamera = !0, this._scene = null
            },
            setDepthTexture: function (e) {
                e && this._mtEditLight.getOrCreateStateSet().setTextureAttributeAndModes(0, e)
            },
            setScene: function (e) {
                this._scene = e
            },
            getShadowMap: function () {
                return this._shadowMap
            },
            isCastingShadows: function () {
                var e = this.get("type");
                return this._enableShadow && this.get("castShadows") && ("DIRECTION" === e || "SPOT" === e)
            },
            getLightSource: function () {
                return this._lightSource
            },
            getNodeScale: function () {
                return this._scale
            },
            getNodeQuad: function () {
                return this._mtQuad
            },
            getNode: function () {
                return this._node
            },
            getNodeLight: function () {
                return this._mtLight
            },
            getNodeEditLight: function () {
                return this._mtEditLight
            },
            dirty: function () {
                this._dirty = !0
            },
            isDirty: function () {
                return this._dirty
            },
            updateNode: function () {
                if (this._dirty) {
                    this._dirty = !1;
                    var e = this._node,
                        t = this._light,
                        i = this.get("type");
                    if ("NONE" === i) return e.setNodeMask(0), t.setEnabled(!1), void(this._mtEditLight.editMask = 0);
                    e.setNodeMask(-1), this._mtEditLight.editMask = "POINT" === i ? f.NodeGizmo.PICK_ARROW | f.NodeGizmo.PICK_PLANE : f.NodeGizmo.PICK_GIZMO;
                    "HEMI" === i && u.a.get("mask") & u.a.PBR && (i = "DIRECTION");
                    var n = this.get("enable"),
                        r = this.get("falloff");
                    t.setLightType(i), t.setSpotCutoff("SPOT" === i ? this.get("angle") : 180), t.setEnabled(n), t.setConstantAttenuation("DIRECTION" !== i ? 1 : r), t.setQuadraticAttenuation("DIRECTION" !== i ? r : 0), t.setSpotBlend(this.get("hardness")), d.mat4.copy(this._mtLight.getMatrix(), this.get("matrix")), this._mtLight.dirtyBound(), this._mtEditLight.dirtyBound(), d.vec3.scale(t.getDiffuse(), this.get("color"), this.get("intensity")), d.vec3.copy(t.getSpecular(), t.getDiffuse()), d.vec3.scale(t.getGround(), this.get("ground"), this.get("intensityGround"));
                    var a = this.getShadowMap();
                    a && (a.setTextureSize(Object(h.a)().shadowTextureSize), a.setBias(this.get("shadowBias")), Object(h.a)().shadowNormalOffset && a.setNormalBias(this.get("shadowNormalBias"))), this.isAttachedToCamera() ? (this._mtLight.setReferenceFrame(d.Transform.ABSOLUTE_RF), this._mtLight.setCullingActive(!1)) : (this._mtLight.setReferenceFrame(d.Transform.RELATIVE_RF), this._mtLight.setCullingActive(!0));
                    var o = this._scene.getMinimumBound(),
                        l = o.radius(),
                        c = this.multUI_ ? this.multUI_ : o.radius2() / 1e3,
                        p = Math.pow(r * c, .125);
                    p = Math.min(Math.max(p, 0), 1);
                    var m = .05 * l * p + .8 * l * (1 - p);
                    "SPOT" === i && this._spotGeom.updateCone(t.getSpotCutoff() * Math.PI / 180, m), "POINT" === i && this._pointGeom.updateRadius(m), this._dirGeom.setNodeMask(n && "DIRECTION" === i ? s.a.NO_PICK_NO_SHADOW : 0), this._spotGeom.setNodeMask(n && "SPOT" === i ? s.a.NO_PICK_NO_SHADOW : 0), this._hemiGeom.setNodeMask(n && "HEMI" === i ? s.a.NO_PICK_NO_SHADOW : 0), this._pointGeom.setNodeMask(n && "POINT" === i ? s.a.NO_PICK_NO_SHADOW : 0), d.vec3.copy(this._hemiGeom.getOrCreateStateSet().getUniform("uGround").getInternalArray(), t.getGround()), d.vec3.copy(this._mtEditLight.getOrCreateStateSet().getUniform("uColor").getInternalArray(), this.get("color"));
                    var g = this._mtEditLight.getOrCreateStateSet();
                    g.getUniform("uEnable").setInt(0 | n), g.getUniform("uAttachedToCamera").setInt(0 | this.isAttachedToCamera()), this._quadGeom.setLightType(i)
                }
            },
            setLightUnit: function (e) {
                this._light.getLightNumber() !== e && (this._light.setLightNumber(e), this._light.setName("skfb" + this._light.getTypeMember()), this._shadowMap.dirty())
            },
            setIconVisibility: function (e) {
                this._mtEditLight.setNodeMask(e ? s.a.PICK_GIZMO_LIGHT : 0)
            },
            isAttachedToCamera: function () {
                var e = this.get("type");
                return ("DIRECTION" === e || "HEMI" === e) && this.get("attachedToCamera")
            },
            resetPosition: function () {
                d.mat4.identity(this._mtLight.getMatrix()), this._scene && d.mat4.translate(this._mtLight.getMatrix(), this._mtLight.getMatrix(), this._scene.getMinimumBound().center()), l.a.draw()
            },
            updateAttachedToCamera: function () {
                var e = d.mat4.create(),
                    t = d.vec3.create();
                return function (i) {
                    if (this._updateMatrixOnToggleCamera) {
                        var n = this.get("matrix");
                        d.mat4.getTranslation(t, n), this.get("attachedToCamera") ? d.mat4.copy(e, i.getViewMatrix()) : d.mat4.invert(e, i.getViewMatrix()), d.mat4.multiply(n, e, n), d.mat4.setTranslation(n, t)
                    }
                }
            }(),
            setUpdateMatrixOnToggleCamera: function (e) {
                this._updateMatrixOnToggleCamera = e
            }
        });
    t.a = p
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = n.a.osg,
        a = {};
    a.ThreePointLight = function () {
        return [{
            type: "DIRECTION",
            enable: !0,
            attachedToCamera: !1,
            castShadows: !1,
            matrix: r.mat4.fromValues(-.9815804500275482, .1909922167095499, -.004668327333101102, 0, .13548347102422797, .7131126062169096, .6878332937084056, 0, .13469984856318096, .6745312327912614, -.7258536813891331, 0, 0, 0, 0, 1),
            color: r.vec3.fromValues(.7806122448979592, .7985214493960848, 1),
            intensity: .96
        }, {
            type: "DIRECTION",
            enable: !0,
            attachedToCamera: !1,
            castShadows: !1,
            matrix: r.mat4.fromValues(.7755211495104662, -.0666602860002539, .6277924441503967, 0, .2690483737361956, .9344846523281437, -.233133882464682, 0, -.5711216326246741, .3497067926613838, .7426474533145686, 0, 0, 0, 0, 1),
            color: r.vec3.fromValues(1, .8783319450229073, .7091836734693877),
            intensity: 1
        }, {
            type: "DIRECTION",
            enable: !0,
            attachedToCamera: !1,
            castShadows: !1,
            matrix: r.mat4.fromValues(.6903299131022926, -.7076363669144057, -.15064986988498263, 0, -.011089698239978026, .19785137301620165, -.9801692980238416, 0, .7234097246160907, .6783108479272498, .12873524736872857, 0, 0, 0, 0, 1),
            color: r.vec3.fromValues(.423469387755102, .7352665556018328, 1),
            intensity: .12,
            ground: r.vec3.fromValues(.9642857142857143, .6484128636877489, .2607507288629738),
            intensityGround: .06
        }]
    }, a.FullMoonNight = function () {
        return [{
            type: "DIRECTION",
            enable: !0,
            attachedToCamera: !1,
            castShadows: !1,
            matrix: r.mat4.fromValues(.9997395789367833, .0037284998571004493, -.02251383121813605, 0, -.003172416108909601, .9996902441347245, .024685047253076783, 0, .02259889562202194, -.024607195505995896, .9994417320914686, 0, 0, 0, 0, 1),
            color: r.vec3.fromValues(.14431486880466474, .20264621883738915, .3928571428571429),
            intensity: 1.5400000000000005,
            ground: r.vec3.fromValues(.9744897959183674, .6276245973191442, .3331164098292378),
            intensityGround: .06
        }, {
            type: "DIRECTION",
            enable: !0,
            attachedToCamera: !1,
            castShadows: !1,
            matrix: r.mat4.fromValues(.9321120105125691, .3015730438836578, -.2005514873067817, 0, .11902736304545063, -.7780729183457072, -.6167941476566071, 0, -.34205216956578893, .5510501183556175, -.7611465564236605, 0, 0, 0, 0, 1),
            color: r.vec3.fromValues(1, .613390254060806, .19387755102040816),
            intensity: 2.9799999999999995
        }, {
            type: "DIRECTION",
            enable: !0,
            attachedToCamera: !1,
            castShadows: !1,
            matrix: r.mat4.fromValues(.5165535747993983, -.2459126458378022, -.8201825254045677, 0, -.40819067915319995, .771302442076031, -.48833688402577136, 0, .7526970000035951, .5870430252243886, .29803978378898704, 0, 0, 0, 0, 1),
            color: r.vec3.fromValues(1, 1, 1),
            intensity: .38
        }]
    }, a.LowKeyLight = function () {
        return [{
            type: "DIRECTION",
            enable: !0,
            attachedToCamera: !1,
            castShadows: !1,
            matrix: r.mat4.fromValues(.022621146436927503, -.2660807408393079, -.9636852821789301, 0, -.18898982664775527, .9454138725983617, -.26547213586781604, 0, .9817184571747294, .1881319984823789, -.02890020742997683, 0, 0, 0, 0, 1),
            color: r.vec3.fromValues(1, 1, 1),
            intensity: 1
        }, {
            type: "DIRECTION",
            enable: !0,
            attachedToCamera: !1,
            castShadows: !1,
            matrix: r.mat4.fromValues(-.9330760233019924, .058913139300351657, .35482161258401, 0, .19787524547993016, .9078715652207372, .36961413432105955, 0, -.30035732380815566, .4150885003001482, -.8587706416461712, 0, 0, 0, 0, 1),
            color: r.vec3.fromValues(1, 1, 1),
            intensity: .22
        }, {
            type: "NONE",
            enable: !0
        }]
    }, a.EvilGenius = function () {
        return [{
            type: "DIRECTION",
            enable: !0,
            attachedToCamera: !1,
            castShadows: !1,
            matrix: r.mat4.fromValues(.9967621126545051, .025235816589958687, .07634424888336766, 0, .000702423157861877, -.9521689363972996, .3055713061819492, 0, .08040396369728874, -.3045282747481311, -.9491036468693457, 0, 0, 0, 0, 1),
            color: r.vec3.fromValues(1, .3450645564348185, .056122448979591844),
            intensity: 1.5400000000000005
        }, {
            type: "DIRECTION",
            enable: !0,
            attachedToCamera: !0,
            castShadows: !1,
            matrix: r.mat4.fromValues(-.7932202797763206, .039941473670798935, .6076234577701727, 0, .16089796285361985, .9761307284151629, .14587887644631273, 0, -.5872933111326324, .21347945972549276, -.780713191238742, 0, 0, 0, 0, 1),
            color: r.vec3.fromValues(.15368596418159094, .7346938775510203, .20111518159950362),
            intensity: 1.9000000000000008
        }, {
            type: "DIRECTION",
            enable: !0,
            attachedToCamera: !1,
            castShadows: !1,
            matrix: r.mat4.fromValues(.9998681367204546, .01574007797565349, .003994886292083951, 0, 0, .24600379421877677, -.9692688652948499, 0, -.016239124704439348, .9691410543235108, .24597135535169048, 0, 0, 0, 0, 1),
            color: r.vec3.fromValues(.9897959183673469, .674842115105101, .02524989587671801),
            intensity: .02,
            ground: r.vec3.fromValues(.3, .2, .2),
            intensityGround: .98
        }]
    }, a.FairyCamp = function () {
        return [{
            type: "DIRECTION",
            enable: !0,
            attachedToCamera: !1,
            castShadows: !1,
            matrix: r.mat4.fromValues(.7285122591021403, -.5166704810444328, -.44980162555865727, 0, .2899427624247639, .827461680647148, -.4808745798834604, 0, .6206473095530125, .21990630067806594, .752620844826062, 0, 0, 0, 0, 1),
            color: r.vec3.fromValues(.8476936693044566, .8957603762037927, .9948979591836735),
            intensity: .9
        }, {
            type: "DIRECTION",
            enable: !0,
            attachedToCamera: !1,
            castShadows: !1,
            matrix: r.mat4.fromValues(.08433618912371937, -.8568665398386119, -.5085932953835439, 0, -.8584235966554874, -.3216498975444721, .39956260099599905, 0, -.5059608047162799, .40289089877364465, -.7626811835729392, 0, 0, 0, 0, 1),
            color: r.vec3.fromValues(.37244897959183676, .538942107455227, 1),
            intensity: 1.7200000000000006
        }, {
            type: "DIRECTION",
            enable: !0,
            attachedToCamera: !1,
            castShadows: !1,
            matrix: r.mat4.fromValues(.9766324883850551, -.001534767629049323, .21491074221438983, 0, .14494434684687327, -.7336231034872216, -.6639188793421307, 0, .15868244688039193, .6795548443783637, -.7162577012039377, 0, 0, 0, 0, 1),
            color: r.vec3.fromValues(.3389212827988338, .7142857142857143, .346581781400607),
            intensity: .5,
            ground: r.vec3.fromValues(.9947417742607245, .48469387755102045, 1),
            intensityGround: .14
        }]
    }, a.ThreePointLightV2 = function () {
        return [{
            type: "DIRECTION",
            enable: !0,
            attachedToCamera: !0,
            castShadows: !1,
            matrix: r.mat4.fromValues(-.9815804500275482, .1909922167095499, -.004668327333101102, 0, .13548347102422797, .7131126062169096, .6878332937084056, 0, .13469984856318096, .6745312327912614, -.7258536813891331, 0, 0, 0, 0, 1),
            color: r.vec3.fromValues(.7806122448979592, .7985214493960848, 1),
            intensity: .96
        }, {
            type: "DIRECTION",
            enable: !0,
            attachedToCamera: !0,
            castShadows: !1,
            matrix: r.mat4.fromValues(.7755211495104662, -.0666602860002539, .6277924441503967, 0, .2690483737361956, .9344846523281437, -.233133882464682, 0, -.5711216326246741, .3497067926613838, .7426474533145686, 0, 0, 0, 0, 1),
            color: r.vec3.fromValues(1, .8783319450229073, .7091836734693877),
            intensity: 1
        }, {
            type: "HEMI",
            enable: !0,
            attachedToCamera: !1,
            castShadows: !1,
            matrix: r.mat4.fromValues(.6903299131022926, -.7076363669144057, -.15064986988498263, 0, -.011089698239978026, .19785137301620165, -.9801692980238416, 0, .7234097246160907, .6783108479272498, .12873524736872857, 0, 0, 0, 0, 1),
            color: r.vec3.fromValues(.423469387755102, .7352665556018328, 1),
            intensity: .12,
            ground: r.vec3.fromValues(.9642857142857143, .6484128636877489, .2607507288629738),
            intensityGround: .06
        }]
    }, a.TwoHeadLightV1 = function () {
        return [{
            type: "DIRECTION",
            enable: !0,
            attachedToCamera: !0,
            castShadows: !1,
            matrix: r.mat4.fromValues(Math.SQRT1_2, 0, Math.SQRT1_2, 0, -0, 1, 0, 0, -Math.SQRT1_2, -0, Math.SQRT1_2, 0, 0, 0, 0, 1),
            color: r.vec3.fromValues(.6, .48, .3),
            intensity: 1
        }, {
            enable: !0,
            attachedToCamera: !0,
            castShadows: !1,
            type: "DIRECTION",
            matrix: r.mat4.fromValues(Math.SQRT1_2, 0, -Math.SQRT1_2, 0, 0, 1, 0, 0, Math.SQRT1_2, 0, Math.SQRT1_2, 0, 0, 0, 0, 1),
            color: r.vec3.fromValues(.42, .42, .6),
            intensity: 1
        }, {
            type: "NONE",
            enable: !0
        }]
    }, a.LightFromAbove = function () {
        return [{
            type: "DIRECTION",
            enable: !0,
            attachedToCamera: !1,
            castShadows: !0,
            matrix: r.mat4.fromValues(.9997395789367833, .0037284998571004493, -.02251383121813605, 0, -.003172416108909601, .9996902441347245, .024685047253076783, 0, .02259889562202194, -.024607195505995896, .9994417320914686, 0, 0, 0, 0, 1),
            color: r.vec3.fromValues(1, 1, 1),
            intensity: .01
        }, {
            type: "NONE",
            enable: !0
        }, {
            type: "NONE",
            enable: !0
        }]
    }, t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(47),
        a = i(8),
        o = i(69),
        s = i(44),
        u = i(85),
        l = i(711),
        c = i(20),
        h = n.a.osg,
        d = a.a.extend({
            initialize: function (e) {
                a.a.prototype.initialize.apply(this, arguments), this.model.bind("change:select", this.onSelectChanged, this), this.model.bind("change:enable", this.onEnableChanged, this), this.model.bind("change", s.a.draw), this._viewer = e.context.getViewer(), this._viewerOSGJS = this._viewer.getViewerOSGJS(), this._manipulator = this._viewerOSGJS.getManipulator(), this._isScreenshot = !1, this._nodeFeature = new h.Node, this._nodeFeature.setName("Feature - Lighting"), this._shadowNode = new n.a.osgShadow.ShadowedScene(Object(l.c)()), this._shadowNode.setName("Shadowed scene"), this._lightNode = new h.Camera, this._lightNode.setName("Lighting - Camera"), this._lightNode.setNearFarRatio(5e-5), this._lightNode.getOrCreateStateSet().setRenderBinDetails(u.a.EDITOR_GIZMO, "RenderBin"), this._lightNode.setNodeMask(o.a.NO_SHADOW), this.initLightNode(), this.onEnableChanged(), this._nodeFeature.addChild(this._lightNode), r.a.getMaterial().then(this.handleDirtyShadows.bind(this))
            },
            getNode: function () {
                return this._nodeFeature
            },
            getNodeLight: function () {
                return this._lightNode
            },
            getNodeShadow: function () {
                return this._shadowNode
            },
            isLightNone: function (e) {
                return -1 === e || "NONE" === this.model.get("lights")[e].get("type")
            },
            isTabLighting: function () {
                var e = this._viewer.getFeaturesManager();
                return e && "lighting" === e.getCurrentTabName()
            },
            handleDirtyShadows: function () {
                var e = this._viewer.getFeatures().material;
                if (e) {
                    var t = e.getModel().attributes,
                        i = this.model.get("lights"),
                        n = i.length;
                    for (var r in t)
                        for (var a = t[r], o = a.getChannels().Opacity, s = a.getChannels().Displacement, u = 0; u < n; ++u) {
                            var l = i[u];
                            o.bind("change", l.dirty, l), s.bind("change", l.dirty, l)
                        }
                }
            },
            onEnableChanged: function () {
                var e = this.model.get("enable");
                if (this._lightNode.setNodeMask(e ? o.a.NO_SHADOW : 0), !e) {
                    var t = this.getGizmo();
                    t && t.attachToNode(null)
                }
                for (var i = this.model.get("lights"), n = 0, r = i.length; n < r; ++n) {
                    var a = i[n],
                        s = e && a.get("enable");
                    a.getLightSource().getLight().setEnabled(s), Object(c.a)().shadowAtlas && !s && Object(l.d)(this._shadowNode, a.getShadowMap())
                }
                e && this._updateLightsAndIcons()
            },
            initLightNode: function () {
                this._nodeFeature.addUpdateCallback(this);
                for (var e = this.model.get("lights"), t = 0, i = e.length; t < i; ++t) {
                    var n = e[t];
                    n.setLightUnit(t), n.bind("change", n.dirty, n), n.bind("change:attachedToCamera", n.updateAttachedToCamera.bind(n, this._viewer.getCamera()), n), n.bind("change", s.a.draw), this._lightNode.addChild(n.getNode())
                }
            },
            getGizmo: function () {
                var e = this._viewer.getFeaturesManager();
                return e ? e.getNodeGizmo() : null
            },
            onSelectChanged: function () {
                var e = this.getGizmo();
                if (e) {
                    var t = this.model.get("select");
                    if (this.isLightNone(t)) return void e.attachToNode(null);
                    e.attachToNode(this.model.get("lights")[t].getNodeEditLight())
                }
            },
            updateSelection: function () {
                var e = this.getGizmo();
                if (e && !e._isEditing) {
                    var t = e._attachedNode;
                    if (!this.isLightNone(this.model.get("select")) || t)
                        for (var i = this.model.get("lights"), n = 0; n < 3; ++n)
                            if (i[n].getNodeEditLight() === t) {
                                e.updateGizmoMask(), this.model.set("select", n);
                                break
                            }
                }
            },
            updateLightIcons: function () {
                var e = h.vec4.create(),
                    t = h.vec3.create(),
                    i = h.vec3.create(),
                    n = h.quat.create();
                return function () {
                    var r = this.model.get("lights"),
                        a = this._viewer.getCamera(),
                        o = this._viewer.getFeaturesManager().getIconScaleFov();
                    this._manipulator.getEyePosition(i);
                    for (var s = this.getGizmo(), u = 0; u < 3; ++u) {
                        var l = r[u];
                        if ("NONE" !== l.get("type")) {
                            var c = l.getNodeEditLight(),
                                d = l.getNodeLight(),
                                f = l.getNodeQuad(),
                                p = l.getNodeScale(),
                                m = s._isEditing && s._attachedNode === c,
                                g = f.getMatrix(),
                                v = c.getMatrix(),
                                _ = d.getMatrix();
                            l.isAttachedToCamera() ? m ? (h.mat4.getTranslation(t, v), h.mat4.multiply(_, a.getViewMatrix(), v), h.mat4.setTranslation(_, t)) : (h.mat4.getTranslation(t, _), h.mat4.invert(v, a.getViewMatrix()), h.mat4.multiply(v, v, _), h.mat4.setTranslation(v, t)) : m ? h.mat4.copy(_, v) : h.mat4.copy(v, _), h.mat4.copy(l.get("matrix"), _), c.getWorldMatrix(void 0, g), h.mat4.getTranslation(t, g);
                            var b = h.vec3.dist(i, t) / o;
                            h.mat4.fromScaling(p.getMatrix(), h.vec3.set(e, b, b, b)), h.mat4.multiply(g, a.getViewMatrix(), g), h.mat4.invert(g, g), h.mat4.fromQuat(g, h.mat4.getRotation(n, g)), f.dirtyBound(), d.dirtyBound(), p.dirtyBound()
                        }
                    }
                }
            }(),
            setIsScreenshot: function (e) {
                this._isScreenshot = e
            },
            _updateLightsAndIcons: function () {
                if (this._lightNode.getNodeMask() && this._shadowNode.getChildren().length) {
                    for (var e = this._viewer.getFeatures().shadingStyle, t = this._viewer.getFeatures().ARKit, i = t.getModel().get("enable") || "lit" === e.getModel().get("type"), n = !this._isScreenshot && i && this.isTabLighting(), r = this._viewer.getFeaturesManager().getShadowForcedUpdate(), a = this.model.get("webVR"), o = this.model.get("lights"), s = 0; s < 3; ++s) {
                        var u = o[s],
                            c = r || u.isDirty();
                        u.updateNode();
                        var d = u.getShadowMap();
                        if (d) {
                            var f = a && u.isAttachedToCamera();
                            if (!f && i && u.get("enable") && u.isCastingShadows()) {
                                if (!(c = c || u.isAttachedToCamera() || r)) {
                                    for (var p = u.get("matrix"), m = u.get("matrixPrev"), g = 0; g < 16; g++)
                                        if (p[g] !== m[g]) {
                                            c = !0;
                                            break
                                        } h.mat4.copy(m, p)
                                }
                                c && d.requestRedraw(), Object(l.a)(this._shadowNode, d)
                            } else(c || f) && Object(l.d)(this._shadowNode, d);
                            u.setIconVisibility(n)
                        }
                    }
                    n && (this.updateLightIcons(), this.updateSelection())
                }
            },
            update: function (e, t) {
                return e.getNumChildrenRequiringUpdateTraversal() > 0 && t.traverse(e), this._updateLightsAndIcons(), !1
            }
        });
    t.a = d
}, function (e, t, i) {
    "use strict";
    var n = i(90),
        r = i(1352),
        a = i(1353),
        o = i(179),
        s = {
            FeatureName: "postProcess",
            ModelType: r.a,
            ViewListType: [a.a]
        },
        u = n.a.create(s);
    u.prototype.getNodeIn = function () {
        return this._views[0]._nodeIn
    }, u.prototype.getNodeOut = function () {
        return this._views[0]._nodeOut
    }, u.prototype.getCamera = function () {
        return this._views[0]._camera
    }, u.prototype.getCurrentComposer = function () {
        return this._views[0]._nodeIn._composer
    }, u.prototype.prepareForScreenShot = function () {
        o.a.uSSAARestart.setFloat(1), this._views[0].hideDofCross()
    }, u.prototype.resetAfterScreenShot = function () {
        o.a.uSSAARestart.setFloat(0)
    }, t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(149),
        r = i(9),
        a = i(47),
        o = i(20),
        s = i(101),
        u = i(103),
        l = i(38),
        c = i.n(l),
        h = i(179),
        d = i(119),
        f = r.a.osg,
        p = n.a.extend({
            initialize: function () {
                n.a.prototype.initialize.apply(this, arguments), this._sssSchema = this.getSubSchema("scene.sssProfiles"), this.set("sssProfiles", this.getInstance(this._sssSchema))
            },
            getModelOptionPath: function () {
                return "scene.postProcess"
            },
            defaults: {
                postProcessReady: !1,
                rgbmDefault: 7,
                rgbmBloom: 1,
                sssCurrentProfile: 0,
                webVR: !1,
                AR: !1,
                veilFactor: 1,
                doDistortionVR: !1,
                distortion: f.vec2.fromValues(.441, .156),
                projectionLeft: f.vec4.fromValues(1, 1, -.5, -.5),
                unprojectionLeft: f.vec4.fromValues(1, 1, -.5, -.5),
                vrFadeLength: Object(o.a)().vrFade / 1e3 / 2,
                vrStartFade: !1,
                vrFadeStartTime: 0,
                vrFadeCallback: void 0,
                vrFading: !1
            },
            getName: function () {
                return "PostProcess"
            },
            getViewer: function () {
                return this._viewer
            },
            useSSSLookupFloat: function () {
                return f.WebGLCaps.instance().getWebGLExtension("OES_texture_float_linear")
            },
            getSSSWeightRange: function () {
                return 2 * Object(o.a)().sssHalfKernel - 1 > 20 ? 3 : 2
            },
            setQuality: function (e) {
                void 0 !== Object(o.a)().quality && (e = Object(o.a)().quality), h.a.uQuality.setFloat(e)
            },
            getQuality: function () {
                return h.a.uQuality.getInternalArray()[0]
            },
            _getBoundRadius: function () {
                return u.a.getModelBoxWithDisplacement().radius()
            },
            getMinimumSsaoRadius: function () {
                return .01 * this._getBoundRadius()
            },
            getMaximumSsaoRadius: function () {
                return .1 * this._getBoundRadius()
            },
            getMinimumSsaoBias: function () {
                return .002 * this._getBoundRadius()
            },
            getMaximumSsaoBias: function () {
                return .01 * this._getBoundRadius()
            },
            _makeValidOption: function (e, t, i, n) {
                var r = this.get(e);
                r < t * u.a.BIAS_MIN || r > i * u.a.BIAS_MAX ? this.set(e, n) : this.set(e, Math.min(Math.max(r, t), i))
            },
            _makeValidSsaoRadius: function () {
                this._makeValidOption("ssaoRadius", this.getMinimumSsaoRadius(), this.getMaximumSsaoRadius(), .025 * this._getBoundRadius())
            },
            _makeValidSsaoBias: function () {
                this._makeValidOption("ssaoBias", this.getMinimumSsaoBias(), this.getMaximumSsaoBias(), .005 * this._getBoundRadius())
            },
            _isEffectivePP: function () {
                return this.get("enable")
            },
            isEffectiveGrain: function () {
                return this._isEffectivePP() && !this.get("webVR") && this.get("grainEnable") && this.get("grainFactor") >= 5e-4
            },
            isEffectiveSharpen: function () {
                return this._isEffectivePP() && !this.get("webVR") && this.get("sharpenEnable") && this.get("sharpenFactor") >= 5e-4
            },
            isEffectiveChromaticAberration: function () {
                return this._isEffectivePP() && !this.get("webVR") && this.get("chromaticAberrationEnable") && this.get("chromaticAberrationFactor") >= .001
            },
            isEffectiveVignette: function () {
                return this._isEffectivePP() && !this.get("webVR") && this.get("vignetteEnable") && this.get("vignetteHardness") - this.get("vignetteAmount") <= .5 * Math.sqrt(2)
            },
            isEffectiveBloom: function () {
                return this._isEffectivePP() && (!this.get("webVR") || !c.a.any) && this.get("bloomEnable") && this.get("bloomFactor") >= .01
            },
            isEffectiveToneMapping: function () {
                return this._isEffectivePP() && this.get("toneMappingEnable")
            },
            isEffectiveColorBalance: function () {
                return this._isEffectivePP() && this.get("colorBalanceEnable")
            },
            isEffectiveDof: function () {
                return this._isEffectivePP() && !this.get("webVR") && this.get("dofEnable") && (this.get("dofBlurNear") >= .01 || this.get("dofBlurFar") >= .01)
            },
            isEffectiveSsao: function () {
                return this._isEffectivePP() && !this.get("webVR") && this.get("ssaoEnable") && this.get("ssaoIntensity") >= .01
            },
            isEffectiveSsr: function () {
                return this._isEffectivePP() && d.a.get("mask") & d.a.LIT && !this.get("webVR") && this.get("ssrEnable") && this.get("ssrFactor") > .01
            },
            hasAtLeastOneEffectiveEffect: function () {
                return !!this.isEffectiveSsr() || (!!this.isEffectiveGrain() || (!!this.isEffectiveSharpen() || (!!this.isEffectiveChromaticAberration() || (!!this.isEffectiveVignette() || (!!this.isEffectiveBloom() || (!!this.isEffectiveToneMapping() || (!!this.isEffectiveColorBalance() || (!!this.isEffectiveDof() || !!this.isEffectiveSsao()))))))))
            },
            initAfterFirstFrame: function () {
                this._makeValidSsaoRadius(), this._makeValidSsaoBias(), this.trigger("uiReady"), this.set("postProcessReady", !0)
            },
            init: function (e) {
                this._viewer = e.getViewer();
                var t = e.getModel().get("options");
                if (t.scene && t.scene.sssProfiles && this.setProfilesJSON(t.scene.sssProfiles), t.scene && t.scene.postProcess) {
                    var i = t.scene.postProcess;
                    this.setJSON(i), void 0 !== Object(o.a)().postProcess && this.set("enable", Object(o.a)().postProcess), void 0 !== Object(o.a)().ssr && this.set("ssrEnable", Object(o.a)().ssr);
                    var n = i.taa,
                        r = Object(o.a)().taa;
                    if (n) {
                        this.set("taaEnable", void 0 !== r ? r : n.enable);
                        var l = Object(o.a)().taaTransparent;
                        this.set("taaTransparent", void 0 !== l ? l : n.transparent), void 0 === r && u.a.getBoxReady().then(function () {
                            u.a.getMaxDistanceFromOrigin() > 1e6 && this.set("taaEnable", !1)
                        }.bind(this))
                    } else void 0 !== r && this.set("taaEnable", r)
                }
                Object(s.a)() && a.a.getMaterial().then(function () {
                    "Tilt Brush" === this._viewer.getRootUserData().authoringTool ? (this.set("bloomEnable", !0), this.set("bloomThreshold", .6), this.set("bloomFactor", 1.6), this.set("bloomRadius", .2), this.set("toneMappingEnable", !0), this.set("toneMappingMethod", "filmic")) : "minecraft" !== this._viewer.getRootUserData().source && "mineways" !== this._viewer.getRootUserData().source || (this.set("ssaoEnable", !0), this.set("ssaoRadius", .05), this.set("ssaoIntensity", 1), this.set("ssaoBias", .006))
                }.bind(this))
            },
            fadeForTeleportVR: function (e) {
                this.set("vrStartFade", !0), this.set("vrFadeCallback", e)
            },
            setProfilesJSON: function (e, t) {
                if (t && t.validate) {
                    var i = this.validate(e, {
                        schema: this._sssSchema
                    });
                    if (i.length) return console.error("Failed to validate sss profile json", e, i), i.join("\n")
                }
                return this.set("sssProfiles", e), []
            },
            getProfilesJSON: function () {
                return this.get("sssProfiles")
            },
            editorGetJSON: function () {
                return this.getJSON()
            },
            editorSetJSON: function (e) {
                return this.setJSON(e, {
                    validate: !0
                })
            }
        });
    t.a = p
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(8),
        a = i(44),
        o = i(1354),
        s = i(1394),
        u = i(636),
        l = i(179),
        c = i(119),
        h = n.a.osg,
        d = r.a.extend({
            initialize: function () {
                r.a.prototype.initialize.apply(this, arguments);
                var e = this.model;
                e.bind("change:webVR", this.dirty, this), e.bind("change:distortVR", this.dirty, this), e.bind("change:enable", this.dirty, this), e.bind("change:grainEnable", this.checkGrainEnable, this), e.bind("change:sharpenEnable", this.checkSharpenEnable, this), e.bind("change:chromaticAberrationEnable", this.checkChromaticAberrationEnable, this), e.bind("change:vignetteEnable", this.checkVignetteEnable, this), e.bind("change:bloomEnable", this.checkBloomEnable, this), e.bind("change:dofEnable", this.checkDofEnable, this), e.bind("change:toneMappingEnable", this.dirty, this), e.bind("change:colorBalanceEnable", this.dirty, this), e.bind("change:ssaoEnable", this.checkSsaoEnable, this), e.bind("change:ssrEnable", this.checkSsrEnable, this), c.a.bind("change:mask", this.checkSsrEnable, this), e.bind("change:taaEnable", this.checkTaaEnable, this), e.bind("change:taaTransparent", this.checkTaaTransparentEnable, this), e.bind("change:distortion", this.onDistortionChanged, this), e.bind("change:projectionLeft", this.onProjectionLeftChanged, this), e.bind("change:unprojectionLeft", this.onUnprojectionLeftChanged, this), e.bind("change:grainFactor", this.onGrainFactor, this), e.bind("change:sharpenFactor", this.onSharpenFactor, this), e.bind("change:chromaticAberrationFactor", this.onChromaticAberrationFactor, this), e.bind("change:vignetteAmount", this.onVignetteLensChanged, this), e.bind("change:vignetteHardness", this.onVignetteLensChanged, this), e.bind("change:bloomFactor", this.onBloomFactorChanged, this), e.bind("change:bloomThreshold", this.onBloomThresholdChanged, this), e.bind("change:bloomRadius", this.onBloomRadiusChanged, this), e.bind("change:toneMappingExposure", this.onToneMappingExposureChanged, this), e.bind("change:toneMappingBrightness", this.onToneMappingBrightnessChanged, this), e.bind("change:toneMappingContrast", this.onToneMappingContrastChanged, this), e.bind("change:toneMappingSaturation", this.onToneMappingSaturationChanged, this), e.bind("change:toneMappingMethod", this.onToneMappingMethodChanged, this), e.bind("change:colorBalanceLow", this.onColorBalanceShiftChanged, this), e.bind("change:colorBalanceMid", this.onColorBalanceShiftChanged, this), e.bind("change:colorBalanceHigh", this.onColorBalanceShiftChanged, this), e.bind("change:dofFocusPoint", this.onDofFocusPoint, this), e.bind("change:dofBlurNear", this.onDofBlurNear, this), e.bind("change:dofBlurFar", this.onDofBlurFar, this), e.bind("change:ssaoIntensity", this.onSsaoIntensity, this), e.bind("change:ssaoRadius", this.onSsaoRadius, this), e.bind("change:ssaoBias", this.onSsaoBias, this), e.bind("change:ssrFactor", this.onSsrFactor, this), e.bind("change", a.a.draw), this._effectiveConfig = {}, this._viewer = this.model._viewer, this._viewerOSGJS = this._viewer.getViewerOSGJS(), this._sssTexKernel = new h.Texture, this._sssTexKernel.divisor = -1, this._camera = this._createMainCamera(), this._nodeIn = new o.a(this), this._nodeOut = this._createNodeOut(), this._nodeIn.addChild(this._camera), this._camera.addChild(this._nodeOut), this._callbackPostProcess = new s.a(this), this._nodeIn.setCullCallback(this._callbackPostProcess), this._initUniforms()
            },
            dirty: function () {
                this._callbackPostProcess.dirty()
            },
            _initUniforms: function () {
                var e = this.model.attributes;
                for (var t in e) this.model.trigger("change:" + t)
            },
            _createNodeOut: function () {
                var e = new h.Node;
                return e.setName("PostProcess - node Out"), e
            },
            _createMainCamera: function () {
                var e = new h.Camera,
                    t = this._viewerOSGJS.getCanvasWidth(),
                    i = this._viewerOSGJS.getCanvasHeight();
                return e.setViewport(new h.Viewport(0, 0, t, i)), e.setName("PostProcess - MainCamera"), e.setRenderOrder(h.Camera.PRE_RENDER, 0), e.attachRenderBuffer(h.FrameBufferObject.DEPTH_ATTACHMENT, h.FrameBufferObject.DEPTH_COMPONENT16), e
            },
            methodToInt: function (e) {
                return "reinhard" === e ? 1 : "filmic" === e ? 2 : 0
            },
            checkGrainEnable: function () {
                this._effectiveConfig.useGrain !== this.model.isEffectiveGrain() && this.dirty()
            },
            checkSharpenEnable: function () {
                this._effectiveConfig.useSharpen !== this.model.isEffectiveSharpen() && this.dirty()
            },
            checkChromaticAberrationEnable: function () {
                this._effectiveConfig.useChromaticAberration !== this.model.isEffectiveChromaticAberration() && this.dirty()
            },
            checkVignetteEnable: function () {
                this._effectiveConfig.useVignette !== this.model.isEffectiveVignette() && this.dirty()
            },
            checkBloomEnable: function () {
                this._effectiveConfig.useBloom !== this.model.isEffectiveBloom() && this.dirty()
            },
            checkDofEnable: function () {
                this._effectiveConfig.useDof !== this.model.isEffectiveDof() && this.dirty()
            },
            checkSsaoEnable: function () {
                this._effectiveConfig.useSsao !== this.model.isEffectiveSsao() && this.dirty()
            },
            checkSsrEnable: function () {
                this._effectiveConfig.useSsr !== this.model.isEffectiveSsr() && this.dirty()
            },
            checkTaaEnable: function () {
                this._effectiveConfig.useTaa !== this.model.get("taaEnable") && this.dirty()
            },
            checkTaaTransparentEnable: function () {
                this._effectiveConfig.useTaaTransparent !== (this.model.get("taaEnable") && this.model.get("taaTransparent")) && this.dirty()
            },
            onDistortionChanged: function () {
                u.a.uDistortion.setFloat2(this.model.get("distortion"))
            },
            onProjectionLeftChanged: function () {
                u.a.uProjectionLeft.setFloat4(this.model.get("projectionLeft"))
            },
            onUnprojectionLeftChanged: function () {
                u.a.uUnprojectionLeft.setFloat4(this.model.get("unprojectionLeft"))
            },
            onGrainFactor: function () {
                u.a.uGrainFactor.setFloat(this.model.get("grainFactor")), this.checkGrainEnable()
            },
            onSharpenFactor: function () {
                u.a.uSharpFactor.setFloat(this.model.get("sharpenFactor")), this.checkSharpenEnable()
            },
            onChromaticAberrationFactor: function () {
                u.a.uChromaFactor.setFloat(this.model.get("chromaticAberrationFactor")), this.checkChromaticAberrationEnable()
            },
            onVignetteLensChanged: function () {
                var e = u.a.uLensRadius.getInternalArray(),
                    t = this.model.get("vignetteAmount"),
                    i = this.model.get("vignetteHardness");
                e[0] = 2 - t - i, e[1] = i - t, this.checkVignetteEnable()
            },
            onBloomFactorChanged: function () {
                u.a.uBloomFactor.setFloat(this.model.get("bloomFactor")), this.checkBloomEnable()
            },
            onBloomThresholdChanged: function () {
                u.a.uBloomThreshold.setFloat(this.model.get("bloomThreshold")), this.checkBloomEnable()
            },
            onBloomRadiusChanged: function () {
                u.a.uBloomRadius.setFloat(this.model.get("bloomRadius")), this.checkBloomEnable()
            },
            onColorBalanceShiftChanged: function () {
                u.a.uColorBalanceLow.setFloat3(this.model.get("colorBalanceLow")), u.a.uColorBalanceMid.setFloat3(this.model.get("colorBalanceMid")), u.a.uColorBalanceHigh.setFloat3(this.model.get("colorBalanceHigh"))
            },
            onToneMappingExposureChanged: function () {
                u.a.uToneExposure.setFloat(this.model.get("toneMappingExposure"))
            },
            onToneMappingBrightnessChanged: function () {
                u.a.uToneBrightness.setFloat(this.model.get("toneMappingBrightness"))
            },
            onToneMappingContrastChanged: function () {
                u.a.uToneContrast.setFloat(this.model.get("toneMappingContrast"))
            },
            onToneMappingSaturationChanged: function () {
                u.a.uToneSaturation.setFloat(this.model.get("toneMappingSaturation"))
            },
            onToneMappingMethodChanged: function () {
                u.a.uToneMethod.setInt(this.methodToInt(this.model.get("toneMappingMethod")))
            },
            onDofFocusPoint: function () {
                this._callbackPostProcess.updateDofFocusPoint()
            },
            onDofBlurNear: function () {
                this._callbackPostProcess.updateTargetDofBlurNear(), this.checkDofEnable()
            },
            onDofBlurFar: function () {
                this._callbackPostProcess.updateTargetDofBlurFar(), this.checkDofEnable()
            },
            hideDofCross: function () {
                this._callbackPostProcess.hideDofCross()
            },
            onSsaoRadius: function () {
                u.a.uSsaoRadius.setFloat(this.model.get("ssaoRadius")), this.checkSsaoEnable()
            },
            onSsaoIntensity: function () {
                u.a.uSsaoIntensity.setFloat(this.model.get("ssaoIntensity")), this.checkSsaoEnable()
            },
            onSsaoBias: function () {
                u.a.uSsaoBias.setFloat(this.model.get("ssaoBias"))
            },
            onSsrFactor: function () {
                l.a.uSsrFactor.setFloat(this.model.get("ssrFactor")), this.checkSsrEnable()
            }
        });
    t.a = d
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(20),
        a = i(69),
        o = i(321),
        s = i(635),
        u = i(79),
        l = i(639),
        c = i(229),
        h = i(38),
        d = i.n(h),
        f = i(47),
        p = i(583),
        m = i(928),
        g = i(1355),
        v = i(119),
        _ = i(636),
        b = i(179),
        S = i(1356),
        x = i.n(S),
        y = i(1357),
        C = i.n(y),
        T = i(1358),
        w = i.n(T),
        M = i(1359),
        E = i.n(M),
        A = i(1360),
        P = i.n(A),
        R = i(1361),
        O = i.n(R),
        I = i(1362),
        F = i.n(I),
        N = i(1363),
        D = i.n(N),
        L = i(1364),
        k = i.n(L),
        V = i(1365),
        B = i.n(V),
        U = i(1366),
        G = i.n(U),
        j = i(1367),
        z = i.n(j),
        H = i(1368),
        W = i.n(H),
        q = i(1369),
        X = i.n(q),
        Y = i(1370),
        K = i.n(Y),
        $ = i(1371),
        Q = i.n($),
        J = i(1372),
        Z = i.n(J),
        ee = i(1373),
        te = i.n(ee),
        ie = i(1374),
        ne = i.n(ie),
        re = i(1375),
        ae = i.n(re),
        oe = i(1376),
        se = i.n(oe),
        ue = i(1377),
        le = i.n(ue),
        ce = i(1378),
        he = i.n(ce),
        de = i(1379),
        fe = i.n(de),
        pe = i(1380),
        me = i.n(pe),
        ge = i(1381),
        ve = i.n(ge),
        _e = i(1382),
        be = i.n(_e),
        Se = i(1383),
        xe = i.n(Se),
        ye = i(1384),
        Ce = i.n(ye),
        Te = i(1385),
        we = i.n(Te),
        Me = i(1386),
        Ee = i.n(Me),
        Ae = i(1387),
        Pe = i.n(Ae),
        Re = i(1388),
        Oe = i.n(Re),
        Ie = i(1389),
        Fe = i.n(Ie),
        Ne = i(1390),
        De = i.n(Ne),
        Le = i(1391),
        ke = i.n(Le),
        Ve = i(1392),
        Be = i.n(Ve),
        Ue = i(1393),
        Ge = i.n(Ue),
        je = n.a.osg,
        ze = n.a.osgUtil,
        He = n.a.osgShader.shaderProcessor,
        We = function (e) {
            je.Node.call(this), this.setName("PostProcess - node In"), this._view3d = e, this._camera = e._camera, this._effectiveConfig = e._effectiveConfig, this._viewer = e._viewer, this._viewerOSGJS = e._viewerOSGJS, this._model = e.model, this._hasTriangles = this._viewer.getOrCreateScene().getJSON().faceCount > 0, s.a.setHasTriangles(this._hasTriangles), this._viewer.getCamera().getRenderer().setRenderStage(new s.a), this._model.on("pingPongTexture0", this.onPingPongTexture0, this), f.a.getMaterial().then(function () {
                var e = this.getBackgroundModel();
                e.bind("backgroundUpdated", this.onBackgroundUpdated, this), e.bind("change:color", this.onBackgroundColor, this)
            }.bind(this)), this._composer = void 0, this._addShaders()
        };
    je.createPrototypeNode(We, je.objectInherit(je.Node.prototype, {
        _addShaders: function () {
            var e = {
                "passThrough.glsl": x.a,
                "setDepthAlpha.glsl": C.a,
                "combineOpacity.glsl": w.a,
                "combineRefraction.glsl": E.a,
                "packMipmapRefraction.glsl": P.a,
                "sssCommon.glsl": O.a,
                "sssExtract.glsl": F.a,
                "sssBlur.glsl": D.a,
                "sssCombine.glsl": k.a,
                "packMipmapDepth.glsl": B.a,
                "depthMipmap.glsl": G.a,
                "ssaoExtract.glsl": z.a,
                "ssaoBlur.glsl": W.a,
                "dofCommon.glsl": X.a,
                "dofCoC.glsl": K.a,
                "dofNearDilate.glsl": Q.a,
                "dofDownsampleColor.glsl": Z.a,
                "dofBlurCircular.glsl": te.a,
                "dofCombine.glsl": ne.a,
                "bloomExtract.glsl": ae.a,
                "bloomCombine.glsl": se.a,
                "chromaticAberration.glsl": le.a,
                "vignette.glsl": he.a,
                "toneMapping.glsl": fe.a,
                "colorBalance.glsl": me.a,
                "supersample.glsl": ve.a,
                "supersampleTaa.glsl": be.a,
                "composeExtra.glsl": xe.a,
                "composeFixedBackground.glsl": Ce.a,
                "fxaa.glsl": we.a,
                "grain.glsl": Ee.a,
                "sharpen.glsl": Pe.a,
                "dofCross.glsl": Oe.a,
                "distortion.glsl": Fe.a,
                "fadeVr.glsl": De.a,
                "veilVr.glsl": ke.a,
                "outline.glsl": Be.a,
                "finalPremultAlpha.glsl": Ge.a
            };
            He.addShaders(e)
        },
        getNodeBackground: function () {
            return this._viewer.getFeatures().environment.getNode().getBackground()
        },
        getBackgroundModel: function () {
            return this._viewer.getFeatures().background.getModel()
        },
        getBackgroundType: function () {
            return this.getBackgroundModel().getEnableType()
        },
        onPingPongTexture0: function (e) {
            this._composer && this._composer.swapFeedbackLoopTextures(e)
        },
        _replaceTexture: function (e, t, i) {
            var n = this._composer.getStateSetPass(t);
            if (n) {
                var r = n.getUniform(i);
                r && n.setTextureAttributeAndModes(r.getInternalArray()[0], e)
            }
        },
        onBackgroundUpdated: function (e) {
            void 0 !== this._composer && "fixed" === this._effectiveConfig.bgType && (this._replaceTexture(e, "composeFixedBackground", "TextureFixed"), this._replaceTexture(e, "composeFixedBackgroundRefraction", "TextureFixed"))
        },
        onBackgroundColor: function () {
            var e = s.a.getClearColor();
            if ("color" !== this.getBackgroundType()) return void je.vec4.set(e, 0, 0, 0, 0);
            je.vec3.copy(e, this.getBackgroundModel().getColor()), e[3] = 1, 1 === b.a.uOutputLinear.getInternalArray()[0] && l.a.srgbToLinear(e, e);
            var t = b.a.uRGBMRange.getInternalArray()[0];
            t > 0 && l.a.encodeRGBM(e, t, e)
        },
        _getSupportedFloatTexture: function () {
            var e = je.WebGLCaps.instance();
            return 0 === Object(r.a)().floatRtt ? je.Texture.UNSIGNED_BYTE : e.hasLinearHalfFloatRTT() ? je.Texture.HALF_FLOAT : e.hasHalfFloatRTT() ? je.Texture.HALF_FLOAT : d.a.any && this._model.get("webVR") && 2 === Object(r.a)().floatRtt ? je.Texture.UNSIGNED_BYTE : e.hasLinearFloatRTT() ? je.Texture.FLOAT : e.hasFloatRTT() ? je.Texture.FLOAT : je.Texture.UNSIGNED_BYTE
        },
        _updateEffectiveConfig: function () {
            var e = this._effectiveConfig,
                t = o.a.get("hasTransparency"),
                i = o.a.get("hasExtra"),
                n = o.a.get("hasRefraction"),
                a = o.a.get("hasScattering");
            e.webVR = this._model.get("webVR"), e.AR = this._model.get("AR");
            var s = this._model.get("doDistortionVR") && Object(r.a)().vrStereo;
            e.useDistortionVR = e.webVR && s, e.useSss = a, e.useSsao = this._model.isEffectiveSsao(), e.useDof = this._model.isEffectiveDof(), e.useBloom = this._model.isEffectiveBloom(), e.useChromaticAberration = this._model.isEffectiveChromaticAberration(), e.useToneMapping = this._model.isEffectiveToneMapping(), e.useColorBalance = this._model.isEffectiveColorBalance(), e.bgType = this.getBackgroundType(), e.hasBG = "none" !== e.bgType, e.useTaa = !e.AR && this._model.get("taaEnable"), e.useTaaTransparent = e.useTaa && this._model.get("taaTransparent");
            var l = Object(r.a)().fxaa;
            return e.useFxaa = void 0 === l ? this._hasTriangles : l, e.useGrain = this._model.isEffectiveGrain(), e.useSharpen = this._model.isEffectiveSharpen(), e.useVignette = this._model.isEffectiveVignette(), e.useTransparency = t || e.webVR || Object(u.a)(), e.useSsr = this._model.isEffectiveSsr(), e.useRefraction = n, e.useDepth = this._needDepthTexture(), e.useExtra = i || e.webVR || e.AR, v.a.set("hasSsr", e.useSsr), this._effectiveConfig
        },
        _needDepthTexture: function () {
            if (Object(u.a)()) return !0;
            var e = this._effectiveConfig;
            if (e.useRefraction || e.useSsr || e.useDof || e.useBloom || e.useSharpen || e.useSsao || e.useSss || e.useTaa || !e.useFxaa) return !0;
            if (this._viewer.getFeatures().hotspot.getModel().get("hotspots").length > 0) return !0;
            var t = this.getBackgroundType();
            return "none" === t || "fixed" === t || this._model.get("webVR")
        },
        _addInternalTextures: function (e, t, i) {
            e.addInternalTexture({
                name: "TextureOpaque",
                immuable: !0,
                srgb: i,
                rgbm: !i
            }), e.setInputTexture("TextureOpaque"), (t.useRefraction || t.useSsr) && e.addInternalTexture({
                name: "TextureToBeRefracted",
                divisor: Object(r.a)().refractionRes,
                immuable: !0,
                reusable: !1,
                srgb: !1,
                rgbm: !0
            }), t.useRefraction && e.addInternalTexture({
                name: "TextureRefraction",
                immuable: !0,
                srgb: !1,
                rgbm: !0
            }), (t.useSsr || t.useSsao) && e.addInternalTexture({
                name: "TextureMipmapDepth",
                immuable: !0,
                reusable: !1,
                srgb: !1,
                rgbm: !1
            }), t.useDepth && e.addInternalTexture({
                name: "TextureDepth",
                filter: "nearest",
                immuable: !0,
                srgb: !1,
                rgbm: !1
            }), t.useTransparency && e.addInternalTexture({
                name: "TextureTransparent",
                filter: "nearest",
                immuable: !0,
                type: this._getSupportedFloatTexture(),
                rgbm: !1,
                srgb: !1
            }), t.useExtra && e.addInternalTexture({
                name: "TextureExtra",
                filter: "nearest",
                immuable: !0,
                srgb: !t.webVR,
                rgbm: !1
            })
        },
        _addSss: function (e, t) {
            var i = this._getSupportedFloatTexture();
            t.addExternalTexture("TextureSSSKernel", this._view3d._sssTexKernel), e.push({
                func: "sssExtract",
                textures: [{
                    name: "%last",
                    uniformName: "TextureSSSColor"
                }, "TextureDepth"],
                out: {
                    name: "TextureSSSExtract",
                    rgbm: !1,
                    divisor: 2,
                    type: i,
                    filter: "linear"
                }
            });
            var n = [];
            n.push("#define SSS_HALF_KERNEL_SIZE " + Object(r.a)().sssHalfKernel), n.push("#define SSS_PROFILE_COUNT " + this._model.get("sssProfiles").length), n.push("#define SSS_JITTER " + Object(r.a)().sssJitter.toExponential());
            var a = this._model.useSSSLookupFloat(),
                o = a ? "1.0" : this._model.getSSSWeightRange().toExponential();
            n.push("#define SSS_BYTE_RANGE " + o);
            var s = je.Uniform.createFloat2(je.vec2.fromValues(0, 1), "uBlurDir");
            e.push({
                func: "sssBlur",
                header: n,
                textures: [{
                    name: "TextureSSSExtract",
                    uniformName: "TextureSSSBlur"
                }, "TextureDepth", "TextureSSSKernel"],
                uniforms: s,
                out: {
                    name: "TextureSSSBlur1",
                    divisor: 2,
                    type: i,
                    rgbm: !1,
                    filter: "linear"
                }
            });
            var u = je.Uniform.createFloat2(je.vec2.fromValues(1, 0), "uBlurDir");
            e.push({
                func: "sssBlur",
                header: n,
                textures: [{
                    name: "TextureSSSBlur1",
                    uniformName: "TextureSSSBlur"
                }, "TextureDepth", "TextureSSSKernel"],
                uniforms: u,
                out: {
                    name: "TextureSSSBlur2",
                    divisor: 2,
                    rgbm: !0,
                    filter: "linear"
                }
            }), e.push({
                func: "sssCombine",
                textures: [{
                    name: "TextureSSSBlur2",
                    uniformName: "TextureSSSBlur"
                }, {
                    name: "%last",
                    uniformName: "TextureSSSColor"
                }, "TextureDepth"],
                out: {
                    name: "%next"
                }
            })
        },
        _packMipmapDepth: function (e) {
            for (var t = je.Uniform.createInt(1, "uFirstDepth"), i = je.Uniform.createInt(0, "uFirstDepth"), n = 1; n <= 5; n++) {
                var r = 1 << n + 1,
                    a = 1 === n ? "TextureDepth" : "TextureDepth" + (n - 1),
                    o = "TextureDepth" + n;
                e.push({
                    func: "depthMipmap",
                    textures: [{
                        name: a,
                        uniformName: "TextureDepth"
                    }],
                    uniforms: 1 === n ? t : i,
                    out: {
                        name: o,
                        divisor: r,
                        filter: "linear"
                    }
                })
            }
            e.push({
                func: "packMipmapDepth",
                textures: [{
                    name: "TextureDepth",
                    uniformName: "TextureDepth0"
                }, "TextureDepth1", "TextureDepth2", "TextureDepth3", "TextureDepth4", "TextureDepth5"],
                out: {
                    name: "TextureMipmapDepth",
                    filter: "linear"
                }
            })
        },
        _addSsao: function (e) {
            var t = ["#extension GL_OES_standard_derivatives : enable"],
                i = [t];
            Object(r.a)().ssaoNormal && i.push("#define SSAO_NORMAL"), d.a.any && i.push("#define MOBILE"), e.push({
                func: "ssaoExtract",
                header: i,
                textures: "TextureMipmapDepth",
                out: {
                    name: "TextureSsaoExtract",
                    filter: "linear"
                }
            }), e.push({
                func: {
                    name: "ssaoBlurH",
                    file: "ssaoBlur.glsl"
                },
                header: "#define SSAO_BLUR_H",
                textures: {
                    name: "TextureSsaoExtract",
                    uniformName: "TextureBlurInput"
                },
                out: {
                    name: "TextureSsaoBlurH",
                    filter: "nearest"
                }
            }), e.push({
                func: {
                    name: "ssaoBlurV",
                    file: "ssaoBlur.glsl"
                },
                header: "#define SSAO_BLUR_V",
                textures: [{
                    name: "%last",
                    filter: "linear"
                }, {
                    name: "TextureSsaoBlurH",
                    uniformName: "TextureBlurInput"
                }],
                out: {
                    name: "%next"
                }
            })
        },
        _addCombineOpacity: function (e) {
            e.push({
                func: "combineOpacity",
                textures: [{
                    name: "%last",
                    filter: "nearest"
                }, "TextureTransparent"],
                out: {
                    name: "%next"
                },
                collapsible: !0
            })
        },
        _packMipmapColor: function (e, t, i) {
            var n = this._addFixedBackgroundRefraction(e, t, i),
                r = [3, 5, 7, 9, 11, 13, 15];
            return Object(g.a)(e, n, "TextureRefractionBlur", r, !0), e.push({
                func: "packMipmapRefraction",
                textures: [{
                    name: n,
                    uniformName: "TextureRefractionBlur0"
                }, "TextureRefractionBlur1", "TextureRefractionBlur2", "TextureRefractionBlur3", "TextureRefractionBlur4", "TextureRefractionBlur5", "TextureRefractionBlur6", "TextureRefractionBlur7"],
                out: {
                    name: "TextureToBeRefracted",
                    filter: "linear"
                }
            }), e.length
        },
        _addRefraction: function (e) {
            e.push({
                func: "combineRefraction",
                textures: ["%last", "TextureRefraction"],
                out: {
                    name: "%next"
                }
            })
        },
        _addDof: function (e) {
            var t = Object(r.a)().dofRes;
            e.push({
                func: "dofCoC",
                textures: "TextureDepth",
                out: {
                    name: "TextureDofCoC",
                    divisor: t,
                    filter: "nearest"
                }
            }), e.push({
                func: {
                    name: "dofNearDilateH",
                    file: "dofNearDilate.glsl"
                },
                textures: ["TextureDofCoC", "TextureDepth"],
                out: {
                    name: "TextureDofNearDilateH",
                    divisor: t,
                    filter: "linear"
                }
            }), e.push({
                func: {
                    name: "dofNearDilateV",
                    file: "dofNearDilate.glsl"
                },
                textures: [{
                    name: "TextureDofNearDilateH",
                    uniformName: "TextureDofCoC"
                }, "TextureDepth"],
                out: {
                    name: "TextureDofNearDilateV",
                    divisor: t,
                    filter: "nearest"
                }
            });
            var i = this._getSupportedFloatTexture() === je.Texture.HALF_FLOAT,
                n = i ? "#define COLOR_WITH_COC" : "",
                a = ["%last"];
            i && a.push({
                name: "TextureDofNearDilateV",
                uniformName: "TextureDofCoC"
            }), e.push({
                func: "dofDownsampleColor",
                header: n,
                textures: a,
                out: {
                    name: "TextureDofDownsampleColor",
                    divisor: t,
                    filter: "nearest",
                    type: i ? je.Texture.HALF_FLOAT : je.Texture.UNSIGNED_BYTE
                }
            });
            var o = [{
                name: "TextureDofDownsampleColor",
                uniformName: "TextureDofColor",
                rgbm: !i
            }];
            i || o.push({
                name: "TextureDofNearDilateV",
                uniformName: "TextureDofCoC"
            }), e.push({
                func: "dofBlurCircular",
                header: n,
                textures: o,
                out: {
                    name: "TextureDofBlurCircular",
                    divisor: t,
                    filter: "linear",
                    rgbm: !0
                }
            }), e.push({
                func: "dofCombine",
                textures: [{
                    name: "%last",
                    filter: "linear"
                }, "TextureDofBlurCircular", "TextureDofNearDilateV", "TextureDepth"],
                out: {
                    name: "%next"
                }
            })
        },
        _addBloom: function (e, t) {
            var i, n = ["%last"];
            t.hasBG && (i = "#define HAS_BACKGROUND", n.push("TextureDepth")), e.push({
                func: "bloomExtract",
                textures: n,
                header: i,
                out: {
                    name: "TextureBloomExtract",
                    filter: "linear"
                }
            });
            var r = [3, 5, 7, 9, 11];
            Object(g.a)(e, "TextureBloomExtract", "TextureBloomBlur", r), e.push({
                func: "bloomCombine",
                textures: [{
                    name: "%last"
                }, "TextureBloomBlur1", "TextureBloomBlur2", "TextureBloomBlur3", "TextureBloomBlur4", "TextureBloomBlur5"],
                out: {
                    name: "%next"
                }
            })
        },
        _addMergeable: function (e, t) {
            if (t.useChromaticAberration && e.push({
                    func: "chromaticAberration",
                    textures: [{
                        name: "%last",
                        filter: "nearest"
                    }],
                    out: {
                        name: "%next"
                    }
                }), t.useColorBalance && e.push({
                    func: "colorBalance",
                    textures: [{
                        name: "%last",
                        filter: "nearest"
                    }],
                    out: {
                        name: "%next"
                    },
                    collapsible: !0
                }), t.useToneMapping) {
                var i = [{
                        name: "%last",
                        filter: "nearest"
                    }],
                    n = "";
                "fixed" !== t.bgType || t.useRefraction || t.useSsr || (n = "#define HAS_FIXED_BACKGROUND", i.push("TextureDepth")), e.push({
                    func: "toneMapping",
                    header: n,
                    textures: i,
                    out: {
                        name: "%next"
                    },
                    collapsible: !0
                })
            }
            t.webVR && t.useExtra && (e.push({
                func: "veilVr",
                textures: "%last",
                out: {
                    name: "%next",
                    filter: "nearest"
                },
                collapsible: !0
            }), e.push({
                func: "composeExtra",
                header: "#define LINEAR_EXTRA",
                textures: ["%last", "TextureExtra"],
                out: {
                    name: "%next",
                    filter: "nearest"
                },
                collapsible: !0
            }))
        },
        _addSuperSample: function (e, t) {
            if (!t.hasBG) {
                var i = ["%last", "TextureDepth"];
                if (t.useRefraction && i.push("TextureRefraction"), e.push({
                        func: "setDepthAlpha",
                        header: t.useRefraction ? "#define REFRACTION_FORCE_ALPHA_ONE" : "",
                        textures: i,
                        out: {
                            name: "%next"
                        },
                        collapsible: !0
                    }), t.AR) return
            }
            if (!t.useTaa) return void e.push({
                func: "supersample",
                textures: [{
                    name: "%last",
                    filter: "linear",
                    rgbm: !1,
                    srgb: !0
                }, "%previous"],
                out: {
                    name: "%next",
                    filter: "linear"
                }
            });
            var n = [];
            t.useTaaTransparent && n.push("#define TAA_TRANSPARENT"), n.push("#define FEEDBACK_MIN " + Object(r.a)().taaFeedbackMin), n.push("#define FEEDBACK_MAX " + Object(r.a)().taaFeedbackMax), p.a.vrConfig.doVR && n.push("#define VR_ENABLED"), e.push({
                func: "supersampleTaa",
                textures: [{
                    name: "%last",
                    filter: "linear",
                    rgbm: !1,
                    srgb: !0
                }, "%previous", "TextureDepth"],
                header: n,
                out: {
                    name: "%next",
                    filter: "linear"
                }
            })
        },
        _addFinalPass: function (e, t) {
            var i = [],
                n = [{
                    name: "%last",
                    filter: "linear",
                    srgb: !0,
                    rgbm: !1
                }];
            t.useDistortionVR && i.push("#define VR_DISTORTION"), t.useFxaa ? e.push({
                func: "fxaa",
                header: i,
                textures: n,
                out: {
                    name: "%next"
                }
            }) : e.push({
                func: "passThrough",
                header: i,
                textures: n,
                out: {
                    name: "%next"
                }
            }), t.useSharpen && (i = [], n = ["%last"], t.hasBG && (i.push("#define HAS_BACKGROUND"), n.push("TextureDepth")), e.push({
                func: "sharpen",
                header: i,
                textures: n,
                out: {
                    name: "%next"
                },
                collapsible: !0
            })), t.useVignette && e.push({
                func: "vignette",
                textures: [{
                    name: "%last",
                    filter: "nearest"
                }],
                out: {
                    name: "%next"
                },
                collapsible: !0
            }), t.useGrain && e.push({
                func: "grain",
                textures: "%last",
                out: {
                    name: "%next"
                },
                collapsible: !0
            }), t.useDof && e.push({
                func: "dofCross",
                textures: "%last",
                out: {
                    name: "%next"
                },
                collapsible: !0
            }), t.webVR ? e.push({
                func: "fadeVr",
                textures: "%last",
                out: {
                    name: "%next"
                },
                collapsible: !0
            }) : t.useExtra && e.push({
                func: "composeExtra",
                textures: ["%last", "TextureExtra"],
                out: {
                    name: "%next"
                },
                collapsible: !0
            }), t.hasBG || e.push({
                func: "finalPremultAlpha",
                textures: "%last",
                out: {
                    name: "%next"
                },
                collapsible: !0
            })
        },
        _addFixedBackground: function (e, t, i) {
            if ("fixed" === t.bgType) {
                var n = this.getNodeBackground().getBackground(),
                    r = n || c.a.dummyTexture;
                r.divisor = -1, i.addExternalTexture("TextureFixed", r);
                var a = ["%last", "TextureFixed", "TextureDepth"],
                    o = [];
                t.useRefraction && (a.push("TextureRefraction"), o.push("#define REFRACTION_COMPOSITING_EXCLUSION")), e.push({
                    func: "composeFixedBackground",
                    header: o,
                    textures: a,
                    uniforms: [m.a.scale],
                    out: {
                        name: "%next"
                    },
                    collapsible: !0
                })
            }
        },
        _addFixedBackgroundRefraction: function (e, t, i) {
            if (!t.useRefraction || "fixed" !== t.bgType) return "%last";
            var n = this.getNodeBackground().getBackground(),
                r = n || c.a.dummyTexture;
            return r.divisor = -1, i.addExternalTexture("TextureFixed", r), e.push({
                func: {
                    name: "composeFixedBackgroundRefraction",
                    file: "composeFixedBackground.glsl"
                },
                textures: ["%last", "TextureFixed", "TextureDepth"],
                uniforms: [m.a.scale],
                out: {
                    name: "TextureWithBackground"
                }
            }), "TextureWithBackground"
        },
        _addPassThrough: function (e) {
            e.push({
                func: "passThrough",
                textures: "%last",
                out: {
                    name: "%next"
                }
            })
        },
        _createComposer: function () {
            var e = this._updateEffectiveConfig(),
                t = this._composer || new ze.ComposerPostProcess;
            void 0 === this._composer && this._initComposer(t), t.clear();
            var i = [],
                n = e.useSsr && Object(r.a)().depthMipmap || e.useSsao,
                a = e.useSsr || e.useRefraction,
                o = 0;
            n && this._packMipmapDepth(i), e.useSsao && this._addSsao(i), e.useSss && this._addSss(i, t), e.useTransparency && this._addCombineOpacity(i), a && (o = this._packMipmapColor(i, e, t)), e.useRefraction && this._addRefraction(i, e, t), e.useDof && this._addDof(i), e.useBloom && this._addBloom(i, e), this._addMergeable(i, e), this._addFixedBackground(i, e, t), o > 0 && i.length === o && this._addPassThrough(i);
            var s = 0 === i.length;
            if (this._addSuperSample(i, e), this._addFinalPass(i, e), this._addInternalTextures(t, e, s), t.build(i), this._assignInternalTextureToCamera(), b.a.uOutputLinear.setInt(s ? 0 : 1), b.a.uRGBMRange.setFloat(s ? -1 : this._model.get("rgbmDefault")), this.onBackgroundColor(), e.useRefraction || e.useSsr) {
                var u = this.getOrCreateStateSet(),
                    l = t.getInternalTexture("TextureToBeRefracted");
                u.setTextureAttributeAndModes(5, l), u.addUniform(je.Uniform.createInt(5, "uTextureToBeRefracted")), l = Object(r.a)().depthMipmap ? t.getInternalTexture("TextureMipmapDepth") : t.getInternalTexture("TextureDepth"), u.setTextureAttributeAndModes(4, l), u.addUniform(je.Uniform.createInt(4, "uTextureMipmapDepth"))
            }
        },
        _assignInternalTextureToCamera: function () {
            var e = this._composer,
                t = this._effectiveConfig,
                i = this._camera;
            i._textureOpaque = e.getInternalTexture("TextureOpaque"), t.useDepth && (i._textureDepth = e.getInternalTexture("TextureDepth")), t.useTransparency && (i._textureTransparent = e.getInternalTexture("TextureTransparent")), t.useRefraction && (i._textureRefraction = e.getInternalTexture("TextureRefraction")), t.useExtra && (i._textureExtra = e.getInternalTexture("TextureExtra"))
        },
        _resizeMipmapHeight: function (e, t, i) {
            var n = e.getInternalTexture(t);
            if (n) {
                var r = e._screenWidth,
                    a = e._screenHeight,
                    o = e._getTextureSize(r, n.divisor),
                    s = e._getTextureSize(a, .5 * n.divisor);
                n.setTextureSize(o, s);
                var u = e.getStateSetPass(i);
                if (u) {
                    u.getUniform("uTextureOutputSize").getInternalArray()[1] = s;
                    for (var l = e.getCameras(), c = 0; c < l.length; ++c) {
                        var h = l[c];
                        if (h.getName() === t) return void h.getViewport().setViewport(0, 0, o, s)
                    }
                }
            }
        },
        _hookComposerResize: function (e) {
            var t = this,
                i = ze.ComposerPostProcess.prototype;
            e.resizeRatio = function (n, r, a, o) {
                i.resizeRatio.call(e, n, r, a, o), t._resizeMipmapHeight(e, "TextureToBeRefracted", "packMipmapRefraction"), t._resizeMipmapHeight(e, "TextureMipmapDepth", "packMipmapDepth")
            }
        },
        _initComposer: function (e) {
            e.setScreenSize(this._viewerOSGJS.getCanvasWidth(), this._viewerOSGJS.getCanvasHeight()), e.setMethodWrapUV(1, 1), this._hookComposerResize(e), this._viewer.bind("resizeCanvas", e.resize, e), this._viewer.bind("resizeRatio", e.resizeRatio, e), e.setNodeMask(a.a.NO_PICK_NO_SHADOW), e.setName("PostProcess - Composer"), this.addChild(e), this._composer = e;
            var t = e.getOrCreateStateSet();
            for (var i in _.a) t.addUniform(_.a[i])
        },
        resetCameraAttachments: function () {
            var e = this._camera;
            e.resetAttachments(), e.fboOpaque && (e.fboOpaque.reset(), e.fboOpaque = void 0), e.fboTransparent && (e.fboTransparent.reset(), e.fboTransparent = void 0), e.fboRefraction && (e.fboRefraction.reset(), e.fboRefraction = void 0), e.fboDepth && (e.fboDepth.reset(), e.fboDepth = void 0), e.fboExtra && (e.fboExtra.reset(), e.fboExtra = void 0), e.attachRenderBuffer(je.FrameBufferObject.DEPTH_ATTACHMENT, je.FrameBufferObject.DEPTH_COMPONENT16)
        },
        createPathStandard: function () {
            if (this._createComposer(), this.resetCameraAttachments(), Object(r.a)().stats) {
                var e = this._composer.getCameras();
                e[e.length - 1].setRenderOrder(je.Camera.POST_RENDER, 0);
                var t, i = [];
                for (t = 0; t < e.length; t++) {
                    var n = e[t].getName(); - 1 === n.indexOf("FeedbackTexture") && i.push(n)
                }
                this._viewer.setOptionStatsPostProcess(i);
                var a = s.a.getTimerGPU();
                for (t = 0; t < e.length; ++t) {
                    var o = e[t],
                        u = o.getName();
                    o.setInitialDrawCallback(a.start.bind(a, u)), o.setFinalDrawCallback(a.end.bind(a, u))
                }
                this._camera.setFinalDrawCallback(function () {
                    a.start("PostProcess")
                });
                var l = this._viewerOSGJS.getCamera();
                l.setInitialDrawCallback(a.start.bind(a, "Total GL")), l.setFinalDrawCallback(function () {
                    a.end("PostProcess"), a.end("Total GL")
                })
            }
        }
    }), "osgSketchfab", "PostProcess"), t.a = We
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = n.a.osg,
        a = n.a.osgShader.shaderProcessor,
        o = {
            pascalCache: [
                [1]
            ],
            getOrCreatePascalCoefficients: function (e) {
                e = void 0 === e ? 5 : Math.min(e, 128);
                var t = o.pascalCache;
                if (t[e]) return t[e];
                for (var i = t.length - 1; i < e; i++) {
                    var n = t[i],
                        r = n.length,
                        a = new Array(r);
                    a[0] = 1, a[r] = 1;
                    for (var s = i === t.length - 1 ? Math.pow(2, i) : 1, u = 0; u < r - 1; u++) a[u + 1] = (n[u] + n[u + 1]) * s;
                    s = Math.pow(2, i + 1);
                    for (var l = 0; l < r + 1; l++) a[l] /= s;
                    t.push(a)
                }
                return t[e]
            }
        },
        s = function (e) {
            var t = e.toString();
            return -1 === t.indexOf(".") ? t + ".0" : t
        },
        u = function (e, t) {
            var i = .005 / e,
                n = e,
                r = o.getOrCreatePascalCoefficients(n),
                a = Math.floor(n / 2),
                u = [],
                l = s(r[a]);
            a + 1 >= e && (l = "1.0");
            var c = 1;
            u.push("vec3 pixel = " + l + " * %fetch(gTexCoord.xy).rgb;"), u.push("vec2 offset;"), u.push("vec2 blurDir = uPixelRatio.xy * uBlurDir.xy / uTextureOutputSize.xy;"), t && u.push("blurDir *= uGlobalTexSize.y * 0.00075;");
            var h;
            for (h = a + 1; h < e; h += 2) {
                var d = r[h],
                    f = r[h + 1],
                    p = d + f;
                if (p < i) break;
                var m = (c * d + (c + 1) * f) / p;
                u.push("offset = blurDir * " + s(m) + ";"), l = s(p), u.push("pixel += " + l + " * %fetch(gTexCoord.xy + offset.xy).rgb;"), u.push("pixel += " + l + " * %fetch(gTexCoord.xy - offset.xy).rgb;"), c += 2
            }
            u.push("return vec4(pixel, 1.0);");
            for (h = 0; h < u.length; ++h) u[h] = "    " + u[h].replace("%fetch", "TEXTURE_2D_TextureBlurInput");
            return ["uniform sampler2D TextureBlurInput;", "uniform vec2 uTextureOutputSize;", "uniform vec2 uPixelRatio;", "uniform vec2 uBlurDir;", t ? "uniform vec2 uGlobalTexSize;\n" : "", "vec4 gaussianBlur() {", u.join("\n"), "}"].join("\n")
        },
        l = function (e, t, i, n, o) {
            for (var s = 2, l = r.Uniform.createFloat2(r.vec2.fromValues(0, 1), "uBlurDir"), c = r.Uniform.createFloat2(r.vec2.fromValues(1, 0), "uBlurDir"), h = {}, d = t, f = 0; f < n.length; f++) {
                var p = n[f] + 1,
                    m = "gaussianBlur" + f;
                a.hasShader[m] || (h[m] = u(p, o)), e.push({
                    func: {
                        name: "gaussianBlur",
                        file: m
                    },
                    uniforms: l,
                    textures: {
                        name: d,
                        uniformName: "TextureBlurInput"
                    },
                    out: {
                        name: "TextureBlurTemp" + f,
                        divisor: s,
                        filter: "linear"
                    }
                }), d = i + (f + 1), e.push({
                    func: {
                        name: "gaussianBlur",
                        file: m
                    },
                    uniforms: c,
                    textures: {
                        name: "TextureBlurTemp" + f,
                        uniformName: "TextureBlurInput"
                    },
                    out: {
                        name: d,
                        divisor: s,
                        filter: "linear"
                    }
                }), s *= 2
            }
            a.addShaders(h)
        };
    t.a = l
}, function (e, t) {
    e.exports = '#ifdef VR_DISTORTION\nuniform vec2 uDistortion;\nuniform vec4 uProjectionLeft;\nuniform vec4 uUnprojectionLeft;\n\n#pragma include "distortion.glsl"\n#endif\n\nuniform sampler2D TextureInput;\n\nvec4 passThrough() {\n#ifdef VR_DISTORTION\n    gTexCoord = distortion(gTexCoord);\n#endif\n\n    return TEXTURE_2D_TextureInput(gTexCoord);\n}'
}, function (e, t) {
    e.exports = '#pragma include "utils/decodeDepth.glsl"\n\nuniform sampler2D TextureInput;\nuniform sampler2D TextureDepth;\n\nuniform sampler2D TextureRefraction;\nuniform vec2 uTextureRefractionSize;\nuniform vec2 uTextureRefractionRatio;\n\n// no background scenario\nvec4 setDepthAlpha(const in vec4 color) {\n#ifdef REFRACTION_FORCE_ALPHA_ONE\n    // detect if we are on a refraction pixel\n    vec2 uvRef = min(gTexCoord, 1.0 - 1.0 / uTextureRefractionSize.xy);\n    if (texture2D(TextureRefraction, uvRef * uTextureRefractionRatio).a > 0.0) return vec4(color.rgb, 1.0);\n#endif\n\n    float alpha = decodeAlpha(TEXTURE_2D_TextureDepth(gTexCoord));\n    return vec4(color.rgb, alpha);\n}'
}, function (e, t) {
    e.exports = "uniform sampler2D TextureTransparent;\n\nvec4 combineOpacity(const in vec4 color) {\n\t// should be replaced with TEXTURE_2D_TextureTransparent as is can make sense\n    vec4 transparent = TEXTURE_2D_TextureTransparent(gTexCoord);\n    return vec4(color.rgb * (1.0 - transparent.a) + transparent.rgb, 1.0);\n}"
}, function (e, t) {
    e.exports = "uniform sampler2D TextureInput;\nuniform sampler2D TextureRefraction;\n\nuniform vec2 uTextureRefractionSize;\nuniform vec2 uTextureRefractionRatio;\nuniform float uRGBMRange;\n\nvec4 combineRefraction() {\n    // manual fetch to check m value of rgba : we use m 0 (invalid of rgbm) as masking\n    vec2 uv = min(gTexCoord, 1.0 - 1.0 / uTextureRefractionSize.xy);\n    vec4 rgbmRefraction = texture2D(TextureRefraction, uv * uTextureRefractionRatio);\n\n    vec4 background = TEXTURE_2D_TextureInput(gTexCoord);\n    if (rgbmRefraction.a == 0.0) return background;\n    return vec4(decodeRGBM(rgbmRefraction, uRGBMRange), 1.0);\n}"
}, function (e, t) {
    e.exports = "uniform sampler2D TextureRefractionBlur0;\nuniform sampler2D TextureRefractionBlur1;\nuniform sampler2D TextureRefractionBlur2;\nuniform sampler2D TextureRefractionBlur3;\nuniform sampler2D TextureRefractionBlur4;\nuniform sampler2D TextureRefractionBlur5;\nuniform sampler2D TextureRefractionBlur6;\nuniform sampler2D TextureRefractionBlur7;\nuniform vec2 uTextureOutputRatio;\n\nvec4 packMipmapRefraction() {\n    vec4 result = vec4(0.0, 0.0, 0.0, 1.0);\n\n    // see _hookComposerResize in NodePostProcess.js (mipmap)\n    gTexCoord.y /= uTextureOutputRatio.y;\n\n    float levelLog = -log2(1.0 - gTexCoord.y) + 1.0;\n    float level = floor(levelLog) - 1.0;\n\n    float pLevel = pow(2.0, level + 1.0); // 2, 4, 8, 16...\n    gTexCoord.x = pLevel * gTexCoord.x * 0.5;\n    gTexCoord.y = pLevel * (1.0 - gTexCoord.y) - 1.0;\n\n    // unused part of the texture\n    if (gTexCoord.x > 1.0 || gTexCoord.y > 1.0) return result;\n\n    if (level < 0.1) result.rgb = TEXTURE_2D_TextureRefractionBlur0(gTexCoord).rgb;\n    else if (level < 1.1) result.rgb = TEXTURE_2D_TextureRefractionBlur1(gTexCoord).rgb;\n    else if (level < 2.1) result.rgb = TEXTURE_2D_TextureRefractionBlur2(gTexCoord).rgb;\n    else if (level < 3.1) result.rgb = TEXTURE_2D_TextureRefractionBlur3(gTexCoord).rgb;\n    else if (level < 4.1) result.rgb = TEXTURE_2D_TextureRefractionBlur4(gTexCoord).rgb;\n    else if (level < 5.1) result.rgb = TEXTURE_2D_TextureRefractionBlur5(gTexCoord).rgb;\n    else if (level < 6.1) result.rgb = TEXTURE_2D_TextureRefractionBlur6(gTexCoord).rgb;\n    else if (level < 7.1) result.rgb = TEXTURE_2D_TextureRefractionBlur7(gTexCoord).rgb;\n\n    return result;\n}\n"
}, function (e, t) {
    e.exports = '#pragma include "utils/checkerboard.glsl"\n\n// blur jimenez\n// https://github.com/iryoku/separable-sss/blob/master/SeparableSSS.h#L454\n\n// blur UE4 (based on jimenez)\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/SeparableSSS.usf\n\n// UE 4 pre/post passes (down/upsample/checkerboard)\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/PostProcessSubsurface.usf\n\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Common.usf#L501\n// also solution 2 of http://stackoverflow.com/questions/596216/formula-to-determine-brightness-of-rgb-color\nfloat luminanceLinear(const in vec3 color) {\n    return dot(color, vec3(0.3, 0.59, 0.11));\n}\n\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/PostProcessSubsurface.usf#L247\nvoid uncheckerboard(out vec3 diffuse, out vec3 specular) {\n    vec2 coordCenter = floor(gTexCoord * uTextureSSSColorSize) + 0.5;\n    vec2 uvCenter = coordCenter / uTextureSSSColorSize;\n\n    vec3 offset = vec3(1.0 / uTextureSSSColorSize.xy, 0.0);\n    vec3 A = TEXTURE_2D_TextureSSSColor(uvCenter + offset.xz).rgb;\n    vec3 B = TEXTURE_2D_TextureSSSColor(uvCenter - offset.xz).rgb;\n    vec3 C = TEXTURE_2D_TextureSSSColor(uvCenter + offset.zy).rgb;\n    vec3 D = TEXTURE_2D_TextureSSSColor(uvCenter - offset.zy).rgb;\n\n    // Luminance could be green channel only\n    float a = luminanceLinear(A);\n    float b = luminanceLinear(B);\n    float c = luminanceLinear(C);\n    float d = luminanceLinear(D);\n\n    float ab = abs(a - b);\n    float cd = abs(c - d);\n\n    // take the average in the direction that avoids dither pattern\n    vec3 quant1 = 0.5 * mix(A + B, C + D, ab > cd ? 1.0 : 0.0);\n    vec3 quant0 = TEXTURE_2D_TextureSSSColor(uvCenter).rgb;\n\n    float checker = checkerboard(coordCenter, uHalton);\n    diffuse = mix(quant1, quant0, checker);\n    specular = mix(quant0, quant1, checker);\n}\n'
}, function (e, t) {
    e.exports = '#pragma include "utils/decodeDepth.glsl"\n\nuniform sampler2D TextureSSSColor;\nuniform sampler2D TextureDepth;\nuniform vec2 uTextureSSSColorSize;\n\nuniform vec4 uHalton;\n\n#pragma include "sssCommon.glsl"\n\n// hacky line to force the composerPostprocess to\n// hook texture funciton in sssCommon because pragma defines\n// aren\'t handled directly\n\n// TEXTURE_2D_TextureSSSColor(whatever)\nvec4 sssExtract() {\n    vec4 pack = TEXTURE_2D_TextureDepth(gTexCoord);\n    vec3 specular;\n    vec3 diffuse;\n    uncheckerboard(diffuse, specular);\n\n    // force depth "0" to tell sss blur to skip the pixel when blurring\n    float bgOrNotSSS = decodeProfile(pack) == 0 || pack.x == 1.0 ? 0.0 : 1.0;\n\n    return vec4(diffuse, bgOrNotSSS * decodeDepth(pack));\n}\n'
}, function (e, t) {
    e.exports = '#pragma include "utils/functions.glsl"\n#pragma include "utils/decodeDepth.glsl"\n#pragma include "utils/rand.glsl"\n\nuniform sampler2D TextureSSSBlur;\nuniform sampler2D TextureDepth;\nuniform sampler2D TextureSSSKernel;\n\nuniform vec2 uNearFar;\n\nuniform vec2 uBlurDir;\nuniform float uProjFactor;\nuniform float uScatteringFactorPacker;\nuniform float uFrameModTaaSS;\n\n#ifndef SSS_JITTER\n#define SSS_JITTER 1.0\n#endif\n\n#ifndef SSS_HALF_KERNEL_SIZE\n#define SSS_HALF_KERNEL_SIZE 11\n#endif\n\n#ifndef SSS_PROFILE_COUNT\n#define SSS_PROFILE_COUNT 1\n#endif\n\n#define SSS_FOLLOW_SURFACE\n\n// if we want to do it branchless\nvec3 sssFetchColorBranchless(const in vec2 uv, const in vec4 colorM, const in float depthNormBias){\n    vec4 fetch = TEXTURE_2D_TextureSSSBlur(uv);\n\n#ifdef SSS_FOLLOW_SURFACE\n    float mixer = smoothstep(0.0, 0.05, abs(colorM.a - fetch.a) * depthNormBias);\n    mixer = mix(mixer, 1.0, step(fetch.a, 0.0)); // force to 1 if fetch.a is 0 (background)\n    fetch.rgb = mix(fetch.rgb, colorM.rgb, mixer);\n#endif\n\n    // uv inside box\n    // https://stackoverflow.com/questions/12751080/glsl-point-inside-box-test\n    vec2 s = step(vec2(0.0), uv) - step(vec2(1.0), uv);\n    return mix(colorM.rgb, fetch.rgb, s.x * s.y);\n}\n\nvec3 sssFetchColor(const in vec2 uv, const in vec4 colorM, const in float depthNormBias){\n    if (uv.x < 0.0 || uv.y < 0.0 || uv.x > 1.0 || uv.y > 1.0) {\n        return colorM.rgb;\n    }\n\n    // ignore sss with big depth difference, original jimenez is clamp(dDiff, 0.0, 1.0)\n    // we use a much more aggressive function\n    vec4 fetch = TEXTURE_2D_TextureSSSBlur(uv);\n\n#ifdef SSS_FOLLOW_SURFACE\n    if (fetch.a == 0.0) return colorM.rgb;\n    return mix(fetch.rgb, colorM.rgb, smoothstep(0.0, 0.05, abs(colorM.a - fetch.a) * depthNormBias));\n#else\n    return fetch.rgb;\n#endif\n}\n\nvec4 sssBlur() {\n    vec4 colorM = TEXTURE_2D_TextureSSSBlur(gTexCoord);\n\n    vec4 pack = TEXTURE_2D_TextureDepth(gTexCoord);\n\n    // background or not sss stuffs\n    if (pack.x == 1.0) {\n        return colorM;\n    }\n\n    int profile = decodeProfile(pack);\n    float scatter = decodeScatter(pack);\n    if (scatter == 0.0) {\n        return colorM;\n    }\n\n    float scatterWorld = scatter / uScatteringFactorPacker;\n    float depthRange = (uNearFar.y - uNearFar.x);\n\n    // for follow surface\n    // factor to get a normalized depth difference depending of scatter but not of camera position\n    float depthNormBias = depthRange * 0.05 / scatterWorld;\n\n    float worldPos = uNearFar.x + depthRange * colorM.a;\n    // uScatteringFactorPacker is just a unpacking factor because subsurface factor \n    // is a world space value but written in 8 bit texture\n    vec2 finalStep = uBlurDir * uProjFactor * scatterWorld / worldPos;\n    finalStep *= 1.0 / 3.0;\n\n    float yProfile = 1.0 - (float(profile) - 0.5) / float(SSS_PROFILE_COUNT);\n    float xKernelSize = 1.0 / float(SSS_HALF_KERNEL_SIZE);\n\n    vec3 kernel0 = texture2D(TextureSSSKernel, vec2(xKernelSize * 0.5, yProfile)).rgb;\n    vec3 colorBlurred = colorM.rgb * kernel0;\n\n    // force nearest sample for sss texture kernel color\n    vec2 offKernelNearest = vec2(0.5 * xKernelSize, 0.0);\n\n    // randomize the sss texture alpha weight a bit\n    float rnd = interleavedGradientNoise(gl_FragCoord.xy, uFrameModTaaSS);\n    rnd = mix(0.5, rnd, SSS_JITTER);\n    vec2 offKernelJitter = vec2(rnd * xKernelSize, 0.0);\n\n    for (int i = 1; i < SSS_HALF_KERNEL_SIZE; i++) {\n        vec2 uvKernel = vec2(float(i) * xKernelSize, yProfile);\n\n        vec3 kernel = texture2D(TextureSSSKernel, uvKernel + offKernelNearest).rgb;\n        float kernelDither = texture2D(TextureSSSKernel, uvKernel + offKernelJitter).a;\n\n        vec2 offset = kernelDither * finalStep;\n\n        vec3 fetch = sssFetchColor(gTexCoord + offset, colorM, depthNormBias);\n        fetch += sssFetchColor(gTexCoord - offset, colorM, depthNormBias);\n\n        colorBlurred += kernel.rgb * fetch;\n    }\n\n    return vec4(colorBlurred, colorM.a);\n}\n'
}, function (e, t) {
    e.exports = '#pragma include "utils/decodeDepth.glsl"\n\nuniform sampler2D TextureSSSColor;\nuniform vec2 uTextureSSSColorSize;\n\nuniform vec4 uHalton;\nuniform vec2 uNearFar;\nuniform float uProjFactor;\nuniform float uScatteringFactorPacker;\n\n#pragma include "sssCommon.glsl"\n\nuniform sampler2D TextureSSSBlur;\nuniform sampler2D TextureDepth;\n\nvec4 sssCombine() {\n    // full res - not SSS\n    vec4 pack = TEXTURE_2D_TextureDepth(gTexCoord);\n    int profile = decodeProfile(pack);\n    // black pixels for background or non sss surfaces\n    if (pack.x == 1.0 || profile == 0) {\n        return TEXTURE_2D_TextureSSSColor(gTexCoord);\n    }\n\n    vec3 specular;\n    vec3 diffuse;\n    uncheckerboard(diffuse, specular);\n\n    // try to retain high res detail as much as possible (same ad dof)\n    // make sure to use a factor that is independent from bounding box\n    float scatterWorld = decodeScatter(pack) / uScatteringFactorPacker;\n    float worldPos = uNearFar.x + (uNearFar.y - uNearFar.x) * decodeDepth(pack);\n    float factor = uProjFactor * scatterWorld / worldPos;\n    \n    // magic factor 10 (can be tweaked, e.g: if sss effects disappears too fast when we are far away)\n    factor = smoothstep(0.05, 0.3, factor * 10.0);\n    // return vec4(vec3(factor), 1.0);\n\n    diffuse = mix(diffuse, TEXTURE_2D_TextureSSSBlur(gTexCoord).rgb, factor);\n\n    return vec4(diffuse + specular, 1.0);\n}\n'
}, function (e, t) {
    e.exports = '#pragma include "utils/encodeDecode.glsl"\n#pragma include "utils/decodeDepth.glsl"\n\nuniform sampler2D TextureDepth0;\nuniform sampler2D TextureDepth1;\nuniform sampler2D TextureDepth2;\nuniform sampler2D TextureDepth3;\nuniform sampler2D TextureDepth4;\nuniform sampler2D TextureDepth5;\nuniform vec2 uTextureOutputRatio;\n\nvec4 packMipmapDepth() {\n    vec4 result = vec4(0.0, 0.0, 0.0, 0.0);\n\n    // see _hookComposerResize in NodePostProcess.js (mipmap)\n    gTexCoord.y /= uTextureOutputRatio.y;\n\n    float levelLog = -log2(1.0 - gTexCoord.y) + 1.0;\n    float level = floor(levelLog) - 1.0;\n\n    float pLevel = pow(2.0, level + 1.0); // 2, 4, 8, 16...\n    gTexCoord.x = pLevel * gTexCoord.x * 0.5;\n    gTexCoord.y = pLevel * (1.0 - gTexCoord.y) - 1.0;\n\n    // unused part of the texture\n    if (gTexCoord.x > 1.0 || gTexCoord.y > 1.0) return result;\n\n    if (level < 0.1) result.rgba = vec4(encode24(decodeDepth(TEXTURE_2D_TextureDepth0(gTexCoord))), 1.0);\n    else if (level < 1.1) result.rgba = TEXTURE_2D_TextureDepth1(gTexCoord);\n    else if (level < 2.1) result.rgba = TEXTURE_2D_TextureDepth2(gTexCoord);\n    else if (level < 3.1) result.rgba = TEXTURE_2D_TextureDepth3(gTexCoord);\n    else if (level < 4.1) result.rgba = TEXTURE_2D_TextureDepth4(gTexCoord);\n    else if (level < 5.1) result.rgba = TEXTURE_2D_TextureDepth5(gTexCoord);\n\n    return result;\n}\n'
}, function (e, t) {
    e.exports = '#pragma include "utils/encodeDecode.glsl"\n#pragma include "utils/decodeDepth.glsl"\n\nuniform sampler2D TextureDepth;\nuniform int uFirstDepth;\n\nuniform vec2 uTextureDepthSize;\nuniform vec2 uTextureOutputSize;\n\n// For some reasons it requires unpacking *and* repacking to avoid transition between mipmap\nvec4 depthMipmap() {\n    vec2 invSize = 1.0 / uTextureDepthSize;\n    vec4 depths;\n    vec2 offDepth = vec2(0.25, -0.25);\n    if (uFirstDepth == 1) {\n        depths.x = decodeDepth(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.yy * invSize));\n        depths.y = decodeDepth(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.xy * invSize));\n        depths.z = decodeDepth(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.yx * invSize));\n        depths.w = decodeDepth(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.xx * invSize));\n    } else {\n        depths.x = decode24(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.yy * invSize).xyz);\n        depths.y = decode24(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.xy * invSize).xyz);\n        depths.z = decode24(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.yx * invSize).xyz);\n        depths.w = decode24(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.xx * invSize).xyz);\n    }\n\n    return vec4(encode24(min(min(depths.x, depths.y), min(depths.z, depths.w))), 1.0);\n}\n'
}, function (e, t) {
    e.exports = '#pragma include "utils/functions.glsl"\n#pragma include "utils/encodeDecode.glsl"\n#pragma include "utils/rand.glsl"\n\nuniform sampler2D TextureMipmapDepth;\nuniform vec2 uTextureMipmapDepthSize;\nuniform vec2 uTextureMipmapDepthRatio;\n\nuniform float uQuality; // mipmap usage\n\nuniform vec2 uTextureOutputSize;\n\nuniform float uSsaoRadius;\nuniform float uSsaoIntensity;\nuniform float uSsaoBias;\nuniform vec4 uSsaoProjectionInfo;\nuniform float uSsaoProjectionScale;\n\nuniform vec2 uNearFar;\n\nuniform float uFrameModTaaSS;\n\n// Constant used to scale the depth view value that is given to the blur pass\n#define MIN_RADIUS 1.0\n#define NB_SPIRAL_TURNS 3.0\n\nvec4 fetchDepthPackLevel(const in vec2 uv, const in float level){\n    float maxLod = 5.0;\n    float powLevel = pow(2.0, min(maxLod, floor(level)) + 1.0);\n    vec2 pixelSize = 2.0 * powLevel / uTextureMipmapDepthSize;\n\n    vec2 uvFetch = max(pixelSize, min(1.0 - pixelSize, uv));\n    uvFetch = vec2(2.0 * uvFetch.x, powLevel - 1.0 - uvFetch.y) * uTextureMipmapDepthRatio.xy / powLevel;\n\n    return texture2D(TextureMipmapDepth, uvFetch);\n}\n\nfloat fetchDepthLevel(const in vec2 uv, const in float level){\n    return decode24(fetchDepthPackLevel(uv, level).xyz);\n}\n\nfloat zValueFromScreenSpacePosition(const in float depth) {\n    return uNearFar.x + (uNearFar.y - uNearFar.x) * depth;\n}\n\nvec3 reconstructCSPosition(const in vec2 ssP, const in float z) {\n    return vec3((ssP.xy * uSsaoProjectionInfo.xy + uSsaoProjectionInfo.zw) * z, z);\n}\n\nvec3 getPosition(const in vec2 uv) {\n    return reconstructCSPosition(uv * uTextureOutputSize, zValueFromScreenSpacePosition(fetchDepthLevel(uv, 0.0)));\n}\n\n#define MAX_MIP_LEVEL 5\n// Determines at which point we should switch mip level\n// if number is too small (~3) will lead to flashing (bad variance as many taps give same pixel)\n// if number is too high, mip level are not used well and the cache is not used efficiently\n#define LOG_MAX_OFFSET 3\n\nvec3 getOffsetedPixelPos(\n    const in vec2 uv,\n    const in vec2 unitOffset,\n    const in float screenSpaceRadius) {\n\n    float mipLevel = clamp(floor(log2(screenSpaceRadius)) - float(LOG_MAX_OFFSET), 0.0, float(MAX_MIP_LEVEL));\n    vec2 uvOff = uv + floor(screenSpaceRadius * unitOffset) / uTextureOutputSize;\n\n    float d = zValueFromScreenSpacePosition(fetchDepthLevel(uvOff, mipLevel));\n    return reconstructCSPosition(uvOff * uTextureOutputSize, d);\n}\n\n#define PIOVER8 0.39269908169\nvec3 unpackNormal1(const in float pack1) {\n    float pack8 = floor(pack1 * 255.0);\n    float th = PIOVER8 * float(pack8 / 16.0);\n    float len = sqrt(mod(float(pack8), 16.0) / 15.001);\n    vec2 nv = vec2(cos(th), sin(th)) * len;\n    return -vec3(nv.x, nv.y, sqrt(max(0.0, 1.0 - nv.x * nv.x - nv.y * nv.y)));\n}\n\nvec3 unpackNormal2(const in vec2 pack2) {\n    vec3 nv = pack2.rgg * 2.0 - 1.0;\n    return -vec3(nv.x, nv.y, sqrt(max(0.0, 1.0 - nv.x * nv.x - nv.y * nv.y)));\n}\n\n#define SSAO_TAP_EXTRACT(id) screenSpaceRadius = (float(id) + 0.5) * (1.0 / nbSamples); \\\n    angle = screenSpaceRadius * (NB_SPIRAL_TURNS * 6.28) + randomAngle; \\\n    screenSpaceRadius = max(0.75, screenSpaceRadius * ssRadius); \\\n    offsetUnitVec = vec2(cos(angle), sin(angle)); \\\n    occludingPoint = getOffsetedPixelPos(uv, offsetUnitVec, screenSpaceRadius); \\\n    occludingPoint -= cameraSpacePosition; \\\n    vv = dot(occludingPoint, occludingPoint); \\\n    vn = dot(occludingPoint, normal); \\\n    contrib += max(1.0 - vv * invRadius2, 0.0) * max((vn - uSsaoBias) * inversesqrt(vv), 0.0); \\\n\n#define SSAO_DO_TAPS(void) SSAO_TAP_EXTRACT(offset + 0); \\\n    SSAO_TAP_EXTRACT(offset + 1); \\\n    SSAO_TAP_EXTRACT(offset + 2); \\\n    SSAO_TAP_EXTRACT(offset + 3); \\\n    SSAO_TAP_EXTRACT(offset + 4); \\\n    SSAO_TAP_EXTRACT(offset + 5); \\\n    SSAO_TAP_EXTRACT(offset + 6); \\\n    SSAO_TAP_EXTRACT(offset + 7); \\\n    SSAO_TAP_EXTRACT(offset + 8); \\\n    SSAO_TAP_EXTRACT(offset + 9); \\\n    SSAO_TAP_EXTRACT(offset + 10); \\\n    offset += 11; \\\n\n\nvec4 ssaoExtract() {\n    vec2 uv = gTexCoord;\n\n    vec3 depthPacked = fetchDepthPackLevel(uv, 0.0).xyz;\n\n    vec3 cameraSpacePosition = getPosition(uv);\n    float ssRadius = -uSsaoProjectionScale * uSsaoRadius / cameraSpacePosition.z;\n\n#ifdef SSAO_NORMAL\n    vec3 normal = unpackNormal2(TEXTURE_2D_TextureDepth(uv).ba); // g buffer normal 2 component on ba\n#elif defined(GL_OES_standard_derivatives) && !defined(MOBILE)\n    vec3 normal = cross(dFdy(cameraSpacePosition), dFdx(cameraSpacePosition));\n#else\n    vec2 offDepth = vec2(1.0, 0.0);\n    vec3 depthLeft = getPosition(uv - offDepth.xy / uTextureMipmapDepthSize);\n    vec3 depthRight = getPosition(uv + offDepth.xy / uTextureMipmapDepthSize);\n    vec3 depthBottom = getPosition(uv - offDepth.yx / uTextureMipmapDepthSize);\n    vec3 depthTop = getPosition(uv + offDepth.yx / uTextureMipmapDepthSize);\n    vec3 normal = cross(depthLeft - depthRight, depthTop - depthBottom);\n#endif\n\n    // early returns should be done derivatives usage to avoid bad edges\n\n    // early return background\n    if (depthPacked.x == 1.0) {\n        return vec4(depthPacked, 1.0);\n    }\n\n    // early return radius too small (note: needs to be in separate conditional because of nvidia/osx bug)\n    if (ssRadius < MIN_RADIUS) {\n        return vec4(depthPacked, 1.0);\n    }\n\n    normal = normalize(normal);\n    float nFalloff = mix(1.0, max(0.0, 1.5 * normal.z), 0.35);\n\n     // needs to be > 2PI\n    float randomAngle = 6.28 * interleavedGradientNoise(gl_FragCoord.xy, uFrameModTaaSS);\n   \n    float invRadius2 = 1.0 / (uSsaoRadius * uSsaoRadius);\n    float contrib = 0.0;\n\n    float vv;\n    float vn;\n    float screenSpaceRadius;\n    float angle;\n    vec3 occludingPoint;\n    vec2 offsetUnitVec;\n    int offset = 0;\n\n    float nbSamples = 11.0;\n    if (uQuality > 0.33) nbSamples += 11.0;\n    if (uQuality > 0.66) nbSamples += 11.0;\n\n    SSAO_DO_TAPS();\n    if (uQuality > 0.33) { SSAO_DO_TAPS(); }\n    if (uQuality > 0.66) { SSAO_DO_TAPS(); }\n\n    float aoValue = max(0.0, 1.0 - sqrt(contrib * nFalloff / nbSamples));\n    aoValue = pow(aoValue, 10.0 * uSsaoIntensity);\n\n    vec4 aoDepth;\n    aoDepth.rgb = depthPacked;\n    aoDepth.a = mix(1.0, aoValue, clamp(ssRadius - MIN_RADIUS, 0.0, 1.0));\n\n    return aoDepth;\n}\n'
}, function (e, t) {
    e.exports = '#pragma include "utils/encodeDecode.glsl"\n\nuniform sampler2D TextureBlurInput;\nuniform vec2 uTextureBlurInputSize;\n\n#define SSAO_FILTER_RADIUS 3\n\n#define SSAO_TAP_BLUR(id, absid) sampleTex = TEXTURE_2D_TextureBlurInput(uv + axis * float(id) * 2.0); \\\n    z = decode24(sampleTex.xyz); \\\n    weight = max(0.0, 1.0 - sharpnessFactor * abs(z - initialZ)) * (0.3 + gaussian[absid]); \\\n    sum += weight * sampleTex.a; \\\n    totalWeight += weight;\n\nvec4 ssaoBlur(const in vec2 axis) {\n    vec2 uv = gTexCoord;\n\n    vec4 aoDepth = TEXTURE_2D_TextureBlurInput(uv);\n\n    // background\n    if(aoDepth.x == 1.0){\n        return aoDepth;\n    }\n\n    float initialZ = decode24(aoDepth.xyz);\n\n    float gaussian[SSAO_FILTER_RADIUS + 2]; // dummy because of intel off-by-one bug\n    gaussian[0] = 0.153170;\n    gaussian[1] = 0.144893;\n    gaussian[2] = 0.122649;\n    gaussian[3] = 0.092902;\n    gaussian[4] = 0.0;\n\n    float totalWeight = gaussian[0];\n    float sum = aoDepth.a * totalWeight;\n    float sharpnessFactor = 400.0;\n\n    // ---- UNROLL ----\n    vec2 ofs;\n    float z;\n    float weight;\n    vec4 sampleTex;\n\n    SSAO_TAP_BLUR(-3, 3);\n    SSAO_TAP_BLUR(-2, 2);\n    SSAO_TAP_BLUR(-1, 1);\n    SSAO_TAP_BLUR(1, 1);\n    SSAO_TAP_BLUR(2, 2);\n    SSAO_TAP_BLUR(3, 3);\n    // ---- UNROLL ----\n\n    aoDepth.a = sum / totalWeight;\n    return aoDepth;\n}\n\n#ifdef SSAO_BLUR_H\nvec4 ssaoBlurH() {\n    return ssaoBlur(vec2(1.0, 0.0) / uTextureBlurInputSize);\n}\n#else\nvec4 ssaoBlurV() {\n    vec3 color = TEXTURE_2D_TextureInput(gTexCoord).rgb;\n    return vec4(color * ssaoBlur(vec2(0.0, 1.0) / uTextureBlurInputSize).aaa, 1.0);\n}\n#endif'
}, function (e, t) {
    e.exports = '#pragma include "utils/decodeDepth.glsl"\n\nconst float MAX_BLUR = 16.0;\nconst float EPS_EARLY_OUT = 0.01; // early out (typically when we move the camera fast and the dof might be not effective)\n\nfloat texDepthToCoC(const in vec4 fetch) {\n    // background should be always max blurred so that the near blur can expand onto the background (because of special dilate background codepath below)\n    if(fetch.x == 1.0) return max(uDofBlurNearFarFocal.x, uDofBlurNearFarFocal.y);\n\n    float coc = decodeDepth(fetch);\n    coc = clamp((coc - uDofBlurNearFarFocal.z) / coc, -1.0, 1.0);\n    return (coc < 0.0 ? coc * uDofBlurNearFarFocal.x : coc * uDofBlurNearFarFocal.y);\n}'
}, function (e, t) {
    e.exports = 'uniform vec3 uDofBlurNearFarFocal;\n\n#pragma include "dofCommon.glsl"\n\nuniform sampler2D TextureDepth;\n\nvec4 dofCoC() {\n    if(uDofBlurNearFarFocal.x < EPS_EARLY_OUT && uDofBlurNearFarFocal.y < EPS_EARLY_OUT){\n        return vec4(0.0);\n    }\n\n    return vec4(vec3(0.0), texDepthToCoC(TEXTURE_2D_TextureDepth(gTexCoord)) * 0.5 + 0.5);\n}'
}, function (e, t) {
    e.exports = 'uniform vec3 uDofBlurNearFarFocal;\n\n#pragma include "dofCommon.glsl"\n\nuniform sampler2D TextureDofCoC;\nuniform vec2 uTextureDofCoCSize;\nuniform sampler2D TextureDepth;\n\nuniform float uDofScale;\n\nvec4 dilateNear(const in vec2 offset) {\n    if(uDofBlurNearFarFocal.x < EPS_EARLY_OUT && uDofBlurNearFarFocal.y < EPS_EARLY_OUT){\n        return vec4(0.0);\n    }\n\n    // TODO DOF both the weights and the formula can be tweaked, also we could add a bit of jitter or something\n    vec2 uv = gTexCoord;\n    bool isBG = TEXTURE_2D_TextureDepth(uv).x == 1.0;\n\n    float coc = 0.0;\n    vec2 ofs = MAX_BLUR * offset / 5.0;\n\n    float coc0 = TEXTURE_2D_TextureDofCoC(uv).a * 2.0 - 1.0;\n    float coc1 = TEXTURE_2D_TextureDofCoC(uv - 5.0 * ofs).a * 2.0 - 1.0;\n    float coc2 = TEXTURE_2D_TextureDofCoC(uv - 4.0 * ofs).a * 2.0 - 1.0;\n    float coc3 = TEXTURE_2D_TextureDofCoC(uv - 3.0 * ofs).a * 2.0 - 1.0;\n    float coc4 = TEXTURE_2D_TextureDofCoC(uv - 2.0 * ofs).a * 2.0 - 1.0;\n    float coc5 = TEXTURE_2D_TextureDofCoC(uv - 1.0 * ofs).a * 2.0 - 1.0;\n    float coc6 = TEXTURE_2D_TextureDofCoC(uv + 1.0 * ofs).a * 2.0 - 1.0;\n    float coc7 = TEXTURE_2D_TextureDofCoC(uv + 2.0 * ofs).a * 2.0 - 1.0;\n    float coc8 = TEXTURE_2D_TextureDofCoC(uv + 3.0 * ofs).a * 2.0 - 1.0;\n    float coc9 = TEXTURE_2D_TextureDofCoC(uv + 4.0 * ofs).a * 2.0 - 1.0;\n    float coc10 = TEXTURE_2D_TextureDofCoC(uv + 5.0 * ofs).a * 2.0 - 1.0;\n\n    if(isBG == true){\n        // avoid "shrink" effect on the out of focus far part on the model edges\n        // gaussian weights (sigma 10), (doesn\'t have to be gaussian though), but the sum must be 1.0\n        // http://dev.theomader.com/gaussian-kernel-calculator/\n        coc = abs(coc0) * 0.095474 +\n        (abs(coc1) + abs(coc10)) * 0.084264 +\n        (abs(coc2) + abs(coc9)) * 0.088139 +\n        (abs(coc3) + abs(coc8)) * 0.091276 +\n        (abs(coc4) + abs(coc7)) * 0.093585 +\n        (abs(coc5) + abs(coc6)) * 0.094998;\n    } else {\n        // blur only near field (expand)\n        coc = min(coc0, 0.0);\n        coc = min(coc1 * 0.3, coc);\n        coc = min(coc2 * 0.5, coc);\n        coc = min(coc3 * 0.75, coc);\n        coc = min(coc4 * 0.8, coc);\n        coc = min(coc5 * 0.95, coc);\n        coc = min(coc6 * 0.95, coc);\n        coc = min(coc7 * 0.8, coc);\n        coc = min(coc8 * 0.75, coc);\n        coc = min(coc9 * 0.5, coc);\n        coc = min(coc10 * 0.3, coc);\n        if(abs(coc0) > abs(coc)) coc = coc0;\n    }\n\n    return vec4(0.0, 0.0, 0.0, coc * 0.5 + 0.5);\n}\n\nvec4 dofNearDilateH() {\n    vec2 offset = vec2(uDofScale / uTextureDofCoCSize.x, 0.0);\n    return dilateNear(offset);\n}\n\nvec4 dofNearDilateV() {\n    vec2 offset = vec2(0.0, uDofScale / uTextureDofCoCSize.y);\n    return dilateNear(offset);\n}'
}, function (e, t) {
    e.exports = "uniform sampler2D TextureInput;\n\n#ifdef COLOR_WITH_COC\nuniform sampler2D TextureDofCoC;\n#endif\n\nvec4 dofDownsampleColor() {\n    vec2 uv = gTexCoord;\n\n    vec4 color = TEXTURE_2D_NEAREST_TextureInput(uv);\n\n// premult with coc buffer\n#ifdef COLOR_WITH_COC\n    color.a = abs(TEXTURE_2D_TextureDofCoC(uv).a * 2.0 - 1.0);\n    color.a *= color.a * color.a;\n    color.rgb *= color.a;\n#endif\n\n    return color;\n}"
}, function (e, t) {
    e.exports = '#pragma include "utils/rand.glsl"\n\nuniform vec3 uDofBlurNearFarFocal;\n#pragma include "dofCommon.glsl"\n\nuniform sampler2D TextureDofColor;\nuniform vec2 uTextureDofColorSize;\n\n#ifndef COLOR_WITH_COC\nuniform sampler2D TextureDofCoC;\nuniform vec2 uTextureDofCoCSize;\n#endif\n\nuniform float uDofScale;\nuniform float uQuality;\n\nuniform float uFrameModTaaSS;\n\n#ifdef COLOR_WITH_COC\n#define DOF_TAP(id) ofs = fTaps_Poisson[id]; \\\n                    ofs = gTexCoord + blurDist * vec2(dot(ofs, basis.xy), dot(ofs, basis.zw) ); \\\n                    sumcol += TEXTURE_2D_TextureDofColor(ofs);\n#else\n#define DOF_TAP(id) ofs = fTaps_Poisson[id]; \\\n                    ofs = gTexCoord + blurDist * vec2(dot(ofs, basis.xy), dot(ofs, basis.zw) ); \\\n                    cocWeight = abs(TEXTURE_2D_TextureDofCoC(ofs).a * 2.0 - 1.0); \\\n                    cocWeight *= cocWeight * cocWeight; \\\n                    sumcol.rgb += TEXTURE_2D_TextureDofColor(ofs).rgb * cocWeight; \\\n                    sumcol.a += cocWeight;\n#endif\n\nvec4 dofBlur16(const in vec2 blurDist, const in float ntime) {\n    float rnd = 6.28 * ditheringNoise(gl_FragCoord.xy, uFrameModTaaSS + ntime);\n\n    float cosa = cos(rnd);\n    float sina = sin(rnd);\n    vec4 basis = vec4(cosa, -sina, sina, cosa);\n\n    vec4 sumcol = vec4(0.0);\n\n    float total = 0.0;\n\n    vec2 fTaps_Poisson[17];\n    // https://github.com/bartwronski/PoissonSamplingGenerator\n    fTaps_Poisson[0] = vec2(0.343280198355, 0.921191856785);\n    fTaps_Poisson[1] = vec2(-0.116859107262, 0.873056831344);\n    fTaps_Poisson[2] = vec2(-0.646421287853, 0.760425284853);\n    fTaps_Poisson[3] = vec2(-0.0437332058416, 0.47196719804);\n    fTaps_Poisson[4] = vec2(0.48240473891, 0.464894594736);\n    fTaps_Poisson[5] = vec2(-0.718897237297, 0.352191304304);\n    fTaps_Poisson[6] = vec2(-0.939061387886, -0.0387376698953);\n    fTaps_Poisson[7] = vec2(0.546569494557, -0.0169516524446);\n    fTaps_Poisson[8] = vec2(-0.182644095652, -0.0702667761349);\n    fTaps_Poisson[9] = vec2(-0.576191305396, -0.252368997099);\n    fTaps_Poisson[10] = vec2(0.921914032366, -0.366530187909);\n    fTaps_Poisson[11] = vec2(-0.0582053944545, -0.510617206206);\n    fTaps_Poisson[12] = vec2(-0.783101528934, -0.601411360136);\n    fTaps_Poisson[13] = vec2(0.430604354377, -0.729559481383);\n    fTaps_Poisson[14] = vec2(-0.350716524868, -0.809522919973);\n    fTaps_Poisson[15] = vec2(0.0600898835968, -0.952568587297);\n    fTaps_Poisson[16] = vec2(0.0, 0.0); // dummy because of intel off-by-one bug\n\n    vec2 ofs;\n    vec4 sampleTex;\n    float cocWeight;\n\n    DOF_TAP(0);\n    DOF_TAP(1);\n    DOF_TAP(2);\n    DOF_TAP(3);\n    DOF_TAP(4);\n    DOF_TAP(5);\n    DOF_TAP(6);\n    DOF_TAP(7);\n    DOF_TAP(8);\n    DOF_TAP(9);\n    DOF_TAP(10);\n    DOF_TAP(11);\n    DOF_TAP(12);\n    DOF_TAP(13);\n    DOF_TAP(14);\n    DOF_TAP(15);\n\n    return sumcol;\n}\n\nvec4 dofBlurCircular() {\n    if(uDofBlurNearFarFocal.x < EPS_EARLY_OUT && uDofBlurNearFarFocal.y < EPS_EARLY_OUT) {\n        return vec4(0.0);\n    }\n\n    float factor = MAX_BLUR * uDofScale;\n\n#ifdef COLOR_WITH_COC\n    vec2 blurDist = factor * pow(TEXTURE_2D_TextureDofColor(gTexCoord).a, 0.333) / uTextureDofColorSize;\n#else\n    vec2 blurDist = factor * abs(TEXTURE_2D_TextureDofCoC(gTexCoord).a * 2.0 - 1.0) / uTextureDofCoCSize;\n#endif\n\n    // TODO optimize dofBlur16 (unroll...)\n    vec4 sumcol = dofBlur16(blurDist, 0.0); // 16\n    if (uQuality > 0.33) sumcol += dofBlur16(blurDist, 3.0); // 32\n    if (uQuality > 0.66) sumcol += dofBlur16(blurDist, 5.0); // 48\n\n    return vec4(sumcol.rgb / sumcol.a, 1.0);\n}\n'
}, function (e, t) {
    e.exports = 'uniform vec3 uDofBlurNearFarFocal;\n\n#pragma include "dofCommon.glsl"\n\nuniform sampler2D TextureInput;\nuniform sampler2D TextureDofBlurCircular;\nuniform sampler2D TextureDofNearDilateV;\nuniform sampler2D TextureDepth;\n\nuniform vec2 uTextureDofNearDilateVSize;\nuniform vec2 uTextureDofBlurCircularSize;\n\nuniform float uDofScale;\n\nvec4 dofCombine() {\n    vec2 uv = gTexCoord;\n    vec3 color = TEXTURE_2D_TextureInput(uv).rgb;\n\n    if(uDofBlurNearFarFocal.x < EPS_EARLY_OUT && uDofBlurNearFarFocal.y < EPS_EARLY_OUT){\n        return vec4(color, 1.0);\n    }\n\n    vec4 depthPacked = TEXTURE_2D_TextureDepth(uv);\n\n    // half res color\n    vec3 blur;\n    // no bilinear for background pixels because it can displays artefacts on low frequency due to rgbm bilinear fetching\n    if (depthPacked.x == 1.0) {\n        blur = TEXTURE_2D_NEAREST_TextureDofBlurCircular(uv).rgb;\n        vec2 off = vec2(1.0, -1.0) * uDofScale;\n        blur += TEXTURE_2D_NEAREST_TextureDofBlurCircular(uv + off.xx / uTextureDofBlurCircularSize).rgb;\n        blur += TEXTURE_2D_NEAREST_TextureDofBlurCircular(uv + off.yy / uTextureDofBlurCircularSize).rgb;\n        blur += TEXTURE_2D_NEAREST_TextureDofBlurCircular(uv + off.xy / uTextureDofBlurCircularSize).rgb;\n        blur += TEXTURE_2D_NEAREST_TextureDofBlurCircular(uv + off.yx / uTextureDofBlurCircularSize).rgb;\n        blur /= 5.0;\n    } else {\n        blur = TEXTURE_2D_TextureDofBlurCircular(uv).rgb;\n        vec2 off = vec2(1.0, -1.0) * uDofScale;\n        blur += TEXTURE_2D_TextureDofBlurCircular(uv + off.xx / uTextureDofBlurCircularSize).rgb;\n        blur += TEXTURE_2D_TextureDofBlurCircular(uv + off.yy / uTextureDofBlurCircularSize).rgb;\n        blur += TEXTURE_2D_TextureDofBlurCircular(uv + off.xy / uTextureDofBlurCircularSize).rgb;\n        blur += TEXTURE_2D_TextureDofBlurCircular(uv + off.yx / uTextureDofBlurCircularSize).rgb;\n        blur /= 5.0;\n    }\n\n    // merge full res and half res coc\n    vec2 uvNearest = (floor(uv * uTextureDofNearDilateVSize) + 0.5) / uTextureDofNearDilateVSize;\n    float coc = abs(min(TEXTURE_2D_TextureDofNearDilateV(uvNearest).a * 2.0 - 1.0, texDepthToCoC(depthPacked)));\n\n    // merge half res blurred color and full res pixels\n    float cocLower = 0.05;\n    float cocHigher = 0.3;\n\n    return vec4(mix(color, blur, smoothstep(cocLower, cocHigher, coc)), 1.0);\n}\n\n'
}, function (e, t) {
    e.exports = '#pragma include "utils/getLuminance.glsl"\n#pragma include "utils/decodeDepth.glsl"\n\nuniform sampler2D TextureInput;\n\n#ifdef HAS_BACKGROUND\nuniform sampler2D TextureDepth;\n#endif\n\nuniform float uBloomThreshold;\n\nvec3 extractBright(const in vec3 color) {\n    // TODO manage hdr pixel with high frequency? (use derivative??), for now we clamp the extracted pixel :(\n    return clamp(color * clamp(getLuminance(color) - uBloomThreshold, 0.0, 1.0), 0.0, 1.0);\n}\n\nvec4 bloomExtract() {\n    vec3 color = TEXTURE_2D_TextureInput(gTexCoord).rgb;\n\n#ifdef HAS_BACKGROUND\n\tfloat alpha = decodeAlpha(TEXTURE_2D_TextureDepth(gTexCoord));\n\tif(alpha == 0.0) {\n\t\treturn vec4(vec3(0.0), 1.0);\n    }\n#else\n\tfloat alpha = 1.0;\n#endif\n\n\treturn vec4(extractBright(color * alpha), 1.0);\n}'
}, function (e, t) {
    e.exports = "uniform sampler2D TextureInput;\nuniform sampler2D TextureBloomBlur1;\nuniform sampler2D TextureBloomBlur2;\nuniform sampler2D TextureBloomBlur3;\nuniform sampler2D TextureBloomBlur4;\nuniform sampler2D TextureBloomBlur5;\n\nuniform float uBloomRadius;\nuniform float uBloomFactor;\n\nfloat getRadiusFactored(const float value, const float middle) {\n    return mix(value, middle * 2.0 - value, uBloomRadius);\n}\n\nvec4 bloomCombine() {\n    vec3 bloom = vec3(0.0);\n\n    const float midVal = 0.6;\n\n    const float factor1 = 1.1;\n    const float factor2 = 0.9;\n    const float factor3 = 0.6;\n    const float factor4 = 0.3;\n    const float factor5 = 0.1;\n\n    bloom += TEXTURE_2D_TextureBloomBlur1(gTexCoord).rgb * getRadiusFactored(factor1, midVal);\n    bloom += TEXTURE_2D_TextureBloomBlur2(gTexCoord).rgb * getRadiusFactored(factor2, midVal);\n    bloom += TEXTURE_2D_TextureBloomBlur3(gTexCoord).rgb * getRadiusFactored(factor3, midVal);\n    bloom += TEXTURE_2D_TextureBloomBlur4(gTexCoord).rgb * getRadiusFactored(factor4, midVal);\n    bloom += TEXTURE_2D_TextureBloomBlur5(gTexCoord).rgb * getRadiusFactored(factor5, midVal);\n\n    vec3 color = TEXTURE_2D_TextureInput(gTexCoord).rgb;\n    return vec4(color + (bloom * uBloomFactor), 1.0);\n}"
}, function (e, t) {
    e.exports = "uniform sampler2D TextureInput;\n\nuniform float uChromaFactor;\n\nvec4 chromaticAberration() {\n    vec2 uv = gTexCoord;\n\n    vec2 dist = uv - 0.5;\n    vec2 offset = uChromaFactor * dist * length(dist);\n    vec3 col;\n    col.r = TEXTURE_2D_TextureInput(uv - offset).r;\n    col.g = TEXTURE_2D_TextureInput(uv).g;\n    col.b = TEXTURE_2D_TextureInput(uv + offset).b;\n\n    return vec4(col, 1.0);\n}"
}, function (e, t) {
    e.exports = '#pragma include "utils/decodeDepth.glsl"\n#pragma include "utils/rand.glsl"\n\nuniform vec2 uLensRadius;\nuniform float uFrameMod;\n\nfloat vignetteDithered() {\n    vec2 lens = uLensRadius;\n    // smoothesp is not realiable with edge0 == edge1\n    lens.y = min(lens.y, lens.x - 1e-4);\n\n    float jitter = interleavedGradientNoise(gl_FragCoord.xy, uFrameMod);\n\n    // jitter a bit the uv to remove the banding in some cases\n    // (lens.x - lens.y) reduce flickering when the vignette is harder (hardness)\n    // (lens.x + lens.y) reduce the flickering when the vignette has a strong radius\n    jitter = (lens.x - lens.y) * (lens.x + lens.y) * 0.07 * (jitter - 0.5);\n    return smoothstep(lens.x, lens.y, jitter + distance(gTexCoord, vec2(0.5)));\n}\n\nvec4 vignette(const in vec4 color) {\n    float factor = vignetteDithered();\n    return vec4(linearTosRGB(sRGBToLinear(color.rgb) * factor), clamp(color.a + (1.0 - factor), 0.0, 1.0));\n}'
}, function (e, t) {
    e.exports = '#pragma include "utils/getLuminance.glsl"\n#pragma include "utils/decodeDepth.glsl"\n\nuniform float uToneExposure;\nuniform float uToneBrightness;\nuniform float uToneContrast;\nuniform float uToneSaturation;\nuniform int uToneMethod;\n\n#ifdef HAS_FIXED_BACKGROUND\nuniform sampler2D TextureDepth;\n#endif\n\nvec3 toneMapping(const in vec3 color) {\n    vec3 col = color * uToneExposure;\n    float luminance = dot(col * (1.0 + uToneBrightness), vec3(0.2126, 0.7152, 0.0722));\n    col = mix(vec3(luminance), col * (1.0 + uToneBrightness), vec3(uToneSaturation));\n\n    // contrast is annoying and require special treatment in case of fixed background\n    // because it doesn\'t output black when the input is black\n    float toneContrast = uToneContrast;\n#ifdef HAS_FIXED_BACKGROUND\n    float alpha = decodeAlpha(TEXTURE_2D_TextureDepth(gTexCoord));\n    if(alpha == 0.0) toneContrast *= luminance;\n#endif\n    col = max(vec3(0.0), col * (1.0 + toneContrast) - 0.5 * toneContrast);\n\n    // simple reinhard and filmic\n    // http://filmicgames.com/archives/190\n    if(uToneMethod == 1) { // reinhard (on luminance)\n        col /= 1.0 + getLuminance(col);\n    } else if( uToneMethod == 2) { // filmic\n        vec3 x = max(vec3(0.0), col - 0.004);\n        col = (x * (6.2 * x + 0.5) ) / ( x * (6.2 * x + 1.7) + 0.06);\n        col = pow(col, vec3(2.2)); // filmic curve already encode srgb to linear\n    }\n\n    return col;\n}\n\nvec4 toneMapping(const in vec4 color) {\n    return vec4(toneMapping(color.rgb), 1.0);\n}\n'
}, function (e, t) {
    e.exports = "uniform vec3 uColorBalanceLow;\nuniform vec3 uColorBalanceMid;\nuniform vec3 uColorBalanceHigh;\n\nfloat RGBToL(const in vec3 color) {\n    float fmin = min(min(color.r, color.g), color.b);\n    float fmax = max(max(color.r, color.g), color.b);\n    return (fmax + fmin) / 2.0;\n}\n\nvec3 colorBalance(const in vec3 color) {\n    vec3 lrgb = uColorBalanceLow;\n    vec3 mrgb = uColorBalanceMid;\n    vec3 hrgb = uColorBalanceHigh;\n\n    float cLen = length(color);\n    if(cLen < 1e-5)\n        return color;\n\n    // TODO : I have no idea what I am doing, we should use a curve widge\n    float lightness = RGBToL(color);\n    // '  lightness=(lightness*0.9-1.0)/(lightness*2.0+1.0) +1.0;\n    lightness = (1.5 * lightness) / (lightness + 0.5);\n    // https://github.com/liovch/GPUImage/blob/master/framework/Source/GPUImageColorBalanceFilter\n    float a = 0.25;\n    float b = 0.333;\n    float scale = 0.7;\n    vec3 low = lrgb * clamp((lightness - b) / -a + 0.5, 0.0, 1.0);\n    vec3 mid = mrgb * clamp((lightness - b) / a + 0.5, 0.0, 1.0) * clamp((lightness + b - 1.0) / -a + 0.5, 0.0, 1.0);\n    vec3 high = hrgb * clamp((lightness + b - 1.0) / a + 0.5, 0.0, 1.0);\n    vec3 newColor = max(color + (low + mid + high) * scale, vec3(0.0));\n    // newColor can be negative\n    float len = length(newColor);\n    return len < 1e-5 ? newColor * cLen : newColor * cLen / len;\n}\n\nvec4 colorBalance(const in vec4 color) {\n    return vec4(colorBalance(color.rgb), 1.0);\n}"
}, function (e, t) {
    e.exports = "uniform vec4 uHalton;\n\nuniform float uSSAARestart;\nuniform sampler2D TexturePrevious;\nuniform vec2 uTexturePreviousSize;\n\n// static in place amortized supersampling\nvec4 supersample() {\n    vec4 currFragColor = TEXTURE_2D_TextureInput(gTexCoord).rgba;\n\n    float haltz = abs(uHalton.z);\n    if (haltz == 1.0) {\n        // just return the color.\n        return currFragColor;\n    }\n\n    // same pixel for same projected interpolated vertex on prev frame\n    vec4 accumColorN = TEXTURE_2D_NEAREST_TexturePrevious(gTexCoord).rgba;\n\n    // mix frames\n    float lerpFac = 1.0 / uHalton.w;\n\n    // if uTaaSSSRestart is 0.0, then we used the previous TAAed image to start supersampling\n    // we do that to avoid a sudden re-aliasing of the image (which is perceptible)\n    if (uHalton.w == 1.0) lerpFac = uSSAARestart;\n\n    if (haltz == 3.0) {\n        // No supersample, crude motion blur by accumulation\n        return mix(currFragColor, accumColorN, lerpFac);\n    }\n\n    // Supsersample, accumulation + jittering\n    // http://en.wikipedia.org/wiki/Moving_average#Cumulative_moving_average\n    // cumulative moving average over frameNum (which starts at 2)\n    // n is previous frame\n    // accumColorN = Accum(n)\n    // return value is accumColor( n +1 )\n    // Accum(n+1) = Accum(n) + ((x(n+1) - Accum(n)) / (n + 1)))\n    // formula above is equal to glsl  mix\n    return mix(accumColorN, currFragColor, lerpFac);\n}\n"
}, function (e, t) {
    e.exports = '#pragma include "utils/getLuminance.glsl"\n#pragma include "utils/decodeDepth.glsl"\n#pragma include "supersample.glsl"\n\nuniform sampler2D TextureInput;\nuniform vec2 uTextureInputSize;\nuniform sampler2D TexturePrevious;\nuniform vec2 uTexturePreviousSize;\nuniform sampler2D TextureDepth;\n\nuniform vec4 uHalton;\nuniform vec2 uNearFar;\n\nuniform float uTaaEnabled;\nuniform mat4 uTaaInvViewMatrixLeft;\nuniform mat4 uTaaCurrentFramePVLeft;\nuniform mat4 uTaaLastFramePVLeft;\nuniform vec4 uTaaCornersCSLeft[2];\n\n#ifdef VR_ENABLED\nuniform mat4 uTaaInvViewMatrixRight;\nuniform mat4 uTaaCurrentFramePVRight;\nuniform mat4 uTaaLastFramePVRight;\nuniform vec4 uTaaCornersCSRight[2];\n#endif\n\nvec3 reconstructWSPosition(const in vec2 uv, const in vec4 corners[2], const in mat4 invView, const in float depth) {\n    vec2 finalUv = uv;\n#ifdef VR_ENABLED\n    float xViewportOffset = uv.x >= 0.5 ? -0.5 : 0.0;\n    finalUv.x = ( uv.x + xViewportOffset ) * 2.0;\n#endif\n\n    // the corners are in view space, it means if we interpolate between them we can retrieve the view space direction of the fragment\n    vec4 AB = mix(corners[0], corners[1], finalUv.x);\n\n    // multiply this view space direction by the depth gives us the view space position\n    vec3 vsPos = vec3(mix(AB.xy, AB.zw, finalUv.y), 1.0) * depth;\n\n    // multiply by the inverse of the view matrix gives us the world space position\n    return (invView * vec4(vsPos, 1.0)).xyz;\n}\n\n#define NEIGHBOUR_SET_IF_DMIN_Z_GREATER(d, x, y) if(d < dmin.z) dmin = vec3(x, y, d);\n#define NEIGHBOUR_CREATE_FROM_OFFSET(d, x, y) d = decodeDepth(TEXTURE_2D_TextureDepth(uv + vec2(x,y)));\n#define FIND_NEIGHBOUR_MIN(d, x, y) NEIGHBOUR_CREATE_FROM_OFFSET(d, x, y); NEIGHBOUR_SET_IF_DMIN_Z_GREATER(d, x, y)\n\n\n// Neighborhood clamping from Tiago Sousa\n// 4tap(decent) comment t, ml, mr, b\n// https://github.com/playdeadgames/temporal/blob/9e6a7704e69bb73f29fe393390e545b21ddfd42d/Assets/Shaders/IncDepth.cginc#L111\n// 9Tap(good) slower but nicer\n// https://github.com/playdeadgames/temporal/blob/9e6a7704e69bb73f29fe393390e545b21ddfd42d/Assets/Shaders/IncDepth.cginc#L37\n//#define CLOSEST_9TAP\nvec3 closestFragment(const in vec2 uv, const in vec2 texelSize) {\n\n    float d;\n    vec2 size = 2.0 * texelSize;\n    vec3 dmin = vec3(0.0, 0.0, 0.0);\n\n    // 5Tap\n    NEIGHBOUR_CREATE_FROM_OFFSET(dmin.z, 0.0, 0.0);\n    FIND_NEIGHBOUR_MIN(d, -size.x, size.y);\n    FIND_NEIGHBOUR_MIN(d, size.x, size.y);\n    FIND_NEIGHBOUR_MIN(d, -size.x, -size.y);\n    FIND_NEIGHBOUR_MIN(d, size.x, -size.y);\n\n#ifdef CLOSEST_9TAP\n    FIND_NEIGHBOUR_MIN(d, 0.0, size.y);\n    FIND_NEIGHBOUR_MIN(d, -size.x, 0.0);\n    FIND_NEIGHBOUR_MIN(d, size.x, 0.0);\n    FIND_NEIGHBOUR_MIN(d, 0.0, -size.y);\n#endif\n\n    return vec3(uv + dmin.xy, dmin.z);\n}\n\n// note: only clips towards aabb center (but fast!)\n// same as https://github.com/gokselgoktas/temporal-anti-aliasing/blob/master/Assets/Resources/Shaders/TemporalAntiAliasing.cginc#L199\n// which is adapted from https://github.com/playdeadgames/temporal\n// using the mathematical similar version of https://twitter.com/Stubbesaurus/status/890154773726580736\n// exhibits numerical issue (in a consistent way on intel/nvidia at least)\nvec4 clip_aabb_opti(const in vec4 minimum, const in vec4 maximum, const in vec4 color) {\n    const float eps = 0.00000001;\n\n    vec4 center = 0.5 * (maximum + minimum);\n    vec4 extents = 0.5 * (maximum - minimum) + eps;\n    vec4 offset = color - center;\n\n    vec4 ts = abs(offset / extents);\n    float t = max(max(ts.r, ts.g), max(ts.b, ts.a));\n    return center + offset / max(1.0, t);\n    // return t > 1.0 : center + offset / t : color;\n}\n\nvec4 taa(const in vec2 ssVel, const in vec2 texelSize) {\n    vec2 uv = gTexCoord;\n\n    vec4 tl = TEXTURE_2D_TextureInput(uv + vec2(-texelSize.x, texelSize.y));\n    vec4 t  = TEXTURE_2D_TextureInput(uv + vec2(0.0, texelSize.y));\n    vec4 tr = TEXTURE_2D_TextureInput(uv + vec2(texelSize.x, texelSize.y));\n\n    vec4 ml = TEXTURE_2D_TextureInput(uv + vec2(-texelSize.x, 0.0));\n    vec4 m  = TEXTURE_2D_TextureInput(uv);\n    vec4 mr = TEXTURE_2D_TextureInput(uv + vec2(texelSize.x, 0.0));\n\n    vec4 bl = TEXTURE_2D_TextureInput(uv + vec2(-texelSize.x, -texelSize.y));\n    vec4 b  = TEXTURE_2D_TextureInput(uv + vec2(0.0, -texelSize.y));\n    vec4 br = TEXTURE_2D_TextureInput(uv + vec2(texelSize.x, -texelSize.y));\n\n    // sharpen\n    // https://github.com/Unity-Technologies/PostProcessing/blob/v1/PostProcessing/Resources/Shaders/TAA.cginc#L143\n    // reduces blurring, but increases flickering with dense geometry\n    vec4 corners = 2.0 * (tr + bl + br + tl) - 2.0 * m;\n    m += (m - (corners * 0.166667)) * 2.718282 * 0.3;\n    m = max(vec4(0.0), m);\n\n    // Brian Karis neighbourhood rounding: http://advances.realtimerendering.com/s2014/epic/TemporalAA.pptx\n    // average of rounded pattern with cross pattern\n    vec4 cmin5 = min(mr, min(m, min(ml, min(t, b))));\n    vec4 cmin = min(cmin5, min(tl, min(tr, min(bl, br))));\n\n    vec4 cmax5 = max(mr, max(m, max(ml, max(t, b))));\n    vec4 cmax = max(cmax5, max(tl, max(tr, max(bl, br))));\n\n    cmin = 0.5 * (cmin + cmin5);\n    cmax = 0.5 * (cmax + cmax5);\n\n    vec4 previousColor = TEXTURE_2D_TexturePrevious(uv - ssVel);\n    previousColor = clip_aabb_opti(cmin, cmax, previousColor);\n\n    float lum0 = getLuminance(m.rgb);\n    float lum1 = getLuminance(previousColor.rgb);\n    float diff = abs(lum0 - lum1) / max(lum0, max(lum1, 0.2));\n    float unbiased_weight = 1.0 - diff;\n    float feedback = mix(FEEDBACK_MIN, FEEDBACK_MAX, unbiased_weight * unbiased_weight);\n\n    return mix(m, previousColor, feedback);\n}\n\nvec2 computeSSVelocity(const in vec3 wsPos, const in mat4 currentFrameProjView, const in mat4 lastFrameProjView, const in bool rightEye)\n{\n    vec4 ssCurrentPos = currentFrameProjView * vec4(wsPos, 1.0);\n    vec4 ssPrevPos = lastFrameProjView * vec4(wsPos, 1.0);\n\n    vec2 ndcCurrent = ssCurrentPos.xy / ssCurrentPos.w;\n    vec2 ndcPrev = ssPrevPos.xy / ssPrevPos.w;\n\n    //ndcPrev = clamp(ndcPrev, vec2(-1.0), vec2(1.0));\n    if(ndcPrev.x >= 1.0 || ndcPrev.x <= -1.0 || ndcPrev.x >= 1.0 || ndcPrev.y <= -1.0)\n        return vec2(0.0);\n\n#ifdef VR_ENABLED\n    ndcCurrent.x /= 2.0;\n    ndcPrev.x /= 2.0;\n\n    if (rightEye) {\n        ndcCurrent.x += 0.5;\n        ndcPrev.x += 0.5;\n    }\n#endif\n\n    return 0.5 * (ndcCurrent - ndcPrev);\n}\n\n\nvec4 computeTaa(const in mat4 invView, const in mat4 currentFrameProjView, const in mat4 lastFrameProjView, const in vec4 corners[2]) {\n    vec2 uv = gTexCoord;\n    float haltz = abs(uHalton.z);\n    if (haltz == 1.0) {\n        vec2 texelSize = vec2(1.0) / uTextureInputSize;\n        vec3 closest = closestFragment(uv, texelSize);\n\n        // discard background fragments to save fillrate\n        // make sure the mesh isn\'t transparent\n        if (closest.z >= 1.0\n#ifdef TAA_TRANSPARENT\n            && decodeAlpha(TEXTURE_2D_TextureDepth(closest.xy)) == 0.0\n#endif\n        ) {\n            // unjitter for fixed background with highres pattern or text\n            return TEXTURE_2D_TextureInput(uv - 0.5 * uHalton.xy * texelSize);\n        }\n\n        float depth = -(uNearFar.x + (uNearFar.y - uNearFar.x) * closest.z);\n        vec3 ws = reconstructWSPosition(closest.xy, corners, invView, depth);\n\n        vec2 ssVel = computeSSVelocity(ws, currentFrameProjView, lastFrameProjView, uv.x >= 0.5);\n        return taa(ssVel, texelSize);\n    }\n\n    return supersample();\n}\n\n// temporal anti-aliasing from Playdead\'s Inside\n// slides: http://www.gdcvault.com/play/1022970/Temporal-Reprojection-Anti-Aliasing-in\n// sources: https://github.com/playdeadgames/temporal\nvec4 supersampleTaa() {\n    if (uTaaEnabled == 0.0) {\n        return supersample();\n    }\n\n#ifdef VR_ENABLED\n    // left and right eyes have different matrices\n    if (gTexCoord.x >= 0.5) {\n        return computeTaa(uTaaInvViewMatrixRight, uTaaCurrentFramePVRight, uTaaLastFramePVRight, uTaaCornersCSRight);\n    }\n#endif\n\n    return computeTaa(uTaaInvViewMatrixLeft, uTaaCurrentFramePVLeft, uTaaLastFramePVLeft, uTaaCornersCSLeft);\n}'
}, function (e, t) {
    e.exports = "uniform sampler2D TextureExtra;\r\n\r\n// LINEAR should be deduce from TEXTURE_2D_TextureExtra with user data\r\nvec4 composeExtra(const in vec4 color) {\r\n#ifdef LINEAR_EXTRA\r\n\tvec4 extra = sRGBToLinear(TEXTURE_2D_TextureExtra(gTexCoord));\r\n#else\r\n\tvec4 extra = TEXTURE_2D_TextureExtra(gTexCoord);\r\n#endif\r\n\treturn extra + vec4(color) * (1.0 - extra.a);\r\n}"
}, function (e, t) {
    e.exports = '#pragma include "utils/decodeDepth.glsl"\r\n\r\nuniform sampler2D TextureFixed;\r\nuniform vec2 uFixedScale;\r\n\r\nuniform sampler2D TextureDepth;\r\nuniform vec2 uTextureOutputSize;\r\n\r\nuniform vec4 uHalton;\r\nuniform float uSplitView;\r\n\r\nvec4 composeBackground(const in vec3 color, const in float alpha) {\r\n    vec2 jitter = uHalton.xy * 0.5 / uTextureOutputSize;\r\n    vec2 uv = (gTexCoord - 0.5 + jitter) * uFixedScale + 0.5;\r\n\r\n    // we recenter and unstretch the background\r\n    if (uSplitView == 1.0) uv.x = uv.x * 0.5 + 0.25;\r\n\r\n    // composer can\'t guess based on user data, so SRGBToLinear should be defined (or not) by TEXTURE_2D_XXXXXXX\r\n    vec3 backgroundColor = sRGBToLinear(texture2D(TextureFixed, uv).rgb);\r\n    return vec4(color.rgb + backgroundColor * (1.0 - alpha), 1.0);\r\n}\r\n\r\nuniform sampler2D TextureInput;\r\nuniform vec2 uTextureInputSize;\r\nuniform vec2 uTextureInputRatio;\r\n\r\nuniform sampler2D TextureRefraction;\r\nuniform vec2 uTextureRefractionSize;\r\nuniform vec2 uTextureRefractionRatio;\r\nuniform float uRGBMRange;\r\n\r\nvec4 composeFixedBackground(const in vec4 color) {\r\n#ifdef REFRACTION_COMPOSITING_EXCLUSION\r\n    // detect if we are on a refraction pixel\r\n    vec2 uvRef = min(gTexCoord, 1.0 - 1.0 / uTextureRefractionSize.xy);\r\n    if (texture2D(TextureRefraction, uvRef * uTextureRefractionRatio).a > 0.0) return color;\r\n#endif\r\n\r\n    float alpha = decodeAlpha(TEXTURE_2D_TextureDepth(gTexCoord));\r\n    return composeBackground(color.rgb, alpha);\r\n}\r\n\r\nvec4 composeFixedBackgroundRefraction() {\r\n    vec3 color = TEXTURE_2D_TextureInput(gTexCoord).rgb;\r\n    float alpha = decodeAlpha(TEXTURE_2D_TextureDepth(gTexCoord));\r\n    return composeBackground(color.rgb, alpha);\r\n}'
}, function (e, t) {
    e.exports = '#ifdef VR_DISTORTION\nuniform vec2 uDistortion;\nuniform vec4 uProjectionLeft;\nuniform vec4 uUnprojectionLeft;\n\n#pragma include "distortion.glsl"\n#endif\n\nuniform sampler2D TextureInput;\nuniform vec2 uTextureInputSize;\n\n// G3D version of FXAA\n// green (y) as luma\n// Quality 12\nvec4 fxaa() {\n#ifdef VR_DISTORTION\n    gTexCoord = distortion(gTexCoord);\n#endif\n\n    vec2 fxaaQualityRcpFrame = 1.0 / uTextureInputSize;\n    float fxaaQualitySubpix = 0.75;\n    float fxaaQualityEdgeThreshold = 0.125;\n    float fxaaQualityEdgeThresholdMin = 0.0625;\n\n    vec2 posM = gTexCoord;\n    vec4 rgbyM = TEXTURE_2D_TextureInput(posM);\n    float lumaM = rgbyM.y;\n\n    // Swizzler Offseter Util\n    vec4 sw = vec4(-1.0, 1.0, 1.0, -1.0) * fxaaQualityRcpFrame.xxyy;\n\n    float lumaS = TEXTURE_2D_TextureInput(posM + vec2(0.0, sw.z)).y;\n    float lumaE = TEXTURE_2D_TextureInput(posM + vec2(sw.y, 0.0)).y;\n    float lumaN = TEXTURE_2D_TextureInput(posM + vec2(0.0, sw.w)).y;\n    float lumaW = TEXTURE_2D_TextureInput(posM + vec2(sw.x, 0.0)).y;\n\n    float maxSM = max(lumaS, lumaM);\n    float minSM = min(lumaS, lumaM);\n\n    float maxESM = max(lumaE, maxSM);\n    float minESM = min(lumaE, minSM);\n\n    float maxWN = max(lumaN, lumaW);\n    float minWN = min(lumaN, lumaW);\n\n    float rangeMax = max(maxWN, maxESM);\n    float rangeMin = min(minWN, minESM);\n\n    float rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;\n    float range = rangeMax - rangeMin;\n    float rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);\n\n    bool earlyExit = range < rangeMaxClamped;\n    if (earlyExit) return rgbyM;\n\n    float lumaNW = TEXTURE_2D_TextureInput(posM + sw.xw).y;\n    float lumaSE = TEXTURE_2D_TextureInput(posM + sw.yz).y;\n    float lumaNE = TEXTURE_2D_TextureInput(posM + sw.yw).y;\n    float lumaSW = TEXTURE_2D_TextureInput(posM + sw.xy).y;\n\n    float lumaNS = lumaN + lumaS;\n    float lumaWE = lumaW + lumaE;\n    float subpixRcpRange = 1.0/range;\n    float subpixNSWE = lumaNS + lumaWE;\n    float edgeHorz1 = (-2.0 * lumaM) + lumaNS;\n    float edgeVert1 = (-2.0 * lumaM) + lumaWE;\n\n    float lumaNESE = lumaNE + lumaSE;\n    float lumaNWNE = lumaNW + lumaNE;\n    float edgeHorz2 = (-2.0 * lumaE) + lumaNESE;\n    float edgeVert2 = (-2.0 * lumaN) + lumaNWNE;\n\n    float lumaNWSW = lumaNW + lumaSW;\n    float lumaSWSE = lumaSW + lumaSE;\n    float edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);\n    float edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);\n    float edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;\n    float edgeVert3 = (-2.0 * lumaS) + lumaSWSE;\n    float edgeHorz = abs(edgeHorz3) + edgeHorz4;\n    float edgeVert = abs(edgeVert3) + edgeVert4;\n\n    float subpixNWSWNESE = lumaNWSW + lumaNESE;\n    float lengthSign = fxaaQualityRcpFrame.x;\n    bool horzSpan = edgeHorz >= edgeVert;\n    float subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;\n\n    if(!horzSpan) lumaN = lumaW;\n    if(!horzSpan) lumaS = lumaE;\n    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;\n    float subpixB = (subpixA * (1.0/12.0)) - lumaM;\n\n    float gradientN = lumaN - lumaM;\n    float gradientS = lumaS - lumaM;\n    float lumaNN = lumaN + lumaM;\n    float lumaSS = lumaS + lumaM;\n    bool pairN = abs(gradientN) >= abs(gradientS);\n    float gradient = max(abs(gradientN), abs(gradientS));\n    if(pairN) lengthSign = -lengthSign;\n    float subpixC = clamp(abs(subpixB) * subpixRcpRange, 0.0, 1.0);\n\n    vec2 posB = posM.xy;\n    vec2 offNP;\n    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;\n    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;\n    if(!horzSpan) posB.x += lengthSign * 0.5;\n    if( horzSpan) posB.y += lengthSign * 0.5;\n\n    vec2 posN;\n    posN.x = posB.x - offNP.x;\n    posN.y = posB.y - offNP.y;\n    vec2 posP;\n    posP.x = posB.x + offNP.x;\n    posP.y = posB.y + offNP.y;\n    float subpixD = ((-2.0)*subpixC) + 3.0;\n    float lumaEndN = TEXTURE_2D_TextureInput(posN).y;\n    float subpixE = subpixC * subpixC;\n    float lumaEndP = TEXTURE_2D_TextureInput(posP).y;\n\n    if(!pairN) lumaNN = lumaSS;\n    float gradientScaled = gradient * 1.0/4.0;\n    float lumaMM = lumaM - lumaNN * 0.5;\n    float subpixF = subpixD * subpixE;\n    bool lumaMLTZero = lumaMM < 0.0;\n\n    lumaEndN -= lumaNN * 0.5;\n    lumaEndP -= lumaNN * 0.5;\n    bool doneN = abs(lumaEndN) >= gradientScaled;\n    bool doneP = abs(lumaEndP) >= gradientScaled;\n    if(!doneN) posN.x -= offNP.x * 1.5;\n    if(!doneN) posN.y -= offNP.y * 1.5;\n    bool doneNP = (!doneN) || (!doneP);\n    if(!doneP) posP.x += offNP.x * 1.5;\n    if(!doneP) posP.y += offNP.y * 1.5;\n\n    if(doneNP) {\n        if(!doneN) lumaEndN = TEXTURE_2D_TextureInput(posN.xy).y;\n        if(!doneP) lumaEndP = TEXTURE_2D_TextureInput(posP.xy).y;\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * 2.0;\n        if(!doneN) posN.y -= offNP.y * 2.0;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * 2.0;\n        if(!doneP) posP.y += offNP.y * 2.0;\n\n        if(doneNP) {\n            if(!doneN) lumaEndN = TEXTURE_2D_TextureInput(posN.xy).y;\n            if(!doneP) lumaEndP = TEXTURE_2D_TextureInput(posP.xy).y;\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * 4.0;\n            if(!doneN) posN.y -= offNP.y * 4.0;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * 4.0;\n            if(!doneP) posP.y += offNP.y * 4.0;\n\n            if(doneNP) {\n                if(!doneN) lumaEndN = TEXTURE_2D_TextureInput(posN.xy).y;\n                if(!doneP) lumaEndP = TEXTURE_2D_TextureInput(posP.xy).y;\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * 12.0;\n                if(!doneN) posN.y -= offNP.y * 12.0;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * 12.0;\n                if(!doneP) posP.y += offNP.y * 12.0;\n\n            }\n\n        }\n\n    }\n\n    float dstN = posM.x - posN.x;\n    float dstP = posP.x - posM.x;\n    if(!horzSpan) dstN = posM.y - posN.y;\n    if(!horzSpan) dstP = posP.y - posM.y;\n\n    bool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;\n    float spanLength = (dstP + dstN);\n    bool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;\n    float spanLengthRcp = 1.0/spanLength;\n\n    bool directionN = dstN < dstP;\n    float dst = min(dstN, dstP);\n    bool goodSpan = directionN ? goodSpanN : goodSpanP;\n    float subpixG = subpixF * subpixF;\n    float pixelOffset = (dst * (-spanLengthRcp)) + 0.5;\n    float subpixH = subpixG * fxaaQualitySubpix;\n\n    float pixelOffsetGood = goodSpan ? pixelOffset : 0.0;\n    float pixelOffsetSubpix = max(pixelOffsetGood, subpixH);\n    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;\n    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;\n\n    return TEXTURE_2D_TextureInput(posM);\n}'
}, function (e, t) {
    e.exports = '#pragma include "utils/rand.glsl"\n\nuniform float uTimeGrain;\nuniform float uGrainFactor;\n\nfloat nrandTriangle() {\n    float nrnd0 = pseudoRandom(gl_FragCoord.xy + 1000.0 * fract(uTimeGrain));\n\n    // Convert uniform distribution into triangle-shaped distribution.\n    float orig = nrnd0 * 2.0 - 1.0;\n    nrnd0 = orig * inversesqrt(abs(orig));\n    nrnd0 = max(-1.0, nrnd0); // Nerf the NaN generated by 0 * rsqrt(0). Thanks @FioraAeterna!\n    nrnd0 = nrnd0 - sign(orig) + 0.5;\n\n    // Result is range [-0.5,1.5] which is useful for actual dithering. convert to [0,1] for histogram.\n    return (nrnd0 + 0.5) * 0.5;\n    // return nrnd0;\n}\n\nvec4 grain(const in vec4 color) {\n    float grainFactor = nrandTriangle();\n    return vec4(mix(color.rgb, color.rgb * (color.rgb + (1.0 - color.rgb) * 2.0 * grainFactor), uGrainFactor), color.a);\n}'
}, function (e, t) {
    e.exports = '#pragma include "utils/decodeDepth.glsl"\n\nuniform sampler2D TextureInput;\nuniform vec2 uTextureInputSize;\n\n#ifdef HAS_BACKGROUND\nuniform sampler2D TextureDepth;\n#endif\n\nuniform float uSharpFactor;\n\nuniform vec2 uPixelRatio;\n\nvec3 sharpColorFactor(const in vec3 color, const float sharp) {\n    vec2 off = uPixelRatio.xy / uTextureInputSize.xy;\n\n    // use useAA, 4 texFetch already in cache. perhaps we could cache ourself.\n    vec3 rgbNW = TEXTURE_2D_TextureInput(gTexCoord + off * vec2(-1.0, -1.0)).rgb; \n    vec3 rgbSE = TEXTURE_2D_TextureInput(gTexCoord + off * vec2(1.0, 1.0)).rgb;\n    vec3 rgbNE = TEXTURE_2D_TextureInput(gTexCoord + off * vec2(1.0, -1.0)).rgb;\n    vec3 rgbSW = TEXTURE_2D_TextureInput(gTexCoord + off * vec2(-1.0, 1.0)).rgb;\n\n    return color + sharp * (4.0 * color - rgbNW - rgbNE - rgbSW - rgbSE);\n}\n\nvec4 sharpen(const in vec4 color) {\n#ifdef HAS_BACKGROUND\n\tfloat alpha = decodeAlpha(TEXTURE_2D_TextureDepth(gTexCoord));\n\tif( alpha == 0.0 ) {\n\t\treturn vec4(color.rgb,1.0);\n    }\n#else\n\tfloat alpha = 1.0;\n#endif\n\n    return vec4(sharpColorFactor(color.rgb, uSharpFactor * alpha), color.a);\n}\n\nvec4 sharpen() {\n    return sharpen(TEXTURE_2D_TextureInput(gTexCoord));\n}'
}, function (e, t) {
    e.exports = "uniform vec2 uTextureInputSize;\nuniform vec3 uDofCross;\n\nuniform vec2 uPixelRatio;\n\nvec4 dofCross(const in vec4 color) {\n    float ratio = uTextureInputSize.y / uTextureInputSize.x;\n    float dist = distance(vec2(uDofCross.x, uDofCross.y * ratio), gTexCoord * vec2(1.0, ratio));\n    float widthCircle = uPixelRatio.x / uTextureInputSize.x;\n    return vec4(mix(color.rgb, vec3(1.0), abs(dist - 60.0 * widthCircle) > widthCircle ? 0.0 : uDofCross.z), color.a);\n}"
}, function (e, t) {
    e.exports = "// https://github.com/borismus/webvr-boilerplate/blob/master/src/distortion/barrel-distortion-fragment-v2.js\n\nvec2 barrel(const in vec2 v, const in vec4 projection, const in vec4 unprojection) {\n  vec2 w = (v + unprojection.zw) / unprojection.xy;\n  float val = dot(w, w);\n  // float poly = (showCenter == 1 && val < 0.00010) ? 10000.0 : 1.0 + (uDistortion.x + uDistortion.y * val) * val;\n  float poly = 1.0 + (uDistortion.x + uDistortion.y * val) * val;\n  return projection.xy * (poly * w) - projection.zw;\n}\n\nvec2 distortion(const in vec2 texCoord) {\n\n  if (abs(texCoord.x - 0.5) < .001) {\n    discard;\n  }\n\n  vec2 a;\n\n  if (texCoord.x < 0.5){\n    a = barrel(vec2(texCoord.x / 0.5, texCoord.y), uProjectionLeft, uUnprojectionLeft);\n  } else {\n    // right projections are shifted and vertically mirrored relative to left\n    const vec3 swi = vec3(1.0, -1.0, 0.0);\n    vec4 projectionRight = (uProjectionLeft + swi.zzxz) * swi.xxyx;\n    vec4 unprojectionRight = (uUnprojectionLeft + swi.zzxz) * swi.xxyx;\n    a = barrel(vec2((texCoord.x - 0.5) / 0.5, texCoord.y), projectionRight, unprojectionRight);\n  }\n\n  if (a.x < 0.0 || a.x > 1.0 || a.y < 0.0 || a.y > 1.0) {\n    discard;\n  }\n\n  return vec2(a.x * 0.5 + (texCoord.x < 0.5 ? 0.0 : 0.5), a.y);\n}"
}, function (e, t) {
    e.exports = "uniform float uVrFadeFactor;\r\n\r\nvec4 fadeVr(const in vec4 color) {\r\n\treturn vec4(mix(color.rgb, vec3(0.0), clamp(uVrFadeFactor, 0.0, 1.0)), color.a);\r\n}"
}, function (e, t) {
    e.exports = "uniform float uVrVeilFactor;\r\n\r\nvec4 veilVr(const in vec4 color) {\r\n\treturn vec4(color.rgb * uVrVeilFactor, 1.0);\r\n}"
}, function (e, t) {
    e.exports = "uniform float uOutlineFactor;\nuniform vec2 uPixelRatio;\nuniform float uHighlightFactor;\n\nuniform sampler2D TextureOutline;\nuniform vec2 uTextureOutlineSize;\n\nvec4 outline() {\n    float fac0 = 2.0;\n    float fac1 = 1.0;\n    float offsetx = uPixelRatio.x / uTextureOutlineSize[0];\n    float offsety = uPixelRatio.y / uTextureOutlineSize[1];\n\n    vec4 texel0 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(offsetx, offsety));\n    vec4 texel1 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(offsetx, 0.0));\n    vec4 texel2 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(offsetx, -offsety));\n    vec4 texel3 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(0.0, -offsety));\n    vec4 texel4 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(-offsetx, -offsety));\n    vec4 texel5 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(-offsetx, 0.0));\n    vec4 texel6 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(-offsetx, offsety));\n    vec4 texel7 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(0.0, offsety));\n\n    vec4 rowx = -fac0 * texel5 + fac0 * texel1 + -fac1 * texel6 + fac1 * texel0 + -fac1 * texel4 + fac1 * texel2;\n    vec4 rowy = -fac0 * texel3 + fac0 * texel7 + -fac1 * texel4 + fac1 * texel6 + -fac1 * texel2 + fac1 * texel0;\n\n    float magSqr = sqrt(dot(rowy, rowy) + dot(rowx, rowx));\n    bool infMag = magSqr < 1.0 / 65025.0;\n\n    vec3 texelCenter = TEXTURE_2D_TextureOutline(gTexCoord).rgb;\n    if (texelCenter == vec3(0.0) || (uHighlightFactor == 0.0 && infMag)) {\n        discard;\n    }       \n\n    float finalFactor = infMag ? uHighlightFactor : min(1.0, sqrt(magSqr) * uOutlineFactor);\n\n    return finalFactor * vec4(texelCenter, 1.0);\n}\n"
}, function (e, t) {
    e.exports = '#pragma include "utils/functions.glsl"\n\nvec4 finalPremultAlpha(const in vec4 color) {\n    return vec4(linearTosRGB(sRGBToLinear(color.rgb) * color.a), color.a);\n}'
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(44),
        a = i(103),
        o = i(20),
        s = i(47),
        u = i(321),
        l = i(583),
        c = i(152),
        h = i(444),
        d = i(159),
        f = i(636),
        p = i(179),
        m = i(119),
        g = n.a.osg,
        v = n.a.osgUtil,
        _ = !1,
        b = !1,
        S = !1,
        x = function (e) {
            this._dirty = !0, this._view3d = e, this._effectiveConfig = e._effectiveConfig, this._viewer = e._viewer, this._viewerOSGJS = e._viewerOSGJS, this._model = e.model;
            var t = Object(o.a)().dofTransition;
            this._interpolatorDofFocusPoint = new v.DelayInterpolator(3, t ? .15 : 1), this._interpolatorDofBlurNear = new v.DelayInterpolator(1, t ? .15 : 1), this._interpolatorDofBlurFar = new v.DelayInterpolator(1, t ? .15 : 1), this._interpolatorDofCross = new v.DelayInterpolator(1, t ? .08 : 1), this._interpolatorDofCross._epsilon = -.01, this._dofInitialized = !1, this._dofAutoFocus = !1, this._currentEye = g.vec3.create(), this._lastEye = g.vec3.create(), this._currentRot = g.quat.create(), this._lastRot = g.quat.create(), this._dofLastPos = g.vec3.create(), this._dofLastFocal = 0, this._firstFrame = !0, this._cullConfig = l.a.vrConfig, this._skipTaaFrames = 0, this._lastUpdateTime = this._viewerOSGJS.getFrameStamp().getSimulationTime();
            var i = this.dirty.bind(this);
            u.a.bind("change:hasTransparency", i), u.a.bind("change:hasExtra", i), u.a.on("change:hasScattering", i), u.a.on("change:hasRefraction", i), s.a.getMaterial().then(function () {
                this.getBackgroundModel().bind("change:enable", i)
            }.bind(this)), this._hookViewerCheckNeedToDoFrame(), this._hookViewerFrame(), this._hookViewerComputeCanvasSize(), this._model.on("resetTaa", this.onResetTaa.bind(this))
        };
    g.createPrototypeObject(x, {
        dirty: function () {
            this._dirty = !0, S = !0
        },
        onResetTaa: function () {
            this._skipTaaFrames = 2
        },
        getMainCamera: function () {
            return this._view3d._camera
        },
        getNodeIn: function () {
            return this._view3d._nodeIn
        },
        getCurrentComposer: function () {
            return this._view3d._nodeIn._composer
        },
        getBackgroundModel: function () {
            return this._viewer.getFeatures().background.getModel()
        },
        updateTargetDofBlurNear: function () {
            this._interpolatorDofBlurNear.setTarget(this._model.get("dofBlurNear"))
        },
        updateTargetDofBlurFar: function () {
            this._interpolatorDofBlurFar.setTarget(this._model.get("dofBlurFar"))
        },
        getClampedProjectionMatrix: function () {
            var e = this.getMainCamera();
            return e.clampedProjectionMatrix || e.getProjectionMatrix()
        },
        onEffectChanged: function () {
            return r.a.draw(), this.getNodeIn().createPathStandard()
        },
        _toggleComposerCameras: function (e) {
            this._viewer.getSuperSample().setSwitch(e);
            var t = e ? -1 : 0;
            this.getMainCamera().setNodeMask(t);
            var i = this.getCurrentComposer(),
                n = i ? i.getCameras() : void 0;
            if (void 0 !== n)
                for (var r = 0; r < n.length - 1; r++) n[r].setNodeMask(t)
        },
        _hookViewerCheckNeedToDoFrame: function () {
            var e = this._viewerOSGJS,
                t = e.checkNeedToDoFrame.bind(e),
                i = this;
            e.checkNeedToDoFrame = function () {
                this._requestContinousUpdate && r.a.draw();
                var e = t(),
                    n = _;
                return _ = !1, e || !n ? (i._toggleComposerCameras(!0), e) : (i._toggleComposerCameras(!1), !0)
            }
        },
        _hookViewerFrame: function () {
            var e = this.getMainCamera(),
                t = this._viewerOSGJS,
                i = this._viewer.getSuperSample(),
                n = Object(o.a)().vrMirror,
                a = this,
                s = t.frame.bind(t);
            t.frame = function () {
                s(), r.a.setShadowForcedUpdate(!1), b && (b = !1, a._skipTaaFrames = 1, r.a.draw(), s(), S = !0), S && (S = !1, a._skipTaaFrames = 1, r.a.draw(), s()), e.setNodeMask(-1), this._hmd && this._hmd.isPresenting && n && (i.setSwitch(!1), e.setNodeMask(0), this.getCamera().getRenderer().draw())
            }
        },
        _hookViewerComputeCanvasSize: function () {
            this._resizeCanvasTimeout = -1, this._doResizeCanvas = !1, this._overrideCanvasWidth = -1, this._overrideCanvasHeight = -1, this._viewer.bind("resizeViewer", this._onResizeCanvas, this), this._viewer.bind("resizeViewerOnNextFrame", this._onForceResizeCanvas, this), this._cbEnableResizeCanvas = this._enableResizeCanvas.bind(this);
            var e = this._viewerOSGJS,
                t = this._viewer.getCanvas();
            this._originalCanvasResize = e.computeCanvasSize.bind(e, t), e.computeCanvasSize = this._computeCanvasSize.bind(e, t, this)
        },
        _onResizeCanvas: function (e, t) {
            this._overrideCanvasWidth = e, this._overrideCanvasHeight = t, r.a.draw()
        },
        _onForceResizeCanvas: function (e, t) {
            this._enableResizeCanvas(), this._onResizeCanvas(e, t)
        },
        _enableResizeCanvas: function () {
            this._doResizeCanvas = !0
        },
        _resetResizeCanvas: function () {
            this._doResizeCanvas = !1, window.clearTimeout(this._resizeCanvasTimeout)
        },
        _computeCanvasSize: function (e, t) {
            var i = t._overrideCanvasWidth,
                n = t._overrideCanvasHeight;
            if (i > 0) {
                var r = !1;
                return this._canvasWidth !== i && (e.width = i, this._canvasWidth = i, r = !0), this._canvasHeight !== n && (e.height = n, this._canvasHeight = n, r = !0), r
            }
            var a = t._viewer.getFeatures(),
                s = a.inspector;
            if (!s) return !1;
            var u = s.getModel();
            if (t._doResizeCanvas) return u.set("viewerToCanvasRatio", 1), t._resetResizeCanvas(), t._originalCanvasResize();
            var l = Math.max(1, Math.floor(e.clientWidth * this._devicePixelRatio)),
                c = Math.max(1, Math.floor(e.clientHeight * this._devicePixelRatio)),
                h = l / c,
                d = this._canvasWidth / this._canvasHeight,
                f = h / d;
            if (f === u.get("viewerToCanvasRatio")) return !1;
            u.set("viewerToCanvasRatio", f), t._resetResizeCanvas();
            var p = Object(o.a)().resizeTimeout;
            return t._resizeCanvasTimeout = window.setTimeout(t._cbEnableResizeCanvas, p), !1
        },
        showDofCross: function () {
            this._interpolatorDofCross.getCurrent()[0] = 1, this._interpolatorDofCross.setTarget(0), g.vec3.copy(this._dofLastPos, this._model.get("dofFocusPoint")), this._dofLastFocal = this.computeFocalDistance(), r.a.draw()
        },
        hideDofCross: function () {
            this._interpolatorDofCross.getCurrent()[0] = 0, r.a.draw()
        },
        computeFocalDistance: function () {
            var e = g.vec4.create();
            return function () {
                g.vec3.copy(e, this._interpolatorDofFocusPoint.getCurrent())[3] = 1;
                var t = this._viewer.getCamera();
                g.vec4.transformMat4(e, e, t.getViewMatrix()), g.vec4.transformMat4(e, e, this.getClampedProjectionMatrix());
                var i = p.a.uNearFar.getInternalArray();
                return (e[3] - i[0]) / (i[1] - i[0])
            }
        }(),
        _updateInterpolatorDofFocusPoint: function () {
            var e = this._model.get("dofFocusPoint");
            this._interpolatorDofFocusPoint.setTarget(e[0], e[1], e[2])
        },
        updateDofFocusPoint: function () {
            this._updateInterpolatorDofFocusPoint(), this.showDofCross(), this._dofAutoFocus = !1
        },
        updateGrain: function (e) {
            if (this._effectiveConfig.useGrain && this._model.get("grainAnimated")) {
                _ = !0;
                var t = e.getSimulationTime(),
                    i = Object(o.a)().grainSpeed / 1e3;
                i > 0 && t - this._lastUpdateTime >= i && (f.a.uTimeGrain.setFloat(t / 1e3), this._lastUpdateTime = t)
            }
        },
        _callbackPicking: function (e, t, i, n) {
            if (!(e < 0)) {
                if (e >= 1) {
                    var r = this._viewer.getFeaturesManager().getViewport3d(),
                        a = f.a.uDofCross.getInternalArray();
                    t = a[0] * r.width(), i = a[1] * r.height(), e = d.a.pickDepth(n, t, i)
                }
                if (e < 1) {
                    var o = this._model.get("dofFocusPoint");
                    d.a.getWorldPositionFromDepthXY(e, t, i, o), this._updateInterpolatorDofFocusPoint()
                }
                this.dofUpdateShowCross()
            }
        },
        dofPickFocusPoint: function () {
            var e = this._viewer.getFeaturesManager(),
                t = e.getViewport3d(),
                i = this._callbackPicking.bind(this);
            d.a.getPixelDepth(.5 * t.width(), .5 * t.height(), i)
        },
        dofUpdateShowCross: function (e, t) {
            if (this._dofAutoFocus) this._interpolatorDofCross.getCurrent()[0] = 0;
            else {
                var i = g.vec3.dist(this._dofLastPos, this._model.get("dofFocusPoint")),
                    n = this.computeFocalDistance();
                i > .1 * e && Math.abs(n - this._dofLastFocal) > .075 && t > .1 && this.showDofCross()
            }
        },
        dofUpdateInterpolators: function (e, t) {
            this._interpolatorDofBlurNear.setTarget(this._model.get("dofBlurNear") * t), this._interpolatorDofBlurFar.setTarget(this._model.get("dofBlurFar") * t);
            var i = this._viewer.getFeaturesManager(),
                n = i.getViewport3d(),
                r = f.a.uDofCross.getInternalArray();
            d.a.getScreenPositionFromWorldPoint(this._model.get("dofFocusPoint"), r), r[0] /= n.width(), r[1] /= n.height();
            var a = e.getDeltaTime();
            this._interpolatorDofBlurNear.update(a), this._interpolatorDofBlurFar.update(a), this._interpolatorDofFocusPoint.update(a), this._interpolatorDofCross.update(a);
            var o = f.a.uDofBlurNearFarFocal.getInternalArray();
            o[0] = this._interpolatorDofBlurNear.getCurrent()[0], o[1] = this._interpolatorDofBlurFar.getCurrent()[0], o[2] = this.computeFocalDistance(), f.a.uDofCross.getInternalArray()[2] = this._interpolatorDofCross.getCurrent()[0], this._interpolatorDofCross.isDone() || (_ = !0)
        },
        _getAttenuationDof: function (e, t) {
            var i = this._viewerOSGJS.getManipulator(),
                n = i.getHomeBoundingSphere(),
                r = t >= .01 && Object(o.a)().dofAttenuateSpeed ? 0 : 1,
                a = i.getHomeDistance(i.getHomeBoundingSphere());
            if (Object(o.a)().dofAttenuateDistance) {
                var s = g.vec3.dist(n.center(), this._currentEye),
                    u = (s - e) / (a - e);
                r *= Math.max(0, Math.min(1, 1 - u))
            }
            return r
        },
        _getCameraMoveFactorSinceLastFocus: function (e) {
            var t = this._viewerOSGJS.getManipulator().getInverseMatrix();
            g.mat4.getRotation(this._currentRot, t), g.quat.normalize(this._currentRot, this._currentRot);
            var i = g.quat.dot(this._lastRot, this._currentRot);
            i = Math.abs(1 - i * i), this._viewerOSGJS.getManipulator().getEyePosition(this._currentEye);
            var n = g.vec3.dist(this._lastEye, this._currentEye);
            return Math.max(n / e, .1 * i)
        },
        updateDof: function (e) {
            if (this._model.isEffectiveDof()) {
                var t = p.a.uNearFar.getInternalArray();
                if (!(t[0] > t[1])) {
                    this.updateDofScaleUniform();
                    var i = this._viewerOSGJS.getManipulator(),
                        n = i.getHomeBoundingSphere().radius(),
                        r = this._getCameraMoveFactorSinceLastFocus(n),
                        a = this._getAttenuationDof(n, r),
                        u = !0;
                    !this._dofInitialized || Object(o.a)().dofSticky ? (this._updateInterpolatorDofFocusPoint(), s.a.getFirstCameraAnimation().isFulfilled() && (this._dofInitialized = !0)) : this._dofAutoFocus || r > .01 ? (this._dofAutoFocus = r > 1e-5, this.dofPickFocusPoint(), this.dofUpdateShowCross(n, a)) : (this._updateInterpolatorDofFocusPoint(), u = !1), this.dofUpdateInterpolators(e, a), u && (g.vec3.copy(this._lastEye, this._currentEye), g.quat.copy(this._lastRot, this._currentRot))
                }
            }
        },
        updateDofScaleUniform: function () {
            var e = this._viewer.getFeaturesManager(),
                t = e.getViewport3d();
            f.a.uDofScale.getInternalArray()[0] = .0015 * t.height() / Object(o.a)().dofRes
        },
        updateDirtyEffect: function () {
            var e = this._viewerOSGJS.getCanvasWidth(),
                t = this._viewerOSGJS.getCanvasHeight();
            this._width && this._height || (this._width = this._height = -1), this._dirty && (this.onEffectChanged(), this._dirty = !1), e === this._width && t === this._height || (this._viewer.trigger("resizeCanvas", e, t), this.getNodeIn().resetCameraAttachments(), this._width = e, this._height = t, b = !0, r.a.draw())
        },
        updateFade: function (e) {
            var t = this._model.get("vrFading");
            if (this._model.get("vrStartFade") && !t && (this._model.set("vrStartFade", !1), t = !0, this._model.set("vrFading", !0), this._model.set("vrFadeStartTime", e.getSimulationTime())), t) {
                var i = this._model.get("vrFadeStartTime"),
                    n = this._model.get("vrFadeLength"),
                    r = e.getSimulationTime(),
                    a = (r - i) / n,
                    o = this._model.get("vrFadeCallback");
                r > i + n && (a = 1 - (a - 1), o && (o(), this._model.set("vrFadeCallback", void 0)));
                var s = f.a.uVrFadeFactor.getInternalArray();
                a >= 0 ? s[0] = a : (s[0] = 0, this._model.set("vrFading", !1))
            }
        },
        updateVeil: function () {
            f.a.uVrVeilFactor.getInternalArray()[0] = this._model.get("veilFactor")
        },
        _sssGaussian: function (e, t, i) {
            var n = t / (.001 + i);
            return Math.exp(-n * n / (2 * e)) / (2 * Math.PI * e)
        },
        _sssProfile: function (e, t) {
            return .1 * this._sssGaussian(.0484, e, t) + .118 * this._sssGaussian(.187, e, t) + .113 * this._sssGaussian(.567, e, t) + .358 * this._sssGaussian(1.99, e, t) + .078 * this._sssGaussian(7.41, e, t)
        },
        _computeSSSKernel: function (e, t, i, n) {
            var r = Object(o.a)().sssHalfKernel,
                a = 2 * r - 1,
                s = 0,
                u = e * r * 4,
                l = u + 0,
                c = u + 1,
                h = u + 2,
                d = u + 3,
                f = this._model.getSSSWeightRange(),
                p = Math.pow(f, 2),
                m = 2 * f / (a - 1);
            for (s = 0; s < r; s++) {
                var g = f - s * m;
                t[4 * s + d] = f * Math.pow(g, 2) / p
            }
            for (s = 0; s < r; s++) {
                var v = t[4 * s + d],
                    _ = s > 0 ? Math.abs(v - t[4 * (s - 1) + d]) : 0,
                    b = s < r - 1 ? Math.abs(v - t[4 * (s + 1) + d]) : b,
                    S = (_ + b) / 2;
                t[4 * s + l] = S * this._sssProfile(v, n[0]), t[4 * s + c] = S * this._sssProfile(v, n[1]), t[4 * s + h] = S * this._sssProfile(v, n[2])
            }
            s = r - 1;
            for (var x = t[4 * s + l], y = t[4 * s + c], C = t[4 * s + h], T = t[4 * s + d]; s > 0; s--) {
                var w = 4 * s,
                    M = 4 * (s - 1);
                t[w + l] = t[M + l], t[w + c] = t[M + c], t[w + h] = t[M + h], t[w + d] = t[M + d]
            }
            t[l] = x, t[c] = y, t[h] = C, t[d] = T;
            var E = t[l],
                A = t[c],
                P = t[h];
            for (s = 1; s < r; s++) E += 2 * t[4 * s + l], A += 2 * t[4 * s + c], P += 2 * t[4 * s + h];
            for (s = 0; s < r; s++) t[4 * s + l] /= E, t[4 * s + c] /= A, t[4 * s + h] /= P;
            for (t[l] = 1 * (1 - i[0]) + i[0] * t[l], t[c] = 1 * (1 - i[1]) + i[1] * t[c], t[h] = 1 * (1 - i[2]) + i[2] * t[h], s = 1; s < r; s++) t[4 * s + l] *= i[0], t[4 * s + c] *= i[1], t[4 * s + h] *= i[2]
        },
        updateSSS: function () {
            f.a.uProjFactor.getInternalArray()[0] = this.getClampedProjectionMatrix()[0];
            var e = a.a.getModelBoxWithoutDisplacement();
            if (e) {
                var t = e.radius(),
                    i = p.a.uScatteringFactorPacker.getInternalArray(),
                    n = t * c.a.getBoxFactor("SubsurfaceScattering");
                i[0] = 1 / n;
                p.a.uNormalizeFactorThickness.getInternalArray()[0] = .2 * t * .25
            }
            if (!this._model.get("sssKernelDone")) {
                this._model.set("sssKernelDone", !0);
                for (var r = this._model.get("sssProfiles"), s = r.length, u = Object(o.a)().sssHalfKernel, l = new Float32Array(4 * s * u), h = 0, d = r.length; h < d; h++) {
                    var m = r[h];
                    this._computeSSSKernel(h, l, m.strength, m.falloff)
                }
                var v = this._view3d._sssTexKernel;
                if (v.setTextureSize(u, s), v.setMinFilter(g.Texture.LINEAR), v.setMagFilter(g.Texture.LINEAR), this._model.useSSSLookupFloat()) return v.setImage(l, g.Texture.RGBA), void v.setInternalFormatType(g.Texture.FLOAT);
                var _ = new Uint8Array(4 * u * s),
                    b = this._model.getSSSWeightRange();
                for (h = 0; h < u * s; ++h) {
                    var S = 4 * h;
                    _[S] = Math.floor(255 * l[S]), _[S + 1] = Math.floor(255 * l[S + 1]), _[S + 2] = Math.floor(255 * l[S + 2]), _[S + 3] = Math.floor(l[S + 3] / b * 255)
                }
                v.setImage(_, g.Texture.RGBA), v.setInternalFormatType(g.Texture.UNSIGNED_BYTE)
            }
        },
        updateSsao: function () {
            if (this._model.isEffectiveSsao()) {
                var e = p.a.uNearFar.getInternalArray();
                if (!(e[0] > e[1])) {
                    var t = this._viewer.getFeaturesManager(),
                        i = t.getViewport3d(),
                        n = this.getClampedProjectionMatrix(),
                        r = 1 === n[15] ? 1 : 2 / n[5],
                        a = -2 * Math.tan(.5 * r);
                    f.a.uSsaoProjectionScale.setFloat(i.height() / a);
                    var o = f.a.uSsaoProjectionInfo.getInternalArray();
                    o[0] = -2 / (i.width() * n[0]), o[1] = -2 / (i.height() * n[5]), o[2] = (1 - n[8]) / n[0], o[3] = (1 - n[9]) / n[5]
                }
            }
        },
        updateViewSpaceCorners: function () {
            var e = [g.vec4.fromValues(-1, -1, 0, 1), g.vec4.fromValues(-1, 1, 0, 1), g.vec4.fromValues(1, -1, 0, 1), g.vec4.fromValues(1, 1, 0, 1)],
                t = g.mat4.create(),
                i = g.vec3.create();
            return function (n, r) {
                g.mat4.invert(t, n);
                for (var a = 0; a < 4; a++) g.vec3.transformMat4(i, e[a], t), r[2 * a] = i[0] / i[2], r[2 * a + 1] = i[1] / i[2]
            }
        }(),
        updateTaaMatrices: function (e, t, i) {
            g.mat4.invert(i.invViewMatrix.getInternalArray(), e);
            var n = i.lastFrame.getInternalArray(),
                r = i.currentFrame.getInternalArray();
            g.mat4.copy(n, r), g.mat4.multiply(r, t, e), this._firstFrame && g.mat4.copy(n, r), this.updateViewSpaceCorners(t, i.corners.getInternalArray())
        },
        updateTAA: function () {
            var e = g.mat4.create();
            return function () {
                var t = p.a.uNearFar.getInternalArray();
                if (t[0] > t[1] || !this._model.get("taaEnable")) return void f.a.uTaaEnabled.setFloat(0);
                var i, n = this._viewer.getCamera().getViewMatrix(),
                    r = this._cullConfig.doVR;
                r ? (g.mat4.multiply(e, this._cullConfig.leftOffsetView, n), i = this._cullConfig.leftProjection) : (e = n, i = this.getClampedProjectionMatrix());
                var a = f.a;
                this.updateTaaMatrices(e, i, {
                    invViewMatrix: a.uTaaInvViewMatrixLeft,
                    lastFrame: a.uTaaLastFramePVLeft,
                    currentFrame: a.uTaaCurrentFramePVLeft,
                    corners: a.uTaaCornersCSLeft
                }), r && (g.mat4.multiply(e, this._cullConfig.rightOffsetView, n), this.updateTaaMatrices(e, this._cullConfig.rightProjection, {
                    invViewMatrix: a.uTaaInvViewMatrixRight,
                    lastFrame: a.uTaaLastFramePVRight,
                    currentFrame: a.uTaaCurrentFramePVRight,
                    corners: a.uTaaCornersCSRight
                })), this._firstFrame && (this._firstFrame = !1);
                var o = this._viewer.getFeatures().animation.getModel(),
                    s = 0 === this._skipTaaFrames && o.canActivateTAA();
                f.a.uTaaEnabled.setFloat(s ? 1 : 0), this._skipTaaFrames > 0 && --this._skipTaaFrames
            }
        }(),
        updateNearFarRatio: function () {
            var e, t = this._viewer.getFeatures();
            if (this._model.get("webVR")) {
                var i = a.a.getModelBoxWithDisplacement(),
                    n = i ? i.radius() : 1,
                    r = t.webVR.getModel().get("worldFactor") / n;
                e = r > 0 ? .005 * Math.max(.1, r) : .005
            } else e = t.camera.getModel().get("nearFarRatio");
            this.getMainCamera().setNearFarRatio(e)
        },
        updateGlobalTexUniforms: function () {
            var e = this._viewer.getFeaturesManager(),
                t = p.a.uGlobalTexSize.getInternalArray(),
                i = p.a.uGlobalTexRatio.getInternalArray(),
                n = p.a.uHalton.getInternalArray();
            p.a.uPreviousGlobalTexSize.setFloat2(t), p.a.uPreviousGlobalTexRatio.setFloat2(i), p.a.uPreviousHalton.setFloat4(n);
            var r = e.getViewport3d();
            t[0] = r.width(), t[1] = r.height();
            var a = this.getCurrentComposer();
            i[0] = a.getGlobalXRatio(), i[1] = a.getGlobalYRatio();
            var o = a.getInternalTexture("TextureToBeRefracted");
            if (o || this._model.isEffectiveSsr()) {
                var s = p.a.uTextureToBeRefractedSize.getInternalArray();
                if (s[0] = o.getWidth(), s[1] = o.getHeight(), !this._model.get("taaEnable")) {
                    var u = this.getClampedProjectionMatrix(),
                        l = f.a.uTaaCornersCSLeft.getInternalArray();
                    this.updateViewSpaceCorners(u, l)
                }
            }
        },
        _shadowJitterUpdate: function (e) {
            if (m.a.get("mask") & m.a.LIT) {
                var t = 1 + e;
                p.a.uStaticFrameNumShadow0.setFloat(t), p.a.uStaticFrameNumShadow1.setFloat(t), p.a.uStaticFrameNumShadow2.setFloat(t), p.a.uStaticFrameNumShadow3.setFloat(t)
            }
        },
        updateGlobalUniforms: function (e) {
            this.updateNearFarRatio(), this.updateGlobalTexUniforms(), p.a.uTimeViewer.setFloat(e.getSimulationTime() / 1e3);
            var t = a.a.getModelBoxWithDisplacement();
            p.a.uBoxRadius.setFloat(t ? t.radius() : 1), p.a.uPixelRatio.setFloat2(h.a.getPixelRatio());
            var i = e.getFrameNumber() % 16;
            this._shadowJitterUpdate(i), p.a.uFrameMod.setFloat(i);
            var n = this._viewer.getSuperSample().isEnabled(),
                r = n || f.a.uTaaEnabled.getInternalArray()[0];
            p.a.uFrameModTaaSS.setFloat(r ? i : 0);
            var o = p.a.uReprojectViewProj.getInternalArray(),
                s = p.a.uPreviousProjection.getInternalArray(),
                u = p.a.uPreviousViewInvView.getInternalArray(),
                l = this._viewer.getCamera(),
                c = l.getViewMatrix(),
                d = this._cullConfig.doVR ? this._cullConfig.leftProjection : this.getClampedProjectionMatrix();
            this._tmpView ? (g.mat4.invert(u, c), g.mat4.mul(u, this._tmpView, u), g.mat4.mul(o, this._tmpProjection, u), g.mat4.copy(s, this._tmpProjection), g.mat4.copy(this._tmpView, c), g.mat4.copy(this._tmpProjection, d)) : (this._tmpView = g.mat4.clone(c), this._tmpProjection = g.mat4.clone(d), g.mat4.copy(o, d))
        },
        cull: function (e, t) {
            if (t.traverse(e), !this._model.get("postProcessReady")) return !1;
            var i = t.getFrameStamp();
            return this.updateTAA(i), this.updateSSS(i), this.updateSsao(i), this.updateGrain(i), this.updateDof(i), this.updateFade(i), this.updateVeil(i), this.updateDirtyEffect(), this.updateGlobalUniforms(i), !1
        }
    }), t.a = x
}, function (e, t, i) {
    "use strict";
    var n = i(90),
        r = i(1396),
        a = i(1397),
        o = {
            FeatureName: "outline",
            ModelType: r.a,
            ViewListType: [a.a]
        },
        s = n.a.create(o);
    s.prototype.getNode = function () {
        return this._views[0].getNodeOutline()
    }, s.prototype.prepareForScreenShot = function () {
        return this.getNode().hideOutline(), !1
    }, t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(24),
        a = i.n(r),
        o = n.a.osg,
        s = a.a.Model.extend({
            defaults: {
                colorSelection: o.vec3.fromValues(1, 1, 0),
                colorHover: o.vec3.fromValues(1, .5, 0),
                durationOutline: -1,
                durationHighlight: -1
            },
            getName: function () {
                return "Outline"
            }
        });
    t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(8),
        a = i(1398),
        o = i(1399),
        s = n.a.osg,
        u = r.a.extend({
            initialize: function () {
                r.a.prototype.initialize.apply(this, arguments), this._viewer = this.options.context.getViewer(), this._viewerOSGJS = this._viewer.getViewerOSGJS();
                var e = this.model;
                e.bind("change:colorSelection", this.onColorSelectionChanged, this), e.bind("change:colorHover", this.onColorHoverChanged, this), e.bind("hideOutline", this.onHideOutline, this), e.bind("hideHighlight", this.onHideHighlight, this), e.bind("clearFocusTimeout", this.onClearFocusTimeout, this), this._nodeOutline = new a.a(this._viewer), this._nodeOutline.setName("Feature - Outline"), this.onColorSelectionChanged(), this.onColorHoverChanged(), this.model.bind("displayOutlineFocus", this._onMaterialChange.bind(this, !0)), this.model.bind("displayOutlineNoFocus", this._onMaterialChange.bind(this, !1))
            },
            getNodeOutline: function () {
                return this._nodeOutline
            },
            onColorSelectionChanged: function () {
                this._nodeOutline.setColorSelection(this.model.get("colorSelection"))
            },
            onColorHoverChanged: function () {
                this._nodeOutline.setColorHover(this.model.get("colorHover"))
            },
            onHideOutline: function () {
                this._nodeOutline.hideOutline()
            },
            onHideHighlight: function () {
                this._nodeOutline.hideHighlight()
            },
            onClearFocusTimeout: function () {
                void 0 !== this._timer && (window.clearTimeout(this._timer), this._timer = void 0)
            },
            _focusOnBound: function (e) {
                var t = this._viewer.getFeaturesManager(),
                    i = e.getBoundingBox(),
                    n = this._nodeOutline;
                this.onClearFocusTimeout(), this._timer = window.setTimeout(function () {
                    t.focusOnBound(i, 1) || t.focusOnHomePosition(1), n.showOutline()
                }, 200)
            },
            _onMaterialChange: function () {
                var e = new o.a;
                return function (t, i, n) {
                    var r = this._viewer.getFeaturesManager();
                    if (r) {
                        e.setStateSet(i || n), r.getWorldNode().accept(e);
                        var a = e._paths;
                        if (0 === a.length) return void s.error("Cound not find nodes attached to the stateset.");
                        t && this._focusOnBound(e), this._nodeOutline.clearOutlineScene(), i ? (this._nodeOutline.addPaths(a), n && (e.setStateSet(n), r.getWorldNode().accept(e), this._nodeOutline.addPathsHover(e._paths))) : this._nodeOutline.addPathsHover(a), this._nodeOutline.setDurationOutline(1e3 * this.model.get("durationOutline")), this._nodeOutline.setDurationHighlight(1e3 * this.model.get("durationHighlight")), t || this._nodeOutline.showOutline()
                    }
                }
            }()
        });
    t.a = u
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(69),
        a = i(85),
        o = i(712),
        s = i(44),
        u = i(321),
        l = i(88),
        c = i(713),
        h = n.a.osg,
        d = n.a.osgUtil,
        f = h.StateAttribute.OVERRIDE_ON,
        p = function (e) {
            h.Node.call(this), this._viewerWebGL = e, this._viewerOSGJS = e.getViewerOSGJS(), this._durationOutline = 5e3, this._timerOutline = void 0, this._durationHighlight = 5e3, this._timerHighlight = void 0, this._nodeProxy = new h.Node, this._outlineScene = new h.Node, this._paths = void 0, this._cbHideHighlight = this.hideHighlight.bind(this), this._cbHideOutline = this.hideOutline.bind(this);
            var t = l.a.DEPTH_DISABLE;
            this._stateSetSelection = new h.StateSet, this._uColorSelection = h.Uniform.createFloat3("uOutlineColor"), this._stateSetSelection.addUniform(this._uColorSelection), this._stateSetSelection.setAttributeAndModes(t, f), this._stateSetHover = new h.StateSet, this._uColorHover = h.Uniform.createFloat3("uOutlineColor"), this._stateSetHover.addUniform(this._uColorHover), this._stateSetHover.setAttributeAndModes(t, f), this._uOutlineFactor = h.Uniform.createFloat(.25, "uOutlineFactor"), this._uHighlightFactor = h.Uniform.createFloat(0, "uHighlightFactor"), this.init()
        };
    h.createPrototypeNode(p, h.objectInherit(h.Node.prototype, {
        getComposer: function () {
            return this._composer
        },
        setColorSelection: function (e) {
            h.vec3.copy(this._uColorSelection.getInternalArray(), e)
        },
        setColorHover: function (e) {
            h.vec3.copy(this._uColorHover.getInternalArray(), e)
        },
        setDurationHighlight: function (e) {
            this._durationHighlight = e
        },
        setDurationOutline: function (e) {
            this._durationOutline = e
        },
        showOutline: function () {
            u.a.setOutline(!0), this._nodeProxy.setNodeMask(r.a.NO_PICK_NO_SHADOW), this._clearTimeoutOutline(), this._durationOutline >= 0 && (this._timerOutline = setTimeout(this._cbHideOutline, this._durationOutline)), this._uHighlightFactor.setFloat(.15), this._clearTimeoutHighlight(), this._durationHighlight >= 0 && this._durationHighlight < this._durationOutline && (this._timerHighlight = setTimeout(this._cbHideHighlight, this._durationHighlight)), s.a.draw()
        },
        hideOutline: function () {
            this._nodeProxy.setNodeMask(0), this._clearTimeoutOutline(), this.hideHighlight(), s.a.draw()
        },
        hideHighlight: function () {
            this._uHighlightFactor.setFloat(0), this._clearTimeoutHighlight(), s.a.draw()
        },
        _clearTimeoutOutline: function () {
            void 0 !== this._timerOutline && (clearTimeout(this._timerOutline), this._timerOutline = void 0)
        },
        _clearTimeoutHighlight: function () {
            void 0 !== this._timerHighlight && (clearTimeout(this._timerHighlight), this._timerHighlight = void 0)
        },
        clearOutlineScene: function () {
            for (var e = this._outlineScene, t = e.getChildren(), i = 0, n = t.length; i < n; ++i) {
                var r = t[i];
                r.getChildren()[0].removeChildren(), r.removeChildren()
            }
            e.removeChildren()
        },
        _getMaterialNode: function (e) {
            var t = e.getStateSet();
            return t && t.getAttribute("SketchfabMaterial") ? t : void 0
        },
        _getLastMaterialPath: function (e, t) {
            for (var i = t || 0, n = e.length - 1; n >= i; --n) {
                var r = this._getMaterialNode(e[n]);
                if (r) return r
            }
        },
        addPaths: function () {
            var e = function (e) {
                this._path = e
            };
            return h.createPrototypeObject(e, {
                    update: function (t) {
                        return t.setMatrix(h.computeLocalToWorld(this._path)), e
                    }
                }),
                function (t, i) {
                    for (var n = this._outlineScene, r = i ? this._stateSetHover : this._stateSetSelection, a = 0, s = t.length; a < s; ++a) {
                        var u = t[a],
                            l = new h.MatrixTransform,
                            c = new h.Node;
                        n.addChild(l), l.addChild(c);
                        var d = u[u.length - 1];
                        c.addChild(d), l.setStateSet(r), this._getMaterialNode(d) || c.setStateSet(this._getLastMaterialPath(u)), Object(o.a)(u) ? l.addUpdateCallback(new e(u)) : l.setMatrix(h.computeLocalToWorld(u))
                    }
                }
        }(),
        addPathsHover: function (e) {
            this.addPaths(e, !0)
        },
        createSubSceneRtt: function (e) {
            var t = new h.Camera;
            t.setName("Outline Camera"), t.setClearColor(h.vec4.create()), t.setRenderOrder(h.Camera.PRE_RENDER, 0), t.attachTexture(h.FrameBufferObject.COLOR_ATTACHMENT0, e);
            var i = t.getOrCreateStateSet();
            return i.setShaderGeneratorName("outline", f), i.setAttribute(new c.a), t
        },
        init: function () {
            var e = l.a.CULL_DISABLE;
            this._outlineScene.getOrCreateStateSet().setAttributeAndModes(e, f);
            var t = this._createComposer();
            this._composer = t;
            var i = t.getInternalTexture("TextureOutline"),
                n = this.createSubSceneRtt(i);
            this._cameraRtt = n, n.addChild(this._outlineScene), this._nodeProxy.addChild(n), this._nodeProxy.addChild(t), this.addChild(this._nodeProxy), this._nodeProxy.setNodeMask(0)
        },
        _createComposer: function () {
            var e = new d.ComposerPostProcess,
                t = this._viewerOSGJS;
            e.setMethodWrapUV(1, 1), e.setScreenSize(t.getCanvasWidth(), t.getCanvasHeight()), e.setFinalPassUpScaleToScreen(!1), e.addInternalTexture({
                name: "TextureOutline",
                immuable: !0,
                srgb: !0,
                rgbm: !1
            }), e.build({
                func: "outline",
                textures: ["TextureOutline"],
                uniforms: [this._uOutlineFactor, this._uHighlightFactor],
                out: {
                    name: "%next"
                }
            });
            var i = e.getStateSetPass("outline"),
                n = l.a.BLEND_SUBSTRACTIVE;
            return i.setAttributeAndModes(n), i.setRenderBinDetails(a.a.OUTLINE, "RenderBin"), this._viewerWebGL.bind("resizeCanvas", e.resize, e), this._viewerWebGL.bind("resizeRatio", e.resizeRatio, e), e
        }
    }), "osgSketchfab", "Outline"), t.a = p
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = n.a.osg,
        a = n.a.osgAnimation,
        o = function (e) {
            r.ComputeBoundsVisitor.call(this), this._paths = [], this.setStateSet(e)
        };
    r.createPrototypeObject(o, r.objectInherit(r.ComputeBoundsVisitor.prototype, {
        reset: function () {
            r.ComputeBoundsVisitor.prototype.reset.call(this), this._pushIfGeo = !1, this._paths.length = 0, this._bonesBoxMatrix = {}, this._usedBones = {}
        },
        setStateSet: function (e) {
            this.reset(), this._stateSet = e
        },
        getBoundingBox: function () {
            var e = new r.BoundingBox;
            return function () {
                for (var t in this._usedBones) {
                    var i = this._bonesBoxMatrix[t];
                    i && (e.copy(i.box), e.transformMat4(e, i.matrix), this._bb.expandByBoundingBox(e))
                }
                return this._bb
            }
        }(),
        apply: function (e) {
            var t = e.getStateSet(),
                i = this._pushIfGeo;
            if (t && void 0 !== t._materialID && (this._pushIfGeo = t === this._stateSet), this._pushIfGeo && e instanceof r.Geometry && (this._paths.push(this.nodePath.slice(0)), e instanceof a.RigGeometry)) {
                var n = e.getBoneNameID();
                for (var o in n) this._usedBones[o] = 1
            }
            r.ComputeBoundsVisitor.prototype.apply.call(this, e), this._pushIfGeo = i
        },
        pushMatrix: function (e) {
            var t = this.nodePath[this.nodePath.length - 1];
            if (t instanceof a.Bone) {
                var i = t.getBoneBoundingBox();
                i.valid() && (this._bonesBoxMatrix[t.getName()] = {
                    matrix: r.mat4.clone(e),
                    box: i
                })
            }
            r.ComputeBoundsVisitor.prototype.pushMatrix.call(this, e)
        },
        applyBoundingBox: function (e) {
            this._pushIfGeo && r.ComputeBoundsVisitor.prototype.applyBoundingBox.call(this, e)
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(90),
        r = i(1401),
        a = i(1406),
        o = {
            FeatureName: "webVR",
            ModelType: r.a,
            ViewListType: [a.a]
        },
        s = n.a.create(o);
    s.prototype.getNode = function () {
        return this._views[0].getNodeWebVR()
    }, s.prototype.getWidgetNode = function () {
        return this._views[0].getProxyWebVR()
    }, s.prototype.prepareForScreenShot = function () {
        var e = n.a.prototype.prepareForScreenShot.call(this);
        return e && this._views[0].setPauseUpdate(!0), e
    }, s.prototype.resetAfterScreenShot = function () {
        n.a.prototype.resetAfterScreenShot.call(this), this._views[0].setPauseUpdate(!1)
    }, t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(20),
        a = i(1402),
        o = i(1404),
        s = i(103),
        u = i(47),
        l = i(149),
        c = n.a.osg;
    Object(r.a)().vrForceRaf && (n.a.osgViewer.Viewer.prototype.setVRDisplay = function (e) {
        this._hmd = e, this._requestAnimationFrame = e.requestAnimationFrame.bind(e)
    });
    var h = l.a.extend({
        getModelOptionPath: function () {
            return "vr"
        },
        defaults: {
            enable: !1,
            deviceInfo: void 0,
            modeLauncher: !1,
            hit: void 0,
            hasNativeHMD: !1,
            humanMatrix: c.mat4.create(),
            humanInAir: !1
        },
        init: function (e) {
            this._context = e, this._scene = e.getScene(), this._viewer = e.getViewer()
        },
        initAfterFirstFrame: function () {
            this.set("deviceInfo", this._initDeviceInfo());
            var e = this._context.getModel().get("options").vr;
            e && e.worldFactor > 0 && this.setJSON(e), this.initBoundAndWorldFactor(), this.set("enable", Object(r.a)().cardboard > 0)
        },
        onVrDisplayReady: function (e) {
            u.a.getVrDisplayReady().isFulfilled() ? e() : u.a.getVrDisplayReady().then(function () {
                e()
            })
        },
        _getBoundRadius: function () {
            return s.a.getModelBoxWithDisplacement().radius()
        },
        isDiorama: function () {
            return this._getBoundRadius() < 2 * this.get("worldFactor")
        },
        getMinimumWorldFactor: function () {
            return .001 * this._getBoundRadius()
        },
        setLastControllerHit: function (e) {
            this._lastControllerHit = e
        },
        getlastControllerHit: function () {
            return this._lastControllerHit
        },
        getMaximumWorldFactor: function () {
            return 10 * this._getBoundRadius()
        },
        getDefaultHumanHeight: function () {
            return 1.65
        },
        _makeValidWorldFactor: function () {
            var e = this.get("worldFactor"),
                t = this.getMinimumWorldFactor(),
                i = this.getMaximumWorldFactor();
            if (e < t * s.a.BIAS_MIN || e > i * s.a.BIAS_MAX) {
                var n = s.a.getModelBoxWithDisplacement(),
                    r = n.getMin()[2],
                    a = n.radius();
                this.set("worldFactor", .5 * a), this.set("floorHeight", r);
                var o = n.center(c.vec3.create());
                o[1] -= 1.2 * a, o[2] = r, c.mat4.fromTranslation(this.get("humanMatrix"), o)
            } else this.set("worldFactor", Math.min(Math.max(e, t), i))
        },
        initBoundAndWorldFactor: function () {
            this._makeValidWorldFactor(), this.trigger("uiReady")
        },
        _initDeviceInfo: function () {
            var e = new o.a(!1),
                t = new a.a(e.getDeviceParams());
            return Object(r.a)().cardboard > 1 && t.setViewer(a.a.Viewers.CardboardV2), t
        },
        getName: function () {
            return "WebVR"
        },
        setJSON: function (e, t) {
            var i = t || {};
            i.ignore = ["initialCamera"];
            var n = l.a.prototype.setJSON.call(this, e, i),
                r = this.get("humanMatrix"),
                a = e.initialCamera;
            return c.mat4.fromQuat(r, a.rotation), c.mat4.setTranslation(r, a.position), n
        },
        getJSON: function () {
            var e = c.mat4.copy(c.mat4.create(), this.get("humanMatrix")),
                t = c.mat4.getScale(c.vec3.create(), e);
            c.vec3.set(t, 1 / t[0], 1 / t[1], 1 / t[2]);
            var i = c.mat4.scale(e, e, t),
                n = c.quat.create();
            c.quat.normalize(n, c.mat4.getRotation(n, i));
            var r = l.a.prototype.getJSON.call(this, {
                ignore: "initialCamera"
            });
            return r.initialCamera = {
                position: c.mat4.getTranslation(c.vec3.create(), i),
                rotation: n
            }, r
        }
    });
    t.a = h
}, function (e, t, i) {
    "use strict";

    function n(e) {
        this.viewer = p.CardboardV1, this.updateDeviceParams(e)
    }
    var r = i(9),
        a = i(1403),
        o = i(714),
        s = r.a.osg,
        u = 180 / Math.PI,
        l = Math.PI / 180,
        c = function (e) {
            this.id = e.id, this.label = e.label, this.fov = e.fov, this.interLensDistance = e.interLensDistance, this.baselineLensDistance = e.baselineLensDistance, this.screenLensDistance = e.screenLensDistance, this.distortionCoefficients = e.distortionCoefficients, this.inverseCoefficients = e.inverseCoefficients
        },
        h = function (e) {
            this.width = e.width || o.a.getScreenWidth(), this.height = e.height || o.a.getScreenHeight(), this.widthMeters = e.widthMeters, this.heightMeters = e.heightMeters, this.bevelMeters = e.bevelMeters
        },
        d = new h({
            widthMeters: .11,
            heightMeters: .062,
            bevelMeters: .004
        }),
        f = new h({
            widthMeters: .1038,
            heightMeters: .0584,
            bevelMeters: .004
        }),
        p = {
            CardboardV1: new c({
                id: "CardboardV1",
                label: "Cardboard I/O 2014",
                fov: 40,
                interLensDistance: .06,
                baselineLensDistance: .035,
                screenLensDistance: .042,
                distortionCoefficients: [.441, .156],
                inverseCoefficients: [-.4410035, .42756155, -.4804439, .5460139, -.58821183, .5733938, -.48303202, .33299083, -.17573841, .0651772, -.01488963, .001559834]
            }),
            CardboardV2: new c({
                id: "CardboardV2",
                label: "Cardboard I/O 2015",
                fov: 60,
                interLensDistance: .064,
                baselineLensDistance: .035,
                screenLensDistance: .039,
                distortionCoefficients: [.34, .55],
                inverseCoefficients: [-.33836704, -.18162185, .862655, -1.2462051, 1.0560602, -.58208317, .21609078, -.05444823, .009177956, -.0009904169, 6183535e-11, -16981803e-13]
            })
        };
    n.prototype.updateDeviceParams = function (e) {
        this.device = this.determineDevice_(e) || this.device
    }, n.prototype.getDevice = function () {
        return this.device
    }, n.prototype.setViewer = function (e) {
        this.viewer = e
    }, n.prototype.determineDevice_ = function (e) {
        if (!e) return o.a.isIOS() ? f : d;
        var t = .0254 / e.xdpi,
            i = .0254 / e.ydpi,
            n = o.a.getScreenWidth(),
            r = o.a.getScreenHeight();
        return new h({
            widthMeters: t * n,
            heightMeters: i * r,
            bevelMeters: .001 * e.bevelMm
        })
    }, n.prototype.getDistortedFieldOfViewLeftEye = function () {
        var e = this.viewer,
            t = this.device,
            i = new a.a(e.distortionCoefficients),
            n = e.screenLensDistance,
            r = (t.widthMeters - e.interLensDistance) / 2,
            o = e.interLensDistance / 2,
            s = e.baselineLensDistance - t.bevelMeters,
            l = t.heightMeters - s,
            c = u * Math.atan(i.distort(r / n)),
            h = u * Math.atan(i.distort(o / n)),
            d = u * Math.atan(i.distort(s / n)),
            f = u * Math.atan(i.distort(l / n));
        return {
            leftDegrees: Math.min(c, e.fov),
            rightDegrees: Math.min(h, e.fov),
            downDegrees: Math.min(d, e.fov),
            upDegrees: Math.min(f, e.fov)
        }
    }, n.prototype.getFieldOfViewLeftEye = function (e) {
        return e ? this.getUndistortedFieldOfViewLeftEye() : this.getDistortedFieldOfViewLeftEye()
    }, n.prototype.getFieldOfViewRightEye = function (e) {
        var t = this.getFieldOfViewLeftEye(e);
        return {
            leftDegrees: t.rightDegrees,
            rightDegrees: t.leftDegrees,
            upDegrees: t.upDegrees,
            downDegrees: t.downDegrees
        }
    }, n.prototype.getProjectionMatrixLeftEye = function (e) {
        var t = this.getFieldOfViewLeftEye(e),
            i = s.mat4.create(),
            n = .1 * Math.tan(l * t.leftDegrees),
            r = .1 * Math.tan(l * t.rightDegrees),
            a = .1 * Math.tan(l * t.downDegrees),
            o = .1 * Math.tan(l * t.upDegrees);
        return s.mat4.frustum(i, -n, r, -a, o, .1, 1e3), i
    }, n.prototype.getUndistortedViewportLeftEye = function () {
        var e = this.getUndistortedParams_(),
            t = this.viewer,
            i = this.device,
            n = t.screenLensDistance,
            r = i.widthMeters / n,
            a = i.heightMeters / n,
            o = i.width / r,
            s = i.height / a,
            u = Math.round((e.eyePosX - e.outerDist) * o),
            l = Math.round((e.eyePosY - e.bottomDist) * s);
        return {
            x: u,
            y: l,
            width: Math.round((e.eyePosX + e.innerDist) * o) - u,
            height: Math.round((e.eyePosY + e.topDist) * s) - l
        }
    }, n.prototype.getUndistortedFieldOfViewLeftEye = function () {
        var e = this.getUndistortedParams_();
        return {
            leftDegrees: u * Math.atan(e.outerDist),
            rightDegrees: u * Math.atan(e.innerDist),
            downDegrees: u * Math.atan(e.bottomDist),
            upDegrees: u * Math.atan(e.topDist)
        }
    }, n.prototype.getUndistortedParams_ = function () {
        var e = this.viewer,
            t = this.device,
            i = new a.a(e.distortionCoefficients),
            n = e.screenLensDistance,
            r = e.interLensDistance / 2 / n,
            o = t.widthMeters / n,
            s = t.heightMeters / n,
            u = o / 2 - r,
            c = (e.baselineLensDistance - t.bevelMeters) / n,
            h = e.fov,
            d = i.distortInverse(Math.tan(l * h)),
            f = Math.min(u, d),
            p = Math.min(r, d),
            m = Math.min(c, d);
        return {
            outerDist: f,
            innerDist: p,
            topDist: Math.min(s - c, d),
            bottomDist: m,
            eyePosX: u,
            eyePosY: c
        }
    }, n.Viewers = p, t.a = n
}, function (e, t, i) {
    "use strict";
    var n = function (e) {
        this.coefficients = e
    };
    n.prototype.distortInverse = function (e) {
        for (var t = e / .9, i = .9 * e, n = e - this.distort(t); Math.abs(i - t) > 1e-4;) {
            var r = e - this.distort(i),
                a = i - r * ((i - t) / (r - n));
            t = i, i = a, n = r
        }
        return i
    }, n.prototype.distort = function (e) {
        return e * this.distortionFactor_(e)
    }, n.prototype.distortionFactor_ = function (e) {
        for (var t = 1, i = 1, n = e * e, r = 0; r < this.coefficients.length; r++) {
            var a = this.coefficients[r];
            i *= n, t += a * i
        }
        return t
    }, t.a = n
}, function (e, t, i) {
    "use strict";
    var n = i(1405),
        r = i(714),
        a = function (e) {
            this.xdpi = e.xdpi, this.ydpi = e.ydpi, this.bevelMm = e.bevelMm
        },
        o = function (e, t) {
            if (this.dpdb = n.a, this.recalculateDeviceParams_(), e) {
                this.onDeviceParamsUpdated = t;
                var i = new XMLHttpRequest,
                    r = this;
                i.open("GET", "https://dpdb.webvr.rocks/dpdb.json", !0), i.addEventListener("load", function () {
                    r.loading = !1, i.status >= 200 && i.status <= 299 && (r.dpdb = JSON.parse(i.response), r.recalculateDeviceParams_())
                }), i.send()
            }
        };
    o.prototype.getDeviceParams = function () {
        return this.deviceParams
    }, o.prototype.recalculateDeviceParams_ = function () {
        var e = this.calcDeviceParams_();
        e && (this.deviceParams = e, this.onDeviceParamsUpdated && this.onDeviceParamsUpdated(this.deviceParams))
    }, o.prototype.calcDeviceParams_ = function () {
        var e = this.dpdb;
        if (!e) return null;
        if (1 !== e.format) return null;
        if (!e.devices || !e.devices.length) return null;
        var t = navigator.userAgent || navigator.vendor || window.opera,
            i = r.a.getScreenWidth(),
            n = r.a.getScreenHeight();
        if (!e.devices) return null;
        for (var o = 0; o < e.devices.length; o++) {
            var s = e.devices[o];
            if (s.rules && (("ios" === s.type || "android" === s.type) && r.a.isIOS() === ("ios" === s.type))) {
                for (var u = !1, l = 0; l < s.rules.length; l++) {
                    var c = s.rules[l];
                    if (this.matchRule_(c, t, i, n)) {
                        u = !0;
                        break
                    }
                }
                if (u) {
                    var h = s.dpi[0] || s.dpi,
                        d = s.dpi[1] || s.dpi;
                    return new a({
                        xdpi: h,
                        ydpi: d,
                        bevelMm: s.bw
                    })
                }
            }
        }
        return null
    }, o.prototype.matchRule_ = function (e, t, i, n) {
        if (!e.ua && !e.res) return !1;
        if (e.ua && t.indexOf(e.ua) < 0) return !1;
        if (e.res) {
            if (!e.res[0] || !e.res[1]) return !1;
            var r = e.res[0],
                a = e.res[1];
            if (Math.min(i, n) !== Math.min(r, a) || Math.max(i, n) !== Math.max(r, a)) return !1
        }
        return !0
    }, t.a = o
}, function (e, t, i) {
    "use strict";
    var n = {
        format: 1,
        last_updated: "2017-08-27T14:39:31Z",
        devices: [{
            type: "android",
            rules: [{
                mdmh: "asus/*/Nexus 7/*"
            }, {
                ua: "Nexus 7"
            }],
            dpi: [320.8, 323],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "asus/*/ASUS_Z00AD/*"
            }, {
                ua: "ASUS_Z00AD"
            }],
            dpi: [403, 404.6],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "Google/*/Pixel XL/*"
            }, {
                ua: "Pixel XL"
            }],
            dpi: [537.9, 533],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "Google/*/Pixel/*"
            }, {
                ua: "Pixel"
            }],
            dpi: [432.6, 436.7],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "HTC/*/HTC6435LVW/*"
            }, {
                ua: "HTC6435LVW"
            }],
            dpi: [449.7, 443.3],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "HTC/*/HTC One XL/*"
            }, {
                ua: "HTC One XL"
            }],
            dpi: [315.3, 314.6],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "htc/*/Nexus 9/*"
            }, {
                ua: "Nexus 9"
            }],
            dpi: 289,
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "HTC/*/HTC One M9/*"
            }, {
                ua: "HTC One M9"
            }],
            dpi: [442.5, 443.3],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "HTC/*/HTC One_M8/*"
            }, {
                ua: "HTC One_M8"
            }],
            dpi: [449.7, 447.4],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "HTC/*/HTC One/*"
            }, {
                ua: "HTC One"
            }],
            dpi: 472.8,
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "Huawei/*/Nexus 6P/*"
            }, {
                ua: "Nexus 6P"
            }],
            dpi: [515.1, 518],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "LENOVO/*/Lenovo PB2-690Y/*"
            }, {
                ua: "Lenovo PB2-690Y"
            }],
            dpi: [457.2, 454.713],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "LGE/*/Nexus 5X/*"
            }, {
                ua: "Nexus 5X"
            }],
            dpi: [422, 419.9],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "LGE/*/LGMS345/*"
            }, {
                ua: "LGMS345"
            }],
            dpi: [221.7, 219.1],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "LGE/*/LG-D800/*"
            }, {
                ua: "LG-D800"
            }],
            dpi: [422, 424.1],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "LGE/*/LG-D850/*"
            }, {
                ua: "LG-D850"
            }],
            dpi: [537.9, 541.9],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "LGE/*/VS985 4G/*"
            }, {
                ua: "VS985 4G"
            }],
            dpi: [537.9, 535.6],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "LGE/*/Nexus 5/*"
            }, {
                ua: "Nexus 5 B"
            }],
            dpi: [442.4, 444.8],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "LGE/*/Nexus 4/*"
            }, {
                ua: "Nexus 4"
            }],
            dpi: [319.8, 318.4],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "LGE/*/LG-P769/*"
            }, {
                ua: "LG-P769"
            }],
            dpi: [240.6, 247.5],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "LGE/*/LGMS323/*"
            }, {
                ua: "LGMS323"
            }],
            dpi: [206.6, 204.6],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "LGE/*/LGLS996/*"
            }, {
                ua: "LGLS996"
            }],
            dpi: [403.4, 401.5],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "Micromax/*/4560MMX/*"
            }, {
                ua: "4560MMX"
            }],
            dpi: [240, 219.4],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "Micromax/*/A250/*"
            }, {
                ua: "Micromax A250"
            }],
            dpi: [480, 446.4],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "Micromax/*/Micromax AQ4501/*"
            }, {
                ua: "Micromax AQ4501"
            }],
            dpi: 240,
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "motorola/*/DROID RAZR/*"
            }, {
                ua: "DROID RAZR"
            }],
            dpi: [368.1, 256.7],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "motorola/*/XT830C/*"
            }, {
                ua: "XT830C"
            }],
            dpi: [254, 255.9],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "motorola/*/XT1021/*"
            }, {
                ua: "XT1021"
            }],
            dpi: [254, 256.7],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "motorola/*/XT1023/*"
            }, {
                ua: "XT1023"
            }],
            dpi: [254, 256.7],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "motorola/*/XT1028/*"
            }, {
                ua: "XT1028"
            }],
            dpi: [326.6, 327.6],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "motorola/*/XT1034/*"
            }, {
                ua: "XT1034"
            }],
            dpi: [326.6, 328.4],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "motorola/*/XT1053/*"
            }, {
                ua: "XT1053"
            }],
            dpi: [315.3, 316.1],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "motorola/*/XT1562/*"
            }, {
                ua: "XT1562"
            }],
            dpi: [403.4, 402.7],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "motorola/*/Nexus 6/*"
            }, {
                ua: "Nexus 6 B"
            }],
            dpi: [494.3, 489.7],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "motorola/*/XT1063/*"
            }, {
                ua: "XT1063"
            }],
            dpi: [295, 296.6],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "motorola/*/XT1064/*"
            }, {
                ua: "XT1064"
            }],
            dpi: [295, 295.6],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "motorola/*/XT1092/*"
            }, {
                ua: "XT1092"
            }],
            dpi: [422, 424.1],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "motorola/*/XT1095/*"
            }, {
                ua: "XT1095"
            }],
            dpi: [422, 423.4],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "motorola/*/G4/*"
            }, {
                ua: "Moto G (4)"
            }],
            dpi: 401,
            bw: 4,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "OnePlus/*/A0001/*"
            }, {
                ua: "A0001"
            }],
            dpi: [403.4, 401],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "OnePlus/*/ONE E1005/*"
            }, {
                ua: "ONE E1005"
            }],
            dpi: [442.4, 441.4],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "OnePlus/*/ONE A2005/*"
            }, {
                ua: "ONE A2005"
            }],
            dpi: [391.9, 405.4],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "OPPO/*/X909/*"
            }, {
                ua: "X909"
            }],
            dpi: [442.4, 444.1],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/GT-I9082/*"
            }, {
                ua: "GT-I9082"
            }],
            dpi: [184.7, 185.4],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-G360P/*"
            }, {
                ua: "SM-G360P"
            }],
            dpi: [196.7, 205.4],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/Nexus S/*"
            }, {
                ua: "Nexus S"
            }],
            dpi: [234.5, 229.8],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/GT-I9300/*"
            }, {
                ua: "GT-I9300"
            }],
            dpi: [304.8, 303.9],
            bw: 5,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-T230NU/*"
            }, {
                ua: "SM-T230NU"
            }],
            dpi: 216,
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SGH-T399/*"
            }, {
                ua: "SGH-T399"
            }],
            dpi: [217.7, 231.4],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SGH-M919/*"
            }, {
                ua: "SGH-M919"
            }],
            dpi: [440.8, 437.7],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-N9005/*"
            }, {
                ua: "SM-N9005"
            }],
            dpi: [386.4, 387],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SAMSUNG-SM-N900A/*"
            }, {
                ua: "SAMSUNG-SM-N900A"
            }],
            dpi: [386.4, 387.7],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/GT-I9500/*"
            }, {
                ua: "GT-I9500"
            }],
            dpi: [442.5, 443.3],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/GT-I9505/*"
            }, {
                ua: "GT-I9505"
            }],
            dpi: 439.4,
            bw: 4,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-G900F/*"
            }, {
                ua: "SM-G900F"
            }],
            dpi: [415.6, 431.6],
            bw: 5,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-G900M/*"
            }, {
                ua: "SM-G900M"
            }],
            dpi: [415.6, 431.6],
            bw: 5,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-G800F/*"
            }, {
                ua: "SM-G800F"
            }],
            dpi: 326.8,
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-G906S/*"
            }, {
                ua: "SM-G906S"
            }],
            dpi: [562.7, 572.4],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/GT-I9300/*"
            }, {
                ua: "GT-I9300"
            }],
            dpi: [306.7, 304.8],
            bw: 5,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-T535/*"
            }, {
                ua: "SM-T535"
            }],
            dpi: [142.6, 136.4],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-N920C/*"
            }, {
                ua: "SM-N920C"
            }],
            dpi: [515.1, 518.4],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-N920W8/*"
            }, {
                ua: "SM-N920W8"
            }],
            dpi: [515.1, 518.4],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/GT-I9300I/*"
            }, {
                ua: "GT-I9300I"
            }],
            dpi: [304.8, 305.8],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/GT-I9195/*"
            }, {
                ua: "GT-I9195"
            }],
            dpi: [249.4, 256.7],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SPH-L520/*"
            }, {
                ua: "SPH-L520"
            }],
            dpi: [249.4, 255.9],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SAMSUNG-SGH-I717/*"
            }, {
                ua: "SAMSUNG-SGH-I717"
            }],
            dpi: 285.8,
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SPH-D710/*"
            }, {
                ua: "SPH-D710"
            }],
            dpi: [217.7, 204.2],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/GT-N7100/*"
            }, {
                ua: "GT-N7100"
            }],
            dpi: 265.1,
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SCH-I605/*"
            }, {
                ua: "SCH-I605"
            }],
            dpi: 265.1,
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/Galaxy Nexus/*"
            }, {
                ua: "Galaxy Nexus"
            }],
            dpi: [315.3, 314.2],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-N910H/*"
            }, {
                ua: "SM-N910H"
            }],
            dpi: [515.1, 518],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-N910C/*"
            }, {
                ua: "SM-N910C"
            }],
            dpi: [515.2, 520.2],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-G130M/*"
            }, {
                ua: "SM-G130M"
            }],
            dpi: [165.9, 164.8],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-G928I/*"
            }, {
                ua: "SM-G928I"
            }],
            dpi: [515.1, 518.4],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-G920F/*"
            }, {
                ua: "SM-G920F"
            }],
            dpi: 580.6,
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-G920P/*"
            }, {
                ua: "SM-G920P"
            }],
            dpi: [522.5, 577],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-G925F/*"
            }, {
                ua: "SM-G925F"
            }],
            dpi: 580.6,
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-G925V/*"
            }, {
                ua: "SM-G925V"
            }],
            dpi: [522.5, 576.6],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-G930F/*"
            }, {
                ua: "SM-G930F"
            }],
            dpi: 576.6,
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-G935F/*"
            }, {
                ua: "SM-G935F"
            }],
            dpi: 533,
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-G950F/*"
            }, {
                ua: "SM-G950F"
            }],
            dpi: [562.707, 565.293],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "samsung/*/SM-G955U/*"
            }, {
                ua: "SM-G955U"
            }],
            dpi: [522.514, 525.762],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "Sony/*/C6903/*"
            }, {
                ua: "C6903"
            }],
            dpi: [442.5, 443.3],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "Sony/*/D6653/*"
            }, {
                ua: "D6653"
            }],
            dpi: [428.6, 427.6],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "Sony/*/E6653/*"
            }, {
                ua: "E6653"
            }],
            dpi: [428.6, 425.7],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "Sony/*/E6853/*"
            }, {
                ua: "E6853"
            }],
            dpi: [403.4, 401.9],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "Sony/*/SGP321/*"
            }, {
                ua: "SGP321"
            }],
            dpi: [224.7, 224.1],
            bw: 3,
            ac: 500
        }, {
            type: "android",
            rules: [{
                mdmh: "TCT/*/ALCATEL ONE TOUCH Fierce/*"
            }, {
                ua: "ALCATEL ONE TOUCH Fierce"
            }],
            dpi: [240, 247.5],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "THL/*/thl 5000/*"
            }, {
                ua: "thl 5000"
            }],
            dpi: [480, 443.3],
            bw: 3,
            ac: 1e3
        }, {
            type: "android",
            rules: [{
                mdmh: "ZTE/*/ZTE Blade L2/*"
            }, {
                ua: "ZTE Blade L2"
            }],
            dpi: 240,
            bw: 3,
            ac: 500
        }, {
            type: "ios",
            rules: [{
                res: [640, 960]
            }],
            dpi: [325.1, 328.4],
            bw: 4,
            ac: 1e3
        }, {
            type: "ios",
            rules: [{
                res: [640, 1136]
            }],
            dpi: [317.1, 320.2],
            bw: 3,
            ac: 1e3
        }, {
            type: "ios",
            rules: [{
                res: [750, 1334]
            }],
            dpi: 326.4,
            bw: 4,
            ac: 1e3
        }, {
            type: "ios",
            rules: [{
                res: [1242, 2208]
            }],
            dpi: [453.6, 458.4],
            bw: 4,
            ac: 1e3
        }, {
            type: "ios",
            rules: [{
                res: [1125, 2001]
            }],
            dpi: [410.9, 415.4],
            bw: 4,
            ac: 1e3
        }]
    };
    t.a = n
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(9)),
        a = i(8),
        o = i(47),
        s = i(583),
        u = i(44),
        l = i(714),
        c = i(85),
        h = i(69),
        d = i(20),
        f = i(424),
        p = i.n(f),
        m = i(930),
        g = i(38),
        v = i.n(g),
        _ = i(1407),
        b = i(1410),
        S = i(1413),
        x = i(1416),
        y = i(1419),
        C = i(1420),
        T = i(159),
        w = i(88),
        M = i(199),
        E = i(179),
        A = r.a.osg,
        P = r.a.osgUtil,
        R = r.a.InputGroups,
        O = new p.a({
            device: "VWR",
            listen: !0
        }),
        I = a.a.extend({
            initialize: function () {
                a.a.prototype.initialize.apply(this, arguments);
                var e = this.model;
                e.bind("change:enable", this.onEnable, this), e.bind("change:worldFactor", this.onWorldFactor, this), e.bind("change:floorHeight", this.onFloorHeight, this), e.bind("doubleTap", this.onDoubleTap, this), e.bind("snapHumanOnFloor", this.snapHumanOnFloor, this), this._standaloneViewer = !Object(d.a)().messaging, O.on("message:requestPresent", this.onRequestPresent, this), this._viewer = this.options.context.getViewer(), this._viewerOSGJS = this._viewer.getViewerOSGJS(), this._manipulator = this._viewerOSGJS.getManipulator(), this._cullConfig = s.a.vrConfig, this._lastSelectedHotspot = void 0, this._lastHoveredHotspot = void 0, this._lastFloorHeight = 0, this._lastTime = 0, this._lastWorldFactor = -1, this._lastMouse = A.vec2.create(), this._interpolatorAlpha = new P.DelayInterpolator(1), this._interpolatorAlpha.setDelay(.1), this._webvrMaxHeight = this.getWebVRMaxHeight(), this._nodeWebVR = new A.Node, this._nodeWebVR.setName("Feature - WebVR"), this._proxyVR = new A.Node, this._proxyVR.setName("WebVR - Proxy"), this._proxyVR.setNodeMask(0), this._floorMT = new x.a(e), this._humanMT = new _.a(e), this._teleportNode = new b.a, this._cursorMT = new S.a, this._controllerMT = new y.a(e, this._viewer.getInputManager()), this._nodeMenu = new C.a(e), this._nodeMenu.setHomeAction(this._exitVR.bind(this)), this._nodeMenu.setNextAction(this.goToNextHotspot.bind(this)), this._nodeMenu.setPrevAction(this.goToPrevHotspot.bind(this)), this._dataDownloaded = !1, this._scaleControlEnabled = !0, this._frameData = void 0, this.onFloorHeight(), this.initGraphNodes(), this.hookComputeCanvasSize(), M.a.initWebVR(this), this._onVrDisplayActivateBinded = this._onVrDisplayActivate.bind(this), this._onVrDisplayDeactivateBinded = this._onVrDisplayDeactivate.bind(this), this._onVrDisplayPresentChangeBinded = this._onVrDisplayPresentChange.bind(this), this._onVrDisplayPointerRestrictedBinded = this._onVrDisplayPointerRestricted.bind(this), this._onVrDisplayPointerUnrestrictedBinded = this._onVrDisplayPointerUnrestricted.bind(this), this._viewerOSGJS.getInputManager().getInputSource("WebVR").pollHeadset(), o.a.getModelDisplayed().then(this.initWebVR.bind(this))
            },
            getNodeWebVR: function () {
                return this._nodeWebVR
            },
            getProxyWebVR: function () {
                return this._proxyVR
            },
            getWebVRMaxHeight: function () {
                return v.a.any ? Math.min(window.screen.width, window.screen.height) * Math.min(2.5, window.devicePixelRatio) : -1
            },
            _onVrDisplayPointerRestricted: function () {
                this._viewer.getCanvas().requestPointerLock()
            },
            _onVrDisplayPointerUnrestricted: function () {
                document.exitPointerLock()
            },
            onRequestPresent: function (e) {
                this._standaloneViewer ? A.log("Launcher onRequestPresent") : A.log("Viewer onRequestPresent"), this.startEnable(!0, !0), e.removeFromHash()
            },
            initWebVR: function () {
                this._nodeWebVR.addUpdateCallback(this)
            },
            setProxyVisible: function (e) {
                this._proxyVR.setNodeMask(e ? h.a.NO_SHADOW : 0)
            },
            onDoubleTap: function (e) {
                if (!this.model.get("enable") && -1 === e._nodePath.indexOf(this._humanMT)) {
                    var t = A.vec3.create();
                    T.a.getWorldPositionFromHit(e, t), A.mat4.setTranslation(this._humanMT.getMatrix(), t), u.a.draw()
                }
            },
            scaleUp: function () {
                var e = this.model.get("worldFactor");
                e <= 0 || this.model.set("worldFactor", 1.2 * e)
            },
            scaleDown: function () {
                var e = this.model.get("worldFactor");
                e <= 0 || this.model.set("worldFactor", e * (1 / 1.2))
            },
            savePosition: function (e) {
                this._lastMouse[0] = e.canvasX, this._lastMouse[1] = e.canvasX
            },
            onFloorHeight: function () {
                var e = this.model.get("floorHeight"),
                    t = .05 * this.model.get("worldFactor");
                Math.abs(this._humanMT.getMatrix()[14] - this._lastFloorHeight) <= t && (this._humanMT.getMatrix()[14] = e), this._floorMT.getMatrix()[14] = e, this._lastFloorHeight = e
            },
            initGraphNodes: function () {
                this._nodeWebVR.addChild(this._proxyVR), this._proxyVR.addChild(this._floorMT), this._proxyVR.addChild(this._humanMT), this._proxyVR.addChild(this._teleportNode), this._proxyVR.addChild(this._cursorMT), this._proxyVR.addChild(this._controllerMT), this._proxyVR.addChild(this._nodeMenu);
                var e = this._proxyVR.getOrCreateStateSet();
                e.setRenderBinDetails(c.a.TRANSPARENT_NO_EARLYZ_POST, "RenderBin"), e.setAttributeAndModes(w.a.DEPTH_LESS_NO_WRITE), e.setAttributeAndModes(w.a.CULL_DISABLE)
            },
            resetCameraToHuman: function () {
                var e = A.vec3.create(),
                    t = A.vec3.create(),
                    i = A.mat4.create(),
                    n = A.vec3.create();
                return function () {
                    var r = this.getConfigWebVR(),
                        a = r.capabilities.hasPosition && r.stageParameters,
                        o = A.mat4.copy(i, this._humanMT.getMatrix());
                    A.mat4.getScale(e, o), A.vec3.set(e, 1 / e[0], 1 / e[1], 1 / e[2]), A.mat4.scale(o, o, e);
                    var s = this._manipulator.getFirstPersonManipulator(),
                        u = s.getPostMultRotate();
                    A.quat.normalize(u, A.mat4.getRotation(u, o)), s.setResetInitialRotationVR(!0), A.mat4.getTranslation(t, o), a && A.mat4.equals(A.mat4.IDENTITY, a.sittingToStandingTransform) && this.handleBuggyStandingTransform(r, 3), t[2] += this.getEyeLevel(), A.vec3.set(n, 0, 1, 0), A.vec3.transformQuat(n, n, u), A.vec3.add(n, t, n), this._viewer.getFeaturesManager().focusOnTargetAndEye(n, t)
                }
            }(),
            requestData: function (e, t) {
                var i = this.model.get("modeLauncher");
                !e || i || this._dataDownloaded || (this._dataDownloaded = !0, this._teleportNode.initTextureTeleport(), this._floorMT.initTextureFloor(), this._nodeMenu.initialize(t))
            },
            notifyPresentVR: function () {
                this._startPresentTime = A.Timer.instance().tick();
                var e = this.model.get("enable"),
                    t = this.model.get("modeLauncher");
                if (e && (this._resetOnNextFrame = !0), t && (this._scaleControlEnabled = !1, Object(d.a)().vrInNavigation)) {
                    var i = window.location.origin + window.location.pathname;
                    i += window.location.search + "&vr_in_navigation=1" + window.location.hash, window.history.pushState({
                        vr_in_navigation: 1
                    }, "vr started", i)
                }
                var n;
                this._standaloneViewer ? !e && t && (A.log("Launcher sending requestPresent"), n = O.createMessage({
                    data: "requestPresent"
                }), n.appendToHash(), A.log("Launcher sent requestPresent")) : (A.log("Viewer enable after Promise" + e), e || (A.log("Viewer SendingExit"), n = O.createMessage({
                    data: "exit"
                }), n.appendToHash(), A.log("Viewer SentExit")))
            },
            _exitVR: function () {
                if (Object(d.a)().vrLinkNavigation) return void window.history.back();
                if (Object(d.a)().isApp) {
                    O.createMessage({
                        data: "exit"
                    }).appendToHash()
                } else this.model.set("enable", !1)
            },
            startEnable: function (e, t) {
                var i = this._viewer.getFeatures();
                this.setProxyVisible(e), this.requestData(e, i), this.updateDistortion(), i.background.getModel().set("webVR", e && !Object(d.a)().vrAr), i.camera.getModel().set("webVR", e), i.hotspot.getModel().set("webVR", e), i.shadingStyle.getModel().set("webVR", e), i.lighting.getModel().set("webVR", e), i.postProcess.getModel().set("webVR", e), Object(d.a)().vrStereo ? (this._cullConfig.doVR = e, E.a.uIsVr.setFloat(e)) : (this._cullConfig.doVR = !1, E.a.uIsVr.setFloat(0)), this._controllerMT.setListenToEvents(e), e ? this._floorMT.updateNodeVR() : this._viewer.getFeaturesManager().focusOnHomePosition(), this._standaloneViewer ? A.log("Launcher StartEnable: enabled:" + e + " doPresentVR: " + t) : A.log("Viewer StartEnable: enabled:" + e + " doPresentVR: " + t);
                var n = this.getConfigWebVR();
                e && !t || n.isPresenting === e || (this.model.get("hasNativeHMD") ? this._viewerOSGJS.setPresentVR(e).then(this.notifyPresentVR.bind(this), this._failedPresentVR.bind(this)).catch(function () {
                    A.log("VR notifyPresentVR Promise Fail")
                }) : (n.isPresenting = e, this.notifyPresentVR()));
                var r = e && !Object(d.a)().vrAr ? 1 : 0;
                this._viewer.getCamera().getClearColor()[3] = r
            },
            _failedPresentVR: function () {
                console.error("Failed to present VR"), this.model.set("enable", !1)
            },
            onEnable: function () {
                var e = this.model.get("enable");
                if (this._registerVRCallbacks(e), e) {
                    this._viewer.getInputManager().setEnable(R.WEBVR, e);
                    this._viewerOSGJS.getVRDisplay() ? this.onDisplayChange() : this._viewerOSGJS.getInputManager().getInputSource("WebVR").pollHeadset()
                } else this._viewer.getInputManager().setEnable(R.WEBVR, e);
                this.model.onVrDisplayReady(function () {
                    this.startEnable(e, this._standaloneViewer)
                }.bind(this))
            },
            _registerVRCallbacks: function (e) {
                e ? (window.addEventListener("vrdisplayactivate", this._onVrDisplayActivateBinded), window.addEventListener("vrdisplaydeactivate", this._onVrDisplayDeactivateBinded), window.addEventListener("vrdisplaypresentchange", this._onVrDisplayPresentChangeBinded), window.addEventListener("vrdisplaypointerrestricted", this._onVrDisplayPointerRestrictedBinded, !1), window.addEventListener("vrdisplaypointerunrestricted", this._onVrDisplayPointerUnrestrictedBinded, !1)) : (window.removeEventListener("vrdisplayactivate", this._onVrDisplayActivateBinded), window.removeEventListener("vrdisplaydeactivate", this._onVrDisplayDeactivateBinded), window.removeEventListener("vrdisplaypresentchange", this._onVrDisplayPresentChangeBinded), window.removeEventListener("vrdisplaypointerrestricted", this._onVrDisplayPointerRestrictedBinded, !1), window.removeEventListener("vrdisplaypointerunrestricted", this._onVrDisplayPointerUnrestrictedBinded, !1))
            },
            onDisplayChange: function () {
                var e = this._viewerOSGJS.getVRDisplay();
                this.model.set("hasNativeHMD", !!e), e && e.displayName && this.model.set("displayName", e.displayName), o.a.resolveVrDisplayReady()
            },
            _onVrDisplayActivate: function () {
                o.a.getModelDisplayed().isFulfilled() ? this.model.onVrDisplayReady(this.model.set.bind(this.model, "enable", !0)) : o.a.getModelDisplayed().then(function () {
                    this.model.onVrDisplayReady(this.model.set.bind(this.model, "enable", !0))
                }), this.getConfigWebVR().isPresenting || this._viewerOSGJS.setPresentVR(!0).then(this.notifyPresentVR.bind(this)).catch(function () {
                    A.log("VR setPresentVR/notifyPresentVR Promise Fail")
                })
            },
            _onVrDisplayDeactivate: function () {
                if (this._startPresentTime && A.Timer.instance().tick() - this._startPresentTime < 5) {
                    var e = "Sorry, VR can not be enabled because your device doesn’t have enough resources.";
                    e += "Please try closing some tabs before enabling VR again.", this._viewer.subviews.osd.show(e, {
                        duration: 5e3,
                        position: "top"
                    })
                }
                this._standaloneViewer && !this.model.get("modeLauncher") && this.model.onVrDisplayReady(this.model.set.bind(this.model, "enable", !1));
                var t = this._viewer.getCanvas();
                document.pointerLockElement === t && document.exitPointerLock()
            },
            _onVrDisplayPresentChange: function (e) {
                e.display.isPresenting || this._standaloneViewer && !this.model.get("modeLauncher") && this.model.onVrDisplayReady(this.model.set.bind(this.model, "enable", !1))
            },
            handleBuggyStandingTransform: function (e, t) {
                0 !== t && (A.warn("VR: Handling buggy standing transform Vive"), navigator.getVRDisplays().then(function (i) {
                    for (var n = 0; n < i.length; ++n)
                        if (i[n].displayName === e.displayName) {
                            e = i[n];
                            break
                        } var r = e.capabilities.hasPosition && e.stageParameters;
                    if (r && A.mat4.equals(A.mat4.IDENTITY, r.sittingToStandingTransform)) return void setTimeout(this.handleBuggyStandingTransform.bind(this, e, --t), 5e3)
                }.bind(this)).catch(function () {
                    A.log("VR Display Promise Fail")
                }))
            },
            updateDistortion: function () {
                var e = this._viewer.getFeatures().postProcess.getModel(),
                    t = !this.model.get("hasNativeHMD") && !Object(d.a)().vrAr;
                if (e.set("doDistortionVR", t), t) {
                    var i = this.model.get("deviceInfo"),
                        n = i.getProjectionMatrixLeftEye(),
                        r = i.getProjectionMatrixLeftEye(!0),
                        a = i.getUndistortedViewportLeftEye(),
                        o = i.device,
                        s = {
                            xScale: a.width / (o.width / 2),
                            yScale: a.height / o.height,
                            xTrans: 2 * (a.x + a.width / 2) / (o.width / 2) - 1,
                            yTrans: 2 * (a.y + a.height / 2) / o.height - 1
                        };
                    e.set("distortion", i.viewer.distortionCoefficients), e.set("projectionLeft", l.a.projectionMatrixToVector_(n)), e.set("unprojectionLeft", l.a.projectionMatrixToVector_(r, s))
                }
            },
            snapHumanOnFloor: function () {
                this._humanMT.getMatrix()[14] -= this._humanMT.computeDistanceToFloor()
            },
            getEyeLevel: function () {
                var e = this.getConfigWebVR(),
                    t = e.capabilities.hasPosition && e.stageParameters,
                    i = this.getPosVR()[2];
                return t && i ? i : this.model.get("worldFactor") * this.model.getDefaultHumanHeight()
            },
            snapOnFloor: function () {
                var e = this.model.get("worldFactor"),
                    t = this._manipulator.getEyePosition(A.vec3.create()),
                    i = A.vec3.copy(A.vec3.create(), t);
                i[2] -= 5 * e;
                var n = this._viewer.getFeaturesManager(),
                    r = T.a.computeNearestIntersection3D(t, i, h.a.PICK_GEOMETRY_FAST, this._nodeWebVR);
                if (r) {
                    var a = A.vec3.create();
                    T.a.getWorldPositionFromHit(r, a), a[2] += this.getEyeLevel(), n.focusOnTargetAndEye(void 0, a)
                }
            },
            scaleMatrixTranslate: function (e, t) {
                e[12] *= t, e[13] *= t, e[14] *= t
            },
            transformMatrixYuptoZup: function () {
                var e = A.vec3.create(),
                    t = A.vec3.create();
                return function (i) {
                    var n = A.mat4.getScale(e, i),
                        r = Math.abs(n[0] - 1) > 1e-7 || Math.abs(n[1] - 1) > 1e-7 || Math.abs(n[2] - 1) > 1e-7;
                    r && (t[0] = 1 / n[0], t[1] = 1 / n[1], t[2] = 1 / n[2], A.mat4.scale(i, i, t));
                    var a = i,
                        o = a[4],
                        s = a[5],
                        u = a[6],
                        l = a[7];
                    a[4] = -a[8], a[5] = a[9], a[6] = a[10], a[7] = a[11], a[8] = o, a[9] = s, a[10] = u, a[11] = l;
                    var c = a[1];
                    a[1] = -a[2], a[2] = c, c = a[5], a[5] = a[6], a[6] = -c, c = a[10], a[10] = a[9], a[9] = -c, c = a[13], a[13] = -a[14], r && A.mat4.scale(i, i, n)
                }
            }(),
            computeHeadToEyeView: function () {
                var e = A.mat4.create();
                return function (t, i, n) {
                    var r = this._frameData.pose;
                    r && (r.orientation ? A.mat4.fromQuat(e, r.orientation) : A.mat4.identity(e), r.position && A.mat4.setTranslation(e, r.position), A.mat4.multiply(t, this._frameData.leftViewMatrix, e), A.mat4.multiply(i, this._frameData.rightViewMatrix, e)), this.transformMatrixYuptoZup(t), this.transformMatrixYuptoZup(i), this.scaleMatrixTranslate(t, n), this.scaleMatrixTranslate(i, n)
                }
            }(),
            _getCorrectionPixel: function (e) {
                if (Object(d.a)().vrScaleRtt > 0) return Object(d.a)().vrScaleRtt;
                var t = this._viewerOSGJS.getVRDisplay();
                return t && "Oculus Go" === t.displayName ? .625 : this._webvrMaxHeight > 0 ? Math.min(1, this._webvrMaxHeight / (e.renderHeight || 512)) : 1
            },
            _updateCullConfig: function () {
                var e = A.vec3.create();
                return function (t, i) {
                    var n = this.model.get("worldFactor"),
                        r = this._cullConfig;
                    t && (A.mat4.copy(r.leftProjection, this._frameData.leftProjectionMatrix), A.mat4.copy(r.rightProjection, this._frameData.rightProjectionMatrix), this._frameData.leftViewMatrix && (A.mat4.copy(r.leftOffsetView, this._frameData.leftViewMatrix), A.mat4.copy(r.rightOffsetView, this._frameData.rightViewMatrix), this.computeHeadToEyeView(r.leftOffsetView, r.rightOffsetView, n))), t && this._frameData.leftViewMatrix || (A.vec3.set(e, -n * i.offset[0], 0, 0), A.mat4.fromTranslation(r.leftOffsetView, e), A.vec3.set(e, -n * i.offset[0], 0, 0), A.mat4.fromTranslation(r.rightOffsetView, e))
                }
            }(),
            onWorldFactor: function () {
                var e = this.model.get("worldFactor");
                if (this._lastWorldFactor > 0 && this._lastWorldFactor !== e) {
                    var t = this.getPosVR();
                    A.vec3.scale(t, t, e / this._lastWorldFactor), this.model.get("enable") && this.snapOnFloor()
                }
                this._lastWorldFactor = e;
                var i = this.getConfigWebVR(),
                    n = i.getEyeParameters("left"),
                    r = i.getEyeParameters("right");
                if (n && r) {
                    var a = this._getCorrectionPixel(n),
                        o = this._cullConfig;
                    o.leftRenderWidth = Math.floor(n.renderWidth * a) || 512, o.leftRenderHeight = Math.floor(n.renderHeight * a) || 512, o.rightRenderWidth = Math.floor(r.renderWidth * a) || 512, o.rightRenderHeight = Math.floor(r.renderHeight * a) || 512;
                    var s = i.getFrameData(this._frameData);
                    this._updateCullConfig(s, n)
                }
                this._viewer.getInputManager().setParam("worldFactor", e), u.a.draw()
            },
            perspectiveMatrixFromVRFieldOfView: function (e, t, i, n) {
                var r = n || A.mat4.create(),
                    a = Math.PI / 180,
                    o = Math.tan(e.upDegrees * a) * t,
                    s = Math.tan(e.downDegrees * a) * t,
                    u = Math.tan(e.leftDegrees * a) * t,
                    l = Math.tan(e.rightDegrees * a) * t;
                return A.mat4.frustum(r, -u, l, -s, o, t, i), r
            },
            hookComputeCanvasSize: function () {
                var e = this._viewerOSGJS,
                    t = e.computeCanvasSize,
                    i = this,
                    n = this._cullConfig;
                e.computeCanvasSize = function (r) {
                    var a = i.model.get("enable");
                    if (!a) return t.call(e, r);
                    i.model.get("hasNativeHMD") && i.onWorldFactor();
                    var o = Math.floor(n.leftRenderWidth + n.rightRenderWidth),
                        s = Math.floor(Math.max(n.leftRenderHeight, n.rightRenderHeight)),
                        u = Math.max(o, s);
                    if (!a && u > 4096) {
                        var l = 4096 / u;
                        o = Math.floor(o * l), s = Math.floor(s * l)
                    }
                    var c = !1;
                    return this._canvasWidth !== o && (r.width = o, this._canvasWidth = o, c = !0), this._canvasHeight !== s && (r.height = s, this._canvasHeight = s, c = !0), c
                }
            },
            getConfigWebVR: function () {
                var e = this._viewerOSGJS,
                    t = e.getVRDisplay();
                if (t) return this._frameData instanceof window.VRFrameData == !1 && (this._frameData = new window.VRFrameData), t;
                if (this._defaultHMD) return this._defaultHMD;
                var i = this.model.get("deviceInfo"),
                    n = .5 * i.viewer.interLensDistance,
                    r = i.getUndistortedViewportLeftEye();
                this._frameData = {
                    leftProjectionMatrix: this.perspectiveMatrixFromVRFieldOfView(i.getFieldOfViewLeftEye(!1), .1, 1e3, A.mat4.create()),
                    rightProjectionMatrix: this.perspectiveMatrixFromVRFieldOfView(i.getFieldOfViewRightEye(!1), .1, 1e3, A.mat4.create())
                };
                var a = {
                    left: {
                        offset: A.vec3.fromValues(-n, 0, 0),
                        renderWidth: r.width,
                        renderHeight: r.height
                    },
                    right: {
                        offset: A.vec3.fromValues(n, 0, 0),
                        renderWidth: r.width,
                        renderHeight: r.height
                    }
                };
                return this._defaultHMD = {
                    displayName: "fake-cardboard",
                    isPresenting: !1,
                    getFrameData: function (e) {
                        return e
                    },
                    getEyeParameters: function (e) {
                        return a[e]
                    },
                    capabilities: {
                        hasPosition: !1,
                        hasRotation: !1,
                        hasExternalDisplay: !1
                    }
                }, this._defaultHMD
            },
            getPosVR: function () {
                var e = A.vec3.create();
                return function () {
                    return this._manipulator.getCurrentManipulator()._vrPos || A.vec3.set(e, 0, 0, 0)
                }
            }(),
            getTeleportPosFromHotspot: function () {
                var e = A.vec3.create(),
                    t = A.vec3.create(),
                    i = A.vec3.create(),
                    n = A.vec3.create();
                return function (r, a, o, s) {
                    var u = this.model.get("worldFactor");
                    T.a.getWorldPositionFromScenePoint(A.mat4.getTranslation(e, r.getHotspotMatrix()), t);
                    var l = 2.5 * u;
                    A.vec3.sub(e, t, a);
                    var c = A.vec3.length(e);
                    e[2] = 0, A.vec3.normalize(e, e), A.vec3.scale(e, e, l), A.vec3.sub(i, t, e), i[2] = t[2] + u, c < l + .1 * l && A.vec3.copy(i, a), A.vec3.copy(n, i), n[2] -= 3.5 * u;
                    var d = T.a.computeNearestIntersection3D(i, n, h.a.PICK_GEOMETRY_FAST, this._nodeWebVR);
                    d ? (T.a.getWorldPositionFromHit(d, o, s), d.backface && A.vec3.negate(s, s)) : (A.vec3.copy(o, i), o[2] -= this.getEyeLevel(), A.vec3.set(s, 0, 0, 1)), this._teleportNode.setHotspotHint(r.canTeleport(), o, t, u), r.setWorldTeleportPosition(t, o, u)
                }
            }(),
            updateHitHotspot: function () {
                var e = function (e) {
                    return e instanceof m.a
                };
                return function (t, i, r, a, o) {
                    var s = this._viewer.getFeatures().hotspot.getWidgetNode(),
                        u = t && -1 !== t._nodePath.indexOf(s);
                    if (this._lastHoveredHotspot && this._lastHoveredHotspot.setHovered(!1), !u) return this._lastHoveredHotspot && this._lastHoveredHotspot.updateCardHit(), this._lastHoveredHotspot = void 0, void this._teleportNode.setHotspotHint(!1);
                    var l = this._lastHoveredHotspot = Object(n.find)(t._nodePath, e);
                    return l.updateCardHit(t), l.setHovered(!0), l.isFullyVisibleCard() ? l : (this.getTeleportPosFromHotspot(l, i, a, o), this._viewer.getFeatures().hotspot.getModel().set("currentHotspotIndex", l.getIndex()), l)
                }
            }(),
            handleHitPicking: function (e, t, i, n, r, a, o) {
                var s, u = this._viewer.getFeaturesManager(),
                    l = this.model.get("worldFactor"),
                    c = this._floorMT.getBoundingSphere(),
                    d = A.vec3.dist(c.center(), t) + c.radius();
                return e ? s = T.a.computeNearestIntersection2D(this._lastMouse[0], this._lastMouse[1], h.a.PICK_GEOMETRY_FAST) : this._controllerMT.isPosedController() ? (s = this._controllerMT.raycastFromController(this._nodeWebVR, u, d, a, o), s ? (T.a.getWorldPositionFromHit(s, n, r), s._backface && A.vec3.negate(r, r), this._controllerMT.updatePointerScaleFromHit(n), this._cursorMT.setColor(A.vec3.fromValues(.1, .66, .85))) : (this._controllerMT.resetPointerScale(), A.vec3.copy(n, o))) : (A.vec3.copy(a, t), A.vec3.copy(o, i), A.vec3.scale(o, i, d), A.vec3.add(o, a, o), s = T.a.computeNearestIntersection3DHotspotFirst(a, o, h.a.PICK_GEOMETRY_FAST, this._nodeWebVR), s ? (T.a.getWorldPositionFromHit(s, n, r), s._backface && A.vec3.negate(r, r)) : (A.vec3.scale(n, i, 3 * l), A.vec3.add(n, t, n))), this.model.setLastControllerHit(s), s
            },
            goToNextHotspot: function () {
                this._viewer.getFeatures().postProcess.getModel().fadeForTeleportVR(this.doTeleportToHotspot.bind(this, 1))
            },
            doTeleportToHotspot: function (e) {
                this._nodeMenu && this._nodeMenu.isVisible() && this._nodeMenu.hide();
                var t = this.computeHotspotIndex(e); - 1 !== t && (this.moveToHotspotWithIndex(t), this.displayHotspotCardForIndex(t))
            },
            goToPrevHotspot: function () {
                this._viewer.getFeatures().postProcess.getModel().fadeForTeleportVR(this.doTeleportToHotspot.bind(this, -1))
            },
            displayHotspotCardForIndex: function (e) {
                var t = this._viewer.getFeatures().hotspot.getWidgetNode().children[e];
                this.toggleHotspotCard(t)
            },
            computeHotspotIndex: function (e) {
                var t = this._viewer.getFeatures().hotspot.getModel(),
                    i = t.get("hotspots");
                if (0 === i.length) return -1;
                if (1 !== e && -1 !== e) return console.error("computeHotspotIndex was called with an invalid direction argument. Valid values are 1 for foward -1 for backward."), 0;
                var n = t.get("currentHotspotIndex"),
                    r = i.length;
                return n += e, n < 0 && (n = -1), n = (n % r + r) % r, t.set("currentHotspotIndex", n), n
            },
            moveToHotspotWithIndex: function () {
                var e = A.vec3.create(),
                    t = A.vec3.create(),
                    i = A.vec3.create();
                return function (n) {
                    var r = this._viewer.getFeatures().hotspot.getWidgetNode(),
                        a = r.children[n],
                        o = this._viewer.getFeatures().hotspot.getModel().get("hotspots").at(n);
                    T.a.getWorldPositionFromScenePoint(o.get("eye"), t), T.a.getWorldPositionFromScenePoint(o.get("position"), e), this.getTeleportPosFromHotspot(a, t, t, i), t[2] += this.getEyeLevel(), this._manipulator.getFirstPersonManipulator().setInitialPoseVR(t, e)
                }
            }(),
            doTeleport: function (e, t, i) {
                var n = this._viewer.getFeaturesManager();
                e[2] += this.getEyeLevel(), t[2] += this.getEyeLevel(), n.focusOnTargetAndEye(t, e), this.toggleHotspotCard(i)
            },
            toggleHotspotCard: function (e) {
                e && (e.isFullyVisibleCard() ? e.onCardHit(this) : (this._lastSelectedHotspot && this._lastSelectedHotspot.setVisibleCard(!1), this._lastSelectedHotspot = e, e && e.setVisibleCard(!0)))
            },
            setPauseUpdate: function (e) {
                this._pauseUpdate = e
            },
            update: function () {
                var e = A.vec3.create(),
                    t = A.vec3.create(),
                    i = A.vec3.create(),
                    n = A.vec3.create(),
                    r = A.vec3.create(),
                    a = A.vec3.create(),
                    o = A.vec3.create(),
                    s = A.vec3.create(),
                    l = A.vec3.create(),
                    c = A.vec3.create();
                return function (h, f) {
                    var p = this._viewer.getFeatures(),
                        m = this.model.get("enable"),
                        g = this.model.get("modeLauncher"),
                        v = this._viewer.getOptions().widgetAPI,
                        _ = !!v && "virtual reality" === v.getTabbedWidget().get() && !this._pauseUpdate,
                        b = m || _;
                    this.setProxyVisible(b);
                    var S = p.background.getModel();
                    S.get("webVR") !== b && S.set("webVR", b);
                    var x = p.postProcess.getModel();
                    if (x.get("webVR") !== b && x.set("webVR", b), this._humanMT.setVisible(_), !m && !_) return !0;
                    var y = this.model.get("worldFactor"),
                        C = f.getFrameStamp(),
                        T = C.getSimulationTime(),
                        w = C.getDeltaTime(),
                        M = this.getConfigWebVR();
                    this._resetOnNextFrame && (!this.model.get("hasNativeHMD") || !M.capabilities.hasPosition || M.stageParameters && this.getPosVR()[2]) && (this._resetOnNextFrame = !1, this.resetCameraToHuman()), this._manipulator.getEyePosition(i), this._manipulator.getTarget(n), A.vec3.sub(n, n, i), A.vec3.normalize(n, n);
                    var E = this._viewer.getCamera();
                    this._controllerMT.updateNodeVR(M, w, A.vec3.sub(s, i, this.getPosVR()));
                    var P = this.handleHitPicking(!m && _, i, n, t, e, r, a);
                    A.vec3.copy(o, t);
                    var R = m && !g && this._controllerMT.isTeleportPressed(),
                        O = !g && this._controllerMT.isClickPressed(),
                        I = this._nodeMenu && this._controllerMT.isMenuPressed(this._nodeMenu.isVisible()),
                        F = P && -1 === P._nodePath.indexOf(this._nodeMenu) && (R || O) && this._nodeMenu.isVisible(),
                        N = m && (I || F);
                    N && (this._manipulator.getTarget(s), this._nodeMenu.isVisible() ? this._nodeMenu.hide() : this._nodeMenu.display(i, s));
                    var D, L;
                    if (m && !g) {
                        L = this._nodeMenu.updateHit(P), D = this.updateHitHotspot(P, r, a, o, e), this._teleportNode.updateWorldNormal(C, e);
                        var k = P && e[2] > .5,
                            V = D ? D.canTeleport() : k,
                            B = P && -1 !== P._nodePath.indexOf(this._floorMT),
                            U = D ? D.canTeleport() : k && (!this.model.isDiorama() || B);
                        if (R && T - this._lastTime > .5) {
                            if (V) {
                                A.vec3.add(c, o, n), A.vec3.copy(l, o);
                                this._viewer.getFeatures().postProcess.getModel().fadeForTeleportVR(this.doTeleport.bind(this, l, c, D)), this._lastTime = T
                            }
                            V || this.toggleHotspotCard(D), L && L.click()
                        }
                        this._interpolatorAlpha.setTarget(U ? 1 : 0), this._interpolatorAlpha.update(C.getDeltaTime())
                    }
                    var G = this._viewer.getFeaturesManager(),
                        j = G.getIconScaleFov(this._cullConfig.leftProjection),
                        z = A.vec3.dist(t, i) / j,
                        H = N ? 0 : this._interpolatorAlpha.getCurrent()[0];
                    this._cursorMT.setVisible(m), this._teleportNode.setVisible(P && !g && m && !I);
                    var W = !g && !Object(d.a)().vrAr && this.model.get("displayFloor");
                    this._floorMT.setVisible(W), this._floorMT.updateNodeVR(), this._humanMT.updateNodeVR(P, T), this._teleportNode.updateNodeVR(H, P, C, o, y, z, e), this._cursorMT.updateNodeVR(g || D ? 1 : 1 - H, E, t, z), this._nodeMenu && this._lastSelectedHotspot && this._nodeMenu.isVisible() && this._lastSelectedHotspot.isFullyVisibleCard() && this._lastSelectedHotspot.setVisibleCard(!1);
                    var q = this._controllerMT.checkScaleChangeValue();
                    return this._scaleControlEnabled && 0 !== q && (q = y * Math.abs(q) * (q > 0 ? 1.02 : 1 / 1.02), this.model.set("worldFactor", q)), u.a.draw(), !0
                }
            }()
        });
    t.a = I
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(120),
        a = i(85),
        o = i(69),
        s = i(79),
        u = i(438),
        l = i(710),
        c = i(159),
        h = i(88),
        d = i(932),
        f = i.n(d),
        p = i(933),
        m = i.n(p),
        g = i(1408),
        v = i.n(g),
        _ = i(1409),
        b = i.n(_),
        S = n.a.osg,
        x = n.a.osgUtil,
        y = S.vec3.fromValues(.1, .4, .8),
        C = S.vec3.fromValues(1, .7, .1),
        T = S.vec3.fromValues(1, 0, 0),
        w = S.vec3.fromValues(0, 0, .9),
        M = function (e) {
            S.MatrixTransform.call(this), this._model = e, this.setMatrix(e.get("humanMatrix")), this.setName("WebVR - Human"), this.setNodeMask(0), this.editMask = x.NodeGizmo.NO_FULL_CIRCLE | x.NodeGizmo.PICK_PLANE_Z | x.NodeGizmo.PICK_ARROW | x.NodeGizmo.PICK_ARC_Z, this._humanMT = new S.MatrixTransform, S.mat4.fromZRotation(this._humanMT.getMatrix(), Math.PI), this._geoHuman = new S.Geometry, this._humanMT.addChild(this._geoHuman), this._uColorCylinder = S.Uniform.createFloat3(S.vec3.copy(S.vec3.create(), y), "uColor"), this._uColorHint = S.Uniform.createFloat3(S.vec3.copy(S.vec3.create(), C), "uColor"), this._hintToFloorMT = new S.MatrixTransform, this._geoHintToFloor = S.createTexturedBoxGeometry(0, 0, -.5, .02, .02, 1), this._hintToFloorMT.addChild(this._geoHintToFloor), this._hintToFloorMT.setNodeMask(o.a.NO_PICK), this._geoCylinder = x.GizmoGeometry.createCylinderGeometry(1, 1, 1, 50, 1, !1, !1), this._geoCylinder.setNodeMask(o.a.NO_PICK);
            for (var t = 0, i = this._geoCylinder.getAttributes().Vertex.getElements(), n = i.length / 3; t < n; ++t) i[3 * t + 2] += .5;
            this._cylinderMT = new S.MatrixTransform, S.mat4.fromScaling(this._cylinderMT.getMatrix(), S.vec3.fromValues(1, 1, .5)), this._cylinderMT.addChild(this._geoCylinder), this.addChild(this._humanMT), this.addChild(this._cylinderMT), this.addChild(this._hintToFloorMT), this._boundingBoxComputed = !0, this._boundingSphereComputed = !0, this.init()
        };
    S.createPrototypeNode(M, S.objectInherit(S.MatrixTransform.prototype, {
        init: function () {
            this.getOrCreateStateSet().setAttributeAndModes(h.a.CULL_BACK);
            var e = this._humanMT.getOrCreateStateSet();
            e.setShaderGeneratorName("shadeless-pbr"), e.setName("vrHuman");
            var t = l.a.createMaterialModel(e);
            t.set("name", "NodeHuman"), t.set("hasVertexColor", !0), t.set("vertexColorEnable", !0), t.set("vertexColorColorSpace", "linear"), t.trigger("apply"), e.setAttributeAndModes(e.getAttribute("SketchfabMaterial")), Object(s.a)() && u.a.getHuman(this.initHumanMesh.bind(this));
            var i = this._geoHintToFloor.getOrCreateStateSet();
            i.setAttributeAndModes(r.a.createShader(v.a, b.a, "webVR-hintToFloor", "VRHintToFloor")), i.addUniform(this._uColorHint), i.setRenderBinDetails(a.a.TRANSPARENT_NO_EARLYZ_POST, "RenderBin");
            var n = this._geoCylinder.getOrCreateStateSet();
            n.setAttributeAndModes(r.a.createShader(f.a, m.a, "webVR-humanCylinder", "VRHumanCylinder")), n.addUniform(this._uColorCylinder), n.addUniform(S.Uniform.createFloat(1, "uAlpha")), n.setRenderBinDetails(a.a.TRANSPARENT_NO_EARLYZ_POST, "RenderBin")
        },
        initHumanMesh: function (e) {
            var t = this._geoHuman;
            t.getAttributes().Vertex = new S.BufferArray(S.BufferArray.ARRAY_BUFFER, e.VERTEX, 3), t.getAttributes().Color = new S.BufferArray(S.BufferArray.ARRAY_BUFFER, e.COLOR, 4), t.getPrimitives().push(new S.DrawElements(S.primitiveSet.TRIANGLES, new S.BufferArray(S.BufferArray.ELEMENT_ARRAY_BUFFER, e.TRIANGLES, 1))), t.getPrimitives().push(new S.DrawElements(S.primitiveSet.TRIANGLE_STRIP, new S.BufferArray(S.BufferArray.ELEMENT_ARRAY_BUFFER, e.STRIP, 1)))
        },
        setVisible: function (e) {
            if (this._visible !== e) {
                this._visible = e, this.setNodeMask(e ? -1 : 0);
                var t = this._model._viewer.getFeaturesManager().getNodeGizmo();
                e ? (t.attachToNode(this), this._initView()) : this._restoreView()
            }
        },
        _initView: function () {
            var e = S.vec3.create(),
                t = S.vec3.create(),
                i = S.vec3.create(),
                n = S.quat.create(),
                r = S.vec3.create(),
                a = S.vec3.create(),
                o = S.vec3.fromValues(0, 0, -1);
            return function () {
                var s = this._model._viewer.getFeaturesManager(),
                    u = this._model.get("worldFactor"),
                    l = this._model._viewer.getViewerOSGJS().getManipulator();
                this._eyePos || (this._eyePos = S.vec3.create(), this._eyeTarget = S.vec3.create()), l.getEyePosition(this._eyePos), l.getTarget(this._eyeTarget), S.mat4.getTranslation(e, this.getMatrix()), S.mat4.getRotation(n, this.getMatrix()), S.vec3.set(t, 0, 1, 0), S.vec3.transformQuat(t, t, n), S.vec3.copy(r, w), S.vec3.scale(r, r, u), S.vec3.add(e, e, r), S.vec3.scale(r, t, -1), S.vec3.normalize(r, r), S.vec3.cross(a, r, o), S.vec3.copy(i, e), S.vec3.scale(r, r, 3 * u), S.vec3.scale(a, a, .5 * u), S.vec3.add(r, r, a), S.vec3.add(i, i, r), s.focusOnTargetAndEye(e, i, 1)
            }
        }(),
        _restoreView: function () {
            if (this._eyePos) {
                this._model._viewer.getFeaturesManager().focusOnTargetAndEye(this._eyeTarget, this._eyePos)
            }
        },
        computeDistanceToFloor: function () {
            var e = S.vec3.create(),
                t = S.vec3.create();
            return function () {
                var i = this.getMatrix(),
                    n = this._model,
                    r = n.get("worldFactor"),
                    a = n.get("floorHeight");
                S.mat4.getTranslation(e, i), S.vec3.copy(t, e);
                var s = .1 * r;
                e[2] += s, t[2] -= 100 * r, this.setNodeMask(o.a.NO_PICK);
                var u = c.a.computeNearestIntersection3D(e, t, o.a.PICK_GEOMETRY_SLOW);
                if (this.setNodeMask(-1), u) s = S.vec3.dist(c.a.getWorldPositionFromHit(u, t), e);
                else {
                    if (!n.get("displayFloor")) return 0;
                    s = e[2] - a
                }
                return Math.max(0, s - .1 * r)
            }
        }(),
        updateNodeVR: function () {
            var e = S.vec3.create();
            return function (t, i) {
                if (0 !== this.getNodeMask()) {
                    var n = this.getMatrix(),
                        r = this._model,
                        a = r._viewer.getFeaturesManager(),
                        o = r.get("worldFactor"),
                        s = r.get("floorHeight");
                    S.vec3.lerp(this._uColorHint.getInternalArray(), C, T, .5 * Math.sin(10 * i) + .5), S.mat4.getScale(e, n), S.vec3.set(e, o / e[0], o / e[1], o / e[2]), S.mat4.scale(n, n, e), r.get("displayFloor") && (n[14] = Math.max(n[14], s));
                    var u = a.getNodeGizmo().getAttachedNode() === this,
                        l = u || t && -1 !== t._nodePath.indexOf(this._humanMT);
                    S.vec3.copy(this._uColorCylinder.getInternalArray(), l ? C : y);
                    var c = this.computeDistanceToFloor() / o,
                        h = c > .05;
                    S.mat4.fromScaling(this._hintToFloorMT.getMatrix(), S.vec3.set(e, 1, 1, h ? c : 1e-7)), this._model.set("humanInAir", h), this.dirtyBound()
                }
            }
        }()
    }), "osgSketchfab", "Human"), t.a = M
}, function (e, t) {
    e.exports = "attribute vec3 Vertex;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying float vHeight;\n\nvoid main(void) {\n  vHeight = Vertex.z;\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xyz, 1.0));\n}\n"
}, function (e, t) {
    e.exports = 'uniform vec3 uColor;\nuniform int uOutputLinear;\n\nvarying float vHeight;\n\n#pragma include "utils/functions.glsl"\n\nvoid main(void) {\n  vec4 color = vec4(uColor, 1.0) * smoothstep(1.0, 0.0, vHeight + 1.0);\n\n  gl_FragColor = uOutputLinear == 0 ? linearTosRGB(color) : color;\n}\n'
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(120),
        a = i(69),
        o = i(77),
        s = i(438),
        u = i(229),
        l = i(1411),
        c = i.n(l),
        h = i(1412),
        d = i.n(h),
        f = i(932),
        p = i.n(f),
        m = i(933),
        g = i.n(m),
        v = n.a.osg,
        _ = n.a.osgUtil,
        b = function () {
            v.Node.call(this), this.setName("WebVR - Teleport"), this.setVisible(!0), this._interpolatorNormal = new _.DelayInterpolator(3), this._interpolatorNormal.setDelay(.08), this._geoCircle1 = v.createTexturedQuadGeometry(-.5, -.5, 0, 1, 0, 0, 0, 1, 0), this._geoCircle2 = v.createTexturedQuadGeometry(-.5, -.5, .15, 1, 0, 0, 0, 1, 0), this._geoCircle3 = v.createTexturedQuadGeometry(-.5, -.5, .15, 1, 0, 0, 0, 1, 0), this._uAlpha1 = v.Uniform.createFloat(1, "uAlpha"), this._uAlpha2 = v.Uniform.createFloat(1, "uAlpha"), this._uAlpha3 = v.Uniform.createFloat(1, "uAlpha"), this._uScale1 = v.Uniform.createFloat(1, "uScale"), this._uScale2 = v.Uniform.createFloat(.99, "uScale"), this._uScale3 = v.Uniform.createFloat(.99, "uScale"), this._geoCylinder = _.GizmoGeometry.createCylinderGeometry(1, 1, 1, 50, 1, !1, !1);
            for (var e = 0, t = this._geoCylinder.getAttributes().Vertex.getElements(), i = t.length / 3; e < i; ++e) t[3 * e + 2] += .5;
            this._cylinderMT = new v.MatrixTransform, v.mat4.fromScaling(this._cylinderMT.getMatrix(), v.vec3.fromValues(.38, .38, .125)), this._cylinderMT.addChild(this._geoCylinder), this._hotspotHintMT = new v.MatrixTransform, this._hotspotHintMT.addChild(this._geoCylinder), this._hotspotHintMT.setNodeMask(0), this._teleportMT = new v.MatrixTransform, this._teleportMT.addChild(this._geoCircle1), this._teleportMT.addChild(this._geoCircle2), this._teleportMT.addChild(this._geoCircle3), this._teleportMT.addChild(this._cylinderMT), this.addChild(this._teleportMT), this.addChild(this._hotspotHintMT), this.init()
        };
    v.createPrototypeNode(b, v.objectInherit(v.Node.prototype, {
        init: function () {
            var e = this.getOrCreateStateSet();
            e.setAttributeAndModes(r.a.createShader(c.a, d.a, "webVR-teleportCircle", "VRTeleportCircle")), e.addUniform(v.Uniform.createInt(0, "uTextureTeleportCircle")), e.setTextureAttributeAndModes(0, u.a.dummyTexture), this._geoCircle1.getOrCreateStateSet().addUniform(this._uScale1), this._geoCircle2.getOrCreateStateSet().addUniform(this._uScale2), this._geoCircle3.getOrCreateStateSet().addUniform(this._uScale3), this._geoCircle1.getOrCreateStateSet().addUniform(this._uAlpha1), this._geoCircle2.getOrCreateStateSet().addUniform(this._uAlpha2), this._geoCircle3.getOrCreateStateSet().addUniform(this._uAlpha3);
            var t = this._cylinderMT.getOrCreateStateSet();
            t.addUniform(v.Uniform.createFloat3(v.vec3.fromValues(.7, .7, .3), "uColor")), t.addUniform(this._uAlpha1);
            var i = this._hotspotHintMT.getOrCreateStateSet();
            i.addUniform(v.Uniform.createFloat3(v.vec3.fromValues(.1, .66, .85), "uColor")), i.addUniform(this._uAlpha1), this._geoCylinder.getOrCreateStateSet().setAttributeAndModes(r.a.createShader(p.a, g.a, "webVR-teleportCylinder", "VRTeleportCylinder"))
        },
        initTextureTeleport: function () {
            s.a.getBaseVR(this.replaceTextureTeleport.bind(this))
        },
        replaceTextureTeleport: function (e) {
            this.getOrCreateStateSet().setTextureAttributeAndModes(0, o.default.instance.getOrCreateTexture(e.TELEPORT_CIRCLE, {
                internalFormat: v.Texture.RGBA
            }).texture)
        },
        setVisible: function (e) {
            this.setNodeMask(e ? a.a.NO_PICK : 0)
        },
        setHotspotHint: function () {
            var e = v.vec3.create(),
                t = v.vec3.fromValues(0, 0, 1),
                i = v.quat.create();
            return function (n, r, a, o) {
                if (this._hotspotHintMT.setNodeMask(n ? -1 : 0), r) {
                    v.vec3.sub(e, a, r);
                    var s = v.vec3.len(e);
                    v.vec3.normalize(e, e), v.quat.rotationTo(i, t, e);
                    var u = this._hotspotHintMT.getMatrix();
                    v.mat4.fromQuat(u, i);
                    v.mat4.scale(u, u, v.vec3.set(e, .02 * o, .02 * o, s)), v.mat4.setTranslation(u, r)
                }
            }
        }(),
        updateWorldNormal: function (e, t) {
            this._interpolatorNormal.setTarget(t[0], t[1], t[2]), this._interpolatorNormal.update(e.getDeltaTime()), v.vec3.normalize(t, this._interpolatorNormal.getCurrent())
        },
        updateNodeVR: function () {
            var e = v.vec3.fromValues(0, 0, 1),
                t = v.vec3.create();
            return function (i, n, r, o, s, u, l) {
                var c = this._teleportMT.getMatrix();
                if (this.getNodeMask()) {
                    var h = Math.acos(v.vec3.dot(e, l));
                    v.vec3.cross(t, l, e), v.mat4.fromRotation(c, -h, t);
                    var d = Math.min(Math.max(s, u), 50 * u);
                    v.mat4.scale(c, c, v.vec3.set(t, d, d, d)), v.vec3.set(t, o[0], o[1], o[2] + .05 * s), v.mat4.setTranslation(c, t), this.setNodeMask(a.a.NO_PICK)
                }
                var f = r.getSimulationTime(),
                    p = f % .99,
                    m = (f + .2) % .99;
                this._uScale2.setFloat(p), this._uScale3.setFloat(m), this._uAlpha1.setFloat(i), this._uAlpha2.setFloat(i * (1 - p * p)), this._uAlpha3.setFloat(i * (1 - m * m)), this._teleportMT.dirtyBound()
            }
        }()
    }), "osgSketchfab", "Teleport"), t.a = b
}, function (e, t) {
    e.exports = "attribute vec2 TexCoord0;\nattribute vec3 Vertex;\n\nvarying vec2 vTexCoord0;\nuniform float uScale;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n  vTexCoord0 = TexCoord0;\n\n  vec3 posLocal = Vertex.xyz * vec3(uScale, uScale, 1.0 - uScale);\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(posLocal, 1.0));\n}\n"
}, function (e, t) {
    e.exports = 'varying vec2 vTexCoord0;\n\nuniform sampler2D uTextureTeleportCircle;\nuniform float uScale;\nuniform float uAlpha;\nuniform int uOutputLinear;\n\n#pragma include "utils/functions.glsl"\n\nvoid main(void) {\n  vec3 tex = sRGBToLinear(texture2D(uTextureTeleportCircle, vTexCoord0).rgb);\n  vec4 color = uScale == 1.0 ? vec4(tex.rrr, 1.0) * uAlpha * tex.g : vec4(uAlpha * tex.b);\n\n  gl_FragColor = uOutputLinear == 0 ? linearTosRGB(color) : color;\n}\n'
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(88),
        a = i(120),
        o = i(69),
        s = i(85),
        u = i(1414),
        l = i.n(u),
        c = i(1415),
        h = i.n(c),
        d = n.a.osg,
        f = function () {
            d.MatrixTransform.call(this), this.setName("WebVR - Cursor"), this.setVisible(!0), this._geom = d.createTexturedQuadGeometry(-.5, -.5, 0, 1, 0, 0, 0, 1, 0), this._uAlpha = d.Uniform.createFloat(1, "uAlpha"), this._uColor = d.Uniform.createFloat3(d.vec3.fromValues(.7, .7, .7), "uCursorColor"), this.addChild(this._geom), this.init()
        };
    d.createPrototypeNode(f, d.objectInherit(d.MatrixTransform.prototype, {
        init: function () {
            var e = d.StateAttribute.OVERRIDE_ON,
                t = this.getOrCreateStateSet();
            t.setAttributeAndModes(a.a.createShader(l.a, h.a, "webVR-cursor", "VRCursor"), e), t.setRenderBinDetails(s.a.VR_CURSOR, "RenderBin"), t.setAttributeAndModes(r.a.BLEND_SUBSTRACTIVE), t.addUniform(this._uColor), t.addUniform(this._uAlpha)
        },
        setVisible: function (e) {
            this.setNodeMask(e ? o.a.NO_PICK : 0)
        },
        setColor: function (e) {
            d.vec3.copy(this._uColor.getInternalArray(), e)
        },
        updateNodeVR: function () {
            var e = d.vec3.create(),
                t = d.quat.create();
            return function (i, n, r, a) {
                var o = this.getMatrix();
                d.mat4.invert(o, n.getViewMatrix()), d.mat4.fromQuat(o, d.mat4.getRotation(t, o)), d.mat4.scale(o, o, d.vec3.set(e, a, a, a)), d.mat4.setTranslation(o, r), this._uAlpha.setFloat(i), this.dirtyBound()
            }
        }()
    }), "osgSketchfab", "Cursor"), t.a = f
}, function (e, t) {
    e.exports = "attribute vec2 TexCoord0;\nattribute vec3 Vertex;\n\nvarying vec2 vLocalVertex;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n  vLocalVertex = Vertex.xy;\n\n  vec3 posLocal = Vertex.xyz * 0.5;\n  posLocal += vec3(0.0, 0.0, 0.1);\n\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(posLocal, 1.0));\n}\n"
}, function (e, t) {
    e.exports = 'varying vec2 vLocalVertex;\n\nuniform float uAlpha;\nuniform int uOutputLinear;\nuniform vec3 uCursorColor;\n\n#pragma include "utils/functions.glsl"\n\nvoid main(void) {\n  vec4 color = vec4(uCursorColor, 1.0) * uAlpha * smoothstep(0.0, 1.0, 1.0 - 2.0 * length(vLocalVertex));\n\n  gl_FragColor = linearTosRGB(color);\n}\n'
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(120),
        a = i(77),
        o = i(85),
        s = i(79),
        u = i(438),
        l = i(229),
        c = i(103),
        h = i(88),
        d = i(1417),
        f = i.n(d),
        p = i(1418),
        m = i.n(p),
        g = n.a.osg,
        v = function (e) {
            g.MatrixTransform.call(this), this._model = e, this._postMultRotate = e._viewer.getViewerOSGJS().getManipulator().getFirstPersonManipulator().getPostMultRotate(), this.setName("WebVR - Floor"), this.setNodeMask(-1), this._cam = new g.Camera, this._cam.setNearFarRatio(5e-5), this._geom = g.createTexturedQuadGeometry(-.5, -.5, 0, 1, 0, 0, 0, 1, 0), this._uScaleToMeter = g.Uniform.createFloat(1, "uScaleToMeter"), this._cam.addChild(this._geom), this.addChild(this._cam), this.init()
        };
    g.createPrototypeNode(v, g.objectInherit(g.MatrixTransform.prototype, {
        init: function () {
            var e = this.getOrCreateStateSet();
            e.setAttributeAndModes(r.a.createShader(f.a, m.a, "webVR-floor", "VRFloor")), e.addUniform(g.Uniform.createInt(0, "uTextureFloor")), e.setTextureAttributeAndModes(0, l.a.dummyTexture), e.addUniform(this._uScaleToMeter), e.addUniform(g.Uniform.createInt(1, "uTextureDepth")), e.setTextureAttributeAndModes(1, l.a.dummyTexture), e.setRenderBinDetails(o.a.TRANSPARENT_NO_EARLYZ_PRE, "RenderBin"), e.setAttributeAndModes(h.a.DEPTH_DISABLE), e.setAttributeAndModes(h.a.CULL_BACK), Object(s.a)() && this.initTextureFloor()
        },
        initTextureFloor: function () {
            u.a.getBaseVR(this.replaceTextureFloor.bind(this))
        },
        replaceTextureFloor: function (e) {
            this.getOrCreateStateSet().setTextureAttributeAndModes(0, a.default.instance.getOrCreateTexture(e.FLOOR, {
                internalFormat: g.Texture.RGBA
            }).texture)
        },
        setVisible: function (e) {
            if (this.setNodeMask(e ? -1 : 0), e && !this._depthInitialized) {
                var t = this._model._viewer.getFeaturesManager().getTextureDepth();
                t && (this.getOrCreateStateSet().setTextureAttributeAndModes(1, t), this._depthInitialized = !0)
            }
        },
        updateNodeVR: function () {
            var e = g.vec3.create(),
                t = g.vec3.create();
            return function () {
                var i = this.getMatrix(),
                    n = c.a.getModelBoxWithDisplacement();
                n.center(t);
                var r = n.radius(),
                    a = Math.max(15 * this._model.get("worldFactor"), 5 * r);
                g.mat4.fromQuat(i, this._postMultRotate), g.mat4.scale(i, i, g.vec3.set(e, a, a, a)), i[12] = t[0], i[13] = t[1], i[14] = this._model.get("floorHeight") - 1e-4 * r, this._uScaleToMeter.setFloat(a / this._model.get("worldFactor")), this.dirtyBound()
            }
        }()
    }), "osgSketchfab", "Floor"), t.a = v
}, function (e, t) {
    e.exports = "attribute vec2 TexCoord0;\nattribute vec3 Vertex;\n\nvarying vec2 vTexCoord0;\nvarying vec4 vViewPos;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n  vTexCoord0 = TexCoord0;\n  vViewPos = uModelViewMatrix * vec4(Vertex.xyz, 1.0);\n  gl_Position = (uProjectionMatrix * vViewPos).xyww;\n}\n"
}, function (e, t) {
    e.exports = '#pragma include "utils/functions.glsl"\n#pragma include "utils/decodeDepth.glsl"\n\nvarying vec2 vTexCoord0;\n\nuniform sampler2D uTextureFloor;\nuniform float uScaleToMeter;\nuniform int uOutputLinear;\n\nvarying vec4 vViewPos;\nuniform vec2 uNearFar;\nuniform sampler2D uTextureDepth;\nuniform vec2 uGlobalTexSize;\nuniform vec2 uGlobalTexRatio;\n\nvoid main(void) {\n  float distDepth = distanceToDepth(uTextureDepth, uGlobalTexRatio * gl_FragCoord.xy / uGlobalTexSize, vViewPos, uNearFar);\n  if (distDepth >= 0.0) discard;\n\n  float x = length(vTexCoord0 * 2.0 - 1.0);\n  x *= x;\n  float fade = smoothstep(0.0, 1.0, 1.0 - x * x);\n\n  float value = sRGBToLinear(texture2D(uTextureFloor, (vTexCoord0 * 1.0 - 0.5) * uScaleToMeter).r);\n  vec4 color = vec4(vec3(value), fade * max(0.8, value));\n  color.rgb *= color.a;\n\n  gl_FragColor = uOutputLinear == 0 ? linearTosRGB(color) : color;\n}\n'
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(120),
        a = i(69),
        o = i(85),
        s = i(438),
        u = i(38),
        l = i.n(u),
        c = i(20),
        h = i(159),
        d = i(88),
        f = i(199),
        p = i(710),
        m = i(934),
        g = i.n(m),
        v = i(935),
        _ = i.n(v),
        b = n.a.osg,
        S = n.a.InputGroups,
        x = b.vec3.create(),
        y = {
            TOUCHPAD: 0
        },
        C = {
            SCALE_THRESHOLD: .3,
            TOUCHPAD: 0,
            TRIGGER: 1,
            LEFT_AND_RIGHT: 2,
            MENU: 3
        },
        T = {
            SCALE_THRESHOLD: .7,
            THUMBSTICK: 0,
            TRIGGER_UP: 1,
            TRIGGER_SIDE: 2,
            AX: 3,
            BY: 4,
            HOME: 5
        },
        w = {
            TRIGGER: 1,
            THUMBSTICK: 0
        },
        M = {
            TOUCHPAD: 0,
            HOME: 1,
            CIRCULAR_UP: 5,
            CIRCULAR_DOWN: 4
        },
        E = {
            SCALE_THRESHOLD: .7,
            TOUCHPAD: 0
        },
        A = {
            TOUCHPAD: 0
        },
        P = {
            SCALE_THRESHOLD: .3,
            THUMBSTICK: 0,
            TRIGGER: 1,
            GRIP: 2,
            MENU: 3,
            TOUCHPAD: 4
        },
        R = b.vec3.fromValues(.8481, .8481, .8481),
        O = b.vec3.fromValues(.00237, .30699, .57048),
        I = function (e, t) {
            b.MatrixTransform.call(this), this.setName("WebVR - Controller"), this.setNodeMask(a.a.NO_PICK), this._pointerMT = new b.MatrixTransform, this._pointerMTScale = new b.MatrixTransform, this._proxyControllerMT = new b.MatrixTransform, this._geomPointer = b.createTexturedQuadGeometry(-.5, 0, 0, 1, 0, 0, 0, 1, 0), this.addChild(this._proxyControllerMT), this.addChild(this._pointerMT), this._pointerMT.addChild(this._pointerMTScale), this._pointerMTScale.addChild(this._geomPointer);
            var i = new b.createTexturedBoxGeometry(0, -.1, 0, .1, .2, .1);
            this._proxyControllerMT.addChild(i), this._uNormalSign = b.Uniform.createFloat(1, "uNormalSign"), this._activeController = void 0, this._model = e, this._postMultRotate = e._viewer.getViewerOSGJS().getManipulator().getFirstPersonManipulator().getPostMultRotate(), this._uPointerAlpha = b.Uniform.createFloat1(1, "uAlpha"), this._hitScaleOffset = 20, this._inputManager = t, this._controllerMeshDisplay = void 0, this._pressedButtons = [], this._gamepadType = void 0, this._pointerClicked = !1, this._timeSinceLastPointerClick = 0, this._menuPressed = !1, this._clickPressed = !1, this._teleportPressed = !1, this._menuPressedFrame = !1, this._clickPressedFrame = !1, this._teleportPressedFrame = !1, this._scaleValueChange = 0, this._cbClick = this.onClick.bind(this), this._canvasX = 0, this._canvasY = 0, this._preferLeftHand = !1, this.init()
        };
    b.createPrototypeNode(I, b.objectInherit(b.MatrixTransform.prototype, {
        init: function () {
            var e = this._proxyControllerMT.getOrCreateStateSet();
            e.addUniform(b.Uniform.createFloat3(R, "uAlbedo")), e.addUniform(this._uNormalSign), e.addUniform(b.Uniform.createFloat(.4, "uRoughness")), e.addUniform(b.Uniform.createFloat(0, "uMetalness")), e.setShaderGeneratorName("controller"), p.a.createMaterialModel(e).trigger("apply");
            var t = this._geomPointer.getOrCreateStateSet();
            t.addUniform(this._uPointerAlpha), t.setRenderBinDetails(o.a.VR_CURSOR, "RenderBin"), t.setAttributeAndModes(d.a.BLEND_SUBSTRACTIVE), t.setAttributeAndModes(r.a.createShader(g.a, _.a, "webVR-laser", "VRLaser")), f.a.initWebVRNavigation(this), this._ctrlLeft = .32, this._ctrlFwrd = .55
        },
        setEventListeners: function () {
            this._model.get("hasNativeHMD") ? window.addEventListener("click", this._cbClick) : this._inputManager.setEnable(S.WEBVR_NAVIGATION, !0)
        },
        removeEventListeners: function () {
            this._model.get("hasNativeHMD") ? window.addEventListener("click", this._cbClick) : this._inputManager.setEnable(S.WEBVR_NAVIGATION, !1)
        },
        onClick: function () {
            this._teleportPressed = !0, this._clickPressed = !0
        },
        setListenToEvents: function (e) {
            e ? this.setEventListeners() : this.removeEventListeners()
        },
        isPosedController: function () {
            var e = this._activeController;
            return !!(e && e.pose && e.pose.hasOrientation)
        },
        _createGeometryFromJSON: function (e) {
            var t = new b.Geometry,
                i = t.getAttributes();
            i.Vertex = new b.BufferArray(b.BufferArray.ARRAY_BUFFER, e.VERTEX, 3), i.Normal = new b.BufferArray(b.BufferArray.ARRAY_BUFFER, e.NORMAL, 3), i.Color = new b.BufferArray(b.BufferArray.ARRAY_BUFFER, e.COLOR, 1);
            var n = t.getPrimitives(),
                r = new b.BufferArray(b.BufferArray.ELEMENT_ARRAY_BUFFER, e.TRIANGLES, 1);
            n.push(new b.DrawElements(b.primitiveSet.TRIANGLES, r));
            var a = new b.BufferArray(b.BufferArray.ELEMENT_ARRAY_BUFFER, e.STRIP, 1);
            return n.push(new b.DrawElements(b.primitiveSet.TRIANGLE_STRIP, a)), t
        },
        replaceControllerMesh: function (e) {
            this._proxyControllerMT.removeChildren();
            var t = this._createGeometryFromJSON(e.BODY),
                i = this._createGeometryFromJSON(e.BUTTON);
            this._proxyControllerMT.addChild(t), this._proxyControllerMT.addChild(i), i.getOrCreateStateSet().addUniform(b.Uniform.createFloat3(O, "uAlbedo")), this._updateCorrectionMatrix()
        },
        _checkControllerHand: function (e) {
            this._activeController && "left" === this._activeController.hand ? (b.mat4.scale(e, e, b.vec3.set(x, -1, 1, 1)), this._uNormalSign.setFloat(-1)) : this._uNormalSign.setFloat(1)
        },
        _updateCorrectionMatrix: function () {
            var e = this._proxyControllerMT.getMatrix();
            if (this._gamepadType === T) b.mat4.fromTranslation(e, b.vec3.set(x, 0, .03262643, .031930979)), b.mat4.rotateX(e, e, .22 * Math.PI), this._checkControllerHand(e);
            else if (this._gamepadType === P) {
                var t = Object(c.a)().forceControllerOrientation;
                b.mat4.fromXRotation(e, Math.PI * t), t = Object(c.a)().forceControllerRayOrientation, b.mat4.rotateX(this._pointerMT.getMatrix(), this._pointerMT.getMatrix(), Math.PI * t), this._checkControllerHand(e)
            } else b.mat4.identity(e)
        },
        onPointerDown: function () {
            l.a.any && !this._activeController && (this._pointerClicked = !0)
        },
        onPointerUp: function (e) {
            this._pointerClicked = !1, l.a.any || Math.abs(e.canvasX - this._canvasX) < 5 && Math.abs(e.canvasY - this._canvasY) < 5 && (this._clickPressed = !0, this._teleportPressed = !0)
        },
        displayMenu: function () {
            this._menuPressed = !0
        },
        onMouseDown: function (e) {
            l.a.any && !this._activeController && this._model.get("hasNativeHMD") && (this._teleportPressed = !0), l.a.any || (this._canvasX = e.canvasX, this._canvasY = e.canvasY)
        },
        updateButtonsPressed: function () {
            if (this._activeController)
                for (var e = this._pressedButtons.length, t = 0; t < e; ++t) {
                    var i = this._activeController.buttons[t].pressed;
                    i !== this._pressedButtons[t] && (this._pressedButtons[t] = i, i ? this.onButtonDown(t) : this.onButtonUp(t))
                }
        },
        updateHoverAxes: function () {
            if (this._gamepadType === T) this._scaleValueChange = 0, this.updateScaleChangeFromXAxis(T.SCALE_THRESHOLD);
            else if (this._gamepadType === P) {
                var e = this._activeController.axes[1];
                e < -P.SCALE_THRESHOLD ? (this._teleportPressedAiming = !0, this._uPointerAlpha.setFloat(.5)) : this._teleportPressedAiming && (this._uPointerAlpha.setFloat(1), this._teleportPressedAiming = !1, this._teleportPressed = !0), this._scaleValueChange = 0, this.updateScaleChangeFromXAxis(P.SCALE_THRESHOLD, 2, -1)
            }
        },
        updateScaleChangeFromXAxis: function (e, t, i) {
            void 0 === t && (t = 0);
            var n = this._activeController.axes[t];
            void 0 === i && (i = 1), n > e ? this._scaleValueChange = i : n < -e && (this._scaleValueChange = -i)
        },
        updatePointerClick: function (e) {
            if (this._pointerClicked) {
                if (this._timeSinceLastPointerClick > 1.2) return this._menuPressed = !0, this._pointerClicked = !1, void(this._timeSinceLastPointerClick = 0);
                this._timeSinceLastPointerClick += e
            } else this._timeSinceLastPointerClick > 0 && this._timeSinceLastPointerClick < 1.2 && (l.a.any && (this._clickPressed = !0, this._teleportPressed = !0), this._timeSinceLastPointerClick = 0)
        },
        onButtonUp: function (e) {
            if (this._gamepadType === C) switch (e) {
                case C.TRIGGER:
                    this._clickPressed = !0, this._teleportPressed = !0;
                    break;
                case C.TOUCHPAD:
                    this._scaleValueChange = 0;
                    break;
                case C.MENU:
                    this._menuPressed = !0
            } else if (this._gamepadType === P) switch (e) {
                case P.TRIGGER:
                case P.THUMBSTICK:
                    this._clickPressed = !0, this._teleportPressed = !0;
                    break;
                case P.TOUCHPAD:
                    this._scaleValueChange = 0;
                    break;
                case P.MENU:
                    this._menuPressed = !0
            } else if (this._gamepadType === T) switch (e) {
                case T.TRIGGER_UP:
                    this._clickPressed = !0, this._teleportPressed = !0;
                    break;
                case T.BY:
                    this._menuPressed = !0
            } else if (this._gamepadType === M) switch (e) {
                case M.TOUCHPAD:
                    this._clickPressed = !0, this._teleportPressed = !0;
                    break;
                case M.HOME:
                    this._menuPressed = !0;
                    break;
                case M.CIRCULAR_UP:
                case M.CIRCULAR_DOWN:
                    this._scaleValueChange = 0
            } else if (this._gamepadType === w) switch (e) {
                case w.TRIGGER:
                    this._clickPressed = !0, this._teleportPressed = !0;
                    break;
                case w.THUMBSTICK:
                    this._menuPressed = !0
            } else if (this._gamepadType === E) switch (e) {
                case E.TOUCHPAD:
                    0 !== this._scaleValueChange && (this._menuPressed = !1, this._pointerClicked = !1, this._teleportPressed = !1), this._pointerClicked = !1, this._scaleValueChange = 0
            } else if (this._gamepadType === A) switch (e) {
                case A.TOUCHPAD:
                    this._pointerClicked = !1
            } else if (this._gamepadType === y) switch (e) {
                case y.TOUCHPAD:
                    this._clickPressed = !0, this._teleportPressed = !0
            }
        },
        onButtonDown: function (e) {
            if (this._gamepadType === C) switch (e) {
                case C.TOUCHPAD:
                    this.updateScaleChangeFromXAxis(C.SCALE_THRESHOLD)
            } else if (this._gamepadType === P) switch (e) {
                case P.TOUCHPAD:
                    this.updateScaleChangeFromXAxis(P.SCALE_THRESHOLD, 2, -1)
            } else if (this._gamepadType === M) switch (e) {
                case M.CIRCULAR_UP:
                    this._scaleValueChange = 1;
                    break;
                case M.CIRCULAR_DOWN:
                    this._scaleValueChange = -1
            } else if (this._gamepadType === w) switch (e) {
                case w.CIRCULAR_UP:
                    this._scaleValueChange = 1;
                    break;
                case w.CIRCULAR_DOWN:
                    this._scaleValueChange = -1
            } else if (this._gamepadType === E) switch (e) {
                case E.TOUCHPAD:
                    this.updateScaleChangeFromXAxis(E.SCALE_THRESHOLD), this._pointerClicked = 0 === this._scaleValueChange
            } else if (this._gamepadType === A) switch (e) {
                case A.TOUCHPAD:
                    this._pointerClicked = !0
            }
        },
        getAndSetActiveController: function () {
            if (navigator.getGamepads) {
                var e = navigator;
                try {
                    if (!(e = window.parent.navigator)) throw new Error("Host is not defined")
                } catch (t) {
                    e = navigator
                }
                var t = e.getGamepads(),
                    i = this._activeController;
                if (this._activeController = this._getControllerWithPressedButtons(t), this._activeController || (this._hasController(t, i) ? this._activeController = i : this._activeController = this._getControllerWithOrientationAndPreferredHand(t)), !this._activeController) return this._pressedButtons.length = 0, void(this._gamepadType = void 0);
                if (i !== this._activeController) {
                    for (var n = this._pressedButtons.length = this._activeController.buttons.length, r = 0; r < n; ++r) this._pressedButtons[r] = !1;
                    this._gamepadType = this._getGamepadType(this._activeController), this._updateCorrectionMatrix()
                }
            }
        },
        _hasController: function (e, t) {
            if (!t) return !1;
            for (var i = 0, n = e.length; i < n; ++i)
                if (e[i] === t) return !0;
            return !1
        },
        _getControllerWithPressedButtons: function (e) {
            for (var t = 0, i = e.length; t < i; ++t) {
                var n = e[t];
                if (n) {
                    if (!(n.pose && n.pose.hasOrientation) || n.pose.orientation)
                        for (var r = n.buttons.length, a = 0; a < r; ++a)
                            if (n.buttons[a].pressed) return n
                }
            }
        },
        setPreferLeftHand: function (e) {
            this._preferLeftHand !== e && (this._preferLeftHand = e, this.getAndSetActiveController(), this._updateCorrectionMatrix())
        },
        _getControllerWithOrientationAndPreferredHand: function (e) {
            for (var t, i = this._preferLeftHand ? "left" : "right", n = 0, r = e.length; n < r; ++n) {
                var a = e[n];
                if (a) {
                    var o = a.pose && a.pose.hasOrientation;
                    if (!o || a.pose.orientation) {
                        if (o && a.hand === i) return a;
                        !o && t || (t = a)
                    }
                }
            }
            return t
        },
        _getGamepadType: function (e) {
            var t = e && e.id;
            if (t) return t = t.toLowerCase(), -1 !== t.indexOf("oculus") ? -1 !== t.indexOf("touch") ? T : -1 !== t.indexOf("go") ? w : M : -1 !== t.indexOf("cardboard button") ? y : -1 !== t.indexOf("daydream") ? E : -1 !== t.indexOf("gear vr") ? A : -1 !== t.indexOf("spatial controller") ? P : -1 !== t.indexOf("vive") ? C : -1 !== t.indexOf("openvr") ? (t = this._model.get("displayName")) ? (t = t.toLowerCase(), -1 !== t.indexOf("oculus") ? T : -1 !== t.indexOf("windows") ? P : C) : C : void 0
        },
        applyPoseMatrix: function () {
            var e = b.quat.create(),
                t = b.vec3.create(),
                i = b.mat4.create();
            return function (n, r, a, o) {
                if (r) {
                    var s = a.stageParameters && a.stageParameters.sittingToStandingTransform,
                        u = r.orientation;
                    r.hasOrientation && u && (s && (u = b.mat4.getRotation(e, s), b.quat.multiply(u, u, r.orientation)), u = b.quat.set(e, u[0], -u[2], u[1], u[3]), b.quat.multiply(u, this._postMultRotate, u), b.mat4.multiply(n, n, b.mat4.fromQuat(i, u)));
                    var l = this._model.get("worldFactor"),
                        c = r.position;
                    if (r.hasPosition && c) s && (c = b.vec3.transformMat4(t, c, s)), c = b.vec3.set(t, c[0] * l, -c[2] * l, c[1] * l), b.vec3.transformQuat(c, c, this._postMultRotate), b.vec3.add(c, c, o), b.mat4.setTranslation(n, c);
                    else if (!r.hasPosition) {
                        t[0] = .2 * l * ("left" === a.hand ? -1 : 1), t[1] = .3 * l, t[2] = 0, b.vec3.transformQuat(t, t, e), t[2] += 1.2 * l, b.vec3.add(t, t, o), b.mat4.setTranslation(n, t)
                    }
                }
            }
        }(),
        updatePointerScaleFromHit: function (e) {
            var t = b.mat4.getTranslation(b.vec3.create(), this.getMatrix()),
                i = b.vec3.dist(t, e);
            this._hitScaleOffset = i / this._model.get("worldFactor")
        },
        resetPointerScale: function () {
            this._hitScaleOffset = 20
        },
        isMenuPressed: function () {
            return this._menuPressedFrame
        },
        isTeleportPressed: function () {
            return this._teleportPressedFrame
        },
        isClickPressed: function () {
            return this._clickPressedFrame
        },
        checkScaleChangeValue: function () {
            return this._scaleValueChange
        },
        checkDownloadController: function () {
            var e = Object(c.a)().forceController,
                t = this._gamepadType;
            if (e) switch (e) {
                case "daydream":
                    t = E;
                    break;
                case "oculus":
                    t = T;
                    break;
                case "go":
                    t = w;
                    break;
                case "windows":
                    t = P;
                    break;
                default:
                    t = C
            } else if (!this.isPosedController()) return;
            t === E ? this._controllerMeshDisplay !== E && (this._controllerMeshDisplay = E, s.a.getControllerDaydream(this.replaceControllerMesh.bind(this))) : t === T ? this._controllerMeshDisplay !== T && (this._controllerMeshDisplay = T, s.a.getControllerOculusTouch(this.replaceControllerMesh.bind(this))) : t === w ? this._controllerMeshDisplay !== w && (this._controllerMeshDisplay = w, s.a.getControllerOculusGo(this.replaceControllerMesh.bind(this))) : t === P ? this._controllerMeshDisplay !== P && (this._controllerMeshDisplay = P, s.a.getControllerWin(this.replaceControllerMesh.bind(this))) : this._controllerMeshDisplay !== C && (this._controllerMeshDisplay = C, s.a.getControllerVive(this.replaceControllerMesh.bind(this)))
        },
        updateNodeVR: function () {
            var e = b.vec3.create();
            return function (t, i, n) {
                var r = this._model.get("worldFactor");
                this.getAndSetActiveController(), this.checkDownloadController(), this.updatePointerClick(i), this.updateButtonsPressed(), this.updateHoverAxes();
                var o = this.getMatrix();
                b.mat4.fromScaling(this._pointerMTScale.getMatrix(), b.vec3.set(e, .05, this._hitScaleOffset, 1)), b.mat4.fromScaling(o, b.vec3.set(e, r, r, r)), Object(c.a)().forceController ? (this.setNodeMask(a.a.NO_PICK), b.mat4.copy(o, this._model.get("humanMatrix")), o[14] += 2 * r) : this.isPosedController() ? (this.setNodeMask(a.a.NO_PICK), this.applyPoseMatrix(o, this._activeController.pose, t, n)) : this.setNodeMask(0), this._menuPressedFrame = this._menuPressed, this._clickPressedFrame = this._clickPressed, this._teleportPressedFrame = this._teleportPressed, this._clickPressed = !1, this._menuPressed = !1, this._teleportPressed = !1, this.dirtyBound()
            }
        }(),
        raycastFromController: function () {
            var e = b.vec3.fromValues(0, 20, 0),
                t = b.mat4.create();
            return function (i, n, r, o, s) {
                var u = this.getMatrix();
                if (this._gamepadType === P) {
                    var l = 2 * Object(c.a)().forceControllerRayOrientation;
                    u = t, b.mat4.rotateX(u, this.getMatrix(), Math.PI * l)
                }
                b.mat4.getTranslation(o, u), b.vec3.set(s, 0, r / this._model.get("worldFactor"), 0), b.vec3.transformMat4(s, s, u);
                var d = h.a.computeNearestIntersection3DHotspotFirst(o, s, a.a.PICK_GEOMETRY_FAST, i);
                return d || b.vec3.transformMat4(s, e, u), d
            }
        }()
    }), "osgSketchfab", "Controller"), t.a = I
}, function (e, t, i) {
    "use strict";
    var n = i(438),
        r = i(1421),
        a = i(586),
        o = i(638),
        s = i(9),
        u = i(77),
        l = i(936),
        c = (i.n(l), s.a.osgAnimation),
        h = s.a.osg,
        d = c.easeOutCubic,
        f = function (e) {
            h.Node.call(this), this._menuPanel = new a.a(.9, 2.5, o.a.AXIS_BOTH, .2, 10, 10), this._menuPanel.setUseCache(!0), this._menuPanel.setClickAction("vrHelpButton", this.displayHelp.bind(this)), this._menuPanel.setClickAction("vrExitButton", this.hide.bind(this)), this._menuPanel.setVisible(!1);
            var t = new r.a(h.vec3.fromValues(0, 0, -.05), .15, d, this._menuPanel, e);
            this._menuPanel.setAnimation(t), this.addChild(this._menuPanel), this._helpPanel = new o.a(2, 2, o.a.AXIS_BOTH, .2, 10, 10), this._helpPanel.setPanelClickAction(this.hideHelp.bind(this)), this._helpPanel.setVisible(!1);
            var i = new r.a(h.vec3.fromValues(0, 0, 0), .3, d, this._helpPanel, e);
            this._helpPanel.setAnimation(i), this.addChild(this._helpPanel), this._model = e
        };
    h.createPrototypeNode(f, h.objectInherit(h.Node.prototype, {
        initialize: function (e) {
            var t = e.hotspot._views[0]._hotspots;
            this._menuPanel.initialize("skfb_front/macros/vr/vr-menu", {
                hasHotspotsNavigation: t.length && t.length > 1
            }), n.a.getBaseVR(function (e) {
                var t = u.default.instance.getOrCreateTexture(e.MENU_HELP, {
                    internalFormat: h.Texture.RGBA
                }).texture;
                this._helpPanel.initialize(t, {
                    width: 1e3,
                    height: 500
                })
            }.bind(this))
        },
        display: function (e, t) {
            this._menuPanel.displayInView(e, t, this._model.get("worldFactor"))
        },
        hide: function () {
            this._menuPanel.setVisible(!1), this._helpPanel.isVisible() && this._helpPanel.setVisible(!1)
        },
        setHomeAction: function (e) {
            this._menuPanel.setClickAction("vrHomeButton", e)
        },
        setNextAction: function (e) {
            this._menuPanel.setClickAction("vrNextButton", e)
        },
        setPrevAction: function (e) {
            this._menuPanel.setClickAction("vrPrevButton", e)
        },
        displayHelp: function () {
            h.mat4.copy(this._helpPanel.getMatrix(), h.mat4.create()), h.mat4.setTranslation(this._helpPanel.getMatrix(), h.vec3.fromValues(0, 0, .2)), h.mat4.multiply(this._helpPanel.getMatrix(), this._menuPanel.getMatrix(), this._helpPanel.getMatrix()), this._helpPanel.setVisible(!0)
        },
        hideHelp: function () {
            this._helpPanel.isVisible() && this._helpPanel.setVisible(!1)
        },
        isVisible: function () {
            return this._menuPanel.isVisible()
        },
        isHelpVisible: function () {
            return this._helpPanel.isVisible()
        },
        updateHit: function (e) {
            return this._helpPanel.isVisible() ? this._helpPanel.updateHit(e) : this._menuPanel.isVisible() ? this._menuPanel.updateHit(e) : void 0
        },
        click: function () {
            this._helpPanel.isVisible() ? this._helpPanel.click() : this._menuPanel.isVisible() && this._menuPanel.click()
        }
    }), "osgSketchfab", "Menu"), t.a = f
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = n.a.osg,
        a = function (e, t, i, n, a) {
            this._startPosOffset = e, this._startPos = r.vec3.create(), this._targetPos = r.vec3.create(), this._duration = t, this._easingFunc = i, this._result = r.vec3.create(), this._hasStarted = !1, this._reverse = !1, this._finished = !0, this._node = n, this._model = a
        };
    a.prototype = {
        isFinished: function () {
            return this._finished
        },
        _reverseAnim: function () {
            this._reverse = !this._reverse
        },
        start: function () {
            var e = r.vec3.create();
            return function (t) {
                this._started = .05 * -t, this._hasStarted = !1, this._finished = !1, r.vec3.scale(e, this._startPosOffset, this._model.get("worldFactor")), this._reverse ? (r.mat4.getTranslation(this._startPos, this._node.getMatrix()), r.vec3.add(this._targetPos, this._startPos, e), this._node.setOpacity(1)) : (r.mat4.getTranslation(this._targetPos, this._node.getMatrix()), r.vec3.add(this._startPos, this._targetPos, e), this._node.setOpacity(0)), r.mat4.setTranslation(this._node.getMatrix(), this._startPos)
            }
        }(),
        update: function (e, t) {
            if (!this._finished) {
                var i = t.getFrameStamp().getSimulationTime();
                if (this._started < 0) return this._started += t.getFrameStamp().getDeltaTime(), !0;
                this._hasStarted || (this._started = i, this._hasStarted = !0);
                var n = (i - this._started) / this._duration;
                return n > 1 && (this._finished = !0, n = 1), this._easingFunc && (n = this._easingFunc(n)), this.interpolate(n, e), this._finished && (this._reverseAnim(), this._onFinishCallback && this._onFinishCallback(), this._node.dirtyBound()), !0
            }
        },
        interpolate: function (e, t) {
            r.vec3.lerp(this._result, this._startPos, this._targetPos, e), r.mat4.setTranslation(t.getMatrix(), this._result), this._reverse ? this._node.setOpacity(1 - e) : this._node.setOpacity(e)
        },
        setOnFinishCallback: function (e) {
            this._onFinishCallback = e
        }
    }, t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(90),
        r = i(1423),
        a = i(1425),
        o = {
            FeatureName: "sound",
            ModelType: r.a,
            ViewListType: [a.a]
        },
        s = n.a.create(o);
    s.prototype.getNode = function () {
        return this._views[0].getNode()
    }, s.prototype.getWidgetNode = function () {
        return this._views[0].getNodeEditor()
    }, s.prototype.prepareForScreenShot = function () {
        var e = n.a.prototype.prepareForScreenShot.call(this);
        return e && this._views[0].setPauseUpdate(!0), e
    }, s.prototype.resetAfterScreenShot = function () {
        n.a.prototype.resetAfterScreenShot.call(this), this._views[0].setPauseUpdate(!1)
    }, t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(149),
        r = i(20),
        a = i(706),
        o = i(77),
        s = i(600);
    t.a = n.a.extend({
        getModelOptionPath: function () {
            return "sound"
        },
        defaults: function () {
            return {
                currentSoundIndex: -1,
                visible: Object(r.a)().uiSound,
                autoplay: !0,
                playing: !1,
                volume: void 0,
                select: void 0,
                enable: !0
            }
        },
        getName: function () {
            return "Sound"
        },
        init: function (e) {
            this._viewer = e.getViewer(), this.set("volume", s.a.getVolume());
            var t = e.getModel().get("options").sound;
            this.set("soundtracks", o.default.instance.getSoundCollection()), this.setJSON(t)
        },
        setJSON: function (e, t) {
            var i = e && e.soundtracks;
            if (i && i.length)
                for (var n = this.get("soundtracks"), r = 0; r < i.length; ++r) {
                    var o = i[r],
                        s = n.findWhere({
                            uid: o.uid
                        }),
                        u = !0;
                    s ? s.get("isInit") ? s = s.duplicate() : u = !1 : s = new a.a, s.setJSON(o, t), s.set("isInit", !0), u && n.add(s)
                }
        },
        getJSON: function () {
            var e = [];
            return this.get("soundtracks").each(function (t) {
                e.push(t.getJSON())
            }), {
                soundtracks: e
            }
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(38),
        a = i.n(r),
        o = i(5),
        s = i.n(o),
        u = i(86),
        l = i(677),
        c = n.a.osg,
        h = .2;
    l.a && (h = .35);
    var d = function (e, t, i) {
        var n = i.isNew() ? i.get("url") : i.get("files")[0].url;
        this._src = n, t && this.setMediaElement(t), this._manager = e, this._model = i, this._mediaElementSource = void 0, this._gain = void 0, this._panner = void 0, this._canPlayDefered = void 0, this._isPlaying = !1, this._seeking = !1, this._duration = void 0, this._isPlayerPendingToPlay = !1, this._doPausePlayerWhenPendingToPlayFinished = void 0, this.pendingToPlayResolvedBound = this.pendingToPlayResolved.bind(this), this.releasePlayerBound = this.releasePlayer.bind(this)
    };
    d.prototype = {
        setMediaElement: function (e) {
            this._player = e, this._player.setAttribute("src", this._src), a.a.apple.device || this._player.load(), this._player.addEventListener("ended", this.onEnded.bind(this)), this._player.addEventListener("loadedmetadata", function (e) {
                this._duration = e.currentTarget.duration
            }.bind(this))
        },
        isPlayerPlaying: function () {
            return !!this._player && !(!(this._player.currentTime > 0) || this._player.paused || this._player.ended)
        },
        playerPlay: function () {
            if (this._player && !this.isPlayerPlaying()) {
                if (this._isPlayerPendingToPlay) return this._pendingToPlayPromise;
                this._managerContextVersion = this._manager._releaseSafeCounter;
                var e;
                try {
                    e = this._player.play()
                } catch (e) {
                    return this.checkAndHandleDOMError(e), s.a.resolve()
                }
                return this._isPlayerPendingToPlay = !0, this._pendingToPlayPromise = e, e || (e = new s.a(function (e) {
                    this._player.addEventListener("play", e)
                }.bind(this))), e.then(this.pendingToPlayResolvedBound).catch(function (e) {
                    if (e instanceof DOMException && "The element has no supported sources." === e.message) return this._isPlayerPendingToPlay = !1, void(this._pendingToPlayPromise = void 0);
                    if (!this.checkAndHandleDOMError(e)) return this._doPausePlayerWhenPendingToPlayFinished || this._managerContextVersion !== this._manager._releaseSafeCounter || this._manager.releasePending ? void this.pendingToPlayResolved() : (this._isPlayerPendingToPlay = !1, this._pendingToPlayPromise = void 0, void window.setTimeout(this.playerPlay.bind(this), 1e3))
                }.bind(this)), e
            }
        },
        playerPause: function () {
            return this._gain && 0 !== this._gain.gain.value && this.setGainValue(0), this._doPausePlayerWhenPendingToPlayFinished ? this._doPausePlayerWhenPendingToPlayFinished.promise : this._isPlayerPendingToPlay ? (this._doPausePlayerWhenPendingToPlayFinished = new u.a, this._doPausePlayerWhenPendingToPlayFinished.promise) : (this.isPlayerPlaying() && this._player && this._player.pause(), s.a.resolve())
        },
        pendingToPlayResolved: function () {
            this._isPlayerPendingToPlay = !1, this._pendingToPlayPromise = void 0, this._doPausePlayerWhenPendingToPlayFinished && (this._player && this._player.pause(), this._doPausePlayerWhenPendingToPlayFinished.resolve(), this._doPausePlayerWhenPendingToPlayFinished = void 0), this.updateVolume()
        },
        releasePlayer: function () {
            this._player = void 0, this._mediaElementSource = void 0
        },
        onEnded: function () {
            this._model.get("loop") || this.pause()
        },
        play: function () {
            this._isPlaying = !0, this.updateVolume()
        },
        pause: function () {
            this._isPlaying = !1, this.updateVolume()
        },
        getModel: function () {
            return this._model
        },
        updateVolume: function () {
            if (this._player) {
                if (this._manager.getIsMute()) return void this.setGainValue(0);
                if (!this._gain || !this._manager.isTabVisible()) return void this.setGainValue(0);
                if (void 0 === this._model.get("volume") || !this._isPlaying || this._seeking || !this._manager.isPlaying()) {
                    if (this._player.muted) return;
                    return c.debug("[SOUND] Volume Change: " + this._model.get("name") + " = 0"), void this.setGainValue(0)
                }
                this._volumeReal = this._model.get("volume") * this._manager.getVolume(), this.setGainValue(this._volumeReal)
            }
        },
        _seekToSync: function (e) {
            return !!this._player && (void 0 !== this._duration && this._duration < 1.5 || (Math.abs(this._player.currentTime - e) > h ? this._player.seeking ? (this._seeking = !0, !1) : (this._player.currentTime = e + .05, this._seeking = !0, !1) : !(this._seeking && !this._player.seeking && (this._seeking = !1, 0))))
        },
        setTime: function (e, t) {
            if (this._manager.canPlay()) {
                if (!this._player || !this._gain) {
                    if (!t) return;
                    this.updateFromModel()
                }
                if (void 0 !== this._duration) {
                    var i = this._model.get("loop");
                    if (this._player.loop !== i && (this._player.loop = i), this.isSoundAsync()) return void(i || this._player.currentTime < this._duration ? this.play() : this.pause());
                    var n = e - this._model.get("startTime"),
                        r = n >= 0;
                    if (r && (i ? n %= this._duration : r = r && this._duration >= n), !r) return this.isPlayerPlaying() && (this._player.currentTime = 0, this.playerPause()), void this.pause();
                    this._seekToSync(n) && this._manager.isPlaying() ? (!this.isPlayerPlaying() && this._manager.isPlaying() && this.playerPlay(), this.play()) : this.pause()
                }
            }
        },
        isSoundAsync: function () {
            return !1 === this._manager._hasAnim || !this._model.get("sync")
        },
        setRefDistanceNormalized: function (e) {
            this._panner && (this._panner.refDistance = e / this._manager.getRadius())
        },
        setMaxDistanceNormalized: function (e) {
            this._panner && (this._panner.maxDistance = e / this._manager.getRadius())
        },
        setPositionNormalized: function (e) {
            if (this._panner) {
                var t = this._manager.getRadius();
                this._manager._setPannerPosition(this._panner, e[0] / t, e[1] / t, e[2] / t)
            }
        },
        setLoop: function () {
            this._player && (this._player.loop = this._model.get("loop"))
        },
        updateFromModel: function () {
            if (!this._player) {
                var e = this._manager._createAudio();
                e && this.setMediaElement(e)
            }
            this.setLoop();
            var t;
            if (t = this._model.get("ambient") ? this._manager.connectAmbientSound(this) : this._manager.connect3DSound(this), this.isSoundAsync() && this.play(), t) return void t.catch(function (e) {
                this.checkAndHandleDOMError(e)
            }.bind(this));
            this.isSoundAsync() && this.playerPlay(), this.updateVolume()
        },
        checkAndHandleDOMError: function (e) {
            c.debug(e.message);
            var t = ["Failed to execute 'play' on 'HTMLMediaElement': API can only be initiated by a user gesture.", "play() can only be initiated by a user gesture."];
            return e instanceof DOMException && -1 !== t.indexOf(e.message) && (this._authErrors = !0, this.pendingToPlayResolved(), this._manager._lock(), !0)
        },
        whenReady: function () {
            if (!this._canPlayDefered) {
                var e = new s.a(function (e) {
                    this._player.addEventListener("canplaythrough", e)
                }.bind(this));
                this._canPlayDefered = e
            }
            return this._canPlayDefered
        },
        setGainValue: function (e) {
            if (this._player && (this._player.muted = e <= 0), this._gain) {
                var t = this._gain.gain;
                if (t.setValueAtTime) {
                    var i = this._manager.getOrCreateAudioContext();
                    if (!i) return;
                    t.setValueAtTime(e, i.currentTime)
                } else t.value = e
            }
        }
    }, t.a = d
}, function (e, t, i) {
    "use strict";
    var n = i(103),
        r = i(9),
        a = i(5),
        o = i.n(a),
        s = i(8),
        u = i(47),
        l = i(20),
        c = i(79),
        h = i(38),
        d = i.n(h),
        f = i(44),
        p = i(1426),
        m = i(600),
        g = i(456),
        v = i(704),
        _ = i(147),
        b = r.a.osg;
    t.a = s.a.extend({
        initialize: function (e) {
            s.a.prototype.initialize.apply(this, arguments), this._currentFrame = 0, this._currentSimulationTime = 0, this._soundPromises = [], this._soundObjects = [], this._context = e.context, this._viewer = this._context.getViewer();
            var t = Object(l.a)().soundEnable;
            this.model.set("enable", t), Object(l.a)().soundMute && (this.model.set("mute", !0), this.model.set("volume", 0), m.a.setMute(!0)), this._nodeFeature = new b.Node, this._nodeFeature.setName("Feature - Sound"), Object(c.a)() && p.a.init(this.model, this._context, this._nodeFeature), this.listenTo(this.model, "change:playing", this.onPlayingChange.bind(this)), this.listenTo(this.model, "change:enable", this.onEnableChange.bind(this)), this.listenTo(this.model, "change:volume", this.updateVolume.bind(this)), this.listenTo(this.model, "change:mute", this.updateMute.bind(this));
            var i = this.model.get("soundtracks");
            Object(_.a)() || t && m.a.checkWillHaveSounds(this._viewer.model) || i.reset();
            var n = i.length > 0;
            if (!n && (u.a.resolveHasSound(n), !Object(c.a)())) return void this.model.set("enable", !1);
            if (this._nodeFeature.setCullCallback(this), Object(c.a)() || n) {
                var r = Object(v.a)();
                r && document.addEventListener(r, this.tabChange.bind(this))
            }
            if (d.a.apple.device) {
                var a, h, f = !1,
                    g = [];
                for (a = 0, h = i.length; a < h; a++) {
                    var S = i.at(a);
                    !f && S.get("ambient") ? f = S : g.push(S)
                }
                for (a = 0, h = g.length; a < h; a++) i.remove(g[a]);
                if (!f) return void u.a.resolveHasSound(!1)
            }
            this.listenTo(i, "add", this.onAdd.bind(this)), this.listenTo(i, "remove", this.onRemove.bind(this)), this.listenTo(i, "select", this.onSelectChanged.bind(this)), m.a.setWaiting(!Object(c.a)()), i.each(this.onAdd.bind(this)), u.a.resolveHasSound(n);
            var x = [];
            x.push(u.a.getHasAnimation()), Object(l.a)().soundPreload && x.push(o.a.all(this._soundPromises).then(function () {
                u.a.resolveSoundsCanPlayTrough(!0)
            })), o.a.all(x).then(function (e) {
                this._hasAnim = e[0], m.a.setHasAnim(this._hasAnim), u.a.resolveSoundsCanPlayTrough(!0), this._hasAnim || (m.a.setWaiting(!1), this.play()), u.a.getFirstAnimation().then(function () {
                    Object(c.a)() && p.a.initDepthTexture(), this.updatePositionAndTime(this.model.get("playing"));
                    var e = this._viewer.getFeatures().animation.getModel();
                    this._featureAnimationModel = e, this._hasAnim && (m.a.setWaiting(!1), e.bind("change:playing", this.onAnimationPlaying, this), e.bind("change:speed", this.onAnimationSpeedChange, this), e.bind("seek", this.onAnimationTimeSeek, this), e.bind("change:currentUID", this.onUidChange, this), this.onAnimationPlaying(e))
                }.bind(this))
            }.bind(this))
        },
        isTabHidden: function () {
            return document[this._hidden]
        },
        tabChange: function () {
            this.model.get("enable") && (Object(v.b)() ? m.a.hide() : (m.a.show(), this._hasAnim && this._featureAnimationModel ? this.onAnimationPlaying(this._featureAnimationModel) : m.a.forcePlay(!0), this.updatePositionAndTime(this.model.get("playing")), m.a.update()))
        },
        animationTimeSync: function () {
            if (m.a.canPlay() && this._featureAnimationModel) {
                var e = this.getTimeFromAnimationProgress();
                e !== this._currentSimulationTime && (this._currentSimulationTime = e, this.updatePositionAndTime(this._featureAnimationModel.get("playing")))
            }
        },
        updatePositionAndTime: function (e) {
            if (m.a.canPlay())
                for (var t = this._viewer.getFeaturesManager && this._viewer.getFeaturesManager(), i = 0, n = this._soundObjects.length; i < n; i++) {
                    var r = this._soundObjects[i];
                    t && this.onSoundPositionChange(r.getModel()), r.setTime(this._currentSimulationTime, e)
                }
        },
        onAnimationPlaying: function (e) {
            if (1 !== this._featureAnimationModel.get("speed")) return void m.a.setWaiting(!0);
            var t = e.get("playing");
            this.model.set("playing", t), t ? this.play() : this.pause()
        },
        onUidChange: function (e) {
            "-1" === e.get("currentUID") ? this.pause() : e.get("playing") && this.play()
        },
        getTimeFromAnimationProgress: function () {
            var e = this._featureAnimationModel.getCurrentAnimation();
            if (!e) return 0;
            var t = e.get("duration");
            return this._featureAnimationModel.get("progress") * t / 100
        },
        onAnimationTimeSeek: function () {
            this._currentSimulationTime = this.getTimeFromAnimationProgress()
        },
        onAnimationSpeedChange: function (e) {
            if (1 !== e.get("speed")) {
                if (this.pause(), m.a.setWaiting(!0), !Object(c.a)()) return;
                m.a.getProxyModel().trigger("sound-show", "Warning. Changing the animation speed will not change the sound speed. This can lead to unexpected sound playback issues", {
                    position: "top",
                    duration: 5e3
                })
            } else m.a.setWaiting(!1), this.play()
        },
        onSoundChange: function (e) {
            e.get("soundObject").updateFromModel(e), f.a.draw()
        },
        onSoundPositionChange: function (e) {
            e.get("soundObject").setPositionNormalized(Object(g.d)(e))
        },
        onSoundDistanceChange: function (e) {
            e.get("soundObject").setRefDistanceNormalized(e.get("distance"))
        },
        onSoundDistanceMaxPositionChange: function (e) {
            e.get("soundObject").setMaxDistanceNormalized(e.get("distanceMax"))
        },
        onSoundTimeChange: function (e) {
            var t = e.get("soundObject"),
                i = this.getTimeFromAnimationProgress();
            t.setTime(i, !1)
        },
        onSoundVolumeChange: function (e) {
            e.get("soundObject").updateVolume()
        },
        onSoundSnapChange: function (e) {
            e.set("snapChanged", !0)
        },
        cull: function () {
            return this._hasAnim && this._featureAnimationModel && this.animationTimeSync(), Object(c.a)() && !this._pauseUpdate && p.a.updateVisibility(), !0
        },
        setPauseUpdate: function (e) {
            this._pauseUpdate = e
        },
        getNode: function () {
            return this._nodeFeature
        },
        getNodeEditor: function () {
            return p.a.getNodeCamera()
        },
        onSelectChanged: function (e) {
            this.model.get("select") !== e && (this.model.set("select", e), this.model.get("soundtracks").trigger("select", e), f.a.draw())
        },
        onAdd: function (e) {
            var t = m.a.createSound(e, this.model.get("playing")),
                i = e.get("distance") < 0,
                r = e.get("distanceMax") < 0;
            (i || r) && (i && e.set("distance", 0), r && e.set("distanceMax", 0), n.a.getBoxReady().then(function () {
                var t = n.a.getModelBoxWithDisplacement();
                i && e.set("distance", t.radius()), r && e.set("distanceMax", 2 * t.radius()), t.center(e.get("position"))
            }), Object(c.a)() && (this.onSelectChanged(e), this._hasAnim && e.set("sync", !0))), e.set("soundObject", t), e.on("change:enable change:ambient change:distanceModel", this.onSoundChange.bind(this)), e.on("change:position ", this.onSoundPositionChange.bind(this)), e.on("change:distance", this.onSoundDistanceChange.bind(this)), e.on("change:distanceMax", this.onSoundDistanceMaxPositionChange.bind(this)), e.on("change:startTime change:loop change:sync", this.onSoundTimeChange.bind(this)), e.on("change:volume", this.onSoundVolumeChange.bind(this)), e.on("change:snap", this.onSoundSnapChange.bind(this)), this._soundObjects.push(t);
            var a = new o.a(function (e) {
                Object(l.a)().soundPreload ? t.whenReady().then(function () {
                    e(t)
                }) : e(t)
            });
            if (this._soundPromises.push(a), Object(c.a)()) {
                e.get("ambient") || p.a.addIcon(e);
                var s = this._viewer.getFeatures().animation;
                if (s) {
                    var u = s.getModel();
                    if (u && 1 !== u.get("speed")) {
                        m.a.setWaiting(!0);
                        m.a.getProxyModel().trigger("sound-show", "Warning. The animation speed is not x1 but sound will play at normal speed. This can lead to unexpected sound playback issues.", {
                            position: "top",
                            duration: 5e3
                        })
                    }
                }
            }
        },
        onRemove: function (e) {
            e === this.model.get("select") && this.onSelectChanged(), c.a && p.a.removeIcon(e);
            var t = e.get("soundObject");
            m.a.removeSound(t), this._soundObjects.splice(this._soundObjects.indexOf(t), 1)
        },
        onEnableChange: function () {
            this.model.set("playing", this.model.get("enable"))
        },
        onPlayingChange: function () {
            this.model.get("enable") && (this.model.get("playing") ? this.onPlay() : this.onPause())
        },
        onPlay: function () {
            if (!Object(v.b)()) {
                if (!this.model.get("enable")) return this.model.set("playing", !1), void this.pause();
                m.a.setPlaying(!0), m.a.canPlay() ? m.a.forcePlay(!0) : m.a.featureDetectSoundAuthGestureNeeded() ? m.a.enableTapRequestPopup() : m.a.forcePlay(!0), this.updatePositionAndTime(!0)
            }
        },
        onPause: function () {
            m.a.pause(), this.updatePositionAndTime()
        },
        play: function () {
            this.model.get("enable") && (this.model.set("playing", !0), this.onPlay())
        },
        pause: function () {
            this.model.get("enable") && (this.model.set("playing", !1), this.onPause())
        },
        updateMute: function (e) {
            var t = e.get("mute");
            m.a.setMute(t)
        },
        updateVolume: function (e) {
            var t = e.get("volume");
            t >= 0 && (e.set("mute", !1), m.a.setMute(!1)), m.a.setVolume(t)
        }
    })
}, function (e, t, i) {
    "use strict";
    var n, r, a = i(9),
        o = i(77),
        s = i(120),
        u = i(229),
        l = i(85),
        c = i(69),
        h = i(44),
        d = i(456),
        f = i(94),
        p = i(103),
        m = i(634),
        g = i(159),
        v = i(88),
        _ = i(199),
        b = i(926),
        S = i.n(b),
        x = i(927),
        y = i.n(x),
        C = a.a.osg,
        T = a.a.osgUtil,
        w = a.a.InputGroups,
        M = v.a.BLEND_SUBSTRACTIVE,
        E = v.a.DEPTH_DISABLE,
        A = C.StateAttribute.ON,
        P = C.vec4.fromValues(.109375, .6640625, .84765625, 1),
        R = C.vec4.fromValues(1, 1, 0, 1),
        O = C.vec4.fromValues(.8, .8, .8, 1),
        I = C.vec4.fromValues(1, 1, 0, 1),
        F = function () {
            return r || (r = C.createTexturedQuadGeometry(-.5, -.5, 0, 1, 0, 0, 0, 1, 0)), r
        },
        N = {
            init: function (e, t, i) {
                this.model = e, this._context = t, this._viewer = this._context.getViewer(), this._nodeFeature = i, this._viewerOSGJS = this._viewer.getViewerOSGJS(), this._manipulator = this._viewerOSGJS.getManipulator(), this._icons = [], this._nodeCamera = new C.Camera, this._nodeCamera.setNearFarRatio(5e-4), this._nodeCamera.setName("Sound - Camera"), this._nodeCamera.getOrCreateStateSet().setRenderBinDetails(l.a.EDITOR_GIZMO, "RenderBin"), this._nodeCamera.setNodeMask(0), this._nodeIcons = new C.MatrixTransform, this._nodeFeature.addChild(this._nodeCamera), this._nodeCamera.addChild(this._nodeIcons), this._nodeGizmos = new C.MatrixTransform, this._nodeGizmos.setNodeMask(0), this._nodeGizmos._forceEnterIntersection = !0, this._nodeCamera.addChild(this._nodeGizmos), this._prepareGeometriesGizmo(), this._gizmoRefDistance = this._makeGizmo(this._geomHandleDistance), this._nodeGizmos.addChild(this._gizmoRefDistance._nodeGizmo), this._gizmoFalloff = this._makeGizmo(this._geomHandleFalloff), this._nodeGizmos.addChild(this._gizmoFalloff._nodeGizmo), _.a.initSound(this), this.initStateset()
            },
            _prepareGeometriesGizmo: function () {
                this._geomHandleFalloff = new C.createTexturedBoxGeometry(0, 0, 0, .5, .5, .5), this._geomHandleDistance = new C.createTexturedBoxGeometry(0, 0, 0, .5, .5, .5), this._arc = T.GizmoGeometry.createCircleGeometry(64, 1, 3.2 * Math.PI), this.setGizmoStateset(this._arc, P), this.setGizmoStateset(this._geomHandleDistance, P), this.setGizmoStateset(this._geomHandleFalloff, P)
            },
            _makeGizmo: function (e) {
                var t = {};
                return t._nodeGizmo = new C.MatrixTransform, t._arcScale = new C.MatrixTransform, this._arcScale = new C.MatrixTransform, t._arcX = this._makeArc(t._arcScale, "arcX"), t._arcY = this._makeArc(t._arcScale, "arcY", .5 * -Math.PI, C.vec3.fromValues(1, 0, 0)), t._arcZ = this._makeArc(t._arcScale, "arcZ", .5 * Math.PI, C.vec3.fromValues(0, 1, 0)), t._handleX = this._makeHandle(t._nodeGizmo, "handleX", C.vec3.fromValues(1, 0, 0), e), t._handleY = this._makeHandle(t._nodeGizmo, "handleY", C.vec3.fromValues(0, 1, 0), e), t._handleZ = this._makeHandle(t._nodeGizmo, "handleZ", C.vec3.fromValues(0, 0, 1), e), t._handleXNeg = this._makeHandle(t._nodeGizmo, "handleXNeg", C.vec3.fromValues(-1, 0, 0), e), t._handleYNeg = this._makeHandle(t._nodeGizmo, "handleYNeg", C.vec3.fromValues(0, -1, 0), e), t._handleZNeg = this._makeHandle(t._nodeGizmo, "handleZNeg", C.vec3.fromValues(0, 0, -1), e), t._nodeGizmo.editMask = T.NodeGizmo.PICK_ARROW | T.NodeGizmo.PICK_PLANE, t._nodeGizmo.setCullingActive(!1), t._nodeGizmo.addChild(t._arcScale), t
            },
            _makeHandle: function (e, t, i, n) {
                var r = new C.MatrixTransform;
                return r.setName(t), e.addChild(r), r.addChild(n), C.mat4.fromTranslation(r.getMatrix(), i), r
            },
            _makeArc: function (e, t, i, n) {
                var r = new C.MatrixTransform;
                return r.setName(t), e.addChild(r), r.addChild(this._arc), i && n && C.mat4.fromRotation(r.getMatrix(), i, n), r
            },
            initStateset: function () {
                this._nodeCamera.getOrCreateStateSet().setTextureAttributeAndModes(0, u.a.dummyTexture, A), this._nodeCamera.getOrCreateStateSet().addUniform(C.Uniform.createInt(0, "uTextureDepth"))
            },
            setGizmoStateset: function (e, t) {
                var i = e.getOrCreateStateSet();
                i.setAttributeAndModes(s.a.createShader(S.a, y.a, "line", "Handle3D", "LINE"), A), i.setAttributeAndModes(M, A), i.setAttributeAndModes(E, A), i.addUniform(C.Uniform.createFloat4(t, "uColor"))
            },
            updateDragHandle: function (e, t) {
                var i = e.getMatrix();
                C.mat4.fromTranslation(i, t);
                var n = e.getWorldMatrices()[0];
                C.mat4.getTranslation(t, n);
                var r = this.getIconSize(t);
                C.mat4.scale(i, i, r), e.dirtyBound()
            },
            updateArcScale: function () {
                var e = C.vec3.create();
                return function (t, i) {
                    var n = t._arcScale.getMatrix();
                    C.mat4.scale(n, C.mat4.IDENTITY, C.vec3.set(e, i, i, i)), t._arcScale.dirtyBound(), this.updateDragHandle(t._handleX, C.vec3.set(e, i, 0, 0)), this.updateDragHandle(t._handleY, C.vec3.set(e, 0, i, 0)), this.updateDragHandle(t._handleZ, C.vec3.set(e, 0, 0, i)), this.updateDragHandle(t._handleXNeg, C.vec3.set(e, -i, 0, 0)), this.updateDragHandle(t._handleYNeg, C.vec3.set(e, 0, -i, 0)), this.updateDragHandle(t._handleZNeg, C.vec3.set(e, 0, 0, -i))
                }
            }(),
            _checkSelectNodeChanged: function () {
                var e = this.model.get("select");
                if (e !== this._select) {
                    this._select = e;
                    var t = this.getGizmo();
                    if (!e || e.get("ambient")) return t.attachToNode(null), void this.hideIcon(e);
                    this.addIcon(e), Object(d.d)(e), this._setGizmoPositionFromSound()
                }
            },
            _updateFalloffGizmo: function () {
                var e = this.model.get("select");
                this.updateArcScale(this._gizmoRefDistance, e.get("distance")), "linear" === e.get("distanceModel") ? (this._gizmoFalloff._nodeGizmo.setNodeMask(c.a.NO_SHADOW), this.updateArcScale(this._gizmoFalloff, e.get("distanceMax"))) : this._gizmoFalloff._nodeGizmo.setNodeMask(0)
            },
            _setGizmoPositionFromSound: function () {
                var e = this.model.get("select"),
                    t = e.get("lastComputedWorldPosition");
                C.mat4.setTranslation(this._nodeGizmos.getMatrix(), t)
            },
            _setSoundPositionFromGizmo: function () {
                var e = this.model.get("select"),
                    t = e.get("lastComputedWorldPosition");
                C.mat4.getTranslation(t, this._nodeGizmos.getMatrix()), Object(d.c)(e, t)
            },
            updateGizmo: function () {
                var e = this.getGizmo();
                if (e) {
                    this._checkSelectNodeChanged();
                    var t = this.model.get("select");
                    if (!t || t.get("ambient")) return this._nodeGizmos.setNodeMask(0), void e.setNodeMask(0);
                    e.attachToNode(this._nodeGizmos), this._nodeGizmos.setNodeMask(-1), e.setNodeMask(-1);
                    var i = t.get("snap");
                    i ? this._nodeGizmos.editMask = T.NodeGizmo.NO_PICK : (this._nodeGizmos.editMask = T.NodeGizmo.PICK_ARROW | T.NodeGizmo.PICK_PLANE, t.set("geometryUid", -1)), this._dragging && h.a.draw(), this._updateFalloffGizmo(), this._nodeGizmos.dirtyBound();
                    var n = t.get("lastComputedWorldPosition"),
                        r = t.get("snapChanged");
                    if (r && t.set("snapChanged", !1), !e.isEditing() && !r) return void this._setGizmoPositionFromSound();
                    i ? (this.snapCheck(t, n), this._displaySnapHelp()) : this._setSoundPositionFromGizmo()
                }
            },
            _updateSoundObjectPosition: function (e) {
                Object(d.d)(e), e.get("soundObject").setPositionNormalized(e.get("lastComputedWorldPosition"))
            },
            getNodeCamera: function () {
                return this._nodeCamera
            },
            getGizmo: function () {
                var e = this._viewer.getFeaturesManager();
                return e ? e.getNodeGizmo() : null
            },
            _displaySnapHelp: function () {
                new f.a({
                    content: "Double-click to snap the sound on the object surface.",
                    class: "info",
                    delay: 2e3
                })
            },
            initDepthTexture: function () {
                var e = this._viewer.getFeaturesManager().getTextureDepth();
                this._nodeCamera.getStateSet().setTextureAttributeAndModes(0, e, A);
                for (var t = 0, i = this._icons.length; t < i; t++) this._icons[t].getStateSet().setTextureAttributeAndModes(0, e, A)
            },
            getIconSize: function () {
                var e = C.vec3.create(),
                    t = C.vec3.create();
                return function (i) {
                    var n = this._viewer.getFeaturesManager(),
                        r = n ? n.getIconScaleFov() : 1;
                    this._manipulator.getEyePosition(e);
                    var a = C.vec3.dist(e, i || C.vec3.ZERO) / r;
                    return C.vec3.set(t, a, a, a)
                }
            }(),
            updateIcons: function () {
                var e = C.quat.create(),
                    t = C.mat4.create(),
                    i = C.vec3.create(),
                    n = C.vec3.create();
                return function () {
                    var r = this.model.get("select"),
                        a = this._viewer.getCamera(),
                        o = C.mat4.getScale(i, a.getProjectionMatrix())[0],
                        s = .02 * this._viewerOSGJS.getCanvasClientWidth() * o;
                    this._manipulator.getEyePosition(n), C.mat4.invert(t, a.getViewMatrix()), C.mat4.getRotation(e, t);
                    for (var u = 0, l = this._icons.length; u < l; u++) {
                        var c = this._icons[u],
                            h = c.getUserData();
                        c !== this._hovered && this.setIconSelected(c, r === h);
                        var d = c.getMatrix();
                        this._updateSoundObjectPosition(h);
                        var f = h.get("lastComputedWorldPosition"),
                            p = C.vec3.dist(n, f) / s;
                        C.vec3.set(i, p, p, p), C.mat4.fromRotationTranslationScale(d, e, f, i), c.dirtyBound()
                    }
                }
            }(),
            addIcon: function (e) {
                var t, i;
                if (i = this._findIcon(e)) return i.setNodeMask(-1), i;
                t = F(), i = new C.MatrixTransform, i.addChild(t);
                var r = o.default.instance,
                    a = r.getOrCreateTexture(m.a.iconSound, {
                        internalFormat: C.Texture.RGBA
                    });
                this.setGizmoStateset(i, O);
                var u = i.getOrCreateStateSet();
                u.setTextureAttributeAndModes(1, a.texture, A), u.addUniform(C.Uniform.createInt(1, "uTextureIcon")), u.addUniform(C.Uniform.createInt(0, "uAttachedToCamera")), u.addUniform(C.Uniform.createInt(1, "uEnable")), n || (n = s.a.createShader(S.a, y.a, "icon", "LightingIcon", "ICON")), u.setAttributeAndModes(n);
                var l = this._icons.length;
                i.setName("SOUNDIconMT_" + l);
                var c = i.getMatrix();
                C.mat4.fromTranslation(c, e.get("lastComputedWorldPosition")), C.mat4.scale(c, c, this.getIconSize()), this._icons.push(i), this._nodeIcons.addChild(i), i.setUserData(e), i.dirtyBound()
            },
            hideIcon: function (e) {
                var t = this._findIcon(e);
                t && t.setNodeMask(0)
            },
            _findIcon: function (e) {
                for (var t = 0; t < this._icons.length; t++)
                    if (this._icons[t].getUserData() === e) return this._icons[t];
                return null
            },
            snapCheck: function () {
                var e = new T.SphereIntersector,
                    t = new T.IntersectionVisitor,
                    i = C.vec3.create();
                return function (n, r) {
                    t.setTraversalMask(c.a.PICK_GEOMETRY_SLOW);
                    var a = p.a.getModelBoxWithDisplacement().radius(),
                        o = 10 * a;
                    g.a.getScenePositionFromWorldPoint(r, i), e.set(i, o), t.setIntersector(e), this._viewer.getRootModel().accept(t);
                    var s = e.getIntersections(),
                        u = s.length;
                    if (u) {
                        for (var l = s[0], h = 1; h < u; ++h) {
                            var f = s[h];
                            f._ratio < l._ratio && (l = f)
                        }
                        Object(d.b)(n, l)
                    }
                }
            }(),
            onDragStart: function (e) {
                if (this.isSoundTabOpen() && g.a.isInitialized()) {
                    var t = g.a.computeNearestIntersection2D(e.canvasX, e.canvasY, c.a.PICK_GEOMETRY, this._nodeCamera);
                    if (this._dragging = !1, t) {
                        var i = t._nodePath[t._nodePath.length - 1];
                        if (i === F()) {
                            var n = t._nodePath[t._nodePath.length - 2].getUserData();
                            n && this.model.get("soundtracks").trigger("select", n)
                        } else if (i === this._geomHandleDistance || i === this._geomHandleFalloff) {
                            var r = this.model.get("select");
                            if (void 0 === r) return;
                            var a = this.getGizmo();
                            if (!a || a.isEditing()) return;
                            this._manipulator.getInputManager().setEnable(w.MANIPULATORS, !1), this._dragging = !0, this.model.set("dragging", !0);
                            var o = a.getWorldMatrices()[0],
                                s = C.vec3.create();
                            C.vec3.transformMat4(s, s, o), a.getCanvasPositionFromWorldPoint(s, s), this._draggingStartGizmoCenterX = s[0], this._draggingStartGizmoCenterY = s[1], this._draggingStartX = e.canvasX, this._draggingStartY = e.canvasY;
                            var u = (this._draggingStartX - this._draggingStartGizmoCenterX) / this._viewer.getWidth(),
                                l = (this._draggingStartY - this._draggingStartGizmoCenterY) / this._viewer.getHeight();
                            this._draggingStartScreenDistance = Math.sqrt(u * u + l * l), t._nodePath[t._nodePath.length - 3] === this._gizmoFalloff._nodeGizmo ? (this.draggingFallofGizmo = !0, this._draggingStartDistance = r.get("distanceMax")) : (this.draggingRefDistanceGizmo = !0, this._draggingStartDistance = r.get("distance"))
                        }
                    }
                }
            },
            onHover: function (e, t, i) {
                if (g.a.isInitialized()) {
                    var n, r = g.a.computeNearestIntersection2D(e, t, c.a.PICK_GEOMETRY, this._nodeCamera);
                    if (r) {
                        var a = r._nodePath[r._nodePath.length - 1];
                        if (a === this._hovered || r._nodePath.length > 2 && r._nodePath[r._nodePath.length - 2] === this._hovered) return;
                        a === F() ? (this._hovered = r._nodePath[r._nodePath.length - 2], this.setIconSelected(this._hovered, !0), h.a.draw()) : a !== this._geomHandleDistance && a !== this._geomHandleFalloff || (this._hovered = a, n = a.getStateSet().getUniform("uColor").getInternalArray(), C.vec4.copy(n, R), h.a.draw())
                    } else this._hovered && (this._hovered === this._geomHandleDistance || this._hovered === this._geomHandleFalloff ? (n = this._hovered.getStateSet().getUniform("uColor").getInternalArray(), C.vec4.copy(n, P)) : this._hovered.getUserData() !== i && this.setIconSelected(this._hovered, !1), h.a.draw(), this._hovered = !1)
                }
            },
            setIconSelected: function (e, t) {
                var i = e.getStateSet().getUniformList(),
                    n = i.uColor.getAttribute().getInternalArray();
                t ? C.vec4.copy(n, I) : C.vec4.copy(n, O)
            },
            onDragMove: function (e) {
                if (this.isSoundTabOpen()) {
                    var t = this.model.get("select");
                    if (!this._dragging) return void this.onHover(e.canvasX, e.canvasY, t);
                    if (void 0 !== t) {
                        var i = this.getGizmo();
                        if (i) {
                            if (i.isEditing()) return void this.onDragEnd();
                            var n = (e.canvasX - this._draggingStartGizmoCenterX) / this._viewer.getWidth(),
                                r = (e.canvasY - this._draggingStartGizmoCenterY) / this._viewer.getHeight(),
                                a = Math.sqrt(n * n + r * r);
                            a = a * this._draggingStartDistance / this._draggingStartScreenDistance, this.draggingRefDistanceGizmo ? (t.set("distance", a), a > t.get("distanceMax") && t.set("distanceMax", a)) : (t.set("distanceMax", a), a < t.get("distance") && t.set("distance", a)), h.a.draw()
                        }
                    }
                }
            },
            onDragEnd: function () {
                if (this._dragging && this.isSoundTabOpen()) {
                    void 0 !== this.model.get("select") && (this._manipulator.getInputManager().setEnable(w.MANIPULATORS, !0), this.draggingFallofGizmo = !1, this.draggingRefDistanceGizmo = !1, this._dragging = !1, this.model.set("dragging", !1), h.a.draw())
                }
            },
            onDoubleClick: function (e) {
                if (this.isSoundTabOpen()) {
                    var t = this.model.get("select");
                    if (void 0 !== t && !t.get("ambient")) {
                        if (this._viewer.getFeaturesManager()) {
                            var i = g.a.pickNearestSurface(e);
                            i && (Object(d.b)(t, i), Object(d.d)(t), t.get("snap") || t.set("geometryUid", -1), this._updateSoundObjectPosition(t))
                        }
                    }
                }
            },
            isSoundTabOpen: function () {
                var e = this._viewer.getOptions().widgetAPI;
                return e && "sound" === e.getTabbedWidget().get()
            },
            removeIcon: function (e) {
                for (var t = 0, i = this._icons.length; t < i; t++) {
                    var n = this._icons[t];
                    if (n.getUserData() === e) {
                        n.getParents()[0].removeChild(n);
                        break
                    }
                }
            },
            updateVisibility: function () {
                this.isSoundTabOpen() ? (0 === this._nodeCamera.getNodeMask() && this._manipulator.getInputManager().setEnable(w.SOUND_GIZMO, !0), this._nodeCamera.setNodeMask(c.a.NO_SHADOW), this.updateGizmo(), this.updateIcons()) : (0 !== this._nodeCamera.getNodeMask() && this._manipulator.getInputManager().setEnable(w.SOUND_GIZMO, !0), this._nodeCamera.setNodeMask(0))
            }
        };
    t.a = N
}, function (e, t, i) {
    "use strict";
    var n = i(90),
        r = i(1428),
        a = i(1429),
        o = {
            FeatureName: "inspector",
            ModelType: r.a,
            ViewListType: [a.a]
        },
        s = n.a.create(o);
    s.prototype.getNode = function () {
        return this._views[0]._nodeInspector
    }, t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(24),
        r = i.n(n),
        a = i(47),
        o = i(152),
        s = i(230),
        u = i(79),
        l = r.a.Model.extend({
            defaults: {
                availableDisplayView: ["Default"],
                materialList: [],
                materialByUid: {},
                displayView: "Default",
                material: void 0,
                hoverMaterial: void 0,
                splitType: "3d",
                texCoord: 0,
                focusMaterial: !Object(u.a)(),
                highlightOnHover: !Object(u.a)(),
                viewerToCanvasRatio: 1,
                referenceShadingType: "lit",
                uiVisible: !1
            },
            init: function (e) {
                this._viewer = e.getViewer(), a.a.getMaterial().then(this.initAvailableView.bind(this))
            },
            getMaterialModel: function () {
                return this._viewer.getFeatures().material.getModel()
            },
            getShadingStyleModel: function () {
                return this._viewer.getFeatures().shadingStyle.getModel()
            },
            getPostProcessModel: function () {
                return this._viewer.getFeatures().postProcess.getModel()
            },
            getGroundModel: function () {
                return this._viewer.getFeatures().ground.getModel()
            },
            getCurrentMaterial: function () {
                return this.getMaterialByUid(this.get("material"))
            },
            getCurrentUVs: function () {
                return this.get("materialList").find(function (e) {
                    return e.uid === this.get("material")
                }.bind(this)).texCoordUnitList
            },
            getMaterialByUid: function (e) {
                var t = this.getMaterialModel().getMaterials(),
                    i = t[e],
                    n = i.get("uidUniqueMerged");
                return n ? t[n] : i
            },
            initAvailableView: function () {
                var e = this.get("displayView"),
                    t = this.get("availableDisplayView"),
                    i = this.get("materialList"),
                    n = this.get("materialByUid");
                this.set("displayView", "Default"), t.length = 0, t.push("Default"), i.length = 0;
                var r = o.a.length,
                    a = {},
                    u = !1,
                    l = this.getMaterialModel(),
                    c = l.attributes;
                for (var h in c) {
                    var d = c[h];
                    if (!d.get("uidUniqueMerged")) {
                        for (var f = {}, p = d.getChannels(), m = 0; m < r; ++m) {
                            var g = o.a[m],
                                v = p[g],
                                _ = v.isEffective();
                            v.set("backupJSON", void 0), f[g] = _, a[g] || v.isEnableEffective() && ("DiffuseIntensity" !== g || _) && (a[g] = !0)
                        }
                        var b = d.get("texCoordUnitList");
                        u = u || b.length > 0, void 0 === this.get("material") && this.set("material", h);
                        var S = !1;
                        p.MetalnessPBR.isEnableEffective() ? S = p.GlossinessPBR.isEnableEffective() : p.SpecularPBR.isEnableEffective() && (S = p.RoughnessPBR.isEnableEffective());
                        var x = {
                            uid: h,
                            name: d.get("name"),
                            texCoordUnitList: b,
                            uidUniqueMerged: d.get("uidUniqueMerged"),
                            uidListUnusedDuplicates: d.get("uidListUnusedDuplicates"),
                            effectiveChannels: f,
                            swapMicrosurface: S
                        };
                        i.push(x), n[h] = x
                    }
                }
                a.MetalnessPBR ? (delete a.GlossinessPBR, a.RoughnessPBR = !0) : a.SpecularPBR && (delete a.RoughnessPBR, a.GlossinessPBR = !0);
                for (var y = 0; y < r; ++y) {
                    var C = o.a[y];
                    a[C] && t.push(C)
                }
                t.push("MatcapFlat"), -1 === t.indexOf("NormalMap") && -1 === t.indexOf("BumpMap") || t.push("MatcapDetail");
                var T = this.getShadingStyleModel();
                T.get("hasWireframe") && t.push("Wireframe"), T.get("hasVertexColor") && T.get("vertexColorEnable") && (t.push("VertexColor"), T.get("hasVertexAlpha") && T.get("vertexColorUseAlpha") && -1 !== t.indexOf("Opacity") && t.push("VertexAlpha")), s.a.hasVertexNormals && t.push("VertexNormal"), u && t.push("UVChecker"), this.getPostProcessModel().hasAtLeastOneEffectiveEffect() && t.push("DefaultNoPostProcess"), this.getGroundModel().get("enable") && t.push("DefaultNoGround"), this.set("referenceShadingType", T.get("type")), this.trigger("change:availableDisplayView"), this.set("displayView", e)
            },
            _getCorrectedDisplayView: function (e) {
                var t = this.get("displayView");
                return !this.get("materialByUid")[e].swapMicrosurface || "RoughnessPBR" !== t && "GlossinessPBR" !== t ? t : "RoughnessPBR" === t ? "GlossinessPBR" : "RoughnessPBR"
            },
            materialHasContentInView2d: function (e) {
                var t = this.getMaterialByUid(e),
                    i = this._getCorrectedDisplayView(e);
                return t.getChannels()[i] ? this.get("materialByUid")[e].effectiveChannels[i] : "Wireframe" === i ? t.get("geometryList").length > 0 : "VertexColor" === i ? t.get("hasVertexColor") : "VertexAlpha" === i ? t.get("hasVertexAlpha") : !("UVChecker" !== i || !t.get("texCoordUnitList").length)
            },
            materialHasTextureInView2d: function (e) {
                var t = this.getMaterialByUid(e),
                    i = this._getCorrectedDisplayView(e),
                    n = t.getChannels()[i];
                if (n) {
                    return this.get("materialByUid")[e].effectiveChannels[i] && !!n.getTextureModel()
                }
                return "Wireframe" === i ? t.get("geometryList").length > 0 : "VertexColor" === i ? t.get("hasVertexColor") : "VertexAlpha" === i && t.get("hasVertexAlpha")
            },
            hasContentInView2d: function () {
                return this.materialHasContentInView2d(this.get("material"))
            },
            getName: function () {
                return "Inspector"
            }
        });
    t.a = l
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(8),
        a = i(0),
        o = (i.n(a), i(69)),
        s = i(44),
        u = i(152),
        l = i(1430),
        c = i(1432),
        h = i(321),
        d = i(937),
        f = i(103),
        p = i(47),
        m = i(159),
        g = i(20),
        v = i(199),
        _ = i(179),
        b = n.a.osg,
        S = n.a.InputGroups,
        x = b.vec3.fromValues(.7, .75, .75),
        y = {
            Opacity: !0,
            AOPBR: !0,
            CavityPBR: !0
        },
        C = r.a.extend({
            initialize: function () {
                r.a.prototype.initialize.apply(this, arguments);
                var e = this.model;
                e.bind("change:displayView", this.onDisplayView, this), e.bind("change:material", this.onMaterial, this), e.bind("change:texCoord", this.onTexCoord, this), e.bind("change:splitType", this.onSplitType, this), e.bind("change:viewerToCanvasRatio", this._onViewerToCanvasRatio, this), this._viewer = this.options.context.getViewer(), this._viewerOSGJS = this._viewer.getViewerOSGJS(), this._inputManager = this._viewer.getInputManager(), this._viewer.bind("resizeCanvas", this._updateSplitView, this), this._nodeInspector = new b.Node, this._nodeInspector.setName("Feature - Inspector"), this._normalVisitor = new d.a, this._camera2D = new c.a(this._viewer, this.model), v.a.initInspector(this), v.a.initInspectorCamera2D(this._camera2D), this._matcapJSON = {
                    factor: 1,
                    color: b.vec3.ONE,
                    texture: {
                        uid: "43a40dd3e9c34fc0b7da9cbf07b82ac8"
                    }
                }, p.a.getMaterial().then(this.initAfterMaterials.bind(this)), f.a.getBoxReady().then(this.initNormalVisitor.bind(this))
            },
            initAfterMaterials: function () {
                this._viewer.getFeatures().quality.getModel().bind("updateDynamicResolutionScaling", this._updateSplitView, this)
            },
            initNormalVisitor: function () {
                this._normalVisitor.setScale(.01 * f.a.getModelBoxWithDisplacement().radius())
            },
            hasDisplayView: function (e) {
                return -1 !== this.model.get("availableDisplayView").indexOf(e)
            },
            getMaterialModel: function () {
                return this._viewer.getFeatures().material.getModel()
            },
            getOutlineModel: function () {
                return this._viewer.getFeatures().outline.getModel()
            },
            getQualityModel: function () {
                return this._viewer.getFeatures().quality.getModel()
            },
            getShadingStyleModel: function () {
                return this._viewer.getFeatures().shadingStyle.getModel()
            },
            getPostProcessModel: function () {
                return this._viewer.getFeatures().postProcess.getModel()
            },
            getGroundModel: function () {
                return this._viewer.getFeatures().ground.getModel()
            },
            getImageCollection: function () {
                return this.getMaterialModel().getImageCollection()
            },
            getCurrentMaterial: function () {
                return this.model.getCurrentMaterial()
            },
            isOnView2D: function (e) {
                var t = this.model.get("splitType");
                return "3d" !== t && ("2d" === t || "split" === t && e.canvasX > .5 * this._viewerOSGJS.getCanvasClientWidth())
            },
            isTabMaterial: function () {
                var e = this._viewer.getFeaturesManager();
                return e && "materials" === e.getCurrentTabName()
            },
            canDisplayOutline: function () {
                return this.isTabMaterial() || "split" === this.model.get("splitType")
            },
            focusCheck: function (e) {
                var t = this.isOnView2D(e);
                t === this._isView2DEnabled || this._cursorPressed || (this._inputManager.setEnable(S.UI_INSPECTOR, t), Object(g.a)().scrollwheel && (this._inputManager.setEnable(S.UI_INSPECTOR_ZOOM, t), this._inputManager.setEnable(S.SCENE_INSPECTOR_ZOOM, !t)), this._inputManager.setEnable(S.SCENE, !t), this._isView2DEnabled = t)
            },
            onMouseMove: function (e) {
                if (this._cursorPressed) return void this.getOutlineModel().trigger("hideOutline");
                if (this.model.get("highlightOnHover") && this.canDisplayOutline() && !this._freezeHoverOutline) {
                    var t;
                    if (this.isOnView2D(e) || (t = this.hitMaterial(e)), this.model.set("hoverMaterial", t), !t) return void this.getOutlineModel().trigger("hideOutline");
                    this.displayOutline("displayOutlineNoFocus", t)
                }
            },
            _freezeOutline: function (e) {
                void 0 !== this._timerFreezer && (window.clearTimeout(this._timerFreezer), this._timerFreezer = void 0), this._freezeHoverOutline = !0;
                var t = 1e3 * e,
                    i = this._enableOutline.bind(this);
                this._timerFreezer = window.setTimeout(i, t)
            },
            _enableOutline: function () {
                this._freezeHoverOutline = !1
            },
            hitMaterial: function (e) {
                if (m.a.isInitialized()) {
                    var t = o.a.PICK_GEOMETRY_FAST,
                        i = m.a.computeNearestIntersection2D(e.canvasX, e.canvasY, t);
                    return i ? m.a.getMaterialFromHit(i) : void 0
                }
            },
            displayOutline: function (e, t) {
                var i = (this.isTabMaterial(), this.getOutlineModel());
                i.set("durationOutline", 2), i.set("durationHighlight", 2), i.trigger(e, t.get("stateSet"))
            },
            onMouseWheel: function () {
                this.getOutlineModel().trigger("hideOutline"), this._freezeOutline(.25)
            },
            onCursorDown: function () {
                this._cursorPressed = !0
            },
            onCursorUp: function () {
                this._cursorPressed = !1, this._freezeOutline(.25)
            },
            autoSelectUV: function () {
                var e = this.getCurrentMaterial(),
                    t = e.getChannels(),
                    i = this.model.get("displayView");
                if (!t[i]) {
                    var n = e.get("texCoordUnitList");
                    return void(n.length && -1 === n.indexOf(this.model.get("texCoord")) && this.model.set("texCoord", n[0]))
                }
                var r = t[i].getTextureModel();
                r && this.model.set("texCoord", r.get("texCoordUnit"))
            },
            onTexCoord: function () {
                this.updateMaterial()
            },
            onMaterial: function () {
                if (this.autoSelectUV(), this.updateMaterial(), this.updateVisible2D(), this.canDisplayOutline()) {
                    var e = this.model.get("focusMaterial") ? "Focus" : "NoFocus";
                    this.displayOutline("displayOutline" + e, this.getCurrentMaterial()), this._freezeOutline(.25)
                }
            },
            updateVisible2D: function () {
                var e = this.model.get("splitType");
                this._camera2D.setVisible("3d" !== e && this.model.hasContentInView2d())
            },
            updateMaterial: function () {
                var e = this.getCurrentMaterial(),
                    t = this.model.get("texCoord");
                this._camera2D.setMaterial(e, t), "UVChecker" === this.model.get("displayView") && e.getChannels().Inspector.setTexCoordUnit(t), s.a.draw()
            },
            onSplitType: function () {
                var e = this.model.get("splitType");
                _.a.uSplitView.setFloat("split" === e ? 1 : 0), "split" !== e && this.getOutlineModel().trigger("hideOutline"), this._updateSplitView(), this.updateVisible2D(), s.a.draw()
            },
            setupCheckerTexture: function (e) {
                if (!this._checkerImageProxy) {
                    var t = this.getImageCollection();
                    this._checkerImageProxy = t.addNewImage({
                        url: Object(l.a)(),
                        width: 1024,
                        height: 1024,
                        id: "skfbUVChecker",
                        name: "UVChecker"
                    })
                }
                var i = e.setupTextureModel({
                    image: this._checkerImageProxy
                });
                return i.updateMultiresTexture(), i
            },
            _getDisplayedChannel: function (e, t, i) {
                return !i.swapMicrosurface || "RoughnessPBR" !== t && "GlossinessPBR" !== t ? ("Opacity" === t && e.Opacity.get("invert") && e.Inspector.set("invert", !0), e[t]) : (e.Inspector.set("invert", !0), "RoughnessPBR" === t ? e.GlossinessPBR : e.RoughnessPBR)
            },
            _getColorProfile: function (e) {
                var t = this.getPostProcessModel().get("sssProfiles"),
                    i = t[e.get("profile") - 1],
                    n = b.vec3.create();
                return b.vec3.add(n, i.strength, i.falloff), b.vec3.scale(n, n, .5), n
            },
            _setDisplayChannel: function (e, t) {
                e.setInspectorSRGB(t.getSRGB());
                var i = t.getName();
                if (!t.isEffective()) return void(y[i] || e.setFactor(0));
                var n = t.getTextureModel();
                if (!n) {
                    var r = 1;
                    if ("SubsurfaceScattering" === i) {
                        r = 1 / (u.a.getBoxFactor("SubsurfaceScattering") * f.a.getModelBoxWithoutDisplacement().radius())
                    }
                    "Opacity" === i && "additive" === t.get("type") && (r = .5), e.setFactor(t.getFactor() * r)
                }
                if ("SubsurfaceScattering" === i) e.setColor(this._getColorProfile(t));
                else if ("ClearCoat" === i) e.setColor(t.get("tint"));
                else {
                    var a = t.getColor && t.getColor();
                    e.setColor(a || b.vec3.ONE)
                }
                n && (e.setTextureModel(t.getTextureModel()), "Opacity" === i && "alphaMask" === t.get("type") && e.set("maskThreshold", t.get("factor")))
            },
            _setUVChecker: function (e, t) {
                this.setupCheckerTexture(e);
                var i = this.getCurrentMaterial() === t,
                    n = i ? this.model.get("texCoord") : t.get("texCoordUnitList")[0];
                e.setTexCoordUnit(n || 0)
            },
            _resetChannel: function (e) {
                return e.get("backupJSON") ? e.setChannelJSON(e.get("backupJSON"), this.getImageCollection()) : e.set("backupJSON", Object(a.cloneDeepWith)(e.getJSON())), e
            },
            _resetState: function () {
                var e = this.getShadingStyleModel();
                e.set("type", this.model.get("referenceShadingType")), this.hasDisplayView("VertexColor") && e.set("vertexColorEnable", !0), this.hasDisplayView("VertexAlpha") && e.set("vertexColorUseAlpha", !0);
                for (var t = this.model.get("materialList"), i = this.getMaterialModel().getMaterials(), n = 0; n < t.length; ++n) {
                    var r = i[t[n].uid],
                        a = r.getChannels();
                    this._resetChannel(a.Inspector), this._resetChannel(a.Displacement), this._resetChannel(a.Opacity), this._resetChannel(a.Matcap), this._resetChannel(a.BumpMap), this._resetChannel(a.NormalMap), a.Opacity.isEffective() || a.Opacity.set("enable", !1)
                }
            },
            onDisplayView: function () {
                var e = this.model.get("displayView");
                if (-1 === this.model.get("availableDisplayView").indexOf(e)) return void console.error("Unknown display view : " + e);
                this._resetState();
                for (var t = this.getShadingStyleModel(), i = "Default" === e || "DefaultNoPostProcess" === e, n = "UVChecker" === e, r = "Wireframe" === e, a = "VertexColor" === e, o = "VertexAlpha" === e, u = "VertexNormal" === e, l = "Opacity" === e, c = "MatcapFlat" === e, d = "MatcapDetail" === e, f = this.getMaterialModel().getMaterials(), p = this.model.get("materialList"), m = 0; m < p.length; ++m)
                    if (!i && !u) {
                        var g = p[m],
                            v = f[g.uid],
                            b = v.getChannels(),
                            S = b.Inspector;
                        S.setTextureModel(void 0);
                        var y = b.Opacity;
                        if (y.isEffective() && "refraction" === y.get("type") && y.set("type", "alphaBlend"), n) this._setUVChecker(S, v);
                        else if (r) S.setColor(x);
                        else if (o) y.set("enable", !1);
                        else if (!a)
                            if (c || d) c && (b.BumpMap.set("enable", !1), b.NormalMap.set("enable", !1)), b.Matcap.setChannelJSON(this._matcapJSON);
                            else {
                                var C = this._getDisplayedChannel(b, e, g);
                                this._setDisplayChannel(S, C), C === b.Displacement ? b.Displacement.set("enable", !1) : C === y && y.set("enable", !1)
                            }
                    } _.a.uDisplayVertexAlpha.setFloat(o), this.updateVisible2D(), this.autoSelectUV(), u && !this._normalVisitor._alreadyRun && (this._normalVisitor._alreadyRun = !0, this._normalVisitor.apply(this._viewer.getRootModel())), this._normalVisitor.setNormalVisibility(u), h.a.setDebugNormal(u), this.hasDisplayView("VertexColor") && t.set("vertexColorEnable", a || o || i), this.hasDisplayView("VertexAlpha") && t.set("vertexColorUseAlpha", !o && !l), r ? (this._backupWireframeEnable = t.get("wireframeEnable"), this._backupWireframeColor = t.get("wireframeColor"), t.set("wireframeColor", "000000FF"), t.set("wireframeEnable", !0)) : this._backupWireframeColor && (t.set("wireframeColor", this._backupWireframeColor), t.set("wireframeEnable", this._backupWireframeEnable), this._backupWireframeColor = void 0), c || d ? t.set("type", "matcap") : i || u || t.set("type", "inspector"), this.hasDisplayView("DefaultNoPostProcess") && this.getPostProcessModel().set("enable", "Default" === e), this.hasDisplayView("DefaultNoGround") && this.getGroundModel().set("enable", "Default" === e), s.a.draw()
            },
            _onViewerToCanvasRatio: function () {
                this._updateViewports(), s.a.draw()
            },
            _updateViewports: function () {
                var e = this._viewer.getFeatures(),
                    t = this._viewer.getCamera(),
                    i = e.postProcess.getCamera().getViewport(),
                    n = this._camera2D.getViewport(),
                    r = t.getViewport(),
                    a = r.width(),
                    o = r.height(),
                    s = this.getQualityModel(),
                    u = s.get("dynamicResolutionScaling"),
                    l = Math.round(a * u[0]),
                    c = Math.round(o * u[1]),
                    h = this.model.get("splitType"),
                    d = "split" === h;
                d ? (i.setViewport(0, 0, l >> 1, c), n.setViewport(a >> 1, 0, a >> 1, o)) : "2d" === h ? (i.setViewport(0, 0, 1, 1), n.setViewport(0, 0, a, o)) : (i.setViewport(0, 0, l, c), n.setViewport(0, 0, 0, 0));
                var f = d ? .5 : 1;
                f *= this.model.get("viewerToCanvasRatio");
                var p = t.getProjectionMatrix();
                p[0] = p[5] * c / (l * f)
            },
            _updateSplitView: function () {
                var e = this.getQualityModel(),
                    t = this.model.get("splitType"),
                    i = 1,
                    n = 1;
                "split" === t ? i = .5 : "2d" === t && (i = 0, n = 0);
                var r = e.get("dynamicResolutionScaling");
                this._updateViewports(), this._viewer.trigger("resizeRatio", i, n, r[0], r[1])
            }
        });
    t.a = C
}, function (e, t, i) {
    "use strict";
    t.a = function () {
        return i(1431)
    }
}, function (e, t, i) {
    e.exports = i.p + "UVChecker-9d678cb42a024068a573165fa538bb4d.png"
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(44),
        a = i(69),
        o = i(85),
        s = i(47),
        u = i(20),
        l = i(88),
        c = i(120),
        h = i(1433),
        d = i.n(h),
        f = i(1434),
        p = i.n(f),
        m = n.a.osg,
        g = n.a.osgUtil,
        v = function (e, t) {
            m.Camera.call(this), this._model = t, this._viewer = e, this._viewerOSGJS = e.getViewerOSGJS(), this.setNodeMask(0), this.setName("Camera 2D"), this.setReferenceFrame(m.Transform.ABSOLUTE_RF), this.setViewport(new m.Viewport), m.vec4.set(this.getClearColor(), .5, .5, 1, 1), this._manipulatorEnable = !1, this._scale = 1, this._zoomCoord = m.vec2.create();
            var i = this.getCameraEasing();
            this._panInterpolator = new g.DelayInterpolator(2, i), this._zoomInterpolator = new g.DelayInterpolator(1, i), this.addUpdateCallback(this), this.initGraph()
        };
    v.prototype = m.objectInherit(m.Camera.prototype, {
        initGraph: function () {
            var e = m.StateAttribute.OVERRIDE_ON,
                t = this.getOrCreateStateSet();
            t.addUniform(m.Uniform.createFloat(1, "uDisplay2D")), t.addUniform(m.Uniform.createInt(0, "uOutputLinear"), e), t.setAttributeAndModes(l.a.DEPTH_DISABLE, e), t.setRenderBinDetails(o.a.OPAQUE_NO_EARLYZ, "RenderBin"), this._projectedGeometry = new m.Node, this._projectedGeometry.setName("Projected Geometry");
            var i = this._projectedGeometry.getOrCreateStateSet();
            i.addUniform(m.Uniform.createFloat4(m.vec4.ONE, "uColor")), i.addUniform(m.Uniform.createInt(0, "uProjectedWireframe")), this._projectedWireframe = new m.Node, this._projectedWireframe.setName("Projected Wireframe"), this._projectedWireframe.getOrCreateStateSet().addUniform(m.Uniform.createInt(1, "uProjectedWireframe")), this._projectedPolygon = new m.Node, this._projectedPolygon.setName("Projected Polygon"), this._projectedGeometry.addChild(this._projectedPolygon), this._projectedGeometry.addChild(this._projectedWireframe), this._displayTexture = new m.Node, this._displayTexture.setName("Display Texture"), this._displayTexture.getOrCreateStateSet().setShaderGeneratorName("inspector", e), this._quadTexture = m.createTexturedQuadGeometry(-.5, -.5, 0, 1, 0, 0, 0, 1, 0), this._quadTexture.setName("Texture display 2D"), this._displayTexture.addChild(this._quadTexture), this.addChild(this._displayTexture), this.addChild(this._projectedGeometry), s.a.getModelDisplayed().then(function () {
                var e = this._viewer.getFeatures(),
                    t = e.environment.getNode();
                this._quadTexture.setStateSet(t.getStateSet()), e.postProcess.getNodeIn().addChild(this)
            }.bind(this))
        },
        getCameraEasing: function () {
            return void 0 === Object(u.a)().cameraEasing ? .8 : 1 - Object(u.a)().cameraEasing
        },
        getViewportWidth: function () {
            return this.getViewport().width()
        },
        getViewportHeight: function () {
            return this.getViewport().height()
        },
        _replaceProjectedGeometry: function (e, t, i) {
            e.removeChildren();
            for (var n = 0; n < t.length; ++n) {
                var r = t[n],
                    a = new m.Geometry;
                a._attributes = r.getAttributes(), a._primitives = r.getPrimitives(), a._QVT = r._QVT, a._QVS = r._QVS, a._listQuantUV = r._listQuantUV, a.setBound(this._quadTexture.getBoundingBox()), a.setStateSet(i), e.addChild(a)
            }
        },
        _updateProjectedGeometry: function (e, t, i, n) {
            if (n.isFulfilled()) return this._replaceProjectedGeometry(e, t, i, n);
            var r = this,
                a = this._material;
            n.then(function () {
                a === r._material && r._replaceProjectedGeometry(e, t, i, n)
            })
        },
        _updateProjectedPolygon: function (e) {
            this._updateProjectedGeometry(this._projectedPolygon, e.get("geometryList"), e.get("stateSet"), s.a.getModelDisplayed())
        },
        _updateProjectedWireframe: function (e) {
            this._updateProjectedGeometry(this._projectedWireframe, e.get("wireframeList"), e.get("stateSetWireframe"), s.a.getWireframeOptimizedSplitCompressed())
        },
        setMaterial: function (e, t) {
            this._material = e;
            var i = e.get("stateSet");
            this._displayTexture.setStateSet(i);
            var n = "TexCoord" + t,
                r = n,
                a = d.a;
            if (Object(u.a)().zz) {
                var o = "uQUV" + t;
                r = n + ".xy * " + o + ".zw + " + o + ".xy", a = "uniform vec4 " + o + ";\n" + a
            }
            a = a.replace(/%UV%/g, n).replace(/%UV_UNPACK%/g, r);
            var s = c.a.createShader(a, p.a, "inspector-projectedTexCoord" + t, "projectedTexCoord" + t);
            if (this._projectedGeometry.getOrCreateStateSet().setAttributeAndModes(s), !e.get("texCoordUnitList").length) return this._projectedPolygon.removeChildren(), void this._projectedWireframe.removeChildren();
            var l = this._quadTexture.getVertexAttributeList(),
                h = "TexCoord" + t;
            l[h] || (l[h] = l.TexCoord0), this._updateProjectedWireframe(e), this._updateProjectedPolygon(e)
        },
        setManipulatorEnable: function (e) {
            this._manipulatorEnable = e
        },
        setVisible: function (e) {
            this.setNodeMask(e ? a.a.NO_PICK_NO_SHADOW_CAST : 0)
        },
        updateOrtho: function () {
            var e = .5 * this._scale,
                t = e * this.getViewportHeight() / this.getViewportWidth();
            m.mat4.ortho(this.getProjectionMatrix(), -e, e, -t, t, -10, 10)
        },
        onEventStart: function (e) {
            this._lastScale = e.scale || 1, this._zoomInterpolator.reset(), this._panInterpolator.reset(), this._isPanning = !0
        },
        onEventEnd: function () {
            this._zoomInterpolator.reset(), this._panInterpolator.reset(), this._isPanning = !1
        },
        onEventUpdate: function (e) {
            if (this._isPanning) {
                if (this._panInterpolator.setTarget(e.glX, -e.glY), e.scale) {
                    var t = e.scale > this._lastScale ? 5 : 10,
                        i = (e.scale - this._lastScale) * t,
                        n = this._zoomInterpolator.getTarget()[0] - i;
                    this._zoomInterpolator.setTarget(n), this._lastScale = e.scale
                }
                this.registerFocusZoom(e), r.a.draw()
            }
        },
        onMouseWheel: function (e) {
            this._zoomInterpolator.setTarget(this._zoomInterpolator.getTarget()[0] - Math.sign(e.deltaY)), this.registerFocusZoom(e), r.a.draw()
        },
        registerFocusZoom: function (e) {
            var t = this._viewerOSGJS.getCanvasPixelRatio(),
                i = this.getViewportWidth(),
                n = this.getViewportHeight(),
                r = m.vec2.set(this._zoomCoord, e.canvasX, e.canvasY),
                a = "2d" === this._model.get("splitType") ? .5 : -.5;
            r[0] = a + (r[0] * t - i) / i, r[1] = r[1] * t / n - .5
        },
        _updateWireframeNodeMask: function () {
            var e = this._viewer.getOrCreateScene().getWireframeNodes();
            e.length && this._projectedWireframe.setNodeMask(e[0].getNodeMask())
        },
        update: function (e, t) {
            var i = t.getFrameStamp(),
                n = i.getDeltaTime(),
                r = this.getViewMatrix(),
                a = this.getViewportWidth(),
                o = this.getViewportHeight(),
                s = this._panInterpolator.update(n),
                u = .1 * this._zoomInterpolator.update(n)[0],
                l = this._scale * (1 + u),
                c = l * this._viewerOSGJS.getCanvasPixelRatio() / a,
                h = l - this._scale;
            r[12] += s[0] * c + this._zoomCoord[0] * h, r[13] -= s[1] * c + this._zoomCoord[1] * h * o / a, this._scale = l, this.updateOrtho(), this._updateWireframeNodeMask();
            var d = this._model.get("displayView"),
                f = "VertexColor" === d || "VertexAlpha" === d ? -1 : 0;
            return this._projectedPolygon.setNodeMask(f), !0
        }
    }), t.a = v
}, function (e, t) {
    e.exports = "attribute vec2 %UV%;\nattribute vec4 Color;\n\nuniform float uArrayColorEnabled;\nuniform float uPointSize;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec4 vColor;\n\nvoid main() {\n    vec2 uv = %UV_UNPACK%;\n    gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(uv - 0.5, 1.0, 1.0));\n    gl_PointSize = 1.0;\n    vColor = uArrayColorEnabled == 1.0 ? Color : vec4(1.0, 1.0, 1.0, 1.0);\n}\n"
}, function (e, t) {
    e.exports = "uniform int uProjectedWireframe;\nuniform float uDisplayVertexAlpha;\nuniform vec4 uColor;\n\nvarying vec4 vColor;\n\nvoid main() {\n    gl_FragColor = uProjectedWireframe == 1 ? vec4(uColor.rgb * uColor.a, uColor.a) : vec4(uDisplayVertexAlpha == 0.0 ? vColor.rgb : vColor.aaa, 1.0);\n}\n"
}, function (e, t, i) {
    "use strict";
    var n = i(90),
        r = i(1436),
        a = i(1437),
        o = {
            FeatureName: "ARKit",
            ModelType: r.a,
            ViewListType: [a.a]
        },
        s = n.a.create(o);
    s.prototype.getNodeIn = function () {
        return this._views[0].getFeatureNode()
    }, s.prototype.getNodeOut = function () {
        return this._views[0].getArSceneNode()
    }, s.prototype.getWidgetNode = function () {
        return this._views[0].getWidgetNode()
    }, t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(24),
        r = i.n(n),
        a = i(20),
        o = r.a.Model.extend({
            defaults: {
                enable: Object(a.a)().arkit
            }
        });
    t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(8),
        a = i(47),
        o = i(938),
        s = i(633),
        u = i(1438),
        l = i(85),
        c = i(69),
        h = i(103),
        d = i(77),
        f = i(1439),
        p = i(229),
        m = i(159),
        g = i(20),
        v = i(88),
        _ = i(1440),
        b = i(424),
        S = i.n(b),
        x = i(114),
        y = i(199),
        C = i(120),
        T = i(1441),
        w = i.n(T),
        M = i(1442),
        E = i.n(M),
        A = new S.a({
            device: "VWR",
            listen: !0
        }),
        P = n.a.osg,
        R = 1.5,
        O = R + .5;
    Object(g.a)().arkitDebug && (R = 200);
    var I = P.vec3.create(),
        F = P.vec3.create(),
        N = P.vec3.create(),
        D = P.vec3.create(),
        L = P.vec3.create(),
        k = P.vec3.create(),
        V = P.vec3.create(),
        B = r.a.extend({
            initialize: function () {
                r.a.prototype.initialize.apply(this, arguments), this._viewer = this.options.context.getViewer(), this._featureNode = new P.MatrixTransform, this._featureNode.setName("Feature - ARKit"), this._arSceneNode = new P.MatrixTransform, this._arSceneNode.setName("ARKit - Scene"), this._featureNode.addChild(this._arSceneNode), a.a.getModelDisplayed().then(this.onEnable.bind(this))
            },
            initGraphNode: function () {
                this._elevationWidget = new _.a(this._viewer.getCamera()), this._proxyNode = new P.Node, this._proxyNode.setName("ARKit - Widget-Shadows"), this._proxyNode.setNodeMask(c.a.NO_SHADOW), this._widgetNode = new P.Node, this._widgetNode.setName("ARKit - Widget");
                var e = this._widgetNode.getOrCreateStateSet();
                this._createWidgetStateSet(e);
                var t = P.Uniform.createFloat(.35, "uAlpha");
                e.addUniform(t), this._uAlpha = t.getInternalArray(), e.setTextureAttributeAndModes(0, p.a.dummyTexture, P.StateAttribute.OVERRIDE), this._featureNode.addChild(this._proxyNode), this._proxyNode.addChild(this._widgetNode), this._shadowPlaneNode = new P.MatrixTransform, this._shadowPlaneNode.setName("ARKit - ShadowPlane"), e = this._proxyNode.getOrCreateStateSet(), e.setShaderGeneratorName("shadow-ar"), this._setCommonStateSet(e)
            },
            _setCommonStateSet: function (e) {
                e.setRenderBinDetails(l.a.EXTRA, "RenderBin"), e.setAttributeAndModes(v.a.CULL_DISABLE), e.setAttributeAndModes(v.a.BLEND_SUBSTRACTIVE), e.setAttributeAndModes(v.a.DEPTH_LESS_NO_WRITE)
            },
            _createWidgetStateSet: function (e) {
                var t = C.a.getOrCreateShader(w.a, E.a, "plane", "ArPlane");
                return e.setAttributeAndModes(t), this._setCommonStateSet(e), e.addUniform(P.Uniform.createInt(0, "uTextureIcon")), e.addUniform(P.Uniform.createFloat(0, "uDisplay2D")), e.addUniform(P.Uniform.createFloat2(P.vec2.fromValues(1, 1), "uScale")), e
            },
            enableARShadows: function (e) {
                e ? (this._proxyNode.addChild(this._shadowPlaneNode), this._proxyNode.dirtyBound()) : (this._proxyNode.removeChild(this._shadowPlaneNode), this._proxyNode.dirtyBound())
            },
            _setPlaneTexture: function (e) {
                var t = d.default.instance.getOrCreateTexture(e.SKFB_LOGO, {
                    internalFormat: P.Texture.RGBA
                });
                this._widgetNode.getOrCreateStateSet().setTextureAttributeAndModes(0, t.texture)
            },
            _getOrCreatePlaneGeometry: function () {
                return this._planeGeom || (this._planeGeom = P.createTexturedQuadGeometry(-.5, 0, -.5, 1, 0, 0, 0, 0, 1), this._planeGeom.setName("PlaneGeometry")), this._planeGeom
            },
            initEvents: function () {
                this.model.bind("change:enable", this.onEnable, this), this.model.bind("pick", this.onPick, this), y.a.initAR(this)
            },
            onEnable: function () {
                if (this.model.get("enable")) {
                    this._planeNodes = {}, this._globalTranslation = P.vec3.create(), this._globalScale = P.vec3.fromValues(1, 1, 1), this._globalRotation = P.mat4.create(), this._startMat = P.mat4.create(), this._startPos = P.vec2.create(), this._curPos = P.vec2.create(), this._elevation = 0, this.initGraphNode(), A.on("message:arShadows", function (e) {
                        this.enableARShadows(parseInt(e.data.arShadows, 10)), e.removeFromHash()
                    }.bind(this)), a.a.getFirstAnimation().then(function () {
                        var e = this._viewer.getFeatures(),
                            t = e.lighting;
                        t.getModel().setPreset("LightFromAbove"), t.getModel().set("enable", !0);
                        var i = e.environment;
                        if (i.getModel().get("enable")) i.getModel().set("shadowEnable", !1);
                        else {
                            var n = d.default.instance.getEnvironmentCollection();
                            if (n.length) {
                                var r = n.at(0).get("uid");
                                i.getModel().set("uid", r)
                            } else i.getModel().set("uid", "2fa15e0b1cee45a5b02605a288934e1b");
                            i.getModel().set("shadowEnable", !1), i.getModel().set("enable", !0)
                        }
                        e.ground.getModel().set("enable", !1), this.enableARShadows(!0)
                    }.bind(this)), this.initEvents(), this._viewer.getViewerOSGJS().requestContinuousUpdate(!0), f.a.getARKitAssets(this._setPlaneTexture.bind(this));
                    var e = this._viewer.getFeatures();
                    e.background.getModel().set("enable", "none"), e.postProcess.getModel().set("enable", !1), e.postProcess.getModel().set("AR", !0), e.hotspot.getWidgetNode().setNodeMask(0), e.autospin.getModel().set("enable", !1), this._featureNode.addUpdateCallback(o.a), this._widgetNode.addUpdateCallback(this), this._widgetNode.addChild(this._elevationWidget), o.a.addPlaneListener(this), o.a.addCameraListener(new u.a(this._viewer.getCamera())), this._viewer.getViewerOSGJS().requestContinuousUpdate(!0), this._inputManager = this._viewer.getInputManager(), Object(g.a)().arkitDebug ? (window.publicLibraries.$(".viewer").css("background", "rgba(125,125,125,255)"), e.camera.getModel().set("indexManipulator", s.a.FPS)) : (window.publicLibraries.$(".viewer").css("background", "rgba(0,0,0,0)"), this._inputManager.setEnable(x.a.SCENE, !1)), this._arSceneNode.setNodeMask(0), this._viewer.getCamera().getClearColor()[3] = 0, h.a.getBoxReady().then(function () {
                        var e = h.a.getModelBoxWithDisplacement(),
                            t = e.getMin()[2];
                        this._bBoxHeight = e.getMax()[2] - t;
                        var i = 1 / this._bBoxHeight;
                        P.vec3.set(this._globalScale, i, i, i), this._invAnchorPoint = e.center(P.vec3.create()), this._invAnchorPoint[2] = t, P.vec3.negate(this._invAnchorPoint, this._invAnchorPoint), Object(g.a)().arkitDebug && (this._viewer.getFeaturesManager().focusOnTargetAndEye(P.vec3.fromValues(0, 0, 0), P.vec3.fromValues(5, 5, 2), .1), this.onPlanesChange([{
                            uid: "123",
                            transform: P.mat4.IDENTITY,
                            center: P.vec3.ZERO,
                            extent: P.vec3.fromValues(10, 1, 10)
                        }]));
                        var n = e.radius() * i;
                        this._shadowPlaneGeom = P.createTexturedQuadGeometry(-n, -n, 0, 2 * n, 0, 0, 0, 2 * n, 0), this._shadowPlaneNode.addChild(this._shadowPlaneGeom), this._shadowPlaneNode.dirtyBound()
                    }.bind(this))
                }
            },
            getFeatureNode: function () {
                return this._featureNode
            },
            getWidgetNode: function () {
                return this._widgetNode
            },
            getArSceneNode: function () {
                return this._arSceneNode
            },
            update: function (e, t) {
                var i = t.getFrameStamp();
                if (this._time = i.getSimulationTime(), this._modelPlaced) {
                    var n = this._time - this._hitTime;
                    return n < .5 && (this._uAlpha[0] = n / .5 * .35), n > R && n < O && (this._uAlpha[0] = .35 * (1 - (n - R) / .5)), !0
                }
            },
            onPick: function (e) {
                var t = m.a.computeNearestIntersection2D(e[0], e[1], c.a.PICK_GEOMETRY_FAST, this._widgetNode);
                this._hitTime = this._time, t && (this._modelPlaced = !0, P.vec3.transformMat4(this._globalTranslation, t._localIntersectionPoint, P.computeLocalToWorld(t._nodePath.slice(1))), this._arSceneNode.setNodeMask(-1), this._updateSceneTransforms(), window.location.hash = "buzz", window.setTimeout(function () {
                    window.location.hash = ""
                }, 200))
            },
            _updateSceneTransforms: function () {
                var e = this._arSceneNode.getMatrix();
                P.mat4.fromTranslation(e, this._globalTranslation), P.mat4.multiply(e, e, this._globalRotation), P.mat4.scale(e, e, this._globalScale), P.mat4.translate(e, e, this._invAnchorPoint), P.mat4.translate(e, e, P.vec3.set(I, 0, 0, this._elevation));
                var t = this._elevation >= 0 ? this._bBoxHeight : 0;
                this._elevationWidget.setAnchorAndElevation(this._globalTranslation, (this._elevation + t) * this._globalScale[0]);
                var i = this._shadowPlaneNode.getMatrix();
                P.mat4.fromTranslation(i, this._globalTranslation);
                for (var n = this._viewer.getFeatures(), r = n.lighting, a = r.getModel().get("lights"), o = 0; o < a.length; o++) {
                    var s = a[o];
                    s.isCastingShadows() && s.dirty()
                }
                this._arSceneNode.dirtyBound(), this._shadowPlaneNode.dirtyBound()
            },
            _getPlaneNode: function (e) {
                var t = this._planeNodes[e];
                if (!t) {
                    this._hitTime = this._time, t = new P.MatrixTransform, t.addChild(this._getOrCreatePlaneGeometry());
                    var i = t.getOrCreateStateSet(),
                        n = P.Uniform.createFloat2(P.vec2.fromValues(1, 1), "uScale");
                    i.addUniform(n), t._uScale = n.getInternalArray(), this._planeNodes[e] = t
                }
                return t
            },
            onPlanesChange: function (e) {
                for (var t in this._planeNodes) {
                    var i = this._planeNodes[t];
                    i.updated = !1
                }
                for (var n, r = 0; r < e.length; r++) {
                    var a = e[r];
                    n = this._getPlaneNode(a.uid), o.a.getMatrixTransformFromARPlane(n.getMatrix(), a), n._uScale[0] = a.extent[0], n._uScale[1] = a.extent[2], 0 === n.getParents().length && this._widgetNode.addChild(n), n.updated = !0, n.dirtyBound()
                }
                for (t in this._planeNodes) i = this._planeNodes[t], !i.updated && n.getParents().length && this._widgetNode.removeChild(i);
                this._widgetNode.dirtyBound()
            },
            startMotion: function (e) {
                this._inputManager.setEnable(x.a.MANIPULATORS, !1), P.vec2.set(this._startPos, e.canvasX, e.canvasY)
            },
            endMotion: function () {
                this._inputManager.setEnable(x.a.MANIPULATORS, !0), this.endElevate(), this.endRotate(), this.endScale()
            },
            motion: function (e) {
                if (this._rotating) this.rotate(e);
                else if (this._scaling) {
                    P.vec2.set(this._curPos, e.canvasX, e.canvasY);
                    var t = this._viewer.getCanvas().height,
                        i = 1 - (this._curPos[1] - this._startPos[1]) / t;
                    e.scale = i, this.scale(e)
                } else this._elevating && this.elevate(e)
            },
            startRotate: function (e) {
                this._rotating = !0, P.vec2.set(this._startPos, e.canvasX, e.canvasY), P.mat4.copy(this._startMat, this._globalRotation)
            },
            endRotate: function () {
                this._rotating = !1
            },
            rotate: function (e) {
                this._rotating || this.startRotate(e), P.vec2.set(this._curPos, e.canvasX, e.canvasY);
                var t = this._viewer.getCanvas().width,
                    i = (this._curPos[0] - this._startPos[0]) / t * Math.PI * 2;
                P.mat4.rotateZ(this._globalRotation, this._startMat, i), this._updateSceneTransforms()
            },
            startScale: function () {
                this._scaling = !0, this._initScale = this._globalScale[0]
            },
            endScale: function () {
                this._scaling = !1
            },
            scale: function (e) {
                var t = Math.max(e.scale * this._initScale, 1e-8);
                P.vec3.set(this._globalScale, t, t, t), this._updateSceneTransforms()
            },
            startElevate: function (e) {
                this._elevating = !0, this._initElevation = this._elevation, P.vec2.set(this._startPos, e.glX, e.glY), this._startWorldElevation = this._getElevationFromScreenCoord(this._startPos), this._elevationWidget.setVisible(!0, .5), this._hitTime = this._time
            },
            endElevate: function () {
                this._elevating = !1, this._elevationWidget.setVisible(!1, .5)
            },
            elevate: function (e) {
                this._elevating || this.startElevate(e), P.vec2.set(this._curPos, e.glX, e.glY);
                var t = this._getElevationFromScreenCoord(this._curPos),
                    i = t - this._startWorldElevation;
                this._elevation = this._initElevation + i, this._elevation < 0 && (this._elevation = 0), this._updateSceneTransforms()
            },
            _getElevationFromScreenCoord: function (e) {
                P.vec2.copy(N, e), N[2] = 0, m.a.getWorldPositionFromScreenPoint(N, D), N[2] = 1, m.a.getWorldPositionFromScreenPoint(N, L), P.vec3.sub(V, L, D), P.vec3.normalize(V, V), P.mat4.getLookAt(k, I, F, this._viewer.getCamera().getViewMatrix()), P.vec3.subtract(k, k, I), k[2] = 0, P.vec3.normalize(k, k), P.mat4.getTranslation(I, this._featureNode.getMatrix());
                var t = P.vec3.length(this._globalTranslation),
                    i = P.vec3.dot(k, V),
                    n = -(P.vec3.dot(k, D) + t),
                    r = n / i;
                return 0 === i && (r = 0), P.vec3.scaleAndAdd(I, D, V, r), I[2] / this._globalScale[0]
            }
        });
    t.a = B
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(938),
        a = n.a.osg,
        o = function (e) {
            this._camera = e, this._prevFrame = {
                valid: !1,
                position: a.mat4.create(),
                direction: a.mat4.create(),
                speed: -1,
                at: -1
            }
        };
    o.prototype = {
        onCameraChange: function (e, t) {
            return !e || !t || (r.a.getCameraMatrix(this._camera.getViewMatrix(), e), a.mat4.copy(this._camera.getProjectionMatrix(), t), !0)
        }
    }, t.a = o
}, function (e, t, i) {
    "use strict";
    t.a = {
        getARKitAssets: function (e) {
            i.e(18).then(function () {
                e(i(1717).default)
            }.bind(null, i)).catch(i.oe)
        }
    }
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(69),
        a = i(934),
        o = i.n(a),
        s = i(935),
        u = i.n(s),
        l = i(120),
        c = i(88),
        h = i(85),
        d = n.a.osg,
        f = d.createTexturedQuadGeometry(-.5, 0, 0, 1, 0, 0, 0, 1, 0),
        p = d.vec3.fromValues(0, 0, 1),
        m = d.vec3.create(),
        g = d.vec3.create(),
        v = d.mat4.create(),
        _ = function (e) {
            d.MatrixTransform.call(this), this._camera = e;
            var t = d.Uniform.createFloat1(.7, "uAlpha");
            this._uAlpha = t.getInternalArray();
            var i = f.getOrCreateStateSet();
            i.setRenderBinDetails(h.a.EDITOR_GIZMO, "RenderBin"), i.setAttributeAndModes(c.a.DEPTH_LESS_NO_WRITE), i.addUniform(t), i.setAttributeAndModes(l.a.createShader(o.a, u.a, "AR-Elevation-Widget", "ARElevation")), this.addChild(f), this.addUpdateCallback(this), this.setNodeMask(0)
        };
    d.createPrototypeNode(_, d.objectInherit(d.MatrixTransform.prototype, {
        setVisible: function (e, t) {
            e !== this._visible && (t || (t = .01), this._delay = t, this._visible = e, e && this.setNodeMask(r.a.NO_PICK_NO_SHADOW), this._isFading = !0)
        },
        update: function (e, t) {
            var i = t.getFrameStamp();
            if (this._time = i.getSimulationTime(), this._updateTransforms(), this._isFading) return this._updateFading(), !0
        },
        _updateTransforms: function () {
            if (this._anchorPoint) {
                var e = this.getMatrix();
                d.mat4.invert(v, this._camera.getViewMatrix()), d.mat4.getTranslation(m, v), m[2] = this._anchorPoint[2], d.mat4.lookAt(e, this._anchorPoint, m, p), d.mat4.invert(e, e), d.mat4.setTranslation(e, this._anchorPoint);
                var t = d.vec3.length(d.vec3.subtract(m, m, this._anchorPoint));
                d.mat4.scale(e, e, d.vec3.set(g, .01 * t, this._elevation, 1))
            }
        },
        _updateFading: function () {
            this._startTime || (this._startTime = this._time);
            var e = this._time - this._startTime;
            e < this._delay ? this._visible ? this._uAlpha[0] = e / this._delay * .7 : this._uAlpha[0] = .7 * (1 - e / this._delay) : (this._visible || this.setNodeMask(0), this._startTime = 0, this._isFading = !1)
        },
        setAnchorAndElevation: function (e, t) {
            this._anchorPoint = e, this._elevation = t
        }
    }), "osgSketchfab", "ElevationWidget"), t.a = _
}, function (e, t) {
    e.exports = "attribute vec3 Vertex;\n\nattribute vec2 TexCoord0;\nvarying vec2 vTexCoord0;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n  vTexCoord0 = TexCoord0;\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xyz, 1.0));\n}\n"
}, function (e, t) {
    e.exports = 'varying vec2 vTexCoord0;\n\nuniform sampler2D uTextureIcon;\nuniform float uAlpha;\nuniform vec2 uScale;\n\n#pragma include "utils/functions.glsl"\n\nvoid main() {\n    vec2 uvCenter = vTexCoord0 * 2.0 - 1.0;\n\n    vec4 icon = texture2D(uTextureIcon, vTexCoord0 * uScale * 10.0);\n\n    float alpha = uAlpha * icon.a * clamp(1.0 - dot(uvCenter, uvCenter), 0.0, 1.0);\n\n    icon.rgb *= alpha;\n    icon.rgb = linearTosRGB(icon.rgb);\n    gl_FragColor = vec4(icon.rgb, alpha);\n}\n'
}, function (e, t, i) {
    "use strict";
    var n = i(90),
        r = i(1444),
        a = i(1445),
        o = {
            FeatureName: "ground",
            ModelType: r.a,
            ViewListType: [a.a]
        },
        s = n.a.create(o);
    s.prototype.getNode = function () {
        return this._views[0].getNodeGround()
    }, t.a = s
}, function (e, t, i) {
    "use strict";
    var n = i(149),
        r = i(77),
        a = n.a.extend({
            _trashbin: [],
            defaults: {
                progress: 0
            },
            getModelOptionPath: function () {
                return "ground"
            },
            getName: function () {
                return "Ground"
            },
            init: function (e) {
                var t = e.getModel().get("options");
                this._globalModel = e.getModel(), t.ground && this.setJSON(t.ground);
                var i = this.get("aoTextureUid");
                if (i) {
                    var n = r.default.instance,
                        a = n.getTextureCollection(),
                        o = a.get(i);
                    o && o.set("internal", !0)
                }
            },
            startRender: function () {
                this._globalModel.trigger("status:pending")
            },
            stopRender: function () {
                this._globalModel.trigger("status:loaded")
            }
        });
    t.a = a
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(8),
        a = i(69),
        o = i(103),
        s = i(44),
        u = i(85),
        l = i(88),
        c = i(321),
        h = i(1446),
        d = i(599),
        f = i(77),
        p = i(47),
        m = i(119),
        g = n.a.osg,
        v = function (e, t) {
            g.StateAttribute.call(this), this._enable = t || !1, this._useBakedAo = "BakedAO" === e, this._displayPlane = !1
        };
    v.prototype = g.objectLibraryClass(g.objectInherit(g.StateAttribute.prototype, {
        attributeType: "GroundStateAttribute",
        cloneType: function () {
            return new v(!0)
        },
        setEnabled: function (e) {
            this._enable = e
        },
        isEnabled: function () {
            return this._enable
        },
        isUseBakedAo: function () {
            return this._useBakedAo
        },
        setDisplayPlane: function (e) {
            this._displayPlane = e
        },
        isDisplayPlane: function () {
            return this._displayPlane
        },
        getHash: function () {
            return "Ground" + this._useBakedAo + this._displayPlane
        }
    }), "osgSketchfab", "GroundStateAttribute"), g.setTypeID(v);
    var _ = r.a.extend({
        initialize: function () {
            r.a.prototype.initialize.apply(this, arguments);
            var e = this.model;
            e.bind("change:enable", this.onEnableChanged, this), e.bind("change:opacity", this.onOpacityChanged, this), e.bind("change:fade", this.onFadeChanged, this), e.bind("change:height", this.onTransformChanged, this), e.bind("change:size", this.onTransformChanged, this), e.bind("change:shadowMode", this.onShadowModeChanged, this), e.bind("change:samplingRange", this.onSamplingRangeChanged, this), e.bind("cancelRequested", this.cancelRender, this), this._nodeFeature = new g.Node, this._nodeFeature.setName("Feature - Ground"), this._transform = new g.MatrixTransform, this._transform.setName("Ground - Transform"), this._transform.setNodeMask(a.a.NO_PICK_NO_SHADOW), this._geometry = g.createTexturedQuadGeometry(-1, -1, 0, 2, 0, 0, 0, 2, 0), this._geometry.setName("Ground - Geometry"), this._geometry.setNodeMask(0), this._transform.addChild(this._geometry), this._viewer = this.options.context.getViewer(), this._needBake = !1;
            var t = this._transform.getOrCreateStateSet();
            this._uScale = g.Uniform.createFloat("uGroundScale"), this._uFade = g.Uniform.createFloat("uGroundFade"), this._uOpacity = g.Uniform.createFloat("uGroundOpacity");
            var i = g.Uniform.createFloat(1, "uWidgetFade");
            t.addUniform(this._uScale), t.addUniform(this._uFade), t.addUniform(this._uOpacity), t.addUniform(i), this._uWidgetFade = i.getInternalArray(), this._widgetFadeDirection = 1, o.a.getBoxReady().then(this.onEnableChanged.bind(this)), this.model.set("lastRenderHeight", this.model.get("height")), this.model.set("lastRenderSamplingRange", this.model.get("samplingRange")), this._nodeFeature.addUpdateCallback(this), e.get("enable") && "BakedAO" === e.get("shadowMode") || p.a.resolveGroundHiResAoLoaded()
        },
        initStateSet: function () {
            var e = this._geometry.getOrCreateStateSet();
            e.setName("Ground"), e.setShaderGeneratorName("ground"), e.setRenderBinDetails(u.a.TRANSPARENT_CUSTOM_EARLYZ, "RenderBin"), e.setAttribute(l.a.CULL_BACK), this.onShadowModeChanged(), this.onFadeChanged(), this.onOpacityChanged(), this._initialized = !0
        },
        onShadowModeChanged: function () {
            if (o.a.getBoxReady().isFulfilled()) {
                var e = this._geometry.getOrCreateStateSet(),
                    t = this.model.get("shadowMode"),
                    i = "BakedAO" === t;
                if (this._geometry.setNodeMask(0), this._groundStateAttrib = new v(t, !0), e.setAttributeAndModes(this._groundStateAttrib), this.cleanUpTexture(this._lightMapper, e), i) {
                    var n = this.model.get("aoTextureUid");
                    n && !this._needBake ? this._setupBakedAoTexture(n) : this._setupLightMapper()
                } else this._geometry.setNodeMask(-1), s.a.draw();
                this._updateTransforms()
            }
        },
        _setupBakedAoTexture: function (e) {
            var t = f.default.instance,
                i = t.getOrCreateMultiresTexture(e, {
                    minFilter: g.Texture.LINEAR,
                    magFilter: g.Texture.LINEAR,
                    wrapS: g.Texture.CLAMP_TO_EDGE,
                    wrapT: g.Texture.CLAMP_TO_EDGE,
                    internalFormat: g.Texture.RGBA
                }),
                n = i.resource;
            n.isTextureNull() && (n.setTextureSize(1, 1), n.setImage(new Uint8Array([255, 255, 255, 255])));
            var r = this._geometry.getOrCreateStateSet();
            r.setTextureAttributeAndModes(0, n, g.StateAttribute.ON | g.StateAttribute.OVERRIDE | g.StateAttribute.PROTECTED), r.addUniform(g.Uniform.createInt(0, "uTexture")), this._geometry.setNodeMask(-1);
            var a = p.a.getLowResLoaded();
            n.setImageSmallest().promise.then(function () {
                this._geometry.setNodeMask(-1), a.then(function () {
                    n.setImageMaxSupported().promise.then(function () {
                        this._aoTexture = n
                    }.bind(this))
                }.bind(this))
            }.bind(this)), this.model.set("lastRenderHeight", this.model.get("height")), this.model.set("lastRenderSamplingRange", this.model.get("samplingRange"))
        },
        _setupLightMapper: function () {
            var e = this._geometry.getOrCreateStateSet();
            if (this._lightMapper) return this._lightMapper.isValidRender() ? this._restoreTexture() : this._needBake = !0, void(this._needBake && this._bake());
            this._lightMapper = new h.a(512, this._nodeFeature, this._viewer, this._transform, 600), e.addUniform(g.Uniform.createInt(0, "uTexture")), this._lightMapper.onFrameRendered(function (t) {
                if (e.setTextureAttributeAndModes(0, this._lightMapper.getFinalTexture(), g.StateAttribute.ON), this._geometry.setNodeMask(-1), this.model.set("progress", this._lightMapper.getProgress()), this.model.set("estimatedTime", this._lightMapper.getEstimatedTime()), t) {
                    this.model.stopRender();
                    if (!this.model.get("dirty")) {
                        this.model.set("dirty", !0);
                        var i = this.model.get("aoTextureUid");
                        i && this.model._trashbin.push(new d.a({
                            uid: i
                        })), this.model.set("aoTextureUid", void 0)
                    }
                    this.model.set("imageCanvas", this._lightMapper.getRenderedCanvas()), this.model.set("lastRenderHeight", this.model.get("height")), this.model.set("lastRenderSamplingRange", this.model.get("samplingRange"))
                }
            }.bind(this));
            var t = o.a.getModelBoxWithDisplacement();
            this._lightMapper.setSceneData(t, this._transform), this._lightMapper._samplingRange = this.model.get("samplingRange"), this._bake(100)
        },
        _restoreTexture: function () {
            var e = new g.Texture;
            e.setImage(this.model.get("imageCanvas")), this._geometry.getOrCreateStateSet().setTextureAttributeAndModes(0, e, g.StateAttribute.ON), this._geometry.setNodeMask(-1), s.a.draw()
        },
        cancelRender: function () {
            if (this._lightMapper) {
                if (this._lightMapper.stopRender(), this.model.stopRender(), this._holdBake = !0, this.model.set("height", this.model.get("lastRenderHeight")), this.model.set("samplingRange", this.model.get("lastRenderSamplingRange")), this._holdBake = !1, this.model.set("progress", 100), this.model.set("estimatedTime", 0), this._lightMapper.isValidRender()) return void this._restoreTexture();
                var e = this.model.get("aoTextureUid");
                e ? (this._setupBakedAoTexture(e), this.model.set("dirty", !1), this.model._trashbin.length = 0) : m.a.get("mask") & m.a.LIT ? this.model.set("shadowMode", "ShadowCatcher") : this.model.set("enable", !1)
            }
        },
        onSamplingRangeChanged: function () {
            this._lightMapper || this._setupLightMapper(), this._lightMapper._samplingRange = this.model.get("samplingRange"), this._bake()
        },
        cleanUpTexture: function (e, t) {
            e && t.setTextureAttributeAndModes(0, e.getFinalTexture(), g.StateAttribute.OFF)
        },
        getNodeGround: function () {
            return this._nodeFeature
        },
        onOpacityChanged: function () {
            this._uOpacity.setFloat(Math.max(0, this.model.get("opacity"))), s.a.draw()
        },
        onFadeChanged: function () {
            this._uFade.setFloat(this.model.get("fade")), s.a.draw()
        },
        onEnableChanged: function () {
            var e = this._geometry.getOrCreateStateSet();
            this._nodeFeature.removeChild(this._transform), c.a.registerStateSetIsTransparent(e, !1), this.model.get("enable") && (this._updateTransforms(), this._nodeFeature.addChild(this._transform), this._initialized || this.initStateSet(), c.a.registerStateSetIsTransparent(e, !0), this._lightMapper && !this._lightMapper.isValidRender() && this._bake(1)), s.a.draw()
        },
        onTransformChanged: function () {
            this._lightMapper || "BakedAO" !== this.model.get("shadowMode") || this._setupLightMapper(), this._updateTransforms(), this._needBake = !0, "BakedAO" === this.model.get("shadowMode") && this._bake(), this._displayPlane(), s.a.draw()
        },
        _displayPlane: function () {
            this._groundStateAttrib.setDisplayPlane(!0), this._geometry.getOrCreateStateSet().setAttribute(l.a.CULL_DISABLE), this._widgetFadeDirection = -1, this._schedulePlane && clearTimeout(this._schedulePlane), this._schedulePlane = setTimeout(function () {
                this._widgetFadeDirection = 1, s.a.draw()
            }.bind(this), 1e3)
        },
        update: function (e, t) {
            if (!this._aoTexture || this._aoTexture.isDirty() || p.a.getGroundHiResAoLoaded().isFulfilled() || p.a.resolveGroundHiResAoLoaded(), !this._groundStateAttrib || !this._groundStateAttrib.isDisplayPlane()) return !0;
            var i = t.getFrameStamp();
            if (this._uWidgetFade[0] += i.getDeltaTime() * this._widgetFadeDirection, this._uWidgetFade[0] > 1) {
                this._uWidgetFade[0] = 1, this._groundStateAttrib.setDisplayPlane(!1);
                this._geometry.getOrCreateStateSet().setAttribute(l.a.CULL_BACK)
            }
            return this._uWidgetFade[0] < .8 && (this._uWidgetFade[0] = .8), s.a.draw(), !0
        },
        _updateTransforms: function () {
            var e = g.vec3.create();
            return function () {
                var t = this._transform.getMatrix(),
                    i = o.a.getModelBoxWithDisplacement(),
                    n = this.model.get("size");
                "BakedAO" === this.model.get("shadowMode") && (n = 1.5);
                var r = i.radius() * n;
                g.vec3.set(e, r, r, r), g.mat4.fromScaling(t, e), this._uScale.getInternalArray()[0] = n;
                var a = this.model.get("height");
                0 === a && (a = 1e-4), i.center(e);
                var s = i.getMax()[2] - i.getMin()[2];
                t[12] = e[0], t[13] = e[1], t[14] = i.getMin()[2] + s * a, this._transform.dirtyBound()
            }
        }(),
        _bake: function (e) {
            e = e || 1e3, this._holdBake || (this.model.startRender(), this._schedule && clearTimeout(this._schedule), this._schedule = setTimeout(this._lightMapper.requestRender.bind(this._lightMapper), e), this._needBake = !1)
        }
    });
    t.a = _
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(88),
        a = i(47),
        o = i(581),
        s = i(44),
        u = i(229),
        l = i(120),
        c = i(715),
        h = i(1447),
        d = i.n(h),
        f = i(1448),
        p = i.n(f),
        m = i(1449),
        g = i.n(m),
        v = i(69),
        _ = n.a.osgShader.shaderProcessor,
        b = n.a.osgUtil,
        S = n.a.osg,
        x = function (e, t, i, n, r) {
            this._textureSize = e, this._nodeFeature = t, this._viewer = i, this._nbFrames = 0, this._targetNode = n, this._nbSamples = r || 300, this._progress = 0, this._samplingRange = 1, this._validRender = !1, this._renderedCanvas = document.createElement("canvas"), this._init()
        };
    x.prototype = {
        _init: function () {
            this.initComposer(), this.initShadowCamera(), this.initLightMapCamera(), this._nodeFeature.addChild(this._shadowCamera), this._nodeFeature.addChild(this._lightMapCamera), this._nodeFeature.addChild(this._composer), this._nodeFeature.addUpdateCallback(this)
        },
        getFinalTexture: function () {
            return this._render ? this._currentlightMap : this._composer.getInternalTexture("FinalTexture1")
        },
        requestRender: function () {
            this._render && this.stopRender(), this._shadowCamera.setNodeMask(v.a.NO_PICK_NO_SHADOW), this._lightMapCamera.setNodeMask(v.a.NO_PICK_NO_SHADOW), this._render = !0, s.a.draw()
        },
        onFrameRendered: function (e) {
            this._frameCallback = e
        },
        stopRender: function () {
            this._render && (this._nbFrames = 0, this._render = !1, this._progress = 0, this._shadowCamera.setNodeMask(0), this._lightMapCamera.setNodeMask(0), this._composer.setNodeMask(0))
        },
        update: function (e, t) {
            if (!this._render || !a.a.getModelDisplayed().isFulfilled()) return !0;
            var i = t.getFrameStamp();
            return this._estimatedTime = i.getDeltaTime() * this._nbSamples, this._nbFrames > this._nbSamples && (this._shadowCamera.setNodeMask(0), this._lightMapCamera.setNodeMask(0), this._composer.setNodeMask(v.a.NO_PICK_NO_SHADOW), this._getLastComposerCamera().setFinalDrawCallback(function (e) {
                this._renderedCanvas = Object(c.b)(e, this._textureSize, this._textureSize, this._renderedCanvas)
            }.bind(this))), this._nbFrames > this._nbSamples + 1 ? (this._validRender = !0, this.stopRender(), this._progress = 100, this._frameCallback && this._frameCallback(!0), this._getLastComposerCamera().setFinalDrawCallback(void 0), !0) : (this._nbFrames++, this._uNumFrames.getInternalArray()[0] = this._nbFrames, this.updateCameras(), s.a.draw(), this.swapLightMaps(), this._frameCallback && this._frameCallback(), this._progress = this._nbFrames / this._nbSamples * 100, !0)
        },
        getRenderedCanvas: function () {
            return this._renderedCanvas
        },
        isValidRender: function () {
            return this._validRender
        },
        getProgress: function () {
            return this._progress
        },
        getEstimatedTime: function () {
            return this._estimatedTime
        },
        setNbSamples: function (e) {
            this._nbSamples = e
        },
        initComposer: function () {
            this._composer = new b.ComposerPostProcess, this._composer.setOffscreen(!0), this._composer.setScreenSize(this._textureSize, this._textureSize), this._composer.setNodeMask(0), this._composer.addInternalTexture({
                name: "LightMap1",
                immuable: !0,
                srgb: !1,
                reusable: !1
            }), this._composer.addInternalTexture({
                name: "FinalTexture1",
                immuable: !0,
                srgb: !1,
                reusable: !1
            }), this._composer.setInputTexture("LightMap1"), _.addShaders({
                "blurBakedAo.glsl": d.a
            });
            var e = [],
                t = S.Uniform.createFloat(1 / this._textureSize, "uInvTextureSize");
            e.push({
                func: {
                    name: "adaptativeBoxBlur",
                    file: "blurBakedAo.glsl"
                },
                uniforms: [t],
                textures: {
                    name: "LightMap1",
                    uniformName: "TextureBlur"
                },
                out: {
                    name: "FinalTexture1",
                    filter: "linear"
                }
            }), this._composer.build(e);
            for (var i = 0; i < this._composer.getCameras().length; i++) {
                this._composer.getCameras()[i].setRenderOrder(S.Camera.PRE_RENDER, 1)
            }
        },
        _getLastComposerCamera: function () {
            var e = this._composer.getCameras();
            return e[e.length - 1]
        },
        initShadowCamera: function () {
            this._shadowCamera = new S.Camera, this._shadowCamera.setName("ShadowCam"), this._shadowCamera.setClearColor(S.vec4.fromValues(1, 1, 1, 1)), this._shadowCamera.setRenderOrder(S.Camera.PRE_RENDER, 0), this._shadowCamera.setReferenceFrame(S.Transform.ABSOLUTE_RF), this._shadowCamera.setViewport(new S.Viewport(0, 0, this._textureSize, this._textureSize)), this._shadowCamera.setNodeMask(0), this._shadowCamera.setComputeNearFar(!1);
            var e = new S.Texture;
            e.setTextureSize(this._textureSize, this._textureSize), e.setMinFilter("LINEAR"), e.setMagFilter("LINEAR"), this._shadowCamera.attachTexture(S.FrameBufferObject.COLOR_ATTACHMENT0, e), this._shadowCamera.attachRenderBuffer(S.FrameBufferObject.DEPTH_ATTACHMENT, S.FrameBufferObject.DEPTH_COMPONENT16);
            var t = new S.MatrixTransform;
            t.setMatrix(this._viewer.getFeatures().orientation.getModel().get("matrix")), t.addChild(this._viewer.getRootModel()), this._shadowCamera.addChild(t);
            var i = this._shadowCamera.getOrCreateStateSet();
            i.setTextureAttributeAndModes(0, e, S.StateAttribute.ON), i.setShaderGeneratorName("shadow-ao-bake"), i.setAttributeAndModes(r.a.DEPTH_LESS_WRITE, S.StateAttribute.ON | S.StateAttribute.OVERRIDE | S.StateAttribute.PROTECTED), this._shadowMap = e
        },
        initLightMapCamera: function () {
            this._lightMapCamera = new S.Camera, this._lightMapCamera.setName("LightMapCam"), this._lightMapCamera.setClearColor(S.vec4.fromValues(1, 1, 1, 1)), this._lightMapCamera.setRenderOrder(S.Camera.PRE_RENDER, 1), this._lightMapCamera.setReferenceFrame(S.Transform.ABSOLUTE_RF), this._lightMapCamera.setViewport(new S.Viewport(0, 0, this._textureSize, this._textureSize)), this._lightMapCamera.setNodeMask(0), this._lightMapCamera.setComputeNearFar(!1), this._lightMap1 = this._composer.getInternalTexture("LightMap1"), this._lightMap1.setMinFilter("LINEAR"), this._lightMap1.setMagFilter("LINEAR"), this._lightMapCamera.attachTexture(S.FrameBufferObject.COLOR_ATTACHMENT0, this._lightMap1), this._lightMap2 = new S.Texture, this._lightMap2.setTextureSize(this._textureSize, this._textureSize), this._lightMap2.setMinFilter("LINEAR"), this._lightMap2.setMagFilter("LINEAR"), this._lightMapCamera.addChild(this._targetNode);
            var e = this._lightMapCamera.getOrCreateStateSet();
            e.setAttributeAndModes(l.a.createShader(p.a, g.a, "ground-bakeao", "GroundBakeAo"), S.StateAttribute.ON | S.StateAttribute.OVERRIDE | S.StateAttribute.PROTECTED), e.setTextureAttributeAndModes(1, this._shadowMap, S.StateAttribute.ON), e.addUniform(S.Uniform.createInt(1, "uShadowMap")), e.setTextureAttributeAndModes(2, u.a.dummyTexture, S.StateAttribute.ON), e.addUniform(S.Uniform.createInt(2, "uPrevLightMap")), this._uNumFrames = S.Uniform.createFloat(0, "uNumFrames"), e.addUniform(this._uNumFrames), this._uTextureSize = S.Uniform.createFloat(this._textureSize, "uTextureSize"), e.addUniform(this._uTextureSize), this._currentlightMap = this._lightMap2
        },
        swapLightMaps: function () {
            var e = this._lightMapCamera.getOrCreateStateSet();
            this._currentlightMap && e.setTextureAttributeAndModes(2, this._currentlightMap, S.StateAttribute.ON), this._currentlightMap === this._lightMap1 ? this._currentlightMap = this._lightMap2 : this._currentlightMap = this._lightMap1, e.setTextureAttributeAndModes(0, this._currentlightMap, S.StateAttribute.ON), this._lightMapCamera.attachTexture(S.FrameBufferObject.COLOR_ATTACHMENT0, this._currentlightMap)
        },
        setSceneData: function (e, t) {
            this._bounds = e, this._transform = t
        },
        updateCameras: function () {
            var e = S.mat4.create(),
                t = S.vec3.create(),
                i = S.vec3.create();
            return function () {
                var n = this._bounds.radius();
                S.mat4.getTranslation(t, this._transform.getMatrix()), S.mat4.copy(e, S.mat4.IDENTITY), this.getRandomPoint(i), S.vec3.scale(i, i, n), S.vec3.add(i, t, i), S.mat4.lookAt(e, i, t, [0, 0, 1]);
                var r = 2 * n,
                    a = r / 1e3;
                S.mat4.ortho(this._shadowCamera.getProjectionMatrix(), -n, n, -n, n, a, r), S.mat4.copy(this._shadowCamera.getViewMatrix(), e), S.mat4.copy(this._lightMapCamera.getViewMatrix(), this._shadowCamera.getViewMatrix()), S.mat4.copy(this._lightMapCamera.getProjectionMatrix(), this._shadowCamera.getProjectionMatrix())
            }
        }(),
        getRandomPoint: function (e) {
            var t = o.a.hemisphereSampleUniform(this._nbFrames, this._nbSamples * (1 / this._samplingRange));
            S.vec3.set(e, t[0], t[1], t[2])
        }
    }, t.a = x
}, function (e, t) {
    e.exports = '#pragma include "utils/encodeDecode.glsl"\n\nuniform float uInvTextureSize;\n\nvec4 adaptativeBoxBlur(){\n    float ao = decode24(TEXTURE_2D_TextureBlur(gTexCoord).rgb);\n    float kernel = 3.0;\n\n    if (ao < 0.2 ){\n        float o = 0.2;\n        ao += decode24(TEXTURE_2D_TextureBlur(gTexCoord + vec2(-o, o) * uInvTextureSize).rgb);\n        ao += decode24(TEXTURE_2D_TextureBlur(gTexCoord + vec2(o, o) * uInvTextureSize).rgb);\n        ao += decode24(TEXTURE_2D_TextureBlur(gTexCoord + vec2(o, -o) * uInvTextureSize).rgb);\n        ao += decode24(TEXTURE_2D_TextureBlur(gTexCoord + vec2(-o, -o) * uInvTextureSize).rgb);\n        ao *= 0.2;\n        return vec4(ao, ao, ao, 1.0);\n    }\n\n    ao = 0.0;\n\n    // webgl 1.0 goodness, only constant bounds for for loops iteration.\n    if (ao < 0.4 ){\n        kernel = 3.0;\n        for (float i = -1.0; i <= 1.0; i++){\n            for (float j = -1.0; j <= 1.0; j++){\n                ao += decode24(TEXTURE_2D_TextureBlur(gTexCoord + vec2(i, j) * uInvTextureSize).rgb);\n            }\n        }\n    } else if (ao < 0.6 ){\n        kernel = 7.0;\n        for (float i = -3.0; i <= 3.0; i++){\n            for (float j = -3.0; j <= 3.0; j++){\n                ao += decode24(TEXTURE_2D_TextureBlur(gTexCoord + vec2(i, j) * uInvTextureSize).rgb);\n            }\n        }\n    } else if (ao < 0.8 ){\n        kernel = 9.0;\n        for (float i = -4.0; i <= 4.0; i++){\n            for (float j = -4.0; j <= 4.0; j++){\n                ao += decode24(TEXTURE_2D_TextureBlur(gTexCoord + vec2(i, j) * uInvTextureSize).rgb);\n            }\n        }\n    } else if(ao < 1.0 ){\n        kernel = 11.0;\n        for (float i = -5.0; i <= 5.0; i++){\n            for (float j = -5.0; j <= 5.0; j++){\n                ao += decode24(TEXTURE_2D_TextureBlur(gTexCoord + vec2(i, j) * uInvTextureSize).rgb);\n            }\n        }\n    }\n\n    ao /= kernel * kernel;\n\n    return vec4(ao, ao, ao, 1.0);\n}\n'
}, function (e, t) {
    e.exports = "attribute vec2 TexCoord0;\nattribute vec3 Vertex;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec4 vProjCoord;\n\nvoid main(void) {\n  gl_Position = vec4(TexCoord0 * 2.0 - 1.0, 0.0, 1.0);\n  vProjCoord = uModelViewMatrix * vec4(Vertex.xyz, 1.0);\n  vProjCoord = uProjectionMatrix * vProjCoord;\n  vProjCoord = vProjCoord / vProjCoord.w * 0.5 + 0.5;\n}\n"
}, function (e, t) {
    e.exports = "#pragma include \"utils/encodeDecode.glsl\"\n\nuniform sampler2D uShadowMap;\nuniform sampler2D uPrevLightMap;\nuniform float uNumFrames;\nuniform float uTextureSize;\n\nvarying vec4 vProjCoord;\n\nvec4 accumulateShadow(const in vec4 projCoord, const in sampler2D shadowMap, const in sampler2D prevLightMap, const in float numFrames, const in float textureSize ){\n    float depth = decode24(texture2D(shadowMap, projCoord.xy).rgb);\n    float prevShadow = decode24(texture2D(prevLightMap, gl_FragCoord.xy / textureSize).rgb);\n\n\n    // here should be step (projCoord.z, depth) for proper comparison.\n    // but I still have some precision issue I can't sort out for now\n    // step (1.0, depth) is actually putting shadows everywhere the depth has been written, even when behind the ground\n    // It's only a problem for scenes that already have a ground geometry that has been made transparent,\n    // has the shader doesnt take opacity into account.\n    float currentShadow = step (1.0, depth);\n\n    // limits of light frustum\n    if (any(bvec4 ( projCoord.x > 1., projCoord.x < 0., projCoord.y > 1., projCoord.y < 0.))) {\n       currentShadow = 1.0;\n    }\n\n    float s = mix(prevShadow , currentShadow, 1.0 / numFrames);\n    return vec4(encode24(s),1.0);\n}\n\n\nvoid main(void) {\n    gl_FragColor = accumulateShadow(vProjCoord, uShadowMap, uPrevLightMap, uNumFrames, uTextureSize);\n}\n"
}, , , , , , , function (e, t, i) {
    "use strict";
    var n = i(5),
        r = i.n(n),
        a = i(3),
        o = i.n(a),
        s = i(0),
        u = (i.n(s), i(14)),
        l = i(4),
        c = i(9),
        h = i(599),
        d = i(8),
        f = i(34),
        p = i(637),
        m = i(130),
        g = c.a.osg;
    t.a = d.a.extend({
        savingEnabled: !1,
        constructor: function () {
            this.onSave = Object(s.throttle)(this.onSave, 1e3), d.a.apply(this, arguments)
        },
        initialize: function () {
            d.a.prototype.initialize.apply(this, arguments), o()(".save-model").click(this.onSave.bind(this));
            var e = this.options.context;
            this._features = e.getFeatures();
            var t = e.getModel();
            t && !this.maintenance && (this.listenTo(t, "status:loaded", this.enableSaving.bind(this)), this.listenTo(t, "status:pending", this.disableSaving.bind(this)))
        },
        onSave: function (e) {
            e.preventDefault(), m.a.isMaintenance() ? m.a.showPopup() : this.save()
        },
        save: function () {
            var e = this._features.inspector.getModel(),
                t = e.get("displayView");
            e.set("displayView", "Default");
            var i = this._save();
            return i.finally(function () {
                e.set("displayView", t)
            }), i
        },
        _save: function () {
            if (!this.savingEnabled) return r.a.reject(new Error("Model is still loading. Please try to save again later."));
            if (o()(".save-model").hasClass("progress")) return r.a.reject(new Error("Already saving previous changes. Please try to save again later."));
            o()(".save-model").addClass("progress");
            var e = this.options.context.getModel().get("uid"),
                t = this.options.context.getModel().get("user").uid,
                i = {
                    modelUID: e,
                    userUID: t
                },
                n = this,
                a = [];
            return this.cancelSave = !1, r.a.all(Object(s.map)([this.saveBackgroundImages(i, a), this.saveMaterialImages(i, a), this.saveTexturesColorspace(i, a), this.saveHotspots(i, a), this.saveAnimations(i, a), this.saveSounds(i, a), this.saveGroundTexture(i, a)], function (e) {
                return e.reflect()
            })).then(function () {
                return a.length > 0 || this.cancelSave ? r.a.reject(new Error) : n.saveOptions()
            }.bind(this)).then(function () {
                return a.length > 0 ? r.a.reject(new Error) : r.a.all(Object(s.map)([n.deleteTextures(a), n.deleteMatcaps(a), n.deleteBackgroundImages(a), n.deleteAnimations(a), n.deleteEnvironments(a), n.deleteGroundTexture(a)], function (e) {
                    return e.reflect()
                }))
            }).then(function () {
                if (a.length > 0) return r.a.reject(new Error);
                o()(".save-model").removeClass("progress"), o()(".save-model").addClass("success"), setTimeout(function () {
                    o()(".save-model").removeClass("success")
                }, 4e3)
            }.bind(this)).catch(function (e) {
                if (o()(".save-model").removeClass("progress"), e && 503 === e.status) m.a.showPopup();
                else {
                    if (this.cancelSave) return;
                    var t = "";
                    if (a.length) t = a.join("<br/>");
                    else {
                        if (t = "An unexpected error happened while saving the following settings : <br/><ul>", e && e.responseJSON && e.responseJSON.detail) {
                            var i = e.responseJSON.detail;
                            g.error(i);
                            var n = "string" == typeof i ? {
                                "": [i]
                            } : i;
                            for (var r in n) t += "<li>&bullet; " + (r ? r + ": " : "") + n[r].join(", ") + "</li>"
                        }
                        t += "</ul>"
                    }
                    t += '<br/>Contact our support team <a href="' + u.a.hosts.faq + '/requests/new?type=3d_viewing&utm_source=website&utm_campaign=save_error" target="_blank">here</a> if you need help.';
                    var s = new f.default({
                        title: "Error",
                        text: t,
                        buttons: {
                            ok: !0
                        },
                        safe: !0
                    });
                    s.open().then(s.close.bind(s))
                }
            }.bind(this))
        },
        deleteUnusedResources: function (e, t, i) {
            if (0 === e.length) return r.a.resolve();
            var n = "Errors while deleting the following " + t + " :<br/><ul>",
                a = !1,
                o = Object(s.map)(e, function (e) {
                    return r.a.resolve(e.destroy()).catch(function (t) {
                        var i = t && t.responseJSON && t.responseJSON.detail;
                        n += "<li>&bullet; " + e.get("name") + " : " + i + "</li>", e.trigger("restore", e), a = !0
                    })
                });
            return e.length = 0, r.a.all(o).then(function () {
                if (a) return i.push(n + "</ul>"), r.a.reject(new Error)
            })
        },
        deleteTextures: function (e) {
            var t = this._features.material.getModel()._textureTrashbin,
                i = Object(s.map)(t, function (e) {
                    return new h.a({
                        uid: e
                    })
                });
            return t.length = 0, this.deleteUnusedResources(i, "material textures", e)
        },
        deleteMatcaps: function (e) {
            var t = this._features.material.getModel()._matcapTrashbin;
            return this.deleteUnusedResources(t, "matcap textures", e)
        },
        deleteAnimations: function (e) {
            var t = this._features.animation.getModel().get("animations")._trashbin;
            return this.deleteUnusedResources(t, "animations", e)
        },
        deleteEnvironments: function (e) {
            var t = this._features.environment.getModel()._trashbin;
            return this.deleteUnusedResources(t, "environments", e)
        },
        deleteBackgroundImages: function (e) {
            var t = this._features.background.getModel()._trashbin;
            return this.deleteUnusedResources(t, "backgrounds", e)
        },
        deleteGroundTexture: function (e) {
            var t = this._features.ground.getModel()._trashbin;
            return this.deleteUnusedResources(t, "ground", e)
        },
        saveBackgroundImages: function (e, t) {
            var i = this,
                n = [];
            return this._features.background.getModel().backgroundCollection.each(function (r) {
                if (r.isNew()) {
                    var a = i.saveImage(r, e);
                    a.catch(function (e) {
                        var i = 0;
                        if (e.responseJSON.detail.imageFile)
                            for (i = 0; i < e.responseJSON.detail.imageFile.length; i++) e.responseJSON.detail.imageFile[i].match("The image should be less than 4mb") && t.push("Background image is too big (max: 4MB)")
                    }), n.push(a)
                }
            }), r.a.all(n)
        },
        saveGroundTexture: function (e, t) {
            var i = this._features.ground.getModel(),
                n = "BakedAO" === i.get("shadowMode");
            if (i.get("enable") && i.get("dirty") && n) {
                var a = i.get("imageCanvas"),
                    o = Object(p.a)(a.toDataURL("image/jpeg", .95));
                o.name = "internal_ground_ao_texture";
                var s = new h.a({
                        name: o.name,
                        imageFile: o
                    }),
                    u = this.saveImage(s, e);
                return u.then(function () {
                    i.set("aoTextureUid", s.get("uid")), i.set("dirty", !1)
                }), u.catch(function () {
                    t.push("Error while saving the baked AO texture ")
                }), r.a.resolve(u)
            }
            if (!i.get("enable") || !n) {
                var l = i.get("aoTextureUid");
                l && (i._trashbin.push(new h.a({
                    uid: l
                })), i.set("aoTextureUid", void 0))
            }
            return r.a.resolve()
        },
        saveImage: function (e, t) {
            return r.a.resolve(e.save(t).then(function (t) {
                e.set("uid", t.uid)
            }))
        },
        _saveImageToBlob: function (e, t, i, n) {
            var r, a = e.getImageModel(),
                o = e.getMultiresTexture().getImage().getImage();
            if (o.toBlob) {
                var s = this;
                return void o.toBlob(function (e) {
                    e.name = t.name, a.set("imageFile", e), i(s.saveImage(a, n))
                }, t.type, .95)
            }
            if (!o.toDataURL) {
                var u = o;
                if (o = document.createElement("canvas"), void 0 !== u.width) o.width = u.width, o.height = u.height, o.getContext("2d").drawImage(u, 0, 0);
                else {
                    var l = o.getContext("2d"),
                        c = e.getImageModel().getImages()[0];
                    o.width = c.width, o.height = c.height;
                    var h = l.getImageData(0, 0, c.width, c.height);
                    h.data.set(u), l.putImageData(h, 0, 0)
                }
            }
            r = Object(p.a)(o.toDataURL(t.type, .95)), r.name = t.name, a.set("imageFile", r), i(this.saveImage(a, n))
        },
        saveMaterialImages: function (e, t) {
            var i = this,
                n = [],
                a = {},
                o = this._features.material,
                u = "Errors while saving the following texture materials :<br/><ul>",
                l = !1;
            return Object(s.each)(o.getModel().attributes, function (t) {
                var o = t.getChannels();
                Object(s.each)(o, function (t) {
                    var o = t.getTextureModel();
                    if (o) {
                        var s = o.getImageModel();
                        if (s && s.isNew()) {
                            var c = s.getUID();
                            if (1 !== a[c]) {
                                a[c] = 1;
                                var h = new r.a(function (t) {
                                    var n = s.get("imageFile");
                                    if (void 0 === n) {
                                        var r = s.findImageNearestToResolution(16384, 16384),
                                            a = Object(p.a)(r.url);
                                        return s.set("imageFile", a), void t(i.saveImage(s, e))
                                    }
                                    if (0 === n.size) i._saveImageToBlob(o, n, t, e);
                                    else if (window.File) {
                                        var u = new FileReader;
                                        u.onload = function () {
                                            this.readyState === FileReader.DONE ? t(i.saveImage(s, e)) : i._saveImageToBlob(o, n, t, e)
                                        }, u.onerror = function () {
                                            i._saveImageToBlob(o, n, t, e)
                                        }, u.readAsArrayBuffer(n)
                                    }
                                });
                                n.push(h.catch(function (e) {
                                    var t = e && e.responseJSON && e.responseJSON.detail;
                                    u += "<li>&bullet; " + s.getName() + " : " + t + "</li>", l = !0
                                }))
                            }
                        }
                    }
                })
            }), r.a.all(n).then(function () {
                if (l) return t.push(u + "</ul>"), r.a.reject(new Error)
            })
        },
        saveOptions: function () {
            var e = this.options.context,
                t = e.getViewer(),
                i = t.getOptionsJSON();
            if (t.getFeaturesManager().registerOptionsJSON(i), i.animation)
                for (var n = this._features.animation.getModel().get("animations")._trashbin, a = 0; a < n.length; a++) n[a] && i.animation.order.splice(a, 0, n[a].get("uid"));
            return r.a.resolve(e.getModel().save({
                options: i
            }, {
                patch: !0
            }))
        },
        saveHotspot: function (e, t, i) {
            return e.save(t).catch(function (t) {
                if (i.push("Annotation #" + (+e.get("order") + 1) + " could not be saved."), t.responseJSON && t.responseJSON.detail) {
                    var n = 0;
                    if (t.responseJSON.detail.name)
                        for (n = 0; n < t.responseJSON.detail.name.length; n++) t.responseJSON.detail.name[n].match("This field is required.") && i.push("Title is required."), t.responseJSON.detail.name[n].match("Ensure this value has at most 64 characters") && i.push("Title is too long (64 characters max).");
                    if (t.responseJSON.detail.content)
                        for (n = 0; n < t.responseJSON.detail.content.length; n++) t.responseJSON.detail.content[n].match("Ensure this value has at most 1024 characters") && i.push("Description is too long (1024 characters max).")
                }
            })
        },
        deleteHotspot: function (e, t, i, n) {
            return e.remove(t).catch(function () {
                n.push(e), i.push("An annotation could not be deleted. Please try saving your settings again.")
            })
        },
        saveHotspots: function (e, t) {
            var i = this._features.hotspot,
                n = i.getModel(),
                a = n.get("hotspots"),
                o = this.options.context.getModel().get("user").account,
                c = u.a.maxHotspotsPerModel[o],
                h = a.length - c;
            if (a.length > c) {
                var d = "You have reached the maximum number of annotations allowed by your plan (" + c + ").";
                return l.a.me().canUpgradePlan() && (d += 1 === h ? '<br>Delete the last annotation you created or <a class="upgrade-link underlined" href="/plans" data-title="maximum-annotation-upgrade" target="_blank">upgrade your account</a>.' : "<br>Delete the " + h + ' last annotations you created or <a class="upgrade-link underlined" href="/plans" data-title="maximum-annotation-upgrade" target="_blank">upgrade your account</a>.'), n.trigger("hotspot-error", new Error(d)), this.cancelSave = !0, r.a.reject()
            }
            var f = !1;
            if (a.each(function (e) {
                    e.get("name") || (f = !0)
                }), f) return n.trigger("hotspot-error", new Error("All your annotations must have a title")), this.cancelSave = !0, r.a.reject();
            var p = [],
                m = [],
                g = this;
            return Object(s.each)(n.hotspotsToBeDeleted, function (i) {
                p.push(g.deleteHotspot(i, e, t, m))
            }), n.hotspotsToBeDeleted = m, r.a.all(p).then(function () {
                var i = [];
                return a.each(function (n) {
                    n.set("order", a.indexOf(n)), i.push(g.saveHotspot(n, e, t))
                }), r.a.all(i)
            })
        },
        saveTexturesColorspace: function (e, t) {
            var i = "Errors while changing the following texture colorspace :<br/><ul>",
                n = !1,
                a = [];
            return this.model.getImageCollection().each(function (e) {
                !e.isNew() && e.hasChanged("colorSpace") && a.push(e.saveColorspace().catch(function (t) {
                    var r = t && t.responseJSON && t.responseJSON.detail;
                    i += "<li>&bullet; " + e.get("name") + " : " + r + "</li>", n = !0
                }))
            }), r.a.all(a).then(function () {
                if (n) return t.push(i + "</ul>"), r.a.reject(new Error)
            })
        },
        saveAnimations: function (e, t) {
            var i = this._features.animation,
                n = i.getModel(),
                a = "Errors while saving the following animations :<br/><ul>",
                o = !1,
                s = n.get("animations").map(function (t) {
                    return t.save(e).catch(function (e) {
                        var i = e && e.responseJSON && e.responseJSON.detail;
                        a += "<li>&bullet; " + t.get("name") + " : " + i + "</li>", o = !0
                    })
                });
            return r.a.all(s).then(function () {
                if (o) return t.push(a + "</ul>"), r.a.reject(new Error)
            })
        },
        saveSounds: function (e, t) {
            var i, n = this._features.sound,
                a = n.getModel(),
                o = a.get("soundtracks"),
                s = u.a.maxSoundtracksPerModel[l.a.me().get("account")];
            if (o.length > s) {
                var c = o.length - s;
                return i = ["You have reached the maximum number of sounds allowed by your plan (" + s + ").", "<br>Delete " + c + ' sounds or <a class="upgrade-link underlined" href="/plans" target="_blank">upgrade your account</a>.'].join("\n"), a.trigger("sound-error", new Error(i)), this.cancelSave = !0, r.a.reject()
            }
            var h = !1;
            i = "Errors while saving the following sounds :<br/><ul>";
            var d = r.a.resolve();
            return o.each(function (t) {
                d = d.then(function () {
                    return t.save(e)
                }).catch(function (e) {
                    var n = e && e.responseJSON && e.responseJSON.detail;
                    return n && n.__all__ && (n = n.__all__[0]), n && n.soundFile && (n = n.soundFile[0]), i += "<li>&bullet; " + t.get("name") + " : " + n + "</li>", h = !0, r.a.resolve()
                })
            }), d.then(function () {
                if (h) return t.push(i + "</ul>"), r.a.reject(new Error)
            })
        },
        enableSaving: function () {
            this.savingEnabled = !0, o()(".save-model").removeClass("btn-disabled")
        },
        disableSaving: function () {
            this.savingEnabled = !1, o()(".save-model").addClass("btn-disabled")
        }
    })
}, , , function (e, t, i) {
    var n;
    ! function (r, a, o) {
        function s(e, t, i) {
            if (e.addEventListener) return void e.addEventListener(t, i, !1);
            e.attachEvent("on" + t, i)
        }

        function u(e) {
            if ("keypress" == e.type) {
                var t = String.fromCharCode(e.which);
                return e.shiftKey || (t = t.toLowerCase()), t
            }
            return x[e.which] ? x[e.which] : y[e.which] ? y[e.which] : String.fromCharCode(e.which).toLowerCase()
        }

        function l(e, t) {
            return e.sort().join(",") === t.sort().join(",")
        }

        function c(e) {
            var t = [];
            return e.shiftKey && t.push("shift"), e.altKey && t.push("alt"), e.ctrlKey && t.push("ctrl"), e.metaKey && t.push("meta"), t
        }

        function h(e) {
            if (e.preventDefault) return void e.preventDefault();
            e.returnValue = !1
        }

        function d(e) {
            if (e.stopPropagation) return void e.stopPropagation();
            e.cancelBubble = !0
        }

        function f(e) {
            return "shift" == e || "ctrl" == e || "alt" == e || "meta" == e
        }

        function p() {
            if (!S) {
                S = {};
                for (var e in x) e > 95 && e < 112 || x.hasOwnProperty(e) && (S[x[e]] = e)
            }
            return S
        }

        function m(e, t, i) {
            return i || (i = p()[e] ? "keydown" : "keypress"), "keypress" == i && t.length && (i = "keydown"), i
        }

        function g(e) {
            return "+" === e ? ["+"] : (e = e.replace(/\+{2}/g, "+plus"), e.split("+"))
        }

        function v(e, t) {
            var i, n, r, a = [];
            for (i = g(e), r = 0; r < i.length; ++r) n = i[r], T[n] && (n = T[n]), t && "keypress" != t && C[n] && (n = C[n], a.push("shift")), f(n) && a.push(n);
            return t = m(n, a, t), {
                key: n,
                modifiers: a,
                action: t
            }
        }

        function _(e, t) {
            return null !== e && e !== a && (e === t || _(e.parentNode, t))
        }

        function b(e) {
            function t(e) {
                e = e || {};
                var t, i = !1;
                for (t in S) e[t] ? i = !0 : S[t] = 0;
                i || (C = !1)
            }

            function i(e, t, i, n, r, a) {
                var o, s, u = [],
                    c = i.type;
                if (!g._callbacks[e]) return [];
                for ("keyup" == c && f(e) && (t = [e]), o = 0; o < g._callbacks[e].length; ++o)
                    if (s = g._callbacks[e][o], (n || !s.seq || S[s.seq] == s.level) && c == s.action && ("keypress" == c && !i.metaKey && !i.ctrlKey || l(t, s.modifiers))) {
                        var h = !n && s.combo == r,
                            d = n && s.seq == n && s.level == a;
                        (h || d) && g._callbacks[e].splice(o, 1), u.push(s)
                    } return u
            }

            function n(e, t, i, n) {
                g.stopCallback(t, t.target || t.srcElement, i, n) || !1 === e(t, i) && (h(t), d(t))
            }

            function r(e) {
                "number" != typeof e.which && (e.which = e.keyCode);
                var t = u(e);
                if (t) return "keyup" == e.type && x === t ? void(x = !1) : void g.handleKey(t, c(e), e)
            }

            function o() {
                clearTimeout(_), _ = setTimeout(t, 1e3)
            }

            function p(e, i, r, a) {
                function s(i) {
                    n(r, i, e), "keyup" !== a && (x = u(i)), setTimeout(t, 10)
                }
                S[e] = 0;
                for (var l = 0; l < i.length; ++l) {
                    var c = l + 1 === i.length,
                        h = c ? s : function (t) {
                            return function () {
                                C = t, ++S[e], o()
                            }
                        }(a || v(i[l + 1]).action);
                    m(i[l], h, a, e, l)
                }
            }

            function m(e, t, n, r, a) {
                g._directMap[e + ":" + n] = t, e = e.replace(/\s+/g, " ");
                var o, s = e.split(" ");
                if (s.length > 1) return void p(e, s, t, n);
                o = v(e, n), g._callbacks[o.key] = g._callbacks[o.key] || [], i(o.key, o.modifiers, {
                    type: o.action
                }, r, e, a), g._callbacks[o.key][r ? "unshift" : "push"]({
                    callback: t,
                    modifiers: o.modifiers,
                    action: o.action,
                    seq: r,
                    level: a,
                    combo: e
                })
            }
            var g = this;
            if (e = e || a, !(g instanceof b)) return new b(e);
            g.target = e, g._callbacks = {}, g._directMap = {};
            var _, S = {},
                x = !1,
                y = !1,
                C = !1;
            g._handleKey = function (e, r, a) {
                var o, s = i(e, r, a),
                    u = {},
                    l = 0,
                    c = !1;
                for (o = 0; o < s.length; ++o) s[o].seq && (l = Math.max(l, s[o].level));
                for (o = 0; o < s.length; ++o)
                    if (s[o].seq) {
                        if (s[o].level != l) continue;
                        c = !0, u[s[o].seq] = 1, n(s[o].callback, a, s[o].combo, s[o].seq)
                    } else c || n(s[o].callback, a, s[o].combo);
                var h = "keypress" == a.type && y;
                a.type != C || f(e) || h || t(u), y = c && "keydown" == a.type
            }, g._bindMultiple = function (e, t, i) {
                for (var n = 0; n < e.length; ++n) m(e[n], t, i)
            }, s(e, "keypress", r), s(e, "keydown", r), s(e, "keyup", r)
        }
        if (r) {
            for (var S, x = {
                    8: "backspace",
                    9: "tab",
                    13: "enter",
                    16: "shift",
                    17: "ctrl",
                    18: "alt",
                    20: "capslock",
                    27: "esc",
                    32: "space",
                    33: "pageup",
                    34: "pagedown",
                    35: "end",
                    36: "home",
                    37: "left",
                    38: "up",
                    39: "right",
                    40: "down",
                    45: "ins",
                    46: "del",
                    91: "meta",
                    93: "meta",
                    224: "meta"
                }, y = {
                    106: "*",
                    107: "+",
                    109: "-",
                    110: ".",
                    111: "/",
                    186: ";",
                    187: "=",
                    188: ",",
                    189: "-",
                    190: ".",
                    191: "/",
                    192: "`",
                    219: "[",
                    220: "\\",
                    221: "]",
                    222: "'"
                }, C = {
                    "~": "`",
                    "!": "1",
                    "@": "2",
                    "#": "3",
                    $: "4",
                    "%": "5",
                    "^": "6",
                    "&": "7",
                    "*": "8",
                    "(": "9",
                    ")": "0",
                    _: "-",
                    "+": "=",
                    ":": ";",
                    '"': "'",
                    "<": ",",
                    ">": ".",
                    "?": "/",
                    "|": "\\"
                }, T = {
                    option: "alt",
                    command: "meta",
                    return: "enter",
                    escape: "esc",
                    plus: "+",
                    mod: /Mac|iPod|iPhone|iPad/.test(navigator.platform) ? "meta" : "ctrl"
                }, w = 1; w < 20; ++w) x[111 + w] = "f" + w;
            for (w = 0; w <= 9; ++w) x[w + 96] = w.toString();
            b.prototype.bind = function (e, t, i) {
                var n = this;
                return e = e instanceof Array ? e : [e], n._bindMultiple.call(n, e, t, i), n
            }, b.prototype.unbind = function (e, t) {
                var i = this;
                return i.bind.call(i, e, function () {}, t)
            }, b.prototype.trigger = function (e, t) {
                var i = this;
                return i._directMap[e + ":" + t] && i._directMap[e + ":" + t]({}, e), i
            }, b.prototype.reset = function () {
                var e = this;
                return e._callbacks = {}, e._directMap = {}, e
            }, b.prototype.stopCallback = function (e, t) {
                var i = this;
                return !((" " + t.className + " ").indexOf(" mousetrap ") > -1) && (!_(t, i.target) && ("INPUT" == t.tagName || "SELECT" == t.tagName || "TEXTAREA" == t.tagName || t.isContentEditable))
            }, b.prototype.handleKey = function () {
                var e = this;
                return e._handleKey.apply(e, arguments)
            }, b.addKeycodes = function (e) {
                for (var t in e) e.hasOwnProperty(t) && (x[t] = e[t]);
                S = null
            }, b.init = function () {
                var e = b(a);
                for (var t in e) "_" !== t.charAt(0) && (b[t] = function (t) {
                    return function () {
                        return e[t].apply(e, arguments)
                    }
                }(t))
            }, b.init(), r.Mousetrap = b, void 0 !== e && e.exports && (e.exports = b), void 0 !== (n = function () {
                return b
            }.call(t, i, t, e)) && (e.exports = n)
        }
    }("undefined" != typeof window ? window : null, "undefined" != typeof window ? document : null)
}, function (e, t, i) {
    "use strict";
    var n = i(3),
        r = i.n(n),
        a = i(271),
        o = i(13),
        s = i(0);
    i.n(s);
    t.a = a.a.extend({
        VIEWER_MODE_ORBIT: 0,
        VIEWER_MODE_FPS: 1,
        HOTSPOT_CYCLE_PAUSE: 1e4,
        events: {
            "click .has-menu": "toggleMenu",
            "touchstart .has-menu": "toggleMenuTouch",
            keydown: "onKeydown",
            mousewheel: "onMousewheel",
            "mousedown  .webgl .canvas": "cameraMoveStart",
            "touchstart .webgl .canvas": "cameraMoveStart",
            "mousedown  .webgl": "mouseDownEvent",
            "mouseup    .webgl": "mouseUpEvent",
            "touchstart .webgl": "mouseDownEvent",
            "touchend   .webgl": "mouseUpEvent",
            "mousedown  .fallback": "mouseDownEvent",
            "touchstart .fallback": "mouseDownEvent",
            'click      [data-action="watermark"]': "onWatermarkClick",
            'touchend   [data-action="watermark"]': "onWatermarkClick"
        },
        constructor: function () {
            this.globalCloseEvent = this.globalCloseEvent.bind(this), this.globalMouseUpEvent = this.globalMouseUpEvent.bind(this), this.onKeydown = this.onKeydown.bind(this), a.a.prototype.constructor.apply(this, arguments)
        },
        delegateEvents: function () {
            a.a.prototype.delegateEvents.apply(this, arguments);
            var e = r()(document);
            e.on("keydown", this.onKeydown), e.on("mousedown", this.globalCloseEvent), e.on("mouseup", this.globalMouseUpEvent), e.on("mousewheel.delegateEvents" + this.cid, ".annotation", this.preventScroll)
        },
        undelegateEvents: function () {
            a.a.prototype.undelegateEvents.apply(this, arguments);
            var e = r()(document);
            e.off("keydown", this.onKeydown), e.off("mousedown", this.globalCloseEvent), e.off("mouseup", this.globalMouseUpEvent), e.off("mousewheel.delegateEvents" + this.cid, ".annotation", this.preventScroll)
        },
        enable: function () {
            this.$(".gui").removeClass("hidden"), Object(s.defer)(function () {
                this.$(".gui").addClass("enabled")
            }.bind(this))
        },
        disable: function () {
            this.$(".gui").removeClass("enabled").addClass("hidden")
        },
        closeMenus: function () {
            this.$(".gui").find(".has-menu").removeClass("active"), this.viewer.subviews.generalControls && this.viewer.subviews.generalControls.settings && this.viewer.subviews.generalControls.settings.togglePane(!1)
        },
        cameraMoveStart: function () {
            this.viewer.$(".webgl").addClass("camera-moving"), this.viewer.subviews.hotspots && this.viewer.subviews.hotspots.pauseHotspotCycleInterval()
        },
        cameraMoveEnd: function () {
            this.viewer.$(".webgl").removeClass("camera-moving"), this.viewer.subviews.hotspots && this.viewer.subviews.hotspots._hotspotCycleIntervalPaused && this.viewer.subviews.hotspots.beginHotspotCycleInterval(this.HOTSPOT_CYCLE_PAUSE)
        },
        onMousewheel: function () {
            var e;
            if (this.viewer.scene) {
                var t = this.viewer.scene.getFeatures();
                t.hasOwnProperty("camera") && (e = t.camera.getModel().get("indexManipulator"))
            }
            if (e === this.VIEWER_MODE_FPS) {
                var i = this.viewer.scene.getViewerOSGJS().getManipulator().getCurrentManipulator()._stepFactor,
                    n = Math.round(i / 4 * 100);
                this.viewer.subviews.osd.show("Walking speed: " + n, {
                    duration: 1e3
                })
            }
        },
        onKeydown: function (e) {
            var t = document.activeElement,
                i = "",
                n = ["BODY", "CANVAS"];
            32 === e.which && t && (i = t.tagName, -1 !== n.indexOf(i) && (this.recenter(), e.preventDefault())), e.which >= 96 && e.which <= 105 && this.timeline && this.timeline.setCurrentAnimation(e.which - 96), 27 === e.which && (this.viewer.subviews.hotspots && this.viewer.subviews.hotspots._hotspots.length && (this.viewer.subviews.hotspots.currentHotspot = -1, this.viewer.subviews.hotspots.applyCurrentHotspot(), this.viewer.subviews.hotspots.unrevealHotspots(), this.viewer.subviews.hotspots.stopHotspotCycleInterval()), this.closeMenus(), this.viewer.subviews.helpOverlay.hide())
        },
        preventParentScroll: function (e, t) {
            var i = r()(".hotspot-controls .list"),
                n = i.height(),
                a = i.children()[0].scrollHeight,
                o = i.children()[0].scrollTop;
            (o === a - n && t < 0 || 0 === o && t > 0) && e.preventDefault()
        },
        preventScroll: function (e) {
            e.preventDefault()
        },
        globalMouseUpEvent: function () {
            this.cameraMoveEnd()
        },
        globalCloseEvent: function (e) {
            r()(e.target).hasClass("has-menu") || r()(e.target).parents(".has-menu").length || this.closeMenus(e)
        },
        toggleMenuTouch: function (e) {
            if ("label" === e.target.tagName.toLowerCase()) return e;
            e.preventDefault(), e.stopPropagation(), this.toggleMenu(e)
        },
        toggleMenu: function (e) {
            if ("label" === e.target.tagName.toLowerCase()) return e;
            e.preventDefault(), e.stopPropagation();
            var t = r()(e.currentTarget);
            t.hasClass("active") ? e.currentTarget === e.target && t.attr("data-title", t.attr("title")).removeClass("active") : (this.closeMenus(), t.attr("title", t.attr("data-title")).removeAttr("data-title").addClass("active"))
        },
        renderSetting: function (e, t) {
            this.viewer.$('[data-setting="' + e + '"]').removeClass("active"), "wireframeColor" === e && !1 === this.viewer.proxySettings.get("wireframeEnable") || this.viewer.$('[data-setting="' + e + '"][data-value="' + t + '"]').addClass("active")
        },
        getPointerPosition: function (e) {
            var t, i = e.originalEvent ? e.originalEvent : e,
                n = {};
            return i.touches && i.touches.length || i.changedTouches && i.changedTouches.length ? (t = i.touches && i.touches.length ? i.touches : i.changedTouches, t = t[0], n.x = t.pageX, n.y = t.pageY, n.type = "Touch") : (n.x = e.pageX, n.y = e.pageY, n.type = "Mouse"), n
        },
        mouseDownEvent: function (e) {
            this.mouseDownPosition = this.getPointerPosition(e), this.viewer.subviews.hint.hide(), "touchstart" === e.type && (e.target === e.currentTarget || this.scene && this.scene.getCanvas && e.target === this.viewer.scene.getCanvas()) && e.preventDefault()
        },
        mouseUpEvent: function (e) {
            if (this.mouseDownPosition) {
                var t = this.getPointerPosition(e);
                if (this.viewer.$el.hasClass("started")) {
                    if (Math.abs(this.mouseDownPosition.x - t.x) > 20 || Math.abs(this.mouseDownPosition.y - t.y) > 20) {
                        var i = this.viewer._currentModel ? this.viewer._currentModel.get("uid") : this.viewer._currentUid;
                        o.a.modelEmbedModelInteraction(i, t.type)
                    }
                    this.mouseDownPosition = null
                }
            }
        },
        recenter: function () {
            this.viewer.scene && this.viewer.scene.getViewerOSGJS().getManipulator().computeHomePosition()
        },
        onWatermarkClick: function () {
            var e = r()(".watermark").find("a").attr("href"),
                t = e.split("models/").pop().split("/")[0];
            o.a.modelEmbedWatermarkClicked(t)
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(7),
        r = i.n(n),
        a = i(9),
        o = i(271),
        s = i(424),
        u = i.n(s),
        l = i(20),
        c = i(1),
        h = i(105),
        d = a.a.osg,
        f = new u.a({
            device: "VWR"
        });
    t.a = o.a.extend({
        optionTypes: {
            color: c.b.string
        },
        initialize: function () {
            o.a.prototype.initialize.apply(this, arguments), this.options = r()({}, this.options, {
                color: this.options.color || h.a.skfbBlue
            })
        },
        reset: function () {
            this._primaryProgress = 0, this._secondaryProgress = 0
        },
        handleLoading: function (e) {
            e.scene.on("primary-progress", function (e) {
                if (this.setPrimaryProgress(e.progress), Object(l.a)().isApp) {
                    var t = f.createMessage({
                        data: {
                            progress: e.progress + ""
                        }
                    });
                    this.previousMessage && this.previousMessage.removeFromHash(), t.appendToHash(), this.previousMessage = t
                }
            }.bind(this)), e.scene.on("secondary-progress", function (e) {
                this.setSecondaryProgress(e.progress)
            }.bind(this)), e.scene.on("success", function () {
                this.viewer.$el.removeClass("model-loading").addClass("model-loaded"), e.model.trigger("status:loaded"), this.trigger("loaded")
            }.bind(this)), e.scene.on("fail", function () {
                d.error("Viewer instanciation failed")
            }.bind(this))
        },
        setPrimaryProgress: function (e) {
            this._primaryProgress = Math.min(Math.max(this._primaryProgress, e), 1), this.updateMainProgressBar(), 1 === this._primaryProgress && this.setSecondaryProgress(0)
        },
        setSecondaryProgress: function (e) {
            this._secondaryProgress = Math.min(Math.max(0, e), 1), this.updateSecondaryProgressBar()
        },
        updateMainProgressBar: function () {
            var e = this._primaryProgress,
                t = 1 === e;
            this.$(".main-progress").toggleClass("loading", !t), this.$(".main-progress-display__progress").css({
                width: 100 * e + "%",
                backgroundColor: this.options.color
            }), this.$(".main-progress-percentage").text(Math.floor(100 * e) + " %")
        },
        updateSecondaryProgressBar: function () {
            var e = this._secondaryProgress;
            this.$(".secondary-progress-percentage").text(Math.floor(100 * e) + " %"), this.$(".secondary-progress-display").css("width", 100 * e + "%");
            var t = 1 === this._primaryProgress,
                i = 1 === e;
            this.$(".secondary-progress").toggleClass("visible", t && !i)
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(38),
        r = i.n(n),
        a = i(0),
        o = (i.n(a), i(271)),
        s = i(53),
        u = i(20);
    t.a = o.a.extend({
        initialize: function () {
            o.a.prototype.initialize.apply(this, arguments), this.$hint = this.$(".viewer-hint"), this.$hint.find(".viewer-movehint .label").html(this.moveHintTemplate()), this.options.fallback && this.$hint.addClass("fallback-position")
        },
        show: function (e) {
            e = Object(a.defaults)(Object(a.extend)({}, e), {
                force: !1
            });
            var t = 1 === s.a.get("sf_show_viewer_hint", 1),
                i = Object(u.a)().uiHint;
            2 === i && (e.force = !0), (e.force || 1 === i && t) && this.$hint.addClass("active")
        },
        hide: function (e) {
            e = Object(a.defaults)(Object(a.extend)({}, e), {
                remember: !0
            }), this.$hint.removeClass("active"), e.remember && s.a.set("sf_show_viewer_hint", 0, {
                expires: 15552e6
            })
        },
        moveHintTemplate: function () {
            return r.a.any ? "touch &amp; drag<br>to rotate" : "click &amp; hold<br>to rotate"
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(3),
        r = i.n(n),
        a = i(0),
        o = (i.n(a), i(106)),
        s = i(13),
        u = i(271),
        l = Object(a.template)(['<div class="setting" data-setting="<%= name %>" data-setting-group="<%= group %>">', '   <p class="setting-label"><%= label %></p>', "</div>"].join("")),
        c = Object(a.template)(['<div class="setting" data-setting="<%= name %>" data-setting-group="<%= group %>" data-setting-type="<%= type %>">', '   <p class="setting-label"><%= label %></p>', '   <p class="setting-value" data-value="<%= value %>" ><%= prettyValue %></p>', "</div>"].join("")),
        h = Object(a.template)(['   <a class="control-menu-back back">Back</a>', '   <ul class="setting-list" data-setting="<%= name %>" data-setting-type="<%= type %>">', "       <%= listItems %>", "   </ul>"].join("")),
        d = Object(a.template)(['<li class="setting-item <% if (selected) { %>selected<% } %>" data-value="<%= value %>">', "   <%= prettyValue %>", '   <span class="shortcut" title="Keyboard shortcut"><%= shortcut %></span>', "</li>"].join(""));
    t.a = u.a.extend({
        events: {
            "click .setting": "onSettingClick",
            "touchend .setting": "onSettingClick",
            "click .back": "togglePane",
            "touchend .back": "togglePane",
            "click .setting-item": "onSettingValueClick",
            "touchend .setting-item": "onSettingValueClick",
            'click [data-setting="viewerMode"] li': "onViewerModeChange",
            'touchend [data-setting="viewerMode"] li': "onViewerModeChange"
        },
        initialize: function (e) {
            if (u.a.prototype.initialize.apply(this, arguments), this.settings = e.settings, this.viewer = e.viewer, Object(a.isEmpty)(this.settings)) return console.warn("No settings object given to SettingsMenu"), void this.$el.hide();
            this.$list = this.$(".control-menu-list"), this.$pane = this.$(".control-menu-pane"), this.$el.on("click touchend", '.wireframe-colors a[data-setting="wireframeColor"]:not(.active)', this.onWireframeColorClick.bind(this)), this.$el.on("click touchend", '.wireframe-colors a[data-setting="wireframeColor"].active', this.onDisableWireframeClick.bind(this)), this.$el.on("click touchend", '.wireframe-colors a[data-setting="wireframeEnable"]', this.onDisableWireframeClick.bind(this)), this.viewer.proxySettings.on("change", this.render.bind(this))
        },
        onViewerModeChange: function (e) {
            e && "touchend" === e.type && e.preventDefault(), "0" === this.viewer.proxySettings.get("viewerMode") ? this.viewer.subviews.osd.show("Click and hold to rotate", {
                position: "top",
                duration: 3e3
            }) : this.viewer.subviews.osd.show("Mouse to look around, keyboard to move", {
                position: "top",
                duration: 3e3
            })
        },
        onDisableWireframeClick: function (e) {
            e && "touchend" === e.type && e.preventDefault();
            var t = this.$('.wireframe-colors [data-setting="wireframeEnable"]');
            s.a.modelViewerWireframeToggleClicked(!1), this.viewer.proxySettings.set("wireframeEnable", !1), t.parent().find(".active").removeClass("active"), t.addClass("active")
        },
        onWireframeColorClick: function (e) {
            e && "touchend" === e.type && e.preventDefault();
            var t = r()(e.currentTarget),
                i = t.attr("data-value");
            this.viewer.proxySettings.set("wireframeColor", i), this.viewer.proxySettings.set("wireframeEnable", !0), t.parent().find(".active").removeClass("active"), t.addClass("active"), s.a.modelViewerWireframeColorSelected(i)
        },
        onSettingClick: function (e) {
            e && "touchend" === e.type && e.preventDefault && e.preventDefault();
            var t = r()(e.currentTarget).attr("data-setting"),
                i = this.settings[t];
            if (i.name = t, i.isButton) return this[i.action] && this[i.action](e);
            this.renderSettingPane(i), this.togglePane(!0)
        },
        onSettingValueClick: function (e) {
            e.preventDefault(), e.stopPropagation();
            var t = r()(e.currentTarget),
                i = t.attr("data-value"),
                n = t.closest("[data-setting]"),
                a = n.attr("data-setting"),
                o = n.attr("data-setting-type") || "string";
            switch (a) {
                case "shadingStyle":
                    s.a.modelViewerShadingSelected(i);
                    break;
                case "viewerMode":
                    s.a.modelViewerViewerModeSelected(i)
            }
            switch (o) {
                case "number":
                    i = parseFloat(i);
                    break;
                case "bool":
                    i = "true" === i
            }
            this.viewer.proxySettings.set(a, i)
        },
        onSettingChangeWhileOpen: function () {
            this.renderSettingPane(this._currentSetting)
        },
        renderSettingPane: function (e) {
            var t = "",
                i = "",
                n = this.viewer.proxySettings.get(e.name),
                r = this.getSettingFromValue(e.name, n),
                o = this.viewer._currentModel.get("options").shading.type;
            this._currentSetting && this.viewer.proxySettings.off("change:" + this._currentSetting.name, this.onSettingChangeWhileOpen, this), this._currentSetting = e, this._currentSetting && this.viewer.proxySettings.on("change:" + this._currentSetting.name, this.onSettingChangeWhileOpen, this), "shadingStyle" === e.name && "lit" !== o || Object(a.each)(e.settings, function (e) {
                t += d({
                    value: e.value,
                    type: e.type || "string",
                    prettyValue: e.label,
                    selected: r === e,
                    shortcut: e.shortcut || ""
                })
            }), i = (e.paneTemplate || h)({
                listItems: t,
                name: e.name,
                type: e.type || "string",
                viewerSettings: this.viewer.proxySettings.toJSON()
            }), this.$pane.html(i);
            var s = this.viewer.scene.getFeatures().webVR.getModel();
            "viewerMode" !== this._currentSetting.name || s.get("hasNativeHMD") ? this.$('[data-value="2"]').show() : this.$('[data-value="2"]').hide()
        },
        getSettingFromValue: function (e, t) {
            var i;
            return (this.settings[e].settings || []).forEach(function (e) {
                e.value !== t && e.value + "" != t + "" || (i = e)
            }), i
        },
        togglePane: function (e, t) {
            var i = this;
            t && "touchend" === t.type && t.preventDefault(), this.$el.toggleClass("detail", e), Object(o.a)(this.$(".control-menu-wrapper")).then(function () {
                i.$el.hasClass("detail") || i.clearPane()
            })
        },
        clearPane: function () {
            this.$pane.html("")
        },
        render: function () {
            var e = "",
                t = this.viewer.scene.getFeatures().quality.getModel(),
                i = this.viewer.scene.getFeatures().hotspot.getModel(),
                n = this.viewer.scene.getFeatures().animation.getModel(),
                r = [];
            Object(a.each)(this.settings, function (e, t) {
                var i = Object(a.clone)(e);
                i.name = t, r.push(i)
            }), r = Object(a.sortBy)(r, "order"), Object(a.each)(r, function (t) {
                var i, n = t.name;
                if (t.isButton) i = l({
                    name: n,
                    label: t.label,
                    group: t.group
                });
                else {
                    var r = this.getSettingFromValue(n, this.viewer.proxySettings.get(n)) || t.settings[0];
                    i = c({
                        name: n,
                        label: t.label,
                        value: r.value,
                        prettyValue: r.label,
                        group: t.group,
                        type: r.type
                    })
                }
                e += i
            }.bind(this)), this.$list.html(e), u.a.prototype.render.apply(this, arguments), n && n.get("animations").length ? this.$('[data-setting-group="animation"]').show() : this.$('[data-setting-group="animation"]').hide(), t && t.get("promiseReady").isFulfilled() ? this.$('[data-setting-group="textureQuality"]').show() : this.$('[data-setting-group="textureQuality"]').hide(), i && i.get("hotspots").length ? this.$('[data-setting-group="annotation"]').show() : this.$('[data-setting-group="annotation"]').hide(), t && t.get("promiseReady").isFulfilled() && window.requestAnimationFrame(function () {
                var e = this.getSettingFromValue("textureQuality", t.get("level"));
                this.$('[data-setting="textureQuality"] .setting-value').attr("data-value", e.value).text(e.label)
            }.bind(this))
        },
        onTextureQualityReady: function (e) {
            var t = this.viewer.scene.getFeatures().quality;
            if (t) {
                if (!e.low && !e.mid && !e.high) return void this.$('[data-setting="textureQuality"]').remove();
                var i = t.getModel(),
                    n = i.get("level");
                this.viewer.proxySettings.set("textureQuality", n), this.render()
            }
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(271);
    t.a = n.a.extend({
        events: {
            "click .close": "close"
        },
        close: function (e) {
            e && e.preventDefault && e.preventDefault()
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(5)),
        a = i.n(r),
        o = i(9),
        s = i(271),
        u = i(994),
        l = i(993),
        c = i(34),
        h = i(637),
        d = o.a.osg;
    t.a = s.a.extend({
        events: {
            "mouseover .snapshot .button": "showGuides",
            "mouseout .snapshot .button": "hideGuides"
        },
        initialize: function () {
            s.a.prototype.initialize.apply(this, arguments), this.$el.find(".snapshot .button").on("click", this.onSnapshot.bind(this))
        },
        onSnapshot: function (e) {
            var t = this.viewer.scene;
            e.preventDefault();
            var i = this.$el.find(".snapshot"),
                n = this.$el.find(".snapshot-flash"),
                r = this.$el.find(".img-container");
            if (!i.hasClass("progress")) {
                i.addClass("progress"), n.addClass("active"), setTimeout(function () {
                    n.removeClass("active")
                }, 2e3);
                var o = !0,
                    s = t.getFeatures();
                if (s.camera) {
                    s.camera.getModel().saveCameraPosition();
                    var u = t.getFeatures().saveUI;
                    u || (u = new l.a, u.init(t.getFeaturesManager()._context), u._views[0].enableSaving()), o = u._views[0].save()
                }
                a.a.all([t.getScreenShot(1920, 1080), o]).then(this.onTakeScreenshot.bind(this, i, r))
            }
        },
        onTakeScreenshot: function (e, t, i) {
            var n = i[0],
                r = n.toDataURL("image/jpeg"),
                a = Object(h.a)(r),
                o = new u.a({
                    imageFile: a
                }),
                s = this.viewer._currentModel,
                l = o.save({
                    modelUID: s.get("uid")
                }),
                f = t.find("img");
            f && (f.remove(), null !== this.previewTimeout && (window.clearTimeout(this.previewTimeout), this.previewTimeout = null));
            var p = new Image;
            p.src = r, t.prepend(p), t.removeClass("invisible"), this.previewTimeout = setTimeout(function () {
                t.addClass("invisible")
            }, 4e3), l.then(function () {
                e.removeClass("progress"), e.addClass("success"), setTimeout(function () {
                    e.removeClass("success")
                }, 2e3)
            }).catch(function () {
                new c.default({
                    title: "Save settings error",
                    text: "An unexpected error happened. The thumbnail has NOT been saved.",
                    buttons: {
                        ok: !0
                    }
                }).open(), d.error("Error while saving snapshot"), e.removeClass("progress")
            })
        },
        showGuides: Object(n.debounce)(function () {
            this.$(".snapshot-guides").addClass("active")
        }, 100),
        hideGuides: Object(n.debounce)(function () {
            this.$(".snapshot-guides").removeClass("active")
        }, 100)
    })
}, function (e, t, i) {
    "use strict";
    var n = i(3),
        r = i.n(n),
        a = i(0),
        o = (i.n(a), i(13)),
        s = i(475),
        u = i(14),
        l = i(678),
        c = i(55),
        h = u.a.shortcuts;
    t.a = l.a.extend({
        displayName: "HelpOverlay",
        mixins: [Object(c.a)(".tabs-container")],
        events: {
            "click .tabs a": "onTabClick",
            "touchstart .tabs a": "onTabClick",
            'click [data-action="reset-camera"]': "onResetCameraClick",
            'touchstart [data-action="reset-camera"]': "onResetCameraClick"
        },
        initialize: function () {
            l.a.prototype.initialize.apply(this, arguments), this.renderingShortcuts = new s.a(h.viewerRendering), this.annotationShortcuts = new s.a(h.annotationControl), this.animationShortcuts = new s.a(h.animationControl), this.render()
        },
        onResetCameraClick: function (e) {
            e.preventDefault(), o.a.modelViewerResetCameraButtonClicked(), this.hide(), this.viewer.scene.getFeaturesManager().focusOnSavedCamera(2), Object(a.defer)(function (e) {
                e.target.blur()
            }, e)
        },
        render: function () {
            var e = this.renderingShortcuts.generateHelpSection(),
                t = this.annotationShortcuts.generateHelpSection(),
                i = this.animationShortcuts.generateHelpSection();
            this.$(".rendering-shortcuts").html(e), this.$(".annotation-shortcuts").html(t), this.$(".animation-shortcuts").html(i)
        },
        onTabClick: function (e) {
            e.preventDefault();
            var t = r()(e.currentTarget),
                i = t.attr("data-target"),
                n = this.$("[data-tab].active"),
                a = this.$('[data-tab="' + i + '"]');
            o.a.modelViewerHelpTabClicked(i), this.$(".tabs li").removeClass("active"), t.parent().addClass("active"), n.removeClass("active"), a.addClass("active")
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(211),
        r = i(55),
        a = i(678),
        o = a.a.extend({
            mixins: [n.a, Object(r.a)(".js-scrollable")],
            events: {
                "click .tabs a": "onTabClick",
                'click [data-action="reset-camera"]': "onResetCameraClick"
            },
            setModel: function (e) {
                this.model = e, this.render()
            },
            render: function () {
                this.model && (this.$(".hotspot-title").html(this.model.get("name")), this.$(".hotspot-content").html(this.model.get("content").rendered), this.handleLazyLoading())
            }
        });
    t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(55)),
        a = i(14),
        o = i(79),
        s = i(475),
        u = i(13),
        l = i(2),
        c = i(271),
        h = i(593),
        d = i(940),
        f = i(4),
        p = a.a.shortcuts,
        m = {
            render: {
                title: "Render (" + p.inspectorControl.shortcuts[0].keyCombinations + ")",
                displayViews: [{
                    text: "Final Render",
                    icon: "icon-final-render",
                    value: "Default",
                    has2dView: !1
                }, {
                    text: "No Post-Processing",
                    icon: "icon-final-render",
                    value: "DefaultNoPostProcess",
                    has2dView: !1
                }]
            },
            materials: {
                title: "Material channels (" + p.inspectorControl.shortcuts[1].keyCombinations + ")",
                displayViews: [{
                    text: "Albedo",
                    icon: "icon-diffuse",
                    value: "DiffusePBR",
                    has2dView: !0
                }, {
                    text: "Base Color",
                    icon: "icon-diffuse",
                    value: "AlbedoPBR",
                    has2dView: !0
                }, {
                    text: "Diffuse",
                    icon: "icon-diffuse",
                    value: "DiffuseColor",
                    has2dView: !0
                }, {
                    text: "Specular",
                    icon: "icon-specular",
                    value: "SpecularPBR",
                    has2dView: !0
                }, {
                    text: "Metalness",
                    icon: "icon-metalness",
                    value: "MetalnessPBR",
                    has2dView: !0
                }, {
                    text: "Specular Color",
                    icon: "icon-specular",
                    value: "SpecularColor",
                    has2dView: !0
                }, {
                    text: "Glossiness",
                    icon: "icon-roughness",
                    value: "GlossinessPBR",
                    has2dView: !0
                }, {
                    text: "Roughness",
                    icon: "icon-roughness",
                    value: "RoughnessPBR",
                    has2dView: !0
                }, {
                    text: "Specular Glossiness",
                    icon: "icon-specular",
                    value: "SpecularHardness",
                    has2dView: !0
                }, {
                    text: "Scattering",
                    icon: "icon-subsurface",
                    value: "SubsurfaceScattering",
                    has2dView: !0
                }, {
                    text: "Translucency",
                    icon: "icon-subsurface",
                    value: "SubsurfaceTranslucency",
                    has2dView: !0
                }, {
                    text: "Normal Map",
                    icon: "icon-normal-map",
                    value: "NormalMap",
                    has2dView: !0
                }, {
                    text: "Bump Map",
                    icon: "icon-normal-map",
                    value: "BumpMap",
                    has2dView: !0
                }, {
                    text: "AO map",
                    icon: "icon-AO",
                    value: "AOPBR",
                    has2dView: !0
                }, {
                    text: "Cavity",
                    icon: "icon-AO",
                    value: "CavityPBR",
                    has2dView: !0
                }, {
                    text: "Lightmap",
                    icon: "icon-lightmap",
                    value: "DiffuseIntensity",
                    has2dView: !0
                }, {
                    text: "Displacement",
                    icon: "icon-displacement",
                    value: "Displacement",
                    has2dView: !0
                }, {
                    text: "Opacity",
                    icon: "icon-transparency",
                    value: "Opacity",
                    has2dView: !0
                }, {
                    text: "Emission",
                    icon: "icon-emission",
                    value: "EmitColor",
                    has2dView: !0
                }, {
                    text: "Specular F0",
                    icon: "icon-specular",
                    value: "SpecularF0",
                    has2dView: !0
                }, {
                    text: "Vertex Color",
                    icon: "icon-diffuse",
                    value: "VertexColor",
                    has2dView: !0
                }, {
                    text: "Vertex Alpha",
                    icon: "icon-transparency",
                    value: "VertexAlpha",
                    has2dView: !0
                }, {
                    text: "Clear Coat",
                    icon: "icon-specular",
                    value: "ClearCoat",
                    has2dView: !0
                }, {
                    text: "Clear Coat Roughness",
                    icon: "icon-roughness",
                    value: "ClearCoatRoughness",
                    has2dView: !0
                }, {
                    text: "Clear Coat Normal Map",
                    icon: "icon-normal-map",
                    value: "ClearCoatNormalMap",
                    has2dView: !0
                }]
            },
            geometry: {
                title: "Geometry (" + p.inspectorControl.shortcuts[2].keyCombinations + ")",
                displayViews: [{
                    text: "Matcap",
                    icon: "icon-final-render",
                    value: "MatcapFlat",
                    has2dView: !1
                }, {
                    text: "Matcap+Surface",
                    icon: "icon-final-render",
                    value: "MatcapDetail",
                    has2dView: !1
                }, {
                    text: "Wireframe",
                    icon: "icon-geometry",
                    value: "Wireframe",
                    has2dView: !0
                }, {
                    text: "Vertex Normals",
                    icon: "icon-vertex-normals",
                    value: "VertexNormal",
                    has2dView: !1
                }]
            },
            uv: {
                title: "UV (" + p.inspectorControl.shortcuts[3].keyCombinations + ")",
                displayViews: [{
                    text: "UV Checker",
                    icon: "icon-UV",
                    value: "UVChecker",
                    has2dView: !0
                }]
            }
        },
        g = l.default.getFromString('\n        <div class="model-inspector__wireframe">\n            {{ wireframe | safe }}\n        </div>\n        {% if inspectableTextures or isStaff %}\n            <div class="mode__title">Viewport{%if not inspectableTextures and isStaff %} (Staff only){% endif %}</div>\n            <div class="toggle-button{%if not inspectableTextures and isStaff %} --staff{% endif %}">\n                <span class="toggle-button__option">\n                    <input type="radio" name="splitType" data-value="3d" id="splitType-3d">\n                    <label for="splitType-3d">3D</label>\n                </span>\n                <span class="toggle-button__option">\n                    <input type="radio" name="splitType" data-value="split" id="splitType-split">\n                    <label for="splitType-split">3D + 2D</label>\n                </span>\n                <span class="toggle-button__option">\n                    <input type="radio" name="splitType" data-value="2d" id="splitType-2d">\n                    <label for="splitType-2d">2D</label>\n                </span>\n            </div>\n        {% endif %}\n       {% for category, mode in modes %}\n            {% if mode.displayViews %}\n                <div class="mode__title">{{ mode.title }}</div>\n            {% endif %}\n            <ul>\n                {% for button in mode.displayViews %}\n                    <li                        class="mode {{ "selected" if button.value == active else "" }}" data-mode="{{ mode.title }}" data-value="{{ button.value }}"\n                        style="{{ button.style }}"\n                    >\n                        <i class="mode__icon custom-icons {{ button.icon }}"></i>\n                        <span>{{ button.text }}</span>\n                    </li>\n                    {% endfor %}\n            </ul>\n       {% endfor %}\n    ');
    t.a = c.a.extend({
        mixins: [Object(r.a)(".js-scrollable")],
        children: {
            materialSelector: {
                selector: ".model-inspector__2D-options .model-inspector__material-options",
                viewClass: h.b,
                shouldCreateChild: function () {
                    return this.canInspectTextures()
                },
                options: function () {
                    return {
                        theme: "dark",
                        value: this.model.get("material").toString(),
                        onChange: function (e) {
                            this.model.set("material", e)
                        }.bind(this),
                        options: this.model.get("materialList").filter(function (e) {
                            return !e.uidUniqueMerged
                        }).map(function (e) {
                            var t = e.uidListUnusedDuplicates.length ? "Merged (" + e.name + ", ...)" : e.name;
                            return {
                                title: this.model.materialHasTextureInView2d(e.uid) ? t : t + " (no texture)",
                                value: e.uid
                            }
                        }.bind(this)).sort(function (e, t) {
                            return e.title < t.title ? -1 : e.title > t.title ? 1 : void 0
                        }),
                        closeOnSelection: !1,
                        autoScale: !0
                    }
                }
            },
            UVSelector: {
                selector: ".model-inspector__2D-options .model-inspector__UV-options",
                viewClass: h.b,
                shouldCreateChild: function () {
                    return this.canInspectTextures() && this.model.getCurrentUVs().length > 1
                },
                options: function () {
                    return {
                        theme: "dark",
                        value: this.model.get("texCoord").toString(),
                        onChange: function (e) {
                            this.model.set("texCoord", e)
                        }.bind(this),
                        options: this.model.getCurrentUVs().sort(function (e, t) {
                            return e - t
                        }).map(function (e) {
                            return {
                                title: "UV " + e.toString(),
                                value: e.toString()
                            }
                        }),
                        closeOnSelection: !1,
                        autoScale: !0
                    }
                }
            }
        },
        events: {
            "click .mode": "onSelectDisplayView",
            "click .model-inspector__minimize": "toggleVisibility",
            'click [name="splitType"]': "onSelectSplitType",
            "click [data-setting]": "changeWireframe"
        },
        initialize: function () {
            c.a.prototype.initialize.apply(this, arguments), this.initializeShortcuts(), this.updateModes(), this.updateSavedState(), this._selectors = this.$(".model-inspector__2D-options"), this.render(), this._selectors.css({
                visibility: "hidden"
            })
        },
        delegateEvents: function () {
            c.a.prototype.delegateEvents.apply(this, arguments), this.model.on("change:displayView", this.updateDisplayViewUI, this), this.model.on("change:material change:texCoord change:displayView", this.renderChildren, this), this.model.on("change:material change:displayView change:splitType", this.update2DView, this), this.model.on("change:availableDisplayView", this.updateAvailableDisplayView, this), this.model.on("change:uiVisible", this.show, this)
        },
        undelegateEvents: function () {
            c.a.prototype.undelegateEvents.apply(this, arguments), this.model.off("change:displayView", this.updateDisplayViewUI, this), this.model.off("change:material change:texCoord change:displayView", this.renderChildren, this), this.model.off("change:material change:displayView change:splitType", this.update2DView, this), this.model.off("change:availableDisplayView", this.updateAvailableDisplayView, this), this.model.off("change:uiVisible", this.show, this)
        },
        updateModes: function () {
            var e = this.model.get("availableDisplayView");
            this.modes = Object(n.reduce)(m, function (t, i, r) {
                var a = i.displayViews.filter(function (t) {
                    return -1 !== e.indexOf(t.value)
                });
                if (0 === a.length) return t;
                var o = Object(n.extend)({}, i, {
                    displayViews: a
                });
                return t[r] = o, t
            }, {}), this.modeNamesWith2d = Object(n.reduce)(this.modes, function (e, t) {
                var i = t.displayViews.filter(function (e) {
                    return e.has2dView
                }).map(function (e) {
                    return e.value
                });
                return e.concat(i)
            }, [])
        },
        changeWireframe: function (e) {
            var t = e.currentTarget.dataset.setting,
                i = e.currentTarget.dataset.value;
            if ("wireframeEnable" === t) {
                var n = !this.options.wireframeModel.get("wireframeEnable");
                return u.a.modelViewerWireframeToggleClicked(n), this.options.wireframeModel.set("wireframeEnable", n)
            }
            u.a.modelViewerWireframeColorSelected(i), this.options.wireframeModel.set("wireframeEnable", !0), this.options.wireframeModel.set(t, i)
        },
        onSelectDisplayView: function (e) {
            var t = e.currentTarget.getAttribute("data-mode"),
                i = e.currentTarget.getAttribute("data-value");
            u.a.inspectorDisplayViewClicked(t, i), this.model.set("displayView", i)
        },
        canInspectTextures: function () {
            return this.options.inspectableTextures || f.a.me().get("isStaff")
        },
        _currentModeHas2dView: function () {
            var e = this.model.get("displayView");
            return -1 !== this.modeNamesWith2d.indexOf(e)
        },
        _getDisplayViewLabel: function () {
            return this.$el.find("[data-value=" + this.model.get("displayView") + "]").text().trim()
        },
        updateDisplayViewUI: function () {
            this.$el.find(".selected").removeClass("selected"), this.$el.find("[data-value=" + this.model.get("displayView") + "]").addClass("selected")
        },
        updateAvailableDisplayView: function () {
            this.updateModes(), -1 === this.model.get("availableDisplayView").indexOf(this._savedState.displayView) && (this._savedState.displayView = "Default"), this.render()
        },
        update2DView: function () {
            if (this.canInspectTextures())
                if (this.updateSelectorsUI(), "3d" === this.model.get("splitType") || this.model.materialHasContentInView2d(this.model.get("material"))) this.$el.find(".model-inspector__empty-2d-view").text("");
                else {
                    var e = this.model.get("materialByUid")[this.model.get("material")].name,
                        t = this.$el.find(".model-inspector__empty-2d-view"),
                        i = "2d" === this.model.get("splitType") ? "50%" : "25%",
                        n = "";
                    n = this._currentModeHas2dView() ? "No data in " + e + "/" + this._getDisplayViewLabel() : "2D view isn't available for " + this._getDisplayViewLabel() + ".<br>Select a Material Channel to view textures.", t.html(n).css("right", i)
                }
        },
        updateSelectorsUI: function () {
            "3d" !== this.model.get("splitType") && this._currentModeHas2dView() ? this._selectors.css({
                visibility: "visible"
            }) : this._selectors.css({
                visibility: "hidden"
            })
        },
        onSelectSplitType: function (e) {
            this.canInspectTextures() && (u.a.inspectorSplitTypeClicked(e.currentTarget.getAttribute("data-value")), this.model.set("splitType", e.currentTarget.getAttribute("data-value")))
        },
        initializeShortcuts: function () {
            var e = new s.a(p.inspectorControl),
                t = this.onShortcut.bind(this),
                i = function () {
                    u.a.modelViewerInspectorShortcut(), this.toggle()
                }.bind(this);
            e.on("render materials geometry uv", t), e.on("inspector", i), e.listen()
        },
        onShortcut: function (e) {
            var t = this.modes[e.id],
                i = this._savedState.displayView,
                r = Object(n.findIndex)(t.displayViews, function (e) {
                    return e.value === i
                }),
                a = (r + 1) % t.displayViews.length,
                s = t.displayViews[a];
            this.model.get("uiVisible") ? this.options.osd.hide() : Object(o.a)() ? this.model.set("uiVisible", !0) : this.options.osd.show(s.text, {
                duration: 1e3
            }), u.a.inspectorModeShortcut(t.title, s.value), this.model.set("displayView", s.value), this.updateSavedState({
                displayView: s.value
            })
        },
        close: function () {
            this.$el.removeClass("--show"), this.updateSavedState(), this.model.set("displayView", "Default"), this.model.set("splitType", "3d")
        },
        show: function (e, t) {
            this.$el.toggleClass("--show --open", t)
        },
        restoreState: function () {
            this.model.set("displayView", this._savedState.displayView), this.model.set("splitType", this._savedState.splitType), this.model.set("material", this._savedState.material), this.model.set("texCoord", this._savedState.texCoord)
        },
        updateSavedState: function (e) {
            this._savedState = Object(n.extend)({
                displayView: this.model.get("displayView"),
                material: this.model.get("material"),
                splitType: this.model.get("splitType"),
                texCoord: this.model.get("texCoord")
            }, e)
        },
        toggle: function () {
            this.model.get("uiVisible") ? (this.model.set("uiVisible", !1), this.close()) : (this.model.set("uiVisible", !0), this.restoreState())
        },
        toggleVisibility: function () {
            u.a.inspectorUIVisibilityToggleClicked(), this.$el.toggleClass("--open")
        },
        render: function () {
            var e = this.viewer.proxySettings.get("setting.name");
            this.$(".model-inspector__modes").html(g({
                inspectableTextures: this.options.inspectableTextures,
                modes: this.modes,
                active: this.model.get("displayView"),
                wireframe: Object(d.b)({
                    wireframeColor: e
                }),
                isStaff: f.a.me().get("isStaff")
            })), this.renderChildren(), this.afterRender()
        },
        afterRender: function () {
            this.$('[data-value="' + this.model.get("splitType") + '"]').prop("checked", !0)
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(271));
    t.a = r.a.extend({
        events: {
            "click .osd": "hide"
        },
        show: function (e, t) {
            this.osdTimeout && window.clearTimeout(this.osdTimeout), t = Object(n.extend)({
                position: "center"
            }, t);
            var i = this.$(".osd");
            i.find(".osd-content").html(e), i.addClass("active"), i.removeClass("osd-top osd-center"), i.addClass("osd-" + t.position), t.duration && (t.duration = Math.max(0, t.duration), t.duration !== 1 / 0 && (this.osdTimeout = setTimeout(this.hide.bind(this), t.duration)))
        },
        hide: function () {
            this.$(".osd").removeClass("active")
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(3),
        r = i.n(n),
        a = i(992),
        o = i(271),
        s = i(14),
        u = i(475);
    t.a = o.a.extend({
        _isHover: !1,
        events: {
            touchstart: "onTouchStart",
            mousedown: "onClick",
            mouseover: "onMouseover",
            mouseout: "onMouseout",
            mouseenter: "onMouseEnter",
            mouseleave: "onMouseLeave"
        },
        initialize: function () {
            o.a.prototype.initialize.apply(this, arguments), this.previousValue = null, this._touched = !1, this.$icon = this.$(".fa"), this.listenTo(this.model, "change:volume", this.render.bind(this)), this.render(), this.$volumeMenu = this.$(".volume-menu"), this.slider = new a.a(void 0, {
                model: this.model,
                global: !0,
                orientation: "vertical"
            }), this.$volumeMenu.append(this.slider.$el), this.initializeShortcuts()
        },
        delegateEvents: function () {
            o.a.prototype.delegateEvents.apply(this, arguments), r()(window).on("mouseup.delegateEvents" + this.cid, this.onVolumeInteractionEnd.bind(this)), r()(window).on("touchend.delegateEvents" + this.cid, this.onVolumeInteractionEnd.bind(this))
        },
        undelegateEvents: function () {
            o.a.prototype.undelegateEvents.apply(this, arguments), r()(window).off(".delegateEvents" + this.cid)
        },
        initializeShortcuts: function () {
            this.soundControlShortcuts = new u.a(s.a.shortcuts.sound), this.soundControlShortcuts.on("mute", this.toggleMute.bind(this)), this.soundControlShortcuts.listen()
        },
        onTouchStart: function () {
            this._touched = !0
        },
        onClick: function (e) {
            e.preventDefault();
            var t = r()(e.target);
            t.is(".volume-menu") || t.parents(".volume-menu").length || this.toggleMute()
        },
        onMouseEnter: function () {
            this._isHover = !0
        },
        onMouseLeave: function () {
            this._isHover = !1
        },
        toggleMute: function () {
            this.slider.onoff()
        },
        togglePane: function (e) {
            this.$el.toggleClass("--active", e)
        },
        onMouseover: function () {
            if (this._touched) return void(this._touched = !1);
            this.togglePane(!0)
        },
        onMouseout: function () {
            !1 === this.slider.started && this.togglePane(!1)
        },
        onVolumeInteractionEnd: function () {
            this.model.get("enable") && (this._isHover || this.togglePane(!1))
        },
        show: function () {
            this.viewer.$el.addClass("sound-enabled")
        },
        hide: function () {
            this.viewer.$el.removeClass("sound-enabled")
        },
        render: function () {
            var e = this.model.get("volume");
            return this.$icon.toggleClass("fa-volume-up", e >= .5), this.$icon.toggleClass("fa-volume-down", e > 0 && e < .5), this.$icon.toggleClass("fa-volume-off", 0 === e), this
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(3),
        r = i.n(n),
        a = i(0),
        o = (i.n(a), i(8)),
        s = i(941),
        u = i(1472),
        l = o.a.extend({
            _isLoaded: !1,
            _context: null,
            isMoving: !1,
            startX: 0,
            sensitivity: 20,
            sprite: {
                current: 0,
                steps: 15,
                ratio: null,
                width: 0
            },
            size: 1,
            autospinTimer: null,
            events: {
                mousedown: "onMouseDown",
                mouseup: "onMouseUp",
                "mousemove ": "onMouseMove",
                touchstart: "onTouchStart",
                touchend: "onTouchEnd",
                touchmove: "onTouchMove"
            },
            constructor: function () {
                this._boundResizeEvent = this.onWindowResize.bind(this), o.a.prototype.constructor.apply(this, arguments)
            },
            initialize: function () {
                o.a.prototype.initialize.apply(this, arguments), this.$viewport = r()(), this.$image = r()()
            },
            delegateEvents: function () {
                o.a.prototype.delegateEvents.apply(this, arguments), r()(window).on("resize", this._boundResizeEvent)
            },
            undelegateEvents: function () {
                o.a.prototype.undelegateEvents.apply(this, arguments), r()(window).off("resize", this._boundResizeEvent), this.autospinTimer && clearInterval(this.autospinTimer)
            },
            isViewerReady: function () {
                return this._isLoaded
            },
            run: function () {
                var e = new s.a;
                this._context = e, this.$el.show(), this.$el.siblings(".webgl").hide(), this.$el.siblings(".osd").hide();
                var t = this.model.get("uid"),
                    i = this._fallbackCollection = new u.a([], {
                        uid: t
                    });
                return i.fetch().then(function () {
                    i.length > 0 ? this.displayFallback() : this.displayNoFallbackError()
                }.bind(this)).catch(function () {
                    this.displayNoFallbackError()
                }.bind(this)), this._isLoaded = !0, !0
            },
            getContext: function () {
                return this._context
            },
            getFeatures: function () {
                return {}
            },
            findBestImage: function () {
                for (var e, t = this._fallbackCollection.toJSON(), i = this.$el.height(), n = 1 / 0, r = 0, a = t.length; r < a; ++r) {
                    var o = t[r],
                        s = Math.abs(i - o.height);
                    s < n && (n = s, e = o)
                }
                return e
            },
            displayFallback: function () {
                this.$viewport = r()(".fallback-viewport"), this.$image = this.$viewport.find("img.fallback-sprite");
                var e = this.findBestImage(),
                    t = e.url;
                this._currentHeight = e.height, this.$image.on("load", function (e) {
                    var t = e.target.naturalHeight,
                        i = e.target.naturalWidth / this.sprite.steps;
                    this.sprite.ratio = t ? i / t : 0, r()(e.target).css("display", "block"), this.trigger("secondary-progress", {
                        progress: 1
                    }), this.trigger("success"), this.displayFallbackWarning(), this.onWindowResize()
                }.bind(this)), this.$image.on("error", function (e) {
                    console.error("Fallback loading failed. URL : " + t + " ERROR : " + e.toString()), this.trigger("fail"), this.displayFallbackLoadingError()
                }.bind(this)), this.$image.attr("src", t)
            },
            displayFallbackLoadingError: function () {
                this.$el.find(".fallback-error-loading").show()
            },
            displayNoFallbackError: function () {
                this.$el.find(".fallback-error-nofallback").show()
            },
            displayFallbackWarning: function () {
                this._warningDisplayed || (this._warningDisplayed = !0, this.$el.find(".fallback-warning").show(), this.fallbackWarning = setTimeout(function () {
                    this.$el.find(".fallback-warning").fadeOut()
                }.bind(this), 5e3))
            },
            onWindowResize: function () {
                if (this._fallbackCollection.length) {
                    var e, t, i = this.$el.width(),
                        n = this.$el.height(),
                        r = i / n;
                    this.findBestImage().height > this._currentHeight && this.displayFallback(), 2 === this.size ? r < this.sprite.ratio ? (e = i, t = Math.floor(e / this.sprite.ratio)) : (t = n, e = Math.floor(t * this.sprite.ratio)) : r < this.sprite.ratio ? (t = n, e = Math.floor(t * this.sprite.ratio)) : (e = i, t = Math.floor(e / this.sprite.ratio)), this.$viewport.width(e).height(t).css({
                        "margin-top": Math.round(-1 * t / 2),
                        "margin-left": Math.round(-1 * e / 2)
                    }), this.sprite.width = Math.round(this.$image.prop("scrollHeight") * this.sprite.ratio), this.$viewport.scrollLeft(this.sprite.width * this.sprite.current)
                }
            },
            onMouseDown: function (e) {
                e.preventDefault(), this.isMoving = !0, this.startX = e.clientX
            },
            onMouseMove: function (e) {
                e.preventDefault(), this.move(e.clientX)
            },
            onMouseUp: function (e) {
                e.preventDefault(), this.isMoving = !1
            },
            onTouchStart: function (e) {
                e.preventDefault(), this.isMoving = !0;
                var t = e.originalEvent.touches[0];
                this.startX = t.clientX
            },
            onTouchMove: function (e) {
                e.preventDefault(), this.move(e.originalEvent.touches[0].clientX)
            },
            onTouchEnd: function (e) {
                e.preventDefault(), this.isMoving = !1
            },
            move: function (e) {
                this.isMoving && (this.autospinTimer && this.stopAutospin(), e > this.startX + this.sensitivity && (this.startX = e, this.moveRight()), e < this.startX - this.sensitivity && (this.startX = e, this.moveLeft()))
            },
            moveRight: function () {
                0 === this.sprite.current ? this.sprite.current = this.sprite.steps - 1 : this.sprite.current = this.sprite.current - 1, this.$viewport.scrollLeft(this.sprite.width * this.sprite.current)
            },
            moveLeft: function () {
                this.sprite.current = (this.sprite.current + 1) % this.sprite.steps, this.$viewport.scrollLeft(this.sprite.width * this.sprite.current)
            },
            startAutospin: function () {
                this.autospinTimer = setInterval(Object(a.bind)(function () {
                    this.moveLeft()
                }, this), 500)
            },
            stopAutospin: function () {
                clearInterval(this.autospinTimer), this.autospinTimer = null
            },
            toggleAutospin: function () {
                this.autospinTimer ? this.stopAutospin() : this.startAutospin()
            }
        });
    t.a = l
}, function (e, t, i) {
    "use strict";
    var n = i(42),
        r = i(1473);
    t.a = n.a.extend({
        model: r.a,
        parse: function (e) {
            return e.results.images
        },
        url: function () {
            return "/i/models/" + this.options.uid + "/fallback"
        }
    })
}, function (e, t, i) {
    "use strict";
    var n = i(11);
    t.a = n.a.extend({})
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(20),
        a = i(44),
        o = i(179),
        s = n.a.osg,
        u = [
            [.263385, -.0252475],
            [-.38545, .054485],
            [-.139795, -.5379925],
            [-.2793775, .6875475],
            [.7139025, .4710925],
            [.90044, -.16422],
            [.4481775, -.82799],
            [-.9253375, -.2910625],
            [.3468025, 1.02292],
            [-1.13742, .33522],
            [-.7676225, -.9123175],
            [-.2005775, -1.1774125],
            [-.926525, .96876],
            [1.12909, -.7500325],
            [.9603, 1.14625]
        ],
        l = function (e) {
            return l.instance ? l.instance : (this._canBeEnabled = Object(r.a)().supersample, this._viewer = e, this._sampleCount = 15, this._isFakeSupersampling = !1, this._isSupersampling = !1, this._frameNum = 1, this._frameNumTaa = 0, this._switch = !0, this._jitter = o.a.uHalton.getInternalArray(), this._jitter[2] = 1, l.instance = this, this)
        };
    s.createPrototypeObject(l, {
        getSampleCount: function () {
            return this._sampleCount
        },
        canBeEnabled: function () {
            return this._canBeEnabled
        },
        getSortedJitterTable: function () {
            return u
        },
        getBackgroundModel: function () {
            return this._viewer.getFeatures().background.getModel()
        },
        getAnimationModel: function () {
            return this._viewer.getFeatures().animation.getModel()
        },
        getWireframeAttenuation: function () {
            var e = this._viewer.getOrCreateScene().getWireframeNodes();
            if (!e.length || 0 === e[0].getNodeMask()) return 1;
            var t = e[0].getStateSet(),
                i = t.getUniform("uColor").getInternalArray()[3];
            return 1 - i + .05 * i
        },
        updateUniforms: function (e, t) {
            var i = e % this._sampleCount,
                n = this.getSortedJitterTable()[i],
                r = t ? .05 : this.getWireframeAttenuation();
            this._jitter[0] = n[0] * r, this._jitter[1] = n[1] * r, this._jitter[3] = i
        },
        setSwitch: function (e) {
            this._switch = e
        },
        isTaaJitter: function () {
            var e = this._postProcess.getModel(),
                t = e.get("taaEnable"),
                i = "none" !== this.getBackgroundModel().get("enable"),
                n = void 0 !== Object(r.a)().taaJitter ? Object(r.a)().taaJitter : i,
                a = e.get("webVR"),
                o = this.getAnimationModel().canActivateTAA(),
                s = 0 === Object(r.a)().autospin || Object(r.a)().taaAnimation;
            return o && t && n && !a && s
        },
        updateFrame: function () {
            if (this._jitter[2] = -this._jitter[2], this._postProcess.getModel().trigger("pingPongTexture0", this._jitter[2] > 0), !this._isSupersampling) return this._jitter[2] = Math.sign(this._jitter[2]), a.a._doJitter && this.isTaaJitter() ? (this.updateUniforms(this._frameNumTaa, !0), this._frameNumTaa++) : (this._jitter[0] = 0, this._jitter[1] = 0, this._frameNum = 1, this._frameNumTaa = 0), a.a._doJitter = !0, !1;
            a.a._doJitter = !0;
            var e = this._frameNum % this._sampleCount;
            return this.updateUniforms(e), this._frameNum++, this.isSupersampled() && (this._isSupersampling = !1), this._isFakeSupersampling = !1, this._isSupersampling
        },
        update: function (e, t) {
            if (!this._switch) return !0;
            var i = t.getFrameStamp().getFrameNumber();
            return this._lastUpdateFrame === i || (this._lastUpdateFrame = i, !this._postProcess && (this._postProcess = this._viewer.getFeatures().postProcess, !this._postProcess) || (this.updateFrame() && a.a.drawSameFrame(), !0))
        },
        isSupersampled: function () {
            return this._frameNum >= this._sampleCount
        },
        isEnabled: function () {
            return this._isSupersampling
        },
        isFakeEnabled: function () {
            return this._isFakeSupersampling
        },
        forceEnable: function () {
            this._isSupersampling = !0, this._jitter[0] = 0, this._jitter[1] = 0, this._jitter[2] = 2 * Math.sign(this._jitter[2]), this._jitter[3] = 0, this._frameNum = 1, a.a.drawSameFrame()
        },
        enable: function () {
            if (!this.canBeEnabled()) return this._isFakeSupersampling || a.a.drawSameFrame(), void(this._isFakeSupersampling = !0);
            1 === this._frameNum && this.forceEnable()
        },
        reset: function () {
            this._jitter[2] = Math.sign(this._jitter[2]), this._frameNum = 1, this._isSupersampling = !1, this._isFakeSupersampling = !1
        },
        setRoot: function (e) {
            var t = new s.Node;
            e.addChild(t), t.addUpdateCallback(l.instance)
        }
    }), t.a = l
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(0),
        a = (i.n(r), i(1476)),
        o = i(163),
        s = n.a.osg,
        u = function (e, t, i) {
            return Math.max(t, Math.min(i, e))
        },
        l = function (e) {
            var t = e.materials;
            for (var i in t) {
                var n = t[i];
                "object" == typeof n ? void 0 === n.stateSetID ? delete t[n.id] : Object(a.a)(n) : delete t[i]
            }
        },
        c = function (e) {
            if (e.orientation.axis) {
                var t = e.orientation.axis;
                t = s.vec3.fromValues(u(t[0], 0, 3), u(t[1], 0, 3), u(t[2], 0, 3)), delete e.orientation.axis, t[0] = (4 - t[0]) % 4, t[1] = (4 - t[1]) % 4, t[2] = (4 - t[2]) % 4, e.orientation.matrix = s.mat4.fromRotation(s.mat4.create(), .5 * Math.PI * (t[0] + t[1] + t[2]), t)
            }
        },
        h = function (e) {
            if (e.animation) {
                var t = e.animation.autoplay;
                void 0 !== e.animation.autoplay && (e.animation.initializeWithRestPose = !t, delete e.animation.autoplay)
            }
        },
        d = function (e) {
            switch (e.shading.type) {
                case "lit":
                case "matcap":
                case "shadeless":
                    break;
                case "blending":
                case "default":
                case "default-shading":
                case "predefined-shading":
                case "shading":
                case void 0:
                    e.shading.type = "lit";
                    break;
                default:
                case "no-shading":
                    e.shading.type = "shadeless"
            }
            e.shading.vertexColor || "pbr" !== e.shading.renderer || (e.shading.vertexColor = {
                enable: !1,
                colorSpace: "linear"
            })
        },
        f = function (e) {
            var t = e.environment;
            void 0 !== t.exposure && (t.exposure *= void 0 !== t.light && t.light > 0 ? t.light : 1);
            var i = t.backgroundEnable;
            void 0 !== i && !0 === t.enable ? e.background.enable = !0 === i ? "environment" : !0 === e.background.enable ? "fixed" : "none" : void 0 !== e.background.enable && (!0 === e.background.enable ? e.background.enable = "fixed" : !1 === e.background.enable && (e.background.enable = "none"))
        },
        p = function (e) {
            if (e.lighting.lights)
                for (var t = e.lighting.lights, i = e.version, n = 0, r = t.length; n < r; ++n) {
                    var a = t[n];
                    a.hardness = Math.max(Math.min(a.hardness, 1), 0), (void 0 === a.castShadows || i < 1 && a.attachedToCamera) && (a.castShadows = !1)
                } else e.lighting = {}
        },
        m = function (e) {
            var t = e.scene && e.scene.postProcess;
            if (t) {
                var i = t.ssao;
                2 === e.version && t.enable && i && i.enable && 0 === i.bias && 0 === i.radius && (i.ssaoBias = -1, i.ssaoRadius = -1, e.vr.scale = -1);
                var n = t.vignette;
                if (n && n.lens) {
                    var r = n.lens;
                    n.amount = 1 - .5 * (r[0] + r[1]), n.hardness = 1 - .5 * (r[0] - r[1]), delete n.lens
                }
            }
        },
        g = function (e) {
            var t = e.vr;
            t && t.scale && (t.worldFactor = t.scale)
        },
        v = function (e) {
            var t = e.camera,
                i = e.scene;
            t && i && (i.fov && (t.fov = i.fov, delete i.fov), i.nearFarRatio && (t.nearFarRatio = i.nearFarRatio, delete i.nearFarRatio))
        },
        _ = function (e, t) {
            if ("object" != typeof e) return void(t.textLog += JSON.stringify(e));
            t.textLog += " { ";
            for (var i in e) {
                t.textLog += i + ": ";
                var n = e[i];
                void 0 !== n ? (_(n, t), t.textLog += ", ") : t.textError += "\n " + i + "=> " + t.textLog.substring(Math.max(0, t.textLog.length - 125), t.textLog.length) + " <= err"
            }
            t.textLog += " } "
        },
        b = function (e) {
            var t = {
                textLog: "",
                textError: ""
            };
            _(e, t), 0 !== t.textError.length && o.a.client.captureMessage("Invalid CloneDeepWith: " + t.textError)
        },
        S = function (e, t) {
            return h(e), v(e), c(e), d(e), f(e), l(e), p(e), m(e), g(e), t ? e : Object(r.cloneDeepWith)(e, function (t) {
                if (void 0 === t && b(e), t.byteLength) return Array.prototype.slice.call(t)
            })
        },
        x = function (e) {
            var t = e.toJSON();
            return void 0 === e.get("vertexCount") && e.set("vertexCount", t.nbVertexes), void 0 === e.get("faceCount") && e.set("faceCount", t.nbTriangles), void 0 === t.options && (t.options = {}), e.set("options", S(t.options, !0)), e.set("files", t.files), e
        };
    x.readOptions = S, t.a = x
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(0),
        a = (i.n(r), i(152)),
        o = n.a.osg,
        s = Object(r.invert)(o.Texture),
        u = ["magFilter", "minFilter", "wrapS", "wrapT", "textureTarget", "internalFormat"],
        l = ["NormalMap", "SubsurfaceScattering", "Opacity", "Displacement", "BumpMap", "AOPBR", "CavityPBR", "MetalnessPBR", "GlossinessPBR", "RoughnessPBR", "SpecularF0", "SpecularHardness"],
        c = function (e) {
            e.image && (e.url = e.image, delete e.image);
            for (var t = 0, i = u.length; t < i; ++t) {
                var n = u[t];
                "number" == typeof e[n] && (e[n] = s[e[n]])
            }
            void 0 === e.texCoordUnit ? e.texCoordUnit = 0 : "string" == typeof e.texCoordUnit && (e.texCoordUnit = parseInt(e.texCoordUnit, 10)), e.format && delete e.format
        },
        h = function (e) {
            return Math.max(0, Math.min(1, e))
        },
        d = function (e, t, i) {
            if (void 0 !== e.factor) {
                var n = 0,
                    r = 1;
                i <= 2 && ("Opacity" === t ? "alphaMask" === e.type ? n = .01 : "alphaBlend" === e.type && e.factor >= .99 && (e.factor = 1) : e.factor < .01 && (e.factor = 0)), "BumpMap" === t || "EmitColor" === t ? r = 10 : "SpecularHardness" === t ? r = 1e4 : "Displacement" !== t && "SubsurfaceScattering" !== t || (r = 1e15), e.factor = Math.max(n, Math.min(r, e.factor))
            }
            if (e.color)
                if (l.indexOf(t) >= 0) delete e.color;
                else {
                    var s = e.color;
                    e.color = o.vec3.fromValues(h(s[0]), h(s[1]), h(s[2]))
                } void 0 === e.enable && (e.enable = !0);
            var u = e.texture;
            if (u) {
                c(u);
                var d = a.a.getPossibleFormat(t);
                if (!u.internalFormat || 1 === Object.keys(d).length) return void(u.internalFormat = a.a.getDefaultFormatString(t));
                d[u.internalFormat] || (d.ALPHA ? u.internalFormat = "ALPHA" : d.RGB ? u.internalFormat = "RGB" : u.internalFormat = "LUMINANCE")
            }
        },
        f = function (e) {
            var t = e.channels;
            t.Geometry && (t.NormalMap = t.Geometry, delete t.Geometry), t.Reflection && (void 0 === e.reflection && (e.reflection = t.Reflection.factor), delete t.Reflection), e.cullFace || e.cullFaceMode && (e.cullFace = e.cullFaceMode, delete e.cullFaceMode), e.depthCheckMode && (t.Opacity && !t.Opacity.type && (t.Opacity.type = "alphaBlend"), delete e.depthCheckMode);
            var i = e.version || 0;
            if (t)
                for (var n in t) d(t[n], n, i)
        };
    t.a = f
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(9)),
        a = i(79),
        o = i(47),
        s = i(712),
        u = i(77),
        l = i(943),
        c = i(1478),
        h = i(69),
        d = i(85),
        f = i(20),
        p = i(223),
        m = i(101),
        g = i(1479),
        v = i(713),
        _ = i(179),
        b = i(585),
        S = i(444),
        x = i(670),
        y = i(103),
        C = i(600),
        T = i(159),
        w = i(456),
        M = i(88),
        E = i(199),
        A = i(44),
        P = r.a.osg,
        R = function (e, t) {
            this._viewerWebGL = e, this._viewerOSGJS = e.getViewerOSGJS(), this._urlOptions = e.options, this._features = e.getFeatures(), this._context = t, this._canvas = e.getCanvas(), this._nodeGizmo = null, Object(w.a)(this)
        };
    R.prototype = {
        getFeatures: function () {
            return this._features
        },
        getCanvas: function () {
            return this._canvas
        },
        getViewerWebGL: function () {
            return this._viewerWebGL
        },
        getViewerOSGJS: function () {
            return this._viewerOSGJS
        },
        getRootModel: function () {
            return this._viewerWebGL.getRootModel()
        },
        getWorldNode: function () {
            return this._features.autospin.getNode()
        },
        getTextureDepth: function () {
            return this._features.postProcess.getCamera()._textureDepth
        },
        getViewport3d: function () {
            return this._features.postProcess.getCamera().getViewport()
        },
        getIconScaleFov: function (e) {
            if (!e) {
                e = this._viewerOSGJS.getCamera().getProjectionMatrix()
            }
            var t = Math.sqrt(e[0] * e[0] + e[4] * e[4] + e[8] * e[8]);
            return .02 * this.getViewport3d().width() * t / S.a.getPixelRatio()[0]
        },
        getResourceManager: function () {
            return this._resourceManager || u.default.instance
        },
        getCurrentTabName: function () {
            if (this._urlOptions.widgetAPI) return this._urlOptions.widgetAPI.getTabbedWidget().get()
        },
        getTargetAndEyeFocusFromBound: function (e, t, i) {
            if (!e.valid()) return !1;
            var n = this._viewerOSGJS.getManipulator(),
                r = n.getCurrentManipulator().getHomeBoundingSphere();
            r.volume() < e.volume() && (e = r), P.vec3.copy(t, e.center(t));
            var a = n.getHomeDistance(e);
            return n.getEyePosition(i), P.vec3.sub(i, t, i), i[2] = 0, P.vec3.normalize(i, i), P.vec3.scale(i, i, a), P.vec3.sub(i, t, i), !0
        },
        focusOnBound: function () {
            var e = P.vec3.create(),
                t = P.vec3.create();
            return function (i, n, r) {
                return !!this.getTargetAndEyeFocusFromBound(i, e, t) && this.focusOnTargetAndEye(e, t, n, r)
            }
        }(),
        focusOnTargetAndEye: function () {
            var e = P.vec3.create();
            return function (t, i, n, r) {
                var a = this._features.camera;
                if (!a) return !1;
                var o = this._viewerOSGJS.getManipulator();
                if (!n || n < 0) return o.setTargetAndEye(t, i), !0;
                var s = a.getModel();
                return t || (t = o.getTarget(e)), i || (i = o.getEyePosition(e)), s.setTargetAndEye(t, i, r), s.set("animationDuration", n), !0
            }
        }(),
        focusOnHomePosition: function (e) {
            var t = this._features,
                i = t.camera;
            if (i && i.getModel()) {
                var n = i.getManipulator().getCurrentManipulator(),
                    r = n.getHomeBoundingSphere(),
                    a = r.center(),
                    o = n.getEyePosition(P.vec3.create());
                P.vec3.sub(o, a, o), P.vec3.normalize(o, o), P.vec3.scale(o, o, n.getHomeDistance(r)), P.vec3.sub(o, a, o), this.focusOnTargetAndEye(a, o, e)
            }
        },
        focusOnSavedCamera: function (e) {
            var t = this._context.getModel().get("options"),
                i = Object(f.a)(),
                n = this._viewerOSGJS.getManipulator(),
                r = i.cameraTarget || t.camera.target,
                a = i.cameraEye || t.camera.position,
                o = a && null !== a[0];
            return o ? o && !this._features.camera.getModel().validateEyeTarget(a, r) ? n.computeHomePosition() : void this.focusOnTargetAndEye(r, a, e) : n.computeHomePosition()
        },
        updateFocusOnAutoHit: function () {
            if (!this._autoHit.get("focus")) return !0;
            var e = Object(w.d)(this._autoHit),
                t = this._features.camera.getManipulator().getCurrentManipulator(),
                i = t.getEyePosition(P.vec3.create()),
                n = t.getTarget(P.vec3.create()),
                r = P.vec3.create(),
                a = P.vec3.create();
            return 1 === Object(f.a)().cameraFollowBones ? (P.vec3.sub(a, e, n), P.vec3.add(r, i, a), P.vec3.copy(a, e)) : (P.vec3.sub(r, e, i), P.vec3.normalize(r, r), P.vec3.scale(r, r, P.vec3.dist(i, n)), P.vec3.sub(r, e, r), P.vec3.copy(a, e)), P.vec3.lerp(a, n, a, .25), P.vec3.lerp(r, i, r, .25), this.focusOnTargetAndEye(a, r, 0), !0
        },
        setInitialAnimation: function () {
            if (!this._features.camera.getModel().shouldPlayFirstCameraAnimation()) return void o.a.resolveFirstCameraAnimation();
            var e = P.vec3.create(),
                t = P.vec3.create(),
                i = this._viewerOSGJS.getManipulator();
            i.getEyePosition(t), i.getTarget(e);
            var n = [e[0] - t[0], e[1] - t[1], 0],
                r = n[0] > n[1] ? 0 : 1,
                a = 0 === r ? 1 : 0,
                s = P.vec3.create();
            s[a] = 1;
            var u = n[r] < 0 ? -1 : 1;
            s[2] = .2 * u;
            var l = 1.5 * y.a.getModelBoxWithDisplacement().radius();
            P.vec3.scale(s, s, 10 * l * u);
            var c = P.vec3.add(P.vec3.create(), t, s);
            i.setEyePosition(c), this.focusOnTargetAndEye(e, t, 2.5);
            var h = this._features.autospin.getModel();
            h.set("speed", -h.get("speed") * u)
        },
        focusOnHit: function (e, t, i) {
            var n = P.vec3.create();
            T.a.getWorldPositionFromHit(e, n);
            var r = this._features.camera.getManipulator().getCurrentManipulator(),
                a = r.getEyePosition(P.vec3.create()),
                o = r.getHomeDistance(r.getHomeBoundingSphere()),
                s = P.vec3.dist(n, a),
                u = i * o;
            s > u && (P.vec3.sub(a, n, a), P.vec3.normalize(a, a), P.vec3.scale(a, a, u), P.vec3.sub(a, n, a)), this.focusOnTargetAndEye(n, a, t, !0)
        },
        _focusDof: function (e, t) {
            var i = this._features.postProcess.getModel();
            T.a.getPixelDepth(e, t, function (e, t, n) {
                if (!(e < 0 || e >= 1)) {
                    var r = i.get("dofFocusPoint");
                    T.a.getWorldPositionFromDepthXY(e, t, n, r), i.trigger("change:dofFocusPoint", r)
                }
            })
        },
        onSingleClick: function () {
            var e = P.vec3.create(),
                t = P.vec3.create(),
                i = P.vec2.create();
            return function (n) {
                var r = n.canvasX,
                    a = n.canvasY,
                    o = this._features.postProcess.getModel();
                o.get("enable") && o.get("dofEnable") && this._focusDof(n.glX, n.glY);
                var s = "materials" === this.getCurrentTabName(),
                    u = this._features.inspector.getModel(),
                    l = "split" === u.get("splitType") || s,
                    c = this._viewerWebGL.getViewerAPI(),
                    h = c && c.intersectPoint || l,
                    d = this._features.ARKit.getModel();
                if (d.get("enable") && d.trigger("pick", P.vec2.fromValues(r, a)), h) {
                    var f = T.a.computeNearestIntersection2D(r, a);
                    if (l && this._singleClickOnInspector(f), f) {
                        var p = t,
                            m = c && c.intersectPoint ? e : void 0;
                        T.a.getWorldPositionFromHit(f, p, m), c && c.intersectPoint && (i[0] = r, i[1] = a, c.intersectPoint(f, p, i, m))
                    }
                }
            }
        }(),
        _singleClickOnInspector: function (e) {
            var t = e && T.a.getMaterialFromHit(e);
            if (!t) return void this._features.outline.getModel().trigger("hideOutline");
            var i = this._features.inspector.getModel(),
                n = t.get("id");
            i.get("material") === n ? i.trigger("change:material", i, n) : i.set("material", n)
        },
        onDoubleClick: function (e) {
            if (Object(f.a)().doubleClick) {
                var t = this._features.camera;
                if (!t.getModel().get("webVR") && t.canMoveTarget()) {
                    if (this._autoHit && this._autoHit.get("focus") && this._autoHit.set("focus", !1), e.pointers && e.pointers.length > 1) return void this.focusOnHomePosition(1);
                    var i = T.a.computeNearestIntersection2D(e.canvasX, e.canvasY);
                    if (!i) return void this.focusOnHomePosition(1);
                    var n = this.getCurrentTabName();
                    if ("virtual reality" === n) return void this._features.webVR.getModel().trigger("doubleTap", i);
                    "annotations" !== n && "sound" !== n && (Object(f.a)().cameraFollowBones && Object(s.a)(i._nodePath) ? (Object(w.b)(this._autoHit, i), this._autoHit.set("focus", !0)) : (this._features.outline.getModel().trigger("clearFocusTimeout"), this.focusOnHit(i, 1, .2)))
                }
            }
        },
        preloadMaxBackground: function () {
            var e = this._features.background;
            if (e) {
                var t = e.getModel();
                if (t && "fixed" === t.get("enable")) {
                    var i = t.getBackground();
                    if (i) {
                        var n = i.findImageNearestUpToResolution(window.screen.width, window.screen.height);
                        n && this.getResourceManager().getOrCreateTexture(n.url, {
                            minFilter: P.Texture.LINEAR,
                            magFilter: P.Texture.LINEAR,
                            transferToGPU: !1,
                            convertNPOT: !1,
                            internalFormat: P.Texture.RGB
                        })
                    }
                }
            }
        },
        applyAutospinToCamera: function (e, t) {
            var i = this._features.autospin;
            if (i) {
                var n = i.getNode().getMatrix();
                P.vec3.transformMat4(e, e, n), P.vec3.transformMat4(t, t, n)
            }
        },
        getCameraWithoutAutospin: function () {
            var e = P.mat4.create();
            return function (t, i) {
                var n = this._viewerOSGJS.getManipulator();
                n.getEyePosition(t), n.getTarget(i);
                var r = this._features.autospin;
                r && (P.mat4.invert(e, r.getNode().getMatrix()), P.vec3.transformMat4(t, t, e), P.vec3.transformMat4(i, i, e))
            }
        }(),
        createGizmoNode: function () {
            var e = new P.Camera;
            e.getOrCreateStateSet().setRenderBinDetails(d.a.EDITOR_GIZMO, "RenderBin");
            var t = this._nodeGizmo = new l.a(this._viewerOSGJS);
            t.setTraversalMask(h.a.PICK_GIZMO_LIGHT), e.addChild(t);
            var i = this._urlOptions.widgetAPI;
            if (i) {
                var n = this._features.orientation;
                i.getTabbedWidget().model.on("change:value", function () {
                    t.attachToNode(null), n && n.getModel().set("showGizmo", !1)
                })
            }
            return e
        },
        setManipulatorNode: function (e) {
            this._features.camera ? this._features.camera.getModel().set("node", e) : this._viewerOSGJS.getManipulator().setNode(e)
        },
        getNodeGizmo: function () {
            return this._nodeGizmo
        },
        initializePreciseBoundManager: function () {
            var e = this.getWorldNode();
            y.a.computePreciseBox(e);
            var t = y.a.getModelBoxWithDisplacement();
            e.getBoundingBox().copy(t);
            var i = e.getBoundingSphere();
            i.set(t.center(i.center()), t.radius()), T.a.init(this._context, this.getRootModel())
        },
        initGraph: function (e) {
            var t = this._features,
                i = new P.Node;
            i.getOrCreateStateSet().setAttributeAndModes(M.a.CULL_DISABLE), i.setName("FeatureManager - Root"), i.addChild(b.a), b.a.initReadyForHighResBound();
            var n = t.orientation,
                r = t.autospin,
                a = t.outline,
                o = t.ground,
                s = t.environment,
                u = t.lighting,
                l = t.camera,
                c = t.sound,
                h = t.hotspot,
                d = t.postProcess,
                f = t.webVR,
                p = t.ARKit,
                m = t.inspector,
                g = u.getNodeShadow(),
                v = i;
            d && (i.addChild(d.getNodeIn()), v = d.getNodeOut()), v.addChild(this.createGizmoNode(v)), v.addChild(g), v = g;
            for (var _ = [l, s, u, c, f, h, m, a, r, p, o, n], S = 0, x = _.length; S < x; ++S) {
                var y = _[S];
                if (y) {
                    var C = y.getNodeIn ? y.getNodeIn() : y.getNode(),
                        T = y.getNodeOut ? y.getNodeOut() : y.getNode();
                    v.addChild(C), v = T
                }
            }
            return v.addChild(e), i
        },
        addGlobalUniforms: function () {
            var e = this._features.postProcess,
                t = e.getNodeIn().getOrCreateStateSet();
            for (var i in _.a) t.addUniform(_.a[i])
        },
        finished: function (e) {
            var t = this._features,
                i = this.getRootModel();
            i.setNodeMask(h.a.PICK_GEOMETRY_SHADOW), i.setName("rootModel");
            var n = this._viewerOSGJS.getCamera();
            C.a.setCamera(n), i.addUpdateCallback(C.a);
            var r = this.initGraph(i);
            e.addChild(r), this.setManipulatorNode(this.getWorldNode()), this.preloadMaxBackground();
            var s = t.lighting;
            s && s.getModel().initLights(t.material.getSceneLights());
            var u = t.environment;
            u && u.getNode().init(n, s.getNodeShadow());
            if (window.sketchfabViewerStats.shadows > 1 && P.WebGLCaps.instance().getWebGLParameter("MAX_FRAGMENT_UNIFORM_VECTORS") < 65)
                for (var l = s.getModel().get("lights"), d = window.sketchfabViewerStats.shadows - 1, p = 0; p < 3 && 0 !== d; p++) {
                    var _ = l[p];
                    _.get("enable") && _.isCastingShadows() && (_._enableShadow = !1, d--)
                }
            return S.a.init(this._canvas, this._features.quality.getModel(), this._viewerOSGJS.getCanvasPixelRatio()), this.focusOnSavedCamera(), this._features.camera && this._features.camera.getModel().saveCameraPosition(), E.a.initGlobalClickEvents(this, this._canvas), this._viewerOSGJS.getInputManager().setEnable("global_click_events", !0), i.getOrCreateStateSet().setAttribute(new v.a), Object(f.a)().zz ? (i.accept(new g.a), o.a.getWireframeOptimizedSplit().then(function () {
                i.accept(new g.a), o.a.resolveWireframeOptimizedSplitCompressed()
            })) : o.a.getWireframeOptimizedSplit().then(o.a.resolveWireframeOptimizedSplitCompressed), this.addGlobalUniforms(), P.time("drawFirstFrame"), this._viewerWebGL.drawFrame(), P.timeEnd("drawFirstFrame"), this.initializePreciseBoundManager(), t.webVR && t.webVR.getModel().initAfterFirstFrame(), t.postProcess && t.postProcess.getModel().initAfterFirstFrame(), t.camera && t.camera.getModel().initAfterFirstFrame(), t.lighting && t.lighting.getModel().set("forceShadowRedraw", !0), P.time("drawSecondFrame"), this._viewerWebGL.drawFrame(), P.timeEnd("drawSecondFrame"), t.lighting && t.lighting.getModel().set("forceShadowRedraw", !1), Object(a.a)() && (o.a.getFirstAnimation().then(function () {
                this.registerOptionsJSON(this._viewerWebGL.getOptionsJSON())
            }.bind(this)), window.addEventListener("beforeunload", this.onBeforeUnload.bind(this), !1)), !Object(m.a)() && "onhashchange" in window && window.addEventListener("hashchange", this._hashChanged.bind(this), !1), Object(f.a)().debug3D && Object(c.a)(this, r), Object(f.a)().cameraFollowBones && (this._autoHit = new x.a, r.addUpdateCallback({
                update: this.updateFocusOnAutoHit.bind(this)
            })), r
        },
        _registerCollection: function (e) {
            e.each(function (e) {
                e.registerOptions()
            })
        },
        registerOptionsJSON: function (e) {
            this._lastOptions = Object(n.cloneDeep)(e);
            var t = this._features;
            this._registerCollection(t.animation.getModel().get("animations")), this._registerCollection(t.hotspot.getModel().get("hotspots"))
        },
        getUnsavedChanges: function () {
            var e = this._viewerWebGL.getOptionsJSON();
            return Object(n.reduce)(this._lastOptions, function (t, i, r) {
                return Object(n.isEqual)(i, e[r]) ? t : t.concat(r)
            }, [])
        },
        getUnsavedMessage: function () {
            var e = this.getUnsavedChanges();
            if (0 !== e.length) {
                var t = "You have unsaved changes:\n";
                return t += "- " + e.join("\n- "), t += "\n\nYou might want to save your changes before leaving."
            }
        },
        onBeforeUnload: function (e) {
            var t = this.getUnsavedMessage();
            return t && (e.returnValue = t), t
        },
        _hashChanged: function () {
            var e = {};
            e = Object(p.a)(e), this._features.material.getModel().overrideMaterialChannels(e);
            var t = Object(f.a)();
            !t.debug3D && Boolean(e.debug3D) && (t.debug3D = !0, Object(c.a)(this, this.getRootModel())), !t.stats && Boolean(e.stats) && (t.continuousRender = !0, t.stats = !0, this._viewerOSGJS.initStats({
                getBoolean: function (e) {
                    return "stats" === e
                }
            })), this._features.inspector.getModel().set("uiVisible", Boolean(e.inspector))
        },
        getShadowForcedUpdate: function () {
            return !!Object(f.a)().shadow && (!!A.a.getShadowForcedUpdate() || (!!this._viewerWebGL.getSuperSample().isEnabled() || (!!this._features.lighting.getModel().get("forceShadowRedraw") || (!!this._features.autospin.getModel().get("enable") || !!this._features.animation.getModel().isPlaying()))))
        }
    }, t.a = R
}, function (e, t, i) {
    "use strict";
    var n = i(0),
        r = (i.n(n), i(3)),
        a = i.n(r),
        o = i(9),
        s = i(47),
        u = i(943),
        l = i(44),
        c = i(85),
        h = i(921),
        d = i(715),
        f = i(159),
        p = i(88),
        m = i(937),
        g = i(713),
        v = i(199),
        _ = i(114),
        b = o.a.osg,
        S = o.a.osgAnimation,
        x = o.a.osgUtil,
        y = b.StateAttribute.OVERRIDE_ON,
        C = function () {
            b.NodeVisitor.call(this, b.NodeVisitor.TRAVERSE_PARENTS), this._paths = [], this._halt = void 0
        };
    b.createPrototypeObject(C, b.objectInherit(b.NodeVisitor.prototype, {
        reset: function () {
            b.NodeVisitor.prototype.reset.call(this), this._paths.length = 0
        },
        setHalt: function (e) {
            this._halt = e
        },
        apply: function (e) {
            e === this._halt && this._paths.push(this.nodePath.slice(1)), this.traverse(e)
        }
    }));
    var T = function (e) {
        b.NodeVisitor.call(this), this._cullCallback = e ? void 0 : h.a.hideCullCallback
    };
    b.createPrototypeObject(T, b.objectInherit(b.NodeVisitor.prototype, {
        apply: function (e) {
            e instanceof b.Geometry && e._isBoneBox && e.setCullCallback(this._cullCallback), this.traverse(e)
        }
    }));
    var w = function () {
            var e = x.DisplayGeometryVisitor.prototype.apply;
            x.DisplayGeometryVisitor.prototype.apply = function (t) {
                if (!t._isBoneBox && !t._isSkeleton) {
                    e.apply(this, arguments);
                    var i = t._originalStateSet;
                    void 0 !== i && t.getStateSet() && i !== t.getStateSet() && t.getStateSet().setRenderBinDetails(c.a.DEBUG, "RenderBin")
                }
            }
        },
        M = function (e) {
            var t = Object(n.invert)(c.a);
            e._graphRender.generateRenderBin = function (e, i) {
                var n = i.className() + " ( " + i.getInstanceID() + " )";
                i.getName() && (n += "\n" + i.getName());
                var r = i.getBinNumber();
                n += "\n" + t[r] || r, this._selectables.set(i.getInstanceID().toString(), i), e.addNode(i.getInstanceID(), {
                    label: n,
                    description: "",
                    style: "fill: " + this.getColorFromClassName(i.className()) + ";stroke-width: 0px;"
                })
            }
        },
        E = function () {
            var e = S.UpdateMorph.prototype.updateWeights;
            S.UpdateMorph.prototype.updateWeights = function () {
                if (void 0 !== this._debugActiveTarget) {
                    var t = parseInt(this._debugActiveTarget, 0);
                    if (-2 === t) {
                        var i = this._weights;
                        return void(i[0] = i[1] = i[2] = i[3] = 0)
                    }
                    if (-1 !== t)
                        for (var n = this._targets, r = 0, a = n.length; r < a; ++r) n[r].value = r === t ? 1 : 0
                }
                return e.call(this)
            }
        },
        A = function (e, t) {
            var i = function () {
                b.NodeVisitor.call(this, b.NodeVisitor.TRAVERSE_ALL_CHILDREN)
            };
            b.createPrototypeObject(i, b.objectInherit(b.NodeVisitor.prototype, {
                apply: function (t) {
                    for (var i = t.getUpdateCallbackList(), n = 0, r = i.length; n < r; ++n) {
                        var a = i[n];
                        if (a instanceof S.UpdateMorph) {
                            var o = {};
                            o.___DEFAULT = -1, o["___NO MORPH"] = -2;
                            for (var s = a._targetNames, u = 0, c = s.length; u < c; ++u) o[s[u]] = u;
                            a._debugActiveTarget = -1;
                            e.add(a, "_debugActiveTarget", o).name("Name " + a.getName()).onChange(l.a.draw)
                        }
                    }
                    this.traverse(t)
                }
            }));
            var n = new i;
            t._rootModel.accept(n)
        },
        P = function () {
            h.a.DrawBones.prototype.apply = function (e) {
                var t = e.getInstanceID();
                this._visitedNodes[t] || (this._visitedNodes[t] = !0, e instanceof S.Bone && this.drawBone(e), this.traverse(e))
            }
        },
        R = function (e, t) {
            this._fManager = e, this._viewerWebGL = e.getViewerWebGL(), this._rootModel = this._viewerWebGL.getRootModel(), this._rootFeature = t, this._debugNormal = !1, this._debugTangent = !1, this._debugScale = .5, this._baseScale = .07 * this._rootModel.getMinimumBound().radius(), this._normalVisitor = new m.a, this._normalVisitor.setScale(this._baseScale * this._debugScale), this._geoColorVisitor = new x.DisplayGeometryVisitor, this._geoColorVisitor._stCenter.setRenderBinDetails(c.a.DEBUG_2, "RenderBin"), this._geoColorVisitor._stCenter.setAttribute(new g.a(!0)), w(), this._debugGeometry = !1, this._debugSkinning = !1, this._debugShadow = !1, this._useGizmo = !1, this._useSync = !1, this._protoUpdateWeights = S.UpdateMorph.prototype.updateWeights, this._protoComputeChannels = S.UpdateMatrixTransform.prototype.computeChannels, this._enableRig = !0, this._collectPathVisitor = new C, this._collectPathVisitor.setHalt(this._fManager.getWorldNode()), this._drawBonesVisitor = new h.a.DrawBones([]), P(), this._showSkeleton = !1, this._showBoneBoxes = !1, this._graphVisitor = x.DisplayGraph.instance(), M(this._graphVisitor), this._debugGraphNode = "Model", this._debugGraphRenderer = !1, this._displayGraph = !1;
            var i = this._fManager.getFeatures().camera.getModel();
            this._enabledConstraints = i.get("enableCameraConstraints"), this._showConstraintsWidget = !1, v.a.initDebug3D(this)
        };
    R.prototype = {
        _getSaveAElement: function () {
            return this._aSave ? this._aSave : (this._aSave = document.createElement("a"), document.body.appendChild(this._aSave), this._aSave.style.display = "none", this._aSave)
        },
        _download: function (e, t) {
            var i = this._fManager._context.getModel("uid").get("uid") + "_";
            i += (new Date).toString().split(" ").splice(1, 4).join("_").replace(/:/g, "_"), i += ".";
            var n = this._getSaveAElement();
            n.href = e, n.download = i + t, n.click()
        },
        _getCameraModel: function () {
            return this._fManager.getFeatures().camera.getModel()
        },
        onTakeScreenShot: function () {
            Object(d.a)(2048, 2048, this._viewerWebGL).toBlob(function (e) {
                this._download(URL.createObjectURL(e), "png")
            }.bind(this), "png", 1)
        },
        onStartMovieRecord: function () {
            var e = document.getElementsByClassName("canvas")[0],
                t = e.captureStream(25),
                i = {
                    mimeType: "video/webm; codecs=vp9"
                };
            this._recorder = new window.MediaRecorder(t, i);
            var n = [],
                r = function (e) {
                    var t = window.URL.createObjectURL(e);
                    this._download(t, "webm")
                }.bind(this);
            this._recorder.ondataavailable = function (e) {
                e.data && e.data.size > 0 && n.push(e.data)
            }, this._recorder.onstop = function () {
                r(new Blob(n, {
                    type: "video/webm"
                }))
            }.bind(this), this._recorder.start()
        },
        onEndMovieRecord: function () {
            this._recorder && this._recorder.stop()
        },
        onTrianglePick: function (e) {
            if (!this._displayGraph) {
                var t = f.a.computeNearestIntersection2D(e.canvasX, e.canvasY);
                if (t) {
                    window.hit = t;
                    var i = t._nodePath[t._nodePath.length - 1];
                    console.log("Active hit : window.hit"), console.log("Name geometry : " + i.getName()), console.log("Vertex indices : " + t._i1 + ", " + t._i2 + ", " + t._i3), console.log("Unique id : " + i._uniqueID);
                    var n = {};
                    n[t._i1] = {}, n[t._i2] = {}, n[t._i3] = {};
                    var r = i.getVertexAttributeList();
                    for (var a in n) {
                        var o = n[a];
                        a = parseInt(a);
                        for (var s in r)
                            for (var u = r[s], l = u.getItemSize(), c = u.getElements(), h = o[s] = [], d = 0; d < l; ++d) h[d] = c[a * l + d]
                    }
                    t.verts = n, console.log("\n")
                }
            }
        },
        onDebugScale: function (e) {
            this._normalVisitor.setScale(this._baseScale * e), l.a.draw()
        },
        testCreateNormalVisitor: function () {
            this._normalVisitor._alreadyRun || (this._normalVisitor._alreadyRun = !0, this._normalVisitor.apply(this._rootModel))
        },
        onDebugNormal: function (e) {
            this.testCreateNormalVisitor(), this._normalVisitor.setNormalVisibility(e), l.a.draw()
        },
        onDebugTangent: function (e) {
            this.testCreateNormalVisitor(), this._normalVisitor.setTangentVisibility(e), l.a.draw()
        },
        onDebugGeometry: function () {
            this._debugGeometry ? this._geoColorVisitor.setGeometryDebug(this._rootModel) : this._debugSkinning ? this._geoColorVisitor.setSkinningDebug(this._rootModel) : this._geoColorVisitor.disableDebug(this._rootModel), l.a.draw()
        },
        onEnableCamConstraints: function () {
            var e = this._getCameraModel();
            e.set("enableCameraConstraints", !e.get("enableCameraConstraints"))
        },
        onShowConstraintsWidget: function () {
            var e = this._getCameraModel();
            e.set("displayGizmo", !e.get("displayGizmo")), e.trigger("refreshConstraints"), l.a.draw()
        },
        resetGraph: function () {
            this._viewerWebGL.getInputManager().setEnable(_.a.DEBUG_GEOMPICK, !1), this._graphVisitor.reset()
        },
        onDisplayGraph: function () {
            this.resetGraph(), this._displayGraph && (this._viewerWebGL.getInputManager().setEnable(_.a.DEBUG_GEOMPICK, !0), s.a.getModelDisplayed().then(this.createDebugGraph.bind(this)))
        },
        createDebugGraph: function () {
            var e;
            "Model" === this._debugGraphNode ? e = this._rootModel : "Feature" === this._debugGraphNode && (e = this._rootFeature), this._graphVisitor.setDisplayGraphRenderer(this._debugGraphRenderer), this._graphVisitor.createGraph(e), this._graphVisitor.setCallbackSelect(this.onNodeSelect.bind(this)), l.a.draw()
        },
        onDebugShadow: function (e) {
            var t = this._fManager.getFeatures().lighting;
            if (t) {
                t.getModel().set("forceShadowRedraw", e);
                for (var i = t.getModel().get("lights"), n = 0, r = i.length; n < r; ++n) {
                    var a = i[n];
                    a.getShadowMap() && (a.getShadowMap().setDebug(e), a.dirty())
                }
                l.a.draw()
            }
        },
        onPickSelect: function (e) {
            var t = this._fManager.getWorldNode(),
                i = f.a.computeNearestIntersection2D(e.glX, e.glY, void 0, t);
            i && (this._graphVisitor.selectNode(i._nodePath[i._nodePath.length - 1]), this._graphVisitor.focusOnGraph())
        },
        onNodeSelect: function (e) {
            if (e instanceof b.StateSet) {
                var t = this._fManager.getFeatures().outline.getModel();
                return t.set("durationOutline", 5), t.set("durationHighlight", 2.5), void t.trigger("displayOutlineFocus", e, 5, 2.5)
            }
            for (var i = e.getBoundingBox(), n = e.getWorldMatrices(this._fManager.getWorldNode()), r = new b.BoundingBox, a = 0; a < n.length; ++a) {
                var o = new b.BoundingBox;
                i.transformMat4(o, n[a]), r.expandByBoundingBox(o)
            }
            this._fManager.focusOnBound(r, 1), this._collectPathVisitor.reset(), e.accept(this._collectPathVisitor);
            var s = this._collectPathVisitor._paths,
                u = this._fManager.getFeatures().outline.getNode();
            u.clearOutlineScene(), u.addPaths(s), u.showOutline()
        },
        _getCameraUrl: function () {
            var e = b.vec3.create(),
                t = b.vec3.create();
            this._fManager.getCameraWithoutAutospin(e, t);
            var i = window.location.href;
            return i += "&camera_eye=" + e.join(",") + "&camera_target=" + t.join(",")
        },
        cameraClipboard: function () {
            var e = this._getCameraUrl(),
                t = document.createTextNode(e);
            document.body.appendChild(t);
            var i = document.createRange();
            i.selectNode(t), window.getSelection().removeAllRanges(), window.getSelection().addRange(i), document.execCommand("copy"), document.body.removeChild(t)
        },
        cameraOpen: function () {
            window.open(this._getCameraUrl())
        },
        onEnableRig: function (e) {
            S.UpdateMatrixTransform.prototype.computeChannels = e ? this._protoComputeChannels : function () {
                this._dirty = !0;
                var e = this._matrix;
                b.mat4.identity(e);
                for (var t = this._stackedTransforms, i = 0, n = t.length; i < n; i++) {
                    var r = t[i];
                    r.resetToDefaultValue(), r.applyToMatrix(e)
                }
            }, l.a.draw()
        },
        onShowSkeleton: function (e) {
            l.a.draw();
            var t = this._drawBonesVisitor;
            if (!e) return void t._geoStateSet.setAttributeAndModes(p.a.DEPTH_NEVER, y);
            t._geoStateSet.setAttributeAndModes(p.a.DEPTH_ALWAYS, y), t._alreadyRun || (t._alreadyRun = !0, this._rootModel.accept(t))
        },
        onShowBoneBoxes: function (e) {
            this._rootModel.accept(new T(e)), l.a.draw()
        },
        onUseGizmo: function (e) {
            this._gizmo || (this._gizmo = new u.a(this._fManager.getViewerOSGJS()), this._rootFeature.addChild(this._gizmo)), this._gizmo.attachToNode(null), this._gizmo.setAutoMatrixTransformInsertion(e), this._gizmo.setCorrectPivotOnAutoInsert(e), this._gizmo.setTraversalMask(e ? 1 : 0), l.a.draw()
        }
    };
    var O = function (e, t, i) {
            var n = e.addFolder("Debug graph"),
                r = {
                    Model: "Model",
                    Feature: "Feature",
                    None: "None"
                };
            return i._graphNode = n.add(t, "_debugGraphNode", r).name("Root"), i._graphNode.onChange(t.onDisplayGraph.bind(t)), i._graphRenderer = n.add(t, "_debugGraphRenderer").name("Renderer"), i._graphRenderer.onChange(t.onDisplayGraph.bind(t)), i._displayGraph = n.add(t, "_displayGraph").name("Display graph"), i._displayGraph.onChange(t.onDisplayGraph.bind(t)), n.open(), n
        },
        I = function (e, t, i) {
            var n = e.addFolder("Display vectors");
            return i._showNormal = n.add(t, "_debugNormal").name("Display normal"), i._showNormal.onChange(t.onDebugNormal.bind(t)), i._showTangent = n.add(t, "_debugTangent").name("Display tangent"), i._showTangent.onChange(t.onDebugTangent.bind(t)), i._vectorScale = n.add(t, "_debugScale").min(0).max(2).name("Scale vectors"), i._vectorScale.onChange(t.onDebugScale.bind(t)), n.open(), n
        },
        F = function (e, t, i) {
            var n = e.addFolder("Animation");
            return i._useRig = n.add(t, "_enableRig").name("Use rig"), i._useRig.onChange(t.onEnableRig.bind(t)), E(), A(n, t), i._showSkeleton = n.add(t, "_showSkeleton").name("Show skeleton"), i._showSkeleton.onChange(t.onShowSkeleton.bind(t)), i._showBoxes = n.add(t, "_showBoneBoxes").name("Show boxes"), i._showBoxes.onChange(t.onShowBoneBoxes.bind(t)), i._showSkinning = n.add(t, "_debugSkinning").name("Display skinning"), i._showSkinning.onChange(function (e) {
                e && t._debugGeometry && i._showGeometry.setValue(!1), t.onDebugGeometry()
            }), n.open(), n
        },
        N = function (e, t, i) {
            var n = e.addFolder("Camera");
            return i._enableConstraints = n.add(t, "_enabledConstraints").name("Constraints"), i._enableConstraints.onChange(t.onEnableCamConstraints.bind(t)), i._showConstraintsWidget = n.add(t, "_showConstraintsWidget").name("Show widget"), i._showConstraintsWidget.onChange(t.onShowConstraintsWidget.bind(t)), i._cameraClipboard = n.add(t, "cameraClipboard").name("Copy clipboard"), i._cameraOpen = n.add(t, "cameraOpen").name("Open new tab"), n.open(), n
        },
        D = function (e, t, i) {
            var n = e.addFolder("Misc");
            return i._showGeometry = n.add(t, "_debugGeometry").name("Display geometry"), i._showGeometry.onChange(function (e) {
                e && t._debugSkinning && i._showSkinning.setValue(!1), t.onDebugGeometry(), i._showSkinning.updateDisplay()
            }), i._gizmo = n.add(t, "_useGizmo").name("Use gizmo"), i._gizmo.onChange(t.onUseGizmo.bind(t)), n.add(t, "_debugShadow").name("Debug Shadow").onChange(t.onDebugShadow.bind(t)), n.add({
                ScreenShot: t.onTakeScreenShot.bind(t)
            }, "ScreenShot"), n.add({
                StartRec: t.onStartMovieRecord.bind(t)
            }, "StartRec"), n.add({
                StopRec: t.onEndMovieRecord.bind(t)
            }, "StopRec"), n.open(), n
        },
        L = function (e) {
            var t = new window.dat.GUI;
            t.domElement.style.paddingTop = "50px";
            var i = new R(this, e),
                n = {};
            O(t, i, n), I(t, i, n), F(t, i, n), N(t, i, n), D(t, i, n)
        },
        k = function (e, t) {
            var i = L.bind(e, t);
            a.a.getScript("https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.5/dat.gui.min.js").done(i)
        };
    t.a = k
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(179),
        a = n.a.osg,
        o = n.a.osgAnimation,
        s = a.BufferArray.randa,
        u = {},
        l = function (e, t) {
            if (t._QVT) return e._QVT = t._QVT, void(e._QVS = t._QVS);
            var i = t._minMax || t.computeMinMaxVertex(u),
                n = a.vec3.fromValues(i.xmax - i.xmin, i.ymax - i.ymin, i.zmax - i.zmin);
            a.vec3.div(n, n, s);
            var r = a.vec3.fromValues(i.xmin, i.ymin, i.zmin);
            t._QVT = r, t._QVS = n, e._QVT = r, e._QVS = n
        },
        c = function (e, t, i) {
            e._listQuantUV || (e._listQuantUV = []);
            var n = "uQUV" + i.substr(8),
                o = t._objQUV;
            if (o) return -1 === e._listQuantUV.indexOf(o) && e._listQuantUV.push(o), void(o.uniformName !== n && e._listQuantUV.push({
                uniformName: n,
                _QUV: o._QUV
            }));
            var s = t.computeMinMaxUV(u),
                l = a.vec4.fromValues(s.xmin, s.ymin, s.xmax - s.xmin, s.ymax - s.ymin);
            t._QUV = l, o = {
                uniformName: n,
                _QUV: l
            }, t._objQUV = o, e._listQuantUV.push(o), r.a[n] || (r.a[n] = a.Uniform.createFloat4(n))
        },
        h = function () {
            a.ComputeBoundsVisitor.call(this), this.nodeMaskOverride = -1
        };
    a.createPrototypeObject(h, a.objectInherit(a.NodeVisitor.prototype, {
        apply: function (e) {
            if (e instanceof a.Geometry == !1) return void this.traverse(e);
            var t = e.getSourceGeometry ? e.getSourceGeometry() : e,
                i = t instanceof o.MorphGeometry;
            if (!e._qcomp) {
                e._qcomp = !0;
                var n = e.getVertexAttributeList();
                if (!i) {
                    var r = n.Vertex;
                    r && l(e, r);
                    var s = n.Normal;
                    s && (s._QNOR = !0);
                    var u = n.Tangent;
                    u && (u._QTAN = !0)
                }
                for (var h in n) h.startsWith("TexCoord") && c(e, n[h], h)
            }
        }
    })), t.a = h
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(423),
        a = i(161),
        o = i(1481),
        s = i(1482),
        u = i(1483),
        l = i(1484),
        c = i(718),
        h = i(1485),
        d = i(1486),
        f = i(1487),
        p = i(1488),
        m = i(1489),
        g = i(1490),
        v = i(1491),
        _ = i(1492),
        b = i(1493),
        S = i(1494),
        x = i(1495),
        y = i(20),
        C = i(44),
        T = i(944),
        w = Object(y.a)().asyncShader,
        M = n.a.osg,
        E = n.a.osgShader,
        A = E.ShaderGenerator,
        P = function (e, t) {
            A.call(this), this.setShaderCompiler(e), this._materialHashCompiler = t || r.a.SHADING_COMPILER
        };
    M.createPrototypeObject(P, M.objectInherit(A.prototype, {
        getOrCreateProgram: function (e) {
            return r.a.CURRENT_COMPILER = this._materialHashCompiler, A.prototype.getOrCreateProgram.call(this, e)
        },
        _getProgram: function (e, t, i, n) {
            var r = this._cache[e];
            if (r && -1 === r.getAsyncCompiling()) return r;
            if (r) {
                var a = t._frameStamp._frame - r.getAsyncCompiling();
                return a < w ? (C.a.draw(), Object(T.a)(1), 1 === a && r.getCompilationResultAndLink(t.getGraphicContext()), r._placeHolder) : Object(T.c)() ? (r.getLinkResult(t.getGraphicContext()), i.length = 0, n.length = 0, this.getActiveAttributeList(t, i), this.getActiveTextureAttributeList(t, n), r.setActiveUniforms(this.getActiveUniforms(t, i, n)), r) : (Object(T.a)(1), r._placeHolder)
            }
        },
        _createProgram: function (e, t, i, n) {
            var r = A.prototype._createProgram.call(this, e, t, i, n);
            return -1 !== r.getAsyncCompiling() ? (this._waitingProgram || (this._waitingProgram = this._createWaitingProgram(t, i, n)), r.enableAsyncCompilation(this._waitingProgram, t._frameStamp._frame), this._waitingProgram) : r
        }
    }));
    var R = function (e, t, i, n) {
            e.addShaderGenerator(t, new P(i, n))
        },
        O = {},
        I = !1;
    O.register = function (e) {
        I || (I = !0, R(e, "lit-classic", a.a), R(e, "lit-pbr", a.a), R(e, "shadeless-classic", o.a), R(e, "shadeless-pbr", o.a), R(e, "matcap", s.a), R(e, "ground", u.a), R(e, "shadow-ao-bake", l.a), R(e, "earlyz", c.a, r.a.EARLYZ_COMPILER), R(e, "shadowcast", h.a, r.a.SHADOWCAST_COMPILER), R(e, "outline", d.a, r.a.SHADOWCAST_COMPILER), R(e, "wireframe", f.a, r.a.WIREFRAME_COMPILER), R(e, "shadow-ar", p.a), R(e, "inspector", m.a), R(e, "controller", g.a), R(e, "debugNormal", v.a), R(e, "debugTangent", _.a), R(e, "debugGeometry", b.a), R(e, "debugSkinning", S.a), R(e, "debugBoneBox", x.a))
    }, t.a = O
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(161),
        a = n.a.osg,
        o = function () {
            r.a.apply(this, arguments)
        };
    a.setStateAttributeConfig(o, {
        attribute: ["VertexCompression", "SketchfabMaterial", "Morph", "Skinning", "PointSize"],
        textureAttribute: ["Texture"]
    }), a.createPrototypeObject(o, a.objectInherit(r.a.prototype, {
        getCompilerName: function () {
            return "Shadeless"
        },
        getFragmentMain: function () {
            return "shadeless.frag"
        },
        getVertexMain: function () {
            return "shadeless.vert"
        },
        defineChannels: function () {
            var e = this._channels;
            this.defineChannel(e.AlbedoPBR), this.defineChannel(e.DiffusePBR), this.defineChannel(e.Opacity), this.defineChannel(e.Displacement), this.defineChannel(e.EmitColor), this.defineChannel(e.CavityPBR), this.defineChannel(e.AOPBR), this.defineChannel(e.DiffuseColor), this.defineChannel(e.DiffuseIntensity), -1 !== this._fragDefines.indexOf("#define HAS_OPACITY_REFRACTION") && (this._vertDefines.push("#define HAS_VIEW_NORMAL"), this._vertDefines.push("#define HAS_VIEW_VERTEX"))
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(161),
        a = n.a.osg,
        o = function () {
            r.a.apply(this, arguments)
        };
    a.setStateAttributeConfig(o, {
        attribute: ["VertexCompression", "SketchfabMaterial", "Morph", "Skinning", "PointSize"],
        textureAttribute: ["Texture"]
    }), a.createPrototypeObject(o, a.objectInherit(r.a.prototype, {
        getCompilerName: function () {
            return "Matcap"
        },
        getFragmentMain: function () {
            return "matcap.frag"
        },
        getVertexMain: function () {
            return "matcap.vert"
        },
        getChannelUV: function (e) {
            return "Matcap" === e.getName() ? "" : r.a.prototype.getChannelUV.call(this, e)
        },
        defineChannels: function () {
            var e = this._channels;
            this.defineChannel(e.Opacity), this.defineChannel(e.Displacement), this.defineChannel(e.NormalMap), this.defineChannel(e.BumpMap), this.defineChannel(e.Matcap)
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(161),
        a = n.a.osg,
        o = function () {
            r.a.apply(this, arguments)
        };
    a.setStateAttributeConfig(o, {
        attribute: ["SketchfabLight0", "SketchfabLight1", "SketchfabLight2", "SketchfabLight3", "ShadowReceive0", "ShadowReceive1", "ShadowReceive2", "ShadowReceive3", "GroundStateAttribute"],
        textureAttribute: ["Texture"]
    }), a.createPrototypeObject(o, a.objectInherit(r.a.prototype, {
        getCompilerName: function () {
            return "Ground"
        },
        getFragmentMain: function () {
            return "ground/ground.frag"
        },
        getVertexMain: function () {
            return "ground/ground.vert"
        },
        initAttributes: function (e) {
            for (var t = this._lights, i = this._shadows, n = 0, r = e.length; n < r; n++) {
                var a = e[n].className();
                "Light" === a ? t.push(e[n]) : "ShadowReceiveAttribute" === a ? i.push(e[n]) : "GroundStateAttribute" === a && (this._groundState = e[n])
            }
        },
        initDefines: function () {
            var e = this._groundState.isUseBakedAo(),
                t = this._groundState.isDisplayPlane();
            e ? this._fragDefines.push("#define BAKED_AO") : (this.defineLights(), this.defineShadows(), this._shadows.length && this._lights.length ? this._fragDefines.push("#define SHADOW_CATCHER") : this._fragDefines.push("#define PASS_THROUGH")), t && this._fragDefines.push("#define DISPLAY_PLANE"), this._vertDefines.push("attribute vec2 TexCoord0;"), this._vertDefines.push("varying vec2 vTexCoord0;"), this._vertAssignUV.push("vTexCoord0 = TexCoord0;")
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(718),
        a = n.a.osg,
        o = function () {
            r.a.apply(this, arguments)
        };
    a.setStateAttributeConfig(o, {
        attribute: ["VertexCompression", "SketchfabMaterial", "Morph", "Skinning", "ShadowCast"],
        textureAttribute: ["Texture"]
    }), a.createPrototypeObject(o, a.objectInherit(r.a.prototype, {
        getCompilerName: function () {
            return "ShadowBakeAo"
        },
        getFragmentMain: function () {
            return "ground/bakeShadowMap.frag"
        },
        getVertexMain: function () {
            return "ground/bakeShadowMap.vert"
        },
        defineChannels: function () {
            var e = this._channels;
            e && (this.defineChannel(e.Opacity), this.defineChannel(e.Displacement))
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(718),
        a = n.a.osg,
        o = function () {
            r.a.apply(this, arguments)
        };
    a.setStateAttributeConfig(o, {
        attribute: ["VertexCompression", "SketchfabMaterial", "Morph", "Skinning", "ShadowCast"],
        textureAttribute: ["Texture"]
    }), a.createPrototypeObject(o, a.objectInherit(r.a.prototype, {
        getCompilerName: function () {
            return "ShadowCastSkfb"
        },
        getFragmentMain: function () {
            return "shadowing/shadowCast.frag"
        },
        getVertexMain: function () {
            return "shadowing/shadowCast.vert"
        },
        defineChannels: function () {
            var e = this._channels;
            e && (this.defineChannel(e.Opacity), this.defineChannel(e.Displacement))
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(161),
        a = n.a.osg,
        o = function () {
            r.a.apply(this, arguments)
        };
    a.setStateAttributeConfig(o, {
        attribute: ["VertexCompression", "SketchfabMaterial", "Morph", "Skinning", "PointSize"],
        textureAttribute: ["Texture"]
    }), a.createPrototypeObject(o, a.objectInherit(r.a.prototype, {
        getCompilerName: function () {
            return "Outline"
        },
        getFragmentMain: function () {
            return "outline.frag"
        },
        getVertexMain: function () {
            return "outline.vert"
        },
        defineChannels: function () {
            var e = this._channels;
            this.defineChannel(e.Displacement)
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(161),
        a = n.a.osg,
        o = function () {
            r.a.apply(this, arguments)
        };
    a.setStateAttributeConfig(o, {
        attribute: ["VertexCompression", "SketchfabMaterial", "Morph", "Skinning"],
        textureAttribute: ["Texture"]
    }), a.createPrototypeObject(o, a.objectInherit(r.a.prototype, {
        getCompilerName: function () {
            return "Wireframe"
        },
        getFragmentMain: function () {
            return "wireframe.frag"
        },
        getVertexMain: function () {
            return "wireframe.vert"
        },
        defineChannels: function () {
            var e = this._channels;
            e && this.defineChannel(e.Displacement)
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(161),
        a = n.a.osg,
        o = function () {
            r.a.apply(this, arguments)
        };
    a.setStateAttributeConfig(o, {
        attribute: ["ShadowReceive0"],
        textureAttribute: ["Texture"]
    }), a.createPrototypeObject(o, a.objectInherit(r.a.prototype, {
        getCompilerName: function () {
            return "ShadowAr"
        },
        getFragmentMain: function () {
            return "ARKit/shadowAr.frag"
        },
        getVertexMain: function () {
            return "ARKit/shadowAr.vert"
        },
        initDefines: function () {
            this.defineShadows()
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(161),
        a = n.a.osg,
        o = function () {
            r.a.apply(this, arguments)
        };
    a.setStateAttributeConfig(o, {
        attribute: ["VertexCompression", "SketchfabMaterial", "Morph", "Skinning", "PointSize"],
        textureAttribute: ["Texture"]
    }), a.createPrototypeObject(o, a.objectInherit(r.a.prototype, {
        getCompilerName: function () {
            return "Inspector"
        },
        getFragmentMain: function () {
            return "inspector/inspector.frag"
        },
        getVertexMain: function () {
            return "inspector/inspector.vert"
        },
        defineChannels: function () {
            var e = this._channels;
            this.defineChannel(e.Opacity), this.defineChannel(e.Displacement), this.defineChannel(e.Inspector), e.Inspector.getTextureModel() && (this._fragDefines.push("#define HAS_INSPECTOR_TEXTURE"), e.Inspector.getSRGB() || this._fragDefines.push("#define CONVERT_INSPECTOR_TO_LINEAR"))
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(161),
        a = n.a.osg,
        o = function () {
            r.a.apply(this, arguments)
        };
    a.setStateAttributeConfig(o, {
        attribute: [],
        textureAttribute: []
    }), a.createPrototypeObject(o, a.objectInherit(r.a.prototype, {
        getCompilerName: function () {
            return "Controller"
        },
        getFragmentMain: function () {
            return "webVR/controller.frag"
        },
        getVertexMain: function () {
            return "webVR/controller.vert"
        },
        initDefines: function () {}
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(161),
        a = n.a.osg,
        o = function () {
            r.a.apply(this, arguments)
        };
    a.setStateAttributeConfig(o, {
        attribute: ["Morph", "Skinning", "PointSize"],
        textureAttribute: []
    }), a.createPrototypeObject(o, a.objectInherit(r.a.prototype, {
        getCompilerName: function () {
            return "DebugNormal"
        },
        getFragmentMain: function () {
            return "debug/normal.frag"
        },
        getVertexMain: function () {
            return "debug/normal.vert"
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(161),
        a = n.a.osg,
        o = function () {
            r.a.apply(this, arguments)
        };
    a.setStateAttributeConfig(o, {
        attribute: ["Morph", "Skinning", "PointSize"],
        textureAttribute: []
    }), a.createPrototypeObject(o, a.objectInherit(r.a.prototype, {
        getCompilerName: function () {
            return "DebugTangent"
        },
        getFragmentMain: function () {
            return "debug/tangent.frag"
        },
        getVertexMain: function () {
            return "debug/tangent.vert"
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(161),
        a = n.a.osg,
        o = function () {
            r.a.apply(this, arguments)
        };
    a.setStateAttributeConfig(o, {
        attribute: ["VertexCompression", "Morph", "Skinning", "PointSize"],
        textureAttribute: []
    }), a.createPrototypeObject(o, a.objectInherit(r.a.prototype, {
        getCompilerName: function () {
            return "DebugGeometry"
        },
        getFragmentMain: function () {
            return "debug/geometry.frag"
        },
        getVertexMain: function () {
            return "debug/geometry.vert"
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(161),
        a = n.a.osg,
        o = function () {
            r.a.apply(this, arguments)
        };
    a.setStateAttributeConfig(o, {
        attribute: ["VertexCompression", "Morph", "Skinning", "PointSize"],
        textureAttribute: []
    }), a.createPrototypeObject(o, a.objectInherit(r.a.prototype, {
        getCompilerName: function () {
            return "DebugSkinning"
        },
        getFragmentMain: function () {
            return "debug/skinning.frag"
        },
        getVertexMain: function () {
            return "debug/skinning.vert"
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(9),
        r = i(161),
        a = n.a.osg,
        o = function () {
            r.a.apply(this, arguments)
        };
    a.setStateAttributeConfig(o, {
        attribute: ["VertexCompression"],
        textureAttribute: []
    }), a.createPrototypeObject(o, a.objectInherit(r.a.prototype, {
        getCompilerName: function () {
            return "DebugBoneBox"
        },
        getFragmentMain: function () {
            return "debug/boneBox.frag"
        },
        getVertexMain: function () {
            return "debug/boneBox.vert"
        }
    })), t.a = o
}, function (e, t, i) {
    "use strict";
    var n = i(77),
        r = i(20),
        a = i(632),
        o = i(581),
        s = i(38),
        u = i.n(s),
        l = function (e, t) {
            this._key = e, this._progress = 0, this._weight = 0, this._active = !1, this._progressUpdate = t, this._promises, this._nbPromisesDone = 0, this._lastSetPromiseId = 0, this._cbFakeUpdate, this._refTime, this._totalBytes = 0
        };
    l.prototype = {
        setPromises: function (e) {
            this._progress = 0, this._promises = e, this._nbPromisesDone = 0, this._totalBytes = 0, this._lastSetPromiseId++, this._cbFakeUpdate = this._onPromiseAutoUpdate.bind(this, this._lastSetPromiseId);
            for (var t = 0; t < this._promises.length; ++t) {
                var i = this._promises[t];
                i.finally(this._onPromiseDone.bind(this, this._lastSetPromiseId, i.size || 0)), this._totalBytes += this._promises[t].progressSize || 0
            }
            window.setTimeout(this._cbFakeUpdate, 100), this._updateRefTime()
        },
        _updateRefTime: function () {
            this._refTime = (new Date).getTime()
        },
        _onPromiseDone: function (e, t) {
            this._lastSetPromiseId === e && (this._totalBytes -= t, this._updateRefTime(), this._nbPromisesDone++, this._progress = this._nbPromisesDone / this._promises.length, this._progressUpdate(this))
        },
        _onPromiseAutoUpdate: function (e) {
            if (this._lastSetPromiseId === e) {
                var t = this._promises.length;
                if (this._nbPromisesDone !== t) {
                    var i = 2e-4 * ((new Date).getTime() - this._refTime),
                        n = this._nbPromisesDone / t,
                        r = (this._nbPromisesDone + 1) / t;
                    this._progress = r - (r - n) / (i * i + 1), this._progressUpdate(this), window.setTimeout(this._cbFakeUpdate, 100)
                }
            }
        }
    };
    var c = function (e) {
        this._triggerProgress = e, this._primaryChannels = [], this._secondaryChannels = [], this._init()
    };
    c.prototype = {
        _init: function () {
            var e = this._updateChannelProgress.bind(this, !1),
                t = this._primaryChannels;
            t.push(new l("texture", e)), t.push(new l("polygon", e)), t.push(new l("osgjs", e)), t.push(new l("wireframe", e));
            var i = this._updateChannelProgress.bind(this, !0),
                n = this._secondaryChannels;
            n.push(new l("texture", i)), n.push(new l("environment", i)), n.push(new l("background", i)), n.push(new l("wireframe", i))
        },
        initPrimaryProgress: function (e, t, i) {
            var n = this._getProgressChannel("texture", !1),
                r = this._getProgressChannel("polygon", !1),
                a = this._getProgressChannel("osgjs", !1),
                o = this._getProgressChannel("wireframe", !1);
            n._totalBytes = this._estimateTexturesSize(), r._totalBytes = t, a._totalBytes = e, o._totalBytes = i, n._active = !0, r._active = !0, a._active = !0, o._active = i > 0, this._autoComputeWeights()
        },
        _estimateTexturesSize: function () {
            var e = n.default.instance.getTextureCollection().models,
                t = e.length;
            if (!t) return 0;
            if (!Object(r.a)().preload) return 5e3 * t;
            var i, s = 0,
                l = 0,
                c = Object(a.a)();
            for (i = 0; i < t; ++i) {
                var h = e[i].findImageNearestPowerOfTwoUpToResolution(c, c);
                l += h.width * h.height, s = Math.max(s, h.width, h.height)
            }
            var d = Object(r.a)().pixelBudget;
            void 0 === d && (d = u.a.any ? 6144 : 12288), d *= d;
            var f = Math.min(c, Math.sqrt(d / t));
            f = o.a.snapToPowerOf2(f, .75), (s <= c || l <= f * f) && (f = c);
            var p = 0;
            for (i = 0; i < t; ++i) p += e[i].findImageNearestPowerOfTwoUpToResolution(f, f).size;
            return p
        },
        _getProgressChannel: function (e, t) {
            for (var i = t ? this._secondaryChannels : this._primaryChannels, n = 0; n < i.length; ++n)
                if (i[n]._key === e) return i[n]
        },
        _autoComputeWeights: function (e) {
            var t = e ? this._secondaryChannels : this._primaryChannels,
                i = 0,
                n = 0,
                r = 0,
                a = 0;
            for (n = 0; n < t.length; ++n) t[n]._active && (i++, r += t[n]._totalBytes, t[n]._totalBytes || a++);
            var o = 1 / i,
                s = 1 - o * a;
            for (n = 0; n < t.length; ++n)
                if (t[n]._active) {
                    var u = t[n]._totalBytes;
                    t[n]._weight = u ? s * u / r : o
                } else t[n]._weight = 0
        },
        _updateChannelProgress: function (e, t) {
            var i = e ? this._secondaryChannels : this._primaryChannels;
            e && !t._active && (t._active = !0, this._autoComputeWeights(!0));
            var n = 0,
                r = 0;
            for (r = 0; r < i.length; ++r) n += i[r]._progress * i[r]._weight;
            var a = e ? "secondary-progress" : "primary-progress";
            if (this._triggerProgress(a, {
                    progress: n
                }), 1 === n)
                for (r = 0; r < i.length; ++r) i[r]._active = !1
        },
        updateProgress: function (e, t, i) {
            var n = this._getProgressChannel(i, t);
            n._progress = e, this._updateChannelProgress(t, n)
        },
        setFakeProgress: function (e, t, i) {
            var n = this._getProgressChannel(i, t);
            if (!n) return void console.error("Unexpected progress channel key : " + i);
            void 0 === e.length && (e = [e]), n.setPromises(e), t || this._autoComputeWeights()
        }
    }, t.a = c
}]);
//# sourceMappingURL=viewer-130af2663154eacf2a75.js.map