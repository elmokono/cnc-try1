//search for "compute KdTree" -> rip(n)
function rip(temp1)
{
    var geomNodes = [];
    function recurse(node)
    {
        if (node.className() == 'Node') geomNodes.push(node);
        if (node.children.length) {
            for (var i = 0; i < node.children.length; ++i) {
                recurse(node.children[i]);
            }
        }
    }
    recurse(temp1);

    for (var tt = 0; tt <  geomNodes.length; tt++) {

        if ( geomNodes[tt]._name == null || geomNodes[tt]._name == 'rootModel') {
            continue;
        }

        console.log('processing mesh ' + tt + ': ' +  geomNodes[tt]._name);
        var vertexOffset = 0;
        var objV = '';
        var objN = '';
        var objF = '';

        var submeshes =  geomNodes[tt].children;
        for (var n = 0; n < submeshes.length; n++) {

            var sw = false; //face order switcher

            if (submeshes[n]._attributes == null){ continue; }

            console.log('processing submesh ' + n);
            var vertices = submeshes[n]._attributes.Vertex._elements;
            for (var i = 0; i < vertices.length; i += 3) {
                objV += 'v ';
                for (j = 0; j < 3; ++j) {
                    objV += vertices[i + j].toFixed(4) + ' ';
                }
                objV += '\n';
            }

            var normals = submeshes[n]._attributes.Normal._elements;
            for (var i = 0; i < normals.length; i += 3) {
                objN += 'vn ';
                for (j = 0; j < 3; ++j) {
                    objN += normals[i + j].toFixed(4) + ' ';
                }
                objN += '\n';
            }

            var primitives = submeshes[n]._primitives;
            for (p = 0; p < primitives.length; p++) {

                var faces = primitives[p].indices._elements;
                for (j = 0; j + 2 < faces.length; primitives[p].mode == 4 ? j += 3 : ++j) {

                    if (faces[j] != faces[j + 1] && faces[j + 1] != faces[j + 2] && faces[j] != faces[j + 2]) {
                        if (primitives[p].mode == 4) sw = false;
                        objF += 'f ';                        
                        
                        objF +=
                            (faces[j + (sw ? 2 : 0)] + vertexOffset + 1) + '//' + (faces[j + (sw ? 2 : 0)] + vertexOffset + 1) +
                            ' ' + (faces[j + 1] + vertexOffset + 1) + '//' + (faces[j + 1] + vertexOffset + 1) +
                            ' ' + (faces[j + (sw ? 0 : 2)] + vertexOffset + 1) + '//' + (faces[j + (sw ? 0 : 2)] + vertexOffset + 1);
                        
                        objF += '\n';
                    }
                    sw = !sw;

                }
            }

            vertexOffset += vertices.length / 3;
        } //submeshes

        var obj = 'g model\n\n' + objV + ' \n' + objN + '\n' + objF;

        //download
        var fileNameToSaveAs =  document.getElementsByClassName('model-name__label')[0].innerHTML + '.' + geomNodes[tt]._name + ".obj";
        var textFileAsBlob = new Blob([obj], {
            type: 'text/plain'
        });
        var downloadLink = document.createElement("a");
        downloadLink.download = fileNameToSaveAs;
        downloadLink.innerHTML = "Download File";
        downloadLink.href = window.webkitURL.createObjectURL(textFileAsBlob);
        downloadLink.click();
        textFileAsBlob = null;
    }
}

//viewer here
webpackJsonp([33],[,function(e,t,i){(function(e){!function(t,i){e.exports=i()}(0,function(){"use strict";function t(){return Er.apply(null,arguments)}function r(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function a(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function n(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}function o(e){return void 0===e}function s(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function u(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function l(e,t){var i,r=[];for(i=0;i<e.length;++i)r.push(t(e[i],i));return r}function c(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function h(e,t){for(var i in t)c(t,i)&&(e[i]=t[i]);return c(t,"toString")&&(e.toString=t.toString),c(t,"valueOf")&&(e.valueOf=t.valueOf),e}function d(e,t,i,r){return Tt(e,t,i,r,!0).utc()}function p(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function f(e){return null==e._pf&&(e._pf=p()),e._pf}function m(e){if(null==e._isValid){var t=f(e),i=Lr.call(t.parsedDateParts,function(e){return null!=e}),r=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&i);if(e._strict&&(r=r&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return r;e._isValid=r}return e._isValid}function g(e){var t=d(NaN);return null!=e?h(f(t),e):f(t).userInvalidated=!0,t}function _(e,t){var i,r,a;if(o(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),o(t._i)||(e._i=t._i),o(t._f)||(e._f=t._f),o(t._l)||(e._l=t._l),o(t._strict)||(e._strict=t._strict),o(t._tzm)||(e._tzm=t._tzm),o(t._isUTC)||(e._isUTC=t._isUTC),o(t._offset)||(e._offset=t._offset),o(t._pf)||(e._pf=f(t)),o(t._locale)||(e._locale=t._locale),Pr.length>0)for(i=0;i<Pr.length;i++)r=Pr[i],a=t[r],o(a)||(e[r]=a);return e}function v(e){_(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===Ar&&(Ar=!0,t.updateOffset(this),Ar=!1)}function b(e){return e instanceof v||null!=e&&null!=e._isAMomentObject}function y(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function x(e){var t=+e,i=0;return 0!==t&&isFinite(t)&&(i=y(t)),i}function S(e,t,i){var r,a=Math.min(e.length,t.length),n=Math.abs(e.length-t.length),o=0;for(r=0;r<a;r++)(i&&e[r]!==t[r]||!i&&x(e[r])!==x(t[r]))&&o++;return o+n}function M(e){!1===t.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function w(e,i){var r=!0;return h(function(){if(null!=t.deprecationHandler&&t.deprecationHandler(null,e),r){for(var a,n=[],o=0;o<arguments.length;o++){if(a="","object"==typeof arguments[o]){a+="\n["+o+"] ";for(var s in arguments[0])a+=s+": "+arguments[0][s]+", ";a=a.slice(0,-2)}else a=arguments[o];n.push(a)}M(e+"\nArguments: "+Array.prototype.slice.call(n).join("")+"\n"+(new Error).stack),r=!1}return i.apply(this,arguments)},i)}function T(e,i){null!=t.deprecationHandler&&t.deprecationHandler(e,i),Dr[e]||(M(i),Dr[e]=!0)}function C(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function E(e){var t,i;for(i in e)t=e[i],C(t)?this[i]=t:this["_"+i]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function L(e,t){var i,r=h({},e);for(i in t)c(t,i)&&(a(e[i])&&a(t[i])?(r[i]={},h(r[i],e[i]),h(r[i],t[i])):null!=t[i]?r[i]=t[i]:delete r[i]);for(i in e)c(e,i)&&!c(t,i)&&a(e[i])&&(r[i]=h({},r[i]));return r}function P(e){null!=e&&this.set(e)}function A(e,t,i){var r=this._calendar[e]||this._calendar.sameElse;return C(r)?r.call(t,i):r}function D(e){var t=this._longDateFormat[e],i=this._longDateFormat[e.toUpperCase()];return t||!i?t:(this._longDateFormat[e]=i.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])}function O(){return this._invalidDate}function k(e){return this._ordinal.replace("%d",e)}function R(e,t,i,r){var a=this._relativeTime[i];return C(a)?a(e,t,i,r):a.replace(/%d/i,e)}function I(e,t){var i=this._relativeTime[e>0?"future":"past"];return C(i)?i(t):i.replace(/%s/i,t)}function F(e,t){var i=e.toLowerCase();Nr[i]=Nr[i+"s"]=Nr[t]=e}function N(e){return"string"==typeof e?Nr[e]||Nr[e.toLowerCase()]:void 0}function V(e){var t,i,r={};for(i in e)c(e,i)&&(t=N(i))&&(r[t]=e[i]);return r}function B(e,t){Vr[e]=t}function U(e){var t=[];for(var i in e)t.push({unit:i,priority:Vr[i]});return t.sort(function(e,t){return e.priority-t.priority}),t}function j(e,t,i){var r=""+Math.abs(e),a=t-r.length;return(e>=0?i?"+":"":"-")+Math.pow(10,Math.max(0,a)).toString().substr(1)+r}function G(e,t,i,r){var a=r;"string"==typeof r&&(a=function(){return this[r]()}),e&&(Gr[e]=a),t&&(Gr[t[0]]=function(){return j(a.apply(this,arguments),t[1],t[2])}),i&&(Gr[i]=function(){return this.localeData().ordinal(a.apply(this,arguments),e)})}function Y(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function H(e){var t,i,r=e.match(Br);for(t=0,i=r.length;t<i;t++)Gr[r[t]]?r[t]=Gr[r[t]]:r[t]=Y(r[t]);return function(t){var a,n="";for(a=0;a<i;a++)n+=C(r[a])?r[a].call(t,e):r[a];return n}}function z(e,t){return e.isValid()?(t=W(t,e.localeData()),jr[t]=jr[t]||H(t),jr[t](e)):e.localeData().invalidDate()}function W(e,t){function i(e){return t.longDateFormat(e)||e}var r=5;for(Ur.lastIndex=0;r>=0&&Ur.test(e);)e=e.replace(Ur,i),Ur.lastIndex=0,r-=1;return e}function q(e,t,i){oa[e]=C(t)?t:function(e,r){return e&&i?i:t}}function X(e,t){return c(oa,e)?oa[e](t._strict,t._locale):new RegExp(J(e))}function J(e){return K(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,i,r,a){return t||i||r||a}))}function K(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function $(e,t){var i,r=t;for("string"==typeof e&&(e=[e]),s(t)&&(r=function(e,i){i[t]=x(e)}),i=0;i<e.length;i++)sa[e[i]]=r}function Q(e,t){$(e,function(e,i,r,a){r._w=r._w||{},t(e,r._w,r,a)})}function Z(e,t,i){null!=t&&c(sa,e)&&sa[e](t,i._a,i,e)}function ee(e){return te(e)?366:365}function te(e){return e%4==0&&e%100!=0||e%400==0}function ie(){return te(this.year())}function re(e,i){return function(r){return null!=r?(ne(this,e,r),t.updateOffset(this,i),this):ae(this,e)}}function ae(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function ne(e,t,i){e.isValid()&&!isNaN(i)&&("FullYear"===t&&te(e.year())&&1===e.month()&&29===e.date()?e._d["set"+(e._isUTC?"UTC":"")+t](i,e.month(),le(i,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](i))}function oe(e){return e=N(e),C(this[e])?this[e]():this}function se(e,t){if("object"==typeof e){e=V(e);for(var i=U(e),r=0;r<i.length;r++)this[i[r].unit](e[i[r].unit])}else if(e=N(e),C(this[e]))return this[e](t);return this}function ue(e,t){return(e%t+t)%t}function le(e,t){if(isNaN(e)||isNaN(t))return NaN;var i=ue(t,12);return e+=(t-i)/12,1===i?te(e)?29:28:31-i%7%2}function ce(e,t){return e?r(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||ba).test(t)?"format":"standalone"][e.month()]:r(this._months)?this._months:this._months.standalone}function he(e,t){return e?r(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[ba.test(t)?"format":"standalone"][e.month()]:r(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function de(e,t,i){var r,a,n,o=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)n=d([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(n,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(n,"").toLocaleLowerCase();return i?"MMM"===t?(a=_a.call(this._shortMonthsParse,o),-1!==a?a:null):(a=_a.call(this._longMonthsParse,o),-1!==a?a:null):"MMM"===t?-1!==(a=_a.call(this._shortMonthsParse,o))?a:(a=_a.call(this._longMonthsParse,o),-1!==a?a:null):-1!==(a=_a.call(this._longMonthsParse,o))?a:(a=_a.call(this._shortMonthsParse,o),-1!==a?a:null)}function pe(e,t,i){var r,a,n;if(this._monthsParseExact)return de.call(this,e,t,i);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(a=d([2e3,r]),i&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(a,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(a,"").replace(".","")+"$","i")),i||this._monthsParse[r]||(n="^"+this.months(a,"")+"|^"+this.monthsShort(a,""),this._monthsParse[r]=new RegExp(n.replace(".",""),"i")),i&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(i&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!i&&this._monthsParse[r].test(e))return r}}function fe(e,t){var i;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=x(t);else if(t=e.localeData().monthsParse(t),!s(t))return e;return i=Math.min(e.date(),le(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,i),e}function me(e){return null!=e?(fe(this,e),t.updateOffset(this,!0),this):ae(this,"Month")}function ge(){return le(this.year(),this.month())}function _e(e){return this._monthsParseExact?(c(this,"_monthsRegex")||be.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(c(this,"_monthsShortRegex")||(this._monthsShortRegex=Sa),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function ve(e){return this._monthsParseExact?(c(this,"_monthsRegex")||be.call(this),e?this._monthsStrictRegex:this._monthsRegex):(c(this,"_monthsRegex")||(this._monthsRegex=Ma),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function be(){function e(e,t){return t.length-e.length}var t,i,r=[],a=[],n=[];for(t=0;t<12;t++)i=d([2e3,t]),r.push(this.monthsShort(i,"")),a.push(this.months(i,"")),n.push(this.months(i,"")),n.push(this.monthsShort(i,""));for(r.sort(e),a.sort(e),n.sort(e),t=0;t<12;t++)r[t]=K(r[t]),a[t]=K(a[t]);for(t=0;t<24;t++)n[t]=K(n[t]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function ye(e,t,i,r,a,n,o){var s=new Date(e,t,i,r,a,n,o);return e<100&&e>=0&&isFinite(s.getFullYear())&&s.setFullYear(e),s}function xe(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&e>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function Se(e,t,i){var r=7+t-i;return-(7+xe(e,0,r).getUTCDay()-t)%7+r-1}function Me(e,t,i,r,a){var n,o,s=(7+i-r)%7,u=Se(e,r,a),l=1+7*(t-1)+s+u;return l<=0?(n=e-1,o=ee(n)+l):l>ee(e)?(n=e+1,o=l-ee(e)):(n=e,o=l),{year:n,dayOfYear:o}}function we(e,t,i){var r,a,n=Se(e.year(),t,i),o=Math.floor((e.dayOfYear()-n-1)/7)+1;return o<1?(a=e.year()-1,r=o+Te(a,t,i)):o>Te(e.year(),t,i)?(r=o-Te(e.year(),t,i),a=e.year()+1):(a=e.year(),r=o),{week:r,year:a}}function Te(e,t,i){var r=Se(e,t,i),a=Se(e+1,t,i);return(ee(e)-r+a)/7}function Ce(e){return we(e,this._week.dow,this._week.doy).week}function Ee(){return this._week.dow}function Le(){return this._week.doy}function Pe(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Ae(e){var t=we(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function De(e,t){return"string"!=typeof e?e:isNaN(e)?(e=t.weekdaysParse(e),"number"==typeof e?e:null):parseInt(e,10)}function Oe(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function ke(e,t){return e?r(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]:r(this._weekdays)?this._weekdays:this._weekdays.standalone}function Re(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Ie(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Fe(e,t,i){var r,a,n,o=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)n=d([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(n,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(n,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(n,"").toLocaleLowerCase();return i?"dddd"===t?(a=_a.call(this._weekdaysParse,o),-1!==a?a:null):"ddd"===t?(a=_a.call(this._shortWeekdaysParse,o),-1!==a?a:null):(a=_a.call(this._minWeekdaysParse,o),-1!==a?a:null):"dddd"===t?-1!==(a=_a.call(this._weekdaysParse,o))?a:-1!==(a=_a.call(this._shortWeekdaysParse,o))?a:(a=_a.call(this._minWeekdaysParse,o),-1!==a?a:null):"ddd"===t?-1!==(a=_a.call(this._shortWeekdaysParse,o))?a:-1!==(a=_a.call(this._weekdaysParse,o))?a:(a=_a.call(this._minWeekdaysParse,o),-1!==a?a:null):-1!==(a=_a.call(this._minWeekdaysParse,o))?a:-1!==(a=_a.call(this._weekdaysParse,o))?a:(a=_a.call(this._shortWeekdaysParse,o),-1!==a?a:null)}function Ne(e,t,i){var r,a,n;if(this._weekdaysParseExact)return Fe.call(this,e,t,i);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(a=d([2e3,1]).day(r),i&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(a,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(a,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(a,"").replace(".",".?")+"$","i")),this._weekdaysParse[r]||(n="^"+this.weekdays(a,"")+"|^"+this.weekdaysShort(a,"")+"|^"+this.weekdaysMin(a,""),this._weekdaysParse[r]=new RegExp(n.replace(".",""),"i")),i&&"dddd"===t&&this._fullWeekdaysParse[r].test(e))return r;if(i&&"ddd"===t&&this._shortWeekdaysParse[r].test(e))return r;if(i&&"dd"===t&&this._minWeekdaysParse[r].test(e))return r;if(!i&&this._weekdaysParse[r].test(e))return r}}function Ve(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=De(e,this.localeData()),this.add(e-t,"d")):t}function Be(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function Ue(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=Oe(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function je(e){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||He.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(c(this,"_weekdaysRegex")||(this._weekdaysRegex=La),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Ge(e){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||He.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(c(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Pa),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Ye(e){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||He.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(c(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Aa),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function He(){function e(e,t){return t.length-e.length}var t,i,r,a,n,o=[],s=[],u=[],l=[];for(t=0;t<7;t++)i=d([2e3,1]).day(t),r=this.weekdaysMin(i,""),a=this.weekdaysShort(i,""),n=this.weekdays(i,""),o.push(r),s.push(a),u.push(n),l.push(r),l.push(a),l.push(n);for(o.sort(e),s.sort(e),u.sort(e),l.sort(e),t=0;t<7;t++)s[t]=K(s[t]),u[t]=K(u[t]),l[t]=K(l[t]);this._weekdaysRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+o.join("|")+")","i")}function ze(){return this.hours()%12||12}function We(){return this.hours()||24}function qe(e,t){G(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function Xe(e,t){return t._meridiemParse}function Je(e){return"p"===(e+"").toLowerCase().charAt(0)}function Ke(e,t,i){return e>11?i?"pm":"PM":i?"am":"AM"}function $e(e){return e?e.toLowerCase().replace("_","-"):e}function Qe(e){for(var t,i,r,a,n=0;n<e.length;){for(a=$e(e[n]).split("-"),t=a.length,i=$e(e[n+1]),i=i?i.split("-"):null;t>0;){if(r=Ze(a.slice(0,t).join("-")))return r;if(i&&i.length>=t&&S(a,i,!0)>=t-1)break;t--}n++}return null}function Ze(t){var r=null;if(!Ia[t]&&void 0!==e&&e&&e.exports)try{r=Da._abbr;i(473)("./"+t),et(r)}catch(e){}return Ia[t]}function et(e,t){var i;return e&&(i=o(t)?rt(e):tt(e,t))&&(Da=i),Da._abbr}function tt(e,t){if(null!==t){var i=Ra;if(t.abbr=e,null!=Ia[e])T("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=Ia[e]._config;else if(null!=t.parentLocale){if(null==Ia[t.parentLocale])return Fa[t.parentLocale]||(Fa[t.parentLocale]=[]),Fa[t.parentLocale].push({name:e,config:t}),null;i=Ia[t.parentLocale]._config}return Ia[e]=new P(L(i,t)),Fa[e]&&Fa[e].forEach(function(e){tt(e.name,e.config)}),et(e),Ia[e]}return delete Ia[e],null}function it(e,t){if(null!=t){var i,r,a=Ra;r=Ze(e),null!=r&&(a=r._config),t=L(a,t),i=new P(t),i.parentLocale=Ia[e],Ia[e]=i,et(e)}else null!=Ia[e]&&(null!=Ia[e].parentLocale?Ia[e]=Ia[e].parentLocale:null!=Ia[e]&&delete Ia[e]);return Ia[e]}function rt(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Da;if(!r(e)){if(t=Ze(e))return t;e=[e]}return Qe(e)}function at(){return Or(Ia)}function nt(e){var t,i=e._a;return i&&-2===f(e).overflow&&(t=i[la]<0||i[la]>11?la:i[ca]<1||i[ca]>le(i[ua],i[la])?ca:i[ha]<0||i[ha]>24||24===i[ha]&&(0!==i[da]||0!==i[pa]||0!==i[fa])?ha:i[da]<0||i[da]>59?da:i[pa]<0||i[pa]>59?pa:i[fa]<0||i[fa]>999?fa:-1,f(e)._overflowDayOfYear&&(t<ua||t>ca)&&(t=ca),f(e)._overflowWeeks&&-1===t&&(t=ma),f(e)._overflowWeekday&&-1===t&&(t=ga),f(e).overflow=t),e}function ot(e,t,i){return null!=e?e:null!=t?t:i}function st(e){var i=new Date(t.now());return e._useUTC?[i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()]:[i.getFullYear(),i.getMonth(),i.getDate()]}function ut(e){var t,i,r,a,n,o=[];if(!e._d){for(r=st(e),e._w&&null==e._a[ca]&&null==e._a[la]&&lt(e),null!=e._dayOfYear&&(n=ot(e._a[ua],r[ua]),(e._dayOfYear>ee(n)||0===e._dayOfYear)&&(f(e)._overflowDayOfYear=!0),i=xe(n,0,e._dayOfYear),e._a[la]=i.getUTCMonth(),e._a[ca]=i.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=o[t]=r[t];for(;t<7;t++)e._a[t]=o[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[ha]&&0===e._a[da]&&0===e._a[pa]&&0===e._a[fa]&&(e._nextDay=!0,e._a[ha]=0),e._d=(e._useUTC?xe:ye).apply(null,o),a=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[ha]=24),e._w&&void 0!==e._w.d&&e._w.d!==a&&(f(e).weekdayMismatch=!0)}}function lt(e){var t,i,r,a,n,o,s,u;if(t=e._w,null!=t.GG||null!=t.W||null!=t.E)n=1,o=4,i=ot(t.GG,e._a[ua],we(Ct(),1,4).year),r=ot(t.W,1),((a=ot(t.E,1))<1||a>7)&&(u=!0);else{n=e._locale._week.dow,o=e._locale._week.doy;var l=we(Ct(),n,o);i=ot(t.gg,e._a[ua],l.year),r=ot(t.w,l.week),null!=t.d?((a=t.d)<0||a>6)&&(u=!0):null!=t.e?(a=t.e+n,(t.e<0||t.e>6)&&(u=!0)):a=n}r<1||r>Te(i,n,o)?f(e)._overflowWeeks=!0:null!=u?f(e)._overflowWeekday=!0:(s=Me(i,r,a,n,o),e._a[ua]=s.year,e._dayOfYear=s.dayOfYear)}function ct(e){var t,i,r,a,n,o,s=e._i,u=Na.exec(s)||Va.exec(s);if(u){for(f(e).iso=!0,t=0,i=Ua.length;t<i;t++)if(Ua[t][1].exec(u[1])){a=Ua[t][0],r=!1!==Ua[t][2];break}if(null==a)return void(e._isValid=!1);if(u[3]){for(t=0,i=ja.length;t<i;t++)if(ja[t][1].exec(u[3])){n=(u[2]||" ")+ja[t][0];break}if(null==n)return void(e._isValid=!1)}if(!r&&null!=n)return void(e._isValid=!1);if(u[4]){if(!Ba.exec(u[4]))return void(e._isValid=!1);o="Z"}e._f=a+(n||"")+(o||""),vt(e)}else e._isValid=!1}function ht(e,t,i,r,a,n){var o=[dt(e),xa.indexOf(t),parseInt(i,10),parseInt(r,10),parseInt(a,10)];return n&&o.push(parseInt(n,10)),o}function dt(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function pt(e){return e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}function ft(e,t,i){if(e){if(Ca.indexOf(e)!==new Date(t[0],t[1],t[2]).getDay())return f(i).weekdayMismatch=!0,i._isValid=!1,!1}return!0}function mt(e,t,i){if(e)return Ha[e];if(t)return 0;var r=parseInt(i,10),a=r%100;return(r-a)/100*60+a}function gt(e){var t=Ya.exec(pt(e._i));if(t){var i=ht(t[4],t[3],t[2],t[5],t[6],t[7]);if(!ft(t[1],i,e))return;e._a=i,e._tzm=mt(t[8],t[9],t[10]),e._d=xe.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),f(e).rfc2822=!0}else e._isValid=!1}function _t(e){var i=Ga.exec(e._i);if(null!==i)return void(e._d=new Date(+i[1]));ct(e),!1===e._isValid&&(delete e._isValid,gt(e),!1===e._isValid&&(delete e._isValid,t.createFromInputFallback(e)))}function vt(e){if(e._f===t.ISO_8601)return void ct(e);if(e._f===t.RFC_2822)return void gt(e);e._a=[],f(e).empty=!0;var i,r,a,n,o,s=""+e._i,u=s.length,l=0;for(a=W(e._f,e._locale).match(Br)||[],i=0;i<a.length;i++)n=a[i],r=(s.match(X(n,e))||[])[0],r&&(o=s.substr(0,s.indexOf(r)),o.length>0&&f(e).unusedInput.push(o),s=s.slice(s.indexOf(r)+r.length),l+=r.length),Gr[n]?(r?f(e).empty=!1:f(e).unusedTokens.push(n),Z(n,r,e)):e._strict&&!r&&f(e).unusedTokens.push(n);f(e).charsLeftOver=u-l,s.length>0&&f(e).unusedInput.push(s),e._a[ha]<=12&&!0===f(e).bigHour&&e._a[ha]>0&&(f(e).bigHour=void 0),f(e).parsedDateParts=e._a.slice(0),f(e).meridiem=e._meridiem,e._a[ha]=bt(e._locale,e._a[ha],e._meridiem),ut(e),nt(e)}function bt(e,t,i){var r;return null==i?t:null!=e.meridiemHour?e.meridiemHour(t,i):null!=e.isPM?(r=e.isPM(i),r&&t<12&&(t+=12),r||12!==t||(t=0),t):t}function yt(e){var t,i,r,a,n;if(0===e._f.length)return f(e).invalidFormat=!0,void(e._d=new Date(NaN));for(a=0;a<e._f.length;a++)n=0,t=_({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[a],vt(t),m(t)&&(n+=f(t).charsLeftOver,n+=10*f(t).unusedTokens.length,f(t).score=n,(null==r||n<r)&&(r=n,i=t));h(e,i||t)}function xt(e){if(!e._d){var t=V(e._i);e._a=l([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),ut(e)}}function St(e){var t=new v(nt(Mt(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function Mt(e){var t=e._i,i=e._f;return e._locale=e._locale||rt(e._l),null===t||void 0===i&&""===t?g({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),b(t)?new v(nt(t)):(u(t)?e._d=t:r(i)?yt(e):i?vt(e):wt(e),m(e)||(e._d=null),e))}function wt(e){var i=e._i;o(i)?e._d=new Date(t.now()):u(i)?e._d=new Date(i.valueOf()):"string"==typeof i?_t(e):r(i)?(e._a=l(i.slice(0),function(e){return parseInt(e,10)}),ut(e)):a(i)?xt(e):s(i)?e._d=new Date(i):t.createFromInputFallback(e)}function Tt(e,t,i,o,s){var u={};return!0!==i&&!1!==i||(o=i,i=void 0),(a(e)&&n(e)||r(e)&&0===e.length)&&(e=void 0),u._isAMomentObject=!0,u._useUTC=u._isUTC=s,u._l=i,u._i=e,u._f=t,u._strict=o,St(u)}function Ct(e,t,i,r){return Tt(e,t,i,r,!1)}function Et(e,t){var i,a;if(1===t.length&&r(t[0])&&(t=t[0]),!t.length)return Ct();for(i=t[0],a=1;a<t.length;++a)t[a].isValid()&&!t[a][e](i)||(i=t[a]);return i}function Lt(){return Et("isBefore",[].slice.call(arguments,0))}function Pt(){return Et("isAfter",[].slice.call(arguments,0))}function At(e){for(var t in e)if(-1===_a.call(Xa,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var i=!1,r=0;r<Xa.length;++r)if(e[Xa[r]]){if(i)return!1;parseFloat(e[Xa[r]])!==x(e[Xa[r]])&&(i=!0)}return!0}function Dt(){return this._isValid}function Ot(){return $t(NaN)}function kt(e){var t=V(e),i=t.year||0,r=t.quarter||0,a=t.month||0,n=t.week||0,o=t.day||0,s=t.hour||0,u=t.minute||0,l=t.second||0,c=t.millisecond||0;this._isValid=At(t),this._milliseconds=+c+1e3*l+6e4*u+1e3*s*60*60,this._days=+o+7*n,this._months=+a+3*r+12*i,this._data={},this._locale=rt(),this._bubble()}function Rt(e){return e instanceof kt}function It(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Ft(e,t){G(e,0,0,function(){var e=this.utcOffset(),i="+";return e<0&&(e=-e,i="-"),i+j(~~(e/60),2)+t+j(~~e%60,2)})}function Nt(e,t){var i=(t||"").match(e);if(null===i)return null;var r=i[i.length-1]||[],a=(r+"").match(Ja)||["-",0,0],n=60*a[1]+x(a[2]);return 0===n?0:"+"===a[0]?n:-n}function Vt(e,i){var r,a;return i._isUTC?(r=i.clone(),a=(b(e)||u(e)?e.valueOf():Ct(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+a),t.updateOffset(r,!1),r):Ct(e).local()}function Bt(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Ut(e,i,r){var a,n=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=Nt(ra,e)))return this}else Math.abs(e)<16&&!r&&(e*=60);return!this._isUTC&&i&&(a=Bt(this)),this._offset=e,this._isUTC=!0,null!=a&&this.add(a,"m"),n!==e&&(!i||this._changeInProgress?ii(this,$t(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?n:Bt(this)}function jt(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Gt(e){return this.utcOffset(0,e)}function Yt(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Bt(this),"m")),this}function Ht(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=Nt(ia,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function zt(e){return!!this.isValid()&&(e=e?Ct(e).utcOffset():0,(this.utcOffset()-e)%60==0)}function Wt(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function qt(){if(!o(this._isDSTShifted))return this._isDSTShifted;var e={};if(_(e,this),e=Mt(e),e._a){var t=e._isUTC?d(e._a):Ct(e._a);this._isDSTShifted=this.isValid()&&S(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Xt(){return!!this.isValid()&&!this._isUTC}function Jt(){return!!this.isValid()&&this._isUTC}function Kt(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}function $t(e,t){var i,r,a,n=e,o=null;return Rt(e)?n={ms:e._milliseconds,d:e._days,M:e._months}:s(e)?(n={},t?n[t]=e:n.milliseconds=e):(o=Ka.exec(e))?(i="-"===o[1]?-1:1,n={y:0,d:x(o[ca])*i,h:x(o[ha])*i,m:x(o[da])*i,s:x(o[pa])*i,ms:x(It(1e3*o[fa]))*i}):(o=$a.exec(e))?(i="-"===o[1]?-1:(o[1],1),n={y:Qt(o[2],i),M:Qt(o[3],i),w:Qt(o[4],i),d:Qt(o[5],i),h:Qt(o[6],i),m:Qt(o[7],i),s:Qt(o[8],i)}):null==n?n={}:"object"==typeof n&&("from"in n||"to"in n)&&(a=ei(Ct(n.from),Ct(n.to)),n={},n.ms=a.milliseconds,n.M=a.months),r=new kt(n),Rt(e)&&c(e,"_locale")&&(r._locale=e._locale),r}function Qt(e,t){var i=e&&parseFloat(e.replace(",","."));return(isNaN(i)?0:i)*t}function Zt(e,t){var i={milliseconds:0,months:0};return i.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(i.months,"M").isAfter(t)&&--i.months,i.milliseconds=+t-+e.clone().add(i.months,"M"),i}function ei(e,t){var i;return e.isValid()&&t.isValid()?(t=Vt(t,e),e.isBefore(t)?i=Zt(e,t):(i=Zt(t,e),i.milliseconds=-i.milliseconds,i.months=-i.months),i):{milliseconds:0,months:0}}function ti(e,t){return function(i,r){var a,n;return null===r||isNaN(+r)||(T(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),n=i,i=r,r=n),i="string"==typeof i?+i:i,a=$t(i,r),ii(this,a,e),this}}function ii(e,i,r,a){var n=i._milliseconds,o=It(i._days),s=It(i._months);e.isValid()&&(a=null==a||a,s&&fe(e,ae(e,"Month")+s*r),o&&ne(e,"Date",ae(e,"Date")+o*r),n&&e._d.setTime(e._d.valueOf()+n*r),a&&t.updateOffset(e,o||s))}function ri(e,t){var i=e.diff(t,"days",!0);return i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse"}function ai(e,i){var r=e||Ct(),a=Vt(r,this).startOf("day"),n=t.calendarFormat(this,a)||"sameElse",o=i&&(C(i[n])?i[n].call(this,r):i[n]);return this.format(o||this.localeData().calendar(n,this,Ct(r)))}function ni(){return new v(this)}function oi(e,t){var i=b(e)?e:Ct(e);return!(!this.isValid()||!i.isValid())&&(t=N(o(t)?"millisecond":t),"millisecond"===t?this.valueOf()>i.valueOf():i.valueOf()<this.clone().startOf(t).valueOf())}function si(e,t){var i=b(e)?e:Ct(e);return!(!this.isValid()||!i.isValid())&&(t=N(o(t)?"millisecond":t),"millisecond"===t?this.valueOf()<i.valueOf():this.clone().endOf(t).valueOf()<i.valueOf())}function ui(e,t,i,r){return r=r||"()",("("===r[0]?this.isAfter(e,i):!this.isBefore(e,i))&&(")"===r[1]?this.isBefore(t,i):!this.isAfter(t,i))}function li(e,t){var i,r=b(e)?e:Ct(e);return!(!this.isValid()||!r.isValid())&&(t=N(t||"millisecond"),"millisecond"===t?this.valueOf()===r.valueOf():(i=r.valueOf(),this.clone().startOf(t).valueOf()<=i&&i<=this.clone().endOf(t).valueOf()))}function ci(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function hi(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function di(e,t,i){var r,a,n;if(!this.isValid())return NaN;if(r=Vt(e,this),!r.isValid())return NaN;switch(a=6e4*(r.utcOffset()-this.utcOffset()),t=N(t)){case"year":n=pi(this,r)/12;break;case"month":n=pi(this,r);break;case"quarter":n=pi(this,r)/3;break;case"second":n=(this-r)/1e3;break;case"minute":n=(this-r)/6e4;break;case"hour":n=(this-r)/36e5;break;case"day":n=(this-r-a)/864e5;break;case"week":n=(this-r-a)/6048e5;break;default:n=this-r}return i?n:y(n)}function pi(e,t){var i,r,a=12*(t.year()-e.year())+(t.month()-e.month()),n=e.clone().add(a,"months");return t-n<0?(i=e.clone().add(a-1,"months"),r=(t-n)/(n-i)):(i=e.clone().add(a+1,"months"),r=(t-n)/(i-n)),-(a+r)||0}function fi(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function mi(e){if(!this.isValid())return null;var t=!0!==e,i=t?this.clone().utc():this;return i.year()<0||i.year()>9999?z(i,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):C(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this._d.valueOf()).toISOString().replace("Z",z(i,"Z")):z(i,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function gi(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var i="["+e+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",a=t+'[")]';return this.format(i+r+"-MM-DD[T]HH:mm:ss.SSS"+a)}function _i(e){e||(e=this.isUtc()?t.defaultFormatUtc:t.defaultFormat);var i=z(this,e);return this.localeData().postformat(i)}function vi(e,t){return this.isValid()&&(b(e)&&e.isValid()||Ct(e).isValid())?$t({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function bi(e){return this.from(Ct(),e)}function yi(e,t){return this.isValid()&&(b(e)&&e.isValid()||Ct(e).isValid())?$t({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function xi(e){return this.to(Ct(),e)}function Si(e){var t;return void 0===e?this._locale._abbr:(t=rt(e),null!=t&&(this._locale=t),this)}function Mi(){return this._locale}function wi(e){switch(e=N(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this}function Ti(e){return void 0===(e=N(e))||"millisecond"===e?this:("date"===e&&(e="day"),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms"))}function Ci(){return this._d.valueOf()-6e4*(this._offset||0)}function Ei(){return Math.floor(this.valueOf()/1e3)}function Li(){return new Date(this.valueOf())}function Pi(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Ai(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Di(){return this.isValid()?this.toISOString():null}function Oi(){return m(this)}function ki(){return h({},f(this))}function Ri(){return f(this).overflow}function Ii(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Fi(e,t){G(0,[e,e.length],0,t)}function Ni(e){return ji.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Vi(e){return ji.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Bi(){return Te(this.year(),1,4)}function Ui(){var e=this.localeData()._week;return Te(this.year(),e.dow,e.doy)}function ji(e,t,i,r,a){var n;return null==e?we(this,r,a).year:(n=Te(e,r,a),t>n&&(t=n),Gi.call(this,e,t,i,r,a))}function Gi(e,t,i,r,a){var n=Me(e,t,i,r,a),o=xe(n.year,0,n.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}function Yi(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}function Hi(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}function zi(e,t){t[fa]=x(1e3*("0."+e))}function Wi(){return this._isUTC?"UTC":""}function qi(){return this._isUTC?"Coordinated Universal Time":""}function Xi(e){return Ct(1e3*e)}function Ji(){return Ct.apply(null,arguments).parseZone()}function Ki(e){return e}function $i(e,t,i,r){var a=rt(),n=d().set(r,t);return a[i](n,e)}function Qi(e,t,i){if(s(e)&&(t=e,e=void 0),e=e||"",null!=t)return $i(e,t,i,"month");var r,a=[];for(r=0;r<12;r++)a[r]=$i(e,r,i,"month");return a}function Zi(e,t,i,r){"boolean"==typeof e?(s(t)&&(i=t,t=void 0),t=t||""):(t=e,i=t,e=!1,s(t)&&(i=t,t=void 0),t=t||"");var a=rt(),n=e?a._week.dow:0;if(null!=i)return $i(t,(i+n)%7,r,"day");var o,u=[];for(o=0;o<7;o++)u[o]=$i(t,(o+n)%7,r,"day");return u}function er(e,t){return Qi(e,t,"months")}function tr(e,t){return Qi(e,t,"monthsShort")}function ir(e,t,i){return Zi(e,t,i,"weekdays")}function rr(e,t,i){return Zi(e,t,i,"weekdaysShort")}function ar(e,t,i){return Zi(e,t,i,"weekdaysMin")}function nr(){var e=this._data;return this._milliseconds=ln(this._milliseconds),this._days=ln(this._days),this._months=ln(this._months),e.milliseconds=ln(e.milliseconds),e.seconds=ln(e.seconds),e.minutes=ln(e.minutes),e.hours=ln(e.hours),e.months=ln(e.months),e.years=ln(e.years),this}function or(e,t,i,r){var a=$t(t,i);return e._milliseconds+=r*a._milliseconds,e._days+=r*a._days,e._months+=r*a._months,e._bubble()}function sr(e,t){return or(this,e,t,1)}function ur(e,t){return or(this,e,t,-1)}function lr(e){return e<0?Math.floor(e):Math.ceil(e)}function cr(){var e,t,i,r,a,n=this._milliseconds,o=this._days,s=this._months,u=this._data;return n>=0&&o>=0&&s>=0||n<=0&&o<=0&&s<=0||(n+=864e5*lr(dr(s)+o),o=0,s=0),u.milliseconds=n%1e3,e=y(n/1e3),u.seconds=e%60,t=y(e/60),u.minutes=t%60,i=y(t/60),u.hours=i%24,o+=y(i/24),a=y(hr(o)),s+=a,o-=lr(dr(a)),r=y(s/12),s%=12,u.days=o,u.months=s,u.years=r,this}function hr(e){return 4800*e/146097}function dr(e){return 146097*e/4800}function pr(e){if(!this.isValid())return NaN;var t,i,r=this._milliseconds;if("month"===(e=N(e))||"year"===e)return t=this._days+r/864e5,i=this._months+hr(t),"month"===e?i:i/12;switch(t=this._days+Math.round(dr(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}}function fr(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*x(this._months/12):NaN}function mr(e){return function(){return this.as(e)}}function gr(){return $t(this)}function _r(e){return e=N(e),this.isValid()?this[e+"s"]():NaN}function vr(e){return function(){return this.isValid()?this._data[e]:NaN}}function br(){return y(this.days()/7)}function yr(e,t,i,r,a){return a.relativeTime(t||1,!!i,e,r)}function xr(e,t,i){var r=$t(e).abs(),a=Tn(r.as("s")),n=Tn(r.as("m")),o=Tn(r.as("h")),s=Tn(r.as("d")),u=Tn(r.as("M")),l=Tn(r.as("y")),c=a<=Cn.ss&&["s",a]||a<Cn.s&&["ss",a]||n<=1&&["m"]||n<Cn.m&&["mm",n]||o<=1&&["h"]||o<Cn.h&&["hh",o]||s<=1&&["d"]||s<Cn.d&&["dd",s]||u<=1&&["M"]||u<Cn.M&&["MM",u]||l<=1&&["y"]||["yy",l];return c[2]=t,c[3]=+e>0,c[4]=i,yr.apply(null,c)}function Sr(e){return void 0===e?Tn:"function"==typeof e&&(Tn=e,!0)}function Mr(e,t){return void 0!==Cn[e]&&(void 0===t?Cn[e]:(Cn[e]=t,"s"===e&&(Cn.ss=t-1),!0))}function wr(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),i=xr(this,!e,t);return e&&(i=t.pastFuture(+this,i)),t.postformat(i)}function Tr(e){return(e>0)-(e<0)||+e}function Cr(){if(!this.isValid())return this.localeData().invalidDate();var e,t,i,r=En(this._milliseconds)/1e3,a=En(this._days),n=En(this._months);e=y(r/60),t=y(e/60),r%=60,e%=60,i=y(n/12),n%=12;var o=i,s=n,u=a,l=t,c=e,h=r?r.toFixed(3).replace(/\.?0+$/,""):"",d=this.asSeconds();if(!d)return"P0D";var p=d<0?"-":"",f=Tr(this._months)!==Tr(d)?"-":"",m=Tr(this._days)!==Tr(d)?"-":"",g=Tr(this._milliseconds)!==Tr(d)?"-":"";return p+"P"+(o?f+o+"Y":"")+(s?f+s+"M":"")+(u?m+u+"D":"")+(l||c||h?"T":"")+(l?g+l+"H":"")+(c?g+c+"M":"")+(h?g+h+"S":"")}var Er,Lr;Lr=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),i=t.length>>>0,r=0;r<i;r++)if(r in t&&e.call(this,t[r],r,t))return!0;return!1};var Pr=t.momentProperties=[],Ar=!1,Dr={};t.suppressDeprecationWarnings=!1,t.deprecationHandler=null;var Or;Or=Object.keys?Object.keys:function(e){var t,i=[];for(t in e)c(e,t)&&i.push(t);return i};var kr={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Rr={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Ir=/\d{1,2}/,Fr={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Nr={},Vr={},Br=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Ur=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,jr={},Gr={},Yr=/\d/,Hr=/\d\d/,zr=/\d{3}/,Wr=/\d{4}/,qr=/[+-]?\d{6}/,Xr=/\d\d?/,Jr=/\d\d\d\d?/,Kr=/\d\d\d\d\d\d?/,$r=/\d{1,3}/,Qr=/\d{1,4}/,Zr=/[+-]?\d{1,6}/,ea=/\d+/,ta=/[+-]?\d+/,ia=/Z|[+-]\d\d:?\d\d/gi,ra=/Z|[+-]\d\d(?::?\d\d)?/gi,aa=/[+-]?\d+(\.\d{1,3})?/,na=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,oa={},sa={},ua=0,la=1,ca=2,ha=3,da=4,pa=5,fa=6,ma=7,ga=8;G("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),G(0,["YY",2],0,function(){return this.year()%100}),G(0,["YYYY",4],0,"year"),G(0,["YYYYY",5],0,"year"),G(0,["YYYYYY",6,!0],0,"year"),F("year","y"),B("year",1),q("Y",ta),q("YY",Xr,Hr),q("YYYY",Qr,Wr),q("YYYYY",Zr,qr),q("YYYYYY",Zr,qr),$(["YYYYY","YYYYYY"],ua),$("YYYY",function(e,i){i[ua]=2===e.length?t.parseTwoDigitYear(e):x(e)}),$("YY",function(e,i){i[ua]=t.parseTwoDigitYear(e)}),$("Y",function(e,t){t[ua]=parseInt(e,10)}),t.parseTwoDigitYear=function(e){return x(e)+(x(e)>68?1900:2e3)};var _a,va=re("FullYear",!0);_a=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},G("M",["MM",2],"Mo",function(){return this.month()+1}),G("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),G("MMMM",0,0,function(e){return this.localeData().months(this,e)}),F("month","M"),B("month",8),q("M",Xr),q("MM",Xr,Hr),q("MMM",function(e,t){return t.monthsShortRegex(e)}),q("MMMM",function(e,t){return t.monthsRegex(e)}),$(["M","MM"],function(e,t){t[la]=x(e)-1}),$(["MMM","MMMM"],function(e,t,i,r){var a=i._locale.monthsParse(e,r,i._strict);null!=a?t[la]=a:f(i).invalidMonth=e});var ba=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,ya="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),xa="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Sa=na,Ma=na;G("w",["ww",2],"wo","week"),G("W",["WW",2],"Wo","isoWeek"),F("week","w"),F("isoWeek","W"),B("week",5),B("isoWeek",5),q("w",Xr),q("ww",Xr,Hr),q("W",Xr),q("WW",Xr,Hr),Q(["w","ww","W","WW"],function(e,t,i,r){t[r.substr(0,1)]=x(e)});var wa={dow:0,doy:6};G("d",0,"do","day"),G("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),G("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),G("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),G("e",0,0,"weekday"),G("E",0,0,"isoWeekday"),F("day","d"),F("weekday","e"),F("isoWeekday","E"),B("day",11),B("weekday",11),B("isoWeekday",11),q("d",Xr),q("e",Xr),q("E",Xr),q("dd",function(e,t){return t.weekdaysMinRegex(e)}),q("ddd",function(e,t){return t.weekdaysShortRegex(e)}),q("dddd",function(e,t){return t.weekdaysRegex(e)}),Q(["dd","ddd","dddd"],function(e,t,i,r){var a=i._locale.weekdaysParse(e,r,i._strict);null!=a?t.d=a:f(i).invalidWeekday=e}),Q(["d","e","E"],function(e,t,i,r){t[r]=x(e)});var Ta="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Ca="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Ea="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),La=na,Pa=na,Aa=na;G("H",["HH",2],0,"hour"),G("h",["hh",2],0,ze),G("k",["kk",2],0,We),G("hmm",0,0,function(){return""+ze.apply(this)+j(this.minutes(),2)}),G("hmmss",0,0,function(){return""+ze.apply(this)+j(this.minutes(),2)+j(this.seconds(),2)}),G("Hmm",0,0,function(){return""+this.hours()+j(this.minutes(),2)}),G("Hmmss",0,0,function(){return""+this.hours()+j(this.minutes(),2)+j(this.seconds(),2)}),qe("a",!0),qe("A",!1),F("hour","h"),B("hour",13),q("a",Xe),q("A",Xe),q("H",Xr),q("h",Xr),q("k",Xr),q("HH",Xr,Hr),q("hh",Xr,Hr),q("kk",Xr,Hr),q("hmm",Jr),q("hmmss",Kr),q("Hmm",Jr),q("Hmmss",Kr),$(["H","HH"],ha),$(["k","kk"],function(e,t,i){var r=x(e);t[ha]=24===r?0:r}),$(["a","A"],function(e,t,i){i._isPm=i._locale.isPM(e),i._meridiem=e}),$(["h","hh"],function(e,t,i){t[ha]=x(e),f(i).bigHour=!0}),$("hmm",function(e,t,i){var r=e.length-2;t[ha]=x(e.substr(0,r)),t[da]=x(e.substr(r)),f(i).bigHour=!0}),$("hmmss",function(e,t,i){var r=e.length-4,a=e.length-2;t[ha]=x(e.substr(0,r)),t[da]=x(e.substr(r,2)),t[pa]=x(e.substr(a)),f(i).bigHour=!0}),$("Hmm",function(e,t,i){var r=e.length-2;t[ha]=x(e.substr(0,r)),t[da]=x(e.substr(r))}),$("Hmmss",function(e,t,i){var r=e.length-4,a=e.length-2;t[ha]=x(e.substr(0,r)),t[da]=x(e.substr(r,2)),t[pa]=x(e.substr(a))});var Da,Oa=/[ap]\.?m?\.?/i,ka=re("Hours",!0),Ra={calendar:kr,longDateFormat:Rr,invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:Ir,relativeTime:Fr,months:ya,monthsShort:xa,week:wa,weekdays:Ta,weekdaysMin:Ea,weekdaysShort:Ca,meridiemParse:Oa},Ia={},Fa={},Na=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Va=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ba=/Z|[+-]\d\d(?::?\d\d)?/,Ua=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],ja=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Ga=/^\/?Date\((\-?\d+)/i,Ya=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Ha={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};t.createFromInputFallback=w("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),t.ISO_8601=function(){},t.RFC_2822=function(){};var za=w("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ct.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:g()}),Wa=w("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ct.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:g()}),qa=function(){return Date.now?Date.now():+new Date},Xa=["year","quarter","month","week","day","hour","minute","second","millisecond"];Ft("Z",":"),Ft("ZZ",""),q("Z",ra),q("ZZ",ra),$(["Z","ZZ"],function(e,t,i){i._useUTC=!0,i._tzm=Nt(ra,e)});var Ja=/([\+\-]|\d\d)/gi;t.updateOffset=function(){};var Ka=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,$a=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;$t.fn=kt.prototype,$t.invalid=Ot;var Qa=ti(1,"add"),Za=ti(-1,"subtract");t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",t.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var en=w("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});G(0,["gg",2],0,function(){return this.weekYear()%100}),G(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Fi("gggg","weekYear"),Fi("ggggg","weekYear"),Fi("GGGG","isoWeekYear"),Fi("GGGGG","isoWeekYear"),F("weekYear","gg"),F("isoWeekYear","GG"),B("weekYear",1),B("isoWeekYear",1),q("G",ta),q("g",ta),q("GG",Xr,Hr),q("gg",Xr,Hr),q("GGGG",Qr,Wr),q("gggg",Qr,Wr),q("GGGGG",Zr,qr),q("ggggg",Zr,qr),Q(["gggg","ggggg","GGGG","GGGGG"],function(e,t,i,r){t[r.substr(0,2)]=x(e)}),Q(["gg","GG"],function(e,i,r,a){i[a]=t.parseTwoDigitYear(e)}),G("Q",0,"Qo","quarter"),F("quarter","Q"),B("quarter",7),q("Q",Yr),$("Q",function(e,t){t[la]=3*(x(e)-1)}),G("D",["DD",2],"Do","date"),F("date","D"),B("date",9),q("D",Xr),q("DD",Xr,Hr),q("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),$(["D","DD"],ca),$("Do",function(e,t){t[ca]=x(e.match(Xr)[0])});var tn=re("Date",!0);G("DDD",["DDDD",3],"DDDo","dayOfYear"),F("dayOfYear","DDD"),B("dayOfYear",4),q("DDD",$r),q("DDDD",zr),$(["DDD","DDDD"],function(e,t,i){i._dayOfYear=x(e)}),G("m",["mm",2],0,"minute"),F("minute","m"),B("minute",14),q("m",Xr),q("mm",Xr,Hr),$(["m","mm"],da);var rn=re("Minutes",!1);G("s",["ss",2],0,"second"),F("second","s"),B("second",15),q("s",Xr),q("ss",Xr,Hr),$(["s","ss"],pa);var an=re("Seconds",!1);G("S",0,0,function(){return~~(this.millisecond()/100)}),G(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),G(0,["SSS",3],0,"millisecond"),G(0,["SSSS",4],0,function(){return 10*this.millisecond()}),G(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),G(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),G(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),G(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),G(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),F("millisecond","ms"),B("millisecond",16),q("S",$r,Yr),q("SS",$r,Hr),q("SSS",$r,zr);var nn;for(nn="SSSS";nn.length<=9;nn+="S")q(nn,ea);for(nn="S";nn.length<=9;nn+="S")$(nn,zi);var on=re("Milliseconds",!1);G("z",0,0,"zoneAbbr"),G("zz",0,0,"zoneName");var sn=v.prototype;sn.add=Qa,sn.calendar=ai,sn.clone=ni,sn.diff=di,sn.endOf=Ti,sn.format=_i,sn.from=vi,sn.fromNow=bi,sn.to=yi,sn.toNow=xi,sn.get=oe,sn.invalidAt=Ri,sn.isAfter=oi,sn.isBefore=si,sn.isBetween=ui,sn.isSame=li,sn.isSameOrAfter=ci,sn.isSameOrBefore=hi,sn.isValid=Oi,sn.lang=en,sn.locale=Si,sn.localeData=Mi,sn.max=Wa,sn.min=za,sn.parsingFlags=ki,sn.set=se,sn.startOf=wi,sn.subtract=Za,sn.toArray=Pi,sn.toObject=Ai,sn.toDate=Li,sn.toISOString=mi,sn.inspect=gi,sn.toJSON=Di,sn.toString=fi,sn.unix=Ei,sn.valueOf=Ci,sn.creationData=Ii,sn.year=va,sn.isLeapYear=ie,sn.weekYear=Ni,sn.isoWeekYear=Vi,sn.quarter=sn.quarters=Yi,sn.month=me,sn.daysInMonth=ge,sn.week=sn.weeks=Pe,sn.isoWeek=sn.isoWeeks=Ae,sn.weeksInYear=Ui,sn.isoWeeksInYear=Bi,sn.date=tn,sn.day=sn.days=Ve,sn.weekday=Be,sn.isoWeekday=Ue,sn.dayOfYear=Hi,sn.hour=sn.hours=ka,sn.minute=sn.minutes=rn,sn.second=sn.seconds=an,sn.millisecond=sn.milliseconds=on,sn.utcOffset=Ut,sn.utc=Gt,sn.local=Yt,sn.parseZone=Ht,sn.hasAlignedHourOffset=zt,sn.isDST=Wt,sn.isLocal=Xt,sn.isUtcOffset=Jt,sn.isUtc=Kt,sn.isUTC=Kt,sn.zoneAbbr=Wi,sn.zoneName=qi,sn.dates=w("dates accessor is deprecated. Use date instead.",tn),sn.months=w("months accessor is deprecated. Use month instead",me),sn.years=w("years accessor is deprecated. Use year instead",va),sn.zone=w("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",jt),sn.isDSTShifted=w("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",qt);var un=P.prototype;un.calendar=A,un.longDateFormat=D,un.invalidDate=O,un.ordinal=k,un.preparse=Ki,un.postformat=Ki,un.relativeTime=R,un.pastFuture=I,un.set=E,un.months=ce,un.monthsShort=he,un.monthsParse=pe,un.monthsRegex=ve,un.monthsShortRegex=_e,un.week=Ce,un.firstDayOfYear=Le,un.firstDayOfWeek=Ee,un.weekdays=ke,un.weekdaysMin=Ie,un.weekdaysShort=Re,un.weekdaysParse=Ne,un.weekdaysRegex=je,un.weekdaysShortRegex=Ge,un.weekdaysMinRegex=Ye,un.isPM=Je,un.meridiem=Ke,et("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===x(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),t.lang=w("moment.lang is deprecated. Use moment.locale instead.",et),t.langData=w("moment.langData is deprecated. Use moment.localeData instead.",rt);var ln=Math.abs,cn=mr("ms"),hn=mr("s"),dn=mr("m"),pn=mr("h"),fn=mr("d"),mn=mr("w"),gn=mr("M"),_n=mr("y"),vn=vr("milliseconds"),bn=vr("seconds"),yn=vr("minutes"),xn=vr("hours"),Sn=vr("days"),Mn=vr("months"),wn=vr("years"),Tn=Math.round,Cn={ss:44,s:45,m:45,h:22,d:26,M:11},En=Math.abs,Ln=kt.prototype;return Ln.isValid=Dt,Ln.abs=nr,Ln.add=sr,Ln.subtract=ur,Ln.as=pr,Ln.asMilliseconds=cn,Ln.asSeconds=hn,Ln.asMinutes=dn,Ln.asHours=pn,Ln.asDays=fn,Ln.asWeeks=mn,Ln.asMonths=gn,Ln.asYears=_n,Ln.valueOf=fr,Ln._bubble=cr,Ln.clone=gr,Ln.get=_r,Ln.milliseconds=vn,Ln.seconds=bn,Ln.minutes=yn,Ln.hours=xn,Ln.days=Sn,Ln.weeks=br,Ln.months=Mn,Ln.years=wn,Ln.humanize=wr,Ln.toISOString=Cr,Ln.toString=Cr,Ln.toJSON=Cr,Ln.locale=Si,Ln.localeData=Mi,Ln.toIsoString=w("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Cr),Ln.lang=en,G("X",0,0,"unix"),G("x",0,0,"valueOf"),q("x",ta),q("X",aa),$("X",function(e,t,i){i._d=new Date(1e3*parseFloat(e,10))}),$("x",function(e,t,i){i._d=new Date(x(e))}),t.version="2.20.1",function(e){Er=e}(Ct),t.fn=sn,t.min=Lt,t.max=Pt,t.now=qa,t.utc=d,t.unix=Xi,t.months=er,t.isDate=u,t.locale=et,t.invalid=g,t.duration=$t,t.isMoment=b,t.weekdays=ir,t.parseZone=Ji,t.localeData=rt,t.isDuration=Rt,t.monthsShort=tr,t.weekdaysMin=ar,t.defineLocale=tt,t.updateLocale=it,t.locales=at,t.weekdaysShort=rr,t.normalizeUnits=N,t.relativeTimeRounding=Sr,t.relativeTimeThreshold=Mr,t.calendarFormat=ri,t.prototype=sn,t.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"YYYY-[W]WW",MONTH:"YYYY-MM"},t})}).call(t,i(382)(e))},function(e,t,i){"use strict";function r(e,t,i,r){if("function"!=typeof e)return new Error("Property `"+t+"` of `"+i+"` has invalid OptionType notation inside "+r+".")}function a(e){function t(t,i,r,a,n,o){var s=i[r];return o=o||r,null===s||void 0===s?t?new Error("Required "+n+" `"+o+"` was not specified in `"+a+"`."):null:e(i,r,a,n,o,v.a)}var i=t.bind(null,!1);return i.isRequired=t.bind(null,!0),i}function n(e){return Array.isArray(e)?"array":void 0===e?"undefined":h()(e)}function o(e){return e instanceof f.a.Model}function s(e){return e instanceof f.a.Collection}function u(e){return a(function(t,i,a,o,s){var u=r(e,s,a,"valuesOf");if(u)return u;var l=t[i],c=n(l);if("object"!==c)return new Error("Invalid "+o+" `"+s+"` of type `"+c+"` supplied to `"+a+"`, expected an object.");for(var h in l){var d=e(l,h,a,o,s+"."+h,v.a);if(d instanceof Error)return d}return null})}function l(e){return a(function(t,i,r,a,s){var u=t[i],l=n(u);if(!o(u))return new Error("Invalid "+a+" `"+s+"` of type `"+l+"` supplied to `"+r+"`, expected `Backbone.Model`.");for(var c in e){var h=e[c];if(h){var d=h(u.attributes,c,r,a,i+".get('"+c+"')",v.a);if(d)return d}}return null})}i.d(t,"a",function(){return M});var c=i(29),h=i.n(c),d=i(0),p=(i.n(d),i(15)),f=i.n(p),m=i(433),g=i.n(m),_=i(229),v=i.n(_),b=l({}),y=a(function(e,t,i,r,a){var o=e[t],u=n(o);return s(o)?null:new Error("Invalid "+r+" `"+a+"` of type `"+u+"` supplied to `"+i+"`, expected `Backbone.Collection`.")}),x=function(e,t){return a(function(i,r,a,n,o){var s=g.a.number(i,r,a,n,o,v.a);if(s)return s;var u=i[r];return u<e||u>t?new Error("Invalid "+n+" `"+r+"` of value `"+u+"` supplied to `"+a+"`, expected number between "+e+" and "+t+"."):null})},S=Object(d.extend)({},g.a);S.valuesOf=u,S.modelShape=l,S.model=b,S.collection=y,S.numberBetween=x,S.component=S.oneOfType([S.shape({viewClass:S.func.isRequired,options:S.object}).isRequired,S.arrayOf(S.shape({viewClass:S.func.isRequired,options:S.object})).isRequired]),S.selectOptionListOf=function(e){return S.arrayOf(S.shape({title:S.string.isRequired,value:e,default:S.bool}).isRequired)},t.b=S;var M=g.a.checkPropTypes},,function(e,t,i){"use strict";function r(e,t,i){if(!e)return i||"";if("function"!=typeof e)throw N(e,t);var r=e();if(!r.isComponentElement)throw N(e,t);var a="";try{a=r.template()}catch(e){throw new Error("\n\nError while getting the template of Component `"+r.displayName+"`:\n\n"+e.stack+"\n\n")}return'<div data-component id="'+r.cid+'" '+(t?'class="'+t+'"':"")+">"+a+"</div>"}function a(e,t,i){return e.map(function(e){return r(e,t,i)}).join("")}function n(e){return f()(e).filter(function(t){return e[t]}).join(" ")}function o(e){return f()(Object(L.b)(e)).map(function(t){return D.a(t)+": "+e[t]+";"}).join(" ")}function s(e,t){return Object(x.escape)(e)+'="'+Object(x.escape)(t)+'"'}function u(e){return y.a.runtime.markSafe(f()(Object(L.b)(e)).map(function(t){var i=["disabled","checked","selected","readonly","multiple"];return Object(x.includes)(i,t)?e[t]?s(t,!0):"":s(t.match(/^classNames?$/)?"class":D.a(t),"style"===t?o(e[t]):"classNames"===t?n(e[t]):e[t])}).join(" "))}Object.defineProperty(t,"__esModule",{value:!0});var l=i(49),c=i.n(l),h=i(19),d=i.n(h),p=i(20),f=i.n(p),m=i(3),g=i.n(m),_=i(1),v=i.n(_),b=i(227),y=i.n(b),x=i(0),S=(i.n(x),i(122)),M=i(253),w=i(254),T=i(22),C=i(73),E=i(478),L=i(30),P=i(90),A=i(64),D=i(53),O=y.a.Loader.extend({getSource:function(e){return{src:{type:"code",obj:window.nunjucksPrecompiled[e]},path:e}}}),k=new y.a.Environment([new O],{autoescape:!0});k.addFilter("log",function(e){return console.log("[Nunjucks] : ",e),e}),k.addFilter("urlize",D.n),k.addFilter("best_fit",w.a),k.addFilter("iterable",function(e){return Array.isArray(e)?e:[e]}),k.addFilter("slugify",D.i),k.addFilter("call_macro_by_name",function(e){var t=this.ctx[e],i=Array.prototype.slice.call(arguments,1);if(!t)throw new Error('Missing macro "'+e+'"');return t.apply(this,i)}),k.addFilter("user_profile_filled",function(e){return"avatar-blue"!==e.avatars.name&&"avatar-orange"!==e.avatars.name&&"avatar-grey"!==e.avatars.name&&(e.biography||e.tagline||e.city||e.country)&&(e.website||e.twitterUsername||e.linkedinUsername||e.facebookUsername||e.unityConnectUrl)}),k.addFilter("has_plan_type",P.f),k.addFilter("badge_label",P.h),k.addFilter("print_suggestion_verb",function(e,t){var i="";return 0===e&&(i=t.displayName+" is a <b>popular</b> user"),10===e&&(i="You <b>liked</b> their models :"),20===e&&(i="You share a common <b>skill</b> :"),30===e&&(i="You share a common <b>interest</b> :"),40===e&&(i="Your profiles are similar."),y.a.runtime.markSafe(i)}),k.addFilter("print_suggestion_target",function(e,t){if(0===t)return"";if(10===t){var i=[];return e.forEach(function(e){var t=g()('<a href="/models/'+e.uid+'">'+e.name+"</a>");i.push(g()("<div>").append(t).html())}),y.a.runtime.markSafe(i.join(", "))}return 20===t?e.name:30===t?e.name:40===t?"":void 0});var R;k.addFilter("skill_slug_to_name",function(e){return R||(R=new M.a,R.fetch({immediate:!0})),R.findWhere({slug:e}).get("name")});var I;k.addFilter("category_uid_to_name",function(e){I||(I=new S.a,I.fetch({immediate:!0}));var t=I.findWhere({uid:e}),i=t.get("name");return t.get("parent")&&(i=I.findWhere({uid:t.get("parent")}).get("name ")+"/"+i),i}),k.addFilter("underscorify",D.m),k.addFilter("image_container",function(e,t,i,r,a,n){var o=Object(w.a)(e,t,i);return y.a.runtime.markSafe('\n        <div\n            class="image-container '+(n&&!Object(A.e)(o)?"--loading":"")+'"\n            '+(n?'data-background="'+o+'"':"")+'\n            style="\n                width: '+(r?"100%":t+"px")+";\n                background-image: url("+o+');\n            ">\n            <div style="padding-top: '+i/t*100+'%"></div>\n        </div>\n    ')}),k.addFilter("query_string",function(e,t){var i=document.createElement("a");return i.href=e,f()(t).length&&(i.search="?"+T.b.craft(T.b.reset(i.search,t))),i.href}),k.addFilter("first_n",function(e,t){return e.slice(0,t)}),k.addFilter("fill_null",function(e,t){for(var i=e.slice();i.length<t;)i.push(null);return i}),k.addFilter("prettify_text",function(e,t){var i=k.getFilter("striptags")(e);return k.getFilter("urlize")(i,t)}),k.addFilter("paragraphy",D.e),k.addFilter("striptags",D.l),k.addFilter("humanize_number",C.k),k.addFilter("humanize_file_size",C.j),k.addFilter("format_order_uid",D.c),k.addFilter("format_price",C.g),k.addFilter("format_rating",function(e,t){var i=d()({numberOnly:!1},t);return Object(C.b)(0,5,Math.round(10*Number(e))/10)+(i.numberOnly?"":"/5")}),k.addFilter("comma_formatted_number",C.e),k.addFilter("pluralize",D.f),k.addFilter("merge",function(e,t){return d()({},e,t)}),k.addFilter("json_data",function(e){return c()(e).replace(/<\//g,"<\\/")}),k.addFilter("format_date",function(e,t){var i;return i="full"===t?"YYYY/MM/DD HH:mm":"L",v.a.utc(e).format(i)}),k.addFilter("max",function(e){return Math.max.apply(Math,e)}),k.addFilter("min",function(e){return Math.min.apply(Math,e)}),k.addFilter("time_ago",function(e){return E.a.timeAgo(v.a.utc(e).toDate())}),k.addFilter("seconds_to_duration",function(e){return v.a.utc(1e3*parseFloat(e)).format("mm:ss")}),k.addFilter("can_upgrade_to_pro",function(e){return Object(P.c)(e)}),k.addFilter("humanize_date",function(e){return v()(e).format("MMM[.] Do[,] YYYY")});var F=k.getFilter("trim");k.addFilter("trim",function(e){return null===e?"":F(e)}),k.addFilter("map",function(e,t){return e.map(function(e){return e[t]})});var N=function(e,t){return new Error("\n\n"+e+(t?" with `"+t+"` className":"")+" is not a Component. \nThe `component` filter only accepts component elements.\nYou can get a component element by calling `Component#createChildrenComponents(childrenConfigs)`, or `Component#createChildComponent(childName, childConfig)`.\n/!\\ Note that this is different from Component instances.\n")};k.addFilter("component",function(e,t,i){return y.a.runtime.markSafe(Array.isArray(e)?a(e,t,i):r(e,t,i))}),k.addFilter("class_names",n),k.addFilter("style",o),k.addFilter("attributes",u),t.default={get:Object(x.curry)(function(e,t){return k.render(e+".jinja",t)}),getFromString:Object(x.curry)(function(e,t){return k.renderString(e,t)}),getFromMacro:function(e,t,i){Array.isArray(e)&&(i=t,t=e[1],e=e[0]);var r=function(i){return k.renderString(["{%- from source import "+t+" -%}","{{ "+t+"("+i.map(function(e,t){return"parameters[ "+t+" ]"}).join(",")+") }}"].join("\n"),{source:e+".jinja",parameters:i})};return i?r(i):r}}},function(e,t,i){"use strict";var r=i(16),a=i(416),n=i(195),o=i(841);Object(n.a)(),Object(r.a)().webgl2&&(a.a.osg.Options.getOptionsURL().webgl2=!0),a.a.osg.StateAttribute.OVERRIDE_ON=a.a.osg.StateAttribute.OVERRIDE|a.a.osg.StateAttribute.ON,i(1091),i(1092),i(1093),i(1094),i(1095),i(1096),Object(o.b)(a.a),a.a.osgAnimation.MorphGeometry.EFFECTIVE_EPS=Object(r.a)().morphEpsilon,t.a=a.a},function(e,t,i){"use strict";var r=i(49),a=i.n(r),n=i(20),o=i.n(n),s=i(15),u=i.n(s),l=i(3),c=i.n(l),h=i(0),d=(i.n(h),i(7)),p=i.n(d),f=i(12),m=i(81),g=i(22),_=i(55),v=i(90),b=i(25),y=f.a.extend({defaults:{likes:{},followings:{},subscriptions:{},reviewUpvotes:{}},endpoint:function(){return this.options.me&&!this.get("uid")?"/users/me":this.isNew()||null!==this.get("uid")?this.isNew()?"/users":"/users/"+this.get("uid"):"/users/@"+this.get("username")},isAuthenticated:function(){return!this.get("isAnonymous")},isInflated:function(){return void 0!==this.get("account")&&o()(this.attributes).length>o()(this.defaults).length+1},follow:function(e){return this.addFollowing(e,!0),y.authenticate(function(){return u.a.ajax({type:"POST",url:"/i/users/"+e+"/followers",cacheBusting:!1})}.bind(this))},followUsers:function(e){return Array.isArray(e)?(e.forEach(function(e){this.addFollowing(e,!0)}.bind(this)),y.authenticate(function(){return c.a.ajax({type:"POST",url:"/i/users/follow",data:a()({uids:e}),contentType:"application/json"})}.bind(this))):p.a.reject("First argument should be an array of user UIDs.")},isProfileFilled:function(){return"avatar-blue"!==this.get("avatars").name&&(this.get("biography")||this.get("tagline")||this.get("city")||this.get("country"))&&(this.get("website")||this.get("twitterUsername")||this.get("linkedinUsername")||this.get("unityConnectUrl")||this.get("facebookUsername"))},unfollow:function(e){return this.addFollowing(e,!1),y.authenticate(function(){return u.a.ajax({type:"DELETE",url:"/i/users/"+e+"/followers",cacheBusting:!1})}.bind(this))},addFollowing:function(e,t){var i={},r=this.get("followingCount")||0;i[e]=t,this.addFollowings(i),this.set("followingCount",Math.max(r+(t?1:-1),0))},addFollowings:function(e){this.set("followings",Object(h.extend)({},this.get("followings"),e))},doesFollow:function(e){return!!this.get("followings")[e]},getFollowings:function(e){var t=this.get("followings"),i=e.filter(function(e){return!(e in t||!e)});return i.length>0?p.a.resolve(u.a.ajax({type:"GET",url:"/i/users/me/followings"+g.b.craft("?",{user_uids:i})})).then(function(t){return this.addFollowings(t.results),Object(h.pick)(this.get("followings"),e)}.bind(this)):(this.trigger("change:followings"),p.a.resolve(Object(h.pick)(t,e)))},getSummary:function(){return u.a.ajax({type:"GET",url:"/i/users/"+this.get("uid")+"/summary"}).then(function(e){return this.set(e),e}.bind(this))},canViewPrivateModelsOf:function(e){return!!this.isAuthenticated()&&(!0===this.get("isStaff")||void 0!==e&&this.get("uid")===e)},canUpgradePlan:function(){return!1===Object(h.includes)(["ent"],this.get("account"))},canUpgradeToPro:function(){return Object(v.c)(this.get("account"))},addLike:function(e,t){var i={};i[e]=t,this.addLikes(i)},addLikes:function(e){this.set("likes",Object(h.extend)({},this.get("likes"),e))},doesLike:function(e){return!!this.get("likes")[e]},getLikes:function(e){if(!this.isAuthenticated())return p.a.resolve({});var t=this.get("likes"),i=e.filter(function(e){return!(e in t)});return i.length>0?p.a.resolve(u.a.ajax({type:"GET",url:"/i/users/me/likes"+g.b.craft("?",{model_uids:i})})).then(function(i){return this.addLikes(i.results),Object(h.pick)(t,e)}.bind(this)):(this.trigger("change:likes"),p.a.resolve(Object(h.pick)(t,e)))},addReviewUpvote:function(e,t){var i={};i[e]=t,this.addReviewUpvotes(i)},addReviewUpvotes:function(e){this.set("reviewUpvotes",Object(h.extend)({},this.get("reviewUpvotes"),e))},hasUpvotedReview:function(e){return this.get("reviewUpvotes")[e]},getReviewUpvotes:function(e){if(!this.isAuthenticated())return p.a.resolve({});var t=this.get("reviewUpvotes"),i=e.filter(function(e){return!(e in t)});return i.length>0?p.a.resolve(u.a.ajax({type:"GET",url:"/i/users/me/upvotes"+g.b.craft("?",{review_uids:i})})).then(function(i){return this.addReviewUpvotes(i.results),Object(h.pick)(t,e)}.bind(this)):(this.trigger("change:reviewUpvotes"),p.a.resolve(Object(h.pick)(t,e)))},getReviewOnModel:function(e){var t=this.get("uid");return p.a.resolve(u.a.ajax({type:"GET",url:"/i/users/me/review"+g.b.craft("?",{model:e})})).then(function(i){return o()(i).length?i:p.a.reject(new b.d("no review found for user "+t+" on model "+e))})},canReview:function(e){return this.isAuthenticated()?p.a.resolve(u.a.ajax({type:"GET",url:"/i/models/"+e+"/can-review"})).then(function(e){return e.canReview}).catch(function(){return!1}):p.a.resolve(!1)},fetchPrivateLimits:function(){return this.isAuthenticated()?this.get("privateLimits")?p.a.resolve(this.get("privateLimits")):p.a.resolve(c.a.ajax({url:"/i/users/me/account",allowPrefetching:!1,cacheBusting:!1,type:"GET"})).then(function(e){return this.set("privateLimits",Object(h.extend)({},this.get("privateLimits"),e)),p.a.resolve(e)}.bind(this)):p.a.reject("User is not authenticated.")},doesSubscribe:function(e){return!!this.get("subscriptions")[e]},fetchSubscriptions:function(e){var t=this.get("subscriptions"),i=e.filter(function(e){return!(e in t)});return i.length>0?void 0!==t[e]?p.a.resolve(t[e]):p.a.resolve(u.a.ajax({type:"GET",url:"/i/collections/subscribed"+g.b.craft("?",{uid:i})})).then(function(i){return this.updateSubscriptions(i.results),Object(h.pick)(t,e)}.bind(this)):(this.trigger("change:subscriptions"),p.a.resolve(Object(h.pick)(t,e)))},updateSubscription:function(e,t){var i={};i[e]=t,this.updateSubscriptions(i)},updateSubscriptions:function(e){this.set("subscriptions",Object(h.extend)({},this.get("subscriptions"),e))},updateAvatar:function(e){return new p.a(function(t,i){var r=new FormData;r.append("imageFile",e),c.a.ajax({type:"POST",url:"/i/avatars",data:r,cache:!1,contentType:!1,processData:!1}).then(t.bind(this),function(e){i(e.responseJSON&&e.responseJSON.detail||"Unexpected error, your user settings may not have been changed.")}.bind(this))})},sendConfirmationMail:function(e){return p.a.resolve(u.a.ajax({type:"GET",url:"/i/users/email_confirmation"+g.b.craft("?",e)}))},updateEmailSettings:function(e){return p.a.resolve(c.a.ajax({type:"PATCH",url:"/i/users/"+this.get("uid")+"/email_settings",data:e}))},setAllowsRestricted:function(e){return this.isAuthenticated()?this.save({allowsRestricted:e},{patch:!0}):(_.a.set("allows_age_restricted",e),p.a.resolve())},doAllowRestricted:function(){return this.isAuthenticated()?this.get("allowsRestricted"):"true"===_.a.get("allows_age_restricted")},setSellerAccount:function(){return u.a.ajax({url:"/i/store/sellers",type:"POST"})},deleteSellerAccount:function(){var e=y.me().get("uid");return u.a.ajax({url:"/i/store/sellers/"+e,type:"DELETE"})},getSellerAccount:function(){var e=y.me().get("uid");return u.a.ajax({url:"/i/store/sellers/"+e,type:"GET",allowPrefetching:!0})},setOauthToken:function(e,t){return u.a.ajax({url:"/oauth2/token/"+e,type:"POST",data:{token:t}})},getOauthToken:function(e){return u.a.ajax({url:"/oauth2/token/"+e,type:"GET"})},isMe:function(){return y.me().get("uid")===this.get("uid")},canAccessFeature:function(e){return Object(h.includes)(this.get("features").map(h.toUpper),Object(h.toUpper)(e))}},{login:function(e,t,i){return i=Object(h.extend)({},i),c.a.ajax({type:"POST",url:"/login",data:{email:e,password:t,next:i.next},xhrFields:{withCredentials:!0}}).then(function(e){return y.clear(),e.result})},authenticate:function(e,t){var r=function(){return new p.a(function(e){i.e(0).then(function(){var t=[i(203)];(function(t){e(t.default)}).apply(null,t)}).catch(i.oe)})},a=function(){return r().then(function(i){return new i({next:t||window.location.href}).open().then(function(t){return this.me({allowPrefetching:!1}).then(function(t){return e(t)}).then(function(e){return e||t}).catch(function(e){return console.error(e),t})}.bind(this)).then(function(e){e&&e!==window.location.href?window.location=e:window.location.reload(!0)})}.bind(this))}.bind(this),n=this.me();return n.isAuthenticated()?p.a.resolve(e(n)):a()},me:function(e){e=Object(h.extend)({},e);var t=function(e){return e.isInflated()?m.a.register("/i/users/"+e.get("uid"),e.toJSON()):e.isAuthenticated()&&(e=this.getByUid(e.get("uid"),{immediate:!0,userOptions:{me:!0}})),this._me.set(e.toJSON()),this._me.set({}),this._me}.bind(this),i=this;return!1!==e.allowPrefetching?void 0===this._me?(this._me=new i(null,{me:!0}),this._me.fetch(e),t(this._me)):(this._me.isInflated()||this._me.fetch(),this._me):(void 0===this._me&&(this._me=new i(null,{me:!0})),p.a.resolve(this._me.fetch(e)).then(t))},getByName:function(e){var t=this;return u.a.ajax({url:"i/users/@"+e,type:"GET",contentType:"application/json",dataType:"json"}).then(function(e){return new t(e)})},getProfileUser:function(){var e=c()("[data-profile-user]").first().data("profile-user");return this.getByUid(e)},getByAttributes:function(e,t){t=Object(h.extend)({},t),e=Object(h.extend)({uid:null},e);var i=this,r=Object(h.extend)({},t.userOptions),a=new i(e,r),n=function(e){return e.set({}),e};return t.immediate?(a.fetch(t),n(a)):a.fetch(t).then(n)},getByUsername:function(e,t){return this.getByAttributes({username:e},t)},getByUid:function(e,t){return this.getByAttributes({uid:e},t)},clear:function(){m.a.invalidate("/i/users/me"),this._me=void 0}});t.a=y},,function(e,t,i){"use strict";var r=i(20),a=i.n(r),n=i(29),o=i.n(n),s=i(3),u=i.n(s),l=i(0),c=(i.n(l),i(30)),h=i(40),d=i(256),p=i(257),f=i(152),m=i(86),g=i(414);t.a=d.a.extend({mixins:[g.a,f.b,p.a],defaultOptions:function(){return{}},isInitialized:!1,isMounted:!1,constructor:function(){this.options=Object(l.extend)({},this.defaultOptions(),Object(l.pickBy)(arguments[0]||{},function(e){return void 0!==e})),d.a.apply(this,arguments)},initialize:function(){d.a.prototype.initialize.apply(this,arguments),this.isInitialized=!0},setElement:function(e){var t=e[0]||e;return this.isInitialized&&this.el===t||d.a.prototype.setElement.apply(this,arguments),this.el&&(this.el[m.b]=this),this},_removeElement:function(){this.$el.html("")},template:function(){return""},update:function(e,t,i,r){this.shouldUpdate=r||this.shouldViewUpdate(e,t);var a=this.isMounted&&this.shouldUpdate;a&&this.viewWillUpdate(e,t);var n=this.options,o=this.state;return this.options=e,this.state=t,this.onViewUpdate(a,n,o,e,t,i)},onViewUpdate:function(e,t,i){e&&(this.render(),this.viewDidUpdate(t,i))},shouldViewUpdate:function(){return!0},viewWillUpdate:function(){},viewDidUpdate:function(){},forceUpdate:function(){this.setState({},!0)},afterRender:function(){d.a.prototype.afterRender.apply(this,arguments),this.isMounted||(this.isMounted=!0,this.viewDidMount())},beforeRemove:function(){d.a.prototype.beforeRemove.apply(this,arguments),this.isMounted&&(this.viewWillUnmount(),this.isMounted=!1,this.el&&delete this.el[m.b])},automagicErrors:function(e){if(this.$(".form-global-error").removeAttr("data-error"),this.$(".form-global-error").hide(),this.$("[data-error-for]").removeAttr("data-error"),null!==e)if("object"===(void 0===e?"undefined":o()(e))){var t=this.$("[data-error-for]");a()(e).forEach(function(i){t.filter(function(){return u()(this).attr("data-error-for").split(",").indexOf(i)>-1}).attr("data-error",e[i].join("\n"))}.bind(this))}else this.$(".form-global-error .message").text(e),this.$(".form-global-error").attr("data-error",e),this.$(".form-global-error").fadeIn()}},{isView:!0,extend:function(e,t){var i=Object(l.extend)({},e,{defaultOptions:Object(c.e)(Object(h.e)(this.prototype.defaultOptions||{}),Object(h.e)(e.defaultOptions||{})),events:Object(l.extend)({},this.prototype.events||{},e.events||{}),children:Object(l.extend)({},this.prototype.children||{},e.children||{}),optionTypes:Object(l.extend)({},this.prototype.optionTypes||{},e.optionTypes||{})});return d.a.extend.call(this,i,t)}})},function(e,t,i){"use strict";var r=i(7),a=i.n(r),n=i(213),o=i(21),s={};s.extend=function(){var e,t,i,r,a=window.Object.prototype.toString,n=window.Object.prototype.hasOwnProperty,o=s.isArray,u=function(e){if(!e||"[object Object]"!==a.call(e)||e.nodeType||e.setInterval)return!1;if(e.constructor&&!n.call(e,"constructor")&&!n.call(e.constructor.prototype,"isPrototypeOf"))return!1;var t;for(t in e);return void 0===t||n.call(e,t)},l=arguments[0]||{},c=1,h=arguments.length,d=!1;for("boolean"==typeof l&&(d=l,l=arguments[1]||{},c=2),"object"==typeof l||function(e){return"[object Function]"===a.call(e)}(l)||(l={}),h===c&&(l=this,--c);c<h;c++)if(null!==(e=arguments[c]))for(t in e)if(i=l[t],r=e[t],l!==r)if(d&&r&&(u(r)||o(r))){var p=i&&(u(i)||o(i))?i:o(r)?[]:{};l[t]=s.extend(d,p,r)}else void 0!==r&&(l[t]=r);return l},s.objectInherit=function(e){function t(){}t.prototype=e;for(var i=new t,r=1;r<arguments.length;r++)s.objectMix(i,arguments[r],!1);return i},s.objectMix=function(e,t,i){for(var r in t)i&&e[r]||(e[r]=t[r]);return e},s.objectType={},s.objectType.type=0,s.arrayDense=function(e,t,i){var r=t.length;if(e>=r)for(var a=r;a<=e;a++)t.push(i?i():null)},s.objectLibraryClass=function(e,t,i){e.className=function(){return i},e.libraryName=function(){return t};var r=t+"::"+i;return e.libraryClassName=function(){return r},e},s.setTypeID=function(e){var t=e.prototype.libraryClassName(),i=s.generateId(s.objectType,t),r=function(){return i};e.typeID=e.prototype.typeID=i,e.getTypeID=e.prototype.getTypeID=r},s.createPrototypeObject=function(e,t,i,r){t.hasOwnProperty("getTypeID")&&(t=s.objectInherit(t,{})),e.prototype=t,t.constructor=e,i&&r&&(s.objectLibraryClass(t,i,r),s.setTypeID(e))},s.generateId=function(e,t){if(void 0!==e[t])return o.a.error(t+" is already defined, change class name or library name"),-1;var i=e.type;return e[i]=t,e[t]=i,e.type+=1,i},s.objectNodeType={},s.objectNodeType.type=0,s.setNodeTypeID=function(e){var t=e.prototype.libraryClassName(),i=s.generateId(s.objectNodeType,t),r=function(){return i};e.nodeTypeID=e.prototype.nodeTypeID=i,e.getNodeTypeID=e.prototype.getNodeTypeID=r},s.createPrototypeNode=function(e,t,r,a){var n=i(773).default,o=t.nodeTypeID;if(s.createPrototypeObject(e,t,r,a),r&&a){s.setNodeTypeID(e);var u=e.nodeTypeID;s.arrayDense(u,n.applyFunctionArray),n.registerApplyFunction(u,n.getApplyFunction(o))}};var u=0,l=0,c={},h={},d=0,p={};s.getStateAttributeTypeNameToTypeId=function(){return p},s.createPrototypeStateAttribute=function(e,t,i,r){s.createPrototypeObject(e,t,i,r);var a=s.getOrCreateStateAttributeTypeId(e);e.prototype.attributeTypeId=a},s.getMaxStateAttributeTypeID=function(){return d},s.getOrCreateStateAttributeTypeId=function(e){var t=e.prototype.getType();if(p[t])return p[t];var i=d++;return p[t]=i,i},s.getOrCreateStateAttributeTypeMemberIndex=function(e){if(void 0!==e._attributeTypeIndex)return e._attributeTypeIndex;var t=e.getTypeMember();return e._attributeTypeIndex=s.getOrCreateStateAttributeTypeMemberIndexFromName(t),e._attributeTypeIndex},s.getOrCreateStateAttributeTypeMemberIndexFromName=function(e){var t=c[e];return void 0!==t?t:(t=u++,c[e]=t,t)},s.getOrCreateTextureStateAttributeTypeMemberIndex=function(e){if(void 0!==e._attributeTypeIndex)return e._attributeTypeIndex;var t=e.getTypeMember();return e._attributeTypeIndex=s.getOrCreateTextureStateAttributeTypeMemberIndexFromName(t),e._attributeTypeIndex},s.getOrCreateTextureStateAttributeTypeMemberIndexFromName=function(e){var t=h[e];return void 0!==t?t:(t=l++,h[e]=t,t)},s.getIdFromTypeMember=function(e){return c[e]},s.getTextureIdFromTypeMember=function(e){return h[e]},s.Int8Array=window.Int8Array,s.Uint8Array=window.Uint8Array,s.Uint8ClampedArray=window.Uint8ClampedArray,s.Int16Array=window.Int16Array,s.Uint16Array=window.Uint16Array,s.Int32Array=window.Int32Array,s.Uint32Array=window.Uint32Array,s.Float32Array=window.Float32Array,s.Float64Array=window.Float64Array;var f={},m={};s.logTime=(o.a.console.time||function(e){f[e]=n.a.instance().tick()}).bind(o.a.console),s.logTimeEnd=(o.a.console.timeEnd||function(e){if(void 0!==f[e]){var t=n.a.instance().deltaM(f[e],n.a.instance().tick());o.a.log(e+": "+t+"ms"),f[e]=void 0}}).bind(o.a.console),s.time=function(e,t){var i=t;void 0===i&&(i=o.a.NOTICE),i>o.a.getNotifyLevel()||(m[e]=1,s.logTime(e))},s.timeEnd=function(e){void 0!==m[e]&&s.logTimeEnd(e)},s.profile=(o.a.console.profile||function(){}).bind(o.a.console),s.profileEnd=(o.a.console.profileEnd||function(){}).bind(o.a.console),s.arrayUniq=function(e){for(var t=e.length,i={},r=[],a=0,n=0;n<t;n++){var o=e[n];1!==i[o]&&(i[o]=1,r[a++]=o)}return r},s.rejectObject=function(e,t){return t&&(e="Invalid json "+e+" "+Object.keys(t)),o.a.warn(e),a.a.reject(e)},t.a=s},function(e,t,i){"use strict";i.d(t,"b",function(){return h}),i.d(t,"c",function(){return c}),i.d(t,"d",function(){return d}),i.d(t,"e",function(){return s}),i.d(t,"f",function(){return u}),i.d(t,"g",function(){return l});var r=i(447),a=i(1009),n=i.n(a),o=i(1015);i.d(t,"a",function(){return n.a}),n.a.glMatrix.setMatrixArrayType(o.a.ArrayType),n.a.glMatrix.EPSILON=1e-9;var s=n.a.vec2,u=n.a.vec3,l=n.a.vec4,c=n.a.mat4,h=n.a.mat3,d=n.a.quat;u.create32=function(){return new Float32Array(3)},u.create64=function(){return new Float64Array(3)},u.fromValues32=function(e,t,i){var r=new Float32Array(3);return r[0]=e,r[1]=t,r[2]=i,r},u.fromValues64=function(e,t,i){var r=new Float64Array(3);return r[0]=e,r[1]=t,r[2]=i,r},u.init=function(e){return u.set(e,0,0,0)},u.transformMat4Rotate=function(e,t,i){var r=t[0],a=t[1],n=t[2];return e[0]=i[0]*r+i[1]*a+i[2]*n,e[1]=i[4]*r+i[5]*a+i[6]*n,e[2]=i[8]*r+i[9]*a+i[10]*n,e},u.valid=function(e){return!r.a.isNaN(e[0])&&(!r.a.isNaN(e[1])&&!r.a.isNaN(e[2]))},u.neg=u.negate,u.ZERO=u.create(),u.ONE=u.fromValues(1,1,1),u.INFINITY=u.fromValues(1/0,1/0,1/0),u.NEGATIVE_INFINITY=u.fromValues(-1/0,-1/0,-1/0),s.create32=function(){return new Float32Array(2)},s.create64=function(){return new Float64Array(2)},s.fromValues32=function(e,t){var i=new Float32Array(2);return i[0]=e,i[1]=t,i},s.fromValues64=function(e,t){var i=new Float64Array(2);return i[0]=e,i[1]=t,i},s.init=function(e){return s.set(e,0,0)},s.valid=function(e){return!r.a.isNaN(e[0])&&!r.a.isNaN(e[1])},s.ZERO=s.create(),s.ONE=s.fromValues(1,1),s.INFINITY=s.fromValues(1/0,1/0),s.NEGATIVE_INFINITY=s.fromValues(-1/0,-1/0),l.create32=function(){return new Float32Array(4)},l.create64=function(){return new Float64Array(4)},l.fromValues32=function(e,t,i,r){var a=new Float32Array(4);return a[0]=e,a[1]=t,a[2]=i,a[3]=r,a},l.fromValues64=function(e,t,i,r){var a=new Float64Array(4);return a[0]=e,a[1]=t,a[2]=i,a[3]=r,a},l.init=function(e){return l.set(e,0,0,0,0)},l.valid=function(e){return!r.a.isNaN(e[0])&&(!r.a.isNaN(e[1])&&(!r.a.isNaN(e[2])&&!r.a.isNaN(e[3])))},l.neg=l.negate,l.ZERO=l.create(),l.ONE=l.fromValues(1,1,1,1),l.INFINITY=l.fromValues(1/0,1/0,1/0,1/0),l.NEGATIVE_INFINITY=l.fromValues(-1/0,-1/0,-1/0,-1/0),d.IDENTITY=d.create(),d.zeroRotation=function(e){return 0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]},d.create32=function(){var e=new Float32Array(4);return e[3]=1,e},d.create64=function(){var e=new Float64Array(4);return e[3]=1,e},d.fromValues32=l.fromValues32,d.fromValues64=l.fromValues64,d.init=d.identity,d.nlerp=function(e,t,i,r){var a,n,o,s,u=t[0],l=t[1],c=t[2],h=t[3],d=i[0],p=i[1],f=i[2],m=i[3],g=u*d+l*p+c*f+h*m,_=1-r;g<0?(a=u*_-d*r,n=l*_-p*r,o=c*_-f*r,s=h*_-m*r):(a=u*_+d*r,n=l*_+p*r,o=c*_+f*r,s=h*_+m*r);var v=1/Math.sqrt(a*a+n*n+o*o+s*s);return e[0]=a*v,e[1]=n*v,e[2]=o*v,e[3]=s*v,e},h.IDENTITY=h.create(),h.create32=function(){var e=new Float32Array(9);return e[0]=e[4]=e[8]=1,e},h.create64=function(){var e=new Float64Array(9);return e[0]=e[4]=e[8]=1,e},c.IDENTITY=c.create(),c.create32=function(){var e=new Float32Array(16);return e[0]=e[5]=e[10]=e[15]=1,e},c.create64=function(){var e=new Float64Array(16);return e[0]=e[5]=e[10]=e[15]=1,e},c.setTranslation=function(e,t){return e[12]=t[0],e[13]=t[1],e[14]=t[2],e},c.getFrustum=function(e,t){var i,r,a=0,n=0,o=0,s=0;if(0!==t[3]||0!==t[7]||-1!==t[11]||0!==t[15])return!1;var u=t[14]/(t[10]-1),l=t[14]/(1+t[10]);return n=u*(t[8]-1)/t[0],a=u*(1+t[8])/t[0],o=u*(1+t[9])/t[5],s=u*(t[9]-1)/t[5],i=u,r=l,e.left=n,e.right=a,e.top=o,e.bottom=s,e.zNear=i,e.zFar=r,!0},c.getPerspective=function(){var e={right:0,left:0,top:0,bottom:0,zNear:0,zFar:0};return function(t,i){return c.getFrustum(e,i)&&(t.fovy=180/Math.PI*(Math.atan(e.top/e.zNear)-Math.atan(e.bottom/e.zNear)),t.aspectRatio=(e.right-e.left)/(e.top-e.bottom)),t.zNear=e.zNear,t.zFar=e.zFar,t}}(),c.getLookAt=function(){var e=c.create(),t=u.create(),i=u.fromValues(0,1,0),r=u.fromValues(0,0,-1);return function(a,n,o,s,l){var h=void 0!==l?l:1;c.invert(e,s),c.getTranslation(a,e),u.transformMat4Rotate(o,i,s),u.transformMat4Rotate(n,r,s),u.normalize(n,n),u.add(n,u.scale(t,n,h),a)}}(),c.getFrustumPlanes=function(){var e=c.create();return function(t,i,r,a){c.mul(e,i,r);var n=!!a,o=t[0];o[0]=e[3]-e[0],o[1]=e[7]-e[4],o[2]=e[11]-e[8],o[3]=e[15]-e[12];var s=t[1];s[0]=e[3]+e[0],s[1]=e[7]+e[4],s[2]=e[11]+e[8],s[3]=e[15]+e[12];var u=t[2];u[0]=e[3]+e[1],u[1]=e[7]+e[5],u[2]=e[11]+e[9],u[3]=e[15]+e[13];var l=t[3];l[0]=e[3]-e[1],l[1]=e[7]-e[5],l[2]=e[11]-e[9],l[3]=e[15]-e[13];var h=4;if(n){h=6;var d=t[4];d[0]=e[3]-e[2],d[1]=e[7]-e[6],d[2]=e[11]-e[10],d[3]=e[15]-e[14];var p=t[5];p[0]=e[3]+e[2],p[1]=e[7]+e[6],p[2]=e[11]+e[10],p[3]=e[15]+e[14]}for(var f=0;f<h;f++){var m=t[f],g=1/Math.sqrt(m[0]*m[0]+m[1]*m[1]+m[2]*m[2]);m[0]*=g,m[1]*=g,m[2]*=g,m[3]*=g}}}(),c.infiniteFrustum=function(e,t,i,r,a,n){var o=2*n/(i-t),s=2*n/(a-r),u=(i+t)/(i-t),l=(a+r)/(a-r);return e[0]=o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=u,e[9]=l,e[10]=-1,e[11]=-1,e[12]=0,e[13]=0,e[14]=-2*n,e[15]=0,e},c.lookAtDirection=function(){var e=u.create(),t=u.create(),i=u.create();return function(r,a,n,o){var s=n;return u.cross(e,s,o),u.normalize(e,e),u.cross(t,e,s),u.normalize(t,t),r[0]=e[0],r[1]=t[0],r[2]=-s[0],r[3]=0,r[4]=e[1],r[5]=t[1],r[6]=-s[1],r[7]=0,r[8]=e[2],r[9]=t[2],r[10]=-s[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,c.translate(r,r,u.neg(i,a))}}(),c.getScale=function(){var e=u.create(),t=u.create(),i=u.create();return function(r,a){return e[0]=a[0],e[1]=a[4],e[2]=a[8],t[0]=a[1],t[1]=a[5],t[2]=a[9],i[0]=a[2],i[1]=a[6],i[2]=a[10],r[0]=u.length(e),r[1]=u.length(t),r[2]=u.length(i),r}}(),c.getSqrScale=function(){var e=u.create(),t=u.create(),i=u.create();return function(r,a){return e[0]=a[0],e[1]=a[4],e[2]=a[8],t[0]=a[1],t[1]=a[5],t[2]=a[9],i[0]=a[2],i[1]=a[6],i[2]=a[10],r[0]=u.sqrLen(e),r[1]=u.sqrLen(t),r[2]=u.sqrLen(i),r}}();var p=c.rotate;c.rotate=function(e,t,i,r){return p(e,t,i,r)||c.identity(e)};var f=c.fromRotation;c.fromRotation=function(e,t,i){return f(e,t,i)||c.identity(e)}},function(e,t,i){"use strict";function r(e){return new u.a(function(t){window.ga.apply(window,["send"].concat(e,{hitCallback:t}))})}function a(e){return d||(d=void 0!==window.ga)?r(e).timeout(1e3).catch(h.c):(console.info("Tracking event skipped : "+o()(e)),u.a.resolve())}var n=i(49),o=i.n(n),s=i(7),u=i.n(s),l=i(22),c=i(55),h=i(40),d=!1;t.a={wrapLink:function(e,t){"_blank"===e.currentTarget.target||e.metaKey||e.ctrlKey||(e.preventDefault(),t.timeout(800).catch(h.c).then(function(){window.location.href=e.currentTarget.href}))},saveCurrentReferrer:function(){var e=document.referrer,t=document.location.href,i=l.b.string("utm_source"),r=c.a.get("utm_source"),a=new Date;return a.setSeconds(240),-1===t.indexOf(e)&&i&&(e=i),-1===t.indexOf(e)&&r&&(e=r),c.a.set("skfb_referrer_override",e,{expires:a}),e},setSegment:function(e){void 0!==window.ga&&window.ga("set",{dimension5:e?e.get("name"):"None",dimension6:e?e.get("kind"):"None"})},pageView:function(e){return void 0===e&&(e=window.location.pathname+window.location.search),a(["pageview",e])},userRegistered:function(e){return a(["event","user","registered",e])},userUnregistrationSurveyNotCompleted:function(e){return a(["event","user","unregistrationSurveyNotCompleted",e])},userUnregistrationSurveyCompleted:function(e,t){return a(["event","user","unregistrationSurveyCompleted",e,t])},userUpgraded:function(e){return a(["event","user","upgraded",e])},userUpgradeCanceled:function(e){return a(["event","user","upgradeCanceled",e])},userSettingsAvatarUpdated:function(e){return a(["event","userSettings","avatarUpdated",e])},userSettingsNotificationsUpdated:function(e){return a(["event","userSettings","notificationsUpdated",e])},userSettingsPasswordUpdated:function(e){return a(["event","userSettings","passwordUpdated",e])},userSettingsProfileUpdated:function(e){return a(["event","userSettings","profileUpdated",e])},userSettingsAppConnected:function(e){return a(["event","userSettings","appConnected",e])},userSettingsAppDisconnected:function(e){return a(["event","userSettings","appDisconnected",e])},userSummaryFollowButtonClicked:function(e,t){return a(["event","userSummary","followButtonClicked",e,t?1:0])},userProfileFollowButtonClicked:function(e,t){return a(["event","userProfile","followButtonClicked",e,t?1:0])},userProfileContactButtonClicked:function(e){return a(["event","userProfile","contactButtonClicked",e])},userProfileWebsiteLinkClicked:function(e){return a(["event","userProfile","websiteLinkClicked",e])},userProfileSocialLinkClicked:function(e,t){return a(["event","userProfile","socialLinkClicked",t])},followSuggestionsSuggestFollowButtonClicked:function(e,t){return a(["event","followSuggestionsPopupSuggest","followButtonClicked",e,t?1:0])},followSuggestionsSearchFollowButtonClicked:function(e,t){return a(["event","followSuggestionsPopupSearch","followButtonClicked",e,t?1:0])},followSuggestionsSuggestFollowAllButtonClicked:function(e){return a(["event","followSuggestionsPopupSuggest","followAllButtonClicked",e])},followSuggestionsSearchFollowAllButtonClicked:function(e){return a(["event","followSuggestionsPopupSearch","followAllButtonClicked",e])},modelPageFollowButtonClicked:function(e,t){return a(["event","modelPage","followButtonClicked",e,t?1:0])},modelPageSettingsButtonClicked:function(e){return a(["event","modelPage","settingsButtonClicked",e])},modelPage3dSettingsButtonClicked:function(e){return a(["event","modelPage","3dSettingsButtonClicked",e])},modelPageAnnotationsButtonClicked:function(e){return a(["event","modelPage","AnnotationsButtonClicked",e])},modelPageAddToCollectionButtonClicked:function(e){return a(["event","modelPage","addToCollectionButtonClicked",e])},modelPageCreateCollectionButtonClicked:function(e){return a(["event","modelPage","createCollectionButtonClicked",e])},modelPageReuploadButtonClicked:function(e){return a(["event","modelPage","reuploadButtonClicked",e])},modelPageDeleteButtonClicked:function(e){return a(["event","modelPage","deleteButtonClicked",e])},modelPageEmbedButtonClicked:function(e){return a(["event","modelPage","embedButtonClicked",e])},modelPageShareButtonClicked:function(e){return a(["event","modelPage","shareButtonClicked",e])},modelPageFavoriteButtonClicked:function(e,t){return a(["event","modelPage","favoriteButtonClicked",e,t?1:0])},modelPageDownloadButtonClicked:function(e){return a(["event","modelPage","downloadButtonClicked",e])},modelPageNewCommentPosted:function(e,t){return a(["event","modelPage","newCommentPosted",e,t?1:0])},modelPageCommentDeleted:function(e,t){return a(["event","modelPage","commentDeleted",e,t?1:0])},modelPageExporterLinkClicked:function(e){return a(["event","modelPage","exporterLinkClicked",e])},modelPageModelInformationClicked:function(){return a(["event","modelPage","modelInformationClicked"])},modelRipperBlocked:function(e,t){return a(["event","modelRipper",e+"Blocked",t])},modelCardSettingsButtonClicked:function(e){return a(["event","modelCard","settingsButtonClicked",e])},modelCardReuploadButtonClicked:function(e){return a(["event","modelCard","reuploadButtonClicked",e])},modelCardDeleteButtonClicked:function(e){return a(["event","modelCard","deleteButtonClicked",e])},modelCard3dSettingsButtonClicked:function(e){return a(["event","modelCard","3dSettingsButtonClicked",e])},modelCardAnnotationsButtonClicked:function(e){return a(["event","modelCard","AnnotationsButtonClicked",e])},modelCardAddToCollectionButtonClicked:function(e){return a(["event","modelCard","addToCollectionButtonClicked",e])},modelCardPreviewButtonClicked:function(e){return a(["event","modelCard","previewButtonClicked",e])},modelCardFavoriteButtonClicked:function(e,t){return a(["event","modelCard","favoriteButtonClicked",e,t?1:0])},modelCardCommentsButtonClicked:function(e,t){return a(["event","modelCard","commentsButtonClicked",e,t])},modelListCardFavoriteButtonClicked:function(e,t){return a(["event","modelListCard","favoriteButtonClicked",e,t?1:0])},modelListCardCommentsButtonClicked:function(e,t){return a(["event","modelListCard","commentsButtonClicked",e,t])},modelPreviewClosePopupButtonClicked:function(e){return a(["event","modelPreview","closePopupButtonClicked",e])},modelPreviewViewModelButtonClicked:function(e){return a(["event","modelPreview","viewModelButtonClicked",e])},modelPreviewShareButtonClicked:function(e){return a(["event","modelPreview","shareButtonClicked",e,status?1:0])},modelPreviewFavoriteButtonClicked:function(e,t){return a(["event","modelPreview","favoriteButtonClicked",e,t?1:0])},modelPreviewCommentsButtonClicked:function(e,t){return a(["event","modelPreview","commentsButtonClicked",e,t])},modelPreviewDownloadButtonClicked:function(e){return a(["event","modelPreview","downloadButtonClicked",e])},modelPreviewCollectionButtonClicked:function(e){return a(["event","modelPreview","collectionButtonClicked",e])},modelSettingsDownloadButtonClicked:function(e,t){return a(["event","modelSettings","downloadButtonClicked",e,t])},modelDownloadFavoriteButtonClicked:function(e,t){return a(["event","modelDownload","favoriteButtonClicked",e,t?1:0])},modelSettingsLicenseChanged:function(e){return a(["event","modelSettings","licenseChanged",e])},modelSettingsSaveButtonClicked:function(e){return a(["event","modelSettings","saveButtonClicked",e])},modelSettingsCancelButtonClicked:function(e){return a(["event","modelSettings","cancelButtonClick",e])},modelEmbedDownloadButtonClicked:function(e){return a(["event","modelEmbed","downloadButtonClicked",e])},modelEmbedFavoriteButtonClicked:function(e,t){return a(["event","modelEmbed","favoriteButtonClicked",e,t?1:0])},modelEmbedShareButtonClicked:function(e){return a(["event","modelEmbed","shareButtonClicked",e])},modelEmbedInfosButtonClicked:function(e,t){return a(["event","modelEmbed","infosButtonClicked",e,t?1:2])},modelEmbedAutostart:function(e){return a(["event","modelEmbed","autostart",e])},modelEmbedPlayButtonClicked:function(e){return a(["event","modelEmbed","playButtonClicked",e])},modelEmbedStopButtonClicked:function(e){return a(["event","modelEmbed","stopButtonClicked",e])},modelEmbedModelInteraction:function(e,t){return a(["event","modelEmbed","modelInteraction"+t,e])},modelEmbedViewModelButtonClicked:function(e){return a(["event","modelEmbed","viewModelButtonClicked",e])},modelEmbedWatermarkClicked:function(e){return a(["event","modelEmbed","watermarkClicked",e])},modelViewerRenderingOptionsButtonClicked:function(){return a(["event","modelViewer","renderingOptionsButtonClicked"])},modelViewerViewerModeButtonClicked:function(){return a(["event","modelViewer","viewerModeButtonClicked"])},modelViewerFullscreenButtonClicked:function(e){return a(["event","modelViewer","fullscreenButtonClicked",e?1:0])},modelViewerTheatreModeButtonClicked:function(e){return a(["event","modelViewer","theatreButtonClicked",e?1:0])},modelViewerVrButtonClicked:function(e){return a(["event","modelViewer","vrButtonClicked",e])},modelViewerInspectorShortcut:function(){return a(["event","modelViewer","inspectorShortcut"])},modelViewerInspectorButtonClicked:function(){return a(["event","modelViewer","inspectorButtonShortcut"])},modelViewerViewerModeSelected:function(e){return a(["event","modelViewer","viewerModeSelected",e])},modelViewerShadingSelected:function(e){return a(["event","modelViewer","shadingSelected",e])},modelViewerAnnotationsToggled:function(e,t){return a(["event","modelViewer","annotationsToggled",e,t?1:0])},modelViewerAnnotationListClicked:function(e){return a(["event","modelViewer","annotationListClicked",e])},modelViewerAnnotationsCycleToggled:function(e,t){return a(["event","modelViewer","annotationsCycleToggled",e,t?1:0])},modelViewerWireframeToggleClicked:function(e){return a(["event","modelViewer","wireframeEnable",e])},modelViewerWireframeColorSelected:function(e){return a(["event","modelViewer","wireframeColorSelected",e])},modelViewerWireframeShortcut:function(e){return a(["timing","modelViewer","wireframeEnable",e])},modelViewerTextureQualitySelected:function(e){return a(["event","modelViewer","textureQualitySelected",e])},modelViewerPolygonLoaded:function(e){return a(["timing","modelViewer","polygonLoaded",e])},modelViewerWireframeLoaded:function(e){return a(["timing","modelViewer","wireframeLoaded",e])},modelViewerHighResTexturesLoaded:function(e,t){return a(["timing","modelViewer","highResTexturesLoaded",e,{metric2:t}])},modelViewerLowResTexturesLoaded:function(e,t){return a(["timing","modelViewer","lowResTexturesLoaded",e,{metric2:t}])},modelViewerModelDisplayed:function(e){return a(["timing","modelViewer","modelDisplayed",e])},modelViewerNextAnnotationClicked:function(e){return a(["event","modelViewer","nextAnnotationClicked",e])},modelViewerPreviousAnnotationClicked:function(e){return a(["event","modelViewer","previousAnnotationClicked",e])},modelViewerAnnotationClicked:function(e){return a(["event","modelViewer","annotationClicked",e])},modelViewerAnimationPlayClicked:function(e){return a(["event","modelViewer","animationPlayClicked",e])},modelViewerAnimationPauseClicked:function(e){return a(["event","modelViewer","animationPauseClicked",e])},modelViewerAnimationSpeedSelected:function(e){return a(["event","modelViewer","animationSpeedSelected",e])},modelViewerAnimationRepeatModeSelected:function(e){return a(["event","modelViewer","animationRepeatModeSelected",e])},modelViewerAnimationListClicked:function(e){return a(["event","modelViewer","animationListClicked",e])},modelViewerAnimationNoAnimationClicked:function(e){return a(["event","modelViewer","animationNoAnimationClicked",e])},modelViewerAnimationSeeked:function(e,t){return a(["event","modelViewer","animationSeeked",e,t])},modelViewerFallbackDisplayed:function(e){return a(["event","modelViewer","fallbackDisplayed",e])},modelViewerHelpButtonCliked:function(e){return a(["event","modelViewer","helpButtonClicked",e])},modelViewerResetCameraButtonClicked:function(){return a(["event","modelViewer","resetCameraButtonClicked"])},modelViewerHelpTabClicked:function(e){return a(["event","modelViewer","helpTabClicked",e])},modelViewerMuteButtonClicked:function(e){return a(["event","modelViewer","muteButtonClicked"])},headerSearchInitiated:function(e){return a(["event","header","searchInitiated",e])},headerUploadButtonClicked:function(){return a(["event","header","uploadButtonClicked",window.location.pathname+window.location.search])},headerUploadSignupButtonClicked:function(){return a(["event","header","uploadSignupButtonClicked"])},headerStoreSellerSignupButtonClicked:function(){return a(["event","header","storeSellerSignupButtonClicked"])},embedPopupEmbedFormatSelected:function(e){return a(["event","embedPopup","embedFormatSelected",e])},embedPopupShowOptionsButtonClicked:function(){return a(["event","embedPopup","showOptionsButtonClicked"])},embedPopupOptionToggleChanged:function(e,t){return a(["event","embedPopup","optionToggleChanged",e,t?1:0])},collectionEmbedPopupShowOptionsButtonClicked:function(){return a(["event","collectionEmbedPopup","showOptionsButtonClicked"])},collectionEmbedPopupOptionToggleChanged:function(e,t){return a(["event","collectionEmbedPopup","optionToggleChanged",e,t?1:0])},modelBrowseTagFilterAdded:function(e){return a(["event","modelBrowse","tagFilterAdded",e])},modelBrowseDateFilterChanged:function(e){return a(["event","modelBrowse","dateFilterChanged",e])},modelBrowseSortFilterChanged:function(e){return a(["event","modelBrowse","sortFilterChanged",e])},modelBrowseFaceCountFilterChanged:function(e){return a(["event","modelBrowse","faceCountFilterChanged",e])},modelBrowseFeaturesFilterChanged:function(e){return a(["event","modelBrowse","featuresFilterChanged",e])},modelBrowseCategoryFilterChanged:function(e){return a(["event","modelBrowse","categoryFilterChanged",e])},modelBrowseFlagFilterChanged:function(e){return a(["event","modelBrowse","flagFilterChanged",e])},modelUploadStarted:function(){return a(["event","modelUpload","started"])},modelUploadCanceled:function(){return a(["event","modelUpload","canceled"])},modelUploadProcessed:function(e){return a(["event","modelUpload","processed",e?1:0])},collectionCardDeleteButtonClicked:function(e){return a(["event","collectionCard","deleteButtonClicked",e])},collectionCardPreviewButtonClicked:function(e){return a(["event","collectionCard","previewButtonClicked",e])},collectionSettingsSaveButtonClicked:function(e){return a(["event","collectionSettings","saveButtonClicked",e])},collectionSettingsCancelButtonClicked:function(e){return a(["event","collectionSettings","cancelButtonClicked",e])},collectionPageDeleteButtonClicked:function(e){return a(["event","collectionPage","deleteButtonClicked",e])},collectionPageEmbedButtonClicked:function(e){return a(["event","collectionPage","embedCollectionButtonClicked",e])},collectionPageShareButtonClicked:function(e){return a(["event","collectionPage","shareCollectionButtonClicked",e])},collectionPreviewViewCollectionButtonClicked:function(e){return a(["event","collectionPreview","viewCollectionButtonClicked",e])},collectionPreviewShareButtonClicked:function(e){return a(["event","collectionPreview","shareButtonClicked",e])},collectionPreviewClosePopupButtonClicked:function(e){return a(["event","collectionPreview","closePopupButtonClicked",e])},landingVideoTourButtonClicked:function(){return a(["event","landing","videoTourButtonClicked"])},studentsPageCheckEligibilitySucceeded:function(e){return a(["event","studentsPage","eligibilityCheckSucceeded",e])},studentsPageCheckEligibilityFailed:function(e){return a(["event","studentsPage","eligibilityCheckFailed",e])},studentsPageContactUsButtonClicked:function(){return a(["event","studentsPage","contactUsButtonClicked"])},annotationEditorCreateButtonClicked:function(e){return a(["event","annotationEditor","createButtonClicked",e])},annotationEditorDeleteButtonClicked:function(e){return a(["event","annotationEditor","deleteButtonClicked",e])},annotationEditorPositionMoved:function(e){return a(["event","annotationEditor","positionMoved",e])},annotationEditorListReordered:function(e){return a(["event","annotationEditor","listReordered",e])},annotationEditorCameraButtonClicked:function(e){return a(["event","annotationEditor","cameraButtonClicked",e])},annotationEditorTooltipEdited:function(e){return a(["event","annotationEditor","tooltipEdited",e])},annotationEditorWidgetDoneButtonClicked:function(e){return a(["event","annotationEditor","widgetDoneButtonClicked",e])},annotationEditorLimitReachedUpgradeButtonClicked:function(e){return a(["event","annotationEditor","annotationEditorLimitReachedUpgradeButtonClicked",e.get("uid")])},soundEditorSoundAdded:function(){return a(["event","soundEditor","soundAdded"])},soundEditorSoundRemoved:function(){return a(["event","soundEditor","soundRemoved"])},soundEditorPreviewSoundButtonClicked:function(){return a(["event","soundEditor","previewSoundButtonClicked"])},soundEditorChangeSoundButtonClicked:function(){return a(["event","soundEditor","changeSoundButtonClicked"])},soundEditor3DSoundButtonClicked:function(){return a(["event","soundEditor","3DSoundButtonClicked"])},soundEditorLoopButtonClicked:function(){return a(["event","soundEditor","LoopButtonClicked"])},postProcessEditorEffectToggled:function(e,t){return a(["event","postProcessEditor","effectToggled",e,t?1:0])},categoryPageFollowSuggestionsButtonClicked:function(e,t){return a(["event","categoryPage","followSuggestionsFollowButtonClicked",e,t?1:0])},tagPageFollowSuggestionsButtonClicked:function(e,t){return a(["event","tagPage","followSuggestionsFollowButtonClicked",e,t?1:0])},shareButtonClicked:function(e,t,i){return a(["event",e,t,i])},deleteModelPopupReasonSelected:function(e){return a(["event","deleteModelPopup","deleteReasonSelected",e])},invitePageSendEmailClicked:function(e){return e=parseInt(e),a(["event","invitePage","sendEmailClicked","",e])},invitePageTwitterButtonClicked:function(){return a(["event","invitePage","twitterButtonClicked"])},invitePageFacebookButtonClicked:function(){return a(["event","invitePage","facebookButtonClicked"])},invitePageGoogleplusButtonClicked:function(){return a(["event","invitePage","googleplusButtonClicked"])},modelIssueReported:function(e,t){return a(["event","modelIssueReported",e,t])},newsfeedFollowCardFollowButtonClicked:function(e,t){return a(["event","newsfeedFollowCard","followButtonClicked",e,t?1:0])},newsfeedPageFollowSuggestionsButtonClicked:function(e,t){return a(["event","newsfeedPage","followSuggestionsFollowButtonClicked",e,t?1:0])},newsfeedCardFollowButtonClicked:function(e,t){return a(["event","newsfeedCard","followButtonClicked",e,t?1:0])},newsfeedCardModelPreviewButtonClicked:function(e){return a(["event","newsfeedCard","modelPreviewButtonClicked",e])},newsfeedCardFavoriteButtonClicked:function(e,t){return a(["event","newsfeedCard","favoriteButtonClicked",e,t?1:0])},onboardingUsersFollowed:function(e,t){return a(["event","onboarding","usersFollowed",t,e])},onboardingInterestsSelected:function(e){return a(["event","onboarding","interestsSelected","",e])},onboardingSkillsSelected:function(e){return a(["event","onboarding","skillsSelected","",e])},playlistNextButtonClicked:function(){return a(["event","playlist","nextButtonClicked"])},playlistPreviousButtonClicked:function(){return a(["event","playlist","previousButtonClicked"])},playlistTocItemClicked:function(){return a(["event","playlist","tocItemClicked"])},playlistTocToggleClicked:function(){return a(["event","playlist","tocToggleClicked"])},profileWizardGeolocationClicked:function(){return a(["event","profileWizard","geolocationClicked"])},uploadCardCollectionCreated:function(e){return a(["event","uploadCard","collectionCreated",e])},uploadCardCollectionEnabled:function(e){return a(["event","uploadCard","collectionEnabled",e])},uploadCardCollectionDisabled:function(e){return a(["event","uploadCard","collectionDisabled",e])},uploadCardSettingsButtonClicked:function(e){return a(["event","uploadCard","settingsButtonClicked",e])},uploadCardReuploadButtonClicked:function(e){return a(["event","uploadCard","reuploadButtonClicked",e])},uploadCardDeleteButtonClicked:function(e){return a(["event","uploadCard","deleteButtonClicked",e])},uploadCard3dSettingsButtonClicked:function(e){return a(["event","uploadCard","3dSettingsButtonClicked",e])},uploadCardAnnotationsButtonClicked:function(e){return a(["event","uploadCard","AnnotationsButtonClicked",e])},inspectorDisplayViewClicked:function(e,t){return a(["event","inspector","displayViewClicked",e+":"+t])},inspectorModeShortcut:function(e,t){return a(["event","inspector","displayViewShortcut",e+":"+t])},inspectorSplitTypeClicked:function(e){return a(["event","inspector","splitTypeClicked",e])},inspectorUIVisibilityToggleClicked:function(){return a(["event","inspector","UIVisibilityToggleClicked"])},storeCheckoutInitiated:function(e,t){return a(["event","store","InitiateCheckout",e,t])},storePurchaseCompleted:function(e,t){return a(["event","store","Purchase",e,t])}}},function(e,t,i){"use strict";var r=i(29),a=i.n(r),n=i(0),o=(i.n(n),i(15)),s=i.n(o),u=i(116),l=i(132),c=i(22),h=i(2),d=Object(u.a)(["initialize"]),p=d(s.a.Model);t.a=p.extend({optionTypes:{},idAttribute:"uid",backend:l.a,constructor:function(){this.options=arguments[1]||{},p.apply(this,arguments)},initialize:function(){p.prototype.initialize.apply(this,arguments),this.checkModelTypes()},set:function(){return p.prototype.set.apply(this,arguments)},sync:function(){return p.prototype.sync.apply(this,arguments).then(function(){return this}.bind(this))},domain:function(){return Object(n.result)(this.backend,"domain")},queryParams:function(){return{}},url:function(){var e=Object(n.result)(this,"domain"),t=Object(n.result)(this,"endpoint"),i=e+t,r=i+c.b.craft("?",this.queryParams());return r=r.replace(/(?!^)\/{2,}/g,"/")},isNew:function(){var e=this.get(this.idAttribute);return void 0===e||!(!e||"tmp_"!==e.toString().substr(0,4))},checkModelTypes:function(){Object(h.a)(this.optionTypes,this.toJSON(),"value",this.displayName||"Model")}},{extend:function(e,t){var i=Object(n.extend)({},e,{optionTypes:Object(n.extend)({},this.prototype.optionTypes||{},e.optionTypes||{})});return p.extend.call(this,i,t)},get:function(e,t){t=Object(n.extend)({},t),"object"!==(void 0===e?"undefined":a()(e))&&(e={uid:e});var i=this,r=new i(e),o=function(e){return e.set({}),e};return t.immediate?(r.fetch(t),o(r)):r.fetch(t).then(o)}})},function(e,t,i){"use strict";var r=i(20),a=i.n(r),n=i(3),o=i.n(n),s=i(0),u=(i.n(s),i(30)),l=(i(2),i(8)),c=i(86),h=i(617),d=l.a.extend({displayName:"Component",mixins:[c.a,h.a],isComponent:!0,setElement:function(){return l.a.prototype.setElement.apply(this,arguments),this.isRenderedManually()&&(this.$el.attr("data-component")||this.$el.attr("data-component",""),this.$el.attr("id")||this.$el.attr("id",this.cid)),this},$:function(e){var t=this.$el;return this.$el.find(e).filter(function(){return o()(this).parent().closest("[data-component]").is(t)})},delegate:function(e,t,i){var r=this.$el;return this.$el.on(e+".delegateEvents"+this.cid,t,function(e){o()(e.currentTarget).closest("[data-component]").is(r)&&i.apply(this,arguments)}),this},_removeElement:function(){this.isRenderedManually()&&this.$el.html("")},isRenderedManually:function(){return!this.options._isChildOfAComponent},getItemKey:function(e,t,i){return e.options&&e.options.key||t},normalizeChildConfig:function(e,t){var i=t||{};return Object(s.extend)({viewClass:d},i,{options:Object(s.extend)({},i.options,{_isChildOfAComponent:!0,el:void 0})})},_getLazyComponent:function(e,t){return function(){var i=this.updateChildConfig(e,this.normalizeChildConfig(e,t)).refreshChild(e).getChild(e);return{isComponentElement:!0,template:function(){return this.setChildOptions(e),i.isMounted?i.shouldUpdate?i._template:"":i.template()}.bind(this),cid:i.cid,displayName:i.displayName}}.bind(this)},createChildComponent:function(e,t){var i=this;return Array.isArray(t)?t.map(function(r,a){var n=i.getItemKey(r,a,t);return i._getLazyComponent(e+n,r)}):this._getLazyComponent(e,t)},createChildrenComponents:function(e){return Object(s.mapValues)(e,function(e,t){return this.createChildComponent(t,e)}.bind(this))},beforeRender:function(){l.a.prototype.beforeRender.apply(this,arguments),a()(this.children).map(this.getChild.bind(this)).filter(Object(u.f)("isComponent")).forEach(function(e){e.beforeRender()})},removeUnmountedChildren:function(e){a()(this.children).filter(function(t){return this.getChild(t).isComponent&&!e.match('id="'+this.getChild(t).cid+'"')}.bind(this)).forEach(this.removeChild.bind(this))},onViewUpdate:function(e,t,i,r,a,n){e&&(n||this.isRenderedManually()?(this.render(),this.viewDidUpdate(t,i)):(this._template=this.template(),this.removeUnmountedChildren(this._template),this._executeAfterRender=this.viewDidUpdate.bind(this,t,i)))},render:function(){this._template=this.template(),this.removeUnmountedChildren(this._template),this.renderDiff(this._template)},afterRender:function(){var e=this;l.a.prototype.afterRender.apply(this,arguments),a()(this.children).map(this.getChild.bind(this)).filter(Object(u.f)("isComponent")).map(function(t){var i=e.el.querySelector("#"+t.cid);return i&&t.el!==i&&t.setElement(i),t}).forEach(function(e){e.afterRender()}),this._executeAfterRender&&(this._executeAfterRender(),this._executeAfterRender=null)}});t.a=d},function(e,t){!function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/layouts/popup.jinja"]=function(){function e(e,t,i,r,a){var n="";try{var o=null;n+='<div class="popup-container',r.contextOrFrameLookup(t,i,"popupNeedsLoading")&&(n+=" popup-loading"),n+=" ",n+=r.suppressValue(r.contextOrFrameLookup(t,i,"popupClass"),e.opts.autoescape),n+='">\n\n    <div class="popup-overlay">\n    </div>\n\n    <form class="popup js-popup" method="post"',r.contextOrFrameLookup(t,i,"allowAutocomplete")||(n+=' autocomplete="off"'),n+=" ",r.contextOrFrameLookup(t,i,"popupAction")&&(n+='action="',n+=r.suppressValue(r.contextOrFrameLookup(t,i,"popupAction"),e.opts.autoescape),n+='"'),n+=">\n\n        ",r.contextOrFrameLookup(t,i,"allowAutocomplete")||(n+="\n            ",n+='\n            <input type="text" style="display:none" />\n            <input type="password" style="display:none" />\n        '),n+='\n\n        <input type="hidden" name="csrfmiddlewaretoken" value="',n+=r.suppressValue(r.contextOrFrameLookup(t,i,"csrf_token"),e.opts.autoescape),n+='" />\n\n        <header class="popup-header">\n\n            ',(o?function(e,t,i,r,a){a("")}:t.getBlock("popup_header"))(e,t,i,r,function(s,u){if(s)return void a(s);n+=u,n+='\n\n            <div class="popup-actions">\n                ',r.contextOrFrameLookup(t,i,"popupClosable")&&(n+='\n                    <a class="popup-close" data-action="close">\n                        <i class="fa fa-times"></i>\n                    </a>\n                '),n+='\n            </div>\n\n        </header>\n\n        <div class="popup-content">\n\n            <div class="popup-content-overlay"></div>\n\n            ',(o?function(e,t,i,r,a){a("")}:t.getBlock("popup_content"))(e,t,i,r,function(s,u){if(s)return void a(s);n+=u,n+="\n        </div>\n\n        ",e.getFilter("default").call(t,r.contextOrFrameLookup(t,i,"withFooter"),!0)&&(n+='\n            <footer class="popup-footer">\n                ',(o?function(e,t,i,r,a){a("")}:t.getBlock("popup_footer"))(e,t,i,r,function(e,t){if(e)return void a(e);n+=t,n+="\n            </footer>\n        "})),n+="\n\n    </form>\n\n</div>\n",o?o.rootRenderFunc(e,t,i,r,a):a(null,n)})})}catch(e){a(r.handleError(e,null,null))}}function t(e,t,i,r,a){var n="";try{var i=i.push(!0);n+='\n                <div class="popup-title">\n                    ',n+=r.suppressValue(r.contextOrFrameLookup(t,i,"popupTitle"),e.opts.autoescape),n+="\n                </div>\n            ",a(null,n)}catch(e){a(r.handleError(e,null,null))}}function i(e,t,i,r,a){var n="";try{var i=i.push(!0);n+="\n            ",a(null,n)}catch(e){a(r.handleError(e,null,null))}}function r(e,t,i,r,a){var n="";try{var i=i.push(!0);n+="\n                ",a(null,n)}catch(e){a(r.handleError(e,null,null))}}return{b_popup_header:t,b_popup_content:i,b_popup_footer:r,root:e}}()}()},,function(e,t,i){"use strict";var r,a=i(17),n=i(0),o=(i.n(n),i(165)),s=i.n(o),u=i(406),l=i(47),c=i(22),h=i(153),d=i(70),p=i(6),f=i(42),m=i.n(f),g=function(e){if(null!==e&&void 0!==e)return"+Infinity"===e||"Infinity"===e?1/0:"-Infinity"===e?-1/0:e},_=function(){var e={};for(var t in s.a){var i=s.a[t],r=g(i.defaultValue),a=void 0;if(void 0!==i.alias)for(var o in i.alias)if(void 0!==(a=c.b[i.type](o)))break;e[Object(n.camelCase)(t)]=void 0!==a?a:c.b[i.type](t,r)}return e},v=function(){if(r)return r;if(window.prefetchedData.embedOptions){r=window.prefetchedData.embedOptions;for(var e in r)r[e]=g(r[e])}else r=_();try{p.a.me().get("isStaff")&&void 0===r.webgl2&&(r.webgl2=!0)}catch(e){console.warn("Prefetching failure while trying to reach User.me(). This is probably because this code has been run in a non web context where prefetchdata are unusable.")}if(r.apiId=c.b.string("api_id",void 0),r.uiInspector){var t=Object(u.a)();r.uiInspector=-1===a.a.inspectorBlacklist.indexOf(t)}r.annotationCycleAutostart=void 0!==r.annotationCycle,r.annotationCycleDuration=5e3,void 0!==r.annotationCycle&&(r.annotationCycleDuration=1e3*r.annotationCycle,delete r.annotationCycle),(r.cardboard||r.annotation||Object(l.a)())&&(r.camera=!1),r.stats&&(r.continuousRender=!0),r.processOptions&&Object(d.a)(!0),r.processOptions&&(r.processMaterial=!0),r.stats&&(r.webglTimerGpu=!1);var i=!r.apiVersion||"1.1.0"===r.apiVersion,n=i&&!r.materialShowcase,o=!Object(d.a)()&&!Object(l.a)()&&n;if(void 0===r.mergeMaterials&&(r.mergeMaterials=o),void 0===r.graphOptimizer&&(r.graphOptimizer=o),void 0===r.materialPacking&&(r.materialPacking=n),void 0===r.imageCompression&&(r.imageCompression=!Object(l.a)()),void 0===r.normalCompression&&(r.normalCompression=m.a.any?"jpg":"percep"),r.shadowAtlas=r.shadowAtlas&&!Object(l.a)(),void 0===r.drsMin){var s=Math.max(1,Math.min(1.5,window.devicePixelRatio||0));r.drsMin=1/s}return r.sssKernel%2==0&&r.sssKernel++,r.sssHalfKernel=1+(r.sssKernel>>1),Object(h.a)(r),r.zoct=c.b.bool("zoct",!1),r.zq=c.b.bool("zq",!0),r.zr=c.b.bool("zr",!0),r.zw=c.b.bool("zw",!0),r.zz=c.b.bool("zz",!Object(l.a)()),r};t.a=v},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(383)),n=i(384),o=i.n(n);t.a=Object(r.extend)({},a.a,o.a)},,,,function(e,t,i){"use strict";function r(){var e=arguments[0];if(u.console&&!(e>u.currentNotifyLevel)){var t=arguments[1],i=Array.prototype.slice.call(arguments);i=i.splice(2,arguments.length),u.console[t].apply(u.console,i),u.traceLogCall&&e!==u.ERROR&&console.trace()}}function a(e,t,i,r){!u.console||e>u.currentNotifyLevel||(u.console.groupCollapsed&&u.console.groupCollapsed(i),u.console[t](r),u.traceLogCall&&e!==u.ERROR&&console.trace(),u.console.groupEnd&&u.console.groupEnd())}function n(e,t){return t?[e.slice(0,4),e.slice(4,8),e.slice(8,12),e.slice(12,16)]:[[e[0],e[4],e[8],e[12]],[e[1],e[5],e[9],e[13]],[e[2],e[6],e[10],e[14]],[e[3],e[7],e[11],e[15]]]}function o(e,t,i){e>u.currentNotifyLevel||u.console.table&&r("table",n(t,i))}function s(e,t,i,r){e>u.currentNotifyLevel||u.console.table&&a("table",t,n(i,r))}var u={};u.ALWAYS=0,u.FATAL=u.ERROR=1,u.WARN=2,u.NOTICE=u.LOG=3,u.INFO=4,u.DEBUG=5,u.currentNotifyLevel=u.LOG,u.console=window.console;for(var l=["error","warn","log","info","debug"],c=0;c<l.length;++c){var h=l[c],d=u[h.toUpperCase()];u[h]=r.bind(u,d,h),u[h+"Fold"]=a.bind(u,d,h),u[h+"Matrix"]=o.bind(u,d),u[h+"MatrixFold"]=s.bind(u,d)}u.group=r.bind(u,u.LOG,"group"),u.groupCollapsed=r.bind(u,u.LOG,"groupCollapsed"),u.groupEnd=u.console.groupEnd,u.notice=u.log,u.noticeFold=u.logFold,u.noticeMatrix=u.logMatrix,u.noticeMatrixFold=u.logMatrixFold,u.assert=function(e,t){void 0===this.console||e||this.console.assert(e,t)},u.setNotifyLevel=function(e,t){u.currentNotifyLevel=e,void 0!==t&&(u.traceLogCall=t)},u.getNotifyLevel=function(){return u.currentNotifyLevel},u.reportWebGLError=!1,u.setConsole=function(e){u.console=e},t.a=u},function(e,t,i){"use strict";function r(e){return"cursor"===e||"page"===e}function a(e,t){arguments.length<2&&(t=e,e=""),t=Object(_.a)(t);var i=f()(t).sort(function(e,t){return r(e)?1:r(t)?-1:e===t?0:e<t?-1:1}).map(function(e){return t[e].filter(function(e){return null!==e&&void 0!==e&&""!==e}).map(function(t){return!0!==t&&!1!==t||(t=Number(t)),[e,t].map(function(e){return encodeURIComponent(e).replace(/%20/g,"+").replace(/%25/g,"%").replace(/%2C/g,",")}).join("=")}).join("&")}).filter(function(e){return e.length>0}).join("&");return i?e+i:""}function n(){return Array.prototype.slice.call(arguments).map(_.a).reduce(function(e,t){return f()(t).forEach(function(i,r){e[r]=(e[r]||[]).concat(t[r])}),e},{})}function o(){return Array.prototype.slice.call(arguments).map(_.a).reduce(function(e,t){return Object(m.assign)(e,t)},{})}function s(e){var t=window.location.search.substr(1);return Object(_.a)(t)[e]||[]}function u(e,t){var i=s(e)||[];return i.length?i.pop():void 0!==t?t.toString():void 0}function l(e,t){var i=u(e);return void 0===i?void 0!==t?Boolean(t):void 0:"0"!==i}function c(e,t){var i=t||[],r=u(e,""),a=i.reduce(function(e,t){return e[t]=!1,e},{});return r.split(" ").map(g.j).reduce(function(e,t){return e[t]=!0,e},a)}function h(e,t){var i=u(e);return void 0===i?void 0!==t?Number(t):void 0:Number(i)}function d(e,t){var i=u(e);if(!i)return t;if(i=i.split(","),i.length<3)return t;i.length=3;for(var r=0;r<3;++r)i[r]=parseFloat(i[r]);return i}t.a=a;var p=i(20),f=i.n(p),m=i(0),g=(i.n(m),i(53)),_=i(74);t.b={craft:a,merge:n,features:c,reset:o,strings:s,string:u,bool:l,number:h,vec3:d}},function(e,t,i){"use strict";var r=i(3),a=i.n(r),n=i(0),o=(i.n(n),i(8)),s=i(25),u=i(83),l=i(103),c=i(2),h=i(94),d=[];t.a=o.a.extend({parent:"body",el:'<div data-element="popup" />',optionTypes:{cleanOnClose:c.b.bool,shouldExitOnClickOutside:c.b.bool,shouldRejectOnCancel:c.b.bool},defaultOptions:{cleanOnClose:!0,shouldExitOnClickOutside:!0,shouldRejectOnCancel:!1},events:{"click .popup-overlay":"onClickOutside",'click [data-action="close"]':"cancel","reset form":"cancel","submit form":"continue","click button:not([type])":l.c},constructor:function(){this.onKeyDown=this.onKeyDown.bind(this),this.debouncedCenter=Object(n.debounce)(this.center,50),this.resizeHandler=function(){a.a.each(d,function(e,t){t.debouncedCenter()})}.bind(this),o.a.apply(this,arguments)},initialize:function(){o.a.prototype.initialize.apply(this,arguments),this.renderLayout()},setElement:function(){return o.a.prototype.setElement.apply(this,arguments),this.$container=this.$(".popup-container"),this},delegateEvents:function(){o.a.prototype.delegateEvents.apply(this,arguments),a()(window).on("resize",this.resizeHandler),document.addEventListener("keydown",this.onKeyDown,!0)},undelegateEvents:function(){o.a.prototype.undelegateEvents.apply(this,arguments),a()(window).off("resize",this.resizeHandler),document.removeEventListener("keydown",this.onKeyDown,!0)},getPromise:function(){return this._promise||(this._promise=new u.a),this._promise},open:function(){return-1!==d.indexOf(this)?(this.show(),this.setElement(this.$el),this.getPromise()):(d.unshift(this),a()(Object(n.result)(this,"parent")).append(this.$el),this.setElement(this.$el),this.hide(),this.center(),window.requestAnimationFrame(function(){this.show()}.bind(this)),this.autofocus(),this.center(),this.getPromise())},show:function(){this.$container.removeClass("hidden")},hide:function(){this.$container.addClass("hidden")},setIsLoading:function(e){this.$container.toggleClass("popup-loading",e)},isHidden:function(){return this.$container.hasClass("hidden")},onKeyDown:function(e){27===e.keyCode&&0!==d.length&&(this.cancel(),e.stopImmediatePropagation(),e.stopPropagation())},onClickOutside:function(){this.options.shouldExitOnClickOutside&&this.cancel()},cancel:function(e){return this._close(),this.options.shouldRejectOnCancel?this.getPromise().reject(new s.e(e)):this.getPromise().resolve()},continue:function(e){return this._close(),this.getPromise().resolve(e)},_close:function(e,t){return-1===d.indexOf(this)?this:this.$container.closest(".inline-popup").length>0?this:((this.options.cleanOnClose||t)&&(Object(h.a)(this.$el,this.remove.bind(this)),-1!==d.indexOf(this)&&d.splice(d.indexOf(this),1)),this.hide(),this)},close:function(e){return this._close(null,e)},replaceWith:function(e,t){return this.close(t),e.open()},center:function(){var e=this.$(".js-popup"),t=this.$(".popup-overlay"),i=a()(window).width(),r=a()(window).height(),n=a()(document).height(),o=e.width(),s=e.height(),u=a()(document).scrollTop(),l=r/2-s/2+u,c=i/2-o/2;s>r&&(l+=(s-r)/2),t.width(i),t.height(n),e.css({position:"absolute",left:c,top:l});var h=c+o/2+"px",d=l+s/2+"px",p=h+" "+d;this.$container[0].style.perspectiveOrigin=p},resize:function(e){var t=this.$(".js-popup");return e.width&&t.width(e.width),e.height&&t.height(e.height),this},autofocus:function(){var e=window.scrollX,t=window.scrollY;this.$(".form-input:visible").length>0?(this.$(".form-input").eq(0).focus(),window.scrollTo(e,t)):(this.$(".btn-primary, .submit").focus(),window.scrollTo(e,t))},remove:function(){return this.undelegateEvents(),o.a.prototype.remove.apply(this,arguments)},renderLayout:function(){if(!this.template)throw new Error("You cannot use this class without specifying an element during instanciation");this.$el.html(Object(n.result)(this,"template")),this.$container=this.$(".popup-container")},afterRender:function(){o.a.prototype.afterRender.apply(this,arguments),this.renderChildren(),this.center()}})},function(e,t,i){i(33),i(28),i(61),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/model.jinja"]=function(){function e(e,t,i,r,a){var n=null,o=null,s="";try{var u=null;e.getTemplate("skfb_front/macros/buttons.jinja",!1,"skfb_front/macros/model.jinja",!1,function(l,c){if(l)return void a(l);c.getExported(function(l,c){if(l)return void a(l);if(!c.hasOwnProperty("star_like_button"))return void a(new Error("cannot import 'star_like_button'"));var h=c.star_like_button;t.setVariable("star_like_button",h),s+="\n",e.getTemplate("skfb_front/macros/user.jinja",!1,"skfb_front/macros/model.jinja",!1,function(l,c){if(l)return void a(l);c.getExported(function(l,c){if(l)return void a(l);if(!c.hasOwnProperty("user_name"))return void a(new Error("cannot import 'user_name'"));var h=c.user_name;if(t.setVariable("user_name",h),!c.hasOwnProperty("user_avatar"))return void a(new Error("cannot import 'user_avatar'"));var d=c.user_avatar;t.setVariable("user_avatar",d),s+="\n",e.getTemplate("skfb_front/macros/utils.jinja",!1,"skfb_front/macros/model.jinja",!1,function(l,c){if(l)return void a(l);c.getExported(function(l,c){if(l)return void a(l);if(!c.hasOwnProperty("humanize_count"))return void a(new Error("cannot import 'humanize_count'"));var h=c.humanize_count;t.setVariable("humanize_count",h),s+="\n\n";var d=r.makeMacro(["model"],["options"],function(a,n){var o=i;i=new r.Frame,n=n||{},n.hasOwnProperty("caller")&&i.set("caller",n.caller),i.set("model",a),i.set("options",n.hasOwnProperty("options")?n.options:{});var s="";s+="\n    ";var u;u=e.getFilter("merge").call(t,{withStaffpickFlag:!0,withStaffpickLink:!1,withRestrictedFlag:!0,displayRecentlyStaffpicked:!1},r.contextOrFrameLookup(t,i,"options")),i.set("options",u,!0),i.topLevel&&t.setVariable("options",u),i.topLevel&&t.addExport("options",u),s+="\n    ";var l;return l=r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"displayRecentlyStaffpicked")&&r.memberLookup(a,"recentlyStaffpicked"),i.set("recentlyStaffpicked",l,!0),i.topLevel&&t.setVariable("recentlyStaffpicked",l),i.topLevel&&t.addExport("recentlyStaffpicked",l),s+="\n\n    ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"withStaffpickLink")&&r.memberLookup(a,"staffpickedAt")?s+='\n        <meta itemprop="award" content="Staff Pick" />\n        <a href="/models/staffpicks" class="flag --staffpicked" title="See all staff picks"></a>\n    ':r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"withStaffpickFlag")&&r.memberLookup(a,"staffpickedAt")&&(s+='\n        <meta itemprop="award" content="Staff Pick" />\n        <span class="flag --staffpicked ',r.contextOrFrameLookup(t,i,"recentlyStaffpicked")&&(s+="--with-text"),s+='" title="Staff Picks"></span>\n    '),s+="\n\n    ",(r.memberLookup(a,"isRestricted")||r.memberLookup(a,"isAdult"))&&(s+="\n        ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"withRestrictedFlag")&&(s+='\n            <a\n                href="https://help.sketchfab.com/hc/en-us/articles/214867883-Age-Restricted-Content"\n                target="_blank"\n                class="flag --restricted"\n                title="Age-restricted content"></a>\n        '),s+="\n    "),s+="\n",i=o,new r.SafeString(s)});t.addExport("model_labels"),t.setVariable("model_labels",d),s+="\n\n";var p=r.makeMacro(["authUser","model"],["options"],function(a,s,u){var l=i;i=new r.Frame,u=u||{},u.hasOwnProperty("caller")&&i.set("caller",u.caller),i.set("authUser",a),i.set("model",s),i.set("options",u.hasOwnProperty("options")?u.options:{});var c,h="";return c=e.getFilter("merge").call(t,{clickable:!0},r.contextOrFrameLookup(t,i,"options")),i.set("options",c,!0),i.topLevel&&t.setVariable("options",c),i.topLevel&&t.addExport("options",c),h+='<span class="model-name">\n\n        ',r.memberLookup(s,"isProtected")?h+='\n            <i class="model-name__icon fa fa-lock --protected"></i>\n        ':r.memberLookup(s,"isPrivate")&&(h+='\n            <i class="model-name__icon custom-icons icon-private --private"></i>\n        '),h+="\n\n        ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"clickable")?(h+='\n            <a class="model-name__label" href="',h+=r.suppressValue(r.memberLookup(s,"viewerUrl"),e.opts.autoescape),h+='"',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"target")&&(h+=' target="',h+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"target"),e.opts.autoescape),h+='"'),h+=' title="',h+=r.suppressValue(r.memberLookup(s,"name"),e.opts.autoescape),h+='">',h+=r.suppressValue(r.memberLookup(s,"name"),e.opts.autoescape),h+="</a>\n        "):(h+='\n            <span class="model-name__label">',h+=r.suppressValue(r.memberLookup(s,"name"),e.opts.autoescape),h+="</span>\n        "),h+="\n\n        ",h+=r.suppressValue((n=50,o=21,r.callWrap(r.contextOrFrameLookup(t,i,"model_labels"),"model_labels",t,[s,r.contextOrFrameLookup(t,i,"options")])),e.opts.autoescape),h+="\n\n    </span>",i=l,new r.SafeString(h)});t.addExport("model_name"),t.setVariable("model_name",p),s+="\n\n";var f=r.makeMacro(["authUser","list"],["options"],function(a,s,u){var l=i;i=new r.Frame,u=u||{},u.hasOwnProperty("caller")&&i.set("caller",u.caller),i.set("authUser",a),i.set("list",s),i.set("options",u.hasOwnProperty("options")?u.options:{});var c,h="";c=e.getFilter("merge").call(t,{maxDisplayed:3,othersHref:""},r.contextOrFrameLookup(t,i,"options")),i.set("options",c,!0),i.topLevel&&t.setVariable("options",c),i.topLevel&&t.addExport("options",c);var d;d=e.getFilter("first_n").call(t,s,r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"maxDisplayed")),i.set("shortList",d,!0),i.topLevel&&t.setVariable("shortList",d),i.topLevel&&t.addExport("shortList",d);var p;p=e.getFilter("length").call(t,s)-e.getFilter("length").call(t,r.contextOrFrameLookup(t,i,"shortList")),i.set("otherCount",p,!0),i.topLevel&&t.setVariable("otherCount",p),i.topLevel&&t.addExport("otherCount",p),i=i.push();var f=r.contextOrFrameLookup(t,i,"shortList");if(f)for(var m=f.length,g=0;g<f.length;g++){var _=f[g];i.set("model",_),i.set("loop.index",g+1),i.set("loop.index0",g),i.set("loop.revindex",m-g),i.set("loop.revindex0",m-g-1),i.set("loop.first",0===g),i.set("loop.last",g===m-1),i.set("loop.length",m),r.memberLookup(r.contextOrFrameLookup(t,i,"loop"),"first")||(r.memberLookup(r.contextOrFrameLookup(t,i,"loop"),"last")&&r.contextOrFrameLookup(t,i,"otherCount")<1?h+="<span> and </span>":h+="<span>, </span>"),h+=r.suppressValue((n=72,o=19,r.callWrap(r.contextOrFrameLookup(t,i,"model_name"),"model_name",t,[a,_,{withStaffpickFlag:!1,withStaffpickLink:!1,withRestrictedFlag:!1}])),e.opts.autoescape)}return i=i.pop(),r.contextOrFrameLookup(t,i,"otherCount")>0&&(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"othersHref")?(h+='<a href="',h+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"othersHref"),e.opts.autoescape),h+='" class="others"> and ',h+=r.suppressValue(r.contextOrFrameLookup(t,i,"otherCount"),e.opts.autoescape),h+=" other",h+=r.suppressValue(e.getFilter("pluralize").call(t,r.contextOrFrameLookup(t,i,"otherCount")),e.opts.autoescape),h+="</a>"):(h+='<span class="others"> and ',h+=r.suppressValue(r.contextOrFrameLookup(t,i,"otherCount"),e.opts.autoescape),h+=" other",h+=r.suppressValue(e.getFilter("pluralize").call(t,r.contextOrFrameLookup(t,i,"otherCount")),e.opts.autoescape),h+="</span>")),i=l,new r.SafeString(h)});t.addExport("model_name_list"),t.setVariable("model_name_list",f),s+="\n\n";var m=r.makeMacro(["authUser","model"],["options"],function(a,n,o){var s=i;i=new r.Frame,o=o||{},o.hasOwnProperty("caller")&&i.set("caller",o.caller),i.set("authUser",a),i.set("model",n),i.set("options",o.hasOwnProperty("options")?o.options:{});var u="";u+="\n\n    ";var l;return l=e.getFilter("merge").call(t,{withProperties:!0,withPublish:!0,with3DSettings:!0},r.contextOrFrameLookup(t,i,"options")),i.set("options",l,!0),i.topLevel&&t.setVariable("options",l),i.topLevel&&t.addExport("options",l),u+='\n\n    <ul class="hover-menu quicksettings corner ',u+=r.suppressValue(e.getFilter("class_names").call(t,{"--up":"up"==r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"direction"),"--left":"left"==r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"direction")}),e.opts.autoescape),u+='">\n\n        ',2==r.memberLookup(n,"processingStatus")&&(u+="\n            ",!r.memberLookup(n,"publishedAt")&&r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"withPublish")&&(u+='\n                <li><a data-action="publish">Publish</a></li>\n                <li class="separator"></li>\n            '),u+="\n\n            ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"withProperties")&&(u+='\n                <li><a data-action="open-settings-popup">Properties</a></li>\n            '),u+="\n\n            ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"with3DSettings")&&(u+='\n                <li><a href="',u+=r.suppressValue(r.memberLookup(n,"editorUrl"),e.opts.autoescape),u+='" data-action="settings3d-button">3D settings</a></li>\n            '),u+="\n\n            ",r.memberLookup(n,"publishedAt")&&(u+='\n                <li><a data-action="open-collection-popup">Add to collection</a></li>\n            '),u+='\n\n            <li class="separator"></li>\n\n        '),u+="\n\n        ",r.memberLookup(n,"processingStatus")>1&&(u+='\n            <li><a data-action="open-reupload-popup">Re-upload</a></li>\n            <li><a class="--red" data-action="delete-model">Delete</a></li>\n        '),u+='\n        <li><a data-action="report-issue">Report an issue</a></li>\n\n    </ul>\n\n',i=s,new r.SafeString(u)});t.addExport("model_quicksettings"),t.setVariable("model_quicksettings",m),s+="\n\n";var g=r.makeMacro([],[],function(e){var t=i;i=new r.Frame,e=e||{},e.hasOwnProperty("caller")&&i.set("caller",e.caller);var a="";return a+='\n\n    <div class="card-preview" data-action="open-preview">\n        <i class="card-preview__icon fa fa-search" title="see preview"></i>\n    </div>\n\n',i=t,new r.SafeString(a)});t.addExport("preview_link"),t.setVariable("preview_link",g),s+="\n\n";var _=r.makeMacro(["authUser","model"],["options"],function(e,a,n){var o=i;i=new r.Frame,n=n||{},n.hasOwnProperty("caller")&&i.set("caller",n.caller),i.set("authUser",e),i.set("model",a),i.set("options",n.hasOwnProperty("options")?n.options:{});var s="";return s+='\n\n    <ul class="hover-menu quicksettings corner',"up"==r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"direction")&&(s+=" hover-menu-up"),"left"==r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"direction")&&(s+=" hover-menu-left"),s+='">\n        <li><a data-action="remove-model">Remove</a></li>\n    </ul>\n\n',i=o,new r.SafeString(s)});t.addExport("collection_item_quicksettings"),t.setVariable("collection_item_quicksettings",_),s+="\n\n";var v=r.makeMacro(["authUser","model"],["options"],function(a,s,u){var l=i;i=new r.Frame,u=u||{},u.hasOwnProperty("caller")&&i.set("caller",u.caller),i.set("authUser",a),i.set("model",s),i.set("options",u.hasOwnProperty("options")?u.options:{});var c="";return c+='\n\n    <div class="model-uploadcard">\n\n        <h3 class="filename">\n            <a href="',c+=r.suppressValue(r.memberLookup(s,"viewerUrl"),e.opts.autoescape),c+='">',r.memberLookup(s,"name")?c+=r.suppressValue((n=157,o=31,r.callWrap(r.contextOrFrameLookup(t,i,"model_name"),"model_name",t,[a,s,{withStaffpickFlag:!1}])),e.opts.autoescape):c+=r.suppressValue(e.getFilter("default").call(t,r.memberLookup(s,"originalFileName"),"No file name"),e.opts.autoescape),c+='</a>\n        </h3>\n        <div class="meta">',r.memberLookup(s,"name")&&(c+='<span class="original-filename">\n                    ',c+=r.suppressValue(e.getFilter("default").call(t,r.memberLookup(s,"originalFileName"),"No file name"),e.opts.autoescape),c+="\n                </span>"),r.memberLookup(s,"processedAt")?(c+='\n                <span class="date" title="',c+=r.suppressValue(r.memberLookup(s,"processedAt"),e.opts.autoescape),c+='">',c+=r.suppressValue(e.getFilter("time_ago").call(t,r.memberLookup(s,"processedAt")),e.opts.autoescape),c+="</span>\n            "):(c+='\n                <span class="date" title="',c+=r.suppressValue(r.memberLookup(s,"createdAt"),e.opts.autoescape),c+='">',c+=r.suppressValue(e.getFilter("time_ago").call(t,r.memberLookup(s,"createdAt")),e.opts.autoescape),c+="</span>\n            "),c+='\n        </div>\n\n        <div class="status">',0==r.memberLookup(s,"processingStatus")?c+='<div class="help">\n                    <i class="icon spinner-small-slow"></i>\n                    <div class="tooltip tooltip-down">Pending</div>\n                </div>':1==r.memberLookup(s,"processingStatus")?c+='<div class="help">\n                    <i class="icon spinner-small"></i>\n                    <div class="tooltip tooltip-down">Processing</div>\n                </div>':2==r.memberLookup(s,"processingStatus")?r.memberLookup(s,"isPublished")?c+='<div class="help">\n                        <i class="icon fa fa-check"></i>\n                        <div class="tooltip tooltip-down">Published</div>\n                    </div>':(c+='<button type="button" class="button btn-important btn-medium" data-action="publish">\n                        Publish\n                    </button>\n\n                    <a href="/models/',c+=r.suppressValue(r.memberLookup(s,"uid"),e.opts.autoescape),c+='/edit" class="button btn-tertiary btn-medium btn-edit" data-action="edit">\n                        3D Settings\n                    </a>'):3==r.memberLookup(s,"processingStatus")&&(c+='<div class="help">\n                    <i class="icon fa fa-times"></i>\n                    <div class="tooltip tooltip-down">Error</div>\n                </div>'),c+='</div>\n\n        <div class="model-uploadcard-settings">\n            <div class="button btn-medium btn-tertiary"',r.memberLookup(s,"processingStatus")<2&&(c+=" disabled"),c+='>\n                <i class="fa fa-cog"></i>\n                ',c+=r.suppressValue((n=225,o=36,r.callWrap(r.contextOrFrameLookup(t,i,"model_quicksettings"),"model_quicksettings",t,[a,s,{direction:"left",withPublish:!1}])),e.opts.autoescape),c+="\n            </div>\n        </div>\n\n    </div>\n\n",i=l,new r.SafeString(c)});t.addExport("model_uploadcard"),t.setVariable("model_uploadcard",v),s+="\n\n\n";var b=r.makeMacro(["authUser"],["options"],function(a,n){var o=i;i=new r.Frame,n=n||{},n.hasOwnProperty("caller")&&i.set("caller",n.caller),i.set("authUser",a),i.set("options",n.hasOwnProperty("options")?n.options:{});var s="";return s+='\n\n    <div class="annotation" data-hotspot="',s+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"hotspotIndex"),e.opts.autoescape),s+='">\n\n        <div class="tooltip">\n\n            ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"editMode")?s+='\n                <form class="tooltip-content">\n                    <div class="edition">\n                        <input class="title" placeholder="Title *" maxlength="64" required>\n                        <textarea class="description" placeholder="Description (add links, images and other formatting with Markdown)" maxlength="1024" rows="2"></textarea>\n                    </div>\n                    <div class="render">\n                        <div class="title"></div>\n                        <div class="markdown-editor">\n                            <div class="description markdown-rendered-content inversed"></div>\n                        </div>\n                    </div>\n                    <div class="meta">\n                        <button type="submit" class="submit button btn-primary btn-small">OK</button>\n                        <div class="meta__mode">\n                            <i class="fa fa-pencil activate-edition selected" title="Edit"></i>\n                            <i class="fa fa-eye activate-render" title="Preview"></i>\n                        </div>\n                    </div>\n                </form>\n            ':s+='\n\n                <div class="tooltip-content">\n                    <div class="tooltip-content-minimal">\n                        <div class="title"></div>\n                        <a href="#" class="more">+ more info</a>\n                    </div>\n                    <div class="title"></div>\n                    <div class="description markdown-rendered-content inversed"></div>\n                </div>\n\n            ',s+="\n\n        </div>\n\n    </div>\n\n",i=o,new r.SafeString(s)});t.addExport("model_hotspot"),t.setVariable("model_hotspot",b),s+="\n\n\n";var y=r.makeMacro([],["options"],function(a){var s=i;i=new r.Frame,a=a||{},a.hasOwnProperty("caller")&&i.set("caller",a.caller),i.set("options",a.hasOwnProperty("options")?a.options:{});var u="";u+="\n\n";var l;l=30,i.set("width_before",l,!0),i.topLevel&&t.setVariable("width_before",l),i.topLevel&&t.addExport("width_before",l),u+="\n";var c;c=960,i.set("width_next",c,!0),i.topLevel&&t.setVariable("width_next",c),i.topLevel&&t.addExport("width_next",c),u+='\n\n<div class="annotation vr visible" data-hotspot="',u+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"hotspotIndex"),e.opts.autoescape),u+='" style="width:',u+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"widthContent"),e.opts.autoescape),u+='px;height:576px;position:absolute;top:30px;left:30px;">\n\n    <div class="tooltip visible" style="width:',u+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"widthContent"),e.opts.autoescape),u+='px;border-radius:30px;left:0;">\n        <div class="tooltip-content" style="width:',u+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"widthContent"),e.opts.autoescape),u+='px;height:576px;border-radius:30px;display:flex;flex-direction:column;">\n\n            <div class="title" style="font-size:48px;line-height:1.5;padding:10px 80px 0 80px;">',u+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"title"),e.opts.autoescape),u+="</div>",i=i.push();var h=(n=292,o=32,r.callWrap(r.contextOrFrameLookup(t,i,"range"),"range",t,[0,r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"column")]));if(h)for(var d=h.length,p=0;p<h.length;p++){var f=h[p];i.set("column",f),i.set("loop.index",p+1),i.set("loop.index0",p),i.set("loop.revindex",d-p),i.set("loop.revindex0",d-p-1),i.set("loop.first",0===p),i.set("loop.last",p===d-1),i.set("loop.length",d),r.contextOrFrameLookup(t,i,"width_before")>30&&(u+='<div class="fa fa-arrow-left" style="font-size:40px;position:absolute;top:250px;left:',u+=r.suppressValue(r.contextOrFrameLookup(t,i,"width_before"),e.opts.autoescape),u+='px"></div>');var m;m=r.contextOrFrameLookup(t,i,"width_before")+1024,i.set("width_before",m,!0),i.topLevel&&t.setVariable("width_before",m),i.topLevel&&t.addExport("width_before",m)}i=i.pop(),u+='<div class="description" style="column-gap:180px;column-count:',u+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"column"),e.opts.autoescape),u+=';font-size:36px;width:100%;line-height:1.5;padding:10px 80px 0 80px;">',u+=r.suppressValue(e.getFilter("safe").call(t,r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"description")),e.opts.autoescape),u+="</div>",i=i.push();var g=(n=301,o=32,r.callWrap(r.contextOrFrameLookup(t,i,"range"),"range",t,[1,r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"column")]));if(g)for(var _=g.length,v=0;v<g.length;v++){var b=g[v];i.set("column",b),i.set("loop.index",v+1),i.set("loop.index0",v),i.set("loop.revindex",_-v),i.set("loop.revindex0",_-v-1),i.set("loop.first",0===v),i.set("loop.last",v===_-1),i.set("loop.length",_),u+='<div class="fa fa-arrow-right" style="font-size:40px;position:absolute;top:250px;left:',u+=r.suppressValue(r.contextOrFrameLookup(t,i,"width_next"),e.opts.autoescape),u+='px"></div>\n                ';var y;y=r.contextOrFrameLookup(t,i,"width_next")+1024,i.set("width_next",y,!0),i.topLevel&&t.setVariable("width_next",y),i.topLevel&&t.addExport("width_next",y)}i=i.pop(),u+='<div class="footer" style="text-align:left;font-size:36px;justify-content:space-around;bottom:15px;left:0;position:absolute;margin:20px 0 20px 0;">',i=i.push();var x=(n=307,o=40,r.callWrap(r.contextOrFrameLookup(t,i,"range"),"range",t,[0,r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"column")]));if(x)for(var S=x.length,M=0;M<x.length;M++){var w=x[M];i.set("column",w),i.set("loop.index",M+1),i.set("loop.index0",M),i.set("loop.revindex",S-M),i.set("loop.revindex0",S-M-1),i.set("loop.first",0===M),i.set("loop.last",M===S-1),i.set("loop.length",S),u+='<div class="containter-button" style="width:1024px;display:inline-block;text-align:center;">',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"displayNavigation")?u+='<button id="prevButton" class="button" style="background:#444444;">Prev</button>\n                                <button id="closeButton" class="button" style="background:#444444;">Close annotation</button>\n                                <button id="nextButton" class="button" style="background:#444444;">Next</button>':u+='<button id="closeButton" class="button" style="background:#444444;">Close annotation</button>',u+="</div>"}return i=i.pop(),u+="</div>\n\n        </div>\n    </div>\n</div>\n\n",i=s,new r.SafeString(u)});t.addExport("model_hotspot_vr"),t.setVariable("model_hotspot_vr",y),s+="\n\n";var x=r.makeMacro(["src"],["options"],function(a,n){var o=i;i=new r.Frame,n=n||{},n.hasOwnProperty("caller")&&i.set("caller",n.caller),i.set("src",a),i.set("options",n.hasOwnProperty("options")?n.options:{});var s="";return s+="<iframe ",s+=r.suppressValue(e.getFilter("attributes").call(t,{class:r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"class"),width:r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"width"),height:r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"height"),src:a,frameborder:"0",allow:"autoplay; fullscreen; vr",allowvr:"",allowfullscreen:"",mozallowfullscreen:"true",webkitallowfullscreen:"true",onmousewheel:""}),e.opts.autoescape),s+="></iframe>",i=o,new r.SafeString(s)});t.addExport("model_iframe"),t.setVariable("model_iframe",x),s+="\n\n";var S=r.makeMacro(["license"],[],function(t,a){var n=i;i=new r.Frame,a=a||{},a.hasOwnProperty("caller")&&i.set("caller",a.caller),i.set("license",t);var o="";return o+='\n    <div class="model-license">\n        <p class="model-license__name help">\n            ',o+=r.suppressValue(r.memberLookup(t,"label"),e.opts.autoescape),o+='\n            <span class="tooltip tooltip-up">',o+=r.suppressValue(r.memberLookup(t,"fullname"),e.opts.autoescape),o+='</span>\n        </p>\n\n        <p class="model-license__requirements">',o+=r.suppressValue(r.memberLookup(t,"requirements"),e.opts.autoescape),o+='</p>\n\n        <a\n            class="model-license__link skfb-link"\n            href="',o+=r.suppressValue(r.memberLookup(t,"url"),e.opts.autoescape),o+='"\n            rel="license"\n            itemprop="license"\n            target="_blank">more info</a>\n    </div>\n',i=n,new r.SafeString(o)});t.addExport("model_license"),t.setVariable("model_license",S),s+="\n\n";var M=r.makeMacro(["model"],["options"],function(a,n){var o=i;i=new r.Frame,n=n||{},n.hasOwnProperty("caller")&&i.set("caller",n.caller),i.set("model",a),i.set("options",n.hasOwnProperty("options")?n.options:{});var s="";s+="\n    ";var u;return u=e.getFilter("merge").call(t,{className:""},r.contextOrFrameLookup(t,i,"options")),i.set("options",u,!0),i.topLevel&&t.setVariable("options",u),i.topLevel&&t.addExport("options",u),s+='\n    <span class="',s+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"className"),e.opts.autoescape),s+=' custom-icons icon-eye-icon help">\n        <span class="count">\n            ',s+=r.suppressValue(e.getFilter("humanize_number").call(t,r.memberLookup(a,"viewCount")),e.opts.autoescape),s+='\n        </span>\n        <span class="tooltip tooltip-up">Views</span>\n    </span>\n',i=o,new r.SafeString(s)});t.addExport("model_view_count"),t.setVariable("model_view_count",M),s+="\n\n";var w=r.makeMacro(["authUser","model"],["options"],function(a,s,u){var l=i;i=new r.Frame,u=u||{},u.hasOwnProperty("caller")&&i.set("caller",u.caller),i.set("authUser",a),i.set("model",s),i.set("options",u.hasOwnProperty("options")?u.options:{});var c,h="";return c=e.getFilter("merge").call(t,{isMine:!1},r.contextOrFrameLookup(t,i,"options")),i.set("options",c,!0),i.topLevel&&t.setVariable("options",c),i.topLevel&&t.addExport("options",c),h+='<div class="model-cell__name-container">\n        <p class="model-cell__name ',h+=r.suppressValue(r.memberLookup(s,"isDeleted")?"--deleted":"",e.opts.autoescape),h+='">\n            ',h+=r.suppressValue((n=377,o=23,r.callWrap(r.contextOrFrameLookup(t,i,"model_name"),"model_name",t,[a,s,{clickable:!r.memberLookup(s,"isDeleted")}])),e.opts.autoescape),h+="\n        </p>\n\n        ",r.memberLookup(s,"isDeleted")&&(h+='\n            <span class="model-cell__deleted-tooltip help">\n                <i class="fa fa-question-circle"></i>\n                <span class="tooltip tooltip-right">\n                    This model was deleted',h+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"isMine")?"":", but no worries, you can still download the latest version!",e.opts.autoescape),h+="\n                </span>\n            </span>\n        "),h+="\n    </div>\n",i=l,new r.SafeString(h)});t.addExport("model_cell_name"),t.setVariable("model_cell_name",w),s+="\n",u?u.rootRenderFunc(e,t,i,r,a):a(null,s)})})})})})})}catch(e){a(r.handleError(e,n,o))}}return{root:e}}()}()},function(e,t,i){"use strict";i.d(t,"c",function(){return h}),i.d(t,"e",function(){return d}),i.d(t,"a",function(){return p}),i.d(t,"d",function(){return f}),i.d(t,"b",function(){return m}),i.d(t,"f",function(){return g}),i.d(t,"g",function(){return _});var r=i(413),a=i.n(r),n=i(434),o=i.n(n),s=i(435),u=i.n(s),l=i(436),c=i.n(l),h=function(e){function t(e,i,r,n){o()(this,t);var s=u()(this,(t.__proto__||a()(t)).call(this,e));return s.feature=i,s.limitReached=r,s.account=n,s}return c()(t,e),t}(Error),d=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||a()(t)).apply(this,arguments))}return c()(t,e),t}(Error),p=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||a()(t)).apply(this,arguments))}return c()(t,e),t}(Error),f=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||a()(t)).apply(this,arguments))}return c()(t,e),t}(Error),m=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||a()(t)).apply(this,arguments))}return c()(t,e),t}(Error),g=function(e,t){return function(i){if(i instanceof e)return t(i);throw i}},_=function(e){return function(t){if(!(t instanceof e))throw t}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(4),a=i(23),n=i(2),o=i(108);i.n(o);t.default=a.a.extend({displayName:"MessagePopup",optionTypes:{title:n.b.string.isRequired,text:n.b.string.isRequired,buttons:n.b.shape({cancel:n.b.bool,cancelClass:n.b.string,cancelLabel:n.b.string,close:n.b.bool,closeClass:n.b.string,closeLabel:n.b.string,continue:n.b.bool,continueClass:n.b.string,continueLabel:n.b.string,ok:n.b.bool,okClass:n.b.string,okLabel:n.b.string,delete:n.b.bool,deleteClass:n.b.string,deleteLabel:n.b.string}),popupClass:n.b.string,safe:n.b.bool,popupClosable:n.b.bool,shouldRejectOnCancel:n.b.bool},defaultOptions:{shouldRejectOnCancel:!0},template:function(){return r.default.get("skfb_front/popups/message",{title:this.options.title,text:this.options.text,buttons:this.options.buttons,safe:this.options.safe,popupClass:this.options.popupClass,popupClosable:this.options.popupClosable})}})},,function(e,t,i){i(33),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/user.jinja"]=function(){function e(e,t,i,r,a){var n=null,o=null,s="";try{var u=null;e.getTemplate("skfb_front/macros/buttons.jinja",!1,"skfb_front/macros/user.jinja",!1,function(l,c){if(l)return void a(l);c.getExported(function(l,c){if(l)return void a(l);if(!c.hasOwnProperty("follow_button"))return void a(new Error("cannot import 'follow_button'"));var h=c.follow_button;t.setVariable("follow_button",h),s+="\n\n";var d=r.makeMacro(["user"],["options"],function(a,n){var o=i;i=new r.Frame,n=n||{},n.hasOwnProperty("caller")&&i.set("caller",n.caller),i.set("user",a),i.set("options",n.hasOwnProperty("options")?n.options:{});var s="";s+="\n    ";var u;return u=e.getFilter("merge").call(t,{avatarWidth:20,avatarHeight:20},r.contextOrFrameLookup(t,i,"options")),i.set("options",u,!0),i.topLevel&&t.setVariable("options",u),i.topLevel&&t.addExport("options",u),s+='\n    <div\n        class="avatar"\n        data-user-summary-anchor="true"\n        data-user="',s+=r.suppressValue(r.memberLookup(a,"uid"),e.opts.autoescape),s+='">\n        ',s+=r.suppressValue(e.getFilter("image_container").call(t,r.memberLookup(a,"avatars"),r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"avatarWidth"),r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"avatarHeight")),e.opts.autoescape),s+="\n    </div>\n",i=o,new r.SafeString(s)});t.addExport("user_name_avatar"),t.setVariable("user_name_avatar",d),s+="\n\n";var p=r.makeMacro(["authUser","user"],["options"],function(a,s,u){var l=i;i=new r.Frame,u=u||{},u.hasOwnProperty("caller")&&i.set("caller",u.caller),i.set("authUser",a),i.set("user",s),i.set("options",u.hasOwnProperty("options")?u.options:{});var c,h="";return c=e.getFilter("merge").call(t,{noBadge:!1},r.contextOrFrameLookup(t,i,"options")),i.set("options",c,!0),i.topLevel&&t.setVariable("options",c),i.topLevel&&t.addExport("options",c),h+='\n\n    <div class="user-name ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"noBadge")&&(h+="--no-badge-link"),h+='">\n        <a class="user-name__link" href="',h+=r.suppressValue(r.memberLookup(s,"profileUrl"),e.opts.autoescape),h+='" ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"target")&&(h+=' target="',h+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"target"),e.opts.autoescape),h+='"'),h+='>\n            <data itemprop="url" value="',h+=r.suppressValue(r.memberLookup(s,"profileUrl"),e.opts.autoescape),h+='"></data>\n            ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"withAvatar")&&(h+="\n            <span ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"withSummary")&&(h+='data-action="show-user-summary"\n                data-user="',h+=r.suppressValue(r.memberLookup(s,"uid"),e.opts.autoescape),h+='"'),h+=">\n                ",h+=r.suppressValue((n=28,o=33,r.callWrap(r.contextOrFrameLookup(t,i,"user_name_avatar"),"user_name_avatar",t,[s,r.contextOrFrameLookup(t,i,"options")])),e.opts.autoescape),h+="\n            </span>\n            "),h+='\n\n            <div class="text">\n                ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"by")&&(h+="by"),h+='\n                <div\n                    class="username-wrapper"\n                    itemprop="name"\n                    title="',h+=r.suppressValue(r.memberLookup(s,"displayName"),e.opts.autoescape),h+='">\n                    ',h+=r.suppressValue(r.memberLookup(s,"displayName"),e.opts.autoescape),h+="\n                </div>\n            </div>\n        </a>\n        ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"withoutBadge")||(h+='\n            <a class="user-name__flag" href="/plans" target="_blank">\n                ',r.memberLookup(s,"accountType")?(h+='\n                    <span class="flag --',h+=r.suppressValue(r.memberLookup(r.memberLookup(s,"accountType"),"badge"),e.opts.autoescape),h+='">',h+=r.suppressValue(r.memberLookup(r.memberLookup(s,"accountType"),"title"),e.opts.autoescape),h+="</span>\n                "):"free"!=r.memberLookup(s,"account")&&(h+='\n                    <span class="flag --',h+=r.suppressValue(r.memberLookup(s,"account"),e.opts.autoescape),h+='">',h+=r.suppressValue(e.getFilter("badge_label").call(t,r.memberLookup(s,"account")),e.opts.autoescape),h+="</span>\n                "),h+="\n            </a>\n        "),h+="\n    </div>",i=l,new r.SafeString(h)});t.addExport("user_name"),t.setVariable("user_name",p),s+="\n\n";var f=r.makeMacro(["users"],["options"],function(a,s){var u=i;i=new r.Frame,s=s||{},s.hasOwnProperty("caller")&&i.set("caller",s.caller),i.set("users",a),i.set("options",s.hasOwnProperty("options")?s.options:{});var l="";l+="\n    ";var c;c=e.getFilter("merge").call(t,{maxDisplayed:3,avatarWidth:18,avatarHeight:18},r.contextOrFrameLookup(t,i,"options")),i.set("options",c,!0),i.topLevel&&t.setVariable("options",c),i.topLevel&&t.addExport("options",c),l+="\n    ";var h;h=e.getFilter("first_n").call(t,a,r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"maxDisplayed")),i.set("shortList",h,!0),i.topLevel&&t.setVariable("shortList",h),i.topLevel&&t.addExport("shortList",h),l+='\n    <div class="inline-avatars">\n        ',i=i.push();var d=r.contextOrFrameLookup(t,i,"shortList");if(d)for(var p=d.length,f=0;f<d.length;f++){var m=d[f];i.set("user",m),i.set("loop.index",f+1),i.set("loop.index0",f),i.set("loop.revindex",p-f),i.set("loop.revindex0",p-f-1),i.set("loop.first",0===f),i.set("loop.last",f===p-1),i.set("loop.length",p),l+='\n            <a\n                href="',l+=r.suppressValue(r.memberLookup(m,"profileUrl"),e.opts.autoescape),l+='"',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"target")&&(l+=' target="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"target"),e.opts.autoescape),l+='" '),l+='data-action="show-user-summary"\n                data-user="',l+=r.suppressValue(r.memberLookup(m,"uid"),e.opts.autoescape),l+='">\n                ',l+=r.suppressValue((n=69,o=36,r.callWrap(r.contextOrFrameLookup(t,i,"user_name_avatar"),"user_name_avatar",t,[m,r.contextOrFrameLookup(t,i,"options")])),e.opts.autoescape),l+="\n            </a>\n        "}return i=i.pop(),l+="\n    </div>\n",i=u,new r.SafeString(l)});t.addExport("user_inline_avatars"),t.setVariable("user_inline_avatars",f),s+="\n\n";var m=r.makeMacro(["authUser","list"],["options"],function(a,s,u){var l=i;i=new r.Frame,u=u||{},u.hasOwnProperty("caller")&&i.set("caller",u.caller),i.set("authUser",a),i.set("list",s),i.set("options",u.hasOwnProperty("options")?u.options:{});var c,h="";c=e.getFilter("merge").call(t,{maxDisplayed:3,othersHref:""},r.contextOrFrameLookup(t,i,"options")),i.set("options",c,!0),i.topLevel&&t.setVariable("options",c),i.topLevel&&t.addExport("options",c),h+="\n    ";var d;if(d=e.getFilter("first_n").call(t,s,r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"maxDisplayed")),i.set("shortList",d,!0),i.topLevel&&t.setVariable("shortList",d),i.topLevel&&t.addExport("shortList",d),h+="\n    ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"totalCount")){h+="\n        ";var p;p=r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"totalCount")-r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"maxDisplayed"),i.set("otherCount",p,!0),i.topLevel&&t.setVariable("otherCount",p),i.topLevel&&t.addExport("otherCount",p),h+="\n    "}else{h+="\n        ";var f;f=e.getFilter("length").call(t,s)-e.getFilter("length").call(t,r.contextOrFrameLookup(t,i,"shortList")),i.set("otherCount",f,!0),i.topLevel&&t.setVariable("otherCount",f),i.topLevel&&t.addExport("otherCount",f),h+="\n    "}h+="\n\n    ",i=i.push();var m=r.contextOrFrameLookup(t,i,"shortList");if(m)for(var g=m.length,_=0;_<m.length;_++){var v=m[_];i.set("user",v),i.set("loop.index",_+1),i.set("loop.index0",_),i.set("loop.revindex",g-_),i.set("loop.revindex0",g-_-1),i.set("loop.first",0===_),i.set("loop.last",_===g-1),i.set("loop.length",g),r.memberLookup(r.contextOrFrameLookup(t,i,"loop"),"first")||(r.memberLookup(r.contextOrFrameLookup(t,i,"loop"),"last")&&r.contextOrFrameLookup(t,i,"otherCount")<1?h+="<span> and </span>":h+="<span>, </span>"),h+=r.suppressValue((n=96,o=18,r.callWrap(r.contextOrFrameLookup(t,i,"user_name"),"user_name",t,[a,v,{withoutBadge:!0}])),e.opts.autoescape)}return i=i.pop(),r.contextOrFrameLookup(t,i,"otherCount")>0&&(h+="<span> and </span>\n        ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"othersHref")||r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"otherAction")?(h+='\n        <a\n            class="others"\n            ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"othersHref")&&(h+=' href="',h+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"othersHref"),e.opts.autoescape),h+='" '),h+="\n            ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"otherAction")&&(h+=' data-action="',h+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"otherAction"),e.opts.autoescape),h+='" '),h+=">",h+=r.suppressValue(r.contextOrFrameLookup(t,i,"otherCount"),e.opts.autoescape),h+=" other",h+=r.suppressValue(e.getFilter("pluralize").call(t,r.contextOrFrameLookup(t,i,"otherCount")),e.opts.autoescape),h+="</a>\n        "):(h+='\n    <span class="others">',h+=r.suppressValue(r.contextOrFrameLookup(t,i,"otherCount"),e.opts.autoescape),h+=" other",h+=r.suppressValue(e.getFilter("pluralize").call(t,r.contextOrFrameLookup(t,i,"otherCount")),e.opts.autoescape),h+="</span>\n        "),h+="\n    "),i=l,new r.SafeString(h)});t.addExport("user_name_list"),t.setVariable("user_name_list",m),s+="\n\n";var g=r.makeMacro(["avatars"],["options"],function(a,n){var o=i;i=new r.Frame,n=n||{},n.hasOwnProperty("caller")&&i.set("caller",n.caller),i.set("avatars",a),i.set("options",n.hasOwnProperty("options")?n.options:{});var s="";s+="\n\n    ";var u;return u=e.getFilter("merge").call(t,{size:32,expand:!1},r.contextOrFrameLookup(t,i,"options")),i.set("options",u,!0),i.topLevel&&t.setVariable("options",u),i.topLevel&&t.addExport("options",u),s+="\n    ",s+=r.suppressValue(e.getFilter("image_container").call(t,a,r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"size"),r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"size"),r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"expand")),e.opts.autoescape),s+="\n\n",i=o,new r.SafeString(s)});t.addExport("user_avatar"),t.setVariable("user_avatar",g),s+="\n\n\n",s+="\n";var _=r.makeMacro(["authUser","user"],["options"],function(a,n,o){var s=i;i=new r.Frame,o=o||{},o.hasOwnProperty("caller")&&i.set("caller",o.caller),i.set("authUser",a),i.set("user",n),i.set("options",o.hasOwnProperty("options")?o.options:{});var u="";return(r.memberLookup(n,"city")||r.memberLookup(n,"country"))&&(r.memberLookup(n,"city")&&(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"microData")&&(u+='<data itemprop="addressLocality">'),u+=r.suppressValue(r.memberLookup(n,"city"),e.opts.autoescape),r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"microData")&&(u+="</data>"),r.memberLookup(n,"country")&&(u+=",")),u+=" ",r.memberLookup(n,"country")&&(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"microData")&&(u+='<data itemprop="addressCountry">'),u+=r.suppressValue(r.memberLookup(n,"country"),e.opts.autoescape),r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"microData")&&(u+="</data>"))),i=s,new r.SafeString(u)});t.addExport("user_location_plaintext"),t.setVariable("user_location_plaintext",_),s+="\n\n";var v=r.makeMacro(["authUser","user"],["options"],function(a,s,u){var l=i;i=new r.Frame,u=u||{},u.hasOwnProperty("caller")&&i.set("caller",u.caller),i.set("authUser",a),i.set("user",s),i.set("options",u.hasOwnProperty("options")?u.options:{});var c="";if(c+="\n\n    ",""!=(n=129,o=31,r.callWrap(r.contextOrFrameLookup(t,i,"user_location_plaintext"),"user_location_plaintext",t,[a,s,r.contextOrFrameLookup(t,i,"options")]))){c+="\n\n        ";var h;h=e.getFilter("merge").call(t,{microData:!0},r.contextOrFrameLookup(t,i,"options")),i.set("options",h,!0),i.topLevel&&t.setVariable("options",h),i.topLevel&&t.addExport("options",h),c+='\n\n        <i class="fa fa-map-marker"></i>\n        <data itemprop="homeLocation" itemscope itemtype="http://schema.org/Place">\n            <data itemprop="address" itemscope itemtype="http://schema.org/PostalAddress">\n            ',c+=r.suppressValue((n=136,o=36,r.callWrap(r.contextOrFrameLookup(t,i,"user_location_plaintext"),"user_location_plaintext",t,[a,s,r.contextOrFrameLookup(t,i,"options")])),e.opts.autoescape),c+="\n            </data>\n        </data>\n    "}return c+="\n\n",i=l,new r.SafeString(c)});t.addExport("user_location"),t.setVariable("user_location",v),s+="\n\n";var b=r.makeMacro(["authUser","user"],["options"],function(a,s,u){var l=i;i=new r.Frame,u=u||{},u.hasOwnProperty("caller")&&i.set("caller",u.caller),i.set("authUser",a),i.set("user",s),i.set("options",u.hasOwnProperty("options")?u.options:{});var c="";c+='\n\n    <div class="user">\n        <a href="/',c+=r.suppressValue(r.memberLookup(s,"username"),e.opts.autoescape),c+='">\n        ',c+=r.suppressValue((n=147,o=20,r.callWrap(r.contextOrFrameLookup(t,i,"user_avatar"),"user_avatar",t,[r.memberLookup(s,"avatars"),{size:104}])),e.opts.autoescape),c+='\n        </a>\n        <div class="info">\n            <p class="name" title="',c+=r.suppressValue(r.memberLookup(s,"displayName"),e.opts.autoescape),c+='"><a href="/',c+=r.suppressValue(r.memberLookup(s,"username"),e.opts.autoescape),c+='">',c+=r.suppressValue(r.memberLookup(s,"displayName"),e.opts.autoescape),c+='</a></p>\n            <p class="tagline" title="',c+=r.suppressValue(r.memberLookup(s,"tagline"),e.opts.autoescape),c+='"><a href="/',c+=r.suppressValue(r.memberLookup(s,"username"),e.opts.autoescape),c+='">',c+=r.suppressValue(r.memberLookup(s,"tagline"),e.opts.autoescape),c+="</a></p>\n            ",0!=r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"followButton")&&r.memberLookup(a,"uid")!=r.memberLookup(s,"uid")&&(c+='\n                <div class="follow-wrapper">\n                    ',c+=r.suppressValue((n=154,o=34,r.callWrap(r.contextOrFrameLookup(t,i,"follow_button"),"follow_button",t,[a,s])),e.opts.autoescape),c+='\n                    <p class="follow-count"><a href="/',c+=r.suppressValue(r.memberLookup(s,"username"),e.opts.autoescape),c+='/followers"><span>',c+=r.suppressValue(r.memberLookup(s,"followerCount"),e.opts.autoescape),c+="</span> followers</a></p>\n                </div>\n            "),c+='\n        </div>\n    </div>\n    <div class="models">',i=i.push();var h=e.getFilter("first_n").call(t,r.memberLookup(s,"thumbnails"),3);if(h)for(var d=h.length,p=0;p<h.length;p++){var f=h[p];i.set("thumb",f),i.set("loop.index",p+1),i.set("loop.index0",p),i.set("loop.revindex",d-p),i.set("loop.revindex0",d-p-1),i.set("loop.first",0===p),i.set("loop.last",p===d-1),i.set("loop.length",d),c+='\n            <a href="',c+=r.suppressValue(r.memberLookup(f,"viewerUrl"),e.opts.autoescape),c+='">\n                ',c+=r.suppressValue(e.getFilter("image_container").call(t,r.memberLookup(f,"thumbnail"),133,88,!1),e.opts.autoescape),c+="\n            </a>\n        "}return i=i.pop(),c+='\n    </div>\n    <div class="stats">\n        <p class="model-count">',c+=r.suppressValue(r.memberLookup(s,"modelCount"),e.opts.autoescape),c+=" model",c+=r.suppressValue(e.getFilter("pluralize").call(t,r.memberLookup(s,"modelCount")),e.opts.autoescape),c+='</p>\n        <p class="view-count">',c+=r.suppressValue(e.getFilter("humanize_number").call(t,r.memberLookup(r.memberLookup(s,"stats"),"view_count")),e.opts.autoescape),c+=" view",c+=r.suppressValue(e.getFilter("pluralize").call(t,r.memberLookup(r.memberLookup(s,"stats"),"view_count")),e.opts.autoescape),c+='</p>\n        <p class="like-count">',c+=r.suppressValue(e.getFilter("humanize_number").call(t,r.memberLookup(r.memberLookup(s,"stats"),"like_count")),e.opts.autoescape),c+=" like",c+=r.suppressValue(e.getFilter("pluralize").call(t,r.memberLookup(r.memberLookup(s,"stats"),"like_count")),e.opts.autoescape),c+="</p>\n    </div>\n\n",i=l,new r.SafeString(c)});t.addExport("user_summary"),t.setVariable("user_summary",b),s+="\n\n";var y=r.makeMacro(["authUser","followSuggestion","cloaked"],["options"],function(a,s,u,l){var c=i;i=new r.Frame,l=l||{},l.hasOwnProperty("caller")&&i.set("caller",l.caller),i.set("authUser",a),i.set("followSuggestion",s),i.set("cloaked",u),i.set("options",l.hasOwnProperty("options")?l.options:{});var h="";return h+="\n\n\n    ",h+=r.suppressValue(e.getFilter("image_container").call(t,r.memberLookup(s,"avatars"),64,64),e.opts.autoescape),h+='\n\n    <div class="info">\n        <p class="name">',h+=r.suppressValue(r.memberLookup(s,"displayName"),e.opts.autoescape),h+='</p>\n        <p class="stats">',h+=r.suppressValue(e.getFilter("humanize_number").call(t,r.memberLookup(s,"followerCount")),e.opts.autoescape),h+=" follower",h+=r.suppressValue(e.getFilter("pluralize").call(t,r.memberLookup(s,"followerCount")),e.opts.autoescape),h+=", ",h+=r.suppressValue(e.getFilter("humanize_number").call(t,r.memberLookup(s,"modelCount")),e.opts.autoescape),h+=" model",h+=r.suppressValue(e.getFilter("pluralize").call(t,r.memberLookup(s,"modelCount")),e.opts.autoescape),h+=" </p>\n    </div>\n\n    ",r.memberLookup(a,"uid")!=r.memberLookup(s,"uid")&&(h+="\n        ",h+=r.suppressValue((n=186,o=22,r.callWrap(r.contextOrFrameLookup(t,i,"follow_button"),"follow_button",t,[a,s])),e.opts.autoescape),h+="\n    "),h+="\n\n",i=c,new r.SafeString(h)});t.addExport("follow_suggestion_large"),t.setVariable("follow_suggestion_large",y),s+="\n\n";var x=r.makeMacro(["authUser","user","cloaked"],["options"],function(a,s,u,l){var c=i;i=new r.Frame,l=l||{},l.hasOwnProperty("caller")&&i.set("caller",l.caller),i.set("authUser",a),i.set("user",s),i.set("cloaked",u),i.set("options",l.hasOwnProperty("options")?l.options:{});var h="";return h+='\n\n    <span\n        class="avatar-container"\n        data-action="show-user-summary"\n        data-user="',h+=r.suppressValue(r.memberLookup(s,"uid"),e.opts.autoescape),h+='">\n        ',h+=r.suppressValue(e.getFilter("image_container").call(t,r.memberLookup(s,"avatars"),64,64),e.opts.autoescape),h+='\n    </span>\n\n    <div class="info">\n        <p\n            class="name"\n            data-action="show-user-summary"\n            data-user="',h+=r.suppressValue(r.memberLookup(s,"uid"),e.opts.autoescape),h+='"\n            data-user-summary-anchor-class=".avatar-container[data-user=\'',h+=r.suppressValue(r.memberLookup(s,"uid"),e.opts.autoescape),h+="']\">\n            ",h+=r.suppressValue(r.memberLookup(s,"displayName"),e.opts.autoescape),h+='\n        </p>\n        <p class="stats">',h+=r.suppressValue(e.getFilter("humanize_number").call(t,r.memberLookup(s,"followerCount")),e.opts.autoescape),h+=" follower",h+=r.suppressValue(e.getFilter("pluralize").call(t,r.memberLookup(s,"followerCount")),e.opts.autoescape),h+=", ",h+=r.suppressValue(e.getFilter("humanize_number").call(t,r.memberLookup(s,"modelCount")),e.opts.autoescape),h+=" model",h+=r.suppressValue(e.getFilter("pluralize").call(t,r.memberLookup(s,"modelCount")),e.opts.autoescape),h+=" </p>\n    </div>\n\n    ",r.memberLookup(a,"uid")!=r.memberLookup(s,"uid")&&(h+="\n        ",h+=r.suppressValue((n=212,o=22,r.callWrap(r.contextOrFrameLookup(t,i,"follow_button"),"follow_button",t,[a,s])),e.opts.autoescape),h+="\n    "),h+='\n\n    <div class="reason">\n        <p>',h+=r.suppressValue(e.getFilter("print_suggestion_verb").call(t,r.memberLookup(r.contextOrFrameLookup(t,i,"followSuggestion"),"verb"),r.memberLookup(r.contextOrFrameLookup(t,i,"followSuggestion"),"user")),e.opts.autoescape),h+=" ",h+=r.suppressValue(e.getFilter("print_suggestion_target").call(t,r.memberLookup(r.contextOrFrameLookup(t,i,"followSuggestion"),"target"),r.memberLookup(r.contextOrFrameLookup(t,i,"followSuggestion"),"verb")),e.opts.autoescape),h+="</p>\n    </div>\n\n",i=c,new r.SafeString(h)});t.addExport("follow_suggestion_reason"),t.setVariable("follow_suggestion_reason",x),s+="\n\n";var S=r.makeMacro(["authUser","followSuggestion","cloaked"],["options"],function(a,s,u,l){var c=i;i=new r.Frame,l=l||{},l.hasOwnProperty("caller")&&i.set("caller",l.caller),i.set("authUser",a),i.set("followSuggestion",s),i.set("cloaked",u),i.set("options",l.hasOwnProperty("options")?l.options:{});var h="";return h+='\n\n    <li class="follow-item',u&&(h+=" cloaked"),h+='" data-user="',h+=r.suppressValue(r.memberLookup(s,"uid"),e.opts.autoescape),h+='">\n\n        ',h+=r.suppressValue((n=225,o=18,r.callWrap(r.contextOrFrameLookup(t,i,"user_name"),"user_name",t,[a,s,r.makeKeywordArgs({options:{withAvatar:!0,withSummary:r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"withSummary"),avatarHeight:32,avatarWidth:32}})])),e.opts.autoescape),h+="\n\n        ",r.memberLookup(a,"uid")!=r.memberLookup(s,"uid")&&(h+="\n\n            ",h+=r.suppressValue((n=234,o=26,r.callWrap(r.contextOrFrameLookup(t,i,"follow_button"),"follow_button",t,[r.contextOrFrameLookup(t,i,"user"),s])),e.opts.autoescape),h+="\n\n        "),h+="\n\n    </li>\n\n",i=c,new r.SafeString(h)});t.addExport("follow_suggestion"),t.setVariable("follow_suggestion",S),s+="\n\n";var M=r.makeMacro(["authUser","followSuggestions"],["options"],function(a,s,u){var l=i;i=new r.Frame,u=u||{},u.hasOwnProperty("caller")&&i.set("caller",u.caller),i.set("authUser",a),i.set("followSuggestions",s),i.set("options",u.hasOwnProperty("options")?u.options:{});var c="";c+='\n\n    <div class="sidebar-box suggested-follow',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"container_class")&&(c+=" ",c+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"container_class"),e.opts.autoescape)),c+='">\n        <h5 class="sidebar-title">',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"title")?c+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"title"),e.opts.autoescape):c+="Who to follow ",c+="</h5>\n        <ul>\n\n            ";var h;if(h=e.getFilter("length").call(t,s),i.set("suggestionsCount",h,!0),i.topLevel&&t.setVariable("suggestionsCount",h),i.topLevel&&t.addExport("suggestionsCount",h),c+="\n\n            ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"maxSuggestions")){c+="\n                ";var d;d=r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"maxSuggestions"),i.set("max",d,!0),i.topLevel&&t.setVariable("max",d),i.topLevel&&t.addExport("max",d),c+="\n            "}else{c+="\n                ";var p;p=r.contextOrFrameLookup(t,i,"suggestionsCount"),i.set("max",p,!0),i.topLevel&&t.setVariable("max",p),i.topLevel&&t.addExport("max",p),c+="\n            "}c+="\n\n            ",i=i.push();var f=s;if(f)for(var m=f.length,g=0;g<f.length;g++){var _=f[g];i.set("following",_),i.set("loop.index",g+1),i.set("loop.index0",g),i.set("loop.revindex",m-g),i.set("loop.revindex0",m-g-1),i.set("loop.first",0===g),i.set("loop.last",g===m-1),i.set("loop.length",m),c+="\n\n                ",c+=r.suppressValue((n=258,o=34,r.callWrap(r.contextOrFrameLookup(t,i,"follow_suggestion"),"follow_suggestion",t,[a,_,r.memberLookup(r.contextOrFrameLookup(t,i,"loop"),"index")>r.contextOrFrameLookup(t,i,"max"),r.contextOrFrameLookup(t,i,"options")])),e.opts.autoescape),c+="\n\n            "}return i=i.pop(),c+='\n        </ul>\n\n        <a href="#" class="show-more" data-action="show-more"><i class="icon fa fa-plus"></i> Show More</i></a>\n\n    </div>\n\n',i=l,new r.SafeString(c)});t.addExport("follow_suggestions"),t.setVariable("follow_suggestions",M),s+="\n",u?u.rootRenderFunc(e,t,i,r,a):a(null,s)})})}catch(e){a(r.handleError(e,n,o))}}return{root:e}}()}()},,function(e,t,i){"use strict";function r(e,t){return f()(e).reduce(function(i,r){return d()({},i,t(e[r],r))},{})}function a(e,t){return r(e,function(e,i){return t(e,i)?c()({},i,e):{}})}function n(e){return a(e,function(e){return void 0!==e&&null!==e&&""!==e})}function o(e){return a(e,function(e){return void 0!==e})}function s(e,t){return function(){return d()({},e.call(this),t.call(this))}}function u(e,t){for(var i in e)if(!(i in t)||e[i]!==t[i])return!1;for(var r in t)if(!(r in e)||e[r]!==t[r])return!1;return!0}t.c=r,i.d(t,"f",function(){return g}),t.b=n,t.a=o,t.e=s,t.d=u;var l=i(102),c=i.n(l),h=i(19),d=i.n(h),p=i(20),f=i.n(p),m=i(0),g=(i.n(m),Object(m.curry)(function(e,t){return t[e]}))},function(e,t,i){"use strict";var r=i(13),a=i(30);t.a=r.a.extend({displayName:"PureComponent",shouldViewUpdate:function(e,t){return!Object(a.d)(this.options,e)||!Object(a.d)(this.state,t)}})},,function(e,t,i){i(421),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/buttons.jinja"]=function(){function e(e,t,i,r,a){var n=null,o=null,s="";try{var u=null;e.getTemplate("skfb_front/macros/popovers.jinja",!1,"skfb_front/macros/buttons.jinja",!1,function(l,c){if(l)return void a(l);c.getExported(function(l,c){if(l)return void a(l);if(!c.hasOwnProperty("share_popover"))return void a(new Error("cannot import 'share_popover'"));var h=c.share_popover;t.setVariable("share_popover",h),s+="\n\n";var d=r.makeMacro(["authUser","user"],["options"],function(t,a,n){var o=i;i=new r.Frame,n=n||{},n.hasOwnProperty("caller")&&i.set("caller",n.caller),i.set("authUser",t),i.set("user",a),i.set("options",n.hasOwnProperty("options")?n.options:{});var s="";return s+='\n\n    <span class="toggle-button follow-user-button btn-loading" data-action="follow" data-user="',s+=r.suppressValue(r.memberLookup(a,"uid"),e.opts.autoescape),s+='">\n        <a class="button btn-primary toggle btn-disabled">\n            <i class="icon fa fa-plus"></i>\n            Follow\n        </a>\n        <a class="button btn-important untoggle">\n            <span class="toggled">\n                Following\n            </span>\n            <span class="untoggled">\n                Unfollow\n            </span>\n        </a>\n    </span>\n\n',i=o,new r.SafeString(s)});t.addExport("follow_button"),t.setVariable("follow_button",d),s+="\n\n";var p=r.makeMacro(["authUser"],["options"],function(a,s){var u=i;i=new r.Frame,s=s||{},s.hasOwnProperty("caller")&&i.set("caller",s.caller),i.set("authUser",a),i.set("options",s.hasOwnProperty("options")?s.options:{});var l="";return l+='\n\n    <div class="button btn-medium btn-secondary btn-loading like like-button popover-container btn-disabled" data-action="like-model">\n        <i class="icon fa fa-star"></i>\n        Like\n        ',r.memberLookup(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"popover"),"display")&&(l+="\n            ",l+=r.suppressValue((n=27,o=26,r.callWrap(r.contextOrFrameLookup(t,i,"share_popover"),"share_popover",t,[{class:r.memberLookup(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"popover"),"arrow")}])),e.opts.autoescape),l+="\n        "),l+="\n    </div>\n\n",i=u,new r.SafeString(l)});t.addExport("like_button"),t.setVariable("like_button",p),s+="\n\n";var f=r.makeMacro(["authUser"],["options"],function(a,s){var u=i;i=new r.Frame,s=s||{},s.hasOwnProperty("caller")&&i.set("caller",s.caller),i.set("authUser",a),i.set("options",s.hasOwnProperty("options")?s.options:{});var l="";return l+='\n\n    <div class="help like-button star-like-button btn-loading popover-container',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"buttonClass")&&(l+=" ",l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"buttonClass"),e.opts.autoescape)),l+='" data-action="like-model">\n        ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"count")&&r.memberLookup(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"count"),"display")&&(l+='\n            <span class="count">',l+=r.suppressValue(r.memberLookup(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"count"),"like"),e.opts.autoescape),l+="</span>\n        "),l+='\n        <span class="tooltip liked-content',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"tooltipClass")?(l+=" ",l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"tooltipClass"),e.opts.autoescape)):l+=" tooltip-down",l+='">Like</span>\n        <span class="tooltip unliked-content',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"tooltipClass")?(l+=" ",l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"tooltipClass"),e.opts.autoescape)):l+=" tooltip-down",l+='">Unlike</span>\n        ',r.memberLookup(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"popover"),"display")&&(l+="\n            ",l+=r.suppressValue((n=42,o=26,r.callWrap(r.contextOrFrameLookup(t,i,"share_popover"),"share_popover",t,[{class:r.memberLookup(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"popover"),"arrow")}])),e.opts.autoescape),l+="\n        "),l+="\n    </div>\n\n",i=u,new r.SafeString(l)});t.addExport("star_like_button"),t.setVariable("star_like_button",f),s+="\n\n";var m=r.makeMacro(["model"],["options"],function(a,n){var o=i;i=new r.Frame,n=n||{},n.hasOwnProperty("caller")&&i.set("caller",n.caller),i.set("model",a),i.set("options",n.hasOwnProperty("options")?n.options:{});var s="";return s+='\n\n    <a class="',s+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"className"),e.opts.autoescape),s+=' help" itemprop="discussionUrl" href="',s+=r.suppressValue(r.memberLookup(a,"viewerUrl"),e.opts.autoescape),s+='#comments" data-action="go-to-comments">\n        <span class="count">\n            ',s+=r.suppressValue(e.getFilter("humanize_number").call(t,r.memberLookup(a,"commentCount")),e.opts.autoescape),s+='\n        </span>\n        <span class="tooltip tooltip-up">Comment</span>\n    </a>\n\n',i=o,new r.SafeString(s)});t.addExport("comments_button"),t.setVariable("comments_button",m),s+="\n\n";var g=r.makeMacro(["authUser"],["options"],function(a,s){var u=i;i=new r.Frame,s=s||{},s.hasOwnProperty("caller")&&i.set("caller",s.caller),i.set("authUser",a),i.set("options",s.hasOwnProperty("options")?s.options:{});var l="";return l+='\n\n    <div class="',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"buttonClass")&&(l+=" ",l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"buttonClass"),e.opts.autoescape),l+=" "),l+=r.suppressValue(e.getFilter("class_names").call(t,{help:!0,"subscribe-button":!0,"count-subscribe-button":!0,"btn-loading":!0,"popover-container":!0,"--disabled":r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"disabled")}),e.opts.autoescape),l+='"\n\n        ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"disabled")||(l+='\n            data-action="subscribe-collection"\n        '),l+=">\n\n        ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"count")&&r.memberLookup(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"count"),"display")&&(l+='\n            <span class="count">',l+=r.suppressValue(r.memberLookup(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"count"),"subscribe"),e.opts.autoescape),l+="</span>\n        "),l+="\n\n        ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"disabled")?(l+='\n            <span class="tooltip subscribed-content',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"tooltipClass")?(l+=" ",l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"tooltipClass"),e.opts.autoescape)):l+=" tooltip-down",l+='">Subscribers</span>\n        '):(l+='\n             <span class="tooltip subscribed-content',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"tooltipClass")?(l+=" ",l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"tooltipClass"),e.opts.autoescape)):l+=" tooltip-down",l+='">Subscribe</span>\n            <span class="tooltip unsubscribed-content',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"tooltipClass")?(l+=" ",l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"tooltipClass"),e.opts.autoescape)):l+=" tooltip-down",l+='">Unsubscribe</span>\n        '),l+="\n\n        ",r.memberLookup(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"popover"),"display")&&(l+="\n            ",l+=r.suppressValue((n=86,o=26,r.callWrap(r.contextOrFrameLookup(t,i,"share_popover"),"share_popover",t,[{class:r.memberLookup(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"popover"),"arrow")}])),e.opts.autoescape),l+="\n        "),l+="\n    </div>\n\n",i=u,new r.SafeString(l)});t.addExport("subscribe_button_count"),t.setVariable("subscribe_button_count",g),s+="\n\n";var _=r.makeMacro(["collection"],[],function(t,a){var n=i;i=new r.Frame,a=a||{},a.hasOwnProperty("caller")&&i.set("caller",a.caller),i.set("collection",t);var o="";return o+='\n\n    <span class="toggle-button addto-button" data-action="add-to-collection" data-collection="',o+=r.suppressValue(r.memberLookup(t,"uid"),e.opts.autoescape),o+='">\n        <a class="button btn-small btn-primary toggle">\n            Add\n        </a>\n        <a class="button btn-small btn-important untoggle">\n            <span class="toggled">\n                Added\n            </span>\n            <span class="untoggled">\n                Remove\n            </span>\n        </a>\n    </span>\n\n',i=n,new r.SafeString(o)});t.addExport("add_to_collection_button"),t.setVariable("add_to_collection_button",_),s+="\n\n";var v=r.makeMacro(["collection"],[],function(t,a){var n=i;i=new r.Frame,a=a||{},a.hasOwnProperty("caller")&&i.set("caller",a.caller),i.set("collection",t);var o="";return o+='\n\n    <span class="toggle-button subscribe-collection-button btn-loading" data-action="subscribe-collection" data-collection="',o+=r.suppressValue(r.memberLookup(t,"uid"),e.opts.autoescape),o+='">\n        <div class="subscribe">\n            <a class="button btn-medium btn-primary btn-disabled toggle">\n                <i class="icon fa fa-rss"></i>\n                Subscribe\n            </a>\n            <a class="button btn-medium btn-important untoggle">\n                <i class="icon icon-fixed-left fa fa-rss"></i>\n                <span class="toggled">\n                    Subscribed\n                </span>\n                <span class="untoggled">\n                    Unsubscribe\n                </span>\n            </a>\n        </div>\n    </span>\n\n',i=n,new r.SafeString(o)});t.addExport("subscribe_button"),t.setVariable("subscribe_button",v),s+="\n\n";var b=r.makeMacro([],["options"],function(a){var n=i;i=new r.Frame,a=a||{},a.hasOwnProperty("caller")&&i.set("caller",a.caller),i.set("options",a.hasOwnProperty("options")?a.options:{});var o="";o+="\n\n    ";var s;return s=e.getFilter("merge").call(t,{buttonClass:"btn-secondary"},r.contextOrFrameLookup(t,i,"options")),i.set("options",s,!0),i.topLevel&&t.setVariable("options",s),i.topLevel&&t.addExport("options",s),o+='\n\n    <a class="button btn-medium ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"buttonClass")&&(o+=" ",o+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"buttonClass"),e.opts.autoescape)),o+='" data-action="open-collection-popup">\n        <div class="add-to">\n            <i class="icon fa fa-plus"></i>\n            Add to\n        </div>\n    </a>\n\n',i=n,new r.SafeString(o)});t.addExport("add_to_open_popup"),t.setVariable("add_to_open_popup",b),s+="\n\n";var y=r.makeMacro([],[],function(e){var t=i;i=new r.Frame,e=e||{},e.hasOwnProperty("caller")&&i.set("caller",e.caller);var a="";return a+='\n\n    <li class="item create-collection">\n        <div class="collection-addcard" data-action="open-create-collection-popup">\n            <div class="thumbnail create-new-collection">\n                <i class="icon fa fa-plus"></i>\n            </div>\n            <div class="js-title">\n                Create new collection\n            </div>\n        </div>\n    </li>\n\n',i=t,new r.SafeString(a)});t.addExport("open_create_collection"),t.setVariable("open_create_collection",y),s+="\n",u?u.rootRenderFunc(e,t,i,r,a):a(null,s)})})}catch(e){a(r.handleError(e,n,o))}}return{root:e}}()}()},function(e,t,i){"use strict";var r=i(7),a=i.n(r),n={};n.OSG_VERSION=-1;var o=function(e){var t={},i=new a.a(function(e,i){t.resolve=e,t.reject=i});i.resolve=t.resolve,i.reject=t.reject,n["get"+e]=function(){return i},n["resolve"+e]=function(){!1===i.isFulfilled()&&i.resolve.apply(i,arguments)}};o("Polygon"),o("Wireframe"),o("WireframeOptimized"),o("WireframeOptimizedSplit"),o("WireframeOptimizedSplitCompressed"),o("ModelDisplayed"),o("FirstAnimation"),o("AllAnimations"),o("HasAnimation"),o("FirstCameraAnimation"),o("Material"),o("HasSound"),o("SoundsCanPlayTrough"),o("VrDisplayReady"),o("LowResLoaded"),o("HighResLoaded"),o("LowResBound"),o("HighResBound"),o("DataSizeOSGJS"),o("DataSizePolygon"),o("DataSizeTextures"),o("DataSizeSound"),o("DataSizeEnvironment"),o("DataSizeWireframe"),o("DataSizeAllModel"),a.a.all([n.getDataSizeOSGJS(),n.getDataSizePolygon(),n.getDataSizeSound(),n.getDataSizeTextures(),n.getDataSizeEnvironment(),n.getDataSizeWireframe()]).then(function(e){for(var t=0,i=0,r=e.length;i<r;i++)t+=e[i];n.resolveDataSizeAllModel(t)}),window.sketchfabViewerLoaded=a.a.all([n.getHighResBound(),n.getAllAnimations(),n.getWireframeOptimizedSplitCompressed()]),document.createEvent&&window.dispatchEvent&&window.sketchfabViewerLoaded.then(function(){var e=document.createEvent("Event");e.initEvent("sketchfaballloadingdone",!0,!0),window.dispatchEvent(e)}),t.a=n},,,function(e,t,i){"use strict";var r,a,n,o=i(5),s=i(118),u=i(702),l=(i(34),o.a.osg),c={},h=-1,d=0,p=!1,f=40,m=l.Timer.instance().tick(),g=!1,_=!1,v=Object(u.a)(),b=function(){if(n=window.setTimeout(b,f),r&&a&&!g&&!c.isDrawAlreadyQueued()){l.Timer.instance().tick()-m-f<=f||(a.enable(),h=-1)}};Object(s.a)()||(n=window.setTimeout(b,f));var y=function(e){if(r&&!g){if(Object(u.b)())return void(_=!0);_=!1;var t=c.isDrawAlreadyQueued();if(t||r.requestRedraw(),a&&!e&&(a.reset(),!t)){var i=l.Timer.instance().tick();d+=i-m,h++,0===h?(h=0,d=0):4===h&&(f=Math.min(200,Math.max(16,d/h)),h=0,d=0),m=i}}};c.setPoseForScreenshot=function(e){g=e},c.isDrawAlreadyQueued=function(){return r._requestRedraw},c.draw=function(){y()},c.drawNoJitter=function(){this._doJitter=!1,y()},c.drawSameFrame=function(){y(!0)},c.redrawShadow=function(){p=!0,y()},c.getShadowForcedUpdate=function(){return p},c.setShadowForcedUpdate=function(e){p=e},c.setViewer=function(e){r=e},c.setSuperSample=function(e){a=e},c.getSuperSample=function(){return a},c.getFrameTimeAverage=function(){return f},v&&document.addEventListener(v,function(){_&&y()}),t.a=c},function(e,t,i){"use strict";var r=i(17),a=i(0),n=(i.n(a),i(15)),o=i.n(n),s=i(7),u=i.n(s),l=i(116),c=i(132),h=i(474),d=i(475),p=i(22),f=i(30),m=i(40),g=i(476),_=i(152),v=Object(l.a)(["initialize"]),b=v(o.a.Collection);t.a=b.extend({mixins:[_.b],optionsTypes:{offset:_.a.number,pageSize:_.a.number,paginationType:_.a.oneOf(["cursor","offset"]),lastPage:_.a.number,firstPage:_.a.number,minOffset:_.a.number,maxOffset:_.a.number,cursor:_.a.shape({previous:_.a.string,next:_.a.string})},defaultOptions:function(){return{pageSize:r.a.apiPageSize,paginationType:"cursor",offset:0,minOffset:0,maxOffset:1/0,cursor:{previous:null}}},backend:c.a,previousPromise:u.a.resolve(),constructor:function(){this.options=Object(a.extend)({},this.defaultOptions(),Object(a.pickBy)(arguments[1]||{},function(e){return void 0!==e})),b.apply(this,arguments)},initialize:function(){this.options.backend&&(this.backend=this.options.backend),this._loading="none",Object(g.a)("add","afterAdd",this),Object(g.a)("remove","afterRemove",this),this.triggerAfterRequest=Object(a.debounce)(this.triggerAfterRequest.bind(this),20),this.initializePagination(),b.prototype.initialize.apply(this,arguments)},at:function(e){return e<0?void 0:b.prototype.at.call(this,e)},domain:function(){return Object(a.result)(this.backend,"domain")},parse:function(e){return this.backend.parse(e)},queryParams:function(){return this.isCursorPagination()?{cursor:this._currentCursor,count:Object(a.result)(this.options,"pageSize")}:{offset:this.options.offset,count:Object(a.result)(this.options,"pageSize")}},url:function(){var e=Object(a.result)(this,"domain"),t=Object(a.result)(this,"endpoint"),i=e+t,r=i+p.b.craft("?",this.queryParams());return r=r.replace(/(?!^)\/{2,}/g,"/")},fetch:function(){this.triggerBeforeRequest();var e=this.previousPromise;return this.previousPromise=u.a.resolve(b.prototype.fetch.apply(this,arguments)).then(function(t){return e.timeout(1e3).catch(m.c).then(function(){return t})}),this.previousPromise.then(function(e){return this.previousPromise=u.a.resolve(),this.triggerAfterRequest(e),e}.bind(this))},reset:function(){b.prototype.reset.apply(this,arguments),this.pagination.reset()},triggerBeforeRequest:function(){this.trigger("beforeRequest")},triggerAfterRequest:function(e){this.trigger("afterRequest",e)},isCursorPagination:function(){return"cursor"===this.pagination.type},initializePagination:function(){"offset"===this.options.paginationType?this._initializeOffsetPagination():this._initializeCursorPagination()},_initializeCursorPagination:function(){var e=this.options.cursor;this.pagination=Object(d.a)(e,function(e,t){return this._currentCursor=e,u.a.resolve(this.fetch(Object(a.extend)({},t,{reset:!1,add:!1,remove:!1})))}.bind(this))},_initializeOffsetPagination:function(){var e={lastPage:this.options.lastPage,firstPage:this.options.firstPage};this.pagination=Object(h.a)(e,function(e,t){return this.options.offset=this.options.minOffset+Object(a.result)(this.options,"pageSize")*e,u.a.resolve(this.fetch(Object(a.extend)({},t,{reset:!1,add:!1,remove:!1})))}.bind(this))},loadPreviousPage:function(e){var t=this;this.setLoading("previous");var i=e||{};return this.pagination.loadPrevious(i).then(function(e){var r=t.parse(e);return i.setPrevious&&i.setNext?t.set(r):t.add(r,{at:0}),t.setLoading("none"),r}).catch(function(e){throw t.setLoading("none"),e})},loadNextPage:function(e){var t=this;this.setLoading("next");var i=e||{};return this.pagination.loadNext(i).then(function(e){var r=t.parse(e);return i.setPrevious&&i.setNext?t.set(r):t.add(r),t.setLoading("none"),r}).catch(function(e){throw t.setLoading("none"),e})},loadFirstPage:function(e){var t=this;return this.setLoading("refresh"),this.pagination.loadFirst(e||{}).then(function(e){var i=t.parse(e);return i.length||t.trigger("empty"),t.set(i),t.setLoading("none"),i}).catch(function(e){throw t.setLoading("none"),e})},loadLatestItems:function(){var e=this;return this.setLoading("refresh"),this.pagination.loadFirst({allowPrefetching:!1}).then(function(t){var i=e.parse(t);return e.add(i,{at:0}),e.setLoading("none"),i}).catch(function(t){throw e.setLoading("none"),t})},hasPreviousPage:function(){return this.pagination.hasPrevious()},hasNextPage:function(){return this.pagination.hasNext()},setLoading:function(e){this._loading=e,this.trigger("loadingChanged",e)},loading:function(){return this._loading},isLoading:function(){return"none"!==this._loading}},{extend:function(e,t){var i=Object(a.extend)({},e,{defaultOptions:Object(f.e)(Object(m.e)(this.prototype.defaultOptions||{}),Object(m.e)(e.defaultOptions||{})),optionTypes:Object(a.extend)({},this.prototype.optionTypes||{},e.optionTypes||{})});return b.extend.call(this,i,t)}})},,function(e,t,i){"use strict";function r(e){return e}function a(){return Array.prototype.slice.call(arguments).reduce(function(e,t){return function(){return e(t.apply(t,arguments))}},r)}function n(e){return Object(u.isFunction)(e)?e:Object(u.constant)(e)}function o(){}function s(e){var t=!0;return function(){if(t){var i=arguments;t=!1,window.requestAnimationFrame(function(){t=!0,e.apply(e,i)})}}}t.b=r,t.a=a,t.e=n,t.c=o,t.d=s;var u=i(0);i.n(u)},function(e,t,i){"use strict";var r=i(20),a=i.n(r),n=i(29),o=i.n(n),s=i(19),u=i.n(s),l=i(15),c=i.n(l),h=i(3),d=i.n(h),p=i(0),f=(i.n(p),i(7)),m=i.n(f),g=i(570),_=i(87),v=i(22),b=i(6),y=i(12),x=i(542),S=i(132);t.a=y.a.extend(Object(p.extend)({},x.a,{defaults:{collections:{}},initialize:function(){y.a.prototype.initialize.apply(this,arguments),this.on("change:isPrivate",function(){this.get("isPrivate")||this.set("password","")}.bind(this)),this.set("filters",new y.a),this.maxFailCount=5},endpoint:function(){return"/models"+(this.isNew()?"":"/"+this.get("uid"))},queryParams:function(){return Object(v.a)("?",u()({},y.a.prototype.queryParams.apply(this,arguments)))},fetchMetadata:function(e){return e=Object(p.extend)({allowPrefetching:!0},e),m.a.resolve(c.a.ajax({type:"GET",url:""+Object(p.result)(this,"domain")+Object(p.result)(this,"endpoint")+"/management",allowPrefetching:e.allowPrefetching})).then(function(e){return this.set({hasStats:e.hasStats,downloadStatus:e.downloadStatus}),e}.bind(this))},updateLike:function(e){return b.a.authenticate(function(t){var i=this.get("uid"),r=this.get("likeCount"),a=r+(e?1:-1);return this.set({likeCount:a}),t.addLike(i,e),m.a.resolve(c.a.ajax({type:e?"POST":"DELETE",url:""+Object(p.result)(this,"domain")+Object(p.result)(this,"endpoint")+"/likes",cacheBusting:!1,dataType:"text"})).catch(function(r){return this.set({likeCount:a}),t.addLike(i,!e),m.a.reject(r)}.bind(this))}.bind(this))},like:function(){return this.updateLike(!0)},unlike:function(){return this.updateLike(!1)},toggleLike:function(){return b.a.authenticate(function(e){return e.doesLike(this.get("uid"))?this.unlike():this.like()}.bind(this))},hit:function(){var e=b.a.me();if(e.isAuthenticated()){var t=this.get("user")&&e.get("uid")===this.get("user").uid,i=e.get("isStaff");if(t||i)return m.a.resolve()}return this.get("isPublished")?c.a.ajax({type:"POST",url:""+Object(p.result)(this,"domain")+Object(p.result)(this,"endpoint")+"/views",cacheBusting:!1}):m.a.resolve()},isPublished:function(){return(this.get("isPublished")||!!this.get("publishedAt"))&&!this.get("isDeleted")},publish:function(){return this.set("isPublished",!0),this.set("publishedAt",new Date),c.a.ajax({type:"PATCH",url:Object(p.result)(this,"url"),data:{isPublished:!0},cacheBusting:!1})},getDownloadStatus:function(e){return c.a.ajax({type:"GET",url:Object(p.result)(this,"domain")+"/archives/latest",allowPrefetching:!1,data:{model:this.get("uid"),archive_type:e},traditional:!0}).then(function(e,t,i){return d.a.Deferred().resolve(e,t,i)})},getLikeUsers:function(){return c.a.ajax({type:"GET",url:""+Object(p.result)(this,"domain")+Object(p.result)(this,"endpoint")+"/liked_by",allowPrefetching:!0}).then(function(e){return e})},sharing:function(){return c.a.ajax({type:"GET",url:""+Object(p.result)(this,"domain")+Object(p.result)(this,"endpoint")+"/sharing"}).then(function(e){return this.set("sharing",e),m.a.resolve(e)}.bind(this))},toJSON:function(){var e=y.a.prototype.toJSON.apply(this,arguments);return e.categories&&(e.categories=e.categories.map(function(e){return"object"===(void 0===e?"undefined":o()(e))?e.uid:e})),e},addCollection:function(e,t){var i={};i[e]=t,this.addCollections(i)},addCollections:function(e){var t=Object(p.clone)(this.get("collections"));Object(p.extend)(t,e),this.set("collections",t)},isInflated:function(){var e=a()(this.attributes);return e.indexOf("description")>-1&&e.indexOf("tags")>-1},isInCollection:function(e){return!!this.get("collections")[e]},isProcessing:function(){var e=this.get("status");return e&&"PROCESSING"===e.processing},getCollections:function(e){var t=[];return Object(p.each)(e,function(e){e in this.get("collections")||t.push(e)}.bind(this)),new m.a(function(e,i){t.length>0?c.a.ajax({type:"GET",url:Object(p.result)(this,"domain")+"/models/"+this.id+"/collections?uid="+t.join("&uid=")}).then(function(t){this.addCollections(t.results),e()}.bind(this),i):(this.trigger("change:collections"),e())}.bind(this))},getDownloadType:function(){return this.get("price")>0&&this.get("license")?"paid":this.get("license")?"free":"no"},getExtraArchive:function(){return"paid"!==this.getDownloadType()||this.isProcessing()?(this.set("extraArchive",null),m.a.resolve()):m.a.resolve(c.a.ajax({url:Object(p.result)(this,"domain")+"/archives/extra?model="+this.id,type:"GET"})).then(function(e){e=e.metadata?e:null,this.set("extraArchive",e)}.bind(this)).catch(function(e){404===e.status&&this.set("extraArchive",null)}.bind(this))},uploadExtraArchive:function(e){var t=this,i=new FormData;return i.append("model",this.id),i.append("extraFile",e),new m.a(function(e,r){c.a.ajax({url:Object(p.result)(t,"domain")+"/archives/extra",type:"POST",data:i,processData:!1,contentType:!1}).then(e,function(e){return r(e.responseJSON)})})},removeExtraArchive:function(){var e=new FormData;return e.append("model",this.id),m.a.resolve(c.a.ajax({url:Object(p.result)(this,"domain")+"/archives/extra",type:"DELETE",data:e,processData:!1,contentType:!1}))},reprocess:function(){return m.a.resolve(c.a.ajax({url:Object(p.result)(this,"domain")+"/models/"+this.id+"/reprocess",type:"POST"})).then(this.checkStatusAndRetry.bind(this)).then(function(e){switch(e.processing){case"SUCCEEDED":return this.set("hasStats",!0),m.a.resolve();case"FAILED":return this.set("hasStats",!1),m.a.reject()}}.bind(this))},getOwnershipStatus:function(e){return m.a.resolve(c.a.ajax({url:Object(p.result)(this,"domain")+"/models/"+this.id+"/download",type:"GET",allowPrefetching:!!e}))},pollArchivesStatus:function(){return _.c(1/0,function(){return m.a.resolve(this.fetchMetadata({allowPrefetching:!1})).then(function(e){return"archives_processing"===e.downloadStatus?m.a.reject():e})}.bind(this),{interval:1e4})},getRatings:function(){return m.a.resolve(c.a.ajax({url:Object(p.result)(this,"domain")+"/models/"+this.id+"/ratings",type:"GET"}))}}),{pollDownloadLink:function(e){return g.a(e,function(e){return e>3e4?e:2*e})},fetchFallback:function(e){return m.a.resolve(c.a.ajax({url:S.a.domain+"/models/"+e+"/fallback",type:"GET"}))}})},function(e,t,i){var r,a,n;/**
 * isMobile.js v0.4.1
 *
 * A simple library to detect Apple phones and tablets,
 * Android phones and tablets, other mobile devices (like blackberry, mini-opera and windows phone),
 * and any kind of seven inch device, via user agent sniffing.
 *
 * @author: Kai Mallea (kmallea@gmail.com)
 *
 * @license: http://creativecommons.org/publicdomain/zero/1.0/
 */
!function(i){var o=/iPhone/i,s=/iPod/i,u=/iPad/i,l=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,c=/Android/i,h=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,d=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,p=/Windows Phone/i,f=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,m=/BlackBerry/i,g=/BB10/i,_=/Opera Mini/i,v=/(CriOS|Chrome)(?=.*\bMobile\b)/i,b=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,y=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),x=function(e,t){return e.test(t)},S=function(e){var t=e||navigator.userAgent,i=t.split("[FBAN");if(void 0!==i[1]&&(t=i[0]),i=t.split("Twitter"),void 0!==i[1]&&(t=i[0]),this.apple={phone:x(o,t),ipod:x(s,t),tablet:!x(o,t)&&x(u,t),device:x(o,t)||x(s,t)||x(u,t)},this.amazon={phone:x(h,t),tablet:!x(h,t)&&x(d,t),device:x(h,t)||x(d,t)},this.android={phone:x(h,t)||x(l,t),tablet:!x(h,t)&&!x(l,t)&&(x(d,t)||x(c,t)),device:x(h,t)||x(d,t)||x(l,t)||x(c,t)},this.windows={phone:x(p,t),tablet:x(f,t),device:x(p,t)||x(f,t)},this.other={blackberry:x(m,t),blackberry10:x(g,t),opera:x(_,t),firefox:x(b,t),chrome:x(v,t),device:x(m,t)||x(g,t)||x(_,t)||x(b,t)||x(v,t)},this.seven_inch=x(y,t),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window)return this},M=function(){var e=new S;return e.Class=S,e};void 0!==e&&e.exports&&"undefined"==typeof window?e.exports=S:void 0!==e&&e.exports&&"undefined"!=typeof window?e.exports=M():(a=[],r=i.isMobile=M(),void 0!==(n="function"==typeof r?r.apply(t,a):r)&&(e.exports=n))}(this)},function(e,t,i){"use strict";var r={};r.PICK_GEOMETRY_FIXED=1,r.PICK_GEOMETRY_ANIMATED=2,r.PICK_GEOMETRY_RIG_BOX=4,r.PICK_GIZMO_LIGHT=8,r.SHADOW_CAST=16,r.SHADOW_BOUNDS=32,r.PICK_GEOMETRY_SLOW=r.PICK_GEOMETRY_FIXED|r.PICK_GEOMETRY_ANIMATED,r.PICK_GEOMETRY_FAST=r.PICK_GEOMETRY_FIXED|r.PICK_GEOMETRY_RIG_BOX,r.PICK_GEOMETRY=r.PICK_GEOMETRY_FIXED|r.PICK_GEOMETRY_ANIMATED|r.PICK_GEOMETRY_RIG_BOX,r.PICK=r.PICK_GEOMETRY|r.PICK_GIZMO_LIGHT,r.SHADOW=r.SHADOW_BOUNDS|r.SHADOW_CAST,r.PICK_GEOMETRY_SHADOW=r.PICK_GEOMETRY|r.SHADOW,r.NO_SHADOW=~r.SHADOW,r.NO_PICK=~r.PICK,r.NO_PICK_NO_SHADOW_CAST=~(r.PICK|r.SHADOW_CAST),r.NO_PICK_NO_SHADOW_BOUNDS=~(r.PICK|r.SHADOW_BOUNDS),r.NO_PICK_NO_SHADOW=~(r.PICK|r.SHADOW),t.a=r},function(e,t,i){"use strict";t.a=function(e){var t=Array.prototype.slice.call(arguments,1),i=e.bind.apply(e,t);return i(),i}},,,function(e,t,i){"use strict";var r=!1,a=function(e){return void 0!==e&&(r=e),r};t.a=a},,,,,,function(e,t,i){"use strict";function r(e){return e.replace(/([A-Z])/g,"_$1").toLowerCase()}function a(e){return e.replace(/[^\w\s-]+/g,"").trim().toLowerCase().replace(/[-\s]+/g,"-")}function n(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\\/g,"")}function o(e,t,i,r){var a=Array.prototype.slice.call(arguments,0);if(a.length&&a[a.length-1].__keywords){var o=a.pop(),s=a[1],u=a[2],l=a[3];t=s||o.trim_url_limit,i=u||o.nofollow,r=l||o.target}null==i&&(i=!0),"string"==typeof e&&(e=n(e));var c=r?' target="'+r+'"':"",h=["noopener","noreferrer"].concat(i?["nofollow"]:[]),d=e.replace(T,function(e){var i=e.trim(),r=E.test(i)?h.slice(0,-1).join(" "):h.join(" ");return O(e,'<a href="'+D(i)+'" rel="'+r+'"'+c+">"+L(t,i)+"</a>")}).replace(w,function(e){var t=e.trim();return O(e,'<a href="mailto:'+t+'">'+t+"</a>")}).replace(C,function(e){var t=e.trim();return(e.match(/^\s/)?" ":"")+'<a href="'+window.location.origin+"/"+P(t).substring(1)+'" rel="'+h.join(" ")+'">'+A(t)});return y.a.runtime.markSafe(d)}function s(e){return y.a.runtime.markSafe(S.a.sanitize(e,{ALLOWED_TAGS:[]}))}function u(e){return v()("<div/>").html(S.a.sanitize(e,{ALLOWED_TAGS:[]}).trim()).text()}function l(e){var t=e.match(/.+/g);return t?y.a.runtime.markSafe(t.map(function(e){return"<p>"+e+"</p>"}).join("")):e}function c(e,t,i){return void 0===t&&(t=""),void 0===i&&(i="s"),1===e?t:i}function h(e,t,i){return e.split(t).pop().split(i)[0]}function d(e){return e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()})}function p(e){return e.replace(/_./g,function(e){return e.toUpperCase().replace("_","")})}function f(e){return e.start+".."+e.end}function m(e){var t=e.split("..");return{start:parseFloat(t[0]||0),end:parseFloat(t[1]||0)}}function g(e){return e.split("/").reduce(function(e,t){return t?"."===t?e:".."===t&&e.length?Object(M.dropRight)(e,1):e.concat(t):e},[]).join("/")+("/"===Object(M.last)(e)?"/":"")}t.m=r,t.i=a,t.n=o,t.l=s,t.h=u,t.e=l,t.f=c,t.b=h,t.a=d,t.j=p,t.g=f,t.k=m,t.d=g,i.d(t,"c",function(){return k});var _=i(3),v=i.n(_),b=i(227),y=i.n(b),x=i(141),S=i.n(x),M=i(0),w=(i.n(M),/(\s|^)\S+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+(\s|$)/g),T=/(\s|^)(https?:\/\/)?(?:(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[\/?#]\S*)?(?=(\s|$))/g,C=/(\s|^)(@[a-zA-Z0-9._-]{2,30})/g,E=new RegExp("sketchfab.com"),L=function(e,t){var i=t.replace(/^(https?:\/\/)?(www\.)?/,"");return null==e||i.length<=e?i:i.substr(0,e)+"..."},P=function(e){return e.match(/^(@[a-zA-Z0-9._-]{2,30})/)[0]},A=function(e){var t=e.split(/^(@[a-zA-Z0-9._-]{2,30})/);return t.length>3?t.join(""):t[1]+"</a>"+t[2]},D=function(e){return e.match(/^https?:\/\//)?e:"http://"+e},O=function(e,t){var i=e.match(/^\s/),r=e.match(/\s$/);return(i?i[0]:"")+t+(r?r[0]:"")},k=function(e){return"#"+e.substring(0,6)}},function(e,t,i){"use strict";var r=function(e){this.traversalMask=-1,this.nodeMaskOverride=0,this.traversalMode=e,void 0===e&&(this.traversalMode=r.TRAVERSE_ALL_CHILDREN),this.nodePath=[],this.visitorType=r.NODE_VISITOR,this._databaseRequestHandler=void 0,this._frameStamp=void 0,this.traverse=r._traversalFunctions[this.traversalMode],this.pushOntoNodePath=r._pushOntoNodePath[this.traversalMode],this.popFromNodePath=r._popFromNodePath[this.traversalMode]};r.TRAVERSE_PARENTS=1,r.TRAVERSE_ALL_CHILDREN=2,r.TRAVERSE_ACTIVE_CHILDREN=3,r.NODE_VISITOR=0,r.UPDATE_VISITOR=1,r.CULL_VISITOR=2;var a=function(e){e.ascend(this)},n=function(e){e.traverse(this)};r._traversalFunctions=[void 0,a,n,n];var o=function(e){this.nodePath.unshift(e)},s=function(e){this.nodePath.push(e)};r._pushOntoNodePath=[void 0,o,s,s];var u=function(){return this.nodePath.shift()},l=function(){this.nodePath.pop()};r._popFromNodePath=[void 0,u,l,l],r.prototype={reset:function(){this.nodePath.length=0},setFrameStamp:function(e){this._frameStamp=e},getFrameStamp:function(){return this._frameStamp},setNodeMaskOverride:function(e){this.nodeMaskOverride=e},getNodeMaskOverride:function(){return this.nodeMaskOverride},setTraversalMask:function(e){this.traversalMask=e},getTraversalMask:function(){return this.traversalMask},getNodePath:function(){return this.nodePath},validNodeMask:function(e){var t=e.getNodeMask();return 0!=(this.traversalMask&(this.nodeMaskOverride|t))},apply:function(e){this.traverse(e)},getVisitorType:function(){return this.visitorType},setDatabaseRequestHandler:function(e){this._databaseRequestHandler=e},getDatabaseRequestHandler:function(){return this._databaseRequestHandler}},t.a=r},function(e,t,i){"use strict";var r=i(155),a=i.n(r),n=i(0),o=(i.n(n),function(e){return e.split(/; */g).reduce(function(e,t){var i=t.indexOf("="),r=decodeURIComponent(t.substr(0,i)),a=decodeURIComponent(t.substr(i+1));return e[r]=a,e},{})}),s=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=i.expires,n=void 0===r?31536e6:r,o=i.domain,s=void 0===o?"":o,u=i.path,l=void 0===u?"/":u,c=n instanceof Date?n:new Date(Date.now()+n);return[encodeURIComponent(e)+"="+encodeURIComponent(t),"expires="+c.toUTCString()].concat(a()(s?["domain="+s]:[]),["path="+l,"secure"]).join(";")},u=function(e,t){document.cookie=s(e,"",Object(n.extend)({},t,{expires:new Date("01/01/1970 00:00+0000")}))},l=function(e,t){var i=void 0;try{i=o(document.cookie)[e]}catch(e){console.warn("The cookies could not be read, most likely due to sandboxing issues.")}return void 0===i?t:i},c=function(e,t,i){try{document.cookie=s(e,t,i)}catch(e){console.warn("The cookies could not be set, most likely due to sandboxing issues.")}};t.a={remove:u,get:l,set:c}},,function(e,t,i){"use strict";var r={};r.OPAQUE=0,r.OPAQUE_NO_EARLYZ=r.BACKGROUND=1,r.REFRACTION=2,r.TRANSPARENT_NO_EARLYZ_PRE=9,r.TRANSPARENT=10,r.TRANSPARENT_NO_EARLYZ_POST=11,r.EXTRA=19,r.EDITOR_GIZMO=r.HOTSPOT=20,r.GRID=r.TOOLTIP=r.VR_MENU=21,r.WIREFRAME=r.VR_CURSOR=22,r.OUTLINE=23,r.DEBUG=24,r.DEBUG_2=25,t.a=r},function(e,t,i){"use strict";var r=i(9),a=i(71),n=function(){a.a.call(this)};r.a.createPrototypeStateAttribute(n,r.a.objectInherit(a.a.prototype,{_attributeTypeIndex:void 0,getType:function(){return this.attributeType},getTypeMember:function(){return this.attributeType},apply:function(){},getHash:function(){return this.getType()}}),"osg","StateAttribute"),n.OFF=0,n.ON=1,n.OVERRIDE=2,n.PROTECTED=4,n.INHERIT=8,t.a=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(7),a=i.n(r),n=i(5),o=i(0),s=(i.n(o),i(1132)),u=i(700),l=i(1138),c=i(1139),h=i(1140),d=i(1141),p=i(980),f=i(1142),m=i(1144),g=i(187),_=i(850),v=i(1145),b=n.a.osg,y=function(e){e=this.computeURL(e);var t=new b.Image;return t.setURL(e),a.a.resolve(t)},x=[],S={},M=function(){return function(){var e=this.getJSON(),t=e.UniqueID,i=new b.BufferArray(b.BufferArray[e.Type]);i.setItemSize(e.ItemSize),i.setElements(x);var r=i.getInstanceID();if(S[r]={},e.Array){var n=Object.keys(e.Array)[0],o=e.Array[n];o.Elements?S[r].inlined=o.Elements:(S[r].vb=o,S[r].type=n)}else S[r].inlined=e.Elements;var s=a.a.resolve(i);return void 0!==t&&(this._identifierMap[t]=s),s}},w=function(e){return function(t,i){return t=i.currentAnimationUID?i.currentAnimationUID:this.computeURL(t),e.getBinaryArray(t,i).getPromise()}},T=function(e,t){this.resource=e,this.promise=t},C=function(e){if(!e){if(C.instance)return C.instance;C.instance=this}return this._optPrefetch={modelUid:void 0,checkPrefetch:!0},this._maps={},this._collections={},this._resourceLoader=new s.a,this};C.Entry=T,C.prototype={setModelUid:function(e){this._optPrefetch.modelUid=e},setStateContextOSG:function(e){this._state=e},getInstance:function(){return C.instance},register:function(e,t){this._maps[e]=t},exist:function(e){return this._maps[e]},hashTextureOptions:function(e){for(var t="",i=u.a.getValidOptions(),r=i.length,a=0;a<r;++a)t+=e[i[a]];return t},_getCollection:function(e,t){var i=this._collections[t];return i||(this._collections[t]=new e([],this._optPrefetch),window.RunningTests||this._collections[t].fetch(),this._collections[t])},getEnvironmentCollection:function(){return this._getCollection(l.a,"environment")},getBackgroundCollection:function(){return this._getCollection(c.a,"background")},getSoundCollection:function(){return this._getCollection(m.a,"sound")},getHotspotCollection:function(){return this._getCollection(p.a,"hotspot")},getMatcapCollection:function(){return this._getCollection(d.a,"matcap")},getAnimationCollection:function(){return this._getCollection(f.a,"animation")},getTextureCollection:function(){if(this._collections.texture)return this._collections.texture;var e=this._getCollection(h.a,"texture");return e.forEach(function(t){0===t.getImages().length&&e.remove(t)}),e.isValid(),e},getOrCreateMultiresTexture:function(e,t){var i=this.hashTextureOptions(t),r=[e,i].join(""),n=this.exist(r);if(n)return n;var o=this.getTextureCollection().get(e)||this.getMatcapCollection().get(e);if(o){var s=new g.a;return u.a.setOptions(t,s),s.setImageModel(o),n=new T(s,a.a.resolve(s)),this.register(r,n),n}},getOrCreateImage:function(e,t){var i="image"+e;t&&t.widget&&(i+="widget");var r=this.exist(i);if(r)return r;var a=this._resourceLoader.getImage(e,t),n=a.getPromise();return r=new T,r.promise=n.then(function(e){return r.image=e,r.resource=e,e}),this.register(i,r),r},getOrCreateTexture:function(e,t){var i=function(e){!this._state||e._textureObject&&!e.isDirty()||this._state.applyTextureAttribute(0,e)}.bind(this),r=u.a.createValidOptions(t),a=this.hashTextureOptions(r),n=[e,a].join(""),o=this.exist(n),s=!!(t&&t.transferToGPU&&this._state);if(o)return s&&(o.promise.isFulfilled()?i(o.texture):o._bindToGPU=!0),o;r.cubemap=t&&t.cubemap;var l=r.cubemap?new _.a:new g.a;l.setTextureSize(1,1),u.a.setOptions(r,l),t&&void 0!==t.convertNPOT&&(l._convertNPOT=t.convertNPOT);var c=this._resourceLoader.getImage(e,t),h=c.getPromise();o=new T(l),o.texture=l,o._bindToGPU=s;var d=this;return o.promise=h.then(function(e){if(r.cubemap)for(var t=0;t<6;t++){var a=b.Texture.TEXTURE_CUBE_MAP_POSITIVE_X+t;l.setImage(a,e[a],"RGBA")}else l.setImage(e);return l.dirty(),o._bindToGPU&&i(l),l}).finally(function(){return h.isFulfilled()||d.register(n,void 0),l}),this.register(n,o),o},getOrCreateModel:function(e,t){var i=e,r=this.exist(i);if(r)return r;var a=t&&t.node?t.node:new b.Node,n={};n.readImageURL=y,n.readBinaryArrayURL=w(this._resourceLoader),n.bufferMap=S,n.readBufferArray=M();var s=Object(o.extend)({},n,t),u=this._resourceLoader.getModel(e,s),l=e.split("/");l.length=l.length-1,l.length<=0&&b.error("getOrCreateModel: can't find prefix to load subdata");var c=l.join("/")+"/";s.prefixURL=c;var h=Object(v.a)(u.getPromise(),e,s,a,this._resourceLoader);return r=new T(a,h),r.node=a,this.register(i,r),r},run:function(){this._resourceLoader.run()}},new C,t.default=C},,function(e,t){!function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/utils.jinja"]=function(){function e(e,t,i,r,a){var n="";try{var o=null,s=r.makeMacro(["number"],[],function(a,n){var o=i;i=new r.Frame,n=n||{},n.hasOwnProperty("caller")&&i.set("caller",n.caller),i.set("number",a);var s="";return s+="\n    ",s+=r.suppressValue(e.getFilter("humanize_number").call(t,a),e.opts.autoescape),s+="\n",i=o,new r.SafeString(s)});t.addExport("humanize_count"),t.setVariable("humanize_count",s),n+="\n\n";var u=r.makeMacro(["host","type","uid"],["options"],function(a,n,o,s){var u=i;i=new r.Frame,s=s||{},s.hasOwnProperty("caller")&&i.set("caller",s.caller),i.set("host",a),i.set("type",n),i.set("uid",o),i.set("options",s.hasOwnProperty("options")?s.options:{});var l="";l+="\n    ";var c;if(c=a+"/requests/new?type=report_abuse&utm_campaign=report_abuse&utm_source=website&"+n+"="+o,i.set("link",c,!0),i.topLevel&&t.setVariable("link",c),i.topLevel&&t.addExport("link",c),l+="\n\n    ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"subject")){l+="\n        ";var h;h="&report_string="+e.getFilter("urlencode").call(t,r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"subject")),i.set("label",h,!0),i.topLevel&&t.setVariable("label",h),i.topLevel&&t.addExport("label",h),l+="\n    "}return l+='\n\n    <a href="',l+=r.suppressValue(r.contextOrFrameLookup(t,i,"link"),e.opts.autoescape),l+=r.suppressValue(r.contextOrFrameLookup(t,i,"label"),e.opts.autoescape),l+='" class="report-link ',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"class"),e.opts.autoescape),l+='" target="_blank">\n        ',l+=r.suppressValue(e.getFilter("safe").call(t,e.getFilter("default").call(t,r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"text"),"Report abuse")),e.opts.autoescape),l+="\n    </a>\n",i=u,new r.SafeString(l)});t.addExport("report_link"),t.setVariable("report_link",u),n+="\n",o?o.rootRenderFunc(e,t,i,r,a):a(null,n)}catch(e){a(r.handleError(e,null,null))}}return{root:e}}()}()},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),function(e){this._views=[],e&&(this._name=e.FeatureName,this._modelName=e.ModelName,this._modelType=e.ModelType,this._viewListType=e.ViewListType.slice(0))});a.prototype={getName:function(){return this._name},getModel:function(){return this._model},addView:function(e){e&&this._views.push(e)},init:function(e){if(this._model||(this._model=e.getModelByName(this._modelName)),!this._model){var t=this._modelType;this._model=new t,this._model.init&&this._model.init(e)}var i=function(t){var i=new t({model:this._model,context:e});this.addView(i)};this._viewListType.forEach(function(e){i.call(this,e)},this),e.addFeature(this)},prepareForScreenShot:function(){var e=this.getWidgetNode();return!(!e||!e.getNodeMask())&&(this._oldMaskEditorWidget=e.getNodeMask(),e.setNodeMask(0),!0)},resetAfterScreenShot:function(){var e=this.getWidgetNode();e&&e.setNodeMask(this._oldMaskEditorWidget)},getWidgetNode:function(){}},a.create=function(e){var t=function(){a.call(this,t)};return t.prototype=Object(r.extend)({},a.prototype),Object(r.extend)(t,e),t.getName=function(){return e.FeatureName},t},t.a=a},function(e,t,i){"use strict";var r=i(5),a=r.a.osg,n={DEPTH_LESS_WRITE:new a.Depth(a.Depth.LESS,0,1,!0),DEPTH_LESS_NO_WRITE:new a.Depth(a.Depth.LESS,0,1,!1),DEPTH_DISABLE:new a.Depth(a.Depth.DISABLE,0,1,!0),DEPTH_ALWAYS:new a.Depth(a.Depth.ALWAYS,0,1,!0),DEPTH_NEVER:new a.Depth(a.Depth.NEVER,0,1,!1),DEPTH_LEQUAL_BACKGROUND_NO_WRITE:new a.Depth(a.Depth.LEQUAL,1,1,!1),DEPTH_LEQUAL_WRITE:new a.Depth(a.Depth.LEQUAL,0,1,!0),DEPTH_LEQUAL_NO_WRITE:new a.Depth(a.Depth.LEQUAL,0,1,!1),DEPTH_EQUAL_NO_WRITE:new a.Depth(a.Depth.EQUAL,0,1,!1),COLOR_MASK_NONE:new a.ColorMask(!1,!1,!1,!1),COLOR_MASK_ALPHA:new a.ColorMask(!1,!1,!1,!0),COLOR_MASK_RGBA:new a.ColorMask(!0,!0,!0,!0),BLEND_DISABLE:new a.BlendFunc,BLEND_SUBSTRACTIVE:new a.BlendFunc(a.BlendFunc.ONE,a.BlendFunc.ONE_MINUS_SRC_ALPHA),BLEND_ADDITIVE:new a.BlendFunc(a.BlendFunc.ONE,a.BlendFunc.ONE),CULL_BACK:new a.CullFace(a.CullFace.BACK),CULL_FRONT:new a.CullFace(a.CullFace.FRONT),CULL_DISABLE:new a.CullFace(a.CullFace.DISABLE)};t.a=n},function(e,t,i){"use strict";i.d(t,"a",function(){return c}),i.d(t,"f",function(){return h}),i.d(t,"d",function(){return d}),i.d(t,"h",function(){return p}),i.d(t,"g",function(){return f}),i.d(t,"e",function(){return m}),i.d(t,"b",function(){return g}),i.d(t,"c",function(){return _});var r=i(3),a=i.n(r),n=i(0),o=(i.n(n),i(130)),s=i(40),u=i(7),l=i.n(u),c=function(e){var t=e.getBoundingClientRect(),i={x:t.left+t.width/2,y:t.top+t.height/2},r={y:(window.innerHeight||document.documentElement.clientHeight)/2,x:(window.innerWidth||document.documentElement.clientWidth)/2};return i.x-r.x+(i.y-r.y)},h=function(e){var t=e.getBoundingClientRect();return t.top>=0-t.height&&t.left>=0&&t.bottom<=window.innerHeight+t.height&&t.right<=window.innerWidth},d=function(e,t){return Object(n.includes)(Object(o.c)(a()(t).parents()),e)},p=function(e){return new l.a(function(t,i){var r=new Image;r.onload=function(){return t(r)},r.onerror=i,r.src=e,r.complete&&t(r)})},f=function(e){return p(e).catch(s.c)},m=function(e){var t=new Image;return t.src=e,t.complete&&0!==t.naturalHeight},g=function(e,t,i){var r=document.createElementNS("http://www.w3.org/2000/svg","svg");return r.setAttribute("width",t),r.setAttribute("height",i),r.innerHTML='\n        <foreignObject\n            x="0"\n            y="0"\n            width="'+t+'"\n            height="'+i+'">\n            <div xmlns="http://www.w3.org/1999/xhtml">\n                '+e+"\n            </div>\n        </foreignObject>\n    ",r},_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png",i=document.createElement("canvas");i.setAttribute("width",2*e.width),i.setAttribute("height",2*e.height);var r=i.getContext("2d");return r.scale(2,2),r.fillStyle="#fff",r.fillRect(0,0,i.width,i.height),r.drawImage(e,0,0),i.toDataURL(t)}},,,function(e,t,i){"use strict";var r=i(8),a=i(0),n=(i.n(a),i(3)),o=i.n(n),s=i(4),u=i(94),l=i(2),c=i(105);i.n(c);t.a=r.a.extend({displayName:"Notification",optionTypes:{parent:l.b.string,class:l.b.string,content:l.b.string,delay:l.b.number},defaultOptions:{parent:".flashmessage-container"},events:{'click [data-action="close"]':"onClickClose"},template:function(){return s.default.getFromMacro("skfb_front/macros/notification","flashmessage",[this.options.class,this.options.content,{safecontent:"True"}])},initialize:function(){r.a.prototype.initialize.apply(this,arguments),this.render(),this.options.delay&&this.close(this.options.delay)},render:function(){this.$el.html(Object(a.result)(this,"template")),o()(this.options.parent).append(this.$el);var e=this.$el.find(".notification");e.addClass("hidden"),Object(a.defer)(e.removeClass.bind(e,"hidden"))},onClickClose:function(e){e&&e.preventDefault&&e.preventDefault(),this.close(0)},close:function(e){e=e||0;var t=this.$el.find(".notification");return setTimeout(function(){t.addClass("hidden"),Object(u.a)(t,function(){this.$el.parent()[0].removeChild(this.el)}.bind(this))}.bind(this),e),this}})},,,function(e,t,i){"use strict";var r=!1,a=function(e){return void 0!==e&&(r=e),r};t.a=a},function(e,t,i){"use strict";var r=i(9),a=function(){this._name=void 0,this._userdata=void 0,this._instanceID=a.getInstanceID()};r.a.createPrototypeObject(a,{cloneType:function(){return new(0,this.constructor)},getInstanceID:function(){return this._instanceID},setName:function(e){this._name=e},getName:function(){return this._name},setUserData:function(e){this._userdata=e},getUserData:function(){return this._userdata}},"osg","Object");var n=0;a.getInstanceID=function(){return n+=1},t.a=a},function(e,t,i){"use strict";var r=i(21),a=function(e){this._data=void 0,this._transpose=!1,this._glCall="",this._cache=void 0,this._name=e,this._type=void 0,this._isMatrix=!1};a.isUniform=function(e){return"object"==typeof e&&window.Object.getPrototypeOf(e)===a.prototype},a.prototype={getName:function(){return this._name},getType:function(){return this._type},apply:function(e,t){this._cache||(this._cache=e[this._glCall]),this._isMatrix?this._cache.call(e,t,this._transpose,this._data):this._cache.call(e,t,this._data)},setInternalArray:function(e){r.a.warn("setInternalArray deprecated, please use getInternalArray instead: "+e.length),this._data=e},getInternalArray:function(){return this._data},setFloat:function(e){this._data[0]=e},setFloat1:function(e){this._data[0]=e[0]},setFloat2:function(e){this._data[0]=e[0],this._data[1]=e[1]},setFloat3:function(e){this._data[0]=e[0],this._data[1]=e[1],this._data[2]=e[2]},setFloat4:function(e){this._data[0]=e[0],this._data[1]=e[1],this._data[2]=e[2],this._data[3]=e[3]},setFloat9:function(e){this._data[0]=e[0],this._data[1]=e[1],this._data[2]=e[2],this._data[3]=e[3],this._data[4]=e[4],this._data[5]=e[5],this._data[6]=e[6],this._data[7]=e[7],this._data[8]=e[8]},setFloat16:function(e){this._data[0]=e[0],this._data[1]=e[1],this._data[2]=e[2],this._data[3]=e[3],this._data[4]=e[4],this._data[5]=e[5],this._data[6]=e[6],this._data[7]=e[7],this._data[8]=e[8],this._data[9]=e[9],this._data[10]=e[10],this._data[11]=e[11],this._data[12]=e[12],this._data[13]=e[13],this._data[14]=e[14],this._data[15]=e[15]}},a.prototype.setVec2=a.prototype.setFloat2,a.prototype.setVec3=a.prototype.setFloat3,a.prototype.setVec4=a.prototype.setFloat4,a.prototype.setMatrix4=a.prototype.setFloat16,a.prototype.setMatrix3=a.prototype.setFloat9,a.prototype.setInt=a.prototype.setFloat,a.prototype.setInt1=a.prototype.setFloat1,a.prototype.setInt2=a.prototype.setFloat2,a.prototype.setInt3=a.prototype.setFloat3,a.prototype.setInt4=a.prototype.setFloat4;var n=function(e,t,i,r,n,o){var s=t&&t.length?e:void 0,u=new a(void 0!==s?t:e);if(u._data=i,void 0!==s)if(s.length)for(var l=0,c=s.length;l<c;++l)u._data[l]=s[l];else u._data[0]=s;return u._glCall=r,u._type=n,u._isMatrix=!!o,u},o=function(e){for(var t=new Float32Array(4*e),i=0;i<t.length;i+=4)t[i]=t[i+3]=1;return t},s=function(e){for(var t=new Float32Array(9*e),i=0;i<t.length;i+=9)t[i]=t[i+4]=t[i+8]=1;return t},u=function(e){for(var t=new Float32Array(16*e),i=0;i<t.length;i+=16)t[i]=t[i+5]=t[i+10]=t[i+15]=1;return t},l=function(e,t,i){return i&&!i.length?i:"string"!=typeof t?(t.length||1)/e:1};a.createFloat1=function(e,t){return n(e,t,new Float32Array(1*l(1,e,t)),"uniform1fv","float")},a.createFloat2=function(e,t){return n(e,t,new Float32Array(2*l(2,e,t)),"uniform2fv","vec2")},a.createFloat3=function(e,t){return n(e,t,new Float32Array(3*l(3,e,t)),"uniform3fv","vec3")},a.createFloat4=function(e,t){return n(e,t,new Float32Array(4*l(4,e,t)),"uniform4fv","vec4")},a.createInt1=function(e,t){return n(e,t,new Int32Array(1*l(1,e,t)),"uniform1iv","int")},a.createInt2=function(e,t){return n(e,t,new Int32Array(2*l(2,e,t)),"uniform2iv","vec2i")},a.createInt3=function(e,t){return n(e,t,new Int32Array(3*l(3,e,t)),"uniform3iv","vec3i")},a.createInt4=function(e,t){return n(e,t,new Int32Array(4*l(4,e,t)),"uniform4iv","vec4i")},a.createMatrix2=function(e,t){return n(e,t,o(l(4,e,t)),"uniformMatrix2fv","mat2",!0)},a.createMatrix3=function(e,t){return n(e,t,s(l(9,e,t)),"uniformMatrix3fv","mat3",!0)},a.createMatrix4=function(e,t){return n(e,t,u(l(16,e,t)),"uniformMatrix4fv","mat4",!0)},a.float=a.createFloatArray=a.createFloat=a.createFloat1,a.vec2=a.createFloat2Array=a.createFloat2,a.vec3=a.createFloat3Array=a.createFloat3,a.vec4=a.createFloat4Array=a.createFloat4,a.int=a.createIntArray=a.createInt=a.createInt1,a.vec2i=a.createInt2Array=a.createInt2,a.vec3i=a.createInt3Array=a.createInt3,a.vec4i=a.createInt4Array=a.createInt4,a.mat2=a.createMat2Array=a.createMat2=a.createMatrix2,a.mat3=a.createMat3Array=a.createMat3=a.createMatrix3,a.mat4=a.createMat4Array=a.createMat4=a.createMatrix4,t.a=a},function(e,t,i){"use strict";function r(e){return String(e).split("").reduce(function(e,t,i,r){var a=r.length-i;return e+(!i||a%3?t:","+t)},"")}function a(e){var t=e/100;if(Object(g.isInteger)(t))return"$"+r(t);var i=String(Math.round(e)).split(""),a=i.filter(function(e,t){return t>=i.length-2});return"$"+r(i.filter(function(e,t){return t<i.length-2}).join("")||"0")+"."+a.join("")}function n(e,t){if(t<=0)return e;var i=Math.pow(10,t),r=e*i;return Math.round(r)/i}function o(e){var t=parseFloat(e),i=[3,6,9,12,15];if(!t)return e;var r=t<0?"-":"",a=Math.abs(t);if(a<1e3)return t;for(var o=0,s=i.length;o<s;++o){var u=n(a/Math.pow(10,i[o]),1);if(u<1e3){var l=Math.floor(u);return u!==l?r+u+_[o]:r+l+_[o]}}return t<0?"1000- P":"1000+ P"}function s(e){var t=Math.pow(Math.abs(e),1/3);return e<0?-t:t}function u(e,t,i){return(i-e)/(t-e)}function l(e,t,i){return i*(t-e)+e}function c(e,t,i){return Math.max(e,Math.min(t,i))}function h(e,t){var i=t||1;return Math.round(e/i)*i}function d(e){return e.reduce(function(t,i){return t+i/e.length},0)}function p(e,t,i){if(!e.length)return null;if(1===e.length)return e[0];var r=i||{},a=function(i){return r[i]=void 0===r[i]?t(e[i]):r[i],r[i]};if(2===e.length)return Math.abs(a(0))<Math.abs(a(1))?e[0]:e[1];var n=Math.floor(e.length/2);return p(a(n)>0?e.slice(0,n+1):e.slice(n),t,r)}function f(e){var t=Math.floor(e),i=Math.floor(e/1024),r=Math.floor(e/1048576),a=Math.floor(e/1073741824);return a?a+"GB":r?r+"MB":i?i+"kB":t+"B"}function m(e,t,i){return e.start===t&&e.end>=i?"Any":e.start===t?"Up to "+o(e.end):e.start>=i?o(e.start)+"+":o(e.start)+" to "+o(e.end)}t.e=r,t.g=a,t.k=o,t.c=s,t.n=u,t.h=l,t.b=c,t.m=h,t.a=d,t.d=p,i.d(t,"i",function(){return v}),i.d(t,"f",function(){return b}),t.j=f,t.l=m;var g=i(0),_=(i.n(g),["k","M","B","T","P"]),v=function(e,t,i,r){return e/t>i/r?{width:e,height:r*e/i}:{width:i*t/r,height:t}},b={linear:function(e){return e},easeInQuad:function(e){return e*e},easeInCubic:function(e){return e*e*e}}},function(e,t,i){"use strict";function r(e){var t={};return u()(e).forEach(function(i){t[i]=Array.isArray(e[i])?e[i]:[e[i]]}),t}function a(e){return"object"===(void 0===e?"undefined":o()(e))?r(e):("?"===e[0]&&(e=e.substr(1)),e.split(/&+/g).reduce(function(e,t){if(0===t.length)return e;var i=t.indexOf("=");-1===i&&(i=t.length);var r=decodeURIComponent(t.substr(0,i).replace(/\+/g,"%20")),a=decodeURIComponent(t.substr(i+1).replace(/\+/g,"%20"));return void 0===e[r]&&(e[r]=[]),e[r].push(a),e},{}))}t.a=a;var n=i(29),o=i.n(n),s=i(20),u=i.n(s)},,function(e,t,i){"use strict";var r=i(102),a=i.n(r),n=i(3),o=i.n(n),s=i(0),u=(i.n(s),i(30)),l=i(103);t.a={name:"WithWindowEvents",constructor:function(){var e=this;this.__withWindowEvents={listeners:[]},this.events=Object(u.c)(this.events,function(t,i){var r=Object(l.b)(i);if("window"!==r.selector)return a()({},i,t);if("string"==typeof t&&!e[t])throw new Error("WithWindowEvents error: "+e.displayName+"."+t+" is not defined.");return e.__withWindowEvents.listeners.push({eventName:r.eventName,callback:function(){for(var i,r=arguments.length,a=Array(r),n=0;n<r;n++)a[n]=arguments[n];return Object(s.isFunction)(t)?t.call.apply(t,[e].concat(a)):(i=e[t]).call.apply(i,[e].concat(a))}}),{}})},delegateEvents:function(){this.__withWindowEvents.listeners.forEach(function(e){o()(window).on(e.eventName,e.callback)})},undelegateEvents:function(){this.__withWindowEvents.listeners.forEach(function(e){o()(window).off(e.eventName,e.callback)})},beforeRemove:function(){this.__withWindowEvents.listeners.forEach(function(e){o()(window).off(e.eventName,e.callback)})}}},,function(e,t,i){"use strict";var r={};r.SCENE="scene",r.MANIPULATORS="scene.manipulators",r.ORBIT_MANIPULATOR="scene.manipulators.orbit",r.ORBIT_MANIPULATOR_MOUSEKEYBOARD="scene.manipulators.orbit.mousekeyboard",r.ORBIT_MANIPULATOR_RESETTOHOME="scene.manipulators.orbit.mousekeyboard.home",r.ORBIT_MANIPULATOR_TOUCH="scene.manipulators.orbit.touch",r.ORBIT_MANIPULATOR_WEBVR="scene.manipulators.orbit.webvr",r.ORBIT_MANIPULATOR_DEVICEORIENTATION="scene.manipulators.orbit.deviceorientation",r.ORBIT_MANIPULATOR_GAMEPAD="scene.manipulators.orbit.gamepad",r.FPS_MANIPULATOR="scene.manipulators.fps",r.FPS_MANIPULATOR_MOUSEKEYBOARD="scene.manipulators.fps.mousekeyboard",r.FPS_MANIPULATOR_RESETTOHOME="scene.manipulators.fps.mousekeyboard.home",r.FPS_MANIPULATOR_TOUCH="scene.manipulators.fps.touch",r.FPS_MANIPULATOR_WEBVR="scene.manipulators.fps.webvr",r.FPS_MANIPULATOR_DEVICEORIENTATION="scene.manipulators.fps.deviceorientation",r.FPS_MANIPULATOR_GAMEPAD="scene.manipulators.fps.gamepad",r.CAD_MANIPULATOR="scene.manipulators.cad",r.CAD_MANIPULATOR_MOUSEKEYBOARD="scene.manipulators.cad.mousekeyboard",r.CAD_MANIPULATOR_RESETTOHOME="scene.manipulators.cad.mousekeyboard.home",r.CAD_MANIPULATOR_TOUCH="scene.manipulators.cad.touch",r.NODE_GIZMO="scene.nodegizmo",r.UI="ui",r.STATS="ui.stats",t.a=r},function(e,t,i){"use strict";var r,a,n=i(5),o=i(1152),s=i(83),u=n.a.osg,l=0,c=new s.a,h={BIAS_MIN:.9,BIAS_MAX:1.1,getBoxReady:function(){return c.promise},updateMaxWorldDisplacement:function(e){e<=l||(l=e,this._updateModelBoxes())},getModelBoxWithDisplacement:function(){return r},getModelBoxWithoutDisplacement:function(){return a},_updateModelBoxes:function(){if(r){var e=r.getMin(),t=r.getMax(),i=u.vec3.fromValues(l,l,l);u.vec3.add(t,t,i),u.vec3.sub(e,e,i)}},computePreciseBox:function(e){var t=new o.a;e.accept(t),a=t.getPreciseBox(),r=new u.BoundingBox,r.copy(a),this._updateModelBoxes(),c.resolve()},getMaxDistanceFromOrigin:function(){var e=u.vec3.length(a.getMin()),t=u.vec3.length(a.getMax());return Math.max(e,t)}};t.a=h},,function(e,t,i){"use strict";var r=i(20),a=i.n(r),n=i(0),o=(i.n(n),window.prefetchedData);t.a={get:function(e){return o[e]},register:function(e,t){o[e]=t},invalidate:function(e){var t=e.replace(/\?.*$/,"");a()(o).forEach(function(e){var i=e.replace(/\?.*$/,"");t!==i&&0!==t.indexOf(i+"/")||(o[e]=void 0)})},update:function(e,t){Object(n.each)(o[e],function(i,r){void 0!==t[r]&&(o[e][r]=t[r])})}}},,function(e,t,i){"use strict";function r(){var e={},t=new n.a(function(t,i){e.resolve=t,e.reject=i});return t.resolve=e.resolve,t.reject=e.reject,t.promise=t,t}t.a=r;var a=i(7),n=i.n(a)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(21),a=i(9),n=i(58),o=i(72),s=i(449),u=i(397),l=i(1016),c=i(246),h=window.ImageBitmap||function(){},d=function(e){return 0!==e&&(e&1+~e)===e},p=function(){n.a.call(this),u.a.call(this),this.setDefaultParameters(),this._dirty=!0,this._dirtyMipmap=!0,this._applyTexImage2DCallbacks=[],this._textureObject=void 0,this._textureNull=!0},f=function(e,t){var i=p[e];return void 0===i?(r.a.warn("bad Texture enum argument "+e+"\nfallback to "+t),t):i};p.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,p.UNPACK_FLIP_Y_WEBGL=37440,p.BROWSER_DEFAULT_WEBGL=37444,p.NONE=0,p.DEPTH_COMPONENT=6402,p.DEPTH_COMPONENT16=33189,p.DEPTH_STENCIL=34041,p.DEPTH24_STENCIL8=35056,p.DEPTH_COMPONENT24=33190,p.DEPTH_COMPONENT32F=36012,p.COMPRESSED_RGB_S3TC_DXT1_EXT=33776,p.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777,p.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778,p.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779,p.COMPRESSED_RGB_ATC_WEBGL=35986,p.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987,p.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798,p.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840,p.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841,p.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842,p.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843,p.COMPRESSED_RGB_ETC1_WEBGL=36196,p.LINEAR=9729,p.NEAREST=9728,p.NEAREST_MIPMAP_NEAREST=9984,p.LINEAR_MIPMAP_NEAREST=9985,p.NEAREST_MIPMAP_LINEAR=9986,p.LINEAR_MIPMAP_LINEAR=9987,p.TEXTURE_MAX_ANISOTROPY_EXT=34046,p.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047,p.CLAMP_TO_EDGE=33071,p.REPEAT=10497,p.MIRRORED_REPEAT=33648,p.TEXTURE_2D=3553,p.TEXTURE_CUBE_MAP=34067,p.TEXTURE_BINDING_CUBE_MAP=34068,p.TEXTURE_CUBE_MAP_POSITIVE_X=34069,p.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,p.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,p.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,p.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,p.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,p.MAX_CUBE_MAP_TEXTURE_SIZE=34076,p.UNSIGNED_BYTE=5121,p.UNSIGNED_SHORT=5123,p.UNSIGNED_SHORT_4_4_4_4=32819,p.UNSIGNED_SHORT_5_5_5_1=32820,p.UNSIGNED_SHORT_5_6_5=33635,p.FLOAT=5126,p.HALF_FLOAT_OES=36193,p.HALF_FLOAT=5131,p.UNSIGNED_INT_10F_11F_11F_REV=35899,p.UNSIGNED_INT_24_8=34042,p.ALPHA=6406,p.RGB=6407,p.RGBA=6408,p.LUMINANCE=6409,p.LUMINANCE_ALPHA=6410,p.RED_INTEGER=36244,p.RGB_INTEGER=36248,p.RGBA_INTEGER=36249,p.RG_INTEGER=33320,p.RED=6403,p.R8=33321,p.R8UI=33330,p.RG8=33323,p.RG8UI=33336,p.RGB8=36758,p.RGB565=36194,p.RGB9_E5=35901,p.RGB8UI=36221,p.RGBA8=32856,p.RGB5_A1=32855,p.RGBA4=32854,p.RGBA8UI=36220,p.SRGB8_ALPHA8=35907,p.SRGB8=35905,p.R16F=33325,p.RG16F=33327,p.RGB16F=34843,p.RGBA16F=34842,p.R11F_G11F_B10F=35898,p.R32F=33326,p.RG32F=33328,p.RGB32F=34837,p.RGBA32F=34836;var m=function(){var e={};return e[p.R8]=p.LUMINANCE,e[p.R8UI]=p.LUMINANCE,e[p.R16F]=p.LUMINANCE,e[p.R32F]=p.LUMINANCE,e[p.SRGB8]=p.LUMINANCE,e[p.RG8]=p.RGB,e[p.RG8UI]=p.RGB,e[p.RG16F]=p.RGB,e[p.RG32F]=p.RGB,e[p.RGB8]=p.RGB,e[p.RGB565]=p.RGB,e[p.RGB9_E5]=p.RGB,e[p.RGB8UI]=p.RGB,e[p.RGB5_A1]=p.RGB,e[p.RGB16F]=p.RGB,e[p.RGB32F]=p.RGB,e[p.RGBA8]=p.RGBA,e[p.R11F_G11F_B10F]=p.RGBA,e[p.RGBA16F]=p.RGBA,e[p.RGBA32F]=p.RGBA,e[p.SRGB8_ALPHA8]=p.RGBA,e}(),g=function(){var e={},t={},i={},r={},a={},n={};return e[p.FLOAT]=t,e[p.HALF_FLOAT]=e[p.HALF_FLOAT_OES]=i,e[p.UNSIGNED_SHORT]=r,e[p.UNSIGNED_INT]=a,e[p.UNSIGNED_INT_24_8]=n,i[p.LUMINANCE]=p.R16F,i[p.RGB]=p.RGB16F,i[p.RGBA]=p.RGBA16F,t[p.LUMINANCE]=p.R32F,t[p.RGB]=p.RGB32F,t[p.RGBA]=p.RGBA32F,r[p.DEPTH_COMPONENT]=p.DEPTH_COMPONENT16,a[p.DEPTH_COMPONENT]=p.DEPTH_COMPONENT32F,n[p.DEPTH_STENCIL]=p.DEPTH24_STENCIL8,e}();p._sTextureManager=new window.Map,p.getTextureManager=function(e){return p._sTextureManager.has(e)||p._sTextureManager.set(e,new l.a),p._sTextureManager.get(e)},p.getEnumFromString=function(e){var t=e;return"string"==typeof t&&(t=f(t,e)),t},a.a.createPrototypeStateAttribute(p,a.a.objectInherit(u.a.prototype,a.a.objectInherit(n.a.prototype,{attributeType:"Texture",cloneType:function(){return new p},invalidate:function(){this._textureObject=void 0,this.dirty()},dirty:function(){this._dirty=!0},isDirty:function(){return this._dirty},isTextureNull:function(){return this._textureNull},getOrCreateUniforms:function(e){if(void 0===p.uniforms&&(p.uniforms=[]),void 0===p.uniforms[e]){var t=this.getType()+e;p.uniforms[e]={texture:o.a.createInt1(e,t)}}return p.uniforms[e]},setDefaultParameters:function(){this._image=void 0,this._magFilter=p.LINEAR,this._minFilter=p.LINEAR,this._maxAnisotropy=1,this._wrapS=p.CLAMP_TO_EDGE,this._wrapT=p.CLAMP_TO_EDGE,this._textureWidth=0,this._textureHeight=0,this._unrefImageDataAfterApply=!1,this._internalFormat=void 0,this._dirtyMipmap=!0,this._textureTarget=p.TEXTURE_2D,this.setInternalFormatType(p.UNSIGNED_BYTE),this._isCompressed=!1,this._flipY=!0,this._colorSpaceConversion=p.NONE},setColorSpaceConversion:function(e){this._colorSpaceConversion=e},setFlipY:function(e){this._flipY=e},getTextureTarget:function(){return this._textureTarget},getTextureObject:function(){return this._textureObject},setTextureSize:function(e,t){var i=c.a.instance().getWebGLParameter("MAX_TEXTURE_SIZE");e===this._textureWidth&&t===this._textureHeight||this.dirty(),void 0!==e&&(e>i?(r.a.error("width ("+e+') too big for GPU. Max Texture Size is "'+i+'"'),this._textureWidth=i):this._textureWidth=e),void 0!==t&&(t>i?(r.a.error("height ("+t+') too big for GPU. Max Texture Size is "'+i+'"'),this._textureHeight=i):this._textureHeight=t),this._textureNull=!1},init:function(e){this._gl||this.setGraphicContext(e.getGraphicContext()),this._textureObject||(this._textureObject=p.getTextureManager(this._gl).generateTextureObject(this._gl,this,this._textureTarget,this._internalFormat,this._textureWidth,this._textureHeight),this.dirty(),this._dirtyTextureObject=!1,this._textureNull=!1)},addApplyTexImage2DCallback:function(e){this._applyTexImage2DCallbacks.indexOf(e)<0&&this._applyTexImage2DCallbacks.push(e)},removeApplyTexImage2DCallback:function(e){var t=this._applyTexImage2DCallbacks.indexOf(e);t>=0&&this._applyTexImage2DCallbacks.splice(t,1)},getWidth:function(){return this._textureWidth},getHeight:function(){return this._textureHeight},releaseGLObjects:function(){void 0!==this._textureObject&&null!==this._textureObject&&void 0!==this._gl&&(p.getTextureManager(this._gl).releaseTextureObject(this._textureObject),u.a.removeObject(this._gl,this)),this.invalidate()},getWrapT:function(){return this._wrapT},getWrapS:function(){return this._wrapS},setWrapS:function(e){this._wrapS="string"==typeof e?f(e,p.CLAMP_TO_EDGE):e,this.dirtyTextureParameters()},setWrapT:function(e){this._wrapT="string"==typeof e?f(e,p.CLAMP_TO_EDGE):e,this.dirtyTextureParameters()},dirtyTextureParameters:function(){this.dirty(),this.dirtyMipmap(),this.dirtyTextureObject()},dirtyTextureObject:function(){this._dirtyTextureObject=!0,this.dirtyMipmap(),this.dirty()},getMinFilter:function(){return this._minFilter},getMagFilter:function(){return this._magFilter},setMaxAnisotropy:function(e){this._maxAnisotropy=e,this.dirtyTextureParameters()},getMaxAnisotropy:function(){return this._maxAnisotropy},setMinFilter:function(e){this._minFilter="string"==typeof e?f(e,p.LINEAR):e,this.dirtyTextureParameters()},setMagFilter:function(e){this._magFilter="string"==typeof e?f(e,p.LINEAR):e,this.dirtyTextureParameters()},setImage:function(e,t){var i=e;(e instanceof window.Image||e instanceof HTMLCanvasElement||e instanceof h||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Float32Array)&&(i=new s.a(e)),this._image=i,this.setImageFormat(t),i&&(i.getWidth&&i.getHeight?this.setTextureSize(i.getWidth(),i.getHeight()):i.width&&i.height&&this.setTextureSize(i.width,i.height)),this._textureNull=!1,this.dirty()},getImage:function(){return this._image},setImageFormat:function(e){var t=e;t?("string"==typeof t&&(t=p[t]),this._imageFormat=t):this._imageFormat=p.RGBA},setInternalFormatType:function(e){this._type="string"==typeof e?p[e]:e},getInternalFormatType:function(){return this._type},setUnrefImageDataAfterApply:function(e){this._unrefImageDataAfterApply=e},checkIsCompressed:function(e){switch(e||this._internalFormat){case p.COMPRESSED_RGB_S3TC_DXT1_EXT:case p.COMPRESSED_RGBA_S3TC_DXT1_EXT:case p.COMPRESSED_RGBA_S3TC_DXT3_EXT:case p.COMPRESSED_RGBA_S3TC_DXT5_EXT:case p.COMPRESSED_RGB_ATC_WEBGL:case p.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:case p.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:case p.COMPRESSED_RGB_PVRTC_4BPPV1_IMG:case p.COMPRESSED_RGB_PVRTC_2BPPV1_IMG:case p.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:case p.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:case p.COMPRESSED_RGB_ETC1_WEBGL:return!0;default:return!1}},setInternalFormat:function(e){var t=e;t?("string"==typeof t&&(t=p[t]),this._isCompressed=this.checkIsCompressed(t)):(this._isCompressed=!1,t=p.RGBA),this._internalFormat=t},getInternalFormat:function(){return this._internalFormat},isDirtyMipmap:function(){return this._dirtyMipmap},dirtyMipmap:function(){this._dirtyMipmap=!0},applyFilterParameter:function(e,t){if(d(this._textureWidth)&&d(this._textureHeight)||(this._wrapT=p.CLAMP_TO_EDGE,this._wrapS=p.CLAMP_TO_EDGE,this._minFilter!==p.LINEAR_MIPMAP_LINEAR&&this._minFilter!==p.LINEAR_MIPMAP_NEAREST||(this._minFilter=p.LINEAR)),e.texParameteri(t,e.TEXTURE_MAG_FILTER,this._magFilter),e.texParameteri(t,e.TEXTURE_MIN_FILTER,this._minFilter),this._maxAnisotropy>1&&p.ANISOTROPIC_SUPPORT_EXT){var i=this._maxAnisotropy<p.ANISOTROPIC_SUPPORT_MAX?this._maxAnisotropy:p.ANISOTROPIC_SUPPORT_MAX;e.texParameterf(t,p.TEXTURE_MAX_ANISOTROPY_EXT,i)}e.texParameteri(t,e.TEXTURE_WRAP_S,this._wrapS),e.texParameteri(t,e.TEXTURE_WRAP_T,this._wrapT)},generateMipmap:function(e,t){if(this._dirtyMipmap=!1,this.hasMipmapFilter()){var i=this._image;if(i&&i.hasMipmap())for(var r=this._getInternalFormatGL(),a=i.getMipmap(),n=1,o=a.length;n<o;n++){var s=a[n];this._isCompressed?this.applyTexImage2D(e,this._textureTarget,n,r,s.getWidth(),s.getHeight(),0,s.getImage()):this.applyTexImage2D(e,this._textureTarget,n,r,s.getWidth(),s.getHeight(),0,this._internalFormat,this._type,s.getImage())}else e.generateMipmap(t)}},hasMipmapFilter:function(){return this._minFilter===p.NEAREST_MIPMAP_NEAREST||this._minFilter===p.LINEAR_MIPMAP_NEAREST||this._minFilter===p.NEAREST_MIPMAP_LINEAR||this._minFilter===p.LINEAR_MIPMAP_LINEAR},applyTexImage2D:function(e){var t=Array.prototype.slice.call(arguments,1);e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,this._flipY),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._colorSpaceConversion),this._isCompressed?e.compressedTexImage2D.apply(e,t):e.texImage2D.apply(e,t);var i=this._applyTexImage2DCallbacks.length;if(i>0)for(var r=0,a=i;r<a;r++)this._applyTexImage2DCallbacks[r].call(this)},computeTextureFormat:function(){this._internalFormat?this._imageFormat=this._internalFormat:(this._internalFormat=this._imageFormat||p.RGBA,this._imageFormat=this._internalFormat)},applyImage:function(e){var t=this._getInternalFormatGL(),i=this._image||null,r=i&&this._image.getImage(),a=this._getTypeGL();this._isCompressed?this.applyTexImage2D(e,this._textureTarget,0,t,this._textureWidth,this._textureHeight,0,r):!r||i.isTypedArray()?this.applyTexImage2D(e,this._textureTarget,0,t,this._textureWidth,this._textureHeight,0,this._internalFormat,a,r):this.applyTexImage2D(e,this._textureTarget,0,t,this._internalFormat,a,r),i&&i.setDirty(!1)},apply:function(e){var t=e.getGraphicContext();if(this._dirtyTextureObject&&(this.releaseGLObjects(),this._dirtyTextureObject=!1,this.setGraphicContext(t)),void 0===this._textureObject||this.isDirty())if(this._textureNull)t.bindTexture(this._textureTarget,null);else{var i=this._image;if(void 0!==i)if(i.isReady()){this.computeTextureFormat();var r=i.getWidth()||this._textureWidth,a=i.getHeight()||this._textureHeight;this.setTextureSize(r,a),this._textureObject||this.init(e),this._textureObject.bind(t),this.applyImage(t),this.applyFilterParameter(t,this._textureTarget),this.generateMipmap(t,this._textureTarget),this._unrefImageDataAfterApply&&(this._image=void 0),this._dirty=!1}else t.bindTexture(this._textureTarget,null);else 0!==this._textureHeight&&0!==this._textureWidth&&(this.computeTextureFormat(),this._textureObject||this.init(e),this._textureObject.bind(t),this.applyImage(t),this.applyFilterParameter(t,this._textureTarget),this.generateMipmap(t,this._textureTarget),this._dirty=!1)}else this._textureObject.bind(t),this.isDirtyMipmap()&&this.generateMipmap(t,this._textureTarget),void 0!==this._image&&this._image.isDirty()&&this.applyImage(t)},_getInternalFormatGL:function(){var e=this._internalFormat;if(!c.a.instance().isWebGL2())return m[e]||e;var t=g[this._type];return t&&t[e]||e},_getTypeGL:function(){return this._type!==p.HALF_FLOAT||c.a.instance().isWebGL2()?this._type:p.HALF_FLOAT_OES}})),"osg","Texture"),p.textureNull=new p,p.createFromImage=function(e,t){var i=new p;return i.setImage(e,t),i},p.createFromCanvas=function(e,t){return p.createFromImage(e,t)},t.default=p},,function(e,t,i){"use strict";i.d(t,"b",function(){return u});var r=i(242),a=i.n(r),n=i(0),o=(i.n(n),i(466)),s=i.n(o),u=a()("instanceKey"),l=function(e){var t=e[u];return!t||t.shouldUpdate};t.a={name:"WithTemplate",template:function(){return""},renderDiff:function(e){var t=this.el.cloneNode();t.innerHTML=e,s()(this.el,t,{onBeforeElUpdated:l,onBeforeElChildrenUpdated:l,childrenOnly:!0})},render:function(){this.renderDiff(Object(n.result)(this,"template"))}}},function(e,t,i){"use strict";function r(e,t,i){var o=Object(a.extend)({interval:1e3,prevInterval:1e3},Object(n.a)(i));return t().catch(function(i){var n="function"==typeof o.interval?o.interval(o.prevInterval):o.interval;return e>0?s.a.delay(n).then(function(){return r(e-1,t,Object(a.extend)({},o,{prevInterval:n}))}):s.a.reject(i)})}t.c=r,i.d(t,"b",function(){return l}),i.d(t,"a",function(){return c});var a=i(0),n=(i.n(a),i(30)),o=i(7),s=i.n(o),u=i(25),l=function(e){var t=void 0;return function(){return t||(t=e.apply(void 0,arguments),t.then(function(e){return t=void 0,e}).catch(function(e){throw t=void 0,e}))}},c=function(e){var t=void 0,i=new s.a(function(i,r){t=r,e.then(i).catch(r)});return i.cancel=function(){return t(new u.a)},i}},,,function(e,t,i){"use strict";function r(e){return d.a.planLabels[e]}function a(e,t){if(e.isStaff)return!0;var i=d.a.proPlanTypes.indexOf(t);return-1!==i&&-1!==d.a.proPlanTypes.slice(i).indexOf(e.account)}function n(e){return"free"===e}function o(e){var t=["free"].concat(d.a.proPlanTypes);return t[t.indexOf(e)+1]}function s(e){return d.a.planLabels[o(e)]||null}function u(e){return d.a.maxSoundtracksPerModel[e]===f}function l(e){return d.a.maxSoundtracksPerModel[e]===m}function c(e){return e>g}function h(e){if("ent"===e.account)return!1;if("free"===e.account)return!0;var t=e.privateLimit.count;return null!==t&&(0===t||t<=.25*d.a.plansPrivateModelLimit[e.account])}t.h=r,t.f=a,t.c=n,t.d=o,t.e=s,t.b=u,t.a=l,t.g=c,t.i=h;var d=i(17),p=i(0),f=(i.n(p),Object(p.max)(Object(p.values)(d.a.maxSoundtracksPerModel))),m=Object(p.max)(Object(p.values)(d.a.maxSoundtracksPerModel)),g=Object(p.max)(Object(p.values)(d.a.maxModelFilesizes))},,,function(e,t,i){"use strict";var r=i(12),a=new r.a;a.PBR_LIT=1,a.CLASSIC_LIT=2,a.PBR_SHADELESS=4,a.CLASSIC_SHADELESS=8,a.MATCAP=16,a.INSPECTOR=32,a.nameMatch={"shadeless-pbr":a.PBR_SHADELESS,"shadeless-classic":a.CLASSIC_SHADELESS,"lit-pbr":a.PBR_LIT,"lit-classic":a.CLASSIC_LIT,"shading-ar":a.PBR_LIT,"shading-vr":a.PBR_LIT,inspector:a.INSPECTOR},a.LIT=a.PBR_LIT|a.CLASSIC_LIT,a.SHADELESS=a.PBR_SHADELESS|a.CLASSIC_SHADELESS,a.PBR=a.PBR_LIT|a.PBR_SHADELESS,a.CLASSIC=a.CLASSIC_LIT|a.CLASSIC_SHADELESS,a.set("mask",a.PBR_LIT),a.set("hasSsr",!1),a.on("change:mask",function(){var e=a.get("mask");switch(e){case a.PBR_LIT:case a.CLASSIC_LIT:case a.PBR_SHADELESS:case a.CLASSIC_SHADELESS:case a.INSPECTOR:case a.MATCAP:break;default:console.error("Invalid ShadingGlobal mask value !"+e)}}),t.a=a},function(e,t,i){"use strict";var r=i(3),a=i.n(r),n=i(0),o=(i.n(n),Object(n.find)({WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},function(e,t){return t in document.body.style}));t.a=function(e,t){setTimeout(function(){a()(e).one(o,t)})}},,,,function(e,t,i){"use strict";var r=i(9),a=i(71),n=i(215),o=i(448),s=i(182),u=i(54),l=i(10),c=i(216),h=i(543),d=i(127),p=function(){a.a.call(this),this.children=[],this._parents=[],this.nodeMask=-1,this._boundingSphere=new o.a,this._boundingSphereComputed=!1,this._boundingBox=new n.a,this._boundingBoxComputed=!1,this._updateCallbacks=[],this._cullCallback=void 0,this._cullingActive=!0,this._numChildrenWithCullingDisabled=0,this._numChildrenRequiringUpdateTraversal=0,this._tmpBox=new n.a},f=new c.a(l.c.create),m=function(){var e=f.getOrCreateObject();return l.c.identity(e)};r.a.createPrototypeNode(p,r.a.objectInherit(a.a.prototype,{getOrCreateStateSet:function(){return this.stateset||this.setStateSet(new s.a),this.stateset},getStateSet:function(){return this.stateset},accept:function(e){e.validNodeMask(this)&&(e.pushOntoNodePath(this),e.apply(this),e.popFromNodePath())},dirtyBound:function(){if(!0===this._boundingSphereComputed||!0===this._boundingBoxComputed){this._boundingSphereComputed=!1,this._boundingBoxComputed=!1;for(var e=this._parents,t=0,i=e.length;t<i;t++)e[t].dirtyBound()}},setNodeMask:function(e){this.nodeMask=e},getNodeMask:function(){return this.nodeMask},setStateSet:function(e){if(this.stateset!==e){var t=0;this.stateset&&(this.stateset.requiresUpdateTraversal()&&t--,this.stateset.removeParent(this)),e&&(e.addParent(this),e.requiresUpdateTraversal()&&++t),0!==t&&this.setNumChildrenRequiringUpdateTraversal(this.getNumChildrenRequiringUpdateTraversal()+t),this.stateset=e}},_updateNumChildrenRequeringUpdateTraversal:function(e){if(0===this._numChildrenRequiringUpdateTraversal&&this._parents.length)for(var t=0,i=this._parents.length;t<i;t++){var r=this._parents[t],a=r.getNumChildrenRequiringUpdateTraversal();r.setNumChildrenRequiringUpdateTraversal(a+e)}},setNumChildrenRequiringUpdateTraversal:function(e){if(this._numChildrenRequiringUpdateTraversal!==e){if(!this._updateCallbacks.length&&this._parents.length){var t=0;if(this._numChildrenRequiringUpdateTraversal>0&&--t,e>0&&++t,0!==t)for(var i=this._parents,r=0,a=i.length;r<a;r++){var n=i[r],o=n.getNumChildrenRequiringUpdateTraversal();n.setNumChildrenRequiringUpdateTraversal(o+t)}}this._numChildrenRequiringUpdateTraversal=e}},getNumChildrenRequiringUpdateTraversal:function(){return this._numChildrenRequiringUpdateTraversal},getUpdateCallback:function(){return this._updateCallbacks[0]},addUpdateCallback:function(e){var t=Boolean(this._updateCallbacks.length);this._updateCallbacks.push(e),t||this._updateNumChildrenRequeringUpdateTraversal(1)},removeUpdateCallback:function(e){var t=this._updateCallbacks.indexOf(e);-1!==t&&(this._updateCallbacks.splice(t,1),this._updateCallbacks.length||this._updateNumChildrenRequeringUpdateTraversal(-1))},getUpdateCallbackList:function(){return this._updateCallbacks},setCullCallback:function(e){this._cullCallback=e},getCullCallback:function(){return this._cullCallback},hasChild:function(e){for(var t=0,i=this.children.length;t<i;t++)if(this.children[t]===e)return!0;return!1},addChild:function(e){if(-1===this.children.indexOf(e))return this.children.push(e),e.addParent(this),this.dirtyBound(),(e.getNumChildrenRequiringUpdateTraversal()>0||e.getUpdateCallbackList().length)&&this.setNumChildrenRequiringUpdateTraversal(this.getNumChildrenRequiringUpdateTraversal()+1),(e.getNumChildrenWithCullingDisabled()>0||!1===e.getCullingActive())&&this.setNumChildrenWithCullingDisabled(this.getNumChildrenWithCullingDisabled()+1),e},getChildren:function(){return this.children},getNumChildren:function(){return this.children.length},getChild:function(e){return this.children[e]},getParents:function(){return this._parents},addParent:function(e){this._parents.push(e)},removeParent:function(e){var t=this._parents.indexOf(e);-1!==t&&this._parents.splice(t,1)},removeChildren:function(){var e=this.children,t=e.length;if(t){for(var i=0,r=0;r<t;r++){var a=e[r];a.removeParent(this),(a.getNumChildrenRequiringUpdateTraversal()>0||a.getUpdateCallbackList().length)&&++i}e.length=0,i&&this.setNumChildrenRequiringUpdateTraversal(this.getNumChildrenRequiringUpdateTraversal()-i),this.dirtyBound()}},removeChild:function(e){var t=this.children,i=t.indexOf(e);-1!==i&&(e.removeParent(this),t.splice(i,1),this.dirtyBound(),(e.getNumChildrenRequiringUpdateTraversal()>0||e.getUpdateCallbackList().length)&&this.setNumChildrenRequiringUpdateTraversal(this.getNumChildrenRequiringUpdateTraversal()-1))},traverse:function(e){for(var t=this.children,i=0,r=t.length;i<r;i++){t[i].accept(e)}},ascend:function(e){for(var t=this._parents,i=0,r=t.length;i<r;i++){t[i].accept(e)}},getBoundingBox:function(){return this._boundingBoxComputed||(this.computeBoundingBox(this._boundingBox),this._boundingBoxComputed=!0),this._boundingBox},computeBoundingBox:function(e){var t=i(584).default,r=t.instance=t.instance||new t;return r.setNodeMaskOverride(-1),r.reset(),r.apply(this),e.copy(r.getBoundingBox()),e},getBoundingSphere:function(){return this.getBound()},getBound:function(){return this._boundingSphereComputed||(this.computeBoundingSphere(this._boundingSphere),this._boundingSphereComputed=!0),this._boundingSphere},computeBoundingSphere:function(e){var t=this.children,i=t.length;if(e.init(),0===i)return e;var r,a,n=this._tmpBox;for(n.init(),a=0;a<i;a++)r=t[a],r.referenceFrame!==d.a.ABSOLUTE_RF&&n.expandByBoundingSphere(r.getBound());if(!n.valid())return e;for(e.set(n.center(e.center()),0),a=0;a<i;a++)r=t[a],r.referenceFrame!==d.a.ABSOLUTE_RF&&e.expandRadiusBySphere(r.getBound());return e},getWorldMatrices:function(){var e=function(){this.nodePaths=[],this.halt=void 0,u.a.call(this,u.a.TRAVERSE_PARENTS)};e.prototype=r.a.objectInherit(u.a.prototype,{reset:function(){this.nodePath.length=0,this.nodePaths.length=0},apply:function(e){0===e._parents.length||e===this.halt||e.referenceFrame===d.a.ABSOLUTE_RF?this.nodePaths.push(this.nodePath.slice(0)):this.traverse(e)}});var t=new e;return t.setNodeMaskOverride(-1),function(e,i){t.reset(),t.halt=e,this.accept(t);for(var r=[],a=i||l.c.create,n=0,o=t.nodePaths.length;n<o;n++){var s=t.nodePaths[n],u=a();0!==s.length&&h.a.computeLocalToWorld(s,!0,u),r.push(u)}return r}}(),getWorldMatrix:function(e,t){var i=this.getWorldMatrices(e,m);return 0===i.length?l.c.identity(t):l.c.copy(t,i[0]),f.reset(),t},setCullingActive:function(e){if(this._cullingActive!==e){if(0===this._numChildrenWithCullingDisabled&&this._parents.length>0){var t=0;if(this._cullingActive||--t,e||++t,0!==t)for(var i=0,r=this._parents.length;i<r;i++)this._parents[i].setNumChildrenWithCullingDisabled(this._parents[i].getNumChildrenWithCullingDisabled()+t)}this._cullingActive=e}},getCullingActive:function(){return this._cullingActive},isCullingActive:function(){return 0===this._numChildrenWithCullingDisabled&&this._cullingActive&&this.getBound().valid()},setNumChildrenWithCullingDisabled:function(e){if(this._numChildrenWithCullingDisabled!==e){if(this._cullingActive&&this._parents.length>0){var t=0;if(this._numChildrenWithCullingDisabled>0&&--t,e>0&&++t,0!==t)for(var i=0,r=this._parents.length;i<r;i++)this._parents[i].setNumChildrenWithCullingDisabled(this._parents[i].getNumChildrenWithCullingDisabled()+t)}this._numChildrenWithCullingDisabled=e}},getNumChildrenWithCullingDisabled:function(){return this._numChildrenWithCullingDisabled},releaseGLObjects:function(){void 0!==this.stateset&&this.stateset.releaseGLObjects()}}),"osg","Node"),t.a=p},function(e,t,i){"use strict";var r={};r.POINTS=0,r.LINES=1,r.LINE_LOOP=2,r.LINE_STRIP=3,r.TRIANGLES=4,r.TRIANGLE_STRIP=5,r.TRIANGLE_FAN=6,t.a=r},function(e,t,i){"use strict";function r(e,t){var i,r={},a=e?" "+e:"";return r["wheel"+a]=function(e){var t=-.25*e.originalEvent.wheelDelta;t&&(e.preventDefault(),n()(e.currentTarget).scrollTop(t+n()(e.currentTarget).scrollTop()))},r["touchstart"+a]=function(e){i=e.originalEvent.touches[0].pageY},r["touchmove"+a]=function(e){e.preventDefault();var t=i-e.originalEvent.touches[0].pageY;i=e.originalEvent.touches[0].pageY,n()(e.currentTarget).scrollTop(t+n()(e.currentTarget).scrollTop())},Object(o.extend)({},t,r)}var a=i(3),n=i.n(a),o=i(0);i.n(o);t.a=function(e){return{name:"PreventPageScroll",constructor:function(){this.events=r(e,this.events)}}}},,,function(e,t,i){"use strict";function r(e){return e.preventDefault(),e}function a(e){return e.stopPropagation(),e}function n(e){return{eventName:e.split(" ")[0],selector:e.split(" ").slice(1).join(" ")}}function o(e){return{x:e.type.match(/^touch/)?e.originalEvent.changedTouches[0]?e.originalEvent.changedTouches[0].pageX:0:e.clientX,y:e.type.match(/^touch/)?e.originalEvent.changedTouches[0]?e.originalEvent.changedTouches[0].pageY:0:e.clientY}}t.c=r,t.d=a,t.b=n,t.a=o},,function(e,t){!function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/notification.jinja"]=function(){function e(e,t,i,r,a){var n="";try{var o=null;n+="\n\n";var s=r.makeMacro(["type","content"],["options"],function(a,n,o){var s=i;i=new r.Frame,o=o||{},o.hasOwnProperty("caller")&&i.set("caller",o.caller),i.set("type",a),i.set("content",n),i.set("options",o.hasOwnProperty("options")?o.options:{});var u="";u+="\n\n    ";var l;return l=e.getFilter("merge").call(t,{safecontent:!1},r.contextOrFrameLookup(t,i,"options")),i.set("options",l,!0),i.topLevel&&t.setVariable("options",l),i.topLevel&&t.addExport("options",l),u+='\n\n    <div class="flashmessage notification ',u+=r.suppressValue(a,e.opts.autoescape),u+='">\n        <div class="inner">\n            <button class="flashmessage-close" data-action="close" title="Close"></button>\n            <div class="message">\n                ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"safecontent")?(u+="\n                    ",u+=r.suppressValue(e.getFilter("safe").call(t,n),e.opts.autoescape),u+="\n                "):(u+="\n                    ",u+=r.suppressValue(n,e.opts.autoescape),u+="\n                "),u+="\n            </div>\n        </div>\n    </div>\n\n",i=s,new r.SafeString(u)});t.addExport("flashmessage"),t.setVariable("flashmessage",s),n+="\n",o?o.rootRenderFunc(e,t,i,r,a):a(null,n)}catch(e){a(r.handleError(e,null,null))}}return{root:e}}()}()},,function(e,t,i){"use strict";var r=i(5),a=i(1165),n=i.n(a),o=i(1166),s=i.n(o),u=i(1167),l=i.n(u),c=i(1168),h=i.n(c),d=i(1169),p=i.n(d),f=i(1170),m=i.n(f),g=i(1171),_=i.n(g),v=i(1172),b=i.n(v),y=i(1173),x=i.n(y),S=i(1174),M=i.n(S),w=i(1175),T=i.n(w),C=i(16),E=r.a.osg,L=r.a.osgShader,P=new r.a.osgShader.ShaderProcessor;if(!Object(C.a)().rgbm){var A=P._shadersText["functions.glsl"];A=A.replace(/encodeRGBM.*\{/,"$&\nreturn vec4(color, 1.0);"),A=A.replace(/decodeRGBM.*\{/,"$&\nreturn color.rgb;"),P._shadersText["functions.glsl"]=A}var D={"sketchfabFunctions.glsl":n.a,"sketchfabTextures.glsl":s.a,"lightsPBR.glsl":l.a,"lightsSSS.glsl":h.a,"pbrUE4.glsl":p.a,"panoramaSampler.glsl":m.a,"cubemapSampler.glsl":_.a,"curvature.glsl":b.a,"rand.glsl":x.a,"refraction.glsl":M.a,"ssr.glsl":T.a};P.addShaders(D);var O=L.nodeFactory;O.extractFunctions(P._shadersText,"sketchfabFunctions.glsl"),O.extractFunctions(P._shadersText,"sketchfabTextures.glsl"),O.extractFunctions(P._shadersText,"curvature.glsl"),O.extractFunctions(P._shadersText,"lightsPBR.glsl"),O.extractFunctions(P._shadersText,"lightsSSS.glsl"),O.extractFunctions(P._shadersText,"pbrUE4.glsl"),O.extractFunctions(P._shadersText,"rand.glsl"),O.extractFunctions(P._shadersText,"refraction.glsl"),O.extractFunctions(P._shadersText,"ssr.glsl");var k=function(){this._shaderCache={}};k.prototype={getShaderProcessor:function(){return P},getOrCreateShader:function(e,t,i,r,a){var n="";a&&(n=a.toString());var o=i+n,s=this._shaderCache[o];return s||(s=this.createShader(e,t,i,r,a),this._shaderCache[o]=s),s},createShader:function(e,t,i,r,a){var n="#define SHADER_NAME "+r+"\n";if(a)if(Array.isArray(a))for(var o=0;o<a.length;o++)n+="#define "+a[o]+"\n";else n+="#define "+a+"\n";var s={};return s[i+"-vert"]=n+e,s[i+"-frag"]=n+t,P.addShaders(s),new E.Program(new E.Shader(E.Shader.VERTEX_SHADER,P.getShader(i+"-vert")),new E.Shader(E.Shader.FRAGMENT_SHADER,P.getShader(i+"-frag")))}},t.a=new k},function(e,t,i){i(14),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/popups/message.jinja"]=function(){function e(e,t,i,r,a){var n="";try{var o=null;e.getTemplate("skfb_front/layouts/popup.jinja",!0,"skfb_front/popups/message.jinja",!1,function(s,u){if(s)return void a(s);o=u;for(var l in o.blocks)t.addBlock(l,o.blocks[l]);n+="\n\n";var c;if(c=r.contextOrFrameLookup(t,i,"title"),i.set("popupTitle",c,!0),i.topLevel&&t.setVariable("popupTitle",c),i.topLevel&&t.addExport("popupTitle",c),n+="\n\n",!r.contextOrFrameLookup(t,i,"popupClass")){n+="\n    ";var h;h="popup-message",i.set("popupClass",h,!0),i.topLevel&&t.setVariable("popupClass",h),i.topLevel&&t.addExport("popupClass",h),n+="\n"}n+="\n\n",(o?function(e,t,i,r,a){a("")}:t.getBlock("popup_content"))(e,t,i,r,function(s,u){if(s)return void a(s);n+=u,n+="\n\n",(o?function(e,t,i,r,a){a("")}:t.getBlock("popup_footer"))(e,t,i,r,function(s,u){if(s)return void a(s);n+=u,n+="\n",o?o.rootRenderFunc(e,t,i,r,a):a(null,n)})})})}catch(e){a(r.handleError(e,null,null))}}function t(e,t,i,r,a){var n="";try{var i=i.push(!0);n+="\n\n    ",r.contextOrFrameLookup(t,i,"safe")?(n+="\n        ",n+=r.suppressValue(e.getFilter("safe").call(t,r.contextOrFrameLookup(t,i,"text")),e.opts.autoescape),n+="\n    "):(n+="\n        ",n+=r.suppressValue(r.contextOrFrameLookup(t,i,"text"),e.opts.autoescape),n+="\n    "),n+="\n\n",a(null,n)}catch(e){a(r.handleError(e,null,null))}}function i(e,t,i,r,a){var n="";try{var i=i.push(!0);n+='\n    <div class="actions">\n\n        ',n+="\n        ",n+="\n\n        ",r.memberLookup(r.contextOrFrameLookup(t,i,"buttons"),"cancel")&&(n+='\n            <button class="button btn-medium btn-tertiary cancel',r.memberLookup(r.contextOrFrameLookup(t,i,"buttons"),"cancelClass")&&(n+=" ",n+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"buttons"),"cancelClass"),e.opts.autoescape)),n+='" type="reset">',n+=r.suppressValue(e.getFilter("default").call(t,r.memberLookup(r.contextOrFrameLookup(t,i,"buttons"),"cancelLabel"),"Cancel"),e.opts.autoescape),n+="</button>\n        "),n+="\n\n        ",r.memberLookup(r.contextOrFrameLookup(t,i,"buttons"),"close")&&(n+='\n            <button class="button btn-medium btn-tertiary',r.memberLookup(r.contextOrFrameLookup(t,i,"buttons"),"cancelClass")&&(n+=" ",n+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"buttons"),"closeClass"),e.opts.autoescape)),n+='" type="reset" data-action="close">',n+=r.suppressValue(e.getFilter("default").call(t,r.memberLookup(r.contextOrFrameLookup(t,i,"buttons"),"closeLabel"),"Close"),e.opts.autoescape),n+="</button>\n        "),n+="\n\n        ",r.memberLookup(r.contextOrFrameLookup(t,i,"buttons"),"continue")&&(n+='\n            <button class="button btn-medium btn-primary submit',r.memberLookup(r.contextOrFrameLookup(t,i,"buttons"),"continueClass")&&(n+=" ",n+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"buttons"),"continueClass"),e.opts.autoescape)),n+='" type="submit">',n+=r.suppressValue(e.getFilter("default").call(t,r.memberLookup(r.contextOrFrameLookup(t,i,"buttons"),"continueLabel"),"Continue"),e.opts.autoescape),n+="</button>\n        "),n+="\n\n        ",r.memberLookup(r.contextOrFrameLookup(t,i,"buttons"),"ok")&&(n+='\n            <button class="button btn-medium btn-primary submit',r.memberLookup(r.contextOrFrameLookup(t,i,"buttons"),"okClass")&&(n+=" ",n+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"buttons"),"okClass"),e.opts.autoescape)),n+='" type="submit">',n+=r.suppressValue(e.getFilter("default").call(t,r.memberLookup(r.contextOrFrameLookup(t,i,"buttons"),"okLabel"),"OK"),e.opts.autoescape),n+="</button>\n        "),n+="\n\n        ",r.memberLookup(r.contextOrFrameLookup(t,i,"buttons"),"delete")&&(n+='\n            <button class="button btn-medium btn-danger submit',r.memberLookup(r.contextOrFrameLookup(t,i,"buttons"),"deleteClass")&&(n+=" ",n+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"buttons"),"deleteClass"),e.opts.autoescape)),n+='" type="submit">',n+=r.suppressValue(e.getFilter("default").call(t,r.memberLookup(r.contextOrFrameLookup(t,i,"buttons"),"deleteLabel"),"Delete"),e.opts.autoescape),n+="</button>\n        "),n+="\n\n    </div>\n",a(null,n)}catch(e){a(r.handleError(e,null,null))}}return{b_popup_content:t,b_popup_footer:i,root:e}}()}()},,,,,function(e,t,i){"use strict";var r=i(5),a=i(93),n=r.a.osg,o=["Inspector","Matcap","Displacement","Opacity","SubsurfaceScattering","SubsurfaceTranslucency","DiffuseColor","DiffusePBR","AlbedoPBR","SpecularColor","DiffuseIntensity","SpecularPBR","MetalnessPBR","GlossinessPBR","RoughnessPBR","NormalMap","BumpMap","AOPBR","EmitColor","CavityPBR","SpecularHardness","SpecularF0"],s=function(e){switch(e){case"Matcap":return a.a.MATCAP;case"SubsurfaceScattering":case"SubsurfaceTranslucency":return a.a.LIT;case"Opacity":case"Displacement":return a.a.LIT|a.a.SHADELESS|a.a.MATCAP|a.a.INSPECTOR;case"EmitColor":return a.a.LIT|a.a.SHADELESS;case"NormalMap":case"BumpMap":return a.a.LIT|a.a.MATCAP;case"DiffusePBR":case"AlbedoPBR":case"AOPBR":case"CavityPBR":return a.a.PBR;case"SpecularPBR":case"MetalnessPBR":case"GlossinessPBR":case"RoughnessPBR":case"SpecularF0":return a.a.PBR_LIT;case"DiffuseColor":case"DiffuseIntensity":return a.a.CLASSIC;case"SpecularColor":case"SpecularHardness":return a.a.CLASSIC_LIT;case"Inspector":return a.a.INSPECTOR}},u=function(e){switch(e){case"DiffuseColor":case"DiffusePBR":case"AlbedoPBR":case"EmitColor":case"SpecularColor":case"SpecularPBR":case"Matcap":case"Inspector":return!0;default:return!1}},l=function(e){switch(e){case"DiffuseColor":case"DiffuseIntensity":case"SpecularColor":case"NormalMap":case"EmitColor":case"DiffusePBR":case"AlbedoPBR":case"SpecularPBR":case"Matcap":case"Inspector":return n.Texture.RGB;case"SpecularHardness":case"BumpMap":case"GlossinessPBR":case"RoughnessPBR":case"MetalnessPBR":case"SpecularF0":case"AOPBR":case"CavityPBR":case"Displacement":case"SubsurfaceScattering":case"SubsurfaceTranslucency":return n.Texture.LUMINANCE;case"Opacity":return n.Texture.ALPHA;default:return console.error("unknown channel: "+e),n.Texture.RGB}},c=function(e){var t=l(e);return t===n.Texture.RGB?"rgb":t===n.Texture.LUMINANCE?"r":t===n.Texture.ALPHA?"a":"rgba"},h=function(e){var t=l(e);return t===n.Texture.RGB?"RGB":t===n.Texture.LUMINANCE?"LUMINANCE":t===n.Texture.ALPHA?"ALPHA":"RGBA"},d=function(e){return l(e)===n.Texture.RGB?3:1},p=function(e){var t={};switch(e){case"NormalMap":case"SpecularPBR":t.RGB="RGB";break;case"SpecularHardness":case"BumpMap":case"GlossinessPBR":case"RoughnessPBR":case"MetalnessPBR":case"SpecularF0":case"AOPBR":case"CavityPBR":case"Displacement":case"SubsurfaceScattering":case"SubsurfaceTranslucency":t.LUMINANCE="Luminance";break;case"DiffuseColor":case"DiffuseIntensity":case"SpecularColor":case"EmitColor":case"DiffusePBR":case"AlbedoPBR":case"Matcap":case"Inspector":t.LUMINANCE="Luminance",t.RGB="RGB";break;case"Opacity":t.ALPHA="Alpha",t.LUMINANCE="Luminance";break;default:return console.error("unknown channel: "+e),n.Texture.RGB}return t},f=function(e){switch(e){case"DiffuseColor":case"DiffusePBR":case"AlbedoPBR":case"Inspector":return 0;case"EmitColor":return 1;case"SpecularColor":case"SpecularPBR":return 2;case"DiffuseIntensity":return 3;default:return-1}},m=function(e){var t={};return"Displacement"!==e&&(t.LINEAR_MIPMAP_LINEAR="Trilinear (best)",t.NEAREST_MIPMAP_LINEAR="Nearest (mipmap)"),t.LINEAR="Bilinear",t.NEAREST="Nearest",t},g=function(e){return"SubsurfaceScattering"===e?.2:"SubsurfaceTranslucency"===e?.2:"Displacement"===e?1:-1},_=function(e){for(var t={},i=0,r=o.length;i<r;++i){var a=o[i];t[a]=e(a)}return function(e){return t[e]}};o.getShadingMask=_(s),o.isSRGB=_(u),o.getDefaultFormatEnum=_(l),o.getDefaultFormatComponent=_(c),o.getDefaultFormatString=_(h),o.getDefaultComponentCount=_(d),o.getPossibleFormat=_(p),o.getPossibleFiltering=_(m),o.getColorPacking=_(f),o.getBoxFactor=_(g),t.a=o},,,function(e,t,i){"use strict";function r(e){return e[0].toUpperCase()+e.slice(1)}function a(e,t,i){t.mixins.forEach(function(r){r[e]&&r[e].apply(t,i)})}function n(e,t){if(!e.name)throw new Error("Every mixin should have a `name` property. Check https://sketchfab.atlassian.net/wiki/display/DOC/Mixins for more info");if(t.mixins.filter(function(t){return t.name===e.name}).length>1)throw new Error("You have two mixins named: "+e.name+". Hint: parent's mixins are automatically merged with child's one when extended. Check out https://sketchfab.atlassian.net/wiki/display/DOC/Mixins for more info");e.dependencies&&e.dependencies.forEach(function(i){if(-1===t.mixins.map(Object(l.f)("name")).indexOf(i))throw new Error("You must include the "+i+" mixin in order to use the "+e.name+" mixin. Check https://sketchfab.atlassian.net/wiki/display/DOC/Mixins for more info")})}function o(e,t){var i=function(e){return function(){if(t.prototype[e]){var i=t.prototype[e].apply(this,arguments);return a(e,this,arguments),i}a(e,this,arguments)}};return e.reduce(function(e,t){var a="after"+r(t),n="before"+r(t),o=i(t),s=i(n),u=i(a);return e[t]=o,e[n]=s,e[a]=u,e},{})}function s(e){var t=e||[];return function(e){return e.extend(Object(u.extend)(o(t,e),{mixins:e.prototype.mixins||[],constructor:function(){Array.isArray(this.mixins)?this.mixins.forEach(function(e){n(e,this),Object(u.defaults)(this,Object(u.cloneDeep)(Object(u.omit)(e,["name","dependencies","constructor"].concat(t))))}.bind(this)):(this.mixins=[],console.error("Mixinable instances must have a `mixins` property of type Array.","Check https://sketchfab.atlassian.net/wiki/display/DOC/Mixins for more info")),t.forEach(function(e){var t="after"+r(e),i="before"+r(e),a=this[e];this[e]=function(){this[i].apply(this,arguments);var e=a.apply(this,arguments);return this[t].apply(this,arguments),e}}.bind(this)),a("constructor",this,arguments),e.apply(this,arguments)}}),{extend:function(t,i){var r=Object(u.extend)({},t,{mixins:this.prototype.mixins.concat(t.mixins||[])});return e.extend.call(this,r,i)}})}}t.a=s;var u=i(0),l=(i.n(u),i(30))},,function(e,t,i){"use strict";var r="undefined"!=typeof global,a=function(){return r};t.a=a},function(e,t,i){"use strict";var r=i(5),a=i(43),n=i(79),o=i(445),s=r.a.osg,u=r.a.osgUtil,l=function(){s.NodeVisitor.call(this),this.setNodeMaskOverride(-1)};l.prototype=s.objectInherit(s.NodeVisitor.prototype,{apply:function(e){e.setShape&&e.setShape(null),this.traverse(e)}});var c={init:function(e,t,i,r){rip(n);this._context=e,this._features=t,this._viewerOSGJS=i,this._rootModel=r,s.time("compute KdTree"),this.computeKdTree(r),s.timeEnd("compute KdTree"),this._initialized=!0},isInitialized:function(){return this._initialized},getViewport3d:function(){return this._features.postProcess.getCamera().getViewport()},getMaterialFromHit:function(e){return this._features.material.getModel().findFirstMaterial(e._nodePath)},_computeIntersections3D:function(){var e=new u.IntersectionVisitor,t=new u.LineSegmentIntersector;return function(i,r,o,s){s||(s=this._features.webVR.getNode()),void 0===o&&(o=a.a.PICK_GEOMETRY_SLOW),e.reset(),t.reset();var u=this._features.shadingStyle,l=u&&u.getModel().get("hasLines"),c=u&&u.getModel().get("hasPoints"),h=.005*n.a.getModelBoxWithoutDisplacement().radius(),d=c||l?h:0;return e.setTraversalMask(o),e.setIntersector(t),t.set(i,r,d),s.accept(e),t.getIntersections()}}(),computeNearestIntersection3D:function(e,t,i,r){var a=this._computeIntersections3D(e,t,i,r);return this._sortIntersections(a)},computeNearestIntersection3DHotspotFirst:function(e,t,i,r){var a=this._computeIntersections3D(e,t,i,r);if(0!==a.length){a.sort(function(e,t){return e._ratio-t._ratio});var n=0,o=a.length,s=this._features.hotspot.getWidgetNode();for(n=0;n<o;++n)if(-1!==a[n]._nodePath.indexOf(s))return a[n];return this._getFirstVisibleHit(a)}},pickNearestSurface:function(e){return this.computeNearestIntersection2D(e.canvasX,e.canvasY,a.a.PICK_GEOMETRY_SLOW,this._rootModel)},_computeIntersections2D:function(){var e=s.vec3.create(),t=s.vec3.create(),i=s.mat4.create();return function(r,a,n,u){return u||(u=this._features.webVR.getNode()),o.a.canvasCoordToGL(r,a,e),o.a.canvasCoordToGL(r,a,t),e[2]=0,t[2]=1,this.getWorldPositionFromScreenPoint(e,e),this.getWorldPositionFromScreenPoint(t,t),u.getWorldMatrix(void 0,i),s.mat4.invert(i,i),s.vec3.transformMat4(e,e,i),s.vec3.transformMat4(t,t,i),this._computeIntersections3D(e,t,n,u)}}(),computeNearestIntersection2D:function(e,t,i,r){var a=this._computeIntersections2D(e,t,i,r);return this._sortIntersections(a)},_sortIntersections:function(e){if(0!==e.length)return e.sort(function(e,t){return e._ratio-t._ratio}),this._getFirstVisibleHit(e)},_getFirstVisibleHit:function(e){for(var t=0,i=e.length;t<i;++t){var r=e[t];if(!r._backface)return r;for(var a=r._nodePath,n=a.length-1;n>=0;--n){var o=a[n].getStateSet(),u=o&&o.getAttribute("CullFace");if(void 0!==u){if(u.getMode()===s.CullFace.DISABLE)return r;break}}}},getRelativePositionFromHit:function(){var e=s.mat4.create(),t=s.mat3.create();return function(i,r,a,n){for(var o=i._nodePath,u=!1,l=0,c=o.length;l<c;++l)if(o[l]===n){o=o.slice(l),u=!0;break}return s.mat4.identity(e),!1===u&&o[0].getWorldMatrix(n,e),s.computeLocalToWorld(o,!0,e),s.vec3.transformMat4(r,i._localIntersectionPoint,e),a&&(s.mat3.normalFromMat4(t,e),s.vec3.transformMat3(a,i._localIntersectionNormal,t),s.vec3.normalize(a,a)),r}}(),getWorldPositionFromHit:function(e,t,i){return this.getRelativePositionFromHit(e,t,i,this._viewerOSGJS.getSceneData())},getScenePositionFromHit:function(e,t,i){return this.getRelativePositionFromHit(e,t,i,this._rootModel)},getWorldPositionFromScenePoint:function(e,t){var i=t||s.vec3.create(),r=this._features.orientation,a=this._features.autospin;return r&&s.vec3.transformMat4(i,e,r.getNode().getMatrix()),a&&s.vec3.transformMat4(i,i,a.getNode().getMatrix()),i},getScenePositionFromWorldPoint:function(){var e=s.mat4.create();return function(t,i){var r=i||s.vec3.create(),a=this._features.orientation,n=this._features.autospin;return s.mat4.identity(e),a&&s.mat4.multiply(e,e,a.getNode().getMatrix()),n&&s.mat4.multiply(e,e,n.getNode().getMatrix()),s.mat4.invert(e,e),s.vec3.transformMat4(r,t,e)}}(),getScreenPositionFromScenePoint:function(e,t){var i=this.getWorldPositionFromScenePoint(e,t);return this.getScreenPositionFromWorldPoint(i,i)},getScreenPositionFromWorldPoint:function(){var e=s.mat4.create();return function(t,i){var r=this._viewerOSGJS.getCamera();s.mat4.identity(e),this.getViewport3d().computeWindowMatrix(e),s.mat4.multiply(e,e,r.getProjectionMatrix()),s.mat4.multiply(e,e,r.getViewMatrix());var a=i||s.vec3.create();return s.vec3.transformMat4(a,t,e)}}(),getWorldPositionFromScreenPoint:function(){var e=s.mat4.create();return function(t,i){var r=this._viewerOSGJS.getCamera();s.mat4.identity(e),this.getViewport3d().computeWindowMatrix(e),s.mat4.multiply(e,e,r.getProjectionMatrix()),s.mat4.multiply(e,e,r.getViewMatrix()),s.mat4.invert(e,e);var a=i||s.vec3.create();return s.vec3.transformMat4(a,t,e)}}(),getScenePositionFromScreenPoint:function(e,t){var i=this.getWorldPositionFromScreenPoint(e,t);return this.getScenePositionFromWorldPoint(i,i)},computeKdTree:function(e){for(var t=this._context.getScene().getWireframeNodes(),i=new l,r=t.length,a=0;a<r;++a)t[a].accept(i);new s.KdTreeBuilder({_numVerticesProcessed:0,_targetNumTrianglesPerLeaf:50,_maxNumLevels:50}).apply(e)}};t.a=c},function(e,t,i){"use strict";var r=i(12),a=i(5),n=i(1097),o=i.n(n),s=i(1098),u=i.n(s),l=i(0),c=(i.n(l),a.a.osg),h=Object(l.invert)(a.a.osg.CullFace),d=function(e){return Array.isArray(e)||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array},p=r.a.extend({initialize:function(){if(r.a.prototype.initialize.apply(this,arguments),this._featureSchema=this.getSubSchema(this.getModelOptionPath()),this._featureSchema){this._typeMap={},this._buildTypeMap(this._featureSchema,this._typeMap);var e=this.getInstance();this.initDefaults(e)}},getModelOptionPath:function(){return""},getSubSchema:function(e,t){for(void 0===t&&(t=!0),e=e?0===e.indexOf("#")?e.substring(2).replace(/\//g,"."):"properties."+e.replace(/\./g,".properties."):"properties";e.indexOf(":")>0;){var i=e.split(":"),r=this._getAttribute(o.a,i[0]);if(r.patternProperties){var a=i[1].indexOf(".");a<0&&(a=i[1].length);var n=i[1].substring(0,a),s=Object.keys(r.patternProperties)[n];e=e.replace(":"+n,".patternProperties."+s)}}var u=this._getAttribute(o.a,e);if(u&&t)if(0===e.indexOf("definition")){u.definitions=Object(l.merge)({},o.a.definitions);var c=e.split(".");c=c[c.length-1],delete u.definitions[c]}else u.definitions=o.a.definitions;return u},_getAttribute:function(e,t){for(var i=t.split(".");i.length&&(e=e[i.shift()]););return e},getInstance:function(e){return e||(e=this._featureSchema),this._instantiateFromSchema(e)},_getRequiredFields:function(e){var t=e.required?e.required.slice():void 0;return e.oneOf&&e.oneOf.length&&e.oneOf[0].required&&e.oneOf[0].required.length&&t.push(e.oneOf[0].required[0]),t},_instantiateFromSchema:function(e){if("object"===e.type){var t={},i=this._getRequiredFields(e);e=e.properties?e.properties:e;for(var r in e)if(!(i&&i.indexOf(r)<0)){var a=e[r];t[r]=this._instantiateAttribute(a)}return t}return this._instantiateAttribute(e)},_instantiateAttribute:function(e){var t=e.default;if(e.$ref){var i=e.$ref,r=this.getSubSchema(i,!1),a=this._instantiateFromSchema(r);return t&&("object"==typeof t?Object(l.merge)(a,t):a=t),a}if(e.type){if(t&&"array"!==e.type)return t;switch(e.type){case"object":return this._instantiateFromSchema(e);case"array":var n;if(n=e.minItems?new Array(e.minItems):[],e.items)for(var o=e.items,s=0;s<n.length;s++)Array.isArray(e.items)&&(o=e.items[Object.keys(e.items)[s]]),n[s]=this._instantiateFromSchema(o);return n;case"number":case"integer":return 0;case"boolean":return!1;case"string":return e.enum?e.enum[0]:""}}},validate:function(e,t){var i=this._validator,r=t&&t.schema||this._featureSchema;i||(i=new u.a({allErrors:!0,removeAdditional:!0}).compile(r),this._validator=i);var a=[];if(i(e))return a;for(var n=0;n<i.errors.length;n++){var o=i.errors[n],s=o.dataPath.substring(1);if(s.indexOf("]")>=0&&(s=s.replace(/]/g,"")),"type"===o.keyword){var l=this._getAttribute(e,s);if(d(l))continue}"required"!==o.keyword&&a.push(this._formatErrorMessage(o,s,t))}return a},_formatErrorMessage:function(e,t,i){var r;i&&i.context&&(r=i.context);var a=r?r+": ":"";if(a+=t.length?'"'+t+'" ':"",a+=e.message,"enum"===e.keyword){a+=": ";for(var n=0;n<e.params.allowedValues.length;n++){a+=e.params.allowedValues[n]+", "}}else"additionalProperties"===e.keyword&&(a+=" ("+e.params.additionalProperty+")");return a},setJSON:function(e,t){if(!this._featureSchema)return["Json Schema not initialized"];this._adaptJSON&&this._adaptJSON(e);var i,r=t||{};if(r.schema?(i={},this._buildTypeMap(r.schema,i)):(r.schema=this._featureSchema,i=this._typeMap),r.validate){var a=this.validate(e,r);if(a.length)return console.error("Failed to validate json",e,a),console.log((new Error).stack),a.join("\n")}var n=this._flattenObject(e,i,r);return this.set(n),[]},_buildTypeMap:function(e,t){if(e.properties){var i=e.properties;for(var r in i){var a=i[r];"object"===a.type?(t[r]={},this._buildTypeMap(a,t[r])):a.type?t[r]=a.type:a.$ref&&(t[r]=a.$ref)}}else e.$ref&&this._buildTypeMap(this.getSubSchema(e.$ref,!1),t)},initDefaults:function(e){if(e){var t=this._flattenObject(e,this._typeMap);this.set(t)}},getJSON:function(e){if(!this._featureSchema)return["Json Schema not initialized"];var t=this.getInstance();if(e&&e.ignore)for(var i=0;i<e.ignore.length;i++){var r=e.ignore[i];delete t[r]}return this._populate(t,this._typeMap,"",e),t},_flattenObject:function(e,t,i){var r={},a=i&&i.ignore?i.ignore:void 0;for(var n in t)if(e.hasOwnProperty(n)&&!(a&&a.indexOf(n)>=0))if("object"==typeof t[n]){var o=this._flattenObject(e[n],t[n],i);for(var s in o)o.hasOwnProperty(s)&&(r[n+s.charAt(0).toUpperCase()+s.slice(1)]=o[s])}else void 0!==e[n]&&(r[n]=this._toModelType(e[n],t[n]));return r},_toModelType:function(e,t){return void 0===e?e:t.indexOf("vec2")>0||t.indexOf("unitVec2")>0?c.vec2.clone(e):t.indexOf("vec3")>0||t.indexOf("unitVec3")>0?c.vec3.clone(e):t.indexOf("vec4")>0||t.indexOf("unitVec4")>0?c.vec4.clone(e):t.indexOf("quaternion")>0?c.quat.clone(e):t.indexOf("matrix")>0?c.mat4.clone(e):t.indexOf("cullFace")>0?c.CullFace[e]:e},_toJsonType:function(e,t){return t.indexOf("vec2")>0||t.indexOf("unitVec2")>0||t.indexOf("vec3")>0||t.indexOf("unitVec3")>0||t.indexOf("vec4")>0||t.indexOf("unitVec4")>0||t.indexOf("quaternion")>0||t.indexOf("matrix")>0?Array.prototype.slice.call(e):t.indexOf("cullFace")>0?h[e]:e},_populate:function(e,t,i,r){for(var a in t)if(!(r&&r.ignore&&r.ignore.indexOf(a)>=0)){var n=i?i+a.charAt(0).toUpperCase()+a.slice(1):a;if("object"==typeof t[a])this._populate(e[a],t[a],n);else{var o=this.get(n);void 0!==o&&(e[a]=this._toJsonType(o,t[a]))}}}});t.a=p},function(e,t,i){"use strict";var r=i(9),a=i(21),n=i(98),o=i(246),s=i(183),u=i(674),l=i(586),c=function(){n.a.call(this),this._attributes={},this._primitives=[],this._cacheDrawCall={},this._useVAO=void 0,this._vao={},this._cacheVertexAttributeBufferList={},this._shape=void 0};c.enableVAO=!0,r.a.createPrototypeNode(c,r.a.objectInherit(n.a.prototype,{releaseGLObjects:function(){void 0!==this.stateset&&this.stateset.releaseGLObjects();for(var e in this._attributes){this._attributes[e].releaseGLObjects()}for(var t=0,i=this._primitives.length;t<i;t++){var r=this._primitives[t];void 0!==r.getIndices&&void 0!==r.getIndices()&&null!==r.getIndices()&&r.indices.releaseGLObjects()}this.releaseVAO()},releaseVAO:function(){if(this._useVAO&&this._glContext)for(var e in this._vao)this._vao[e]&&(this._vao[e].releaseGLObjects(),this._vao[e]=void 0)},dirty:function(){this._cacheDrawCall={},this.releaseVAO()},getPrimitives:function(){return this.getPrimitiveSetList()},getAttributes:function(){return this.getVertexAttributeList()},getShape:function(){return this._shape},setShape:function(e){this._shape=e},getVertexAttributeList:function(){return this._attributes},getPrimitiveSetList:function(){return this._primitives},setVertexAttribArray:function(e,t){this._attributes[e]!==t&&(this._attributes[e]=t,this.dirty())},_generateVertexSetup:function(e,t,i){for(var r=["//generated by Geometry::implementation","state.lazyDisablingOfVertexAttributes();","var attr;"],a=0,n=e.length;a<n;a++)r.push("attr = this._attributes['"+e[a]+"'];"),r.push("if ( attr.BufferArrayProxy ) attr = attr.getBufferArray();"),r.push("if ( !attr.isValid() ) return;"),r.push("state.setVertexAttribArray("+t[a]+", attr, attr.getNormalize() );");return r.push("state.applyDisablingOfVertexAttributes();"),i&&r.push("state.setIndexArray( this._primitives[ 0 ].getIndices() );"),r},_generatePrimitives:function(e,t,i){var r=[t?"state.enableVertexColor();":"state.disableVertexColor();"];if(i)return r.concat(["var primitive = this._primitives[ "+e[0]+" ];","var indexes = primitive.getIndices();","if ( indexes.isDirty() ) {;","  indexes.bind( gl );","  indexes.compile( gl );","};","primitive.drawElements( state );"]);r.push("var primitives = this._primitives;");for(var a=0,n=e.length;a<n;a++)r.push("primitives["+e[a]+"].draw(state);");return r},generateDrawCommand:function(){var e=[],t=[];return function(i,r,a,n){var o=r._attributesCache,c=this.getVertexAttributeList();t.length=0,e.length=0;var h,d,p,f=this._useVAO,m=f?[]:void 0,g=!1;for(var _ in o)if(h=o[_],void 0!==c[_]){var v=this._attributes[_];if(v instanceof u.a&&(v=v.getBufferArray(),f=!1),!v.isValid())return;f&&m.push(v),g||"Color"!==_||(g=!0),t.push(_),e.push(h)}var b,y;if(f){this._cacheVertexAttributeBufferList[a]=m;var x=1===n.length&&this._primitives[n[0]]instanceof s.a,S=this._generateVertexSetup(t,e,x);i.clearVertexAttribCache();var M=i.getGraphicContext(),w=new l.a(M);w.create(M),i.setVertexArrayObject(w),this._vao[a]=w;new Function("state",S.join("\n")).call(this,i);var T=["var gl = state.getGraphicContext();","var vao = this._vao[ "+a+" ] ","var hasChanged = state.setVertexArrayObject( vao );","if ( hasChanged ) {","  var vaList = this._cacheVertexAttributeBufferList[ "+a+" ];","  var va;"];for(d=0,p=m.length;d<p;d++)T.push("  va = vaList[ "+d+"];"),T.push("  if ( va.isDirty() ) {;"),T.push("    va.bind( gl );"),T.push("    va.compile( gl );"),T.push("  };");T.push("}"),b=T.concat(this._generatePrimitives(n,g,x)).join("\n"),y="GeometryDrawImplementationCacheVAO"}else b=this._generateVertexSetup(t,e,!1).concat(this._generatePrimitives(n,g,!1)).join("\n"),y="GeometryDrawImplementationCache";var C=new Function("state","return function "+y+"( state ) { "+b+"}")();return this._cacheDrawCall[a]=C,C}}(),_getValidPrimitives:function(){for(var e=[],t=0;t<this._primitives.length;t++){this._primitives[t].getCount()?e.push(t):this._warnInvalidPrimitives||(a.a.warn("geometry with instanceID "+this._instanceID+" has invalid primitives"),this._warnInvalidPrimitives=!0)}return e},drawImplementation:function(e){var t=e.getLastProgramApplied(),i=t.getInstanceID();e.drawGeometry(this);var r=this._cacheDrawCall[i];if(this._vao[i]?this._vao[i].isDirty()&&(r=void 0):e.setVertexArrayObject(null),r)return void r.call(this,e);if(!this._primitives.length)return void(this._warnNoPrimitives||(a.a.warn("geometry with instanceID "+this._instanceID+" has no primitives"),this._warnNoPrimitives=!0));var n=this._getValidPrimitives();n.length&&(void 0===this._useVAO&&c.enableVAO&&(this._useVAO=o.a.instance().hasVAO(),this._glContext=e.getGraphicContext()),r=this.generateDrawCommand(e,t,i,n),r.call(this,e),e.setVertexArrayObject(null))},setBound:function(e){this._boundingBox=e,this._boundingBoxComputed=!0},computeBoundingBox:function(e){e.init();var t=this.getVertexAttributeList().Vertex;if(t&&t.getElements()&&t.getItemSize()>2){for(var i=t.getElements(),r=t.getItemSize(),a=e.getMin(),n=e.getMax(),o=a[0],s=a[1],u=a[2],l=n[0],c=n[1],h=n[2],d=0,p=i.length;d<p;d+=r){var f=i[d],m=i[d+1],g=i[d+2];f<o&&(o=f),f>l&&(l=f),m<s&&(s=m),m>c&&(c=m),g<u&&(u=g),g>h&&(h=g)}a[0]=o,a[1]=s,a[2]=u,n[0]=l,n[1]=c,n[2]=h}return e},computeBoundingSphere:function(e){e.init();var t=this.getBoundingBox();return e.expandByBoundingBox(t),e}}),"osg","Geometry"),c.appendVertexAttributeToList=function(e,t,i){for(var r in e){var a=r;void 0!==i&&(a+="_"+i),t[a]=e[r]}},t.a=c},function(e,t,i){"use strict";var r,a=i(222),n=i(465);r=a.a.extend({model:n.a,endpoint:"/categories",defaultOptions:{pageSize:""},queryParams:function(){return{}}}),t.a=r},,,,,function(e,t,i){"use strict";t.a={RELATIVE_RF:0,ABSOLUTE_RF:1}},function(e,t,i){"use strict";var r=i(21),a=i(9),n=i(71),o=i(397),s=i(213),u=function(e){var t;return e instanceof a.a.Float32Array&&(t=5126),e instanceof a.a.Int16Array&&(t=5122),e instanceof a.a.Uint16Array&&(t=5123),e instanceof a.a.Int8Array&&(t=5120),e instanceof a.a.Uint8Array&&(t=5121),e instanceof a.a.Uint8ClampedArray&&(t=5121),e instanceof a.a.Int32Array&&(t=5124),e instanceof a.a.Uint32Array&&(t=5125),t},l=function(e,t,i){o.a.call(this),this._instanceID=n.a.getInstanceID(),this.dirty(),this._itemSize=i,this._target="string"==typeof e?l[e]:e,this._type=void 0,this._normalize=!1,t&&(void 0===t.byteLength&&(r.a.warn("BufferArray with non typedArray elements is deprecated"),t=this._target===l.ELEMENT_ARRAY_BUFFER?new a.a.Uint16Array(t):new a.a.Float32Array(t)),this.setElements(t)),this._usage=l.STATIC_DRAW};l.ELEMENT_ARRAY_BUFFER=34963,l.ARRAY_BUFFER=34962,l.STATIC_DRAW=35044,l.DYNAMIC_DRAW=35048,l.STREAM_DRAW=35040,l._sDeletedGLBufferArrayCache=new window.Map,l.deleteGLBufferArray=function(e,t){l._sDeletedGLBufferArrayCache.has(e)||l._sDeletedGLBufferArrayCache.set(e,[]),l._sDeletedGLBufferArrayCache.get(e).push(t)},l.flushDeletedGLBufferArrays=function(e,t){if(t<=0)return t;if(!l._sDeletedGLBufferArrayCache.has(e))return t;for(var i=0,r=s.a.instance().tick(),a=l._sDeletedGLBufferArrayCache.get(e),n=a.length,o=n-1;o>=0&&i<t;o--)e.deleteBuffer(a[o]),a.splice(o,1),i=s.a.instance().deltaS(r,s.a.instance().tick());return t-i},l.flushAllDeletedGLBufferArrays=function(e){if(l._sDeletedGLBufferArrayCache.has(e))for(var t=l._sDeletedGLBufferArrayCache.get(e),i=t.length,r=i-1;r>=0;r--)e.deleteBuffer(t[r]),t.splice(r,1)},l.onLostContext=function(e){if(l._sDeletedGLBufferArrayCache.has(e)){l._sDeletedGLBufferArrayCache.get(e).length=0}},a.a.createPrototypeObject(l,a.a.objectInherit(o.a.prototype,{setUsage:function(e){this._usage=e},getUsage:function(){return this._usage},getInstanceID:function(){return this._instanceID},setItemSize:function(e){this._itemSize=e},isValid:function(){return!!this._buffer||!(!this._elements||!this._elements.length)},invalidate:function(){this._buffer=void 0,this.dirty()},releaseGLObjects:function(){void 0!==this._buffer&&null!==this._buffer&&void 0!==this._gl&&(l.deleteGLBufferArray(this._gl,this._buffer),o.a.removeObject(this._gl,this)),this.invalidate()},setNormalize:function(e){this._normalize=e},getNormalize:function(){return this._normalize},bind:function(e){this._gl||this.setGraphicContext(e);var t=this._target,i=this._buffer;if(i)return void e.bindBuffer(t,i);!i&&this._elements.length>0&&(this._buffer=e.createBuffer(),this._numItems=this._elements.length/this._itemSize,e.bindBuffer(t,this._buffer))},getItemSize:function(){return this._itemSize},dirty:function(){this._dirty=!0},isDirty:function(){return this._dirty},compile:function(e){this._dirty&&(e.bufferData(this._target,this._elements,this._usage),this._dirty=!1)},getElements:function(){return this._elements},setElements:function(e){this._elements=e,this._type=u(e),this._dirty=!0},getType:function(){return this._type}}),"osg","BufferArray"),t.a=l},,function(e,t,i){"use strict";function r(e){return e.reduce(function(e,t){return e.concat(t)},[])}function a(e,t,i){return e.filter(i)[0]||t}function n(e){return Array.prototype.slice.call(e)}t.a=r,t.b=a,t.c=n},,function(e,t,i){"use strict";t.a={name:"internal",domain:"/i",parse:function(e){return e.results||[]}}},,,,function(e,t,i){"use strict";var r=i(432),a=i.n(r),n=i(17),o=i(6),s=function(e){var t,i=0;if(0===e.length)return i;for(var r=0;r<e.length;r++)t=e.charCodeAt(r),i=(i<<5)-i+t,i&=i;return i};t.a={debounceMap:{},install:function(){var e={ignoreUrls:[/extensions\//i,/^chrome:\/\//i,/^moz-extension:\/\//i,/webtoolbar\//i],release:n.a.version};a.a.setShouldSendCallback(function(e){if(void 0===e||void 0===e.message&&(void 0===e.exception||!e.exception.values.length))return!1;if("plugin.setSuspendState is not a function"===e.message||"undefined"===e.message)return!1;if(-1!==e.message.indexOf("NS_ERROR"))return!1;if(e.message.indexOf("undefined")&&(-1!==e.message.indexOf("osgjs/sources/osg/GLObject")||-1!==e.message.indexOf("window.Map")))return!1;var t=Date.now(),r="";try{r=e.exception.values[0].stacktrace.frames.reduce(function(e,t){e+=t.filename+t.lineno+";"},"")}catch(e){}var a=s(e.message+r),n=t-this.debounceMap[a]<500;if(this.debounceMap[a]=Date.now(),n)return!1;if((0,i(230).default)()&&window.MSInputMethodContext&&document.documentMode)return!1;var o=navigator.userAgent.toLowerCase();return-1===o.indexOf("msie")||9!==parseInt(o.split("msie")[1])}.bind(this));var t=a.a.config(n.a.sentryDSN,e);n.a.useSentry?t.install():console.warn("Sentry was not installed ; it is manually disabled.");var r=o.a.me();return r.isAuthenticated()&&a.a.setUserContext({uid:r.get("uid"),username:r.get("username"),email:r.get("email")}),a.a},client:a.a}},function(e,t,i){"use strict";var r=i(20),a=i.n(r),n=i(3),o=i.n(n),s=i(0),u=(i.n(s),i(256)),l=i(152),c=i(257);t.a=u.a.extend({mixins:[l.b,c.a],el:'<div class="widget"/>',constructor:function(e,t){this.environment=Object(s.extend)({},e?e.environment:{},(t||{}).environment),this.options=t||{},this.collection=this.options.collection,this.model=this.options.model,u.a.call(this,t)},initialize:function(e){u.a.prototype.initialize.call(this,e),this.render(),void 0!==this.options.id&&(this.id=this.options.id,this.$el.attr("id",this.id)),void 0!==this.options.className&&(this.className=this.options.className,this.$el.addClass(this.className)),void 0!==this.options.title&&this.$el.attr("title",this.options.title)},$:function(e){var t=this.$el;return this.$el.find(e).filter(function(){return o()(this).parent().closest(".widget").is(t)})},delegateEvents:function(e){e||(e=Object(s.result)(this,"events")||{});var t=this.$el;return u.a.prototype.delegateEvents.call(this,a()(e).reduce(function(i,r){var a=e[r];return Object(s.isFunction)(a)||(a=this[e[r]]),a?(i[r]=function(e){e&&e.currentTarget&&!o()(e.currentTarget).closest(".widget").is(t)||a.apply(this,arguments)}.bind(this),i):i}.bind(this),{})),this.model&&this.model.on("change",this.modelChangeEvent,this),this},undelegateEvents:function(){return u.a.prototype.undelegateEvents.apply(this,arguments),this.model&&this.model.off("change",this.modelChangeEvent,this),this},modelChangeEvent:function(){var e=this.options.name,t=e+".",i=!e,r=a()(this.model.changedAttributes()||{}),n=r.some(function(i){return i===e||0===i.indexOf(t)});(i||n)&&this.render()},change:function(e,t){1===arguments.length&&(t=e,e=void 0);var i=!0,r=function(){i=!1},a={target:this,which:e,value:t,preventDefault:r};return this.trigger("change.before",a),!!i&&(this.defaultAction(e,t),this.trigger("change"),!0)},defaultAction:function(e,t){this.set(t)},field:function(e){return this.options.name+(e?"."+e:"")},get:function(e){return this.model.get(this.field(e))},set:function(e,t){return 1===arguments.length&&(t=e,e=void 0),this.model.set(this.field(e),t)},disable:function(){this._disabled=!0,this.$el.addClass("disabled")},enable:function(){this._disabled=!1,this.$el.removeClass("disabled")}},{reify:function(){var e=arguments,t=this,i=function(){t.apply(this,e)};return i.prototype=this.prototype,new i}})},,,,function(e,t,i){var r,a;!function(n,o){"use strict";r=o,void 0!==(a="function"==typeof r?r.call(t,i,t,e):r)&&(e.exports=a)}(0,function(){"use strict";var e={};return e.sanitize=function(e,t){var i=["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr","svg","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","switch","symbol","text","textpath","title","tref","tspan","view","vkern","math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmuliscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mpspace","msqrt","mystyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","#text"],r=!0,a=["accept","action","align","alt","autocomplete","bgcolor","border","checked","cite","class","color","cols","colspan","coords","datetime","default","dir","disabled","download","enctype","for","headers","height","hidden","high","href","hreflang","id","ismap","label","lang","list","loop","low","max","maxlength","media","method","min","multiple","name","novalidate","open","optimum","pattern","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","rows","rowspan","spellcheck","scope","selected","shape","size","span","srclang","start","src","step","style","summary","tabindex","title","type","usemap","valign","value","width","xmlns","accent-height","accumulate","additivive","alignment-baseline","ascent","azimuth","baseline-shift","bias","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dy","dy","direction","display","divisor","dur","elevation","end","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","front-weight","image-rendering","in","in2","k1","k2","k3","k4","kerning","letter-spacing","lighting-color","local","marker-end","marker-mid","marker-start","max","mask","mode","min","operator","opacity","order","overflow","paint-order","path","points","r","rx","ry","radius","restart","scale","seed","shape-rendering","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","transform","text-anchor","text-decoration","text-rendering","u1","u2","viewbox","visibility","word-spacing","wrap","writing-mode","x","x1","x2","y","y1","y2","z","accent","accentunder","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","display","displaystyle","fence","frame","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","xlink:href","xml:id","xlink:title","xml:space"],n=!1,o=!1,s=!1,u=!0,l=!0,c=["a","abbr","acronym","address","article","aside","b","bdi","bdo","big","blink","blockquote","caption","center","cite","code","col","dd","del","details","dfn","dir","div","dl","dt","em","figcaption","figure","footer","h1","h2","h3","h4","h5","h6","header","i","ins","kbd","label","legend","li","main","mark","marquee","nav","ol","output","p","pre","q","rp","rt","ruby","s","samp","section","small","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var"],h=function(e){return document.createNodeIterator(e,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT,function(){return NodeFilter.FILTER_ACCEPT},!1)},d=function(e){return!(e instanceof Text)&&!!(e.children&&!(e.children instanceof HTMLCollection)||e.attributes instanceof NodeList||"string"!=typeof e.nodeName||"string"!=typeof e.textContent||"number"!=typeof e.nodeType||"number"!=typeof e.COMMENT_NODE||"function"!=typeof e.setAttribute||"function"!=typeof e.cloneNode||"function"!=typeof e.removeAttributeNode||"function"!=typeof e.insertAdjacentHTML||"function"!=typeof e.attributes.item)},p=function(e){if(d(e)){try{e.parentNode.removeChild(e)}catch(t){e.outerHTML=""}return!0}if(e.nodeType===e.COMMENT_NODE||-1===i.indexOf(e.nodeName.toLowerCase())){if(l&&e.insertAdjacentHTML&&e.nodeName.toLowerCase&&-1!==c.indexOf(e.nodeName.toLowerCase()))try{e.insertAdjacentHTML("AfterEnd",e.innerHTML)}catch(e){}return e.parentNode.removeChild(e),!0}return s&&!e.firstElementChild&&(e.textContent=e.textContent.replace(/</g,"&lt;")),!1},f=function(e){var t,i,n=/^(\w+script|data):/gi,o=e.cloneNode(!0);if(e.attributes)for(var s=e.attributes.length-1;s>=0;s--)t=o.attributes[s],i=!1,e.removeAttribute(e.attributes[s].name),t instanceof Attr&&(u&&("id"===t.name&&window[t.value]&&(i=!0),"name"===t.name&&document[t.value]&&(i=!0)),!(a.indexOf(t.name.toLowerCase())>-1||r&&t.name.match(/^data-[\w-]+/i))||t.value.replace(/[\x00-\x20]/g,"").match(n)&&("src"!==t.name||0!==t.value.indexOf("data:")||"IMG"!==t.ownerElement.nodeName)||i||e.setAttribute(t.name,t.value))},m=function(e){for(var t,i=h(e);t=i.nextNode();)p(t)||(t.content instanceof DocumentFragment&&m(t.content),f(t))};t&&function(e){e.ALLOWED_ATTR&&(a=e.ALLOWED_ATTR),e.ALLOWED_TAGS&&(i=e.ALLOWED_TAGS),e.ALLOW_DATA_ATTR&&(r=e.ALLOW_DATA_ATTR),e.SAFE_FOR_JQUERY&&(s=e.SAFE_FOR_JQUERY),e.WHOLE_DOCUMENT&&(n=e.WHOLE_DOCUMENT),e.RETURN_DOM&&(o=e.RETURN_DOM),e.SANITIZE_DOM&&(u=e.SANITIZE_DOM),e.KEEP_CONTENT&&(l=e.KEEP_CONTENT),e.ADD_ATTR&&(a=a.concat(e.ADD_ATTR)),e.ADD_TAGS&&(i=i.concat(e.ADD_TAGS)),l&&i.push("#text")}(t);var g=function(e){var t=document.implementation.createHTMLDocument("");t.body.parentNode.removeChild(t.body.parentNode.firstElementChild),t.body.outerHTML=e,null===t.body&&(t.body.innerHTML=e);var i=n?t.body.parentNode:t.body;if(!(t.body instanceof HTMLBodyElement&&t.body instanceof HTMLHtmlElement)){var r=document.implementation.createHTMLDocument("");i=n?r.getElementsByTagName.call(t,"html")[0]:r.getElementsByTagName.call(t,"body")[0]}return i}(e);if(void 0===g)return"";for(var _,v=h(g);_=v.nextNode();)p(_)||(_.content instanceof DocumentFragment&&m(_.content),f(_));return o?g:n?g.outerHTML:g.innerHTML},e})},function(e,t,i){"use strict";var r=i(9),a=i(214),n=i(544),o=i(10),s=i(84),u=i(127),l=function(){a.a.call(this),n.a.call(this),this.viewport=void 0,this._graphicContext=void 0,this._scissor=void 0,this.setClearColor(o.g.fromValues(0,0,0,1)),this.setClearDepth(1),this.setClearMask(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),this.setViewMatrix(o.c.create()),this.setProjectionMatrix(o.c.create()),this.renderOrder=l.NESTED_RENDER,this.renderOrderNum=0,this._view=void 0,this._renderer=void 0,this._attachments={}};l.PRE_RENDER=0,l.NESTED_RENDER=1,l.POST_RENDER=2,l.COLOR_BUFFER_BIT=16384,l.DEPTH_BUFFER_BIT=256,l.STENCIL_BUFFER_BIT=1024,r.a.createPrototypeNode(l,r.a.objectInherit(n.a.prototype,r.a.objectInherit(a.a.prototype,{getView:function(){return this._view},setView:function(e){this._view=e},getRenderer:function(){return this._renderer},setRenderer:function(e){this._renderer=e},setFinalDrawCallback:function(e){this._finalDrawCallback=e},getFinalDrawCallback:function(){return this._finalDrawCallback},setInitialDrawCallback:function(e){this._initialDrawCallback=e},getInitialDrawCallback:function(){return this._initialDrawCallback},getAttachments:function(){return this._attachments},setGraphicContext:function(e){this._graphicContext=e},getGraphicContext:function(){return this._graphicContext},setClearDepth:function(e){this.clearDepth=e},getClearDepth:function(){return this.clearDepth},setClearMask:function(e){this.clearMask=e},getClearMask:function(){return this.clearMask},setClearColor:function(e){this.clearColor=e},getClearColor:function(){return this.clearColor},setViewport:function(e){this.viewport=e,this.getOrCreateStateSet().setAttributeAndModes(e)},getViewport:function(){return this.viewport},setScissor:function(e){this._scissor=e,this.getOrCreateStateSet().setAttributeAndModes(this._scissor)},getScissor:function(){return this._scissor},setViewMatrix:function(e){this.modelviewMatrix=e},setViewMatrixAsLookAt:function(e,t,i){o.c.lookAt(this.getViewMatrix(),e,t,i)},setProjectionMatrix:function(e){this.projectionMatrix=e},setProjectionMatrixAsOrtho:function(e,t,i,r,a,n){o.c.ortho(this.getProjectionMatrix(),e,t,i,r,a,n)},isRenderToTextureCamera:function(){return window.Object.keys(this._attachments).length>0},getViewMatrix:function(){return this.modelviewMatrix},getProjectionMatrix:function(){return this.projectionMatrix},getRenderOrder:function(){return this.renderOrder},setRenderOrder:function(e,t){this.renderOrder=e,this.renderOrderNum=t},getFrameBufferObject:function(){return this.frameBufferObject},setFrameBufferObject:function(e){this.frameBufferObject=e},detachAll:function(){this._attachments={},this.frameBufferObject&&this.frameBufferObject.dirty()},resetAttachments:function(){this.frameBufferObject&&(this.frameBufferObject.reset(),this.frameBufferObject=0),this._attachments={}},attachTexture:function(e,t,i){this.frameBufferObject&&this.frameBufferObject.dirty(),i||(i=s.default.TEXTURE_2D),this._attachments[e]={attachment:e,texture:t,textureTarget:i}},attachRenderBuffer:function(e,t){this.frameBufferObject&&this.frameBufferObject.dirty(),this._attachments[e]={format:t,attachment:e}},computeLocalToWorldMatrix:function(e){return this.referenceFrame===u.a.RELATIVE_RF?o.c.mul(e,e,this.modelviewMatrix):o.c.copy(e,this.modelviewMatrix),!0},computeWorldToLocalMatrix:function(){var e=o.c.create();return function(t){return o.c.invert(e,this.modelviewMatrix),this.referenceFrame===u.a.RELATIVE_RF?o.c.mul(t,e,t):o.c.copy(t,e),!0}}()})),"osg","Camera"),t.a=l},function(e,t,i){"use strict";var r=i(9),a=i(10),n=i(214),o=i(127),s=function(){n.a.call(this),this.matrix=a.c.create()};r.a.createPrototypeNode(s,r.a.objectInherit(n.a.prototype,{getMatrix:function(){return this.matrix},setMatrix:function(e){this.matrix=e,this.dirtyBound()},computeLocalToWorldMatrix:function(e){return this.referenceFrame===o.a.RELATIVE_RF?a.c.mul(e,e,this.matrix):a.c.copy(e,this.matrix),!0},computeWorldToLocalMatrix:function(){var e=a.c.create();return function(t){return a.c.invert(e,this.matrix),this.referenceFrame===o.a.RELATIVE_RF?a.c.mul(t,e,t):a.c.copy(t,e),!0}}()}),"osg","MatrixTransform"),t.a=s},function(e,t,i){"use strict";var r=i(5),a=r.a.osg,n=r.a.osgAnimation,o={wireframe:!0,epsilon:!0,nphi:!0,attributes:!0,vertex_mode:!0,triangle_mode:!0,rigIndex:!0,framerate:!0,bx:!0,by:!0,bz:!0,hx:!0,hy:!0,hz:!0,ox:!0,oy:!0,oz:!0,ow:!0,ot:!0,channel_mode:!0},s=function(){a.NodeVisitor.call(this)};s.convertUserDataToObject=function(e,t){var i=t||{};if(!e)return i;for(var r=0,a=e.length;r<a;++r){var n=e[r],s=n.Name;o[s]||-1!==s.indexOf("_bbl_")||-1!==s.indexOf("_h_")||-1!==s.indexOf("_mode")?i[s]=JSON.parse(n.Value):i[s]=n.Value}return i},s.instanceIDGeometryMap={},s.uidGeometryMap={},s.hasPoints=!1,s.hasTriangles=!1,s.hasLines=!1,s.hasVertexNormals=!1,s.hasRigsOrMorphs=!1,a.createPrototypeObject(s,a.objectInherit(a.NodeVisitor.prototype,{apply:function(e){var t=e instanceof a.Geometry;if(t&&(void 0!==e._uniqueID&&(s.uidGeometryMap[e._uniqueID]=e),s.instanceIDGeometryMap[e.getInstanceID()]=e,!s.hasRigsOrMorphs)){var i=e instanceof n.RigGeometry,r=e instanceof n.MorphGeometry;s.hasRigsOrMorphs=i||r}if(t||e instanceof n.Bone){e.userDataMap=s.convertUserDataToObject(e.getUserData());var o=e;if(e.getSourceGeometry&&(o=e.getSourceGeometry(),s.convertUserDataToObject(o.getUserData(),e.userDataMap)),o instanceof n.MorphGeometry)for(var u=o.getMorphTargets(),l=0,c=u.length;l<c;++l){var h=e.userDataMap["morph_"+l]={};s.convertUserDataToObject(u[l].getUserData(),h)}}return this.traverse(e)}})),t.a=s},function(e,t,i){"use strict";var r=i(5),a=i(47),n=i(16),o=i(1186),s=r.a.InputGroups;s.GLOBAL_ACTIONS=s.SCENE+".globalactions",s.GLOBAL_FOCUS="focuscanvas",s.SCENE_VIEWERAPI=s.SCENE+".viewerapi",s.FOCUS_INSPECTOR="focus.inspector",s.SCENE_INSPECTOR=s.SCENE+".inspector",s.UI_INSPECTOR=s.UI+".inspector",s.SCENE_INSPECTOR_ZOOM=s.SCENE_INSPECTOR+".zoom",s.UI_INSPECTOR_ZOOM=s.UI_INSPECTOR+".zoom",s.ENVIRONMENT=s.SCENE+".environment",s.DEBUG="debug",s.DEBUG_TRIPICK="debug.tripick",s.DEBUG_GEOMPICK="debug.geompick",s.AUTOSPIN=s.SCENE+".autospin",s.HOTSPOT=s.SCENE+".hotspot",s.HOTSPOT_VIEWER=s.HOTSPOT+".viewer",s.HOTSPOT_EDITOR=s.HOTSPOT+".editor",s.CAMERA=s.SCENE+".camera",s.CAMERA_GIZMO=s.CAMERA+".gizmo",s.SOUND=s.SCENE+".sound",s.SOUND_GIZMO=s.SOUND+".gizmo",s.WEBVR=s.SCENE+".webvr",s.WEBVREDITOR=s.SCENE+"webvreditor",s.WEBVR_NAVIGATION=s.WEBVR+".navigation",s.WEBVR_DISPLAY=s.WEBVR+".display",s.AR="ar",s.AR_DEBUG=s.AR+".debug";var u={init:function(e){this._manager=e},initGlobalClickEvents:function(e,t){var i=0,r=0,a=0,n=function(e){a=0,i=e.clientX,r=e.clientY},o=function(e){var t=Math.abs(i-e.clientX)+Math.abs(r-e.clientY);a=Math.max(a,t)},u=function(t){a<2&&e.onSingleClick(t)};this._manager.group(s.GLOBAL_ACTIONS).addMappings({onDoubleClick:["doubletap","doubletap2fingers","dblclick"],onSingleClick:"singletap"},e),this._manager.group(s.GLOBAL_ACTIONS).addMappings({preventclick:"mousedown"},n),this._manager.group(s.GLOBAL_ACTIONS).addMappings({preventmousemove:"mousemove"},o),this._manager.group(s.GLOBAL_ACTIONS).addMappings({fallbacksingleclick:"mouseup"},u),this._manager.group("focuscanvas").addMappings({focus:"mousedown"},function(){t.focus({preventScroll:!0})}),this._manager.setPriority("focuscanvas",0)},initViewerAPI:function(e){this._manager.group(s.SCENE_VIEWERAPI).addMappings({onMouseMove:"mousemove",onCursorUp:["mouseup","singletap"]},e)},initInspector:function(e){this._manager.group(s.FOCUS_INSPECTOR).addMappings({focusCheck:["mousedown","touchstart","wheel","mousemove","touchend","mouseup"],onCursorDown:["mousedown","touchstart"],onCursorUp:["touchend","touchcancel","mouseout","mouseup"]},e),this._manager.group(s.SCENE_INSPECTOR).addMappings({onMouseMove:"mousemove"},e),this._manager.group(s.SCENE_INSPECTOR_ZOOM).addMappings({onMouseWheel:"wheel"},e),this._manager.setPriority(s.FOCUS_INSPECTOR,this._manager.getHigherPriority(s.SCENE_INSPECTOR)),this._manager.setPriority(s.FOCUS_INSPECTOR+":onCursorUp",this._manager.getHigherPriority(s.FOCUS_INSPECTOR))},initInspectorCamera2D:function(e){this._manager.group(s.UI_INSPECTOR).addMappings({onEventStart:["pinchstart","panstart","mousedown"],onEventEnd:["pinchend","panend","mouseup","mouseout"],onEventUpdate:["pinch","pan","mousemove"]},e),this._manager.group(s.UI_INSPECTOR_ZOOM).addMappings({onMouseWheel:"wheel"},e),this._manager.setPriority(s.UI_INSPECTOR+":onEventEnd",this._manager.getHigherPriority(s.FOCUS_INSPECTOR))},initEnvironment:function(e){this._manager.group(s.ENVIRONMENT).addMappings({startRotate:["mousedown alt","touchstart 3"],rotateLight:["mousemove alt ctrl !shift"],rotateEnv:["mousemove alt shift !ctrl"],rotateEnvAndLight:["mousemove alt !shift !ctrl","panmove 3"],endRotate:["mouseup","mouseout","touchend","touchcancel"]},e),this._manager.setPriority(s.ENVIRONMENT,this._manager.getHigherPriority(s.MANIPULATORS))},initDebug3D:function(e){this._manager.group(s.DEBUG_TRIPICK).addMappings({onTrianglePick:"dblclick"},e),this._manager.group(s.DEBUG_GEOMPICK).addMappings({onPickSelect:"dblclick"},e),this._manager.setPriority(s.DEBUG,1)},initAutospin:function(e,t){this._manager.group(s.AUTOSPIN).addMappings({pause:["mousedown","touchstart"],resume:["mouseup","mouseout","touchend","touchcancel"]},e),this._manager.setPriority(s.AUTOSPIN,this._manager.getHigherPriority(s.MANIPULATORS)),this._manager.setEnable(s.AUTOSPIN,t)},initHotspot:function(e){this._manager.group(s.HOTSPOT).addMappings({hoverHotspot:"mousemove"},e),Object(a.a)()?(this._manager.group(s.HOTSPOT_EDITOR).addMappings({createHotspot:"dblclick",startDrag:["mousedown","touchstart"],dragHotspot:["mousemove","touchmove"],stopDrag:["touchend","mouseup"],cancelDrag:["touchcancel","mouseout"]},e),this._manager.setPriority(s.HOTSPOT,this._manager.getHigherPriority(s.MANIPULATORS))):this._manager.group(s.HOTSPOT_VIEWER).addMappings({selectHotspot:["mousedown","singletap"]},e)},initCamera:function(e){this._manager.group(s.CAMERA_GIZMO).addMappings({motion:"mousemove",startDrag:"mousedown",endDrag:["mouseleave","mouseup"]},e),this._manager.setPriority(s.CAMERA_GIZMO,this._manager.getHigherPriority(s.MANIPULATORS))},initSound:function(e){this._manager.group(s.SOUND_GIZMO).addMappings({onDragMove:"mousemove",onDragStart:"mousedown",onDragEnd:["mouseleave","mouseup"],onDoubleClick:"dblclick"},e),this._manager.setEnable(s.SOUND_GIZMO,!1),this._manager.setPriority(s.SOUND_GIZMO,this._manager.getHigherPriority(s.MANIPULATORS))},initWebVR:function(e){this._manager.group(s.WEBVR).addMappings({scaleUp:"keydown o",scaleDown:"keydown p"},e),this._manager.group(s.WEBVR_DISPLAY).addMappings({onDisplayChange:["vrdisplayconnected","vrdisplaynotfound"]},e),this._manager.setEnable(s.WEBVR,!1),Object(a.a)()&&this._manager.group(s.WEBVREDITOR).addMappings({savePosition:"mousemove"},e)},initWebVRNavigation:function(e){this._manager.group(s.WEBVR_NAVIGATION).addMappings({onPointerDown:"touchstart 1",onPointerUp:["touchend 1","mouseup 0","mouseup 1"],displayMenu:["mouseup 2","touchend 2"],onMouseDown:"mousedown"},e),this._manager.setEnable(s.WEBVR_NAVIGATION,!1)},initAR:function(e){Object(n.a)().arkitDebug&&(this._manager.group(s.AR_DEBUG).addMappings({startMotion:["mousedown 1","mousedown 2"],startRotate:"mousedown 1 !ctrl",startElevate:"mousedown ctrl 1",startScale:"mousedown 2",motion:"mousemove",endMotion:["mouseup","mouseout"]},e),this._manager.setPriority(s.AR_DEBUG,this._manager.getHigherPriority(s.MANIPULATORS))),o.a.initGestures(this._manager),this._manager.group(s.AR).addMappings({startScale:"pinchstart",endScale:"pinchend",scale:"pinch",endRotate:"panhend",endElevate:"panvend",rotate:"panh",elevate:"panv"},e)}};t.a=u},function(e,t,i){"use strict";var r=i(5),a=i(610),n=r.a.osg,o={uDrawOpaque:n.Uniform.createInt(-1,"uDrawOpaque"),uQVT:n.Uniform.createFloat3("uQVT"),uQVS:n.Uniform.createFloat3("uQVS"),uQW:n.Uniform.createFloat2("uQW"),uQUV0:n.Uniform.createFloat4("uQUV0"),uNearFar:n.Uniform.createFloat2("uNearFar"),uBoxRadius:n.Uniform.createFloat("uBoxRadius"),uOutputLinear:n.Uniform.createInt(1,"uOutputLinear"),uRGBMRange:n.Uniform.createFloat("uRGBMRange"),uGlobalTexSize:n.Uniform.createFloat2("uGlobalTexSize"),uGlobalTexRatio:n.Uniform.createFloat2("uGlobalTexRatio"),uPixelRatio:n.Uniform.createFloat2("uPixelRatio"),uPreviousGlobalTexSize:n.Uniform.createFloat2("uPreviousGlobalTexSize"),uPreviousGlobalTexRatio:n.Uniform.createFloat2("uPreviousGlobalTexRatio"),uPreviousHalton:n.Uniform.createFloat4("uPreviousHalton"),uReprojectViewProj:n.Uniform.createMatrix4("uReprojectViewProj"),uTaaCornersCSLeft:a.a.uTaaCornersCSLeft,uPreviousProjection:n.Uniform.createMatrix4("uPreviousProjection"),uPreviousViewInvView:n.Uniform.createMatrix4("uPreviousViewInvView"),uTextureToBeRefractedSize:n.Uniform.createFloat2("uTextureToBeRefractedSize"),uDisplay2D:n.Uniform.createFloat(0,"uDisplay2D"),uSplitView:n.Uniform.createFloat(0,"uSplitView"),uDisplayVertexAlpha:n.Uniform.createFloat(0,"uDisplayVertexAlpha"),uTimeViewer:n.Uniform.createFloat("uTimeViewer"),uHalton:n.Uniform.createFloat4("uHalton"),uSSAARestart:n.Uniform.createFloat(0,"uSSAARestart"),uScatteringFactorPacker:n.Uniform.createFloat("uScatteringFactorPacker"),uNormalizeFactorThickness:n.Uniform.createFloat("uNormalizeFactorThickness"),uStaticFrameNumShadow0:n.Uniform.createFloat("uStaticFrameNumShadow0"),uStaticFrameNumShadow1:n.Uniform.createFloat("uStaticFrameNumShadow1"),uStaticFrameNumShadow2:n.Uniform.createFloat("uStaticFrameNumShadow2"),uStaticFrameNumShadow3:n.Uniform.createFloat("uStaticFrameNumShadow3"),uShadowMapSize:n.Uniform.createFloat2("uShadowMapSize"),uIsVr:n.Uniform.createInt("uIsVr"),uFrameMod:n.Uniform.createFloat(0,"uFrameMod"),uFrameModTaaSS:n.Uniform.createFloat(0,"uFrameModTaaSS"),uSsrFactor:n.Uniform.createFloat(1,"uSsrFactor"),uQuality:n.Uniform.createFloat(0,"uQuality")};t.a=o},function(e,t,i){"use strict";var r=i(3),a=i.n(r),n=i(0);i.n(n);t.a={name:"LazyLoading",handleLazyLoading:function(e){e=e||{},Object(n.defaults)(e,{onBeforeLoad:function(){},onAfterLoad:function(){}});var t=function(){this.$(".lazyload").each(function(){var t=a()(this),i=t.attr("data-uri"),r=new Image;r.classList.add("lazyloaded"),r.onload=r.onerror=function(){var i,a=t.width();if(i=r.naturalWidth>a?r.naturalHeight*(a/r.naturalWidth):r.naturalHeight,e.onBeforeLoad(i),t.is(":visible")){var n=function(){t.append(r),t.addClass("loaded").one("transitionend webkittransitionend moztransitionend",function(){t.replaceWith(r),e.onAfterLoad()})}.bind(this);i!==t.outerHeight()?t.css("min-height",i).one("transitionend webkittransitionend moztransitionend",n):n()}else t.replaceWith(r),e.onAfterLoad()},r.src=i})}.bind(this);"complete"===document.readyState?t():a()(window).load(t)}}},,,function(e,t,i){"use strict";i.d(t,"b",function(){return s});var r=i(469),a=i.n(r),n=i(616),o=i.n(n);i.d(t,"a",function(){return a.a}),i.d(t,"c",function(){return o.a});var s=function(){return window.innerWidth<=parseInt(o.a.responsiveBreakpointXSmall)}},,function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(30)),n=i(2);i.d(t,"a",function(){return n.b}),t.b={name:"WithOptionTypes",optionTypes:{},initialize:function(){},setOptions:function(e){var t=Object(r.extend)({},this.options,Object(a.a)(e));this.isMounted&&this.viewWillReceiveOptions(t),this.update(t,this.state,!1)},viewWillReceiveOptions:function(){},checkOptionTypes:function(){Object(n.a)(this.optionTypes,this.options,"option",this.displayName||"View")}}},function(e,t,i){"use strict";var r=function(e){var t=e||{};return window.location&&window.location.hash?(window.location.hash.substr(1).split(",").forEach(function(e){var i=e.split("="),r=i[0],a=i[1];if("debug3d"===r&&(t.debug3D=!0),"stats"===r&&(t.stats=!0),r.match("material_"))switch(r=r.substr(9)){case"showcase":t.materialShowcase=void 0===a?t.materialShowcase:"0"!==a;break;case"names":t.materialNames=a;break;case"normal":t.materialNormal=a;break;case"emissive":t.materialEmissive=a;break;case"transparency":t.materialTransparency=a;break;case"diffuse":t.materialDiffuse=a;break;case"metalness":t.materialMetalness=a;break;case"roughness":t.materialRoughness=a;break;case"glossiness":t.materialGlossiness=a;break;case"specular":t.materialSpecular=a;break;case"cavity":t.materialCavity=a;break;case"f0":t.materialF0=a;break;case"ao":t.materialAO=a;break;case"displacement":t.materialDisplacement=a;break;case"displacement_factor":t.materialDisplacementFactor=void 0===a?t.materialDisplacementFactor:Number(a)}}),t):t};t.a=r},,,,,,,,,,,,function(e,t){e.exports={allow_swift_shader:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Allow swift shader software rendering."},animation_autoplay:{type:"bool",defaultValue:!0,values:"0, 1",share:"private",help:"Automatically play animations when the viewer starts."},anisotropy:{type:"bool",defaultValue:!0,values:"0, 1",share:"private",help:"If we activate anisotropy when trilinear is chosen."},annotation:{type:"number",defaultValue:0,values:"[1, 50]",share:"public",help:"Setting to [1, 50] will automatically load that annotation when the viewer starts."},annotation_cycle:{type:"number",defaultValue:null,values:"+X",share:"public",help:"Setting to any number will start the Autopilot cycle with that duration, in seconds, at each annotation."},annotations_visible:{type:"bool",defaultValue:null,values:"0, 1",share:"public",help:"Setting to 0 will hide annotations by default."},api_version:{type:"string",defaultValue:null,values:"string",share:"private",help:"The version of the viewer API."},arkit:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Initialize the viewer in ARKit mode"},arkit_debug:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Enter in debug mode for ar to debug in a desktop browser"},async_image:{type:"bool",defaultValue:!1,values:"0, 1",share:"shared",help:"Loads png and jpg in asynchronous (memory overhead for now so disabled by default)."},autospin:{type:"number",defaultValue:0,values:"+/-X",share:"public",help:"Setting to any number will cause the model to automatically spin around the z-axis after loading. The greater the number, the faster the spin. A negative number will reverse the spin direction."},autostart:{type:"bool",defaultValue:!1,values:"0, 1",share:"public",help:"Setting to 1 will make the model load immediately once the page is ready, rather than waiting for a user to click the Play button."},camera:{type:"bool",defaultValue:!0,values:"0, 1",share:"public",help:"Setting to 0 will skip the initial animation that occurs when a model is loaded, and immediately show the model in its default position."},camera_constraints:{type:"bool",defaultValue:!0,values:"0, 1",share:"shared",help:"Enable / Disable camera limits"},camera_easing:{type:"number",defaultValue:null,values:"0..1",share:"private",help:"0 means no easing."},camera_eye:{type:"vec3",defaultValue:null,values:"X,Y,Z",share:"private",help:"Forces position of the camera."},camera_follow_bones:{type:"number",defaultValue:0,values:"0, 1, 2",share:"private",help:"1: translate eye 2: focus eye. You need to double-click the model on an animated part first."},camera_target:{type:"vec3",defaultValue:null,values:"0, 1",share:"private",help:"Forces the target of the camera."},cardboard:{type:"number",defaultValue:0,values:"0, 1, 2",share:"public",help:"Start in VR Mode automatically."},carmel:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"If we are in the carmel context."},ui_color:{type:"string",defaultValue:"",values:"",share:"private",limited_to:"ent",help:"The primary color of the ui."},continuous_render:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Redraw continuously."},convert_vertex_color_8bit:{type:"bool",defaultValue:!0,values:"0, 1",share:"private",help:"Converts vertex color in 8bit."},debug3d:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Open a dat.gui panel to debug 3d stuffs."},depth_mipmap:{type:"bool",defaultValue:0,values:"+X",share:"private",help:"Uses depth mipmap."},dof_attenuate_distance:{type:"bool",defaultValue:!0,values:"0, 1",share:"private",help:"Attenuates dof effect when we unzoom."},dof_attenuate_speed:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Attenuates dof effect when we move the camera."},dof_res:{type:"number",defaultValue:2,values:"+X",share:"private",help:"Resolution divider of dof postprocess (2 means half resolution)."},dof_sticky:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"If the dof focus point sticks on the same place."},dof_transition:{type:"bool",defaultValue:!0,values:"0, 1",share:"private",help:"If there is a transition when changing the dof focus point."},double_click:{type:"bool",defaultValue:!0,values:"0, 1",share:"shared",help:"If we allow double-click (focus constraint)."},download_picture:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Download the thumbnail on Save View."},drs:{type:"bool",defaultValue:!0,values:"0, 1",share:"private",help:"Enables dynamic resolution scaling."},drs_ratio:{type:"number",defaultValue:1,values:"+X",share:"private",help:"Speeds at which we reduce the resolution."},drs_fps:{type:"number",defaultValue:15,values:"0..1",share:"private",help:"Minimum before reducing the resolution."},drs_min:{type:"number",defaultValue:null,values:"0..1",share:"private",help:"Minimum resoluton rate allowed, by default value is (1.0 / canvasPixelRatio)."},drs_test:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Alternates between 2 drs values (for debugging purpose)."},epsilon_alpha:{type:"number",defaultValue:1e-5,values:"0..1",share:"private",help:"GPU workaround bug with epsilon alpha discard threshold."},float_rtt:{type:"number",defaultValue:2,values:"0, 1, 2",share:"private",help:"0 : force 8bit, 1 force float if supported, 2 : depends (dynamic)."},force_controller:{type:"string",defaultValue:"",values:"vive, daydream, oculus, windows",share:"private",help:"Force display of controller (debug)."},force_controller_orientation:{type:"number",defaultValue:-.5,values:"-2..2",share:"private",help:"Rotates the controller when set: -2 is -2PI, 2 is 2PI"},force_controller_ray_orientation:{type:"number",defaultValue:-.075,values:"-2..2",share:"private",help:"Rotates the teleport ray when set: -2 is -2PI, 2 is 2PI"},force_ms:{type:"number",defaultValue:0,values:"+X",share:"private",help:"Forces framerate with a setTimeout (in ms, 0 means requestAnimationFrame)."},force_triangles:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Forces merge of TRIANGLE and TRIANGLE_STRIP."},fps_speed:{type:"number",defaultValue:5,values:"+X",share:"public",help:"Set the default walk speed in First-Person."},fxaa:{type:"bool",defaultValue:null,values:"0, 1",share:"private",help:"Uses fxaa."},grain_speed:{type:"number",defaultValue:64,values:"+X",share:"private",help:"Grain animation speed, in ms."},graph_optimizer:{type:"bool",defaultValue:null,values:"+X",share:"private",help:"Optimizes mesh (merge and bake geometries, etc), disabled by default in some cases (editor, api, processing)."},image_compression:{type:"bool",defaultValue:null,values:"0, 1",share:"shared",help:"Use the full resolution, original textures (false in editor, true in viewer)."},internal:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Allows us to use limited parameters on whitelisted domains (e.g. hide the watermark on sketchfab.com)."},is_app:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"If we are in the mobile app context."},keep_empty_geometries:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"If we want to keep the empty geometries in the scene graph instead of removing them."},material_ao:{type:"string",defaultValue:null,values:"0, 1",share:"private",help:"override ao channel for material given by material_names option."},material_cavity:{type:"string",defaultValue:null,values:"0, 1",share:"private",help:"override cavity channel for material given by material_names option."},material_diffuse:{type:"string",defaultValue:null,values:"0, 1",share:"private",help:"override diffuse channel for material given by material_names option."},material_displacement:{type:"string",defaultValue:null,values:"0, 1",share:"private",help:"override displacement channel for material given by material_names option."},material_displacement_factor:{type:"number",defaultValue:null,values:"+X",share:"private",help:"override displacement factor channel for material given by material_names option."},material_emissive:{type:"string",defaultValue:null,values:"0, 1",share:"private",help:"override emissive channel for material given by material_names option."},material_f0:{type:"string",defaultValue:null,values:"0, 1",share:"private",help:"override f0 channel for material given by material_names option."},material_glossiness:{type:"string",defaultValue:null,values:"0, 1",share:"private",help:"override glossiness channel for material given by material_names option."},material_metalness:{type:"string",defaultValue:null,values:"0, 1",share:"private",help:"override metalness channel for material given by material_names option."},material_names:{type:"string",defaultValue:"main_material",values:"0, 1",share:"private",help:"Multiple names are separated with ; For example material_names=mat1;mat2."},material_normal:{type:"string",defaultValue:null,values:"0, 1",share:"private",help:"override normal channel for material given by material_names option."},material_packing:{type:"bool",defaultValue:null,values:"0, 1",share:"private",help:"Pack texture materials."},material_roughness:{type:"string",defaultValue:null,values:"0, 1",share:"private",help:"override roughness channel for material given by material_names option."},material_showcase:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Enables material showcase."},material_specular:{type:"string",defaultValue:null,values:"0, 1",share:"private",help:"override specular channel for material given by material_names option."},material_transparency:{type:"string",defaultValue:null,values:"0, 1",share:"private",help:"override opacity channel for material given by material_names option."},max_texture_units:{type:"number",defaultValue:32,values:"+X",share:"private",help:"Sets maximum count of texture units."},max_texture_size:{type:"number",defaultValue:8192,values:"+X",share:"private",help:"All texture capped at that texture size."},max_vertex_uniforms:{type:"number",defaultValue:8192,values:"+X",share:"private",help:"Sets max vertex uniform."},merge_materials:{type:"bool",defaultValue:null,values:"0, 1",share:"private",help:"Merge similar materials."},messaging:{type:"bool",defaultValue:null,values:"0, 1",share:"private"},model:{type:"string",defaultValue:null,values:"uid",share:"UID of model to hook."},model_optimization:{defaultValue:null,help:"Use the unoptimized editor build.",share:"private",type:"bool",values:"0, 1"},morph_epsilon:{defaultValue:.05,help:"Epsilon to limit the number of interpolated morph targets per frame.",share:"private",type:"number",values:"+X"},morph_gpu:{defaultValue:4,help:"Maximum morph gpu allowed (rest is done on the cpu), minimum value is 1.",share:"private",type:"number",values:"[1, +X]"},navigation:{type:"string",defaultValue:"orbit",values:"orbit, fps",share:"public",help:"Choose between fps and orbit mode."},normal_compression:{type:"string",defaultValue:null,values:"percep, jpg",share:"private",help:"In case of astc normalmap, choose between astc and jpg."},orbit_constraint_pan:{type:"bool",defaultValue:null,values:"0, 1",share:"shared",help:"Disable panning"},orbit_constraint_pitch_down:{type:"number",defaultValue:null,values:"[-PI/2, PI/2]",share:"shared",help:"Pitch down limit."},orbit_constraint_pitch_up:{type:"number",defaultValue:null,values:"[-PI/2, PI/2]",share:"shared",help:"Pitch up limit."},orbit_constraint_yaw_left:{type:"number",defaultValue:null,values:"[-PI, PI]",share:"shared",help:"Yaw left limit."},orbit_constraint_yaw_right:{type:"number",defaultValue:null,values:"[-PI, PI]",share:"shared",help:"Yaw right limit."},orbit_constraint_zoom_in:{type:"number",defaultValue:null,values:"+X",share:"shared",help:"Zoom in limit."},orbit_constraint_zoom_out:{type:"number",defaultValue:null,values:"+X",share:"shared",help:"Zoom out limit."},panorama:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Uses panorama hdr instead of cubemap."},pixel_budget:{type:"number",defaultValue:null,values:"+X",share:"private",help:"0 is infinite, x is nb of pixel (e.g 4096)."},pratio:{type:"number",defaultValue:null,values:"+X",share:"private",help:"For debugging, same as osgjs overrideDevicePixelRatio (but shorter)."},post_process:{type:"bool",defaultValue:null,values:"0, 1",share:"private",help:"If postprocess filters are enabled."},power_preference:{type:"string",defaultValue:"default",values:"default|low-power|high-performance",share:"private",help:"Hint for gpu (power battery vs performance). Setting high-performance might be unsafe (context lost), so be wary."},preload:{type:"bool",defaultValue:!1,values:"0, 1",share:"public",help:"Download all textures before displaying the model."},preserve_drawing_buffer:{type:"bool",defaultValue:!1,values:"0, 1",share:"public",help:"WebGL canvas option."},process_material:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Reprocess materials."},process_options:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Reprocess all the options (same as a reupload without backend reprocessing)."},quality:{type:"number",defaultValue:null,values:"+X",share:"private",help:"Quality of viewer (null means it depends of the fps), for now it only impacts a few postprocesses."},refraction_res:{type:"number",defaultValue:1,values:"+X",share:"private",help:"Resolution divider of refraction texture (2 means half resolution)."},resize_timeout:{type:"number",defaultValue:1e3,values:"+X",share:"shared",help:"Resize timeout when the size is stable (in ms)."},rgbm:{type:"bool",defaultValue:!0,values:"0, 1",share:"private",help:"For quick visual framebuffer debugging (spectorjs)."},scale:{type:"number",defaultValue:1,values:"+X",share:"private",help:"Scale the scene (for debugging)."},scrollwheel:{type:"bool",defaultValue:!0,values:"0, 1",share:"public",help:"Disable zooming with scrollwheel (Ctrl+Click/drag still zooms)."},shadow:{type:"bool",defaultValue:!0,values:"0, 1",share:"private",help:"enable shadow"},shadow_atlas:{type:"bool",defaultValue:!0,values:"0, 1",share:"private",help:"enable shadow atlas."},shadow_jitter_offset:{type:"string",defaultValue:"default",values:"default, none",share:"private",help:"If we use jitter offset shadow."},shadow_normal_offset:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"If we use normal offset shadow bias."},shadow_PCF:{type:"string",defaultValue:"1Tap(4texFetch)",values:"1Tap(4texFetch), 4Tap(16texFetch), 9Tap(36texFetch), 16Tap(64texFetch)",share:"private",help:"Shadow attempt to fight aliasing complex settings."},shadow_texture_size:{type:"number",defaultValue:1024,values:"+X",share:"private",help:"Size of shadowmaps."},share:{type:"bool",defaultValue:!1},show_bones:{type:"number",defaultValue:0,values:"0, 1, 2, 3",share:"private",help:"1: Skeleton only, 2: Skeleton + Mesh, 3: Bounding boxes"},single_sided:{type:"bool",defaultValue:null,values:"0, 1",share:"private",help:"Force single sided (or double sided) on all material"},snap_keyframe:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Snap on keyframes."},sound_enable:{type:"bool",defaultValue:!0,values:"0, 1",share:"private",help:"Enables the sound feature"},sound_mute:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Mute any sound"},sound_preload:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Preloads the sounds"},split_limit:{type:"number",defaultValue:65535,values:"+X",share:"private",help:"Graph optimizer split limit"},ssao_normal:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"DEBUG ONLY! otherwise needs mrt."},ssr:{type:"bool",defaultValue:null,values:"0, 1",share:"private",help:"Forces screen space reflection."},ssr_transparent:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Enables SSR on transparent material (additive/blending/refraction)."},sss_jitter:{type:"number",defaultValue:1,values:"[0, 1]",share:"private",help:"SSS jitter force ."},sss_kernel:{type:"number",defaultValue:17,values:"11, 17, 25",share:"private",help:"Kernel size for diffuse kernel scattering."},stats:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"OSGJS option to display stats"},svg_size:{type:"number",defaultValue:2048,values:"+X",share:"private",help:"Default svg size."},substance_displacement:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Moves vertices in y dimension only (displacement map)."},supersample:{type:"bool",defaultValue:!0,values:"0, 1",share:"private",help:"If accumulation supersample is enabled or not."},tracking:{type:"bool",defaultValue:!0,limited_to:"staff"},taa:{type:"bool",defaultValue:null,values:"0, 1",share:"private",help:"Forces disabling/enabling of Temporal Anti-Aliasing."},taa_animation:{type:"bool",defaultValue:!1,values:"[0, 1]",share:"private",help:"If we allow taa while an animation is playing."},taa_feedback_max:{type:"number",defaultValue:.97,values:"[0, 1]",share:"private",help:"Feedback controls how much the current and the previous frames are blended together. The blending is done within the [min,max] range."},taa_feedback_min:{type:"number",defaultValue:.88,values:"[0, 1]",share:"private",help:"Feedback controls how much the current and the previous frames are blended together. The blending is done within the [min,max] range."},taa_jitter:{type:"bool",defaultValue:null,values:"0, 1",share:"private",help:"Enable/Disable jittering when not supersampling."},taa_transparent:{type:"bool",defaultValue:null,values:"0, 1",share:"private",help:"Enables taa on transparent objects."},tab:{type:"string",defaultValue:null,values:"scene, lighting, materials, post processing filters, annotations, animation, virtual reality, sound",share:"private",help:"Default tab opening in the editor (note: the web is not using getOptions, the entry is here for documentation only)."},transparent:{type:"bool",defaultValue:!1,values:"0, 1",share:"public",limited_to:"pro",help:"Makes the background transparent."},ui_animations:{type:"bool",defaultValue:!0,values:"0, 1",share:"public",limited_to:"prem",help:"Hide Animation menu / timeline."},ui_annotations:{type:"bool",defaultValue:!0,values:"0, 1",share:"public",limited_to:"prem",help:"Hide Annotation menu / controls."},ui_controls:{type:"bool",defaultValue:!0,values:"0, 1",share:"public",limited_to:"prem",help:"Hide help, Settings, VR, Fullscreen."},ui_fadeout:{type:"bool",defaultValue:!0,limited_to:"prem"},ui_fullscreen:{type:"bool",defaultValue:!0,values:"0, 1",share:"public",limited_to:"prem",help:"Hide Fullscreen button."},ui_general_controls:{type:"bool",defaultValue:!0,values:"0, 1",share:"public",limited_to:"prem",help:"Hide all viewer controls."},ui_help:{type:"bool",defaultValue:!0,values:"0, 1",share:"public",limited_to:"prem",help:"Hide help button."},ui_hint:{type:"number",defaultValue:1,values:"0, 1, 2",share:"private",help:"Hide viewer hint."},ui_infos:{type:"bool",defaultValue:!0,values:"0, 1",share:"public",limited_to:"prem",alias:["desc_button"],help:"Hide top info bar."},ui_inspector:{type:"bool",defaultValue:!0,values:"0, 1",share:"private",limited_to:"prem",help:"Show model inspector."},ui_inspector_open:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Show model inspector open on start."},ui_related:{type:"bool",defaultValue:!0,values:"0, 1",share:"public",limited_to:"pro",help:"Hide related models."},ui_settings:{type:"bool",defaultValue:!0,values:"0, 1",share:"public",limited_to:"prem",help:"Hide Settings button."},ui_snapshots:{type:"bool",defaultValue:!1,values:"0, 1",share:"public",help:"Show Save View button."},ui_sound:{type:"bool",defaultValue:!0,limited_to:"staff"},ui_stop:{type:"bool",defaultValue:!0,values:"0, 1",share:"public",alias:["stop_button"],help:"Hide Stop Viewer button. "},ui_theatre:{type:"bool",defaultValue:!1,limited_to:"prem"},ui_vr:{type:"bool",defaultValue:!0,values:"0, 1",share:"public",limited_to:"prem",help:"Hide View in VR button."},ui_watermark:{type:"bool",defaultValue:!0,alias:["watermark"],limited_to:"ent",help:"Disable watermark when false."},ui_watermark_link:{type:"bool",defaultValue:!0,limited_to:"biz",help:"Disable link in watermark when false."},unit_render_local:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Uses for unit render test."},unit_render_reporter:{type:"string",defaultValue:"html",values:"console, html",share:"private",help:"To run 1 uid in /tests/screenshot"},unit_render_task:{type:"number",defaultValue:null,values:"index",share:"private",help:"To run only one test in /tests/screenshot"},use_vao:{type:"bool",defaultValue:!0,values:"0, 1",share:"private",help:"If we use the VAO gl extension."},varying_sorting:{type:"bool",defaultValue:!0,values:"0, 1",share:"private",help:"Hack because of earlyz (bug gpu)."},vr_ar:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"transparent background and no floor (to test)"},vr_browser_env:{type:"string",defaultValue:"c0022acc4f3242e2bcae8043e08df8cc",values:"uid",share:"private",help:"Model UID of the environment model for the vr browse."},vr_fade:{type:"number",defaultValue:200,values:"+X",share:"private",help:"Fade time of the black transition in vr."},vr_launcher_alpha_card_factor:{type:"number",defaultValue:1,values:"+X",share:"private",help:"Alpha card factor."},vr_mirror:{type:"bool",defaultValue:!1,values:"0, 1",share:"public",help:"Copy VR headset view on desktop screen."},vr_mobile_max_faces:{type:"number",defaultValue:5e4,values:"+X",share:"public",help:"Filter the fetched models in vr on mobile to those with a face count below the value"},vr_generate_ui_textures:{type:"bool",defaultValue:!0,values:"0, 1",share:"private",help:"Set to false to disable the UI texture generation in VR (fallback for ios app)"},vr_force_raf:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"Debug only (force replacement of native raf with hmd raf)."},vr_link_navigation:{type:"bool",defaultValue:0,values:"0, 1",share:"private",help:"1 means the vr launcher use standards link navigation to navigate in VR."},vr_in_navigation:{type:"bool",defaultValue:0,values:"0, 1",share:"private",help:"1 means browser is in vr."},vr_scale_rtt:{type:"number",defaultValue:0,values:"+X",share:"private",help:"If not 0, it will scale the size of te recommended vr renderTarget."},vr_stereo:{type:"bool",defaultValue:!0,values:"0, 1",share:"private",help:"Mostly for debugging vr on desktop: disable stereo view in vr context."},webgl2:{type:"bool",defaultValue:null,values:"0, 1",share:"shared",help:"Uses webgl2 instead of webgl1 if provided."},webgl_timer_gpu:{type:"bool",defaultValue:!1,values:"0, 1",share:"private",help:"when false, disables gpu timer queries for cleaner gl traces."},webgl_restore:{type:"number",defaultValue:3,values:"+X",share:"private",help:"when 0, enables webgl restore on other browser than Edge."}}},function(e,t,i){"use strict";var r=i(8);t.a=r.a.extend({constructor:function(e){this.viewer=e.viewer,this.widgets=e.widgets,r.a.apply(this,arguments)},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.$el.addClass("disabled")},isEnabled:function(){return this.$el.hasClass("disabled")}})},,,,,,,,,,,,,,,,function(e,t,i){"use strict";var r=i(71),a=i(58),n=i(9),o=function(){r.a.call(this),this._parents=[],this._attributeArray=[],this._textureAttributeArrayList=[],this._activeTextureAttributeUnit=[],this._activeAttribute=[],this._activeTextureAttribute=[],this._binName=void 0,this._binNumber=0,this._shaderGeneratorPair=null,this._updateCallbackList=[],this.uniforms={},this._hasUniform=!1,this._drawID=-1};o.AttributePair=function(e,t){this._object=e,this._value=t},o.AttributePair.prototype={getShaderGeneratorName:function(){return this._object},getAttribute:function(){return this._object},getUniform:function(){return this._object},getValue:function(){return this._value}},n.a.createPrototypeObject(o,n.a.objectInherit(r.a.prototype,{setDrawID:function(e){this._drawID=e},getDrawID:function(){return this._drawID},getAttributePair:function(e,t){return new o.AttributePair(e,t)},addUniform:function(e,t){var i=void 0!==t?t:a.a.ON,r=e.getName();this.uniforms[r]=this.getAttributePair(e,i),this._hasUniform=!0},addParent:function(e){this._parents.push(e)},removeParent:function(e){var t=this._parents.indexOf(e);-1!==t&&this._parents.splice(t,1)},removeUniform:function(e){this.removeUniformByName(e.getName())},removeUniformByName:function(e){delete this.uniforms[e],this._hasUniform=!!window.Object.keys(this.uniforms).length},hasUniform:function(){return this._hasUniform},getUniform:function(e){var t=this.uniforms;if(t[e])return t[e].getAttribute()},getUniformList:function(){return this.uniforms},setTextureAttributeAndModes:function(e,t,i){this._setTextureAttribute(e,this.getAttributePair(t,void 0!==i?i:a.a.ON))},getNumTextureAttributeLists:function(){return this._textureAttributeArrayList.length},getTextureAttribute:function(e,t){var i=n.a.getTextureIdFromTypeMember(t);if(void 0!==i&&this._hasTextureAttribute(e,i)){var r=this._textureAttributeArrayList[e];return r[i]?r[i].getAttribute():void 0}},removeTextureAttribute:function(e,t){var i=n.a.getTextureIdFromTypeMember(t);if(void 0!==i&&this._hasTextureAttribute(e,i)){this._textureAttributeArrayList[e][i]=void 0,this._computeValidTextureUnit()}},getAttribute:function(e){var t=n.a.getIdFromTypeMember(e);if(void 0!==t&&this._hasAttribute(t))return this._attributeArray[t].getAttribute()},setAttributeAndModes:function(e,t){this._setAttribute(this.getAttributePair(e,void 0!==t?t:a.a.ON))},setAttribute:function(e,t){this.setAttributeAndModes(e,t)},removeAttribute:function(e){var t=n.a.getIdFromTypeMember(e);this._hasAttribute(t)&&(this._attributeArray[t]=void 0,this._computeValidAttribute())},setRenderingHint:function(e){"OPAQUE_BIN"===e?this.setRenderBinDetails(0,"RenderBin"):"TRANSPARENT_BIN"===e?this.setRenderBinDetails(10,"DepthSortedBin"):this.setRenderBinDetails(0,"")},getUpdateCallbackList:function(){return this._updateCallbackList},removeUpdateCallback:function(e){var t=this._updateCallbackList.indexOf(e);if(-1!==t&&(this._updateCallbackList.splice(t,1),0===this._updateCallbackList.length))for(var i=this._parents,r=0,a=i.length;r<a;r++){var n=i[r];n.setNumChildrenRequiringUpdateTraversal(n.getNumChildrenRequiringUpdateTraversal()-1)}},requiresUpdateTraversal:function(){return!!this._updateCallbackList.length},addUpdateCallback:function(e){var t=Boolean(this._updateCallbackList.length);if(this._updateCallbackList.push(e),!t)for(var i=this._parents,r=0,a=i.length;r<a;r++){var n=i[r];n.setNumChildrenRequiringUpdateTraversal(n.getNumChildrenRequiringUpdateTraversal()+1)}},hasUpdateCallback:function(e){return-1!==this._updateCallbackList.indexOf(e)},setRenderBinDetails:function(e,t){this._binNumber=e,this._binName=t},getAttributeMap:function(){for(var e={},t=0,i=this._attributeArray.length;t<i;t++){var r=this._attributeArray[t];if(r){e[r.getAttribute().getTypeMember()]=r}}return e},getBinNumber:function(){return this._binNumber},getBinName:function(){return this._binName},setBinNumber:function(e){this._binNumber=e},setBinName:function(e){this._binName=e},getAttributeList:function(){for(var e=this._attributeArray,t=[],i=0,r=e.length;i<r;i++)e[i]&&t.push(e[i]);return t},setShaderGeneratorName:function(e,t){this._shaderGeneratorPair=this.getAttributePair(e,void 0!==t?t:a.a.ON)},getShaderGeneratorPair:function(){return this._shaderGeneratorPair},getShaderGeneratorName:function(){return this._shaderGeneratorPair?this._shaderGeneratorPair.getShaderGeneratorName():void 0},releaseGLObjects:function(){for(var e=0,t=this._textureAttributeArrayList.length;e<t;e++){var i=this.getTextureAttribute(e,"Texture");i&&i.releaseGLObjects()}for(var r=this.getAttributeList(),a=0,n=r.length;a<n;a++)r[a]._object.releaseGLObjects&&r[a]._object.releaseGLObjects()},_setTextureAttribute:function(e,t){n.a.arrayDense(e,this._textureAttributeArrayList),this._textureAttributeArrayList[e]||(this._textureAttributeArrayList[e]=[]);var i=n.a.getOrCreateTextureStateAttributeTypeMemberIndex(t.getAttribute());n.a.arrayDense(i,this._textureAttributeArrayList[e]),this._textureAttributeArrayList[e][i]=t,this._computeValidTextureUnit()},_computeValidTextureUnit:function(){this._activeTextureAttributeUnit.length=0,this._activeTextureAttribute.length=0;for(var e=this._textureAttributeArrayList,t=0,i=e.length;t<i;t++){var r=e[t];if(r&&r.length){for(var a=!1,n=0,o=r.length;n<o;n++)r[n]&&(a=!0,-1===this._activeTextureAttribute.indexOf(n)&&this._activeTextureAttribute.push(n));a&&this._activeTextureAttributeUnit.push(t)}}},_computeValidAttribute:function(){this._activeAttribute.length=0;for(var e=this._attributeArray,t=0,i=e.length;t<i;t++)e[t]&&this._activeAttribute.push(t)},_setAttribute:function(e){var t=n.a.getOrCreateStateAttributeTypeMemberIndex(e.getAttribute());n.a.arrayDense(t,this._attributeArray),this._attributeArray[t]=e,this._computeValidAttribute()},_hasAttribute:function(e){return!(e>=this._attributeArray.length)&&!!this._attributeArray[e]},_hasTextureAttribute:function(e,t){return!(e>=this._textureAttributeArrayList.length||!this._textureAttributeArrayList[e])&&(!(t>=this._textureAttributeArrayList[e].length)&&!!this._textureAttributeArrayList[e][t])}}),"osg","StateSet"),t.a=o},function(e,t,i){"use strict";var r=i(99),a=function(e,t){this.mode=r.a.POINTS,void 0!==e&&("string"==typeof e&&(e=r.a[e]),this.mode=e),this.count=0,this.offset=0,this.indices=t,this.uType=a.UNSIGNED_SHORT,void 0!==t&&this.setIndices(t)};a.UNSIGNED_BYTE=5121,a.UNSIGNED_SHORT=5123,a.UNSIGNED_INT=5125,a.prototype={getMode:function(){return this.mode},draw:function(e){0!==this.count&&(e.setIndexArray(this.indices),this.drawElements(e))},drawElements:function(e){e.getGraphicContext().drawElements(this.mode,this.count,this.uType,this.offset)},setIndices:function(e){this.indices=e;var t=e.getElements();this.count=t.length;var i=t.BYTES_PER_ELEMENT;1===i?this.uType=a.UNSIGNED_BYTE:2===i?this.uType=a.UNSIGNED_SHORT:4===i&&(this.uType=a.UNSIGNED_INT)},getIndices:function(){return this.indices},setFirst:function(e){this.offset=e},getFirst:function(){return this.offset},setCount:function(e){this.count=e},getCount:function(){return this.count},getNumIndices:function(){return this.indices.getElements().length},index:function(e){return this.indices.getElements()[e]}},t.a=a},function(e,t,i){"use strict";var r=function(){this._pool=[],this._length=0};r.prototype={clean:function(){this._length=0,this._pool.length=0},reset:function(){this._length=0},getLength:function(){return this._length},getArray:function(){return this._pool},back:function(){return this._pool[this._length-1]},pop:function(){return this._length--,this._pool[this._length]},push:function(e){this._length===this._pool.length?this._pool.push(e):this._pool[this._length]=e,this._length++},forEach:function(e){for(var t=0;t<this._length;t++)e(this._pool[t])}},t.a=r},function(e,t,i){"use strict";var r=i(99),a=function(e,t,i){this.mode=e,void 0!==e&&("string"==typeof e&&(e=r.a[e]),this.mode=e),this.first=t,this.count=i};a.prototype={draw:function(e){if(0!==this.count){e.getGraphicContext().drawArrays(this.mode,this.first,this.count)}},getMode:function(){return this.mode},setCount:function(e){this.count=e},getCount:function(){return this.count},setFirst:function(e){this.first=e},getFirst:function(){return this.first},getNumIndices:function(){return this.count},index:function(e){return this.first+e}},t.a=a},function(e,t,i){"use strict";var r,a=i(9),n=i(21),o=i(585),s=i(397),u=i(58),l=i(592),c=i(213),h=o.a.getOptionsURL().shaderStats?{}:void 0,d=new Uint8Array(4),p=function(e){e.flush(),e.finish(),e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,d)},f=new l.a,m=/uniform\s+\w+\s+(\w+)((\s)?\[(.*?)\])?/g,g=/(in|attribute)\s+\w+\s+(\w+)\s*;/g,_=function(e){for(var t,i,r={};null!==(t=g.exec(e));)i=t[2],r[i]=!0;return r},v=function(e){for(var t,i={};null!==(t=m.exec(e));){i[t[1]]=!0}return i},b=function(e,t){s.a.call(this),u.a.call(this),this._program=null,this._nullProgram=!0,this._vertex=void 0,this._fragment=void 0,this._uniformsCache=void 0,this._attributesCache=void 0,this._activeUniforms=void 0,this._foreignUniforms=void 0,this._trackAttributes=void 0,e&&this.setVertexShader(e),t&&this.setFragmentShader(t),this._dirty=!0};b._sDeletedGLProgramCache=new window.Map,b.deleteGLProgram=function(e,t){b._sDeletedGLProgramCache.has(e)||b._sDeletedGLProgramCache.set(e,[]),b._sDeletedGLProgramCache.get(e).push(t)},b.flushDeletedGLPrograms=function(e,t){if(t<=0)return t;if(!b._sDeletedGLProgramCache.has(e))return t;for(var i=0,r=c.a.instance().tick(),a=b._sDeletedGLProgramCache.get(e),n=a.length,o=n-1;o>=0&&i<t;o--)e.deleteProgram(a[o]),a.splice(o,1),i=c.a.instance().deltaS(r,c.a.instance().tick());return t-i},b.flushAllDeletedGLPrograms=function(e){if(b._sDeletedGLProgramCache.has(e))for(var t=b._sDeletedGLProgramCache.get(e),i=t.length,r=i-1;r>=0;r--)e.deleteProgram(t[r]),t.splice(r,1)},b.onLostContext=function(e){if(b._sDeletedGLProgramCache.has(e)){b._sDeletedGLProgramCache.get(e).length=0}},a.a.createPrototypeStateAttribute(b,a.a.objectInherit(s.a.prototype,a.a.objectInherit(u.a.prototype,{attributeType:"Program",cloneType:function(){return new b},setVertexShader:function(e){this._vertex=e,this._nullProgram=!1,e.setText(f.processShader(e.getText()))},setFragmentShader:function(e){this._fragment=e,this._nullProgram=!1,e.setText(f.processShader(e.getText()))},getVertexShader:function(){return this._vertex},getFragmentShader:function(){return this._fragment},getProgram:function(){return this._program},setActiveUniforms:function(e){this._activeUniforms=e},getActiveUniforms:function(){return this._activeUniforms},setForeignUniforms:function(e){this._foreignUniforms=e},getForeignUniforms:function(){return this._foreignUniforms},setUniformsCache:function(e){this._uniformsCache=e},getUniformsCache:function(){return this._uniformsCache},setAttributesCache:function(e){this._attributesCache=e},getAttributesCache:function(){return this._attributesCache},setTrackAttributes:function(e){this._trackAttributes=e},getTrackAttributes:function(){return this._trackAttributes},releaseGLObjects:function(){void 0!==this._vertex&&this._vertex.releaseGLObjects(),void 0!==this._fragment&&this._fragment.releaseGLObjects(),null!==this._program&&(void 0!==this._gl&&(b.deleteGLProgram(this._gl,this._program),s.a.removeObject(this._gl,this)),this.invalidate())},dirty:function(){this._program=void 0},invalidate:function(){this._cacheUniformId=void 0,this._uniformsCache=void 0,this._attributesCache=void 0,this._foreignUniforms=void 0,this._trackAttributes=void 0,this._program=void 0},_rebuildProgramFromSpector:function(e,t,i,r){this._dirty=!0,this._vertex.invalidate(),this._fragment.invalidate(),this.invalidate(),this._vertex.setText(e),this._fragment.setText(t),this._spectorOnCompiled=i,this._spectorOnError=r},_onErrorToSpector:function(e){return!!this._spectorOnError&&(this._spectorOnError(e),!0)},_onCompilationToSpector:function(){this._spectorOnCompiled&&this._spectorOnCompiled(this._program)},_bindProgramToSpector:function(){window&&window.spector&&!this._program.__SPECTOR_rebuildProgram&&(this._program.__SPECTOR_rebuildProgram=this._rebuildProgramFromSpector.bind(this))},_logDebugShaders:function(e,t){if("Failed to create D3D shaders.\n"===t){var i=void 0!==e.rawgl?e.rawgl:e;void 0!==i&&void 0===i.getExtension&&(i=i.getExtension("WEBGL_debug_shaders"))&&(n.a.error(i.getTranslatedShaderSource(this._vertex.shader)),n.a.error(i.getTranslatedShaderSource(this._fragment.shader)))}},_activateFailSafe:function(e){var t=e.createProgram();this._vertex.failSafe(e,this._vertex.getText()),this._fragment.failSafe(e,this._fragment.getText()),this._glAttachAndCompile(e,t,this._vertex,this._fragment),n.a.warn("FailSafe shader Activated "),this._program=t},_glAttachAndCompile:function(e,t,i,r){e.attachShader(t,i.shader),e.attachShader(t,r.shader),e.linkProgram(t)},_glShaderCompile:function(e,t){if(t.shader)return!0;h&&(t===this._vertex?h.vert=c.a.tick():h.frag=c.a.tick());var i=t.compile(e,r);return h&&(p(e),t===this._vertex?h.vert=c.a.tick()-h.vert:h.frag=c.a.tick()-h.frag),i},compile:function(){var e=this._gl,t=this._fragment.getText(),i=this._vertex.getText();this._attributeMap=_(i),this._uniformMap=v(t+"\n"+i),h&&(h.vert=0,h.frag=0,h.link=0,h.total=0,p(e),h.total=c.a.tick());var r=this._glShaderCompile(e,this._vertex);if(!(r=this._glShaderCompile(e,this._fragment)&&r))return!1;if(h&&(h.link=c.a.tick()),this._program=e.createProgram(),this._attributeMap.Vertex&&e.bindAttribLocation(this._program,0,"Vertex"),this._glAttachAndCompile(e,this._program,this._vertex,this._fragment),h){e.getProgramParameter(this._program,e.LINK_STATUS),p(e),h.link=c.a.tick()-h.link,h.total=c.a.tick()-h.total;var a=t.match(/^#define\s+SHADER_NAME\s+(.*)$/m);a=a&&a[1]?a[1]:"";var n=a+" - "+h.total.toFixed(2)+"ms";console.group(n),console.log("vertex : "+h.vert.toFixed(2)+"ms"),console.log("fragment : "+h.frag.toFixed(2)+"ms"),console.log("link : "+h.link.toFixed(2)+"ms"),console.log("total : "+h.total.toFixed(2)+"ms"),console.groupEnd(n)}return!0},getCompilationResult:function(e,t){if(e)if(t.getProgramParameter(this._program,t.LINK_STATUS)||t.isContextLost())this._onCompilationToSpector(this._program);else{var i=t.getProgramInfoLog(this._program);if(n.a.errorFold(i,"can't link program\nvertex shader:\n"+this._vertex.text+"\n fragment shader:\n"+this._fragment.text),this._logDebugShaders(t,i),r&&r(this._vertex.text,this._fragment.text,i),e=!1,this._onErrorToSpector(i))return}return this._uniformsCache={},this._attributesCache={},e?(this.cacheAttributeList(t,window.Object.keys(this._attributeMap)),this.cacheUniformList(t,window.Object.keys(this._uniformMap))):this._activateFailSafe(t),this._bindProgramToSpector(),e},apply:function(e){if(!this._nullProgram){if(this._gl||this.setGraphicContext(e.getGraphicContext()),this._program&&!this._dirty)return void e.applyProgram(this._program);this._compileClean=this.compile(),this.getCompilationResult(this._compileClean,this._gl),e.applyProgram(this._program),this._dirty=!1}},cacheUniformList:function(e,t){for(var i=this._uniformsCache,r=0,a=t.length;r<a;r++){var n=t[r],o=e.getUniformLocation(this._program,n);void 0!==o&&null!==o&&void 0===i[n]&&(i[n]=o)}},cacheAttributeList:function(e,t){for(var i=this._attributesCache,r=0,a=t.length;r<a;r++){var n=t[r],o=e.getAttribLocation(this._program,n);-1!==o&&void 0!==o&&void 0===i[n]&&(i[n]=o)}}})),"osg","Program"),b.registerErrorCallback=function(e){r=e},t.a=b},function(e,t,i){"use strict";var r=i(7),a=i.n(r),n=i(5),o=i(0),s=(i.n(o),i(607)),u=i(606),l=i(34),c=i(37),h=n.a.osg,d=function(){h.Texture.call(this),this._isVideo=!1,this._requireOriginalCompression=!1,this._imageModel=void 0,this._convertNPOT=!0,this._truePackingRead=void 0};d.WAIT_ANIMATION=!0;var p=h.ImageStream.prototype.play;h.ImageStream.prototype.play=function(){this._status!==h.ImageStream.PLAYING&&(c.a.draw(),p.call(this))};var f=-1===navigator.userAgent.indexOf("Firefox/46");h.createPrototypeStateAttribute(d,h.objectInherit(h.Texture.prototype,{isVideo:function(){return this._isVideo},getOriginalFormat:function(){return this._truePackingRead||this.getInternalFormat()},_resizeToNearestPowerOf2:function(e){var t=document.createElement("canvas"),i=t.width=u.a.floorPowerOf2(e.getWidth()),r=t.height=u.a.floorPowerOf2(e.getHeight()),a=t.getContext("2d");a.drawImage(e.getImage(),0,0,i,r);var n=this._internalFormat;if(n===h.Texture.RGB||n===h.Texture.RGBA)return t;for(var o=a.getImageData(0,0,i,r).data,s=n===h.Texture.ALPHA?3:0,l=i*r,c=new Uint8Array(l),d=0;d<l;++d)c[d]=o[4*d+s];return this.setTextureSize(i,r),c},setImage:function(e,t){var i=e instanceof h.Image;if(!i||e.isDirty()||e!==this.getImage()&&e!==this._lastSetImage){this._lastSetImage=e;var r=e instanceof h.ImageStream;this._convertNPOT&&i&&!r&&(u.a.isPowerOf2(e.getWidth())&&u.a.isPowerOf2(e.getHeight())||(e.setDirty&&e.setDirty(!1),e=this._resizeToNearestPowerOf2(e))),!f&&this.hasMipmapFilter()&&this.setMinFilter(this.getMagFilter()),h.Texture.prototype.setImage.call(this,e,t),c.a.draw()}},applyTexImage2D:function(){h.Texture.prototype.applyTexImage2D.apply(this,arguments),c.a.draw()},getResourceManager:function(){return this._resourceManager||i(59).default.instance},setImageModel:function(e){this._imageModel=e,this._isVideo=e.isVideo(),this.updateRequireOriginalCompression();var t=this.getImageJSONMaxSupported();t.options&&"A"===t.options.format?(this._truePackingRead=h.Texture.ALPHA,this.setInternalFormat(h.Texture.LUMINANCE)):this._truePackingRead=void 0},getImageModel:function(){return this._imageModel},getImageCount:function(){var e=this._imageModel;return e&&e.getImages?e.getImages().length:this._image?1:0},setImageSmallest:function(){var e=this.getImageSmallest();if(e)return!0===e.promise.isFulfilled()&&e.image?this.setImage(e.image):this._setEntryImage(e,e.promise),e},setImageMaxSupported:function(){var e=this.getImageMaxSupported();if(e){var t=d.WAIT_ANIMATION?l.a.getFirstCameraAnimation():a.a.resolve(),i=a.a.all(Object(o.map)([t,e.promise,l.a.getLowResBound()],function(e){return e.reflect()}));return this._setEntryImage(e,i),e}},_setEntryImage:function(e,t){this._lastEntry=e,e.promise=t.then(function(){return this._lastEntry!==e?this._lastEntry.promise:(this.setImage(e.image),e.image)}.bind(this))},getImageSmallest:function(){if(this._imageModel){var e=this._requireOriginalCompression?void 0:this.getOriginalFormat(),t=this._imageModel.findImageNearestToResolution(128,128,e);return this.getResourceImage(t)}},updateRequireOriginalCompression:function(){var e=Object(s.a)(),t=this._imageModel.findImageNearestPowerOfTwoUpToResolution(e,e,this.getOriginalFormat()),i=this._imageModel.findImageNearestPowerOfTwoUpToResolution(e,e),r=Math.min(e,u.a.floorPowerOf2(i.width)),a=Math.min(e,u.a.floorPowerOf2(i.height));return this._requireOriginalCompression=t.width<r||t.height<a,this._requireOriginalCompression},getImageJSONMaxSupported:function(e){e=Object(s.a)(e);var t=this._requireOriginalCompression?void 0:this.getOriginalFormat();return this._imageModel.findImageNearestPowerOfTwoUpToResolution(e,e,t)},getImageMaxSupported:function(){if(this._imageModel)return this.getResourceImage(this.getImageJSONMaxSupported())},getImageWidget:function(){if(this._imageModel){var e=this._imageModel.findImageWidget();return e.options?e.options.widget=!0:e.options={widget:!0},this.getResourceImage(e,!0)}},getResourceImage:function(e,t){!t&&e.url&&e.width*e.height>1048576&&(e.options=e.options||{},e.options.decodeAsync=!0);var i=this.getResourceManager().getOrCreateImage(e.url,e.options);return i.promise.progressSize=e.size,i},getHash:function(){return"osgSketchfabTexture"}}),"osgSketchfab","MultiresTexture"),d.dummyTexture=new d,d.dummyTexture.setName("MultiresDummyTexture"),d.dummyTexture.setTextureSize(1,1),t.a=d},,,,,,,,function(e,t,i){"use strict";var r=i(3),a=i.n(r),n=i(0),o=(i.n(n),i(81));t.a=function(){var e=a.a.ajax;a.a.ajax=function(){var t=arguments.length>=2?arguments[1]:arguments[0];if(t=Object(n.extend)({allowPrefetching:!0,cacheBusting:!0},t),t.method)throw new Error('The "method" option is actually "type" ;)');if(t.allowPrefetch)throw new Error('The "allowPrefetch" option is actually "allowPrefetching" ;)');if(t.immediate&&!t.allowPrefetching)throw new Error('The "immediate" option cannot be used with "allowPrefetching" false (mutually exclusives)');if("GET"===t.type.toUpperCase()){var i=o.a.get(t.url);if(!i&&t.immediate)throw new Error('The "'+t.url+'" URL should be prefetched: immediate loading required');if(i&&t.allowPrefetching){var r={status:200,data:i};t.success&&t.success(r.data,"success",r),t.complete&&t.complete(r,"success");var s=a.a.Deferred().resolve(r.data,"success",r);return s.readyState=4,s.status=200,s.abort=function(){},s}var u=e.apply(this,arguments);return u.then(function(e,i,r){return o.a.register(t.url,e),a.a.Deferred().resolve(e,i,r)}),u}return"PATCH"===t.type.toUpperCase()?(o.a.update(t.url,"string"==typeof t.data?JSON.parse(t.data):t.data),e.apply(this,arguments)):t.cacheBusting?(o.a.invalidate(t.url),e.apply(this,arguments)):e.apply(this,arguments)}}},,,,,,,,,,,,,,,,function(e,t,i){"use strict";var r,a=i(118);window.requestAnimationFrame&&(r=Object(a.a)()?function(){return 0}:window.requestAnimationFrame.bind(window)),t.a={get:function(){return r}}},,function(e,t,i){"use strict";var r=function(){var e=window||global;if(void 0===e.performance)return function(){return Date.now()};var t=e.performance.now||e.performance.mozNow||e.performance.msNow||e.performance.oNow||e.performance.webkitNow||function(){return Date.now()};return function(){return t.apply(e.performance,arguments)}}(),a=function(){};a.instance=function(){return a._instance||(a._instance=new a),a._instance},a.tick=r,a.prototype={deltaS:function(e,t){return(t-e)/1e3},deltaM:function(e,t){return t-e},tick:function(){return r()}},t.a=a},function(e,t,i){"use strict";var r=i(9),a=i(98),n=i(10),o=i(127),s=function(){a.a.call(this),this.referenceFrame=o.a.RELATIVE_RF};r.a.createPrototypeNode(s,r.a.objectInherit(a.a.prototype,{setReferenceFrame:function(e){this.referenceFrame=e},getReferenceFrame:function(){return this.referenceFrame},computeBoundingSphere:function(){var e=n.c.create();return function(t){return a.a.prototype.computeBoundingSphere.call(this,t),t.valid()?(n.c.identity(e),this.computeLocalToWorldMatrix(e),t.transformMat4(t,e),t):t}}()}),"osg","Transform"),t.a=s},function(e,t,i){"use strict";var r=i(21),a=i(9),n=i(10),o=function(){this._min=n.f.create(),this._max=n.f.create(),this.init()};a.a.createPrototypeObject(o,{init:function(){n.f.copy(this._min,n.f.INFINITY),n.f.copy(this._max,n.f.NEGATIVE_INFINITY)},volume:function(){var e=this._max[0]-this._min[0];return e*=this._max[1]-this._min[1],e*=this._max[2]-this._min[2]},copy:function(e){n.f.copy(this._min,e._min),n.f.copy(this._max,e._max)},valid:function(){return this._max[0]>=this._min[0]&&this._max[1]>=this._min[1]&&this._max[2]>=this._min[2]},expandByBoundingSphere:function(e){if(e.valid()){var t=this._max,i=this._min,r=e._radius,a=e._center[0],n=e._center[1],o=e._center[2];i[0]=Math.min(i[0],a-r),i[1]=Math.min(i[1],n-r),i[2]=Math.min(i[2],o-r),t[0]=Math.max(t[0],a+r),t[1]=Math.max(t[1],n+r),t[2]=Math.max(t[2],o+r)}},expandByvec3:function(e){r.a.warn("deprecated, use expandByVec3"),this.expandByVec3(e)},expandByVec3:function(e){var t=this._min,i=this._max;t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),i[0]=Math.max(i[0],e[0]),i[1]=Math.max(i[1],e[1]),i[2]=Math.max(i[2],e[2])},expandByBoundingBox:function(e){if(e.valid()){var t=this._min,i=this._max,r=e._min,a=e._max;r[0]<t[0]&&(t[0]=r[0]),a[0]>i[0]&&(i[0]=a[0]),r[1]<t[1]&&(t[1]=r[1]),a[1]>i[1]&&(i[1]=a[1]),r[2]<t[2]&&(t[2]=r[2]),a[2]>i[2]&&(i[2]=a[2])}},center:function(e){var t=this._min,i=this._max;return e[0]=.5*(t[0]+i[0]),e[1]=.5*(t[1]+i[1]),e[2]=.5*(t[2]+i[2]),e},radius:function(){return Math.sqrt(this.radius2())},radius2:function(){var e=this._min,t=this._max,i=t[0]-e[0],r=t[1]-e[1],a=t[2]-e[2];return.25*(i*i+r*r+a*a)},getMin:function(){return this._min},getMax:function(){return this._max},setMin:function(e){return n.f.copy(this._min,e),this},setMax:function(e){return n.f.copy(this._max,e),this},xMax:function(){return this._max[0]},yMax:function(){return this._max[1]},zMax:function(){return this._max[2]},xMin:function(){return this._min[0]},yMin:function(){return this._min[1]},zMin:function(){return this._min[2]},corner:function(e,t){return t[0]=1&e?this._max[0]:this._min[0],t[1]=2&e?this._max[1]:this._min[1],t[2]=4&e?this._max[2]:this._min[2],t},transformMat4:function(){var e=n.f.create(),t=n.f.create();return function(i,r){var a=this.getMin(),o=this.getMax();n.c.getTranslation(e,r),n.f.copy(t,e);for(var s=0;s<3;++s)for(var u=4*s,l=a[s],c=o[s],h=0;h<3;++h){var d=r[u+h],p=d*c,f=d*l;p<f?(e[h]+=p,t[h]+=f):(e[h]+=f,t[h]+=p)}var m=i.getMax(),g=i.getMin();return m[0]=t[0],m[1]=t[1],m[2]=t[2],g[0]=e[0],g[1]=e[1],g[2]=e[2],i}}()},"osg","BoundingBox"),t.a=o},function(e,t,i){"use strict";var r=function(e){this._createFunction=e,this._pool=[],this._length=0};r.prototype={clean:function(){this._pool.length=0,this._length=0},getLength:function(){return this._length},reset:function(){this._length=0},getOrCreateObject:function(){var e;return this._length===this._pool.length?(e=this._createFunction(),this._pool.push(e)):e=this._pool[this._length],this._length++,e},forEach:function(e){for(var t=0;t<this._length;t++)e(this._pool[t])}},t.a=r},function(e,t,i){"use strict";var r=i(21),a=i(9),n=i(213),o=i(397),s=function(e,t){o.a.call(this);var i=e;"string"==typeof e&&(i=s[e]),this.type=i,this.setText(t)};s.VERTEX_SHADER=35633,s.FRAGMENT_SHADER=35632;s.VS_DBG="#define _DEBUG 1\n#ifdef _DEBUG\nattribute vec3 Vertex;uniform mat4 uModelViewMatrix;uniform mat4 uProjectionMatrix;void main(void) {  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex, 1.0);}\n",s.FS_DBG="#define _DEBUG 1\n#ifdef _DEBUG\n precision lowp float; void main(void) { gl_FragColor = vec4(1.0, 0.6, 0.6, 1.0);}\n",s._sDeletedGLShaderCache=new window.Map,s.deleteGLShader=function(e,t){s._sDeletedGLShaderCache.has(e)||s._sDeletedGLShaderCache.set(e,[]),s._sDeletedGLShaderCache.get(e).push(t)},s.flushDeletedGLShaders=function(e,t){if(t<=0)return t;if(!s._sDeletedGLShaderCache.has(e))return t;for(var i=0,r=n.a.instance().tick(),a=s._sDeletedGLShaderCache.get(e),o=a.length,u=o-1;u>=0&&i<t;u--)e.deleteShader(a[u]),a.splice(u,1),i=n.a.instance().deltaS(r,n.a.instance().tick());return t-i},s.flushAllDeletedGLShaders=function(e){if(s._sDeletedGLShaderCache.has(e))for(var t=s._sDeletedGLShaderCache.get(e),i=t.length,r=i-1;r>=0;r--)e.deleteShader(t[r]),t.splice(r,1)},s.onLostContext=function(e){if(s._sDeletedGLShaderCache.has(e)){s._sDeletedGLShaderCache.get(e).length=0}},a.a.createPrototypeObject(s,a.a.objectInherit(o.a.prototype,{setText:function(e){this.text=e},getText:function(){return this.text},failSafe:function(e,t){this.shader=e.createShader(this.type);var i=t.match(/#define[\s]+SHADER_NAME[\s]+([\S]+)(\n|$)/);i=i?i[1]:"";var r=this.type===s.VERTEX_SHADER?s.VS_DBG:s.FS_DBG;r+="\n#define SHADER_NAME FailSafe"+i+"\n#else\n"+t+"\n#endif\n",e.shaderSource(this.shader,r),e.compileShader(this.shader)},processErrors:function(e,t){var i=/ERROR: [\d]+:([\d]+): (.+)/gim,a=t.split("\n"),n=a.length;if(0!==n){var o,s;if(null===i.exec(e)&&(i=/Shader compilation errors\n\((\d+)\, \d+\): (.+)/gim),null===i.exec(e))return void r.a.error(e);for(i.lastIndex=0;null!==(s=i.exec(e));){s.index===i.lastIndex&&i.lastIndex++;var u=parseInt(s[1],10);if(!(u>n)){r.a.error("ERROR "+s[2]+" in line "+u);var l=Math.max(0,u-7),c=Math.max(0,u-2);for(o=l;o<=c;o++)r.a.warn(a[o].replace(/^[ \t]+/g,""));for(c=Math.max(0,u-1),r.a.error(a[c].replace(/^[ \t]+/g,"")),l=Math.min(n,u),c=Math.min(n,u+5),o=l;o<c;o++)r.a.warn(a[o].replace(/^[ \t]+/g,""))}}}},compile:function(e,t){this._gl||this.setGraphicContext(e),this.shader=e.createShader(this.type);var i=this.text;if(e.shaderSource(this.shader,i),e.compileShader(this.shader),!e.getShaderParameter(this.shader,e.COMPILE_STATUS)&&!e.isContextLost()){var a=e.getShaderInfoLog(this.shader);this.processErrors(a,i);for(var n=i,o=n.split("\n"),s="\n",u=0,l=o.length;u<l;++u)s+=u+" "+o[u]+"\n";return r.a.errorFold("can't compile shader",s),t&&t(this.shaderText,s,a),!1}return!0},releaseGLObjects:function(){void 0!==this._gl&&(s.deleteGLShader(this._gl,this.shader),o.a.removeObject(this._gl,this)),this.invalidate()},invalidate:function(){this.shader=void 0}}),"osg","Shader"),t.a=s},,,,,function(e,t,i){"use strict";var r,a=i(0),n=(i.n(a),i(38));r=n.a.extend({},{get:function(e){e=Object(a.extend)({},e);var t=this,i=new t;return!1!==e.allowPrefetching?(void 0===this.singleton&&(this.singleton=i),this.singleton.fetch(e),this.singleton):i.fetch(e)}}),t.a=r},,,,,,function(e,t,i){"use strict";var r=i(415),a=i.n(r),n=i(429),o=i.n(n),s=i(426),u=i.n(s),l=i(430),c=i.n(l),h=i(431),d=i.n(h);Array.prototype.find||(Array.prototype.find=function(e){for(var t=0,i=this.length;t<i;++t)if(e(this[t]))return this[t]}),d.a||(Number.isNaN=function(e){return e!==e}),c.a||(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),u.a||(Math.sign=function(e){return(e>0)-(e<0)||+e}),o.a||(Math.log2=function(e){return Math.log(e)*Math.LOG2E}),a.a||(Math.log10=function(e){return Math.log(e)*Math.LOG10E}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>=this.length)&&(t=this.length),this.substr(t-e.length,e.length)===e}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(t||0,e.length)===e});var p=window.Image;delete window.Image,window.Image||(window.Image=p)},,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=!1,a=function(e){return void 0!==e&&(r=e),r};t.default=a},,,,,,,,,,,,,,,function(e,t){var i={};i.EPSILON=1e-6,i.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,i.RANDOM=Math.random,i.ENABLE_SIMD=!1,i.SIMD_AVAILABLE=i.ARRAY_TYPE===Float32Array&&"SIMD"in this,i.USE_SIMD=i.ENABLE_SIMD&&i.SIMD_AVAILABLE,i.setMatrixArrayType=function(e){i.ARRAY_TYPE=e};var r=Math.PI/180;i.toRadian=function(e){return e*r},i.equals=function(e,t){return Math.abs(e-t)<=i.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))},e.exports=i},function(e,t,i){"use strict";var r,a=i(21),n=i(777),o=i(585),s=function(){r||(r=i(84).default),this._checkRTT={},this._webGLExtensions={},this._webGLParameters={},this._webGLShaderMaxInt="NONE",this._webGLShaderMaxFloat="NONE",this._bugsDB={},this._webGLPlatforms={},this._webGLParameters.MAX_COMBINED_TEXTURE_IMAGE_UNITS=8,this._webGLParameters.MAX_CUBE_MAP_TEXTURE_SIZE=16,this._webGLParameters.MAX_FRAGMENT_UNIFORM_VECTORS=16,this._webGLParameters.MAX_RENDERBUFFER_SIZE=1,this._webGLParameters.MAX_TEXTURE_IMAGE_UNITS=8,this._webGLParameters.MAX_TEXTURE_SIZE=64,this._webGLParameters.MAX_VARYING_VECTORS=8,this._webGLParameters.MAX_VERTEX_ATTRIBS=8,this._webGLParameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS=0,this._webGLParameters.MAX_VERTEX_UNIFORM_VECTORS=128,this._webGLParameters.MAX_VIEWPORT_DIMS=[1,1],this._webGLParameters.NUM_COMPRESSED_TEXTURE_FORMATS=0,this._webGLParameters.MAX_SHADER_PRECISION_FLOAT="none",this._webGLParameters.MAX_SHADER_PRECISION_INT="none",this._gl=void 0};s.instance=function(e,t){if(!s._instance){var i,r=e;if(!r){"undefined"!=typeof window&&window.gli&&(i=window.gli.host.inspectContext,window.gli.host.inspectContext=!1);var u=document.createElement("canvas");u.width=32,u.height=32;var l=new o.a;l.extend({antialias:!1}),l.extendWithOptionsURL(),r=n.a.setupWebGL(u,l,function(){})}s._instance=new s,r?s._instance.init(r):a.a.warn("no support for webgl context detected."),i&&(window.gli.host.inspectContext=i)}return e&&(t||e!==s._instance.getContext())&&s._instance.initContextDependant(e),s._instance},s.prototype={getContext:function(){return this._gl},initContextDependant:function(e){this._gl=e,this._isGL2=void 0!==window.WebGL2RenderingContext&&e instanceof window.WebGL2RenderingContext,this.initWebGLExtensions(e),this.hasLinearHalfFloatRTT(e),this.hasLinearFloatRTT(e),this.hasHalfFloatRTT(e),this.hasFloatRTT(e)},init:function(e){if(this.initWebGLParameters(e),this.initPlatformSupport(),this.initBugDB(),this.initContextDependant(e),this._isGL2)for(var t=["OES_element_index_uint","EXT_sRGB","EXT_blend_minmax","EXT_frag_depth","WEBGL_depth_texture","EXT_shader_texture_lod","OES_standard_derivatives","OES_texture_float","OES_texture_half_float","OES_texture_half_float_linear","OES_texture_float_linear","OES_vertex_array_object","WEBGL_draw_buffers","OES_fbo_render_mipmap","ANGLE_instanced_arrays"],i=s._instance.getWebGLExtensions(),r=function(){},a=0,n=t.length;a<n;a++)i[t[a]]=r},isWebGL2:function(){return this._isGL2},initBugDB:function(){var e=this._webGLPlatforms,t=this._webGLParameters;e.Apple&&(t.UNMASKED_VENDOR_WEBGL&&-1===t.UNMASKED_VENDOR_WEBGL.indexOf("Intel")||(this._bugsDB.OES_standard_derivatives=!0))},initPlatformSupport:function(){var e=this._webGLPlatforms;e.Apple=-1!==navigator.vendor.indexOf("Apple")||-1!==navigator.vendor.indexOf("OS X"),e.Mobile=/Mobi/.test(navigator.userAgent)||/ablet/.test(navigator.userAgent)},getWebGLPlatform:function(e){return this._webGLPlatforms[e]},getWebGLPlatforms:function(){return this._webGLPlatforms},getWebGLParameter:function(e){return this._webGLParameters[e]},getWebGLParameters:function(){return this._webGLParameters},getShaderMaxPrecisionFloat:function(){return this._webGLParameters.MAX_SHADER_PRECISION_FLOAT},getShaderMaxPrecisionInt:function(){return this._webGLParameters.MAX_SHADER_PRECISION_INT},checkSupportRTT:function(e,t,i){var r=t+","+i;if(this._isGL2)return!!this._webGLExtensions.EXT_color_buffer_float;if(void 0!==this._checkRTT[r])return this._checkRTT[r];if(!e)return!1;var a=e.createTexture();e.bindTexture(e.TEXTURE_2D,a),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,2,2,0,e.RGBA,t,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,i);var n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0);var o=this._checkRTT[r]=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.deleteTexture(a),e.deleteFramebuffer(n),e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),o},hasLinearHalfFloatRTT:function(e){return this._webGLExtensions.OES_texture_half_float_linear&&this.checkSupportRTT(e,r.HALF_FLOAT_OES,r.LINEAR)},hasLinearFloatRTT:function(e){return this._webGLExtensions.OES_texture_float_linear&&this.checkSupportRTT(e,r.FLOAT,r.LINEAR)},hasHalfFloatRTT:function(e){return this._webGLExtensions.OES_texture_half_float&&this.checkSupportRTT(e,r.HALF_FLOAT_OES,r.NEAREST)},hasFloatRTT:function(e){return this._webGLExtensions.OES_texture_float&&this.checkSupportRTT(e,r.FLOAT,r.NEAREST)},queryPrecision:function(e,t,i){var r=e.getShaderPrecisionFormat(t,i);return!!r&&0!==r.precision},hasVAO:function(){return!!this._webGLExtensions.OES_vertex_array_object},getDisjointTimerQuery:function(){return this._webGLExtensions.EXT_disjoint_timer_query_webgl2||this._webGLExtensions.EXT_disjoint_timer_query},initWebGLParameters:function(e){if(e){for(var t=["MAX_COMBINED_TEXTURE_IMAGE_UNITS","MAX_CUBE_MAP_TEXTURE_SIZE","MAX_FRAGMENT_UNIFORM_VECTORS","MAX_RENDERBUFFER_SIZE","MAX_TEXTURE_IMAGE_UNITS","MAX_TEXTURE_SIZE","MAX_VARYING_VECTORS","MAX_VERTEX_ATTRIBS","MAX_VERTEX_TEXTURE_IMAGE_UNITS","MAX_VERTEX_UNIFORM_VECTORS","MAX_VIEWPORT_DIMS","SHADING_LANGUAGE_VERSION","VERSION","VENDOR","RENDERER","ALIASED_LINE_WIDTH_RANGE","ALIASED_POINT_SIZE_RANGE","RED_BITS","GREEN_BITS","BLUE_BITS","ALPHA_BITS","DEPTH_BITS","STENCIL_BITS"],i=this._webGLParameters,r=0,a=t.length;r<a;++r){var n=t[r];i[n]=e.getParameter(e[n])}this.queryPrecision(e,e.FRAGMENT_SHADER,e.HIGH_FLOAT)?i.MAX_SHADER_PRECISION_FLOAT="high":this.queryPrecision(e,e.FRAGMENT_SHADER,e.MEDIUM_FLOAT)?i.MAX_SHADER_PRECISION_FLOAT="medium":this.queryPrecision(e,e.FRAGMENT_SHADER,e.LOW_FLOAT)&&(i.MAX_SHADER_PRECISION_FLOAT="low"),this.queryPrecision(e,e.FRAGMENT_SHADER,e.HIGH_INT)?i.MAX_SHADER_PRECISION_INT="high":this.queryPrecision(e,e.FRAGMENT_SHADER,e.MEDIUM_INT)?i.MAX_SHADER_PRECISION_INT="medium":this.queryPrecision(e,e.FRAGMENT_SHADER,e.LOW_INT)&&(i.MAX_SHADER_PRECISION_INT="low");var o=e.getExtension("WEBGL_debug_renderer_info");o&&(i.UNMASKED_RENDERER_WEBGL=e.getParameter(o.UNMASKED_RENDERER_WEBGL),i.UNMASKED_VENDOR_WEBGL=e.getParameter(o.UNMASKED_VENDOR_WEBGL))}},applyExtension:function(e,t){var i=e.getExtension(t),r=t.split("_")[0],a="_"+r,n=new RegExp(r+"$"),o=new RegExp(a);for(var s in i){if("function"==typeof i[s]){var u=s.replace(n,"");void 0===e[u]&&(e[u]=i[s].bind(i))}else{var l=s.replace(o,"");void 0===e[l]&&(e[l]=i[s])}}},getWebGLExtension:function(e){return this._webGLExtensions[e]},getWebGLExtensions:function(){return this._webGLExtensions},_checkShader:function(e,t,i){var r=t;"string"==typeof r&&(r=e[t]);var a=e.createShader(r);return e.shaderSource(a,i),e.compileShader(a),!(!e.getShaderParameter(a,e.COMPILE_STATUS)&&!e.isContextLost())},_doubleCheckExtension:function(e,t){var i=["#version 100","#extension GL_%ext% : require","precision mediump float;","varying vec3 vColor;","void main() {","gl_FragColor = vec4(vColor, 1.0);","}"].join("\n");return this._checkShader(e,"FRAGMENT_SHADER",i.replace(/\%ext\%/g,t))},initWebGLExtensions:function(e,t){if(e){var i=t;void 0===i&&(i=!0);var a=e.getSupportedExtensions();if(a){for(var n=this._webGLExtensions,o=0,s=a.length;o<s;++o){var u=a[o];i&&this._bugsDB[u]||(n[u]=e.getExtension(u),this._isGL2||this.applyExtension(e,u))}if(!this._isGL2){var l="EXT_shader_texture_lod";n[l]&&!this._doubleCheckExtension(e,l)&&delete n[l]}var c=this.getWebGLExtension("EXT_texture_filter_anisotropic");c&&(r.ANISOTROPIC_SUPPORT_EXT=!0,r.ANISOTROPIC_SUPPORT_MAX=e.getParameter(c.MAX_TEXTURE_MAX_ANISOTROPY_EXT))}}}},t.a=s},function(e,t,i){"use strict";var r=i(9),a=i(58),n=function(e,t,i,r){a.a.call(this),this._sourceFactor=n.DISABLE,this._destinationFactor=n.DISABLE,this._sourceFactorAlpha=this._sourceFactor,this._destinationFactorAlpha=this._destinationFactor,this._separate=!1,void 0!==e&&this.setSource(e),void 0!==t&&this.setDestination(t),void 0!==i&&this.setSourceAlpha(i),void 0!==r&&this.setDestinationAlpha(r)};n.DISABLE=-1,n.ZERO=0,n.ONE=1,n.SRC_COLOR=768,n.ONE_MINUS_SRC_COLOR=769,n.SRC_ALPHA=770,n.ONE_MINUS_SRC_ALPHA=771,n.DST_ALPHA=772,n.ONE_MINUS_DST_ALPHA=773,n.DST_COLOR=774,n.ONE_MINUS_DST_COLOR=775,n.SRC_ALPHA_SATURATE=776,n.BLEND_DST_RGB=32968,n.BLEND_SRC_RGB=32969,n.BLEND_DST_ALPHA=32970,n.BLEND_SRC_ALPHA=32971,n.CONSTANT_COLOR=32769,n.ONE_MINUS_CONSTANT_COLOR=32770,n.CONSTANT_ALPHA=32771,n.ONE_MINUS_CONSTANT_ALPHA=32772,n.BLEND_COLOR=32773,r.a.createPrototypeStateAttribute(n,r.a.objectInherit(a.a.prototype,{attributeType:"BlendFunc",cloneType:function(){return new n},setSource:function(e){this.setSourceRGB(e),this.setSourceAlpha(e)},getSource:function(){return this._sourceFactor},setDestination:function(e){this.setDestinationRGB(e),this.setDestinationAlpha(e)},getDestination:function(){return this._destinationFactor},getSeparate:function(){return this._separate},checkSeparate:function(){return this._sourceFactor!==this._sourceFactorAlpha||this._destinationFactor!==this._destinationFactorAlpha},setSourceRGB:function(e){this._sourceFactor="string"==typeof e?n[e]:e,this._separate=this.checkSeparate()},getSourceRGB:function(){return this._sourceFactor},setSourceAlpha:function(e){this._sourceFactorAlpha="string"==typeof e?n[e]:e,this._separate=this.checkSeparate()},getSourceAlpha:function(){return this._sourceFactorAlpha},setDestinationRGB:function(e){this._destinationFactor="string"==typeof e?n[e]:e,this._separate=this.checkSeparate()},getDestinationRGB:function(){return this._destinationFactor},setDestinationAlpha:function(e){this._destinationFactorAlpha="string"==typeof e?n[e]:e,this._separate=this.checkSeparate()},getDestinationAlpha:function(){return this._destinationFactorAlpha},apply:function(e){e.applyBlendFunc(this)}}),"osg","BlendFunc"),t.a=n},function(e,t,i){"use strict";var r=i(21),a=i(9),n=i(397),o=i(58),s=i(213),u=i(246),l=function(){n.a.call(this),o.a.call(this),this._fbo=void 0,this._rbo=void 0,this._attachments=[],this._buffers=[],this._dirty=!0,this._hasMRT=u.a.instance().getWebGLExtension("WEBGL_draw_buffers")};l.COLOR_ATTACHMENT0=36064,l.DEPTH_ATTACHMENT=36096,l.DEPTH_COMPONENT16=33189,l._sDeletedGLFrameBufferCache=new window.Map,l.deleteGLFrameBuffer=function(e,t){l._sDeletedGLFrameBufferCache.has(e)||l._sDeletedGLFrameBufferCache.set(e,[]),l._sDeletedGLFrameBufferCache.get(e).push(t)},l.flushDeletedGLFrameBuffers=function(e,t){if(t<=0)return t;if(!l._sDeletedGLFrameBufferCache.has(e))return t;var i=l._sDeletedGLFrameBufferCache.get(e);if(0===i.length)return t;for(var r=0,a=s.a.instance().tick(),n=i.length,o=n-1;o>=0&&r<t;o--)e.deleteFramebuffer(i[o]),i.splice(o,1),r=s.a.instance().deltaS(a,s.a.instance().tick());return t-r},l.flushAllDeletedGLFrameBuffers=function(e){if(l._sDeletedGLFrameBufferCache.has(e)){var t=l._sDeletedGLFrameBufferCache.get(e);if(0!==t.length)for(var i=t.length,r=i-1;r>=0;r--)e.deleteFramebuffer(t[r]),t.splice(r,1)}},l._sDeletedGLRenderBufferCache=new window.Map,l.deleteGLRenderBuffer=function(e,t){l._sDeletedGLRenderBufferCache.has(e)||l._sDeletedGLRenderBufferCache.set(e,[]),l._sDeletedGLRenderBufferCache.get(e).push(t)},l.flushDeletedGLRenderBuffers=function(e,t){if(t<=0)return t;if(!l._sDeletedGLRenderBufferCache.has(e))return t;for(var i=0,r=s.a.instance().tick(),a=l._sDeletedGLRenderBufferCache.get(e),n=a.length,o=n-1;o>=0&&i<t;o--)e.deleteRenderbuffer(a[o]),a.splice(o,1),i=s.a.instance().deltaS(r,s.a.instance().tick());return t-i},l.flushAllDeletedGLRenderBuffers=function(e){if(l._sDeletedGLRenderBufferCache.has(e))for(var t=l._sDeletedGLRenderBufferCache.get(e),i=t.length,r=i-1;r>=0;r--)e.deleteRenderbuffer(t[r]),t.splice(r,1)},l.onLostContext=function(e){if(l._sDeletedGLFrameBufferCache.has(e)){var t=l._sDeletedGLFrameBufferCache.get(e);t.length=0,l._sDeletedGLRenderBufferCache.has(e)&&(t=l._sDeletedGLRenderBufferCache.get(e),t.length=0)}},a.a.createPrototypeStateAttribute(l,a.a.objectInherit(n.a.prototype,a.a.objectInherit(o.a.prototype,{attributeType:"FrameBufferObject",cloneType:function(){return new l},invalidate:function(){if(this._rbo&&this._attachments){for(var e=0,t=this._attachments.length;e<t;++e){var i=this._attachments[e];i.texture||(i.renderBufferObject=void 0)}this._rbo=void 0}this._fbo=void 0,this._buffers.length=0,this._dirty=!0},dirty:function(){this._buffers.length=0,this._dirty=!0},isDirty:function(){return this._dirty},setAttachment:function(e){this._attachments.push(e)},getAttachment:function(e){if(this._attachments)for(var t=0,i=this._attachments.length;t<i;++t){var r=this._attachments[t];if(r.attachment===e)return r}},releaseGLObjects:function(){void 0!==this._fbo&&void 0!==this._gl&&l.deleteGLFrameBuffer(this._gl,this._fbo),this._fbo=void 0,void 0!==this._rbo&&void 0!==this._gl&&l.deleteGLRenderBuffer(this._gl,this._rbo),this.invalidate()},_reportFrameBufferError:function(e){switch(e){case 36054:r.a.debug("FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case 36055:r.a.debug("FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case 36057:r.a.debug("FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case 36061:r.a.debug("FRAMEBUFFER_UNSUPPORTED");break;default:r.a.debug("FRAMEBUFFER unknown error "+e.toString(16))}},reset:function(){this.releaseGLObjects(),this._attachments=[]},getFrameBufferObject:function(){return this._fbo},getRenderBufferObject:function(){return this._rbo},createFrameBufferObject:function(e){this.setGraphicContext(e.getGraphicContext()),this._fbo=this._gl.createFramebuffer()},createRenderBuffer:function(e,t,i){var r=this._gl,a=r.createRenderbuffer();return r.bindRenderbuffer(r.RENDERBUFFER,a),r.renderbufferStorage(r.RENDERBUFFER,e,t,i),a},framebufferRenderBuffer:function(e,t){var i=this._gl;i.bindRenderbuffer(i.RENDERBUFFER,t),i.framebufferRenderbuffer(i.FRAMEBUFFER,e,i.RENDERBUFFER,t)},framebufferTexture2D:function(e,t,i,r){var a=this._gl;if(e.applyTextureAttribute(1,r),r.isDirty()||!r.getTextureObject())return!1;var n=a.DRAW_FRAMEBUFFER||a.FRAMEBUFFER;return a.framebufferTexture2D(n,t,i,r.getTextureObject().id(),0),!0},bindFrameBufferObject:function(){var e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._fbo)},checkStatus:function(){var e=this._gl,t=e.checkFramebufferStatus(e.FRAMEBUFFER);t!==e.FRAMEBUFFER_COMPLETE&&this._reportFrameBufferError(t)},_checkAllowedSize:function(e,t){var i=u.a.instance().getWebGLParameter("MAX_RENDERBUFFER_SIZE");return!(0===e||0===t||t>i||e>i)||(r.a.error("width ("+e+") or height ("+e+') makes frame buffer not bindable. Max RenderBuffer is "'+i+'"'),!1)},apply:function(e){this._gl||this.setGraphicContext(e.getGraphicContext());var t=this._gl,i=this._attachments;if(0===i.length&&!this._fbo)return void t.bindFramebuffer(t.FRAMEBUFFER,null);if(!this.isDirty())return t.bindFramebuffer(t.FRAMEBUFFER,this._fbo),void(!0===r.a.reportWebGLError&&this.checkStatus());this._fbo||this.createFrameBufferObject(e),this.bindFrameBufferObject();for(var a=this._hasMRT?this._buffers:void 0,n=!1,o=0,s=i.length;o<s;++o){var u=i[o];if(u.texture){var l=u.texture;if(!this._checkAllowedSize(l.getWidth(),l.getHeight()))return void this.releaseGLObjects();if(this._hasMRT&&u.attachment>=t.COLOR_ATTACHMENT0&&u.attachment<=t.COLOR_ATTACHMENT15&&-1===a.indexOf(u.attachment)&&a.push(u.attachment),!this.framebufferTexture2D(e,u.attachment,u.textureTarget,l))return void this.releaseGLObjects()}else{if(!this._checkAllowedSize(u.width,u.height))return void this.releaseGLObjects();u.renderBufferObject?this._rbo=u.renderBufferObject:(this._rbo=this.createRenderBuffer(u.format,u.width,u.height),u.renderBufferObject=this._rbo),this.framebufferRenderBuffer(u.attachment,this._rbo),n=!0}}a&&a.length>0&&t.drawBuffers(a),this.checkStatus(),n&&t.bindRenderbuffer(t.RENDERBUFFER,null),this._dirty=!1}})),"osg","FrameBufferObject"),t.a=l},function(e,t,i){"use strict";var r=i(9),a=i(58),n=function(e,t,i,r){a.a.call(this),this._func=n.LESS,this._near=0,this._far=1,this._writeMask=!0,void 0!==e&&(this._func="string"==typeof e?n[e]:e),void 0!==t&&(this._near=t),void 0!==i&&(this._far=i),void 0!==r&&(this._writeMask=r)};n.DISABLE=0,n.NEVER=512,n.LESS=513,n.EQUAL=514,n.LEQUAL=515,n.GREATER=516,n.NOTEQUAL=517,n.GEQUAL=518,n.ALWAYS=519,r.a.createPrototypeStateAttribute(n,r.a.objectInherit(a.a.prototype,{attributeType:"Depth",cloneType:function(){return new n},setRange:function(e,t){this._near=e,this._far=t},setWriteMask:function(e){this._writeMask=e},getWriteMask:function(){return this._writeMask},getFunc:function(){return this._func},apply:function(e){e.applyDepth(this)}}),"osg","Depth"),t.a=n},function(e,t,i){"use strict";var r=function(e){this._manipulator=e,this._enable=!0};r.prototype={isEnabled:function(){return this._enable},setEnable:function(e){this._enable=e}},t.a=r},function(e,t,i){"use strict";var r=i(12),a=i(47),n=i(16),o=new r.a({hasTransparency:!1,hasScattering:!1,hasRefraction:!1,hasExtra:!1,protectDepthAndColorUnit:!1}),s={modelkey:"hasTransparency",activeStateSets:{},count:0},u={modelkey:"hasScattering",activeStateSets:{},count:0},l={modelkey:"hasRefraction",activeStateSets:{},count:0},c=function(e,t,i){var r=t.getInstanceID();!!e.activeStateSets[r]!==i&&(e.activeStateSets[r]=i,e.count+=i?1:-1,o.set(e.modelkey,e.count>0))};o.registerStateSetIsTransparent=c.bind(c,s),o.registerStateSetIsScattering=c.bind(c,u),o.registerStateSetIsRefraction=c.bind(c,l);var h=!1,d=!1,p=!1,f=!1,m=!1,g=function(){o.set("hasExtra",f||h||d||p||m||Object(n.a)().debug3D||Object(a.a)()||!Object(n.a)().vrStereo)};o.setHotspot=function(e){d=e,g()},o.setWireframe=function(e){h=e,g()},o.setGizmo=function(e){p=e,g()},o.setDebugNormal=function(e){f=e,g()},o.setOutline=function(e){m=e,g()},g(),t.a=o},,function(e,t,i){"use strict";var r,a=i(477),n=i(222);r=n.a.extend({model:a.a,url:"/i/skills"}),t.a=r},function(e,t,i){"use strict";t.a=function(e,t,i){if(!e)return"";var r;return r=e.images?e.images:e,0===r.length?"":1===r.length?r[0].url:r.reduce(function(e,r){var a=Math.abs(t-e.width),n=Math.abs(i-e.height),o=a+n,s=Math.abs(t-r.width),u=Math.abs(i-r.height),l=s+u;return(e.width<t||e.height<i)&&(o+=t*i),(r.width<t||r.height<i)&&(l+=t*i),o<l?e:r}).url}},function(e,t,i){"use strict";function r(e){return s.a.extend({displayName:"Popup",mixins:[u.a],defaultOptions:e.prototype.defaultOptions,children:{componentWrapper:{selector:".js-popup-content",viewClass:n.a.extend({displayName:"PopupWrapper("+e.prototype.displayName+")",template:function(){return o.default.getFromString("{{ components.child | component }}",{components:this.createChildrenComponents({child:{viewClass:e,options:this.options}})})}}),options:function(){return Object(a.extend)({},this.options,{popup:{continue:this.continue.bind(this),cancel:this.cancel.bind(this),open:this.open.bind(this),close:this.close.bind(this),remove:this.remove.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),center:this.center.bind(this),resize:this.resize.bind(this),autofocus:this.autofocus.bind(this)}})}}},initialize:function(){s.a.prototype.initialize.apply(this,arguments),this.render()},template:function(){return o.default.getFromString(['<div class="popup-container">','    <div class="popup-overlay"></div>','    <div class="js-popup js-popup-content"></div>',"</div>"].join("\n"),{})}})}t.a=r;var a=i(0),n=(i.n(a),i(13)),o=i(4),s=i(23),u=i(86)},function(e,t,i){"use strict";var r=i(15),a=i.n(r),n=i(116);t.a=Object(n.a)(["initialize","remove","delegateEvents","undelegateEvents","setElement","render","viewDidMount","viewDidUpdate","viewWillUnmount"])(a.a.View)},function(e,t,i){"use strict";function r(e,t){var i=e.__withChildren.childrenConfigs[t];return!i.shouldCreateChild||i.shouldCreateChild.call(e)}function a(e,t){var i=e.__withChildren.childrenConfigs[t];return"function"==typeof i.selector?i.selector.call(e):i.selector}function n(e,t){var i=e.__withChildren.childrenConfigs[t];return"function"==typeof i.options?i.options.call(e):i.options}function o(e,t){var i=e.__withChildren.childrenConfigs[t];return i.viewClass.isView?i.viewClass:i.viewClass.call(e)}var s=i(20),u=i.n(s),l=i(0),c=(i.n(l),i(2),{options:function(){return{}}});t.a={name:"WithChildren",dependencies:["WithOptionTypes"],children:{},constructor:function(){this.__withChildren={childrenConfigs:{}},u()(this.children).forEach(function(e){this.updateChildConfig(e,this.children[e])}.bind(this)),this.children={}},setElement:function(){return this.setChildrenElements(),this},beforeRemove:function(){this.removeChildren()},createChild:function(e){var t=a(this,e),i=n(this,e),r=o(this,e),s=new r(Object(l.extend)({},i,t?{el:this.$(t)}:{}));return this.children[e]=s,this},removeChild:function(e){return this.hasChild(e)&&this.getChild(e).remove(),delete this.children[e],this},removeChildren:function(){return u()(this.__withChildren.childrenConfigs).forEach(this.removeChild.bind(this)),this},refreshChild:function(e){var t=r(this,e),i=this.hasChild(e);return t?i?this.refreshChildViewClass(e).setChildElement(e):this.createChild(e):this.removeChild(e),this},refreshChildren:function(){u()(this.__withChildren.childrenConfigs).forEach(this.refreshChild.bind(this))},initializeChild:function(e){this.refreshChild(e)},initializeChildren:function(){this.refreshChildren()},setChildElement:function(e){var t=a(this,e);return t&&this.getChild(e).setElement(this.$(t)),this},setChildrenElements:function(){return u()(this.__withChildren.childrenConfigs).filter(this.hasChild.bind(this)).forEach(this.setChildElement.bind(this)),this},setChildOptions:function(e){return this.getChild(e).setOptions(n(this,e)),this},setChildrenOptions:function(){return u()(this.__withChildren.childrenConfigs).filter(this.hasChild.bind(this)).forEach(this.setChildOptions.bind(this)),this},refreshChildViewClass:function(e){var t=o(this,e);return this.getChild(e)instanceof t||(this.removeChild(e),this.createChild(e)),this},renderChild:function(e){if(this.refreshChild(e),this.hasChild(e)){var t=this.getChild(e);t.isMounted?this.setChildOptions(e):t.render()}},renderChildren:function(){u()(this.__withChildren.childrenConfigs).forEach(this.renderChild.bind(this))},getChildrenConfigs:function(){return this.__withChildren.childrenConfigs},updateChildConfig:function(e,t){var i=Object(l.extend)({},c,t);return this.__withChildren.childrenConfigs[e]=i,this},getChild:function(e){return this.children[e]},hasChild:function(e){return!!this.children[e]}}},function(e,t,i){"use strict";var r,a=i(642),n=i(16),o=[{type:"VERTEX_SHADER",text:["attribute vec3 aPosition;","void main() {","gl_Position = vec4(aPosition, 1.0);","}"].join("\n")},{type:"FRAGMENT_SHADER",text:["precision mediump float;","varying vec3 vColor;","void main() {","gl_FragColor = vec4(vColor, 1.0);","}"].join("\n")},{type:"FRAGMENT_SHADER",text:["precision mediump float;","varying vec3 vColor;","void f(in vec3 a, out vec3 b) {","b = 2.0 * a;","}","void main() {","vec3 color;","f(vColor, color);","gl_FragColor = gl_FrontFacing ? vec4(color, 1.0) : vec4(color, 0.0);","}"].join("\n")},{type:"FRAGMENT_SHADER",text:["#version 100","precision mediump float;","varying vec3 vColor;","varying vec4 vColor2;","#define LIN_SRGB(x) x < 0.0031308 ? x * 12.92 : 1.055 * pow(x, 1.0/2.4) - 0.055","#define SRGB_LIN(x) x < 0.04045 ? x * (1.0 / 12.92) : pow((x + 0.055) * (1.0 / 1.055), 2.4)","float linearTosRGB(const in float color) { return LIN_SRGB(color); }","vec3 linearTosRGB(const in vec3 color) { return vec3(LIN_SRGB(color.r), LIN_SRGB(color.g), LIN_SRGB(color.b)); }","vec4 linearTosRGB(const in vec4 color) { return vec4(LIN_SRGB(color.r), LIN_SRGB(color.g), LIN_SRGB(color.b), color.a); }","void main() {","vec3 color;","color.r = linearTosRGB(vColor2.r);","color = linearTosRGB(vColor);","gl_FragColor = gl_FrontFacing ? vec4(color, 1.0) : vec4(color, 0.0);","}"].join("\n")}],s=function(e,t,i){var r=t;"string"==typeof r&&(r=e[t]);var a=e.createShader(r);return e.shaderSource(a,i),e.compileShader(a),!(!e.getShaderParameter(a,e.COMPILE_STATUS)&&!e.isContextLost())||(console.warn("Could't compile shader "+i),console.warn(e.getShaderInfoLog(a)),console.warn("You may want to consider a browser that fully supports WebGL."),!1)};t.a=function(){if(void 0!==r)return r;if(r=!1,!window.Set||!window.Map||!window.Uint8ClampedArray)return!1;if(Object(a.a)())return!1;try{var e=["webgl","experimental-webgl"],t={antialias:!1},i=null,u=document.createElement("canvas");if(!u||!u.getContext)return!1;for(var l=0;l<e.length&&!(i=u.getContext(e[l],t));l++);if(!(i&&i.getParameter&&i.getExtension&&i.getShaderPrecisionFormat))return!1;if(i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS)<64)return!1;if(i.getParameter(i.MAX_VARYING_VECTORS)<8)return!1;var c=i.getExtension("WEBGL_debug_renderer_info");if(c&&"Google SwiftShader"===i.getParameter(c.UNMASKED_RENDERER_WEBGL)&&!Object(n.a)().allowSwiftShader)return!1;r=o.every(function(e){return s(i,e.type,e.text)})}catch(e){r=!1}return r}},function(e,t,i){"use strict";var r=i(47),a=i(118),n="";Object(a.a)()||Object(r.a)()||(n+="?optimized=1");var o=function(e,t,i){var r="/i/models/"+t;if(e&&(r+="/"+e+n),i&&!window.prefetchedData[r])throw console.error("Missing prefetch "+r),new Error("Missing prefetch "+r);return r};t.a=o},function(e,t,i){"use strict";var r=i(13),a=i(4),n=i(2),o=i(561);i.n(o);t.a=r.a.extend({displayName:"Popup",optionTypes:{title:n.b.string.isRequired,child:n.b.component.isRequired,className:n.b.string,isClosable:n.b.bool,width:n.b.number},defaultOptions:{className:"",isClosable:!0},state:{},events:{},template:function(){return a.default.getFromMacro("skfb_front/macros/components/molecules/popup","popup",[{className:this.options.className,isClosable:this.options.isClosable,width:this.options.width,title:this.options.title,components:this.createChildrenComponents({child:this.options.child})}])}})},,function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("af",{months:"Januarie_Februarie_Maart_April_Mei_Junie_Julie_Augustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mrt_Apr_Mei_Jun_Jul_Aug_Sep_Okt_Nov_Des".split("_"),weekdays:"Sondag_Maandag_Dinsdag_Woensdag_Donderdag_Vrydag_Saterdag".split("_"),weekdaysShort:"Son_Maa_Din_Woe_Don_Vry_Sat".split("_"),weekdaysMin:"So_Ma_Di_Wo_Do_Vr_Sa".split("_"),meridiemParse:/vm|nm/i,isPM:function(e){return/^nm$/i.test(e)},meridiem:function(e,t,i){return e<12?i?"vm":"VM":i?"nm":"NM"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Vandag om] LT",nextDay:"[Mre om] LT",nextWeek:"dddd [om] LT",lastDay:"[Gister om] LT",lastWeek:"[Laas] dddd [om] LT",sameElse:"L"},relativeTime:{future:"oor %s",past:"%s gelede",s:"'n paar sekondes",ss:"%d sekondes",m:"'n minuut",mm:"%d minute",h:"'n uur",hh:"%d ure",d:"'n dag",dd:"%d dae",M:"'n maand",MM:"%d maande",y:"'n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:" "},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9"," ":"0"},r=function(e){return 0===e?0:1===e?1:2===e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5},a={s:["  "," ",["",""],"%d ","%d ","%d "],m:["  "," ",["",""],"%d ","%d ","%d "],h:["  "," ",["",""],"%d ","%d ","%d "],d:["  "," ",["",""],"%d ","%d ","%d "],M:["  "," ",["",""],"%d ","%d ","%d "],y:["  "," ",["",""],"%d ","%d ","%d "]},n=function(e){return function(t,i,n,o){var s=r(t),u=a[e][r(t)];return 2===s&&(u=u[i?0:1]),u.replace(/%d/i,t)}},o=["","","","","","","","","","","",""];return e.defineLocale("ar",{months:o,monthsShort:o,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:n("s"),ss:n("s"),m:n("m"),mm:n("m"),h:n("h"),hh:n("h"),d:n("d"),dd:n("d"),M:n("M"),MM:n("M"),y:n("y"),yy:n("y")},preparse:function(e){return e.replace(/[ ]/g,function(e){return i[e]}).replace(//g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]}).replace(/,/g,"")},week:{dow:6,doy:12}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("ar-dz",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:0,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("ar-kw",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:0,doy:12}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t={1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",0:"0"},i=function(e){return 0===e?0:1===e?1:2===e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5},r={s:["  "," ",["",""],"%d ","%d ","%d "],m:["  "," ",["",""],"%d ","%d ","%d "],h:["  "," ",["",""],"%d ","%d ","%d "],d:["  "," ",["",""],"%d ","%d ","%d "],M:["  "," ",["",""],"%d ","%d ","%d "],y:["  "," ",["",""],"%d ","%d ","%d "]},a=function(e){return function(t,a,n,o){var s=i(t),u=r[e][i(t)];return 2===s&&(u=u[a?0:1]),u.replace(/%d/i,t)}},n=["","","","","","","","","","","",""];return e.defineLocale("ar-ly",{months:n,monthsShort:n,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:a("s"),ss:a("s"),m:a("m"),mm:a("m"),h:a("h"),hh:a("h"),d:a("d"),dd:a("d"),M:a("M"),MM:a("M"),y:a("y"),yy:a("y")},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]}).replace(/,/g,"")},week:{dow:6,doy:12}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("ar-ma",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:6,doy:12}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:" "},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9"," ":"0"};return e.defineLocale("ar-sa",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(e){return e.replace(/[ ]/g,function(e){return i[e]}).replace(//g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]}).replace(/,/g,"")},week:{dow:0,doy:6}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("ar-tn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t={1:"-inci",5:"-inci",8:"-inci",70:"-inci",80:"-inci",2:"-nci",7:"-nci",20:"-nci",50:"-nci",3:"-nc",4:"-nc",100:"-nc",6:"-nc",9:"-uncu",10:"-uncu",30:"-uncu",60:"-nc",90:"-nc"};return e.defineLocale("az",{months:"yanvar_fevral_mart_aprel_may_iyun_iyul_avqust_sentyabr_oktyabr_noyabr_dekabr".split("_"),monthsShort:"yan_fev_mar_apr_may_iyn_iyl_avq_sen_okt_noy_dek".split("_"),weekdays:"Bazar_Bazar ertsi_rnb axam_rnb_Cm axam_Cm_nb".split("_"),weekdaysShort:"Baz_BzE_Ax_r_CAx_Cm_n".split("_"),weekdaysMin:"Bz_BE_A__CA_C_".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugn saat] LT",nextDay:"[sabah saat] LT",nextWeek:"[gln hft] dddd [saat] LT",lastDay:"[dnn] LT",lastWeek:"[ken hft] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s vvl",s:"birne saniyy",ss:"%d saniy",m:"bir dqiq",mm:"%d dqiq",h:"bir saat",hh:"%d saat",d:"bir gn",dd:"%d gn",M:"bir ay",MM:"%d ay",y:"bir il",yy:"%d il"},meridiemParse:/gec|shr|gndz|axam/,isPM:function(e){return/^(gndz|axam)$/.test(e)},meridiem:function(e,t,i){return e<4?"gec":e<12?"shr":e<17?"gndz":"axam"},dayOfMonthOrdinalParse:/\d{1,2}-(nc|inci|nci|nc|nc|uncu)/,ordinal:function(e){if(0===e)return e+"-nc";var i=e%10,r=e%100-i,a=e>=100?100:null;return e+(t[i]||t[r]||t[a])},week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e,t){var i=e.split("_");return t%10==1&&t%100!=11?i[0]:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?i[1]:i[2]}function i(e,i,r){var a={ss:i?"__":"__",mm:i?"__":"__",hh:i?"__":"__",dd:"__",MM:"__",yy:"__"};return"m"===r?i?"":"":"h"===r?i?"":"":e+" "+t(a[r],+e)}return e.defineLocale("be",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:{format:"______".split("_"),standalone:"______".split("_"),isFormat:/\[ ?[] ?(?:|)? ?\] ?dddd/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",lastDay:"[ ] LT",nextWeek:function(){return"[] dddd [] LT"},lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return"[ ] dddd [] LT";case 1:case 2:case 4:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:i,mm:i,h:i,hh:i,d:"",dd:i,M:"",MM:i,y:"",yy:i},meridiemParse:/|||/,isPM:function(e){return/^(|)$/.test(e)},meridiem:function(e,t,i){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(||)/,ordinal:function(e,t){switch(t){case"M":case"d":case"DDD":case"w":case"W":return e%10!=2&&e%10!=3||e%100==12||e%100==13?e+"-":e+"-";case"D":return e+"-";default:return e}},week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("bg",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[ ] dddd [] LT";case 1:case 2:case 4:case 5:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|||||)/,ordinal:function(e){var t=e%10,i=e%100;return 0===e?e+"-":0===i?e+"-":i>10&&i<20?e+"-":1===t?e+"-":2===t?e+"-":7===t||8===t?e+"-":e+"-"},week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("bm",{months:"Zanwuyekalo_Fewuruyekalo_Marisikalo_Awirilikalo_Mkalo_Zuwnkalo_Zuluyekalo_Utikalo_Stanburukalo_kutburukalo_Nowanburukalo_Desanburukalo".split("_"),monthsShort:"Zan_Few_Mar_Awi_M_Zuw_Zul_Uti_St_ku_Now_Des".split("_"),weekdays:"Kari_Ntnn_Tarata_Araba_Alamisa_Juma_Sibiri".split("_"),weekdaysShort:"Kar_Nt_Tar_Ara_Ala_Jum_Sib".split("_"),weekdaysMin:"Ka_Nt_Ta_Ar_Al_Ju_Si".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"MMMM [tile] D [san] YYYY",LLL:"MMMM [tile] D [san] YYYY [lr] HH:mm",LLLL:"dddd MMMM [tile] D [san] YYYY [lr] HH:mm"},calendar:{sameDay:"[Bi lr] LT",nextDay:"[Sini lr] LT",nextWeek:"dddd [don lr] LT",lastDay:"[Kunu lr] LT",lastWeek:"dddd [tmnen lr] LT",sameElse:"L"},relativeTime:{future:"%s kn",past:"a b %s b",s:"sanga dama dama",ss:"sekondi %d",m:"miniti kelen",mm:"miniti %d",h:"lr kelen",hh:"lr %d",d:"tile kelen",dd:"tile %d",M:"kalo kelen",MM:"kalo %d",y:"san kelen",yy:"san %d"},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("bn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t&&e>=4||""===t&&e<5||""===t?e+12:e},meridiem:function(e,t,i){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:" "},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9"," ":"0"};return e.defineLocale("bo",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:" _ _ _ _ _ _ ".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[], LT",lastDay:"[] LT",lastWeek:"[ ] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(e){return e.replace(/[ ]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t&&e>=4||""===t&&e<5||""===t?e+12:e},meridiem:function(e,t,i){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e,t,i){return e+" "+a({mm:"munutenn",MM:"miz",dd:"devezh"}[i],e)}function i(e){switch(r(e)){case 1:case 3:case 4:case 5:case 9:return e+" bloaz";default:return e+" vloaz"}}function r(e){return e>9?r(e%10):e}function a(e,t){return 2===t?n(e):e}function n(e){var t={m:"v",b:"v",d:"z"};return void 0===t[e.charAt(0)]?e:t[e.charAt(0)]+e.substring(1)}return e.defineLocale("br",{months:"Genver_C'hwevrer_Meurzh_Ebrel_Mae_Mezheven_Gouere_Eost_Gwengolo_Here_Du_Kerzu".split("_"),monthsShort:"Gen_C'hwe_Meu_Ebr_Mae_Eve_Gou_Eos_Gwe_Her_Du_Ker".split("_"),weekdays:"Sul_Lun_Meurzh_Merc'her_Yaou_Gwener_Sadorn".split("_"),weekdaysShort:"Sul_Lun_Meu_Mer_Yao_Gwe_Sad".split("_"),weekdaysMin:"Su_Lu_Me_Mer_Ya_Gw_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h[e]mm A",LTS:"h[e]mm:ss A",L:"DD/MM/YYYY",LL:"D [a viz] MMMM YYYY",LLL:"D [a viz] MMMM YYYY h[e]mm A",LLLL:"dddd, D [a viz] MMMM YYYY h[e]mm A"},calendar:{sameDay:"[Hiziv da] LT",nextDay:"[Warc'hoazh da] LT",nextWeek:"dddd [da] LT",lastDay:"[Dec'h da] LT",lastWeek:"dddd [paset da] LT",sameElse:"L"},relativeTime:{future:"a-benn %s",past:"%s 'zo",s:"un nebeud segondenno",ss:"%d eilenn",m:"ur vunutenn",mm:t,h:"un eur",hh:"%d eur",d:"un devezh",dd:t,M:"ur miz",MM:t,y:"ur bloaz",yy:i},dayOfMonthOrdinalParse:/\d{1,2}(a|vet)/,ordinal:function(e){return e+(1===e?"a":"vet")},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e,t,i){var r=e+" ";switch(i){case"ss":return r+=1===e?"sekunda":2===e||3===e||4===e?"sekunde":"sekundi";case"m":return t?"jedna minuta":"jedne minute";case"mm":return r+=1===e?"minuta":2===e||3===e||4===e?"minute":"minuta";case"h":return t?"jedan sat":"jednog sata";case"hh":return r+=1===e?"sat":2===e||3===e||4===e?"sata":"sati";case"dd":return r+=1===e?"dan":"dana";case"MM":return r+=1===e?"mjesec":2===e||3===e||4===e?"mjeseca":"mjeseci";case"yy":return r+=1===e?"godina":2===e||3===e||4===e?"godine":"godina"}}return e.defineLocale("bs",{months:"januar_februar_mart_april_maj_juni_juli_august_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._aug._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prolu] dddd [u] LT";case 6:return"[prole] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[proli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",ss:t,m:t,mm:t,h:t,hh:t,d:"dan",dd:t,M:"mjesec",MM:t,y:"godinu",yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("ca",{months:{standalone:"gener_febrer_mar_abril_maig_juny_juliol_agost_setembre_octubre_novembre_desembre".split("_"),format:"de gener_de febrer_de mar_d'abril_de maig_de juny_de juliol_d'agost_de setembre_d'octubre_de novembre_de desembre".split("_"),isFormat:/D[oD]?(\s)+MMMM/},monthsShort:"gen._febr._mar_abr._maig_juny_jul._ag._set._oct._nov._des.".split("_"),monthsParseExact:!0,weekdays:"diumenge_dilluns_dimarts_dimecres_dijous_divendres_dissabte".split("_"),weekdaysShort:"dg._dl._dt._dc._dj._dv._ds.".split("_"),weekdaysMin:"dg_dl_dt_dc_dj_dv_ds".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [de] YYYY",ll:"D MMM YYYY",LLL:"D MMMM [de] YYYY [a les] H:mm",lll:"D MMM YYYY, H:mm",LLLL:"dddd D MMMM [de] YYYY [a les] H:mm",llll:"ddd D MMM YYYY, H:mm"},calendar:{sameDay:function(){return"[avui a "+(1!==this.hours()?"les":"la")+"] LT"},nextDay:function(){return"[dem  a "+(1!==this.hours()?"les":"la")+"] LT"},nextWeek:function(){return"dddd [a "+(1!==this.hours()?"les":"la")+"] LT"},lastDay:function(){return"[ahir a "+(1!==this.hours()?"les":"la")+"] LT"},lastWeek:function(){return"[el] dddd [passat a "+(1!==this.hours()?"les":"la")+"] LT"},sameElse:"L"},relativeTime:{future:"d'aqu %s",past:"fa %s",s:"uns segons",ss:"%d segons",m:"un minut",mm:"%d minuts",h:"una hora",hh:"%d hores",d:"un dia",dd:"%d dies",M:"un mes",MM:"%d mesos",y:"un any",yy:"%d anys"},dayOfMonthOrdinalParse:/\d{1,2}(r|n|t||a)/,ordinal:function(e,t){var i=1===e?"r":2===e?"n":3===e?"r":4===e?"t":"";return"w"!==t&&"W"!==t||(i="a"),e+i},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e){return e>1&&e<5&&1!=~~(e/10)}function i(e,i,r,a){var n=e+" ";switch(r){case"s":return i||a?"pr sekund":"pr sekundami";case"ss":return i||a?n+(t(e)?"sekundy":"sekund"):n+"sekundami";case"m":return i?"minuta":a?"minutu":"minutou";case"mm":return i||a?n+(t(e)?"minuty":"minut"):n+"minutami";case"h":return i?"hodina":a?"hodinu":"hodinou";case"hh":return i||a?n+(t(e)?"hodiny":"hodin"):n+"hodinami";case"d":return i||a?"den":"dnem";case"dd":return i||a?n+(t(e)?"dny":"dn"):n+"dny";case"M":return i||a?"msc":"mscem";case"MM":return i||a?n+(t(e)?"msce":"msc"):n+"msci";case"y":return i||a?"rok":"rokem";case"yy":return i||a?n+(t(e)?"roky":"let"):n+"lety"}}var r="leden_nor_bezen_duben_kvten_erven_ervenec_srpen_z_jen_listopad_prosinec".split("_"),a="led_no_be_dub_kv_vn_vc_srp_z_j_lis_pro".split("_");return e.defineLocale("cs",{months:r,monthsShort:a,monthsParse:function(e,t){var i,r=[];for(i=0;i<12;i++)r[i]=new RegExp("^"+e[i]+"$|^"+t[i]+"$","i");return r}(r,a),shortMonthsParse:function(e){var t,i=[];for(t=0;t<12;t++)i[t]=new RegExp("^"+e[t]+"$","i");return i}(a),longMonthsParse:function(e){var t,i=[];for(t=0;t<12;t++)i[t]=new RegExp("^"+e[t]+"$","i");return i}(r),weekdays:"nedle_pondl_ter_steda_tvrtek_ptek_sobota".split("_"),weekdaysShort:"ne_po_t_st_t_p_so".split("_"),weekdaysMin:"ne_po_t_st_t_p_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm",l:"D. M. YYYY"},calendar:{sameDay:"[dnes v] LT",nextDay:"[ztra v] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedli v] LT";case 1:case 2:return"[v] dddd [v] LT";case 3:return"[ve stedu v] LT";case 4:return"[ve tvrtek v] LT";case 5:return"[v ptek v] LT";case 6:return"[v sobotu v] LT"}},lastDay:"[vera v] LT",lastWeek:function(){switch(this.day()){case 0:return"[minulou nedli v] LT";case 1:case 2:return"[minul] dddd [v] LT";case 3:return"[minulou stedu v] LT";case 4:case 5:return"[minul] dddd [v] LT";case 6:return"[minulou sobotu v] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"ped %s",s:i,ss:i,m:i,mm:i,h:i,hh:i,d:i,dd:i,M:i,MM:i,y:i,yy:i},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("cv",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"YYYY [] MMMM [] D[-]",LLL:"YYYY [] MMMM [] D[-], HH:mm",LLLL:"dddd, YYYY [] MMMM [] D[-], HH:mm"},calendar:{sameDay:"[] LT []",nextDay:"[] LT []",lastDay:"[] LT []",nextWeek:"[] dddd LT []",lastWeek:"[] dddd LT []",sameElse:"L"},relativeTime:{future:function(e){return e+(/$/i.exec(e)?"":/$/i.exec(e)?"":"")},past:"%s ",s:"- ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-/,ordinal:"%d-",week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("cy",{months:"Ionawr_Chwefror_Mawrth_Ebrill_Mai_Mehefin_Gorffennaf_Awst_Medi_Hydref_Tachwedd_Rhagfyr".split("_"),monthsShort:"Ion_Chwe_Maw_Ebr_Mai_Meh_Gor_Aws_Med_Hyd_Tach_Rhag".split("_"),weekdays:"Dydd Sul_Dydd Llun_Dydd Mawrth_Dydd Mercher_Dydd Iau_Dydd Gwener_Dydd Sadwrn".split("_"),weekdaysShort:"Sul_Llun_Maw_Mer_Iau_Gwe_Sad".split("_"),weekdaysMin:"Su_Ll_Ma_Me_Ia_Gw_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Heddiw am] LT",nextDay:"[Yfory am] LT",nextWeek:"dddd [am] LT",lastDay:"[Ddoe am] LT",lastWeek:"dddd [diwethaf am] LT",sameElse:"L"},relativeTime:{future:"mewn %s",past:"%s yn l",s:"ychydig eiliadau",ss:"%d eiliad",m:"munud",mm:"%d munud",h:"awr",hh:"%d awr",d:"diwrnod",dd:"%d diwrnod",M:"mis",MM:"%d mis",y:"blwyddyn",yy:"%d flynedd"},dayOfMonthOrdinalParse:/\d{1,2}(fed|ain|af|il|ydd|ed|eg)/,ordinal:function(e){var t=e,i="",r=["","af","il","ydd","ydd","ed","ed","ed","fed","fed","fed","eg","fed","eg","eg","fed","eg","eg","fed","eg","fed"];return t>20?i=40===t||50===t||60===t||80===t||100===t?"fed":"ain":t>0&&(i=r[t]),e+i},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("da",{months:"januar_februar_marts_april_maj_juni_juli_august_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_man_tir_ons_tor_fre_lr".split("_"),weekdaysMin:"s_ma_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd [d.] D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"p dddd [kl.] LT",lastDay:"[i gr kl.] LT",lastWeek:"[i] dddd[s kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"f sekunder",ss:"%d sekunder",m:"et minut",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dage",M:"en mned",MM:"%d mneder",y:"et r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e,t,i,r){var a={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return t?a[i][0]:a[i][1]}return e.defineLocale("de",{months:"Januar_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._Mrz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:t,mm:"%d Minuten",h:t,hh:"%d Stunden",d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e,t,i,r){var a={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return t?a[i][0]:a[i][1]}return e.defineLocale("de-at",{months:"Jnner_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jn._Feb._Mrz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:t,mm:"%d Minuten",h:t,hh:"%d Stunden",d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e,t,i,r){var a={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return t?a[i][0]:a[i][1]}return e.defineLocale("de-ch",{months:"Januar_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._Mrz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:t,mm:"%d Minuten",h:t,hh:"%d Stunden",d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t=["","","","","","","","","","","",""],i=["","","","","","",""];return e.defineLocale("dv",{months:t,monthsShort:t,weekdays:i,weekdaysShort:i,weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd LT",lastDay:"[] LT",lastWeek:"[] dddd LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"d% ",m:"",mm:" %d",h:"",hh:" %d",d:"",dd:" %d",M:"",MM:" %d",y:"",yy:" %d"},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:7,doy:12}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}return e.defineLocale("el",{monthsNominativeEl:"___________".split("_"),monthsGenitiveEl:"___________".split("_"),months:function(e,t){return e?"string"==typeof t&&/D/.test(t.substring(0,t.indexOf("MMMM")))?this._monthsGenitiveEl[e.month()]:this._monthsNominativeEl[e.month()]:this._monthsNominativeEl},monthsShort:"___________".split("_"),weekdays:"____ _ _".split("_"),weekdaysShort:"____ _ _".split("_"),weekdaysMin:"____ _ _".split("_"),meridiem:function(e,t,i){return e>11?i?"":"":i?"":" "},isPM:function(e){return""===(e+"").toLowerCase()[0]},meridiemParse:/[ ]\.??\.?/i,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendarEl:{sameDay:"[ {}] LT",nextDay:"[ {}] LT",nextWeek:"dddd [{}] LT",lastDay:"[ {}] LT",lastWeek:function(){switch(this.day()){case 6:return"[ ] dddd [{}] LT";default:return"[ ] dddd [{}] LT"}},sameElse:"L"},calendar:function(e,i){var r=this._calendarEl[e],a=i&&i.hours();return t(r)&&(r=r.apply(i)),r.replace("{}",a%12==1?"":"")},relativeTime:{future:" %s",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("en-au",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("en-ca",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"YYYY-MM-DD",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("en-gb",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("en-ie",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("en-nz",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("eo",{months:"januaro_februaro_marto_aprilo_majo_junio_julio_agusto_septembro_oktobro_novembro_decembro".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_ag_sep_okt_nov_dec".split("_"),weekdays:"dimano_lundo_mardo_merkredo_ado_vendredo_sabato".split("_"),weekdaysShort:"dim_lun_mard_merk_a_ven_sab".split("_"),weekdaysMin:"di_lu_ma_me_a_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D[-a de] MMMM, YYYY",LLL:"D[-a de] MMMM, YYYY HH:mm",LLLL:"dddd, [la] D[-a de] MMMM, YYYY HH:mm"},meridiemParse:/[ap]\.t\.m/i,isPM:function(e){return"p"===e.charAt(0).toLowerCase()},meridiem:function(e,t,i){return e>11?i?"p.t.m.":"P.T.M.":i?"a.t.m.":"A.T.M."},calendar:{sameDay:"[Hodia je] LT",nextDay:"[Morga je] LT",nextWeek:"dddd [je] LT",lastDay:"[Hiera je] LT",lastWeek:"[pasinta] dddd [je] LT",sameElse:"L"},relativeTime:{future:"post %s",past:"anta %s",s:"sekundoj",ss:"%d sekundoj",m:"minuto",mm:"%d minutoj",h:"horo",hh:"%d horoj",d:"tago",dd:"%d tagoj",M:"monato",MM:"%d monatoj",y:"jaro",yy:"%d jaroj"},dayOfMonthOrdinalParse:/\d{1,2}a/,ordinal:"%da",week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),i="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),r=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],a=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i;return e.defineLocale("es",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(e,r){return e?/-MMM-/.test(r)?i[e.month()]:t[e.month()]:t},monthsRegex:a,monthsShortRegex:a,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:r,longMonthsParse:r,shortMonthsParse:r,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),i="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),r=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],a=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i;return e.defineLocale("es-do",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(e,r){return e?/-MMM-/.test(r)?i[e.month()]:t[e.month()]:t},monthsRegex:a,monthsShortRegex:a,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:r,longMonthsParse:r,shortMonthsParse:r,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY h:mm A",LLLL:"dddd, D [de] MMMM [de] YYYY h:mm A"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),i="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_");return e.defineLocale("es-us",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(e,r){return e?/-MMM-/.test(r)?i[e.month()]:t[e.month()]:t},monthsParseExact:!0,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"MM/DD/YYYY",LL:"MMMM [de] D [de] YYYY",LLL:"MMMM [de] D [de] YYYY h:mm A",LLLL:"dddd, MMMM [de] D [de] YYYY h:mm A"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:0,doy:6}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e,t,i,r){var a={s:["mne sekundi","mni sekund","paar sekundit"],ss:[e+"sekundi",e+"sekundit"],m:["he minuti","ks minut"],mm:[e+" minuti",e+" minutit"],h:["he tunni","tund aega","ks tund"],hh:[e+" tunni",e+" tundi"],d:["he peva","ks pev"],M:["kuu aja","kuu aega","ks kuu"],MM:[e+" kuu",e+" kuud"],y:["he aasta","aasta","ks aasta"],yy:[e+" aasta",e+" aastat"]};return t?a[i][2]?a[i][2]:a[i][1]:r?a[i][0]:a[i][1]}return e.defineLocale("et",{months:"jaanuar_veebruar_mrts_aprill_mai_juuni_juuli_august_september_oktoober_november_detsember".split("_"),monthsShort:"jaan_veebr_mrts_apr_mai_juuni_juuli_aug_sept_okt_nov_dets".split("_"),weekdays:"phapev_esmaspev_teisipev_kolmapev_neljapev_reede_laupev".split("_"),weekdaysShort:"P_E_T_K_N_R_L".split("_"),weekdaysMin:"P_E_T_K_N_R_L".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[Tna,] LT",nextDay:"[Homme,] LT",nextWeek:"[Jrgmine] dddd LT",lastDay:"[Eile,] LT",lastWeek:"[Eelmine] dddd LT",sameElse:"L"},relativeTime:{future:"%s prast",past:"%s tagasi",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:"%d peva",M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("eu",{months:"urtarrila_otsaila_martxoa_apirila_maiatza_ekaina_uztaila_abuztua_iraila_urria_azaroa_abendua".split("_"),monthsShort:"urt._ots._mar._api._mai._eka._uzt._abu._ira._urr._aza._abe.".split("_"),monthsParseExact:!0,weekdays:"igandea_astelehena_asteartea_asteazkena_osteguna_ostirala_larunbata".split("_"),weekdaysShort:"ig._al._ar._az._og._ol._lr.".split("_"),weekdaysMin:"ig_al_ar_az_og_ol_lr".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY[ko] MMMM[ren] D[a]",LLL:"YYYY[ko] MMMM[ren] D[a] HH:mm",LLLL:"dddd, YYYY[ko] MMMM[ren] D[a] HH:mm",l:"YYYY-M-D",ll:"YYYY[ko] MMM D[a]",lll:"YYYY[ko] MMM D[a] HH:mm",llll:"ddd, YYYY[ko] MMM D[a] HH:mm"},calendar:{sameDay:"[gaur] LT[etan]",nextDay:"[bihar] LT[etan]",nextWeek:"dddd LT[etan]",lastDay:"[atzo] LT[etan]",lastWeek:"[aurreko] dddd LT[etan]",sameElse:"L"},relativeTime:{future:"%s barru",past:"duela %s",s:"segundo batzuk",ss:"%d segundo",m:"minutu bat",mm:"%d minutu",h:"ordu bat",hh:"%d ordu",d:"egun bat",dd:"%d egun",M:"hilabete bat",MM:"%d hilabete",y:"urte bat",yy:"%d urte"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("fa",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiemParse:/  |  /,isPM:function(e){return/  /.test(e)},meridiem:function(e,t,i){return e<12?"  ":"  "},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] [] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",ss:" d%",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[-]/g,function(e){return i[e]}).replace(//g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]}).replace(/,/g,"")},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:6,doy:12}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e,t,r,a){var n="";switch(r){case"s":return a?"muutaman sekunnin":"muutama sekunti";case"ss":return a?"sekunnin":"sekuntia";case"m":return a?"minuutin":"minuutti";case"mm":n=a?"minuutin":"minuuttia";break;case"h":return a?"tunnin":"tunti";case"hh":n=a?"tunnin":"tuntia";break;case"d":return a?"pivn":"piv";case"dd":n=a?"pivn":"piv";break;case"M":return a?"kuukauden":"kuukausi";case"MM":n=a?"kuukauden":"kuukautta";break;case"y":return a?"vuoden":"vuosi";case"yy":n=a?"vuoden":"vuotta"}return n=i(e,a)+" "+n}function i(e,t){return e<10?t?a[e]:r[e]:e}var r="nolla yksi kaksi kolme nelj viisi kuusi seitsemn kahdeksan yhdeksn".split(" "),a=["nolla","yhden","kahden","kolmen","neljn","viiden","kuuden",r[7],r[8],r[9]];return e.defineLocale("fi",{months:"tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_keskuu_heinkuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),monthsShort:"tammi_helmi_maalis_huhti_touko_kes_hein_elo_syys_loka_marras_joulu".split("_"),weekdays:"sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"),weekdaysShort:"su_ma_ti_ke_to_pe_la".split("_"),weekdaysMin:"su_ma_ti_ke_to_pe_la".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"Do MMMM[ta] YYYY",LLL:"Do MMMM[ta] YYYY, [klo] HH.mm",LLLL:"dddd, Do MMMM[ta] YYYY, [klo] HH.mm",l:"D.M.YYYY",ll:"Do MMM YYYY",lll:"Do MMM YYYY, [klo] HH.mm",llll:"ddd, Do MMM YYYY, [klo] HH.mm"},calendar:{sameDay:"[tnn] [klo] LT",nextDay:"[huomenna] [klo] LT",nextWeek:"dddd [klo] LT",lastDay:"[eilen] [klo] LT",lastWeek:"[viime] dddd[na] [klo] LT",sameElse:"L"},relativeTime:{future:"%s pst",past:"%s sitten",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("fo",{months:"januar_februar_mars_aprl_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sunnudagur_mnadagur_tsdagur_mikudagur_hsdagur_frggjadagur_leygardagur".split("_"),weekdaysShort:"sun_mn_ts_mik_hs_fr_ley".split("_"),weekdaysMin:"su_m_t_mi_h_fr_le".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D. MMMM, YYYY HH:mm"},calendar:{sameDay:"[ dag kl.] LT",nextDay:"[ morgin kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[ gjr kl.] LT",lastWeek:"[sstu] dddd [kl] LT",sameElse:"L"},relativeTime:{future:"um %s",past:"%s sani",s:"f sekund",ss:"%d sekundir",m:"ein minutt",mm:"%d minuttir",h:"ein tmi",hh:"%d tmar",d:"ein dagur",dd:"%d dagar",M:"ein mnai",MM:"%d mnair",y:"eitt r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("fr",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui  ] LT",nextDay:"[Demain  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[Hier  ] LT",lastWeek:"dddd [dernier  ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|)/,ordinal:function(e,t){switch(t){case"D":return e+(1===e?"er":"");default:case"M":case"Q":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("fr-ca",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui  ] LT",nextDay:"[Demain  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[Hier  ] LT",lastWeek:"dddd [dernier  ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|e)/,ordinal:function(e,t){switch(t){default:case"M":case"Q":case"D":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("fr-ch",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui  ] LT",nextDay:"[Demain  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[Hier  ] LT",lastWeek:"dddd [dernier  ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|e)/,ordinal:function(e,t){switch(t){default:case"M":case"Q":case"D":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t="jan._feb._mrt._apr._mai_jun._jul._aug._sep._okt._nov._des.".split("_"),i="jan_feb_mrt_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_");return e.defineLocale("fy",{months:"jannewaris_febrewaris_maart_april_maaie_juny_july_augustus_septimber_oktober_novimber_desimber".split("_"),monthsShort:function(e,r){return e?/-MMM-/.test(r)?i[e.month()]:t[e.month()]:t},monthsParseExact:!0,weekdays:"snein_moandei_tiisdei_woansdei_tongersdei_freed_sneon".split("_"),weekdaysShort:"si._mo._ti._wo._to._fr._so.".split("_"),weekdaysMin:"Si_Mo_Ti_Wo_To_Fr_So".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[hjoed om] LT",nextDay:"[moarn om] LT",nextWeek:"dddd [om] LT",lastDay:"[juster om] LT",lastWeek:"[frne] dddd [om] LT",sameElse:"L"},relativeTime:{future:"oer %s",past:"%s lyn",s:"in pear sekonden",ss:"%d sekonden",m:"ien mint",mm:"%d minuten",h:"ien oere",hh:"%d oeren",d:"ien dei",dd:"%d dagen",M:"ien moanne",MM:"%d moannen",y:"ien jier",yy:"%d jierren"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t=["Am Faoilleach","An Gearran","Am M rt","An Giblean","An Citean","An t-gmhios","An t-Iuchar","An Lnastal","An t-Sultain","An D mhair","An t-Samhain","An Dbhlachd"],i=["Faoi","Gear","M rt","Gibl","Cit","gmh","Iuch","Ln","Sult","D mh","Samh","Dbh"],r=["Didmhnaich","Diluain","Dim irt","Diciadain","Diardaoin","Dihaoine","Disathairne"],a=["Did","Dil","Dim","Dic","Dia","Dih","Dis"],n=["D","Lu","M ","Ci","Ar","Ha","Sa"];return e.defineLocale("gd",{months:t,monthsShort:i,monthsParseExact:!0,weekdays:r,weekdaysShort:a,weekdaysMin:n,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[An-diugh aig] LT",nextDay:"[A-m ireach aig] LT",nextWeek:"dddd [aig] LT",lastDay:"[An-d aig] LT",lastWeek:"dddd [seo chaidh] [aig] LT",sameElse:"L"},relativeTime:{future:"ann an %s",past:"bho chionn %s",s:"beagan diogan",ss:"%d diogan",m:"mionaid",mm:"%d mionaidean",h:"uair",hh:"%d uairean",d:"latha",dd:"%d latha",M:"mos",MM:"%d mosan",y:"bliadhna",yy:"%d bliadhna"},dayOfMonthOrdinalParse:/\d{1,2}(d|na|mh)/,ordinal:function(e){return e+(1===e?"d":e%10==2?"na":"mh")},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("gl",{months:"xaneiro_febreiro_marzo_abril_maio_xuo_xullo_agosto_setembro_outubro_novembro_decembro".split("_"),monthsShort:"xan._feb._mar._abr._mai._xu._xul._ago._set._out._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"domingo_luns_martes_mrcores_xoves_venres_sbado".split("_"),weekdaysShort:"dom._lun._mar._mr._xov._ven._sb.".split("_"),weekdaysMin:"do_lu_ma_m_xo_ve_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoxe "+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[ma "+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd ["+(1!==this.hours()?"s":"a")+"] LT"},lastDay:function(){return"[onte "+(1!==this.hours()?"":"a")+"] LT"},lastWeek:function(){return"[o] dddd [pasado "+(1!==this.hours()?"s":"a")+"] LT"},sameElse:"L"},relativeTime:{future:function(e){return 0===e.indexOf("un")?"n"+e:"en "+e},past:"hai %s",s:"uns segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"unha hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e,t,i,r){var a={s:["thodde secondanim","thodde second"],ss:[e+" secondanim",e+" second"],m:["eka mintan","ek minute"],mm:[e+" mintanim",e+" mintam"],h:["eka horan","ek hor"],hh:[e+" horanim",e+" hor"],d:["eka disan","ek dis"],dd:[e+" disanim",e+" dis"],M:["eka mhoinean","ek mhoino"],MM:[e+" mhoineanim",e+" mhoine"],y:["eka vorsan","ek voros"],yy:[e+" vorsanim",e+" vorsam"]};return t?a[i][0]:a[i][1]}return e.defineLocale("gom-latn",{months:"Janer_Febrer_Mars_Abril_Mai_Jun_Julai_Agost_Setembr_Otubr_Novembr_Dezembr".split("_"),monthsShort:"Jan._Feb._Mars_Abr._Mai_Jun_Jul._Ago._Set._Otu._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Aitar_Somar_Mongllar_Budvar_Brestar_Sukrar_Son'var".split("_"),weekdaysShort:"Ait._Som._Mon._Bud._Bre._Suk._Son.".split("_"),weekdaysMin:"Ai_Sm_Mo_Bu_Br_Su_Sn".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"A h:mm [vazta]",LTS:"A h:mm:ss [vazta]",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY A h:mm [vazta]",LLLL:"dddd, MMMM[achea] Do, YYYY, A h:mm [vazta]",llll:"ddd, D MMM YYYY, A h:mm [vazta]"},calendar:{sameDay:"[Aiz] LT",nextDay:"[Faleam] LT",nextWeek:"[Ieta to] dddd[,] LT",lastDay:"[Kal] LT",lastWeek:"[Fatlo] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s adim",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}(er)/,ordinal:function(e,t){switch(t){case"D":return e+"er";default:case"M":case"Q":case"DDD":case"d":case"w":case"W":return e}},week:{dow:1,doy:4},meridiemParse:/rati|sokalli|donparam|sanje/,meridiemHour:function(e,t){return 12===e&&(e=0),"rati"===t?e<4?e:e+12:"sokalli"===t?e:"donparam"===t?e>12?e:e+12:"sanje"===t?e+12:void 0},meridiem:function(e,t,i){return e<4?"rati":e<12?"sokalli":e<16?"donparam":e<20?"sanje":"rati"}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("gu",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,i){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("he",{months:" _____ _____ _".split("_"),monthsShort:" _____ _____ _".split("_"),weekdays:"_ _____".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D []MMMM YYYY",LLL:"D []MMMM YYYY HH:mm",LLLL:"dddd, D []MMMM YYYY HH:mm",l:"D/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},calendar:{sameDay:"[ ]LT",nextDay:"[ ]LT",nextWeek:"dddd [] LT",lastDay:"[ ]LT",lastWeek:"[] dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:"  %s",s:"  ",ss:"%d  ",m:"",mm:"%d ",h:"",hh:function(e){return 2===e?"":e+" "},d:"",dd:function(e){return 2===e?"":e+" "},M:"",MM:function(e){return 2===e?"":e+" "},y:" ",yy:function(e){return 2===e?" ":e%10==0&&10!==e?e+"  ":e+"  "}},meridiemParse:/"| "| |  |  ||/i,isPM:function(e){return/^("| |)$/.test(e)},meridiem:function(e,t,i){return e<5?"  ":e<10?"":e<12?i?' "':"  ":e<18?i?'"':" ":""}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("hi",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,i){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e,t,i){var r=e+" ";switch(i){case"ss":return r+=1===e?"sekunda":2===e||3===e||4===e?"sekunde":"sekundi";case"m":return t?"jedna minuta":"jedne minute";case"mm":return r+=1===e?"minuta":2===e||3===e||4===e?"minute":"minuta";case"h":return t?"jedan sat":"jednog sata";case"hh":return r+=1===e?"sat":2===e||3===e||4===e?"sata":"sati";case"dd":return r+=1===e?"dan":"dana";case"MM":return r+=1===e?"mjesec":2===e||3===e||4===e?"mjeseca":"mjeseci";case"yy":return r+=1===e?"godina":2===e||3===e||4===e?"godine":"godina"}}return e.defineLocale("hr",{months:{format:"sijenja_veljae_oujka_travnja_svibnja_lipnja_srpnja_kolovoza_rujna_listopada_studenoga_prosinca".split("_"),standalone:"sijeanj_veljaa_oujak_travanj_svibanj_lipanj_srpanj_kolovoz_rujan_listopad_studeni_prosinac".split("_")},monthsShort:"sij._velj._ou._tra._svi._lip._srp._kol._ruj._lis._stu._pro.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prolu] dddd [u] LT";case 6:return"[prole] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[proli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",ss:t,m:t,mm:t,h:t,hh:t,d:"dan",dd:t,M:"mjesec",MM:t,y:"godinu",yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e,t,i,r){var a=e;switch(i){case"s":return r||t?"nhny msodperc":"nhny msodperce";case"ss":return a+(r||t)?" msodperc":" msodperce";case"m":return"egy"+(r||t?" perc":" perce");case"mm":return a+(r||t?" perc":" perce");case"h":return"egy"+(r||t?" ra":" rja");case"hh":return a+(r||t?" ra":" rja");case"d":return"egy"+(r||t?" nap":" napja");case"dd":return a+(r||t?" nap":" napja");case"M":return"egy"+(r||t?" hnap":" hnapja");case"MM":return a+(r||t?" hnap":" hnapja");case"y":return"egy"+(r||t?" v":" ve");case"yy":return a+(r||t?" v":" ve")}return""}function i(e){return(e?"":"[mlt] ")+"["+r[this.day()]+"] LT[-kor]"}var r="vasrnap htfn kedden szerdn cstrtkn pnteken szombaton".split(" ");return e.defineLocale("hu",{months:"janur_februr_mrcius_prilis_mjus_jnius_jlius_augusztus_szeptember_oktber_november_december".split("_"),monthsShort:"jan_feb_mrc_pr_mj_jn_jl_aug_szept_okt_nov_dec".split("_"),weekdays:"vasrnap_htf_kedd_szerda_cstrtk_pntek_szombat".split("_"),weekdaysShort:"vas_ht_kedd_sze_cst_pn_szo".split("_"),weekdaysMin:"v_h_k_sze_cs_p_szo".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY. MMMM D.",LLL:"YYYY. MMMM D. H:mm",LLLL:"YYYY. MMMM D., dddd H:mm"},meridiemParse:/de|du/i,isPM:function(e){return"u"===e.charAt(1).toLowerCase()},meridiem:function(e,t,i){return e<12?!0===i?"de":"DE":!0===i?"du":"DU"},calendar:{sameDay:"[ma] LT[-kor]",nextDay:"[holnap] LT[-kor]",nextWeek:function(){return i.call(this,!0)},lastDay:"[tegnap] LT[-kor]",lastWeek:function(){return i.call(this,!1)},sameElse:"L"},relativeTime:{future:"%s mlva",past:"%s",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("hy-am",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",lastDay:"[] LT",nextWeek:function(){return"dddd [ ] LT"},lastWeek:function(){return"[] dddd [ ] LT"},sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},meridiemParse:/|||/,isPM:function(e){return/^(|)$/.test(e)},meridiem:function(e){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}|\d{1,2}-(|)/,ordinal:function(e,t){switch(t){case"DDD":case"w":case"W":case"DDDo":return 1===e?e+"-":e+"-";default:return e}},week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("id",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nov_Des".split("_"),weekdays:"Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),weekdaysShort:"Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|siang|sore|malam/,meridiemHour:function(e,t){return 12===e&&(e=0),"pagi"===t?e:"siang"===t?e>=11?e:e+12:"sore"===t||"malam"===t?e+12:void 0},meridiem:function(e,t,i){return e<11?"pagi":e<15?"siang":e<19?"sore":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Besok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kemarin pukul] LT",lastWeek:"dddd [lalu pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lalu",s:"beberapa detik",ss:"%d detik",m:"semenit",mm:"%d menit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e){return e%100==11||e%10!=1}function i(e,i,r,a){var n=e+" ";switch(r){case"s":return i||a?"nokkrar sekndur":"nokkrum sekndum";case"ss":return t(e)?n+(i||a?"sekndur":"sekndum"):n+"seknda";case"m":return i?"mnta":"mntu";case"mm":return t(e)?n+(i||a?"mntur":"mntum"):i?n+"mnta":n+"mntu";case"hh":return t(e)?n+(i||a?"klukkustundir":"klukkustundum"):n+"klukkustund";case"d":return i?"dagur":a?"dag":"degi";case"dd":return t(e)?i?n+"dagar":n+(a?"daga":"dgum"):i?n+"dagur":n+(a?"dag":"degi");case"M":return i?"mnuur":a?"mnu":"mnui";case"MM":return t(e)?i?n+"mnuir":n+(a?"mnui":"mnuum"):i?n+"mnuur":n+(a?"mnu":"mnui");case"y":return i||a?"r":"ri";case"yy":return t(e)?n+(i||a?"r":"rum"):n+(i||a?"r":"ri")}}return e.defineLocale("is",{months:"janar_febrar_mars_aprl_ma_jn_jl_gst_september_oktber_nvember_desember".split("_"),monthsShort:"jan_feb_mar_apr_ma_jn_jl_g_sep_okt_nv_des".split("_"),weekdays:"sunnudagur_mnudagur_rijudagur_mivikudagur_fimmtudagur_fstudagur_laugardagur".split("_"),weekdaysShort:"sun_mn_ri_mi_fim_fs_lau".split("_"),weekdaysMin:"Su_M_r_Mi_Fi_F_La".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd, D. MMMM YYYY [kl.] H:mm"},calendar:{sameDay:"[ dag kl.] LT",nextDay:"[ morgun kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[ gr kl.] LT",lastWeek:"[sasta] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"eftir %s",past:"fyrir %s san",s:i,ss:i,m:i,mm:i,h:"klukkustund",hh:i,d:i,dd:i,M:i,MM:i,y:i,yy:i},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("it",{months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),weekdays:"domenica_luned_marted_mercoled_gioved_venerd_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Oggi alle] LT",nextDay:"[Domani alle] LT",nextWeek:"dddd [alle] LT",lastDay:"[Ieri alle] LT",lastWeek:function(){switch(this.day()){case 0:return"[la scorsa] dddd [alle] LT";default:return"[lo scorso] dddd [alle] LT"}},sameElse:"L"},relativeTime:{future:function(e){return(/^[0-9].+$/.test(e)?"tra":"in")+" "+e},past:"%s fa",s:"alcuni secondi",ss:"%d secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("ja",{months:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMD HH:mm dddd",l:"YYYY/MM/DD",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMD HH:mm dddd"},meridiemParse:/|/i,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd LT",lastDay:"[] LT",lastWeek:"[]dddd LT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d",m:"1",mm:"%d",h:"1",hh:"%d",d:"1",dd:"%d",M:"1",MM:"%d",y:"1",yy:"%d"}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("jv",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_Nopember_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nop_Des".split("_"),weekdays:"Minggu_Senen_Seloso_Rebu_Kemis_Jemuwah_Septu".split("_"),weekdaysShort:"Min_Sen_Sel_Reb_Kem_Jem_Sep".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sp".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/enjing|siyang|sonten|ndalu/,meridiemHour:function(e,t){return 12===e&&(e=0),"enjing"===t?e:"siyang"===t?e>=11?e:e+12:"sonten"===t||"ndalu"===t?e+12:void 0},meridiem:function(e,t,i){return e<11?"enjing":e<15?"siyang":e<19?"sonten":"ndalu"},calendar:{sameDay:"[Dinten puniko pukul] LT",nextDay:"[Mbenjang pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kala wingi pukul] LT",lastWeek:"dddd [kepengker pukul] LT",sameElse:"L"},relativeTime:{future:"wonten ing %s",past:"%s ingkang kepengker",s:"sawetawis detik",ss:"%d detik",m:"setunggal menit",mm:"%d menit",h:"setunggal jam",hh:"%d jam",d:"sedinten",dd:"%d dinten",M:"sewulan",MM:"%d wulan",y:"setaun",yy:"%d taun"},week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("ka",{months:{standalone:" _ _ _ _____ _ _ _ ".split("_"),format:" _ _ _ _____ _ _ _ ".split("_")},monthsShort:"__ _ ________".split("_"),weekdays:{standalone:" _ ____ _".split("_"),format:" _ ____ _".split("_"),isFormat:/(|)/},weekdaysShort:"_ ____ _".split("_"),weekdaysMin:"_ _____".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[] LT[-]",nextDay:"[] LT[-]",lastDay:"[] LT[-]",nextWeek:"[] dddd LT[-]",lastWeek:"[] dddd LT-",sameElse:"L"},relativeTime:{future:function(e){return/(|||)/.test(e)?e.replace(/$/,""):e+""},past:function(e){return/(||||)/.test(e)?e.replace(/(|)$/," ")://.test(e)?e.replace(/$/," "):void 0},s:"  ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/0|1-|-\d{1,2}|\d{1,2}-/,ordinal:function(e){return 0===e?e:1===e?e+"-":e<20||e<=100&&e%20==0||e%100==0?"-"+e:e+"-"},week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"};return e.defineLocale("kk",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"[ ] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|)/,ordinal:function(e){var i=e%10,r=e>=100?100:null;return e+(t[e]||t[i]||t[r])},week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("km",{months:"_______ ____".split("_"),monthsShort:"_______ ____".split("_"),weekdays:"____ __".split("_"),weekdaysShort:"____ __".split("_"),weekdaysMin:"____ __".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [ ] [] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("kn",{months:"___________".split("_"),monthsShort:"___________".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,i){return e<4?"":e<10?"":e<17?"":e<20?"":""},dayOfMonthOrdinalParse:/\d{1,2}()/,ordinal:function(e){return e+""},week:{dow:0,doy:6}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("ko",{months:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______ ".split("_"),weekdaysShort:"______ ".split("_"),weekdaysMin:"______ ".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h:mm",LLLL:"YYYY MMMM D dddd A h:mm",l:"YYYY.MM.DD",ll:"YYYY MMMM D",lll:"YYYY MMMM D A h:mm",llll:"YYYY MMMM D dddd A h:mm"},calendar:{sameDay:" LT",nextDay:" LT",nextWeek:"dddd LT",lastDay:"  LT",lastWeek:" dddd LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s  ",s:" ",ss:"%d",m:"1",mm:"%d",h:" ",hh:"%d",d:"",dd:"%d",M:" ",MM:"%d",y:" ",yy:"%d"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},meridiemParse:/ |/,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?" ":""}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"};return e.defineLocale("ky",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"[ ] dddd [] [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|||)/,ordinal:function(e){var i=e%10,r=e>=100?100:null;return e+(t[e]||t[i]||t[r])},week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e,t,i,r){var a={m:["eng Minutt","enger Minutt"],h:["eng Stonn","enger Stonn"],d:["een Dag","engem Dag"],M:["ee Mount","engem Mount"],y:["ee Joer","engem Joer"]};return t?a[i][0]:a[i][1]}function i(e){return a(e.substr(0,e.indexOf(" ")))?"a "+e:"an "+e}function r(e){return a(e.substr(0,e.indexOf(" ")))?"viru "+e:"virun "+e}function a(e){if(e=parseInt(e,10),isNaN(e))return!1;if(e<0)return!0;if(e<10)return 4<=e&&e<=7;if(e<100){var t=e%10,i=e/10;return a(0===t?i:t)}if(e<1e4){for(;e>=10;)e/=10;return a(e)}return e/=1e3,a(e)}return e.defineLocale("lb",{months:"Januar_Februar_Merz_Abrll_Mee_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Abr._Mee_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonndeg_Mindeg_Dnschdeg_Mttwoch_Donneschdeg_Freideg_Samschdeg".split("_"),weekdaysShort:"So._M._D._M._Do._Fr._Sa.".split("_"),weekdaysMin:"So_M_D_M_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm [Auer]",LTS:"H:mm:ss [Auer]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm [Auer]",LLLL:"dddd, D. MMMM YYYY H:mm [Auer]"},calendar:{sameDay:"[Haut um] LT",sameElse:"L",nextDay:"[Muer um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gschter um] LT",lastWeek:function(){switch(this.day()){case 2:case 4:return"[Leschten] dddd [um] LT";default:return"[Leschte] dddd [um] LT"}}},relativeTime:{future:i,past:r,s:"e puer Sekonnen",ss:"%d Sekonnen",m:t,mm:"%d Minutten",h:t,hh:"%d Stonnen",d:t,dd:"%d Deeg",M:t,MM:"%d Mint",y:t,yy:"%d Joer"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("lo",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd[] LT",lastDay:"[] LT",lastWeek:"[]dddd[] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "},dayOfMonthOrdinalParse:/()\d{1,2}/,ordinal:function(e){return""+e}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e,t,i,r){return t?"kelios sekunds":r?"keli sekundi":"kelias sekundes"}function i(e,t,i,r){return t?a(i)[0]:r?a(i)[1]:a(i)[2]}function r(e){return e%10==0||e>10&&e<20}function a(e){return o[e].split("_")}function n(e,t,n,o){var s=e+" ";return 1===e?s+i(e,t,n[0],o):t?s+(r(e)?a(n)[1]:a(n)[0]):o?s+a(n)[1]:s+(r(e)?a(n)[1]:a(n)[2])}var o={ss:"sekund_sekundi_sekundes",m:"minut_minuts_minut",mm:"minuts_minui_minutes",h:"valanda_valandos_valand",hh:"valandos_valand_valandas",d:"diena_dienos_dien",dd:"dienos_dien_dienas",M:"mnuo_mnesio_mnes",MM:"mnesiai_mnesi_mnesius",y:"metai_met_metus",yy:"metai_met_metus"};return e.defineLocale("lt",{months:{format:"sausio_vasario_kovo_balandio_gegus_birelio_liepos_rugpjio_rugsjo_spalio_lapkriio_gruodio".split("_"),standalone:"sausis_vasaris_kovas_balandis_gegu_birelis_liepa_rugpjtis_rugsjis_spalis_lapkritis_gruodis".split("_"),isFormat:/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?|MMMM?(\[[^\[\]]*\]|\s)+D[oD]?/},monthsShort:"sau_vas_kov_bal_geg_bir_lie_rgp_rgs_spa_lap_grd".split("_"),weekdays:{format:"sekmadien_pirmadien_antradien_treiadien_ketvirtadien_penktadien_etadien".split("_"),standalone:"sekmadienis_pirmadienis_antradienis_treiadienis_ketvirtadienis_penktadienis_etadienis".split("_"),isFormat:/dddd HH:mm/},weekdaysShort:"Sek_Pir_Ant_Tre_Ket_Pen_ e".split("_"),weekdaysMin:"S_P_A_T_K_Pn_ ".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY [m.] MMMM D [d.]",LLL:"YYYY [m.] MMMM D [d.], HH:mm [val.]",LLLL:"YYYY [m.] MMMM D [d.], dddd, HH:mm [val.]",l:"YYYY-MM-DD",ll:"YYYY [m.] MMMM D [d.]",lll:"YYYY [m.] MMMM D [d.], HH:mm [val.]",llll:"YYYY [m.] MMMM D [d.], ddd, HH:mm [val.]"},calendar:{sameDay:"[ iandien] LT",nextDay:"[Rytoj] LT",nextWeek:"dddd LT",lastDay:"[Vakar] LT",lastWeek:"[Prajus] dddd LT",sameElse:"L"},relativeTime:{future:"po %s",past:"prie %s",s:t,ss:n,m:i,mm:n,h:i,hh:n,d:i,dd:n,M:i,MM:n,y:i,yy:n},dayOfMonthOrdinalParse:/\d{1,2}-oji/,ordinal:function(e){return e+"-oji"},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e,t,i){return i?t%10==1&&t%100!=11?e[2]:e[3]:t%10==1&&t%100!=11?e[0]:e[1]}function i(e,i,r){return e+" "+t(n[r],e,i)}function r(e,i,r){return t(n[r],e,i)}function a(e,t){return t?"daas sekundes":"dam sekundm"}var n={ss:"sekundes_sekundm_sekunde_sekundes".split("_"),m:"mintes_mintm_minte_mintes".split("_"),mm:"mintes_mintm_minte_mintes".split("_"),h:"stundas_stundm_stunda_stundas".split("_"),hh:"stundas_stundm_stunda_stundas".split("_"),d:"dienas_dienm_diena_dienas".split("_"),dd:"dienas_dienm_diena_dienas".split("_"),M:"mnea_mneiem_mnesis_mnei".split("_"),MM:"mnea_mneiem_mnesis_mnei".split("_"),y:"gada_gadiem_gads_gadi".split("_"),yy:"gada_gadiem_gads_gadi".split("_")};return e.defineLocale("lv",{months:"janvris_februris_marts_aprlis_maijs_jnijs_jlijs_augusts_septembris_oktobris_novembris_decembris".split("_"),monthsShort:"jan_feb_mar_apr_mai_jn_jl_aug_sep_okt_nov_dec".split("_"),weekdays:"svtdiena_pirmdiena_otrdiena_trediena_ceturtdiena_piektdiena_sestdiena".split("_"),weekdaysShort:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysMin:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY.",LL:"YYYY. [gada] D. MMMM",LLL:"YYYY. [gada] D. MMMM, HH:mm",LLLL:"YYYY. [gada] D. MMMM, dddd, HH:mm"},calendar:{sameDay:"[ odien pulksten] LT",nextDay:"[Rt pulksten] LT",nextWeek:"dddd [pulksten] LT",lastDay:"[Vakar pulksten] LT",lastWeek:"[Pagju] dddd [pulksten] LT",sameElse:"L"},relativeTime:{future:"pc %s",past:"pirms %s",s:a,ss:i,m:r,mm:i,h:r,hh:i,d:r,dd:i,M:r,MM:i,y:r,yy:i},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t={words:{ss:["sekund","sekunda","sekundi"],m:["jedan minut","jednog minuta"],mm:["minut","minuta","minuta"],h:["jedan sat","jednog sata"],hh:["sat","sata","sati"],dd:["dan","dana","dana"],MM:["mjesec","mjeseca","mjeseci"],yy:["godina","godine","godina"]},correctGrammaticalCase:function(e,t){return 1===e?t[0]:e>=2&&e<=4?t[1]:t[2]},translate:function(e,i,r){var a=t.words[r];return 1===r.length?i?a[0]:a[1]:e+" "+t.correctGrammaticalCase(e,a)}};return e.defineLocale("me",{months:"januar_februar_mart_april_maj_jun_jul_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj_jun_jul_avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sjutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jue u] LT",lastWeek:function(){return["[prole] [nedjelje] [u] LT","[prolog] [ponedjeljka] [u] LT","[prolog] [utorka] [u] LT","[prole] [srijede] [u] LT","[prolog] [etvrtka] [u] LT","[prolog] [petka] [u] LT","[prole] [subote] [u] LT"][this.day()]},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"nekoliko sekundi",ss:t.translate,m:t.translate,mm:t.translate,h:t.translate,hh:t.translate,d:"dan",dd:t.translate,M:"mjesec",MM:t.translate,y:"godinu",yy:t.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("mi",{months:"Kohi-tte_Hui-tanguru_Pout-te-rangi_Paenga-whwh_Haratua_Pipiri_Hngoingoi_Here-turi-kk_Mahuru_Whiringa--nuku_Whiringa--rangi_Hakihea".split("_"),monthsShort:"Kohi_Hui_Pou_Pae_Hara_Pipi_Hngoi_Here_Mahu_Whi-nu_Whi-ra_Haki".split("_"),monthsRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsStrictRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsShortRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsShortStrictRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,2}/i,weekdays:"Rtapu_Mane_Trei_Wenerei_Tite_Paraire_Htarei".split("_"),weekdaysShort:"Ta_Ma_T_We_Ti_Pa_H".split("_"),weekdaysMin:"Ta_Ma_T_We_Ti_Pa_H".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [i] HH:mm",LLLL:"dddd, D MMMM YYYY [i] HH:mm"},calendar:{sameDay:"[i teie mahana, i] LT",nextDay:"[apopo i] LT",nextWeek:"dddd [i] LT",lastDay:"[inanahi i] LT",lastWeek:"dddd [whakamutunga i] LT",sameElse:"L"},relativeTime:{future:"i roto i %s",past:"%s i mua",s:"te hkona ruarua",ss:"%d hkona",m:"he meneti",mm:"%d meneti",h:"te haora",hh:"%d haora",d:"he ra",dd:"%d ra",M:"he marama",MM:"%d marama",y:"he tau",yy:"%d tau"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("mk",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"e_o_____a".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"[] dddd [] LT",lastDay:"[ ] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[] dddd [] LT";case 1:case 2:case 4:case 5:return"[] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|||||)/,ordinal:function(e){var t=e%10,i=e%100;return 0===e?e+"-":0===i?e+"-":i>10&&i<20?e+"-":1===t?e+"-":2===t?e+"-":7===t||8===t?e+"-":e+"-"},week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("ml",{months:"___________".split("_"),monthsShort:"._._._.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm -",LTS:"A h:mm:ss -",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm -",LLLL:"dddd, D MMMM YYYY, A h:mm -"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},meridiemParse:/|| ||/i,meridiemHour:function(e,t){return 12===e&&(e=0),""===t&&e>=4||" "===t||""===t?e+12:e},meridiem:function(e,t,i){return e<4?"":e<12?"":e<17?" ":e<20?"":""}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e,t,i,r){var a="";if(t)switch(i){case"s":a=" ";break;case"ss":a="%d ";break;case"m":a=" ";break;case"mm":a="%d ";break;case"h":a=" ";break;case"hh":a="%d ";break;case"d":a=" ";break;case"dd":a="%d ";break;case"M":a=" ";break;case"MM":a="%d ";break;case"y":a=" ";break;case"yy":a="%d "}else switch(i){case"s":a=" ";break;case"ss":a="%d ";break;case"m":a=" ";break;case"mm":a="%d ";break;case"h":a=" ";break;case"hh":a="%d ";break;case"d":a=" ";break;case"dd":a="%d ";break;case"M":a=" ";break;case"MM":a="%d ";break;case"y":a=" ";break;case"yy":a="%d "}return a.replace(/%d/i,e)}var i={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},r={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("mr",{months:"___________".split("_"),monthsShort:"._._._._._._._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},preparse:function(e){return e.replace(/[]/g,function(e){return r[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return i[e]})},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,i){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("ms",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|tengahari|petang|malam/,meridiemHour:function(e,t){return 12===e&&(e=0),"pagi"===t?e:"tengahari"===t?e>=11?e:e+12:"petang"===t||"malam"===t?e+12:void 0},meridiem:function(e,t,i){return e<11?"pagi":e<15?"tengahari":e<19?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",ss:"%d saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("ms-my",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|tengahari|petang|malam/,meridiemHour:function(e,t){return 12===e&&(e=0),"pagi"===t?e:"tengahari"===t?e>=11?e:e+12:"petang"===t||"malam"===t?e+12:void 0},meridiem:function(e,t,i){return e<11?"pagi":e<15?"tengahari":e<19?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",ss:"%d saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("mt",{months:"Jannar_Frar_Marzu_April_Mejju_ unju_Lulju_Awwissu_Settembru_Ottubru_Novembru_Diembru".split("_"),monthsShort:"Jan_Fra_Mar_Apr_Mej_ un_Lul_Aww_Set_Ott_Nov_Di".split("_"),weekdays:"Il-add_It-Tnejn_It-Tlieta_L-Erbga_Il-amis_Il- imga_Is-Sibt".split("_"),weekdaysShort:"ad_Tne_Tli_Erb_am_ im_Sib".split("_"),weekdaysMin:"a_Tn_Tl_Er_a_ i_Si".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Illum fil-]LT",nextDay:"[Gada fil-]LT",nextWeek:"dddd [fil-]LT",lastDay:"[Il-biera fil-]LT",lastWeek:"dddd [li gadda] [fil-]LT",sameElse:"L"},relativeTime:{future:"f %s",past:"%s ilu",s:"ftit sekondi",ss:"%d sekondi",m:"minuta",mm:"%d minuti",h:"siega",hh:"%d siegat",d:"urnata",dd:"%d ranet",M:"xahar",MM:"%d xhur",y:"sena",yy:"%d sni"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("my",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[.] LT []",nextDay:"[] LT []",nextWeek:"dddd LT []",lastDay:"[.] LT []",lastWeek:"[] dddd LT []",sameElse:"L"},relativeTime:{future:" %s ",past:" %s ",s:".",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("nb",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan._feb._mars_april_mai_juni_juli_aug._sep._okt._nov._des.".split("_"),monthsParseExact:!0,weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"s._ma._ti._on._to._fr._l.".split("_"),weekdaysMin:"s_ma_ti_on_to_fr_l".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] HH:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[i gr kl.] LT",lastWeek:"[forrige] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"noen sekunder",ss:"%d sekunder",m:"ett minutt",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dager",M:"en mned",MM:"%d mneder",y:"ett r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("ne",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"._._._._._._.".split("_"),weekdaysMin:"._._._._._._.".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},preparse:function(e){return e.replace(/[]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,i){return e<3?"":e<12?"":e<16?"":e<20?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd[,] LT",lastDay:"[] LT",lastWeek:"[] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},week:{dow:0,doy:6}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),i="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),r=[/^jan/i,/^feb/i,/^maart|mrt.?$/i,/^apr/i,/^mei$/i,/^jun[i.]?$/i,/^jul[i.]?$/i,/^aug/i,/^sep/i,/^okt/i,/^nov/i,/^dec/i],a=/^(januari|februari|maart|april|mei|april|ju[nl]i|augustus|september|oktober|november|december|jan\.?|feb\.?|mrt\.?|apr\.?|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i;return e.defineLocale("nl",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(e,r){return e?/-MMM-/.test(r)?i[e.month()]:t[e.month()]:t},monthsRegex:a,monthsShortRegex:a,monthsStrictRegex:/^(januari|februari|maart|mei|ju[nl]i|april|augustus|september|oktober|november|december)/i,monthsShortStrictRegex:/^(jan\.?|feb\.?|mrt\.?|apr\.?|mei|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,monthsParse:r,longMonthsParse:r,shortMonthsParse:r,weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",ss:"%d seconden",m:"n minuut",mm:"%d minuten",h:"n uur",hh:"%d uur",d:"n dag",dd:"%d dagen",M:"n maand",MM:"%d maanden",y:"n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),i="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),r=[/^jan/i,/^feb/i,/^maart|mrt.?$/i,/^apr/i,/^mei$/i,/^jun[i.]?$/i,/^jul[i.]?$/i,/^aug/i,/^sep/i,/^okt/i,/^nov/i,/^dec/i],a=/^(januari|februari|maart|april|mei|april|ju[nl]i|augustus|september|oktober|november|december|jan\.?|feb\.?|mrt\.?|apr\.?|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i;return e.defineLocale("nl-be",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(e,r){return e?/-MMM-/.test(r)?i[e.month()]:t[e.month()]:t},monthsRegex:a,monthsShortRegex:a,monthsStrictRegex:/^(januari|februari|maart|mei|ju[nl]i|april|augustus|september|oktober|november|december)/i,monthsShortStrictRegex:/^(jan\.?|feb\.?|mrt\.?|apr\.?|mei|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,monthsParse:r,longMonthsParse:r,shortMonthsParse:r,weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",ss:"%d seconden",m:"n minuut",mm:"%d minuten",h:"n uur",hh:"%d uur",d:"n dag",dd:"%d dagen",M:"n maand",MM:"%d maanden",y:"n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("nn",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sundag_mndag_tysdag_onsdag_torsdag_fredag_laurdag".split("_"),weekdaysShort:"sun_mn_tys_ons_tor_fre_lau".split("_"),weekdaysMin:"su_m_ty_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[I dag klokka] LT",nextDay:"[I morgon klokka] LT",nextWeek:"dddd [klokka] LT",lastDay:"[I gr klokka] LT",lastWeek:"[Fregande] dddd [klokka] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s sidan",s:"nokre sekund",ss:"%d sekund",m:"eit minutt",mm:"%d minutt",h:"ein time",hh:"%d timar",d:"ein dag",dd:"%d dagar",M:"ein mnad",MM:"%d mnader",y:"eit r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("pa-in",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,i){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e){return e%10<5&&e%10>1&&~~(e/10)%10!=1}function i(e,i,r){var a=e+" ";switch(r){case"ss":return a+(t(e)?"sekundy":"sekund");case"m":return i?"minuta":"minut";case"mm":return a+(t(e)?"minuty":"minut");case"h":return i?"godzina":"godzin";case"hh":return a+(t(e)?"godziny":"godzin");case"MM":return a+(t(e)?"miesice":"miesicy");case"yy":return a+(t(e)?"lata":"lat")}}var r="stycze_luty_marzec_kwiecie_maj_czerwiec_lipiec_sierpie_wrzesie_padziernik_listopad_grudzie".split("_"),a="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_wrzenia_padziernika_listopada_grudnia".split("_");return e.defineLocale("pl",{months:function(e,t){return e?""===t?"("+a[e.month()]+"|"+r[e.month()]+")":/D MMMM/.test(t)?a[e.month()]:r[e.month()]:r},monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_pa_lis_gru".split("_"),weekdays:"niedziela_poniedziaek_wtorek_roda_czwartek_pitek_sobota".split("_"),weekdaysShort:"ndz_pon_wt_r_czw_pt_sob".split("_"),weekdaysMin:"Nd_Pn_Wt_r_Cz_Pt_So".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Dzi o] LT",nextDay:"[Jutro o] LT",nextWeek:function(){switch(this.day()){case 0:return"[W niedziel o] LT";case 2:return"[We wtorek o] LT";case 3:return"[W rod o] LT";case 6:return"[W sobot o] LT";default:return"[W] dddd [o] LT"}},lastDay:"[Wczoraj o] LT",lastWeek:function(){switch(this.day()){case 0:return"[W zesz niedziel o] LT";case 3:return"[W zesz rod o] LT";case 6:return"[W zesz sobot o] LT";default:return"[W zeszy] dddd [o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",ss:i,m:i,mm:i,h:i,hh:i,d:"1 dzie",dd:"%d dni",M:"miesic",MM:i,y:"rok",yy:i},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("pt",{months:"janeiro_fevereiro_maro_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro".split("_"),monthsShort:"jan_fev_mar_abr_mai_jun_jul_ago_set_out_nov_dez".split("_"),weekdays:"Domingo_Segunda-feira_Tera-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sbado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sb".split("_"),weekdaysMin:"Do_2_3_4_5_6_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY HH:mm"},calendar:{sameDay:"[Hoje  s] LT",nextDay:"[Amanh  s] LT",nextWeek:"dddd [ s] LT",lastDay:"[Ontem  s] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[ltimo] dddd [ s] LT":"[ltima] dddd [ s] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"h %s",s:"segundos",ss:"%d segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("pt-br",{months:"janeiro_fevereiro_maro_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro".split("_"),monthsShort:"jan_fev_mar_abr_mai_jun_jul_ago_set_out_nov_dez".split("_"),weekdays:"Domingo_Segunda-feira_Tera-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sbado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sb".split("_"),weekdaysMin:"Do_2_3_4_5_6_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [ s] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [ s] HH:mm"},calendar:{sameDay:"[Hoje  s] LT",nextDay:"[Amanh  s] LT",nextWeek:"dddd [ s] LT",lastDay:"[Ontem  s] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[ltimo] dddd [ s] LT":"[ltima] dddd [ s] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"%s atrs",s:"poucos segundos",ss:"%d segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d"})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e,t,i){var r={ss:"secunde",mm:"minute",hh:"ore",dd:"zile",MM:"luni",yy:"ani"},a=" ";return(e%100>=20||e>=100&&e%100==0)&&(a=" de "),e+a+r[i]}return e.defineLocale("ro",{months:"ianuarie_februarie_martie_aprilie_mai_iunie_iulie_august_septembrie_octombrie_noiembrie_decembrie".split("_"),monthsShort:"ian._febr._mart._apr._mai_iun._iul._aug._sept._oct._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"duminic_luni_mari_miercuri_joi_vineri_smbt".split("_"),weekdaysShort:"Dum_Lun_Mar_Mie_Joi_Vin_Sm".split("_"),weekdaysMin:"Du_Lu_Ma_Mi_Jo_Vi_S".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[azi la] LT",nextDay:"[mine la] LT",nextWeek:"dddd [la] LT",lastDay:"[ieri la] LT",lastWeek:"[fosta] dddd [la] LT",sameElse:"L"},relativeTime:{future:"peste %s",past:"%s n urm",s:"cteva secunde",ss:t,m:"un minut",mm:t,h:"o or",hh:t,d:"o zi",dd:t,M:"o lun",MM:t,y:"un an",yy:t},week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e,t){var i=e.split("_");return t%10==1&&t%100!=11?i[0]:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?i[1]:i[2]}function i(e,i,r){var a={ss:i?"__":"__",mm:i?"__":"__",hh:"__",dd:"__",MM:"__",yy:"__"};return"m"===r?i?"":"":e+" "+t(a[r],+e)}var r=[/^/i,/^/i,/^/i,/^/i,/^[]/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i];return e.defineLocale("ru",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:{format:"._._._.____._._._._.".split("_"),standalone:"._.__.____._._._._.".split("_")},weekdays:{standalone:"______".split("_"),format:"______".split("_"),isFormat:/\[ ?[] ?(?:||)? ?\] ?dddd/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),monthsParse:r,longMonthsParse:r,shortMonthsParse:r,monthsRegex:/^([]|\.?|[]|?\.?|?|\.?|[]|\.?|[]|[]|\.?|[]|\.?|?|\.?|[]|?\.?|[]|\.?|[]|?\.?|[]|\.?)/i,monthsShortRegex:/^([]|\.?|[]|?\.?|?|\.?|[]|\.?|[]|[]|\.?|[]|\.?|?|\.?|[]|?\.?|[]|\.?|[]|?\.?|[]|\.?)/i,monthsStrictRegex:/^([]|[]|?|[]|[]|[]|[]|?|[]|[]|[]|[])/i,monthsShortStrictRegex:/^(\.|?\.|[.]|\.|[]|[.]|[.]|\.|?\.|\.|?\.|\.)/i,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., H:mm",LLLL:"dddd, D MMMM YYYY ., H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",lastDay:"[ ] LT",nextWeek:function(e){if(e.week()===this.week())return 2===this.day()?"[] dddd [] LT":"[] dddd [] LT";switch(this.day()){case 0:return"[ ] dddd [] LT";case 1:case 2:case 4:return"[ ] dddd [] LT";case 3:case 5:case 6:return"[ ] dddd [] LT"}},lastWeek:function(e){if(e.week()===this.week())return 2===this.day()?"[] dddd [] LT":"[] dddd [] LT";switch(this.day()){case 0:return"[ ] dddd [] LT";case 1:case 2:case 4:return"[ ] dddd [] LT";case 3:case 5:case 6:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",ss:i,m:i,mm:i,h:"",hh:i,d:"",dd:i,M:"",MM:i,y:"",yy:i},meridiemParse:/|||/i,isPM:function(e){return/^(|)$/.test(e)},meridiem:function(e,t,i){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(||)/,ordinal:function(e,t){switch(t){case"M":case"d":case"DDD":return e+"-";case"D":return e+"-";case"w":case"W":return e+"-";default:return e}},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t=["","","","","","","","","","","",""],i=["","","","","","",""];return e.defineLocale("sd",{months:t,monthsShort:t,weekdays:i,weekdaysShort:i,weekdaysMin:i,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd [  ] LT",lastDay:"[] LT",lastWeek:"[ ] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("se",{months:"oajagemnnu_guovvamnnu_njukamnnu_cuoomnnu_miessemnnu_geassemnnu_suoidnemnnu_borgemnnu_akamnnu_golggotmnnu_skbmamnnu_juovlamnnu".split("_"),monthsShort:"oj_guov_njuk_cuo_mies_geas_suoi_borg_ak_golg_skb_juov".split("_"),weekdays:"sotnabeaivi_vuossrga_maebrga_gaskavahkku_duorastat_bearjadat_lvvardat".split("_"),weekdaysShort:"sotn_vuos_ma_gask_duor_bear_lv".split("_"),weekdaysMin:"s_v_m_g_d_b_L".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"MMMM D. [b.] YYYY",LLL:"MMMM D. [b.] YYYY [ti.] HH:mm",LLLL:"dddd, MMMM D. [b.] YYYY [ti.] HH:mm"},calendar:{sameDay:"[otne ti] LT",nextDay:"[ihttin ti] LT",nextWeek:"dddd [ti] LT",lastDay:"[ikte ti] LT",lastWeek:"[ovddit] dddd [ti] LT",sameElse:"L"},relativeTime:{future:"%s geaes",past:"mait %s",s:"moadde sekunddat",ss:"%d sekunddat",m:"okta minuhta",mm:"%d minuhtat",h:"okta diimmu",hh:"%d diimmut",d:"okta beaivi",dd:"%d beaivvit",M:"okta mnnu",MM:"%d mnut",y:"okta jahki",yy:"%d jagit"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("si",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"a h:mm",LTS:"a h:mm:ss",L:"YYYY/MM/DD",LL:"YYYY MMMM D",LLL:"YYYY MMMM D, a h:mm",LLLL:"YYYY MMMM D [] dddd, a h:mm:ss"},calendar:{sameDay:"[] LT[]",nextDay:"[] LT[]",nextWeek:"dddd LT[]",lastDay:"[] LT[]",lastWeek:"[] dddd LT[]",sameElse:"L"},relativeTime:{future:"%s",past:"%s ",s:" ",ss:" %d",m:"",mm:" %d",h:"",hh:" %d",d:"",dd:" %d",M:"",MM:" %d",y:"",yy:" %d"},dayOfMonthOrdinalParse:/\d{1,2} /,ordinal:function(e){return e+" "},meridiemParse:/ | |.|../,isPM:function(e){return".."===e||" "===e},meridiem:function(e,t,i){return e>11?i?"..":" ":i?"..":" "}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e){return e>1&&e<5}function i(e,i,r,a){var n=e+" ";switch(r){case"s":return i||a?"pr seknd":"pr sekundami";case"ss":return i||a?n+(t(e)?"sekundy":"seknd"):n+"sekundami";case"m":return i?"minta":a?"mintu":"mintou";case"mm":return i||a?n+(t(e)?"minty":"mint"):n+"mintami";case"h":return i?"hodina":a?"hodinu":"hodinou";case"hh":return i||a?n+(t(e)?"hodiny":"hodn"):n+"hodinami";case"d":return i||a?"de":"dom";case"dd":return i||a?n+(t(e)?"dni":"dn"):n+"dami";case"M":return i||a?"mesiac":"mesiacom";case"MM":return i||a?n+(t(e)?"mesiace":"mesiacov"):n+"mesiacmi";case"y":return i||a?"rok":"rokom";case"yy":return i||a?n+(t(e)?"roky":"rokov"):n+"rokmi"}}var r="janur_februr_marec_aprl_mj_jn_jl_august_september_oktber_november_december".split("_"),a="jan_feb_mar_apr_mj_jn_jl_aug_sep_okt_nov_dec".split("_");return e.defineLocale("sk",{months:r,monthsShort:a,weekdays:"nedea_pondelok_utorok_streda_tvrtok_piatok_sobota".split("_"),weekdaysShort:"ne_po_ut_st_t_pi_so".split("_"),weekdaysMin:"ne_po_ut_st_t_pi_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm"},calendar:{sameDay:"[dnes o] LT",nextDay:"[zajtra o] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedeu o] LT";case 1:case 2:return"[v] dddd [o] LT";case 3:return"[v stredu o] LT";case 4:return"[vo tvrtok o] LT";case 5:return"[v piatok o] LT";case 6:return"[v sobotu o] LT"}},lastDay:"[vera o] LT",lastWeek:function(){switch(this.day()){case 0:return"[minul nedeu o] LT";case 1:case 2:return"[minul] dddd [o] LT";case 3:return"[minul stredu o] LT";case 4:case 5:return"[minul] dddd [o] LT";case 6:return"[minul sobotu o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"pred %s",s:i,ss:i,m:i,mm:i,h:i,hh:i,d:i,dd:i,M:i,MM:i,y:i,yy:i},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e,t,i,r){var a=e+" ";switch(i){case"s":return t||r?"nekaj sekund":"nekaj sekundami";case"ss":return a+=1===e?t?"sekundo":"sekundi":2===e?t||r?"sekundi":"sekundah":e<5?t||r?"sekunde":"sekundah":"sekund";case"m":return t?"ena minuta":"eno minuto";case"mm":return a+=1===e?t?"minuta":"minuto":2===e?t||r?"minuti":"minutama":e<5?t||r?"minute":"minutami":t||r?"minut":"minutami";case"h":return t?"ena ura":"eno uro";case"hh":return a+=1===e?t?"ura":"uro":2===e?t||r?"uri":"urama":e<5?t||r?"ure":"urami":t||r?"ur":"urami";case"d":return t||r?"en dan":"enim dnem";case"dd":return a+=1===e?t||r?"dan":"dnem":2===e?t||r?"dni":"dnevoma":t||r?"dni":"dnevi";case"M":return t||r?"en mesec":"enim mesecem";case"MM":return a+=1===e?t||r?"mesec":"mesecem":2===e?t||r?"meseca":"mesecema":e<5?t||r?"mesece":"meseci":t||r?"mesecev":"meseci";case"y":return t||r?"eno leto":"enim letom";case"yy":return a+=1===e?t||r?"leto":"letom":2===e?t||r?"leti":"letoma":e<5?t||r?"leta":"leti":t||r?"let":"leti"}}return e.defineLocale("sl",{months:"januar_februar_marec_april_maj_junij_julij_avgust_september_oktober_november_december".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedelja_ponedeljek_torek_sreda_etrtek_petek_sobota".split("_"),weekdaysShort:"ned._pon._tor._sre._et._pet._sob.".split("_"),weekdaysMin:"ne_po_to_sr_e_pe_so".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danes ob] LT",nextDay:"[jutri ob] LT",nextWeek:function(){switch(this.day()){case 0:return"[v] [nedeljo] [ob] LT";case 3:return"[v] [sredo] [ob] LT";case 6:return"[v] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[v] dddd [ob] LT"}},lastDay:"[veraj ob] LT",lastWeek:function(){switch(this.day()){case 0:return"[prejnjo] [nedeljo] [ob] LT";case 3:return"[prejnjo] [sredo] [ob] LT";case 6:return"[prejnjo] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[prejnji] dddd [ob] LT"}},sameElse:"L"},relativeTime:{future:"ez %s",past:"pred %s",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("sq",{months:"Janar_Shkurt_Mars_Prill_Maj_Qershor_Korrik_Gusht_Shtator_Tetor_Nntor_Dhjetor".split("_"),monthsShort:"Jan_Shk_Mar_Pri_Maj_Qer_Kor_Gus_Sht_Tet_Nn_Dhj".split("_"),weekdays:"E Diel_E Hn_E Mart_E Mrkur_E Enjte_E Premte_E Shtun".split("_"),weekdaysShort:"Die_Hn_Mar_Mr_Enj_Pre_Sht".split("_"),weekdaysMin:"D_H_Ma_M_E_P_Sh".split("_"),weekdaysParseExact:!0,meridiemParse:/PD|MD/,isPM:function(e){return"M"===e.charAt(0)},meridiem:function(e,t,i){return e<12?"PD":"MD"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Sot n] LT",nextDay:"[Nesr n] LT",nextWeek:"dddd [n] LT",lastDay:"[Dje n] LT",lastWeek:"dddd [e kaluar n] LT",sameElse:"L"},relativeTime:{future:"n %s",past:"%s m par",s:"disa sekonda",ss:"%d sekonda",m:"nj minut",mm:"%d minuta",h:"nj or",hh:"%d or",d:"nj dit",dd:"%d dit",M:"nj muaj",MM:"%d muaj",y:"nj vit",yy:"%d vite"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t={words:{ss:["sekunda","sekunde","sekundi"],m:["jedan minut","jedne minute"],mm:["minut","minute","minuta"],h:["jedan sat","jednog sata"],hh:["sat","sata","sati"],dd:["dan","dana","dana"],MM:["mesec","meseca","meseci"],yy:["godina","godine","godina"]},correctGrammaticalCase:function(e,t){return 1===e?t[0]:e>=2&&e<=4?t[1]:t[2]},translate:function(e,i,r){var a=t.words[r];return 1===r.length?i?a[0]:a[1]:e+" "+t.correctGrammaticalCase(e,a)}};return e.defineLocale("sr",{months:"januar_februar_mart_april_maj_jun_jul_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj_jun_jul_avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedelja_ponedeljak_utorak_sreda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sre._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedelju] [u] LT";case 3:return"[u] [sredu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jue u] LT",lastWeek:function(){return["[prole] [nedelje] [u] LT","[prolog] [ponedeljka] [u] LT","[prolog] [utorka] [u] LT","[prole] [srede] [u] LT","[prolog] [etvrtka] [u] LT","[prolog] [petka] [u] LT","[prole] [subote] [u] LT"][this.day()]},sameElse:"L"},relativeTime:{future:"za %s",past:"pre %s",s:"nekoliko sekundi",ss:t.translate,m:t.translate,mm:t.translate,h:t.translate,hh:t.translate,d:"dan",dd:t.translate,M:"mesec",MM:t.translate,y:"godinu",yy:t.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t={words:{ss:["","",""],m:[" "," "],mm:["","",""],h:[" "," "],hh:["","",""],dd:["","",""],MM:["","",""],yy:["","",""]},correctGrammaticalCase:function(e,t){return 1===e?t[0]:e>=2&&e<=4?t[1]:t[2]},translate:function(e,i,r){var a=t.words[r];return 1===r.length?i?a[0]:a[1]:e+" "+t.correctGrammaticalCase(e,a)}};return e.defineLocale("sr-cyrl",{months:"___________".split("_"),monthsShort:"._._._.____._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"._._._._._._.".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:function(){switch(this.day()){case 0:return"[] [] [] LT";case 3:return"[] [] [] LT";case 6:return"[] [] [] LT";case 1:case 2:case 4:case 5:return"[] dddd [] LT"}},lastDay:"[ ] LT",lastWeek:function(){return["[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT"][this.day()]},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:t.translate,m:t.translate,mm:t.translate,h:t.translate,hh:t.translate,d:"",dd:t.translate,M:"",MM:t.translate,y:"",yy:t.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("ss",{months:"Bhimbidvwane_Indlovana_Indlov'lenkhulu_Mabasa_Inkhwekhweti_Inhlaba_Kholwane_Ingci_Inyoni_Imphala_Lweti_Ingongoni".split("_"),monthsShort:"Bhi_Ina_Inu_Mab_Ink_Inh_Kho_Igc_Iny_Imp_Lwe_Igo".split("_"),weekdays:"Lisontfo_Umsombuluko_Lesibili_Lesitsatfu_Lesine_Lesihlanu_Umgcibelo".split("_"),weekdaysShort:"Lis_Umb_Lsb_Les_Lsi_Lsh_Umg".split("_"),weekdaysMin:"Li_Us_Lb_Lt_Ls_Lh_Ug".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Namuhla nga] LT",nextDay:"[Kusasa nga] LT",nextWeek:"dddd [nga] LT",lastDay:"[Itolo nga] LT",lastWeek:"dddd [leliphelile] [nga] LT",sameElse:"L"},relativeTime:{future:"nga %s",past:"wenteka nga %s",s:"emizuzwana lomcane",ss:"%d mzuzwana",m:"umzuzu",mm:"%d emizuzu",h:"lihora",hh:"%d emahora",d:"lilanga",dd:"%d emalanga",M:"inyanga",MM:"%d tinyanga",y:"umnyaka",yy:"%d iminyaka"},meridiemParse:/ekuseni|emini|entsambama|ebusuku/,meridiem:function(e,t,i){return e<11?"ekuseni":e<15?"emini":e<19?"entsambama":"ebusuku"},meridiemHour:function(e,t){return 12===e&&(e=0),"ekuseni"===t?e:"emini"===t?e>=11?e:e+12:"entsambama"===t||"ebusuku"===t?0===e?0:e+12:void 0},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("sv",{months:"januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"sndag_mndag_tisdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_mn_tis_ons_tor_fre_lr".split("_"),weekdaysMin:"s_m_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [kl.] HH:mm",LLLL:"dddd D MMMM YYYY [kl.] HH:mm",lll:"D MMM YYYY HH:mm",llll:"ddd D MMM YYYY HH:mm"},calendar:{sameDay:"[Idag] LT",nextDay:"[Imorgon] LT",lastDay:"[Igr] LT",nextWeek:"[P] dddd LT",lastWeek:"[I] dddd[s] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"fr %s sedan",s:"ngra sekunder",ss:"%d sekunder",m:"en minut",mm:"%d minuter",h:"en timme",hh:"%d timmar",d:"en dag",dd:"%d dagar",M:"en mnad",MM:"%d mnader",y:"ett r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}(e|a)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"e":1===t?"a":2===t?"a":"e")},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("sw",{months:"Januari_Februari_Machi_Aprili_Mei_Juni_Julai_Agosti_Septemba_Oktoba_Novemba_Desemba".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ago_Sep_Okt_Nov_Des".split("_"),weekdays:"Jumapili_Jumatatu_Jumanne_Jumatano_Alhamisi_Ijumaa_Jumamosi".split("_"),weekdaysShort:"Jpl_Jtat_Jnne_Jtan_Alh_Ijm_Jmos".split("_"),weekdaysMin:"J2_J3_J4_J5_Al_Ij_J1".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[leo saa] LT",nextDay:"[kesho saa] LT",nextWeek:"[wiki ijayo] dddd [saat] LT",lastDay:"[jana] LT",lastWeek:"[wiki iliyopita] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s baadaye",past:"tokea %s",s:"hivi punde",ss:"sekunde %d",m:"dakika moja",mm:"dakika %d",h:"saa limoja",hh:"masaa %d",d:"siku moja",dd:"masiku %d",M:"mwezi mmoja",MM:"miezi %d",y:"mwaka mmoja",yy:"miaka %d"},week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("ta",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, HH:mm",LLLL:"dddd, D MMMM YYYY, HH:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[ ] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",ss:"%d ",m:" ",mm:"%d ",h:"  ",hh:"%d  ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e){return e+""},preparse:function(e){return e.replace(/[]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/|||||/,meridiem:function(e,t,i){return e<2?" ":e<6?" ":e<10?" ":e<14?" ":e<18?" ":e<22?" ":" "},meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<2?e:e+12:""===t||""===t?e:""===t&&e>=10?e:e+12},week:{dow:0,doy:6}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("te",{months:"___________".split("_"),monthsShort:"._.__.____._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,i){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("tet",{months:"Janeiru_Fevereiru_Marsu_Abril_Maiu_Juniu_Juliu_Augustu_Setembru_Outubru_Novembru_Dezembru".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Aug_Set_Out_Nov_Dez".split("_"),weekdays:"Domingu_Segunda_Tersa_Kuarta_Kinta_Sexta_Sabadu".split("_"),weekdaysShort:"Dom_Seg_Ters_Kua_Kint_Sext_Sab".split("_"),weekdaysMin:"Do_Seg_Te_Ku_Ki_Sex_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Ohin iha] LT",nextDay:"[Aban iha] LT",nextWeek:"dddd [iha] LT",lastDay:"[Horiseik iha] LT",lastWeek:"dddd [semana kotuk] [iha] LT",sameElse:"L"},relativeTime:{future:"iha %s",past:"%s liuba",s:"minutu balun",ss:"minutu %d",m:"minutu ida",mm:"minutus %d",h:"horas ida",hh:"horas %d",d:"loron ida",dd:"loron %d",M:"fulan ida",MM:"fulan %d",y:"tinan ida",yy:"tinan %d"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("th",{months:"_ ___ _______".split("_"),monthsShort:".._.._.._.._.._.._.._.._.._.._.._..".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"._._._._._._.".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY  H:mm",LLLL:"dddd D MMMM YYYY  H:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd[ ] LT",lastDay:"[ ] LT",lastWeek:"[]dddd[ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("tl-ph",{months:"Enero_Pebrero_Marso_Abril_Mayo_Hunyo_Hulyo_Agosto_Setyembre_Oktubre_Nobyembre_Disyembre".split("_"),monthsShort:"Ene_Peb_Mar_Abr_May_Hun_Hul_Ago_Set_Okt_Nob_Dis".split("_"),weekdays:"Linggo_Lunes_Martes_Miyerkules_Huwebes_Biyernes_Sabado".split("_"),weekdaysShort:"Lin_Lun_Mar_Miy_Huw_Biy_Sab".split("_"),weekdaysMin:"Li_Lu_Ma_Mi_Hu_Bi_Sab".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"MM/D/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY HH:mm",LLLL:"dddd, MMMM DD, YYYY HH:mm"},calendar:{sameDay:"LT [ngayong araw]",nextDay:"[Bukas ng] LT",nextWeek:"LT [sa susunod na] dddd",lastDay:"LT [kahapon]",lastWeek:"LT [noong nakaraang] dddd",sameElse:"L"},relativeTime:{future:"sa loob ng %s",past:"%s ang nakalipas",s:"ilang segundo",ss:"%d segundo",m:"isang minuto",mm:"%d minuto",h:"isang oras",hh:"%d oras",d:"isang araw",dd:"%d araw",M:"isang buwan",MM:"%d buwan",y:"isang taon",yy:"%d taon"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e){return e},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e){var t=e;return t=-1!==e.indexOf("jaj")?t.slice(0,-3)+"leS":-1!==e.indexOf("jar")?t.slice(0,-3)+"waQ":-1!==e.indexOf("DIS")?t.slice(0,-3)+"nem":t+" pIq"}function i(e){var t=e;return t=-1!==e.indexOf("jaj")?t.slice(0,-3)+"Hu":-1!==e.indexOf("jar")?t.slice(0,-3)+"wen":-1!==e.indexOf("DIS")?t.slice(0,-3)+"ben":t+" ret"}function r(e,t,i,r){var n=a(e);switch(i){case"ss":return n+" lup";case"mm":return n+" tup";case"hh":return n+" rep";case"dd":return n+" jaj";case"MM":return n+" jar";case"yy":return n+" DIS"}}function a(e){var t=Math.floor(e%1e3/100),i=Math.floor(e%100/10),r=e%10,a="";return t>0&&(a+=n[t]+"vatlh"),i>0&&(a+=(""!==a?" ":"")+n[i]+"maH"),r>0&&(a+=(""!==a?" ":"")+n[r]),""===a?"pagh":a}var n="pagh_wa_cha_wej_loS_vagh_jav_Soch_chorgh_Hut".split("_");return e.defineLocale("tlh",{months:"tera jar wa_tera jar cha_tera jar wej_tera jar loS_tera jar vagh_tera jar jav_tera jar Soch_tera jar chorgh_tera jar Hut_tera jar wamaH_tera jar wamaH wa_tera jar wamaH cha".split("_"),monthsShort:"jar wa_jar cha_jar wej_jar loS_jar vagh_jar jav_jar Soch_jar chorgh_jar Hut_jar wamaH_jar wamaH wa_jar wamaH cha".split("_"),monthsParseExact:!0,weekdays:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),weekdaysShort:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),weekdaysMin:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[DaHjaj] LT",nextDay:"[waleS] LT",nextWeek:"LLL",lastDay:"[waHu] LT",lastWeek:"LLL",sameElse:"L"},relativeTime:{future:t,past:i,s:"puS lup",ss:r,m:"wa tup",mm:r,h:"wa rep",hh:r,d:"wa jaj",dd:r,M:"wa jar",MM:r,y:"wa DIS",yy:r},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t={1:"'inci",5:"'inci",8:"'inci",70:"'inci",80:"'inci",2:"'nci",7:"'nci",20:"'nci",50:"'nci",3:"'nc",4:"'nc",100:"'nc",6:"'nc",9:"'uncu",10:"'uncu",30:"'uncu",60:"'nc",90:"'nc"};return e.defineLocale("tr",{months:"Ocak_ubat_Mart_Nisan_Mays_Haziran_Temmuz_Austos_Eyll_Ekim_Kasm_Aralk".split("_"),monthsShort:"Oca_ub_Mar_Nis_May_Haz_Tem_Au_Eyl_Eki_Kas_Ara".split("_"),weekdays:"Pazar_Pazartesi_Sal_aramba_Perembe_Cuma_Cumartesi".split("_"),weekdaysShort:"Paz_Pts_Sal_ar_Per_Cum_Cts".split("_"),weekdaysMin:"Pz_Pt_Sa_a_Pe_Cu_Ct".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugn saat] LT",nextDay:"[yarn saat] LT",nextWeek:"[gelecek] dddd [saat] LT",lastDay:"[dn] LT",lastWeek:"[geen] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s nce",s:"birka saniye",ss:"%d saniye",m:"bir dakika",mm:"%d dakika",h:"bir saat",hh:"%d saat",d:"bir gn",dd:"%d gn",M:"bir ay",MM:"%d ay",y:"bir yl",yy:"%d yl"},dayOfMonthOrdinalParse:/\d{1,2}'(inci|nci|nc|nc|uncu|nc)/,ordinal:function(e){if(0===e)return e+"'nc";var i=e%10,r=e%100-i,a=e>=100?100:null;return e+(t[i]||t[r]||t[a])},week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e,t,i,r){var a={s:["viensas secunds","'iensas secunds"],ss:[e+" secunds",e+" secunds"],m:["'n mut","'iens mut"],mm:[e+" muts",e+" muts"],h:["'n ora","'iensa ora"],hh:[e+" oras",e+" oras"],d:["'n ziua","'iensa ziua"],dd:[e+" ziuas",e+" ziuas"],M:["'n mes","'iens mes"],MM:[e+" mesen",e+" mesen"],y:["'n ar","'iens ar"],yy:[e+" ars",e+" ars"]};return r?a[i][0]:t?a[i][0]:a[i][1]}return e.defineLocale("tzl",{months:"Januar_Fevraglh_Mar_Avru_Mai_Gn_Julia_Guscht_Setemvar_Listopts_Noemvar_Zecemvar".split("_"),monthsShort:"Jan_Fev_Mar_Avr_Mai_Gn_Jul_Gus_Set_Lis_Noe_Zec".split("_"),weekdays:"Sladi_Lnei_Maitzi_Mrcuri_Xhadi_Vineri_Sturi".split("_"),weekdaysShort:"Sl_Ln_Mai_Mr_Xh_Vi_St".split("_"),weekdaysMin:"S_L_Ma_M_Xh_Vi_S".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"D. MMMM [dallas] YYYY",LLL:"D. MMMM [dallas] YYYY HH.mm",LLLL:"dddd, [li] D. MMMM [dallas] YYYY HH.mm"},meridiemParse:/d\'o|d\'a/i,isPM:function(e){return"d'o"===e.toLowerCase()},meridiem:function(e,t,i){return e>11?i?"d'o":"D'O":i?"d'a":"D'A"},calendar:{sameDay:"[oxhi  ] LT",nextDay:"[dem   ] LT",nextWeek:"dddd [ ] LT",lastDay:"[ieiri  ] LT",lastWeek:"[sr el] dddd [lasteu  ] LT",sameElse:"L"},relativeTime:{future:"osprei %s",past:"ja%s",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("tzm",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] LT",sameElse:"L"},relativeTime:{future:"   %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d o",M:"o",MM:"%d ",y:"",yy:"%d "},week:{dow:6,doy:12}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("tzm-latn",{months:"innayr_brayr_mars_ibrir_mayyw_ywnyw_ywlywz_wt_wtanbir_ktwbr_nwwanbir_dwjnbir".split("_"),monthsShort:"innayr_brayr_mars_ibrir_mayyw_ywnyw_ywlywz_wt_wtanbir_ktwbr_nwwanbir_dwjnbir".split("_"),weekdays:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),weekdaysShort:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),weekdaysMin:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[asdkh g] LT",nextDay:"[aska g] LT",nextWeek:"dddd [g] LT",lastDay:"[assant g] LT",lastWeek:"dddd [g] LT",sameElse:"L"},relativeTime:{future:"dadkh s yan %s",past:"yan %s",s:"imik",ss:"%d imik",m:"minu",mm:"%d minu",h:"saa",hh:"%d tassain",d:"ass",dd:"%d ossan",M:"ayowr",MM:"%d iyyirn",y:"asgas",yy:"%d isgasn"},week:{dow:6,doy:12}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";function t(e,t){var i=e.split("_");return t%10==1&&t%100!=11?i[0]:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?i[1]:i[2]}function i(e,i,r){var a={ss:i?"__":"__",mm:i?"__":"__",hh:i?"__":"__",dd:"__",MM:"__",yy:"__"};return"m"===r?i?"":"":"h"===r?i?"":"":e+" "+t(a[r],+e)}function r(e,t){var i={nominative:"______".split("_"),accusative:"______".split("_"),genitive:"______".split("_")};return e?i[/(\[[]\]) ?dddd/.test(t)?"accusative":/\[?(?:|)? ?\] ?dddd/.test(t)?"genitive":"nominative"][e.day()]:i.nominative}function a(e){return function(){return e+""+(11===this.hours()?"":"")+"] LT"}}return e.defineLocale("uk",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:r,weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:a("[ "),nextDay:a("[ "),lastDay:a("[ "),nextWeek:a("[] dddd ["),lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return a("[] dddd [").call(this);case 1:case 2:case 4:return a("[] dddd [").call(this)}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",ss:i,m:i,mm:i,h:"",hh:i,d:"",dd:i,M:"",MM:i,y:"",yy:i},meridiemParse:/|||/,isPM:function(e){return/^(|)$/.test(e)},meridiem:function(e,t,i){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(|)/,ordinal:function(e,t){switch(t){case"M":case"d":case"DDD":case"w":case"W":return e+"-";case"D":return e+"-";default:return e}},week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";var t=["","","","","","","","","","","",""],i=["","","","","","",""];return e.defineLocale("ur",{months:t,monthsShort:t,weekdays:i,weekdaysShort:i,weekdaysMin:i,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[  ] LT",lastWeek:"[] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("uz",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"D MMMM YYYY, dddd HH:mm"},calendar:{sameDay:"[ ] LT []",nextDay:"[] LT []",nextWeek:"dddd [ ] LT []",lastDay:"[ ] LT []",lastWeek:"[] dddd [ ] LT []",sameElse:"L"},relativeTime:{future:" %s ",past:"  %s ",s:"",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("uz-latn",{months:"Yanvar_Fevral_Mart_Aprel_May_Iyun_Iyul_Avgust_Sentabr_Oktabr_Noyabr_Dekabr".split("_"),monthsShort:"Yan_Fev_Mar_Apr_May_Iyun_Iyul_Avg_Sen_Okt_Noy_Dek".split("_"),weekdays:"Yakshanba_Dushanba_Seshanba_Chorshanba_Payshanba_Juma_Shanba".split("_"),weekdaysShort:"Yak_Dush_Sesh_Chor_Pay_Jum_Shan".split("_"),weekdaysMin:"Ya_Du_Se_Cho_Pa_Ju_Sha".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"D MMMM YYYY, dddd HH:mm"},calendar:{sameDay:"[Bugun soat] LT [da]",nextDay:"[Ertaga] LT [da]",nextWeek:"dddd [kuni soat] LT [da]",lastDay:"[Kecha soat] LT [da]",lastWeek:"[O'tgan] dddd [kuni soat] LT [da]",sameElse:"L"},relativeTime:{future:"Yaqin %s ichida",past:"Bir necha %s oldin",s:"soniya",ss:"%d soniya",m:"bir daqiqa",mm:"%d daqiqa",h:"bir soat",hh:"%d soat",d:"bir kun",dd:"%d kun",M:"bir oy",MM:"%d oy",y:"bir yil",yy:"%d yil"},week:{dow:1,doy:7}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("vi",{months:"thng 1_thng 2_thng 3_thng 4_thng 5_thng 6_thng 7_thng 8_thng 9_thng 10_thng 11_thng 12".split("_"),monthsShort:"Th01_Th02_Th03_Th04_Th05_Th06_Th07_Th08_Th09_Th10_Th11_Th12".split("_"),monthsParseExact:!0,weekdays:"ch nht_th hai_th ba_th t_th nm_th su_th by".split("_"),weekdaysShort:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysMin:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysParseExact:!0,meridiemParse:/sa|ch/i,isPM:function(e){return/^ch$/i.test(e)},meridiem:function(e,t,i){return e<12?i?"sa":"SA":i?"ch":"CH"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [nm] YYYY",LLL:"D MMMM [nm] YYYY HH:mm",LLLL:"dddd, D MMMM [nm] YYYY HH:mm",l:"DD/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},calendar:{sameDay:"[Hm nay lc] LT",nextDay:"[Ng y mai lc] LT",nextWeek:"dddd [tun ti lc] LT",lastDay:"[Hm qua lc] LT",lastWeek:"dddd [tun ri lc] LT",sameElse:"L"},relativeTime:{future:"%s ti",past:"%s trc",s:"v i giy",ss:"%d giy",m:"mt pht",mm:"%d pht",h:"mt gi",hh:"%d gi",d:"mt ng y",dd:"%d ng y",M:"mt thng",MM:"%d thng",y:"mt nm",yy:"%d nm"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e){return e},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("x-pseudo",{months:"J~~r_F~br~r_~Mrc~h_p~rl_~M_~J~_Jl~_~gst~_Sp~tmb~r_~ctb~r_~vm~br_~Dc~mbr".split("_"),monthsShort:"J~_~Fb_~Mr_~pr_~M_~J_~Jl_~g_~Sp_~ct_~v_~Dc".split("_"),monthsParseExact:!0,weekdays:"S~d~_M~d~_T~sd~_Wd~sd~_T~hrs~d_~Frd~_S~tr~d".split("_"),weekdaysShort:"S~_~M_~T_~Wd_~Th_~Fr_~St".split("_"),weekdaysMin:"S~_M~_T_~W_T~h_Fr~_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[T~d~ t] LT",nextDay:"[T~m~rr~w t] LT",nextWeek:"dddd [t] LT",lastDay:"[~st~rd~ t] LT",lastWeek:"[L~st] dddd [t] LT",sameElse:"L"},relativeTime:{future:"~ %s",past:"%s ~g",s:" ~fw ~sc~ds",ss:"%d s~c~ds",m:" ~m~t",mm:"%d m~~ts",h:"~ h~r",hh:"%d h~rs",d:" ~d",dd:"%d d~s",M:" ~m~th",MM:"%d m~t~hs",y:" ~r",yy:"%d ~rs"},dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("yo",{months:"Sr_Erele_rna_Igbe_Ebibi_Okudu_Agmo_Ogun_Owewe_wara_Belu_p".split("_"),monthsShort:"Sr_Erl_rn_Igb_Ebi_Oku_Ag_Ogu_Owe_wa_Bel_p".split("_"),weekdays:"Aiku_Aje_Isgun_jru_jb_ti_Abamta".split("_"),weekdaysShort:"Aik_Aje_Is_jr_jb_ti_Aba".split("_"),weekdaysMin:"Ai_Aj_Is_r_b_t_Ab".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Oni ni] LT",nextDay:"[la ni] LT",nextWeek:"dddd [s ton'b] [ni] LT",lastDay:"[Ana ni] LT",lastWeek:"dddd [s tol] [ni] LT",sameElse:"L"},relativeTime:{future:"ni %s",past:"%s kja",s:"isju aaya die",ss:"aaya %d",m:"isju kan",mm:"isju %d",h:"wakati kan",hh:"wakati %d",d:"j kan",dd:"j %d",M:"osu kan",MM:"osu %d",y:"dun kan",yy:"dun %d"},dayOfMonthOrdinalParse:/j\s\d{1,2}/,ordinal:"j %d",week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("zh-cn",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMDAhmm",LLLL:"YYYYMDddddAhmm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t||""===t||""===t?e:""===t||""===t?e+12:e>=11?e:e+12},meridiem:function(e,t,i){var r=100*e+t;return r<600?"":r<900?"":r<1130?"":r<1230?"":r<1800?"":""},calendar:{sameDay:"[]LT",nextDay:"[]LT",nextWeek:"[]ddddLT",lastDay:"[]LT",lastWeek:"[]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:" ",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "},week:{dow:1,doy:4}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("zh-hk",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMDdddd HH:mm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t||""===t||""===t?e:""===t?e>=11?e:e+12:""===t||""===t?e+12:void 0},meridiem:function(e,t,i){var r=100*e+t;return r<600?"":r<900?"":r<1130?"":r<1230?"":r<1800?"":""},calendar:{sameDay:"[]LT",nextDay:"[]LT",nextWeek:"[]ddddLT",lastDay:"[]LT",lastWeek:"[]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}})})},function(e,t,i){!function(e,t){t(i(1))}(0,function(e){"use strict";return e.defineLocale("zh-tw",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMDdddd HH:mm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t||""===t||""===t?e:""===t?e>=11?e:e+12:""===t||""===t?e+12:void 0},meridiem:function(e,t,i){var r=100*e+t;return r<600?"":r<900?"":r<1130?"":r<1230?"":r<1800?"":""},calendar:{sameDay:"[]LT",nextDay:"[]LT",nextWeek:"[]ddddLT",lastDay:"[]LT",lastWeek:"[]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}})})},,,function(e,t,i){"use strict";var r=i(0);i.n(r);i.p=window.webpackPublicPath;var a={__webpack_public_path__:window.webpackPublicPath,isFeatureEnabled:function(e){var t=this.features[e];return t&&void 0!==t.enabled?t.enabled:!t||void 0===t.flag||t.flag>0}};Object(r.extend)(a,window.sketchfabRuntime),t.a=a},function(e,t,i){"use strict";e.exports={buildMode:"dist",modelFiletypes:["wrl","obj","ive","3ds","dae","ply","osg2","osgt","osgb","osgx","osgs","gem","geo","mdl","rgb","lws","dxf","tgz","osgterrain","shp","zae","stl","sta","bvh","ac","flt","ogr","osga","md2","x","txp","dw","osgtgz","3dc","asc","lw","lwo","gdal","bsp","osg","iv","blend","blend1","fbx","dat","mc2obj","dwf","vpk","zip","7z","rar","gz","kmz","craft","wrz","mu","q3d","gltf","glb","iges","igs","abc","las"],environmentFiletypes:["hdr","exr"],exportersFiletypes:{ipt:"inventor",qef:"qubicle",spp:"substance",qmo:"qubicle",s3d:"strata",gh:"grasshopper",ztl:"zbrush",fmz:"formz",skp:"sketchup",lws:"lightwave",c4d:"cinema4d",unity:"unity","3dslash":"3dslash",sbs:"substance",mat:"unity",max:"3dsmax",psd:"photoshop",ic3d:"ironcad",craft:"kerbalspaceprogram",lxo:"modo",prefab:"unity",sldprt:"solidworks",ma:"maya",mb:"maya",ghx:"grasshopper",qb:"qubicle",blend:"blender"},textureFileTypes:["jpg","jpeg","png","tga"],avatarFiletypes:["jpg","jpeg","png"],backgroundFiletypes:["jpg","jpeg","png"],matcapFiletypes:["jpg","jpeg","png","tga"],additionalUploadableFileTypes:["mtl","psd","bin"],soundFiletypes:["mp3"],maxBackgroundFilesize:4194304,maxMatcapFilesize:4194304,maxEnvironmentFilesize:52428800,maxAvatarFilesizes:{prem:1048576,biz:1048576,pro:1048576,ent:1048576,free:1048576},maxModelFilesizes:{prem:524288e3,biz:524288e3,pro:209715200,ent:524288e3,free:52428800},maxHotspotsPerModel:{prem:50,biz:75,pro:20,ent:100,free:5},maxSoundFilesize:5242880,maxSoundtracksPerModel:{prem:10,biz:15,pro:5,ent:15,free:1},plansPrivateModelLimit:{prem:200,biz:1e3,pro:20,ent:-1,free:0},textureMaxFileSize:78643200,cameraConstraintsEditing:{prem:1,biz:1,pro:1,ent:1,free:0},analyticsReferrerOverrides:["facebook.com/.*?/?dialog/oauth.*?","facebook.com/login$","facebook.com/l.php$"],oauthRedirectUris:{},usernameMaxLength:30,usernameValidatorRegex:"^[a-zA-Z0-9._-]{2,30}$",usernameValidatorTitle:"Letters, numbers, -, _ and . only",proPlanTypes:["pro","prem","biz","ent"],planLabels:{prem:"premium",biz:"business",pro:"pro",ent:"enterprise",free:"basic"},plansPayment:{prem:{USD:{year:{price:948,paypal_button_id:"DNW9GPYC5CWAL",price_per_month:79},month:{price:99,paypal_button_id:"764SLLAFZFC7E",price_per_month:99}},EUR:{year:{price:948,paypal_button_id:"HSU4K5CKH2SKW",price_per_month:79},month:{price:99,paypal_button_id:"AW87ZEUX64PTC",price_per_month:99}}},pro:{USD:{year:{price:180,paypal_button_id:"VT3YHC7D2E2Z4",price_per_month:15},month:{price:19,paypal_button_id:"TFCBZEWQJ8ZAY",price_per_month:19}},EUR:{year:{price:180,paypal_button_id:"2EG7WKLQBQM4W",price_per_month:15},month:{price:19,paypal_button_id:"KZNESLCYSD7DL",price_per_month:19}}},biz:{USD:{year:{price:4788,paypal_button_id:"CUCPJLLNW662W",price_per_month:399},month:{price:499,paypal_button_id:"SCCBG7F2PH98A",price_per_month:499}},EUR:{year:{price:4788,paypal_button_id:"UL9DR8UMCBEDW",price_per_month:399},month:{price:499,paypal_button_id:"4GGXEVQJLYFCG",price_per_month:499}}}},deflatableModelFiletypes:["stl","ply","obj","dae"],minDeflatableFilesize:524288,maxLevenshteinDistance:2,prodHookDomainsBlacklist:["sketchfab.com"],inspectorBlacklist:["3docean.net","3dsquirrel.co.uk","3dexport.com","blendermarket.com","cgtrader.com","creativemarket.com","crytek.com","cubebrush.co","daz3d.com","evermotion.orggumroad.com","pond5.com","renderosity.com","stock.adobe.com","turbosquid.com","unrealengine.com","unity3d.com"],maxExtraArchiveSize:524288e3,apiPageSize:24,internalDomains:[{domain:"2mdn.net",allowSubdomains:!0},{domain:"3dtotal.com",allowSubdomains:!0},{domain:"80.lv",allowSubdomains:!0},{domain:"artstation.com",allowSubdomains:!0},{domain:"blendernation.com",allowSubdomains:!0},{domain:"cgsociety.org",allowSubdomains:!0},{domain:"fatvoxel.com",allowSubdomains:!0},{domain:"guidigo.com",allowSubdomains:!0},{domain:"moddb.com",allowSubdomains:!0},{domain:"nearpod.com",allowSubdomains:!0},{domain:"serving-sys.com",allowSubdomains:!0},{domain:"sketchfab.com",allowSubdomains:!0},{domain:"skfb-local.com",allowSubdomains:!0},{domain:"syncsketch.com",allowSubdomains:!0},{domain:"therookies.co",allowSubdomains:!0},{domain:"yeggi.com",allowSubdomains:!0},{domain:"yobi3d.com",allowSubdomains:!0}],hosts:{faq:"https://help.sketchfab.com/hc/en-us"},optionsVersion:7,channelNames:{Matcap:["matcap"],Displacement:["displacement"],Opacity:["transparency","transparent","opacity","mask","alpha"],SubsurfaceScattering:["scattering","subsurface"],SubsurfaceTranslucency:["translucency","thickness"],DiffuseColor:["diffuse","albedo","basecolor"],DiffusePBR:["diffuse","albedo","basecolor"],AlbedoPBR:["diffuse","albedo","basecolor"],SpecularColor:["specular","spec","s"],DiffuseIntensity:["ambient occlusion","ao","occlusion","lightmap","diffuseintensity"],SpecularPBR:["specular","spec","s"],MetalnessPBR:["metalness","metallic","metal","m"],GlossinessPBR:["glossiness","glossness","gloss","g","glossy"],RoughnessPBR:["roughness","rough","r"],NormalMap:["normal","nrm","normalmap"],BumpMap:["bump","bumpmap","heightmap"],AOPBR:["ambient occlusion","ao","occlusion","lightmap","diffuseintensity"],EmitColor:["emission","emit","emissive"],CavityPBR:["cavity"],SpecularHardness:["glossiness","glossness","gloss","g","glossy"],SpecularF0:["specularf0","f0"],Inspector:[]},shortcuts:{viewerRendering:{name:"Rendering",shortcuts:[{id:"defaultRenderingMode",name:"Lit: ",description:"Shows default rendering mode",keyCombinations:["1"]},{id:"shadelessRenderingMode",name:"Shadeless: ",description:"Shows shadeless rendering mode",keyCombinations:"2"},{id:"matcapRenderingMode",name:"MatCap: ",description:"Shows matcap rendering mode",keyCombinations:"3"},{id:"toggleWireframe",name:"Wireframe: ",description:"Toggles wireframe visibility",keyCombinations:"5"},{id:"inspector",name:"Inspector: ",keyCombinations:["i"]}]},animationControl:{name:"Animations",shortcuts:[{id:"prevFrame",name:"Previous frame: ",keyCombinations:["b","ctrl+b","shift+b"]},{id:"nextFrame",name:"Next frame: ",keyCombinations:["n","ctrl+n","shift+n"]},{id:"toggleTextEdition",name:"Go to time/frame : ",keyCombinations:["enter"]}]},annotationControl:{name:"Annotations",shortcuts:[{id:"prevAnnotation",name:"Previous: ",keyCombinations:["j","pageup"]},{id:"nextAnnotation",name:"Next: ",keyCombinations:["k","pagedown"]}]},inspectorControl:{name:"Inspector",shortcuts:[{id:"render",name:"Render: ",keyCombinations:["1"]},{id:"materials",name:"Materials: ",keyCombinations:["2"]},{id:"geometry",name:"Geometry: ",keyCombinations:["3"]},{id:"uv",name:"UV: ",keyCombinations:["4"]}]},sound:{name:"Sound",shortcuts:[{id:"mute",name:"Mute: ",keyCombinations:["m"]}]}},vr:{launcherUid:"c0022acc4f3242e2bcae8043e08df8cc"},defaultMatcapUid:"35c4d334eded44d8a657f390954a32dd",facebookApiVersion:"v2.10",modelMinPrice:399,reviewsUsageOptions:[{value:"game",title:"Game development"},{value:"rtr",title:"Real-Time Rendering"},{value:"vfx",title:"Rendering & Visual FX"},{value:"anim",title:"Animation/Motion Design"},{value:"vr",title:"VR"},{value:"print",title:"3D Printing, Maker Projects & DIY"},{value:"archi",title:"Architecture / Interior Design"},{value:"edu",title:"Education"},{value:"ar",title:"AR"},{value:"art",title:"Art"},{value:"other",title:"Other"}],storeCartMaxSize:50}},,,,,,,,,,,,,function(e,t,i){"use strict";var r=(i(21),function(){this._gl=void 0,this._onLostContextCallback=void 0});r.prototype={setGraphicContext:function(e){this._gl=e,r.addObject(this._gl,this)},getGraphicContext:function(){return this._gl},setLostContextCallback:function(e){this._onLostContextCallback=e},onLostContext:function(){this.invalidate&&"function"==typeof this.invalidate&&this.invalidate(),this._onLostContextCallback&&this._onLostContextCallback()}},r._sResourcesArrayCache=new window.Map,r.addObject=function(e,t){r._sResourcesArrayCache.has(e)||r._sResourcesArrayCache.set(e,[]);var i=r._sResourcesArrayCache.get(e);-1===i.indexOf(t)&&i.push(t)},r.removeObject=function(e,t){if(r._sResourcesArrayCache.has(e)){var i=r._sResourcesArrayCache.get(e),a=i.indexOf(t);-1!==a&&i.splice(a,1)}},r.onLostContext=function(e){if(r._sResourcesArrayCache.has(e))for(var t=r._sResourcesArrayCache.get(e),i=0,a=t.length;i<a;i++)t[i].onLostContext()},t.a=r},function(e,t,i){"use strict";var r=i(9),a=i(674),n=i(21),o=i(10),s=i(121),u=i(182),l=i(783),c=i(58),h=i(215),d=function(){s.a.call(this),this._shape=null,this._targets=[],this._stateSetAnimation=new u.a,this._targetWeights=new Float32Array(d.MAX_MORPH_GPU),this._morphAttribute=void 0,this._morphTargetNames=void 0,this._maxMorphGPU=d.MAX_MORPH_GPU,this._isInitialized=!1};d.EFFECTIVE_EPS=.05,d.MAX_MORPH_GPU=4,r.a.createPrototypeNode(d,r.a.objectInherit(s.a.prototype,{init:function(){return this._morphAttribute?(this._isInitialized=!0,!1):(this._morphAttribute=new l.a(Math.min(this._maxMorphGPU,this.getMorphTargets().length)),this.getStateSetAnimation().setAttributeAndModes(this._morphAttribute,c.a.ON),this._morphAttribute.setTargetWeights(this.getTargetsWeight()),this._targets[0]?(this._morphTargetNames=window.Object.keys(this._targets[0].getVertexAttributeList()),this._morphAttribute.copyTargetNames(this._morphTargetNames)):(this._morphTargetNames=[],n.a.error("No Targets in the MorphGeometry !")),this._isInitialized=!0,!0)},getMaximumPossibleMorphGPU:function(){return this._maxMorphGPU},setMaximumPossibleMorphGPU:function(e){this._maxMorphGPU=e,this._isInitialized=!1,this._morphAttribute&&this._morphAttribute.setNumTargets(e)},getMorphTargetNames:function(){return this._morphTargetNames},getStateSetAnimation:function(){return this._stateSetAnimation},getMorphTargets:function(){return this._targets},isInitialized:function(){return this._isInitialized},getTargetsWeight:function(){return this._targetWeights},computeBoundingBox:function(){var e=new h.a;return function(t){s.a.prototype.computeBoundingBox.call(this,t);for(var i=0,r=this._targets.length;i<r;i++)t.expandByBoundingBox(this._targets[i].computeBoundingBox(e));return t}}(),mergeChildrenVertexAttributeList:function(){for(var e=0,t=this._targets.length;e<t;e++){var i=this._targets[e],r=i.getVertexAttributeList();for(var n in r){var o=r[n];o&&!o.getBufferArray&&(r[n]=new a.a(o))}s.a.appendVertexAttributeToList(i.getVertexAttributeList(),this.getVertexAttributeList(),e)}},_computeEffectiveSumWeights:function(){for(var e=0,t=this._targetWeights,i=0,r=t.length;i<r;++i){var a=t[i];Math.abs(a)<=d.EFFECTIVE_EPS||(e+=a)}return Math.abs(e)>1e-5?e:e<0?-1e-5:1e-5},computeTransformedVertex:function(e,t){t=t||o.f.create();var i=3*e,r=this._targetWeights,a=this.getVertexAttributeList(),n=a.Vertex.getElements(),s=1-this._computeEffectiveSumWeights();t[0]=s*n[i],t[1]=s*n[i+1],t[2]=s*n[i+2];for(var u=0,l=r.length;u<l;++u){var c=r[u];if(!(Math.abs(c)<=d.EFFECTIVE_EPS)){var h=a["Vertex_"+u].getElements();t[0]+=c*h[i],t[1]+=c*h[i+1],t[2]+=c*h[i+2]}}return t},computeTransformedVertices:function(){for(var e=this._targetWeights,t=this.getVertexAttributeList(),i=t.Vertex.getElements(),r=i.length,a=this._morphedVerts=this._morphedVerts||new Float32Array(r),n=1-this._computeEffectiveSumWeights(),o=0;o<r;++o)a[o]=n*i[o];for(var s=0,u=e.length;s<u;++s){var l=e[s];if(!(Math.abs(l)<=d.EFFECTIVE_EPS))for(var c=t["Vertex_"+s].getElements(),h=0;h<r;++h)a[h]+=l*c[h]}return a}}),"osgAnimation","MorphGeometry"),t.a=d},function(e,t,i){"use strict";var r=i(10),a=i(128),n=i(121),o=i(99),s=i(185),u=i(183),l=i(186),c=i(217),h=i(9),d=function(e,t,i,r,s,l){var c,d,p,f=void 0!==e?e:0,m=void 0!==t?t:0,g=void 0!==i?i:0,_=void 0!==r?r:1,v=void 0!==s?s:1,b=void 0!==l?l:1,y=new n.a;c=_/2,d=v/2,p=b/2;var x=new h.a.Float32Array(72),S=new h.a.Float32Array(48),M=new h.a.Float32Array(72);x[0]=f-c,x[1]=m-d,x[2]=g+p,M[0]=0,M[1]=-1,M[2]=0,S[0]=0,S[1]=1,x[3]=f-c,x[4]=m-d,x[5]=g-p,M[3]=0,M[4]=-1,M[5]=0,S[2]=0,S[3]=0,x[6]=f+c,x[7]=m-d,x[8]=g-p,M[6]=0,M[7]=-1,M[8]=0,S[4]=1,S[5]=0,x[9]=f+c,x[10]=m-d,x[11]=g+p,M[9]=0,M[10]=-1,M[11]=0,S[6]=1,S[7]=1,x[12]=f+c,x[13]=m+d,x[14]=g+p,M[12]=0,M[13]=1,M[14]=0,S[8]=0,S[9]=1,x[15]=f+c,x[16]=m+d,x[17]=g-p,M[15]=0,M[16]=1,M[17]=0,S[10]=0,S[11]=0,x[18]=f-c,x[19]=m+d,x[20]=g-p,M[18]=0,M[19]=1,M[20]=0,S[12]=1,S[13]=0,x[21]=f-c,x[22]=m+d,x[23]=g+p,M[21]=0,M[22]=1,M[23]=0,S[14]=1,S[15]=1,x[24]=f+c,x[25]=m-d,x[26]=g+p,M[24]=1,M[25]=0,M[26]=0,S[16]=0,S[17]=1,x[27]=f+c,x[28]=m-d,x[29]=g-p,M[27]=1,M[28]=0,M[29]=0,S[18]=0,S[19]=0,x[30]=f+c,x[31]=m+d,x[32]=g-p,M[30]=1,M[31]=0,M[32]=0,S[20]=1,S[21]=0,x[33]=f+c,x[34]=m+d,x[35]=g+p,M[33]=1,M[34]=0,M[35]=0,S[22]=1,S[23]=1,x[36]=f-c,x[37]=m+d,x[38]=g+p,M[36]=-1,M[37]=0,M[38]=0,S[24]=0,S[25]=1,x[39]=f-c,x[40]=m+d,x[41]=g-p,M[39]=-1,M[40]=0,M[41]=0,S[26]=0,S[27]=0,x[42]=f-c,x[43]=m-d,x[44]=g-p,M[42]=-1,M[43]=0,M[44]=0,S[28]=1,S[29]=0,x[45]=f-c,x[46]=m-d,x[47]=g+p,M[45]=-1,M[46]=0,M[47]=0,S[30]=1,S[31]=1,x[48]=f-c,x[49]=m+d,x[50]=g+p,M[48]=0,M[49]=0,M[50]=1,S[32]=0,S[33]=1,x[51]=f-c,x[52]=m-d,x[53]=g+p,M[51]=0,M[52]=0,M[53]=1,S[34]=0,S[35]=0,x[54]=f+c,x[55]=m-d,x[56]=g+p,M[54]=0,M[55]=0,M[56]=1,S[36]=1,S[37]=0,x[57]=f+c,x[58]=m+d,x[59]=g+p,M[57]=0,M[58]=0,M[59]=1,S[38]=1,S[39]=1,x[60]=f+c,x[61]=m+d,x[62]=g-p,M[60]=0,M[61]=0,M[62]=-1,S[40]=0,S[41]=1,x[63]=f+c,x[64]=m-d,x[65]=g-p,M[63]=0,M[64]=0,M[65]=-1,S[42]=0,S[43]=0,x[66]=f-c,x[67]=m-d,x[68]=g-p,M[66]=0,M[67]=0,M[68]=-1,S[44]=1,S[45]=0,x[69]=f-c,x[70]=m+d,x[71]=g-p,M[69]=0,M[70]=0,M[71]=-1,S[46]=1,S[47]=1;var w=new h.a.Uint16Array(36);w[0]=0,w[1]=1,w[2]=2,w[3]=0,w[4]=2,w[5]=3,w[6]=4,w[7]=5,w[8]=6,w[9]=4,w[10]=6,w[11]=7,w[12]=8,w[13]=9,w[14]=10,w[15]=8,w[16]=10,w[17]=11,w[18]=12,w[19]=13,w[20]=14,w[21]=12,w[22]=14,w[23]=15,w[24]=16,w[25]=17,w[26]=18,w[27]=16,w[28]=18,w[29]=19,w[30]=20,w[31]=21,w[32]=22,w[33]=20,w[34]=22,w[35]=23,y.getAttributes().Vertex=new a.a(a.a.ARRAY_BUFFER,x,3),y.getAttributes().Normal=new a.a(a.a.ARRAY_BUFFER,M,3),y.getAttributes().TexCoord0=new a.a(a.a.ARRAY_BUFFER,S,2);var T=new u.a(o.a.TRIANGLES,new a.a(a.a.ELEMENT_ARRAY_BUFFER,w,1));return y.getPrimitives().push(T),y},p=function(){var e=new n.a,t=new h.a.Float32Array([4,-1,-1,4,-1,-1]),i=new a.a(a.a.ARRAY_BUFFER,t,2);e.getAttributes().Vertex=i,e.getAttributes().TexCoord0=i;var r=new s.a(o.a.TRIANGLES,0,3);return e.getPrimitives().push(r),function(){return e}}(),f=function(e,t,i,s,l,c,d,p,f,m,g,_,v){void 0===_&&void 0===v&&(_=m,v=g,m=0,g=0);var b=new n.a,y=new h.a.Float32Array(12);y[0]=e+d,y[1]=t+p,y[2]=i+f,y[3]=e,y[4]=t,y[5]=i,y[6]=e+s,y[7]=t+l,y[8]=i+c,y[9]=e+s+d,y[10]=t+l+p,y[11]=i+c+f,void 0===_&&(_=1),void 0===v&&(v=1);var x=new h.a.Float32Array(8);x[0]=m,x[1]=v,x[2]=m,x[3]=g,x[4]=_,x[5]=g,x[6]=_,x[7]=v;var S=r.f.fromValues(s,l,c);r.f.cross(S,S,r.f.fromValues(d,p,f)),r.f.normalize(S,S);var M=new h.a.Float32Array(12);M[0]=S[0],M[1]=S[1],M[2]=S[2],M[3]=S[0],M[4]=S[1],M[5]=S[2],M[6]=S[0],M[7]=S[1],M[8]=S[2],M[9]=S[0],M[10]=S[1],M[11]=S[2];var w=new h.a.Uint16Array(6);w[0]=0,w[1]=1,w[2]=2,w[3]=0,w[4]=2,w[5]=3,b.getAttributes().Vertex=new a.a(a.a.ARRAY_BUFFER,y,3),b.getAttributes().Normal=new a.a(a.a.ARRAY_BUFFER,M,3),b.getAttributes().TexCoord0=new a.a(a.a.ARRAY_BUFFER,x,2);var T=new u.a(o.a.TRIANGLES,new a.a(a.a.ELEMENT_ARRAY_BUFFER,w,1));return b.getPrimitives().push(T),b},m=function(e){void 0===e&&(e=1),void 0===m.getShader&&(m.getShader=function(){if(void 0===m.getShader.program){var e=["#ifdef GL_ES","precision highp float;","#endif","attribute vec3 Vertex;","attribute vec4 Color;","uniform mat4 uModelViewMatrix;","uniform mat4 uProjectionMatrix;","","varying vec4 vColor;","","void main(void) {","  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex, 1.0));","  vColor = Color;","}"].join("\n"),t=["#ifdef GL_ES","precision highp float;","#endif","varying vec4 vColor;","void main(void) {","gl_FragColor = vColor;","}"].join("\n"),i=new l.a(new c.a("VERTEX_SHADER",e),new c.a("FRAGMENT_SHADER",t));m.getShader.program=i}return m.getShader.program});var t=new n.a,i=new h.a.Float32Array(18);i[3]=e,i[10]=e,i[17]=e;var r=new h.a.Float32Array(24);r[0]=r[3]=1,r[4]=r[7]=1,r[9]=r[11]=1,r[13]=r[15]=1,r[18]=r[19]=1,r[22]=r[23]=1,t.getAttributes().Vertex=new a.a(a.a.ARRAY_BUFFER,i,3),t.getAttributes().Color=new a.a(a.a.ARRAY_BUFFER,r,4);var u=new s.a(o.a.LINES,0,6);return t.getPrimitives().push(u),t.getOrCreateStateSet().setAttributeAndModes(m.getShader()),t},g=function(e,t,i,l,c,d,p){e=e||1,l=void 0!==l?l:0,c=void 0!==c?c:2*Math.PI,d=void 0!==d?d:0,p=void 0!==p?p:Math.PI;for(var f=Math.max(3,Math.floor(t)||8),m=Math.max(2,Math.floor(i)||6),g=f*m/3>=65536,_=g?f*m*6:f*m*4,v=new h.a.Float32Array(3*_),b=new h.a.Float32Array(3*_),y=new h.a.Float32Array(2*_),x=g?void 0:new h.a.Uint16Array(f*m*6),S=0,M=0,w=new h.a.Float32Array(3),T=new h.a.Float32Array(3),C=new h.a.Float32Array(3),E=new h.a.Float32Array(3),L=new h.a.Float32Array(3),P=new h.a.Float32Array(3),A=new h.a.Float32Array(3),D=new h.a.Float32Array(3),O=new h.a.Float32Array(2),k=new h.a.Float32Array(2),R=new h.a.Float32Array(2),I=new h.a.Float32Array(2),F=function(t,i,a,n,o){a[0]=-e*Math.cos(l+t*c)*Math.sin(d+i*p),a[1]=e*Math.cos(d+i*p),a[2]=e*Math.sin(l+t*c)*Math.sin(d+i*p),r.f.normalize(n,a),o[0]=t,o[1]=1-i},N=0;N<m;N++)for(var V=0;V<f;V++){F((V+1)/f,N/m,w,L,O),F(V/f,N/m,T,P,k),F(V/f,(N+1)/m,C,A,R),F((V+1)/f,(N+1)/m,E,D,I);var B=3*S;v[B]=w[0],v[B+1]=w[1],v[B+2]=w[2],v[B+3]=T[0],v[B+4]=T[1],v[B+5]=T[2],v[B+6]=C[0],v[B+7]=C[1],v[B+8]=C[2],b[B]=L[0],b[B+1]=L[1],b[B+2]=L[2],b[B+3]=P[0],b[B+4]=P[1],b[B+5]=P[2],b[B+6]=A[0],b[B+7]=A[1],b[B+8]=A[2];var U=2*S;if(y[U]=O[0],y[U+1]=O[1],y[U+2]=k[0],y[U+3]=k[1],y[U+4]=R[0],y[U+5]=R[1],S+=3,g)B=3*S,v[B]=w[0],v[B+1]=w[1],v[B+2]=w[2],v[B+3]=C[0],v[B+4]=C[1],v[B+5]=C[2],v[B+6]=E[0],v[B+7]=E[1],v[B+8]=E[2],b[B]=L[0],b[B+1]=L[1],b[B+2]=L[2],b[B+3]=A[0],b[B+4]=A[1],b[B+5]=A[2],b[B+6]=D[0],b[B+7]=D[1],b[B+8]=D[2],U=2*S,y[U]=O[0],y[U+1]=O[1],y[U+2]=R[0],y[U+3]=R[1],y[U+4]=I[0],y[U+5]=I[1],S+=3;else{B=3*S,v[B]=E[0],v[B+1]=E[1],v[B+2]=E[2],b[B]=D[0],b[B+1]=D[1],b[B+2]=D[2],U=2*S,y[U]=I[0],y[U+1]=I[1];var j=3*M,G=S-3;x[j]=G,x[j+1]=G+1,x[j+2]=G+2,x[j+3]=G,x[j+4]=G+2,x[j+5]=G+3,M+=2,S+=1}}var Y=new n.a;return Y.getAttributes().Vertex=new a.a("ARRAY_BUFFER",v,3),Y.getAttributes().Normal=new a.a("ARRAY_BUFFER",b,3),Y.getAttributes().TexCoord0=new a.a("ARRAY_BUFFER",y,2),g?Y.getPrimitives().push(new s.a(o.a.TRIANGLES,0,v.length/3)):Y.getPrimitives().push(new u.a(o.a.TRIANGLES,new a.a("ELEMENT_ARRAY_BUFFER",x,1))),Y},_=function(e,t,i,r,u,l,c,h,d,p,f){e=void 0!==e?e:-.5,t=void 0!==t?t:-.5,i=void 0!==i?i:0,r=void 0!==r?r:1,u=void 0!==u?u:0,l=void 0!==l?l:0,c=void 0!==c?c:0,h=void 0!==h?h:1,d=void 0!==d?d:0,p=void 0!==p?p:5,f=void 0!==f?f:p,p+=2,f+=2;var m=new n.a,g=new Float32Array(2*(p+f)*3),_=0,v=0,b=r/(p-1),y=u/(p-1),x=l/(p-1),S=e+r+c,M=t+u+h,w=i+l+d;for(_=0;_<p;++_)v=6*_,g[v]=e+b*_,g[v+1]=t+y*_,g[v+2]=i+x*_,g[v+3]=S-b*(p-_-1),g[v+4]=M-y*(p-_-1),g[v+5]=w-x*(p-_-1);for(b=c/(f-1),y=h/(f-1),x=d/(f-1),_=0;_<f;++_)v=6*(p+_),g[v]=e+b*_,g[v+1]=t+y*_,g[v+2]=i+x*_,g[v+3]=S-b*(f-_-1),g[v+4]=M-y*(f-_-1),g[v+5]=w-x*(f-_-1);m.getAttributes().Vertex=new a.a(a.a.ARRAY_BUFFER,g,3);var T=new s.a(o.a.LINES,0,2*(p+f));return m.getPrimitives().push(T),m},v=function(e){var t=new n.a,i=new Float32Array([-.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5]);t.getAttributes().Vertex=new a.a(a.a.ARRAY_BUFFER,i,3),e||(e=[1,0,0,1]);for(var r=new h.a.Float32Array(32),s=0;s<8;s++)for(var l=0;l<4;l++)r[3*s+l]=e[l];t.getAttributes().Color=new a.a(a.a.ARRAY_BUFFER,r,4);var c=new h.a.Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);return t.getPrimitives().push(new u.a(o.a.LINES,new a.a("ELEMENT_ARRAY_BUFFER",c,1))),t};t.a={createTexturedBoxGeometry:d,createTexturedQuadGeometry:f,createTexturedSphereGeometry:g,createTexturedFullScreenFakeQuadGeometry:p,createAxisGeometry:m,createTexturedSphere:g,createGridGeometry:_,createBoundingBoxGeometry:v}},function(e,t,i){"use strict";var r=i(10),a=i(795),n={};n.InvalidTargetID=-1;var o=function(e,t,i){return{type:e,id:n.InvalidTargetID,channels:[],value:t,defaultValue:i}},s=function(e){return o(a.a.Quat,r.d.copy(r.d.create(),e),r.d.copy(r.d.create(),e))},u=function(e){return o(a.a.Matrix,r.c.copy(r.c.create(),e),r.c.copy(r.c.create(),e))},l=function(e){return o(a.a.Vec3,r.f.copy(r.f.create(),e),r.f.copy(r.f.create(),e))},c=function(e){return o(a.a.Float,e,e)};n.createQuatTarget=s,n.createVec3Target=l,n.createFloatTarget=c,n.createMatrixTarget=u,t.a=n},function(e,t,i){"use strict";var r=i(5),a=i(17),n=i(762),o=i(763),s=i(854),u=i(700),l=i(144),c=r.a.osg,h=function(e,t,i){c.NodeVisitor.call(this,c.NodeVisitor.TRAVERSE_ALL_CHILDREN),this._lights=[],this._materials=[],this._materialManager=e,this._stateSetsProcessed={},this._authoringTool=t,this._source=i,this._style="",this._hasMetal=void 0,this._globalEnforceRoughness=void 0,this._dictionary=a.a.channelNames,this._dictionaryKeys=Object.keys(a.a.channelNames),this._sortedImages=void 0,this._textureFactor1=!1,this._textureUnit0=!1};c.createPrototypeObject(h,c.objectInherit(c.NodeVisitor.prototype,{getStyle:function(){return this._style},hasMetallicWorkflow:function(){return this._hasMetal},getLights:function(){return this._lights},getMaterials:function(){return this._materials},copyDiffuse:function(e){var t=e.getChannels().DiffuseColor,i=e.getChannels().AlbedoPBR,r=e.getChannels().DiffusePBR,a=t.getColor(),n=t.getFactor(),o=t.getTextureModel();a&&(i.setColor(a),r.setColor(a)),i.setFactor(n),r.setFactor(n),o&&(i.setTextureModel(o),r.setTextureModel(o))},matchNameAgainstDict:function(e,t,i){for(var r=Object(o.a)(e),a=0;a<t.length;a++){var s=t[a],u=Object(n.a)(r,s);if(u<i&&u<s.length)return!0}return!1},channelTextureExtract:function(e,t){var i=e.getChannels()[t];if(i){var r=i.getTextureModel();if(r)return r.getImageModel().get("name")}},channelTextureMatch:function(e,t,i,r){var a=this.channelTextureExtract(e,t);return a&&this.matchNameAgainstDict(a,i,r)},hasTextureChannel:function(e,t){return void 0!==this.channelTextureExtract(e,t)},channelTextureCopy:function(e,t,i){var r,a=e.getChannels();if(this.channelTextureExtract(e,t))for(var n=i.length;n--;)r=a[i[n]],r.setTextureModel(a[t].getTextureModel().clone())},checkPBRSlot:function(e){if(e)for(var t=0;t<this._dictionaryKeys.length;t++){var i=this._dictionaryKeys[t],r=this._dictionary[i];if(this.matchNameAgainstDict(e,r,a.a.maxLevenshteinDistance))return i}},assignPBRTextureFromFilenames:function(e,t){for(var i=0,r=e.length;i<r;++i){var a=e[i],n=a.getName(),o=this.checkPBRSlot(n);if(!o&&a.getImage()&&(n=a.getImage().getURL(),o=this.checkPBRSlot(n)),o){var s=t.getChannels(),u=s[o];u.getTextureModel()||u.setupTextureModel(this.createTextureOptionsFromTextureOSG(a))}}},checkChannelsAndSetWorkFlowRoughGloss:function(e){if(e){var t=e.getChannels(),i=this.hasTextureChannel(e,"GlossinessPBR"),r=this.hasTextureChannel(e,"SpecularPBR"),a=this.hasTextureChannel(e,"RoughnessPBR");this.hasTextureChannel(e,"BumpMap")&&t.BumpMap.setFactor(10),this.hasTextureChannel(e,"MetalnessPBR")&&(this._hasMetal=!0),r&&void 0===this._hasMetal&&(this._hasMetal=!1);var n=a||this._globalEnforceRoughness;n||(n=!i&&void 0===this._globalEnforceRoughness),e.setWorkFlowRoughGloss(n,!1)}},matchFullNameAgainstDict:function(e,t){for(var i=0;i<t.length;++i)if(!(t[i].length<4)&&-1!==e.indexOf(t[i]))return!0;return!1},setChannelsFromImagesNames:function(e,t,i,r){for(var n=a.a.maxLevenshteinDistance,o=0,u=t.length;o<u;o++)for(var l=t[o],c=this._dictionary[l],h=0,d=i.length;h<d;h++){var p=i[h].get("name"),f=r?this.matchFullNameAgainstDict(p,c):this.matchNameAgainstDict(p,c,n);if(f){var m=e.getChannels()[l];m.setTextureModel(new s.a({image:i[h]})),m.setFactor(1),e.setChannelEnable(m.get("name"),!0)}}},setGlossinessPBRFromSpecularGlossiness:function(e,t,i){var r=.2126*t[0]+.7152*t[1]+.0722*t[2],a=Math.pow(1e4*i,.25)/100*r;e.setChannelFactor("GlossinessPBR",a),e.setChannelEnable("GlossinessPBR",!0),this._globalEnforceRoughness=!1},getPBRChannels:function(e){var t=[],i=e.getChannels();for(var r in i)-1!==r.indexOf("PBR")&&t.push(r);return t},channelMatchAndCopy:function(e,t,i){var r=this._dictionary[i];if(this.channelTextureMatch(e,t,r,2))return this.channelTextureCopy(e,t,[i])},checkForPBRTextureFromChannelsAndFilenames:function(e){if(e){for(var t=this.getPBRChannels(e),i=t.length;i--;)if(void 0!==this.channelTextureExtract(e,t[i]))return;this.channelTextureCopy(e,"DiffuseColor",["AlbedoPBR","DiffusePBR"]),this.channelTextureCopy(e,"DiffuseIntensity",["AOPBR"]),this.channelMatchAndCopy(e,"SpecularColor","MetalnessPBR")||this.channelMatchAndCopy(e,"SpecularHardness","MetalnessPBR")||this.channelMatchAndCopy(e,"SpecularColor","SpecularPBR")||this.channelMatchAndCopy(e,"SpecularHardness","SpecularPBR"),this.channelMatchAndCopy(e,"SpecularColor","RoughnessPBR")||this.channelMatchAndCopy(e,"SpecularHardness","RoughnessPBR")||this.channelMatchAndCopy(e,"SpecularColor","GlossinessPBR")||this.channelMatchAndCopy(e,"SpecularHardness","GlossinessPBR")}},getOrCreateSortedImagesList:function(){return void 0===this._sortedImages&&(this._sortedImages=this._materialManager.getImageCollection().clone(),this._sortedImages.comparator=function(e,t){return(e.get("version")||0)-(t.get("version")||0)},this._sortedImages.sort()),this._sortedImages},checkForPBRTextureFromMaterialAndFilenames:function(e,t){if(e&&0!==this._materialManager.getImageCollection().length){var i=[],r=this,a=e.getChannels();for(var n in a)r.channelTextureExtract(e,n)||i.push(n);for(var o=[],s=this.getOrCreateSortedImagesList(),u=e.get("name").toLowerCase(),l=0;l<s.length;l++){var c=s.models[l].get("name");(t||-1!==c.toLowerCase().indexOf(u))&&o.push(s.models[l])}this.setChannelsFromImagesNames(e,i,o,t)}},hasMaterialAttributes:function(e){return e.getAttribute("Material")},hasTextureAttributes:function(e){for(var t=0,i=e.getNumTextureAttributeLists();t<i;t++)if(e.getTextureAttribute(t,"Texture"))return!0;return!1},processDefaultMaterial:function(e,t){t.removeAttribute("Material");for(var i=0,r=t.getNumTextureAttributeLists();i<r;i++)t.removeTextureAttribute(i,"Texture")},getReferencedTextures:function(e){for(var t=[],i=0;i<e.getNumTextureAttributeLists();i++){var r=e.getTextureAttribute(i,"Texture");r&&("PackedMaterialTexture"===r.className()&&(r=r.getTexture()),t[i]=r)}return t},createMaterial:function(e,t){var i=this._materialManager.createMaterial(e,t);return this._materials.push(i),i},createTextureOptionsFromTextureOSG:function(e){var t=u.a.getOptions(e),i=e.getImage(),r=i.getURL(),a=this._materialManager.getImageCollection(),n=a.getImageFromURL(r);return n?(t.image=n,t):void c.error("Cannot find image in collection : "+r)},mapTexturesOnMaterial:function(e,t){for(var i=["EmitColor","DiffuseColor","SpecularColor"],r=this.getReferencedTextures(e),a=e.getNumTextureAttributeLists(),n=0,o=a;n<o;n++)if(e.getTextureAttribute(n,"Texture")){var u=1===a?"DiffuseColor":i[n];if(u&&r[n]){var l=new s.a(this.createTextureOptionsFromTextureOSG(r[n]));this.setMaterialChannelTexture(e,t,n,u,l)}}},applyExistingMaterial:function(e,t){if(e){var i=this._materialManager.getMaterialByStateSet(e);if(!i)return void(this._stateSetsProcessed[e.getInstanceID()]=!0);var r=i.get("stateSet")||e,a=r.getInstanceID();if(!0===this._stateSetsProcessed[a])return i;this._stateSetsProcessed[a]=!0;var n=e.getAttributeMap().Material,o=this._materialManager.getUniqueMaterialName(n,e,t);return i.set("name",o),i.setStateSet(e),this._materials.push(i),i}},processLightSource:function(){},pushLight:function(e){var t=this.nodePath[this.nodePath.length-1];t instanceof c.LightSource&&(t.setNodeMask(0),t.setLight(e)),e._worldMatrix=c.computeLocalToWorld(this.nodePath),this._lights.push(e)},processNode:function(e){var t=e.getStateSet();if(t){var i=this.applyExistingMaterial(t,e);if(i)return void e.setStateSet(i.get("stateSet"));var r=t.getUserData();if(this.hasMaterialAttributes(t)||this.hasTextureAttributes(t))if(r){var a=l.a.convertUserDataToObject(r);this.processMaterial(e,t,a)}else this.processDefaultMaterial(e,t);i=this._materialManager.getMaterialByStateSet(t),this.checkForPBRTextureFromChannelsAndFilenames(i),this.checkForPBRTextureFromMaterialAndFilenames(i),this.checkChannelsAndSetWorkFlowRoughGloss(i)}},apply:function(e){e.typeID===c.LightSource.typeID&&this.processLightSource(e),this.processNode(e),this.traverse(e)},handleSingleMaterialMapping:function(){if(1===this.getMaterials().length){var e=this.getMaterials()[0];this.checkForPBRTextureFromMaterialAndFilenames(e,!0),this.checkChannelsAndSetWorkFlowRoughGloss(e)}},setMaterialChannelColor:function(e,t,i,r){var a=t.getChannels()[i];return a.setColor&&(a.setColor(r),a.setEnable(!0)),a},setMaterialChannelFactor:function(e,t,i,r){var a=t.getChannels()[i];return a.setFactor(r),a.setEnable(!0),a},setMaterialChannelTexture:function(e,t,i,r,a){e.removeTextureAttribute(i,"Texture");var n=t.getChannels()[r];return n.setTextureModel(a),n.resetTextureFormat(),this._textureFactor1&&n.setFactor(1),n.setTexCoordUnit(this._textureUnit0?0:i),n.setEnable(!0),n},setChannelsFromMetaDataFactor:function(e,t){if(this._metaMapFactor){var i=this._metaMapFactor;for(var r in i)if(void 0!==e[r]){var a=JSON.parse(e[r]);this.setMaterialChannelFactor(e,t,i[r],a)}}},setChannelsFromMetaDataColor:function(e,t){if(this._metaMapColor){var i=this._metaMapColor;for(var r in i)if(void 0!==e[r]){var a=JSON.parse(e[r]);this.setMaterialChannelColor(e,t,i[r],a)}}},setChannelsFromMetaDataTexture:function(e,t,i){if(this._metaMapTexture){var r=this.getReferencedTextures(t),a=this._metaMapTexture;for(var n in a)if(void 0!==e[n]){var o=JSON.parse(e[n]),u=r[o];if(u){var l=new s.a(this.createTextureOptionsFromTextureOSG(u)),c=a[n];this.setMaterialChannelTexture(t,i,o,c,l)}}}}})),t.a=h},,,,,function(e,t,i){"use strict";function r(){var e;try{if(!(e=window.location!==window.parent.location?document.referrer:document.location.href))throw new Error("url is not defined")}catch(t){e=document.referrer}var t=document.createElement("a");return t.href=e,t}function a(){return r().hostname.replace(/^www\./,"")}t.b=r,t.a=a},,,,,,,,function(e,t,i){"use strict";function r(e,t){e.__withState.nextState=t}function a(e){delete e.__withState.nextState}function n(e){return e.__withState.nextState||e.state}var o=i(0),s=(i.n(o),i(40));t.a={name:"WithState",state:{},constructor:function(){var e=this;this.__withState={planRender:Object(s.d)(function(t){var i=n(e);a(e),e.update(e.options,i,!0,t)})}},setState:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=n(this),a=Object(o.isFunction)(e)?e(i):e;r(this,Object(o.extend)({},i,a)),this.__withState.planRender(t)}}},,function(e,t,i){"use strict";var r=i(1007),a=(i.n(r),i(771)),n=i(772),o=i(1047),s=i(1050),u=i(1052),l=i(1056),c=i(1070),h=i(690),d=i(1080),p=i(1085),f=i(1086),m=i(1087),g=i(1088),_=a.a;_.osg=n.default,_.osgAnimation=o.a,_.osgDB=s.a,_.osgGA=u.a,_.osgUtil=l.a,_.osgViewer=c.a,_.osgShader=h.default,_.osgShadow=d.a,_.osgStats=p.a,_.osgText=f.a,_.osgWrappers=m.a,_.osgPlugins=g.a,_.InputGroups=c.a.InputGroups,_.globalify=function(){window.osg=_.osg,window.osgAnimation=_.osgAnimation,window.osgDB=_.osgDB,window.osgGA=_.osgGA,window.osgUtil=_.osgUtil,window.osgViewer=_.osgViewer,window.osgShader=_.osgShader,window.osgShadow=_.osgShadow,window.osgStats=_.osgStats,window.osgText=_.osgText,window.osgWrappers=_.osgWrappers,window.osgPlugins=_.osgPlugins,window.InputGroups=_.InputGroups},t.a=_},function(e,t,i){"use strict";var r=i(9),a=i(58),n=i(10),o=function(e,t,i,r){a.a.call(this),this._x=void 0!==e?e:0,this._y=void 0!==t?t:0,this._width=void 0!==i?i:800,this._height=void 0!==r?r:600};r.a.createPrototypeStateAttribute(o,r.a.objectInherit(a.a.prototype,{attributeType:"Viewport",cloneType:function(){return new o},setViewport:function(e,t,i,r){this._x=e,this._y=t,this._width=i,this._height=r},x:function(){return this._x},y:function(){return this._y},width:function(){return this._width},height:function(){return this._height},computeWindowMatrix:function(){var e=n.c.create(),t=n.c.create(),i=n.f.create();return function(r){n.c.fromTranslation(e,n.f.ONE),n.c.fromScaling(t,[.5*this._width,.5*this._height,.5]);var a=n.c.fromTranslation(r,n.f.set(i,this._x,this._y,0));return n.c.mul(a,a,n.c.mul(t,t,e))}}(),apply:function(e){e.applyViewport(this)}}),"osg","Viewport"),t.a=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(21),a=i(9),n=i(72),o=i(247),s=i(121),u=i(128),l=i(99),c=i(185),h=i(183),d=i(182),p=i(98),f=i(10),m=i(143),g=i(676),_=i(549),v={};v.ObjectWrapper={},v.ObjectWrapper.serializers={},v.readImage=function(e,t){return v.registry().readImageURL(e,t)},v.readImageURL=v.readImage,v.readBinaryArrayURL=function(e,t){return v.registry().readBinaryArrayURL(e,t)},v.readNodeURL=function(e,t){var i=e.substr(e.lastIndexOf(".")+1),r=_.a.instance().getReaderWriterForExtension(i);return void 0!==r?r.readNodeURL(e,t):v.registry().readNodeURL(e,t)},v.registry=function(){var e=i(684).default;return void 0===v.registry._input&&(v.registry._input=new e),v.registry._input},v.parseSceneGraph=function(e,t){if(!(void 0!==e.Version&&e.Version>0)){a.a.time("osgjs.metric:ReaderParser.parseSceneGraphDeprecated",r.a.INFO);var i=v.parseSceneGraphDeprecated(e);return a.a.timeEnd("osgjs.metric:ReaderParser.parseSceneGraphDeprecated",r.a.INFO),i}a.a.time("osgjs.metric:ReaderParser.parseSceneGraph",r.a.INFO);var n;for(var o in e)if("Generator"!==o&&"Version"!==o){n=o;break}if(n){var s={};s[n]=e[n];var u=v.registry().clone();u.setJSON(s);var l=a.a.objectMix(a.a.objectMix({},v.registry().getOptions()),t||{});u.setOptions(l);var c=u.readObject();return a.a.timeEnd("osgjs.metric:ReaderParser.parseSceneGraph",r.a.INFO),c}r.a.log("can't parse scenegraph "+e,r.a.INFO)},v.parseSceneGraphDeprecated=function(e){var t,_=function(e,t){var i=t[e];return void 0===i&&(i=t[e.toLowerCase()]),i},b=function(e,t){var i=_("Name",t);i&&void 0!==e.setName&&e.setName(i)},y=function(e,t){b(e,t),e.setAmbient(_("Ambient",t)),e.setDiffuse(_("Diffuse",t)),e.setEmission(_("Emission",t)),e.setSpecular(_("Specular",t)),e.setShininess(_("Shininess",t))},x=function(e,t){b(e,t),e.setSourceRGB(t.SourceRGB),e.setSourceAlpha(t.SourceAlpha),e.setDestinationRGB(t.DestinationRGB),e.setDestinationAlpha(t.DestinationAlpha)},S=function(e,t){var i=t.MagFilter||t.mag_filter||void 0;i&&e.setMagFilter(i);var a=t.MinFilter||t.min_filter||void 0;a&&e.setMinFilter(a);var n=t.WrapT||t.wrap_t||void 0;n&&e.setWrapT(n);var o=t.WrapS||t.wrap_s||void 0;o&&e.setWrapS(o);var s=_("File",t);v.readImage(s).then(function(t){e.setImage(t)}).catch(function(){r.a.log("Can't read image")})},M=e.children,w=e._primitives||e.primitives||e.Primitives||void 0,T=e._attributes||e.attributes||e.Attributes||void 0;if(w||T){var C=new s.a;b(C,e),C.stateset=e.stateset,e=C;for(var E=0,L=w.length;E<L;E++){var P=w[E].mode;if(w[E].indices){var A=w[E].indices;A=new u.a(u.a[A.type],A.elements,A.itemSize),P=P?l.a[P]:"TRIANGLES",C.getPrimitiveSetList().push(new h.a(P,A))}else{P=l.a[P];var D=w[E].first,O=w[E].count;C.getPrimitiveSetList().push(new c.a(P,D,O))}}for(var k in T){var R=T[k];C.getVertexAttributeList()[k]=new u.a(R.type,R.elements,R.itemSize)}}var I=_("StateSet",e);if(I){var F=new d.a;!function(e,t){b(e,t);var a=_("Textures",t)||_("TextureAttributeList",t)||void 0;if(a)for(var s=0,u=a.length;s<u;s++){var l=_("File",a[s]);if(l){var c=i(84).default,h=new c;S(h,a[s]),e.setTextureAttributeAndModes(s,h),e.addUniform(n.a.createInt1(s,"Texture"+s))}else r.a.log("no texture on unit "+s+" skip it")}var d=_("BlendFunc",t);if(d){var p=new o.a;x(p,d),e.setAttributeAndModes(p)}var f=_("Material",t);if(f){var m=i(788).default,g=new m;y(g,f),e.setAttributeAndModes(g)}}(F,I),e.stateset=F}var N=e.matrix||e.Matrix||void 0;N&&(t=new m.a,b(t,e),a.a.extend(t,e),f.c.copy(t.getMatrix(),N),e=t);var V=e.projection||e.Projection||void 0;if(V&&(t=new g.a,b(t,e),a.a.extend(t,e),f.c.copy(t.setProjectionMatrix(),V),e=t),void 0===e.typeID&&(t=new p.a,b(t,e),a.a.extend(t,e),e=t),M){e.children=[];for(var B=0,U=M.length;B<U;B++)e.addChild(v.parseSceneGraphDeprecated(M[B]))}return e},t.default=v},function(e,t,i){var r=i(1248),a=function(e){e=e||"",e=decodeURIComponent(e);var t={};return e.split("&").forEach(function(e){if(e.indexOf("=")>-1){var i=e.split("=");t[i[0]]=i[1]}else t=e.indexOf(",")>-1?e.split(","):e}.bind(this)),t},n=function(e,t){var i=e;i.indexOf("#")>-1&&(i=i.slice(1));var r=i.split(";"),a=[];for(var n in r){var u=new s(o(r[n]));u.from&&u.from===t||!u.data||a.push(u)}return a},o=function(e){var t=e,i={};t.indexOf("#")>-1&&(t=t.slice(1));var r=t.split(":");return 1===r.length?i.data=r[0]:2===r.length?(i.from=r[0].toUpperCase(),i.data=r[1]):3===r.length&&(i.from=r[0].toUpperCase(),i.to=r[1].toUpperCase(),i.data=r[2]),i.data&&(i.stringData=i.data,i.data=a(i.data)),i._originalString=e+";",i},s=function(e){var t=e;"string"==typeof e&&(t=o(e)),this._msg=t,this.from=t.from,this.to=t.to,this.data=u(t.data)},u=function(e){return"string"==typeof e?e=decodeURIComponent(e):Array.isArray(e)?e=e.map(decodeURIComponent):"object"===(typeof e).toLowerCase()&&Object.keys(e).forEach(function(t){"string"==typeof e[t]?e[t]=decodeURIComponent(e[t]):Array.isArray(e[t])&&(e[t]=e[t].map(decodeURIComponent))}.bind(this)),e};s.prototype._getStringifiedData=function(){var e="";if("string"==typeof this.data)return encodeURIComponent(this.data);if(Array.isArray(this.data))return this.data.map(encodeURIComponent).join(",");if("object"==typeof this.data)for(var t in this.data){var i;"string"==typeof this.data[t]?i=encodeURIComponent(this.data[t]):Array.isArray(this.data[t])&&(i=this.data[t].map(encodeURIComponent).join(",")),e+=t+"="+i}return e},s.prototype.toString=function(){var e="";return this.from&&(e+=this.from+":"),this.to&&(e+=this.to+":"),e+=this._getStringifiedData()+";"};var l=function(e){if(e=e||{},!e.device)throw new Error('ViewerHashAPI options need to contain the "device" identifier property');e.listen&&this.listen(e.listen),this.device=e.device};l.prototype.appendToHash=function(e,t){e instanceof s&&(e=e.toString()),"string"==typeof e&&(t=c(t),-1===t.location.hash.indexOf(e)&&(t.location.hash=t.location.hash+e))},l.prototype.removeFromHash=function(e,t){if(!(e instanceof s))throw new Error("Please supply an instance of ViewerHashMessage");t=c(t);var i=t.location.hash;i=e._msg&&e._msg._originalString?i.replace(e._msg._originalString,""):i.replace(e.toString(),""),t.location.hash=i};var c=function(e){if(e=(!0===e?window:e)||window,e&&e.tagName&&"iframe"===e.tagName.toLowerCase()&&(e=e.contentWindow),!e.addEventListener)throw new Error("Could not bind an event to supplied target. Please supply an instance of window or an iframe.");return e};l.prototype.listen=function(e){return e=c(e),e.addEventListener("hashchange",this._onHashChange.bind(this,e),!1)},l.prototype._onHashChange=function(e){(this.getMessages(e.location.hash).messages||[]).forEach(function(e){if(e)if(e.data&&!Array.isArray(e)){var t=e.data;if("object"==typeof e.data){var i=Object.keys(e.data);t=e.data._key?e.data._key:i[0]}t&&this.trigger("message:"+t,e)}else this.trigger("message",e)}.bind(this))},l.prototype.getMessages=function(e){var t=n(e,this.device),i=e;for(var r in t)i=t[r]._msg&&t[r]._msg._originalString?i.replace(t[r]._msg._originalString,""):i.replace(t[r].toString(),"");return{messages:t,hash:i}},l.prototype.createMessage=function(e){return e=e||{},e.from=this.device,new s(e)},r.mixin(l.prototype),s.prototype.removeFromHash=function(){l.prototype.removeFromHash.call(this,this)},s.prototype.appendToHash=function(){l.prototype.appendToHash.call(this,this)},e.exports=l},function(e,t,i){"use strict";var r=i(5),a=i(16),n=i(113),o=i(93),s=r.a.osg,u=r.a.osgShader,l=u.Compiler,c=function(){u.Compiler.apply(this,arguments);var e=this._material?this._material.getMaterialModel():void 0;this._channels=e?e.getChannels():void 0,this._isLighted=e&&!1===this._material.getShadeless(),this._isVertexColored=e&&this._material.getVertexColorEnable(),this._isVertexAlpha=e&&this._material.getVertexAlphaEnable()},h={attribute:["VertexCompression","SketchfabLight0","SketchfabLight1","SketchfabLight2","SketchfabLight3","ShadowReceive0","ShadowReceive1","ShadowReceive2","ShadowReceive3","SketchfabMaterial","Morph","Skinning","PointSize"],textureAttribute:["Texture"]};u.Compiler.setStateAttributeConfig(c,h),s.createPrototypeObject(c,s.objectInherit(l.prototype,{createVariableOne:function(e){return this.createVariable(e).setValue(e+"(1.0)")},createVariableZero:function(e){return this.createVariable(e).setValue(e+"(0.0)")},sortDeclarations:function(e){if(l.prototype.sortDeclarations.call(this,e),!this._fragmentShaderMode&&Object(a.a)().varyingSorting)for(var t=-1,i=0,r=e.length;i<r;++i){var n=e[i];if(-1===t&&"v"===n[0]&&(t=i),-1!==n.indexOf("vViewNormal")){e[i]=e[t],e[t]=n;break}}},isAlphaBlendedMaterial:function(){if(!this._channels)return!1;var e=this._channels.Opacity,t=e.get("type");return e.isEffective()&&("alphaBlend"===t||"additive"===t)},isRefractionMaterial:function(){if(!this._channels)return!1;var e=this._channels.Opacity,t=e.get("type");return e.isEffective()&&"refraction"===t},isDitheringMaskingMaterial:function(){if(!this._channels)return!1;var e=this._channels.Opacity,t=e.get("type");return e.isEffective()&&("alphaMask"===t||"dithering"===t)},getTextureByName:function(){},declareTextures:function(){},getCompilerName:function(){return"Classic"},getFragmentShaderName:function(){var e,t=l.prototype.getFragmentShaderName.call(this);if(e=this.isAlphaBlendedMaterial()?"Blend":this.isRefractionMaterial()?"Refract":this.isDitheringMaskingMaterial()?"MaskDither":"Opaque"){var i=this.getCompilerName();t=t.replace(i,i+"_"+e)}return t},registerTextureAttributes:function(e,t){var i=e.className();if("PackedMaterialTexture"===i)return this.registerTexture(e,t);if("TextureEnvironment"===i)return this.registerTextureEnvironment(e,t);if("ShadowTexture"===i||"ShadowTextureAtlas"===i)return this.registerTextureShadow(e,t);if("Texture"===i){var r=e.getName();return"TextureToBeRefracted"!==r&&"TextureDepth"!==r&&"TextureMipmapDepth"!==r?void console.error("Unknown texture in compiler: "+e.getName()):this.registerTexture(e,t)}},registerTextureEnvironment:function(e,t){this._textures[t]=e,this._texturesByName["TextureEnvironment"+e.getChannel()]={texture:e,variable:void 0,textureUnit:t}},applyEmissive:function(e){var t=this.getOrCreateChannel("EmitColor");if(!t)return e;var i=this.createVariable("vec3");return this.getNode("InlineCode").code("%output = %mult == 1 ? %color * %emit : %color + %emit;").inputs({color:e,emit:t,mult:this.getOrCreateUniform("int","uEmitMultiplicative")}).outputs({output:i}),i},_getFinalLightContribution:function(e,t){var i={};return e||t?e&&t?(i.diffuse=this.createVariable("vec3"),this.getNode("Add").inputs(e.diffuse,t.diffuse).outputs(i.diffuse),i.specular=this.createVariable("vec3"),this.getNode("Add").inputs(e.specular,t.specular).outputs(i.specular),i):(i.diffuse=e?e.diffuse:t.diffuse,i.specular=e?e.specular:t.specular,i):(i.diffuse=this.createVariableZero("vec3"),i.specular=this.createVariableZero("vec3"),i)},_applySeparateEmitColor:function(e){var t=this.getOrCreateChannel("EmitColor");if(t){var i=["%diffuse = (%mult == 1 ? %diffuse * %emit : %diffuse + %emit);","%specular = (%mult == 1 ? %specular * %emit : %specular);"].join("\n");this.getNode("InlineCode").code(i).inputs({diffuse:e.diffuse,specular:e.specular,emit:t,mult:this.getOrCreateUniform("int","uEmitMultiplicative")}).outputs({diffuse:e.diffuse,specular:e.specular})}},checkerboardFinalColor:function(e,t){var i=this.createVariable("vec3"),r=this._getFinalLightContribution(e,t);this._applySeparateEmitColor(r);var a=this.createVariable("float");return this.getNode("Checkerboard").inputs({uv:this.createVariable("vec2").setValue("gl_FragCoord.xy"),halton:this.getOrCreateUniform("vec4","uHalton")}).outputs({result:a}),this.getNode("Blend").mode("MIX").inputs(r.specular,r.diffuse,a).outputs(i),i},getRefractionRoughness:function(){return this.getOrCreateUniform("float","uOpacityRoughnessFactor")},applyRefraction:function(e,t){if((e||t)&&this.isRefractionMaterial()){var i=this.getOrCreateUniform("vec4","uTaaCornersCSLeft");i.globalDeclaration=function(){return"uniform vec4 "+i.getVariable()+"[2];"};var r=this.createVariable("vec3");this.getNode("Refraction").inputs({indexRefraction:this.getOrCreateUniform("float","uOpacityIOR"),roughness:this.getRefractionRoughness(),normal:this.getOrCreateMaterialNormal(),eyeVector:this.getOrCreateNormalizedViewEyeDirection(),viewVertex:this.getOrCreateViewVertex(),boxRadius:this.getOrCreateUniform("float","uBoxRadius"),colorTex:this.getOrCreateSampler("sampler2D","uTextureToBeRefracted"),depthTex:this.getOrCreateSampler("sampler2D","uTextureMipmapDepth"),refractionSize:this.getOrCreateUniform("vec2","uTextureToBeRefractedSize"),nearFar:this.getOrCreateUniform("vec2","uNearFar"),currentRatio:this.getOrCreateUniform("vec2","uGlobalTexRatio"),previousSize:this.getOrCreateUniform("vec2","uPreviousGlobalTexSize"),previousRatio:this.getOrCreateUniform("vec2","uPreviousGlobalTexRatio"),previousHalton:this.getOrCreateUniform("vec4","uPreviousHalton"),reprojectViewProj:this.getOrCreateUniform("mat4","uReprojectViewProj"),projection:this.getOrCreateUniform("mat4","uProjectionMatrix"),corners:i,isVr:this.getOrCreateUniform("int","uIsVr")}).outputs({result:r}).addDefines([Object(a.a)().depthMipmap?"#define DEPTH_MIPMAP":""]);var n=!(!t||!e),o=this.createVariable("float").setValue(n?"0.5":"1.0"),s=this._channels.Opacity.get("useAlbedoTint")?this.getOrCreateMaterialDiffuseColor():this.getOrCreateConstantOne("float"),u=this.getOrCreateUniform("vec3","uOpacityRefractionColor");this.getNode("Mult").inputs(o,r,s,u).outputs(r);var l=this.getOrCreateChannel("Opacity");t&&this.getNode("Blend").mode("MIX").inputs(r,t.diffuse,l).outputs(t.diffuse),e&&this.getNode("Blend").mode("MIX").inputs(r,e.diffuse,l).outputs(e.diffuse)}},createColorLit:function(){var e=this.getLightingSeparate(),t=this.getEnvironmentSeparate();if(this._channels.SubsurfaceScattering.isEnableEffective())return this.checkerboardFinalColor(e,t);if(!t&&!e)return this.applyEmissive(this.createVariableZero("vec3"));this.applyRefraction(e,t);var i=[];t&&i.push(t.diffuse,t.specular),e&&i.push(e.diffuse,e.specular);var r=this.createVariable("vec3");return this.getNode("Add").inputs(i).outputs(r),this.applyEmissive(r)},createFragmentShaderGraph:function(){var e;return this._isLighted?e=this.createColorLit():(e=this.getShadelessColor(),this.applyRefraction({diffuse:e}),e=this.applyEmissive(e)),[this.getFinalFrag(e)]},getOrCreateDistanceShadow:function(e){return this._computeShadowOutDistance=this.hasLightShadow(e)&&!!this.getOrCreateChannel("SubsurfaceTranslucency"),l.prototype.getOrCreateDistanceShadow.call(this,e)},getOrCreateJitterShadow:function(e){if("none"!==Object(a.a)().shadowJitterOffset)return this.getOrCreateUniform("float","uStaticFrameNumShadow"+e)},getOrCreateTranslucencyTextureFactor:function(){var e=this.getVariable("translucencyThicknessFactor");if(e)return e;e=this.createVariable("float","translucencyThicknessFactor");var t=this.getOrCreateChannel("SubsurfaceTranslucency"),i=this.getOrCreateUniform("float","uSubsurfaceTranslucencyFactor");return this.getNode("Mult").inputs(i,t).outputs(e),e},getLightSSSWithPrecompute:function(e,t){var i={dotNL:t.dotNL,attenuation:t.attenuation,translucencyColor:this.getOrCreateUniform("vec3","uSubsurfaceTranslucencyColor"),translucencyFactor:this.getOrCreateTranslucencyTextureFactor(),thicknessFactor:this.getOrCreateUniform("float","uSubsurfaceTranslucencyThicknessFactor"),shadowDistance:this.getOrCreateDistanceShadow(e.getLightNumber()),diffuse:this.getOrCreateMaterialDiffusePBR?this.getOrCreateMaterialDiffusePBR():this.getOrCreateMaterialDiffuseColor(),lightColor:this.getOrCreateUniform(e.getOrCreateUniforms().diffuse)},r=this.createVariable("vec3");return this.getNode("ComputeLightSSS").inputs(i).outputs({result:r}),r},getLightSeparate:function(e){var t=l.prototype.getLightSeparate.call(this,e);if(!this.getOrCreateDistanceShadow(e.getLightNumber()))return t;var i=this.getLightSSSWithPrecompute(e,t);return this.getNode("Add").inputs(t.diffuseOut,i).outputs(t.diffuseOut),t},getFinalFrag:function(e){var t=this.getNode("glFragColor");if(this.applyPointSizeCircle(t),this.isAlphaBlendedMaterial())return this.getFinalFragOpaqueOrBlending(e,t);if(this.isRefractionMaterial()){var i=this.getOrCreateChannel("Opacity");return this.applyDiscardTransparentOpaque(i,i,t),this.getRGBM(this.getSrgbColor(e),t)}return this.applyAlphaMask(t),this.getRGBM(this.getSrgbColor(e),t)},getRGBM:function(e,t){return this.getNode("EncodeRGBM").inputs({color:e,range:this.getOrCreateUniform("float","uRGBMRange")}).outputs({result:t}),t},getFinalFragOpaqueOrBlending:function(e,t){var i=this.getOrCreateChannel("Opacity"),r=this.getAlphaFinalAlpha(i);this.applyDiscardTransparentOpaque(i,r,t);var a=this.getSrgbColor(this.getPremultAlpha(e,i));return this.getNode("InlineCode").code("%color = %drawOpaque == 1 ? %rgbm : vec4(%rgb, %alpha);").inputs({rgb:a,rgbm:this.getRGBM(a,this.createVariable("vec4")),alpha:r,drawOpaque:this.getOrCreateUniform("int","uDrawOpaque")}).outputs({color:t}),t},applyDiscardTransparentOpaque:function(e,t,i){var r=(1-Object(a.a)().epsilonAlpha).toExponential(),n="if (";this.isAlphaBlendedMaterial()&&(n+="%alphaOriginal == 0.0  || "),n+="(%drawOpaque == 1 && %alphaFinal < "+r+")",n+=" || (%drawOpaque == 0 && %alphaFinal >= "+r+")",n+=") discard;",this.getNode("InlineCode").code(n).inputs({alphaOriginal:e,alphaFinal:t,drawOpaque:this.getOrCreateUniform("int","uDrawOpaque")}).outputs({out:i})},getAlphaFinalAlpha:function(e){var t=this.createVariable("float");return this.getNode("InlineCode").code("%finalAlpha = %alpha * float(1 - %additive);").inputs({alpha:e,additive:this.getOrCreateUniform("int","uOpacityAdditive")}).outputs({finalAlpha:t}),t},getShadelessColor:function(){return this.getOrCreateMaterialDiffuseColor()},getVertexAlpha:function(e){if(!this._isVertexAlpha)return e;var t=this.createVariable("float");return this.getNode("InlineCode").code("%out = %alpha * (%hasVertexColor == 1.0 ? %vertexColor.a : 1.0);").inputs({hasVertexColor:this.getOrCreateUniform("float","uArrayColorEnabled"),vertexColor:this.getOrCreateVarying("vec4","vVertexColor"),alpha:e}).outputs({out:t}),t},multiplyDiffuseWithVertexColor:function(e){if(!this._isVertexColored)return e;var t=this.getOrCreateVarying("vec4","vVertexColor"),i=this.getOrCreateUniform("float","uArrayColorEnabled");if("srgb"===this._material.getVertexColorColorSpace()){var r=this.createVariable("vec3");this.getNode("sRGBToLinear").inputs({color:t}).outputs({result:r}),t=r}var a=this.createVariable("vec3"),n=["","%color.rgb = %diffuse.rgb;","if ( %hasVertexColor == 1.0) {","  %color *= %vertexColor.rgb;","}"].join("\n");return this.getNode("InlineCode").code(n).inputs({diffuse:e,hasVertexColor:i,vertexColor:t}).outputs({color:a}).comment("diffuse color = diffuse color * vertex color"),a},getOrCreateMaterialDiffuseColor:function(){var e=this.getVariable("materialDiffuseColor");if(e)return e;e=this.createVariable("vec3","materialDiffuseColor");var t=this.getOrCreateChannel("DiffuseColor");if(!t)return e.setValue("vec3(0.0)");var i=this.getOrCreateChannel("DiffuseIntensity")||this.createVariableOne("float");return this.getNode("Mult").inputs(this.multiplyDiffuseWithVertexColor(t),i).outputs(e),e},getOrCreateMaterialNormal:function(){return this.getOrCreateGeometryNormal()},getAmbientLight:function(){},getOrCreateMaterialSpecularColor:function(){return this.getOrCreateChannel("SpecularColor")||this.createVariableZero("vec3")},getOrCreateMaterialSpecularHardness:function(){return this.getOrCreateChannel("SpecularHardness")||this.createVariableZero("float")},applyAlphaMask:function(e){if(this.isDitheringMaskingMaterial()){var t=this.getOrCreateChannel("Opacity");t&&this.getNode("DitheringMaskingDiscard").inputs({alpha:t,factor:this.getOrCreateUniform("float","uOpacityFactor"),dithering:this.getOrCreateUniform("int","uOpacityDithering"),fragCoord:this.createVariable("vec4").setValue("gl_FragCoord"),thinLayer:this.getOrCreateUniform("float","uOpacityThinLayer"),nearFar:this.getOrCreateUniform("vec2","uNearFar"),frameMod:this.getOrCreateUniform("float","uFrameMod"),halton:this.getOrCreateUniform("vec4","uHalton")}).outputs({result:e})}},getOrCreateNormalMap:function(){var e=this.getVariable("normalMap");return e||(e=this.createVariable("vec3","normalMap"),this.getNode("TextureNormalMap").inputs({normal:this.getOrCreateChannel("NormalMap"),flipY:this.getOrCreateUniform("int","uNormalMapFlipY")}).outputs({result:e}),e)},getOrCreateGeometryNormal:function(){var e=this.getVariable("geoNormal");if(e)return e;e=this.createVariable("vec3","geoNormal");var t=this.getNormalMapNormal()||this.getBumpMapNormal()||this.getOrCreateNormalizedFrontViewNormal();return this.getNode("SetFromNode").inputs(t).outputs(e),e},getSrgbColor:function(e){var t=this.createVariable("vec3");return this.getNode("LinearTosRGBWithTest").inputs({color:e,keepLinear:this.getOrCreateUniform("int","uOutputLinear")}).outputs({result:t}),t},ssr:function(e){if(!o.a.get("hasSsr"))return e;if((this.isAlphaBlendedMaterial()||this.isRefractionMaterial())&&!Object(a.a)().ssrTransparent)return e;var t,i=this.createVariable("vec3");t=this.getOrCreateMaterialRoughness?this.getOrCreateMaterialRoughness():this.getOrCreateConstantZero("float");var r=this.createVariable("vec3");if(this.getOrCreateMaterialSpecularPBR)this.getNode("Mult").inputs(this.getOrCreateMaterialSpecularPBR(),this.getOrCreateMaterialAOSpecularPBR()).outputs(r);else{var n=this.getOrCreateUniform("float","uReflection");this.getNode("Mult").inputs(this.getOrCreateMaterialSpecularColor(),n).outputs(r)}var s=this.getOrCreateUniform("vec4","uTaaCornersCSLeft");return s.globalDeclaration=function(){return"uniform vec4 "+s.getVariable()+"[2];"},this.getNode("Ssr").inputs({frameMod:this.getOrCreateUniform("float","uFrameModTaaSS"),quality:this.getOrCreateUniform("float","uQuality"),specularEnvironment:e,specularColor:r,roughness:t,ssrFactor:this.getOrCreateUniform("float","uSsrFactor"),normal:this.getOrCreateMaterialNormal(),eyeVector:this.getOrCreateNormalizedViewEyeDirection(),viewVertex:this.getOrCreateViewVertex(),boxRadius:this.getOrCreateUniform("float","uBoxRadius"),colorTex:this.getOrCreateSampler("sampler2D","uTextureToBeRefracted"),depthTex:this.getOrCreateSampler("sampler2D","uTextureMipmapDepth"),mipmapSize:this.getOrCreateUniform("vec2","uTextureToBeRefractedSize"),nearFar:this.getOrCreateUniform("vec2","uNearFar"),currentRatio:this.getOrCreateUniform("vec2","uGlobalTexRatio"),previousSize:this.getOrCreateUniform("vec2","uPreviousGlobalTexSize"),previousRatio:this.getOrCreateUniform("vec2","uPreviousGlobalTexRatio"),previousHalton:this.getOrCreateUniform("vec4","uPreviousHalton"),previousProjection:this.getOrCreateUniform("mat4","uPreviousProjection"),previousViewInvView:this.getOrCreateUniform("mat4","uPreviousViewInvView"),reprojectViewProj:this.getOrCreateUniform("mat4","uReprojectViewProj"),projection:this.getOrCreateUniform("mat4","uProjectionMatrix"),corners:s}).outputs({result:i}).addDefines([Object(a.a)().depthMipmap?"#define DEPTH_MIPMAP":""]),i},getEnvironmentSeparate:function(){if(this.getTextureEnvironmentSpecular())return{diffuse:this.getEnvironmentDiffuse(),specular:this.ssr(this.getEnvironmentSpecular())}},getTextureEnvironmentSpecular:function(){var e=this._texturesByName.TextureEnvironmentSpecular;return e&&e.texture},getEnvironmentUniforms:function(){return this.getTextureEnvironmentSpecular().getUniforms()},getOrCreateEnvironmentTransform:function(){if(this.getVariable("envTransform"))return this.getVariable("envTransform");var e=this.createVariable("mat3","envTransform");return this.getNode("EnvironmentTransformPBR").inputs({transform:this.getOrCreateUniform(this.getEnvironmentUniforms().environmentTransform)}).outputs({result:e}),e},getOrCreateMaterialAmbientOcclusion:function(){return this.createVariableOne("float")},_computeEnvDiffuseNormal:function(e){var t=this.getEnvironmentUniforms(),i=this.getOrCreateUniform(t.diffuseSPH);i.globalDeclaration=function(){return"uniform vec3 "+i.getVariable()+"[9];"};var r=this.createVariable("vec3");return this.getNode("ComputeDiffuseSPH").inputs({normal:e,envTransform:this.getOrCreateEnvironmentTransform(),sphCoef:i}).outputs({result:r}),r},_addBackIrradiance:function(e){if(this._channels.SubsurfaceTranslucency.getTextureModel()){var t=this.getOrCreateChannel("SubsurfaceTranslucency");if(t){var i=this.createVariable("vec3"),r=this.createVariable("float").setValue("-1.0"),a=this.createVariable("float").setValue("0.5");this.getNode("Blend").mode("ADD").inputs(a,this.getOrCreateMaterialNormal(),r).outputs(i);var n=this._computeEnvDiffuseNormal(i),o=this.createVariable("float");this.getNode("Mult").inputs(t,this.getOrCreateUniform("float","uSubsurfaceTranslucencyThicknessFactor")).outputs(o);var s={dotNL:this.createVariable("float").setValue("-1.0"),attenuation:this.getOrCreateConstantOne("float"),translucencyColor:this.getOrCreateUniform("vec3","uSubsurfaceTranslucencyColor"),translucencyFactor:this.getOrCreateUniform("float","uSubsurfaceTranslucencyFactor"),thicknessFactor:o,shadowDistance:this.getOrCreateUniform("float","uNormalizeFactorThickness"),diffuse:this.getOrCreateConstantOne("vec3"),lightColor:n};this.getNode("ComputeLightSSS").inputs(s).outputs({result:n}),this.getNode("Add").inputs(e,n).outputs(e)}}},getEnvironmentDiffuse:function(){if(this.getTextureEnvironmentSpecular()){if(this.getVariable("envDiffuse"))return this.getVariable("envDiffuse");var e=this.createVariable("vec3","envDiffuse"),t=this.getEnvironmentUniforms(),i=this._computeEnvDiffuseNormal(this.getOrCreateMaterialNormal()),r=this.getOrCreateUniform(t.exposure),a=this.getOrCreateMaterialDiffuseColor(),n=this.getOrCreateMaterialAmbientOcclusion();return this._addBackIrradiance(i),this.getNode("Mult").inputs(i,a,r,n).outputs(e),e}},getEnvironmentSpecular:function(){var e=this.getTextureEnvironmentSpecular();if(e){if(this.getVariable("envSpecular"))return this.getVariable("envSpecular");var t=this.createVariable("vec3","envSpecular"),i=this.getEnvironmentUniforms(),r=this.createVariable("vec3");this.getNode("TextureEnvironmentCube").inputs({tex:this.getOrCreateSampler("samplerCube",i.textureSpecular.getName()),envTransform:this.getOrCreateEnvironmentTransform(),normal:this.getOrCreateMaterialNormal(),eyeVector:this.getOrCreateNormalizedViewEyeDirection(),texSize:this.getOrCreateUniform(e.getOrCreateUniforms().size)}).outputs({result:r});var a=this.getOrCreateUniform("float","uReflection"),n=this.getOrCreateUniform(i.exposure);return this.getNode("Mult").inputs(r,this.getOrCreateMaterialSpecularColor(),a,n).outputs(t),t}},getNormalMapNormal:function(){if(this.getOrCreateChannel("NormalMap")){var e=this.getOrCreateNormalizedFrontViewNormal(),t=this.getOrCreateNormalMap(),i=this.getOrCreateUniform("float","uNormalMapFactor"),r=this.createVariable("vec3");this.getNode("InlineCode").code("%out.xy = %factor * %input.xy;\n%out.z = %input.z;").inputs({input:t,factor:i}).outputs({out:r});var a=this.createVariable("vec3");return this.getNode("NormalTangentSpace").inputs({tangent:this.getOrCreateFrontViewTangent(),normal:e,texNormal:r}).outputs({result:a}),a}},getBumpMapNormal:function(){var e=this.getOrCreateChannel("BumpMap");if(e){var t=this.getOrCreateNormalizedFrontViewNormal(),i=this.getOrCreateUniform("float","uBumpMapFactor"),r=this.createVariable("vec2");this.getNode("Mult").inputs(e,i).outputs(r);var a=this.createVariable("vec3");return this.getNode("BumpMap").inputs({tangent:this.getOrCreateFrontViewTangent(),normal:t,gradient:r}).outputs({result:a}),a}},getColorAtlasUV:function(e){var t=n.a.getColorPacking(e),i="";return i=0===t?"vec2(0.125, 0.5)":1===t?"vec2(0.375, 0.5)":2===t?"vec2(0.625, 0.5)":"vec2(0.875, 0.5)",this.getOrCreateConstant("vec2","uvColorAtlas"+t).setValue(i)},_getChannelUV:function(e,t){if("Matcap"===t)return this.getOrCreateMatcapUV();if(!e.getTextureModel())return this.getColorAtlasUV(t);var i=e.getTexCoordUnit();return this._fragmentShaderMode?this.getOrCreateVarying("vec2","vTexCoord"+i):this.getOrCreateAttribute("vec2","TexCoord"+i)},_getChannelValue:function(e,t,i){if(!e.getTextureModel()&&n.a.getColorPacking(t)<0)return this.createVariableOne(i);var r=this._material.getChannelMapping(t);if(!(void 0===r||r<0)){var a=this._textures[r],o=a.getName(),s=this.getVariable(o);void 0===s&&(s=this.getOrCreateSampler("sampler2D",o));var u=this._getChannelUV(e,t),l=a.getChannelPacking(t);return this.readChannel(t,s,u,l)}},_hasCustomFactor:function(e){return"Opacity"===e?this.isDitheringMaskingMaterial():"NormalMap"===e||"BumpMap"===e||"Displacement"===e||"SubsurfaceTranslucency"===e},_applyChannelFactor:function(e,t,i){if("Opacity"===e&&(t=this.getVertexAlpha(t)),this._hasCustomFactor(e))return this.getNode("SetFromNode").inputs(t).outputs(i),i;var r=this.getOrCreateUniform("float","u"+e+"Factor");return"CavityPBR"===e||"AOPBR"===e||"Matcap"===e?(this.applyInvertLerpFactor(t,r,i),i):("SpecularColor"===e&&(r=this.applyAdjustSpecular(r)),this.getNode("Mult").inputs(t,r).outputs(i),i)},getOrCreateChannel:function(e){if(this._channels){var t="channel"+e,i=this.getVariable(t);if(i)return i;var r=this._channels[e];if(r.isEnableEffective()){var a=n.a.getDefaultFormatEnum(e)===s.Texture.RGB,o=a?"vec3":"float";if("BumpMap"===e&&(o="vec2"),i=this.createVariable(o,t),!r.isEffective()){var u;return u="SubsurfaceTranslucency"===e?this.getOrCreateConstantOne("float"):this.getOrCreateUniform("float","u"+e+"Factor"),this.getNode("SetFromNode").inputs(u).outputs(i),i}var l=this._getChannelValue(r,e,o);if(l)return this._applyChannelFactor(e,l,i),i}}},getOrCreateMatcapUV:function(){var e=this.getVariable("uvMatcap");return e||(e=this.createVariable("vec2","uvMatcap"),this.getNode("NormalMatcap").inputs({normal:this.getOrCreateMaterialNormal(),eyeVector:this.getOrCreateNormalizedViewEyeDirection()}).outputs({result:e}),e)},applyAdjustSpecular:function(e){if(!this.getOrCreateChannel("NormalMap"))return e;var t=this.getOrCreateNormalMap(),i=this.createVariable("float");return this.getNode("AdjustSpecular").inputs({specular:e,normal:t}).outputs({result:i}),i},applyInvertLerpFactor:function(e,t,i){var r=this.getOrCreateConstantOne(e.getType());return this.getNode("Blend").mode("MIX").inputs(r,e,t).outputs(i),i},readChannel:function(e,t,i,r){var a;switch(e){case"DiffuseColor":case"EmitColor":case"DiffuseIntensity":case"SpecularColor":case"NormalMap":case"Matcap":case"Inspector":a=this.readTexture("vec3",e,t,i,r);break;case"Opacity":a=this.readTextureOpacity("float",e,t,i,r);break;case"SpecularHardness":case"Displacement":case"SubsurfaceScattering":case"SubsurfaceTranslucency":a=this.readTexture("float",e,t,i,r);break;case"BumpMap":a=this.createTextureChannelsGradient(e,t,i,r)}return a},getLinearTexel:function(e,t){if(!this._channels[e].getSRGB())return t;var i=this.createVariable(t.getType());return this.getNode("sRGBToLinear").inputs({color:t}).outputs({result:i}),i},readTexture:function(e,t,i,r,a){var n=this.createVariable(e,t+"Fetch"),o="%color = texture2D(%sampler, %uv)."+a+";";return this.getNode("InlineCode").code(o).inputs({sampler:i,uv:r}).outputs({color:n}),this.getLinearTexel(t,n)},readTextureOpacity:function(e,t,i,r,a){var n=this.readTexture(e,t,i,r,a),o=this.createVariable("float");return this.getNode("InlineCode").code("%aout = %invert == 1 ? 1.0 - %alpha : %alpha;").inputs({alpha:n,invert:this.getOrCreateUniform("int","uOpacityInvert")}).outputs({aout:o}),o},createTextureChannelsGradient:function(e,t,i,r){var a=this.createVariable("vec2","gradient"+e),n=this._channels[e].getSRGB(),o="texture2D(tex, uv)."+(r||"r");n&&(o="sRGBToLinear("+o+")");var s=["#define TEX_BUMP(tex, uv) "+o];return this.getNode("TextureGradient").inputs({tex:t,texSize:this.getOrCreateUniform("vec2","u"+e+"Size"),uv:i}).outputs({result:a}).addDefines(s),a},getOrCreateProjectionMatrix:function(){var e=this.getVariable("jitteredProjection");if(e)return e;e=this.createVariable("mat4","jitteredProjection");var t=["%projOut = %projIn;","%projOut[2].xy += (1.0 - %is2D) * (%halton.xy * %ratio.xy / %size.xy);"];return this.getNode("InlineCode").code(t.join("\n")).inputs({projIn:this.getOrCreateUniform("mat4","uProjectionMatrix"),halton:this.getOrCreateUniform("vec4","uHalton"),size:this.getOrCreateUniform("vec2","uGlobalTexSize"),ratio:this.getOrCreateUniform("vec2","uGlobalTexRatio"),viewVertex:this.getOrCreateViewVertex(),is2D:this.getOrCreateUniform("float","uDisplay2D")}).outputs({projOut:e}),e},getOrCreateDisplacement:function(){var e=this.getVariable("displacement");if(e)return e;var t=this.getOrCreateChannel("Displacement");if(t){e=this.createVariable("float","displacement");return this.getNode("InlineCode").code("%out = (%displacement - 0.5) * %factor;").inputs({displacement:t,factor:this.getOrCreateUniform("float","uDisplacementFactor")}).outputs({out:e}),e}},displaceVertex:function(e,t){var i,r={vertex:e,displacement:this.getOrCreateDisplacement()};return Object(a.a)().substanceDisplacement?i="%output = %vertex + vec3(0.0, 0.0, 1.0) * (%vertex.z > 0.01 ? %displacement : 0.0);":(i="%output = %vertex + %direction * %displacement;",r.direction=this.getOrCreateVertexNormalizedModelNormal()),this.getNode("InlineCode").code(i).inputs(r).outputs({output:t}),t},getOrCreateVertexNormalizedModelNormal:function(){var e=this._variables.vnModelNormal;if(e)return e;var t=this.createVariable("vec3","vnModelNormal");return this.getNode("Normalize").inputs({vec:l.prototype.getOrCreateModelNormal.call(this)}).outputs({result:t}),t},displaceNormalCorrection:function(e,t){var i=this._channels.Displacement.getTexCoordUnit(),r=this._material.getChannelMapping("Displacement"),a=this._textures[r],n=a.getName(),o=this.getVariable(n),s=this.createTextureChannelsGradient("Displacement",o,this.getOrCreateAttribute("vec2","TexCoord"+i),a.getChannelPacking("Displacement")),u=this.createVariable("vec2");return this.getNode("Mult").inputs(s,this.getOrCreateUniform("float","uDisplacementNormal")).outputs(u),this.getNode("BumpMap").inputs({tangent:this.getOrCreateModelTangent(),normal:e,gradient:u}).outputs({result:t}),t},getOrCreateModelVertex:function(){if(this._fragmentShaderMode||!this.getOrCreateDisplacement())return l.prototype.getOrCreateModelVertex.call(this);var e=this._variables.displacedVertex;if(e)return e;e=this.createVariable("vec3","displacedVertex");var t=this.createVariable("vec3","modelVertex");return this.getNode("MatrixMultPosition").inputs({matrix:this.getOrCreateUniform("mat4","uModelMatrix"),vec:this.getOrCreateLocalVertex()}).outputs({vec:t}),this.displaceVertex(t,e)},getOrCreateModelNormal:function(){var e=this._channels.NormalMap;if(this._fragmentShaderMode||!this.getOrCreateDisplacement()||e.isEnableEffective())return l.prototype.getOrCreateModelNormal.call(this);var t=this._variables.displaceNormalCorrection;return t||(t=this.createVariable("vec3","displacedNormal"),this.displaceNormalCorrection(this.getOrCreateVertexNormalizedModelNormal(),t))},getOrCreateViewVertex:function(){if(this._fragmentShaderMode||!this.getOrCreateDisplacement())return l.prototype.getOrCreateViewVertex.call(this);var e=this._variables.viewVertex;return e||(e=this.createVariable("vec4","viewVertex"),this.getNode("MatrixMultPosition").inputs({matrix:this.getOrCreateUniform("mat4","uViewMatrix"),vec:this.getOrCreateModelVertex()}).outputs({vec:e}),e)},getOrCreateViewNormal:function(){if(this._fragmentShaderMode||!this.getOrCreateDisplacement())return l.prototype.getOrCreateViewNormal.call(this);var e=this._variables.viewNormal;return e||(e=this.createVariable("vec3","viewNormal"),this.getNode("MatrixMultDirection").inputs({matrix:this.getOrCreateUniform("mat4","uViewMatrix"),vec:this.getOrCreateModelNormal()}).outputs({vec:e}),e)}}),"osgSketchfab","Compiler"),t.a=c},function(e,t){!function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/popovers.jinja"]=function(){function e(e,t,i,r,a){var n="";try{var o=null,s=r.makeMacro([],["options"],function(a){var n=i;i=new r.Frame,a=a||{},a.hasOwnProperty("caller")&&i.set("caller",a.caller),i.set("options",a.hasOwnProperty("options")?a.options:{});var o="";return o+='\n\n    <div class="popover share-popover hidden',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"class")&&(o+=" ",o+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"class"),e.opts.autoescape)),o+='">\n        <p>Thanks! Also share?</p>\n\n        <a data-action="share-on-facebook" class="share-popover-icon icons-facebook"></a>\n        <a data-action="share-on-twitter" class="share-popover-icon icons-twitter"></a>\n        <a data-action="share-on-google-plus" class="share-popover-icon icons-google"></a>\n        <a data-action="share-on-pinterest" class="share-popover-icon icons-pinterest"></a>\n    </div>\n\n',i=n,new r.SafeString(o)});t.addExport("share_popover"),t.setVariable("share_popover",s),n+="\n",o?o.rootRenderFunc(e,t,i,r,a):a(null,n)}catch(e){a(r.handleError(e,null,null))}}return{root:e}}()}()},,,,function(e,t,i){"use strict";var r=i(3),a=i.n(r),n=i(26);t.a={isMaintenance:function(){return a()('meta[property="skfb:maintenance"]').attr("content")},showPopup:function(){var e=this.isMaintenance(),t=new n.default({title:e?"Maintenance":"Error",text:e?'Sketchfab is undergoing maintenance.<br>See: <a href="https://forum.sketchfab.com/t/sketchfab-operations/6678" target=_blank>Operations forum post</a>':"An unknown error occurred. Please try again later. If the error persists, please contact support@sketchfab.com",buttons:{ok:!0},safe:!0});return t.open().then(function(){t.close()}),t}}},,,function(e,t){},,,,,,,,,function(e,t,i){"use strict";var r={STRIP:Uint16Array,TRIANGLES:Uint16Array,VERTEX:Float32Array,NORMAL:Float32Array,COLOR:Float32Array},a=function(e){for(var t in e){var i=e[t];e[t]=i.length?new r[t](i):a(i)}return e};t.a={getBaseVR:function(e){i.e(9).then(function(){e(i(1566).default)}.bind(null,i)).catch(i.oe)},getVrBrowserAssets:function(e){i.e(11).then(function(){e(i(1567).default)}.bind(null,i)).catch(i.oe)},getControllerVive:function(e){i.e(15).then(function(){e(a(i(1568).default))}.bind(null,i)).catch(i.oe)},getControllerDaydream:function(e){i.e(17).then(function(){e(a(i(1569).default))}.bind(null,i)).catch(i.oe)},getControllerOculusTouch:function(e){i.e(16).then(function(){e(a(i(1570).default))}.bind(null,i)).catch(i.oe)},getControllerWin:function(e){i.e(14).then(function(){e(a(i(1571).default))}.bind(null,i)).catch(i.oe)},getHuman:function(e){i.e(13).then(function(){e(a(i(1572).default))}.bind(null,i)).catch(i.oe)}}},,,,,,function(e,t,i){"use strict";var r=i(19),a=i.n(r),n=i(31),o=i(4),s=i(64),u=i(73),l=i(2),c=i(100),h=i(76),d=i(580);i.n(d);t.a=n.a.extend({displayName:"Dropdown",mixins:[Object(c.a)('[data-ref="menu"]'),h.a],optionTypes:{child:l.b.component.isRequired,labelTitle:l.b.string,labelValue:l.b.string,longestLabelValue:l.b.string,placeholder:l.b.string,color:l.b.string,className:l.b.string,theme:l.b.oneOf(["dark","light","white-background","grey-background"]),menuAlign:l.b.oneOf(["left","right"]),disabled:l.b.bool,withBackground:l.b.bool,grey:l.b.bool},defaultOptions:{color:"",theme:"light",menuAlign:"left",disabled:!1,withBackground:!1,grey:!1},events:{'click [data-action="toggle-menu"]:not([data-disabled="true"])':"onToggle","click window":"onWindowClick","resize window":"setMenuPosition"},state:{isOpen:!1},viewDidMount:function(){this.setMenuPosition()},viewDidUpdate:function(){this.setMenuPosition()},onToggle:function(){this.setState({isOpen:!this.state.isOpen})},onWindowClick:function(e){!Object(s.d)(this.el,e.target)&&this.state.isOpen&&this.setState({isOpen:!1})},setMenuPosition:function(){var e=this.el.getBoundingClientRect(),t=this.refs.menu.getBoundingClientRect();this.refs.$menu.css({bottom:-Math.min(0,window.innerHeight-(e.bottom+t.height+10)),right:"right"===this.options.menuAlign?Math.min(0,e.right-(t.width+10)):"auto",left:"left"===this.options.menuAlign?Math.min(0,window.innerWidth-(e.left+t.width+10)):"auto"})},scrollToHeightPercent:function(e){var t=this.refs.$menu.prop("scrollHeight");this.refs.$menu.scrollTop(Object(u.b)(0,1,e)*t)},template:function(){var e=this;return o.default.getFromMacro("skfb_front/macros/components/atoms/dropdown","dropdown",[{isOpen:this.state.isOpen&&!this.options.disabled,labelTitle:this.options.labelTitle,labelValue:this.options.labelValue,longestLabelValue:this.options.longestLabelValue,placeholder:this.options.placeholder,color:this.options.color,disabled:this.options.disabled,withBackground:this.options.withBackground,grey:this.options.grey,theme:this.options.theme,className:this.options.className,components:this.createChildrenComponents({child:[].concat(this.options.child).map(function(t,i){return a()({},t,{options:a()({},t.options,{key:t.options.key||i,dropdown:{isOpen:e.state.isOpen,onToggle:e.onToggle.bind(e),scrollToHeightPercent:e.scrollToHeightPercent.bind(e)}})})})})}])}})},,function(e,t,i){"use strict";var r=i(5),a=r.a.osg,n=[0,0],o={init:function(e,t,i){this._qualityModel=t,this._canvasPixelRatio=i,this._canvas=e,this._pixelRatio=[1,1]},getCanvasCoord:function(e,t){if(t=t||n,e.center||e.touches){if(e.center)t[0]=e.center.x,t[1]=e.center.y;else{t[0]=t[1]=0;for(var i=e.touches.length,r=0;r<i;++r)t[0]+=e.touches[r].clientX/i,t[1]+=e.touches[r].clientY/i}var a=e.target.getBoundingClientRect();t[0]+=-a.left,t[1]+=-a.top}else t[0]=void 0===e.offsetX?e.layerX:e.offsetX,t[1]=void 0===e.offsetY?e.layerY:e.offsetY;return t},getPixelRatio:function(){var e=this._qualityModel.get("dynamicResolutionScaling");return this._pixelRatio[0]=this._canvasPixelRatio*e[0],this._pixelRatio[1]=this._canvasPixelRatio*e[1],this._pixelRatio},canvasCoordToGL:function(e,t,i){var r=this._canvas,n=i||a.vec2.create(),o=this.getPixelRatio();return n[0]=e*o[0],n[1]=(r.clientHeight-t)*o[1],n},glCoordToCanvas:function(e,t,i){var r=this._canvas,n=i||a.vec2.create(),o=this.getPixelRatio();return n[0]=e/o[0],n[1]=r.clientHeight-t/o[1],n}};t.a=o},,function(e,t,i){"use strict";var r=function(e,t,i){return Math.min(i,Math.max(t,e))},a=function(e,t,i){if(i<=e)return 0;if(i>=t)return 1;var r=(i-e)/(t-e);return r*r*(3-2*r)},n=function(e){return e!==e};t.a={clamp:r,smoothStep:a,isNaN:n}},function(e,t,i){"use strict";var r=i(21),a=i(9),n=i(215),o=i(10),s=function(){this._center=o.f.create(),this._radius=-1};a.a.createPrototypeObject(s,{init:function(){o.f.init(this._center),this._radius=-1},valid:function(){return this._radius>=0},set:function(e,t){this._center=e,this._radius=t},center:function(){return this._center},radius:function(){return this._radius},radius2:function(){return this._radius*this._radius},volume:function(){var e=this._radius;return e*e*e*Math.PI*4/3},copy:function(e){this._radius=e._radius,o.f.copy(this._center,e._center)},copyBoundingBox:function(e){e.center(this._center),this._radius=e.radius()},expandByBoundingBox:function(){var e=o.f.create(),t=new n.a;return function(i){if(i.valid()){if(!this.valid())return void this.copyBoundingBox(i);o.f.copy(t._min,i._min),o.f.copy(t._max,i._max);for(var r=0;r<8;r++)o.f.sub(e,i.corner(r,e),this._center),o.f.normalize(e,e),o.f.scaleAndAdd(e,this._center,e,-this._radius),t.expandByVec3(e);t.center(this._center),this._radius=t.radius()}}}(),expandByvec3:function(e){r.a.warn("deprecated, use expandByVec3"),this.expandByVec3(e)},expandByVec3:function(){var e=o.f.create();return function(t){if(this.valid()){o.f.sub(e,t,this.center(e));var i=o.f.length(e);if(i>this.radius()){var r=.5*(i-this.radius());this._center[0]+=e[0]*(r/i),this._center[1]+=e[1]*(r/i),this._center[2]+=e[2]*(r/i),this._radius+=r}}else this._center[0]=t[0],this._center[1]=t[1],this._center[2]=t[2],this._radius=0}}(),expandRadiusBySphere:function(e){if(e.valid())if(this.valid()){var t=o.f.distance(this._center,e._center)+e._radius;t>this._radius&&(this._radius=t)}else o.f.copy(this._center,e._center),this._radius=e._radius},expandByBoundingSphere:function(e){if(e.valid()){if(!this.valid())return this._center[0]=e._center[0],this._center[1]=e._center[1],this._center[2]=e._center[2],void(this._radius=e.radius());var t=o.f.distance(e.center(),this.center());if(!(t+e.radius()<=this.radius())){if(t+this.radius()<=e.radius())return this._center[0]=e._center[0],this._center[1]=e._center[1],this._center[2]=e._center[2],void(this._radius=e._radius);var i=.5*(this.radius()+t+e.radius()),r=(i-this.radius())/t;this._center[0]+=(e._center[0]-this._center[0])*r,this._center[1]+=(e._center[1]-this._center[1])*r,this._center[2]+=(e._center[2]-this._center[2])*r,this._radius=i}}},contains:function(e){return!!this.valid()&&o.f.sqrDist(this.center(),e)<=this.radius2()},intersects:function(e){if(!this.valid()||!e.valid())return!1;var t=this.radius()+e.radius();return o.f.sqrDist(e.center(),this.center())<=t*t},transformMat4:function(){var e=o.f.create();return function(t,i){if(!this.valid())return t;t._center!==this._center&&(o.f.copy(t._center,this._center),t._radius=this._radius);var r=t._center,a=t._radius;return o.c.getSqrScale(e,i),a*=Math.sqrt(Math.max(Math.max(e[0],e[1]),e[2])),t._radius=a,o.f.transformMat4(r,r,i),t}}()},"osg","BoundingSphere"),t.a=s},function(e,t,i){"use strict";var r=(i(21),i(9)),a=i(71),n=window.ImageBitmap||function(){},o=function(e){a.a.call(this),this._imageObject=void 0,this._url=void 0,this._width=void 0,this._height=void 0,this._dirty=!0,this._mipmap=[],e&&this.setImage(e),this._isGreyscale=void 0};r.a.createPrototypeObject(o,r.a.objectInherit(a.a.prototype,{dirty:function(){this._isGreyscale=void 0,this._dirty=!0},isDirty:function(){return this._dirty},setDirty:function(e){this._dirty=e},getImage:function(){return this._imageObject instanceof o?this._imageObject.getImage():this._imageObject},getURL:function(){return this._url},setURL:function(e){this._url=e},useOrCreateImage:function(e){return e instanceof o==!1?new o(e):e},setImage:function(e){if(!this._url&&e&&(e.src||e.currentSrc)&&(this._url=e.src||e.currentSrc),this._mipmap.length=0,Array.isArray(e)){for(var t=0,i=e.length;t<i;t++)this._mipmap.push(this.useOrCreateImage(e[t]));this.setWidth(this._mipmap[0].getWidth()),this.setHeight(this._mipmap[0].getHeight())}else this._mipmap.push(e);this._imageObject=this._mipmap[0],this.dirty()},isCanvas:function(){return this.getImage()instanceof window.HTMLCanvasElement},isBitmap:function(){return this.getImage()instanceof n},isVideo:function(){return this.getImage()instanceof window.HTMLVideoElement},isImage:function(){return this.getImage()instanceof window.Image},isTypedArray:function(){var e=this.getImage();return e instanceof Uint8Array||e instanceof Float32Array||e instanceof Uint16Array},setWidth:function(e){this._width=e},setHeight:function(e){this._height=e},getWidth:function(){var e=this.getImage();return this.isImage()?e.naturalWidth:this.isVideo()?e.videoWidth:this.isCanvas()||this.isBitmap()?e.width:this._width},getHeight:function(){var e=this.getImage();return this.isImage()?e.naturalHeight:this.isVideo()?e.videoHeight:this.isCanvas()||this.isBitmap()?e.height:this._height},isGreyscale:function(e){if(void 0!==this._isGreyscale)return this._isGreyscale;if(void 0!==this._imageObject&&this.isReady()&&void 0===this._isGreyscale){var t=this._imageObject;this.isCanvas()||(t=document.createElement("canvas"));var i=t.getContext("2d");t.width=this._imageObject.width,t.height=this._imageObject.height,i.drawImage(this._imageObject,0,0);var r,a;e||(r=t.width,a=t.height),e>0&&(e=Math.min(Math.min(t.width,t.height),e),r=a=e);for(var n=!0,o=t.width/r,s=t.height/a,u=0;u<r;u++)for(var l=0;l<a;l++){var c=Math.floor(o*(u+.5)),h=Math.floor(s*(l+.5)),d=i.getImageData(c,h,1,1).data;if(d[0]!==d[1]||d[0]!==d[2]){n=!1;break}}this._isGreyscale=n}return this._isGreyscale},isReady:function(){if(this._imageObject&&this._imageObject instanceof o)return this._imageObject.isReady();if(this.isCanvas()||this.isTypedArray()||this.isBitmap())return!0;if(this.isImage()){var e=this.getImage();if(e.complete)return void 0===e.naturalWidth||0!==e.naturalWidth}if(this.isVideo()&&0!==this.getWidth())return!0;var t=this.getImage();return!!t.complete&&(void 0===t.naturalWidth||0!==t.naturalWidth)},getMipmap:function(){return this._mipmap},hasMipmap:function(){return this._mipmap.length>1},release:function(){this._mipmap.length=0,this._imageObject=void 0}}),"osg","Image"),t.a=o},function(e,t,i){"use strict";var r=i(9),a=i(58),n=function(e){a.a.call(this),this.setMode(void 0!==e?e:n.BACK)};n.DISABLE=0,n.FRONT=1028,n.BACK=1029,n.FRONT_AND_BACK=1032,r.a.createPrototypeStateAttribute(n,r.a.objectInherit(a.a.prototype,{attributeType:"CullFace",cloneType:function(){return new n},setMode:function(e){var t=e;"string"==typeof t&&(t=n[t]),this._mode=t},getMode:function(){return this._mode},apply:function(e){e.applyCullFace(this)}}),"osg","CullFace"),t.a=n},function(e,t,i){"use strict";var r=i(9),a=i(10),n=r.a.objectInherit(a.g,{INSIDE:1,INTERSECT:2,OUTSIDE:3,transformProvidingInverse:function(){var e=n.create();return function(t,i){var r=t[0],a=t[1],o=t[2],s=t[3];return e[0]=i[0]*r+i[1]*a+i[2]*o+i[3]*s,e[1]=i[4]*r+i[5]*a+i[6]*o+i[7]*s,e[2]=i[8]*r+i[9]*a+i[10]*o+i[11]*s,e[3]=i[12]*r+i[13]*a+i[14]*o+i[15]*s,n.normalizeEquation(e),n.copy(e,t),t}},normalizeEquation:function(e){var t=1/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t},getNormal:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},setNormal:function(e,t){e[0]=t[0],e[1]=t[1],e[2]=t[2]},getDistance:function(e){return e[3]},setDistance:function(e,t){e[3]=t},distanceToPlane:function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]},intersectsOrContainsBoundingSphere:function(e,t){if(!t.valid())return n.OUTSIDE;var i=t.center(),r=t.radius(),a=this.distanceToPlane(e,i);return a<-r?n.OUTSIDE:a<=r?n.INTERSECT:n.INSIDE},instersectsBoundingSphere:function(e,t){return this.intersectsOrContainsBoundingSphere(e,t)===n.INTERSECT},intersectsOrContainsBoundingBox:function(){var e=a.f.create();return function(t,i){var r=(t[0]>=0?1:0)|(t[1]>=0?2:0)|(t[2]>=0?4:0),a=7&~r;return this.distanceToPlane(t,i.corner(a,e))>0?n.INSIDE:this.distanceToPlane(t,i.corner(r,e))<0?n.OUTSIDE:n.INTERSECT}}(),intersectsBoundingBox:function(e,t,i){return this.intersectsOrContainsBoundingBox(e,t,i)===n.INTERSECT},intersectOrContainsVertices:function(e,t){for(var i=-1,r=0;r<t.length;r++){var a=this.distanceToPlane(e,t[r]);if(a<0){if(1===i)return n.INTERSECT;i=2}else{if(!(a>0))return n.INTERSECT;if(2===i)return n.INTERSECT;i=1}}return i>0?n.INSIDE:n.OUTSIDE},intersectVertices:function(e,t){return this.intersectOrContainsVertices(e,t)===n.INTERSECT}});t.a=n},function(e,t,i){"use strict";var r=i(9),a=i(10),n=i(215),o=i(143),s=i(680),u=function(e){void 0!==e&&this.setName(e),o.a.call(this),this._invBindInSkeletonSpace=a.c.create(),this._boneInSkeletonSpace=a.c.create(),this._boneBoundingBox=new n.a};r.a.createPrototypeNode(u,r.a.objectInherit(o.a.prototype,{getOrCreateDebugColor:function(){return this._boneColor?this._boneColor:(this._boneColor=a.f.fromValues(Math.random(),Math.random(),Math.random()),this._boneColor)},getBoneBoundingBox:function(){return this._boneBoundingBox},setBoneBoundingBox:function(e){this._boneBoundingBox=e},getMatrixInSkeletonSpace:function(){return this._boneInSkeletonSpace},getInvBindMatrixInSkeletonSpace:function(){return this._invBindInSkeletonSpace},setMatrixInSkeletonSpace:function(e){a.c.copy(this._boneInSkeletonSpace,e)},setInvBindMatrixInSkeletonSpace:function(e){a.c.copy(this._invBindInSkeletonSpace,e)},getBoneParent:function(){for(var e=this.getParents(),t=0,i=e.length;t<i;t++){if(e[t].getTypeID()===u.getTypeID())return e[t]}},setDefaultUpdateCallback:function(e){this.addUpdateCallback(new s.a(void 0!==e?e:this.getName()))}}),"osgAnimation","Bone"),t.a=u},function(e,t,i){"use strict";var r=i(9),a=i(10),n=i(121),o=i(21),s=i(182),u=i(398),l=i(1020),c=i(1022),h=i(547),d=i(543),p=function(){n.a.call(this),this._shape=null,this.addUpdateCallback(new l.a),this._root=void 0,this._pathToRoot=void 0,this._isAnimatedPath=!1,this._boneNameID={},this._matrixFromSkeletonToGeometry=a.c.create(),this._invMatrixFromSkeletonToGeometry=a.c.create(),this._rigTransformImplementation=new c.a,this._geometry=void 0,this._stateSetAnimation=new s.a,this._needToComputeMatrix=!0};r.a.createPrototypeNode(p,r.a.objectInherit(n.a.prototype,{getStateSetAnimation:function(){return this._stateSetAnimation},getSkeleton:function(){return this._root},setSkeleton:function(e){this._root=e},setPathToSkeleton:function(e){this._pathToRoot=e,this._isAnimatedPath=h.a.checkPathIsAnimated(e)},setNeedToComputeMatrix:function(e){this._needToComputeMatrix=e},getNeedToComputeMatrix:function(){return this._needToComputeMatrix},computeBoundingBox:function(e){e.init();var t=this.getVertexAttributeList().Vertex,i=this.getVertexAttributeList().Weights;if(t&&i&&t.getElements()&&t.getItemSize()>2){for(var r=i.getElements(),a=t.getElements(),n=t.getItemSize(),o=e.getMin(),s=e.getMax(),u=o[0],l=o[1],c=o[2],h=s[0],d=s[1],p=s[2],f=0,m=0,g=a.length;f<g;f+=n,m+=4)if(0===r[f]&&0===r[f+1]&&0===r[f+2]&&0===r[f+3]){var _=a[f],v=a[f+1],b=a[f+2];_<u&&(u=_),_>h&&(h=_),v<l&&(l=v),v>d&&(d=v),b<c&&(c=b),b>p&&(p=b)}o[0]=u,o[1]=l,o[2]=c,s[0]=h,s[1]=d,s[2]=p}return e},computeMatrixFromRootSkeleton:function(){if(!this._root)return void o.a.warn("Warning "+this.className()+".computeMatrixFromRootSkeleton if you have this message it means you miss to call buildTransformer( root ), or your RigGeometry ("+this.getName()+") is not attached to a Skeleton subgraph");a.c.identity(this._matrixFromSkeletonToGeometry),d.a.computeLocalToWorld(this._pathToRoot,!0,this._matrixFromSkeletonToGeometry),a.c.invert(this._invMatrixFromSkeletonToGeometry,this._matrixFromSkeletonToGeometry),this._isAnimatedPath||(this._needToComputeMatrix=!1)},getMatrixFromSkeletonToGeometry:function(){return this._matrixFromSkeletonToGeometry},getInvMatrixFromSkeletonToGeometry:function(){return this._invMatrixFromSkeletonToGeometry},getSourceGeometry:function(){return this._geometry},setSourceGeometry:function(e){this._geometry=e},getBoneNameID:function(){return this._boneNameID},setBoneNameID:function(e){this._boneNameID=e},mergeChildrenVertexAttributeList:function(){this._geometry instanceof u.a&&this._geometry.mergeChildrenVertexAttributeList();var e=this._geometry.getVertexAttributeList();n.a.appendVertexAttributeToList(e,this.getVertexAttributeList())},mergeChildrenData:function(){this.mergeChildrenVertexAttributeList();var e=this._geometry.getPrimitiveSetList();this.getPrimitiveSetList().length=0;for(var t=0,i=e.length;t<i;t++)this.getPrimitiveSetList()[t]=e[t];this.getStateSet()&&console.error("A stateset in the rig is already present : "+this.getStateSet()),this.setStateSet(this._geometry.getStateSet())},update:function(){this._rigTransformImplementation.update(this)},computeTransformedVertex:function(e,t){t=t||a.f.create();var i=this.getVertexAttributeList(),r=i.Weights.getElements(),n=i.Bones.getElements(),o=0,s=0,u=0;if(this._geometry.computeTransformedVertex)this._geometry.computeTransformedVertex(e,t),o=t[0],s=t[1],u=t[2];else{var l=i.Vertex.getElements();o=l[3*e],s=l[3*e+1],u=l[3*e+2]}for(var c=4*e,h=this._rigTransformImplementation._skinningAttribute.getMatrixPalette(),d=0,p=0,f=0,m=0,g=0,_=0,v=0,b=0,y=0,x=0,S=0,M=0,w=0,T=!1,C=0;C<4;++C){var E=r[c+C];if(0!==E){var L=12*n[c+C];d+=h[L+0]*E,m+=h[L+1]*E,v+=h[L+2]*E,x+=h[L+3]*E,p+=h[L+4]*E,g+=h[L+5]*E,b+=h[L+6]*E,S+=h[L+7]*E,f+=h[L+8]*E,_+=h[L+9]*E,y+=h[L+10]*E,M+=h[L+11]*E,w+=E,T=!0}}T||(t[0]=o,t[1]=s,t[2]=u);var P=1/w;return t[0]=(d*o+m*s+v*u+x)*P,t[1]=(p*o+g*s+b*u+S)*P,t[2]=(f*o+_*s+y*u+M)*P,t},computeTransformedVertices:function(){for(var e=this.getVertexAttributeList(),t=this._geometry.computeTransformedVertices?this._geometry.computeTransformedVertices():e.Vertex.getElements(),i=e.Weights.getElements(),r=e.Bones.getElements(),a=this._riggedVerts||new Float32Array(t.length),n=this._rigTransformImplementation._skinningAttribute.getMatrixPalette(),o=0,s=0,u=t.length;o<u;o+=3,s+=4){var l,c=0,h=0,d=0,p=0,f=0,m=0,g=0,_=0,v=0,b=0,y=0,x=0,S=0,M=!1,w=i[s];0!==w&&(l=12*r[s],c+=n[l+0]*w,p+=n[l+1]*w,g+=n[l+2]*w,b+=n[l+3]*w,h+=n[l+4]*w,f+=n[l+5]*w,_+=n[l+6]*w,y+=n[l+7]*w,d+=n[l+8]*w,m+=n[l+9]*w,v+=n[l+10]*w,x+=n[l+11]*w,S+=w,M=!0),w=i[s+1],0!==w&&(l=12*r[s+1],c+=n[l+0]*w,p+=n[l+1]*w,g+=n[l+2]*w,b+=n[l+3]*w,h+=n[l+4]*w,f+=n[l+5]*w,_+=n[l+6]*w,y+=n[l+7]*w,d+=n[l+8]*w,m+=n[l+9]*w,v+=n[l+10]*w,x+=n[l+11]*w,S+=w,M=!0),w=i[s+2],0!==w&&(l=12*r[s+2],c+=n[l+0]*w,p+=n[l+1]*w,g+=n[l+2]*w,b+=n[l+3]*w,h+=n[l+4]*w,f+=n[l+5]*w,_+=n[l+6]*w,y+=n[l+7]*w,d+=n[l+8]*w,m+=n[l+9]*w,v+=n[l+10]*w,x+=n[l+11]*w,S+=w,M=!0),w=i[s+3],0!==w&&(l=12*r[s+3],c+=n[l+0]*w,p+=n[l+1]*w,g+=n[l+2]*w,b+=n[l+3]*w,h+=n[l+4]*w,f+=n[l+5]*w,_+=n[l+6]*w,y+=n[l+7]*w,d+=n[l+8]*w,m+=n[l+9]*w,v+=n[l+10]*w,x+=n[l+11]*w,S+=w,M=!0);var T=t[o],C=t[o+1],E=t[o+2];if(M){var L=1/S;a[o]=(c*T+p*C+g*E+b)*L,a[o+1]=(h*T+f*C+_*E+y)*L,a[o+2]=(d*T+m*C+v*E+x)*L}else a[o]=T,a[o+1]=C,a[o+2]=E}return a}}),"osgAnimation","RigGeometry"),t.a=p},function(e,t,i){"use strict";var r=i(10),a=i(400),n=i(795),o={},s=function(e,t,i,r,a,n){var o=i[0],s=i[i.length-1];return n.start=o,n.keys=t,n.end=s,n.times=i,n.type=e,n.duration=s-o,n.target=r,n.name=a,n},u=function(e,t,i,r,a){return s(n.a.Vec3,e,t,i,r,a||{})},l=function(e,t,i,r,a){return s(n.a.Float,e,t,i,r,a||{})},c=function(e,t,i,r,a){return s(n.a.Quat,e,t,i,r,a||{})},h=function(e,t,i,r,a){return s(n.a.QuatSlerp,e,t,i,r,a||{})},d=function(e,t,i,r,a){return s(n.a.FloatCubicBezier,e,t,i,r,a||{})},p=function(e,t,i,r,a){return s(n.a.Vec3CubicBezier,e,t,i,r,a||{})},f={create:function(){return 0}},m={create:function(){return r.f.create32()}},g={create:function(){return r.d.create32()}},_=function(e,t){return{channel:t,value:e.create(),targetID:a.a.InvalidTargetID,weight:1,key:0,start:0,end:0}},v=function(e){return _(m,e)},b=function(e){return _(g,e)},y=function(e){return _(f,e)},x=function(e){return _(f,e)},S=function(e){return _(m,e)},M=function(e){return o[e.type](e)};o.createInstanceChannel=M,o.createInstanceVec3Channel=v,o.createInstanceQuatChannel=b,o.createInstanceQuatSlerpChannel=b,o.createInstanceFloatChannel=y,o.createInstanceFloatCubicBezierChannel=x,o.createInstanceVec3CubicBezierChannel=S,o.createVec3Channel=u,o.createQuatChannel=c,o.createQuatSlerpChannel=h,o.createFloatChannel=l,o.createFloatCubicBezierChannel=d,o.createVec3CubicBezierChannel=p,o[n.a.Vec3]=v,o[n.a.Quat]=b,o[n.a.QuatSlerp]=b,o[n.a.Float]=y,o[n.a.FloatCubicBezier]=x,o[n.a.Vec3CubicBezier]=S,o.ChannelType=n.a,t.a=o},function(e,t,i){"use strict";var r=function(e){this._target=e,this._supportedEvents=[]};r.prototype={supportsEvent:function(e){for(var t=0;t<this._supportedEvents.length;t++){var i=this._supportedEvents[t];if(0===e.indexOf(i))return!0}return!1},setInputManager:function(e){this._inputManager=e}},t.a=r},function(e,t,i){"use strict";function r(e,t){t=t||{};for(var i in e)t[i]=e[i];return t}function a(e,t,i){var r=i?" !== ":" === ",a=i?" || ":" && ",n=i?"!":"",o=i?"":"!";switch(e){case"null":return t+r+"null";case"array":return n+"Array.isArray("+t+")";case"object":return"("+n+t+a+"typeof "+t+r+'"object"'+a+o+"Array.isArray("+t+"))";case"integer":return"(typeof "+t+r+'"number"'+a+o+"("+t+" % 1)"+a+t+r+t+")";default:return"typeof "+t+r+'"'+e+'"'}}function n(e,t){switch(e.length){case 1:return a(e[0],t,!0);default:var i="",r=s(e);r.array&&r.object&&(i=r.null?"(":"(!"+t+" || ",i+="typeof "+t+' !== "object")',delete r.null,delete r.array,delete r.object),r.number&&delete r.integer;for(var n in r)i+=(i?" && ":"")+a(n,t,!0);return i}}function o(e,t){if(Array.isArray(t)){for(var i=[],r=0;r<t.length;r++){var a=t[r];T[a]?i[i.length]=a:"array"===e&&"array"===a&&(i[i.length]=a)}if(i.length)return i}else{if(T[t])return[t];if("array"===e&&"array"===t)return["array"]}}function s(e){for(var t={},i=0;i<e.length;i++)t[e[i]]=!0;return t}function u(e){return"number"==typeof e?"["+e+"]":C.test(e)?"."+e:"['"+l(e)+"']"}function l(e){return e.replace(E,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function c(e,t){t+="[^0-9]";var i=e.match(new RegExp(t,"g"));return i?i.length:0}function h(e,t,i){return t+="([^0-9])",i=i.replace(/\$/g,"$$$$"),e.replace(new RegExp(t,"g"),i+"$1")}function d(e){return e.replace(L,"").replace(P,"").replace(A,"if (!($1))")}function p(e,t){var i=e.match(D);return i&&2==i.length&&(e=t?e.replace(k,"").replace(F,N):e.replace(O,"").replace(R,I)),i=e.match(V),i&&3===i.length?e.replace(B,""):e}function f(e,t){if("boolean"==typeof e)return!e;for(var i in e)if(t[i])return!0}function m(e,t,i){if("boolean"==typeof e)return!e&&"not"!=i;for(var r in e)if(r!=i&&t[r])return!0}function g(e){return"'"+l(e)+"'"}function _(e,t,i,r){return y(e,i?"'/' + "+t+(r?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):r?"'[' + "+t+" + ']'":"'[\\'' + "+t+" + '\\']'")}function v(e,t,i){return y(e,g(i?"/"+M(t):u(t)))}function b(e,t,i){var r,a,n,o;if(""===e)return"rootData";if("/"==e[0]){if(!U.test(e))throw new Error("Invalid JSON-pointer: "+e);a=e,n="rootData"}else{if(!(o=e.match(j)))throw new Error("Invalid JSON-pointer: "+e);if(r=+o[1],"#"==(a=o[2])){if(r>=t)throw new Error("Cannot access property/index "+r+" levels up, current level is "+t);return i[t-r]}if(r>t)throw new Error("Cannot access data "+r+" levels up, current level is "+t);if(n="data"+(t-r||""),!a)return n}for(var s=n,l=a.split("/"),c=0;c<l.length;c++){var h=l[c];h&&(n+=u(w(h)),s+=" && "+n)}return s}function y(e,t){return'""'==e?t:(e+" + "+t).replace(/' \+ '/g,"")}function x(e){return w(decodeURIComponent(e))}function S(e){return encodeURIComponent(M(e))}function M(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}function w(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}e.exports={copy:r,checkDataType:a,checkDataTypes:n,coerceToTypes:o,toHash:s,getProperty:u,escapeQuotes:l,equal:i(698),ucs2length:i(1101),varOccurences:c,varReplace:h,cleanUpCode:d,finalCleanUpCode:p,schemaHasRules:f,schemaHasRulesExcept:m,toQuotedString:g,getPathExpr:_,getPath:v,getData:b,unescapeFragment:x,unescapeJsonPointer:w,escapeFragment:S,escapeJsonPointer:M};var T=s(["string","number","integer","boolean","null"]),C=/^[a-z$_][a-z$_0-9]*$/i,E=/'|\\/g,L=/else\s*{\s*}/g,P=/if\s*\([^)]+\)\s*\{\s*\}(?!\s*else)/g,A=/if\s*\(([^)]+)\)\s*\{\s*\}\s*else(?!\s*if)/g,D=/[^v.]errors/g,O=/var errors = 0;|var vErrors = null;|validate.errors = vErrors;/g,k=/var errors = 0;|var vErrors = null;/g,R="return errors === 0;",I="validate.errors = null; return true;",F=/if \(errors === 0\) return data;\s*else throw new ValidationError\(vErrors\);/,N="return data;",V=/[^A-Za-z_$]rootData[^A-Za-z0-9_$]/g,B=/if \(rootData === undefined\) rootData = data;/,U=/^\/(?:[^~]|~0|~1)*$/,j=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/},function(e,t,i){"use strict";var r=i(5),a=i(113),n=i(93),o=r.a.osg,s=function(){o.StateAttribute.call(this),this._channelMapping={},this._materialModel=void 0,this._stateSetContext=void 0,this._additive=!1,this._depthWrite=!0,this._castShadows=!0,this._hashes=["",""],this._dirtyUniforms=!0,this._activeChannels=[]};s.SHADING_COMPILER=0,s.EARLYZ_COMPILER=1,s.SHADOWCAST_COMPILER=2,s.WIREFRAME_COMPILER=3,s.CURRENT_COMPILER=s.SHADING_COMPILER,s.compilerChannels=[],s.compilerChannels[s.SHADING_COMPILER]=a.a,s.compilerChannels[s.EARLYZ_COMPILER]=["Opacity","Displacement","SubsurfaceScattering"],s.compilerChannels[s.SHADOWCAST_COMPILER]=["Displacement","Opacity"],s.compilerChannels[s.WIREFRAME_COMPILER]=["Displacement"],s.hasVertexColor=!1,s.hasVertexAlpha=!1,o.createPrototypeStateAttribute(s,o.objectInherit(o.StateAttribute.prototype,{attributeType:"SketchfabMaterial",dirtyMaterial:function(){for(var e=this._hashes.length,t=0;t<e;++t)this._hashes[t]="";this._dirtyUniforms=!0},getHash:function(){if(!this._materialModel)return"";var e=this._hashes[s.CURRENT_COMPILER];if(e)return e;e=this.attributeType,s.CURRENT_COMPILER!==s.WIREFRAME_COMPILER&&(e+=this.getVertexAlphaEnable()?"1":"0"),s.CURRENT_COMPILER===s.SHADING_COMPILER&&(e+=this.getShadeless()?"1":"0",e+=this.getVertexColorEnable()?"1":"0",e+=this.getHasOnlyPoints()?"1":"0",e+="srgb"===this.getVertexColorColorSpace()?"1":"0",e+=n.a.get("hasSsr")?"1":"0");for(var t=s.CURRENT_COMPILER===s.SHADOWCAST_COMPILER,i=this._materialModel.getChannels(),r=s.compilerChannels[s.CURRENT_COMPILER],a=r.length,o=this._channelMapping,u=0;u<a;++u){var l=r[u],c=i[l];if(c.isEnableEffective())if(!t||this._castShadows){var h=o[l];e+=".",e+=h<0?"":h,e+=c.getShaderHash(),e+=this.getChannelPacking(l)}else e+=".0";else e+=".0"}return this._hashes[s.CURRENT_COMPILER]=e,e},setMaterialModel:function(e){this._materialModel=e},setStateSetContext:function(e){this._stateSetContext=e},setChannelMapping:function(e,t){this._channelMapping[e]=t},getChannelPacking:function(e){return this._stateSetContext?this._stateSetContext.getChannelPacking(e):""},updateOpacity:function(){this._additive=!1,this._depthWrite=!0,this._castShadows=!0;var e=this._materialModel.getChannels().Opacity;if(e.isEffective()){var t=e.getTransparency();if("alphaMask"!==t&&"dithering"!==t){if("additive"===t)return this._additive=!0,this._depthWrite=!1,void(this._castShadows=!1);var i=!1;return 1===e.getFactor()&&(i=e.getTextureModel()||this.getVertexAlphaEnable()),i?void 0:(this._depthWrite=!1,void(this._castShadows=!1))}}},cloneType:function(){return new s},getType:function(){return this.attributeType},getTypeMember:function(){return this.attributeType},getMaterialModel:function(){return this._materialModel},getShadeless:function(){return this._materialModel&&this._materialModel.get("shadeless")},getReflection:function(){return this._materialModel&&this._materialModel.get("reflection")},getVertexColorEnable:function(){return this._materialModel&&this._materialModel.get("vertexColorEnable")},getVertexAlphaEnable:function(){return this._materialModel&&this._materialModel.get("vertexAlphaEnable")},getVertexColorColorSpace:function(){return this._materialModel&&this._materialModel.get("vertexColorColorSpace")},getCullFace:function(){return this._materialModel&&this._materialModel.get("cullFace")},getHasOnlyPoints:function(){return this._materialModel&&this._materialModel.hasOnlyPoints()},getAdditive:function(){return this._additive},getDepthWrite:function(){return this._depthWrite},getCastShadows:function(){return this._castShadows},getChannelMapping:function(e){return this._channelMapping[e]},getOrCreateUniforms:function(){if(s.uniforms)return s.uniforms;var e=s.uniforms={};e.uReflection=o.Uniform.createFloat("uReflection");for(var t=i(703).default,r=a.a.length,n=0;n<r;++n){var u=a.a[n],l=t[u].model;l.prototype.addUniforms.call(l,e,u)}return e},_cacheChannelUniforms:function(){var e=this.getOrCreateUniforms(),t=this._materialModel.getChannels(),i=a.a.length,r=this._activeChannels;r.length=0;for(var n=0;n<i;++n){var o=t[a.a[n]];o.isEnableEffective()&&(o.cacheUniforms(e),r.push(o))}},apply:function(){if(this._materialModel){this._dirtyUniforms&&(this._dirtyUniforms=!1,this._cacheChannelUniforms());this.getOrCreateUniforms().uReflection.setFloat(this.getReflection());for(var e=this._activeChannels,t=e.length,i=0;i<t;++i)e[i].updateUniforms()}}}),"osgSketchfab","Material"),t.a=s},function(e,t,i){"use strict";i.d(t,"a",function(){return c}),i.d(t,"d",function(){return d}),i.d(t,"b",function(){return p}),i.d(t,"c",function(){return m});var r,a=i(5),n=i(144),o=i(612),s=i(119),u=a.a.osg,l=a.a.osgAnimation,c=function(e){r=e.getViewerWebGL().getRootModel()},h=function(){var e=u.vec3.create(),t=u.mat4.create();return function(i){var a=i.get("lastComputedScenePosition"),o=i.get("geometryUid");if(o<0)return u.vec3.copy(a,i.get("position"));var s=n.a.uidGeometryMap[o];if(!s)return u.vec3.copy(a,i.get("position"));var l=i.get("indices"),c=l[0],h=l[1],d=l[2];if(s.getWorldMatrix(r,t),c<0)return u.vec3.transformMat4(a,i.get("localPosition"),t);var p=s.getVertexAttributeList().Vertex.getElements(),f=p.length/3;if(c>=f||h>=f||d>=f)return u.vec3.copy(a,i.get("position"));var m=i.get("barycentricWeights"),g=m[0],_=m[1],v=m[2];if(u.vec3.init(a),s.computeTransformedVertex)s.computeTransformedVertex(c,e),u.vec3.scaleAndAdd(a,a,e,g),h>=0&&(s.computeTransformedVertex(h,e),u.vec3.scaleAndAdd(a,a,e,_)),d>=0&&(s.computeTransformedVertex(d,e),u.vec3.scaleAndAdd(a,a,e,v));else{var b=3*c;if(a[0]=g*p[b],a[1]=g*p[b+1],a[2]=g*p[b+2],h>=0){var y=3*h;a[0]+=_*p[y],a[1]+=_*p[y+1],a[2]+=_*p[y+2]}if(d>=0){var x=3*d;a[0]+=v*p[x],a[1]+=v*p[x+1],a[2]+=v*p[x+2]}}return u.vec3.transformMat4(a,a,t),a}}(),d=function(e){h(e);var t=e.get("lastComputedScenePosition"),i=e.get("lastComputedWorldPosition");return s.a.getWorldPositionFromScenePoint(t,i)},p=function(e,t){s.a.getScenePositionFromHit(t,e.get("position"));var i=t._nodePath[t._nodePath.length-1],r=void 0!==i._uniqueID?i._uniqueID:-1,a=i instanceof l.RigGeometry||i instanceof l.MorphGeometry,n=a||Object(o.a)(t._nodePath);e.set("geometryUid",n?r:-1);var u=e.get("localPosition");u[0]=n?t._localIntersectionPoint[0]:0,u[1]=n?t._localIntersectionPoint[1]:0,u[2]=n?t._localIntersectionPoint[2]:0;var c=e.get("indices");c[0]=a?t._i1:-1,c[1]=a?t._i2:-1,c[2]=a?t._i3:-1;var h=e.get("barycentricWeights");h[0]=a?t._r1:0,h[1]=a?t._r2:0,h[2]=a?t._r3:0},f=function(e){e.set("geometryUid",-1),u.vec3.set(e.get("indices"),-1,-1,-1),u.vec3.init(e.get("barycentricWeights")),u.vec3.init(e.get("localPosition"))},m=function(e,t){var i=e.get("position");s.a.getScenePositionFromWorldPoint(t,i),u.vec3.copy(e.get("lastComputedScenePosition"),i),u.vec3.copy(e.get("lastComputedWorldPosition"),t),f(e)}},function(e,t,i){!function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/logo.jinja"]=function(){function e(e,t,r,a,n){var o=null,s=null,u="";try{var l=null,c=a.makeMacro([],["headerStyle"],function(n){var o=r;r=new a.Frame,n=n||{},n.hasOwnProperty("caller")&&r.set("caller",n.caller),r.set("headerStyle",n.hasOwnProperty("headerStyle")?n.headerStyle:"normal");var s="";return s+='\n<div class="logo">\n    <a class="link" href="/">\n        ',"inverted"==a.contextOrFrameLookup(t,r,"headerStyle")?(s+='\n        <img src="',s+=a.suppressValue(i(741),e.opts.autoescape),s+='" width="121" height="30" class="visual" alt="Sketchfab">\n        '):(s+='\n        <img src="',s+=a.suppressValue(i(742),e.opts.autoescape),s+='" width="121" height="30" class="visual" alt="Sketchfab">\n        '),s+="\n    </a>\n</div>\n",r=o,new a.SafeString(s)});t.addExport("header_logo"),t.setVariable("header_logo",c),u+="\n\n\n";var h=a.makeMacro([],[],function(i){var n=r;r=new a.Frame,i=i||{},i.hasOwnProperty("caller")&&r.set("caller",i.caller);var u="";return u+='\n<div class="logo">\n    <a href="/">\n        ',u+=a.suppressValue((o=16,s=13,a.callWrap(a.contextOrFrameLookup(t,r,"logo"),"logo",t,[96,20])),e.opts.autoescape),u+="\n    </a>\n</div>\n",r=n,new a.SafeString(u)});t.addExport("responsive_header_logo"),t.setVariable("responsive_header_logo",h),u+="\n\n\n";var d=a.makeMacro(["width","height"],["options"],function(i,n,o){var s=r;r=new a.Frame,o=o||{},o.hasOwnProperty("caller")&&r.set("caller",o.caller),r.set("width",i),r.set("height",n),r.set("options",o.hasOwnProperty("options")?o.options:{});var u="";u+="\n\n    ";var l;if(l=e.getFilter("merge").call(t,{brand:!0,color:"#555555"},a.contextOrFrameLookup(t,r,"options")),r.set("options",l,!0),r.topLevel&&t.setVariable("options",l),r.topLevel&&t.addExport("options",l),u+="\n\n    ",a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"brand")){u+="\n        ";var c;c=121,r.set("view_width",c,!0),r.topLevel&&t.setVariable("view_width",c),r.topLevel&&t.addExport("view_width",c),u+="\n    "}else{u+="\n        ";var h;h=25,r.set("view_width",h,!0),r.topLevel&&t.setVariable("view_width",h),r.topLevel&&t.addExport("view_width",h),u+="\n    "}return u+='\n\n    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve"\n         x="0" y="0" width="',u+=a.suppressValue(i,e.opts.autoescape),u+='" height="',u+=a.suppressValue(n,e.opts.autoescape),u+='"\n         viewBox="0 0 ',u+=a.suppressValue(a.contextOrFrameLookup(t,r,"view_width"),e.opts.autoescape),u+=' 25"\n         enable-background="new 0 0 ',u+=a.suppressValue(a.contextOrFrameLookup(t,r,"view_width"),e.opts.autoescape),u+=' 25">\n\n        ',a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"brand")&&(u+='\n            <g id="logo-text">\n                <path fill="',u+=a.suppressValue(a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"color"),e.opts.autoescape),u+='"\n                    d="M36.471,7.719c-1.526,0-2.289,0.504-2.289,1.512c0,0.448,0.189,0.791,0.567,1.029\n                       c0.378,0.238,1.263,0.582,2.656,1.029c1.393,0.448,2.37,0.956,2.93,1.522c0.56,0.567,0.84,1.438,0.84,2.615\n                       c0,1.498-0.455,2.632-1.365,3.401c-0.911,0.771-2.1,1.155-3.57,1.155c-1.092,0-2.429-0.168-4.011-0.504l-0.756-0.147l0.294-2.247\n                       c1.876,0.253,3.311,0.379,4.305,0.379c1.484,0,2.226-0.616,2.226-1.849c0-0.447-0.171-0.798-0.515-1.05s-1.025-0.525-2.047-0.819\n                       c-1.624-0.462-2.769-1.011-3.434-1.648s-0.998-1.522-0.998-2.657c0-1.428,0.434-2.492,1.302-3.192c0.868-0.7,2.058-1.05,3.57-1.05\n                       c1.036,0,2.352,0.14,3.948,0.42l0.756,0.147L40.65,8.056C38.676,7.832,37.283,7.719,36.471,7.719z"\n                />\n                <path fill="',u+=a.suppressValue(a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"color"),e.opts.autoescape),u+='"\n                    d="M46.068,19.731h-2.814v-14.7h2.814v8.358l1.071-0.189l2.079-3.969h3.15l-2.73,4.977l2.877,5.523h-3.171\n                       l-2.121-4.095l-1.155,0.188V19.731z"\n                />\n                <path fill="',u+=a.suppressValue(a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"color"),e.opts.autoescape),u+='"\n                    d="M56.705,17.075c0.329,0.287,0.801,0.431,1.417,0.431c1.302,0,2.464-0.042,3.486-0.126l0.589-0.063\n                       l0.041,2.079c-1.61,0.392-3.066,0.588-4.368,0.588c-1.582,0-2.73-0.42-3.444-1.26c-0.714-0.84-1.071-2.205-1.071-4.095\n                       c0-3.766,1.547-5.649,4.641-5.649c3.052,0,4.578,1.582,4.578,4.746l-0.209,1.953H56.19C56.204,16.322,56.375,16.788,56.705,17.075z\n                       M59.802,13.536c0-0.84-0.133-1.424-0.399-1.753c-0.266-0.329-0.732-0.493-1.396-0.493c-0.666,0-1.134,0.171-1.407,0.514\n                       c-0.273,0.343-0.417,0.921-0.431,1.732H59.802z"\n                />\n                <path fill="',u+=a.suppressValue(a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"color"),e.opts.autoescape),u+='"\n                    d="M70.407,11.625h-2.583v4.305c0,0.42,0.011,0.718,0.031,0.893c0.021,0.175,0.098,0.325,0.231,0.451\n                       c0.133,0.126,0.339,0.189,0.619,0.189l1.596-0.042l0.126,2.246c-0.938,0.211-1.651,0.315-2.142,0.315\n                       c-1.26,0-2.121-0.283-2.583-0.851c-0.462-0.566-0.693-1.613-0.693-3.14v-4.368h-1.238V9.231h1.238V6.312h2.814v2.919h2.583V11.625z"\n                />\n                <path fill="',u+=a.suppressValue(a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"color"),e.opts.autoescape),u+='"\n                    d="M76.161,8.979c0.729,0,1.659,0.112,2.794,0.336l0.566,0.126l-0.084,2.226\n                       c-1.106-0.112-1.925-0.168-2.457-0.168c-0.966,0-1.606,0.207-1.921,0.62c-0.315,0.413-0.473,1.193-0.473,2.341\n                       c0,1.148,0.157,1.937,0.473,2.363c0.314,0.427,0.962,0.641,1.942,0.641l2.436-0.168l0.084,2.246\n                       c-1.498,0.295-2.639,0.441-3.423,0.441c-1.554,0-2.671-0.438-3.35-1.312s-1.019-2.278-1.019-4.211c0-1.932,0.35-3.328,1.05-4.189\n                       S74.607,8.979,76.161,8.979z"\n                />\n                <path fill="',u+=a.suppressValue(a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"color"),e.opts.autoescape),u+='"\n                    d="M84.414,19.731H81.6v-14.7h2.814v4.704c0.966-0.504,1.834-0.756,2.604-0.756c1.4,0,2.366,0.413,2.898,1.239\n                       c0.531,0.826,0.798,2.1,0.798,3.822v5.691h-2.814v-5.628c0-0.882-0.104-1.536-0.314-1.963s-0.63-0.641-1.26-0.641\n                       c-0.546,0-1.093,0.084-1.639,0.252l-0.272,0.084V19.731z"\n                />\n                <path fill="',u+=a.suppressValue(a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"color"),e.opts.autoescape),u+='"\n                    d="M96.531,11.625v8.106h-2.814v-8.106h-1.134V9.231h1.134V8.77c0-1.512,0.224-2.555,0.672-3.129\n                       s1.246-0.861,2.395-0.861c0.504,0,1.155,0.07,1.953,0.21l0.44,0.063l-0.042,2.289c-0.616-0.028-1.134-0.042-1.554-0.042\n                       s-0.7,0.112-0.84,0.336c-0.141,0.224-0.21,0.609-0.21,1.155v0.441h2.541v2.394H96.531z"\n                />\n                <path fill="',u+=a.suppressValue(a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"color"),e.opts.autoescape),u+='"\n                    d="M108.753,12.507v4.368c0.028,0.337,0.084,0.571,0.168,0.704s0.259,0.228,0.525,0.283l-0.084,2.121\n                       c-0.714,0-1.285-0.049-1.712-0.146c-0.427-0.099-0.857-0.295-1.291-0.589c-1.008,0.49-2.037,0.735-3.087,0.735\n                       c-2.171,0-3.255-1.147-3.255-3.444c0-1.119,0.301-1.914,0.902-2.383c0.603-0.469,1.526-0.746,2.772-0.83l2.247-0.168v-0.651\n                       c0-0.434-0.099-0.731-0.294-0.893c-0.196-0.161-0.512-0.241-0.945-0.241l-3.948,0.168l-0.084-1.953\n                       c1.498-0.406,2.923-0.609,4.273-0.609c1.352,0,2.324,0.28,2.919,0.84C108.456,10.379,108.753,11.276,108.753,12.507z\n                       M104.028,15.279c-0.784,0.07-1.176,0.49-1.176,1.26c0,0.771,0.343,1.155,1.028,1.155c0.532,0,1.113-0.084,1.743-0.252l0.315-0.084\n                       v-2.247L104.028,15.279z"\n                />\n                <path fill="',u+=a.suppressValue(a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"color"),e.opts.autoescape),u+='"\n                    d="M116.522,8.979c1.47,0,2.545,0.402,3.224,1.208s1.019,2.244,1.019,4.316c0,2.071-0.392,3.503-1.176,4.294\n                       s-2.136,1.187-4.053,1.187c-0.603,0-1.701-0.07-3.298-0.21l-0.798-0.084V5.031h2.814v4.515\n                       C115.15,9.168,115.906,8.979,116.522,8.979z M115.536,17.464c0.938,0,1.567-0.228,1.89-0.683s0.482-1.271,0.482-2.447\n                       c0-1.89-0.588-2.834-1.764-2.834c-0.56,0-1.092,0.07-1.596,0.21l-0.294,0.063v5.607C114.898,17.436,115.325,17.464,115.536,17.464z"\n                />\n            </g>\n        '),u+='\n\n        <g>\n            <path fill="#FFFFFF"\n                  d="M12.5,0.833C6.056,0.833,0.834,6.057,0.834,12.5S6.056,24.167,12.5,24.167S24.167,18.943,24.167,12.5\n                     S18.944,0.833,12.5,0.833z" />\n        </g>\n\n        <g id="logo-circle">\n            <path fill="#1CAAD9"\n                d="M12.5-0.029C5.596-0.029,0,5.568,0,12.472c0,6.904,5.596,12.501,12.5,12.501s12.5-5.597,12.5-12.501\n                   C25.001,5.568,19.405-0.029,12.5-0.029z M11.414,19.911L6.025,16.8v-6.276l5.389,2.911V19.911z M12.374,11.958l-6.376-3.38\n                   l6.376-3.682l6.377,3.682L12.374,11.958z M18.755,16.812l-5.369,3.1v-6.452l5.369-2.901V16.812z"\n            />\n        </g>\n\n    </svg>\n\n',r=s,new a.SafeString(u)});t.addExport("logo"),t.setVariable("logo",d),u+="\n",l?l.rootRenderFunc(e,t,r,a,n):n(null,u)}catch(e){n(a.handleError(e,o,s))}}return{root:e}}()}()},,,,,,function(e,t,i){"use strict";var r=i(12);t.a=r.a.extend({})},,,,function(e,t){e.exports={skfbWhite:"#ffffff",skfbRed:"#cc211f",skfbBrightRed:"#f02624",skfbLightBlue:"#49cdf8",skfbBlue:"#1caad9",skfbDarkBlue:"#1c88bb",skfbLightYellow:"#ffe9b4",skfbYellow:"#fed600",skfbOrange:"#ff9e3a",skfbGreen:"#35cba7",skfbBrightGreen:"#1ac95d",skfbPurple:"#df1660",skfbBlack:"#222222",skfbGrey0:"#555555",skfbGrey1:"#888888",skfbGrey2:"#999999",skfbGrey3:"#cccccc",skfbGrey4:"#dddddd",skfbGrey5:"#e7e7e7",skfbGrey6:"#f2f2f2",skfbEditorGrey0:"#000000",skfbEditorGrey1:"#1a1a1a",skfbEditorGrey2:"#333333",skfbEditorGrey3:"#595959",skfbEditorGrey4:"#666666",skfbEditorGrey5:"#777777",skfbEditorGrey6:"#888888",skfbEditorGrey7:"#cccccc",containerInfoBg:"#ddf6fa",containerInfoBorder:"#8bdded",containerWarningBg:"#ffe9b4",containerWarningBorder:"#fed600",containerDangerBg:"#f6d3d6",containerDangerBorder:"#e07881",colorPositive:"#1ac95d",colorError:"#db6f6f",colorRestricted:"#cc211f",colorDanger:"#cc211f",colorWarning:"#fed600",colorStaff:"#ff9e3a",colorMaster:"#35cba7",websiteBackgroundColor:"#f2f2f2",websiteTopBackgroundColor:"white",websiteTopTextColor:"#222222",websiteTopHoverColor:"#1caad9",websiteTopSearchColor:"#999999",websiteTopSearchActiveColor:"black",websiteOddTextColor:"#555555",websiteOddLinkColor:"#1caad9",websiteOddHoverLinkColor:"#1c88bb",websiteEvenTextColor:"#eeeeee",websiteEvenLinkColor:"white",websiteEvenHoverLinkColor:"#f2f2f2",websiteFooterPrimaryColor:"#555555",websiteFooterSecondaryColor:"#999999",websiteSidebarIconColor:"#999999",editorColor:"#333333",editorImportantColor:"#0d0d0d",editorKeyColor:"#1a1a1a",editorMinorColor:"#4d4d4d",editorTrivialColor:"#595959",editorTextColor:"#cccccc",editorStrongColor:"white",editorBorderColor:"black",editorActiveColor:"#1caad9",editorScrollbarTrackColor:"#a3a3a3",editorScrollbarThumbColor:"#444444",viewerRadialBackgroundFrom:"#f2f2f2",viewerRadialBackgroundTo:"#b3b3b3",viewerPrimaryLoadingColor:"#1caad9",viewerSecondaryLoadingColor:"#1caad9",viewerBackgroundColor:"black",brandColor:"#1caad9",facebookColor:"#3a589a",twitterColor:"#00c4fc",googleplusColor:"#de4830",pinterestColor:"#ce1d21",linkedinColor:"#1884bc",instagramColor:"#125688",tumblrColor:"#36465d",redditColor:"#ff5700",mailColor:"#555555",websiteSuccessColor:"#00a317",storeColor:"#df1660",storeHoverColor:"#c81859",websiteStoreCheckoutGradient:"linear-gradient(45deg, #1caad9, #49cdf8)",labelColor:"#888888",dropdownArrowColor:"#b8b8b8",dropdownArrowColorHighlight:"#222222",linkColor:"#1caad9",linkHoverColor:"#1c88bb",privateLimitInfoBg:"#ffe9b4",privateLimitInfoBorder:"#fed600",privateLimitReachedBg:"#f6d3d6",privateLimitReachedBorder:"#e07881",colorProUser:"#00aad8",colorPremUser:"#007395",colorBizUser:"#003748",colorEntUser:"#222222",userFlagPro:"#00aad8",userFlagPrem:"#007395",userFlagBiz:"#003748",userFlagEnt:"#222222",userFlagStaff:"#ff9e3a",userFlagMaster:"#35cba7"}},function(e,t,i){i(33),i(24),i(421),i(28),i(459),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/viewer.jinja"]=function(){function e(e,t,r,a,n){var o=null,s=null,u="";try{var l=null;e.getTemplate("skfb_front/macros/buttons.jinja",!1,"skfb_front/macros/viewer.jinja",!1,function(c,h){if(c)return void n(c);h.getExported(function(c,h){if(c)return void n(c);if(!h.hasOwnProperty("star_like_button"))return void n(new Error("cannot import 'star_like_button'"));var d=h.star_like_button;t.setVariable("star_like_button",d),u+="\n",e.getTemplate("skfb_front/macros/model.jinja",!1,"skfb_front/macros/viewer.jinja",!1,function(c,h){if(c)return void n(c);h.getExported(function(c,h){if(c)return void n(c);if(!h.hasOwnProperty("model_name"))return void n(new Error("cannot import 'model_name'"));var d=h.model_name;t.setVariable("model_name",d),u+="\n",e.getTemplate("skfb_front/macros/popovers.jinja",!1,"skfb_front/macros/viewer.jinja",!1,function(c,h){if(c)return void n(c);h.getExported(function(c,h){if(c)return void n(c);if(!h.hasOwnProperty("share_popover"))return void n(new Error("cannot import 'share_popover'"));var d=h.share_popover;t.setVariable("share_popover",d),u+="\n",e.getTemplate("skfb_front/macros/user.jinja",!1,"skfb_front/macros/viewer.jinja",!1,function(c,h){if(c)return void n(c);h.getExported(function(c,h){if(c)return void n(c);if(!h.hasOwnProperty("user_name"))return void n(new Error("cannot import 'user_name'"));var d=h.user_name;t.setVariable("user_name",d),u+="\n",e.getTemplate("skfb_front/macros/user.jinja",!1,"skfb_front/macros/viewer.jinja",!1,function(c,h){if(c)return void n(c);h.getExported(function(c,h){if(c)return void n(c);if(!h.hasOwnProperty("user_avatar"))return void n(new Error("cannot import 'user_avatar'"));var d=h.user_avatar;t.setVariable("user_avatar",d),u+="\n",e.getTemplate("skfb_front/macros/logo.jinja",!1,"skfb_front/macros/viewer.jinja",!1,function(c,h){if(c)return void n(c);h.getExported(function(c,h){if(c)return void n(c);if(!h.hasOwnProperty("logo"))return void n(new Error("cannot import 'logo'"));var d=h.logo;t.setVariable("logo",d),u+="\n\n\n";var p=a.makeMacro(["authUser","model"],["options"],function(i,n,u){var l=r;r=new a.Frame,u=u||{},u.hasOwnProperty("caller")&&r.set("caller",u.caller),r.set("authUser",i),r.set("model",n),r.set("options",u.hasOwnProperty("options")?u.options:{});var c="";return c+='\n\n    <div class="titlebar">\n\n        <div class="summary">\n            ',a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiInfos")&&(c+='\n                <div class="avatar">\n                    <a target="_blank" href="/models/',c+=a.suppressValue(a.memberLookup(n,"uid"),e.opts.autoescape),c+='">',c+=a.suppressValue((o=15,s=78,a.callWrap(a.contextOrFrameLookup(t,r,"user_avatar"),"user_avatar",t,[a.memberLookup(a.memberLookup(n,"user"),"avatars"),{size:32}])),e.opts.autoescape),c+='</a>\n                </div>\n                <div class="model-info">\n                    <h1 class="title">',c+=a.suppressValue((o=18,s=49,a.callWrap(a.contextOrFrameLookup(t,r,"model_name"),"model_name",t,[i,n,{target:"_blank",withRestrictedFlag:!1}])),e.opts.autoescape),c+='</h1>\n                    <h2>by <a target="_blank" href="/models/',c+=a.suppressValue(a.memberLookup(n,"uid"),e.opts.autoescape),c+='">',c+=a.suppressValue(a.memberLookup(a.memberLookup(n,"user"),"displayName"),e.opts.autoescape),c+="</a></h2>\n                </div>\n            "),c+='\n        </div>\n\n        <div class="actions">\n\n            ',a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiInfos")&&(a.memberLookup(n,"isDownloadable")||a.memberLookup(n,"inStore"))&&(c+='\n                <a class="help tooltip tooltip-down download" data-tooltip="Download" target="_blank" href="/models/',c+=a.suppressValue(a.memberLookup(n,"uid"),e.opts.autoescape),c+='#download">\n                    <i class="icon fa fa-download"></i>\n                </a>\n            '),c+="\n\n            ",a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiInfos")&&(c+='\n                <a class="help tooltip tooltip-down share" data-tooltip="Share" data-action="open-share-overlay">\n                    <i class="custom-icons icon-ion-android-share-alt-icon"></i>\n                </a>\n            '),c+="\n\n            ",a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiStop")&&(c+='\n                <a class="help tooltip tooltip-down close hidden" data-tooltip="Stop" data-action="stop">\n                    <i class="custom-icons icon-ion-close-round-icon"></i>\n                </a>\n            '),c+="\n\n        </div>\n\n    </div>\n\n",r=l,new a.SafeString(c)});t.addExport("viewer_infos"),t.setVariable("viewer_infos",p),u+="\n\n";var f=a.makeMacro(["authUser","model"],["options"],function(i,n,u){var l=r;r=new a.Frame,u=u||{},u.hasOwnProperty("caller")&&r.set("caller",u.caller),r.set("authUser",i),r.set("model",n),r.set("options",u.hasOwnProperty("options")?u.options:{});var c="";return c+="\n\n    ",a.memberLookup(n,"isDeleted")?c+='\n        <div class="viewer">\n            <div class="osd active">\n                <div class="content">\n                    <div class="panel">\n                        <p>This model has been deleted</p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ':a.memberLookup(n,"isPublished")||a.memberLookup(a.memberLookup(n,"user"),"uid")==a.memberLookup(i,"uid")||a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"share")?(c+="\n        ",c+=a.suppressValue((o=63,s=20,a.callWrap(a.contextOrFrameLookup(t,r,"show_viewer"),"show_viewer",t,[i,n,a.contextOrFrameLookup(t,r,"options")])),e.opts.autoescape),c+="\n    "):c+='\n        <div class="viewer">\n            <div class="osd active">\n                <div class="content">\n                    <div class="panel">\n                        <p>This model has not been published yet</p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ',c+="\n\n",r=l,new a.SafeString(c)});t.addExport("viewer"),t.setVariable("viewer",f),u+="\n\n";var m=a.makeMacro(["authUser","model"],["options"],function(i,n,u){var l=r;r=new a.Frame,u=u||{},u.hasOwnProperty("caller")&&r.set("caller",u.caller),r.set("authUser",i),r.set("model",n),r.set("options",u.hasOwnProperty("options")?u.options:{});var c="";return c+='\n\n    <div class="viewer has-model ',a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"transparent")&&(c+=" transparent"),a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"autostart")&&(c+=" started"),c+='">\n\n        ',c+=a.suppressValue((o=82,s=21,a.callWrap(a.contextOrFrameLookup(t,r,"viewer_infos"),"viewer_infos",t,[i,n,a.contextOrFrameLookup(t,r,"options")])),e.opts.autoescape),c+='\n\n        <div class="landing" data-action="start">\n\n            <div class="preview">\n                ',c+=a.suppressValue(e.getFilter("image_container").call(t,a.memberLookup(n,"thumbnails"),1024,768,!0,!0),e.opts.autoescape),c+='\n            </div>\n\n            <div class="start-button">\n                <button class="play">\n                    <i class="fa fa-play"></i>\n                    <span class="label">3D</span>\n                </button>\n            </div>\n\n            ',c+=a.suppressValue((o=97,s=23,a.callWrap(a.contextOrFrameLookup(t,r,"watermark"),"watermark",t,[n,a.contextOrFrameLookup(t,r,"options")])),e.opts.autoescape),c+='\n\n        </div>\n\n        <div class="overlays">\n            ',a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"restricted")&&(c+='\n                <div class="overlay restricted">\n                    <div>\n                        <h3 class="heading">Age-restricted content</h3>\n                        <p>\n                            This 3D model contains age-restricted content.<br/>\n                            You need to enable age-restricted content to view this.\n                        </p>\n                        <button type="submit" class="button btn-input btn-primary submit" data-action="allowRestricted">Enable age-restricted content</button>\n                        ',c+=a.suppressValue((o=111,s=29,a.callWrap(a.contextOrFrameLookup(t,r,"logo"),"logo",t,[121,25,{color:"#ffffff"}])),e.opts.autoescape),c+="\n                    </div>\n                </div>\n            "),c+='\n            <div class="overlay help hidden">\n                <a href="#" class="close custom-icons icon-ion-close-round-icon"></a>\n                <div class="inner">\n                    <ul class="tabs">\n                        <li class="active"><a href="#" data-target="basic">Navigation basics</a></li>\n                        <li><a href="#" data-target="all">All controls</a></li>\n                    </ul>\n                    <div class="tabs-container">\n                        <div class="tab active" data-tab="basic">\n                            <div class="tip">\n                                <div>\n                                    <i class="fa fa-refresh"></i>\n                                </div>\n                                <div>\n                                    <b>Orbit around</b>\n                                    <div>\n                                        Left click + drag or<br>\n                                        One finger drag (touch)\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="tip">\n                                <div>\n                                    <i class="fa fa-search-plus"></i>\n                                </div>\n                                <div>\n                                    <b>Zoom</b>\n                                    <div>\n                                        Double click on model<br>\n                                        or scroll anywhere or<br>\n                                        Pinch (touch)\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="tip">\n                                <div>\n                                    <i class="fa fa-arrows"></i>\n                                </div>\n                                <div>\n                                    <b>Pan</b>\n                                    <div>\n                                        Right click + drag or<br />\n                                        Two fingers drag (touch)\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        <div class="tab" data-tab="all">\n                            <div>\n                                <div class="section">\n                                    <h2>Orbit navigation</h2>\n                                    <b>Move camera:</b> 1 finger drag or Left Mouse Button<br>\n                                    <b>Pan:</b> 2-finger drag or Right Mouse Button or <kbd>SHIFT</kbd>+ Left Mouse Button<br>\n                                    <b>Zoom on object:</b> Double-tap or Double-click on object<br>\n                                    <b>Zoom out:</b> Double-tap or Double-click on background<br>\n                                    <b>Zoom:</b> Pinch in/out or Mousewheel or <kbd>CTRL</kbd> + Left Mouse Button<br>\n                                </div>\n                                <div class="section">\n                                    <h2>First-person navigation</h2>\n                                    <b>Move:</b> <kbd></kbd>,<kbd></kbd>,<kbd></kbd>,<kbd></kbd> (or <kbd>W</kbd>,<kbd>A</kbd>,<kbd>S</kbd>,<kbd>D</kbd>)<br>\n                                    <b>Look around:</b> 1-finger drag or Left Mouse Button<br>\n                                    <b>Adjust speed:</b> Mousewheel<br>\n                                </div>\n                                <div class="section rendering-shortcuts"></div>\n                                <div class="section">\n                                    <h2>Lighting</h2>\n                                    <b>Rotate lighting:</b> 3-finger drag or <kbd>ALT</kbd> + Left Mouse Button<br>\n                                    <b>Rotate env. only:</b> <kbd>ALT</kbd> + <kbd>SHIFT</kbd> + Left Mouse Button<br>\n                                </div>\n                                <div class="section annotation-shortcuts"></div>\n                                <div class="section animation-shortcuts"></div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="action">\n                        <button class="button" data-action="reset-camera">Reset camera view</button>\n                    </div>\n\n                </div>\n            </div>\n            <div class="overlay share hidden">\n                <a href="#" class="close custom-icons icon-ion-close-round-icon"></a>\n                <div class="inner">\n                    <div class="share-link">\n                        <div class="text-field">\n                            <label>Link</label>\n                            <input type="text" class="text" value="" readonly>\n                            <button data-clipboard-target=".text-field .text">copy</button>\n                        </div>\n                    </div>\n                    <div class="share-social">\n                        <a data-action="share-on-facebook" target="_blank"><i class="fa fa-facebook"></i></a>\n                        <a data-action="share-on-twitter" target="_blank"><i class="fa fa-twitter"></i></a>\n                        <a data-action="share-on-reddit" target="_blank"><i class="fa fa-reddit"></i></a>\n                        <a data-action="share-on-tumblr" target="_blank"><i class="fa fa-tumblr"></i></a>\n                        <a data-action="share-on-google-plus" target="_blank"><i class="fa fa-google-plus"></i></a>\n                        <a data-action="share-on-linkedin" target="_blank"><i class="fa fa-linkedin"></i></a>\n                        <a data-action="share-on-pinterest" target="_blank"><i class="fa fa-pinterest"></i></a>\n                        <a class="share-mail" target="_blank"><i class="fa fa-envelope"></i></a>\n                    </div>\n                    <div class="share-embed">\n                        <a class="button" href="" target="_blank">\n                            <i class="fa fa-code"></i> Embed\n                        </a>\n                    </div>\n                </div>\n            </div>\n            <div class="overlay hotspots-overlay hidden">\n                <a href="#" class="close custom-icons icon-ion-close-round-icon"></a>\n                <div class="inner">\n                    <h4 class="hotspot-title"></h4>\n                    <div class="hotspot-content js-scrollable markdown-rendered-content"></div>\n                </div>\n            </div>\n            <div class="overlay helper-vr-overlay hidden">\n                <i class="custom-icons icon-ion-close-round-icon close"></i>\n                <div class="inner custom-scrollbar">\n                     <div class="header-helper">\n                        To view this model in virtual reality:\n                    </div>\n                    <div class="content-helper">\n                        <div class="row-helper">\n                            <div class="content-row">\n                                <div class="image"><i class="fa fa-mobile"></i></div>\n                                <div class="text">\n                                    <div class="title">on mobile phone</div>\n                                    <div>with Cardboard or similar</div>\n                                </div>\n                            </div>\n                            <ul class="info">\n                                <li>On your mobile, open this link: <a class="url" target="_blank" href="#"></a></li>\n                                <li>Press the VR icon</li>\n                                <li>Insert your mobile in a Cardboard headset</li>\n                            </ul>\n                        </div>\n                        <div class="row-helper">\n                            <div class="content-row">\n                                <div class="image"><i class="fa fa-desktop"></i></div>\n                                <div class="text">\n                                    <div class="title">on desktop PC <span class="flag --info">BETA</span></div>\n                                    <div>with a VR headset</div>\n                                </div>\n                            </div>\n                            <ul class="info">\n                                <li><a href="https://webvr.info/" target="_blank" rel="noopener noreferrer nofollow">Get a WebVR-compatible browser</a></li>\n                                <li>Enable WebVR</li>\n                                <li>Open this model</li>\n                                <li>Click on the VR icon</li>\n                            </ul>\n                        </div>\n                    </div>\n                    <div class="footer-helper">\n                        <a href="https://help.sketchfab.com/hc/en-us/articles/204777439-Mobile-VR-and-Desktop-WebVR?utm_source=website&amp;utm_campaign=vr_hints" target="_blank">\n                        More info on Virtual reality.\n                        </a>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div class="webgl">\n\n            <canvas class="canvas" data-modelUid="',c+=a.suppressValue(a.memberLookup(n,"uid"),e.opts.autoescape),c+='" data-action="create-hotspot">\n            </canvas>\n\n            <div class="loading-container">\n                <div class="secondary-progress">\n                    <div class="secondary-progress-percentage"></div>\n                    <div class="secondary-progress-display"></div>\n                </div>\n                <div class="main-progress">\n                    <img src="',c+=a.suppressValue(e.getFilter("best_fit").call(t,a.memberLookup(n,"thumbnails"),64,36),e.opts.autoescape),c+='" class="loading-thumbnail" />\n                    <div class="main-progress-wrapper">\n                        <div class="main-progress-percentage loading-percentage">0%</div>\n                        <p>Loading 3D model</p>\n                        <div class="main-progress-display">\n                            <div class="main-progress-display__progress"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div class="hotspots"></div>\n\n            <div class="gui">\n\n                <div class="animation-not-supported hidden">\n                    <a href="#" class="close"></a>\n                    <p>Model is too heavy for your device and can not be rendered properly</p>\n                </div>\n\n                ',a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiControls")&&a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiAnnotations")&&(c+='\n                    <div class="hotspot-controls-responsive">\n                        <div data-title="Previous Annotation" data-action="prev-annotation">\n                            <div class="icon fa fa-caret-left"></div>\n                        </div>\n                        <div data-title="Next Annotation" data-action="next-annotation">\n                            <div class="icon fa fa-caret-right"></div>\n                        </div>\n                    </div>\n                '),c+="\n\n                ",a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiInspector")&&(c+='\n                    <div class="model-inspector">\n                        <div class="model-inspector__menu">\n                            <div class="model-inspector__minimize"><i class="fa fa-caret-down" aria-hidden="true"></i>Model Inspector</div>\n                            <div class="model-inspector__content">\n                                <div class="model-inspector__modes custom-scrollbar js-scrollable">\n                                    ',c+='\n                                </div>\n                            </div>\n                        </div>\n                        <div class="model-inspector__2D-options">\n                            <div class="model-inspector__UV-options"></div>\n                            <div class="model-inspector__material-options"></div>\n                        </div>\n                        <div class="model-inspector__empty-2d-view">\n                        </div>\n                    </div>\n                '),c+='\n\n\n                <div class="controls">\n                    ',c+=a.suppressValue((o=339,s=31,a.callWrap(a.contextOrFrameLookup(t,r,"watermark"),"watermark",t,[n,a.contextOrFrameLookup(t,r,"options")])),e.opts.autoescape),c+="\n\n                    ",a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiControls")&&(c+="\n\n                        ",a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiAnimations")&&(c+='\n                            <div class="animation-controls widget ',a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiFadeout")||(c+="no-fadeout"),c+='">\n                                <div class="timeline">\n                                    <div class="timeline-wrapper">\n                                        <div class="track">\n                                            <div class="bar">\n                                            </div>\n                                            <div class="knob">\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                                <a href="#" class="control play fa"></a>\n                                <a href="#" class="control next fa"></a>\n                                <div class="animation-timer control progress help" data-unit="time">00:00.00</div>\n                                <div class="animation-list control has-menu">\n                                    <p class="animation-name"></p>\n                                    <div class="control-menu list">\n                                        <div class="animation__options">\n                                            <div class="toggle-button">\n                                                <span class="toggle-button__option tooltip" data-tooltip="Repeat one">\n                                                    <input type="radio" name="animation-cycle" data-value="one" id="animation-cycle-one">\n                                                    <label for="animation-cycle-one"><i class="custom-icons icon-cycle-repeat-one"></i></label>\n                                                </span>\n                                                <span class="toggle-button__option tooltip" data-tooltip="Repeat all">\n                                                    <input type="radio" name="animation-cycle" data-value="all" id="animation-cycle-all">\n                                                    <label for="animation-cycle-all"><i class="custom-icons icon-cycle-repeat-all"></i></label>\n                                                </span>\n                                                <span class="toggle-button__option tooltip" data-tooltip="No repeat">\n                                                    <input type="radio" name="animation-cycle" data-value="none" id="animation-cycle-none">\n                                                    <label for="animation-cycle-none"><i class="custom-icons icon-cycle-no-repeat"></i></label>\n                                                </span>\n                                            </div>\n                                            <div class="toggle-button">\n                                                <span class="toggle-button__option tooltip" data-tooltip="Speed x0.1">\n                                                    <input type="radio" name="animation-speed" data-value="0.1" id="animation-speed-point-one">\n                                                    <label for="animation-speed-point-one">x0.1</label>\n                                                </span>\n                                                <span class="toggle-button__option tooltip" data-tooltip="Speed x0.5">\n                                                    <input type="radio" name="animation-speed" data-value="0.5" id="animation-speed-point-five">\n                                                    <label for="animation-speed-point-five">x0.5</label>\n                                                </span>\n                                                <span class="toggle-button__option tooltip" data-tooltip="Speed x1">\n                                                    <input type="radio" name="animation-speed" data-value="1" id="animation-speed-one">\n                                                    <label for="animation-speed-one">x1</label>\n                                                </span>\n                                                <span class="toggle-button__option tooltip" data-tooltip="Speed x2">\n                                                    <input type="radio" name="animation-speed" data-value="2" id="animation-speed-two">\n                                                    <label for="animation-speed-two">x2</label>\n                                                </span>\n                                            </div>\n                                        </div>\n                                        <ul class="js-scrollable"></ul>\n                                    </div>\n                                </div>\n                            </div>\n                        '),c+="\n\n                        ",a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiAnnotations")&&(c+='\n                            <div class="hotspot-controls widget has-menu ',a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiFadeout")||(c+="no-fadeout"),c+='">\n\n                                <div data-title="Previous Annotation" data-action="prev-annotation">\n                                    <div class="icon fa fa-caret-left"></div>\n                                </div>\n\n                                <div class="hotspot-name default" data-action="toggle-annotation-list">\n                                    Select an annotation\n                                </div>\n\n                                <div data-title="Next Annotation" data-action="next-annotation">\n                                    <div class="icon fa fa-caret-right"></div>\n                                </div>\n\n                                <div class="list hotspots-list"></div>\n\n                            </div>\n                        '),c+='\n\n                            <div class="general-controls widget ',a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiFadeout")||(c+="no-fadeout"),c+='">\n                            ',a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiGeneralControls")&&(c+="\n\n                                ",a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiHelp")&&(c+='\n                                    <a class="control tooltip help" data-tooltip="Help">\n                                        <i class="fa fa-question"></i>\n                                    </a>\n                                '),c+="\n                                ",a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiSound")&&(c+='\n                                    <a class="control volume" title="Volume (M)" draggable="false">\n                                        <i class="fa fa-volume-up"></i>\n                                        <div class="volume-menu">\n                                        </div>\n                                    </a>\n                                '),c+="\n                                ",a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiSettings")&&(c+='\n                                    <a class="control tooltip settings has-menu" data-tooltip="Settings">\n                                        <i class="fa fa-gear"></i>\n                                        <div class="control-menu settings-menu">\n                                            <div class="control-menu-wrapper">\n                                                <div class="control-menu-list"></div>\n                                                <div class="control-menu-pane"></div>\n                                            </div>\n                                        </div>\n                                        <span class="control-badge"></span>\n                                    </a>\n                                '),c+="\n                                ",a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiInspector")&&(c+='\n                                    <a class="control tooltip inspector" data-tooltip="Model Inspector (I)" data-action="inspector">\n                                        <i class="custom-icons icon-inspector"></i>\n                                    </a>\n                                '),c+="\n                                ",a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiVr")&&(c+='\n                                    <a class="control tooltip vr ',a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiTheatre")||a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiFullscreen")||(c+="tooltip-right-bound"),c+='" data-tooltip="View in VR">\n                                        <i class="custom-icons icon-vr-icon"></i>\n                                    </a>\n                                '),c+="\n                                ",a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiTheatre")&&(c+='\n                                    <a class="control tooltip theatre" data-tooltip="Theater Mode">\n                                        <i class="custom-icons icon-theater-icon"></i>\n                                    </a>\n                                '),c+="\n                                ",a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiFullscreen")&&(c+='\n                                    <a class="control tooltip tooltip-right-bound fullscreen" data-tooltip="Fullscreen">\n                                        <i class="custom-icons icon-fullscreen-icon"></i>\n                                    </a>\n                                '),c+="\n                            "),c+="\n                            </div>\n                    "),c+="\n                </div>\n\n                ",a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiSnapshots")&&(c+='\n                    <div class="snapshot-guides">\n                    </div>\n                    <div class="snapshot widget">\n                        <a class="button help">\n                            <span class="normal"><i class="icon fa fa-camera"></i> Save view</span>\n                            <span class="progress"><i class="icon fa fa-camera"></i> Saving&hellip;</span>\n                            <span class="success"><i class="icon fa fa-check"></i>Saved</span>\n                            <div class="tooltip tooltip-right">Save thumbnail and initial camera view</div>\n                        </a>\n                        <div class="img-container invisible"></div>\n                    </div>\n                    <div class="snapshot-flash">\n                    </div>\n                '),c+='\n\n                <div class="viewer-hint widget disabled">\n                    <div class="viewer-movehint">\n                        <i class="icon"></i>\n                        <span class="label"></span>\n                    </div>\n                </div>\n\n            </div>\n\n        </div>\n\n        <div class="osd widget">\n            <div class="osd-content">\n            </div>\n        </div>\n\n        <div class="fallback" style="display: none">\n\n            <div class="fallback-viewport">\n                <img src="" alt="" class="fallback-sprite">\n            </div>\n\n            <div class="fallback-warning">\n                <div class="inner">\n                    For compatibility reasons, 3D is not available (<a href="https://help.sketchfab.com/hc/en-us/articles/203059088-Compatibility?utm_source=website&amp;utm_campaign=error_fallback" target="_blank">see requirements</a>).<br>\n                    You are seeing a 360&deg; image instead.\n                </div>\n            </div>\n\n            <div class="fallback-error fallback-error-loading">\n                <div class="inner">\n                    <p>Connection error. Please try again.</p>\n                </div>\n            </div>\n\n            <div class="fallback-error fallback-error-nofallback">\n                <div class="inner">\n                    <p>Sorry, the model can\'t be displayed.</p>\n                    <p>Please check out <a href="https://help.sketchfab.com/hc/en-us/articles/203059088-Compatibility?utm_source=website&amp;utm_campaign=error_fallback" target="_blank">our FAQ</a> to learn how to fix this issue.</p>\n                </div>\n            </div>\n\n            <div class="progress-bar">\n                <div class="progress-bar-percentage"></div>\n                <div class="progress-bar-display"></div>\n            </div>\n\n            <div class="progress-circle">\n                <div class="progress-circle-percentage loading-percentage"></div>\n                <svg class="progress-circle-display" version="1.1">\n                    <path class="progress-circle-path" fill="none" stroke="#1caad9" stroke-width="6" />\n                </svg>\n            </div>\n\n            ',a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiControls")&&(c+='\n                <div class="controls">\n                    <div class="control control-fullscreen fullscreen tooltip tooltip-left" data-tooltip="Fullscreen" data-action="fullscreen">\n                        <div class="icon custom-icons icon-fullscreen-icon"></div>\n                    </div>\n                </div>\n            '),c+="\n\n        </div>\n\n    </div>\n\n",r=l,new a.SafeString(c)});t.addExport("show_viewer"),t.setVariable("show_viewer",m),u+="\n\n";var g=a.makeMacro(["mode"],[],function(e,t){var i=r;r=new a.Frame,t=t||{},t.hasOwnProperty("caller")&&r.set("caller",t.caller),r.set("mode",e);var n="";return n+="\n\n    ","orbit"==e&&(n+='\n\n        <div class="viewer-mode-help">\n            <h2>Orbit mode</h2>\n            <ul class="help-shortcuts">\n                <li class="mouse-left">Rotate</li>\n                <li class="mouse-wheel">Zoom <small class="hint">also works with CTRL+left click</small></li>\n                <li class="mouse-right">Pan <small class="hint">also works with SHIFT+left click</small></li>\n            </ul>\n        </div>\n\n    '),n+="\n\n    ","fps"==e&&(n+='\n\n        <div class="viewer-mode-help">\n            <h2>First person mode</h2>\n            <ul class="help-shortcuts">\n                <li class="mouse-left">Look around</li>\n                <li class="mouse-wheel">Walking speed</li>\n                <li class="kbd-wasd">Walk <small class="hint">also works with arrows or Z,Q,S,D</small></li>\n            </ul>\n        </div\n\n    '),n+="\n\n",r=i,new a.SafeString(n)});t.addExport("help_viewer_mode"),t.setVariable("help_viewer_mode",g),u+="\n\n";var _=a.makeMacro(["hotspots"],[],function(i,n){var o=r;r=new a.Frame,n=n||{},n.hasOwnProperty("caller")&&r.set("caller",n.caller),r.set("hotspots",i);var s="";s+='\n<a href="#" data-action="toggle-visibility" class="annotations-visibility --hide"></a>\n<a href="#" data-action="toggle-autopilot" class="annotations-autopilot --stopped"></a>\n<ul class="js-scrollable">\n    ',r=r.push();var u=i;if(u)for(var l=u.length,c=0;c<u.length;c++){var h=u[c];r.set("hotspot",h),r.set("loop.index",c+1),r.set("loop.index0",c),r.set("loop.revindex",l-c),r.set("loop.revindex0",l-c-1),r.set("loop.first",0===c),r.set("loop.last",c===l-1),r.set("loop.length",l),s+='\n        <li class="link"><a data-hotspot-target="',s+=a.suppressValue(a.memberLookup(a.contextOrFrameLookup(t,r,"loop"),"index0"),e.opts.autoescape),s+='" title="',s+=a.suppressValue(a.memberLookup(h,"name"),e.opts.autoescape),s+='"><span class="index">',s+=a.suppressValue(a.memberLookup(a.contextOrFrameLookup(t,r,"loop"),"index"),e.opts.autoescape),s+="</span> ",s+=a.suppressValue(a.memberLookup(h,"name"),e.opts.autoescape),s+="</a></li>\n    "}return r=r.pop(),s+="\n</ul>\n",r=o,new a.SafeString(s)});t.addExport("hotspots_list"),t.setVariable("hotspots_list",_),u+="\n\n";var v=a.makeMacro(["hasFullscreen"],[],function(t,n){var o=r;r=new a.Frame,n=n||{},n.hasOwnProperty("caller")&&r.set("caller",n.caller),r.set("hasFullscreen",t);var s="";return s+='\n\n    <div class="vr-mode-help">\n        ',s+='\n        <img src="',s+=a.suppressValue(i(880),e.opts.autoescape),s+='" width="96" height="116" alt="Place your landscape oriented phone in front of lenses">\n\n        <p>\n            ',s+=t?'\n                <button class="button btn-textified" data-action="fullscreen">Switch to fullscreen</button><br>\n                then place your phone into your Cardboard viewer\n            ':"\n                Place your phone into your Cardboard viewer\n            ",s+="\n        </p>\n    </div>\n\n",r=o,new a.SafeString(s)});t.addExport("help_vr_mode"),t.setVariable("help_vr_mode",v),u+="\n\n";var b=a.makeMacro(["model"],["options"],function(i,n){var o=r;r=new a.Frame,n=n||{},n.hasOwnProperty("caller")&&r.set("caller",n.caller),r.set("model",i),r.set("options",n.hasOwnProperty("options")?n.options:{});var s="";return s+="\n    ",a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiWatermark")&&(s+='\n        <div class="watermark',s+=a.suppressValue(a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiWatermarkLink")?"":" tooltip tooltip-left-bound",e.opts.autoescape),s+='"\n            ',a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiWatermarkLink")||(s+='\n                data-tooltip="Powered by Sketchfab.com"\n            '),s+="\n        >\n            <a\n                ",a.memberLookup(a.contextOrFrameLookup(t,r,"options"),"uiWatermarkLink")&&(s+='\n                    title="View on Sketchfab"\n                    data-action="watermark" href="',s+=a.suppressValue(a.memberLookup(i,"viewerUrl"),e.opts.autoescape),s+='" target="_blank"\n                '),s+="\n            ></a>\n        </div>\n    "),s+="\n",r=o,new a.SafeString(s)});t.addExport("watermark"),t.setVariable("watermark",b),u+="\n",l?l.rootRenderFunc(e,t,r,a,n):n(null,u)})})})})})})})})})})})})}catch(e){n(a.handleError(e,o,s))}}return{root:e}}()}()},,,function(e,t,i){function r(e){return i(a(e))}function a(e){var t=n[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var n={"./af":262,"./af.js":262,"./ar":263,"./ar-dz":264,"./ar-dz.js":264,"./ar-kw":265,"./ar-kw.js":265,"./ar-ly":266,"./ar-ly.js":266,"./ar-ma":267,"./ar-ma.js":267,"./ar-sa":268,"./ar-sa.js":268,"./ar-tn":269,"./ar-tn.js":269,"./ar.js":263,"./az":270,"./az.js":270,"./be":271,"./be.js":271,"./bg":272,"./bg.js":272,"./bm":273,"./bm.js":273,"./bn":274,"./bn.js":274,"./bo":275,"./bo.js":275,"./br":276,"./br.js":276,"./bs":277,"./bs.js":277,"./ca":278,"./ca.js":278,"./cs":279,"./cs.js":279,"./cv":280,"./cv.js":280,"./cy":281,"./cy.js":281,"./da":282,"./da.js":282,"./de":283,"./de-at":284,"./de-at.js":284,"./de-ch":285,"./de-ch.js":285,"./de.js":283,"./dv":286,"./dv.js":286,"./el":287,"./el.js":287,"./en-au":288,"./en-au.js":288,"./en-ca":289,"./en-ca.js":289,"./en-gb":290,"./en-gb.js":290,"./en-ie":291,"./en-ie.js":291,"./en-nz":292,"./en-nz.js":292,"./eo":293,"./eo.js":293,"./es":294,"./es-do":295,"./es-do.js":295,"./es-us":296,"./es-us.js":296,"./es.js":294,"./et":297,"./et.js":297,"./eu":298,"./eu.js":298,"./fa":299,"./fa.js":299,"./fi":300,"./fi.js":300,"./fo":301,"./fo.js":301,"./fr":302,"./fr-ca":303,"./fr-ca.js":303,"./fr-ch":304,"./fr-ch.js":304,"./fr.js":302,"./fy":305,"./fy.js":305,"./gd":306,"./gd.js":306,"./gl":307,"./gl.js":307,"./gom-latn":308,"./gom-latn.js":308,"./gu":309,"./gu.js":309,"./he":310,"./he.js":310,"./hi":311,"./hi.js":311,"./hr":312,"./hr.js":312,"./hu":313,"./hu.js":313,"./hy-am":314,"./hy-am.js":314,"./id":315,"./id.js":315,"./is":316,"./is.js":316,"./it":317,"./it.js":317,"./ja":318,"./ja.js":318,"./jv":319,"./jv.js":319,"./ka":320,"./ka.js":320,"./kk":321,"./kk.js":321,"./km":322,"./km.js":322,"./kn":323,"./kn.js":323,"./ko":324,"./ko.js":324,"./ky":325,"./ky.js":325,"./lb":326,"./lb.js":326,"./lo":327,"./lo.js":327,"./lt":328,"./lt.js":328,"./lv":329,"./lv.js":329,"./me":330,"./me.js":330,"./mi":331,"./mi.js":331,"./mk":332,"./mk.js":332,"./ml":333,"./ml.js":333,"./mr":334,"./mr.js":334,"./ms":335,"./ms-my":336,"./ms-my.js":336,"./ms.js":335,"./mt":337,"./mt.js":337,"./my":338,"./my.js":338,"./nb":339,"./nb.js":339,"./ne":340,"./ne.js":340,"./nl":341,"./nl-be":342,"./nl-be.js":342,"./nl.js":341,"./nn":343,"./nn.js":343,"./pa-in":344,"./pa-in.js":344,"./pl":345,"./pl.js":345,"./pt":346,"./pt-br":347,"./pt-br.js":347,"./pt.js":346,"./ro":348,"./ro.js":348,"./ru":349,"./ru.js":349,"./sd":350,"./sd.js":350,"./se":351,"./se.js":351,"./si":352,"./si.js":352,"./sk":353,"./sk.js":353,"./sl":354,"./sl.js":354,"./sq":355,"./sq.js":355,"./sr":356,"./sr-cyrl":357,"./sr-cyrl.js":357,"./sr.js":356,"./ss":358,"./ss.js":358,"./sv":359,"./sv.js":359,"./sw":360,"./sw.js":360,"./ta":361,"./ta.js":361,"./te":362,"./te.js":362,"./tet":363,"./tet.js":363,"./th":364,"./th.js":364,"./tl-ph":365,"./tl-ph.js":365,"./tlh":366,"./tlh.js":366,"./tr":367,"./tr.js":367,"./tzl":368,"./tzl.js":368,"./tzm":369,"./tzm-latn":370,"./tzm-latn.js":370,"./tzm.js":369,"./uk":371,"./uk.js":371,"./ur":372,"./ur.js":372,"./uz":373,"./uz-latn":374,"./uz-latn.js":374,"./uz.js":373,"./vi":375,"./vi.js":375,"./x-pseudo":376,"./x-pseudo.js":376,"./yo":377,"./yo.js":377,"./zh-cn":378,"./zh-cn.js":378,"./zh-hk":379,"./zh-hk.js":379,"./zh-tw":380,"./zh-tw.js":380};r.keys=function(){return Object.keys(n)},r.resolve=a,e.exports=r,r.id=473},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(74)),n=function(e,t){return Math.min(e,Math.max(0,parseInt(t)||0))},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(a.a)(e.split("?")[1]||"").page},s=function(){var e={};return{get:function(t){return e[t]},update:function(t){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach(function(i){e[i.uid]=t})}}},u=function(e,t){var i=function(){var t=Object(r.isNumber)(e.lastPage)?e.lastPage:0,i=n(t,e.firstPage);return{lastPage:t,currentPageIndex:i,hasPrevious:0!==i}},a=s(),u=i(),l=function(e){return function(t){return a.update(e,t.results),u.currentPageIndex=e,t.previous||(u.hasPrevious=!1),t.next?u.lastPage=1/0:u.lastPage=e,t}};return{type:"offset",loadPrevious:function(e){var i=n(u.lastPage,u.currentPageIndex-1);return t(i,e).then(l(i))},loadNext:function(e){var i=n(u.lastPage,u.currentPageIndex+1);return t(i,e).then(l(i))},loadFirst:function(e){u=i(),a=s();return t(0,e).then(l(0))},reset:function(){u=i()},hasPrevious:function(){return u.hasPrevious},hasNext:function(){return u.currentPageIndex+1<u.lastPage},isFirst:function(){return 0===u.currentPageIndex},getQueryParamsForElementUid:function(e){return{page:a.get(e)||""}},getQueryParams:function(){return{page:u.currentPageIndex}},setInitialQuery:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=o(e);a.update(i,t.results)}}};t.a=u},function(e,t,i){"use strict";var r=i(19),a=i.n(r),n=i(74),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(n.a)(e.split("?")[1]||"").cursor},s=function(){var e={};return{get:function(t){return e[t]},update:function(t){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach(function(i){e[i.uid]=t})}}},u=function(e,t){var i=function(){return{previousCursor:e.previous||null,currentCursor:e.current,nextCursor:e.next||null}},r=s(),n=i(),u=function(e,t){return function(i){return r.update(e,i.results),n.currentCursor=e,t.setNext&&(n.nextCursor=i.next?o(i.next):null),t.setPrevious&&(n.previousCursor=i.previous?o(i.previous):null),i}};return{type:"cursor",loadPrevious:function(e){return t(n.previousCursor,e).then(u(n.previousCursor,a()({},e,{setPrevious:!0})))},loadNext:function(e){return t(n.nextCursor,e).then(u(n.nextCursor,a()({},e,{setNext:!0})))},loadFirst:function(e){return n=i(),r=s(),t(n.currentCursor,e).then(u(n.current,a()({},e,{setNext:!0,setPrevious:!0})))},reset:function(){n=i()},hasPrevious:function(){return null!==n.previousCursor},hasNext:function(){return null!==n.nextCursor},isFirst:function(){return n.currentCursor===e.current},getQueryParamsForElementUid:function(e){return{cursor:r.get(e)}},getQueryParams:function(){return{cursor:n.currentCursor}},setInitialQuery:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=o(e);r.update(i,t.results)}}};t.a=u},function(e,t,i){"use strict";function r(e,t,i){var r=[],n=Object(a.debounce)(function(){var e=r.slice();r=[],i.trigger(t,e)},20),o=function(e){r.push(e),n()};return i.on(e,o),function(){i.off(e,o)}}t.a=r;var a=i(0);i.n(a)},function(e,t,i){"use strict";var r=i(12);t.a=r.a.extend({})},function(e,t,i){"use strict";var r=i(20),a=i.n(r),n=["a","e","i","o","u","h"],o=function(e,t){var i,r,a,o;e<0?(i="in ",r=""):(i="",r=" ago");var s=Math.abs(e);return 1!==s?(a=s.toString(),o="s"):(a=-1!==n.indexOf(t[0])?"an ":"a ",o=""),i+a+" "+t+o+r},s={1e3:function(e){return o(e,"second")},6e4:function(e){return o(e,"minute")},36e5:function(e){return o(e,"hour")},864e5:function(e){return o(e,"day")},6048e5:function(e){return o(e,"week")},24192e5:function(e){return o(e,"month")},290304e5:function(e){return o(e,"year")}};t.a={timeAgo:function(e){var t=(new Date).getTime(),i=e.getTime(),r=t-i,n=null;a()(s).forEach(function(e){e=parseInt(e),(null===n||e>n&&Math.floor(r/e)>=1)&&(n=e)});var o=Math.floor(r/n);return s[n](o)}}},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(3)),n=i.n(a),o=i(15),s=i.n(o),u=i(1355),l=i.n(u),c=function(e,t){if(Array.isArray(e))this.shortcuts=e||[];else{if(!Object(r.isObject)(e))throw new Error("Shortcut manager needs a shortcut object to function");this.shortcutGroup=e,this.shortcuts=e.shortcuts||[]}this.options=t||{},this.handlers={},this.options=Object(r.defaults)({},this.options,{listen:!1}),this.options.listen&&this.listen()},h=new l.a;h.stopCallback=function(e,t){return!((" "+t.className+" ").indexOf(" mousetrap ")>-1)&&("button"===document.activeElement.tagName.toLowerCase()||("INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.contentEditable&&"true"===t.contentEditable))},Object(r.extend)(c.prototype,s.a.Events),c.prototype.listen=function(e){void 0===e?this.shortcuts.forEach(this._listen.bind(this)):Array.isArray(e)?(this.shortcuts=this.shortcuts.concat(e),e.forEach(this._listen.bind(this))):this._listen(e)},c.prototype.stopListening=function(e){e.forEach(function(e){h.unbind(this._getShortcut(e).keyCombinations),delete this.handlers[e]}.bind(this))},c.prototype.getTitle=function(){return this.shortcutGroup?this.shortcutGroup.name||"":""},c.prototype.getShortcut=function(e){return this.shortcuts.filter(function(t){return t.id===e})[0]||""},c.prototype.getShortDescriptionById=function(e){var t="";return this.shortcuts.forEach(function(i){i.id===e&&(t=this._formatKeyCombination(i.keyCombinations).replace("<br />",""))}.bind(this)),t},c.prototype.generateHelpSection=function(){var e=n()("<div />"),t=this.getTitle();return t&&e.append("<h2>"+t+"</h2>"),this.shortcuts.filter(this._validate).forEach(function(t){t.name&&e.append("<b>"+t.name+"</b>"),e.append(this._formatKeyCombination(t.keyCombinations))}.bind(this)),e.html()||""},c.prototype.hasKeyCombination=function(e){var t=!1;return this.shortcuts.forEach(function(i){t||(Array.isArray(i.shortcuts)?i.shortcuts.forEach(function(i){t=i===e}):t=i.shortcuts===e)}),t},c.prototype._formatKeyCombination=function(e){return[].concat(e).map(function(e){return"<kbd>"+e+"</kbd>"}).join(" or ")+"<br />"},c.prototype._listen=function(e){this._validate(e)&&!this.handlers[e.id]&&(this.handlers[e.id]=this._notify.bind(this,e),h.bind(e.keyCombinations,this.handlers[e.id]))},c.prototype._getShortcut=function(e){return Object(r.find)(this.shortcuts,function(t){return t.id===e})},c.prototype._validate=function(e){return!!e.keyCombinations&&!!e.id},c.prototype._notify=function(e,t){this.trigger(e.id,e,t)},t.a=c},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";var r=i(7),a=i.n(r),n=i(0),o=(i.n(n),i(15)),s=i.n(o),u=i(87);t.a={status:function(){return void 0===this.get("status")?this.pollStatus():a.a.resolve(this.get("status"))},pollStatus:function(){return new a.a(function(e,t){s.a.ajax({type:"GET",url:Object(n.result)(this,"url")+"/status",allowPrefetching:!1}).then(function(i){if(!i)return t();var r={PENDING:0,PROCESSING:1,SUCCEEDED:2,FAILED:3}[i.processing.toUpperCase()];this.set("status",i),this.set("processingStatus",r),e(i)}.bind(this),t)}.bind(this))},checkStatus:function(){return this.pollStatus().then(function(e){return-1!==["SUCCEEDED","FAILED"].indexOf(e.processing.toUpperCase())?a.a.resolve(e):a.a.reject(e)}.bind(this),function(){return this.maxFailCount<=0?a.a.resolve({processing:"FAILED",error:"The server failed to answer in time"}):(this.maxFailCount-=1,a.a.reject("Server responded with an error"))}.bind(this))},checkStatusAndRetry:function(){return u.c(1/0,this.checkStatus.bind(this),{interval:2e3})}}},function(e,t,i){"use strict";var r=i(10),a=i(127),n=function(e,t,i,n){var o=t,s=void 0!==n?n:e.length;void 0===o&&(o=!0);var u=i||r.c.create(),l=0;if(o){for(l=s-1;l>=0;l--){var c=e[l];if("Camera"===c.className()&&(c.getReferenceFrame()!==a.a.RELATIVE_RF||0===c.getParents().length))break}l+=1}for(var h=l,d=s;h<d;h++){var p=e[h];p.computeLocalToWorldMatrix&&p.computeLocalToWorldMatrix(u)}return u};t.a={computeLocalToWorld:n}},function(e,t,i){"use strict";var r=function(){r.prototype.reset.call(this)};r.prototype={reset:function(){this._computeNearFar=!0,this._nearFarRatio=.005,this._enableFrustumCulling=!1,this._settingsSourceOverrider=this,this._LODScale=1,this._clampProjectionMatrixCallback=void 0},setCullSettings:function(e){this._computeNearFar=e._computeNearFar,this._nearFarRatio=e._nearFarRatio,this._enableFrustumCulling=e._enableFrustumCulling,this._settingsSourceOverrider=e._settingsSourceOverrider,this._clampProjectionMatrixCallback=e._clampProjectionMatrixCallback},setNearFarRatio:function(e){this._nearFarRatio=e},getNearFarRatio:function(){return this._nearFarRatio},setComputeNearFar:function(e){this._computeNearFar=e},getComputeNearFar:function(){return this._computeNearFar},setEnableFrustumCulling:function(e){this._enableFrustumCulling=e},getEnableFrustumCulling:function(){return this._enableFrustumCulling},getSettingSourceOverrider:function(){return this._settingsSourceOverrider},setClampProjectionMatrixCallback:function(e){this._clampProjectionMatrixCallback=e},getClampProjectionMatrixCallback:function(){return this._clampProjectionMatrixCallback},setLODScale:function(e){this._LODScale=e},getLODScale:function(){return this._LODScale}},t.a=r},function(e,t,i){"use strict";var r=i(21),a=i(9),n=i(447),o=i(54),s=i(544),u=i(779),l=i(10),c=i(143),h=i(673),d=i(676),p=i(677),f=i(773),m=i(121),g=i(780),_=i(546),v=i(589),b=i(98),y=i(678),x=i(781),S=i(679),M=i(142),w=i(127),T=i(590),C=i(453),E=i(452),L=i(398),P=i(184),A=i(216),D=function(){return new g.a},O=function(){return new s.a},k=function(){o.a.call(this,o.a.TRAVERSE_ACTIVE_CHILDREN),s.a.call(this),u.a.call(this),this._rootStateGraph=void 0,this._currentStateGraph=void 0,this._currentRenderBin=void 0,this._currentRenderStage=void 0,this._rootRenderStage=void 0,this._computedNear=Number.POSITIVE_INFINITY,this._computedFar=Number.NEGATIVE_INFINITY,this._camera=void 0,this._pooledLeaf=new A.a(D),this._pooledRenderStages={},this._pooledCullSettings=new A.a(O),this._renderBinStack=new P.a,this.visitorType=o.a.CULL_VISITOR,this._identityMatrix=l.c.create(),this._renderer=void 0,this._renderStageType=v.a,this._numCamera=0,this._numMatrixTransform=0,this._numProjection=0,this._numNode=0,this._numLightSource=0,this._numGeometry=0};k.registerApplyFunction=f.default.registerApplyFunction,k.getApplyFunction=f.default.getApplyFunction,a.a.createPrototypeObject(k,a.a.objectInherit(u.a.prototype,a.a.objectInherit(o.a.prototype,{applyFunctionArray:f.default.applyFunctionArray,distance:function(e,t){return-(e[0]*t[2]+e[1]*t[6]+e[2]*t[10]+t[14])},getComputedNear:function(){return this._computedNear},getComputedFar:function(){return this._computedFar},resetStats:function(){this._numCamera=0,this._numMatrixTransform=0,this._numProjection=0,this._numNode=0,this._numLightSource=0,this._numGeometry=0},handleCullCallbacksAndTraverse:function(e){var t=e.getCullCallback();t&&!t.cull(e,this)||this.traverse(e)},getCurrentCamera:function(){return this._currentRenderBin.getStage().getCamera()},updateCalculatedNearFar:function(){var e=l.f.create(),t=l.f.create();return function(i,r){var a,n,o=r.getBoundingBox();if(a=this.distance(o.corner(this._bbCornerNear,e),i),n=this.distance(o.corner(this._bbCornerFar,t),i),a>n){var s=a;a=n,n=s}return!(n<0)&&(a<this._computedNear&&(this._computedNear=a),n>this._computedFar&&(this._computedFar=n),!0)}}(),setStateGraph:function(e){this._rootStateGraph=e,this._currentStateGraph=e},setRenderStage:function(e){this._rootRenderStage=e,this._currentRenderBin=e},setRenderer:function(e){this._renderer=e},getRenderer:function(){return this._renderer},reset:function(){u.a.prototype.reset.call(this),this._pooledLeaf.reset(),this._pooledCullSettings.reset();for(var e in this._pooledRenderStages)this._pooledRenderStages[e].reset();_.a.reset(),this._computedNear=Number.POSITIVE_INFINITY,this._computedFar=Number.NEGATIVE_INFINITY},getCurrentRenderBin:function(){return this._currentRenderBin},setCurrentRenderBin:function(e){this._currentRenderBin=e},addPositionedAttribute:function(e,t){var i=e||this._identityMatrix;this._currentRenderBin.getStage().addPositionAttribute(i,t)},pushStateSet:function(e){if(this._currentStateGraph=this._currentStateGraph.findOrInsert(e),void 0!==e.getBinName()){var t=this._renderBinStack,i=this._currentRenderBin;t.push(i),this._currentRenderBin=i.getStage().findOrInsert(e.getBinNumber(),e.getBinName())}},popStateSet:function(){var e=this._currentStateGraph,t=e.getStateSet();if(this._currentStateGraph=e.getParent(),void 0!==t.getBinName()){var i=this._renderBinStack;0===i.getLength()?this._currentRenderBin=this._currentRenderBin.getStage():this._currentRenderBin=i.pop()}},popProjectionMatrix:function(){if(!0===this._computeNearFar&&this._computedFar>=this._computedNear){var e=this.getCurrentProjectionMatrix();void 0!==this._clampProjectionMatrixCallback?this._clampProjectionMatrixCallback(e,this._computedNear,this._computedFar,this._nearFarRatio):this.clampProjectionMatrix(e,this._computedNear,this._computedFar,this._nearFarRatio)}u.a.prototype.popProjectionMatrix.call(this)},clampProjectionMatrix:function(e,t,i,a,n){if(i<t-1e-6)return r.a.log("clampProjectionMatrix not applied, invalid depth range, znear = "+t+"  zfar = "+i,!1,!0),!1;var o,s;if(i<t+1e-6){var u=.5*(t+i);t=u-1e-6,i=u+1e-6}if(Math.abs(e[3])<1e-6&&Math.abs(e[7])<1e-6&&Math.abs(e[11])<1e-6){var l=.02*(i-t);l<1&&(l=1),o=t-l,s=i+l,t=o,i=s,e[10]=-2/(s-o),e[14]=-(s+o)/(s-o)}else{o=.98*t,s=1.02*i;var c=i*a;o<c&&(o=c),t=o,i=s;var h=e[10],d=e[14],p=e[11],f=e[15],m=(-o*h+d)/(-o*p+f),g=(-s*h+d)/(-s*p+f),_=Math.abs(2/(m-g)),v=-(m+g)/2,b=v*_;e[2]=e[2]*_+e[3]*b,e[6]=e[6]*_+e[7]*b,e[10]=h*_+p*b,e[14]=d*_+f*b}return void 0!==n&&(n[0]=t,n[1]=i),!0},popCameraModelViewProjectionMatrix:function(){this.popModelViewMatrix(),this.popProjectionMatrix()},pushCameraModelViewProjectionMatrix:function(e,t,i){this.pushModelViewMatrix(t),this.pushProjectionMatrix(i)},apply:function(e){this.applyFunctionArray[e.nodeTypeID].call(this,e)},createOrReuseRenderLeaf:function(){return this._pooledLeaf.getOrCreateObject()},createOrReuseRenderStage:function(e){var t=e?e.className():"RenderStage";if(!this._pooledRenderStages[t]){var i=e?e.constructor:v.a,r=function(){return new i};this._pooledRenderStages[t]=new A.a(r)}return this._pooledRenderStages[t].getOrCreateObject().init()},postPushGeometry:function(e,t){var i,r;t instanceof C.a?(r=t.getStateSetAnimation(),r&&e.pushStateSet(r),(i=t.getSourceGeometry())instanceof L.a&&(r=i.getStateSetAnimation())&&e.pushStateSet(r)):t instanceof L.a&&(r=t.getStateSetAnimation())&&e.pushStateSet(r)},prePopGeometry:function(e,t){if(t instanceof C.a){var i=t.getSourceGeometry();i instanceof L.a&&i.getStateSetAnimation()&&e.popStateSet(),t.getStateSetAnimation()&&e.popStateSet()}else t instanceof L.a&&t.getStateSetAnimation()&&e.popStateSet()},pushLeaf:function(e,t){var i=this._currentStateGraph.getLeafs();i.getLength()||this._currentRenderBin.addStateGraph(this._currentStateGraph);var r=this.createOrReuseRenderLeaf();r.init(this._currentStateGraph,e,this.getCurrentProjectionMatrix(),this.getCurrentViewMatrix(),this.getCurrentModelViewMatrix(),this.getCurrentModelMatrix(),t),i.push(r)}})),"osg","CullVisitor");var R=function(e){this._numCamera++;var t=e.getStateSet();t&&this.pushStateSet(t);var i=this._pooledMatrix.getOrCreateObject(),r=this._pooledMatrix.getOrCreateObject();if(e.getReferenceFrame()===w.a.RELATIVE_RF){var a=this.getCurrentProjectionMatrix();l.c.mul(r,a,e.getProjectionMatrix());var n=this.getCurrentModelViewMatrix();l.c.mul(i,n,e.getViewMatrix())}else l.c.copy(i,e.getViewMatrix()),l.c.copy(r,e.getProjectionMatrix());var o=this._computedNear,s=this._computedFar,u=this._pooledCullSettings.getOrCreateObject();if(u.reset(),u.setCullSettings(this),this._computedNear=Number.POSITIVE_INFINITY,this._computedFar=Number.NEGATIVE_INFINITY,this.setCullSettings(e),u.getSettingSourceOverrider()===this&&u.getEnableFrustumCulling()&&this.setEnableFrustumCulling(!0),this.pushCameraModelViewProjectionMatrix(e,i,r),e.getViewport()&&this.pushViewport(e.getViewport()),e.getRenderOrder()===M.a.NESTED_RENDER)this.handleCullCallbacksAndTraverse(e);else{var c=this.getCurrentRenderBin(),h=c.getStage(),d=this.createOrReuseRenderStage(this._rootRenderStage);d.setCamera(e),d.setClearDepth(e.getClearDepth()),d.setClearColor(e.getClearColor()),d.setClearMask(e.getClearMask());var p=e.getViewport()?e.getViewport():h.getViewport(),f=e.getScissor()?e.getScissor():h.getScissor();d.setViewport(p),d.setScissor(f),this.setCurrentRenderBin(d),this.handleCullCallbacksAndTraverse(e),this.setCurrentRenderBin(c),e.getRenderOrder()===M.a.PRE_RENDER?this.getCurrentRenderBin().getStage().addPreRenderStage(d,e.renderOrderNum):this.getCurrentRenderBin().getStage().addPostRenderStage(d,e.renderOrderNum)}this.popCameraModelViewProjectionMatrix(e),e.getViewport()&&this.popViewport(),this.setCullSettings(u),this._computedNear=o,this._computedFar=s,t&&this.popStateSet()},I=function(e){if(this._numMatrixTransform++,!this.isCulled(e,this.nodePath)){this.pushCurrentMask();var t=this._pooledMatrix.getOrCreateObject(),i=this.getCurrentModelViewMatrix();l.c.copy(t,i),e.computeLocalToWorldMatrix(t),this.pushModelViewMatrix(t);var r=e.getStateSet();r&&this.pushStateSet(r),this.handleCullCallbacksAndTraverse(e),r&&this.popStateSet(),this.popModelViewMatrix(),this.popCurrentMask()}},F=function(e){this._numProjection++;var t=this.getCurrentProjectionMatrix(),i=this._pooledMatrix.getOrCreateObject();l.c.mul(i,t,e.getProjectionMatrix()),this.pushProjectionMatrix(i);var r=e.getStateSet();r&&this.pushStateSet(r),this.handleCullCallbacksAndTraverse(e),r&&this.popStateSet(),this.popProjectionMatrix()},N=function(e){if(this._numNode++,!this.isCulled(e,this.nodePath)){this.pushCurrentMask();var t=e.getStateSet();t&&this.pushStateSet(t),this.handleCullCallbacksAndTraverse(e),t&&this.popStateSet(),this.popCurrentMask()}},V=function(e){this._numLightSource++;var t=e.getStateSet();t&&this.pushStateSet(t);var i=e.getLight();i&&(e.getReferenceFrame()===w.a.RELATIVE_RF?this.addPositionedAttribute(this.getCurrentModelViewMatrix(),i):this.addPositionedAttribute(null,i)),this.handleCullCallbacksAndTraverse(e),t&&this.popStateSet()},B=l.f.create(),U=!1,j=function(e){this._numGeometry++;var t=this.getCurrentModelViewMatrix(),i=e.getBoundingBox();if(!this._computeNearFar||!i.valid()||this.updateCalculatedNearFar(t,e)){var a=e.getCullCallback();if(!a||a.cull(e,this)){var o=e.getStateSet();o&&this.pushStateSet(o),this.postPushGeometry(this,e);var s=0;i.valid()&&(s=this.distance(i.center(B),t)),n.a.isNaN(s)?U||(r.a.warn("warning geometry has a NaN depth, "+t+" center "+B),U=!0):this.pushLeaf(e,s),this.prePopGeometry(this,e),o&&this.popStateSet()}}};f.default.registerApplyFunction(b.a.nodeTypeID,N),f.default.registerApplyFunction(x.a.nodeTypeID,N),f.default.registerApplyFunction(S.a.nodeTypeID,N),f.default.registerApplyFunction(M.a.nodeTypeID,R),f.default.registerApplyFunction(c.a.nodeTypeID,I),f.default.registerApplyFunction(d.a.nodeTypeID,F),f.default.registerApplyFunction(m.a.nodeTypeID,j),f.default.registerApplyFunction(T.a.nodeTypeID,I),f.default.registerApplyFunction(E.a.nodeTypeID,I),f.default.registerApplyFunction(h.a.nodeTypeID,I),f.default.registerApplyFunction(y.a.nodeTypeID,N),f.default.registerApplyFunction(p.a.nodeTypeID,V),f.default.registerApplyFunction(C.a.nodeTypeID,j),f.default.registerApplyFunction(L.a.nodeTypeID,j),t.a=k},function(e,t,i){"use strict";var r=i(9),a=i(21),n=i(71),o=i(447),s=i(216),u=i(184),l=i(587),c=function(){return[null,null]},h=function(e){n.a.call(this),this._renderStage=void 0,this._parent=void 0,this._binNum=0,this._sorted=!1,this._sortMode=void 0!==e?e:h.defaultSortMode,this._drawCallback=void 0,this._leafs=[],this._pooledPositionedAttribute=new s.a(c),this._positionedAttribute=new u.a,this._stateGraphList=new u.a,this._bins=new l.a,h.prototype.init.call(this,e)};h.SORT_BY_STATE=0,h.SORT_BACK_TO_FRONT=1,h.SORT_FRONT_TO_BACK=2,h.defaultSortMode=h.SORT_BY_STATE;var d=function(){return new h},p=new s.a(d);h.BinPrototypes={RenderBin:function(){return p.getOrCreateObject().init()},DepthSortedBin:function(){return p.getOrCreateObject().init(h.SORT_BACK_TO_FRONT)}};var f=function(e,t){return t._depth-e._depth},m=function(e,t){return e._depth-t._depth},g=function(e,t){return e._binNum-t._binNum};r.a.createPrototypeObject(h,r.a.objectInherit(n.a.prototype,{init:function(e){return this._renderStage=void 0,this._parent=void 0,this._binNum=0,this._sortMode=void 0!==e?e:h.defaultSortMode,this._drawCallback=void 0,h.prototype._initInternal.call(this),this},_initInternal:function(){this._bins.reset(),this._stateGraphList.reset(),this._positionedAttribute.reset(),this._pooledPositionedAttribute.reset(),this._leafs.length=0,this._sorted=!1},_createRenderBin:function(e){var t=h.BinPrototypes.RenderBin;return e&&h.BinPrototypes[e]&&(t=h.BinPrototypes[e]),t()},addPositionAttribute:function(e,t){var i=this._pooledPositionedAttribute.getOrCreateObject();i[0]=e,i[1]=t,this._positionedAttribute.push(i)},getStateGraphList:function(){return this._stateGraphList},getPositionedAttribute:function(){return this._positionedAttribute},copyLeavesFromStateGraphListToRenderLeafList:function(){this._leafs.length=0;for(var e=!1,t=this._stateGraphList.getArray(),i=this._stateGraphList.getLength(),r=0;r<i;r++)for(var n=t[r]._leafs,s=n.getArray(),u=n.getLength(),l=0;l<u;l++){var c=s[l];o.a.isNaN(c._depth)?e=!0:this._leafs.push(c)}e&&a.a.debug("warning: RenderBin::copyLeavesFromStateGraphListToRenderLeafList() detected NaN depth values, database may be corrupted."),this._stateGraphList.reset()},getSortMode:function(){return this._sortMode},sortBackToFront:function(){this.copyLeavesFromStateGraphListToRenderLeafList(),this._leafs.sort(f)},sortFrontToBack:function(){this.copyLeavesFromStateGraphListToRenderLeafList(),this._leafs.sort(m)},sortImplementation:function(){var e=h;switch(this._sortMode){case e.SORT_BACK_TO_FRONT:this.sortBackToFront();break;case e.SORT_FRONT_TO_BACK:this.sortFrontToBack();break;case e.SORT_BY_STATE:}},sort:function(){if(!this._sorted){for(var e=this._bins.getKeys(),t=this._bins.getMap(),i=e.getArray(),r=e.getLength(),a=0;a<r;a++){t[i[a]].sort()}this.sortImplementation(),this._sorted=!0}},setParent:function(e){this._parent=e},getParent:function(){return this._parent},getBinNumber:function(){return this._binNum},findOrInsert:function(e,t){var i=this._bins.getMap(),r=i[e];return r||(r=this._createRenderBin(t),r._parent=this,r._binNum=e,r._renderStage=this._renderStage,this._bins.set(e,r)),r},getStage:function(){return this._renderStage},addStateGraph:function(e){this._stateGraphList.push(e)},reset:function(){h.prototype._initInternal.call(this)},draw:function(e,t){var i=t;return i=this._drawCallback&&this._drawCallback.drawImplementation?this._drawCallback.drawImplementation(this,e,i):this.drawImplementation(e,i)},applyPositionedAttribute:function(e,t){for(var i=t.getArray(),r=t.getLength(),a=0,n=r;a<n;a++){var o=i[a],s=o[1],u=o[0];e.setGlobalDefaultAttribute(s),s.apply(e),s.applyPositionedUniform(u,e),e.haveAppliedAttribute(s)}},drawImplementation:function(e,t){for(var i=t,r=[],a=this._bins.getMap(),n=this._bins.getKeys(),o=n.getLength(),s=n.getArray(),u=0;u<o;u++){var l=s[u];r.push(a[l])}r.sort(g);for(var c,h=0,d=r.length;h<d&&(c=r[h],!(c.getBinNumber()>0));h++)i=c.draw(e,i);for(i=this.drawLeafs(e,i);h<d;h++)c=r[h],i=c.draw(e,i);return i},drawLeafs:function(e,t){for(var i,r=this._stateGraphList.getArray(),a=this._stateGraphList.getLength(),n=this._leafs,o=t,s=0,u=n.length;s<u;s++)i=n[s],i.render(e,o),o=i;for(var l=0,c=a;l<c;l++)for(var h=r[l],d=h._leafs.getArray(),p=h._leafs.getLength(),f=0;f<p;f++)i=d[f],i.render(e,o),o=i;return o}}),"osg","RenderBin"),h.reset=function(){p.reset()},h.clean=function(){p.clean()},t.a=h},function(e,t,i){"use strict";var r=i(21),a=i(9),n=i(71),o=i(143),s=function(){n.a.call(this)};s.checkPathIsAnimated=function(e){for(var t=0,i=e.length;t<i;++t){var r=e[t];if(r instanceof o.a)for(var a=r.getUpdateCallbackList(),n=0,u=a.length;n<u;++n)if(a[n]instanceof s)return!0}return!1},a.a.createPrototypeObject(s,a.a.objectInherit(n.a.prototype,{linkChannel:function(){},linkAnimation:function(e){var t=this.getName();if(0===t.length)return r.a.log("no name on an update callback, discard"),0;for(var i=0,a=e.getChannels(),n=0,o=a.length;n<o;n++){var s=a[n];s.getTargetName()===t&&(this.linkChannel(s),i++)}return i}}),"osgAnimation","AnimationUpdateCallback"),t.a=s},function(e,t,i){"use strict";var r=i(9),a=i(58),n=i(72),o=i(10),s=function(e,t){a.a.call(this);var i=void 0!==e?e:0;this._ambient=o.g.fromValues(.2,.2,.2,1),this._diffuse=o.g.fromValues(.8,.8,.8,1),this._specular=o.g.fromValues(.2,.2,.2,1),this._position=o.g.fromValues(0,0,1,0),this._direction=o.f.fromValues(0,0,-1),this._ground=o.g.fromValues(.2,.2,.2,-1),this._spotCutoff=180,this._spotBlend=.01,this._attenuation=o.g.fromValues(1,0,0,0),this._lightNumber=i,this._enable=!t,this._dirtyHash=!0,this._hash=""};s.DIRECTION="DIRECTION",s.SPOT="SPOT",s.POINT="POINT",s.HEMI="HEMI",s.uniforms={},r.a.createPrototypeStateAttribute(s,r.a.objectInherit(a.a.prototype,{attributeType:"Light",cloneType:function(){return new s(this._lightNumber,!0)},getTypeMember:function(){return this.attributeType+this._lightNumber},getUniformName:function(e){return"u"+this.getTypeMember()+"_"+e},getHash:function(){return this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!1,this._hash):this._hash},_computeInternalHash:function(){return this.getTypeMember()+this.getLightType()+this.isEnabled().toString()},getOrCreateUniforms:function(){var e=s,t=this.getTypeMember();return e.uniforms[t]?e.uniforms[t]:(e.uniforms[t]={viewPosition:n.a.createFloat4(this.getUniformName("viewPosition")),viewDirection:n.a.createFloat3(this.getUniformName("viewDirection")),modelViewMatrix:n.a.createMatrix4(this.getUniformName("modelViewMatrix")),modelViewNormalMatrix:n.a.createMatrix3(this.getUniformName("modelViewNormalMatrix")),ambient:n.a.createFloat4(this.getUniformName("ambient")),diffuse:n.a.createFloat4(this.getUniformName("diffuse")),specular:n.a.createFloat4(this.getUniformName("specular")),attenuation:n.a.createFloat4(this.getUniformName("attenuation")),spotCutOff:n.a.createFloat1(this.getUniformName("spotCutOff")),spotBlend:n.a.createFloat1(this.getUniformName("spotBlend")),ground:n.a.createFloat4(this.getUniformName("ground"))},e.uniforms[t])},isEnabled:function(){return this._enable},setEnabled:function(e){this._enable=e,this._dirtyHash=!0},setAmbient:function(e){o.g.copy(this._ambient,e)},getAmbient:function(){return this._ambient},setDiffuse:function(e){o.g.copy(this._diffuse,e)},getDiffuse:function(){return this._diffuse},setSpecular:function(e){o.g.copy(this._specular,e)},getSpecular:function(){return this._specular},setPosition:function(e){o.g.copy(this._position,e)},getPosition:function(){return this._position},setDirection:function(e){o.f.copy(this._direction,e)},getDirection:function(){return this._direction},setSpotCutoff:function(e){this._spotCutoff=e},getSpotCutoff:function(){return this._spotCutoff},setSpotBlend:function(e){this._spotBlend=e},getSpotBlend:function(){return this._spotBlend},setGround:function(e){o.f.copy(this._ground,e)},getGround:function(){return this._ground},setConstantAttenuation:function(e){this._attenuation[0]=e},getConstantAttenuation:function(){return this._attenuation[0]},setLinearAttenuation:function(e){this._attenuation[1]=e},getLinearAttenuation:function(){return this._attenuation[1]},setQuadraticAttenuation:function(e){this._attenuation[2]=e},getQuadraticAttenuation:function(){return this._attenuation[2]},setLightType:function(e){return e===s.DIRECTION?this.setLightAsDirection():e===s.SPOT?this.setLightAsSpot():e===s.HEMI?this.setLightAsHemi():this.setLightAsPoint()},getLightType:function(){return this.isDirectionLight()?s.DIRECTION:this.isSpotLight()?s.SPOT:this.isHemiLight()?s.HEMI:s.POINT},setLightAsSpot:function(){o.g.set(this._position,0,0,0,1),o.f.set(this._direction,0,0,-1),this._ground[3]=-1,this._spotCutoff=90,this._dirtyHash=!0},setLightAsPoint:function(){o.g.set(this._position,0,0,0,1),o.f.set(this._direction,0,0,-1),this._ground[3]=-1,this._dirtyHash=!0},setLightAsDirection:function(){o.g.set(this._position,0,0,1,0),this._spotCutoff=180,this._ground[3]=-1,this._dirtyHash=!0},setLightAsHemi:function(){o.g.set(this._position,0,0,1,0),this._spotCutoff=180,this._ground[3]=1,this._dirtyHash=!0},setLightNumber:function(e){this._lightNumber=e,this._dirtyHash=!0},getLightNumber:function(){return this._lightNumber},isSpotLight:function(){return this._spotCutoff<180},isDirectionLight:function(){return 0===this._position[3]&&-1===this._ground[3]},isHemiLight:function(){return 1===this._ground[3]},applyPositionedUniform:function(e){var t=this.getOrCreateUniforms(),i=t.modelViewMatrix.getInternalArray(),r=t.modelViewNormalMatrix.getInternalArray(),a=t.viewPosition.getInternalArray(),n=t.viewDirection.getInternalArray();o.c.copy(i,e),o.b.normalFromMat4(r,e),o.g.transformMat4(a,this._position,i),o.f.transformMat3(n,this._direction,r)},apply:function(){if(this._enable){var e=this.getOrCreateUniforms();if(this.isSpotLight()){var t=Math.cos(this._spotCutoff*Math.PI/180);e.spotCutOff.setFloat(t),e.spotBlend.setFloat((1-t)*this._spotBlend)}this.isHemiLight()&&e.ground.setFloat4(this._ground),e.attenuation.setFloat4(this._attenuation),e.diffuse.setFloat4(this._diffuse),e.specular.setFloat4(this._specular),e.ambient.setFloat4(this._ambient)}}}),"osg","Light"),t.a=s},function(e,t,i){"use strict";var r=i(21),a={instance:function(){return a._instance||(a._instance=a,a._instance.plugins=new window.Map),a._instance},addReaderWriter:function(e,t){void 0!==a.instance().plugins.get(e)&&r.a.warn("the '"+e+"' plugin already exists"),a.instance().plugins.set(e,t)},getReaderWriterForExtension:function(e){return a.instance().plugins.get(e)}};t.a=a},function(e,t,i){"use strict";var r=i(9),a=i(54),n=i(10),o=i(216),s=i(184),u=i(127),l=function(){a.a.call(this),this._intersector=void 0,this._projectionStack=new s.a,this._modelStack=new s.a,this._viewStack=new s.a,this._windowStack=new s.a,this._pooledMatrix=new o.a(n.c.create),this.reset()};r.a.createPrototypeObject(l,r.a.objectInherit(a.a.prototype,{reset:function(){this._pooledMatrix.reset(),this._viewStack.reset(),this._modelStack.reset(),this._projectionStack.reset(),this._windowStack.reset(),this._viewStack.push(n.c.IDENTITY),this._modelStack.push(n.c.IDENTITY),this._projectionStack.push(n.c.IDENTITY),this._windowStack.push(n.c.IDENTITY)},setIntersector:function(e){this._intersector=e},getIntersector:function(){return this._intersector},pushModelMatrix:function(e){this._modelStack.push(e)},getModelMatrix:function(){return this._modelStack.back()},popModelMatrix:function(){return this._modelStack.pop()},pushViewMatrix:function(e){this._viewStack.push(e)},getViewMatrix:function(){return this._viewStack.back()},popViewMatrix:function(){return this._viewStack.pop()},pushProjectionMatrix:function(e){this._projectionStack.push(e)},getProjectionMatrix:function(){return this._projectionStack.back()},popProjectionMatrix:function(){return this._projectionStack.pop()},pushWindowMatrix:function(e){this._windowStack.push(e)},pushWindowMatrixUsingViewport:function(e){this._windowStack.push(e.computeWindowMatrix(this._pooledMatrix.getOrCreateObject()))},getWindowMatrix:function(){return this._windowStack.back()},popWindowMatrix:function(){return this._windowStack.pop()},getTransformation:function(){var e=n.c.create64();return function(){return n.c.copy(e,this.getWindowMatrix()),n.c.mul(e,e,this.getProjectionMatrix()),n.c.mul(e,e,this.getViewMatrix()),n.c.mul(e,e,this.getModelMatrix()),e}}(),enter:function(e){return this._intersector.enter(e)},apply:function(e){e.getViewMatrix?this.applyCamera(e):e.getMatrix?this.applyTransform(e):this.applyNode(e)},applyCamera:function(e){var t=e.getViewport();void 0!==t&&this.pushWindowMatrixUsingViewport(t);var i,r,a;e.getReferenceFrame()===u.a.RELATIVE_RF&&this.getViewMatrix()&&this.getProjectionMatrix()?(i=n.c.mul(this._pooledMatrix.getOrCreateObject(),this.getProjectionMatrix(),e.getProjectionMatrix()),r=this.getViewMatrix(),a=n.c.mul(this._pooledMatrix.getOrCreateObject(),this.getModelMatrix(),e.getViewMatrix())):(i=e.getProjectionMatrix(),r=e.getViewMatrix(),a=n.c.identity(this._pooledMatrix.getOrCreateObject())),this.pushProjectionMatrix(i),this.pushViewMatrix(r),this.pushModelMatrix(a),this._intersector.setCurrentTransformation(this.getTransformation()),this.traverse(e),this.popModelMatrix(),this.popViewMatrix(),this.popProjectionMatrix(),void 0!==t&&this.popWindowMatrix(),this._intersector.setCurrentTransformation(this.getTransformation())},applyNode:function(e){if(this.enter(e))return e.getPrimitiveSetList?void this._intersector.intersect(this,e):void(e.traverse&&this.traverse(e))},applyTransform:function(e){if(this.enter(e)){if(e.getReferenceFrame()===u.a.ABSOLUTE_RF){var t=this._pooledMatrix.getOrCreateObject();this.pushViewMatrix(n.c.identity(t)),this.pushModelMatrix(e.getMatrix())}else if(this._modelStack.getLength()>0){var i=n.c.copy(this._pooledMatrix.getOrCreateObject(),this.getModelMatrix());n.c.mul(i,i,e.getMatrix()),this.pushModelMatrix(i)}else this.pushModelMatrix(e.getMatrix());this._intersector.setCurrentTransformation(this.getTransformation()),this.traverse(e),this.popModelMatrix(),e.getReferenceFrame()===u.a.ABSOLUTE_RF&&this.popViewMatrix(),this._intersector.setCurrentTransformation(this.getTransformation())}}}),"osgUtil","IntersectionVisitor"),t.a=l},function(e,t,i){"use strict";var r=i(9),a=i(10),n=i(598),o=i(807),s=function(){n.a.call(this),this._start=a.f.create(),this._iStart=a.f.create(),this._end=a.f.create(),this._iEnd=a.f.create(),this._threshold=0,this._iThreshold=0};r.a.createPrototypeObject(s,r.a.objectInherit(n.a.prototype,{set:function(e,t,i){a.f.copy(this._start,e),a.f.copy(this._iStart,e),a.f.copy(this._end,t),a.f.copy(this._iEnd,t),void 0!==i&&(this._threshold=this._iThreshold=i)},setStart:function(e){a.f.copy(this._start,e),a.f.copy(this._iStart,e)},setEnd:function(e){a.f.copy(this._end,e),a.f.copy(this._iEnd,e)},intersectNode:function(e){return this.intersectBoundingSphere(e.getBoundingSphere())},intersectBoundingSphere:function(){var e=a.f.create(),t=a.f.create();return function(i){if(!i.valid())return!1;a.f.sub(e,this._iStart,i.center());var r=a.f.sqrLen(e)-i.radius2();if(r<=0)return!0;a.f.sub(t,this._iEnd,this._iStart);var n=a.f.sqrLen(t),o=2*a.f.dot(e,t),s=o*o-4*n*r;if(s<0)return!1;s=Math.sqrt(s);var u=.5/n,l=(-o-s)*u,c=(-o+s)*u;return!(l<=0&&c<=0)&&!(l>1&&c>1)}}(),intersect:function(){var e=new o.a;return function(t,i){e.setGeometry(i),e.setIntersectionVisitor(t),e.setIntersector(this),e.set(this._iStart,this._iEnd,this._iThreshold);var r=i.getShape();if(r)return void r.intersectLineSegment(e,r.getNodes()[0],this._iStart,this._iEnd,this._iThreshold);i.computeTransformedVertices&&e.setVertices(i.computeTransformedVertices()),e.apply(i),e.reset()}}(),setCurrentTransformation:function(e){if(a.c.invert(e,e),this._threshold>0){var t=this._iStart;a.c.getScale(t,e);var i=t[0],r=t[1],n=t[2];this._iThreshold=this._threshold*(i>r?i>n?i:n:r>n?r:n)}a.f.transformMat4(this._iStart,this._start,e),a.f.transformMat4(this._iEnd,this._end,e)}}),"osgUtil","LineSegmentIntersector"),t.a=s},function(e,t,i){"use strict";var r=i(9),a=i(21),n=i(186),o=i(217),s=i(553),u=i(592),l=function(){this._cache={},this._shaderProcessor=new u.a,this._ShaderCompiler=void 0,this.setShaderCompiler(s.a)};l.prototype={setShaderCompiler:function(e){this._ShaderCompiler=e,e._validAttributeTypeMemberCache||this._computeStateAttributeCache(e)},getShaderCompiler:function(){return this._ShaderCompiler},getShaderProcessor:function(){return this._shaderProcessor},setShaderProcessor:function(e){this._shaderProcessor=e},filterAttributeTypes:function(e){return!(!e.isEnabled||e.isEnabled())},getActiveAttributeList:function(e,t){for(var i="",r=e._attributeArray,a=this._ShaderCompiler._validAttributeTypeMemberCache,n=0,o=a.length;n<o;n++){var s=a[n],u=s<r.length?r[s]:void 0;if(u){var l=u._lastApplied;l&&!this.filterAttributeTypes(l)&&(i+=l.getHash(),t.push(l))}}return i},getActiveAttributeListCache:function(e){for(var t="",i=this._ShaderCompiler._validAttributeTypeMemberCache,r=0,a=i.length;r<a;r++){var n=i[r],o=n<e._attributeArray.length?e._attributeArray[n]:void 0;if(o){var s=o._lastApplied;if(!s||this.filterAttributeTypes(s))continue;t+=o._lastApplied.getHash()}}return t},getActiveTextureAttributeListCache:function(e){for(var t="",i=this._ShaderCompiler._validTextureAttributeTypeMemberCache,r=e._textureAttributeArrayList,a=0;a<r.length;a++){var n=r[a];if(n)for(var o=n.length,s=0;s<i.length;s++){var u=i[s],l=u<o?n[u]:void 0;if(l){var c=l._lastApplied;if(!c||this.filterAttributeTypes(c)||c.isTextureNull())continue;t+=c.getHash()}}}return t},getActiveTextureAttributeList:function(e,t){var i,r,a="",n=e._textureAttributeArrayList,o=this._ShaderCompiler._validTextureAttributeTypeMemberCache;for(i=0,r=n.length;i<r;i++){var s=n[i];if(s){t[i]=[];for(var u=0,l=o.length;u<l;u++){var c=o[u],h=c<s.length?s[c]:void 0;if(h){var d=h._lastApplied;!d||this.filterAttributeTypes(d)||d.isTextureNull()||(a+=d.getHash(),t[i].push(d))}}}}return a},getActiveUniforms:function(e,t,i){for(var r={},a=0,n=t.length;a<n;a++){var o=t[a];if(o.getOrCreateUniforms){var s=o.getOrCreateUniforms();if(void 0!==s)for(var u in s){var l=s[u];r[l.getName()]=l}}}for(var c=0,h=i.length;c<h;c++){var d=i[c];if(d)for(var p=0,f=d.length;p<f;p++){var m=d[p],g=m.getOrCreateUniforms(c);for(var _ in g){var v=g[_];r[v.getName()]=v}}}return r},_computeStateAttributeCache:function(e){var t,i,n,o,s,u=e.stateAttributeConfig.attribute||[],l=[];for(i=0,n=u.length;i<n;i++)t=u[i],void 0!==(s=r.a.getIdFromTypeMember(t))&&(-1!==l.indexOf(s)?a.a.warn("Compiler "+e.name+" contains duplicate attribute entry "+t+", check the Compiler configuration"):l.push(s));for(o=new Uint8Array(l),e._validAttributeTypeMemberCache=o,u=e.stateAttributeConfig.textureAttribute||[],l=[],i=0,n=u.length;i<n;i++)t=u[i],s=r.a.getTextureIdFromTypeMember(t),-1!==l.indexOf(s)?a.a.warn("Compiler "+e.name+" contains duplicate texture attribute entry "+t+", check the Compiler configuration"):l.push(s);o=new Uint8Array(l),e._validTextureAttributeTypeMemberCache=o},getOrCreateProgram:function(){var e=[],t=[];return function(i){var r=this._ShaderCompiler,a=this.getActiveAttributeListCache(i)+this.getActiveTextureAttributeListCache(i),s=this._cache[a];if(void 0!==s)return s;t.length=0,e.length=0,this.getActiveAttributeList(i,t),this.getActiveTextureAttributeList(i,e);var u=new r(t,e,this._shaderProcessor),l=u.createFragmentShader(),c=u.createVertexShader(),h=new n.a(new o.a(o.a.VERTEX_SHADER,c),new o.a(o.a.FRAGMENT_SHADER,l));return h.hash=a,h.setActiveUniforms(this.getActiveUniforms(i,t,e)),h.generated=!0,this._cache[a]=h,h}}(),resetCache:function(){this._cache={}}},t.a=l},function(e,t,i){"use strict";var r=i(21),a=i(72),n=i(822),o=i(9),s=i(1061),u=i(1062),l=function(e,t,i){this._attributes=e,this._textureAttributes=t,this._fragmentShaderMode=!1,this._activeNodeMap={},this._compiledNodeMap={},this._traversedNodeMap={},this._variables={},this._varyings={},this._vertexShader=[],this._fragmentShader=[],this._shaderProcessor=i,this._texturesByName={},this._shadowsTextures=[],this._lights=[],this._shadows=[],this._textures=[],this._material=null,this._invariantPosition=!1,this._isBillboard=!1,this._customVertexShader=!1,this._customFragmentShader=!1,this.initAttributes(),this.initTextureAttributes()};l.cloneStateAttributeConfig=function(e){return JSON.parse(JSON.stringify(e.stateAttributeConfig))},l.setStateAttributeConfig=function(e,t){e.stateAttributeConfig=t,t.attribute.forEach(o.a.getOrCreateStateAttributeTypeMemberIndexFromName),t.textureAttribute.forEach(o.a.getOrCreateTextureStateAttributeTypeMemberIndexFromName),e.validAttributeTypeMember=t.attribute,e.validTextureAttributeTypeMember=t.textureAttribute},l.setStateAttributeConfig(l,{attribute:["Light0","ShadowReceive0","Light1","ShadowReceive1","Light2","ShadowReceive2","Light3","ShadowReceive3","Light4","Light5","Light6","Light7","Material","PointSize","Billboard","Morph","Skinning"],textureAttribute:["Texture"]}),l.prototype=o.a.extend({},s.a,u.a,{constructor:l,createFragmentShader:function(){return this._fragmentShaderMode=!0,this._createFragmentShader()},createVertexShader:function(){return this._fragmentShaderMode=!1,this._createVertexShader()},getOrCreateProjectionMatrix:function(){return this.getOrCreateUniform("mat4","uProjectionMatrix")},getCompilerName:function(){return this._material?"CompilerOSGJS":"NoMaterialCompilerOSGJS"},getFragmentShaderName:function(){var e=this.getCompilerName(),t=this._material&&this._material.getName();return t&&(t=t.replace(/[^a-zA-Z0-9]+/g,"_").slice(0,20),e+="("+t+")"),e},getVertexShaderName:function(){return this.getFragmentShaderName()},getDebugIdentifier:function(){var e=this.getVertexShaderName(),t=this.getFragmentShaderName();return e===t?t:e+"|"+t},logError:function(e){r.a.error(this.getDebugIdentifier()+" : "+e)},logWarn:function(e){r.a.warn(this.getDebugIdentifier()+" : "+e)},getOrCreateConstantOne:function(e){return this.getOrCreateConstant(e,e+"White").setValue(e+"(1.0)")},getOrCreateConstantZero:function(e){return this.getOrCreateConstant(e,e+"Black").setValue(e+"(0.0)")},initAttributes:function(){for(var e=this._attributes,t=this._lights,i=this._shadows,r=0,a=e.length;r<a;r++){var n=e[r].className();"Light"===n?t.push(e[r]):"Material"===n?this._material=e[r]:"ShadowReceiveAttribute"===n?i.push(e[r]):"Billboard"===n?this._isBillboard=!!e[r]:"SkinningAttribute"===n?this._skinningAttribute=e[r]:"MorphAttribute"===n?this._morphAttribute=e[r]:"PointSizeAttribute"===n&&(this._pointSizeAttribute=e[r])}},initTextureAttributes:function(){var e=this._textureAttributes,t=e.length;this._textures.length=this._shadowsTextures.length=t;for(var i=0;i<t;i++){var r=e[i];if(void 0!==r)for(var a=0,n=r.length;a<n;a++)this.registerTextureAttributes(r[a],i)}},registerTextureAttributes:function(e,t){var i=e.className();return"Texture"===i?this.registerTexture(e,t):-1!==i.indexOf("ShadowTexture")?this.registerTextureShadow(e,t):void 0},registerTexture:function(e,t){var i=e.getName();i||(i="Texture"+t,e.setName(i)),this._textures[t]=e,this._texturesByName[i]={texture:e,variable:void 0,textureUnit:t}},registerTextureShadow:function(e,t){var i=e.getName();i||(i="Texture"+t,e.setName(i)),this._shadowsTextures[t]=e,this._texturesByName[i]={texture:e,variable:void 0,textureUnit:t,shadow:!0}},getTextureByName:function(e){var t=this._texturesByName[e];if(!t||t.variable)return t;var i,r=t.texture,a=t.textureUnit,n=r.className(),o="Texture"+a;if("Texture"===n)i=this.getOrCreateSampler("sampler2D",o);else{if("TextureCubeMap"!==n)return;i=this.getOrCreateSampler("samplerCube",o)}var s=this._fragmentShaderMode?this.getOrCreateVarying("vec2","vTexCoord"+a):this.getOrCreateAttribute("vec2","TexCoord"+a);return t.variable=this.createTextureRGBA(r,i,s),t},createShaderFromGraphs:function(e){this._compiledNodeMap={};var t=[];for(var i in this._variables){var r=this._variables[i],a=r.declare();a&&t.push(a)}var n=this.evaluateExtensions(e),o=this.evaluateDefines(e),s=[];s.push("\n"),s.push(this.evaluateGlobalVariableDeclaration(e)),this._invariantPosition&&!this._fragmentShaderMode&&s.push("\ninvariant gl_Position;"),s.push("\n"),s.push(this.evaluateGlobalFunctionDeclaration(e)),s.push("void main() {"),0!==t.length&&(s.push("// vars\n"),s.push(t.join(" ")),s.push("\n// end vars\n")),0===e.length&&this.logError("shader without any final Node output (need at least one)"),s.push(this.evaluate(e)),s.push("}");var u=s.join("\n");return this._shaderProcessor.processShader(u,o,n,this._fragmentShaderMode?"fragment":"vertex")},_logLookForVariable:function(e,t){var i=[];for(var r in e)e[r]===t&&i.push(r);return i},getNode:function(){var e=n.a.getNode.apply(n.a,arguments);e||r.a.error("Unknown Node type : "+arguments[0]);var t=e.getID();return this._activeNodeMap[t]=e,e},getVariable:function(e){return this._variables[e]},getAttributeType:function(e){for(var t=0;t<this._attributes.length;t++)if(this._attributes[t].getType()===e)return this._attributes[t]},createVariable:function(e,t,i){var r=t;if(void 0===r){r="tmp_"+window.Object.keys(this._variables).length}else if(this._variables[r]){if(r+=i,void 0===i)return this.createVariable(e,t,1);if(this._variables[r])return i++,this.createVariable(e,t,i)}var a=this.getNode("Variable",e,r);return this._variables[r]=a,a},getOrCreateUniform:function(e,t,i){var r=t;if(e instanceof a.a){var n=e;e=n.getType(),r=n.getName()}else void 0===r&&this.logError("Cannot create unamed Uniform");var o=this._variables[r];if(o&&o.getType()===e)return o;var s=this.getNode("Uniform",e,r,i);return this._variables[r]=s,s},getOrCreateSampler:function(e,t){void 0===t&&this.logError("No name given for sampler type : "+e);var i=this._variables[t];if(i)return i;var r=this.getNode("Sampler",e,t);return this._variables[t]=r,r},getOrCreateAttribute:function(e,t){this._fragmentShaderMode&&this.logError("No Vertex Attribute in Fragment Shader");var i=this._variables[t];if(i)return i;var r=this.getNode("Attribute",e,t);return this._variables[t]=r,r},getOrCreateConstant:function(e,t){var i=t;if(void 0===i){i="tmp_"+window.Object.keys(this._variables).length}else{var r=this._variables[i];if(r)return r}var a=this.getNode("Constant",e,i);return this._variables[i]=a,a},getOrCreateVarying:function(e,t){void 0===t&&this.logError("Error: Mandatory to name varying (as you need to retrieve them)");var i=this._variables[t];return i?(this._varyings[t]||this.logError("Error: requesting a varying not declared with getOrCreateVarying previously"),i.getType()!==e&&this.logError("Error: Same varying, but different type"),i):(this._fragmentShaderMode||this._customFragmentShader||this.logError("Error: requesting a varying not declared in Fragment Shader Graph (for Custom Vertex Shader, add this._customFragmentShader to the processor): "+t+" "+e),i=this._variables[t]=this._varyings[t]=this.getNode("Varying",e,t))},markNodeAsVisited:function(e){var t=e.getID();this._activeNodeMap[t]===e?this._compiledNodeMap[t]=e:this.logWarn("Node not requested by using Compiler getNode and/or not registered in nodeFactory "+e.toString())},checkOrMarkNodeAsTraversed:function(e){var t=e.getID();return!!this._traversedNodeMap[t]||(this._traversedNodeMap[t]=e,!1)},traverse:function(e,t){if(!this.checkOrMarkNodeAsTraversed(t)){var i=t.getInputs();if(!Array.isArray(i)){var r=[];for(var a in i)r.push(i[a]);i=r}for(var n=0,o=i.length;n<o;n++){t.checkInputsOutputs();var s=i[n];s&&s!==t&&this.traverse(e,s)}e.call(e,t),this.markNodeAsVisited(t)}},_getAndInitFunctor:function(e){this._traversedNodeMap={};var t={},i=[];return e=e.bind(this,t,i),e._map=t,e._text=i,e},_functorEvaluateAndGatherField:function(e,t,i,r){var a=r.getType();void 0!==a&&""!==a||this.logError("Your node "+r+" has no type"),r[e]&&!t[a]&&(t[a]=!0,Array.prototype.push.apply(i,r[e]()))},evaluateAndGatherField:function(e,t){for(var i=this._getAndInitFunctor(this._functorEvaluateAndGatherField.bind(this,t)),r=0,a=e.length;r<a;r++)this.traverse(i,e[r]);return i._text},_functorEvaluateGlobalFunctionDeclaration:function(e,t,i){var r=i.getType();if(void 0!==r&&""!==r||this.logError("Your node "+i+" has no type"),i.globalFunctionDeclaration&&!e[r]){e[r]=!0;var a=i.globalFunctionDeclaration();a&&t.push(a)}},evaluateGlobalFunctionDeclaration:function(e){for(var t=this._getAndInitFunctor(this._functorEvaluateGlobalFunctionDeclaration),i=0,r=e.length;i<r;i++)this.traverse(t,e[i]);return t._text.join("\n")},_functorEvaluateGlobalVariableDeclaration:function(e,t,i){var r=i.getID();if(i.globalDeclaration&&!e[r]){e[r]=!0;var a=i.globalDeclaration();a&&t.push(a)}},evaluateGlobalVariableDeclaration:function(e){var t=this._getAndInitFunctor(this._functorEvaluateGlobalVariableDeclaration),i=0,r=e.length;for(i=0;i<r;i++)this.traverse(t,e[i]);var a=t._text,n=a.length;if(n>0){this.sortDeclarations(a);var o=a[0][0];for(i=0;i<n;++i){var s=a[i][0];s!==o&&(o=s,a[i-1]+="\n")}}return a.join("\n")},sortDeclarations:function(e){if(e.sort(),!this._fragmentShaderMode)for(var t=0,i=e.length;t<i;++t){var r=e[t];if("a"!==r[0])break;if(-1!==r.indexOf("Vertex")){e.splice(t,1),e.unshift(r);break}}},_functorEvaluate:function(e,t,i){var r=i.getID();if(!e[r]){e[r]=!0;var a=i.computeShader();if(a){var n=i.getComment&&i.getComment();n&&t.push(n),t.push(a)}}},evaluate:function(e){for(var t=this._getAndInitFunctor(this._functorEvaluate),i=0,r=e.length;i<r;i++)this.traverse(t,e[i]);return t._text.join("\n")},evaluateDefines:function(e){return this.evaluateAndGatherField(e,"getDefines")},evaluateExtensions:function(e){return this.evaluateAndGatherField(e,"getExtensions")},getOrCreateModelVertex:function(){if(this._fragmentShaderMode)return this.getOrCreateVarying("vec3","vModelVertex");var e=this._variables.modelVertex;return e||(e=this.createVariable("vec3","modelVertex"),this.getNode("MatrixMultPosition").inputs({matrix:this.getOrCreateUniform("mat4","uModelMatrix"),vec:this.getOrCreateLocalVertex()}).outputs({vec:e}),e)},getOrCreateModelNormal:function(){if(this._fragmentShaderMode)return this.getOrCreateVarying("vec3","vModelNormal");var e=this._variables.modelNormal;return e||(e=this.createVariable("vec3","modelNormal"),this.getNode("MatrixMultDirection").inputs({matrix:this.getOrCreateUniform("mat3","uModelNormalMatrix"),vec:this.getOrCreateLocalNormal()}).outputs({vec:e}),e)},getOrCreateModelTangent:function(){if(this._fragmentShaderMode)return this.getOrCreateVarying("vec4","vModelTangent");var e=this._variables.modelTangent;return e||(e=this.createVariable("vec4","modelTangent"),this.getNode("MatrixMultDirection").setOverwriteW(!1).inputs({matrix:this.getOrCreateUniform("mat3","uModelNormalMatrix"),vec:this.getOrCreateLocalTangent()}).outputs({vec:e}),e)},getOrCreateViewVertex:function(){if(this._fragmentShaderMode)return this.getOrCreateVarying("vec4","vViewVertex");var e=this._variables.viewVertex;return e||(e=this.createVariable("vec4","viewVertex"),this.getNode("MatrixMultPosition").inputs({matrix:this.getOrCreateUniform("mat4","uModelViewMatrix"),vec:this.getOrCreateLocalVertex()}).outputs({vec:e}),e)},getOrCreateViewNormal:function(){if(this._fragmentShaderMode)return this.getOrCreateVarying("vec3","vViewNormal");var e=this._variables.viewNormal;return e||(e=this.createVariable("vec3","viewNormal"),this.getNode("MatrixMultDirection").inputs({matrix:this.getOrCreateUniform("mat3","uModelViewNormalMatrix"),vec:this.getOrCreateLocalNormal()}).outputs({vec:e}),e)},getOrCreateViewTangent:function(){if(this._fragmentShaderMode)return this.getOrCreateVarying("vec4","vViewTangent");var e=this._variables.viewTangent;return e||(e=this.createVariable("vec4","viewTangent"),this.getNode("MatrixMultDirection").setOverwriteW(!1).inputs({matrix:this.getOrCreateUniform("mat3","uModelViewNormalMatrix"),vec:this.getOrCreateLocalTangent()}).outputs({vec:e}),e)}}),t.a=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),a=r.a.osg,n=!0,o=a.Timer.prototype.tick,s=function(){this.children=[],this.message="",this.parent=this},u={},l={},c=new s,h=c,d=function(e){console.log("%c"+e,"color:purple")};a.time=function(e){var t=new s;u[e]=t,t.start=o(),n&&(h.children.push(t),t.parent=h,h=t,t.timerMessage=e)},a.timeEnd=function(e){var t=u[e],i=e+" : "+(o()-t.start).toFixed(2)+"ms";if(!n)return void l.logMessage(i);h=t.parent||c,t.message=i};var p=function(e,t){var i=!e.message,r=e.children,a="";e!==c&&r.length>0&&(a=t+e.timerMessage+(i?"(pending)\n\n":"\n"));for(var n=e===c||i?"":"  |  ",o=0;o<r.length;++o)a+=p(r[o],t+n)+"\n";var s=e.parent===c||!e.parent.message,u=s&&e.timerMessage?"\n":"";return a+(t+e.message)+u};l.showMessage=function(){var e=p(c,"");e=e.replace(/(\n*$)/,""),e+="\n\n<<<<< Model Displayed! >>>>>",d(e),n=!1},l.logBound=function(e){var t=e.center(a.vec3.create()),i="Bound center : [ "+t[0]+", "+t[1]+", "+t[2]+" ]\n";i+="Bound radius : "+e.radius()+"\n";var r=e.getMin(),n=e.getMax();i+="Bbox min : [ "+r[0]+", "+r[1]+", "+r[2]+" ]\n",i+="Bbox max : [ "+n[0]+", "+n[1]+", "+n[2]+" ]\n",l.logMessage(i)},l.logMessage=function(e){if(!n)return d(e);var t=new s;t.message=e,h.children.push(t),t.parent=h},t.default=l},function(e,t,i){"use strict";var r=i(5),a=r.a.osg,n=function(){a.Light.apply(this,arguments)};n.DIRECTION=a.Light.DIRECTION,n.SPOT=a.Light.SPOT,n.POINT=a.Light.POINT,n.HEMI=a.Light.HEMI,a.createPrototypeStateAttribute(n,a.objectInherit(a.Light.prototype,{attributeType:"SketchfabLight",isDirectionLight:function(){return 0===this._position[3]&&(-1===this._ground[3]||0===this._ground[3])}}),"osgSketchfab","Light");var o=a.vec3.create();a.LightSource.prototype.computeBoundingSphere=function(e){if(a.Node.prototype.computeBoundingSphere.call(this,e),!e.valid())return e;if(void 0!==this._light&&this._referenceFrame===a.Transform.RELATIVE_RF){var t=this._light.getPosition();0!==t[3]&&e.expandByVec3(a.vec3.scale(o,t,1/t[3]))}return e},t.a=n},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(7)),n=i.n(a),o=i(5),s=i(187),u=i(1201),l=i.n(u),c=i(1202),h=i.n(c),d=i(107),p=i(34),f=i(37),m=i(554),g=i(113),_=i(16),v=o.a.osg,b=v.StateAttribute.OVERRIDE_ON,y=v.createTexturedFullScreenFakeQuadGeometry(),x=function(e,t){v.Camera.call(this),this.addChild(y),this.setNodeMask(0),this._outTexture=e,this._packedTextures=Object(r.clone)(t.getPackedTextures()),this._channels=t.getOrderedChannels().slice(),this._lastHash="",this.initPacking()};x.AUTO_RELEASE_GL=!1;var S=function(e){e.generateMipmap=function(){this._rttPass||v.Texture.prototype.generateMipmap.apply(this,arguments),this._rttPass=!1}};v.createPrototypeNode(x,v.objectInherit(v.Camera.prototype,{getNbChannels:function(){return this._channels.length},disablePacking:function(){this.setNodeMask(0);for(var e=this.getStateSet(),t=this.getNbChannels(),i=0;i<t;++i){var r=e.getTextureAttribute(i,"Texture");r&&r!==s.a.dummyTexture&&r.releaseGLObjects()}if(x.AUTO_RELEASE_GL){var a=this.frameBufferObject;a&&a.releaseGLObjects()}},initPacking:function(){var e=this.getOrCreateStateSet(),t=this._packedTextures,i=0,r=this._channels,a=r.length,n=v.Uniform.createInt4("uReadPacking"),o=n.getInternalArray();for(i=0;i<a;++i){var u=r[i],l=t[u].texture,c=l.getInternalFormat()===v.Texture.ALPHA;3===g.a.getDefaultComponentCount(u)?o[i]=c?3:2:o[i]=c?1:0}for(i=0;i<4;++i)e.setTextureAttributeAndModes(i,s.a.dummyTexture,b);this._outTexture.setTextureSize(1,1),this.setRenderOrder(v.Camera.PRE_RENDER,0),this.attachTexture(v.FrameBufferObject.COLOR_ATTACHMENT0,this._outTexture,v.Texture.TEXTURE_2D);var h=new v.Viewport(0,0,1,1);this.setReferenceFrame(v.Transform.ABSOLUTE_RF),this.setViewport(h),e.addUniform(v.Uniform.createInt(0,"uTexture0"),b),e.addUniform(v.Uniform.createInt(1,"uTexture1"),b),e.addUniform(v.Uniform.createInt(2,"uTexture2"),b),e.addUniform(v.Uniform.createInt(3,"uTexture3"),b),e.addUniform(n,b)},updatePacking:function(){var e=this._packedTextures,t=this._channels,i=t.length,r=0,a="";for(r=0;r<i;++r){var n=e[t[r]].texture;a+=""+n.getWidth()+n.getHeight()}if(a===this._lastHash)return 0;this._lastHash=a,this.setNodeMask(-1);var o=this.getStateSet(),s=0,u=0,l=0;for(r=0;r<i;++r){var c=e[t[r]].texture;s=Math.max(s,c.getWidth()),u=Math.max(u,c.getHeight()),o.setTextureAttributeAndModes(l++,c,b)}return this._outTexture.setTextureSize(s,u),this._outTexture.dirtyMipmap(),this._outTexture._rttPass=!0,this.setRenderOrder(v.Camera.PRE_RENDER,0),this.resetAttachments(),this.attachTexture(v.FrameBufferObject.COLOR_ATTACHMENT0,this._outTexture,v.Texture.TEXTURE_2D),this.getViewport().setViewport(0,0,s,u),s*u}}),"osgSketchfab","TexturePacker");var M=function(){v.Node.call(this),this.setCullCallback(this),this._program=d.a.createShader(h.a,l.a,"material-packer","MaterialPacker"),this._dirtyPackedTextures=[],this._cacheCameras={},this._currentPackingCameras=[],this._frameCount=-1,this._lowResDone=!1,this._highResDone=!0,this._allMaterialsPackingCalled=!1,n.a.all([p.a.getHighResLoaded(),p.a.getLowResBound()]).then(function(){this._highResDone=!1,f.a.draw()}.bind(this))};v.createPrototypeNode(M,v.objectInherit(v.Node.prototype,{addPackedTexture:function(e){this._allMaterialsPackingCalled&&this._dirtyPackedTextures.push(e)},removePackedTexture:function(e){var t=this._dirtyPackedTextures.indexOf(e);t>=0&&(this._dirtyPackedTextures[t]=void 0)},packAllMaterialsTextures:function(e){for(var t in e)for(var i=e[t].get("stateSet"),r=i.getNumTextureAttributeLists(),a=0;a<r;++a){var n=i.getTextureAttribute(a,"Texture");n&&n.getTexture&&n.getTexture()}this._allMaterialsPackingCalled=!0},resetCaches:function(){var e=this.frameBufferObject;e&&e.releaseGLObjects(),this._cacheCameras={},this._currentPackingCameras=[]},deleteUnusedCameras:function(e){var t={};for(var i in e)for(var r=e[i].get("stateSet"),a=r.getNumTextureAttributeLists(),n=0;n<a;++n){var o=r.getTextureAttribute(n,"Texture");if(o&&o.getTexture){var s=this._getHash(o);t[s]=!0}}var u=this._cacheCameras;for(var l in u)if(!t[l]){var c=u[l];c.disablePacking(),c.getParents()[0].removeChild(c),delete this._cacheTextures[l]}},packTextures:function(e){var t=e.getPackedTextures(),i=e.getOrderedChannels();if(0===i.length)return v.Texture.textureNull;var r=t[i[0]].texture;if(1===i.length)return r;var a=this._getHash(e);if(this._cacheCameras[a])return this._cacheCameras[a]._outTexture;var n=new s.a;S(n),n.setImageFormat(v.Texture.RGBA),n.setWrapS(r.getWrapS()),n.setWrapT(r.getWrapT()),n.setMagFilter(r.getMagFilter());var o=r.getMinFilter();n.setMinFilter(o),o===v.Texture.LINEAR_MIPMAP_LINEAR&&Object(_.a)().anisotropy&&n.setMaxAnisotropy(16);var u=new x(n,e);return u.getOrCreateStateSet().setAttributeAndModes(this._program,b),this._cacheCameras[a]=u,this.addChild(u),n},_getHash:function(e){var t="";if(e.getOrderedChannels().length<=1)return t;for(var i=e.getPackedTextures(),r=e.getOrderedChannels(),a=0;a<r.length;++a){var n=r[a],o=i[n].texture,s=g.a.getDefaultComponentCount(n);t+=o.getInstanceID()+"-"+s+"-"}return t},_createNewJobs:function(){var e=this._dirtyPackedTextures,t=e.length;if(t){for(var i=0;i<t;++i)e[i]&&e[i].getTexture();e.length=0}},_disableOldJobs:function(){var e=this._currentPackingCameras,t=e.length;if(!t)return 0;for(var i=0;i<t;++i)e[i].disablePacking();return e.length=0,f.a.draw(),t},_updateNewJobs:function(){for(var e=this._currentPackingCameras,t=this.getChildren(),i=t.length,r=0,a=0;a<i;++a){var n=t[a].updatePacking();if(n&&(e.push(t[a]),(r+=n)>=1048576))break}return e.length},_checkResolveHighResBound:function(){if(!this._highResDone){this._highResDone=!0,p.a.resolveHighResBound();var e=this.getChildren(),t=e.length;m.default.logMessage("Texture packing FBO Count : "+t),x.AUTO_RELEASE_GL=!0;for(var i=0;i<t;++i){var r=e[i].frameBufferObject;r&&r.releaseGLObjects()}}},_checkResolveLowResBound:function(){this._lowResDone||(this._lowResDone=!0,p.a.resolveLowResBound())},cull:function(){if(0===++this._frameCount)return!0;this._createNewJobs();var e=this._disableOldJobs(),t=this._updateNewJobs();return this._frameCount>1&&!e&&!t&&(this._checkResolveHighResBound(),this._checkResolveLowResBound()),!0}}));var w=new M;t.a=w},function(e,t,i){"use strict";var r=i(5),a=i(16),n=r.a.osg,o=function(){var e=n.WebGLCaps.instance().getWebGLParameter("MAX_TEXTURE_IMAGE_UNITS");return Math.min(e,Object(a.a)().maxTextureUnits)};t.a=o},function(e,t,i){"use strict";var r=i(5),a=i(43),n=i(146),o=r.a.osg,s=function(){o.CullVisitor.call(this),this._separateVR=!1,this._isEnv=!1},u=s.vrConfig={doVR:!1,leftRenderWidth:0,rightRenderWidth:0,leftRenderHeight:0,rightRenderHeight:0,rightProjection:o.mat4.create(),leftProjection:o.mat4.create(),leftOffsetView:o.mat4.create(),rightOffsetView:o.mat4.create()};o.createPrototypeObject(s,o.objectInherit(o.CullVisitor.prototype,{popCameraModelViewProjectionMatrix:function(e){this.popModelViewMatrix(),this.popProjectionMatrix(e)},reset:function(){o.CullVisitor.prototype.reset.call(this),this._minNear=this._computedNear,this._maxFar=this._computedFar},updateNearFar:function(){this._minNear=Math.min(this._minNear,this._computedNear),this._maxFar=Math.max(this._maxFar,this._computedFar)},_handleMainCamera:function(e){var t=this.getCurrentProjectionMatrix(),i=this._computedNear,r=this._computedFar,a=this._nearFarRatio,s=this._projectionMatrixStack.getArray()[0];o.mat4.copy(s,t),this.clampProjectionMatrix(s,this._minNear,this._maxFar,1e-5),u.doVR&&(this.clampProjectionMatrix(u.leftProjection,i,r,a),this.clampProjectionMatrix(u.rightProjection,i,r,a));var l=n.a.uNearFar.getInternalArray();this.clampProjectionMatrix(t,i,r,a,l),e.clampedProjectionMatrix?o.mat4.copy(e.clampedProjectionMatrix,t):e.clampedProjectionMatrix=o.mat4.clone(t)},popProjectionMatrix:function(e){if(!0===this._computeNearFar&&this._computedFar>=this._computedNear){var t="PostProcess - MainCamera"===e.getName();(t||e.getReferenceFrame()===o.Transform.RELATIVE_RF&&!e.isRenderToTextureCamera())&&this.updateNearFar(),t?this._handleMainCamera(e):this.clampProjectionMatrix(this.getCurrentProjectionMatrix(),this._computedNear,this._computedFar,this._nearFarRatio)}o.CullStack.prototype.popProjectionMatrix.call(this)},handleCullCallbacksAndTraverse:function(e){var t=u.doVR&&(this._nodeOut===e||"PostProcess - node Out"===e.getName());t&&(this._nodeOut=e,this._separateVR=!0);var i=this._nodeEnv===e||"Environment - Camera"===e.getName();i&&(this._nodeEnv=e,this._isEnv=!0);var r=e.getCullCallback();r&&!r.cull(e,this)||this.traverse(e),i&&(this._isEnv=!1),t&&(this._separateVR=!1)},pushLeaf:function(e,t){var i=this._currentStateGraph._leafs;0===i.getLength()&&this._currentRenderBin.addStateGraph(this._currentStateGraph);var r=this._separateVR&&this.traversalMask!==a.a.SHADOW,n=this.createOrReuseRenderLeaf();if(n.isVR=r,r){var s=this._isEnv,l=this.getCurrentModelViewMatrix(),c=this.getCurrentViewMatrix();n.leftProjection=u.leftProjection,n.rightProjection=u.rightProjection;var h=n.leftModelView||o.mat4.create(),d=n.rightModelView||o.mat4.create();n.leftModelView=s?o.mat4.copy(h,l):o.mat4.multiply(h,u.leftOffsetView,l),n.rightModelView=s?o.mat4.copy(d,l):o.mat4.multiply(d,u.rightOffsetView,l);var p=n.leftView||o.mat4.create(),f=n.rightView||o.mat4.create();n.leftView=s?o.mat4.copy(p,c):o.mat4.multiply(p,u.leftOffsetView,c),n.rightView=s?o.mat4.copy(f,c):o.mat4.multiply(f,u.rightOffsetView,c)}n.init(this._currentStateGraph,e,this.getCurrentProjectionMatrix(),this.getCurrentViewMatrix(),this.getCurrentModelViewMatrix(),this.getCurrentModelMatrix(),t),i.push(n)}}),"osgSketchfab","CullVisitor"),t.a=s},function(e,t,i){"use strict";var r=i(437),a=i(5),n=i(613),o=i(419),s=i.n(o),u=i(7),l=i.n(u),c=i(42),h=i.n(c),d=i(3),p=i.n(d),f=i(0),m=(i.n(f),i(670)),g=i(16),_=i(187),v=a.a.osg,b=new s.a({device:"VWR",listen:!0}),y={},x=function(e){return 1<<Math.ceil(Math.log2(e))},S=function(e){var t,i,r,a=0;if(0===e.length)return a;for(t=0,r=e.length;t<r;t++)i=e.charCodeAt(t),a=(a<<5)-a+i,a|=0;return"vr-browser-"+a},M=function(e,t,i,r,a,o){n.a.call(this,e,t,i,r,a,o),this._uPaginate=void 0,this._textureWidth=1024,this._textureHeight=1024,this._useCache=!1};M.prototype=v.objectInherit(n.a.prototype,{initialize:function(e,t,i){m.a&&!Object(g.a)().isApp||(t=Object(f.extend)({},t),r.a.getBaseVR(function(r){this._styles=r.vrStyles,this._appendVrElement();var a=p()(r.TEMPLATES.getFromMacro(e,"panel",[t]));this._templatePath=e,a.css("position","absolute"),a.css("top","0"),a.css("left","0"),this._$uiPanelsDiv.append(a);var n=this._extractMetaData(a);if(this._useCache){var o=S(a.html()),s=localStorage.getItem(o);if(s){var u=new Image;return u.crossOrigin="anonymous",u.onload=function(){var e=new v.Texture;e.setTextureSize(1,1),e.setImage(u),this._applyTexture(e,n,i)}.bind(this),u.src=s,void a.remove()}}if(!Object(g.a)().vrGenerateUiTextures)return i(_.a.dummyTexture,n),void a.remove();this._rasterizeElement(r.rasterizeHTML,a).then(function(e){if(this._useCache){var t=e.toDataURL(),i=S(a.html());this._storeInCache(i,t)}var r=new v.Texture;return r.setTextureSize(1,1),r.setImage(e),r}.bind(this)).then(function(e){this._applyTexture(e,n,i)}.bind(this)),a.remove()}.bind(this)))},_storeInCache:function(e,t){try{localStorage.setItem(e,t)}catch(r){localStorage.removeItem(localStorage.key(0));for(var i=0;i<localStorage.length&&0!==localStorage.key(i).indexOf("vr-browser-");i++)localStorage.removeItem(localStorage.key(i));this._storeInCache(e,t)}},setUseCache:function(e){this._useCache=e||!1},_applyTexture:function(e,t,i){this.isInitialized()?(this.changeTexture(e),this.updateMetaData(t)):n.a.prototype.initialize.call(this,e,t),i&&i(e,t)},_appendVrElement:function(){this._$uiPanelsDiv=p()("#vr-ui-panels"),this._$uiPanelsDiv.length||(this._$uiPanelsDiv=p()('<div id="vr-ui-panels" style="position:absolue; top:0;bottom:0;left:0;right:0; background:transparent"/>'),p()("body").append(this._$uiPanelsDiv),this._$uiPanelsDiv.append('<style id="vr-panel-style">'+this._styles+"</style>"))},_rasterizeElement:function(e,t){var i=document.createElement("canvas");return i.width=t.outerWidth(),i.height=t.outerHeight(),e.drawHTML(this._$uiPanelsDiv.prop("outerHTML"),i,{cacheBucket:y,cache:"all"}).then(function(e){if(h.a.apple.phone){var t="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(e.svg))),r=Object(f.uniqueId)("rasterize");return b.createMessage({data:{_key:r,height:i.height+"",width:i.width+"",svg:t}}).appendToHash(),new l.a(function(e){b.on("message:"+r,function(t){var i=new Image;i.crossOrigin="anonymous";var r;i.onload=function(){e(i)},t.b64&&(r=t.b64),t.data.b64&&(r=t.data.b64),r.indexOf("%3D")>-1&&(r=decodeURIComponent(r)),-1===r.indexOf("data:image/png")&&(r="data:image/png;base64,"+r),i.src=r})})}if(this._textureWidth=x(i.width),this._textureHeight=x(i.height),i.width===this._textureWidth&&i.height===this._textureHeight)return i;var a=document.createElement("canvas");return a.width=this._textureWidth,a.height=this._textureHeight,a.getContext("2d").drawImage(i,0,0,this._textureWidth,this._textureHeight),a}.bind(this),function(e){console.log(e)})},_extractMetaData:function(e){var t=e.find(".page"),i=e.outerHeight(!0),r=e.outerWidth(!0),a={id:e.attr("id"),width:r,height:i,cells:[],pages:[]};if(0===t.length)this._extractButtons(e,a,0,"default");else for(var n=0;n<t.length;n++)this._extractButtons(p()(t[n]),a,n,t[n].id);return this._extractCells(e,a),a},_extractButtons:function(e,t,i,r){if(r){var a=e.find("button"),n=e.offset().top,o=e.offset().left,s=e.outerHeight(!0),u=e.outerWidth(!0);t.pages[i]={id:r,num:i,x:o,y:n,width:u,height:s,items:[],areas:[]};for(var l=0;l<a.length;l++){var c=a[l].id,h=a[l].disabled;if(c&&!h){var d=p()(a[l]),f=v.vec4.create();f[0]=d.offset().left-o,f[1]=f[0]+d.outerWidth(),f[2]=d.offset().top-n,f[3]=f[2]+d.outerHeight(),f[0]>t.width&&(f[0]%=t.width),f[1]>t.width&&(f[1]%=t.width),t.pages[i].items.push(c),t.pages[i].areas.push(f)}}}},_extractCells:function(e,t){for(var i=e.find(".cell"),r=e.offset().top,a=e.offset().left,n=0,o=1/0,s=1/0,u=0,l=0;l<i.length;l++){var c=i[l].id;if(c){var h=p()(i[l]),d={};d.id=c,d.x=h.offset().left-a,d.y=h.offset().top-r;var f=h.css("z-index");d.z=isNaN(f)?0:f,d.width=h.outerWidth(!1),d.height=h.outerHeight(!1);var m=d.x+d.width;m>n&&(n=m),d.x<o&&(o=d.x);var g=d.y+d.height;g>u&&(u=g),d.y<s&&(s=d.y),t.cells[l]=d}}0===i.length?(t.cellsWidth=e.outerWidth(!1),t.cellsHeight=e.outerHeight(!1)):(t.cellsWidth=n-o,t.cellsHeight=u-s)}}),t.a=M},,function(e,t){!function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/components/molecules/popup.jinja"]=function(){function e(e,t,i,r,a){var n="";try{var o=null,s=r.makeMacro([],["options"],function(a){var n=i;i=new r.Frame,a=a||{},a.hasOwnProperty("caller")&&i.set("caller",a.caller),i.set("options",a.hasOwnProperty("options")?a.options:{});var o="";return o+='\n    <section style="',o+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"width")?"width:"+r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"width")+"px":"",e.opts.autoescape),o+='" class="c-popup ',o+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"className"),e.opts.autoescape),o+='">\n        <header class="c-popup__header">\n            <div class="c-popup__title">\n                ',o+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"title"),e.opts.autoescape),o+='\n            </div>\n\n            <div class="c-popup__actions">\n                ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"isClosable")&&(o+='\n                    <a class="c-popup__close" data-action="close">\n                        <i class="fa fa-times"></i>\n                    </a>\n                '),o+='\n            </div>\n        </header>\n\n        <div class="c-popup__content">\n            ',o+=r.suppressValue(e.getFilter("component").call(t,r.memberLookup(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"components"),"child")),e.opts.autoescape),o+="\n        </div>\n    </section>\n",i=n,new r.SafeString(o)});t.addExport("popup"),t.setVariable("popup",s),n+="\n",o?o.rootRenderFunc(e,t,i,r,a):a(null,n)}catch(e){a(r.handleError(e,null,null))}}return{root:e}}()}()},function(e,t,i){"use strict";var r=i(5),a=i(420),n=r.a.osg,o=r.a.osgShader,s=function(){a.a.apply(this,arguments),this._isLighted=!1},u=o.Compiler.cloneStateAttributeConfig(a.a);u.attribute=["VertexCompression","SketchfabMaterial","Morph","Skinning","PointSize"],o.Compiler.setStateAttributeConfig(s,u),n.createPrototypeObject(s,n.objectInherit(a.a.prototype,{getCompilerName:function(){return"Shadeless"},getOrCreateChannel:function(e){switch(e){case"Opacity":case"DiffuseColor":case"EmitColor":case"DiffuseIntensity":case"Displacement":return a.a.prototype.getOrCreateChannel.call(this,e)}},registerTextureEnvironment:function(){},registerTextureShadow:function(){}})),t.a=s},,function(e,t,i){"use strict";i.d(t,"a",function(){return d});var r=i(0),a=(i.n(r),i(31)),n=i(4),o=i(130),s=i(2),u=i(76),l=i(443),c=Object(r.curry)(function(e,t){return e+t}),h=function(e,t){return Object(o.b)(e,{},function(e){return e.value===t})},d=a.a.extend({displayName:"DropdownOptionList",mixins:[u.a],optionTypes:{value:s.b.string.isRequired,options:s.b.arrayOf(s.b.shape({title:s.b.string.isRequired,value:s.b.string.isRequired,default:s.b.bool}).isRequired).isRequired,onSelectOption:s.b.func.isRequired,dropdown:s.b.shape({isOpen:s.b.bool.isRequired,onToggle:s.b.func.isRequired,scrollToHeightPercent:s.b.func.isRequired}).isRequired,color:s.b.string,theme:s.b.string,closeOnSelection:s.b.bool},events:{'click [data-action="select-option"]':"onOptionClick",'mouseenter [data-action="select-option"]':"onMouseEnterOption",'mouseleave [data-action="select-option"]':"onMouseLeaveOption","keydown window":"onWindowKeyDown"},viewDidMount:function(){this.updateScrollPosition()},viewDidUpdate:function(){this.updateScrollPosition()},getSelectedIndex:function(){return this.options.options.indexOf(h(this.options.options,this.options.value))},onOptionClick:function(e){this.options.onSelectOption(e.target.getAttribute("data-value")),this.options.closeOnSelection&&this.options.dropdown.isOpen&&this.options.dropdown.onToggle()},onMouseEnterOption:function(e){e.target.style.color=this.options.color},onMouseLeaveOption:function(e){e.target.getAttribute("data-active")||(e.target.style.color="")},onWindowKeyDown:function(e){this.options.dropdown.isOpen&&this.options.options.length&&(38!==e.which&&40!==e.which||e.preventDefault(),38===e.which&&this.selectIndex(c(-1)),40===e.which&&this.selectIndex(c(1)))},selectIndex:function(e){var t=this.getSelectedIndex(),i=this.options.options.length,r=(i+e(t))%i;this.options.onSelectOption(this.options.options[r].value),this.scrollAtNextRender=!0},scrollToSelectedOption:function(){var e=(this.getSelectedIndex()-1)/this.options.options.length;this.options.dropdown.scrollToHeightPercent(e)},updateScrollPosition:function(){this.scrollAtNextRender&&(this.scrollAtNextRender=!1,this.scrollToSelectedOption())},template:function(){return n.default.getFromString(["<ul class=\"c-dropdown-select {{ '--' + theme + '-theme' if theme else '' }}\">","    {% for optionItem in options %}","        {% set isActive = optionItem.value == value %}","        <li",'            class="c-dropdown-select__option {{ {',"                '--active': isActive",'            } | class_names }}"','            style="{{ {',"                'color': color if isActive else ''",'            } | style }}"','            {% if isActive %} data-active="true" {% endif %}','            data-value="{{ optionItem.value }}"','            data-action="select-option">',"            {{ optionItem.title }}","        </li>","    {% endfor %}","</ul>"].join("\n"),{options:this.options.options,value:this.options.value,color:this.options.color,theme:this.options.theme})}});t.b=a.a.extend({displayName:"DropdownSelect",optionTypes:{value:s.b.string.isRequired,onChange:s.b.func.isRequired,options:s.b.arrayOf(s.b.shape({title:s.b.string.isRequired,value:s.b.string.isRequired,default:s.b.bool}).isRequired).isRequired,title:s.b.string,placeholder:s.b.string,color:s.b.string,theme:s.b.oneOf(["dark","light","white-background","grey-background"]),menuAlign:s.b.oneOf(["left","right"]),disabled:s.b.bool,closeOnSelection:s.b.bool,autoScale:s.b.bool},defaultOptions:{theme:"light",closeOnSelection:!0,autoScale:!1},initialize:function(){a.a.prototype.initialize.apply(this,arguments);var e=this.getDefaultValue();!this.options.value&&e&&this.options.onChange(e)},getDefaultValue:function(){return Object(o.b)(this.options.options,{},function(e){return e.default}).value},template:function(){return n.default.getFromString("{{ components.dropdown | component }}",{components:this.createChildrenComponents({dropdown:{viewClass:l.a,options:{disabled:this.options.disabled,labelTitle:this.options.title,labelValue:h(this.options.options,this.options.value).title,longestLabelValue:this.options.autoScale?this.options.options.reduce(function(e,t){return e.length>t.title.length?e:t.title},""):"",placeholder:this.options.placeholder,color:this.options.color,theme:this.options.theme,className:this.options.className,menuAlign:this.options.menuAlign,child:{viewClass:d,options:{value:this.options.value,options:this.options.options,color:this.options.color,theme:this.options.theme,closeOnSelection:this.options.closeOnSelection,onSelectOption:this.options.onChange}}}}})})}})},,,,,,function(e,t,i){"use strict";function r(e,t,i){return s.a.resolve(n.a.ajax({url:e,type:"GET",allowPrefetching:!1}).then(function(a,n,o){var u="function"==typeof t?t(i||1e3):t||1e3;return 202===o.status?s.a.delay(u).then(r.bind(null,e,t,u)):s.a.resolve(a)}))}t.a=r;var a=i(3),n=i.n(a),o=i(7),s=i.n(o)},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(4));t.a=function(e){var t={fileTypes:function(e,t){var i=t.name.replace(/^.*\.([^.]*)$/,"$1").toLowerCase();if(-1===e.indexOf(i))return{type:"fileTypes",message:"<p>Unsupported format. Please upload a "+e.join(", ").toUpperCase()+".</p>"}},maxFileSize:function(e,t){if(!(t.size<e)){var i=Math.floor(e/1024/1024)+"MB",r=Math.ceil(t.size/1024/1024)+"MB";return{type:"maxFileSize",message:a.default.getFromString('<p>The {{ fileName | default("selected") }} image file size is too large. The maximum file size is {{ maxSizeLabel}} (your file is {{ currentSizeLabel }}).<p/>',{fileName:t.name,maxSizeLabel:i,currentSizeLabel:r})}}}},i={fileTypes:"<p>The file type you tried to upload is not currently supported by Sketchfab.</p>",maxFileSize:'        <p>To reduce your file size, you can:</p>        <ul class="--disc">            <li>resize your image to a lower resolution.</li>            <li>use a more efficient file format like JPEG.</li>            <li>reduce the JPEG quality.</li>        </ul>        '};return{name:"Validator",validateFile:function(i,a){if(null==e)return console.error("Ruleset not defined");var n,o=[];return Object(r.each)(e,function(e,r){(n=t[r](e,i))&&o.push(n)}),a?o.length>0?o:void 0:this.concatErrorMessages(o)},concatErrorMessages:function(e){return e.reduce(function(e,t){return e.concat(e,t.message)},"")},getExtraErrorInformation:function(e){return i[e]}}}},function(e,t,i){"use strict";var r=i(79),a=i(55),n=i(41),o=i(5),s=i(7),u=i.n(s),l=i(1337),c=i(16),h=i(47),d=i(118),p=i(42),f=i.n(p),m=i(83),g=i(458),_=o.a.osg,v=function(){if(this._volume=Number(a.a.get("volume",1)),this._sounds=[],this._context=void 0,this._enabled=!1,this._tabVisible=!0,this._isPlaying=!1,this._waiting=!Object(h.a)(),this._has3D=!1,this._muted=!1,this._unlockBound=this._unlock.bind(this),this._lockBound=this._lock.bind(this),this._forcePlayBound=function(){this.forcePlay(this._isPlaying)}.bind(this),this._hasSounds=!1,this._willHaveSounds=void 0,!(window.AudioContext||window.webkitAudioContext))return void(this._willHaveSounds=!1);if(Object(h.a)()&&(this._willHaveSounds=!0),!this._willHaveSounds){var e=Object(c.a)().model;if(!e){var t=window.location.href.match(/\/models\/((.+)(?:\/)+|(.+))/);t&&t.length>3&&(e=t[2]?t[2]:t[3])}e&&n.a.get(e).then(this.checkWillHaveSounds.bind(this))}this._authErrors=this.featureDetectSoundAuthGestureNeeded(),this._resetPlayedOnceFromAuthGesture(),this._enablingAuthAudio=!1,this._firstEnter=!0,this._readyForErrorMessage=new m.a,this._audioContextTriesCount=0,window.addEventListener("beforeunload",this.exit.bind(this)),this._contextClosePending=!1,this._radius=1,r.a.getBoxReady().then(function(){if(this.getHas3D()){this._radius=r.a.getModelBoxWithoutDisplacement().radius();for(var e=0;e<this._sounds.length;e++){var t=this._sounds[e];t.setMaxDistance(t.getModel().get("distanceMax")),t.setRefDistance(t.getModel().get("distance")),t.updatePosition(Object(g.d)(t.getModel()))}}}.bind(this))};v.prototype={release:function(){if(this._context&&!this._releasePending){var e;this._releasePendingPromises=[];for(var t=0;t<this._sounds.length;t++)(e=this.releaseSound(this._sounds[t]))&&this._releasePendingPromises.push(e);var i=this._context.close;i&&(e=this._context.close(),e?(this._contextClosePending=!0,e.then(function(){this._contextClosePending=!1,this._context=void 0}.bind(this)),this._releasePendingPromises.push(e)):i=!1),this._releasePending=u.a.all(this._releasePendingPromises),this._releasePending.finally(function(){i||(this._context=void 0),this._releasePendingPromises=void 0,this._releasePending=void 0}.bind(this))}},releaseSound:function(e){if(e&&(this.disconnectSound(e),e._mediaElementSource&&(e._mediaElementSource.disconnect(),e._mediaElementSource=void 0),e._player)){e._player.volume=0,e.pause();var t=e.playerPause();return t.then(e.releasePlayerBound),e.isSoundAsync()&&(e._exitTime=e._player.currentTime),e._player=void 0,e.isPlayerPlaying()||e.releasePlayer(),t}},removeSound:function(e){e&&(this.releaseSound(e),this._sounds.splice(this._sounds.indexOf(e),1))},reset:function(){if(this._releasePending)return void this._releasePending.then(this.reset.bind(this));this._audioContextTriesCount=0,this._hasSounds&&!this._firstEnter&&this.forcePlay(this._isPlaying)},enableTapRequestPopup:function(){this._osdProxyModel&&this._willHaveSounds&&!Object(h.a)()&&this._osdProxyModel.trigger("sound-show","Tap/Click to play sounds",{position:"top",duration:1/0})},exit:function(){this._context&&(this.release(),this._firstEnter=!1,this._lock())},enter:function(){this.reset()},checkWillHaveSounds:function(e){if(void 0!==this._willHaveSounds)return this._willHaveSounds;var t=e.get("options").sound;if(!t||!t.soundtracks||!t.soundtracks.length)return this._willHaveSounds=!1,!1;if(!f.a.apple.device)return this._willHaveSounds=!0,!0;for(var i,r=0,a=t.soundtracks.length;r<a;r++)if(t.soundtracks[r].ambient){i=r;break}return void 0!==i?(t.soundtracks.length>1&&(t.soundtracks.splice(i+1,t.soundtracks.length-i),t.soundtracks.splice(0,i)),this._willHaveSounds=!0,!0):(t.soundtracks.length=0,this._willHaveSounds=!1,!1)},setProxyModel:function(e){this._osdProxyModel=e,this._readyForErrorMessage&&this._readyForErrorMessage.resolve()},getProxyModel:function(){return this._osdProxyModel},getOrCreateAudioContext:function(e){if(this._willHaveSounds&&this._enabled&&!this._waiting&&this._tabVisible){if(this._context&&!this._contextClosePending)return this._context;var t=window.AudioContext||window.webkitAudioContext;try{return this._context=e?new t:new t({latencyHint:"interactive"}),"suspended"===this._context.state?void this._context.resume().then(function(){this._unlockBound()}.bind(this)).catch(function(){this._authErrors=!0,this._lock()}.bind(this)):(this._audioContextTriesCount&&this.forcePlay(this._isPlaying),this._context)}catch(e){if(e instanceof TypeError){if(_.debug(e.message),this.getOrCreateAudioContext(!0),this._context)return this._context}else if("An AudioContext in a cross origin iframe must be created or resumed from a user gesture to enable audio output."===e.message)return this._authErrors=!0,this.pendingToPlayResolved(),void this._lock();this._readyForErrorMessage.promise.then(function(){this._audioContextTriesCount++,this._audioContextTriesCount<5?setTimeout(function(){this.getOrCreateAudioContext()}.bind(this),200):this._osdProxyModel.trigger("sound-error",new Error('Your browser can not play additional sounds and this page must be reloaded. If the problem persists, try to restart your browser. <a style="color: -webkit-link; cursor: auto; text-decoration: underline;" href="javascript:window.location.reload()">reload</a>'),{position:"top",duration:1/0})}.bind(this))}return this._context}},_createAudio:function(){var e=document.createElement("audio");return e.loop=!0,e.volume=1,e.muted=!0,e.preload="auto",e.crossOrigin="anonymous",e},addSound:function(e,t){return this._hasSounds=!0,this._playedOnceFromAuthGesture||this._enableAuthAudioListener(this._forcePlayBound),this.canPlay()&&(t||!1===this._hasAnim)&&e.play(),this._sounds.push(e),e},createSound:function(e,t){this._isPlaying=t;var i,r=this._createAudio(e),a=new l.a(this,r,e);return r&&this.canPlay()&&(i=e.get("ambient")?this.connectAmbientSound(a):this.connect3DSound(a))&&i.then(this._unlockBound).catch(this._lockBound),this.addSound(a,t)},createPreview:function(e){var t=this._createAudio(e),i=new l.a(this,t,e);return this.connectAmbientSound(i),i},_errorCatchAndTryAgain:function(e){_.debug(e.message),this.exit(),window.setTimeout(function(){this.reset()}.bind(this),500)},_tryCreateMediaElementSource:function(e){if(e._mediaElementSource)return!0;try{return e._mediaElementSource=this._context.createMediaElementSource(e._player),!0}catch(e){return e instanceof DOMException&&"Failed to execute 'createMediaElementSource' on 'BaseAudioContext': AudioContext has been closed."===e.message&&this._errorCatchAndTryAgain(e),!1}},_tryConnectMediaElementSource:function(e,t){try{return e._mediaElementSource.connect(t),!0}catch(e){return this._errorCatchAndTryAgain(e),!1}},_setPannerPosition:function(e,t,i,r){e.positionX?(e.positionX.value=t,e.positionY.value=i,e.positionZ.value=r):e.setPosition(t,i,r)},_setPannerOrientation:function(e,t,i,r,a,n,o){e.forwardX?(e.forwardX.value=t,e.forwardY.value=i,e.forwardZ.value=r,e.upX.value=a,e.upY.value=n,e.upZ.value=o):e.setOrientation(t,i,r,a,n,o)},connect3DSound:function(e){var t=this.getOrCreateAudioContext();if(t){this.disconnectSound(e);var i=e._panner?e._panner:t.createPanner();if(e._panner=i,i.panningModel="HRTF",i.rolloffFactor=1,i.coneInnerAngle=360,i.coneOuterAngle=0,i.coneOuterGain=0,i.distanceModel=e.getModel().get("distanceModel"),e.setRefDistance(e.getModel().get("distance")),e.setMaxDistance(e.getModel().get("distanceMax")),e._player||(e._player=this._createAudio(e.getModel())),this._tryCreateMediaElementSource(e)){var r=e._gain?e._gain:t.createGain();if(e._gain=r,e.setGainValue(0),r.connect(i),i.connect(t.destination),this._tryConnectMediaElementSource(e,r))return e.playerPlay()}}},connectAmbientSound:function(e){var t=this.getOrCreateAudioContext();if(t&&(this.disconnectSound(e),e._player||(e._player=this._createAudio(e.getModel())),this._tryCreateMediaElementSource(e))){var i=e._gain?e._gain:t.createGain();if(e._gain=i,e.setGainValue(0),i.connect(t.destination),this._tryConnectMediaElementSource(e,i))return e.playerPlay()}},disconnectSound:function(e){e&&(e.setGainValue(0),e._panner&&(e._panner.disconnect(),e._panner=void 0),e._gain&&(e._gain.disconnect(),e._gain=void 0))},update:function(){var e=_.vec3.create(),t=_.vec3.create(),i=_.vec3.create();return function(){if(!this._enabled)return!0;var r=this._context,a=this._camera;if(!a||!r)return!0;_.mat4.getLookAt(e,t,i,a.getViewMatrix()),_.vec3.sub(t,t,e),_.vec3.normalize(t,t);var n=this._radius,o=r.listener;return this._setPannerPosition(o,e[0]/n,e[1]/n,e[2]/n),this._setPannerOrientation(o,t[0],t[1],t[2],i[0],i[1],i[2]),!0}}(),getVolume:function(){return this._volume},setCamera:function(e){this._camera=e},setVolume:function(e){var t=0===this._volume;if(this._volume=e,!this._muted&&(a.a.set("volume",e),this.canPlay())){!t&&e>0&&this._lock();for(var i=0,r=this._sounds.length;i<r;i++)this._sounds[i].updateVolume()}},isTabVisible:function(){return this._tabVisible},hide:function(){this._tabVisible=!1,this.exit()},show:function(){this._tabVisible=!0,this.enter()},setEnabled:function(e){e?(this._enabled=!0,this.reset()):(this.exit(),this._enabled=!1)},isEnabled:function(){return this._enabled},setHasAnim:function(e){this._hasAnim=e},_unlockAcknowledge:function(e){document.removeEventListener("touchend",e,!0),document.removeEventListener("mouseup",e,!0),this._playedOnceFromAuthGesture=!0,this._authErrors=this.featureDetectSoundAuthGestureNeeded(),this._osdProxyModel&&this._osdProxyModel.trigger("sound-hide")},_unlock:function(e){if(this._enablingAuthAudio=!1,this._context)return void this._unlockAcknowledge();this.getOrCreateAudioContext()&&this._unlockAcknowledge(e)},_lock:function(){this._resetPlayedOnceFromAuthGesture(),this._playedOnceFromAuthGesture||this._waiting||this._muted||0===this._volume||(this._enableAuthAudioListener(this._forcePlayBound),this.enableTapRequestPopup())},_enableAuthAudioListener:function(e){this._enablingAuthAudio||(this._enablingAuthAudio=!0,document.addEventListener("touchend",e,!0),document.addEventListener("mouseup",e,!0))},setPlaying:function(e){this._isPlaying=e},isPlaying:function(){return this._isPlaying},forcePlay:function(e){var t=this._sounds.length;if(!t)return this._unlock();for(var i,r=[],a=0;a<t;a++){var n=this._sounds[a];(n.getModel().get("ambient")||this._has3D)&&(n.updateFromModel(),i=n.playerPlay(),i&&r.push(i),n.isSoundAsync()&&(n.play(),n._exitTime&&(n._player.currentTime=n._exitTime,n._exitTime=void 0)))}this._isPlaying=e,this._context&&(i=this._context.resume(),r.push(i)),r.length&&(i=u.a.all(r).then(this._unlockBound).catch(function(){_.debug("error on sound play"),this._authErrors=!0,this._lock()}.bind(this)))},pause:function(){for(var e=0;e<this._sounds.length;e++){var t=this._sounds[e];t.isSoundAsync()||t.pause()}this._isPlaying=!1},getPlayedOnceFromAuthGesture:function(){return this._playedOnceFromAuthGesture},_resetPlayedOnceFromAuthGesture:function(){this._playedOnceFromAuthGesture=!this._authErrors||Object(c.a)().isApp||Object(d.a)(),this._playedOnceFromAuthGesture||(this._playedOnceFromAuthGesture=!1,this._enabled&&this._hasSounds&&(this._playedOnceFromAuthGesture=!this._authErrors))},canPlay:function(){return this._enabled&&this._playedOnceFromAuthGesture&&!this._releasePending&&!this._waiting&&this._tabVisible},setWaiting:function(e){this._waiting=e,this._lock()},setHas3D:function(e){this._has3D=e},getHas3D:function(){return this._has3D},getRadius:function(){return this._radius},featureDetectSoundAuthGestureNeeded:function(){var e=document.createElement("audio");try{return e.pause(),e.play().catch(function(e){e instanceof DOMException&&"NotAllowedError"===e.name&&(this._authErrors=!0,this._lock())}.bind(this)),e.paused}catch(e){return _.debug(e),!0}},setMute:function(e){this._muted=e;for(var t=0,i=this._sounds.length;t<i;t++)this._sounds[t].updateVolume();this._muted||this._lock()},getIsMute:function(){return this._muted}};var b=new v;t.a=b},,,,,,,,function(e,t){!function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/components/atoms/dropdown.jinja"]=function(){function e(e,t,i,r,a){var n="";try{var o=null,s=r.makeMacro([],["options"],function(a){var n=i;i=new r.Frame,a=a||{},a.hasOwnProperty("caller")&&i.set("caller",a.caller),i.set("options",a.hasOwnProperty("options")?a.options:{});var o="";o+="\n    ";var s;return s=e.getFilter("merge").call(t,{labelTitle:"",labelValue:"",className:"",longestLabelValue:"",placeholder:"",theme:"",color:"",components:{},disabled:!1,isOpen:!1,withBackground:!1,grey:!1},r.contextOrFrameLookup(t,i,"options")),i.set("options",s,!0),i.topLevel&&t.setVariable("options",s),i.topLevel&&t.addExport("options",s),o+='\n    <div\n        class="c-dropdown ',o+=r.suppressValue(e.getFilter("class_names").call(t,{"--disabled":r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"disabled"),"--open":r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"isOpen"),"--with-background":r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"withBackground"),"--grey":r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"grey")}),e.opts.autoescape),o+=" ",o+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"className"),e.opts.autoescape),o+=" ",o+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"theme")?"--"+r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"theme")+"-theme":"",e.opts.autoescape),o+='">\n        <div\n            class="c-dropdown__label"\n            data-action="toggle-menu"\n            data-disabled="',o+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"disabled"),e.opts.autoescape),o+='">\n            <span\n                data-ref="labelTitle"\n                class="c-dropdown__label-title">\n                ',o+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"labelTitle")?r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"labelTitle"):"",e.opts.autoescape),o+='\n            </span>\n\n            <span\n                class="',o+=r.suppressValue(e.getFilter("class_names").call(t,{"c-dropdown__label-value":!0,"--placeholder":!r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"labelValue")}),e.opts.autoescape),o+='"\n                style="',o+=r.suppressValue(e.getFilter("style").call(t,{color:r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"labelValue")?r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"):""}),e.opts.autoescape),o+='">\n                <span class="c-dropdown__label-value__text ',o+=r.suppressValue(e.getFilter("class_names").call(t,{"--absolute":r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"longestLabelValue")}),e.opts.autoescape),o+='">\n                    ',o+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"labelValue")?r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"labelValue"):r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"placeholder"),e.opts.autoescape),o+='\n                </span>\n\n                <span class="c-dropdown__label-value__hidden">',o+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"longestLabelValue"),e.opts.autoescape),o+='</span>\n            </span>\n        </div>\n        <div\n            data-ref="menu"\n            class="c-dropdown__menu ',o+=r.suppressValue(e.getFilter("class_names").call(t,{"--open":r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"isOpen")}),e.opts.autoescape),o+='">\n            ',o+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"isOpen")?e.getFilter("component").call(t,r.memberLookup(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"components"),"child")):"",e.opts.autoescape),o+="\n        </div>\n    </div>\n",i=n,new r.SafeString(o)});t.addExport("dropdown"),t.setVariable("dropdown",s),n+="\n",o?o.rootRenderFunc(e,t,i,r,a):a(null,n)}catch(e){a(r.handleError(e,null,null))}}return{root:e}}()}()},,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(215),a=i(121),n=i(10),o=i(214),s=i(54),u=i(9),l=i(184),c=i(216),h=function(e){s.a.call(this,e),this._pooledMatrix=new c.a(n.c.create),this._matrixStack=new l.a,this._matrixStack.push(n.c.IDENTITY),this._bb=new r.a};u.a.createPrototypeObject(h,u.a.objectInherit(s.a.prototype,{reset:function(){this._pooledMatrix.reset(),this._matrixStack.reset(),this._matrixStack.push(n.c.IDENTITY),this._bb.init()},getBoundingBox:function(){return this._bb},applyTransform:function(e){var t=this._pooledMatrix.getOrCreateObject();n.c.copy(t,this._matrixStack.back()),e.computeLocalToWorldMatrix(t,this),this.pushMatrix(t),this.traverse(e),this.popMatrix()},apply:function(e){return e instanceof o.a?void this.applyTransform(e):e instanceof a.a?void this.applyBoundingBox(e.getBoundingBox()):void this.traverse(e)},pushMatrix:function(e){this._matrixStack.push(e)},popMatrix:function(){this._matrixStack.pop()},applyBoundingBox:function(){var e=new r.a;return function(t){t.valid()&&(t.transformMat4(e,this._matrixStack.back()),this._bb.expandByBoundingBox(e))}}(),getMatrixStack:function(){return this._matrixStack}}),"osg","ComputeBoundsVisitor"),t.default=h},function(e,t,i){"use strict";var r,a=i(21),n=i(9),o={antialias:!0,fullscreen:!0,enableFrustumCulling:!1,scrollwheel:!0,webgl2:!1,powerPreference:"high-performance",shaderStats:!1,stats:!1},s=function(){for(var e in o)this[e]=o[e]};s.getOptionsURL=function(){if(r)return r;if(r={},!window.location.search)return r;for(var e,t=[],i=window.location.search.slice(1).split("&"),n=0;n<i.length;n++){e=i[n].split("=");var o=e[0];t.push(o);var s=e[1];"0"!==s&&"false"!==s&&(void 0===s&&(s="1"),r[o]=s)}if(void 0!==r.log){switch(r.log.toLowerCase()){case"debug":a.a.setNotifyLevel(a.a.DEBUG);break;case"info":a.a.setNotifyLevel(a.a.INFO);break;case"notice":a.a.setNotifyLevel(a.a.NOTICE);break;case"warn":a.a.setNotifyLevel(a.a.WARN);break;case"error":a.a.setNotifyLevel(a.a.ERROR);break;case"html":var u=[],l=document.createElement("div"),c=document.createElement("pre");document.addEventListener("DOMContentLoaded",function(){document.body.appendChild(l),l.appendChild(c)});var h=function(e){u.unshift(e),c.innerHTML=u.join("\n")};l.style.overflow="hidden",l.style.position="absolute",l.style.zIndex="10000",l.style.height="100%",l.style.maxWidth="600px",c.style.overflow="scroll",c.style.width="105%",c.style.height="100%",c.style.fontSize="10px",["log","error","warn","info","debug"].forEach(function(e){window.console[e]=h})}}return r},s.prototype={extend:function(e){return n.a.objectMix(this,e),this},get:function(e){return this[e]},getBoolean:function(e){var t=this.getString(e);if(t)return"false"!==t&&"0"!==t},getNumber:function(e){var t=this[e];if(t)return Number(t)},getString:function(e){if(void 0!==this[e])return this[e].toString()},extendWithOptionsURL:function(){this.extend(s.getOptionsURL())}},t.a=s},function(e,t,i){"use strict";var r=i(9),a=i(71),n=i(397),o=i(213),s=function(){n.a.call(this),this._instanceID=a.a.getInstanceID(),this._vaoObject=void 0,this.dirty()};s._sDeletedGLVertexArrayObjectCache=new window.Map,s.deleteGLVertexArrayObject=function(e,t){s._sDeletedGLVertexArrayObjectCache.has(e)||s._sDeletedGLVertexArrayObjectCache.set(e,[]),s._sDeletedGLVertexArrayObjectCache.get(e).push(t)},s.flushDeletedGLVertexArrayObjects=function(e,t){if(t<=0)return t;if(!s._sDeletedGLVertexArrayObjectCache.has(e))return t;for(var i=0,r=o.a.instance().tick(),a=s._sDeletedGLVertexArrayObjectCache.get(e),n=a.length,u=n-1;u>=0&&i<t;u--)e.deleteVertexArray(a[u]),a.splice(u,1),i=o.a.instance().deltaS(r,o.a.instance().tick());return t-i},s.flushAllDeletedGLVertexArrayObjects=function(e){if(s._sDeletedGLVertexArrayObjectCache.has(e))for(var t=s._sDeletedGLVertexArrayObjectCache.get(e),i=t.length,r=i-1;r>=0;r--)e.deleteVertexArray(t[r]),t.splice(r,1)},s.onLostContext=function(e){if(s._sDeletedGLVertexArrayObjectCache.has(e)){s._sDeletedGLVertexArrayObjectCache.get(e).length=0}},r.a.createPrototypeObject(s,r.a.objectInherit(n.a.prototype,{getInstanceID:function(){return this._instanceID},invalidate:function(){this._vaoObject=void 0,this.dirty()},releaseGLObjects:function(){void 0!==this._vaoObject&&void 0!==this._gl&&(s.deleteGLVertexArrayObject(this._gl,this._vaoObject),n.a.removeObject(this._gl,this)),this.invalidate()},create:function(e){this._vaoObject=e.createVertexArray(),this._dirty=!1},bind:function(e){this._gl||this.setGraphicContext(e),this._vaoObject&&e.bindVertexArray(this._vaoObject)},dirty:function(){this._dirty=!0},isDirty:function(){return this._dirty}}),"osg","VertexArrayObject"),t.a=s},function(e,t,i){"use strict";var r=i(184),a=function(){this._keys=new r.a,this._map={}};a.prototype={reset:function(){for(var e=this._keys.getArray(),t=this._keys.getLength(),i=0;i<t;i++){var r=e[i];this._map[r]=void 0}this._keys.reset()},set:function(e,t){this._keys.push(e),this._map[e]=t},hasKey:function(e){return void 0!==this._map[e]},getMap:function(){return this._map},getKeys:function(){return this._keys},forEach:function(e){for(var t=this._keys.getArray(),i=this._keys.getLength(),r=0;r<i;r++){var a=t[r];e(a,this._map[a])}}},t.a=a},function(e,t,i){"use strict";var r=i(9),a=i(184),n=i(587),o=i(216),s=function(){this._depth=0,this._children=new n.a,this._leafs=new a.a,this._stateset=void 0,this._parent=void 0},u=function(){return new s};s.pooledStateGraph=new o.a(u),s.statsNbMoveStateGraph=0,s.reset=function(){s.pooledStateGraph.reset(),s.statsNbMoveStateGraph=0},r.a.createPrototypeObject(s,{clean:function(){this._leafs.reset(),this._children.reset(),this._depth=0,this._stateset=void 0,this._parent=void 0},getStateSet:function(){return this._stateset},getLeafs:function(){return this._leafs},getParent:function(){return this._parent},findOrInsert:function(e){var t=e.getInstanceID(),i=this._children.getMap(),r=i[t];return r||(r=s.pooledStateGraph.getOrCreateObject(),r.clean(),r._parent=this,r._depth=this._depth+1,r._stateset=e,this._children.set(t,r)),r}},"osg","StateGraph"),s.moveStateGraph=function(){var e=new a.a,t=e.getArray();return function(i,r,a){s.statsNbMoveStateGraph++,e.reset();var n,o,u=a,l=r;if(u!==l&&void 0!==u)if(void 0!==l){if(l._parent===u._parent)return void 0!==l._stateset&&i.popStateSet(),void(void 0!==u._stateset&&i.pushStateSet(u._stateset));for(;l._depth>u._depth;)void 0!==l._stateset&&i.popStateSet(),l=l._parent;for(e.reset();u._depth>l._depth;)void 0!==u._stateset&&e.push(u._stateset),u=u._parent;for(;l!==u;)void 0!==l._stateset&&i.popStateSet(),l=l._parent,void 0!==u._stateset&&e.push(u._stateset),u=u._parent;for(n=e._length-1,o=0;n>=o;--n)i.pushStateSet(t[n])}else{do{void 0!==u._stateset&&e.push(u._stateset),u=u._parent}while(u);for(n=e._length-1,o=0;n>=o;--n)i.pushStateSet(t[n])}}}(),t.a=s},function(e,t,i){"use strict";var r=i(9),a=i(142),n=i(248),o=i(21),s=i(546),u=i(10),l=i(216),c=function(){s.a.call(this),this._clearColor=u.g.create(),this._clearDepth=void 0,this._clearMask=void 0,this._camera=void 0,this._viewport=void 0,this._scissor=void 0,this._preRenderList=[],this._postRenderList=[],c.prototype.init.call(this)},h=function(){return{renderStage:null,order:null}},d=new l.a(h);r.a.createPrototypeObject(c,r.a.objectInherit(s.a.prototype,{init:function(){return s.a.prototype.init.call(this),this._clearDepth=1,u.g.set(this._clearColor,0,0,0,1),this._clearMask=a.a.COLOR_BUFFER_BIT|a.a.DEPTH_BUFFER_BIT,this._camera=void 0,this._viewport=void 0,this._scissor=void 0,this._renderStage=this,c.prototype._initInternal.call(this),this},_initInternal:function(){this._preRenderList.length=0,this._postRenderList.length=0},reset:function(){d.reset(),s.a.prototype.reset.call(this),c.prototype._initInternal.call(this)},setClearDepth:function(e){this._clearDepth=e},getClearDepth:function(){return this._clearDepth},setClearColor:function(e){u.g.copy(this._clearColor,e)},getClearColor:function(){return this._clearColor},setClearMask:function(e){this._clearMask=e},getClearMask:function(){return this._clearMask},setViewport:function(e){this._viewport=e},getViewport:function(){return this._viewport},setScissor:function(e){this._scissor=e},getScissor:function(){return this._scissor},setCamera:function(e){this._camera=e},getCamera:function(){return this._camera},getPreRenderStageList:function(){return this._preRenderList},getPostRenderStageList:function(){return this._postRenderList},addPreRenderStage:function(e,t){for(var i=0,r=this._preRenderList.length;i<r;i++){if(t<this._preRenderList[i].order)break}var a=d.getOrCreateObject();a.order=t,a.renderStage=e,i<this._preRenderList.length?this._preRenderList=this._preRenderList.splice(i,0,a):this._preRenderList.push(a)},addPostRenderStage:function(e,t){for(var i=0,r=this._postRenderList.length;i<r;i++){if(t<this._postRenderList[i].order)break}var a=d.getOrCreateObject();a.order=t,a.renderStage=e,i<this._postRenderList.length?this._postRenderList=this._postRenderList.splice(i,0,a):this._postRenderList.push(a)},drawPreRenderStages:function(e,t){for(var i=t,r=0,a=this._preRenderList.length;r<a;++r){i=this._preRenderList[r].renderStage.draw(e,i)}return i},draw:function(e,t){this._camera&&this._camera.getInitialDrawCallback()&&this._camera.getInitialDrawCallback()(e);var i=this.drawPreRenderStages(e,t);return i=this.drawImplementation(e,i),i=this.drawPostRenderStages(e,i),this._camera&&this._camera.getFinalDrawCallback()&&this._camera.getFinalDrawCallback()(e),i},sort:function(){for(var e=0,t=this._preRenderList.length;e<t;++e)this._preRenderList[e].renderStage.sort();s.a.prototype.sort.call(this);for(var i=0,r=this._postRenderList.length;i<r;++i)this._postRenderList[i].renderStage.sort()},drawPostRenderStages:function(e,t){for(var i=t,r=0,a=this._postRenderList.length;r<a;++r){i=this._postRenderList[r].renderStage.draw(e,i)}return i},applyCamera:function(e){var t=e.getGraphicContext();if(void 0===this._camera)return void t.bindFramebuffer(t.FRAMEBUFFER,null);var i=this._camera.getViewport(),r=this._camera.frameBufferObject;if(r||(r=new n.a,this._camera.frameBufferObject=r),r.isDirty()){var a,o,s=this._camera.getAttachments(),u=s[n.a.COLOR_ATTACHMENT0];u&&u.texture&&(a=u.texture.getWidth(),o=u.texture.getHeight());for(var l in s){u=s[l];var c={};c.attachment=u.attachment,void 0===u.texture?(c.format=u.format,c.width=void 0!==a?a:i.width(),c.height=void 0!==o?o:i.height()):(c.texture=u.texture,c.textureTarget=u.textureTarget,u.format&&(c.format=u.format)),r.setAttachment(c)}}r.apply(e)},drawImplementation:function(e,t){var i=e.getGraphicContext();return this.applyCamera(e),void 0===this._viewport&&o.a.log("RenderStage does not have a valid viewport"),e.applyAttribute(this._viewport),this._scissor&&e.applyAttribute(this._scissor),0!==this._clearMask&&(this._clearMask&i.COLOR_BUFFER_BIT&&e.clearColor(this._clearColor),this._clearMask&i.DEPTH_BUFFER_BIT&&(e.depthMask(!0),e.clearDepth(this._clearDepth)),e.clear(this._clearMask)),0!==this._positionedAttribute.getLength()&&this.applyPositionedAttribute(e,this._positionedAttribute),s.a.prototype.drawImplementation.call(this,e,t)}}),"osg","RenderStage"),c.clean=function(){d.clean()},t.a=c},function(e,t,i){"use strict";var r=i(9),a=i(143),n=i(782),o=i(54),s=i(591),u=i(452),l=function(){o.a.call(this,o.a.TRAVERSE_ALL_CHILDREN)};r.a.createPrototypeObject(l,r.a.objectInherit(o.a.prototype,{apply:function(e){if(e.getTypeID()===u.a.getTypeID()){var t=e.getUpdateCallback();if(t instanceof s.a){for(var i=t._stackedTransforms,r=0,a=i.length;r<a;r++){i[r].resetToDefaultValue()}t.computeChannels()}}this.traverse(e)}}),"osgAnimation","ResetRestPoseVisitor");var c=new l,h=function(){a.a.call(this)};r.a.createPrototypeNode(h,r.a.objectInherit(a.a.prototype,{setDefaultUpdateCallback:function(){this.addUpdateCallback(new n.a)},setRestPose:function(){this.accept(c)}}),"osgAnimation","Skeleton"),t.a=h},function(e,t,i){"use strict";var r=i(9),a=i(10),n=i(547),o=function(){n.a.call(this),this._stackedTransforms=[],this._matrix=a.c.create(),this._dirty=!1};r.a.createPrototypeObject(o,r.a.objectInherit(n.a.prototype,{getStackedTransforms:function(){return this._stackedTransforms},setMatrix:function(e){a.c.copy(this._matrix,e),this._dirty=!0},getMatrix:function(){return this._matrix},computeChannels:function(){this._dirty=!0;var e=this._matrix;a.c.identity(e);for(var t=this._stackedTransforms,i=0,r=t.length;i<r;i++){t[i].applyToMatrix(e)}},update:function(e){return a.c.copy(e.getMatrix(),this._matrix),this._dirty&&(e.dirtyBound(),this._dirty=!1),!0}}),"osgAnimation","UpdateMatrixTransform"),t.a=o},function(e,t,i){"use strict";var r=i(21),a=i(789),n=i(790),o=i(246),s=function(e){if(!e){if(s.instance)return s.instance;s.instance=this}return this.addShaders(a.a),this.addShaders(n.a),this};s.prototype={_shadersText:{},_shadersList:{},_globalDefaultprecision:"#ifdef GL_FRAGMENT_PRECISION_HIGH\n precision highp float;\n #else\n precision mediump float;\n#endif",_debugLines:!1,_includeR:/#pragma include "([^"]+)"/g,_includeCondR:/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,_defineR:/\#define\s+([a-zA-Z_0-9]+)/,_precisionR:/precision\s+(high|low|medium)p\s+float/,addShaders:function(e){for(var t in e)this._shadersList[t]=t,this._shadersText[t]=e[t]},instrumentShaderlines:function(e,t){return"\n#line 0 "+t+"\n"+e},hasShader:function(e){return void 0!==this._shadersText[e]},getShaderTextPure:function(e){var t=this._shadersText[e];return t||(r.a.error("shader file/text: "+e+" not registered"),t=""),t},getShader:function(e,t,i,r){var a=this.getShaderTextPure(e);return this.processShader(a,t,i,r)},preprocess:function(e,t,i,r){var a=this;return e.replace(this._includeCondR,function(e,n){var o=n.split(" "),s=o[0].replace(/"/g,"");if(o.length>1&&r){for(var u=!1,l=r.map(function(e){return a._defineR.test(e)&&e.replace(/\s+/g," ").split(" ")[1]}),c=1;c<o.length&&!u;c++)for(var h=o[c].replace(/"/g,""),d=0;d<l.length&&!u;d++)if(!1!==l[d]&&l[d]===h){u=!0;break}if(!u)return""}if(-1!==i.indexOf(s))return"";var p=this.getShaderTextPure(s);return i.push(s),this._debugLines&&(p=this.instrumentShaderlines(p,t)),t++,p=this.preprocess(p,t,i,r)}.bind(this))},_getSortedUnique:function(){var e=function(e,t,i){return!t||e!==i[t-1]};return function(t){return t&&t.sort().filter(e)}}(),_convertExtensionsToWebGL2:function(){var e=function(e,t){return"core_"+t},t=function(e,t){return"#define "+t},i="(GL_EXT_shader_texture_lod|GL_OES_standard_derivatives|GL_EXT_draw_buffers|GL_EXT_frag_depth)",r=new RegExp("#\\s*extension\\s+"+i+".*","g"),a=new RegExp(i,"g");return function(i){return i=i.replace(r,t),i=i.replace(a,e)}}(),_convertToWebGL2:function(){var e=[],t=function(t,i){var r="glFragData_"+i;return e[i]="layout(location = "+i+") out vec4 "+r+";",r};return function(i,r){return i?(i=i.replace(/attribute\s+/g,"in "),i=i.replace(/varying\s+/g,r?"in ":"out "),i=i.replace(/(texture2D|textureCube)\s*\(/g,"texture("),i=i.replace(/(textureCubeLodEXT)\s*\(/g,"textureLod("),i=this._convertExtensionsToWebGL2(i),r&&(e.length=0,i=i.replace(/gl_FragData\s*\[\s*(\d+)\s*\]/g,t),e.length||e.push("out vec4 glFragColor_0;"),i=i.replace(/gl_FragColor/g,"glFragColor_0"),i=i.replace(/void\s+main\s*\(/g,e.join("\n")+"\nvoid main(")),i):i}}(),_hasVersion:function(e){var t=e.match(/^#(.*)$/m);return t&&-1!==t[0].indexOf("version")},processShader:function(e,t,i,r){if(this._hasVersion(e))return e;var a=[],n=e,s=0;this._debugLines&&(n=this.instrumentShaderlines(n,s),s++),t=this._getSortedUnique(t),i=this._getSortedUnique(i);var u=this.preprocess(n,s,a,t,r);u=u.replace(/#pragma DECLARE_FUNCTION/g,"//#pragma DECLARE_FUNCTION");var l=-1===u.indexOf("gl_Position"),c=o.a.instance().isWebGL2(),h=c?"#version 300 es":"#version 100";h+="\n";var d=i?i.join("\n")+"\n":"",p=t?t.join("\n")+"\n":"";c?(d=this._convertExtensionsToWebGL2(d),p=this._convertToWebGL2(p,l),u=this._convertToWebGL2(u,l)):(p=p.replace(/\\\n/g,""),u=u.replace(/\\\n/g,""));var f="";return this._globalDefaultprecision&&!this._precisionR.test(u)&&(f=this._globalDefaultprecision+"\n"),h+d+f+p+u}},t.a=s},function(e,t,i){"use strict";var r=i(454),a=0,n=function(e,t){for(var i=1/0,r=-1/0,n=0;n<e.length;n++)i=Math.min(i,e[n].start),r=Math.max(r,e[n].end);var o=r-i,s=t||"animation"+a.toString();return a++,{channels:e,duration:o,name:s,start:i}},o=function(e){for(var t=[],i=0;i<e.channels.length;i++){var a=r.a.createInstanceChannel(e.channels[i]);t.push(a)}return{channels:t,duration:e.duration,start:0,name:e.name,firstKeyTime:e.start}},s=function(){};s.createAnimation=n,s.createInstanceAnimation=o,t.a=s},function(e,t,i){"use strict";var r=i(9),a=i(128),n=i(453),o=i(547),s=i(400),u=i(398),l=function(){o.a.call(this),this._targets=[],this._targetNames=[],this._morphs=[],this._weights=new Float32Array(u.a.MAX_MORPH_GPU),this._indexMap=new Uint32Array(u.a.MAX_MORPH_GPU),this._gpuMorphed=[],this._maxMorphGPU=-1},c=function(e,t){return Math.abs(t.value)-Math.abs(e.value)};r.a.createPrototypeObject(l,r.a.objectInherit(o.a.prototype,{_initNode:function(e){var t;e instanceof u.a?t=e:e instanceof n.a&&e.getSourceGeometry()instanceof u.a&&(t=e.getSourceGeometry()),t&&t.getName()===this.getName()&&(t.isInitialized()||t.init(),this._morphs.push(t),this._maxMorphGPU=Math.min(this._maxMorphGPU,t.getMaximumPossibleMorphGPU()))},init:function(e){this._maxMorphGPU=u.a.MAX_MORPH_GPU,this._morphs.length=0;var t=e.getChildren();if(!t.length)return void this._initNode(e);for(var i=0,r=t.length;i<r;i++)this._initNode(t[i])},isInitialized:function(){var e=this._morphs,t=e.length;if(!t)return!1;for(var i=0;i<t;++i)if(!e[i].isInitialized())return!1;return!0},getNumTarget:function(){return this._targets.length},getTarget:function(e){return this._targets[e]},getTargetName:function(e){return this._targetNames[e]},addTarget:function(e,t){this._targets[t]=s.a.createFloatTarget(0),this._targetNames[t]=e},_remapBufferArrays:function(){for(var e=this._indexMap,t=this._morphs,i=0;i<this._maxMorphGPU;++i)for(var r=e[i],a="_"+i,n="_"+r,o=0,s=t.length;o<s;++o)for(var u=t[o],l=u.getVertexAttributeList(),c=u.getMorphTargetNames(),h=0,d=c.length;h<d;++h){var p=c[h];l[p+a].setBufferArray(l[p+n].getInitialBufferArray())}},_mergeExtraMorphTarget:function(e,t,i){var r=0,n=this._gpuMorphed,o=e[t],s=o.getElements().length,l=s/o.getItemSize(),c=o.getItemSize();o._cpuMorph=o._cpuMorph||new a.a(a.a.ARRAY_BUFFER,new Float32Array(s),c);var h=o._cpuMorph.getElements();for(r=0;r<s;++r)h[r]=0;for(var d=this._targets,p=0,f=d.length;p<f;++p)if(!0!==n[p]){var m=d[p].value;if(!(Math.abs(m)<=u.a.EFFECTIVE_EPS)){m/=i;var g=e[t+"_"+p].getInitialBufferArray().getElements();for(r=0;r<l;++r){var _=r*c;h[_]+=m*g[_],h[_+1]+=m*g[_+1],h[_+2]+=m*g[_+2]}}}e[t+"_"+(this._maxMorphGPU-1)].setBufferArray(o._cpuMorph),o._cpuMorph.dirty()},_computeExtraWeightsSum:function(){for(var e=this._gpuMorphed,t=0,i=this._targets,r=0,a=i.length;r<a;++r)if(!0!==e[r]){var n=i[r].value;Math.abs(n)<=u.a.EFFECTIVE_EPS||(t+=n)}return Math.abs(t)>1e-5?t:t<0?-1e-5:1e-5},_morphBufferArrayCPU:function(){for(var e=this._weights[this._maxMorphGPU-1]=this._computeExtraWeightsSum(),t={},i=this._morphs,r=0,a=i.length;r<a;++r)for(var n=i[r],o=n.getVertexAttributeList(),s=n.getMorphTargetNames(),u=0,l=s.length;u<l;++u){var c=s[u],h=o[c];h&&!t[h.getInstanceID()]&&(t[h.getInstanceID()]=!0,this._mergeExtraMorphTarget(o,c,e))}},updateWeights:function(){if(0!==this._maxMorphGPU){var e=0,t=this._targets,i=t.length,r=this._weights;if(r[0]=r[1]=r[2]=r[3]=0,i<=this._maxMorphGPU)for(e=0;e<i;++e)r[e]=t[e].value;else{var a=this._indexMap;a[0]=a[1]=a[2]=a[3]=0;var n=this._gpuMorphed;for(n.length=i,e=0;e<i;++e)n[e]=!1;var o=t.slice(0).sort(c);for(e=0;e<this._maxMorphGPU;++e){var s=t.indexOf(o[e]);n[s]=!0,a[e]=s,r[e]=o[e].value}var l=Math.abs(o[this._maxMorphGPU].value),h=l>u.a.EFFECTIVE_EPS;n[a[this._maxMorphGPU-1]]=!h,this._remapBufferArrays(),h&&this._morphBufferArrayCPU()}}},update:function(e){this.isInitialized()||this.init(e),this.updateWeights();for(var t=this._weights,i=Math.min(this._maxMorphGPU,this._targets.length),r=this._morphs,a=0,n=r.length;a<n;++a)for(var o=r[a].getTargetsWeight(),s=0;s<i;s++)o[s]=t[s];return!0}}),"osgAnimation","UpdateMorph"),t.a=l},function(e,t,i){"use strict";var r=i(7),a=i.n(r),n=i(418),o=i(549),s=i(802),u=i(21),l=function(e){return"string"==typeof e||e instanceof String},c=function(e){return"blob:http"===e.substr(0,9)},h=function(e){return"http://"===e.substr(0,7)||"https://"===e.substr(0,8)},d=function(e){return!!l(e)&&(c(e)||h(e))},p=window.zip,f=new window.Map,m=function(e){return new a.a(function(t,i){var r=new window.Image;r.onerror=function(){i(r)},r.onload=function(){t(r)},r.src=e})},g=function(e){var t=window.URL.createObjectURL(e),i=m(t);return i.finally(function(){window.URL.revokeObjectURL(t)}),i},_=function(e){return new a.a(function(t,i){var r=new window.FileReader;r.onerror=function(){i(r)},r.onload=function(){t(this.result)},r.readAsArrayBuffer(e)})},v=function(e){return Object(s.a)(e,{responseType:"arraybuffer"})},b=function(e){return Object(s.a)(e).then(function(e){return JSON.parse(e)})},y=function(e){var t=JSON.parse(e);return a.a.resolve(t)},x={createJSONFromURL:b,createArrayBufferFromURL:v,createArrayBufferFromBlob:_,createImageFromBlob:g,createImageFromURL:m,requestURI:s.a,requestResource:function(e,t){var i=x.getExtension(e),r=x.getMimeType(i);if(t&&t.responseType?t.responseType.toLowerCase():void 0)return Object(s.a)(e,t);if(r){if(r.match("image"))return m(e);if(r.match("binary"))return v(e);if(r.match("json"))return b(e);if(r.match("text"))return Object(s.a)(e)}return Object(s.a)(e)},resolveData:function(e,t){var i,r=x.getExtension(e),n=x.getMimeType(r);n&&(n.match("image")?l(t)?i=m:t instanceof window.Blob&&(i=g):n.match("json")?i=d(t)?b:y:n.match("binary")&&(l(t)?i=v:t instanceof window.Blob&&(i=_)));return i?i(t):a.a.resolve(t)},resolveFilesMap:function(e){var t=[];for(var i in e){var r=e[i],n=x.resolveData(i,r).then(function(e,t){this[e]=t}.bind(e,i));t.push(n)}return a.a.all(t).then(function(){return e})},_unzipEntry:function(e){return new a.a(function(t){var i=e.filename,r=x.getExtension(i),a=x.getMimeType(r),n=p.BlobWriter;null===a.match("text")&&null===a.match("json")||(n=p.TextWriter),e.getData(new n(a),function(e){t({filename:i,data:e})})})},unzipBlob:function(e){return new a.a(function(t,i){var r={},n=[];p.createReader(new p.BlobReader(e),function(e){e.getEntries(function(i){for(var o=0;o<i.length;o++)if(!i[o].directory){var s=x._unzipEntry(i[o]);s.then(function(e){r[e.filename]=e.data}),n.push(s)}a.a.all(n).then(function(){e.close(),x.resolveFilesMap(r).then(function(e){t(e)})})})},function(){i(this)})})},unzip:function(e){if(!window.zip)return a.a.reject("missing deps to unzip, require https://github.com/gildas-lormeau/zip.js");if(l(e))return x.requestResource(e).then(function(e){var t=new window.Blob([e],{type:f.get("zip")});return x.unzipBlob(t)});if(e instanceof window.Blob)return x.unzipBlob(e);if(e instanceof window.ArrayBuffer){var t=new window.Blob([e],{type:f.get("zip")});return x.unzipBlob(t)}return a.a.reject("cant unzip input")},readFileList:function(e){var t,i,r={},u=[];for(i=0;i<e.length;++i){var l=x.getExtension(e[i].name);void 0===o.a.instance().getReaderWriterForExtension(l)&&"osgjs"!==l||(t=e[i].name);var c,h=x.getMimeType(l);c=h.match("image")?"blob":h.match("json")||h.match("text")?"string":"arraybuffer",u.push(Object(s.a)(e[i],{responseType:c}))}return a.a.all(u).then(function(a){for(i=0;i<a.length;++i)r[e[i].name]=a[i];return x.resolveFilesMap(r).then(function(e){return n.default.readNodeURL(t,{filesMap:e})})})},getMimeType:function(e){return f.get(e)},getExtension:function(e){return e.substr(e.lastIndexOf(".")+1)},addMimeTypeForExtension:function(e,t){void 0!==f.has(e)&&u.a.warn("the '"+e+"' already has a mimetype: "+f.get(e)),f.set(e,t)}};f.set("bin","application/octet-binary"),f.set("b3dm","application/octet-binary"),f.set("glb","application/octet-binary"),f.set("zip","application/octet-binary"),f.set("gz","application/octet-binary"),f.set("png","image/png"),f.set("jpg","image/jpeg"),f.set("jpeg","image/jpeg"),f.set("gif","image/gif"),f.set("json","application/json"),f.set("gltf","application/json"),f.set("osgjs","application/json"),f.set("txt","text/plain"),f.set("glsl","text/plain"),t.a=x},function(e,t,i){"use strict";var r=i(7),a=i.n(r),n=i(9),o=i(127),s=n.a.rejectObject,u={};u.Object=function(e,t){var i=e.getJSON();if(i.Name&&t.setName(i.Name),i.UserDataContainer){var r=e.setJSON(i.UserDataContainer).readUserDataContainer();void 0!==r&&t.setUserData(r)}return t},u.Node=function(e,t){var i=e.getJSON();u.Object(e,t);var r=[];if(i.UpdateCallbacks)for(var n=t.addUpdateCallback.bind(t),o=0,s=i.UpdateCallbacks.length;o<s;o++){var l=e.setJSON(i.UpdateCallbacks[o]).readObject();r.push(l),l.then(n)}if(i.StateSet){var c=e.setJSON(i.StateSet).readObject();r.push(c),c.then(t.setStateSet.bind(t))}var h=[];if(i.Children)for(var d=0,p=i.Children.length;d<p;d++)h.push(e.setJSON(i.Children[d]).readObject());return a.a.all(r).then(function(){return a.a.all(h).then(function(e){for(var i=e.length,r=0;r<i;r++)t.addChild(e[r]);return t})})},u.StateSet=function(e,t){var i=e.getJSON();u.Object(e,t),void 0!==i.RenderingHint&&t.setRenderingHint(i.RenderingHint);var r=[];if(void 0!==i.AttributeList)for(var n=0,o=i.AttributeList.length;n<o;n++)!function(i){var a=e.setJSON(i).readObject();a.isRejected()||(r.push(a),a.then(t.setAttributeAndModes.bind(t)))}(i.AttributeList[n]);if(i.TextureAttributeList)for(var s=i.TextureAttributeList,l=0,c=s.length;l<c;l++)for(var h=s[l],d=0,p=h.length;d<p;d++)!function(i,a){var n=e.setJSON(a).readObject();n.isRejected()||(r.push(n),n.then(t.setTextureAttributeAndModes.bind(t,i)))}(l,h[d]);return a.a.all(r).then(function(){return t})},u.Material=function(e,t){var i=e.getJSON();return i.Diffuse&&i.Emission&&i.Specular&&void 0!==i.Shininess?(u.Object(e,t),t.setAmbient(i.Ambient),t.setDiffuse(i.Diffuse),t.setEmission(i.Emission),t.setSpecular(i.Specular),t.setShininess(i.Shininess),a.a.resolve(t)):s("Material",i)},u.BlendFunc=function(e,t){var i=e.getJSON();return i.SourceRGB&&i.SourceAlpha&&i.DestinationRGB&&i.DestinationAlpha?(u.Object(e,t),t.setSourceRGB(i.SourceRGB),t.setSourceAlpha(i.SourceAlpha),t.setDestinationRGB(i.DestinationRGB),t.setDestinationAlpha(i.DestinationAlpha),a.a.resolve(t)):s("BlendFunc",i)},u.CullFace=function(e,t){var i=e.getJSON();return void 0===i.Mode?s("CullFace",i):(u.Object(e,t),t.setMode(i.Mode),a.a.resolve(t))},u.BlendColor=function(e,t){var i=e.getJSON();return i.ConstantColor?(u.Object(e,t),t.setConstantColor(i.ConstantColor),a.a.resolve(t)):s("BlendColor",i)},u.Light=function(e,t){var i=e.getJSON();return i.Ambient&&i.Diffuse&&i.Direction&&i.Position&&i.Specular&&void 0!==i.LightNum&&void 0!==i.SpotCutoff&&void 0!==i.LinearAttenuation&&void 0!==i.ConstantAttenuation&&void 0!==i.QuadraticAttenuation?(u.Object(e,t),t.setAmbient(i.Ambient),t.setConstantAttenuation(i.ConstantAttenuation),t.setDiffuse(i.Diffuse),t.setDirection(i.Direction),t.setLightNumber(i.LightNum),t.setLinearAttenuation(i.LinearAttenuation),t.setPosition(i.Position),t.setQuadraticAttenuation(i.QuadraticAttenuation),t.setSpecular(i.Specular),t.setSpotCutoff(i.SpotCutoff),t.setSpotBlend(.01),void 0!==i.SpotExponent&&t.setSpotBlend(i.SpotExponent/128),a.a.resolve(t)):s("Light",i)},u.Texture=function(e,t){var i=e.getJSON();u.Object(e,t),i.MinFilter&&t.setMinFilter(i.MinFilter),i.MagFilter&&t.setMagFilter(i.MagFilter),i.WrapT&&t.setWrapT(i.WrapT),i.WrapS&&t.setWrapS(i.WrapS);var r=i.File;return void 0===r&&(r="no-image-provided"),e.readImageURL(r).then(function(e){return t.setImage(e),t})},u.Projection=function(e,t){var i=e.getJSON();if(!i.Matrix)return s("Projection",i);var r=u.Node(e,t);return t.setMatrix(i.Matrix),r},u.MatrixTransform=function(e,t){var i=e.getJSON();if(!i.Matrix)return s("MatrixTransform",i);var r=u.Node(e,t);return t.setMatrix(i.Matrix),r},u.LightSource=function(e,t){var i=e.getJSON();if(!i.Light)return s("LightSource",i);var r=u.Node(e,t);return a.a.all([e.setJSON(i.Light).readObject(),r]).then(function(e){var r=e[0];return t.setLight(r),"ABSOLUTE_RF"===i.ReferenceFrame&&t.setReferenceFrame(o.a.ABSOLUTE_RF),t})},u.functionSortAttributes=function(e,t){return-1!==e.indexOf("TexCoord")&&-1!==t.indexOf("TexCoord")?parseInt(e.substr(8),10)-parseInt(t.substr(8),10):e<t?-1:e>t?1:0},u.Geometry=function(e,t){var i=e.getJSON();if(!i.VertexAttributeList)return s("Geometry",i);i.PrimitiveSetList=i.PrimitiveSetList||[];var r=[];r.push(u.Node(e,t));var n=t.getPrimitives(),o=n.push.bind(n),l=0,c=i.PrimitiveSetList.length;for(l=0;l<c;l++){var h=e.setJSON(i.PrimitiveSetList[l]).readPrimitiveSet();r.push(h),h.then(o)}var d=function(e,t){this.getVertexAttributeList()[e]=t},p=i.VertexAttributeList,f=window.Object.keys(p);for(f.sort(u.functionSortAttributes),c=f.length,l=0;l<c;l++){var m=f[l],g=e.setJSON(p[m]).readBufferArray();r.push(g),g.then(d.bind(t,m))}return a.a.all(r).then(function(){return t})},u.PagedLOD=function(e,t){var i=e.getJSON();u.Object(e,t),"USE_BOUNDING_SPHERE_CENTER"===i.CenterMode?t.setCenterMode(0):"UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED"===i.CenterMode&&t.setCenterMode(2),t.setCenter([i.UserCenter[0],i.UserCenter[1],i.UserCenter[2]]),t.setRadius(i.UserCenter[3]),"PIXEL_SIZE_ON_SCREEN"===i.RangeMode&&t.setRangeMode(1);for(var r,n=i.RangeList,o=0;o<window.Object.keys(n).length;o++){r="Range "+o;var s=n[r];t.setRange(o,s[0],s[1])}for(n=i.RangeDataList,o=0;o<window.Object.keys(n).length;o++)r="File "+o,t.setFileName(o,n[r]);t.setDatabasePath(e.getDatabasePath());var l=[];if(i.Children)for(var c=0,h=i.Children.length;c<h;c++)l.push(e.setJSON(i.Children[c]).readObject());return a.a.all(l).then(function(e){var i=e.length;for(o=0;o<i;o++)t.addChildNode(e[o]);return t})},t.a=u},function(e,t,i){"use strict";var r=i(21),a=i(448),n=i(10),o=function(e){e&&(this._boundStrategy=e.boundStrategy,this.setInputManager(e.inputManager)),void 0===this._boundStrategy&&(this._boundStrategy=o.COMPUTE_HOME_USING_SPHERE),this._controllerList={},this._inverseMatrix=n.c.create(),this._camera=void 0,this._node=void 0,this._frustum={},this._computeBoundNodeMaskOverride=-1,this._tmpSphere=new a.a};o.prototype={setCamera:function(e){this._camera=e},getCamera:function(){return this._camera},setNode:function(e){this._node=e},setComputeBoundNodeMaskOverride:function(e){this._computeBoundNodeMaskOverride=e},getComputeBoundNodeMaskOverride:function(){return this._computeBoundNodeMaskOverride},setInputManager:function(e){this._inputManager=e},getInputManager:function(){return this._inputManager},getHomeBoundingSphere:function(e){var t=this._node;if(t){var r=void 0!==e?e:this._boundStrategy;if(r&o.COMPUTE_HOME_USING_BBOX){var a;if(-1===this._computeBoundNodeMaskOverride)a=t.getBoundingBox();else{var n=i(584).default,s=new n;s.setNodeMaskOverride(this._computeBoundNodeMaskOverride),s.reset(),s.apply(t),a=s.getBoundingBox()}if(!a.valid())return t.getBoundingSphere();if(r&o.COMPUTE_HOME_USING_SPHERE){var u=t.getBoundingSphere();if(u.valid()&&u.volume()<a.volume())return u}return this._tmpSphere.copyBoundingBox(a),this._tmpSphere}return t.getBoundingSphere()}},getHomeBound:function(e){return r.a.warn("Please use getHomeBoundingSphere instead"),this.getHomeBoundingSphere(e)},getHomeDistance:function(e){var t=this._frustum,i=e.radius();if(this._camera&&n.c.getFrustum(t,this._camera.getProjectionMatrix())){var r=Math.abs(t.right-t.left)/t.zNear/2,a=Math.abs(t.top-t.bottom)/t.zNear/2;i/=Math.sin(Math.atan2(a<r?a:r,1))}else i*=1.5;return i},update:function(){},getInverseMatrix:function(){return this._inverseMatrix},getControllerList:function(){return this._controllerList}},o.COMPUTE_HOME_USING_SPHERE=1,o.COMPUTE_HOME_USING_BBOX=2,t.a=o},function(e,t,i){"use strict";var r=i(599),a=function(){this._intersections=[],this._primitiveMask=r.a.ALL_PRIMITIVES,this._intersectionLimit=r.a.NO_LIMIT};a.prototype={reset:function(){this._intersections.length=0},enter:function(e){return!this.reachedLimit()&&(!e.isCullingActive()||this.intersectNode(e))},intersectNode:function(e){return this.intersectBoundingSphere(e.getBoundingSphere())||this.intersectBoundingBox(e.getBoundingBox())},intersectBoundingSphere:function(){return!1},intersectBoundingBox:function(){return!1},getIntersections:function(){return this._intersections},setIntersectionLimit:function(e){this._intersectionLimit=e},getIntersectionLimit:function(){return this._intersectionLimit},setPrimitiveMask:function(e){this._primitiveMask=e},getPrimitiveMask:function(){return this._primitiveMask},reachedLimit:function(){return this._intersectionLimit===r.a.LIMIT_ONE&&this._intersections.length>0},setCurrentTransformation:function(){},intersect:function(){}},t.a=a},function(e,t,i){"use strict";t.a={NO_LIMIT:0,LIMIT_ONE_PER_DRAWABLE:1,LIMIT_ONE:2,POINT_PRIMITIVES:1,LINE_PRIMITIVES:2,TRIANGLE_PRIMITIVES:4,ALL_PRIMITIVES:7}},function(e,t,i){"use strict";var r=i(10),a=i(681),n=i(599),o=function(){this._hit=!1,this._primitiveIndex=0,this._vertices=void 0,this._geometry=void 0,this._intersectionVisitor=void 0,this._intersector=void 0,this._limitOneIntersection=!1,this._primitiveMask=n.a.ALL_PRIMITIVES};o.Intersection=function(){this._nodePath=void 0,this._drawable=void 0,this._matrix=void 0,this._primitiveIndex=void 0,this._ratio=0,this._backface=!1,this._localIntersectionPoint=r.f.create()},o.prototype={reset:function(){this._hit=!1,this._vertices=void 0,this._primitiveIndex=0},setPrimitiveIndex:function(e){this._primitiveIndex=e},setGeometry:function(e){this._geometry=e,this._primitiveIndex=0,this._vertices=e.getAttributes().Vertex.getElements()},setVertices:function(e){this._vertices=e},setIntersectionVisitor:function(e){this._intersectionVisitor=e},setIntersector:function(e){this._intersector=e,this._primitiveMask=e.getPrimitiveMask();var t=e.getIntersectionLimit();this._limitOneIntersection=t===n.a.LIMIT_ONE_PER_DRAWABLE||t===n.a.LIMIT_ONE},setLimitOneIntersection:function(e){this._limitOneIntersection=e},leave:function(){},enter:function(){},initIntersection:function(e){return e._matrix=r.c.clone(this._intersectionVisitor.getModelMatrix()),e._nodePath=this._intersectionVisitor.getNodePath().slice(),e._primitiveIndex=this._primitiveIndex,e._drawable=this._geometry,this._intersector.getIntersections().push(e),this._hit=!0,e},intersectPoint:function(){},intersectLine:function(){},intersectTriangle:function(){},operatorPoint:function(){var e=r.f.create();return function(t){if(!(this._limitOneIntersection&&this._hit||0==(this._primitiveMask&n.a.POINT_PRIMITIVES))){var i=this._vertices;r.f.set(e,i[3*t],i[3*t+1],i[3*t+2]),this.intersectPoint(e,t),this._primitiveIndex++}}}(),operatorLine:function(){var e=r.f.create(),t=r.f.create();return function(i,a){if(!(this._limitOneIntersection&&this._hit||0==(this._primitiveMask&n.a.LINE_PRIMITIVES))){var o=this._vertices;r.f.set(e,o[3*i],o[3*i+1],o[3*i+2]),r.f.set(t,o[3*a],o[3*a+1],o[3*a+2]),this.intersectLine(e,t,i,a),this._primitiveIndex++}}}(),operatorTriangle:function(){var e=r.f.create(),t=r.f.create(),i=r.f.create();return function(a,o,s){if(!(this._limitOneIntersection&&this._hit||0==(this._primitiveMask&n.a.TRIANGLE_PRIMITIVES))){var u=this._vertices;r.f.set(e,u[3*a],u[3*a+1],u[3*a+2]),r.f.set(t,u[3*o],u[3*o+1],u[3*o+2]),r.f.set(i,u[3*s],u[3*s+1],u[3*s+2]),this.intersectTriangle(e,t,i,a,o,s),this._primitiveIndex++}}}(),apply:function(e){e.getAttributes().Vertex&&Object(a.a)(e,this)}},t.a=o},function(e,t,i){"use strict";var r=i(250),a=i(9),n=i(447),o=i(78),s=function(e){r.a.call(this,e),this.init()};a.a.createPrototypeObject(s,a.a.objectInherit(r.a.prototype,{init:function(){this._panFactor=[],this._panFactor[0]=1,this._panFactor[1]=-this._panFactor[0],this._rotateFactor=[],this._rotateFactor[0]=.6,this._rotateFactor[1]=-this._rotateFactor[0],this._zoomFactor=5,this._lastScale=0,this._zooming=!1,this._dragStarted=!1,this._initInputs(o.a.ORBIT_MANIPULATOR_TOUCH)},_initInputs:function(e){this._manipulator.getInputManager().group(e).addMappings({pinchEnd:"pinchend",pinchStart:"pinchstart",pinchInOut:["pinchin","pinchout"],startPan:["panstart 2"],startRotate:["panstart 1"],pan:["panmove 2"],rotate:["panmove 1"],endMotion:["touchend 2","touchcancel 2","touchend 1","touchcancel 1"]},this)},startPan:function(e){this._panning=!0,this.startMotion(this._manipulator.getPanInterpolator(),this._panFactor,e)},startRotate:function(e){this._rotating=!0,this.startMotion(this._manipulator.getRotateInterpolator(),this._rotateFactor,e)},pan:function(e){this._panning||(this.endMotion(),this.startPan(e)),this.move(this._manipulator.getPanInterpolator(),this._panFactor,e)},rotate:function(e){this._rotating||(this.endMotion(),this.startPan(e)),this.move(this._manipulator.getRotateInterpolator(),this._rotateFactor,e)},startMotion:function(e,t,i){if(!this._zooming){e.reset();var r=i.canvasX*t[0],a=i.canvasY*t[1];e.set(r,a)}},move:function(e,t,i){var r=i.canvasX*t[0],a=i.canvasY*t[1];e.setTarget(r,a)},endMotion:function(){(this._panning||this._rotating)&&(this._panning=!1,this._rotating=!1)},pinchStart:function(e){this._zooming=!0,this._lastScale=e.scale;var t=this._manipulator.getZoomInterpolator();t.reset(),t.set(this._lastScale)},pinchEnd:function(){this._zooming=!1},pinchInOut:function(e){if(this._zooming){var t=e.scale>this._lastScale?this._zoomFactor:3*this._zoomFactor,i=.5-Math.abs(e.velocity);t*=n.a.smoothStep(0,.5,i);var r=(e.scale-this._lastScale)*t;this._lastScale=e.scale;var a=this._manipulator.getZoomInterpolator();a.setTarget(a.getTarget()[0]-r)}},setManipulator:function(e){this._manipulator=e}})),t.a=s},function(e,t,i){"use strict";var r=function(e,t){this._current=new Float32Array(e),this._target=new Float32Array(e),this._delta=new Float32Array(e),this._delay=void 0!==t?t:.15,this._reset=!1,this._start=0,this.reset()};r.prototype={setDelay:function(e){this._delay=e},reset:function(){for(var e=0,t=this._current.length;e<t;e++)this._current[e]=this._target[e]=0;this._reset=!0},update:function(e){for(var t=Math.min(1,this._delay*e*60),i=0,r=this._current.length;i<r;i++){var a=(this._target[i]-this._current[i])*t;this._delta[i]=a,this._current[i]+=a}return this._delta},set:function(){for(var e=0,t=this._current.length;e<t;e++)this._current[e]=this._target[e]=arguments[e];this._reset=!1},isReset:function(){return this._reset},getCurrent:function(){return this._current},setTarget:function(){for(var e=0,t=this._target.length;e<t;e++)this._reset?this._target[e]=this._current[e]=arguments[e]:this._target[e]=arguments[e];this._reset=!1},addTarget:function(){for(var e=0;e<arguments.length;e++)this._target[e]+=arguments[e]},getTarget:function(){return this._target},getDelta:function(){return this._delta},getStart:function(){return this._start},setStart:function(e){this._start=e}},t.a=r},function(e,t,i){"use strict";var r=i(21),a=0,n=function(){this._name="AbstractNode",this._inputs=[],this._outputs=null,this._id=a++,this._text=void 0};n.prototype={getID:function(){return this._id},getName:function(){return this._name},getType:function(){return this.type},toString:function(){var e="name : "+this._name;return this.type&&(e+=" ("+this.type+")"),e},getInputs:function(){return this._inputs},getOutputs:function(){return this._outputs},checkInputsOutputs:function(){var e,t;if(this.validInputs)for(e=0;e<this.validInputs.length;e++)if(t=this.validInputs[e],!this._inputs[t])return r.a.error("Shader node "+this.type+" validation error input "+t+" is missing"),!1;if(this.validOutputs)for(e=0;e<this.validOutputs.length;e++)if(t=this.validOutputs[e],!this._outputs[t])return r.a.error("Shader node "+this.type+" validation error output "+t+" is missing"),!1;return!0},inputs:function(){for(var e=0,t=arguments.length;e<t;e++){var i=arguments[e];if(!i){r.a.error("Shader node "+this.type+" input number "+t+" is undefined ");break}if(Array.isArray(i))return this.inputs.apply(this,i),this;if("object"==typeof i&&null!==i&&i instanceof n==!1)return this._inputs=i,this;this._inputs.push(i)}return this},outputs:function(e){if(this._outputs=e,this._outputs instanceof n==!0)this.autoLink(this._outputs);else for(var t in this._outputs)this.autoLink(this._outputs[t]);return this},autoLink:function(e){return void 0===e?this:(e.inputs(this),this)},computeShader:function(){return this._text},comment:function(e){this._comment="//"+e},getComment:function(){return this._comment}},t.a=n},function(e,t,i){"use strict";var r=i(83),a=function(e,t,i){this._url=e,this._defer=new r.a,this._responseType=t,this._options=i};a.prototype={getPromise:function(){return this._defer},getURL:function(){return this._url},start:function(){this._xhr=new XMLHttpRequest,this._xhr.addEventListener("error",this.error.bind(this),!1),this._xhr.addEventListener("abort",this.abort.bind(this),!1),this._xhr.addEventListener("progress",this.progress.bind(this),!1),this._xhr.addEventListener("load",function(e){if(200!==this._xhr.status)return console.log("Error not loaded "+this._url),void this.error(e);this._xhr.response||(this._xhr.response=this._xhr.responseText),this.load.call(this)}.bind(this),!1),this._xhr.open("GET",this._url,!0),this._xhr.responseType=this._responseType,this._xhr.send(null)},error:function(){console.error("Error when downloading url : "+this._url),this._defer.reject(this)},abort:function(){this._defer.cancel(this)},progress:function(e){var t=this._options;if(t&&t.progress&&t.size){var i=e.loaded/t.size;t.progress(i,t.secondary,t.progressKey)}},load:function(){this._defer.resolve(this)},getXHR:function(){return this._xhr}},t.a=a},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(5)),n=i(16),o=i(606),s=a.a.osg,u=function(e,t,i,r){var a=i-e,n=r-t;return a*a+n*n},l=function(e){return o.a.isPowerOf2(e.width)&&o.a.isPowerOf2(e.height)},c={isVideoURL:function(e){var t=e.split("."),i=t[t.length-1].toLowerCase();return"ogv"===i||"ogg"===i||"mp4"===i||"avi"===i||"webm"===i},isVideo:function(){return this.isVideoURL(this.get("images")[0].url)},getUID:function(){return this.get("uid")},getImages:function(){return this.get("images")},getURL:function(){console.error("dont call ImageSet.getURL")},findFormat:function(e){if("N"===e){var t=Object(r.filter)(this.get("images"),function(t){var i=t.options&&t.options.format===e&&t.options.quality;return"percep"===Object(n.a)().normalCompression?i&&"percep"===i.flag:i&&"percep"!==i.flag});if(t.length)return t}return Object(r.filter)(this.get("images"),function(t){return!t.options||t.options.format===e})},getFilteredImages:function(e){if(!e||!Object(n.a)().imageCompression)return this.findFormat();var t;switch(e){case s.Texture.ALPHA:if(t=this.findFormat("A"),t.length>0)return t;break;case s.Texture.RGB:if(t=this.findFormat("RGB"),t.length>0)return t;if(t=this.findFormat("N"),t.length>0)return t;break;case s.Texture.LUMINANCE:if(t=this.findFormat("R"),t.length>0)return t;if(t=this.findFormat("RGB"),t.length>0)return t;if(t=this.findFormat("N"),t.length>0)return t}return this.findFormat()},findImageNearestPowerOfTwoUpToResolution:function(e,t,i){return this.findImageNearestUpToResolution(e,t,!0,i)},findImageNearestUpToResolution:function(e,t,i,r){for(var a,n,o=1/0,s=!1,c=1/0,h=this.getFilteredImages(r),d=0,p=h.length;d<p;++d){var f=h[d],m=u(e,t,f.width,f.height);if(m<o&&(o=m,a=f),!(f.width>e||f.height>t))if(i){var g=l(f);s&&!g||(!n||!s&&g||m<c||c===1/0&&f.width>n.width&&f.height>n.height)&&(n=f,s=g,c=m)}else(!n||m<c||c===1/0&&f.width>n.width&&f.height>n.height)&&(n=f,c=m)}return n||a},findImageSmallest:function(e){return this.findImageNearestToResolution(0,0,e)},findImageWidget:function(){return this.findImageNearestToResolution(0,0,s.Texture.RGB)},findImageNearestToResolution:function(e,t,i){for(var r,a=1/0,n=this.getFilteredImages(i),o=0,s=n.length;o<s;++o){var l=n[o],c=u(e,t,l.width,l.height);c<a&&(a=c,r=l)}return r}};t.a=c},function(e,t,i){"use strict";var r={};r.isPowerOf2=function(e){return 0==(e&e-1)},r.floorPowerOf2=function(e){return 1<<Math.floor(Math.log2(e))},r.ceilPowerOf2=function(e){return 1<<Math.ceil(Math.log2(e))},r.snapToPowerOf2=function(e,t){if(r.isPowerOf2(e))return e;var i=r.floorPowerOf2(e);return e/i-1>(void 0===t?.5:t)?r.ceilPowerOf2(e):i},t.a=r},function(e,t,i){"use strict";var r=i(5),a=i(16),n=r.a.osg,o=function(e){var t=n.WebGLCaps.instance(),i=t.getWebGLParameter("MAX_TEXTURE_SIZE"),r=t.getWebGLParameter("MAX_RENDERBUFFER_SIZE"),o=Object(a.a)().maxTextureSize,s=void 0===e?1/0:e;return Math.min(i,r,o,s)};t.a=o},function(e,t,i){"use strict";var r,a=i(5),n=i(1162),o=i(1163),s=i(37),u=i(16),l=a.a.osg,c=a.a.osgGA,h=a.a.osgUtil,d=h.DelayInterpolator.prototype,p=d.reset;d.reset=function(){p.call(this),this._epsilon=.01};var f=d.set;d.set=function(){f.apply(this,arguments),this._epsilon>=0&&!this.isDone()&&r(!0)};var m=d.setTarget;d.setTarget=function(){m.apply(this,arguments),this._epsilon>=0&&!this.isDone()&&r(!0)};var g=d.addTarget;d.addTarget=function(){g.apply(this,arguments),this._epsilon>=0&&!this.isDone()&&r(!0)},d.isDone=function(e){e=e||1;for(var t=Math.abs(this._epsilon),i=0,r=this._current.length;i<r;++i)if(Math.abs(this._target[i]-this._current[i])>t*e)return!1;return!0};var _=d.update;d.update=function(e){var t=_.call(this,e);if(this._epsilon>=0)if(this.isDone())for(var i=0,a=this._current.length;i<a;++i)this._current[i]=this._target[i];else r(),this.isDone(100)?s.a.draw():s.a.drawNoJitter();return t};var v=function(){for(var e=Math.abs(this._epsilon),t=0,i=this._current.length;t<i;++t)if(1===Math.abs(this._target[t])||Math.abs(this._target[t]-this._current[t])>e)return!1;return!0},b=function(e){e.isDone=v.bind(e)},y=function(e,t){r=t,c.SwitchManipulator.call(this),this._boundStrategy=c.Manipulator.COMPUTE_HOME_USING_SPHERE|c.Manipulator.COMPUTE_HOME_USING_BBOX,this._inputManager=e,this.init()};l.createPrototypeObject(y,l.objectInherit(c.SwitchManipulator.prototype,{init:function(){c.SwitchManipulator.prototype.setManipulatorIndex.call(this,0);var e=new o.a({boundStrategy:this._boundStrategy,inputManager:this._inputManager});e.getRotateInterpolator()._epsilon=.1,e.getPanInterpolator()._epsilon=.1,e.getZoomInterpolator()._epsilon=.001,e.getPanInterpolator()._isOrbitPan=!0;var t=new n.a({boundStrategy:this._boundStrategy,inputManager:this._inputManager});t.getLookPositionInterpolator()._epsilon=.1,t.getSideInterpolator()._epsilon=.001,b(t.getSideInterpolator()),t.getForwardInterpolator()._epsilon=.001,b(t.getForwardInterpolator()),t.getPanInterpolator()._epsilon=.001,b(t.getPanInterpolator()),t.getZoomInterpolator()._epsilon=.001,b(t.getZoomInterpolator()),this.addManipulator(e,"ORBIT"),this.addManipulator(t,"FPS"),void 0!==Object(u.a)().cameraEasing&&this.setDelay(1-Object(u.a)().cameraEasing)},getOrbitManipulator:function(){return this._manipulatorList[y.ORBIT]},getFirstPersonManipulator:function(){return this._manipulatorList[y.FPS]},_setManipulatorDelay:function(e,t){e.setDelay(t);var i=e._controllerList;for(var r in i){var a=i[r];void 0!==a._delay&&(a._delay=t)}},setDelay:function(e){this._setManipulatorDelay(this._manipulatorList[y.ORBIT],e),this._setManipulatorDelay(this._manipulatorList[y.FPS],e)},addManipulator:function(e,t){c.SwitchManipulator.prototype.addManipulator.call(this,e),t&&(y[t]=this.getManipulatorList().length-1)},setManipulatorIndex:function(){var e=l.vec3.create(),t=l.vec3.create();return function(i){if(i!==this.getCurrentManipulatorIndex()){var r=this.getCurrentManipulator();c.SwitchManipulator.prototype.setManipulatorIndex.call(this,i),this.setTargetAndEye(r.getTarget(e),r.getEyePosition(t))}}}(),setTargetAndEye:function(e,t){var i=this.getCurrentManipulator();this.getCurrentManipulatorIndex()===y.ORBIT?(e&&i.setTarget(e),t&&i.setEyePosition(t)):(t&&i.setEyePosition(t),e&&i.setTarget(e)),r(!0)},setEyePosition:function(e,t){this.getCurrentManipulator().setEyePosition(e,t),r(!0)},getEyePosition:function(e){return this.getCurrentManipulator().getEyePosition(e)},setTarget:function(e){this.getCurrentManipulator().setTarget(e),r(!0)},getTarget:function(e){return this.getCurrentManipulator().getTarget(e)},setDistance:function(e){this.getCurrentManipulatorIndex()===y.ORBIT&&(this.getCurrentManipulator().setDistance(e),r(!0))},getDistance:function(){return this.getCurrentManipulator().getDistance()},computeHomePosition:function(e){c.SwitchManipulator.prototype.computeHomePosition.call(this,e),r(!0)}}),"osgSketchfab","SwitchManipulator"),t.a=y},function(e,t,i){"use strict";t.a={iconCamCenter:i(1178),iconZoomHint:i(1179),iconsLight:{DIRECTION:i(1180),SPOT:i(1181),POINT:i(1182),HEMI:i(1183)},iconSound:i(1184),iconHotspot:i(1185)}},function(e,t,i){"use strict";var r=i(5),a=r.a.osg,n={uProjFactor:a.Uniform.createFloat("uProjFactor"),uSsaoRadius:a.Uniform.createFloat("uSsaoRadius"),uSsaoIntensity:a.Uniform.createFloat("uSsaoIntensity"),uSsaoBias:a.Uniform.createFloat("uSsaoBias"),uSsaoProjectionInfo:a.Uniform.createFloat4("uSsaoProjectionInfo"),uSsaoProjectionScale:a.Uniform.createFloat(1,"uSsaoProjectionScale"),uDofBlurNearFarFocal:a.Uniform.createFloat3("uDofBlurNearFarFocal"),uDofCross:a.Uniform.createFloat3(a.vec3.create(),"uDofCross"),uDofScale:a.Uniform.createFloat(1,"uDofScale"),uBloomFactor:a.Uniform.createFloat("uBloomFactor"),uBloomThreshold:a.Uniform.createFloat("uBloomThreshold"),uBloomRadius:a.Uniform.createFloat("uBloomRadius"),uChromaFactor:a.Uniform.createFloat("uChromaFactor"),uColorBalanceLow:a.Uniform.createFloat3("uColorBalanceLow"),uColorBalanceMid:a.Uniform.createFloat3("uColorBalanceMid"),uColorBalanceHigh:a.Uniform.createFloat3("uColorBalanceHigh"),uToneExposure:a.Uniform.createFloat("uToneExposure"),uToneBrightness:a.Uniform.createFloat("uToneBrightness"),uToneContrast:a.Uniform.createFloat("uToneContrast"),uToneSaturation:a.Uniform.createFloat("uToneSaturation"),uToneMethod:a.Uniform.createInt("uToneMethod"),uDistortion:a.Uniform.createFloat2("uDistortion"),uProjectionLeft:a.Uniform.createFloat4("uProjectionLeft"),uUnprojectionLeft:a.Uniform.createFloat4("uUnprojectionLeft"),uSharpFactor:a.Uniform.createFloat("uSharpFactor"),uLensRadius:a.Uniform.createFloat2("uLensRadius"),uTimeGrain:a.Uniform.createFloat("uTimeGrain"),uGrainFactor:a.Uniform.createFloat("uGrainFactor"),uTaaInvViewMatrixLeft:a.Uniform.createMatrix4("uTaaInvViewMatrixLeft"),uTaaCurrentFramePVLeft:a.Uniform.createMatrix4("uTaaCurrentFramePVLeft"),uTaaLastFramePVLeft:a.Uniform.createMatrix4("uTaaLastFramePVLeft"),uTaaCornersCSLeft:a.Uniform.createFloat4Array("uTaaCornersCSLeft",2),uTaaEnabled:a.Uniform.createFloat(1,"uTaaEnabled"),uTaaInvViewMatrixRight:a.Uniform.createMatrix4("uTaaInvViewMatrixRight"),uTaaCurrentFramePVRight:a.Uniform.createMatrix4("uTaaCurrentFramePVRight"),uTaaLastFramePVRight:a.Uniform.createMatrix4("uTaaLastFramePVRight"),uTaaCornersCSRight:a.Uniform.createFloat4Array("uTaaCornersCSRight",2),uVrFadeFactor:a.Uniform.createFloat(0,"uVrFadeFactor"),uVrVeilFactor:a.Uniform.createFloat(1,"uVrVeilFactor")};t.a=n},function(e,t,i){"use strict";var r=function(e){var t,i=window.WebKitBlobBuilder||window.MozBlobBuilder||window.BlobBuilder;t=e.split(",")[0].indexOf("base64")>=0?window.atob(e.split(",")[1]):window.decodeURI(e.split(",")[1]);for(var r=e.split(",")[0].split(":")[1].split(";")[0],a=new ArrayBuffer(t.length),n=new Uint8Array(a),o=0;o<t.length;o++)n[o]=t.charCodeAt(o);var s;if(void 0!==window.Blob)s=new Blob([n],{type:r});else if(void 0!==i){var u=new i;u.append(a),s=u.getBlob(r)}return s};t.a=r},function(e,t,i){"use strict";var r=i(5),a=r.a.osg,n=r.a.osgAnimation,o=function(e){for(var t=0,i=e.length;t<i;++t){var r,o=e[t];if(o instanceof n.Bone)r=n.UpdateBone;else{if(!(o instanceof a.MatrixTransform))continue;r=n.UpdateMatrixTransform}for(var s=o.getUpdateCallbackList(),u=0,l=s.length;u<l;++u)if(s[u]instanceof r)return!0}return!1};t.a=o},function(e,t,i){"use strict";var r=i(5),a=i(63),n=i(43),o=i(57),s=i(107),u=i(1246),l=i.n(u),c=i(1247),h=i.n(c),d=i(0),p=(i.n(d),r.a.osg),f=p.BufferArray,m=p.Geometry,g=p.primitiveSet,_=p.DrawElements,v=p.vec4.fromValues(1,1,1,1),b=function(e,t,i,r,a,n){p.MatrixTransform.call(this),this._subX=void 0!==a?a:1,this._subY=void 0!==n?n:1,this._curveAxis=i,this._curveFactor=r,this._distanceFromCam=2.5,this._width=1,t&&(this._distanceFromCam=t),e&&(this._width=e),this._clickActions={},this._opacity=1,this._round=.02,this._opaqueRollover=!1,this._visible=!0,this._currentPage=0,this._enabled=!0};b.AXIS_X=0,b.AXIS_Y=1,b.AXIS_BOTH=2,p.createPrototypeNode(b,p.objectInherit(p.MatrixTransform.prototype,{initialize:function(e,t){this._texPanel=e,this._metaData=this._computeMetaData(t),this._panelGeom=this._createGridGeometry(this._metaData.cells),this.addChild(this._panelGeom);var i=this._panelGeom.getOrCreateStateSet(),r=p.Uniform.createFloat1(this._opacity,"uAlpha");this._uAlpha=r.getInternalArray(),i.addUniform(r);var n=p.Uniform.createFloat1(t.aspectRatio,"uRatio");this._uRatio=n.getInternalArray(),i.addUniform(n);var u=p.Uniform.createFloat1(this._enabled?1:.5,"uVeilFactor");this._uVeilFactor=u.getInternalArray(),i.addUniform(u),i.addUniform(p.Uniform.createFloat1(this._opaqueRollover?1:0,"uHoveredOpaque"));var c=p.Uniform.createFloat1(this._round,"uRound");i.addUniform(c),i.addUniform(p.Uniform.createInt(0,"uTexturePanel")),i.setTextureAttributeAndModes(0,this._texPanel),i.setAttributeAndModes(a.a.CULL_DISABLE);var d=s.a.getOrCreateShader(l.a,h.a,"textured-panel","TexturedPanel");i.setAttributeAndModes(d);var f=p.Uniform.createFloat4(v,"uHoveredArea");this._uHoveredArea=f.getInternalArray(),i.addUniform(f),i.setRenderBinDetails(o.a.VR_MENU,"RenderBin"),i.setAttributeAndModes(a.a.BLEND_SUBSTRACTIVE),this.initPage(),this._initialized=!0},changeTexture:function(e){var t=this._panelGeom.getOrCreateStateSet();this._texPanel=e,t.setTextureAttributeAndModes(0,this._texPanel)},updateMetaData:function(e){this._metaData=this._computeMetaData(e),this._uRatio[0]=this._metaData.aspectRatio},setEnabled:function(e){this._enabled=e,this._uVeilFactor&&(this._uVeilFactor[0]=e?1:.5)},setMetaData:function(e){this._metaData=e,this._uRatio[0]=this._metaData.aspectRatio},getTexture:function(){return this._texPanel},isInitialized:function(){return this._initialized},setVisible:function(e){if(this._visible!==e){if(this._animation){if(!this._animation.isFinished())return;e&&this._doSetVisible(!0),this._animation.start(0)}else this._doSetVisible(e);this._visible=e}},_doSetVisible:function(e){this.setNodeMask(e?n.a.PICK_GEOMETRY_FAST:0),this._uAlpha&&(this._uAlpha[0]=1),e||this.initPage()},isVisible:function(){return this._visible},setOpacity:function(e){this._opacity=e,this._uAlpha&&(this._uAlpha[0]=e)},updateHit:function(e){if(this._initialized&&this._enabled){var t=e&&e._localIntersectionPoint;if(!e||-1===e._nodePath.indexOf(this))return void(void 0!==this._currentHovered&&(this._currentHovered=void 0,p.vec4.copy(this._uHoveredArea,v)));var i={x:(t[0]+.5*this._width)/this._width,y:(t[1]+.5*this._height)/this._height},r=this._metaData.pages?this._findPage(i):void 0,a=i.x,n=i.y;if(r){var o=r.areas;if(o)for(var s=0;s<o.length;s++)if(this._checkArea(o[s],a,n,r.items[s],r))return this}return"WHOLE_PANEL"!==this._currentHovered&&(this._currentHovered="WHOLE_PANEL",p.vec4.copy(this._uHoveredArea,v)),this}},_findPage:function(e){for(var t=e.x,i=e.y,r=0;r<this._metaData.cells.length;r++){var a=this._metaData.cells[r],n=a.x/this._width,o=1-a.y/this._height,s=(a.x+a.width)/this._width,u=1-(a.y+a.height)/this._height;if(t>=n&&t<=s&&i<=o&&i>=u)return e.x=(t-n)/(s-n),e.y=(i-u)/(o-u),a.page}},_checkArea:function(e,t,i,r,a){return t>e[0]&&t<e[1]&&i<e[2]&&i>e[3]&&(this._currentHovered!==r&&(this._currentHovered=r,a?(this._uHoveredArea[0]=a.x+e[0]*a.width,this._uHoveredArea[1]=a.x+e[1]*a.width,this._uHoveredArea[2]=1-a.y-a.height+e[2]*a.height,this._uHoveredArea[3]=1-a.y-a.height+e[3]*a.height):p.vec4.copy(this._uHoveredArea,e)),!0)},click:function(){if(this._currentHovered)if("WHOLE_PANEL"!==this._currentHovered){var e=this._clickActions[this._currentHovered];e&&e()}else this._panelClickAction&&this._panelClickAction()},initPage:function(){this._metaData&&this._metaData.pages&&this.setPageForCell(this._metaData.pages[0].id,this._metaData.cells[0].id)},setPageForCell:function(e,t){var i=this._getPage(e);if(!i)return void p.log("can't find page named "+e+" for panel "+(this._metaData?this._metaData.id:"unknown"));var r=this._getCell(t);if(!r)return void p.log("can't find cell named "+t+" for panel "+(this._metaData?this._metaData.id:"unknown"));r.page=i;for(var a=this._panelGeom.getAttributes().TexCoord0,n=a.getElements(),o=this._subY,s=this._subX,u=r.startIndex?r.startIndex:0,l=0;l<=o;l++)for(var c=0;c<=s;c++){var h=2*u;n[h]=i.x+c/s*i.width,n[h+1]=1-i.y-l/o*i.height,u++}a.dirty(),this._panelGeom.dirty()},_getPage:function(e){if(this._metaData&&this._metaData.pages)for(var t=0;t<this._metaData.pages.length;t++)if(this._metaData.pages[t].id===e)return this._metaData.pages[t]},_getCell:function(e){var t=this._metaData&&this._metaData.cells;if(t)for(var i=0;i<t.length;++i)if(t[i].id===e)return t[i]},setClickAction:function(e,t){this._clickActions[e]=t},removeClickAction:function(e){delete this._clickActions[e]},setPanelClickAction:function(e){this._panelClickAction=e},removePanelClickAction:function(){this._panelClickAction=void 0},displayInView:function(){var e=p.vec3.create(),t=p.vec3.create(),i=p.vec3.fromValues(0,0,.1),r=p.vec3.create();return function(a,n,o){p.vec3.copy(e,n),e[2]=a[2];var s=p.mat4.lookAt(this.getMatrix(),a,e,i);p.mat4.invert(s,s);var u=o;p.mat4.scale(s,s,p.vec3.set(t,u,u,u)),p.vec3.sub(r,e,a),p.vec3.normalize(r,r),p.vec3.scale(r,r,this._distanceFromCam*o),p.vec3.add(r,a,r),r[2]+=-.2*o,p.mat4.setTranslation(s,r),this.dirtyBound(),this.setVisible(!0)}}(),setAnimation:function(e){e.setOnFinishCallback(this._onAnimationFinished.bind(this)),this._animation=e,this.addUpdateCallback(e)},getAnimation:function(){return this._animation},_onAnimationFinished:function(){this._visible||this._doSetVisible(!1)},_computeMetaData:function(e){var t=Object(d.extend)(e,{aspectRatio:e.cellsWidth?e.cellsWidth/e.cellsHeight:e.width/e.height});this._height=this._width/t.aspectRatio;var i,r;if(t.pages)for(r=0;r<t.pages.length;r++){var a=t.pages[r];if(a.areas)for(i=0;i<a.areas.length;i++){var n=a.areas[i];n[0]=n[0]/a.width,n[1]=n[1]/a.width,n[2]=1-n[2]/a.height,n[3]=1-n[3]/a.height}a.x/=e.width,a.y/=e.height,a.width/=e.width,a.height/=e.height}if(t.cells&&t.cells.length>0)for(i=0;i<t.cells.length;i++){var o=t.cells[i];o.x=o.x/t.cellsWidth*this._width,o.y=o.y/t.cellsHeight*this._height,o.z/=100,o.width=o.width/t.cellsWidth*this._width,o.height=o.height/t.cellsHeight*this._height}else t.cells=[{id:"default",x:0,y:0,z:0,width:this._width,height:this._height}];return t},_createTexturedGridGeometry:function(e,t,i,r,a,n,o,s,u,l,c,h){t*=-1,s&&(u=void 0!==u?u:.2);for(var d=r/n,p=a/o,f=this._verticesIndex,m=0,g=0,_=this._indicesIndex,v=0,y=0,x=0;x<=o;x++)for(var S=0;S<=n;S++)m=3*f,g=2*f,c[g]=S/n,c[g+1]=1-x/o,s&&(s!==b.AXIS_X&&s!==b.AXIS_BOTH||(v=S/n-.5,v=v*v*u),s!==b.AXIS_Y&&s!==b.AXIS_BOTH||(y=x/o-.5,y=y*y*u)),l[m]=e+d*S,l[m+1]=t-p*x,l[m+2]=i+v+y,f++;var M=this._verticesIndex;this._verticesIndex=f;for(var w=0;w<n*o;w++)_=this._indicesIndex+6*w,f=M+w+Math.floor(w/n),h[_]=f,h[_+1]=n+1+f,h[_+2]=n+1+f+1,h[_+3]=n+1+f+1,h[_+4]=f+1,h[_+5]=f;this._indicesIndex=_+6},_createGridGeometry:function(e){var t=this._subY,i=this._subX,r=(i+1)*(t+1)*e.length,a=new m,n=new Float32Array(3*r),o=new Float32Array(2*r),s=new Uint8Array(i*t*6*e.length);this._verticesIndex=0,this._indicesIndex=0;for(var u=.5*this._width,l=.5*this._height,c=0;c<e.length;c++){var h=e[c];h.startIndex=this._verticesIndex,this._createTexturedGridGeometry(h.x-u,h.y-l,h.z,h.width,h.height,i,t,this._curveAxis,this._curveFactor,n,o,s)}a.getAttributes().Vertex=new f(f.ARRAY_BUFFER,n,3),a.getAttributes().TexCoord0=new f(f.ARRAY_BUFFER,o,2);var d=new _(g.TRIANGLES,new f(f.ELEMENT_ARRAY_BUFFER,s,1));return a.getPrimitives().push(d),a}}),"osgSketchfab","TexturedPanel"),t.a=b},function(e,t,i){"use strict";i.d(t,"b",function(){return h});var r=function(e){var t=0;return e<.0031308?e>0&&(t=12.92*e):t=1.055*Math.pow(e,1/2.4)-.055,t},a=function(e){var t=0;return e<.04045?e>=0&&(t=e*(1/12.92)):t=Math.pow((e+.055)*(1/1.055),2.4),t},n=function(e,t){var i=t||new Array(e.length);return i[0]=r(e[0]),i[1]=r(e[1]),i[2]=r(e[2]),i.length>3&&e.length>3&&(i[3]=e[3]),i},o=function(e,t){var i=t||new Array(e.length);return i[0]=a(e[0]),i[1]=a(e[1]),i[2]=a(e[2]),i.length>3&&e.length>3&&(i[3]=e[3]),i},s=function(e,t,i){i[3]=Math.min(1,Math.max(e[0]/t,i[1]/t,i[2]/t,1e-6)),i[3]=Math.ceil(255*i[3])/255;var r=1/(t*i[3]);return i[0]=e[0]*r,i[1]=e[1]*r,i[2]=e[2]*r,i},u=function(e,t,i){var r=t*e[3];return i[0]=r*i[0],i[1]=r*i[1],i[2]=r*i[2],i},l=function(e){var t={r:Math.round(255*e.r),g:Math.round(255*e.g),b:Math.round(255*e.b)};return"#"+(16777216|t.b|t.g<<8|t.r<<16).toString(16).substr(1)},c=function(e){return/^[0-9a-f]{3}([0-9a-f]{3})?$/i.test(e)},h=function(e){var t=decodeURI(e);return c(t)?"#"+t:t};t.a={linearToSrgb1:r,srgbToLinear1:a,linearToSrgb:n,srgbToLinear:o,encodeRGBM:s,decodeRGBM:u,rgbToHex:l,parseUrlColor:h}},function(e,t,i){"use strict";var r=i(5),a=i(16),n=r.a.osg,o=function(e){n.StateAttribute.call(this),this._enable=!e&&Object(a.a)().zz};n.createPrototypeStateAttribute(o,n.objectInherit(n.StateAttribute.prototype,{attributeType:"VertexCompression",cloneType:function(){return new o(!0)},isEnabled:function(){return this._enable},getHash:function(){return"VCMP"+(this._enable?1:0)}}),"osg","VertexCompression"),t.a=o},function(e,t){e.exports={websiteTopHeight:"60px",websiteBannerHeight:"50px",websiteResponsiveTopHeight:"40px",websiteResponsiveNavigationWidth:"250px",editorHeaderHeight:"55px",editorPanelWidth:"320px",editorScrollbarWidth:"10px",editorGroupWidgetHeaderHeight:"30px",editorGroupWidgetSwitchWidth:"50px",editorGroupWidgetSwitchHeight:"24px",editorGroupWidgetSwitchMargin:"2px",editorGroupWidgetSwitchCursorWidth:"12px",editorNestedGroupWidgetSwitchMargin:"3px",editorImageWidgetWidth:"30px",editorImageWidgetHeight:"30px",viewerControlSize:"30px",websiteMaxWidth:"2000px",responsiveBreakpointXXLarge:"1910px",responsiveBreakpointXLarge:"1400px",responsiveBreakpointLarge:"1280px",responsiveBreakpointMedium:"1100px",responsiveBreakpointSmall:"950px",responsiveBreakpointXSmall:"800px",responsiveBreakpointXXSmall:"480px",responsiveGridOneColumn:"700px",responsiveGridTwoColumn:"1015px",responsiveGridThreeColumn:"1910px"}},function(e,t,i){"use strict";var r=i(3),a=i.n(r),n=i(130);t.a={name:"WithRefs",refs:{},initialize:function(){this.refreshRefs()},afterRender:function(){this.refreshRefs()},refreshRefs:function(){this.refs=Object(n.c)(this.$("[data-ref]")).reduce(function(e,t){var i=t.getAttribute("data-ref");return e["$"+i]=a()(t),e[i]=t,e},{})}}},function(e,t,i){"use strict";var r=!1;window&&window.navigator&&(r=-1!==window.navigator.userAgent.indexOf("Edge"));var a=function(){return r};t.a=a},function(e,t,i){"use strict";var r=i(5),a=i(420),n=r.a.osg,o=r.a.osgShader,s=function(){a.a.apply(this,arguments)};o.Compiler.setStateAttributeConfig(s,o.Compiler.cloneStateAttributeConfig(a.a)),n.createPrototypeObject(s,n.objectInherit(a.a.prototype,{getCompilerName:function(){return"PBR"},getTextureEnvironmentSpecular:function(){var e=this._texturesByName.TextureEnvironmentSpecularPBR;return e&&e.texture},getTextureEnvironmentIntegrateBRDF:function(){var e=this._texturesByName.TextureEnvironmentIntegrateBRDF;return e&&e.texture},getEnvironmentSpecular:function(){var e=this.getTextureEnvironmentSpecular();if(e){if(this.getVariable("envSpecular"))return this.getVariable("envSpecular");var t,i=this.createVariable("vec3","envSpecular"),r=this.getEnvironmentUniforms(),a=e.getIsCubemap(),n=[a?"#define CUBEMAP":"#define PANORAMA"];this.getTextureEnvironmentIntegrateBRDF()&&(t=this.getOrCreateSampler("sampler2D",r.textureIntegrateBRDF.getName()),n.push("#define TEXTURE_BRDF"));var o=[];a&&o.push("#extension GL_EXT_shader_texture_lod : require");var s=this.createVariable("vec3");this.getNode("ComputeIBLSpecularUE4").inputs({normal:this.getOrCreateMaterialNormal(),eyeVector:this.getOrCreateNormalizedViewEyeDirection(),roughness:this.getOrCreateMaterialRoughness(),specular:this.getOrCreateMaterialSpecularPBR(),envTransform:this.getOrCreateEnvironmentTransform(),texSpecular:this.getOrCreateSampler(a?"samplerCube":"sampler2D",r.textureSpecularPBR.getName()),lodRange:this.getOrCreateUniform(e.getOrCreateUniforms().lodRange),texSize:this.getOrCreateUniform(e.getOrCreateUniforms().size),frontNormal:this.getOrCreateNormalizedFrontViewNormal(),texBRDF:t}).outputs({result:s}).addDefines(n).addExtensions(o);var u=this.getOrCreateUniform(r.exposure);return this.getNode("Mult").inputs(s,this.getOrCreateMaterialAOSpecularPBR(),u).outputs(i),i}},readChannel:function(e,t,i,r){var n=a.a.prototype.readChannel.apply(this,arguments);if(n)return n;switch(e){case"DiffusePBR":case"AlbedoPBR":case"SpecularPBR":n=this.readTexture("vec3",e,t,i,r);break;case"GlossinessPBR":case"RoughnessPBR":case"MetalnessPBR":case"SpecularF0":case"CavityPBR":case"AOPBR":n=this.readTexture("float",e,t,i,r)}return n},getOrCreateMaterialSpecularF0:function(){var e=this.getVariable("materialSpecularf0");if(e)return e;e=this.createVariable("float","materialSpecularf0");var t=this.getOrCreateChannel("SpecularF0");if(!t)return e.setValue("0.04");var i=this.createVariable("float").setValue("0.0"),r=this.createVariable("float").setValue("0.08");return this.getNode("Blend").mode("MIX").inputs(i,r,t).outputs(e),e},getOrCreateMaterialAmbientOcclusion:function(){return this.getOrCreateChannel("AOPBR")||this.createVariableOne("float")},getOrCreateMaterialAOSpecularPBR:function(){if(!this.getOrCreateChannel("AOPBR"))return this.createVariableOne("float");var e=this.getVariable("materialAO");return e||(e=this.createVariable("float","materialAO"),this.getNode("SpecularOcclusion").inputs({occlude:this.getOrCreateUniform("int","uAOPBROccludeSpecular"),ao:this.getOrCreateMaterialAmbientOcclusion(),normal:this.getOrCreateGeometryNormal(),eyeVector:this.getOrCreateNormalizedViewEyeDirection()}).outputs({result:e}),e)},getOrCreateMaterialCavityPBR:function(){return this.getOrCreateChannel("CavityPBR")||this.createVariableOne("float")},getShadelessColor:function(){var e=this.createVariable("vec3");return this.getNode("Mult").inputs(this.getOrCreateMaterialAlbedo(),this.getOrCreateMaterialAmbientOcclusion()).outputs(e),e},getOrCreateMaterialAlbedo:function(){var e=this.getVariable("materialAlbedo");if(e)return e;e=this.createVariable("vec3","materialAlbedo");var t=this.getOrCreateChannel("AlbedoPBR")||this.getOrCreateChannel("DiffusePBR")||this.createVariableZero("vec3");return this.getNode("SetFromNode").inputs(this.multiplyDiffuseWithVertexColor(t)).outputs(e),e},getOrCreateMaterialDiffuseColor:function(){var e=this.getVariable("materialDiffusePBR");if(e)return e;e=this.createVariable("vec3","materialDiffusePBR");var t=this.getOrCreateChannel("MetalnessPBR");if(t){this.getNode("InlineCode").code("%out = %albedo * (1.0 - %metal);").inputs({albedo:this.getOrCreateMaterialAlbedo(),metal:t}).outputs({out:e})}else this.getNode("SetFromNode").inputs(this.getOrCreateMaterialAlbedo()).outputs(e);return e},getOrCreateMaterialRoughness:function(){var e=this.getVariable("materialRoughness");if(e)return e;e=this.createVariable("float","materialRoughness");var t=this.getOrCreateChannel("RoughnessPBR");t||(t=this.getOrCreateChannel("GlossinessPBR"))&&(t=this.getRoughnessFromGlossiness(t)),t=t?this.getMinRoughness(t):this.createVariable("float").setValue("0.2");var i=t;return this._texturesByName.NormalMap&&(i=this.createVariable("float"),this.getNode("AdjustRoughnessNormalMap").inputs({roughness:t,normal:this.getOrCreateNormalMap()}).outputs({result:i})),this.getNode("AdjustRoughnessGeometry").inputs({roughness:i,normal:this.getOrCreateNormalizedFrontViewNormal()}).outputs({result:e}),e},getOrCreateMaterialSpecularPBR:function(){var e=this.getOrCreateChannel("SpecularPBR");if(e)return e;var t=this.getVariable("materialSpecularPBR");if(t)return t;t=this.createVariable("vec3","materialSpecularPBR");var i=this.getOrCreateChannel("MetalnessPBR");if(!i)return t.setValue("vec3(0.05)");return this.getNode("InlineCode").code("%out = mix(vec3(%f0), %albedo, %metal);").inputs({metal:i,albedo:this.getOrCreateMaterialAlbedo(),f0:this.getOrCreateMaterialSpecularF0()}).outputs({out:t}),t},getOrCreatePrecomputeGGX:function(){var e=this.getVariable("prepGGX");if(e)return e;e=this.createVariable("vec4","prepGGX");var t={normal:this.getOrCreateMaterialNormal(),eyeVector:this.getOrCreateNormalizedViewEyeDirection(),roughness:this.getOrCreateMaterialRoughness()};return this.getNode("PrecomputeGGX").inputs(t).outputs({result:e}),e},getLightWithPrecompute:function(e,t){var i=e.getOrCreateUniforms(),r={normal:this.getOrCreateMaterialNormal(),eyeVector:this.getOrCreateNormalizedViewEyeDirection(),dotNL:t.dotNL,precomputeGGX:this.getOrCreatePrecomputeGGX(),diffuse:this.getOrCreateMaterialDiffuseColor(),specular:this.getOrCreateMaterialSpecularPBR(),attenuation:t.attenuation,lightColor:this.getOrCreateUniform(i.diffuse),eyeLightDir:t.eyeLightDir},a=this.getOutputsFromLight();return this.getNode("ComputeLightLambertGGX").inputs(r).outputs(a),a},getRoughnessFromGlossiness:function(e){var t=this.createVariable("float");return this.getNode("InlineCode").code("%out = 1.0 - %input;").inputs({input:e}).outputs({out:t}),t},getMinRoughness:function(e){var t=this.createVariable("float");return this.getNode("InlineCode").code("%out = max(1.e-4, %input);").inputs({input:e}).outputs({out:t}),t},getOrCreateChannel:function(e){var t=a.a.prototype.getOrCreateChannel.call(this,e);return t?"SpecularPBR"!==e&&"MetalnessPBR"!==e?t:this._refractionSpecularDone||!this.isRefractionMaterial()?t:(this._refractionSpecularDone=!0,"SpecularPBR"===e?this.getNode("InlineCode").code("%output = mix(0.08 * %input, %input, %mask);").inputs({mask:this.getOrCreateChannel("Opacity"),input:t}).outputs({output:t}):this.getNode("Mult").inputs(t,this.getOrCreateChannel("Opacity")).outputs(t),t):t},getRefractionRoughness:function(){var e=this.getOrCreateUniform("float","uOpacityRoughnessFactor");if(!this._channels.Opacity.get("useMicrosurfaceTexture"))return e;var t;if(this.getOrCreateChannel("RoughnessPBR")){var i=this.getVariable("RoughnessPBRFetch");return i?(t=this.createVariable("float"),this.getNode("Mult").inputs(i,e).outputs(t),t):e}this.getOrCreateChannel("GlossinessPBR");var r=this.getVariable("GlossinessPBRFetch");if(!r)return e;t=this.createVariable("float"),r=this.getRoughnessFromGlossiness(r);var a=this.getOrCreateConstantOne("float");return this.getNode("Blend").mode("MIX").inputs(r,a,e).outputs(t),t},getFinalFrag:function(e){var t=this.createVariable("vec3");return this.getNode("Mult").inputs(e,this.getOrCreateMaterialCavityPBR()).outputs(t),a.a.prototype.getFinalFrag.call(this,t)}})),t.a=s},function(e,t,i){"use strict";var r=i(5),a=i(619),n=i(16),o=r.a.osg,s=r.a.osgShader,u=function(){a.a.apply(this,arguments),this._isVertexAlpha=!!this._material&&this._material.getVertexAlphaEnable(),this._isVertexColored=this._isVertexAlpha},l=s.Compiler.cloneStateAttributeConfig(a.a);l.attribute=["VertexCompression","SketchfabMaterial","Morph","Skinning","PointSize"],s.Compiler.setStateAttributeConfig(u,l),o.createPrototypeObject(u,o.objectInherit(a.a.prototype,{getCompilerName:function(){return"earlyZ"},getOrCreateChannel:function(e){switch(e){case"Opacity":case"Displacement":case"SubsurfaceScattering":return a.a.prototype.getOrCreateChannel.call(this,e)}},registerTextureEnvironment:function(){},registerTextureShadow:function(){},getScatter:function(){var e=this.getOrCreateChannel("SubsurfaceScattering");if(!e)return this.createVariableZero("float");var t=this.createVariable("float"),i=this.getOrCreateUniform("float","uScatteringFactorPacker");return this.getNode("Mult").inputs(e,i).outputs(t),t},getAlpha:function(){if(!this.isAlphaBlendedMaterial())return this.createVariableOne("float");var e=this.createVariable("float");return this.getNode("InlineCode").code("%outAlpha = %drawOpaque == 1 ? 1.0 : %alpha;").inputs({alpha:this.getOrCreateChannel("Opacity"),drawOpaque:this.getOrCreateUniform("int","uDrawOpaque")}).outputs({outAlpha:e}),e},getDepth:function(){var e=this.createVariable("float");return this.getNode("InlineCode").code("%depth = (-%eye.z * %eye.w - %nearFar.x) / (%nearFar.y - %nearFar.x);").inputs({eye:this.getOrCreateViewVertex(),nearFar:this.getOrCreateUniform("vec2","uNearFar")}).outputs({depth:e}),e},getProfile:function(){return this.getOrCreateChannel("SubsurfaceScattering")?this.getOrCreateUniform("float","uSubsurfaceScatteringProfile"):this.createVariableZero("float")},createDepthFrag:function(){var e=this.createVariable("vec4");return this.getNode("EncodeDepthAlphaProfileScatter").inputs({depth:this.getDepth(),profile:this.getProfile(),scatter:this.getScatter(),alpha:this.getAlpha()}).outputs({result:e}),Object(n.a)().ssaoNormal&&this.getNode("InlineCode").code("%depth.ba = normalize(%normal).rg * 0.5 + 0.5;").inputs({normal:this.getOrCreateMaterialNormal()}).outputs({depth:e}),e},applyDiscardTransparentOpaque:function(e){if(!this.getOrCreateChannel("SubsurfaceScattering")){var t=(1-Object(n.a)().epsilonAlpha).toExponential(),i="if(%drawOpaque == 1 && %alpha < "+t+") discard;";this.getNode("InlineCode").code(i).inputs({alpha:this.getOrCreateChannel("Opacity"),drawOpaque:this.getOrCreateUniform("int","uDrawOpaque")}).outputs({out:e})}},createFragmentShaderGraph:function(){var e=this.getNode("glFragColor");this.isAlphaBlendedMaterial()||this.isRefractionMaterial()?this.applyDiscardTransparentOpaque(e):this.isDitheringMaskingMaterial()&&this.applyAlphaMask(e),this.applyPointSizeCircle(e);var t=this.createDepthFrag();return this.getNode("SetFromNode").inputs(t).outputs(e),[e]}})),t.a=u},,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";t.a=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),i=e.indexOf("Trident/");return(t>=0||i>=0)&&(document.all&&!window.atob)}},,,,,,,function(e,t,i){"use strict";var r=i(29),a=i.n(r),n=i(7),o=i.n(n),s=i(3),u=i.n(s),l=i(12),c=i(605);t.a=l.a.extend({defaults:{colorSpace:"unknown"},endpoint:function(){return"/textures"+(this.isNew()?"":"/"+this.get("uid"))},isValid:function(){var e=this.get("name");return void 0===e&&console.warn("no name for Texture "+this.id),e=e||this.id,void 0===this.get("images")&&console.warn("no images for Texture "+e),void 0===this.get("uid")&&console.warn("no uid for Texture "+e),!0},save:function(e,t){null!=e&&"object"!==(void 0===e?"undefined":a()(e))||(t=e);var i=new FormData;return i.append("imageFile",this.get("imageFile"),this.get("name")),i.append("colorSpace",this.get("colorSpace")),i.append("modelUid",t.modelUID),o.a.resolve(u.a.ajax({url:this.url(),data:i,processData:!1,contentType:!1,type:"POST"}))},saveColorspace:function(){return o.a.resolve(u.a.ajax({url:this.url(),data:{colorSpace:this.get("colorSpace")},type:"PATCH"}))}}).extend(c.a)},,,,,,,,,,,,,,,function(e,t,i){"use strict";var r=i(29),a=i.n(r),n=i(7),o=i.n(n),s=i(15),u=i.n(s),l=i(3),c=i.n(l),h=i(12);t.a=h.a.extend({defaults:function(){return{name:"",content:"",position:[0,0,0],eye:[0,0,0],target:[0,0,0],lastComputedScenePosition:[0,0,0],lastComputedWorldPosition:[0,0,0],uidImage:void 0,imageFile:void 0,preview:"",hovered:!0,geometryUid:-1,indices:[-1,-1,-1],barycentricWeights:[0,0,0],localPosition:[0,0,0]}},endpoint:function(){return"/hotspots"+(this.isNew()?"":"/"+this.get("uid"))},remove:function(){return o.a.resolve(u.a.ajax({type:"DELETE",url:this.url()}))},appendArray:function(e,t,i){for(var r=0,a=i.length;r<a;++r)e.append(t,i[r])},_dumpOptions:function(){return{eye:this.get("eye").toString(),target:this.get("target").toString(),position:this.get("position").toString(),content:this.get("content").raw,name:this.get("name"),imFile:this.get("imFile")}},registerOptions:function(){this._lastOptions=this._dumpOptions()},hasChangedOptions:function(){if(!this._lastOptions)return!0;var e=this._dumpOptions(),t=this._lastOptions;for(var i in t)if(t[i]!==e[i])return!0;return!1},save:function(e,t){if(!this.hasChangedOptions())return o.a.resolve();this.registerOptions(),null!=e&&"object"!==(void 0===e?"undefined":a()(e))||(t=e);var i=this.isNew(),r=new FormData,n=this.get("imageFile");void 0===this.get("uidImage")&&n&&r.append("imageFile",n),r.append("model",t.modelUID),r.append("name",this.get("name"));var s=this.get("content").raw;r.append("content",null!==s?s:""),this.appendArray(r,"eye",this.get("eye")),this.appendArray(r,"target",this.get("target")),this.appendArray(r,"position",this.get("position"));var u=this,l=c.a.ajax({type:i?"POST":"PATCH",url:this.url(),data:r,cache:!1,contentType:!1,processData:!1,success:function(e){i&&(u.set("uid",e.uid),e.images.length>0&&u.set("uidImage",e.images[0].uid))},error:function(e){console.error(e.stack)}});return o.a.resolve(l)},_validate:function(e,t){return t=t||{},t.validate=!0,h.a.prototype._validate.call(this,e,t)},validate:function(e){var t=e.eye,i=e.target,r=i[0]-t[0],a=i[1]-t[1],n=i[2]-t[2],o=Math.sqrt(r*r+a*a+n*n);if(o<=1e-8)return i[0]=e.position[0],i[1]=e.position[1],i[2]=e.position[2],!1;if(o<=.001){var s=.01/o;i[0]=t[0]+r*s,i[1]=t[1]+a*s,i[2]=t[2]+n*s}return!1}})},,,,,,function(e,t,i){"use strict";var r=navigator.vendor&&navigator.vendor.indexOf("Apple")>-1&&navigator.userAgent&&!navigator.userAgent.match("CriOS");t.a=r},function(e,t,i){"use strict";var r=i(166);t.a=r.a.extend({events:{"click .close":"hide","touchstart .close":"hide"},show:function(e){e&&e.preventDefault&&e.preventDefault(),this.$el.removeClass("hidden")},hide:function(e){e&&e.preventDefault&&e.preventDefault(),this.$el.addClass("hidden")},isVisible:function(){return!this.el.classList.contains("hidden")}})},,function(e,t,i){"use strict";var r=i(21),a=i(9),n=i(214),o=i(10),s=i(54),u=i(127),l=i(98),c=function(){n.a.call(this),this._matrix=o.c.create(),this._position=o.f.create(),this._matrixDirty=!0,this._scale=o.f.fromValues(1,1,1),this._minimumScale=0,this._maximumScale=Number.MAX_VALUE,this._rotation=o.d.create(),this._pivotPoint=o.f.create(),this._autoScaleToScreen=!1,this._autoRotateToScreen=!1,this._cachedMatrix=o.c.create(),this._firstTimeToInitEyePoint=!0,this._autoScaleTransitionWidthRatio=.25,this._billboardAttribute=void 0,this._previousWidth=0,this._previousHeight=0,this._previousProjection=o.c.create(),this._previousModelView=o.c.create(),this._previousPosition=o.f.create()};a.a.createPrototypeNode(c,a.a.objectInherit(n.a.prototype,{getMatrix:function(){return this._matrix},setMatrix:function(e){this._matrix=e,this.dirtyBound()},setPosition:function(e){this._position=e,this._matrixDirty=!0,this.dirtyBound()},getPosition:function(){return this._position},setRotation:function(e){this._rotation=e,this._matrixDirty=!0,this.dirtyBound()},getRotation:function(){return this._rotation},setScale:function(e){this.setScaleFromVec3(o.f.fromValues(e,e,e))},setScaleFromvec3:function(e){r.a.warn("deprecated, use setScaleFromVec3"),this.setScaleFromVec3(e)},setScaleFromVec3:function(e){this._scale=e,this._matrixDirty=!0,this.dirtyBound()},getScale:function(){return this._scale},setMinimumScale:function(e){this._minimumScale=e},getMinimumScale:function(){return this._minimumScale},setMaximumScale:function(e){this._maximumScale=e},getMaximumScale:function(){return this._maximumScale},setAutoScaleToScreen:function(e){this._autoScaleToScreen=e,this._matrixDirty=!0},getAutoScaleToScreen:function(){return this._autoScaleToScreen},setAutoRotateToScreen:function(e){this._autoRotateToScreen=e},getAutoRotateToScreen:function(){return this._autoRotateToScreen},setAutoScaleTransitionWidthRatio:function(e){this._autoScaleTransitionWidthRatio=e},getAutoScaleTransitionWidthRatio:function(){return this._autoScaleTransitionWidthRatio},computeLocalToWorldMatrix:function(e){this._matrixDirty&&this.computeMatrix(),this.referenceFrame===u.a.RELATIVE_RF?o.c.mul(e,e,this._matrix):o.c.copy(e,this._matrix)},computeMatrix:function(){var e=o.f.create(),t=o.c.create();return function(){this._matrixDirty&&(o.c.fromQuat(this._matrix,this._rotation),o.c.fromTranslation(t,this._position),o.c.mul(this._matrix,t,this._matrix),o.c.scale(this._matrix,this._matrix,this._scale),o.c.translate(this._matrix,this._matrix,o.f.neg(e,this._pivotPoint)),this._matrixDirty=!1)}}(),computeWorldToLocalMatrix:function(){var e=o.f.create(),t=o.d.create(),i=o.f.create(),r=o.c.create();return function(a){return(0!==this.scale[0]||0!==this.scale[1]||0!==this.scale[2])&&(i[0]=1/this._scale[0],i[1]=1/this._scale[1],i[2]=1/this._scale[2],this.referenceFrame===u.a.RELATIVE_RF?(o.c.fromTranslation(r,o.f.neg(e,this._position)),o.c.mul(a,r,a),o.d.zeroRotation(this._rotation)||(o.c.fromQuat(r,o.d.invert(t,this._rotation)),o.c.mul(a,r,a)),o.c.fromScaling(r,i),o.c.mul(a,r,a),o.c.fromTranslation(r,this._pivotPoint),o.c.mul(a,r,a)):(o.c.fromQuat(this._matrix,o.d.invert(t,this._rotation)),o.c.translate(a,a,o.f.neg(e,this._position)),o.c.fromScaling(r,i),o.c.mul(a,r,a),o.c.fromTranslation(r,this._pivotPoint),o.c.mul(a,r,a)),!0)}}(),computeBound:function(){var e=o.c.create();return function(t){return this._autoScaleToScreen&&this._firstTimeToInitEyePoint?t:(l.a.prototype.computeBound.call(this,t),t.valid()?(o.c.identity(e),this.computeLocalToWorldMatrix(e),t.transformMat4(t,e),t):t)}}(),accept:function(){return function(e){if(e.getVisitorType()===s.a.CULL_VISITOR){var t=e.getViewport().width(),i=e.getViewport().height(),r=e.getCurrentProjectionMatrix(),a=e.getCurrentModelViewMatrix(),n=this._position,u=this._firstTimeToInitEyePoint;if(this._firstTimeToInitEyePoint||(t!==this._previousWidth||i!==this._previousHeight?u=!0:o.c.exactEquals(r,this._previousProjection)&&o.c.exactEquals(a,this._previousModelView)?o.f.exactEquals(n,this._previousPosition)||(u=!0):u=!0),this._firstTimeToInitEyePoint=!1,u){if(this._autoScaleToScreen){var c=e.getViewport(),h=this.computePixelSizeVector(c,r,a),d=o.g.fromValues(this._position[0],this._position[1],this._position[2],1),p=o.g.dot(d,h);p=.48/p;var f=1/p;if(this._autoScaleTransitionWidthRatio>0){var m,g,_;if(this._minimumScale>0){var v=this._minimumScale,b=this._maximumScale<Number.MAX_VALUE?this._minimumScale+(this._maximumScale-this._minimumScale)*this._autoScaleTransitionWidthRatio:this._minimumScale*(1+this._autoScaleTransitionWidthRatio);m=1/(4*(b-v)),g=1-2*m*b,_=v+g*g/(4*m);f<-g/(2*m)?f=this._minimumScale:f<b&&(f=_+g*f+m*(f*f))}if(this._maximumScale<Number.MAX_VALUE){var y=this._maximumScale,x=this._minimumScale>0?this._maximumScale+(this._minimumScale-this._maximumScale)*this._autoScaleTransitionWidthRatio:this._maximumScale*(1-this._autoScaleTransitionWidthRatio);m=1/(4*(x-y)),g=1-2*m*x,_=y+g*g/(4*m);f>-g/(2*m)?f=this._maximumScale:f>x&&(f=_+g*f+m*(f*f))}}this.setScale(f)}if(this._autoRotateToScreen){var S=o.d.create();o.c.getRotation(S,a),this.setRotation(o.d.invert(S,S))}this._previousWidth=t,this._previousHeight=i,o.f.copy(this._previousPosition,n),o.c.copy(this._previousProjection,r),o.c.copy(this._previousModelView,a)}}l.a.prototype.accept.call(this,e)}}(),computePixelSizeVector:function(){var e=o.f.create(),t=o.f.create();return function(i,r,a){var n=r[0]*i.width()*.5,s=r[8]*i.width()*.5+r[11]*i.width()*.5;o.f.set(e,a[0]*n+a[2]*s,a[4]*n+a[6]*s,a[8]*n+a[10]*s);var u=r[5]*i.height()*.5,l=r[9]*i.height()*.5+r[11]*i.height()*.5;o.f.set(t,a[1]*u+a[2]*l,a[5]*u+a[6]*l,a[9]*u+a[10]*l);var c=r[11],h=r[15],d=o.g.fromValues(a[2]*c,a[6]*c,a[10]*c,a[14]*c+a[15]*h),p=.7071067811/Math.sqrt(o.f.sqrLen(e)+o.f.sqrLen(t));return o.g.scale(d,d,p),d}}()}),"osg","AutoTransform"),t.a=c},function(e,t,i){"use strict";var r=i(128),a=function(e){this._initialBufferArray=void 0,this._bufferArray=void 0,e&&(this.setBufferArray(e),this.setInitialBufferArray(e))},n={setInitialBufferArray:function(e){this._initialBufferArray=e},getInitialBufferArray:function(){return this._initialBufferArray},setBufferArray:function(e){this._bufferArray=e.getBufferArray?e.getBufferArray():e},getBufferArray:function(){return this._bufferArray}};for(var o in r.a.prototype)n[o]=function(e){return function(){return e.apply(this._bufferArray,arguments)}}(r.a.prototype[o]);a.prototype=n,t.a=a},function(e,t,i){"use strict";var r=i(71),a=i(451),n=i(9),o=i(10),s=i(184),u=function(){this._clippingMask=0,this._planeList=[a.a.create(),a.a.create(),a.a.create(),a.a.create(),a.a.create(),a.a.create()],this._vertexList=[],this._maskStack=new s.a,this._resultMask=0,this._maskStack.push(this._resultMask)};n.a.createPrototypeObject(u,n.a.objectInherit(r.a.prototype,{getPlanes:function(){return this._planeList},setPlanes:function(e){this._planeList=e,this.setupMask()},clear:function(){if(this._clippingMask=0,this._planeList)for(var e=0,t=this._planeList.length;e<t;++e)a.a.init(this._planeList[e]);this._vertexList=[],this.setupMask()},setToUnitFrustum:function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),this._planeList.length=0,this._planeList.push(o.g.set(a.a.create(),1,0,0,1)),this._planeList.push(o.g.set(a.a.create(),-1,0,0,1)),this._planeList.push(o.g.set(a.a.create(),0,1,0,1)),this._planeList.push(o.g.set(a.a.create(),0,-1,0,1)),e&&this._planeList.push(o.g.set(a.a.create(),0,0,1,1)),t&&this._planeList.push(o.g.set(a.a.create(),0,0,-1,1)),this.setupMask()},setToBoundingBox:function(e){this._planeList.length=0,this._planeList.push(o.g.set(a.a.create(),1,0,0,-e.getMin()[0])),this._planeList.push(o.g.set(a.a.create(),-1,0,0,e.getMax()[0])),this._planeList.push(o.g.set(a.a.create(),0,1,0,-e.getMin()[1])),this._planeList.push(o.g.set(a.a.create(),0,-1,0,e.getMax()[1])),this._planeList.push(o.g.set(a.a.create(),0,0,1,-e.getMin()[2])),this._planeList.push(o.g.set(a.a.create(),0,0,-1,e.getMax()[2])),this.setupMask()},setAndTransformProvidingInverse:function(e,t){this._referenceVertexList=e._referenceVertexList;var i=this._maskStack.getLength()-1,r=e._maskStack[i];if(0===r)return this._maskStack.getArray()[i]=0,this._resultMask=0,void(this._planeList.length=0);var n,o=1,s=0;for(n=0;n!==e._planeList.length;++n)r&o&&++s,o<<=1;this._planeList.length=s,this._resultMask=0,o=1;var u=0;for(n=0;n!==e._planeList.length;++n)r&o&&(this._planeList[u]=e._planeList[n],a.a.transformProvidingInverse(this._planeList[u++],t),this._resultMask=this._resultMask<<1|1),o<<=1;this._maskStack.getArray()[i]=this._resultMask},voidset:function(e){this._planeList=e,this.setupMask()},add:function(e){this._planeList.push(e),this.setupMask()},empty:function(){return 0===this._planeList.length},setReferenceVertexList:function(e){this._referenceVertexList=e},getReferenceVertexList:function(){return this._referenceVertexList},setupMask:function(e){this._resultMask=0;for(var t=void 0!==e?e:this._planeList.length,i=0;i<t;++i)this._resultMask=this._resultMask<<1|1;this._maskStack.reset(),this._maskStack.push(this._resultMask)},getCurrentMask:function(){return this._maskStack.back()},setResultMask:function(e){this._resultMask=e},getResultMask:function(){return this._resultMask},getMaskStack:function(){return this._maskStack},pushCurrentMask:function(){this._maskStack.push(this._resultMask)},popCurrentMask:function(){return this._maskStack.pop()},containsVertex:function(e){var t=this._maskStack.back();if(!t)return!0;for(var i=1,r=0;r<this._planeList.length;++r){if(t&i&&a.a.distanceToPlane(this._planeList[r],e)<0)return!1;i<<=1}return!0},containsVertices:function(e){var t=this._maskStack.back();if(!t)return!0;this._resultMask=t;for(var i=0;i<e.length;++i){for(var r=e[i],n=!1,o=1,s=0;!n&&s<this._planeList.length;++s)t&o&&a.a.distanceToPlane(this._planeList[s],r)<0&&(n=!0),o<<=1;if(!n)return!0}return!1},containsBoundingSphere:function(e){var t=this._maskStack.back();if(!t||!e.valid())return!0;this._resultMask=t;for(var i=1,r=0;r<this._planeList.length;++r){if(this._resultMask&i){var n=a.a.intersectsOrContainsBoundingSphere(this._planeList[r],e);if(a.a.OUTSIDE===n)return!1;a.a.INSIDE===n&&(this._resultMask^=i)}i<<=1}return!0},containsBoundingBox:function(e){var t=this._maskStack.back();if(!t)return!0;this._resultMask=t;for(var i=1,r=0;r<this._planeList.length;++r){if(this._resultMask&i){var n=a.a.intersectsOrContainsBoundingBox(this._planeList[r],e);if(a.a.OUTSIDE===n)return!1;a.a.INSIDE===n&&(this._resultMask^=i)}i<<=1}return!0},containsAllOfVertices:function(e){var t=this._maskStack.back();if(!t)return!1;this._resultMask=t;for(var i=1,r=0;r<this._planeList.length;++r){if(this._resultMask&i){if(a.a.intersectsOrContainsVertices(this._planeList[r],e)<1)return!1;this._resultMask^=i}i<<=1}return!0},containsAllOfBoundingSphere:function(e){var t=this._maskStack.back();if(!t)return!1;this._resultMask=t;for(var i=1,r=0;r<this._planeList.length;++r){if(this._resultMask&i){if(a.a.intersectsOrContainsBoundingSphere(this._planeList[r],e)<1)return!1;this._resultMask^=i}i<<=1}return!0},containsAllOfBoundingBox:function(e){var t=this._maskStack.back();if(!t)return!1;this._resultMask=t;for(var i=1,r=0;r<this._planeList.length;++r){if(this._resultMask&i){if(a.a.intersectsOrContainsBoundingBox(this._planeList[r],e)<1)return!1;this._resultMask^=i}i<<=1}return!0},transformProvidingInverse:function(e){var t=this._maskStack.back();if(t){this._resultMask=t;for(var i=1,r=0;r<this._planeList.length;++r)t&i&&a.a.transformProvidingInverse(this._planeList[r],e),i<<=1}}}),"osg","Polytope"),t.a=u},function(e,t,i){"use strict";var r=i(9),a=i(98),n=i(10),o=function(){a.a.call(this),this.projection=n.c.create()};r.a.createPrototypeNode(o,r.a.objectInherit(a.a.prototype,{getProjectionMatrix:function(){return this.projection},setProjectionMatrix:function(e){this.projection=e}}),"osg","Projection"),t.a=o},function(e,t,i){"use strict";var r=i(9),a=i(98),n=i(127),o=i(10),s=function(){a.a.call(this),this.setCullingActive(!1),this._light=void 0,this._referenceFrame=n.a.RELATIVE_RF};r.a.createPrototypeNode(s,r.a.objectInherit(a.a.prototype,{getLight:function(){return this._light},setLight:function(e){this._light=e},setReferenceFrame:function(e){this._referenceFrame=e},getReferenceFrame:function(){return this._referenceFrame},computeBoundingSphere:function(){var e=o.f.create();return function(t){if(a.a.prototype.computeBoundingSphere.call(this,t),void 0!==this._light&&this._referenceFrame===n.a.RELATIVE_RF){var i=this._light.getPosition();0!==i[3]&&t.expandByVec3(o.f.scale(e,i,1/i[3]))}return t}}()}),"osg","LightSource"),t.a=s},function(e,t,i){"use strict";var r=i(9),a=i(98),n=i(54),o=i(10),s=i(448),u=function(){a.a.call(this),this._radius=-1,this._range=[],this._rangeMode=u.DISTANCE_FROM_EYE_POINT,this._userDefinedCenter=[],this._centerMode=u.USE_BOUNDING_SPHERE_CENTER};u.DISTANCE_FROM_EYE_POINT=0,u.PIXEL_SIZE_ON_SCREEN=1,u.USE_BOUNDING_SPHERE_CENTER=0,u.USER_DEFINED_CENTER=1,u.UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED=2,r.a.createPrototypeNode(u,r.a.objectInherit(a.a.prototype,{getRadius:function(){return this._radius},setRadius:function(e){this._radius=e},setCenter:function(e){this._centerMode!==u.UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED&&(this._centerMode=u.USER_DEFINED_CENTER),this._userDefinedCenter=e},getCenter:function(){return this._centerMode===u.USER_DEFINED_CENTER||this._centerMode===u.UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED?this._userDefinedCenter:this.getBound().center()},setCenterMode:function(e){this._centerMode=e},computeBoundingSphere:function(e){if(this._centerMode===u.USER_DEFINED_CENTER&&this._radius>=0)return e.set(this._userDefinedCenter,this._radius),e;if(this._centerMode===u.UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED&&this._radius>=0){e.set(this._userDefinedCenter,this._radius);var t=new s.a;return e.expandByBoundingSphere(a.a.prototype.computeBoundingSphere.call(this,t)),e}return a.a.prototype.computeBoundingSphere.call(this,e),e},projectBoundingSphere:function(){var e=o.f.create();return function(t,i,r){o.f.transformMat4(e,t.center(),i);var a=t.radius2(),n=e[2]*e[2],s=o.f.sqrLen(e);return-Math.PI*r*r*a*Math.sqrt(Math.abs((s-a)/(a-n)))/(a-n)}}(),setRangeMode:function(e){this._rangeMode=e},addChildNode:function(e){if(a.a.prototype.addChild.call(this,e),this.children.length>this._range.length){var t=[],i=0;this._range.lenght>0&&(i=this._range[this._range.length-1][1]),t.push(o.e.fromValues(i,i)),this._range.push(t)}return!0},addChild:function(e,t,i){if(a.a.prototype.addChild.call(this,e),this.children.length>this._range.length){var r=[];r.push(o.e.fromValues(t,t)),this._range.push(r)}return this._range[this.children.length-1][0]=t,this._range[this.children.length-1][1]=i,!0},traverse:function(){var e=o.f.create(),t=o.f.create(),i=o.c.create();return function(r){switch(r.traversalMode){case n.a.TRAVERSE_ALL_CHILDREN:for(var a=0;a<this.children.length;a++)this.children[a].accept(r);break;case n.a.TRAVERSE_ACTIVE_CHILDREN:var s=0,l=r.getCurrentModelViewMatrix();if(o.c.invert(i,l),this._rangeMode===u.DISTANCE_FROM_EYE_POINT)o.f.transformMat4(t,e,i),s=o.f.distance(this.getBound().center(),t)*r.getLODScale();else{var c=r.getCurrentProjectionMatrix();s=this.projectBoundingSphere(this.getBound(),l,c[0]),s=s*r.getViewport().width()*r.getViewport().width()*.25/r.getLODScale()}var h=this.children.length;this._range.length<h&&(h=this._range.length);for(var d=0;d<h;++d)this._range[d][0]<=s&&s<this._range[d][1]&&this.children[d].accept(r)}}}()}),"osg","Lod"),t.a=u},function(e,t,i){"use strict";var r=i(9),a=i(678),n=i(54),o=i(10),s=function(){a.a.call(this),this._perRangeDataList=[],this._loading=!1,this._expiryTime=0,this._expiryFrame=0,this._centerMode=a.a.USER_DEFINED_CENTER,this._frameNumberOfLastTraversal=0,this._databasePath="",this._numChildrenThatCannotBeExpired=0},u=function(){this.filename="",this.function=void 0,this.loaded=!1,this.timeStamp=0,this.frameNumber=0,this.frameNumberOfLastTraversal=0,this.dbrequest=void 0};r.a.createPrototypeNode(s,r.a.objectInherit(a.a.prototype,{setRange:function(e,t,i){if(e>=this._range.length){var r=[];r.push([t,t]),this._range.push(r)}this._range[e][0]=t,this._range[e][1]=i},setExpiryTime:function(e){this._expiryTime=e},setDatabasePath:function(e){this._databasePath=e},getDatabasePath:function(){return this._databasePath},setFileName:function(e,t){if(e>=this._perRangeDataList.length){var i=new u;i.filename=t,this._perRangeDataList.push(i)}else this._perRangeDataList[e].filename=t},setFunction:function(e,t){if(e>=this._perRangeDataList.length){var i=new u;i.function=t,this._perRangeDataList.push(i)}else this._perRangeDataList[e].function=t},addChild:function(e,t,i){a.a.prototype.addChild.call(this,e,t,i),this._perRangeDataList.push(new u)},addChildNode:function(e){a.a.prototype.addChildNode.call(this,e)},setFrameNumberOfLastTraversal:function(e){this._frameNumberOfLastTraversal=e},getFrameNumberOfLastTraversal:function(){return this._frameNumberOfLastTraversal},setTimeStamp:function(e,t){this._perRangeDataList[e].timeStamp=t},setFrameNumber:function(e,t){this._perRangeDataList[e].frameNumber=t},setNumChildrenThatCannotBeExpired:function(e){this._numChildrenThatCannotBeExpired=e},getNumChildrenThatCannotBeExpired:function(){return this._numChildrenThatCannotBeExpired},getDatabaseRequest:function(e){return this._perRangeDataList[e].dbrequest},removeExpiredChildren:function(e,t,i){if(!(this.children.length<=this._numChildrenThatCannotBeExpired)){var r,a,n=this.children.length-1;r=this._perRangeDataList[n].timeStamp+this._expiryTime,a=this._perRangeDataList[n].frameNumber+this._expiryFrame,r<e&&a<t&&(this._perRangeDataList[n].filename.length>0||void 0!==this._perRangeDataList[n].function)&&(i.push(this.children[n]),this.removeChild(this.children[n]),this._perRangeDataList[n].loaded=!1,void 0!==this._perRangeDataList[n].dbrequest&&(this._perRangeDataList[n].dbrequest._groupExpired=!0))}},traverse:function(){var e=o.f.create(),t=o.f.create(),i=o.c.create();return function(r){var s=r.traversalMode,u=!1;switch(r.getVisitorType()===n.a.CULL_VISITOR&&(this._frameNumberOfLastTraversal=r.getFrameStamp().getFrameNumber(),u=!0),s){case n.a.TRAVERSE_ALL_CHILDREN:for(var l=0;l<this.children.length;l++)this.children[l].accept(r);break;case n.a.TRAVERSE_ACTIVE_CHILDREN:var c=0,h=r.getCurrentModelViewMatrix();if(o.c.invert(i,h),this._rangeMode===a.a.DISTANCE_FROM_EYE_POINT){o.f.transformMat4(t,e,i);c=o.f.distance(this.getBound().center(),t)*r.getLODScale()}else{var d=r.getCurrentProjectionMatrix();c=this.projectBoundingSphere(this.getBound(),h,d[0]),c=c*r.getViewport().width()*r.getViewport().width()*.25/r.getLODScale(),c<0&&(c=this._range[this._range.length-1][0])}for(var p=!1,f=-1,m=0;m<this._range.length;++m)this._range[m][0]<=c&&c<this._range[m][1]&&(m<this.children.length?(u&&(this._perRangeDataList[m].timeStamp=r.getFrameStamp().getSimulationTime(),this._perRangeDataList[m].frameNumber=r.getFrameStamp().getFrameNumber()),this.children[m].accept(r),f=m):p=!0);if(p){var g=this.children.length;if(g>0&&g-1!==f&&(u&&(this._perRangeDataList[g-1].timeStamp=r.getFrameStamp().getSimulationTime(),this._perRangeDataList[g-1].frameNumber=r.getFrameStamp().getFrameNumber()),this.children[g-1].accept(r)),g<this._perRangeDataList.length){var _=(this._range[g][0]-c)/(this._range[g][1]-this._range[g][0]);this._rangeMode===a.a.PIXEL_SIZE_ON_SCREEN&&(_=-_);var v=r.nodePath[r.nodePath.length-1];if(!1===this._perRangeDataList[g].loaded){this._perRangeDataList[g].loaded=!0;var b=r.getDatabaseRequestHandler();this._perRangeDataList[g].dbrequest=b.requestNodeFile(this._perRangeDataList[g].function,this._databasePath+this._perRangeDataList[g].filename,v,r.getFrameStamp().getSimulationTime(),_)}else void 0!==this._perRangeDataList[g].dbrequest?(this._perRangeDataList[g].dbrequest._timeStamp=r.getFrameStamp().getSimulationTime(),this._perRangeDataList[g].dbrequest._priority=_):this._perRangeDataList[g].loaded=!1}}}}}()}),"osg","PagedLOD"),t.a=s},function(e,t,i){"use strict";var r=i(9),a=i(21),n=i(591),o=i(10),s=i(54),u=function(){n.a.call(this)};r.a.createPrototypeObject(u,r.a.objectInherit(n.a.prototype,{update:function(e,t){if(t.getVisitorType()===s.a.UPDATE_VISITOR){if(e.className&&"Bone"!==e.className())return a.a.warn("Warning: UpdateBone set on non-Bone object."),!1;var i=e;n.a.prototype.update.call(this,e),i.setMatrix(i.getMatrix());var r=i.getMatrix(),u=i.getBoneParent();u?o.c.mul(i.getMatrixInSkeletonSpace(),u.getMatrixInSkeletonSpace(),r):i.setMatrixInSkeletonSpace(r)}return!0}}),"osgAnimation","UpdateBone"),t.a=u},function(e,t,i){"use strict";var r=i(99),a=i(183),n=i(185),o=[],s=[];o[r.a.TRIANGLES]=function(e,t,i,r){for(var a=e+t,n=e;n<a;n+=3)r.operatorTriangle(i[n],i[n+1],i[n+2])},o[r.a.TRIANGLE_STRIP]=function(e,t,i,r){for(var a=2,n=e;a<t;++a,++n)a%2?r.operatorTriangle(i[n],i[n+2],i[n+1]):r.operatorTriangle(i[n],i[n+1],i[n+2])},o[r.a.TRIANGLE_FAN]=function(e,t,i,r){for(var a=i[e],n=2,o=e+1;n<t;++n,++o)r.operatorTriangle(a,i[o],i[o+1])},o[r.a.POINTS]=function(e,t,i,r){for(var a=e+t,n=e;n<a;++n)r.operatorPoint(i[n])},o[r.a.LINES]=function(e,t,i,r){for(var a=e+t,n=e;n<a;n+=2)r.operatorLine(i[n],i[n+1])},o[r.a.LINE_STRIP]=function(e,t,i,r){for(var a=e+t,n=e;n<a;++n)r.operatorLine(i[n],i[n+1])},o[r.a.LINE_LOOP]=function(e,t,i,r){for(var a=e+t,n=e;n<a;++n)r.operatorLine(i[n],i[n+1]);r.operatorLine(i[i.length-1],i[0])},s[r.a.TRIANGLES]=function(e,t,i){for(var r=2,a=e;r<t;r+=3,a+=3)i.operatorTriangle(a,a+1,a+2)},s[r.a.TRIANGLE_STRIP]=function(e,t,i){for(var r=2,a=e;r<t;++r,++a)r%2?i.operatorTriangle(a,a+2,a+1):i.operatorTriangle(a,a+1,a+2)},s[r.a.TRIANGLE_FAN]=function(e,t,i){for(var r=2,a=e+1;r<t;++r,++a)i.operatorTriangle(e,a,a+1)},s[r.a.POINTS]=function(e,t,i){for(var r=0,a=e;r<t;++r,++a)i.operatorPoint(a)},s[r.a.LINES]=function(e,t,i){for(var r=1,a=e;r<t;r+=2,a+=2)i.operatorLine(a,a+1)},s[r.a.LINE_STRIP]=function(e,t,i){for(var r=1,a=e;r<t;++r,++a)i.operatorLine(a,a+1)},s[r.a.LINE_LOOP]=function(e,t,i){for(var r=1,a=e;r<t;++r,++a)i.operatorLine(a,a+1);i.operatorLine(e+t-1,e)};var u=function(e,t){var i=e.getPrimitiveSetList();if(i)for(var r,u=i.length,l=0;l<u;l++){var c=i[l];if(c instanceof a.a){if(r=o[c.getMode()]){var h=c.indices.getElements();r(c.getFirst()/h.BYTES_PER_ELEMENT,c.getCount(),h,t)}}else c instanceof n.a&&(r=s[c.getMode()])&&r(c.getFirst(),c.getCount(),t)}};t.a=u},function(e,t,i){"use strict";var r=i(9),a=i(58),n=function(e,t,i,r){a.a.call(this),this._x=void 0!==e?e:-1,this._y=void 0!==t?t:-1,this._width=void 0!==i?i:-1,this._height=void 0!==r?r:-1};r.a.createPrototypeStateAttribute(n,r.a.objectInherit(a.a.prototype,{attributeType:"Scissor",cloneType:function(){return new n},setScissor:function(e,t,i,r){this._x=e,this._y=t,this._width=i,this._height=r},x:function(){return this._x},y:function(){return this._y},width:function(){return this._width},height:function(){return this._height},apply:function(e){e.applyScissor(this)}}),"osg","Scissor"),t.a=n},function(e,t,i){"use strict";var r=i(9),a=i(71),n=i(10),o=i(400),s=function(e,t){a.a.call(this),this._target=o.a.createVec3Target(t||n.f.ONE),e&&this.setName(e)};r.a.createPrototypeObject(s,r.a.objectInherit(a.a.prototype,{init:function(e){this.setScale(e),n.f.copy(this._target.defaultValue,e)},setScale:function(e){n.f.copy(this._target.value,e)},getTarget:function(){return this._target},resetToDefaultValue:function(){this.setScale(this._target.defaultValue)},applyToMatrix:function(e){var t=this._target.value;n.c.scale(e,e,t)}}),"osgAnimation","StackedScale"),t.a=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(7),a=i.n(r),n=i(9),o=i(771),s=i(595),u=i(1051),l=i(685),c=i.n(l),h=i(21),d=i(449),p=i(128),f=i(185),m=i(785),g=i(183),_=i(99),v=n.a.rejectObject,b=function(e,t){this._json=e;var i=t;void 0===i&&(i={}),this._identifierMap=i,this._objectRegistry={},this._cacheReadObject={},this.setOptions(n.a.objectMix({},u.a))};b.imageFallback||(b.imageFallback=function(){var e=new window.Image;return e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQIW2P8DwQACgAD/il4QJ8AAAAASUVORK5CYII=",e}()),b.prototype={clone:function(){var e=new b;return e._objectRegistry=this._objectRegistry,e._cacheReadObject=this._cacheReadObject,e},setOptions:function(e){this._defaultOptions=e},getOptions:function(){return this._defaultOptions},setProgressXHRCallback:function(e){this._defaultOptions.progressXHRCallback=e},setReadNodeURLCallback:function(e){this._defaultOptions.readNodeURL=e},registerObject:function(e,t){this._objectRegistry[e]=t},getJSON:function(){return this._json},setJSON:function(e){return this._json=e,this},setPrefixURL:function(e){this._defaultOptions.prefixURL=e},getPrefixURL:function(){return this._defaultOptions.prefixURL},setDatabasePath:function(e){this._defaultOptions.databasePath=e},getDatabasePath:function(){return this._defaultOptions.databasePath},computeURL:function(e){return"string"==typeof this._defaultOptions.prefixURL&&this._defaultOptions.prefixURL.length>0?this._defaultOptions.prefixURL+e:e},requestFile:function(e,t){return s.a.requestURI(e,t)},getObjectWrapper:function(e){if(this._objectRegistry[e])return new this._objectRegistry[e];for(var t=o.a,i=e.split("."),r=0,a=i.length;r<a;r++){var n=t[i[r]];if(void 0===n)return;t=n}return this._objectRegistry[e]=t,new t},fetchImage:function(e,t,i){var r="data:image/"===t.substring(0,"data:image/".length),n=new window.Image;return!r&&i.imageCrossOrigin&&(n.crossOrigin=i.imageCrossOrigin),e.setURL(t),e.setImage(n),n.src=t,new a.a(function(r){n.onerror=function(){h.a.warn("warning use white texture as fallback instead of "+t),e.setImage(b.imageFallback),r(e)},n.onload=function(){i.imageOnload&&i.imageOnload.call(e),r(e)}})},readImageURL:function(e,t){if(void 0===t&&(t=this._defaultOptions),t.readImageURL)return t.readImageURL.call(this,e,t);"data:image"!==e.substr(0,10)&&(e=this.computeURL(e));var i=new d.a;return this.fetchImage(i,e,t)},readNodeURL:function(e,t){var r=t;if(void 0===r&&(r=this._defaultOptions),r.readNodeURL)return r.readNodeURL.call(this,e,r);e=this.computeURL(e);var a=this;if(r=n.a.objectMix({},r),!r.prefixURL){var o=a.getPrefixURL(),s=e.lastIndexOf("/");-1!==s&&(o=e.substring(0,s+1)),r.prefixURL=o}var u=i(418).default,l=function(t){return u.parseSceneGraph(t,r).then(function(t){return h.a.log("loaded "+e),t})},d=function(e){function t(e){return e.length<2?"0"+e:e}var i=e;c.a.isGunzipBuffer(e)&&(i=c.a.gunzip(e));var r=new Uint8Array(i);return function(e){for(var i="",r=0,a=e.length;r<a;++r)i+="%"+t(e[r].toString(16));return i=decodeURIComponent(i)}(r)};return n.a.time("osgjs.metric:Input.readNodeURL",h.a.INFO),a.requestFile(e).then(function(t){var i;try{i=JSON.parse(t)}catch(t){h.a.error("cant parse url "+e+" try to gunzip")}return i?l(i):a.requestFile(e,{responseType:"arraybuffer"}).then(function(e){var t=d(e);return i=JSON.parse(t),l(i)}).catch(function(t){var i="cant read file "+e+" status "+t;return h.a.error(i),i})}).catch(function(t){var i="cant get file "+e+" status "+t;return h.a.error(i),i}).finally(function(){n.a.timeEnd("osgjs.metric:Input.readNodeURL")})},_unzipTypedArray:function(e){var t=new Uint8Array(e);if(31===t[0]&&139===t[1]){var r=i(685);r||h.a.error("osg failed to use a gunzip.min.js to uncompress a gz file.\n You can add this vendors to enable this feature or adds the good header in your gzip file served by your server");return new r.Gunzip(t).decompress().buffer}return e},readBinaryArrayURL:function(e,t){if(void 0===t&&(t=this._defaultOptions),t.readBinaryArrayURL)return t.readBinaryArrayURL.call(this,e,t);if(e=this.computeURL(e),void 0!==this._identifierMap[e])return this._identifierMap[e];var i=this.requestFile(e,{responseType:"arraybuffer",progress:this._defaultOptions.progressXHRCallback}),r=this;return this._identifierMap[e]=i.then(function(e){return r._unzipTypedArray(e)}),this._identifierMap[e]},initializeBufferArray:function(e,t,i,r){if(void 0===r&&(r=this.getOptions()),r.initializeBufferArray)return r.initializeBufferArray.call(this,e,t,i);var a=e.File;return this.readBinaryArrayURL(a).then(function(r){var a,o;!function(){var e=new Uint8Array([18,52]),t=new Uint16Array(e.buffer);o="1234"===t[0].toString(16)}();var s=0;void 0!==e.Offset&&(s=e.Offset);var u=n.a[t].BYTES_PER_ELEMENT,l=e.Size,c=i.getItemSize(),d=l*u*c;if(o){h.a.log("big endian detected");var p=n.a[t],f=new p(l*c),m=new DataView(r,s,d),g=0,_=f.length;if("Uint16Array"===t)for(;g<_;g++)f[g]=m.getUint16(g*u,!0);else if("Float32Array"===t)for(;g<_;g++)f[g]=m.getFloat32(g*u,!0);a=f,m=null}else a=new n.a[t](r,s,c*l);return i.setElements(a),i})},readBufferArray:function(e){var t,i=this.getJSON(),r=i.UniqueID;if(void 0!==r&&void 0!==(t=this._identifierMap[r]))return t;if(void 0===e&&(e=this.getOptions()),e.readBufferArray)return e.readBufferArray.call(this);if(!i.Elements&&!i.Array||!i.ItemSize||!i.Type)return v("BufferArray",i);var o;if(i.Elements)o=a.a.resolve(new p.a(p.a[i.Type],i.Elements,i.ItemSize));else if(i.Array){var s=new p.a(p.a[i.Type]);s.setItemSize(i.ItemSize);var u,l;if(i.Array.Float32Array?(u=i.Array.Float32Array,l="Float32Array"):i.Array.Uint16Array?(u=i.Array.Uint16Array,l="Uint16Array"):i.Array.Uint8Array&&(u=i.Array.Uint8Array,l="Uint8Array"),void 0===u)return v("Typed Array "+window.Object.keys(i.Array)[0]);u.File?o=this.initializeBufferArray(u,l,s):u.Elements&&(s.setElements(new n.a[l](u.Elements)),o=a.a.resolve(s))}return void 0!==r&&(this._identifierMap[r]=o),o},readUserDataContainer:function(){var e,t=this.getJSON(),i=t.UniqueID;return void 0!==i&&void 0!==(e=this._identifierMap[i])?e.Values:(this._identifierMap[i]=t,t.Values)},readPrimitiveSet:function(){var e,t,i,r,n,o,s,u=this.getJSON(),l=u.DrawElementUShort||u.DrawElementUByte||u.DrawElementUInt||u.DrawElementsUShort||u.DrawElementsUByte||u.DrawElementsUInt,c=u.DrawArray||u.DrawArrays,h=u.DrawArrayLengths;if(l){if(void 0!==(e=l.UniqueID)&&void 0!==(t=this._identifierMap[e]))return t;n=l.Mode?_.a[l.Mode]:_.a.TRIANGLES,r=new g.a(n),this.setJSON(l.Indices),i=this.readBufferArray().then(function(e){return r.setIndices(e),r}),this.setJSON(u)}else if(c){if(void 0!==(e=c.UniqueID)&&void 0!==(t=this._identifierMap[e]))return t;n=c.Mode||c.mode,o=void 0!==c.First?c.First:c.first,s=void 0!==c.Count?c.Count:c.count,r=new f.a(_.a[n],o,s),i=a.a.resolve(r)}else if(h){if(void 0!==(e=h.UniqueID)&&void 0!==(t=this._identifierMap[e]))return t;n=h.Mode,o=h.First;var d=h.ArrayLengths;r=new m.a(_.a[n],o,d),i=a.a.resolve(r)}else i=v("PrimitiveSet",u);return void 0!==e&&(this._identifierMap[e]=i),i},readObject:function(){var e=this.getJSON(),t=window.Object.keys(e),r=t[0];if(!r)return v("can't find property for object "+t);var a,n=e[r].UniqueID;if(void 0!==n&&void 0!==(a=this._identifierMap[n]))return a;var o=this.getObjectWrapper(r);if(!o)return v("can't instanciate object "+r);var s=i(418).default,u=s.ObjectWrapper.serializers;if(this._cacheReadObject[r])u=this._cacheReadObject[r];else{for(var l=r.split("."),c=0,h=l.length;c<h;c++){var d=l[c],p=u[d];if(!p)return v("Unknown scope "+r+"("+d+")");u=p}this._cacheReadObject[r]=u}var f=u(this.setJSON(e[r]),o);return void 0!==n&&(this._identifierMap[n]=f,o._uniqueID=n),f}},t.default=b},function(e,t){},function(e,t,i){var r;/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
!function(a,n,o,s){"use strict";function u(e,t,i){return setTimeout(p(e,i),t)}function l(e,t,i){return!!Array.isArray(e)&&(c(e,i[t],i),!0)}function c(e,t,i){var r;if(e)if(e.forEach)e.forEach(t,i);else if(e.length!==s)for(r=0;r<e.length;)t.call(i,e[r],r,e),r++;else for(r in e)e.hasOwnProperty(r)&&t.call(i,e[r],r,e)}function h(e,t,i){var r="DEPRECATED METHOD: "+t+"\n"+i+" AT \n";return function(){var t=new Error("get-stack-trace"),i=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",n=a.console&&(a.console.warn||a.console.log);return n&&n.call(a.console,r,i),e.apply(this,arguments)}}function d(e,t,i){var r,a=t.prototype;r=e.prototype=Object.create(a),r.constructor=e,r._super=a,i&&fe(r,i)}function p(e,t){return function(){return e.apply(t,arguments)}}function f(e,t){return typeof e==_e?e.apply(t?t[0]||s:s,t):e}function m(e,t){return e===s?t:e}function g(e,t,i){c(y(t),function(t){e.addEventListener(t,i,!1)})}function _(e,t,i){c(y(t),function(t){e.removeEventListener(t,i,!1)})}function v(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function b(e,t){return e.indexOf(t)>-1}function y(e){return e.trim().split(/\s+/g)}function x(e,t,i){if(e.indexOf&&!i)return e.indexOf(t);for(var r=0;r<e.length;){if(i&&e[r][i]==t||!i&&e[r]===t)return r;r++}return-1}function S(e){return Array.prototype.slice.call(e,0)}function M(e,t,i){for(var r=[],a=[],n=0;n<e.length;){var o=t?e[n][t]:e[n];x(a,o)<0&&r.push(e[n]),a[n]=o,n++}return i&&(r=t?r.sort(function(e,i){return e[t]>i[t]}):r.sort()),r}function w(e,t){for(var i,r,a=t[0].toUpperCase()+t.slice(1),n=0;n<me.length;){if(i=me[n],(r=i?i+a:t)in e)return r;n++}return s}function T(){return Me++}function C(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||a}function E(e,t){var i=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){f(e.options.enable,[e])&&i.handler(t)},this.init()}function L(e){var t=e.options.inputClass;return new(t||(Ce?G:Ee?z:Te?q:j))(e,P)}function P(e,t,i){var r=i.pointers.length,a=i.changedPointers.length,n=t&Pe&&r-a==0,o=t&(De|Oe)&&r-a==0;i.isFirst=!!n,i.isFinal=!!o,n&&(e.session={}),i.eventType=t,A(e,i),e.emit("hammer.input",i),e.recognize(i),e.session.prevInput=i}function A(e,t){var i=e.session,r=t.pointers,a=r.length;i.firstInput||(i.firstInput=k(t)),a>1&&!i.firstMultiple?i.firstMultiple=k(t):1===a&&(i.firstMultiple=!1);var n=i.firstInput,o=i.firstMultiple,s=o?o.center:n.center,u=t.center=R(r);t.timeStamp=ye(),t.deltaTime=t.timeStamp-n.timeStamp,t.angle=V(s,u),t.distance=N(s,u),D(i,t),t.offsetDirection=F(t.deltaX,t.deltaY);var l=I(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=l.x,t.overallVelocityY=l.y,t.overallVelocity=be(l.x)>be(l.y)?l.x:l.y,t.scale=o?U(o.pointers,r):1,t.rotation=o?B(o.pointers,r):0,t.maxPointers=i.prevInput?t.pointers.length>i.prevInput.maxPointers?t.pointers.length:i.prevInput.maxPointers:t.pointers.length,O(i,t);var c=e.element;v(t.srcEvent.target,c)&&(c=t.srcEvent.target),t.target=c}function D(e,t){var i=t.center,r=e.offsetDelta||{},a=e.prevDelta||{},n=e.prevInput||{};t.eventType!==Pe&&n.eventType!==De||(a=e.prevDelta={x:n.deltaX||0,y:n.deltaY||0},r=e.offsetDelta={x:i.x,y:i.y}),t.deltaX=a.x+(i.x-r.x),t.deltaY=a.y+(i.y-r.y)}function O(e,t){var i,r,a,n,o=e.lastInterval||t,u=t.timeStamp-o.timeStamp;if(t.eventType!=Oe&&(u>Le||o.velocity===s)){var l=t.deltaX-o.deltaX,c=t.deltaY-o.deltaY,h=I(u,l,c);r=h.x,a=h.y,i=be(h.x)>be(h.y)?h.x:h.y,n=F(l,c),e.lastInterval=t}else i=o.velocity,r=o.velocityX,a=o.velocityY,n=o.direction;t.velocity=i,t.velocityX=r,t.velocityY=a,t.direction=n}function k(e){for(var t=[],i=0;i<e.pointers.length;)t[i]={clientX:ve(e.pointers[i].clientX),clientY:ve(e.pointers[i].clientY)},i++;return{timeStamp:ye(),pointers:t,center:R(t),deltaX:e.deltaX,deltaY:e.deltaY}}function R(e){var t=e.length;if(1===t)return{x:ve(e[0].clientX),y:ve(e[0].clientY)};for(var i=0,r=0,a=0;a<t;)i+=e[a].clientX,r+=e[a].clientY,a++;return{x:ve(i/t),y:ve(r/t)}}function I(e,t,i){return{x:t/e||0,y:i/e||0}}function F(e,t){return e===t?ke:be(e)>=be(t)?e<0?Re:Ie:t<0?Fe:Ne}function N(e,t,i){i||(i=je);var r=t[i[0]]-e[i[0]],a=t[i[1]]-e[i[1]];return Math.sqrt(r*r+a*a)}function V(e,t,i){i||(i=je);var r=t[i[0]]-e[i[0]],a=t[i[1]]-e[i[1]];return 180*Math.atan2(a,r)/Math.PI}function B(e,t){return V(t[1],t[0],Ge)+V(e[1],e[0],Ge)}function U(e,t){return N(t[0],t[1],Ge)/N(e[0],e[1],Ge)}function j(){this.evEl=He,this.evWin=ze,this.pressed=!1,E.apply(this,arguments)}function G(){this.evEl=Xe,this.evWin=Je,E.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function Y(){this.evTarget=$e,this.evWin=Qe,this.started=!1,E.apply(this,arguments)}function H(e,t){var i=S(e.touches),r=S(e.changedTouches);return t&(De|Oe)&&(i=M(i.concat(r),"identifier",!0)),[i,r]}function z(){this.evTarget=et,this.targetIds={},E.apply(this,arguments)}function W(e,t){var i=S(e.touches),r=this.targetIds;if(t&(Pe|Ae)&&1===i.length)return r[i[0].identifier]=!0,[i,i];var a,n,o=S(e.changedTouches),s=[],u=this.target;if(n=i.filter(function(e){return v(e.target,u)}),t===Pe)for(a=0;a<n.length;)r[n[a].identifier]=!0,a++;for(a=0;a<o.length;)r[o[a].identifier]&&s.push(o[a]),t&(De|Oe)&&delete r[o[a].identifier],a++;return s.length?[M(n.concat(s),"identifier",!0),s]:void 0}function q(){E.apply(this,arguments);var e=p(this.handler,this);this.touch=new z(this.manager,e),this.mouse=new j(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function X(e,t){e&Pe?(this.primaryTouch=t.changedPointers[0].identifier,J.call(this,t)):e&(De|Oe)&&J.call(this,t)}function J(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var i={x:t.clientX,y:t.clientY};this.lastTouches.push(i);var r=this.lastTouches,a=function(){var e=r.indexOf(i);e>-1&&r.splice(e,1)};setTimeout(a,tt)}}function K(e){for(var t=e.srcEvent.clientX,i=e.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var a=this.lastTouches[r],n=Math.abs(t-a.x),o=Math.abs(i-a.y);if(n<=it&&o<=it)return!0}return!1}function $(e,t){this.manager=e,this.set(t)}function Q(e){if(b(e,st))return st;var t=b(e,ut),i=b(e,lt);return t&&i?st:t||i?t?ut:lt:b(e,ot)?ot:nt}function Z(e){this.options=fe({},this.defaults,e||{}),this.id=T(),this.manager=null,this.options.enable=m(this.options.enable,!0),this.state=ht,this.simultaneous={},this.requireFail=[]}function ee(e){return e&gt?"cancel":e&ft?"end":e&pt?"move":e&dt?"start":""}function te(e){return e==Ne?"down":e==Fe?"up":e==Re?"left":e==Ie?"right":""}function ie(e,t){var i=t.manager;return i?i.get(e):e}function re(){Z.apply(this,arguments)}function ae(){re.apply(this,arguments),this.pX=null,this.pY=null}function ne(){re.apply(this,arguments)}function oe(){Z.apply(this,arguments),this._timer=null,this._input=null}function se(){re.apply(this,arguments)}function ue(){re.apply(this,arguments)}function le(){Z.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ce(e,t){return t=t||{},t.recognizers=m(t.recognizers,ce.defaults.preset),new he(e,t)}function he(e,t){this.options=fe({},ce.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=L(this),this.touchAction=new $(this,this.options.touchAction),de(this,!0),c(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function de(e,t){var i=e.element;if(i.style){var r;c(e.options.cssProps,function(a,n){r=w(i.style,n),t?(e.oldCssProps[r]=i.style[r],i.style[r]=a):i.style[r]=e.oldCssProps[r]||""}),t||(e.oldCssProps={})}}function pe(e,t){var i=n.createEvent("Event");i.initEvent(e,!0,!0),i.gesture=t,t.target.dispatchEvent(i)}var fe,me=["","webkit","Moz","MS","ms","o"],ge=n.createElement("div"),_e="function",ve=Math.round,be=Math.abs,ye=Date.now;fe="function"!=typeof Object.assign?function(e){if(e===s||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var r=arguments[i];if(r!==s&&null!==r)for(var a in r)r.hasOwnProperty(a)&&(t[a]=r[a])}return t}:Object.assign;var xe=h(function(e,t,i){for(var r=Object.keys(t),a=0;a<r.length;)(!i||i&&e[r[a]]===s)&&(e[r[a]]=t[r[a]]),a++;return e},"extend","Use `assign`."),Se=h(function(e,t){return xe(e,t,!0)},"merge","Use `assign`."),Me=1,we=/mobile|tablet|ip(ad|hone|od)|android/i,Te="ontouchstart"in a,Ce=w(a,"PointerEvent")!==s,Ee=Te&&we.test(navigator.userAgent),Le=25,Pe=1,Ae=2,De=4,Oe=8,ke=1,Re=2,Ie=4,Fe=8,Ne=16,Ve=Re|Ie,Be=Fe|Ne,Ue=Ve|Be,je=["x","y"],Ge=["clientX","clientY"];E.prototype={handler:function(){},init:function(){this.evEl&&g(this.element,this.evEl,this.domHandler),this.evTarget&&g(this.target,this.evTarget,this.domHandler),this.evWin&&g(C(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&_(this.element,this.evEl,this.domHandler),this.evTarget&&_(this.target,this.evTarget,this.domHandler),this.evWin&&_(C(this.element),this.evWin,this.domHandler)}};var Ye={mousedown:Pe,mousemove:Ae,mouseup:De},He="mousedown",ze="mousemove mouseup";d(j,E,{handler:function(e){var t=Ye[e.type];t&Pe&&0===e.button&&(this.pressed=!0),t&Ae&&1!==e.which&&(t=De),this.pressed&&(t&De&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}});var We={pointerdown:Pe,pointermove:Ae,pointerup:De,pointercancel:Oe,pointerout:Oe},qe={2:"touch",3:"pen",4:"mouse",5:"kinect"},Xe="pointerdown",Je="pointermove pointerup pointercancel";a.MSPointerEvent&&!a.PointerEvent&&(Xe="MSPointerDown",Je="MSPointerMove MSPointerUp MSPointerCancel"),d(G,E,{handler:function(e){var t=this.store,i=!1,r=e.type.toLowerCase().replace("ms",""),a=We[r],n=qe[e.pointerType]||e.pointerType,o="touch"==n,s=x(t,e.pointerId,"pointerId");a&Pe&&(0===e.button||o)?s<0&&(t.push(e),s=t.length-1):a&(De|Oe)&&(i=!0),s<0||(t[s]=e,this.callback(this.manager,a,{pointers:t,changedPointers:[e],pointerType:n,srcEvent:e}),i&&t.splice(s,1))}});var Ke={touchstart:Pe,touchmove:Ae,touchend:De,touchcancel:Oe},$e="touchstart",Qe="touchstart touchmove touchend touchcancel";d(Y,E,{handler:function(e){var t=Ke[e.type];if(t===Pe&&(this.started=!0),this.started){var i=H.call(this,e,t);t&(De|Oe)&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:e})}}});var Ze={touchstart:Pe,touchmove:Ae,touchend:De,touchcancel:Oe},et="touchstart touchmove touchend touchcancel";d(z,E,{handler:function(e){var t=Ze[e.type],i=W.call(this,e,t);i&&this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:e})}});var tt=2500,it=25;d(q,E,{handler:function(e,t,i){var r="touch"==i.pointerType,a="mouse"==i.pointerType;if(!(a&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(r)X.call(this,t,i);else if(a&&K.call(this,i))return;this.callback(e,t,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var rt=w(ge.style,"touchAction"),at=rt!==s,nt="auto",ot="manipulation",st="none",ut="pan-x",lt="pan-y",ct=function(){if(!at)return!1;var e={},t=a.CSS&&a.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(i){e[i]=!t||a.CSS.supports("touch-action",i)}),e}();$.prototype={set:function(e){"compute"==e&&(e=this.compute()),at&&this.manager.element.style&&ct[e]&&(this.manager.element.style[rt]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return c(this.manager.recognizers,function(t){f(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),Q(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,i=e.offsetDirection;if(this.manager.session.prevented)return void t.preventDefault();var r=this.actions,a=b(r,st)&&!ct[st],n=b(r,lt)&&!ct[lt],o=b(r,ut)&&!ct[ut];if(a){var s=1===e.pointers.length,u=e.distance<2,l=e.deltaTime<250;if(s&&u&&l)return}return o&&n?void 0:a||n&&i&Ve||o&&i&Be?this.preventSrc(t):void 0},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var ht=1,dt=2,pt=4,ft=8,mt=ft,gt=16;Z.prototype={defaults:{},set:function(e){return fe(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(l(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=ie(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return l(e,"dropRecognizeWith",this)?this:(e=ie(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(l(e,"requireFailure",this))return this;var t=this.requireFail;return e=ie(e,this),-1===x(t,e)&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(l(e,"dropRequireFailure",this))return this;e=ie(e,this);var t=x(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){function t(t){i.manager.emit(t,e)}var i=this,r=this.state;r<ft&&t(i.options.event+ee(r)),t(i.options.event),e.additionalEvent&&t(e.additionalEvent),r>=ft&&t(i.options.event+ee(r))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(32|ht)))return!1;e++}return!0},recognize:function(e){var t=fe({},e);if(!f(this.options.enable,[this,t]))return this.reset(),void(this.state=32);this.state&(mt|gt|32)&&(this.state=ht),this.state=this.process(t),this.state&(dt|pt|ft|gt)&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},d(re,Z,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,i=e.eventType,r=t&(dt|pt),a=this.attrTest(e);return r&&(i&Oe||!a)?t|gt:r||a?i&De?t|ft:t&dt?t|pt:dt:32}}),d(ae,re,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ue},getTouchAction:function(){var e=this.options.direction,t=[];return e&Ve&&t.push(lt),e&Be&&t.push(ut),t},directionTest:function(e){var t=this.options,i=!0,r=e.distance,a=e.direction,n=e.deltaX,o=e.deltaY;return a&t.direction||(t.direction&Ve?(a=0===n?ke:n<0?Re:Ie,i=n!=this.pX,r=Math.abs(e.deltaX)):(a=0===o?ke:o<0?Fe:Ne,i=o!=this.pY,r=Math.abs(e.deltaY))),e.direction=a,i&&r>t.threshold&&a&t.direction},attrTest:function(e){return re.prototype.attrTest.call(this,e)&&(this.state&dt||!(this.state&dt)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=te(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),d(ne,re,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[st]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&dt)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),d(oe,Z,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[nt]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,r=e.distance<t.threshold,a=e.deltaTime>t.time;if(this._input=e,!r||!i||e.eventType&(De|Oe)&&!a)this.reset();else if(e.eventType&Pe)this.reset(),this._timer=u(function(){this.state=mt,this.tryEmit()},t.time,this);else if(e.eventType&De)return mt;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===mt&&(e&&e.eventType&De?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=ye(),this.manager.emit(this.options.event,this._input)))}}),d(se,re,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[st]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&dt)}}),d(ue,re,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ve|Be,pointers:1},getTouchAction:function(){return ae.prototype.getTouchAction.call(this)},attrTest:function(e){var t,i=this.options.direction;return i&(Ve|Be)?t=e.overallVelocity:i&Ve?t=e.overallVelocityX:i&Be&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&i&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&be(t)>this.options.velocity&&e.eventType&De},emit:function(e){var t=te(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),d(le,Z,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ot]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,r=e.distance<t.threshold,a=e.deltaTime<t.time;if(this.reset(),e.eventType&Pe&&0===this.count)return this.failTimeout();if(r&&a&&i){if(e.eventType!=De)return this.failTimeout();var n=!this.pTime||e.timeStamp-this.pTime<t.interval,o=!this.pCenter||N(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,o&&n?this.count+=1:this.count=1,this._input=e;if(0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=u(function(){this.state=mt,this.tryEmit()},t.interval,this),dt):mt}return 32},failTimeout:function(){return this._timer=u(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==mt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ce.VERSION="2.0.7",ce.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[se,{enable:!1}],[ne,{enable:!1},["rotate"]],[ue,{direction:Ve}],[ae,{direction:Ve},["swipe"]],[le],[le,{event:"doubletap",taps:2},["tap"]],[oe]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};he.prototype={set:function(e){return fe(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){this.touchAction.preventDefaults(e);var i,r=this.recognizers,a=t.curRecognizer;(!a||a&&a.state&mt)&&(a=t.curRecognizer=null);for(var n=0;n<r.length;)i=r[n],2===t.stopped||a&&i!=a&&!i.canRecognizeWith(a)?i.reset():i.recognize(e),!a&&i.state&(dt|pt|ft)&&(a=t.curRecognizer=i),n++}},get:function(e){if(e instanceof Z)return e;for(var t=this.recognizers,i=0;i<t.length;i++)if(t[i].options.event==e)return t[i];return null},add:function(e){if(l(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(l(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,i=x(t,e);-1!==i&&(t.splice(i,1),this.touchAction.update())}return this},on:function(e,t){if(e!==s&&t!==s){var i=this.handlers;return c(y(e),function(e){i[e]=i[e]||[],i[e].push(t)}),this}},off:function(e,t){if(e!==s){var i=this.handlers;return c(y(e),function(e){t?i[e]&&i[e].splice(x(i[e],t),1):delete i[e]}),this}},emit:function(e,t){this.options.domEvents&&pe(e,t);var i=this.handlers[e]&&this.handlers[e].slice();if(i&&i.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var r=0;r<i.length;)i[r](t),r++}},destroy:function(){this.element&&de(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},fe(ce,{INPUT_START:Pe,INPUT_MOVE:Ae,INPUT_END:De,INPUT_CANCEL:Oe,STATE_POSSIBLE:ht,STATE_BEGAN:dt,STATE_CHANGED:pt,STATE_ENDED:ft,STATE_RECOGNIZED:mt,STATE_CANCELLED:gt,STATE_FAILED:32,DIRECTION_NONE:ke,DIRECTION_LEFT:Re,DIRECTION_RIGHT:Ie,DIRECTION_UP:Fe,DIRECTION_DOWN:Ne,DIRECTION_HORIZONTAL:Ve,DIRECTION_VERTICAL:Be,DIRECTION_ALL:Ue,Manager:he,Input:E,TouchAction:$,TouchInput:z,MouseInput:j,PointerEventInput:G,TouchMouseInput:q,SingleTouchInput:Y,Recognizer:Z,AttrRecognizer:re,Tap:le,Pan:ae,Swipe:ue,Pinch:ne,Rotate:se,Press:oe,on:g,off:_,each:c,merge:Se,extend:xe,assign:fe,inherit:d,bindFn:p,prefixed:w}),(void 0!==a?a:"undefined"!=typeof self?self:{}).Hammer=ce,(r=function(){return ce}.call(t,i,t,e))!==s&&(e.exports=r)}(window,document)},function(e,t,i){"use strict";var r=i(250),a=i(9),n=i(447),o=i(811),s=i(78),u=function(e){r.a.call(this,e),this._zoomFactor=1,this.init()};a.a.createPrototypeObject(u,a.a.objectInherit(r.a.prototype,{init:function(){this._mode=void 0,this._inMotion=!1,this._initInputs(s.a.ORBIT_MANIPULATOR_MOUSEKEYBOARD,s.a.ORBIT_MANIPULATOR_RESETTOHOME)},_initInputs:function(e,t){var i=this._manipulator.getInputManager(),r=this.setMode.bind(this,o.a.ROTATE,this._manipulator.getRotateInterpolator()),a=this.setMode.bind(this,o.a.PAN,this._manipulator.getPanInterpolator()),n=this.setMode.bind(this,o.a.ZOOM,this._manipulator.getZoomInterpolator());i.group(e).addMappings({move:"mousemove",startPan:["mousedown shift 0","mousedown 1","mousedown 2"],startZoom:["mousedown ctrl 0","mousedown ctrl 2"],startRotate:"mousedown 0 !shift !ctrl",stopMotion:["mouseup","mouseout","keyup a","keyup s","keyup d"],zoom:"wheel"},this),i.group(t).addMappings({reset:"keydown space"},this),i.group(e).addMappings({setRotationMode:"keydown a"},r),i.group(e).addMappings({setPanMode:"keydown d"},a),i.group(e).addMappings({setZoomMode:"keydown s"},n)},getMode:function(){return this._mode},setMode:function(e,t){this.getMode()!==e&&(this._mode=e,t.reset(),this._inMotion=!0)},setManipulator:function(e){this._manipulator=e},getZoomFactor:function(){return this._zoomFactor},setZoomFactor:function(e){this._zoomFactor=e},move:function(e){if(!1!==this._inMotion){var t=e.canvasX,i=-e.canvasY,r=this._manipulator;if(!1===n.a.isNaN(t)&&!1===n.a.isNaN(i)){var a=this.getMode();if(a===o.a.ROTATE)r.getRotateInterpolator().setTarget(t,i);else if(a===o.a.PAN)r.getPanInterpolator().setTarget(t,i);else if(a===o.a.ZOOM){var s=r.getZoomInterpolator();s.isReset()&&(s.setStart(i),s.set(0));var u=i-s.getStart();s.setStart(i);var l=s.getTarget()[0];s.setTarget(l-u/20)}}}},startPan:function(e){var t=this._manipulator.getPanInterpolator();this.setMode(o.a.PAN,t),t.reset(),t.set(e.canvasX,-e.canvasY)},startRotate:function(e){var t=this._manipulator.getRotateInterpolator();this.setMode(o.a.ROTATE,t),t.reset(),t.set(e.canvasX,-e.canvasY)},startZoom:function(e){var t=this._manipulator.getZoomInterpolator();this.setMode(o.a.ZOOM,t),t.setStart(-e.canvasY),t.set(0)},stopMotion:function(){this._inMotion=!1,this._mode=void 0},zoom:function(e){var t=e.deltaY/this._zoomFactor,i=this._manipulator,r=i.getZoomInterpolator().getTarget()[0]-t;i.getZoomInterpolator().setTarget(r)},reset:function(){this._manipulator.computeHomePosition()}})),t.a=u},function(e,t,i){"use strict";var r=i(250),a=i(9),n=i(10),o=i(78),s=Math.PI/180,u=function(e,t,i,r,a){var n=Math.cos(t/2),o=Math.cos(i/2),s=Math.cos(r/2),u=Math.sin(t/2),l=Math.sin(i/2),c=Math.sin(r/2);return"XYZ"===a?(e[0]=u*o*s+n*l*c,e[1]=n*l*s-u*o*c,e[2]=n*o*c+u*l*s,e[3]=n*o*s-u*l*c):"YXZ"===a?(e[0]=u*o*s+n*l*c,e[1]=n*l*s-u*o*c,e[2]=n*o*c-u*l*s,e[3]=n*o*s+u*l*c):"ZXY"===a?(e[0]=u*o*s-n*l*c,e[1]=n*l*s+u*o*c,e[2]=n*o*c+u*l*s,e[3]=n*o*s-u*l*c):"ZYX"===a?(e[0]=u*o*s-n*l*c,e[1]=n*l*s+u*o*c,e[2]=n*o*c-u*l*s,e[3]=n*o*s+u*l*c):"YZX"===a?(e[0]=u*o*s+n*l*c,e[1]=n*l*s+u*o*c,e[2]=n*o*c-u*l*s,e[3]=n*o*s-u*l*c):"XZY"===a&&(e[0]=u*o*s-n*l*c,e[1]=n*l*s-u*o*c,e[2]=n*o*c+u*l*s,e[3]=n*o*s+u*l*c),e},l=function(e){r.a.call(this,e),this.init()};l.computeQuaternion=function(){var e=n.d.create(),t=n.d.fromValues(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(i,r,a){var o=r.alpha*s,l=r.beta*s,c=r.gamma*s,h=a*s;u(i,l,o,-c,"YXZ");var d=-h/2;e[1]=Math.sin(d),e[3]=Math.cos(d),n.d.mul(i,i,e),n.d.mul(i,i,t);var p=i[1];return i[1]=-i[2],i[2]=p,i}}(),a.a.createPrototypeObject(l,a.a.objectInherit(r.a.prototype,{init:function(){this._quat=n.d.create(),this._pos=n.f.create(),this._deviceOrientation=void 0,this._screenOrientation=void 0;var e=this._manipulator.getInputManager();e.group(o.a.FPS_MANIPULATOR_DEVICEORIENTATION).addMappings({setDeviceOrientation:"deviceorientation",setScreenOrientation:"orientationchange"},this),e.setEnable(o.a.FPS_MANIPULATOR_DEVICEORIENTATION,!1)},setDeviceOrientation:function(e){if(this._deviceOrientation||(this._deviceOrientation={}),this._deviceOrientation.alpha=e.alpha,this._deviceOrientation.beta=e.beta,this._deviceOrientation.gamma=e.gamma,e.screenOrientation)return void this.setScreenOrientation(e);this._update()},setScreenOrientation:function(e){this._screenOrientation=e.screenOrientation,this._update()},_update:function(){this._deviceOrientation&&this._screenOrientation&&(l.computeQuaternion(this._quat,this._deviceOrientation,this._screenOrientation),this._manipulator.setPoseVR(this._quat,this._pos))}})),t.a=l},function(e,t,i){"use strict";var r=i(9),a=i(21),n=i(603),o=function(e,t){if(!e||!t)return"";var i;for(var r in t)void 0!==(i=t[r])&&(i.getVariable&&(i=i.getVariable()),e=e.replace("%s",i));return e},s=function(e,t){var i=e,r=[],a=t;void 0===t&&(a="");for(var n=0,o=i.length;n<o;n++){var s,u=i[n];s=void 0===u?"undefined":"string"==typeof u?u:u.getType?u.getType()+" "+u.getVariable():u.getVariable(),r.push(a+s)}return r},u=function(e,t,r){var a=i(690).default,n=[],o="";if(a.debugShaderNode&&(n.push("\n// output"),Array.prototype.push.apply(n,s([t],"// "))),t&&(o=(t.getVariable?t.getVariable():t)+" = "),o=o+e+"( ",r&&r.length>0){a.debugShaderNode&&(n.push("// inputs"),Array.prototype.push.apply(n,s(r,"// ")));for(var u=0,l=r.length;u<l;u++)o+=r[u].getVariable?r[u].getVariable():r[u],u!==l-1&&(o+=", ")}return o+=" );\n",a.debugShaderNode?n.join("\n")+"\n"+o:o},l=function(e){var t=e.match(/([^\s]+):([^\s]+)/g),i={};if(!t)return i;for(var r=0;r<t.length;++r){var a=t[r].split(":");i[a[0]]=a[1]}return i},c=function(e,t){var i=t.indexOf("("),r=t.indexOf(")"),a=t.substring(0,i);a=a.replace(/[\r\n|\r|\n]/g,"").trim().replace(/\s+/g," ");var n=a.split(/\s/),o=n[0],s=n[1],u=l(e),c=u.result||"result",h=u.NODE_NAME;h||(h=s[0].toUpperCase()+s.substring(1));var d=[];u.DERIVATIVES&&d.push("#extension GL_OES_standard_derivatives : "+u.DERIVATIVES);var p,f=[],m="#define"===o;"void"!==o&&(p={name:c,type:!m&&o},f.push(p));var g=t.substring(i+1,r);g=g.replace(/[\r\n|\r|\n]/g,"");for(var _=g.split(/OPT_ARG_|,/),v=-1!==g.indexOf("OPT_ARG_"),b=[],y=[],x=0;x<_.length;++x){var S=_[x];if(S){var M=S.trim().replace(/\s+/g," ").split("[")[0],w=M.split(/\s/),T=w.length,C=T>=3&&-1!==w[T-3].indexOf("out"),E=w[T-1],L={isOutput:C,type:w[T-2],name:u[E]||E,optional:v&&-1!==g.indexOf("OPT_ARG_"+E)};y.push(L),L.optional||(C?f.push(L):b.push(L))}}return{nodeName:h,functionName:s,signature:{returnVariable:p,orderedArgs:y,outputs:f,inputs:b,extensions:d}}},h=function(e,t){var i=function(){n.a.call(this),this._defines=[],this._extensions=[],this._missingArgs=!1};return r.a.createPrototypeObject(i,r.a.objectInherit(n.a.prototype,{type:e.nodeName,signatures:[e.signature],globalDeclare:'#pragma include "'+t+'"',checkInputsOutputs:function(){},globalFunctionDeclaration:function(){return this.globalDeclare},addExtensions:function(e){return this._extensions.push.apply(this._extensions,e),this},getExtensions:function(){return this.getOrCreateSignature(),this._extensions},addDefines:function(e){return this._defines.push.apply(this._defines,e),this},getDefines:function(){return this._defines},_validateSameVariables:function(e,t){for(var i=e.length,r=0;r<i;++r)if(!t[e[r].name])return!1;return e.length===Object.keys(t).length},_validateSameType:function(e,t){for(var i=e.length,r=0;r<i;++r){if(t[e[r].name].getType()!==e[r].type)return!1}return!0},_getSignatureBestMatch:function(){if(1===this.signatures.length)return this.signatures[0];for(var e=[],t=[],i=[],r=this.signatures.length,a=0;a<r;++a){var n=this.signatures[a];this._validateSameVariables(n.outputs,this._outputs)&&(this._validateSameVariables(n.inputs,this._inputs)&&(e.push(n),this._validateSameType(n.outputs,this._outputs)&&(t.push(n),this._validateSameType(n.inputs,this._inputs)&&i.push(n))))}return e.length?1!==e.length&&t.length?1!==t.length&&i.length?i[0]:t[0]:e[0]:this.signatures[0]},getOrCreateSignature:function(){return this._signature||(this._signature=this._getSignatureBestMatch(),this.addExtensions(this._signature.extensions)),this._signature},_typeDownCast:function(t){var i;if(t.optional){if(!(i=this._inputs[t.name]||this._outputs[t.name]))return}else i=t.isOutput?this._outputs[t.name]:this._inputs[t.name];if(!i){var r=t.isOutput?"output":"input";return a.a.error("missing "+r+" "+t.name+" on NodeCustom "+e.nodeName),void(this._missingArgs=!0)}var n=i.getType(),o=t.type;return o&&o!==n?"vec3"===o?i.getVariable()+".rgb":"vec2"===o?i.getVariable()+".rg":"float"===o?i.getVariable()+".r":i:i},computeShader:function(){var t=this.getOrCreateSignature(),i=t.returnVariable&&t.returnVariable.name,r=i?this._outputs[i]:void 0;i&&!r&&(a.a.error("missing output "+i+" on NodeCustom "+e.nodeName),this._missingArgs=!0);for(var n=[],o=0;o<t.orderedArgs.length;++o){var s=this._typeDownCast(t.orderedArgs[o]);s&&n.push(s)}return this._missingArgs?"":u(e.functionName,r,n)}}),"osgShader",e.nodeName),i},d={},p=function(e,t){for(var i=e[t].split(/#pragma DECLARE_FUNCTION(.*)[\r\n|\r|\n]/),r=(i.length-1)/2,a={},n=0;n<r;++n){var o=c(i[2*n+1],i[2*n+2]),s=o.nodeName,u=a[s];u?u.prototype.signatures.push(o.signature):(u=d[s],u?(u.prototype.signatures=[o.signature],u.prototype.globalDeclare='#pragma include "'+t+'"'):u=h(o,t),a[s]=u,d[s]=u)}return a};t.a={callFunction:u,checkVariableType:s,sprintf:o,extractFunctions:p}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(553),a=i(552),n=i(1059),o=i(592),s=i(822),u=i(603),l=i(689),c={};c.Compiler=r.a,c.ShaderGenerator=a.a,c.ShaderGeneratorProxy=n.a,c.ShaderProcessor=o.a,c.nodeFactory=s.a,c.utils=l.a,c.node={},c.node.Node=u.a,s.a._nodes.forEach(function(e,t){c.node[t]=e}),c.debugShaderNode=!1,t.default=c},function(e,t,i){"use strict";var r,a=i(1063),n=i(826),o=i(21),s=function(){try{r=i(3)}catch(e){o.a.warn("You will not be able to use osgUtil.DisplayGraph until you add jQuery in your page")}},u=function(e){this.options=e;var t=document.createElement("style");t.type="text/css",t.innerHTML=[".osgDebugSimpleTooltip {","display: none;","position: absolute;","margin-left: 10px;","border-radius: 4px;","padding: 10px;","background: rgba(0,0,0,.9);","color: #ffffff;","}",".osgDebugSimpleTooltip:before {","content: ",";","position: absolute;","left: -10px;","top: 8px;","border: 10px solid transparent;","border-width: 10px 10px 10px 0;","border-right-color: rgba(0,0,0,.9);","}"].join("\n"),document.getElementsByTagName("head")[0].appendChild(t),this.el=document.createElement("div"),this.el.className="osgDebugSimpleTooltip",document.body.appendChild(this.el);for(var i=document.querySelectorAll(this.options.selector),r=0;r<i.length;r++)i[r].addEventListener("mouseover",this.showTooltip.bind(this),!1),i[r].addEventListener("mouseout",this.hideTooltip.bind(this),!1)};u.prototype={showTooltip:function(e){if(r){var t=e.currentTarget;this.el.innerHTML=t.getAttribute("title"),this.el.style.display="block",this.el.style.left=r(t).position().left+r(t).get(0).getBoundingClientRect().width+"px",this.el.style.top=r(t).position().top+"px"}},hideTooltip:function(){this.el.style.display="none"}};var l=function(){s(),r&&(this._selectables=new window.Map,this._graphNode=new n.a(this._selectables),this._graphRender=new a.a(this._selectables),this._displayNode=!0,this._displayRenderer=!1,this._cbSelect=void 0,this._focusedElement="graph",this._idToDomElement=new window.Map,this._$svg=r("<svg width=100% height=100%></svg>"),r("body").append(this._$svg),this._css=".node {text-align: center;cursor: pointer;}.node rect {stroke: #FFF;}.edgePath path {stroke: #FFF;fill: none;}table {text-align: right;}svg {position: absolute;left: 0px;top: 0px;}.osgDebugButton {position: absolute;left: 15px;top: 15px;z-index: 5;border: 0;background: #65a9d7;background: -webkit-gradient(linear, left top, left bottom, from(#3e779d), to(#65a9d7));background: -webkit-linear-gradient(top, #3e779d, #65a9d7);background: -moz-linear-gradient(top, #3e779d, #65a9d7);background: -ms-linear-gradient(top, #3e779d, #65a9d7);background: -o-linear-gradient(top, #3e779d, #65a9d7);padding: 5px 10px;-webkit-border-radius: 7px;-moz-border-radius: 7px;border-radius: 7px;-webkit-box-shadow: rgba(0,0,0,1) 0 1px 0;-moz-box-shadow: rgba(0,0,0,1) 0 1px 0;box-shadow: rgba(0,0,0,1) 0 1px 0;text-shadow: rgba(0,0,0,.4) 0 1px 0;color: white;font-size: 15px;font-family: Helvetica, Arial, Sans-Serif;text-decoration: none;vertical-align: middle;}.osgDebugButton:hover {border-top-color: #28597a;background: #28597a;color: #ccc;}.osgDebugButton:active {border-top-color: #1b435e;background: #1b435e;}.osgDebugSimpleTooltip .osgDebugName {font-weight: bold;color: #60b1fc;margin: 0;}.osgDebugSimpleTooltip .osgDebugDescription {margin: 0;}")};l.instance=function(){return l._instance||(l._instance=new l),l._instance},l.prototype={getColorFromClassName:n.a.prototype.getColorFromClassName,setCallbackSelect:function(e){this._cbSelect=e},reset:function(){r&&(this._selectables.clear(),this._$svg.empty(),this._focusedElement="scene",r(".osgDebugButton").hide())},setDisplayGraphRenderer:function(e){this._displayRenderer=e},createRenderGraph:function(e){this._graphRender.createGraph(e),this.displayGraph()},createGraph:function(e){r&&(this.reset(),this._displayNode=!!e,e&&this._graphNode.createGraph(e),this._displayRenderer?i(692).default.debugGraph=!0:this.displayGraph())},displayGraph:function(){if(r){if(window.d3&&window.dagreD3)return void this._createGraphApply();var e=this._createGraphApply.bind(this);r.getScript("//cdnjs.cloudflare.com/ajax/libs/d3/3.4.13/d3.min.js").done(function(){r.getScript("//cdn.jsdelivr.net/dagre-d3/0.2.9/dagre-d3.min.js").done(e)})}},_createGraphApply:function(){var e=new window.dagreD3.Digraph;this._displayNode&&this._graphNode.generateNodeAndLink(e),this._displayRenderer&&this._graphRender.generateNodeAndLink(e),this.injectStyleElement(),r(".osgDebugButton").show();var t=this.renderer=new window.dagreD3.Renderer,i=window.d3.select(this._$svg.get(0)),a=i.append("g"),n=t.zoom();t.zoom(function(e,t){var i=n(e,t);return i.scale(.75).event(t),i});var o=function(e,t){return'<p class="osgDebugName">'+e+'</p><pre class="osgDebugDescription">'+t+"</pre>"},s=this._idToDomElement,l=t.drawNodes();t.drawNodes(function(e,t){var i=l(e,t);return i.attr("title",function(t){return s.set(t,this),o(t,e.node(t).description||"")}),i}),t.run(e,a),this.tooltip=new u({selector:".node"}),r(".node").click(this.onNodeSelect.bind(this)),this.focusOnGraph()},selectNode:function(e){var t=e.getInstanceID(),i=this._idToDomElement.get(t);i&&r(i).click()},onNodeSelect:function(e){var t=e.currentTarget,i=r(t.getAttribute("title"))[0].innerHTML,a=this._selectables;this.lastNode&&(this.lastNode.style.fill=this.lastColor);var n=a.get(i);n&&(this.lastNode=t.childNodes[0],this.lastColor=this.lastNode.style.fill,t.childNodes[0].style.fill="#f00",window.activeNode=n,o.a.info("window.activeNode is set with the node below !"),o.a.log(window.activeNode),o.a.log("\n"),this._cbSelect&&this._cbSelect(n))},focusOnScene:function(){r(".osgDebugButton").text("Access to the graph"),this._$svg.css("zIndex","-2"),this._focusedElement="scene"},focusOnGraph:function(){r(".osgDebugButton").text("Access to the scene"),this._$svg.css("zIndex","2"),r(".osgDebugSimpleTooltip").css("zIndex","3"),this._focusedElement="graph"},injectStyleElement:function(){if(!this._cssInjected){this._cssInjected=!0,r("body").append('<button class="osgDebugButton">Access to the scene</button>'),r(".osgDebugButton").click(function(){"scene"===this._focusedElement?this.focusOnGraph():this.focusOnScene()}.bind(this));var e=document.createElement("style");e.type="text/css",e.innerHTML=this._css,document.getElementsByTagName("head")[0].appendChild(e)}}},t.a=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(9),a=i(544),n=i(545),o=i(71),s=i(589),u=i(792),l=i(588),c=i(10),h=i(690),d=i(691),p=function(e){o.a.call(this),this._state=void 0,this._camera=e,this._renderStage=void 0,this._stateGraph=void 0,this._frameStamp=void 0,this._previousCullsettings=new a.a,this.setDefaults()};p.debugGraph=!1,r.a.createPrototypeObject(p,r.a.objectInherit(o.a.prototype,{setDefaults:function(){this._state=new u.a(new h.default.ShaderGeneratorProxy),this._cullVisitor=new n.a,this._cullVisitor.setRenderer(this),this._stateGraph=new l.a,this.getCamera().setClearColor(c.g.create()),this.setRenderStage(new s.a);var e=i(772).default,t=this.getCamera().getOrCreateStateSet();t.setAttributeAndModes(new e.Material),t.setAttributeAndModes(new e.Depth),t.setAttributeAndModes(new e.BlendFunc),t.setAttributeAndModes(new e.CullFace)},getCullVisitor:function(){return this._cullVisitor},setCullVisitor:function(e){e&&!e.getRenderer()&&e.setRenderer(this),this._cullVisitor=e},setRenderStage:function(e){this._renderStage=e},getCamera:function(){return this._camera},setFrameStamp:function(e){this._frameStamp=e},getFrameStamp:function(){return this._frameStamp},getState:function(){return this._state},setState:function(e){this._state=e},setGraphicContext:function(e){this._state.setGraphicContext(e)},getGraphicContext:function(){return this._state.getGraphicContext()},cullAndDraw:function(){this.cull(),this.draw()},cull:function(){var e=this.getCamera(),t=e.getView();this._cullVisitor.setFrameStamp(this._frameStamp),this._cullVisitor.resetStats(),l.a.reset(),this._stateGraph.clean(),this._renderStage.reset(),this._cullVisitor.reset(),this._cullVisitor.setStateGraph(this._stateGraph),this._cullVisitor.setRenderStage(this._renderStage),this._cullVisitor.pushStateSet(e.getStateSet()),this._previousCullsettings.reset(),this._previousCullsettings.setCullSettings(this._cullVisitor),this._cullVisitor.setCullSettings(e),this._previousCullsettings.getSettingSourceOverrider()===this._cullVisitor&&this._previousCullsettings.getEnableFrustumCulling()&&this._cullVisitor.setEnableFrustumCulling(!0),this._cullVisitor.pushCameraModelViewProjectionMatrix(e,e.getViewMatrix(),e.getProjectionMatrix()),e.getBound();var r=t.getLight(),a=i(693).default;if(r)switch(t.getLightingMode()){case a.LightingMode.HEADLIGHT:this._cullVisitor.addPositionedAttribute(null,r);break;case a.LightingMode.SKY_LIGHT:this._cullVisitor.addPositionedAttribute(e.getViewMatrix(),r)}var n=e.getViewport(),o=e.getScissor();this._cullVisitor.pushViewport(n),this._renderStage.setClearDepth(e.getClearDepth()),this._renderStage.setClearColor(e.getClearColor()),this._renderStage.setClearMask(e.getClearMask()),this._renderStage.setViewport(n),this._renderStage.setScissor(o),this._cullVisitor.setDatabaseRequestHandler(this._camera.getView().getDatabasePager()),this._cullVisitor.handleCullCallbacksAndTraverse(e),this._cullVisitor.popCameraModelViewProjectionMatrix(e),this._cullVisitor.setCullSettings(this._previousCullsettings),this._cullVisitor.popViewport(),this._cullVisitor.popStateSet(),this._renderStage.sort()},draw:function(){var e=this.getState();e.resetCacheFrame(),e.resetStats(),this._renderStage.setCamera(this._camera),this._renderStage.draw(e),p.debugGraph&&(d.a.instance().createRenderGraph(this._renderStage),p.debugGraph=!1),this._renderStage.setCamera(void 0),e.applyDefault()}}),"osgViewer","Renderer"),t.default=p},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(128),a=i(142),n=i(786),o=i(248),s=i(548),u=i(10),l=i(84),c=i(186),h=i(217),d=i(682),p=i(417),f=i(586),m=i(246),g=i(550),_=i(551),v=i(692),b=i(827),y=i(691),x=i(21),S=function(){this._camera=new a.a,this._camera.setName("OSGJS camera"),this._scene=new b.a,this._camera.setName("OSGJS Scene"),this._frameStamp=new n.a,this._lightingMode=void 0,this._manipulator=void 0,this._canvasWidth=0,this._canvasHeight=0,this._requestContinousUpdate=!0,this._requestRedraw=!0,this.setLightingMode(S.LightingMode.HEADLIGHT);var e=this.createRenderer(this.getCamera());e.setFrameStamp(this._frameStamp),this.getCamera().setRenderer(e),this.getCamera().setView(this)};S.LightingMode={NO_LIGHT:0,HEADLIGHT:1,SKY_LIGHT:2},S.prototype={requestRedraw:function(){this._requestRedraw=!0},requestContinuousUpdate:function(e){this._requestContinousUpdate=e},createRenderer:function(e){return new v.default(e)},setGraphicContext:function(e){this.getCamera().getRenderer().getState().setGraphicContext(e)},getGraphicContext:function(){return this.getCamera().getRenderer().getState().getGraphicContext()},initWebGLCaps:function(e,t){m.a.instance(e,t)},computeCanvasSize:function(){return function(e){var t,i;t=e.clientWidth,i=e.clientHeight,t<1&&(t=1),i<1&&(i=1);var r=this._devicePixelRatio,a=Math.floor(t*r),n=Math.floor(i*r),o=!1;return this._canvasWidth!==a&&(e.width=a,this._canvasWidth=a,o=!0),this._canvasHeight!==n&&(e.height=n,this._canvasHeight=n,o=!0),o}}(),getCanvasWidth:function(){return this._canvasWidth},getCanvasHeight:function(){return this._canvasHeight},getCanvasClientWidth:function(){return Math.ceil(this._canvasWidth/this._devicePixelRatio)},getCanvasClientHeight:function(){return Math.ceil(this._canvasHeight/this._devicePixelRatio)},getCanvasPixelRatio:function(){return this._devicePixelRatio},setUpView:function(e,t){var i=window.devicePixelRatio||1,r=t.getNumber("overrideDevicePixelRatio"),a=t.getNumber("maxDevicePixelRatio")||-1;"number"==typeof r?i=r:-1!==a&&(i=Math.min(i,a)),this._devicePixelRatio=i,this.computeCanvasSize(e);var n=e.width,o=e.height,s=n/o;if(this._camera.setViewport(new p.a(0,0,n,o)),this._camera.setScissor(new d.a),this._camera.setGraphicContext(this.getGraphicContext()),u.c.lookAt(this._camera.getViewMatrix(),u.f.fromValues(0,0,-10),u.f.create(),u.f.fromValues(0,1,0)),u.c.perspective(this._camera.getProjectionMatrix(),Math.PI/180*55,s,1,1e3),t&&t.enableFrustumCulling&&this.getCamera().getRenderer().getCullVisitor().setEnableFrustumCulling(!0),t&&t.debugGraph){var l=this.getCamera();y.a.instance().refreshGraph=function(){var e=y.a.instance();e.setDisplayGraphRenderer(!0),e.createGraph(l)},x.a.log("to refresh the graphs type in the console:\nOSG.osgUtil.DisplayGraph.instance().refreshGraph()")}},computeIntersections:function(e,t,i){return void 0===i&&(i=-1),this._lsi?this._lsi.reset():this._lsi=new _.a,this._origIntersect||(this._origIntersect=u.f.create(),this._dstIntersect=u.f.create()),this._lsi.set(u.f.set(this._origIntersect,e,t,0),u.f.set(this._dstIntersect,e,t,1)),this._iv?this._iv.reset():(this._iv=new g.a,this._iv.setIntersector(this._lsi)),this._iv.setTraversalMask(i),this._camera.accept(this._iv),this._lsi.getIntersections()},setFrameStamp:function(e){this._frameStamp=e},getFrameStamp:function(){return this._frameStamp},setCamera:function(e){this._camera=e},getCamera:function(){return this._camera},setSceneData:function(e){if(e!==this._scene.getSceneData()){this._scene.setSceneData(e);for(var t=this._camera.getChildren(),i=void 0,r=0,a=t.length;r<a;r++)if("osgStats"===t[r].getName()){i=t[r];break}this._camera.removeChildren(),this._camera.addChild(e),i&&this._camera.addChild(i)}},getSceneData:function(){return this._scene.getSceneData()},setDatabasePager:function(e){this._scene.setDatabasePager(e)},getDatabasePager:function(){return this._scene.getDatabasePager()},getScene:function(){return this._scene},getManipulator:function(){return this._manipulator},setManipulator:function(e){this._manipulator=e},getLight:function(){return this._light},setLight:function(e){this._light=e,this._lightingMode!==S.LightingMode.NO_LIGHT&&this._scene.getOrCreateStateSet().setAttributeAndModes(this._light)},getLightingMode:function(){return this._lightingMode},setLightingMode:function(e){this._lightingMode!==e&&(this._lightingMode=e,this._lightingMode!==S.LightingMode.NO_LIGHT?this._light||(this._light=new s.a):this._light=void 0)},flushDeletedGLObjects:function(e){var t=this.getGraphicContext(),i=e;i=r.a.flushDeletedGLBufferArrays(t,i),i=f.a.flushDeletedGLVertexArrayObjects(t,i),i=l.default.getTextureManager(t).flushDeletedTextureObjects(t,i),i=c.a.flushDeletedGLPrograms(t,i),i=h.a.flushDeletedGLShaders(t,i),i=o.a.flushDeletedGLFrameBuffers(t,i),o.a.flushDeletedGLRenderBuffers(t,i)},flushAllDeletedGLObjects:function(){var e=this.getGraphicContext();f.a.flushAllDeletedGLVertexArrayObjects(e),r.a.flushAllDeletedGLBufferArrays(e),l.default.getTextureManager(e).flushAllDeletedTextureObjects(e),c.a.flushAllDeletedGLPrograms(e),h.a.flushAllDeletedGLShaders(e),o.a.flushAllDeletedGLFrameBuffers(e),o.a.flushAllDeletedGLRenderBuffers(e)}},t.default=S},function(e,t,i){"use strict";var r=function(){this._values=new Float32Array(r.maxGraphValue),this._index=0,this._maxValue=0,this._x=0,this._y=0};r.maxGraphValue=120,r.prototype={getIndex:function(){return this._index},getValues:function(){return this._values},setDisplayPosition:function(e,t){this._x=e,this._y=t},getX:function(){return this._x},getY:function(){return this._y},addValue:function(e,t){var i=this._index;this._maxValue=e>this._maxValue?e:this._maxValue,this._maxValue*=.99,this._values[i]=e/(1.1*this._maxValue),t&&(this._values[i]+=t),this._index=(this._index+1)%r.maxGraphValue}},t.a=r},function(e,t,i){"use strict";var r=i(21),a=i(71),n=i(9),o=function(){a.a.call(this),this._shadowedScene=void 0,this._dirty=!1,this._continuousUpdate=!0,this._needRedraw=!0};n.a.createPrototypeObject(o,n.a.objectInherit(a.a.prototype,{dirty:function(){this._dirty=!0},getShadowedScene:function(){return this._shadowedScene},setContinuousUpdate:function(e){this._continuousUpdate=e},isContinuousUpdate:function(){return this._continuousUpdate},needRedraw:function(){return this._needRedraw},requestRedraw:function(){this._needRedraw=!0},setShadowedScene:function(e){this._shadowedScene=e},init:function(){r.a.log("No ShadowTechnique activated: normal rendering activated")},valid:function(){return!1},updateShadowTechnique:function(){},cullShadowCasting:function(){},cleanSceneGraph:function(){r.a.log("No ShadowTechnique activated: normal rendering activated")}}),"osgShadow","ShadowTechnique"),t.a=o},function(e,t,i){"use strict";var r=i(21),a=i(84),n=i(72),o=i(9),s=i(10),u=function(){a.default.call(this),this._uniforms={},this._mapSize=s.g.create(),this._renderSize=s.e.create(),this._lightNumber=-1,this._dirtyHash=!0,this._hash=""};u.uniforms={},o.a.createPrototypeStateAttribute(u,o.a.objectInherit(a.default.prototype,{cloneType:function(){return new u},invalidate:function(){a.default.prototype.invalidate.call(this),this.dirty()},hasLightNumber:function(e){return this._lightNumber===e},setLightNumber:function(e){this._lightNumber=e,this._dirtyHash=!0},getLightNumber:function(){return this._lightNumber},getUniformName:function(e){return"uShadow_"+this.getType()+this._lightNumber.toString()+"_"+e},setInternalFormatType:function(e){a.default.prototype.setInternalFormatType.call(this,e),this._dirtyHash=!0},getOrCreateUniforms:function(e){var t=u;if(r.a.assert(void 0!==e),r.a.assert(-1!==this._lightNumber),void 0!==t.uniforms[e])return t.uniforms[e];var i=t.uniforms[e]={ViewRight:n.a.createFloat4(this.getUniformName("viewRight")),ViewUp:n.a.createFloat4(this.getUniformName("viewUp")),ViewLook:n.a.createFloat4(this.getUniformName("viewLook")),Projection:n.a.createFloat3(this.getUniformName("projection")),DepthRange:n.a.createFloat2(this.getUniformName("depthRange")),MapSize:n.a.createFloat4(this.getUniformName("mapSize")),RenderSize:n.a.createFloat2(this.getUniformName("renderSize"))},a="Texture"+e,o=n.a.createInt1(e,a);return i[a]=o,t.uniforms[e]},setViewMatrix:function(e){this._viewMatrix=e},setProjection:function(e){this._projection=e},setDepthRange:function(e){this._depthRange=e},setTextureSize:function(e,t){a.default.prototype.setTextureSize.call(this,e,t),this.dirty(),this._mapSize[0]=e,this._mapSize[1]=t,this._mapSize[2]=1/e,this._mapSize[3]=1/t,this._renderSize[0]=1/e,this._renderSize[1]=1/t},_updateViewMatrixUniforms:function(e,t,i,r){var a,n=e;a=t.getInternalArray(),a[0]=n[0],a[1]=n[4],a[2]=n[8],a[3]=n[12],a=i.getInternalArray(),a[0]=n[1],a[1]=n[5],a[2]=n[9],a[3]=n[13],a=r.getInternalArray(),a[0]=n[2],a[1]=n[6],a[2]=n[10],a[3]=n[14]},apply:function(e,t){if(a.default.prototype.apply.call(this,e,t),-1!==this._lightNumber){var i=this.getOrCreateUniforms(t);this._updateViewMatrixUniforms(this._viewMatrix,i.ViewRight,i.ViewUp,i.ViewLook),i.Projection.setFloat3(this._projection),i.DepthRange.setFloat2(this._depthRange),i.MapSize.setFloat4(this._mapSize),i.RenderSize.setFloat2(this._renderSize)}},getHash:function(){return this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!1,this._hash):this._hash},_computeInternalHash:function(){return this.getTypeMember()+"_"+this._lightNumber+"_"+this._type}}),"osgShadow","ShadowTexture"),t.a=u},function(e,t,i){"use strict";function r(e,t,i){var n=this._refs[i];if("string"==typeof n){if(!this._refs[n])return r.call(this,e,t,n);n=this._refs[n]}if((n=n||this._schemas[i])instanceof v)return s(n.schema,this._opts.inlineRefs)?n.schema:n.validate||this._compile(n);var o,u,l,c=a.call(this,t,i);return c&&(o=c.schema,t=c.root,l=c.baseId),o instanceof v?u=o.validate||e.call(this,o.schema,t,void 0,l):void 0!==o&&(u=s(o,this._opts.inlineRefs)?o:e.call(this,o,t,void 0,l)),u}function a(e,t){var i=m.parse(t),r=h(i),a=c(this._getId(e.schema));if(r!==a){var s=d(r),u=this._refs[s];if("string"==typeof u)return n.call(this,e,u,i);if(u instanceof v)u.validate||this._compile(u),e=u;else{if(!((u=this._schemas[s])instanceof v))return;if(u.validate||this._compile(u),s==d(t))return{schema:u,root:e,baseId:a};e=u}if(!e.schema)return;a=c(this._getId(e.schema))}return o.call(this,i,a,e.schema,e)}function n(e,t,i){var r=a.call(this,e,t);if(r){var n=r.schema,s=r.baseId;e=r.root;var u=this._getId(n);return u&&(s=p(s,u)),o.call(this,i,s,n,e)}}function o(e,t,i,r){if(e.fragment=e.fragment||"","/"==e.fragment.slice(0,1)){for(var n=e.fragment.split("/"),o=1;o<n.length;o++){var s=n[o];if(s){if(s=_.unescapeFragment(s),void 0===(i=i[s]))break;var u;if(!y[s]&&(u=this._getId(i),u&&(t=p(t,u)),i.$ref)){var l=p(t,i.$ref),c=a.call(this,r,l);c&&(i=c.schema,r=c.root,t=c.baseId)}}}return void 0!==i&&i!==r.schema?{schema:i,root:r,baseId:t}:void 0}}function s(e,t){return!1!==t&&(void 0===t||!0===t?u(e):t?l(e)<=t:void 0)}function u(e){var t;if(Array.isArray(e)){for(var i=0;i<e.length;i++)if("object"==typeof(t=e[i])&&!u(t))return!1}else for(var r in e){if("$ref"==r)return!1;if("object"==typeof(t=e[r])&&!u(t))return!1}return!0}function l(e){var t,i=0;if(Array.isArray(e)){for(var r=0;r<e.length;r++)if(t=e[r],"object"==typeof t&&(i+=l(t)),i==1/0)return 1/0}else for(var a in e){if("$ref"==a)return 1/0;if(x[a])i++;else if(t=e[a],"object"==typeof t&&(i+=l(t)+1),i==1/0)return 1/0}return i}function c(e,t){return!1!==t&&(e=d(e)),h(m.parse(e))}function h(e){return m.serialize(e).split("#")[0]+"#"}function d(e){return e?e.replace(S,""):""}function p(e,t){return t=d(t),m.resolve(e,t)}function f(e){var t=d(this._getId(e)),i={"":t},r={"":c(t,!1)},a={},n=this;return b(e,{allKeys:!0},function(e,t,o,s,u,l,c){if(""!==t){var h=n._getId(e),p=i[s],f=r[s]+"/"+u;if(void 0!==c&&(f+="/"+("number"==typeof c?c:_.escapeFragment(c))),"string"==typeof h){h=p=d(p?m.resolve(p,h):h);var v=n._refs[h];if("string"==typeof v&&(v=n._refs[v]),v&&v.schema){if(!g(e,v.schema))throw new Error('id "'+h+'" resolves to more than one schema')}else if(h!=d(f))if("#"==h[0]){if(a[h]&&!g(e,a[h]))throw new Error('id "'+h+'" resolves to more than one schema');a[h]=e}else n._refs[h]=f}i[t]=p,r[t]=f}}),a}var m=i(1100),g=i(698),_=i(456),v=i(842),b=i(1102);e.exports=r,r.normalizeId=d,r.fullPath=c,r.url=p,r.ids=f,r.inlineRef=s,r.schema=a;var y=_.toHash(["properties","patternProperties","enum","dependencies","definitions"]),x=_.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]),S=/#\/?$/},function(e,t,i){"use strict";var r=Array.isArray,a=Object.keys,n=Object.prototype.hasOwnProperty;e.exports=function e(t,i){if(t===i)return!0;var o,s,u,l=r(t),c=r(i);if(l&&c){if((s=t.length)!=i.length)return!1;for(o=0;o<s;o++)if(!e(t[o],i[o]))return!1;return!0}if(l!=c)return!1;var h=t instanceof Date,d=i instanceof Date;if(h!=d)return!1;if(h&&d)return t.getTime()==i.getTime();var p=t instanceof RegExp,f=i instanceof RegExp;if(p!=f)return!1;if(p&&f)return t.toString()==i.toString();if(t instanceof Object&&i instanceof Object){var m=a(t);if((s=m.length)!==a(i).length)return!1;for(o=0;o<s;o++)if(!n.call(i,m[o]))return!1;for(o=0;o<s;o++)if(u=m[o],!e(t[u],i[u]))return!1;return!0}return!1}},function(e,t,i){"use strict";function r(e){this.message="validation failed",this.errors=e,this.ajv=this.validation=!0}function a(e,t,i){this.message=i||a.message(e,t),this.missingRef=o.url(e,t),this.missingSchema=o.normalizeId(o.fullPath(this.missingRef))}function n(e){return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var o=i(697);e.exports={Validation:n(r),MissingRef:n(a)},a.message=function(e,t){return"can't resolve reference "+t+" from id "+e}},function(e,t,i){"use strict";var r=i(5),a=i(16),n=r.a.osg,o=["magFilter","minFilter","wrapS","wrapT","textureWidth","textureHeight","textureTarget","internalFormat"],s={getValidOptions:function(){return o},getOptions:function(e){var t={};return t.minFilter=e.getMinFilter(),t.magFilter=e.getMagFilter(),t.wrapT=e.getWrapT(),t.wrapS=e.getWrapS(),t.textureWidth=e.getWidth(),t.textureHeight=e.getHeight(),t.textureTarget=e.getTextureTarget(),t.internalFormat=e._internalFormat,t.imageFormat=e._imageFormat,t},setOptions:function(e,t){t.setMinFilter(e.minFilter),t.setMagFilter(e.magFilter),t.setWrapT(e.wrapT),t.setWrapS(e.wrapS),e.minFilter===n.Texture.LINEAR_MIPMAP_LINEAR&&Object(a.a)().anisotropy&&t.setMaxAnisotropy(16),t.setInternalFormat(e.internalFormat)},createValidOptionsForMaterial:function(e){var t=s.createValidOptions(e);return t.minFilter===n.Texture.NEAREST_MIPMAP_LINEAR?(t.magFilter=n.Texture.NEAREST,t):t.minFilter===n.Texture.LINEAR_MIPMAP_LINEAR||t.minFilter===n.Texture.LINEAR?(t.magFilter=n.Texture.LINEAR,t):t.minFilter===n.Texture.NEAREST?(t.magFilter=n.Texture.NEAREST,t):t.magFilter===n.Texture.LINEAR?(t.minFilter=n.Texture.LINEAR_MIPMAP_LINEAR,t):(t.magFilter=n.Texture.NEAREST,t.minFilter=n.Texture.NEAREST,t)},createValidOptions:function(e){e||(e={});for(var t=o.length,i=0;i<t;++i){var r=o[i];"string"==typeof e[r]&&(e[r]=n.Texture[e[r]])}return e.magFilter||(e.magFilter=n.Texture.LINEAR),e.minFilter||(e.minFilter=n.Texture.LINEAR_MIPMAP_LINEAR),e.wrapS||(e.wrapS=n.Texture.REPEAT),e.wrapT||(e.wrapT=n.Texture.REPEAT),e.textureWidth||(e.textureWidth=0),e.textureHeight||(e.textureHeight=0),e.textureTarget||(e.textureTarget=n.Texture.TEXTURE_2D),e.internalFormat||(e.internalFormat=-1),e}};t.a=s},function(e,t,i){"use strict";var r=i(29),a=i.n(r),n=i(7),o=i.n(n),s=i(15),u=i.n(s),l=i(120),c=i(17),h=i(571);t.a=l.a.extend({getModelOptionPath:function(){return"#.definitions.soundtrack"},getName:function(){return"Soundtrack"},initDefaults:function(e){this.get("uid")||(l.a.prototype.initDefaults.call(this,e),this.set("uid","tmp_"+this.cid))},defaults:function(){return{cid:this.cid,lastComputedScenePosition:[0,0,0],lastComputedWorldPosition:[0,0,0]}},endpoint:function(){return"/sounds"+(this.isNew()?"":"/"+this.get("uid"))},duplicate:function(){var e=new this.constructor;return e.setJSON(this.getJSON()),e.set("name",this.get("name")),e.set("url",this.get("url")),e.set("files",this.get("files")),e},save:function(e,t){if(!this.isNew())return o.a.resolve();null!=e&&"object"!==(void 0===e?"undefined":a()(e))||(t=e);var i=new FormData;i.append("soundFile",this.get("files")[0]),i.append("name",this.get("name")),i.append("model",t.modelUID);var r=this;return o.a.resolve(u.a.ajax({type:"POST",url:this.url(),data:i,processData:!1,contentType:!1})).then(function(e){r.set("uid",e.uid)})}},Object(h.a)({fileTypes:c.a.soundFiletypes,maxFileSize:c.a.maxSoundFilesize}))},function(e,t,i){"use strict";i.d(t,"a",function(){return d}),i.d(t,"b",function(){return h});var r,a,n=i(118),o=!1;if(document)for(var s=["hidden","mozHidden","msHidden","webkitHidden"],u=0,l=s.length;u<l;u++){var c=s[u];if(void 0!==document[c]){r=c,a=c.toLowerCase().split("hidden").shift()+"visibilitychange";break}}var h,d=function(){return a};h=Object(n.a)()?function(){return!1}:function(){return!(o||!r)&&document[r]}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=(i.n(r),i(5)),n=i(8),o=i(120),s=i(12),u=i(17),l=i(47),c=i(113),h=i(93),d=i(854),p=i(37),f=i(79),m=i(59),g=a.a.osg,_=function(e){return 0===e[0]&&0===e[1]&&0===e[2]},v=function(e){return 1===e[0]&&1===e[1]&&1===e[2]},b={CavityPBR:!0,AOPBR:!0,NormalMap:!0,Displacement:!0,BumpMap:!0},y={DiffuseIntensity:!0,DiffusePBR:!0,AlbedoPBR:!0,SpecularPBR:!0,GlossinessPBR:!0,RoughnessPBR:!0,MetalnessPBR:!0,SpecularF0:!0},x={},S=x.view=n.a.extend({initialize:function(){n.a.prototype.initialize.apply(this,arguments),this.model.on("change:enable",this.updateChannel,this),this.model.on("change:texCoordUnit",this.changeTexCoord,this),this.model.on("setFactor",this.updateChannel,this),this.model.on("setColor",this.updateChannel,this),this.model.on("setTextureModel",this.updateChannel,this),this.model.on("updateChannel",this.updateChannel,this),this.model.on("all",p.a.draw)},getStateSetContext:function(){return this.options.stateSetContext},updateChannel:function(){if(this.model.getTextureModel()){var e=this.model.get("material").get("texCoordUnitList"),t=this.model.getTexCoordUnit();e.length&&-1===e.indexOf(t)&&this.model.setTexCoordUnit(e[0])}this.getStateSetContext().updateChannel(this.model)},apply:function(){this.updateChannel()},changeTexCoord:function(){this.getStateSetContext().dirtyMaterial()}}),M=x.model=o.a.extend({getModelOptionPath:function(){return"materials:0.channels."+this.get("name")},_initFactorFromBox:function(e,t){var i=this;i.get(e)>=0||f.a.getBoxReady().then(function(){if(!(i.get(e)>=0)){var r=f.a.getModelBoxWithoutDisplacement().radius();i.set(e,r*t)}})},setupTextureModel:function(e){var t=new d.a(e);return-1===t.get("internalFormat")&&t.set("internalFormat",c.a.getDefaultFormatEnum(this.get("name"))),t.updateMultiresTexture(),this.setTextureModel(t),t},_createTextureModel:function(e,t){var i=t.get(e.uid);if(i)return this.setupTextureModel(Object(r.extend)({},e,{image:i}));(this.isEffective()||Object(l.a)())&&g.error("can't find imageModel "+e.uid)},setChannelJSON:function(e,t,i){var r=this.setJSON(e,{ignore:["texture"],context:this.get("name"),imageCollection:t,validate:i&&i.validate});return r.length?r:(e.texture&&this._createTextureModel(e.texture,t),r)},getJSON:function(){var e=o.a.prototype.getJSON.call(this,{ignore:["texture"],context:this.get("name")}),t=this.get("textureModel");return t&&(e.texture=t.getJSON()),e},validate:function(e,t){var i=o.a.prototype.validate.call(this,e,t);return t&&t.imageCollection&&e.texture&&e.enable&&e.factor?(t.imageCollection.get(e.texture.uid)||i.push(this.get("name")+" texture uid does not exist"),i):i},getName:function(){return this.get("name")},getEnable:function(){return this.get("enable")},getFactor:function(){return this.get("factor")},getTextureModel:function(){return this.get("textureModel")},getTexCoordUnit:function(){var e=this.get("textureModel");return e&&e.get("texCoordUnit")},setEnable:function(e){return this.set("enable",e)},setFactor:function(e){return this.set("factor",e),this.trigger("setFactor")},setTextureModel:function(e){return this.set("textureModel",e),this.trigger("setTextureModel")},setTexCoordUnit:function(e){var t=this.get("textureModel");void 0!==t&&(t.set("texCoordUnit",e),this.trigger("change:texCoordUnit"))},removeTexture:function(){this.setColor(g.vec3.ONE)},reset:function(){return this.removeTexture(),this.set("factor",1),this.trigger("updateChannel")},resetTextureFormat:function(){var e=this.get("textureModel");e&&(e.set("internalFormat",c.a.getDefaultFormatEnum(this.get("name"))),e.updateMultiresTexture())},isEffective:function(){if(!this.isActivated())return!1;var e=this.get("name"),t=this.get("factor");if(0===t){if("RoughnessPBR"!==e&&"GlossinessPBR"!==e)return!1;var i=this.get("material").getChannels().Opacity;return i.isEffective()&&"refraction"===i.get("type")&&i.get("useMicrosurfaceTexture")}if(b[e]&&!this.get("textureModel"))return!1;if("Displacement"===e&&!g.WebGLCaps.instance().getWebGLParameter("MAX_VERTEX_TEXTURE_IMAGE_UNITS"))return!1;var r=this.get("color");return!(!y[e]&&r&&_(r))&&("DiffuseIntensity"!==e||1!==t||!r||!v(r))},isEnableEffective:function(){return!!this.isActivated()&&(!!y[this.get("name")]||this.isEffective())},isActivated:function(){return!!(c.a.getShadingMask(this.get("name"))&this.getCurrentShading())&&this.get("enable")},getCurrentShading:function(){var e=this.get("material").get("stateSet"),t=e&&e.getShaderGeneratorName();return t?h.a.nameMatch[t]:h.a.get("mask")},shouldDisplayGUIWarningOnDeletion:function(){if(!this.getEnable())return!1;var e=h.a.get("mask")&h.a.CLASSIC,t=e?h.a.CLASSIC:h.a.PBR;return!!(c.a.getShadingMask(this.getName())&t)},addUniforms:function(e,t){var i="u"+(t||this.get("name"))+"Factor";e[i]=g.Uniform.createFloat(i)},cacheUniforms:function(e){this._uniformFactor=e["u"+this.get("name")+"Factor"].getInternalArray(),this._valueFactor=this.isEnableEffective()?this.get("factor"):0},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor},getSRGB:function(){var e=this.get("textureModel");if(!e)return!1;if(!e.getImageModel())return c.a.isSRGB(this.get("name"));var t=e.getImageModel().get("colorSpace");return"srgb"===t||"linear"!==t&&c.a.isSRGB(this.get("name"))},getShaderHash:function(){var e=this.isEffective(),t=e&&this.get("textureModel"),i=this.getSRGB()?"1":"0";return i+=t?t.get("texCoordUnit"):"x"}}),w={};w.view=S,w.model=M.extend({_adaptJSON:function(e){e.texture?delete e.color:delete e.texture},getColor:function(){return this.get("color")},setColor:function(e){return this.set("textureModel",void 0),this.set("color",g.vec3.copy(this.get("color")||g.vec3.create(),e)),this.trigger("setColor")},setTextureModel:function(e){e&&this.set("color",void 0),M.prototype.setTextureModel.call(this,e)},getJSON:function(){var e=M.prototype.getJSON.call(this);return this.get("textureModel")&&e.color&&delete e.color,e},setChannelJSON:function(e,t,i){var r=M.prototype.setChannelJSON.call(this,e,t,i);return r.length?r:(e.color&&this.setColor(e.color),r)}});var T=M.prototype.addUniforms,C=M.prototype.cacheUniforms,E={};E.view=S.extend({initialize:function(){S.prototype.initialize.apply(this,arguments),this.model.on("change:type",this.changeType,this),this.model.on("change:invert",this.updateChannel,this),this.model.on("change:ior",this.updateChannel,this),this.model.on("change:roughnessFactor",this.updateChannel,this),this.model.on("change:useMicrosurfaceTexture",this.updateChannel,this),this.model.on("change:useAlbedoTint",this.updateChannel,this),this.model.on("change:refractionColor",this.updateChannel,this),this.model.on("change:thinLayer",this.updateChannel,this),this.model.get("material").on("change:vertexAlphaEnable",this.updateChannel,this),this._isMasking="alphaMask"===this.model.getTransparency()},_checkForceLuminance:function(){var e=this.model.getTextureModel(),t=e&&e.getMultiresTexture();if(t){var i=e.getImageModel();if(!(!1===i.get("alpha"))){var r=i.get("name")||t.getImageModel().getURL();if(r=r.toLowerCase(),-1===r.indexOf("jpg")&&-1===r.indexOf("jpeg"))return}e.set("internalFormat",g.Texture.LUMINANCE),e.updateMultiresTexture()}},updateChannel:function(){var e=this.model.get("material").getChannels();e.RoughnessPBR.isEnableEffective()?e.RoughnessPBR.trigger("updateChannel"):e.GlossinessPBR.isEnableEffective()&&e.GlossinessPBR.trigger("updateChannel"),this._checkForceLuminance(),S.prototype.updateChannel.call(this)},_updateMaskingFiltering:function(){var e="alphaMask"===this.model.getTransparency();if(e!==this._isMasking){this._isMasking=e;var t=this.model.getTextureModel();if(t&&t.get("magFilter")!==g.Texture.NEAREST){var i=t.get("minFilter"),r=i===g.Texture.LINEAR_MIPMAP_LINEAR,a=i;e&&i===r?a=g.Texture.LINEAR:e||i!==g.Texture.LINEAR||(a=this._blendFilter),a&&(t.set("minFilter",i),t.set("magFilter",r?g.Texture.LINEAR:i),t.updateMultiresTexture())}}},changeType:function(){this._updateMaskingFiltering(),this.updateChannel()}}),E.model=M.extend({_modelOptionPath:"materials:0.channels.Opacity",getTransparency:function(){return this.get("type")},setTransparency:function(e){this.setJSON({type:e})},isEffective:function(){if(!this.isActivated())return!1;var e=this.get("type"),t=this.get("factor"),i=this.get("textureModel"),r=i||this.get("material").get("vertexAlphaEnable");if("alphaMask"===e)return r&&0!==t;if("alphaBlend"===e||"refraction"===e||"additive"===e){if(this.get("material").getChannels().SubsurfaceScattering.isEffective())return!1}return"alphaBlend"!==e&&"refraction"!==e&&"dithering"!==e||(r||1!==t)},addUniforms:function(e,t){T.call(this,e,t),e.uOpacityInvert=g.Uniform.createInt("uOpacityInvert"),e.uOpacityDithering=g.Uniform.createInt("uOpacityDithering"),e.uOpacityAdditive=g.Uniform.createInt("uOpacityAdditive"),e.uOpacityIOR=g.Uniform.createFloat("uOpacityIOR"),e.uOpacityRoughnessFactor=g.Uniform.createFloat("uOpacityRoughnessFactor"),e.uOpacityRefractionColor=g.Uniform.createFloat3("uOpacityRefractionColor"),e.uOpacityThinLayer=g.Uniform.createFloat("uOpacityThinLayer")},cacheUniforms:function(e){C.call(this,e),this._uniformInvert=e.uOpacityInvert.getInternalArray(),this._uniformDithering=e.uOpacityDithering.getInternalArray(),this._uniformAdditive=e.uOpacityAdditive.getInternalArray(),this._uniformIOR=e.uOpacityIOR.getInternalArray(),this._uniformRoughnessFactor=e.uOpacityRoughnessFactor.getInternalArray(),this._uniformRefractionColor=e.uOpacityRefractionColor.getInternalArray();var t=this.isEnableEffective();this._valueInvert=t&&this.get("textureModel")&&this.get("invert")?1:0,this._valueDithering=t&&"dithering"===this.get("type")?1:0,this._valueAdditive=t&&"additive"===this.get("type")?1:0;var i=t&&"refraction"===this.get("type");this._valueIOR=i?this.get("ior"):0,this._valueRoughness=i?this.get("roughnessFactor"):0,this._valueRefractionColor=i?this.get("refractionColor"):g.vec3.ONE,this._uniformThinLayer=e.uOpacityThinLayer.getInternalArray(),this._valueThinLayer=this.get("thinLayer")?1:0},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor,this._uniformInvert[0]=this._valueInvert,this._uniformDithering[0]=this._valueDithering,this._uniformAdditive[0]=this._valueAdditive,this._uniformIOR[0]=this._valueIOR,this._uniformRoughnessFactor[0]=this._valueRoughness,g.vec3.copy(this._uniformRefractionColor,this._valueRefractionColor),this._uniformThinLayer[0]=this._valueThinLayer},_hasTextureAlpha:function(){var e=this.get("textureModel");if(!e)return!1;var t=e.getMultiresTexture();return!(!t||!t.getOriginalFormat)&&t.getOriginalFormat()===g.Texture.ALPHA},getSRGB:function(){return!this._hasTextureAlpha()&&M.prototype.getSRGB.call(this)},getShaderHash:function(){var e=M.prototype.getShaderHash.call(this),t=this.get("type"),i="alphaBlend"===t||"additive"===t,r=this.get("textureModel")&&this.get("textureModel").isLuminance(),a="refraction"===t,n=a&&this.get("useMicrosurfaceTexture")&&h.a.get("mask")&h.a.PBR,o=a&&this.get("useAlbedoTint");return e+=i?"1":"0",e+=r?"1":"0",e+=a?"1":"0",e+=n?"1":"0",e+=o?"1":"0"}});var L={};L.view=S.extend({initialize:function(){S.prototype.initialize.apply(this,arguments),this.model.on("change:occludeSpecular",this.updateChannel,this)}}),L.model=M.extend({getModelOptionPath:function(){return"materials:0.channels.AOPBR"},addUniforms:function(e,t){T.call(this,e,t),e.uAOPBROccludeSpecular=g.Uniform.createInt("uAOPBROccludeSpecular")},cacheUniforms:function(e){C.call(this,e),this._uniformOcclude=e.uAOPBROccludeSpecular.getInternalArray(),this._valueOcclude=this.isEnableEffective()&&this.get("occludeSpecular")?1:0},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor,this._uniformOcclude[0]=this._valueOcclude}});var P={};P.view=S.extend({}),P.model=M.extend({_modelOptionPath:"materials:0.channels.BumpMap",addUniforms:function(e,t){T.call(this,e,t);var i="u"+t+"Size";e[i]=g.Uniform.createFloat2(g.vec2.create(),i)},cacheUniforms:function(e){C.call(this,e),this._uniformSize=e["u"+this.get("name")+"Size"].getInternalArray(),this._mrTexture=this.get("textureModel")&&this.get("textureModel").getMultiresTexture()},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor,this._uniformSize[0]=this._mrTexture?this._mrTexture.getWidth():0,this._uniformSize[1]=this._mrTexture?this._mrTexture.getHeight():0}});var A={};A.view=S.extend({updateChannel:function(){S.prototype.updateChannel.call(this),this.model.updateGeometryOffsets()}}),A.model=M.extend({_modelOptionPath:"materials:0.channels.Displacement",updateGeometryOffsets:function(){var e=g.vec3.create();return function(){var t=this.isEffective()?this.getFactor():0;if(f.a.updateMaxWorldDisplacement(t),0!==t)for(var i=this.get("material").get("geometryList"),r=0,a=i.length;r<a;++r){var n=i[r];if(!n._maxScale){for(var o=n.getWorldMatrices(),s=0,u=0,l=o.length;u<l;++u)g.mat4.getScale(e,o[u]),s=Math.max(s,e[0],e[1],e[2]);n._maxScale=s}var c=n._displacementFactor||0,h=t/(n._maxScale||1);n._displacementFactor=Math.max(c,h),n.dirtyBound()}}}(),setTextureModel:function(e){return e&&e.get("minFilter")===g.Texture.LINEAR_MIPMAP_LINEAR&&(e.set("minFilter",g.Texture.LINEAR),e.updateMultiresTexture()),M.prototype.setTextureModel.call(this,e)},addUniforms:function(e,t){P.model.prototype.addUniforms.call(this,e,t),e.uDisplacementNormal=g.Uniform.createFloat(1,"uDisplacementNormal")},cacheUniforms:function(e){if(P.model.prototype.cacheUniforms.call(this,e),this._uniformNormal=e.uDisplacementNormal.getInternalArray(),this.isEnableEffective()){var t=f.a.getModelBoxWithoutDisplacement();t?this._valueNormal=250*this.get("factor")/t.radius():f.a.getBoxReady().then(this.cacheUniforms.bind(this,e))}else this._valueNormal=0},updateUniforms:function(){P.model.prototype.updateUniforms.call(this),this._uniformNormal[0]=this._valueNormal}});var D={};D.view=S.extend({initialize:function(){S.prototype.initialize.apply(this,arguments),this.model.on("change:flipY",this.updateChannel,this)}}),D.model=M.extend({_modelOptionPath:"materials:0.channels.NormalMap",addUniforms:function(e,t){T.call(this,e,t),e.uNormalMapFlipY=g.Uniform.createInt("uNormalMapFlipY")},cacheUniforms:function(e){C.call(this,e),this._uniformFlip=e.uNormalMapFlipY.getInternalArray(),this._valueFlip=this.isEnableEffective()&&this.get("flipY")?1:0},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor,this._uniformFlip[0]=this._valueFlip}});var O={};O.view=S.extend({initialize:function(){S.prototype.initialize.apply(this,arguments),this.model.on("change:type",this.updateChannel,this)}}),O.model=w.model.extend({_modelOptionPath:"materials:0.channels.EmitColor",addUniforms:function(e,t){T.call(this,e,t),e.uEmitMultiplicative=g.Uniform.createInt("uEmitMultiplicative")},cacheUniforms:function(e){C.call(this,e),this._uniformMultiply=e.uEmitMultiplicative.getInternalArray();var t=this.isEnableEffective()&&"multiplicative"===this.get("type");this._valueMultiply=t?1:0},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor,this._uniformMultiply[0]=this._valueMultiply},isEffective:function(){return!!this.isActivated()&&(0!==this.get("factor")||"additive"!==this.get("type"))}});var k,R=function(){if(k)return k;if(k=m.default.instance.getMatcapCollection(),0===k.length){k.addNewImage({url:u.a.defaultMatcapUid,name:u.a.defaultMatcapUid,width:1,height:1}).set("uid",u.a.defaultMatcapUid)}return k},I={};I.view=S.extend({initialize:function(){S.prototype.initialize.apply(this,arguments),this.model.on("change:curvature",this.updateChannel,this)}}),I.model=w.model.extend({_modelOptionPath:"materials:0.channels.Matcap",_adaptJSON:function(){},initialize:function(){if(M.prototype.initialize.apply(this,arguments),!this.get("textureModel")){var e=R(),t=e.get(u.a.defaultMatcapUid);t||(t=e.at(0)),this.setChannelJSON({texture:{uid:t.getUID()}})}},setTextureModel:function(e){return this.set("textureModel",e),this.trigger("setTextureModel")},setColor:function(e){return this.set("color",g.vec3.copy(this.get("color")||g.vec3.create(),e)),this.trigger("setColor")},isEffective:function(){return!!this.isActivated()},addUniforms:function(e,t){T.call(this,e,t),e.uMatcapCurvature=g.Uniform.createFloat("uMatcapCurvature"),e.uMatcapColor=g.Uniform.createFloat3("uMatcapColor")},cacheUniforms:function(e){C.call(this,e),this._uniformCurvature=e.uMatcapCurvature.getInternalArray(),this._valueCurvature=this.isEnableEffective()?this.get("curvature"):0,this._uniformColor=e.uMatcapColor.getInternalArray(),this._valueColor=this.isEnableEffective()?this.get("color"):g.vec3.ONE},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor,this._uniformCurvature[0]=this._valueCurvature,g.vec3.copy(this._uniformColor,this._valueColor)},getJSON:function(){return M.prototype.getJSON.call(this)},setChannelJSON:function(e,t,i){return M.prototype.setChannelJSON.call(this,e,R(),i)},resetToDefaultMatcap:function(){this.setChannelJSON({texture:{uid:u.a.defaultMatcapUid}})}});var F={};F.view=S.extend({initialize:function(){S.prototype.initialize.apply(this,arguments),this.model.on("change:profile",this.updateChannel,this)}}),F.model=M.extend({_modelOptionPath:"materials:0.channels.SubsurfaceScattering",initialize:function(){M.prototype.initialize.apply(this,arguments),this._initFactorFromBox("factor",.05)},addUniforms:function(e,t){T.call(this,e,t),e.uSubsurfaceScatteringProfile=g.Uniform.createFloat("uSubsurfaceScatteringProfile")},cacheUniforms:function(e){C.call(this,e),this._uniformProfile=e.uSubsurfaceScatteringProfile.getInternalArray(),this._valueProfile=this.isEnableEffective()?this.get("profile"):1},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor,this._uniformProfile[0]=this._valueProfile}});var N={};N.view=S.extend({initialize:function(){S.prototype.initialize.apply(this,arguments),this.model.on("change:thicknessFactor",this.updateChannel,this)}}),N.model=w.model.extend({_modelOptionPath:"materials:0.channels.SubsurfaceTranslucency",initialize:function(){M.prototype.initialize.apply(this,arguments),this._initFactorFromBox("thicknessFactor",.05)},setTextureModel:I.model.prototype.setTextureModel,setColor:I.model.prototype.setColor,getJSON:I.model.prototype.getJSON,setJSON:I.model.prototype.setJSON,_adaptJSON:I.model.prototype._adaptJSON,addUniforms:function(e,t){T.call(this,e,t),e.uSubsurfaceTranslucencyColor=g.Uniform.createFloat3("uSubsurfaceTranslucencyColor"),e.uSubsurfaceTranslucencyThicknessFactor=g.Uniform.createFloat("uSubsurfaceTranslucencyThicknessFactor")},cacheUniforms:function(e){C.call(this,e),this._uniformThicknessFactor=e.uSubsurfaceTranslucencyThicknessFactor.getInternalArray(),this._uniformColor=e.uSubsurfaceTranslucencyColor.getInternalArray(),this._valueColor=this.isEnableEffective()?this.get("color"):g.vec3.ONE,this._valueThicknessFactor=this.isEnableEffective()?this.get("thicknessFactor"):0},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor,this._uniformThicknessFactor[0]=this._valueThicknessFactor,g.vec3.copy(this._uniformColor,this._valueColor)}});var V={};V.view=S.extend({}),V.model=w.model.extend({initialize:function(){s.a.prototype.initialize.apply(this,arguments)},setInspectorSRGB:function(e){this._srgb=e},getSRGB:function(){return!!this._srgb},setTextureModel:I.model.prototype.setTextureModel,setColor:I.model.prototype.setColor,addUniforms:function(e,t){T.call(this,e,t),e.uInspectorInvert=g.Uniform.createInt("uInspectorInvert"),e.uInspectorMaskThreshold=g.Uniform.createFloat("uInspectorMaskThreshold"),e.uInspectorColor=g.Uniform.createFloat3("uInspectorColor")},cacheUniforms:function(e){C.call(this,e),this._uniformInvert=e.uInspectorInvert.getInternalArray(),this._uniformMaskThreshold=e.uInspectorMaskThreshold.getInternalArray(),this._uniformColor=e.uInspectorColor.getInternalArray()},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor,this._uniformInvert[0]=this.get("invert")?1:0,this._uniformMaskThreshold[0]=this.get("maskThreshold"),g.vec3.copy(this._uniformColor,this.getColor())},setChannelJSON:function(e,t){if(void 0!==e.enable&&this.setEnable(e.enable),void 0!==e.factor&&this.setFactor(e.factor),e.color&&this.setColor(e.color),e.texture){this._createTextureModel(e.texture,t)||this.setColor(e.color||g.vec3.fromValues(1,1,1))}return void 0!==e.invert&&this.set("invert",e.invert),void 0!==e.maskThreshold&&this.set("maskThreshold",e.maskThreshold),[]},getJSON:function(){var e={},t=this.get("textureModel");t&&(e.texture=t.getJSON());var i=this.get("color");return i&&(e.color=i),e.factor=this.get("factor"),e.enable=this.get("enable"),e.invert=this.get("invert"),e.maskThreshold=this.get("maskThreshold"),e}});var B={DiffusePBR:w,AlbedoPBR:w,SpecularPBR:w,GlossinessPBR:x,RoughnessPBR:x,MetalnessPBR:x,SpecularF0:x,CavityPBR:x,Matcap:I,SubsurfaceTranslucency:N,DiffuseColor:w,SpecularColor:w,DiffuseIntensity:w,SpecularHardness:x,SubsurfaceScattering:F,Displacement:A,NormalMap:D,AOPBR:L,BumpMap:P,EmitColor:O,Opacity:E,Inspector:V};t.default=B},function(e,t,i){"use strict";var r=i(5),a=i(37),n=r.a.osg,o=function(e){this._duration=void 0===e?1:e,this.reset()};n.createPrototypeObject(o,{getDuration:function(){return this._duration},setDuration:function(e){this._duration=e},reset:function(){this._startTime=-1,this._finished=!1,this._ratio=0,a.a.draw()},finished:function(){},interpolate:function(e,t,i){if(this._finished)return 1;this._startTime<0&&(this._startTime=e);var r=Math.min(this._duration,e-this._startTime),a=0===this._duration?1:r/this._duration;return this._ratio=a,(a>=1||0===this._duration)&&(this._finished=!0,this.finished(t,i)),a},update:function(e,t){return this.interpolate(t.getFrameStamp().getSimulationTime(),e,t),!0}}),t.a=o},function(e,t,i){"use strict";var r=i(15),a=i.n(r),n=i(7),o=i.n(n),s=i(0),u=(i.n(s),i(5)),l=i(47),c=i(457),h=i(1206),d=i(1207),p=i(1209),f=i(113),m=u.a.osg,g=1,_=function(){m.NodeVisitor.call(this,m.NodeVisitor.TRAVERSE_PARENTS),this._material=void 0,this._manager=void 0};m.createPrototypeObject(_,m.objectInherit(m.NodeVisitor.prototype,{setManager:function(e){this._manager=e},reset:function(){this.nodePath.length=0,this._material=void 0},apply:function(e){if(!this._material){var t=e.getStateSet();t&&(this._material=this._manager.getMaterialByStateSet(t)),this._material||this.traverse(e)}}}));var v=function(e,t){m.NodeVisitor.call(this),this._manager=e,this._useVertexAlpha=t,this._stackMaterial=[]};m.createPrototypeObject(v,m.objectInherit(m.NodeVisitor.prototype,{apply:function(e){var t=e.getStateSet(),i=t&&this._manager.getMaterialByStateSet(t);if(i&&this._stackMaterial.push(i),e instanceof m.Geometry&&this._stackMaterial.length>0){var r=this._stackMaterial[this._stackMaterial.length-1];e.getVertexAttributeList().Color&&(r.set("hasVertexColor",!0),!r.get("hasVertexAlpha")&&e.userDataMap.hasVertexAlpha&&(r.set("hasVertexAlpha",!0),r.set("vertexAlphaEnable",this._useVertexAlpha))),e.userDataMap&&(r.set("hasPoints",e.userDataMap.hasPoints),r.set("hasTriangles",e.userDataMap.hasTriangles),r.set("hasLines",e.userDataMap.hasLines)),r.get("geometryList").push(e)}this.traverse(e),i&&this._stackMaterial.pop()}}));var b=a.a.Model.extend({initialize:function(){this._materialByStateSetID={},this._materialNames={material_:0}},getImageCollection:function(){return this._imageCollection||u.a.osg.error("ImageCollection not initialized in MaterialManager, something is wrong"),this._imageCollection},setImageCollection:function(e){this._imageCollection=e},getMatcapCollection:function(){return this._matcapCollection||u.a.osg.error("matcapCollection not initialized in MaterialManager, somewhing wrong"),this._matcapCollection},setMatcapCollection:function(e){this._matcapCollection=e},setNewMaterial:function(e,t){this.attributes[e]=t;var i=t.get("stateSetID");void 0!==i&&(this._materialByStateSetID[i]=t)},addMaterial:function(e){var t=new h.a,i=this.getImageCollection();return t.setMaterialJSON(e,i),new d.a({model:t}),this.setNewMaterial(e.id,t),t},getMaterials:function(){return this.attributes},getMaterialStateID:function(e){if(void 0!==e._materialID)return e._materialID;var t=e.getUserData();if(t)for(var i=t.length-1;i>=0;--i)if("UniqueID"===t[i].Name){e._materialID=parseInt(t[i].Value,10);break}return void 0===e._materialID&&(void 0!==e._uniqueID?e._materialID=e._uniqueID:(u.a.osg.warn("v0 StateSet detected"),e._materialID=g++)),e._materialID},getMaterialByStateSetID:function(e){return void 0!==e?this._materialByStateSetID[e]:void 0},getMaterialByStateSet:function(e){return this.getMaterialByStateSetID(this.getMaterialStateID(e))},_deleteMaterialById:function(e){var t=this.attributes[e];t&&delete this._materialByStateSetID[t.get("stateSetID")],delete this.attributes[e]},removeMaterialByStateSetID:function(e){var t=this.attributes;for(var i in t)t[i].get("stateSetID")===e&&this._deleteMaterialById(i)},removeMaterialByStateSet:function(e){var t=this.attributes;for(var i in t){if(t[i].get("stateSet")===e)return void this._deleteMaterialById(i)}},removeUnboundMaterial:function(){var e=this.attributes;for(var t in e){e[t].get("stateSet")||this._deleteMaterialById(t)}},getMaxUvCount:function(){var e=this.attributes,t=0;for(var i in e){var r=e[i];if(!r.get("uidUniqueMerged")){var a=r.get("texCoordUnitList").length;a>t&&(t=a)}}return t},createMaterial:function(e,t){void 0===t&&(t=e.getOrCreateStateSet());var i=new h.a;new d.a({model:i});var r=Object(p.a)();return i.set("id",r),i.set("stateSetID",this.getMaterialStateID(t)),i.set("name",this.getUniqueMaterialName(t.getAttributeMap().Material,t,e)),this.setNewMaterial(r,i),i},getUniqueMaterialName:function(e,t,i){var r=this._materialNames,a=e&&e.getAttribute()?e.getAttribute().getName():void 0;return void 0===a&&(a=void 0!==t.getName()?t.getName():i.getName()),void 0===a?"material_"+r.material_++:(void 0===r[a]?r[a]=0:a+="_"+r[a]++,a)},setWorkFlowMetalSpec:function(e,t){var i=this.attributes;for(var r in i)i[r].setWorkFlowMetalSpec(e,t)},setWorkFlowRoughGloss:function(e,t){var i=this.attributes;for(var r in i)i[r].setWorkFlowRoughGloss(e,t)},overrideMaterialChannels:function(e){if(!Object(l.a)()&&e.materialShowcase){var t=e.materialDisplacement,i=e.materialDisplacementFactor,r=e.materialNormal,a=e.materialDiffuse,n=e.materialMetalness,o=e.materialRoughness,u=e.materialGlossiness,c=e.materialSpecular,h=e.materialEmissive,d=e.materialTransparency,p=e.materialCavity,f=e.materialAO,m=e.materialF0,g=e.materialNames||"main_material",_=g.split(";");if(e.substanceDisplacement&&void 0!==t){var v=this.attributes["ae605e73-2987-4b0f-b25b-bdf1dc02e6ed"];v||(v=Object(s.find)(this.attributes,function(e){return"Sides"===e.get("name")})),v&&this._replaceChannelURL(v.getChannels(),"Displacement",t,!0,i)}for(var b in this.attributes){var y=this.attributes[b];if(-1!==_.indexOf(y.get("name"))){var x=y.getChannels();a&&(this._replaceChannelURL(x,"DiffuseColor",a),this._replaceChannelURL(x,"AlbedoPBR",a),this._replaceChannelURL(x,"DiffusePBR",a)),void 0!==m&&(m.length?this._replaceChannelURL(x,"SpecularF0",m):(x.SpecularF0.reset(),x.SpecularF0.setFactor(.5))),void 0!==r&&this._replaceChannelURL(x,"NormalMap",r,!0),void 0!==t&&this._replaceChannelURL(x,"Displacement",t,!0,i),void 0!==p&&this._replaceChannelURL(x,"CavityPBR",p,!0),void 0!==h&&this._replaceChannelURL(x,"EmitColor",h,!0),void 0!==d&&this._replaceChannelURL(x,"Opacity",d,!0),void 0!==f&&(this._replaceChannelURL(x,"AOPBR",f,!0),this._replaceChannelURL(x,"DiffuseIntensity",f,!0)),(c||n)&&(this._replaceChannelURL(x,"SpecularPBR",c),this._replaceChannelURL(x,"MetalnessPBR",n),y.setWorkFlowMetalSpec(Boolean(n))),(o||u)&&(this._replaceChannelURL(x,"RoughnessPBR",o),this._replaceChannelURL(x,"GlossinessPBR",u),y.setWorkFlowRoughGloss(Boolean(o)))}}}},_replaceChannelURL:function(e,t,i,r,a){var n=e[t];if(!i||!i.length)return void n.setEnable(!1);var o=this.getImageCollection(),s=o.addNewImage({url:i,name:i,width:1,height:1});n.setupTextureModel({image:s}),r&&n.setEnable(!0),n.setFactor(void 0===a?1:a)},tagMaterialWithGeometryInfo:function(e,t){var i=new v(this,t);e.accept(i)},updateTexCoordUnitList:function(){var e=this.attributes;for(var t in e)e[t].updateTexCoordUnitList()},findFirstMaterial:function(){var e=new _;return function(t){var i=t.length,r=t[i-1];if(r._mostInfluencedRig)return e.reset(),e.setManager(this),r._mostInfluencedRig.accept(e),e._material;for(var a=i-1;a>=0;--a){var n=t[a].getStateSet();if(n){var o=this.getMaterialByStateSet(n);if(o)return o}}}}(),getJSON:function(){var e={},t=this.attributes;for(var i in t)e[i]=t[i].getJSON();return e},editorGetJSON:function(){var e={},t=this.getImageCollection(),i=this.getMatcapCollection();for(var r in this.attributes){var a=this.attributes[r].getJSON(),n=a.channels;for(var o in n){var s=n[o];if(s.texture){var u="Matcap"===o?i:t,l=u.get(s.texture.uid),c=l.get("name");s.texture.name=c,delete s.texture.uid,delete s.texture.texCoordUnit,delete s.texture.textureTarget}}e[r]={shadeless:a.shadeless,name:a.name,cullFace:a.cullFace,reflection:a.reflection,channels:n}}return e},editorSetJSON:function(e){var t=this.getImageCollection(),i=this.getMatcapCollection(),r=[];for(var a in this.attributes){var n=e[a];n&&r.push(function(e,r){for(var a=[],n=0,s=f.a.length;n<s;n++){var u=f.a[n],l=e.channels[u];if(l&&l.texture&&l.texture.name){var c="Matcap"===u?i:t,h=c.where({name:l.texture.name})[0];h?l.texture.uid=h.getUID():(e.channels[u]=void 0,a.push("texture "+l.texture.name+" not found in the current scene, skipping channel "+u+" for material "+r.get("name")))}}var d=r.setMaterialJSON(e,t,{validate:!0});return d?o.a.reject(d):o.a.resolve(a)}(n,this.attributes[a]))}return o.a.all(r)}});b.createMaterialModel=function(e){var t=new h.a;new d.a({model:t});var i=e.getName();return i&&t.set("name",i),(new c.a).setMaterialModel(t),t.setStateSet(e),t},t.a=b},function(e,t,i){"use strict";i.d(t,"b",function(){return x}),i.d(t,"a",function(){return S}),i.d(t,"d",function(){return M}),i.d(t,"c",function(){return b});var r=i(5),a=i(555),n=i(43),o=i(16),s=i(557),u=i(707),l=i(63),c=i(146),h=r.a.osg,d=Object(o.a)().shadow,p=Object(o.a)().shadowAtlas,f=p?7:12,m=Object(o.a)().shadowTextureSize;r.a.osgShadow.ShadowMap.prototype._preventTextureBindingDuringShadowCasting=function(){for(var e=Object(s.a)(),t=h.StateAttribute.OVERRIDE_ON,i=0;i<e;i++)this._casterStateSet.setTextureAttributeAndModes(i,h.Texture.textureNull,t)};var g,_,v,b=function(e){return g=new r.a.osgShadow.ShadowSettings,g.setLight(e),g.setShadowCastShaderGeneratorName("shadowcast"),g.setCastsShadowDrawTraversalMask(n.a.SHADOW),g.setCastsShadowBoundsTraversalMask(n.a.SHADOW_BOUNDS),g.userShadowCasterVisitor=!1,g.kernelSizePCF=Object(o.a)().shadowPCF,g.fakePCF=!1,g.setTextureSize(Object(o.a)().shadowTextureSize),g};p&&(_=b(),_.atlasSize=2*m,_.setTextureSize(m),v=new r.a.osgShadow.ShadowMapAtlas(_),v.setTextureUnitBase(f));var y=c.a.uShadowMapSize.getInternalArray();y[0]=m,y[1]=m;var x=function(e,t,i){var n=new h.MatrixTransform;n.setName(e+" - LightNode "+t),n.getOrCreateStateSet().setAttributeAndModes(l.a.DEPTH_DISABLE);var c=new a.a(t);i&&c.setLightType(i),c.setName(e+" - Light "+t),h.vec3.copy(c.getAmbient(),h.vec3.ZERO),h.vec3.copy(c.getSpecular(),h.vec3.ZERO),c.setLinearAttenuation(0);var p=new h.LightSource;if(p.setName("skfb"+e+" - LightSource "+t),p.setLight(c),!d)return{node:n,light:c,lightSource:p,shadowSettings:v?_:b(c),enableShadow:!1};var m,g;if(v?(g=_,m=v.addLight(c)):(g=b(c),m=new r.a.osgShadow.ShadowMap(g),m.setTextureUnitBase(f),m.setContinuousUpdate(!1),m.setTextureSize(Object(o.a)().shadowTextureSize)),m.setJitterOffset(Object(o.a)().shadowJitterOffset),Object(o.a)().stats){var y=m.getCamera(),x=u.a.getTimerGPU();y.setInitialDrawCallback(function(){x.start("ShadowMap"),x.start("ShadowMap"+t)}),y.setFinalDrawCallback(function(){x.end("ShadowMap"+t),x.end("ShadowMap")})}return{node:n,light:c,lightSource:p,shadowSettings:g,shadowMap:m,enableShadow:d&&Object(s.a)()>f}},S=function(e,t){d&&(t.setContinuousUpdate(!1),p?(e.addShadowTechnique(v),v.addShadowMap(t)):e.addShadowTechnique(t))},M=function(e,t){p?v.removeShadowMap(t):e.removeShadowTechnique(t)}},function(e,t,i){"use strict";var r=i(5),a=i(557),n=i(57),o=i(63),s=i(1234),u=r.a.osg,l=u.vec4.fromValues(1,1,1,0),c=function(e,t){return e._binNum-t._binNum},h=function(e,t){for(var i=t?t._parent:void 0,r=0;i;)i._stateset&&r++,i=i._parent;return r>1&&r--,e.getStateSetStackSize()-r},d=s.a.passTypes,p=s.a.forceAttribute,f=u.StateAttribute.OVERRIDE_ON,m=function(){var e=new u.StateSet;e.setShaderGeneratorName("earlyz",f);for(var t=Object(a.a)(),i=0;i<t;i++)e.setTextureAttributeAndModes(i,u.Texture.textureNull,f);return e}(),g=function(){u.RenderStage.apply(this,arguments),this._binArraySorted=[],g.prototype.init.call(this)},_=!0;g.setHasTriangles=function(e){_=e};var v;g.setTimerGPU=function(e){v=e},g.getTimerGPU=function(){return v};var b=u.vec4.create();g.getClearColor=function(){return b},u.createPrototypeObject(g,u.objectInherit(u.RenderStage.prototype,{constructor:g,init:function(){return u.RenderStage.prototype.init.call(this),this._binArraySorted.length=0,this._renderBufferDepthAttachment=void 0,this},isMainCamera:function(){var e=this.getCamera();return!(!e||"PostProcess - MainCamera"!==e.getName())},isShadowCasterCamera:function(){var e=this.getCamera(),t=e&&e.getName();return!(!t||!t.startsWith("light_shadow_camera"))},sortBinArray:function(){var e=this._binArraySorted;e.length=0;for(var t=this._bins.getKeys(),i=t.getLength(),r=t.getArray(),a=this._bins.getMap(),n=0;n<i;n++){var o=r[n];e.push(a[o])}e.sort(c)},drawTransparentBin:function(e,t){for(var i,r=t,a=this._binArraySorted,o=0,u=a.length,l=s.a.currentPass===d.EARLYZ_TRANSPARENT;o<u;o++){i=a[o];var c=i.getBinNumber();if(c!==n.a.TRANSPARENT){if(!l&&(c===n.a.TRANSPARENT_NO_EARLYZ_POST||c===n.a.TRANSPARENT_NO_EARLYZ_PRE)){var h=p.depth;p.depth=void 0,r=i.draw(e,r),p.depth=h}}else r=i.draw(e,r)}return r},drawOpaqueBin:function(e,t){for(var i,r=this.getDoEarlyZ(),a=t,o=this._binArraySorted,u=0,l=o.length;u<l&&(i=o[u],!(i.getBinNumber()>0));u++)a=i.draw(e,a);a=this.drawLeafs(e,a);for(var c=s.a.currentPass===d.OPAQUE_SHADING;u<l;u++){i=o[u];var h=i.getBinNumber();if(h===n.a.OPAQUE||h===n.a.REFRACTION||r&&h===n.a.TRANSPARENT)a=i.draw(e,a);else if(c&&h===n.a.OPAQUE_NO_EARLYZ){var f=p.depth;p.depth=void 0,s.a.currentPass=d.DEFAULT,a=i.draw(e,a),s.a.currentPass=d.OPAQUE_SHADING,p.depth=f}}return a},drawRefractionBin:function(e,t){for(var i,r=t,a=this._binArraySorted,o=0,s=a.length;o<s;o++){i=a[o];i.getBinNumber()===n.a.REFRACTION&&(r=i.draw(e,r))}return r},drawExtraBin:function(e,t){for(var i,r=t,a=this._binArraySorted,o=0,s=a.length;o<s;o++){i=a[o];i.getBinNumber()>=n.a.EXTRA&&(r=i.draw(e,r))}return r},bindDepthRTT:function(e){this.getCamera().fboDepth.apply(e)},bindTransparencyRTT:function(e){this.getCamera().fboTransparent.apply(e)},bindRefractionRTT:function(e){this.getCamera().fboRefraction.apply(e)},bindOpaqueRTT:function(e){this.getCamera().fboOpaque.apply(e)},bindExtraRTT:function(e){this.getCamera().fboExtra.apply(e)},createFBO:function(e,t){if(t){var i=new u.FrameBufferObject,r=this._renderBufferDepthAttachment;r||(r={attachment:u.FrameBufferObject.DEPTH_ATTACHMENT,format:u.FrameBufferObject.DEPTH_COMPONENT16,width:t.getWidth(),height:t.getHeight()},this._renderBufferDepthAttachment=r),i.setAttachment(r);var a={attachment:u.FrameBufferObject.COLOR_ATTACHMENT0,textureTarget:u.Texture.TEXTURE_2D,texture:t};return i.setAttachment(a),i.apply(e),i}},drawOpaqueShading:function(e,t){s.a.currentPass=d.OPAQUE_SHADING,p.depth=this.getDoEarlyZ()?o.a.DEPTH_EQUAL_NO_WRITE:o.a.DEPTH_LESS_WRITE,p.blend=o.a.BLEND_DISABLE;var i=this.drawOpaqueBin(e,t);return p.blend=void 0,p.depth=void 0,s.a.currentPass=d.DEFAULT,i},drawEarlyOpaque:function(e,t){s.a.currentPass=d.EARLYZ_OPAQUE,p.depth=o.a.DEPTH_LESS_WRITE,p.blend=o.a.BLEND_DISABLE,p.colorMask=this.isWritingDepth()?o.a.COLOR_MASK_RGBA:o.a.COLOR_MASK_NONE;var i=this.drawOpaqueBin(e,t);return p.colorMask=void 0,p.blend=void 0,p.depth=void 0,s.a.currentPass=d.DEFAULT,i},drawEarlyAlpha:function(e,t){s.a.currentPass=d.EARLYZ_TRANSPARENT,p.depth=o.a.DEPTH_LESS_NO_WRITE,p.colorMask=o.a.COLOR_MASK_ALPHA;var i=this.drawTransparentBin(e,t);return p.colorMask=void 0,p.depth=void 0,s.a.currentPass=d.DEFAULT,i},drawTransparentShading:function(e,t){s.a.currentPass=d.TRANSPARENT_SHADING,p.depth=o.a.DEPTH_LEQUAL_NO_WRITE,p.blend=o.a.BLEND_SUBSTRACTIVE;var i=this.drawTransparentBin(e,t);return p.blend=void 0,p.depth=void 0,s.a.currentPass=d.DEFAULT,i},drawRefractionShading:function(e,t){s.a.currentPass=d.REFRACTION,p.depth=o.a.DEPTH_LESS_WRITE,p.blend=o.a.BLEND_DISABLE;var i=this.drawRefractionBin(e,t);return p.blend=void 0,p.depth=void 0,s.a.currentPass=d.DEFAULT,i},drawExtra:function(e,t){s.a.currentPass=d.EXTRA;var i=this.drawExtraBin(e,t);return s.a.currentPass=d.DEFAULT,i},isWritingDepth:function(){return!!this.getCamera()._textureDepth},getDoEarlyZ:function(){return _||this.isWritingDepth()},drawImplementationSketchfab:function(e,t){var i=e.getGraphicContext(),r=t,a=this.getCamera(),n=!!a._textureDepth;if(n?(this.bindDepthRTT(e),e.clearColor(l)):(this.bindOpaqueRTT(e),e.clearColor(b)),e.depthMask(!0),e.clearDepth(this.getClearDepth()),e.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),this.getDoEarlyZ()){var s=h(e,r);e.insertStateSet(s,m),v.start("EarlyOpaque"),r=this.drawEarlyOpaque(e,r),v.end("EarlyOpaque"),n&&a._textureTransparent&&(v.start("EarlyTransparency"),r=this.drawEarlyAlpha(e,r),v.end("EarlyTransparency")),e.removeStateSet(s),e.applyAttribute(o.a.COLOR_MASK_RGBA)}return n&&(this.bindOpaqueRTT(e),e.clearColor(b),e.clear(i.COLOR_BUFFER_BIT)),v.start("ShadingOpaque"),r=this.drawOpaqueShading(e,r),v.end("ShadingOpaque"),e.clearColor(u.vec4.ZERO),a._textureTransparent&&(this.bindTransparencyRTT(e),e.clear(i.COLOR_BUFFER_BIT),v.start("ShadingTransparency"),r=this.drawTransparentShading(e,r),v.end("ShadingTransparency")),a._textureRefraction&&(this.bindRefractionRTT(e),e.clear(i.COLOR_BUFFER_BIT),v.start("ShadingRefraction"),r=this.drawRefractionShading(e,r),v.end("ShadingRefraction")),a._textureExtra&&(this.bindExtraRTT(e),e.clear(i.COLOR_BUFFER_BIT),v.start("Extra"),r=this.drawExtra(e,r),v.end("Extra")),r},drawImplementation:function(e,t){if(!this.isMainCamera()){this.isShadowCasterCamera()&&(s.a.currentPass=d.SHADOWMAP);var i=u.RenderStage.prototype.drawImplementation.call(this,e,t);return s.a.currentPass=d.DEFAULT,i}var r=this.getCamera();if(!r._textureOpaque)return t;r.fboOpaque||(r.fboOpaque=this.createFBO(e,r._textureOpaque)),r.fboTransparent||(r.fboTransparent=this.createFBO(e,r._textureTransparent)),r.fboDepth||(r.fboDepth=this.createFBO(e,r._textureDepth)),r.fboRefraction||(r.fboRefraction=this.createFBO(e,r._textureRefraction)),r.fboExtra||(r.fboExtra=this.createFBO(e,r._textureExtra));var a=this.getViewport();void 0===a&&u.log("RenderStage does not have a valid viewport"),e.applyAttribute(a),this._scissor&&e.applyAttribute(this._scissor),0!==this._positionedAttribute.getLength()&&this.applyPositionedAttribute(e,this._positionedAttribute),this.sortBinArray();var n=t;return v.start("Shading"),n=this.drawImplementationSketchfab(e,n),v.end("Shading"),n}}),"osgSketchfab","RenderStageSketchfab"),u.RenderBin.prototype.drawLeafs=function(e,t){for(var i,r=this.getStateGraphList(),a=r.getArray(),n=this._leafs,o=t,u=this.getStage().getViewport(),l=0;l<n.length;l++)i=n[l],s.a.LAST_LEAF=i,!i.isVR&&o&&o.isVR&&e.applyViewport(u),i.render(e,o),o=i;for(var c=r.getLength(),h=0;h<c;h++)for(var d=a[h],p=d._leafs.getArray(),f=d._leafs.getLength(),m=0;m<f;m++)i=p[m],s.a.LAST_LEAF=i,!i.isVR&&o&&o.isVR&&e.applyViewport(u),i.render(e,o),o=i;return o},t.a=g},function(e,t,i){"use strict";var r=i(5),a=r.a.osg,n={};n.base64=function(e,t){return"data:"+e+";base64,"+t},n.isMobile=function(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e},n.isFirefox=function(){return/firefox/i.test(navigator.userAgent)},n.isIOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},n.isIFrame=function(){try{return window.self!==window.top}catch(e){return!0}},n.appendQueryParameter=function(e,t,i){return e+=(e.indexOf("?")<0?"?":"&")+t+"="+i},n.getQueryParameter=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),i=t.exec(location.search);return null===i?"":decodeURIComponent(i[1].replace(/\+/g," "))},n.isLandscapeMode=function(){return 90===window.orientation||-90===window.orientation},n.getScreenWidth=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},n.getScreenHeight=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},n.projectionMatrixToVector_=function(e,t){var i=t||{},r=i.xScale||1,n=i.yScale||1,o=i.xTrans||0,s=i.yTrans||0,u=a.vec4.create();return u[0]=e[0]*r*.5,u[1]=e[5]*n*.5,u[2]=.5*(e[8]-1-o),u[3]=.5*(e[9]-1-s),u},n.leftProjectionVectorToRight_=function(e){return a.vec4.fromValues(e[0],e[1],-e[2]-1,e[3])},t.a=n},,function(e,t,i){"use strict";var r=i(3),a=i.n(r);t.a={onFullScreenChange:function(e){var t=a()(document);t.on("fullscreenchange",e),t.on("webkitfullscreenchange",e),t.on("MSFullscreenchange",e),t.on("mozfullscreenchange",e)},offFullScreenChange:function(e){var t=a()(document);t.off("fullscreenchange",e),t.off("webkitfullscreenchange",e),t.off("MSFullscreenchange",e),t.off("mozfullscreenchange",e)},hasFullscreen:function(){return document.fullscreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled||document.mozFullScreenEnabled},isFullscreen:function(){return document.fullScreen||document.mozFullScreen||void 0!==document.msFullscreenElement&&null!==document.msFullscreenElement||document.webkitIsFullScreen},requestFullscreen:function(e){e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen&&e.mozRequestFullScreen()},exitFullscreen:function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen&&document.mozCancelFullScreen()}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";var r=i(1005),a=i(1159),n=i(1188),o=i(1210),s=i(1213),u=i(1216),l=i(1220),c=i(1229),h=i(1239),d=i(1242),p=i(1254),f=i(1259),m=i(1302),g=i(1307),_=i(1329),v=i(1335),b=i(1340);t.a=[r.a,a.a,n.a,o.a,s.a,u.a,l.a,c.a,h.a,d.a,p.a,f.a,m.a,g.a,v.a,b.a,_.a]},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(3)),n=i.n(a),o=i(42),s=i.n(o),u=i(419),l=i.n(u),c=i(8),h=i(55),d=i(25),p=i(258),f=i(47),m=i(4),g=i(11),_=i(670),v=i(479),b=i(53),y=i(572),x=i(90),S=i(41),M=i(1356),w=i(1357),T=i(1358),C=i(875),E=i(1360),L=i(1361),P=i(1362),A=i(1363),D=i(1364),O=i(671),k=i(1365),R=i(1366),I=i(764),F=i(34),N=i(1367),V=i(877),B=i(16),U=i(710),j=i(136),G=i(614),Y=i(17),H=i(470),z=(i.n(H),Y.a.shortcuts),W=new l.a({device:"WEB",listen:!0});t.a=c.a.extend({subviews:{},events:{'click [data-action="start"]':"onStart",'click [data-action="stop"]':"onStop",click:"globalCloseEvent",touchend:"globalCloseEvent",'click [data-action="inspector"]':"toggleInspector"},templates:{viewerMode:m.default.getFromMacro("skfb_front/macros/viewer","help_viewer_mode"),viewerVr:m.default.getFromMacro("skfb_front/macros/viewer","help_vr_mode")},initialize:function(){c.a.prototype.initialize.apply(this,arguments),this.proxySettings=new S.a({shadingStyle:null,viewerMode:null,wireframeColor:null,wireframeEnable:null,hasWireframe:null,annotationsVisible:null,textureQuality:null,speed:null,cycleMode:null,fps:null}),this.initializeMandatorySubviews(),this.initializeHashMessages(),this.initializeSoundManager(),this.delegateGlobalMoveEvent(),this.delegateSubviews(),this.isVR()&&s.a.apple.device&&this.hackIosCanvasRender(),s.a.any||!_.a||Object(B.a)().transparent||this.hackDesktopSafariCanvasBackground()},_createSubview:function(e,t,i){return this.subviews[e]=new t(Object(r.extend)({},{viewer:this,widgets:this.subviews},i)),this.subviews[e]},globalCloseEvent:function(e){n()(e.target).hasClass("has-menu")||n()(e.target).parents(".has-menu").length||(this.subviews.hotspots&&this.subviews.hotspots.toggleAnnotationList(!1),this.subviews.gui.closeMenus())},delegateGlobalMoveEvent:function(){var e=function(e){"canvas"===e.target.tagName.toLowerCase()&&(clearTimeout(this._showGuiTimeout),clearTimeout(this._hideGuiTimeout),this._hideGuiTimeout=setTimeout(function(){this.$el.addClass("moving")}.bind(this),150))},t=function(e){"canvas"===e.target.tagName.toLowerCase()&&(clearTimeout(this._hideGuiTimeout),clearTimeout(this._showGuiTimeout),e.preventDefault(),this._showGuiTimeout=setTimeout(function(){this.$el.hasClass("moving")&&this.$el.removeClass("moving")}.bind(this),500))},i=function(e){var t=e.relatedTarget||e.toElement;s.a.any||(clearTimeout(this.globalIdleTimeout),this.$el.find(t).length||(this.globalIdleTimeout=setTimeout(this.onGlobalIdleTimeout.bind(this),3500)))},a=function(){clearTimeout(this.globalIdleTimeout),(this.$el.hasClass("idle")||this.$el.hasClass("moving"))&&(this.$el.removeClass("idle moving"),Object(r.each)(this.subviews,function(e){e.trigger("idle",!1)}))};if(!Object(f.a)()){var o;this.el.addEventListener("touchmove",this.preventScroll.bind(this),{passive:!1}),this.$el.on("mousedown touchstart",e.bind(this)),this.$el.on("mouseup touchend",t.bind(this)),this.$el.on("mousewheel",function(e){"canvas"===e.target.tagName.toLowerCase()&&(this.$el.addClass("moving"),clearTimeout(o),o=setTimeout(function(){this.$el.removeClass("moving")}.bind(this),300))}.bind(this)),n()(this.el).on("mouseout",i.bind(this)),n()(this.el).on("mouseenter mousein",a.bind(this))}},preventScroll:function(e){if(e.target.classList.contains("canvas"))return e.preventDefault();var t=void 0!==e.target.dataset.hotspotTarget;this.subviews&&this.subviews.helpOverlay&&!this.subviews.helpOverlay.isVisible()&&!t&&e.preventDefault()},onGlobalIdleTimeout:function(){Object(f.a)()||(this.$el.addClass("idle"),Object(r.each)(this.subviews,function(e){e.trigger("idle",!0)}))},initializeMandatorySubviews:function(){this._createSubview("gui",M.a,{el:this.$el}),this._createSubview("loading",w.a,{el:this.$(".loading-container"),color:Object(G.b)(Object(B.a)().uiColor)}),this._createSubview("hint",T.a,{el:this.$el,fallback:!Object(p.a)()}),this._createSubview("generalControls",C.a,{el:Object(p.a)()?this.$(".general-controls"):this.$(".fallback .controls"),fallback:!Object(p.a)()}),this._createSubview("header",E.a,{el:this.$(".titlebar")}),this._createSubview("snapshot",L.a,{el:this.$el}),this._createSubview("helpOverlay",P.a,{el:this.$(".help.overlay")}),this._createSubview("hotspotsOverlay",A.a,{el:this.$(".hotspots-overlay")}),this._createSubview("helperVrOverlay",O.a.extend({setUrl:function(e){this.$(".url").attr("href",e).text(e)}}),{el:this.$(".helper-vr-overlay")}),this._createSubview("osd",k.a,{el:this.$el})},initShortcuts:function(){this.viewerRenderingShortcuts=new v.a(z.viewerRendering),this.viewerRenderingShortcuts.on("toggleWireframe",function(){if(this.proxySettings.get("hasWireframe")){var e=!this.proxySettings.get("wireframeEnable");g.a.modelViewerWireframeShortcut(e),this.proxySettings.set("wireframeEnable",e)}}.bind(this)),this.viewerRenderingShortcuts.on("inspector",this.toggleInspector,this),this.viewerRenderingShortcuts.listen([this.viewerRenderingShortcuts.getShortcut("toggleWireframe"),this.viewerRenderingShortcuts.getShortcut("inspector")]),this.viewerRenderingShortcuts.on("defaultRenderingMode",function(){this.proxySettings.set("shadingStyle","lit")}.bind(this)),this.viewerRenderingShortcuts.on("shadelessRenderingMode",function(){this.proxySettings.set("shadingStyle","shadeless")}.bind(this)),this.viewerRenderingShortcuts.on("matcapRenderingMode",function(){this.proxySettings.set("shadingStyle","matcap")}.bind(this)),this.updateShorcuts()},updateShorcuts:function(){"lit"===this._currentModel.get("options").shading.type||Object(f.a)()?this.viewerRenderingShortcuts.listen([this.viewerRenderingShortcuts.getShortcut("defaultRenderingMode"),this.viewerRenderingShortcuts.getShortcut("shadelessRenderingMode"),this.viewerRenderingShortcuts.getShortcut("matcapRenderingMode")]):this.viewerRenderingShortcuts.stopListening(["defaultRenderingMode","shadelessRenderingMode","matcapRenderingMode"])},blurHotspots:function(){this.subviews.hotspots&&(this.subviews.hotspots.hideTooltips(),this.subviews.hotspots.currentHotspot=-1,this.subviews.hotspots.renderControl())},initializeHashMessages:function(){Object(B.a)().isApp&&W.on("message:vrMode",function(e){var t=parseInt(e.data.vrMode,10);this.blurHotspots(),this.scene.getFeatures().webVR.getModel().set("enable",!!t),e.removeFromHash()}.bind(this))},initializeHotspotsSubviews:function(e){var t=this;i.e(10).then(i.bind(null,1574)).then(function(i){var r=i.default,a=t.scene.getFeatures().hotspot,n=a.getModel();t._createSubview("hotspots",r,{el:t.$el,model:n,container:t.$(".hotspots"),fallback:!Object(p.a)()}),"function"==typeof e&&e()})},initializeAnimationSubviews:function(e){var t=this;i.e(18).then(i.bind(null,1575)).then(function(i){var r=i.default,a=t.scene.getFeatures().animation.getModel();t._createSubview("animationControls",r,{el:t.$(".animation-controls"),model:a,currentModel:t._currentModel,enabled:!t.isVR()}),"function"==typeof e&&e()})},delegateSubviews:function(){this.isVR()?(this.subviews.gui.disable(),this.subviews.header.disable()):(this.subviews.loading.on("loaded",setTimeout.bind(window,this.subviews.gui.enable.bind(this.subviews.gui),500)),this.subviews.header.enable()),this.subviews.loading.on("loaded",function(){Object(B.a)().transparent||this.$el.addClass("transparent-pattern")}.bind(this))},onStart:function(){this.start(),this._startTracked||(this._startTracked=!0)},start:function(e){return this.$el.addClass("started"),!0===e?g.a.modelEmbedAutostart(this._currentUid):g.a.modelEmbedPlayButtonClicked(this._currentUid),this.$el.hasClass("transparent")||this.$el.addClass("transparent-pattern"),this._options&&this.load(),this.scene&&this.scene.getViewerOSGJS&&this.scene.getViewerOSGJS().done()&&(this.scene.getViewerOSGJS().setDone(!1),this.scene.getViewerOSGJS().run()),y.a.setEnabled(!0),this.trigger("started"),this},onStop:function(){this.subviews.modelInspector&&(this.subviews.modelInspector.close(),n()(".summary").removeClass("shifted"),n()(".watermark").removeClass("shifted-watermark")),this.stop()},stop:function(){var e=this._currentModel?this._currentModel.get("uid"):this._currentUid;return g.a.modelEmbedStopButtonClicked(e),this.$el.removeClass("started"),this.scene&&this.scene.getViewerOSGJS&&this.scene.getViewerOSGJS().done()&&this.scene.getViewerOSGJS().setDone(!0),this.subviews.hotspots&&this.subviews.hotspots.triggerHotspotCycle(!1),y.a.setEnabled(!1),this.trigger("stopped"),this},load:function(){if(this._options){var e=this._options;this._options=null,this.scene&&(this.scene.drop(),this.scene=null),this.subviews.loading.reset(),this.$el.removeClass("model-loaded"),this.$el.addClass("model-loading"),S.a.get(e.uid).then(this.onModelLoad.bind(this,e))}},lookat:function(e,t,i){void 0===i&&(i=1);var r=this.scene.getFeatures(),a=r.camera.getModel();a.set("animationDuration",i),a.setTargetAndEye(t,e)},isVR:function(){return this.scene?this.scene.getFeatures().webVR.getModel().get("enable"):Object(B.a)().cardboard>0},isCardboard:function(){return Object(B.a)().cardboard>0},onModelLoad:function(e,t){j.a.client.setTagsContext({frontend:"3d"}),this._currentModel=t,t.hit();var i=this.scene=this.createScene(t,e);if(this.subviews.loading.handleLoading({model:t,scene:i}),i.run(),!Object(p.a)())return void this.$el.addClass("fallback-mode");this.initShortcuts(),this.initViewerFeatures(),this.subviews.hint.show(),this.trigger("model-loaded"),j.a.client.setTagsContext({frontend:"web"})},errorHandler:function(e){if(e instanceof d.c){var t,i,a,n,o,s=Object(x.e)(e.account);switch(e.feature){case"sound":i="sound track",a="sounds",o=Object(x.b)(e.account);break;case"hotspot":i="annotation",a="annotations",o=Object(x.a)(e.account);break;default:throw e}o?(n=["You have reached the maximum number of <b>"+i+"s</b> allowed by Sketchfab.","Have custom needs?"],t={href:"mailto:{{ ENTERPRISE_ADDRESS }}?Subject=Custom needs - "+i,text:"Contact us"}):(n=["You have reached the maximum number of <b>"+e.limitReached+" "+i+b.f(e.limitReached)+"</b> allowed by your plan.","To add a new "+i+", you need to upgrade to "+s+" plan."],t={href:"/plans",text:"Upgrade to "+s}),new I.a(Object(r.extend)(e,{popupSubTitle:"You cannot add a new "+i,popupMessages:n,additionalButton:t,popupImg:a})).open()}else this.subviews.osd.show(e.message,arguments)},setScene:function(e){if(this.scene)throw new Error("It is currently impossible to reset a scene");return this._options=e,this._currentUid=e.uid,this},createScene:function(e,t){if(Object(p.a)()){var i={};return i.el=this.$(".webgl"),i.features=t.features,i.widgetAPI=t.widgetAPI,i.model=e,i.viewerAPI=t.viewerAPI,F.a.getPolygon().then(function(e){g.a.modelViewerPolygonLoaded(e.time)}),F.a.getWireframe().then(function(e){g.a.modelViewerWireframeLoaded(e.time)}),F.a.getLowResLoaded().then(function(e){g.a.modelViewerLowResTexturesLoaded(e.time,e.count)}),F.a.getHighResLoaded().then(function(e){g.a.modelViewerHighResTexturesLoaded(e.time,e.count)}),F.a.getModelDisplayed().then(function(e){g.a.modelViewerModelDisplayed(e.time)}),new V.a(i)}return g.a.modelViewerFallbackDisplayed(e.get("uid")),new N.a({model:e,el:this.$(".fallback"),features:t.features})},initViewerFeatures:function(){this.initializeSound(),F.a.getModelDisplayed().then(function(){F.a.getHasAnimation().then(function(e){e&&this.initializeAnimation()}.bind(this)),this.initializeHotspots(),this.initializeShading(),this.initializeViewerMode(),this.initializeTextureQuality(),this.initializeVr(),this.initializeModelInspector()}.bind(this))},initializeHotspots:function(){var e=this.scene.getFeatures().hotspot,t=e&&e.getModel();t&&this.initializeHotspotsSubviews(function(){var e=this.subviews.hotspots;t.setUpdateCallback(e.refreshHotspots.bind(e));var i=t.get("hotspots");i.on("add remove sort change:title change:description change:position",e.refreshHotspots,e),i.on("add remove sort change:name",e.updateHotspotsControls,e),i.on("add remove",Object(r.debounce)(this.subviews.generalControls.renderSettings,100),this.subviews.generalControls),i.on("select",e.onHotspotSelected,e),i.on("add",e.showAnnotations,e),i.on("remove",function(){0===i.length&&e.hideAnnotations()}),this.proxySettings.on("change:annotationsVisible",function(){i.length&&this.proxySettings.get("annotationsVisible")?e.showAnnotations():e.hideAnnotations()}.bind(this)),this.proxySettings.set("annotationsVisible",t.get("visible"),{silent:!0}),e.updateHotspotsControls(),F.a.getFirstCameraAnimation().then(function(){if(e.refreshHotspots(),t.on("hotspot-error",this.errorHandler.bind(this)),!0===Object(B.a)().annotationCycleAutostart){var r=Math.max(Object(B.a)().annotation,1);i.trigger("select",i.at(r-1)),this.subviews.hotspots.triggerHotspotCycle(!0)}else Object(B.a)().annotation>0&&i.trigger("select",i.at(Object(B.a)().annotation-1))}.bind(this))}.bind(this))},initializeAnimation:function(){var e=this.scene.getFeatures().animation,t=e.getModel();this.initializeAnimationSubviews(function(){this.$el.addClass("has-animation"),this.subviews.generalControls.setHasAnimations(!0),this.proxySettings.set("speed",t.get("speed")),this.proxySettings.set("cycleMode",t.get("cycleMode")),this.proxySettings.set("fps",t.get("fps")),this.proxySettings.on("change:speed",function(e,i){t.set("speed",i)}),this.proxySettings.on("change:cycleMode",function(e,i){t.set("cycleMode",i)}),this.proxySettings.on("change:fps",function(e,i){t.set("fps",i)}),t.on("change:fps",function(e,t){this.proxySettings.set("fps",t)}.bind(this)),this.$(".osd").addClass("padded"),this.$(".timeline").removeClass("disabled")}.bind(this))},isFeatureAvailable:function(e,t,i){return e&&t&&0!==i.length},initializeModelInspector:function(){var e=this.scene.getFeatures().inspector,t=this.proxySettings,i=this.$(".model-inspector");if(!this.isFeatureAvailable(Object(B.a)().uiInspector,e,i))return void this.$('[data-action="inspector"]').hide();var r=e.getModel();this._createSubview("modelInspector",D.a,{model:r,inspectableTextures:Object(f.a)()||this.scene.model.get("isInspectable"),wireframeModel:t,osd:this.subviews.osd,el:i}),Object(B.a)().uiInspectorOpen&&this.toggleInspector(),this.subviews.generalControls.listenTo(r,"change:uiVisible",function(e,t){this.$('[data-action="inspector"]').toggleClass("active",t),n()(".summary").toggleClass("shifted",t),n()(".controls").toggleClass("shifted",t)}.bind(this)),Object(f.a)()&&this.listenTo(r,"change:uiVisible",function(e,t){var i=this.scene._widgetAPI,r=this.subviews.modelInspector.model;t?(r.initAvailableView(),i.alert("To edit the model, close the Inspector.",{continue:!0,continueLabel:"Close Inspector"}).then(function(){this.$("canvas").focus(),this.toggleInspector()}.bind(this)).catch(function(e){if("Resuming editor"!==e)throw e})):i.resume()}.bind(this))},toggleInspector:function(){this.subviews.modelInspector&&(g.a.modelViewerInspectorButtonClicked(),this.subviews.modelInspector.toggle(),this.subviews.snapshot.$(".snapshot.widget").toggle(),this.subviews.header.$(".actions").toggle())},initializeTextureQuality:function(){var e=this,t=this.scene.getFeatures().quality;if(t){var i=t.getModel();i.get("promiseReady").then(function(e){this.subviews.generalControls.generateTextureQualitySettings(e),this.subviews.generalControls.settings.onTextureQualityReady.call(this.subviews.generalControls.settings,e)}.bind(this)),this.proxySettings.on("change:textureQuality",function(){var t=parseInt(this.get("textureQuality"),10);window.requestAnimationFrame(function(){i.set("level",t)});var r=e.subviews.generalControls.getSettingLabelForValue("textureQuality",t+"");e.$(".control-badge").text(r).addClass("active")})}},initializeViewerMode:function(){var e=this.scene.getFeatures().camera;if(e){var t=e.getModel(),i=t.get("indexManipulator");this.proxySettings.set("viewerMode",i),this.subviews.gui.renderSetting("viewerMode",i),this.proxySettings.on("change:viewerMode",function(){t.set("indexManipulator",parseInt(this.proxySettings.get("viewerMode"),10)),this.scene.getFeaturesManager().focusOnSavedCamera(1),this.$("canvas").focus()}.bind(this))}},initializeShading:function(){var e=this.scene.getFeatures().shadingStyle;if(e){var t=e.getModel(),i=this,r=function(){i.proxySettings.set("shadingStyle",t.get("type")),i.proxySettings.set("wireframeColor",t.get("wireframeColor")),i.proxySettings.set("wireframeEnable",t.get("wireframeEnable")),i.proxySettings.set("hasWireframe",t.get("hasWireframe")),i.subviews.gui.renderSetting("wireframeColor",i.proxySettings.get("wireframeColor")),i.subviews.gui.renderSetting("wireframeEnable",i.proxySettings.get("wireframeEnable")?1:0),i.subviews.gui.renderSetting("hasWireframe",i.proxySettings.get("hasWireframe")?1:0),i.subviews.gui.renderSetting("shadingStyle",i.proxySettings.get("shadingStyle"))};r(),this.proxySettings.listenTo(t,"change",r),this.proxySettings.on("change:shadingStyle",function(){t.set("type",this.get("shadingStyle"))}),this.proxySettings.on("change:wireframeColor",function(){this.get("wireframeEnable")?t.setWireframeColorSmooth(this.get("wireframeColor")):t.set("wireframeColor",this.get("wireframeColor"))}),this.proxySettings.on("change:wireframeEnable",function(){t.set("wireframeEnable",!!this.get("wireframeEnable"))})}},initializeVr:function(){if(this.isVR()){this.$el.addClass("vr-mode");if(1===h.a.get("show_vr_hint",1)){var e=this.templates.viewerVr([U.a.hasFullscreen()]);this.subviews.osd.show(e,{duration:5e3})}h.a.set("show_vr_hint",0,{expires:504e5})}else Object(B.a)().vrLinkNavigation&&this.subviews.osd.show(s.a.any?"Tap on Screen or Press any button to switch to VR":"Press Enter to switch to VR",{duration:5e3})},initializeSoundManager:function(){this.proxySettings.on("sound-error",this.errorHandler.bind(this)),this.proxySettings.on("sound-hide",this.subviews.osd.hide.bind(this.subviews.osd)),this.proxySettings.on("sound-show",this.subviews.osd.show.bind(this.subviews.osd)),y.a.setProxyModel(this.proxySettings)},initializeSound:function(){var e=this.scene.getFeatures().sound;if(e){var t=e.getModel(),i=t.get("soundtracks"),r=this._createSubview("sound",R.a,{el:this.$(".general-controls .volume"),model:t});i.on("add",r.show,r),i.on("remove",function(){0===i.length&&r.hide()}),i.length&&t.get("visible")&&r.show(),t.on("sound-error",this.errorHandler.bind(this))}},hackDesktopSafariCanvasBackground:function(){this.$("canvas").parent().css({backgroundColor:"#000"})},hackIosCanvasRender:function(){Object(r.defer)(function(){n()("canvas")[0].style.width=n()("canvas")[0].clientWidth+1+"px",Object(r.defer)(function(){n()("canvas")[0].style.width=n()("canvas")[0].clientWidth-1+"px",n()("canvas")[0].style.width=""})})}})},function(e,t,i){e.exports=i.p+"sketchfab-logo-white-23404398f711fe3ef715025c76e98bd2.svg"},function(e,t,i){e.exports=i.p+"sketchfab-logo-8bc6696c7ed7369e1acaee4ec5168169.png"},,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";t.a=function(e,t){var i,r,a=e.length,n=t.length,o=[];if(!a)return n;if(!n)return a;for(i=0;i<=a;i++)o[i]=[i];for(r=0;r<=n;r++)o[0][r]=r;for(r=1;r<=n;r++)for(i=1;i<=a;i++)e[i-1]===t[r-1]?o[i][r]=o[i-1][r-1]:o[i][r]=Math.min(o[i-1][r],o[i][r-1],o[i-1][r-1])+1;return o[a][n]}},function(e,t,i){"use strict";t.a=function(e){return e=e.substring(e.lastIndexOf("/")+1),e=e.split("."),e=e[e.length>1?e.length-2:e.length-1],e.split("_").pop().toLowerCase()}},function(e,t,i){"use strict";var r=i(255),a=i(260),n=i(4),o=i(13),s=i(2),u=o.a.extend({displayName:"UpgradePlanPopupContent",optionTypes:{popupSubTitle:s.b.string.isRequired},events:{"click .upgrade-additional-callback":"additionalButtonCallback"},additionalButtonCallback:function(){this.options.additionalButton&"function"==typeof this.options.additionalButton.callback&&this.options.additionalButton.callback.apply(this,arguments)},template:function(){return n.default.getFromString('            {% if options.popupImg %}<div class="illustration --{{ options.popupImg }}"></div>{% endif %}            <p class="title">{{ options.popupSubTitle }}</p>            <div class="infos">                {% for message in options.popupMessages %}                    <p>{{message|safe}}</p>                {% endfor %}            </div>            <div class="actions">                {% if options.nextPlan %}                    <div class="btn-wrapper">                        <a class="button btn-huge btn-important upgrade-link" href="/plans" target="_blank">Upgrade to {{ options.nextPlan }}</a>                    </div>                {% endif %}                {% if options.additionalButton %}                    <div class="btn-wrapper">                        <a class="button btn-large btn-primary upgrade-additional-callback"                        {% if options.additionalButton.href %}href="{{ options.additionalButton.href }}" target="_blank"{% endif %}>{{ options.additionalButton.text }}</a>                    </div>                {% endif %}            </div>            ',{options:this.options})}});t.a=Object(r.a)(o.a.extend({template:function(){return n.default.getFromString("{{ components.popup | component }}",{components:this.createChildrenComponents({popup:{viewClass:a.a,options:{title:"",className:"upgrade-plan-popup",child:{viewClass:u,options:{popupImg:this.options.popupImg,popupSubTitle:this.options.popupSubTitle,popupMessages:this.options.popupMessages,nextPlan:this.options.nextPlan,additionalButton:this.options.additionalButton}}}}})})}}))},,,,,,,function(e,t,i){"use strict";var r=i(1008),a=i.n(r);t.a={name:a.a.name,version:a.a.version,author:a.a.author}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(673),a=i(1017),n=i(1018),o=i(247),s=i(215),u=i(448),l=i(128),c=i(674),h=i(142),d=i(1019),p=i(584),f=i(543),m=i(450),g=i(778),_=i(544),v=i(779),b=i(545),y=i(249),x=i(785),S=i(185),M=i(183),w=i(1024),T=i(248),C=i(786),E=i(121),L=i(10),P=i(397),A=i(449),D=i(1025),O=i(787),k=i(1026),R=i(548),I=i(677),F=i(1027),N=i(678),V=i(788),B=i(447),U=i(143),j=i(216),G=i(184),Y=i(587),H=i(98),z=i(54),W=i(21),q=i(71),X=i(585),J=i(679),K=i(675),$=i(1028),Q=i(451),Z=i(1029),ee=i(681),te=i(99),ie=i(186),re=i(676),ae=i(546),ne=i(780),oe=i(589),se=i(217),ue=i(399),le=i(791),ce=i(792),he=i(58),de=i(588),pe=i(182),fe=i(781),me=i(84),ge=i(1045),_e=i(214),ve=i(1046),be=i(72),ye=i(793),xe=i(9),Se=i(417),Me=i(682),we=i(127),Te=i(213),Ce=i(794),Ee=i(586),Le=i(246),Pe={};Pe.AutoTransform=r.a,Pe.BillboardAttribute=a.a,Pe.BlendColor=n.a,Pe.BlendFunc=o.a,Pe.BoundingBox=s.a,Pe.BoundingSphere=u.a,Pe.BufferArray=l.a,Pe.BufferArrayProxy=c.a,Pe.ColorMask=d.a,Pe.Camera=h.a,Pe.ColorMask=d.a,Pe.ComputeBoundsVisitor=p.default,xe.a.objectMix(Pe,f.a),Pe.CullFace=m.a,Pe.CullingSet=g.a,Pe.CullSettings=_.a,Pe.CullStack=v.a,Pe.CullVisitor=b.a,Pe.Depth=y.a,Pe.DrawArrayLengths=x.a,Pe.DrawArrays=S.a,Pe.DrawElements=M.a,Pe.EllipsoidModel=w.a,Pe.WGS_84_RADIUS_EQUATOR=w.a.WGS_84_RADIUS_EQUATOR,Pe.WGS_84_RADIUS_POLAR=w.a.WGS_84_RADIUS_POLAR,Pe.FrameBufferObject=T.a,Pe.FrameStamp=C.a,Pe.Geometry=E.a,Pe.GLObject=P.a,Pe.Image=A.a,Pe.ImageStream=D.a,Pe.KdTree=O.a,Pe.KdTreeBuilder=k.a,Pe.Light=R.a,Pe.LightSource=I.a,Pe.LineWidth=F.a,Pe.Lod=N.a,Pe.Material=V.default,xe.a.objectMix(Pe,B.a),Pe.MatrixTransform=U.a,Pe.PooledResource=j.a,Pe.PooledArray=G.a,Pe.PooledMap=Y.a,Pe.Node=H.a,Pe.NodeVisitor=z.a,xe.a.objectMix(Pe,W.a),Pe.Object=q.a,Pe.Options=X.a,Pe.PagedLOD=J.a,Pe.Plane=Q.a,Pe.PointSizeAttribute=$.a,Pe.Polytope=K.a,Pe.primitiveSet=te.a,Pe.primitiveFunctor=Z.a,Pe.primitiveIndexFunctor=ee.a,Pe.Program=ie.a,Pe.Projection=re.a,Pe.RenderBin=ae.a,Pe.RenderLeaf=ne.a,Pe.RenderStage=oe.a,Pe.Shader=se.a,xe.a.objectMix(Pe,ue.a),Pe.StackObjectPairPool=le.a,Pe.State=ce.a,Pe.StateAttribute=he.a,Pe.StateGraph=de.a,Pe.StateSet=pe.a,Pe.Scissor=Me.a,Pe.Switch=fe.a,Pe.Texture=me.default,Pe.TextureCubeMap=ge.a,Pe.Transform=_e.a,Pe.TriangleIndexFunctor=ve.a,Pe.Uniform=be.a,Pe.UpdateVisitor=ye.a,xe.a.objectMix(Pe,xe.a),Pe.Viewport=Se.a,Pe.VertexArrayObject=Ee.a,Pe.vec2=L.a.vec2,Pe.vec3=L.a.vec3,Pe.vec4=L.a.vec4,Pe.quat=L.a.quat,Pe.mat3=L.a.mat3,Pe.mat4=L.a.mat4,Pe.Transform.RELATIVE_RF=we.a.RELATIVE_RF,Pe.Transform.ABSOLUTE_RF=we.a.ABSOLUTE_RF,Pe.Timer=Te.a,Pe.TimerGPU=Ce.a,Pe.WebGLCaps=Le.a,t.default=Pe},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=[],a=function(e,t){r[e]=t},n=function(e){return r[e]};t.default={applyFunctionArray:r,registerApplyFunction:a,getApplyFunction:n}},function(e,t,i){var r=i(245),a={};a.create=function(){var e=new r.ARRAY_TYPE(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},a.clone=function(e){var t=new r.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},a.fromValues=function(e,t,i,a,n,o,s,u,l){var c=new r.ARRAY_TYPE(9);return c[0]=e,c[1]=t,c[2]=i,c[3]=a,c[4]=n,c[5]=o,c[6]=s,c[7]=u,c[8]=l,c},a.set=function(e,t,i,r,a,n,o,s,u,l){return e[0]=t,e[1]=i,e[2]=r,e[3]=a,e[4]=n,e[5]=o,e[6]=s,e[7]=u,e[8]=l,e},a.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.transpose=function(e,t){if(e===t){var i=t[1],r=t[2],a=t[5];e[1]=t[3],e[2]=t[6],e[3]=i,e[5]=t[7],e[6]=r,e[7]=a}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},a.invert=function(e,t){var i=t[0],r=t[1],a=t[2],n=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],h=c*o-s*l,d=-c*n+s*u,p=l*n-o*u,f=i*h+r*d+a*p;return f?(f=1/f,e[0]=h*f,e[1]=(-c*r+a*l)*f,e[2]=(s*r-a*o)*f,e[3]=d*f,e[4]=(c*i-a*u)*f,e[5]=(-s*i+a*n)*f,e[6]=p*f,e[7]=(-l*i+r*u)*f,e[8]=(o*i-r*n)*f,e):null},a.adjoint=function(e,t){var i=t[0],r=t[1],a=t[2],n=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8];return e[0]=o*c-s*l,e[1]=a*l-r*c,e[2]=r*s-a*o,e[3]=s*u-n*c,e[4]=i*c-a*u,e[5]=a*n-i*s,e[6]=n*l-o*u,e[7]=r*u-i*l,e[8]=i*o-r*n,e},a.determinant=function(e){var t=e[0],i=e[1],r=e[2],a=e[3],n=e[4],o=e[5],s=e[6],u=e[7],l=e[8];return t*(l*n-o*u)+i*(-l*a+o*s)+r*(u*a-n*s)},a.multiply=function(e,t,i){var r=t[0],a=t[1],n=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],d=i[0],p=i[1],f=i[2],m=i[3],g=i[4],_=i[5],v=i[6],b=i[7],y=i[8];return e[0]=d*r+p*o+f*l,e[1]=d*a+p*s+f*c,e[2]=d*n+p*u+f*h,e[3]=m*r+g*o+_*l,e[4]=m*a+g*s+_*c,e[5]=m*n+g*u+_*h,e[6]=v*r+b*o+y*l,e[7]=v*a+b*s+y*c,e[8]=v*n+b*u+y*h,e},a.mul=a.multiply,a.translate=function(e,t,i){var r=t[0],a=t[1],n=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],d=i[0],p=i[1];return e[0]=r,e[1]=a,e[2]=n,e[3]=o,e[4]=s,e[5]=u,e[6]=d*r+p*o+l,e[7]=d*a+p*s+c,e[8]=d*n+p*u+h,e},a.rotate=function(e,t,i){var r=t[0],a=t[1],n=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],d=Math.sin(i),p=Math.cos(i);return e[0]=p*r+d*o,e[1]=p*a+d*s,e[2]=p*n+d*u,e[3]=p*o-d*r,e[4]=p*s-d*a,e[5]=p*u-d*n,e[6]=l,e[7]=c,e[8]=h,e},a.scale=function(e,t,i){var r=i[0],a=i[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=a*t[3],e[4]=a*t[4],e[5]=a*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},a.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},a.fromRotation=function(e,t){var i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=0,e[3]=-i,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},a.fromQuat=function(e,t){var i=t[0],r=t[1],a=t[2],n=t[3],o=i+i,s=r+r,u=a+a,l=i*o,c=r*o,h=r*s,d=a*o,p=a*s,f=a*u,m=n*o,g=n*s,_=n*u;return e[0]=1-h-f,e[3]=c-_,e[6]=d+g,e[1]=c+_,e[4]=1-l-f,e[7]=p-m,e[2]=d-g,e[5]=p+m,e[8]=1-l-h,e},a.normalFromMat4=function(e,t){var i=t[0],r=t[1],a=t[2],n=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],_=t[15],v=i*s-r*o,b=i*u-a*o,y=i*l-n*o,x=r*u-a*s,S=r*l-n*s,M=a*l-n*u,w=c*m-h*f,T=c*g-d*f,C=c*_-p*f,E=h*g-d*m,L=h*_-p*m,P=d*_-p*g,A=v*P-b*L+y*E+x*C-S*T+M*w;return A?(A=1/A,e[0]=(s*P-u*L+l*E)*A,e[1]=(u*C-o*P-l*T)*A,e[2]=(o*L-s*C+l*w)*A,e[3]=(a*L-r*P-n*E)*A,e[4]=(i*P-a*C+n*T)*A,e[5]=(r*C-i*L-n*w)*A,e[6]=(m*M-g*S+_*x)*A,e[7]=(g*y-f*M-_*b)*A,e[8]=(f*S-m*y+_*v)*A,e):null},a.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},a.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},a.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e},a.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e},a.sub=a.subtract,a.multiplyScalar=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e},a.multiplyScalarAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e[4]=t[4]+i[4]*r,e[5]=t[5]+i[5]*r,e[6]=t[6]+i[6]*r,e[7]=t[7]+i[7]*r,e[8]=t[8]+i[8]*r,e},a.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},a.equals=function(e,t){var i=e[0],a=e[1],n=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],d=t[0],p=t[1],f=t[2],m=t[3],g=t[4],_=t[5],v=e[6],b=t[7],y=t[8];return Math.abs(i-d)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(a-p)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(n-f)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(o-m)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(s-g)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(u-_)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(_))&&Math.abs(l-v)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(v))&&Math.abs(c-b)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(h-y)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(y))},e.exports=a},function(e,t,i){var r=i(245),a={};a.create=function(){var e=new r.ARRAY_TYPE(3);return e[0]=0,e[1]=0,e[2]=0,e},a.clone=function(e){var t=new r.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.fromValues=function(e,t,i){var a=new r.ARRAY_TYPE(3);return a[0]=e,a[1]=t,a[2]=i,a},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},a.set=function(e,t,i,r){return e[0]=t,e[1]=i,e[2]=r,e},a.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},a.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e},a.sub=a.subtract,a.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e},a.mul=a.multiply,a.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e},a.div=a.divide,a.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},a.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},a.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e},a.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e},a.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},a.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},a.scaleAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e},a.distance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1],a=t[2]-e[2];return Math.sqrt(i*i+r*r+a*a)},a.dist=a.distance,a.squaredDistance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1],a=t[2]-e[2];return i*i+r*r+a*a},a.sqrDist=a.squaredDistance,a.length=function(e){var t=e[0],i=e[1],r=e[2];return Math.sqrt(t*t+i*i+r*r)},a.len=a.length,a.squaredLength=function(e){var t=e[0],i=e[1],r=e[2];return t*t+i*i+r*r},a.sqrLen=a.squaredLength,a.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},a.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},a.normalize=function(e,t){var i=t[0],r=t[1],a=t[2],n=i*i+r*r+a*a;return n>0&&(n=1/Math.sqrt(n),e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n),e},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},a.cross=function(e,t,i){var r=t[0],a=t[1],n=t[2],o=i[0],s=i[1],u=i[2];return e[0]=a*u-n*s,e[1]=n*o-r*u,e[2]=r*s-a*o,e},a.lerp=function(e,t,i,r){var a=t[0],n=t[1],o=t[2];return e[0]=a+r*(i[0]-a),e[1]=n+r*(i[1]-n),e[2]=o+r*(i[2]-o),e},a.hermite=function(e,t,i,r,a,n){var o=n*n,s=o*(2*n-3)+1,u=o*(n-2)+n,l=o*(n-1),c=o*(3-2*n);return e[0]=t[0]*s+i[0]*u+r[0]*l+a[0]*c,e[1]=t[1]*s+i[1]*u+r[1]*l+a[1]*c,e[2]=t[2]*s+i[2]*u+r[2]*l+a[2]*c,e},a.bezier=function(e,t,i,r,a,n){var o=1-n,s=o*o,u=n*n,l=s*o,c=3*n*s,h=3*u*o,d=u*n;return e[0]=t[0]*l+i[0]*c+r[0]*h+a[0]*d,e[1]=t[1]*l+i[1]*c+r[1]*h+a[1]*d,e[2]=t[2]*l+i[2]*c+r[2]*h+a[2]*d,e},a.random=function(e,t){t=t||1;var i=2*r.RANDOM()*Math.PI,a=2*r.RANDOM()-1,n=Math.sqrt(1-a*a)*t;return e[0]=Math.cos(i)*n,e[1]=Math.sin(i)*n,e[2]=a*t,e},a.transformMat4=function(e,t,i){var r=t[0],a=t[1],n=t[2],o=i[3]*r+i[7]*a+i[11]*n+i[15];return o=o||1,e[0]=(i[0]*r+i[4]*a+i[8]*n+i[12])/o,e[1]=(i[1]*r+i[5]*a+i[9]*n+i[13])/o,e[2]=(i[2]*r+i[6]*a+i[10]*n+i[14])/o,e},a.transformMat3=function(e,t,i){var r=t[0],a=t[1],n=t[2];return e[0]=r*i[0]+a*i[3]+n*i[6],e[1]=r*i[1]+a*i[4]+n*i[7],e[2]=r*i[2]+a*i[5]+n*i[8],e},a.transformQuat=function(e,t,i){var r=t[0],a=t[1],n=t[2],o=i[0],s=i[1],u=i[2],l=i[3],c=l*r+s*n-u*a,h=l*a+u*r-o*n,d=l*n+o*a-s*r,p=-o*r-s*a-u*n;return e[0]=c*l+p*-o+h*-u-d*-s,e[1]=h*l+p*-s+d*-o-c*-u,e[2]=d*l+p*-u+c*-s-h*-o,e},a.rotateX=function(e,t,i,r){var a=[],n=[];return a[0]=t[0]-i[0],a[1]=t[1]-i[1],a[2]=t[2]-i[2],n[0]=a[0],n[1]=a[1]*Math.cos(r)-a[2]*Math.sin(r),n[2]=a[1]*Math.sin(r)+a[2]*Math.cos(r),e[0]=n[0]+i[0],e[1]=n[1]+i[1],e[2]=n[2]+i[2],e},a.rotateY=function(e,t,i,r){var a=[],n=[];return a[0]=t[0]-i[0],a[1]=t[1]-i[1],a[2]=t[2]-i[2],n[0]=a[2]*Math.sin(r)+a[0]*Math.cos(r),n[1]=a[1],n[2]=a[2]*Math.cos(r)-a[0]*Math.sin(r),e[0]=n[0]+i[0],e[1]=n[1]+i[1],e[2]=n[2]+i[2],e},a.rotateZ=function(e,t,i,r){var a=[],n=[];return a[0]=t[0]-i[0],a[1]=t[1]-i[1],a[2]=t[2]-i[2],n[0]=a[0]*Math.cos(r)-a[1]*Math.sin(r),n[1]=a[0]*Math.sin(r)+a[1]*Math.cos(r),n[2]=a[2],e[0]=n[0]+i[0],e[1]=n[1]+i[1],e[2]=n[2]+i[2],e},a.forEach=function(){var e=a.create();return function(t,i,r,a,n,o){var s,u;for(i||(i=3),r||(r=0),u=a?Math.min(a*i+r,t.length):t.length,s=r;s<u;s+=i)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],n(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}(),a.angle=function(e,t){var i=a.fromValues(e[0],e[1],e[2]),r=a.fromValues(t[0],t[1],t[2]);a.normalize(i,i),a.normalize(r,r);var n=a.dot(i,r);return n>1?0:Math.acos(n)},a.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},a.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},a.equals=function(e,t){var i=e[0],a=e[1],n=e[2],o=t[0],s=t[1],u=t[2];return Math.abs(i-o)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(a-s)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(n-u)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))},e.exports=a},function(e,t,i){var r=i(245),a={};a.create=function(){var e=new r.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},a.clone=function(e){var t=new r.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},a.fromValues=function(e,t,i,a){var n=new r.ARRAY_TYPE(4);return n[0]=e,n[1]=t,n[2]=i,n[3]=a,n},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.set=function(e,t,i,r,a){return e[0]=t,e[1]=i,e[2]=r,e[3]=a,e},a.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e},a.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e},a.sub=a.subtract,a.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e[3]=t[3]*i[3],e},a.mul=a.multiply,a.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e[3]=t[3]/i[3],e},a.div=a.divide,a.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},a.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},a.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e[3]=Math.min(t[3],i[3]),e},a.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e[3]=Math.max(t[3],i[3]),e},a.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},a.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},a.scaleAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e},a.distance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1],a=t[2]-e[2],n=t[3]-e[3];return Math.sqrt(i*i+r*r+a*a+n*n)},a.dist=a.distance,a.squaredDistance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1],a=t[2]-e[2],n=t[3]-e[3];return i*i+r*r+a*a+n*n},a.sqrDist=a.squaredDistance,a.length=function(e){var t=e[0],i=e[1],r=e[2],a=e[3];return Math.sqrt(t*t+i*i+r*r+a*a)},a.len=a.length,a.squaredLength=function(e){var t=e[0],i=e[1],r=e[2],a=e[3];return t*t+i*i+r*r+a*a},a.sqrLen=a.squaredLength,a.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},a.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},a.normalize=function(e,t){var i=t[0],r=t[1],a=t[2],n=t[3],o=i*i+r*r+a*a+n*n;return o>0&&(o=1/Math.sqrt(o),e[0]=i*o,e[1]=r*o,e[2]=a*o,e[3]=n*o),e},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},a.lerp=function(e,t,i,r){var a=t[0],n=t[1],o=t[2],s=t[3];return e[0]=a+r*(i[0]-a),e[1]=n+r*(i[1]-n),e[2]=o+r*(i[2]-o),e[3]=s+r*(i[3]-s),e},a.random=function(e,t){return t=t||1,e[0]=r.RANDOM(),e[1]=r.RANDOM(),e[2]=r.RANDOM(),e[3]=r.RANDOM(),a.normalize(e,e),a.scale(e,e,t),e},a.transformMat4=function(e,t,i){var r=t[0],a=t[1],n=t[2],o=t[3];return e[0]=i[0]*r+i[4]*a+i[8]*n+i[12]*o,e[1]=i[1]*r+i[5]*a+i[9]*n+i[13]*o,e[2]=i[2]*r+i[6]*a+i[10]*n+i[14]*o,e[3]=i[3]*r+i[7]*a+i[11]*n+i[15]*o,e},a.transformQuat=function(e,t,i){var r=t[0],a=t[1],n=t[2],o=i[0],s=i[1],u=i[2],l=i[3],c=l*r+s*n-u*a,h=l*a+u*r-o*n,d=l*n+o*a-s*r,p=-o*r-s*a-u*n;return e[0]=c*l+p*-o+h*-u-d*-s,e[1]=h*l+p*-s+d*-o-c*-u,e[2]=d*l+p*-u+c*-s-h*-o,e[3]=t[3],e},a.forEach=function(){var e=a.create();return function(t,i,r,a,n,o){var s,u;for(i||(i=4),r||(r=0),u=a?Math.min(a*i+r,t.length):t.length,s=r;s<u;s+=i)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],n(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}(),a.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},a.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},a.equals=function(e,t){var i=e[0],a=e[1],n=e[2],o=e[3],s=t[0],u=t[1],l=t[2],c=t[3];return Math.abs(i-s)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(a-u)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(n-l)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(o-c)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))},e.exports=a},function(e,t,i){"use strict";var r=function(){var e=function(e){return'<div style="margin: auto; width:500px;z-index:10000;margin-top:20em;text-align:center;">'+e+"</div>"},t='This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>',i='It doesn\'t appear your computer can support WebGL.<br/><a href="http://get.webgl.org">Click here for more information.</a>',r=!0,a=function(a,n,s){function u(a){if(r){var n=document.getElementsByTagName("body")[0];if(n){var o=window.WebGLRenderingContext?i:t;a&&(o+="<br/><br/>Status: "+a),n.innerHTML=e(o)}}}s=s||u,a.addEventListener&&a.addEventListener("webglcontextcreationerror",function(e){s(e.statusMessage)},!1);var l=o(a,n);return l||s(""),l},n=function(e,t,i){for(var r=null,a=0;a<i.length;++a){try{r=e.getContext(i[a],t)}catch(e){}if(r)break}return r},o=function(e,t){var i;if(t&&t.webgl2){if(r=!1,i=n(e,t,["webgl2","experimental-webgl2"]))return i;r=!0}return n(e,t,["webgl","experimental-webgl","webkit-3d","moz-webgl"])};return{create3DContext:o,setupWebGL:a}}();window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)}}()),window.cancelRequestAnimFrame||(window.cancelAnimationFrame=function(){return window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout}()),Date.now||(Date.now=function(){return(new Date).getTime()}),t.a=r},function(e,t,i){"use strict";var r=i(675),a=function(){this._mask=a.DEFAULT_CULLING,this._frustum=new r.a};a.prototype={reset:function(){this._mask=a.DEFAULT_CULLING,this._frustum.clear()},setCullingMask:function(e){this._mask=e},getCullingMask:function(){return this._mask},setFrustum:function(e){this._frustum=e},getFrustum:function(){return this._frustum},getCurrentResultMask:function(){return this._frustum.getCurrentMask()},pushCurrentMask:function(){this._frustum.pushCurrentMask()},popCurrentMask:function(){this._frustum.popCurrentMask()},resetCullingMask:function(){this._frustum.setResultMask(this._frustum.getCurrentMask())},isBoundingBoxCulled:function(e){return!(!(this._mask&a.VIEW_FRUSTUM_CULLING)||this._frustum.containsBoundingBox(e))},isBoundingSphereCulled:function(e){return!(!(this._mask&a.VIEW_FRUSTUM_CULLING)||this._frustum.containsBoundingSphere(e))},isVerticesCulled:function(e){return!(!(this._mask&a.VIEW_FRUSTUM_CULLING)||this._frustum.containsVertices(e))}},a.NO_CULLING=0,a.VIEW_FRUSTUM_LEFT_CULLING=1,a.VIEW_FRUSTUM_RIGHT_CULLING=2,a.VIEW_FRUSTUM_TOP_CULLING=3,a.VIEW_FRUSTUM_BOTTOM_CULLING=4,a.NEAR_PLANE_CULLING=5,a.FAR_PLANE_CULLING=6,a.VIEW_FRUSTUM_SIDES_CULLING=a.VIEW_FRUSTUM_LEFT_CULLING|a.VIEW_FRUSTUM_RIGHT_CULLING|a.VIEW_FRUSTUM_BOTTOM_CULLING|a.VIEW_FRUSTUM_TOP_CULLING,a.VIEW_FRUSTUM_CULLING=a.VIEW_FRUSTUM_SIDES_CULLING|a.NEAR_PLANE_CULLING|a.FAR_PLANE_CULLING,a.DEFAULT_CULLING=a.VIEW_FRUSTUM_SIDES_CULLING,a.ENABLE_ALL_CULLING=a.VIEW_FRUSTUM_CULLING,t.a=a},function(e,t,i){"use strict";var r=i(9),a=i(448),n=i(142),o=i(543),s=i(544),u=i(778),l=i(10),c=i(451),h=i(214),d=i(127),p=i(184),f=i(216),m=i(587),g=function(){return new u.a},_=function(){this._modelViewMatrixStack=new p.a,this._projectionMatrixStack=new p.a,this._viewportStack=new p.a,this._cullingSetStack=new p.a,this._frustumVolume=-1,this._bbCornerFar=0,this._bbCornerNear=0,this._pooledMatrix=new f.a(l.c.create),this._pooledCullingSet=new f.a(g),this._cameraIndexStack=new p.a,this._cameraModelViewIndexStack=new p.a,this._cameraMatrixInverse=new m.a,this._cameraMatrixInverseRoot=void 0};r.a.createPrototypeObject(_,r.a.objectInherit(s.a.prototype,{reset:function(){this._modelViewMatrixStack.reset(),this._projectionMatrixStack.reset(),this._cullingSetStack.reset(),this._pooledMatrix.reset(),this._pooledCullingSet.reset(),this._cameraModelViewIndexStack.reset(),this._cameraIndexStack.reset(),this._cameraMatrixInverse.reset(),this._cameraMatrixInverseRoot=void 0},getProjectionMatrixStack:function(){return this._projectionMatrixStack},getCurrentProjectionMatrix:function(){return this._projectionMatrixStack.back()},getCurrentModelViewMatrix:function(){return this._modelViewMatrixStack.back()},getCameraInverseMatrix:function(){if(!this._cameraIndexStack.getLength())return this._cameraMatrixInverseRoot;var e=this._cameraIndexStack.back(),t=this.getNodePath()[e],i=t.getInstanceID(),r=this._cameraMatrixInverse.getMap(),a=r[i];if(void 0===a){var n=this._cameraModelViewIndexStack.back(),o=this._modelViewMatrixStack.getArray()[n];a=this._pooledMatrix.getOrCreateObject(),l.c.invert(a,o),this._cameraMatrixInverse.set(i,a)}return a},getCurrentModelMatrix:function(){var e=this.getCameraInverseMatrix(),t=this._pooledMatrix.getOrCreateObject();return l.c.mul(t,e,this.getCurrentModelViewMatrix())},getCurrentViewMatrix:function(){var e=this._modelViewMatrixStack.getArray();return this._cameraIndexStack.getLength()?e[this._cameraModelViewIndexStack.back()]:e[0]},getViewport:function(){if(0!==this._viewportStack.getLength())return this._viewportStack.back()},getLookVectorLocal:function(e){var t=this.getCurrentModelViewMatrix();return l.f.set(e,-t[2],-t[6],-t[10])},pushViewport:function(e){this._viewportStack.push(e)},popViewport:function(){this._viewportStack.pop()},getFrustumPlanes:function(){var e=l.c.create();return function(t,i,r,a){l.c.mul(e,i,r);var n=!!a,o=t[0];o[0]=e[3]-e[0],o[1]=e[7]-e[4],o[2]=e[11]-e[8],o[3]=e[15]-e[12];var s=t[1];s[0]=e[3]+e[0],s[1]=e[7]+e[4],s[2]=e[11]+e[8],s[3]=e[15]+e[12];var u=t[2];u[0]=e[3]+e[1],u[1]=e[7]+e[5],u[2]=e[11]+e[9],u[3]=e[15]+e[13];var h=t[3];if(h[0]=e[3]-e[1],h[1]=e[7]-e[5],h[2]=e[11]-e[9],h[3]=e[15]-e[13],n){var d=t[4];d[0]=e[3]-e[2],d[1]=e[7]-e[6],d[2]=e[11]-e[10],d[3]=e[15]-e[14];var p=t[5];p[0]=e[3]+e[2],p[1]=e[7]+e[6],p[2]=e[11]+e[10],p[3]=e[15]+e[14]}for(var f=a?6:4,m=0;m<f;m++)c.a.normalizeEquation(t[m])}}(),pushCullingSet:function(){var e=this._pooledCullingSet.getOrCreateObject();this._enableFrustumCulling&&(l.c.getFrustumPlanes(e.getFrustum().getPlanes(),this.getCurrentProjectionMatrix(),this.getCurrentModelViewMatrix(),!1),e.getFrustum().setupMask(4)),this._cullingSetStack.push(e)},popCullingSet:function(){return this._cullingSetStack.pop()},getCurrentCullingSet:function(){return this._cullingSetStack.back()},pushCurrentMask:function(){var e=this.getCurrentCullingSet();e&&e.pushCurrentMask()},popCurrentMask:function(){var e=this.getCurrentCullingSet();e&&e.popCurrentMask()},isVerticesCulled:function(e){return!!this._enableFrustumCulling&&this.getCurrentCullingSet().isVerticesCulled(e)},isBoundingBoxCulled:function(e){return!!this._enableFrustumCulling&&(e.valid()&&this.getCurrentCullingSet().isBoundingBoxCulled(e))},isBoundingSphereCulled:function(e){return!!this._enableFrustumCulling&&(e.valid()&&this.getCurrentCullingSet().isBoundingSphereCulled(e))},isCulled:function(){var e=new a.a;return function(t,i){if(!this._enableFrustumCulling)return!1;if(t.isCullingActive()){if(0===this.getCurrentCullingSet().getCurrentResultMask())return!1;var r=this._pooledMatrix.getOrCreateObject();l.c.identity(r);var a=i.length;return t instanceof h.a&&a--,o.a.computeLocalToWorld(i,!0,r,a),t.getBound().transformMat4(e,r),this.getCurrentCullingSet().isBoundingSphereCulled(e)}return this.getCurrentCullingSet().resetCullingMask(),!1}}(),pushModelViewMatrix:function(){var e=l.f.create();return function(t){var i=this.getNodePath(),r=i.length;if(r){var a=r-1;i[a].getTypeID()===n.a.getTypeID()&&i[a].getReferenceFrame()===d.a.ABSOLUTE_RF&&(this._cameraIndexStack.push(a),this._cameraModelViewIndexStack.push(this._modelViewMatrixStack.getLength()))}else{var o=this._pooledMatrix.getOrCreateObject();l.c.invert(o,t),this._cameraMatrixInverseRoot=o}this._modelViewMatrixStack.push(t),this.getLookVectorLocal(e),this._bbCornerFar=(e[0]>=0?1:0)|(e[1]>=0?2:0)|(e[2]>=0?4:0),this._bbCornerNear=7&~this._bbCornerFar}}(),popModelViewMatrix:function(){var e=l.f.create();return function(){var t=this.getNodePath(),i=t.length-1;this._cameraIndexStack.getLength()&&i===this._cameraIndexStack.back()&&(this._cameraIndexStack.pop(),this._cameraModelViewIndexStack.pop()),this._modelViewMatrixStack.pop(),this._modelViewMatrixStack.getLength()?this.getLookVectorLocal(e):l.f.set(e,0,0,-1),this._bbCornerFar=(e[0]>=0?1:0)|(e[1]>=0?2:0)|(e[2]>=0?4:0),this._bbCornerNear=7&~this._bbCornerFar}}(),pushProjectionMatrix:function(e){this._projectionMatrixStack.push(e),this._frustumVolume=-1,this.pushCullingSet()},popProjectionMatrix:function(){this._projectionMatrixStack.pop(),this._frustumVolume=-1,this.popCullingSet()}}),"osg","CullStack"),t.a=_},function(e,t,i){"use strict";var r=i(588),a=[function(e,t,i,r,a){e.applyModelViewMatrix(t,i),e.applyProjectionMatrix(a)},function(e,t,i,r,a){var n=e.getGraphicContext(),o=e.applyModelViewMatrix(t,i);if(e.applyProjectionMatrix(a),o){var s=e._modelMatrix;s.setMatrix4(i),s.apply(n,this.modelUniform)}},function(e,t,i,r,a){var n=e.getGraphicContext(),o=e.applyModelViewMatrix(t,i);if(e.applyProjectionMatrix(a),o){var s=e._viewMatrix;s.setMatrix4(r),s.apply(n,this.viewUniform)}},function(e,t,i,r,a){var n=e.getGraphicContext(),o=e.applyModelViewMatrix(t,i);if(e.applyProjectionMatrix(a),o){var s=e._modelMatrix;s.setMatrix4(i),s.apply(n,this.modelUniform);var u=e._viewMatrix;u.setMatrix4(r),u.apply(n,this.viewUniform)}}],n=function(e,t){this.modelUniform=t._uniformsCache[e._modelMatrix.getName()],this.viewUniform=t._uniformsCache[e._viewMatrix.getName()];var i=0;this.modelUniform&&(i=1),this.viewUniform&&(i|=2),this.apply=a[i]},o=function(){this._parent=void 0,this._geometry=void 0,this._depth=0,this._projection=void 0,this._view=void 0,this._model=void 0,this._modelView=void 0};o.prototype={reset:function(){this._parent=void 0,this._geometry=void 0,this._depth=0,this._projection=void 0,this._view=void 0,this._model=void 0,this._modelView=void 0},init:function(e,t,i,r,a,n,o){this._parent=e,this._geometry=t,this._depth=o,this._projection=i,this._view=r,this._model=n,this._modelView=a},drawGeometry:function(){return function(e){var t=e.getLastProgramApplied(),i=t.getInstanceID(),r=e.getCacheUniformsApplyRenderLeaf(),a=r[i];a||(a=new n(e,t),r[i]=a),a.apply(e,this._modelView,this._model,this._view,this._projection),this._geometry.drawImplementation(e)}}(),render:function(){var e=0,t=-1;return function(i,a){var n,o,s=this._parent,u=s._parent,l=s._stateset;void 0!==a?(n=a._parent,o=n._parent,o!==u?(r.a.moveStateGraph(i,o,u),i.applyStateSet(l)):s!==n?i.applyStateSet(l):i._stateSetStackChanged(e,t)&&i.applyStateSet(l)):(r.a.moveStateGraph(i,void 0,u),i.applyStateSet(l)),i._setStateSetsDrawID(++e),t=i.getStateSetStackSize(),this.drawGeometry(i)}}()},t.a=o},function(e,t,i){"use strict";var r=i(9),a=i(98),n=i(54),o=function(){a.a.call(this),this._values=[]};r.a.createPrototypeNode(o,r.a.objectInherit(a.a.prototype,{addChild:function(e,t){return a.a.prototype.addChild.call(this,e),void 0===t&&(t=!0),this.children.length>this._values.length?this._values.push(t):this._values[this.children.length-1]=t,!0},setValue:function(e,t){e<this._values.length&&(this._values[e]=t)},getValue:function(e){if(e<this._values.length)return this._values[e]},setAllChildrenOff:function(){for(var e=0;e<this._values.length;++e)this._values[e]=!1},setAllChildrenOn:function(){for(var e=0;e<this._values.length;++e)this._values[e]=!0},traverse:function(){return function(e){switch(e.traversalMode){case n.a.TRAVERSE_ALL_CHILDREN:for(var t=0;t<this.children.length;++t)this.children[t].accept(e);break;case n.a.TRAVERSE_ACTIVE_CHILDREN:var i=this.children.length;for(this._values.length<i&&(i=this._values.length),t=0;t<i;++t)!0===this._values[t]&&this.children[t].accept(e)}}}()}),"osg","Switch"),t.a=o},function(e,t,i){"use strict";var r=i(9),a=i(452),n=i(54),o=i(21),s=i(71),u=function(){n.a.call(this)};r.a.createPrototypeObject(u,r.a.objectInherit(n.a.prototype,{apply:function(e){if(e.getTypeID()===a.a.getTypeID()){for(var t=!1,i=e.getChildren(),r=0,n=e.getChildren().length;r<n;r++){if(i[r].getTypeID()===a.a.getTypeID()){if(t)return void o.a.warn("Warning: a Bone was found after a non-Bone child within a Skeleton. Children of a Bone must be ordered with all child Bones first for correct update order.")}else t=!0}this.traverse(e)}}}),"osgAnimation","ValidateSkeletonVisitor");var l=function(e,t){return(e instanceof a.a?0:1)-(t instanceof a.a?0:1)},c=function(){this._needValidate=!0};r.a.createPrototypeObject(c,r.a.objectInherit(s.a.prototype,{needToValidate:function(){return this._needValidate},update:function(e,t){if(this._needValidate&&t.getVisitorType()===n.a.UPDATE_VISITOR&&e.className&&"Skeleton"===e.className()){for(var i=new u,r=e.getChildren(),a=0,o=r.length;a<o;a++){r[a].accept(i)}r.sort(l),this._needValidate=!1}return!0}}),"osgAnimation","UpdateSkeleton"),t.a=c},function(e,t,i){"use strict";var r=i(9),a=i(58),n=i(72),o=function(e,t){a.a.call(this),this._nbTarget=e,this._enable=!t,this._targetNames={},this._hashNames="",this._hash="",this._dirtyHash=!0};o.uniforms={},r.a.createPrototypeStateAttribute(o,r.a.objectInherit(a.a.prototype,{attributeType:"Morph",cloneType:function(){return new o(void 0,!0)},hasTarget:function(e){return!!this._targetNames[e]},copyTargetNames:function(e){for(var t=this._targetNames,i="",r=t.length=e.length,a=0;a<r;++a){var n=e[a];t[n]=!0,i+=n}this._hashNames=i,this._dirtyHash=!0},getOrCreateUniforms:function(){var e=o,t=this.getNumTargets();return e.uniforms[t]?e.uniforms[t]:(e.uniforms[t]={uTargetWeights:n.a.createFloat4("uTargetWeights")},e.uniforms[t])},setNumTargets:function(e){this._nbTarget=e,this._dirtyHash=!0},getNumTargets:function(){return this._nbTarget},setTargetWeights:function(e){this._targetWeights=e},getTargetWeights:function(){return this._targetWeights},isEnabled:function(){return this._enable},getHash:function(){return this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!1,this._hash):this._hash},_computeInternalHash:function(){return this.getTypeMember()+this._hashNames+this.getNumTargets()+this.isEnabled()},apply:function(){if(this._enable){this.getOrCreateUniforms().uTargetWeights.setFloat4(this._targetWeights)}}}),"osgAnimation","MorphAttribute"),t.a=o},function(e,t,i){"use strict";var r=i(9),a=i(58),n=i(72),o=function(e,t){a.a.call(this),this._enable=!e,this._boneUniformSize=t,this._dirtyHash=!0,this._hash=""};o.uniforms={},o.maxBoneUniformSize=1,o.maxBoneUniformAllowed=1/0,r.a.createPrototypeStateAttribute(o,r.a.objectInherit(a.a.prototype,{attributeType:"Skinning",cloneType:function(){return new o(!0)},getBoneUniformSize:function(){return void 0!==this._boneUniformSize?this._boneUniformSize:o.maxBoneUniformSize},getOrCreateUniforms:function(){var e=o,t=this.getBoneUniformSize();return e.uniforms[t]?e.uniforms[t]:(e.uniforms[t]={uBones:n.a.createFloat4Array("uBones",t)},e.uniforms[t])},setMatrixPalette:function(e){this._matrixPalette=e,void 0===this._boneUniformSize&&(o.maxBoneUniformSize=Math.max(o.maxBoneUniformSize,e.length/4),o.maxBoneUniformSize=Math.min(o.maxBoneUniformAllowed,o.maxBoneUniformSize))},getMatrixPalette:function(){return this._matrixPalette},isEnabled:function(){return this._enable},getHash:function(){return this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!0,this._hash):this._hash},_computeInternalHash:function(){return this.getTypeMember()+this.getBoneUniformSize()+this.isEnabled()},apply:function(){this._enable&&this.getOrCreateUniforms().uBones.getInternalArray().set(this._matrixPalette)}}),"osgAnimation","SkinningAttribute"),t.a=o},function(e,t,i){"use strict";var r=function(e,t,i){this._mode=e,this._first=t,this._arrayLengths=i.slice(0)};r.prototype={draw:function(e){for(var t=e.getGraphicContext(),i=this._mode,r=this._first,a=this._arrayLengths,n=0,o=a.length;n<o;n++){var s=a[n];t.drawArrays(i,r,s),r+=s}},getMode:function(){return this._mode},getNumIndices:function(){for(var e=0,t=this._arrayLengths,i=0,r=t.length;i<r;i++)e+=t[i];return e},getCount:function(){return this.getNumIndices()},getArrayLengths:function(){return this._arrayLengths},getFirst:function(){return this._first},setFirst:function(e){this._first=e}},t.a=r},function(e,t,i){"use strict";var r=function(){this._frame=0,this._startSimulation=0,this._currentSimulation=0,this._deltaTime=0};r.prototype={setReferenceTime:function(e){this._startSimulation=e},getReferenceTime:function(){return this._startSimulation},setSimulationTime:function(e){this._currentSimulation=e},getSimulationTime:function(){return this._currentSimulation},setDeltaTime:function(e){this._deltaTime=e},getDeltaTime:function(){return this._deltaTime},setFrameNumber:function(e){this._frame=e},getFrameNumber:function(){return this._frame}},t.a=r},function(e,t,i){"use strict";var r=i(9),a=i(10),n=i(215),o=i(681),s=i(99),u=i(21),l=function(e,t){this._bb=new n.a,this._first=e,this._second=t,this._nodeRayStart=a.f.create(),this._nodeRayEnd=a.f.create()},c=function(){this._numVertexIndices=0};c.prototype={apply:function(e){e.getAttributes().Vertex&&Object(o.a)(e,this)},operatorPoint:function(){this._numVertexIndices+=2},operatorLine:function(){this._numVertexIndices+=3},operatorTriangle:function(){this._numVertexIndices+=4}};var h=function(e){this._buildKdTree=e,this._numIndices=0};h.prototype={apply:function(e){e.getAttributes().Vertex&&Object(o.a)(e,this)},operatorPoint:function(e){var t=this._buildKdTree._kdTree.getVertices(),i=3*e;this._buildKdTree._kdTree.addPoint(e),this._buildKdTree._primitiveIndices[this._numIndices]=this._numIndices;var r=this._buildKdTree._centers,a=3*this._numIndices;r[a]=t[i],r[a+1]=t[i+1],r[a+2]=t[i+2],this._numIndices++},operatorLine:function(e,t){if(e!==t){var i=this._buildKdTree._kdTree.getVertices(),r=3*e,a=3*t;this._buildKdTree._kdTree.addLine(e,t);var n=this._numIndices;this._buildKdTree._primitiveIndices[n]=n;var o=3*n,s=i[r],u=i[r+1],l=i[r+2],c=i[a],h=i[a+1],d=i[a+2],p=s<c?s:c,f=u<h?u:h,m=l<d?l:d,g=s>c?s:c,_=u>h?u:h,v=l>d?l:d,b=this._buildKdTree._centers;b[o]=.5*(p+g),b[o+1]=.5*(f+_),b[o+2]=.5*(m+v),this._numIndices++}},operatorTriangle:function(e,t,i){if(e!==t&&e!==i&&t!==i){var r=this._buildKdTree._kdTree.getVertices(),a=3*e,n=3*t,o=3*i;this._buildKdTree._kdTree.addTriangle(e,t,i);var s=this._numIndices;this._buildKdTree._primitiveIndices[s]=s;var u=3*s,l=r[a],c=r[a+1],h=r[a+2],d=r[n],p=r[n+1],f=r[n+2],m=r[o],g=r[o+1],_=r[o+2],v=l<d?l<m?l:m:d<m?d:m,b=c<p?c<g?c:g:p<g?p:g,y=h<f?h<_?h:_:f<_?f:_,x=l>d?l>m?l:m:d>m?d:m,S=c>p?c>g?c:g:p>g?p:g,M=h>f?h>_?h:_:f>_?f:_,w=this._buildKdTree._centers;w[u]=.5*(v+x),w[u+1]=.5*(b+S),w[u+2]=.5*(y+M),this._numIndices++}}};var d=function(e){this._kdTree=e,this._bb=new n.a,this._primitiveIndices=void 0,this._centers=void 0,this._axisOrder=a.f.create(),this._stackLength=0};d.prototype={build:function(e,t){var i=e._targetNumTrianglesPerLeaf,r=t.getVertexAttributeList().Vertex;if(!r)return!1;var a=r.getElements();if(!a)return!1;var o=a.length/3;if(o<i)return!1;this._bb.copy(t.getBoundingBox()),this._kdTree.setVertices(a),this.computeDivisions(e),e._numVerticesProcessed+=o;for(var u=0,d=t.getPrimitiveSetList(),p=d.length,f=0;f<p;f++){var m=d[f],g=m.getMode();g===s.a.TRIANGLE_STRIP||g===s.a.TRIANGLE_FAN?u+=3*Math.abs(m.getCount()-2):u+=3*m.getCount()}var _=new c(this);_.apply(t);var v=_._numVertexIndices;this._primitiveIndices=new Uint32Array(u/3),this._centers=new Float32Array(u),this._kdTree.setPrimitiveIndices(new Uint32Array(u));var b=o>65535?new Uint32Array(v):new Uint16Array(v);this._kdTree.setVertexIndices(b);var y=new h(this);y.apply(t);var x=this._kdTree.getPrimitiveIndices().slice(0,this._kdTree.getNumPrimitiveIndices());this._kdTree.setPrimitiveIndices(x);var S=this._kdTree.getVertexIndices().slice(0,this._kdTree.getNumVertexIndices());this._kdTree.setVertexIndices(S),this._primitiveIndices=this._primitiveIndices.slice(0,y._numIndices),this._centers=this._centers.slice(0,3*y._numIndices);var M=new l(-1,this._primitiveIndices.length);M._bb.copy(this._bb);var w=this._kdTree.addNode(M),T=new n.a;T.copy(this._bb),this.divide(e,T,w,0);var C=this._kdTree.getPrimitiveIndices();for(p=this._primitiveIndices.length,f=0;f<p;++f)this._primitiveIndices[f]=C[this._primitiveIndices[f]];return this._kdTree.setPrimitiveIndices(this._primitiveIndices),this._kdTree.getNodes().length>0},computeDivisions:function(e){this._stackLength=e._maxNumLevels;var t=this._bb._max,i=this._bb._min,r=t[0]-i[0],a=t[1]-i[1],n=t[2]-i[2],o=this._axisOrder;o[0]=r>=a&&r>=n?0:a>=n?1:2,o[2]=r<a&&r<n?0:a<n?1:2;var s=o[0]+o[2];o[1]=3===s?0:2===s?1:2},divide:function(e,t,i,r){var a=this._kdTree,n=this._primitiveIndices,o=a.getNodes(),s=o[i],u=s._first,c=s._second,h=r<this._stackLength&&u<0&&c>e._targetNumTrianglesPerLeaf,d=-u-1,p=d+c-1;if(!h)return u<0&&this.computeNodeBox(s,d,p),i;if(u>=0)return i;for(var f=this._axisOrder[r%3],m=t._min[f],g=t._max[f],_=.5*(m+g),v=0,b=0,y=!1,x=d,S=p,M=this._centers;x<S;){for(;x<S&&M[3*n[x]+f]<=_;)++x;for(;x<S&&M[3*n[S]+f]>_;)--S;if(x<S){var w=n[x];n[x]=n[S],n[S]=w,++x,--S}}x===S&&(M[3*n[x]+f]<=_?++x:--S),S-d<=-1?(v=0,b=i,y=!0):p-x<=-1?(v=i,b=0,y=!0):(v=a.addNode(new l(-d-1,S-d+1)),b=a.addNode(new l(-x-1,p-x+1)));var T=t._max[f];t._max[f]=_;var C=0!==v?this.divide(e,t,v,r+1):0;t._max[f]=T,T=t._min[f],t._min[f]=_;var E=0!==b?this.divide(e,t,b,r+1):0;if(t._min[f]=T,!y){s._first=C,s._second=E,y=!0;var L=s._bb;L.init(),0!==C&&L.expandByBoundingBox(o[C]._bb),0!==E&&L.expandByBoundingBox(o[E]._bb)}return i},computeNodeBox:function(e,t,i){for(var r=1/0,a=1/0,n=1/0,o=-1/0,s=-1/0,u=-1/0,l=this._kdTree.getVertexIndices(),c=this._kdTree.getPrimitiveIndices(),h=this._kdTree.getVertices(),d=t;d<=i;++d)for(var p=c[this._primitiveIndices[d]],f=l[p++],m=0;m<f;++m){var g=3*l[p++],_=h[g],v=h[g+1],b=h[g+2];_<r&&(r=_),v<a&&(a=v),b<n&&(n=b),_>o&&(o=_),v>s&&(s=v),b>u&&(u=b)}var y=e._bb,x=y._min,S=y._max;x[0]=r-1e-6,x[1]=a-1e-6,x[2]=n-1e-6,S[0]=o+1e-6,S[1]=s+1e-6,S[2]=u+1e-6}};var p=function(){this._vertices=null,this._kdNodes=[],this._primitiveIndices=void 0,this._vertexIndices=void 0,this._numVertexIndices=0,this._numPrimitiveIndices=0};r.a.createPrototypeObject(p,{getVertices:function(){return this._vertices},setVertices:function(e){this._vertices=e},getNumPrimitiveIndices:function(){return this._numPrimitiveIndices},getNumVertexIndices:function(){return this._numVertexIndices},setPrimitiveIndices:function(e){this._primitiveIndices=e},getPrimitiveIndices:function(){return this._primitiveIndices},setVertexIndices:function(e){this._vertexIndices=e},getVertexIndices:function(){return this._vertexIndices},getNodes:function(){return this._kdNodes},addPoint:function(e){var t=this._numVertexIndices;this._primitiveIndices[this._numPrimitiveIndices++]=t,this._vertexIndices[this._numVertexIndices++]=1,this._vertexIndices[this._numVertexIndices++]=e},addLine:function(e,t){var i=this._numVertexIndices;this._primitiveIndices[this._numPrimitiveIndices++]=i,this._vertexIndices[this._numVertexIndices++]=2,this._vertexIndices[this._numVertexIndices++]=e,this._vertexIndices[this._numVertexIndices++]=t},addTriangle:function(e,t,i){var r=this._numVertexIndices;this._primitiveIndices[this._numPrimitiveIndices++]=r,this._vertexIndices[this._numVertexIndices++]=3,this._vertexIndices[this._numVertexIndices++]=e,this._vertexIndices[this._numVertexIndices++]=t,this._vertexIndices[this._numVertexIndices++]=i},addNode:function(e){return this._kdNodes.push(e),this._kdNodes.length-1},build:function(e,t){return new d(this).build(e,t)},_intersectFunctor:function(e,t){var i=-t._first-1,r=i+t._second,a=this._vertexIndices;e.setVertices(this._vertices),e.setPrimitiveIndex(i);for(var n=i;n<r;++n){var o=this._primitiveIndices[n],s=a[o++];3===s?e.operatorTriangle(a[o],a[o+1],a[o+2]):2===s?e.operatorLine(a[o],a[o+1]):1===s?e.operatorPoint(a[o]):u.a.error("KdTree::intersect() unsupported vertices count :"+s)}},intersect:function(e,t){if(t._first<0)return void this._intersectFunctor(e,t);e.enter(t._bb)&&(t._first>0&&this.intersect(e,this._kdNodes[t._first]),t._second>0&&this.intersect(e,this._kdNodes[t._second]),e.leave())},intersectLineSegment:function(e,t,i,r){if(t._first<0)return void this._intersectFunctor(e,t);var n=t._nodeRayStart,o=t._nodeRayEnd;a.f.copy(n,i),a.f.copy(o,r);var s,u=this._kdNodes;t._first>0&&(s=u[t._first],e.enter(s._bb,n,o)&&this.intersectLineSegment(e,s,n,o)),t._second>0&&(a.f.copy(n,i),a.f.copy(o,r),s=u[t._second],e.enter(s._bb,n,o)&&this.intersectLineSegment(e,s,n,o))}},"osg","KdTree"),t.a=p},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(9),a=i(58),n=i(10),o=i(72),s=function(){a.a.call(this),this._ambient=n.g.fromValues(.2,.2,.2,1),this._diffuse=n.g.fromValues(.8,.8,.8,1),this._specular=n.g.fromValues(0,0,0,1),this._emission=n.g.fromValues(0,0,0,1),this._shininess=12.5};r.a.createPrototypeStateAttribute(s,r.a.objectInherit(a.a.prototype,{attributeType:"Material",cloneType:function(){return new s},getParameterName:function(e){return"u"+this.getType()+"_"+e},getOrCreateUniforms:function(){var e=s;return e.uniforms?e.uniforms:(e.uniforms={ambient:o.a.createFloat4("uMaterialAmbient"),diffuse:o.a.createFloat4("uMaterialDiffuse"),specular:o.a.createFloat4("uMaterialSpecular"),emission:o.a.createFloat4("uMaterialEmission"),shininess:o.a.createFloat1("uMaterialShininess")},e.uniforms)},setEmission:function(e){n.g.copy(this._emission,e)},getEmission:function(){return this._emission},setAmbient:function(e){n.g.copy(this._ambient,e)},getAmbient:function(){return this._ambient},setSpecular:function(e){n.g.copy(this._specular,e)},getSpecular:function(){return this._specular},setDiffuse:function(e){n.g.copy(this._diffuse,e)},getDiffuse:function(){return this._diffuse},setShininess:function(e){this._shininess=e},getShininess:function(){return this._shininess},setTransparency:function(e){this._diffuse[3]=1-e},getTransparency:function(){return this._diffuse[3]},apply:function(){var e=this.getOrCreateUniforms();e.ambient.setFloat4(this._ambient),e.diffuse.setFloat4(this._diffuse),e.specular.setFloat4(this._specular),e.emission.setFloat4(this._emission),e.shininess.setFloat(this._shininess)}}),"osg","Material"),t.default=s},function(e,t,i){"use strict";var r=i(1030),a=i.n(r),n=i(1031),o=i.n(n),s=i(1032),u=i.n(s),l=i(1033),c=i.n(l),h=i(1034),d=i.n(h),p=i(1035),f=i.n(p),m=i(1036),g=i.n(m),_=i(1037),v=i.n(_),b=i(1038),y=i.n(b);t.a={"common.glsl":a.a,"functions.glsl":o.a,"lightCommon.glsl":u.a,"lights.glsl":c.a,"skinning.glsl":d.a,"morphing.glsl":f.a,"textures.glsl":g.a,"colorEncode.glsl":v.a,"billboard.glsl":y.a}},function(e,t,i){"use strict";var r=i(1039),a=i.n(r),n=i(1040),o=i.n(n),s=i(1041),u=i.n(s),l=i(1042),c=i.n(l),h=i(1043),d=i.n(h);t.a={"shadowCast.glsl":a.a,"shadowReceive.glsl":o.a,"shadowLinearSoft.glsl":u.a,"floatFromTex.glsl":c.a,"tapPCF.glsl":d.a}},function(e,t,i){"use strict";var r=function(){this._globalDefault=void 0,this._lastApplied=void 0,this._changed=!1,this._values=[],this._back=void 0,this._length=0};r.prototype={getLength:function(){return this._length},push:function(e,t){var i;this._length===this._values.length?(i={object:e,value:t},this._values.push(i)):(i=this._values[this._length],i.object=e,i.value=t),this._back=i,this._length++},pop:function(){if(this._length){var e=this._values;this._length--;var t=e[this._length];return this._back=this._length?e[this._length-1]:void 0,t}}},t.a=r},function(e,t,i){"use strict";var r=i(10),a=i(21),n=i(71),o=i(186),s=i(58),u=i(184),l=i(791),c=i(72),h=i(9),d=i(246),p=i(1044),f=[void 0,function(e,t){return e[0]===t[0]||(t[0]=e[0],!1)},function(e,t){return e[0]===t[0]&&e[1]===t[1]||(t[0]=e[0],t[1]=e[1],!1)},function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]||(t[0]=e[0],t[1]=e[1],t[2]=e[2],!1)},function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]||(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],!1)}],m=function(e){n.a.call(this),this._excludeUniforms={uProjectionMatrix:!0,uModelMatrix:!0,uViewMatrix:!0,uModelViewMatrix:!0,uModelNormalMatrix:!0,uModelViewNormalMatrix:!0,uArrayColorEnabled:!0},this._graphicContext=void 0,this._shaderGeneratorProxy=e,void 0===e&&console.break(),this._currentVAO=null,this._currentIndexVBO=null,this._stateSets=new u.a,this._shaderGeneratorNames=new l.a,this._uniforms={},this._textureAttributeArrayList=[],this._attributeArray=[],this._projectionMatrix=c.a.createMatrix4(r.c.create(),"uProjectionMatrix"),this._modelMatrix=c.a.createMatrix4(r.c.create(),"uModelMatrix"),this._viewMatrix=c.a.createMatrix4(r.c.create(),"uViewMatrix"),this._modelViewMatrix=c.a.createMatrix4(r.c.create(),"uModelViewMatrix"),this._modelNormalMatrix=c.a.createMatrix3(r.b.create(),"uModelNormalMatrix"),this._modelViewNormalMatrix=c.a.createMatrix3(r.b.create(),"uModelViewNormalMatrix");var t=new l.a;t._globalDefault=c.a.createFloat1(0,"uArrayColorEnabled"),this._uniforms.ArrayColorEnabled=t,this._previousColorAttribPair={},this._vertexAttribMap={},this._vertexAttribMap._disable=[],this._vertexAttribMap._keys=[],this._frameStamp=void 0,this._programCommonUniformsCache={},this._lastAppliedModelViewMatrix=void 0,this._lastAppliedProjectionMatrix=void 0,this._program=void 0;var i=new o.a;this.applyAttribute(i),this._programType=h.a.getOrCreateStateAttributeTypeMemberIndex(i),this._programAttribute=this._attributeArray[this._programType],this._numPushStateSet=0,this._numApply=0,this._programUniformCache=[],this._cacheUniformId=0,this._stateCache=new p.a,this.resetStats()};h.a.createPrototypeObject(m,h.a.objectInherit(n.a.prototype,{getExcludeUniforms:function(){return this._excludeUniforms},resetCaches:function(){this._currentVAO=null,this._currentIndexVBO=null,this._previousColorAttribPair={},this._vertexAttribMap={},this._vertexAttribMap._disable=[],this._vertexAttribMap._keys=[],this._programCommonUniformsCache={}},applyColorMask:function(e){this._stateCache.applyColorMaskAttribute(e)},applyBlendFunc:function(e){this._stateCache.applyBlendFuncAttribute(e)},applyCullFace:function(e){this._stateCache.applyCullFaceAttribute(e)},applyDepth:function(e){this._stateCache.applyDepthAttribute(e)},applyViewport:function(e){this._stateCache.applyViewportAttribute(e)},applyScissor:function(e){this._stateCache.applyScissorAttribute(e)},viewport:function(e,t,i,r){this._stateCache.viewport(e,t,i,r)},depthMask:function(e){this._stateCache.depthMask(e)},clearDepth:function(e){this._stateCache.clearDepth(e)},clearColor:function(e){this._stateCache.clearColor(e)},clear:function(e){this._stateCache.clear(this._graphicContext,e)},drawGeometry:function(e){this._stateCache.drawGeometry(this._graphicContext,e)},getCacheUniformsApplyRenderLeaf:function(){return this._programCommonUniformsCache},setGraphicContext:function(e){this._graphicContext=e,this._extVAO=d.a.instance(e).getWebGLExtension("OES_vertex_array_object")},getGraphicContext:function(){return this._graphicContext},getShaderGeneratorProxy:function(){return this._shaderGeneratorProxy},pushCheckOverride:function(e,t,i){var r=this._evaluateOverrideObjectOnStack(e,t,i);r!==t?e.push(r,e._back.value):e.push(t,i)},_evaluateOverrideObjectOnStack:function(e,t,i){var r=e._back;return 0===e._length?t:r.value&s.a.OVERRIDE&&!(i&s.a.PROTECTED)?r.object:t},pushStateSet:function(e){this._numPushStateSet++,this._stateSets.push(e),this.pushAttributeMap(this._attributeArray,e._attributeArray,e._activeAttribute);for(var t=e._textureAttributeArrayList,i=e._activeTextureAttributeUnit,r=e._activeTextureAttribute,a=0,n=i.length;a<n;a++){var o=i[a],s=t[o],u=this.getOrCreateTextureAttributeArray(o);this.pushAttributeMap(u,s,r)}e.hasUniform()&&this.pushUniformsList(this._uniforms,e.getUniformList());var l=e.getShaderGeneratorPair();l&&this.pushCheckOverride(this._shaderGeneratorNames,l.getShaderGeneratorName(),l.getValue())},getStateSetStackSize:function(){return this._stateSets.getLength()},insertStateSet:function(){var e=new u.a,t=e.getArray();return function(i,r){e.reset();for(var a=this.getStateSetStackSize();a>i;)e.push(this._stateSets.back()),this.popStateSet(),a--;this.pushStateSet(r);for(var n=e._length-1;n>=0;n--)this.pushStateSet(t[n])}}(),removeStateSet:function(){var e=new u.a,t=e.getArray();return function(i){var r=this.getStateSetStackSize();if(i>=r)return void a.a.warn("Warning State:removeStateSet "+i+" out of range");for(e.reset();r-1>i;)e.push(this._stateSets.back()),this.popStateSet(),r--;this.popStateSet();for(var n=e._length-1;n>=0;n--)this.pushStateSet(t[n])}}(),resetCacheFrame:function(){this._lastAppliedModelViewMatrix=this._lastAppliedProjectionMatrix=void 0},resetStats:function(){this._numApply=0,this._numPushStateSet=0},applyProgram:function(e){this._program!==e&&(this._program=e,this.getGraphicContext().useProgram(e))},applyModelViewMatrix:function(){var e=r.b.create();return function(t,i){if(this._lastAppliedModelViewMatrix===t)return!1;var a=this.getLastProgramApplied(),n=a.getUniformsCache(),o=this._modelViewMatrix,s=n.uModelViewMatrix,u=this.getGraphicContext();s&&(o.setMatrix4(t),o.apply(u,s));var l;if(this._lastAppliedModelViewMatrix){for(var c=this._lastAppliedModelViewMatrix,h=0;h<11;h++)if(t[h]!==c[h]){l=!0;break}}else l=!0;return l&&(o=this._modelViewNormalMatrix,s=n.uModelViewNormalMatrix,s&&(r.b.normalFromMat4(e,t),o.setMatrix3(e),o.apply(u,s)),(s=n.uModelNormalMatrix)&&(r.b.normalFromMat4(e,i),o.setMatrix3(e),o.apply(u,s))),this._lastAppliedModelViewMatrix=t,!0}}(),applyProjectionMatrix:function(e){if(this._lastAppliedProjectionMatrix!==e){this._lastAppliedProjectionMatrix=e;var t=this.getLastProgramApplied(),i=this._projectionMatrix,r=t.getUniformsCache()[i.getName()];r&&(i.setMatrix4(e),i.apply(this.getGraphicContext(),r))}},getCurrentShaderGeneratorStateSet:function(e){var t=this._programAttribute,i=e._attributeArray[this._programType];if(!(0!==t._length&&t._back.value!==s.a.OFF||i&&i.getValue()!==s.a.OFF)){var r,a=e.getShaderGeneratorPair(),n=this._shaderGeneratorNames;if(a){var o=a.getValue(),u=a.getShaderGeneratorName();r=this._evaluateOverrideObjectOnStack(this._shaderGeneratorNames,u,o)}else n._length&&(r=n._back.object);var l=r;return this._shaderGeneratorProxy.getShaderGenerator(l)}},_applyAttributeMapStateSet:function(e,t){for(var i=e.length>t.length?e.length:t.length,r=0,a=i;r<a;r++){var n,o=r,s=o<e.length?e[o]:void 0,u=o<t.length?t[o]:void 0,l=!!s,c=l&&s._changed;if(u||c){var h=u?u.getAttribute():void 0;if(l)if(h){var d=u.getValue();n=this._evaluateOverrideObjectOnStack(s,h,d),n!==h?s._changed&&(this._applyAttributeStack(n,s),s._changed=!1):this._applyAttributeStack(n,s)&&(s._changed=!0)}else s._length?(s._changed=!1,this._applyAttributeStack(s._back.object,s)):(s._changed=!1,this._applyAttributeStack(s._globalDefault,s));else s=this._createAttributeStack(e,o,h.cloneType()),s._changed=!0,this._applyAttributeStack(h,s)}}},_applyTextureAttributeMapListStateSet:function(e,t){for(var i,r,a,n=0;n<16;n++){var o=n;i=o<e.length?e[o]:void 0;var s=o<t.length?t[o]:void 0;if(i||s){r=a=0,i?(a=i.length,s&&(r=s.length)):(i=this.getOrCreateTextureAttributeArray(o),r=s.length);for(var u=a>r?a:r,l=0;l<u;l++){var c,h=l,d=h<a?i[h]:void 0,p=s&&h<s.length?s[h]:void 0,f=!!d,m=f&&d._changed;if(p||m){var g=p?p.getAttribute():void 0;if(f)if(g){var _=p.getValue();c=this._evaluateOverrideObjectOnStack(d,g,_),c!==g?d._changed&&(this._applyTextureAttribute(o,c,d),d._changed=!1):this._applyTextureAttribute(o,c,d)&&(d._changed=!0)}else d._length?(d._changed=!1,this._applyTextureAttribute(o,d._back.object,d)):(d._changed=!1,this._applyTextureAttribute(o,d._globalDefault,d));else c=p.getAttribute(),d=this._createAttributeStack(i,h,c.cloneType()),d._changed=!0,this._applyTextureAttribute(o,c,d)}}}}},applyStateSet:function(e){this._numApply++;var t=this.getLastProgramApplied();this._currentShaderGenerator=this.getCurrentShaderGeneratorStateSet(e),this._applyAttributeMapStateSet(this._attributeArray,e._attributeArray),this._applyTextureAttributeMapListStateSet(this._textureAttributeArrayList,e._textureAttributeArrayList);var i;if(this._currentShaderGenerator){var r=this._currentShaderGenerator.getOrCreateProgram(this);this.applyAttribute(r),i=r,this._applyGeneratedProgramUniforms(r,e)}else i=this.getLastProgramApplied(),this._applyCustomProgramUniforms(i,e);t!==i&&(this._lastAppliedModelViewMatrix=void 0,this._lastAppliedProjectionMatrix=void 0)},popAllStateSets:function(){for(;this._stateSets._length;)this.popStateSet()},popStateSet:function(){if(this._stateSets._length){var e=this._stateSets.pop();this.popAttributeMap(this._attributeArray,e._attributeArray,e._activeAttribute);for(var t=e._textureAttributeArrayList,i=e._activeTextureAttributeUnit,r=e._activeTextureAttribute,a=0,n=i.length;a<n;a++){var o=i[a],s=t[o],u=this._textureAttributeArrayList[o];this.popAttributeMap(u,s,r)}e.hasUniform()&&this.popUniformsList(this._uniforms,e.getUniformList()),e.getShaderGeneratorPair()&&this._shaderGeneratorNames.pop()}},_createAttributeStack:function(e,t,i){h.a.arrayDense(t,e);var r=new l.a;return r._globalDefault=i,e[t]=r,r},haveAppliedAttribute:function(e){if(e){var t=this._attributeArray,i=h.a.getOrCreateStateAttributeTypeMemberIndex(e),r=i<t.length?t[i]:void 0;r||(r=this._createAttributeStack(t,i,e.cloneType())),r._lastApplied=e,r._changed=!0}},applyAttribute:function(e){var t=h.a.getOrCreateStateAttributeTypeMemberIndex(e),i=this._attributeArray,r=t<i.length?i[t]:void 0;r||(r=this._createAttributeStack(i,t,e.cloneType())),r._changed=!0,this._applyAttributeStack(e,r)},_applyAttributeStack:function(e,t){return t._lastApplied!==e&&(e.apply&&e.apply(this),t._lastApplied=e,!0)},_applyTextureAttribute:function(e,t,i){if(i._lastApplied===t)return!1;if(i._lastApplied=t,!t.apply)return!0;var r=this.getGraphicContext();return r.activeTexture(r.TEXTURE0+e),t.apply(this,e),!0},applyTextureAttribute:function(e,t){var i=h.a.getOrCreateTextureStateAttributeTypeMemberIndex(t),r=this.getOrCreateTextureAttributeArray(e),a=r[i];a||(a=this._createAttributeStack(r,i,t.cloneType())),a._changed=!0,this._applyTextureAttribute(e,t,a)},getLastProgramApplied:function(){return this._programAttribute._lastApplied},applyDefault:function(){this.popAllStateSets(),this._currentShaderGenerator=void 0,this.applyAttributeMap(this._attributeArray),this.applyTextureAttributeMapList(this._textureAttributeArrayList)},applyAttributeMap:function(e){for(var t,i=0,r=e.length;i<r;i++)if(t=e[i]){var a;a=t._length?t._back.object:t._globalDefault,t._changed&&(t._lastApplied!==a&&(a.apply&&a.apply(this),t._lastApplied=a),t._changed=!1)}},pushUniformsList:function(e,t){var i,r;for(var a in t){var n=t[a];r=n.getUniform(),i=r.getName(),e[i]||this._createAttributeStack(e,i,r),this.pushCheckOverride(e[i],r,n.getValue())}},popUniformsList:function(e,t){for(var i in t)e[i].pop()},applyTextureAttributeMapList:function(e){for(var t,i=this._graphicContext,r=0,a=e.length;r<a;r++)if(t=e[r])for(var n=0,o=t.length;n<o;n++){var s=t[n];if(s){var u;u=s._length?s._back.object:s._globalDefault,s._changed&&(s._lastApplied!==u&&(i.activeTexture(i.TEXTURE0+r),u.apply(this,r),s._lastApplied=u),s._changed=!1)}}},setGlobalDefaultAttribute:function(e){var t=h.a.getOrCreateStateAttributeTypeMemberIndex(e);t>=this._attributeArray.length||!this._attributeArray[t]?this._createAttributeStack(this._attributeArray,t,e):this._attributeArray[t]._globalDefault=e},getGlobalDefaultAttribute:function(e){var t=this._attributeArray,i=h.a.getIdFromTypeMember(e);if(!(void 0===i||i>=t.length))return t[i]?t[i]._globalDefault:void 0},setGlobalDefaultTextureAttribute:function(e,t){var i=this.getOrCreateTextureAttributeArray(e),r=h.a.getOrCreateTextureStateAttributeTypeMemberIndex(t);r>=i.length||!i[r]?this._createAttributeStack(i,r,t):i[r]._globalDefault=t},getGlobalDefaultTextureAttribute:function(e,t){var i=this.getOrCreateTextureAttributeArray(e),r=h.a.getTextureIdFromTypeMember(t);if(!(void 0===r||r>=i.length))return i[r]?i[r]._globalDefault:void 0},getOrCreateTextureAttributeArray:function(e){return h.a.arrayDense(e,this._textureAttributeArrayList),this._textureAttributeArrayList[e]||(this._textureAttributeArrayList[e]=[]),this._textureAttributeArrayList[e]},pushAttributeMap:function(e,t,i){for(var r,a=t.length,n=e.length,o=0,s=i.length;o<s;o++){var u=i[o],l=u<a?t[u]:void 0,c=l.getAttribute();r=u<n?e[u]:void 0,r||(r=this._createAttributeStack(e,u,c.cloneType())),this.pushCheckOverride(r,c,l.getValue()),r._changed=!0}},popAttributeMap:function(e,t,i){for(var r=0,a=i.length;r<a;r++){var n=i[r],o=e[n];o.pop(),o._changed=!0}},setIndexArray:function(e){var t=this._graphicContext;this._currentIndexVBO!==e&&(e.bind(t),this._currentIndexVBO=e),e.isDirty()&&e.compile(t)},lazyDisablingOfVertexAttributes:function(){for(var e=this._vertexAttribMap._keys,t=0,i=e.length;t<i;t++){var r=e[t];this._vertexAttribMap[r]&&(this._vertexAttribMap._disable[r]=!0)}},enableVertexColor:function(){var e=this._programAttribute._lastApplied;if(e.getUniformsCache().uArrayColorEnabled&&e.getAttributesCache().Color){var t=this._uniforms.ArrayColorEnabled._globalDefault;this._previousColorAttribPair[e.getInstanceID()]||(t.setFloat(1),t.apply(this.getGraphicContext(),e.getUniformsCache().uArrayColorEnabled),this._previousColorAttribPair[e.getInstanceID()]=!0)}},disableVertexColor:function(){var e=this._programAttribute._lastApplied;if(e.getUniformsCache().uArrayColorEnabled&&e.getAttributesCache().Color){var t=this._uniforms.ArrayColorEnabled._globalDefault;this._previousColorAttribPair[e.getInstanceID()]&&(t.setFloat(0),t.apply(this.getGraphicContext(),e.getUniformsCache().uArrayColorEnabled),this._previousColorAttribPair[e.getInstanceID()]=!1)}},applyDisablingOfVertexAttributes:function(){for(var e=this._vertexAttribMap._keys,t=0,i=e.length;t<i;t++)if(!0===this._vertexAttribMap._disable[e[t]]){var r=e[t];this._graphicContext.disableVertexAttribArray(r),this._vertexAttribMap._disable[r]=!1,this._vertexAttribMap[r]=!1}},clearVertexAttribCache:function(){for(var e=this._vertexAttribMap,t=e._keys,i=0,r=t.length;i<r;i++){var a=t[i];e[a]=void 0,e._disable[a]=!1}this._vertexAttribMap._disable.length=0,this._vertexAttribMap._keys.length=0},setVertexArrayObject:function(e){return this._currentVAO!==e&&(this._currentVAO=e,e?e.bind(this._graphicContext):(this._graphicContext.bindVertexArray(null),this.clearVertexAttribCache()),this._currentIndexVBO=void 0,!0)},setVertexAttribArray:function(e,t,i){var r=this._vertexAttribMap;r._disable[e]=!1;var a=this._graphicContext,n=!1;t.isDirty()&&(t.bind(a),t.compile(a),n=!0);var o=r[e];o!==t&&(n||t.bind(a),o||(a.enableVertexAttribArray(e),void 0===o&&r._keys.push(e)),r[e]=t,a.vertexAttribPointer(e,t.getItemSize(),t.getType(),i,0,0))},_getActiveUniformsFromProgramAttributes:function(e,t){var i=this._attributeArray,r=e.getTrackAttributes().attributeKeys;if(r.length>0)for(var a=0,n=r.length;a<n;a++){var o=r[a],s=this.typeMember[o],u=i[s];if(u){var l=u._globalDefault;if(l.getOrCreateUniforms){var c=l.getOrCreateUniforms();for(var h in c)t.push(c[h])}}}},_getActiveUniformsFromProgramTextureAttributes:function(e,t){var i=e.getTrackAttributes().textureAttributeKeys;if(i)for(var r=0,a=i.length;r<a;r++){var n=i[r];if(n){var o=this._textureAttributeArrayList[r];if(o)for(var s=0,u=n.length;s<u;s++){var l=n[s],c=o[l];if(c){var h=c._globalDefault;if(h.getOrCreateUniforms){var d=h.getOrCreateUniforms();for(var p in d)t.push(d[p])}}}}}},_cacheUniformsForCustomProgram:function(e,t){this._getActiveUniformsFromProgramAttributes(e,t),this._getActiveUniformsFromProgramTextureAttributes(e,t);for(var i=this._graphicContext,r={},a=0,n=t.length;a<n;a++){var o=t[a],s=o.getName(),u=i.getUniformLocation(e._program,s);void 0!==u&&null!==u&&(r[s]=o)}e.trackUniforms=r},_applyCustomProgramUniforms:function(){var e=[];return function(t,i){e.length=0,void 0!==t.getTrackAttributes()&&void 0===t.trackUniforms&&this._cacheUniformsForCustomProgram(t,e);var r,a=t.getUniformsCache(),n=this._uniforms;t.trackUniforms&&(r=t.trackUniforms);var o;for(var s in a){var u=a[s],l=n[s],c=i&&i.uniforms[s];if(l||c)if(c){var h=i.uniforms[s],d=h.getValue(),p=h.getUniform();o=l?this._evaluateOverrideObjectOnStack(l,p,d):p}else o=l._length?l._back.object:l._globalDefault;else{if(void 0===r){this._checkErrorUniform(s);continue}o=r[s]}o.apply(this._graphicContext,u)}}}(),_checkErrorUniform:function(e){var t=e.substr(7);this._textureAttributeArrayList[t]&&e==="Texture"+t||this._excludeUniforms[e]||(this._excludeUniforms[e]=1,a.a.error("Uniform not in the scene hierarchy : "+e))},_computeForeignUniforms:function(e,t){var i=[];for(var r in e){void 0!==e[r]&&void 0===t[r]&&(this._excludeUniforms[r]||i.push(r))}return i},_removeUniformsNotRequiredByProgram:function(e,t){for(var i in e){var r=t[i];void 0!==r&&null!==r||delete e[i]}},_cacheUniformsForGeneratedProgram:function(e){var t=e.getUniformsCache(),i=e.getActiveUniforms(),r=this._computeForeignUniforms(t,i);e.setForeignUniforms(r),this._removeUniformsNotRequiredByProgram(i,t)},_copyUniformEntry:function(e){var t,i=e.getInternalArray();return i.length<16&&(t=new i.constructor(i.length)),t},_initUniformCache:function(e){var t,i,r,a,n,o,s=e.getActiveUniforms(),u=e.getForeignUniforms(),l=this._uniforms,c=[],h=[];if(e._cacheUniformId=this._cacheUniformId++,this._programUniformCache[e._cacheUniformId]={},u.length)for(r=c,t=0,i=u.length;t<i;t++){a=u[t];var d=l[a];d&&(o=d._globalDefault,n=this._copyUniformEntry(o),r.push(n))}for(var p in s)o=s[p],n=this._copyUniformEntry(o),h.push(n);this._programUniformCache[e._cacheUniformId].foreign=c,this._programUniformCache[e._cacheUniformId].active=h},_checkCacheAndApplyUniform:function(e,t,i,r,a){var n,o=e.getInternalArray(),s=o.length;if(s<=4){var u=t[i];n=f[s](o,u)}else n=!1;if(!n){var l=r[a];e.apply(this._graphicContext,l)}},_applyGeneratedProgramUniforms:function(e,t){var i,r,a,n,o=this._uniforms,s=e.getForeignUniforms();if(!s){if(this._cacheUniformsForGeneratedProgram(e),s=e.getForeignUniforms(),t){var u=t.uniforms;for(n=0;n<s.length;n++)r=s[n],o[r]||u[r]&&(i=u[r].getUniform(),this._createAttributeStack(o,r,i))}this._initUniformCache(e)}var l=e.getUniformsCache(),c=e.getActiveUniforms(),h=this._programUniformCache[e._cacheUniformId].active,d=this._programUniformCache[e._cacheUniformId].foreign,p=0;for(var f in c)i=c[f],this._checkCacheAndApplyUniform(i,h,p,l,f),p++;p=0;var m=s.length;for(n=0;n<m;n++){r=s[n],a=o[r];var g=t&&t.uniforms[r];if(g||a){if(g){var _=t.uniforms[r],v=_.getValue(),b=_.getUniform();i=this._evaluateOverrideObjectOnStack(a,b,v)}else a._length?i=a._back.object:(i=a._globalDefault,this._checkErrorUniform(r));this._checkCacheAndApplyUniform(i,d,p,l,r),p++}else this._checkErrorUniform(r)}},_setStateSetsDrawID:function(e){for(var t=this._stateSets.getArray(),i=0,r=this._stateSets.length;i<r;i++)t[i].setDrawID(e)},_stateSetStackChanged:function(e,t){var i=this._stateSets.getArray(),r=this._stateSets.length;if(t!==r)return!0;for(var a=0;a<r;a++)if(e!==i[a].getDrawID())return!0;return!1}}),"osg","State"),t.a=m},function(e,t,i){"use strict";var r=i(9),a=i(54),n=function(){a.a.call(this),this.visitorType=a.a.UPDATE_VISITOR,this._numUpdateCallback=0};r.a.createPrototypeObject(n,r.a.objectInherit(a.a.prototype,{resetStats:function(){this._numUpdateCallback=0},apply:function(e){var t=e.getStateSet();if(t&&t.requiresUpdateTraversal()){var i=t.getUpdateCallbackList(),r=i.length;if(r){this._numUpdateCallback+=r;for(var a=0,n=r;a<n;a++)i[a].update(t,this)}}for(var o=e.getUpdateCallbackList(),s=o.length,u=0;u<s;u++)if(this._numUpdateCallback++,!o[u].update(e,this))return;e.getNumChildrenRequiringUpdateTraversal()>0&&this.traverse(e)}}),"osg","NodeVisitor"),t.a=n},function(e,t,i){"use strict";var r=i(21),a=i(246),n=function(e){this._enabled=!1,this.reset(e)};n.FRAME_COUNT=0,n.instance=function(e,t){return n._instance?e&&(n._instance.getContext()!==e||t)&&(n._instance.setContext(e),n._instance.reset(e)):n._instance=new n(e),n._instance},n.prototype={reset:function(e){if(e){var t=a.a.instance(e).getDisjointTimerQuery();if(!t)return this;if(e.getQueryParameter||(e.getQueryParameter=t.getQueryObjectEXT.bind(t)),this._hasTimeElapsed=e.getQuery(t.TIME_ELAPSED_EXT,t.QUERY_COUNTER_BITS_EXT)>=30,this._hasTimeStamp=e.getQuery(t.TIMESTAMP_EXT,t.QUERY_COUNTER_BITS_EXT)>=30,!this._hasTimeElapsed&&!this._hasTimeStamp)return this;this._hasTimeStamp||r.a.debug("Warning: do not use interleaved GPU query"),this._ext=t,this._gl=e,this._enabled=!0}this._frameAverageCount=10,this._glQueries=[],this._queriesByID={},this._userQueries=[],this._queryCount=0,this._nbOpened=0},getContext:function(){return this._gl},setContext:function(e){this._gl=e},setFrameAverageCount:function(e){this._frameAverageCount=e},clearQueries:function(){for(var e=this._glQueries,t=0,i=e.length;t<i;++t){var r=e[t];this._gl.deleteQuery(r._pollingStartQuery),r._pollingEndQuery&&this._gl.deleteQuery(r)}this._userQueries.length=0,this._glQueries.length=0,this._queriesByID={}},supportTimeStamp:function(){return this._hasTimeStamp},enable:function(){this._enabled=!!this._ext},disable:function(){this._enabled=!1},isEnabled:function(){return this._enabled},setCallback:function(e){this._callback=e},createUserQuery:function(e){var t;return t=this._hasTimeStamp?this.createGLQuery():{_startIndex:0,_endIndex:0},t._id=e,t._frame=n.FRAME_COUNT,t._isOpened=!0,t._siblings=[],t},createGLQuery:function(){var e={};return e._isWaiting=!1,e._pollingStartQuery=void 0,e._pollingEndQuery=void 0,e._averageTimer=0,e._resultCount=0,this._hasTimeStamp&&(e._pollingEndQuery=this._gl.createQuery()),e._pollingStartQuery=this._gl.createQuery(),this._glQueries.push(e),e},getOrCreateLastGLQuery:function(){var e=this._glQueries[this._queryCount-1];return e||(e=this._glQueries[this._queryCount-1]=this.createGLQuery())},beginCurrentQuery:function(){if(0!==this._nbOpened){this._queryCount++;var e=this.getOrCreateLastGLQuery();e._isWaiting||this._gl.beginQuery(this._ext.TIME_ELAPSED_EXT,e._pollingStartQuery)}},endCurrentQuery:function(){0!==this._nbOpened&&(this.getOrCreateLastGLQuery()._isWaiting||this._gl.endQuery(this._ext.TIME_ELAPSED_EXT))},getAvailableQueryByID:function(e){var t=this._queriesByID[e];if(!t)return t=this._queriesByID[e]=this.createUserQuery(e),this._userQueries.push(t),t;if(t._frame===n.FRAME_COUNT){if(t._isOpened)return t;for(var i=t._siblings,r=0,a=i.length;r<a;++r){var o=i[r];if(o._frame!==n.FRAME_COUNT||o._isOpened)return o._frame=n.FRAME_COUNT,o}var s=this.createUserQuery();return i.push(s),s}return t._frame=n.FRAME_COUNT,t},start:function(e){if(this._enabled){var t=this.getAvailableQueryByID(e);t._isOpened=!0,this._hasTimeStamp?t._isWaiting||this._ext.queryCounterEXT(t._pollingStartQuery,this._ext.TIMESTAMP_EXT):(this.endCurrentQuery(),this._nbOpened++,t._startIndex=this._queryCount,this.beginCurrentQuery())}},end:function(e){if(this._enabled){var t=this.getAvailableQueryByID(e);t._isOpened=!1,this._hasTimeStamp?t._isWaiting||this._ext.queryCounterEXT(t._pollingEndQuery,this._ext.TIMESTAMP_EXT):(this.endCurrentQuery(),t._endIndex=this._queryCount,this._nbOpened--,this.beginCurrentQuery())}},computeQueryAverageTime:function(e){for(var t=0,i=this._glQueries,r=e._startIndex;r<e._endIndex;++r){var a=i[r]._averageTimer;if(a<0)return-1;t+=a}return t},computeFullAverageTime:function(e){var t=this.computeQueryAverageTime(e);if(t<0)return-1;for(var i=e._siblings,r=0,a=i.length;r<a;++r){var o=i[r];if(o._frame===n.FRAME_COUNT-1){var s=this.computeQueryAverageTime(o);if(s<0)return-1;t+=s}}return t},pollQueries:function(){if(n.FRAME_COUNT++,this._queryCount=0,this._nbOpened=0,this._enabled&&this._callback){var e,t=this._glQueries,i=t.length;if(this._gl.getParameter(this._ext.GPU_DISJOINT_EXT))for(e=0;e<i;++e)t[e]._isWaiting=!1;else{for(e=0;e<i;++e)this.pollQuery(t[e]);var r=this._userQueries,a=r.length;for(e=0;e<a;++e){var o=r[e],s=this.computeFullAverageTime(o);s>0&&this._callback(s,o._id)}}}},pollQuery:function(e){e._isWaiting=!1;var t=this._hasTimeStamp?e._pollingEndQuery:e._pollingStartQuery;if(!this._gl.getQueryParameter(t,this._gl.QUERY_RESULT_AVAILABLE))return e._isWaiting=!0,0;var i;if(this._hasTimeStamp){var r=this._gl.getQueryParameter(e._pollingStartQuery,this._gl.QUERY_RESULT);i=this._gl.getQueryParameter(t,this._gl.QUERY_RESULT)-r}else i=this._gl.getQueryParameter(t,this._gl.QUERY_RESULT);return e._resultCount++,e._resultCount>this._frameAverageCount&&(e._averageTimer=0,e._resultCount=1),e._averageTimer=e._averageTimer+(i-e._averageTimer)/e._resultCount,e._averageTimer}},t.a=n},function(e,t,i){"use strict";t.a={Vec3:0,Quat:1,Float:2,FloatCubicBezier:3,Vec3CubicBezier:4,QuatSlerp:5,Matrix:6,Count:7}},function(e,t,i){"use strict";var r=i(21),a=i(9),n=i(71),o=i(10),s=i(454),u=i(593),l=i(797),c=i(798),h=i(400),d=i(594),p={lerp:function(e,t,i){return e+(t-e)*i},init:function(){return 0},copy:function(e,t){return t},create:function(){return 0}},f=[];f[s.a.ChannelType.Float]=1,f[s.a.ChannelType.FloatCubicBezier]=1,f[s.a.ChannelType.Vec3]=3,f[s.a.ChannelType.Vec3CubicBezier]=3,f[s.a.ChannelType.Quat]=4,f[s.a.ChannelType.QuatSlerp]=4,f[s.a.ChannelType.Matrix]=16;var m=[];m.length=s.a.ChannelType.Count,m[s.a.ChannelType.Vec3]=o.f,m[s.a.ChannelType.Quat]=o.d,m[s.a.ChannelType.QuatSlerp]=o.d,m[s.a.ChannelType.Float]=p,m[s.a.ChannelType.FloatCubicBezier]=p,m[s.a.ChannelType.Vec3CubicBezier]=o.f,m[s.a.ChannelType.Matrix]=o.c;var g=function(){n.a.call(this),this._simulationTime=0,this._pauseTime=0,this._timeFactor=1,this._startTime=0,this._instanceAnimations={},this._startAnimations={},this._targets=[],this._targetsMap={},this._targetsByTypes=[],this._targetsByTypes.length=s.a.ChannelType.Count;for(var e=0,t=this._targetsByTypes.length;e<t;e++)this._targetsByTypes[e]=[];this._activeAnimations={},this._activeAnimationList=[],this._activeChannelsByTypes=[],this._activeChannelsByTypes.length=s.a.ChannelType.Count;for(var i=0,r=this._activeChannelsByTypes.length;i<r;i++)this._activeChannelsByTypes[i]=[];this._animationsUpdateCallback={},this._animationsUpdateCallbackArray=[],this._animationsToRegister=[],this._pause=!1,this._dirty=!1,this._seekTime=-1};a.a.createPrototypeObject(g,a.a.objectInherit(n.a.prototype,{init:function(e){this._simulationTime=0,this._pauseTime=0,this._timeFactor=1,this._startTime=0,this._instanceAnimations={},this._startAnimations={},this._resetTargets(),this._activeAnimations={},this._activeAnimationList.length=0;for(var t=0,i=this._activeChannelsByTypes.length;t<i;t++)this._activeChannelsByTypes[t].length=0;this._animationsUpdateCallback={},this._animationsUpdateCallbackArray.length=0,this._pause=!1,this._seekTime=-1,this.addAnimations(e)},addAnimations:function(e){var t=this._addAnimation(e);Array.prototype.push.apply(this._animationsToRegister,t),this._dirty=!0,this._registerAnimations()},update:function(e,t){this._dirty&&(this._findAnimationUpdateCallback(e),this._registerTargetFoundInAnimationCallback(),this._registerAnimations());var i=t.getFrameStamp().getSimulationTime();return-1!==this._seekTime&&(this._pauseTime=-this._seekTime+this._startTime+i),this._seekTime=-1,this._pause?this._pauseTime=i-this._simulationTime+this._startTime:this._simulationTime=this._startTime+(i-this._pauseTime),this.updateManager(this._simulationTime*this._timeFactor),!0},updateManager:function(e){this._processStartAnimation(e);for(var t=s.a.ChannelType.Count,i=0;i<t;i++){var r=this._activeChannelsByTypes[i];this._updateChannelsType(e,r,l.a[i])}for(var a=0;a<t;a++){var n=this._targetsByTypes[a];this._updateTargetType(n,m[a])}for(var o=0,u=this._animationsUpdateCallbackArray.length;o<u;o++){this._animationsUpdateCallbackArray[o].computeChannels()}this._removeFinishedAnimation(e)},togglePause:function(){this._pause=!this._pause,this._pause||(this._seekTime=this._simulationTime)},getSimulationTime:function(){return this._simulationTime},setSimulationTime:function(e){this._simulationTime=e},setSeekTime:function(e){this._simulationTime=e,this._seekTime=e},stopAnimation:function(e){for(var t=this._activeAnimationList,i=0,r=t.length;i<r;++i)if(t[i].name===e)return this._removeActiveChannels(this._instanceAnimations[e]),this._activeAnimations[e]=void 0,void t.splice(i,1)},stopAllAnimation:function(){for(var e=this._activeAnimationList,t=0,i=e.length;t<i;++t){var r=e[t].name;this._removeActiveChannels(this._instanceAnimations[r]),this._activeAnimations[r]=void 0}e.length=0},setTimeFactor:function(e){var t=e/this._timeFactor;this._startTime+=(this._simulationTime-this._simulationTime*t)/t,this._timeFactor=e,this._pause&&(this._simulationTime+=(this._simulationTime-this._simulationTime*t)/t)},getTimeFactor:function(){return this._timeFactor},isPlaying:function(e){return!!this._activeAnimations[e]},playAnimationObject:function(e){var t=this._instanceAnimations[e.name];if(!t)return void r.a.info("no animation "+e.name+" found");this.isPlaying(e.name)||(t.priority=void 0===e.priority?0:e.priority,t.weight=void 0===e.weight?1:e.weight,t.loop=void 0===e.loop||e.loop,this._startAnimations[t.name]=t)},playAnimation:function(e,t,i,r){var a;return a="object"==typeof e?e:{name:e,priority:i,weight:r,loop:t},this.playAnimationObject(a)},getAnimations:function(){return this._instanceAnimations},_registerAnimations:function(){if(this._targets.length){for(var e=0,t=this._animationsToRegister.length;e<t;e++){var i=this._animationsToRegister[e];this._registerInstanceAnimation(i)}this._animationsToRegister.length=0,this._dirty=!1}},_registerInstanceAnimation:function(e){for(var t=e.channels,i=0,a=t.length;i<a;i++){var n=t[i],o=n.channel.target,s=n.channel.name,u=o+"."+s;this._targetMap[u]?n.targetID=this._targetMap[u].id:r.a.warn("registerInstanceAnimation did not find targetName ("+u+") in the scene graph")}return!0},_findAnimationUpdateCallback:function(e){var t=new c.a;e.accept(t),this._animationsUpdateCallback=t.getAnimationUpdateCallbackMap()},_registerTargetFoundInAnimationCallback:function(){this._resetTargets();var e,t,i,a=0,n=this._targetMap,o=this._targets,s=function(e,t){if(n[e])t!==n[e]&&r.a.warn("detected differents target instance with the same name ("+e+")");else{n[e]=t,t.id=a++,o.push(t);var i=t.type;this._targetsByTypes[i].push(t)}}.bind(this);for(var u in this._animationsUpdateCallback){var l=this._animationsUpdateCallback[u];if(l.getStackedTransforms&&l.getStackedTransforms().length){this._animationsUpdateCallbackArray.push(l);for(var c=l.getStackedTransforms(),h=0,p=c.length;h<p;h++){var f=c[h];e=f.getTarget(),t=f.getName(),i=l.getName()+"."+t,s(i,e,t)}}else if(l instanceof d.a)for(var m=0,g=l.getNumTarget();m<g;m++)t=l.getTargetName(m),i=t+"."+m,e=l.getTarget(m),s(i,e,t)}},_addAnimation:function(e){for(var t=[],i=0,r=e.length;i<r;i++){var a=e[i],n=a.name;if(!this._instanceAnimations[n]){var o=u.a.createInstanceAnimation(a);this._instanceAnimations[n]=o,t.push(o)}}return t},_addActiveChannels:function(e,t){for(var i=t.channels,r=0,a=i.length;r<a;r++){var n=i[r],o=n.channel.type;n.t=e,n.instanceAnimation=t;var s=n.targetID;s!==h.a.InvalidTargetID&&(this._activeChannelsByTypes[o].push(n),this._targets[s].channels.push(n))}},_removeActiveChannels:function(e){for(var t=e.channels,i=0,r=t.length;i<r;i++){var a=t[i],n=a.channel.type,o=a.targetID;if(o!==h.a.InvalidTargetID){var s=this._targets[o].channels,u=s.indexOf(a);s.splice(u,1);var l=this._activeChannelsByTypes[n],c=l.indexOf(a);l.splice(c,1)}}},_updateTargetType:function(e,t){for(var i=0,r=e.length;i<r;i++){var a=e[i],n=a.channels,o=n.length;if(0===o)a.value=t.copy(a.value,a.defaultValue);else if(1===o)a.value=t.copy(a.value,n[0].value);else{a.value=t.init(a.value);for(var s=0,u=0,l=n.length;u<l;u++){var c=n[u],h=c.weight;if(0!==(s+=h)&&0!==h){var d=h/s;a.value=t.lerp(a.value,a.value,c.value,d)}}}}},_updateChannelsType:function(e,t,i){for(var r=0,a=t.length;r<a;r++){var n=t[r],o=n.instanceAnimation,s=o.loop,u=e-n.t;s&&o.duration>0&&(u%=o.duration),i(u+o.firstKeyTime,n)}},_removeFinishedAnimation:function(e){for(var t=this._activeAnimationList,i=0;i<t.length;){var r=t[i],a=r.name;e>r.end&&!1===r.loop?(this._removeActiveChannels(r),this._activeAnimations[a]=void 0,t.splice(i,1)):i++}},_addActiveAnimation:function(e,t){this._activeAnimations[t.name]=t;var i=this._instanceAnimations[t.name];i.start=e,i.end=e+i.duration,this._addActiveChannels(e,i),this._activeAnimationList.push(i)},_processStartAnimation:function(e){if(this._targets.length){var t;for(t in this._startAnimations){var i=this._startAnimations[t],r=i.name;this.isPlaying(r)||this._addActiveAnimation(e,i)}void 0!==t&&(this._startAnimations={})}},_resetTargets:function(){this._targetMap={},this._targets.length=0;for(var e=0,t=this._targetsByTypes.length;e<t;e++)this._targetsByTypes[e].length=0},resetAllStackedTransforms:function(){for(var e=this._animationsUpdateCallbackArray,t=0,i=e.length;t<i;t++){for(var r=e[t].getStackedTransforms(),a=0,n=r.length;a<n;a++)r[a].resetToDefaultValue();e[t].computeChannels()}},setAnimationLerpEndStart:function(e,t){var i=e.channels;void 0===e.originalDuration&&(e.originalDuration=e.duration),e.duration=e.originalDuration+t;for(var r=e.firstKeyTime,a=e.originalDuration,n=0,o=i.length;n<o;++n){var s=i[n].channel;if(!(Math.abs(s.start-r)>.01||Math.abs(s.duration-a)>.01)){void 0===s.originalEnd&&(s.originalEnd=s.end),s.end=s.originalEnd+t;var u=f[s.type],l=s.times.buffer.byteLength/4;if(0===t)s.keys=new Float32Array(s.keys.buffer,0,(l-1)*u),s.times=new Float32Array(s.times.buffer,0,l-1);else{s.keys=new Float32Array(s.keys.buffer,0,l*u);for(var c=(l-1)*u,h=0;h<u;++h)s.keys[c+h]=s.keys[h];s.times=new Float32Array(s.times.buffer,0,l),s.times[l-1]=s.times[l-2]+t}}}}}),"osgAnimation","BasicAnimationManager"),g.TypeToSize=f,t.a=g},function(e,t,i){"use strict";var r=i(10),a=i(454),n=function(e,t,i){i[0]=t[e++],i[1]=t[e++],i[2]=t[e++]},o=function(e,t,i){i[0]=t[e++],i[1]=t[e++],i[2]=t[e++],i[3]=t[e++]},s=function(e,t){var i=t.channel,r=t.value,a=i.keys,o=i.times;if(e>=o[o.length-1])return t.key=0,void n(a.length-3,a,r);if(e<=o[0])return t.key=0,void n(0,a,r);var s=t.key;if(e>o[s])for(;o[s+1]<e;)s++;else if(e<o[s])for(;o[s]>e;)s--;var u=o[s],l=o[s+1],c=3*s,h=a[c++],d=a[c++],p=a[c++],f=a[c++],m=a[c++],g=a[c++],_=(e-u)/(l-u);r[0]=h+(f-h)*_,r[1]=d+(m-d)*_,r[2]=p+(g-p)*_,t.key=s},u=function(){var e=r.d.create32(),t=r.d.create32();return function(i,a){var n=a.channel,s=a.value,u=n.keys,l=n.times;if(i>=l[l.length-1])return a.key=0,void o(u.length-4,u,s);if(i<=l[0])return a.key=0,void o(0,u,s);var c=a.key;if(i>l[c])for(;l[c+1]<i;)c++;else if(i<l[c])for(;l[c]>i;)c--;var h=l[c],d=l[c+1],p=4*c;e[0]=u[p++],e[1]=u[p++],e[2]=u[p++],e[3]=u[p++],t[0]=u[p++],t[1]=u[p++],t[2]=u[p++],t[3]=u[p++];var f=(i-h)/(d-h);r.d.nlerp(s,e,t,f),a.key=c}}(),l=function(){var e=r.d.create32(),t=r.d.create32();return function(i,a){var n=a.channel,s=a.value,u=n.keys,l=n.times;if(i>=l[l.length-1])return a.key=0,void o(u.length-4,u,s);if(i<=l[0])return a.key=0,void o(0,u,s);var c=a.key;if(i>l[c])for(;l[c+1]<i;)c++;else if(i<l[c])for(;l[c]>i;)c--;var h=l[c],d=l[c+1],p=4*c;e[0]=u[p++],e[1]=u[p++],e[2]=u[p++],e[3]=u[p++],t[0]=u[p++],t[1]=u[p++],t[2]=u[p++],t[3]=u[p++];var f=(i-h)/(d-h);r.d.slerp(s,e,t,f),a.key=c}}(),c=function(e,t){var i=t.channel,r=t.value,a=i.keys,n=i.times;if(e>=n[n.length-1])return t.key=0,void(t.value=a[a.length-1]);if(e<=n[0])return t.key=0,void(t.value=a[0]);var o=t.key;if(e>n[o])for(;n[o+1]<e;)o++;else if(e<n[o])for(;n[o]>e;)o--;var s=n[o],u=n[o+1],l=o,c=a[l++];r=c+(a[l++]-c)*((e-s)/(u-s)),t.key=o,t.value=r},h=function(e,t){var i=t.channel,r=t.value,a=i.keys,n=i.times;if(e>=n[n.length-1])return t.key=0,void(t.value=a[a.length-3]);if(e<=n[0])return t.key=0,void(t.value=a[0]);var o=t.key;if(e>n[o])for(;n[o+1]<e;)o++;else if(e<n[o])for(;n[o]>e;)o--;var s=(e-n[o])/(n[o+1]-n[o]),u=1-s,l=u*u,c=l*u,h=s*s,d=3*o;r=a[d]*c+a[d+1]*(3*s*l)+a[d+2]*(3*h*u)+a[d+3]*(h*s),t.key=o,t.value=r},d=function(){var e=r.f.create(),t=r.f.create(),i=r.f.create(),a=r.f.create();return function(o,s){var u=s.channel,l=s.value,c=u.keys,h=u.times;if(o>=h[h.length-1])return s.key=0,void n(c.length-9,c,l);if(o<=h[0])return s.key=0,void n(0,c,l);var d=s.key;if(o>h[d])for(;h[d+1]<o;)d++;else if(o<h[d])for(;h[d]>o;)d--;var p=(o-h[d])/(h[d+1]-h[d]),f=1-p,m=f*f,g=m*f,_=p*p,v=9*d;r.f.scale(e,r.f.set(e,c[v++],c[v++],c[v++]),g),r.f.scale(t,r.f.set(t,c[v++],c[v++],c[v++]),3*p*m),r.f.scale(i,r.f.set(i,c[v++],c[v++],c[v++]),3*_*f),r.f.scale(a,r.f.set(a,c[v++],c[v++],c[v++]),_*p),l[0]=e[0]+t[0]+i[0]+a[0],l[1]=e[1]+t[1]+i[1]+a[1],l[2]=e[2]+t[2]+i[2]+a[2],s.key=d}}(),p=a.a.ChannelType,f={};f[p.Vec3]=s,f[p.Quat]=u,f[p.QuatSlerp]=l,f[p.Float]=c,f[p.FloatCubicBezier]=h,f[p.Vec3CubicBezier]=d,f.Vec3LerpInterpolator=s,f.QuatLerpInterpolator=u,f.QuatSlerpInterpolator=l,f.FloatLerpInterpolator=c,f.FloatCubicBezierInterpolator=h,f.Vec3CubicBezierInterpolator=d,t.a=f},function(e,t,i){"use strict";var r=i(9),a=i(54),n=i(547),o=function(){a.a.call(this),this._animationUpdateCallback={}};r.a.createPrototypeObject(o,r.a.objectInherit(a.a.prototype,{getAnimationUpdateCallbackMap:function(){return this._animationUpdateCallback},apply:function(e){for(var t=e.getUpdateCallbackList(),i=0,r=t.length;i<r;i++){var a=t[i];a instanceof n.a&&(this._animationUpdateCallback[a.getInstanceID()]=a)}this.traverse(e)}}),"osgAnimation","CollectAnimationUpdateCallbackVisitor"),t.a=o},function(e,t,i){"use strict";var r=i(9),a=i(71),n=i(10),o=i(400),s=function(e,t){a.a.call(this),this._target=o.a.createMatrixTarget(t||n.c.IDENTITY),e&&this.setName(e)};r.a.createPrototypeObject(s,r.a.objectInherit(a.a.prototype,{init:function(e){this.setMatrix(e),n.c.copy(this._target.defaultValue,e)},getTarget:function(){return this._target},getMatrix:function(){return this._target.value},setMatrix:function(e){n.c.copy(this._target.value,e)},resetToDefaultValue:function(){this.setMatrix(this._target.defaultValue)},applyToMatrix:function(e){n.c.mul(e,e,this._target.value)}}),"osgAnimation","StackedMatrix"),t.a=s},function(e,t,i){"use strict";var r=i(9),a=i(71),n=i(10),o=i(400),s=n.d.create(),u=function(e,t){a.a.call(this),this._target=o.a.createQuatTarget(t||s),e&&this.setName(e)};r.a.createPrototypeObject(u,r.a.objectInherit(a.a.prototype,{init:function(e){this.setQuaternion(e),n.d.copy(this._target.defaultValue,e)},setQuaternion:function(e){n.d.copy(this._target.value,e)},getTarget:function(){return this._target},resetToDefaultValue:function(){this.setQuaternion(this._target.defaultValue)},applyToMatrix:function(){var e=n.c.create();return function(t){var i=e;n.c.fromQuat(i,this._target.value),n.c.mul(t,t,i)}}()}),"osgAnimation","StackedQuaternion"),t.a=u},function(e,t,i){"use strict";var r=i(9),a=i(71),n=i(10),o=i(400),s=function(e,t){a.a.call(this),this._target=o.a.createVec3Target(t||n.f.ZERO),e&&this.setName(e)};r.a.createPrototypeObject(s,r.a.objectInherit(a.a.prototype,{init:function(e){this.setTranslate(e),n.f.copy(this._target.defaultValue,e)},setTranslate:function(e){n.f.copy(this._target.value,e)},getTarget:function(){return this._target},resetToDefaultValue:function(){this.setTranslate(this._target.defaultValue)},applyToMatrix:function(e){n.c.translate(e,e,this._target.value)}}),"osgAnimation","StackedTranslate"),t.a=s},function(e,t,i){"use strict";var r=i(7),a=i.n(r),n=function(e,t){return new a.a(function(i,r){var a=new XMLHttpRequest;a.open("GET",e,!0);var n=t&&t.responseType?t.responseType.toLowerCase():void 0;n&&(a.responseType=n),t&&t.progress&&a.addEventListener("progress",t.progress,!1),a.addEventListener("error",r,!1),a.addEventListener("load",function(){i("arraybuffer"===a.responseType||"blob"===a.responseType?a.response:a.responseText)}),a.send(null)})},o=function(e,t){return new a.a(function(i){var r=t&&t.responseType?t.responseType.toLowerCase():void 0,a=new window.FileReader;a.onload=function(e){i(e.target.result)},r?"arraybuffer"===r?a.readAsArrayBuffer(e):"blob"===r?i(e):"string"===r?a.readAsText(e):a.readAsDataURL(e):a.readAsText(e)})},s=function(e,t){return"string"==typeof e?n(e,t):o(e,t)};t.a=s},function(e,t,i){"use strict";var r=i(7),a=i.n(r),n=i(9),o=i(54),s=i(679),u=i(213),l=function(){o.a.call(this,o.a.TRAVERSE_ALL_CHILDREN),this._activePagedLODList=void 0,this._frameNumber=0};n.a.createPrototypeObject(l,n.a.objectInherit(o.a.prototype,{apply:function(e){e.getTypeID()===s.a.getTypeID()&&(e.setFrameNumberOfLastTraversal(this._frameNumber),this._activePagedLODList.add(e)),this.traverse(e)},set:function(e,t){this._activePagedLODList=e,this._frameNumber=t}}),"osgDB","FindPagedLODsVisitor");var c=function(){o.a.call(this,o.a.TRAVERSE_ALL_CHILDREN)};n.a.createPrototypeObject(c,n.a.objectInherit(o.a.prototype,{apply:function(e){e.releaseGLObjects(),this.traverse(e)}}),"osgDB","ReleaseVisitor");var h=function(){o.a.call(this,o.a.TRAVERSE_ALL_CHILDREN),this._childrenList=[]};n.a.createPrototypeObject(h,n.a.objectInherit(o.a.prototype,{apply:function(e){e.getTypeID()===s.a.getTypeID()&&(this._childrenList.push(e),this._markRequestsExpired(e)),this.traverse(e)},removeExpiredChildrenAndFindPagedLODs:function(e,t,i,r){if(!e.children.length)return!1;var a=r.length;e.removeExpiredChildren(t,i,r);for(var n=a;n<r.length;n++)r[n].accept(this);return a!==r.length},_markRequestsExpired:function(e){for(var t,i=e._perRangeDataList.length,r=0;r<i;r++)void 0!==(t=e.getDatabaseRequest(r))&&(t._groupExpired=!0,t._loadedModel=null)},reset:function(){this._childrenList.length=0}}),"osgDB","ExpiredPagedLODVisitor");var d=function(e,t){return t._timeStamp-e._timeStamp},p=function(e,t){var i=e._timeStamp-t._timeStamp;return 0===i&&(i=e._priority-t._priority),i},f=function(){this._pendingRequests=[],this._pendingNodes=[],this._loading=!1,this._progressCallback=void 0,this._lastCB=!0,this._activePagedLODList=new Set,this._childrenToRemoveList=new Set,this._downloadingRequestsNumber=0,this._maxRequestsPerFrame=10,this._acceptNewRequests=!0,this._releaseVisitor=new c,this._expiredPagedLODVisitor=new h,this._findPagedLODsVisitor=new l,this._targetMaximumNumberOfPagedLOD=75,this._elapsedTime=0,this._beginTime=0,this._availableTime=0},m=function(){this._loadedModel=void 0,this._group=void 0,this._url=void 0,this._function=void 0,this._timeStamp=0,this._groupExpired=!1,this._priority=0};n.a.createPrototypeObject(f,{setTargetMaximumNumberOfPageLOD:function(e){this._targetMaximumNumberOfPagedLOD=e},getTargetMaximumNumberOfPageLOD:function(){return this._targetMaximumNumberOfPagedLOD},setAcceptNewDatabaseRequests:function(e){this._acceptNewRequests=e},getAcceptNewDatabaseRequests:function(){return this._acceptNewRequests},reset:function(){this._pendingRequests=[],this._pendingNodes=[],this._loading=!1,this._lastCB=!0,this._activePagedLODList.clear(),this._childrenToRemoveList.clear(),this._downloadingRequestsNumber=0,this._maxRequestsPerFrame=10,this._acceptNewRequests=!0,this._targetMaximumNumberOfPagedLOD=75},updateSceneGraph:function(e){void 0!==this._progressCallback&&this.executeProgressCallback(),this.removeExpiredSubgraphs(e,.0025),this.takeRequests(),this.addLoadedDataToSceneGraph(e,.005)},executeProgressCallback:function(){this._pendingRequests.length>0||this._pendingNodes.length>0?(this._progressCallback(this._pendingRequests.length+this._downloadingRequestsNumber,this._pendingNodes.length),this._lastCB=!1):this._lastCB||(this._progressCallback(this._pendingRequests.length+this._downloadingRequestsNumber,this._pendingNodes.length),this._lastCB=!0)},setMaxRequestsPerFrame:function(e){this._maxRequestsPerFrame=e},getMaxRequestsPerFrame:function(){return this._maxRequestsPerFrame},getRequestListSize:function(){return this._pendingRequests.length+this._downloadingRequestsNumber},setProgressCallback:function(e){this._progressCallback=e},addLoadedDataToSceneGraph:function(e,t){if(!this._pendingNodes.length||t<=0)return 0;var i=0,r=u.a.instance().tick();this._pendingNodes.sort(d);for(var a=0;a<this._pendingNodes.length;a++){if(i>t)return 0;var n=this._pendingNodes.shift(),o=e.getFrameNumber(),s=e.getSimulationTime();if(!1===n._groupExpired){var l=n._group;l.setTimeStamp(l.children.length,s),l.setFrameNumber(l.children.length,o),l.addChildNode(n._loadedModel),this._activePagedLODList.has(l)?this.registerPagedLODs(n._loadedModel,o):this.registerPagedLODs(l,o)}else n._loadedModel=void 0,n=void 0;i=u.a.instance().deltaS(r,u.a.instance().tick())}return t-=i},isLoading:function(){return this._loading},registerPagedLODs:function(e,t){e&&(this._findPagedLODsVisitor.set(this._activePagedLODList,t),e.accept(this._findPagedLODsVisitor))},requestNodeFile:function(e,t,i,r,a){if(this._acceptNewRequests){var n=new m;return n._group=i,n._function=e,n._url=t,n._timeStamp=r,n._priority=a,this._pendingRequests.push(n),n}},takeRequests:function(){if(this._pendingRequests.length){var e=Math.min(this._maxRequestsPerFrame,this._pendingRequests.length);this._pendingRequests.sort(p);for(var t=0;t<e;t++)this._downloadingRequestsNumber++,this.processRequest(this._pendingRequests.shift())}},processRequest:function(e){this._loading=!0;var t=this;if(e._groupExpired)return t._downloadingRequestsNumber--,void(this._loading=!1);void 0!==e._function?this.loadNodeFromFunction(e._function,e._group).then(function(i){t._downloadingRequestsNumber--,e._loadedModel=i,t._pendingNodes.push(e),t._loading=!1}):""!==e._url&&this.loadNodeFromURL(e._url).then(function(i){t._downloadingRequestsNumber--,e._loadedModel=i,t._pendingNodes.push(e),t._loading=!1})},loadNodeFromFunction:function(e,t){var i=e(t);return i?i&&i.then?i:a.a.resolve(i):a.a.reject()},loadNodeFromURL:function(e){return i(418).default.readNodeURL(e)},releaseGLExpiredSubgraphs:function(e){return this._availableTime=e,!this._childrenToRemoveList.size||e<=0?0:(this._elapsedTime=0,this._beginTime=u.a.instance().tick(),this._childrenToRemoveList.forEach(this._releaseExpiredSubgraphs,this),this._availableTime-=this._elapsedTime,this._availableTime)},_releaseExpiredSubgraphs:function(e){this._elapsedTime>this._availableTime||(this._childrenToRemoveList.delete(e),e.accept(this._releaseVisitor),e.removeChildren(),e=null,this._elapsedTime=u.a.instance().deltaS(this._beginTime,u.a.instance().tick()))},removeExpiredSubgraphs:function(e,t){if(0===e.getFrameNumber())return 0;var i=this._activePagedLODList.size-this._targetMaximumNumberOfPagedLOD,r=e.getSimulationTime()-.1,a=e.getFrameNumber()-1;return i>0&&(t=this.removeExpiredChildren(i,r,a,t)),t},removeExpiredChildren:function(e,t,i,r){var a=0,n=u.a.instance().tick(),o=this,s=[],l=this._expiredPagedLODVisitor;return l.reset(),this._activePagedLODList.forEach(function(c){if(a>r)return 0;if(e<0)return r;if(i<c.getFrameNumberOfLastTraversal())return r;l.removeExpiredChildrenAndFindPagedLODs(c,t,i,s);for(var h=0;h<l._childrenList.length;h++)o._activePagedLODList.delete(l._childrenList[h]),e--;for(h=0;h<s.length;h++)o._childrenToRemoveList.add(s[h]);l._childrenList.length=0,s.length=0,a=u.a.instance().deltaS(n,u.a.instance().tick())}),r-=a}},"osgDB","DatabasePager"),t.a=f},function(e,t,i){"use strict";var r=i(7),a=i.n(r),n=i(9),o=i(21),s=i(596),u=i(454),l=i(593),c=i(418),h=i(799),d=i(683),p=i(398),f=i(121),m=n.a.rejectObject,g={},_=function(){},v=c.default.registry();v.registerObject("osgAnimation.Vec3LerpChannel",_),v.registerObject("osgAnimation.FloatLerpChannel",_),v.registerObject("osgAnimation.QuatSlerpChannel",_),v.registerObject("osgAnimation.QuatLerpChannel",_),v.registerObject("osgAnimation.FloatCubicBezierChannel",_),v.registerObject("osgAnimation.Vec3CubicBezierChannel",_),v.registerObject("osgAnimation.StackedMatrixElement",h.a),v.registerObject("osgAnimation.StackedScaleElement",d.a),g.Animation=function(e){var t=e.getJSON();if(void 0===t.Name||!t.Channels||0===t.Channels.length)return m("Animation",t);for(var i=[],r=0,n=t.Channels.length;r<n;r++){var o=e.setJSON(t.Channels[r]).readObject();i.push(o)}return a.a.all(i).then(function(e){return l.a.createAnimation(e,t.Name)})},g.StandardVec3Channel=function(e,t,i){var r=e.getJSON();if(!(void 0!==r.TargetName&&r.KeyFrames&&r.Name&&r.KeyFrames.Time&&r.KeyFrames.Key&&3===r.KeyFrames.Key.length))return m("StandardVec3Channel",r);var n=e.setJSON(r.KeyFrames.Time).readBufferArray(),o=e.setJSON(r.KeyFrames.Key[0]).readBufferArray(),s=e.setJSON(r.KeyFrames.Key[1]).readBufferArray(),u=e.setJSON(r.KeyFrames.Key[2]).readBufferArray();return a.a.all([n,o,s,u]).then(function(e){for(var a=e[0].getElements(),n=e[1].getElements(),o=e[2].getElements(),s=e[3].getElements(),u=a.length,l=new Float32Array(new ArrayBuffer(4*(u+1)*3),0,3*u),c=new Float32Array(new ArrayBuffer(4*(u+1)),0,u),h=0;h<u;h++){var d=3*h;c[h]=a[h],l[d++]=n[h],l[d++]=o[h],l[d]=s[h]}return i(l,c,r.TargetName,r.Name,t),t})},g.StandardQuatChannel=function(e,t,i){var r=e.getJSON();if(!(void 0!==r.TargetName&&r.KeyFrames&&r.Name&&r.KeyFrames.Time&&r.KeyFrames.Key&&4===r.KeyFrames.Key.length))return m("StandardQuatChannel",r);var n=e.setJSON(r.KeyFrames.Time).readBufferArray(),o=e.setJSON(r.KeyFrames.Key[0]).readBufferArray(),s=e.setJSON(r.KeyFrames.Key[1]).readBufferArray(),u=e.setJSON(r.KeyFrames.Key[2]).readBufferArray(),l=e.setJSON(r.KeyFrames.Key[3]).readBufferArray();return a.a.all([n,o,s,u,l]).then(function(e){for(var a=e[0].getElements(),n=e[1].getElements(),o=e[2].getElements(),s=e[3].getElements(),u=e[4].getElements(),l=a.length,c=new Float32Array(new ArrayBuffer(4*(l+1)*4),0,4*l),h=new Float32Array(new ArrayBuffer(4*(l+1)),0,l),d=0;d<l;d++){var p=4*d;h[d]=a[d],c[p++]=n[d],c[p++]=o[d],c[p++]=s[d],c[p]=u[d]}return i(c,h,r.TargetName,r.Name,t),t})},g.StandardFloatChannel=function(e,t,i){var r=e.getJSON();if(!(void 0!==r.TargetName&&r.KeyFrames&&r.Name&&r.KeyFrames.Time&&r.KeyFrames.Key))return m("StandardFloatChannel",r);var n=e.setJSON(r.KeyFrames.Time).readBufferArray(),o=e.setJSON(r.KeyFrames.Key).readBufferArray();return a.a.all([n,o]).then(function(e){for(var a=e[0].getElements(),n=e[1].getElements(),o=a.length,s=new Float32Array(new ArrayBuffer(4*(o+1)),0,o),u=new Float32Array(new ArrayBuffer(4*(o+1)),0,o),l=0;l<o;l++)u[l]=a[l],s[l]=n[l];return i(s,u,r.TargetName,r.Name,t),t})},g.Vec3LerpChannel=function(e,t){return g.StandardVec3Channel(e,t,u.a.createVec3Channel)},g.QuatLerpChannel=function(e,t){return g.StandardQuatChannel(e,t,u.a.createQuatChannel)},g.QuatSlerpChannel=function(e,t){return g.StandardQuatChannel(e,t,u.a.createQuatChannel)},g.FloatLerpChannel=function(e,t){return g.StandardFloatChannel(e,t,u.a.createFloatChannel)},g.FloatCubicBezierChannel=function(e,t){var i=e.getJSON();if(!(void 0!==i.TargetName&&i.KeyFrames&&i.Name&&i.KeyFrames.Time&&i.KeyFrames.Position&&i.KeyFrames.ControlPointOut&&i.KeyFrames.ControlPointIn))return m("FloatCubicBezierChannel",i);var r,n=[],o=window.Object.keys(i.KeyFrames);for(r=0;r<o.length;r++)n.push(e.setJSON(i.KeyFrames[o[r]]).readBufferArray());return a.a.all(n).then(function(e){var a=e[0].getElements(),n=e[1].getElements(),o=e[2].getElements(),s=e[3].getElements(),l=s.length,c=new Float32Array(new ArrayBuffer(4*(l+1)*3),0,3*l),h=new Float32Array(new ArrayBuffer(4*(l+1)),0,l);for(r=0;r<l;r++){var d=3*r;h[r]=s[r],c[d++]=o[r],c[d++]=a[r],c[d]=n[r]}return u.a.createFloatCubicBezierChannel(c,h,i.TargetName,i.Name,t),t})},g.Vec3CubicBezierChannel=function(e,t){var i=e.getJSON();if(!(void 0!==i.TargetName&&i.KeyFrames&&i.Name&&i.KeyFrames.Time&&i.KeyFrames.Position&&i.KeyFrames.ControlPointOut&&i.KeyFrames.ControlPointIn&&3===i.KeyFrames.Position.length&&3===i.KeyFrames.ControlPointIn.length&&3===i.KeyFrames.ControlPointOut.length))return m("Vec3CubicBezierChannel",i);var r,n=[],o=window.Object.keys(i.KeyFrames);for(r=0;r<o.length;r++){var s=o[r],l=i.KeyFrames[s];"Time"!==s?(n.push(e.setJSON(l[0]).readBufferArray()),n.push(e.setJSON(l[1]).readBufferArray()),n.push(e.setJSON(l[2]).readBufferArray())):n.push(e.setJSON(l).readBufferArray())}return a.a.all(n).then(function(e){var a=e[0].getElements(),n=e[1].getElements(),o=e[2].getElements(),s=e[3].getElements(),l=e[4].getElements(),c=e[5].getElements(),h=e[6].getElements(),d=e[7].getElements(),p=e[8].getElements(),f=e[9].getElements(),m=f.length,g=new Float32Array(new ArrayBuffer(4*(m+1)*9),0,9*m),_=new Float32Array(new ArrayBuffer(4*(m+1)),0,m);for(r=0;r<m;r++){var v=9*r;_[r]=f[r],g[v++]=h[r],g[v++]=d[r],g[v++]=p[r],g[v++]=a[r],g[v++]=n[r],g[v++]=o[r],g[v++]=s[r],g[v++]=l[r],g[v]=c[r]}return u.a.createVec3CubicBezierChannel(g,_,i.TargetName,i.Name,t),t})},g.BasicAnimationManager=function(e,t){var i=e.getJSON();if(!i.Animations)return m("BasicAnimationManager",i);s.a.Object(e,t);for(var r=[],n=0,u=i.Animations.length;n<u;n++){var l=e.setJSON(i.Animations[n]).readObject();l.isRejected()?o.a.warn("An Animation failed on the parsing!"):r.push(l)}return a.a.all(r).then(function(e){return t.init(e),t})},g.UpdateMatrixTransform=function(e,t){var i=e.getJSON();if(/*!jsonObj.Name ||*/!i.StackedTransforms)return m("UpdateMatrixTransform",i);s.a.Object(e,t);var r,n,u=[];for(r=0,n=i.StackedTransforms.length;r<n;r++){var l=e.setJSON(i.StackedTransforms[r]).readObject();l.isRejected()?o.a.warn("A stacked transforms failed on the parsing!"):u.push(l)}return a.a.all(u).then(function(e){var i=t.getStackedTransforms();for(r=0,n=e.length;r<n;r++)i.push(e[r]);return t.computeChannels(),t})},g.StackedTranslate=function(e,t){var i=e.getJSON();return i.Name&&i.Translate?(s.a.Object(e,t),t.init(i.Translate),a.a.resolve(t)):m("StackedTranslate",i)},g.StackedQuaternion=function(e,t){var i=e.getJSON();return i.Name&&i.Quaternion?(s.a.Object(e,t),t.init(i.Quaternion),a.a.resolve(t)):m("StackedQuaternion",i)},g.StackedRotateAxis=function(e,t){var i=e.getJSON();return i.Axis&&void 0!==i.Angle?(s.a.Object(e,t),t.init(i.Axis,i.Angle),a.a.resolve(t)):m("StackedRotateAxis",i)},g.StackedMatrix=function(e,t){var i=e.getJSON();return i.Name&&i.Matrix?(s.a.Object(e,t),t.init(i.Matrix),a.a.resolve(t)):m("StackedMatrix",i)},g.StackedScale=function(e,t){var i=e.getJSON();return i.Name&&i.Scale?(s.a.Object(e,t),t.init(i.Scale),a.a.resolve(t)):m("StackedScale",i)},g.Bone=function(e,t){var i=e.getJSON();if(!i.InvBindMatrixInSkeletonSpace)return m("Bone",i);var r=s.a.MatrixTransform(e,t);if(t.setInvBindMatrixInSkeletonSpace(i.InvBindMatrixInSkeletonSpace),i.BoundingBox){var a=t.getBoneBoundingBox();a.setMax(i.BoundingBox.max),a.setMin(i.BoundingBox.min)}return r},g.UpdateBone=g.UpdateMatrixTransform,g.UpdateSkeleton=function(e,t){return s.a.Object(e,t),a.a.resolve(t)},g.Skeleton=s.a.MatrixTransform,g.RigGeometry=function(e,t){var i=e.getJSON();if(!i.SourceGeometry)return m("RigGeometry",i);i.BoneMap||o.a.warn("No boneMap found in a RigGeometry !");var r=s.a.Geometry(e,t);t._boneNameID=i.BoneMap;var n,u=i.SourceGeometry["osg.Geometry"];return u?(e.setJSON(u),t.setSourceGeometry(new f.a),n=s.a.Geometry(e,t.getSourceGeometry())):(u=i.SourceGeometry["osgAnimation.MorphGeometry"],u?(e.setJSON(u),t.setSourceGeometry(new p.a),n=g.MorphGeometry(e,t.getSourceGeometry())):o.a.warn("SourceGeometry type no recognized")),void 0===t._uniqueID&&(t._uniqueID=u.UniqueID),a.a.all([r,n]).then(function(){return t.mergeChildrenData(),t})},g.MorphGeometry=function(e,t){var i=e.getJSON();if(!i.MorphTargets)return m("MorphGeometry",i);var r=i.MorphTargets,n=[];n.push(s.a.Geometry(e,t));for(var o=0,u=r.length;o<u;o++)n.push(e.setJSON(r[o]).readObject());return a.a.all(n).then(function(e){for(var t=e[0],i=t.getMorphTargets(),r=1,a=e.length;r<a;r++)i.push(e[r]);return t.mergeChildrenVertexAttributeList(),t})},g.UpdateMorph=function(e,t){var i=e.getJSON();if(!i.TargetMap)return m("UpdateMorph",i);s.a.Object(e,t);for(var r=window.Object.keys(i.TargetMap),n=0,o=r.length;n<o;n++){var u=r[n];t.addTarget(i.TargetMap[u],parseInt(u,10))}return a.a.resolve(t)},g.StackedMatrixElement=g.StackedMatrix,g.StackedScaleElement=g.StackedScale,t.a=g},function(e,t,i){"use strict";var r=i(7),a=i.n(r),n=i(596),o=i(21),s=i(806),u={};u.Text=function(e,t){var i=e.getJSON();if(!i.Text)return a.a.reject();var r=n.a.Node(e,t);if(t.setColor(i.Color),t.setText(i.Text),t.setAutoRotateToScreen(i.AutoRotateToScreen),t.setPosition(i.Position),t.setCharacterSize(i.CharacterSize),"VERTICAL"===i.Layout)return o.a.error("Vertical Alignment not supported"),a.a.reject();var u=i.Alignment;return i.Alignment.indexOf("BASE_LINE")>-1&&("LEFT_BASE_LINE"===i.Alignment?u=s.a.LEFT_CENTER:"CENTER_BASE_LINE"===i.Alignment?u=s.a.CENTER_CENTER:"RIGHT_BASE_LINE"===i.Alignment?u=s.a.RIGHT_CENTER:"LEFT_BOTTOM_BASE_LINE"===i.Alignment?u=s.a.LEFT_BOTTOM:"CENTER_BOTTOM_BASE_LINE"===i.Alignment?u=s.a.CENTER_BOTTOM:"RIGHT_BOTTOM_BASE_LINE"===i.Alignment&&(u=s.a.RIGHT_BOTTOM)),t.setAlignment(u),t.setLayout(i.Layout),r},t.a=u},function(e,t,i){"use strict";var r=i(545),a=i(9),n=i(10),o=i(673),s=i(143),u=i(399),l=i(84),c=i(247),h=i(54),d=i(98),p=function(e){o.a.call(this),this._canvas=document.createElement("canvas"),this._context=this._canvas.getContext("2d"),this._matrixTransform=new s.a,this.addChild(this._matrixTransform),this._text="",void 0!==e&&(this._text=e),this._font="monospace",this._color=n.g.fromValues(0,0,0,1),this._fillStyle="rgba( 0, 0, 0, 1 )",this._context.textAlign="center",this._textX=void 0,this._context.baseLine="middle",this._textY=void 0,this._characterSize=1,this._characterSizeMode=p.OBJECT_COORDS,this._fontSize=32,this._geometry=void 0,this._autoRotateToScreen=!1,this._position=n.f.create(),this._layout=p.LEFT_TO_RIGHT,this._alignment=p.CENTER_CENTER,this._forcePowerOfTwo=!1,this._texture=new l.default,this.drawText(),this._dirty=!1,this._previousModelView=n.c.create()};p.OBJECT_COORDS=0,p.SCREEN_COORDS=1,p.OBJECT_COORDS_WITH_MAXIMUM_SCREEN_SIZE_CAPPED_BY_FONT_HEIGHT=2,p.LEFT_TO_RIGHT="ltr",p.RIGHT_TO_LEFT="rtl",p.LEFT_TOP=0,p.LEFT_CENTER=1,p.LEFT_BOTTOM=2,p.CENTER_TOP=3,p.CENTER_CENTER=4,p.CENTER_BOTTOM=5,p.RIGHT_TOP=6,p.RIGHT_CENTER=7,p.RIGHT_BOTTOM=8,a.a.createPrototypeNode(p,a.a.objectInherit(o.a.prototype,{drawText:function(){if(void 0!==this._geometry&&(this._matrixTransform.removeChild(this._geometry),this._geometry.releaseGLObjects()),this._text){this.setTextProperties(),this._canvas.width=this._context.measureText(this._text).width,this._canvas.height=2*this._fontSize,this._forcePowerOfTwo&&(this._canvas.width=this._nextPowerOfTwo(this._canvas.width),this._canvas.height=this._nextPowerOfTwo(this._canvas.height)),this.setTextProperties(),this._context.clearRect(0,0,this._canvas.width,this._canvas.height),this._context.fillText(this._text,this._textX,this._textY);var e=this._canvas.width/this._canvas.height,t=this._characterSize*e;this._geometry=u.a.createTexturedQuadGeometry(-t/2,-this._characterSize/2,0,t,0,0,0,this._characterSize,0),this._texture.setTextureSize(this._canvas.width,this._canvas.height),this._texture.setMinFilter("LINEAR"),this._texture.setMagFilter("LINEAR"),this._texture.setImage(this._canvas);var i=this._geometry.getOrCreateStateSet();i.setTextureAttributeAndModes(0,this._texture),i.setRenderingHint("TRANSPARENT_BIN"),i.setAttributeAndModes(new c.a(c.a.ONE,c.a.ONE_MINUS_SRC_ALPHA)),this._matrixTransform.addChild(this._geometry),this.dirtyBound()}},setText:function(e){this._text=e,this._dirty=!0},getText:function(){return this._text},setFont:function(e){this._font=e,this._dirty=!0},setColor:function(e){this._color=e,this._fillStyle="rgba("+Math.round(255*e[0])+","+Math.round(255*e[1])+","+Math.round(255*e[2])+","+e[3]+")",this._context.fillStyle=this._fillStyle,this._context.fillText(this._text,this._textX,this._textY)},getColor:function(){return this._color},setCharacterSize:function(e){this._characterSize=e,this._characterSizeMode!==p.OBJECT_COORDS&&(n.c.fromScaling(this._matrixTransform.getMatrix(),[this._characterSize,this._characterSize,this._characterSize]),this._characterSizeMode===p.OBJECT_COORDS_WITH_MAXIMUM_SCREEN_SIZE_CAPPED_BY_FONT_HEIGHT&&this.setMaximumScale(this._characterSize)),this._dirty=!0},getCharacterSize:function(){return this._characterSize},setCharacterSizeMode:function(e){this._characterSizeMode=e,this._characterSizeMode!==p.OBJECT_COORDS?(n.c.fromScaling(this._matrixTransform.getMatrix(),[this._characterSize,this._characterSize,this._characterSize]),this.setAutoScaleToScreen(!0),this.setMaximumScale(Number.MAX_VALUE),this._characterSizeMode===p.OBJECT_COORDS_WITH_MAXIMUM_SCREEN_SIZE_CAPPED_BY_FONT_HEIGHT&&this.setMaximumScale(this._characterSize)):(this._matrixTransform.setMatrix(n.c.create()),this.setAutoScaleToScreen(!1)),this._dirty=!0},getCharacterSizeMode:function(){return this._characterSizeMode},setFontResolution:function(e){this._fontSize=e,this._dirty=!0},getFontResolution:function(){return this._fontSize},setPosition:function(e){this._position=e,n.c.fromTranslation(this.getMatrix(),e)},getPosition:function(){return this._position},setTextProperties:function(){this._context.fillStyle=this._fillStyle,this._setAlignmentValues(this._alignment),this._context.font=this._fontSize+"px "+this._font,this._context.direction=this._layout},setAutoRotateToScreen:function(e){o.a.prototype.setAutoRotateToScreen.call(this,e),this._dirty=!0},getAutoRotateToScreen:function(){return this._autoRotateToScreen},setLayout:function(e){this._layout="string"==typeof e?p[e]:e,this._dirty=!0},getLayout:function(){return this._layout},setAlignment:function(e){this._alignment="string"==typeof e?p[e]:e,this._dirty=!0},getAlignment:function(){return this._alignment},accept:function(){return function(e){if(this._dirty&&(this.drawText(),this._dirty=!1),e.getVisitorType()===h.a.CULL_VISITOR){var t=e.getViewport().width(),i=e.getViewport().height(),r=e.getCurrentProjectionMatrix(),a=e.getCurrentModelViewMatrix(),o=this._position,s=this._firstTimeToInitEyePoint;if(this._firstTimeToInitEyePoint||(n.c.exactEquals(a,this._previousModelView)?t!==this._previousWidth||i!==this._previousHeight?s=!0:n.c.exactEquals(r,this._previousProjection)?n.f.exactEquals(o,this._previousPosition)||(s=!0):s=!0:s=!0),this._firstTimeToInitEyePoint=!1,s){if(this._autoScaleToScreen){var u=e.getViewport(),l=this.computePixelSizeVector(u,r,a),c=n.g.fromValues(this._position[0],this._position[1],this._position[2],1),p=n.g.dot(c,l);p=.48/p;var f=1/p;if(this._autoScaleTransitionWidthRatio>0){var m,g,_;if(this._minimumScale>0){var v=this._minimumScale,b=this._maximumScale<Number.MAX_VALUE?this._minimumScale+(this._maximumScale-this._minimumScale)*this._autoScaleTransitionWidthRatio:this._minimumScale*(1+this._autoScaleTransitionWidthRatio);m=1/(4*(b-v)),g=1-2*m*b,_=v+g*g/(4*m);f<-g/(2*m)?f=this._minimumScale:f<b&&(f=_+g*f+m*(f*f))}if(this._maximumScale<Number.MAX_VALUE){var y=this._maximumScale,x=this._minimumScale>0?this._maximumScale+(this._minimumScale-this._maximumScale)*this._autoScaleTransitionWidthRatio:this._maximumScale*(1-this._autoScaleTransitionWidthRatio);m=1/(4*(x-y)),g=1-2*m*x,_=y+g*g/(4*m);f>-g/(2*m)?f=this._maximumScale:f>x&&(f=_+g*f+m*(f*f))}}this.setScale(f)}if(this._autoRotateToScreen){var S=n.d.create(),M=e.getCurrentModelViewMatrix();n.c.getRotation(S,M),this.setRotation(n.d.invert(S,S))}this._previousWidth=t,this._previousHeight=i,n.f.copy(this._previousPosition,o),n.c.copy(this._previousProjection,r),n.c.copy(this._previousModelView,a)}}d.a.prototype.accept.call(this,e)}}(),_setAlignmentValues:function(e){switch(e){case p.LEFT_TOP:this._context.textAlign="left",this._textX=0,this._context.textBaseline="top",this._textY=0;break;case p.LEFT_CENTER:this._context.textAlign="left",this._textX=0,this._context.textBaseline="middle",this._textY=this._canvas.height/2;break;case p.LEFT_BOTTOM:this._context.textAlign="left",this._textX=0,this._context.textBaseline="bottom",this._textY=this._canvas.height;break;case p.CENTER_TOP:this._context.textAlign="center",this._textX=this._canvas.width/2,this._context.textBaseline="top",this._textY=0;break;case p.CENTER_CENTER:this._context.textAlign="center",this._textX=this._canvas.width/2,this._context.textBaseline="middle",this._textY=this._canvas.height/2;break;case p.CENTER_BOTTOM:this._context.textAlign="center",this._textX=this._canvas.width/2,this._context.textBaseline="bottom",this._textY=this._canvas.height;break;case p.RIGHT_TOP:this._context.textAlign="right",this._textX=this._canvas.width,this._context.textBaseline="top",this._textY=0;break;case p.RIGHT_CENTER:this._context.textAlign="right",this._textX=this._canvas.width,this._context.textBaseline="middle",this._textY=this._canvas.height/2;break;case p.RIGHT_BOTTOM:this._context.textAlign="right",this._textX=this._canvas.width,this._context.textBaseline="bottom",this._textY=this._canvas.height}},setForcePowerOfTwo:function(e){this._forcePowerOfTwo=e},getForcePowerOfTwo:function(){return this._forcePowerOfTwo},_nextPowerOfTwo:function(e){var t=e;return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}}),"osgText","Text"),r.a.registerApplyFunction(p.nodeTypeID,r.a.getApplyFunction(o.a.nodeTypeID)),t.a=p},function(e,t,i){"use strict";var r=i(9),a=i(10),n=i(600),o=function(){n.a.Intersection.call(this),this._localIntersectionNormal=a.f.clone(a.f.ONE),this._i1=-1,this._i2=-1,this._i3=-1,this._r1=0,this._r2=0,this._r3=0},s=function(){n.a.call(this),this._threshold=0,this._d=a.f.create(),this._length=0,this._invLength=0,this._start=a.f.create(),this._end=a.f.create(),this._dInvX=a.f.create(),this._dInvY=a.f.create(),this._dInvZ=a.f.create(),this._hit=!1};r.a.createPrototypeObject(s,r.a.objectInherit(n.a.prototype,{set:function(e,t,i){this._start=e,this._end=t,a.f.sub(this._d,t,e),this._length=a.f.length(this._d),this._invLength=0!==this._length?1/this._length:0,a.f.scale(this._d,this._d,this._invLength),0!==this._d[0]&&a.f.scale(this._dInvX,this._d,1/this._d[0]),0!==this._d[1]&&a.f.scale(this._dInvY,this._d,1/this._d[1]),0!==this._d[2]&&a.f.scale(this._dInvZ,this._d,1/this._d[2]),void 0!==i&&(this._threshold=i)},enter:function(e,t,i){var r=e._min,n=r[0],o=r[1],s=r[2],u=e._max,l=u[0],c=u[1],h=u[2],d=this._dInvX,p=this._dInvY,f=this._dInvZ;if(t[0]<=i[0]){if(i[0]<n)return!1;if(t[0]>l)return!1;t[0]<n&&a.f.scaleAndAdd(t,t,d,n-t[0]),i[0]>l&&a.f.scaleAndAdd(i,t,d,l-t[0])}else{if(t[0]<n)return!1;if(i[0]>l)return!1;i[0]<n&&a.f.scaleAndAdd(i,t,d,n-t[0]),t[0]>l&&a.f.scaleAndAdd(t,t,d,l-t[0])}if(t[1]<=i[1]){if(i[1]<o)return!1;if(t[1]>c)return!1;t[1]<o&&a.f.scaleAndAdd(t,t,p,o-t[1]),i[1]>c&&a.f.scaleAndAdd(i,t,p,c-t[1])}else{if(t[1]<o)return!1;if(i[1]>c)return!1;i[1]<o&&a.f.scaleAndAdd(i,t,p,o-t[1]),t[1]>c&&a.f.scaleAndAdd(t,t,p,c-t[1])}if(t[2]<=i[2]){if(i[2]<s)return!1;if(t[2]>h)return!1;t[2]<s&&a.f.scaleAndAdd(t,t,f,s-t[2]),i[2]>h&&a.f.scaleAndAdd(i,t,f,h-t[2])}else{if(t[2]<s)return!1;if(i[2]>h)return!1;i[2]<s&&a.f.scaleAndAdd(i,t,f,s-t[2]),t[2]>h&&a.f.scaleAndAdd(t,t,f,h-t[2])}return!0},intersectPoint:function(){var e=a.f.create(),t=a.f.create();return function(i,r){var n=this._start;a.f.sub(e,i,n),a.f.sub(t,this._end,n);var s=a.f.dot(e,t)*this._invLength*this._invLength;if(!((s<0?a.f.sqrLen(e):s>1?a.f.sqrDist(i,this._end):a.f.sqrLen(a.f.scaleAndAdd(e,e,t,-s)))>this._threshold*this._threshold)){var u=this.initIntersection(new o);u._i1=r,u._r1=1,a.f.scaleAndAdd(u._localIntersectionPoint,n,t,s),u._ratio=s}}}(),intersectLine:function(){var e=a.f.create(),t=a.f.create(),i=a.f.create(),r=a.f.create(),n=a.f.create();return function(s,u,l,c){a.f.sub(e,u,s),a.f.sub(t,this._end,this._start),a.f.sub(i,s,this._start);var h,d,p=a.f.dot(e,e),f=a.f.dot(e,t),m=a.f.dot(t,t),g=a.f.dot(e,i),_=a.f.dot(t,i),v=p*m-f*f,b=v,y=v;v<1e-8?(h=0,b=1,d=_,y=m):(h=f*_-m*g,d=p*_-f*g,h<0?(h=0,d=_,y=m):h>b&&(h=b,d=_+f,y=m)),d<0?(d=0,-g<0?h=0:-g>p?h=b:(h=-g,b=p)):d>y&&(d=y,-g+f<0?h=0:-g+f>p?h=b:(h=-g+f,b=p));var x=Math.abs(h)<1e-8?0:h/b,S=Math.abs(d)<1e-8?0:d/y;if(a.f.scaleAndAdd(r,s,e,x),a.f.scaleAndAdd(n,this._start,t,S),!(a.f.sqrDist(r,n)>this._threshold*this._threshold)){var M=this.initIntersection(new o);M._i1=l,M._i2=c,M._r1=1-S,M._r2=S,a.f.copy(M._localIntersectionPoint,n),M._ratio=S}}}(),intersectTriangle:function(){var e=a.f.create(),t=a.f.create(),i=a.f.create(),r=a.f.create(),n=a.f.create(),s=a.f.create();return function(u,l,c,h,d,p){var f=this._d;a.f.sub(t,c,u),a.f.sub(i,l,u),a.f.cross(n,f,t);var m=a.f.dot(n,i);if(!(m>-1e-20&&m<1e-20)){var g=1/m;a.f.sub(r,this._start,u);var _=a.f.dot(n,r)*g;if(!(_<0||_>1)){a.f.cross(s,r,i);var v=a.f.dot(s,f)*g;if(!(v<0||_+v>1)){var b=a.f.dot(s,t)*g;if(!(b<1e-20||b>this._length)){var y=1-_-v,x=_,S=v,M=b*this._invLength,w=u[0]*y+l[0]*x+c[0]*S,T=u[1]*y+l[1]*x+c[1]*S,C=u[2]*y+l[2]*x+c[2]*S;a.f.cross(e,i,t),a.f.normalize(e,e);var E=this.initIntersection(new o);E._i1=h,E._i2=d,E._i3=p,E._r1=y,E._r2=x,E._r3=S,a.f.set(E._localIntersectionPoint,w,T,C),a.f.copy(E._localIntersectionNormal,e),E._ratio=M,E._backface=a.c.determinant(E._matrix)*m<0}}}}}}(),operatorPoint:function(e){this._threshold<=0||n.a.prototype.operatorPoint.call(this,e)},operatorLine:function(e,t){this._threshold<=0||n.a.prototype.operatorLine.call(this,e,t)}}),"osgUtil","LineSegmentIntersectFunctor"),t.a=s},function(e,t,i){"use strict";var r=i(9),a=i(10),n=i(675),o=i(451),s=i(598),u=i(809),l=function(){s.a.call(this),this._index=0,this._polytope=new n.a,this._iPolytope=new n.a,this._referencePlane=a.g.create(),this._iReferencePlane=a.g.create()},c=function(e,t,i){var r=t[0],a=t[1],n=t[2],o=t[3];e[0]=i[0]*r+i[1]*a+i[2]*n+i[3]*o,e[1]=i[4]*r+i[5]*a+i[6]*n+i[7]*o,e[2]=i[8]*r+i[9]*a+i[10]*n+i[11]*o,e[3]=i[12]*r+i[13]*a+i[14]*n+i[15]*o};r.a.createPrototypeObject(l,r.a.objectInherit(s.a.prototype,{setPolytope:function(e){this._polytope.setPlanes(e);for(var t=[],i=0;i<e.length;++i){var r=e[i];t[i]=a.g.copy(this._iPolytope.getPlanes()[i]||o.a.create(),r)}this._iPolytope.setPlanes(t),a.g.copy(this._referencePlane,e[e.length-1]),a.g.copy(this._iReferencePlane,this._referencePlane)},getPolytope:function(){return this._iPolytope},setPolytopeFromWindowCoordinates:function(e,t,i,r){this.setPolytope([a.g.fromValues(1,0,0,-e),a.g.fromValues(-1,0,0,i),a.g.fromValues(0,1,0,-t),a.g.fromValues(0,-1,0,r),a.g.fromValues(0,0,1,0)])},intersectBoundingBox:function(e){return this._iPolytope.containsBoundingBox(e)},intersectBoundingSphere:function(e){return this._iPolytope.containsBoundingSphere(e)},intersect:function(){var e=new u.a;return function(t,i){e.setGeometry(i),e.setIntersectionVisitor(t),e.setIntersector(this);var r=i.getShape();r?r.intersect(e,r.getNodes()[0]):(i.computeTransformedVertices&&e.setVertices(i.computeTransformedVertices()),e.apply(i)),e.reset()}}(),setCurrentTransformation:function(e){for(var t=this._polytope.getPlanes(),i=this._iPolytope.getPlanes(),r=0,n=t.length;r<n;r++){var o=i[r]=i[r]||a.g.create();c(o,t[r],e),a.g.scale(o,o,1/a.f.len(o))}c(this._iReferencePlane,this._referencePlane,e),a.g.scale(this._iReferencePlane,this._iReferencePlane,1/a.f.len(this._iReferencePlane))}}),"osgUtil","PolytopeIntersector"),t.a=l},function(e,t,i){"use strict";var r=i(9),a=i(10),n=i(451),o=i(600),s=function(){o.a.Intersection.call(this),this._intersectionPoints=[],this._distance=0,this._maxDistance=0,this._numIntersectionPoints=0},u=function(){o.a.call(this),this._src=[],this._dest=[],this._maxNumIntersectionsPoints=6};r.a.createPrototypeObject(u,r.a.objectInherit(o.a.prototype,{reset:function(){o.a.prototype.reset.call(this),this._src=[],this._dest=[]},enter:function(e){return!!this._intersector.getPolytope().containsBoundingBox(e)&&(this._intersector.getPolytope().pushCurrentMask(),!0)},leave:function(){this._intersector.getPolytope().popCurrentMask()},addIntersection:function(){this._src=r.a.arrayUniq(this._src);for(var e=this._src,t=a.f.create(),i=-Number.MAX_VALUE,o=this._intersector._iReferencePlane,u=0;u<e.length;++u){a.f.add(t,t,e[u]);var l=n.a.distanceToPlane(o,e[u]);l>i&&(i=l)}a.f.scale(t,t,1/e.length);var c=this.initIntersection(new s);c._distance=n.a.distanceToPlane(o,t),c._maxDistance=i,a.f.copy(c._localIntersectionPoint,t);var h=this._maxNumIntersectionsPoints;for(c._numIntersectionPoints=e.length<h?e.length:h,u=0;u<c._numIntersectionPoints;++u)c._intersectionPoints.push(a.f.clone(this._src[u]))},contains:function(){var e=this._intersector.getPolytope(),t=e.getPlanes(),i=e.getCurrentMask();if(!i)return!0;for(var r=1,o=0;o<t.length;++o)if(i&0===r)r<<=1;else{this._dest=[];for(var s=t[o],u=this._src[0],l=n.a.distanceToPlane(s,u),c=1;c<this._src.length;++c){var h=this._src[c],d=n.a.distanceToPlane(s,h);if(l>=0&&this._dest.push(a.f.clone(u)),l*d<0){var p=l-d,f=l/p,m=a.f.add(a.f.create(),a.f.scale(a.f.create(),u,1-f),a.f.scale(a.f.create(),h,f));this._dest.push(m)}l=d,u=h}if(l>=0&&this._dest.push(a.f.clone(u)),this._dest.length<=1)return!1;var g=this._src.slice();this._src=this._dest.slice(),this._dest=g}return!0},containsPoint:function(e){return!!this._intersector.getPolytope().containsVertex(e)&&(this._src=[],this._src[0]=e,!0)},containsLine:function(e,t){return this._src=[],this._src[0]=e,this._src[1]=t,this._src[2]=e,this.contains()},containsTriangle:function(e,t,i){return this._src=[],this._src[0]=e,this._src[1]=t,this._src[2]=i,this._src[3]=e,this.contains()},intersectPoint:function(e){this.containsPoint(e)&&this.addIntersection()},intersectLine:function(e,t){this.containsLine(e,t)&&this.addIntersection()},intersectTriangle:function(e,t,i){this.containsTriangle(e,t,i)&&this.addIntersection()}}),"osgUtil","PolytopeIntersectFunctor"),t.a=u},function(e,t,i){"use strict";var r=i(687),a=i(78),n=i(9),o=function(e){r.a.call(this,e),this._timer=!1};n.a.createPrototypeObject(o,n.a.objectInherit(r.a.prototype,{_initInputs:function(){r.a.prototype._initInputs.call(this,a.a.CAD_MANIPULATOR_MOUSEKEYBOARD,a.a.CAD_MANIPULATOR_RESETTOHOME),this._manipulator.getInputManager().group(a.a.CAD_MANIPULATOR_MOUSEKEYBOARD).addMappings({savePosition:"mousemove"},this)},zoom:function(e){var t=-e.deltaY/this._zoomFactor,i=this._manipulator,r=i.getZoomInterpolator().getTarget()[0]-t;if(i.getZoomInterpolator().setTarget(r),!1===this._timer){this._timer=!0;var a=this;this._timerRef&&clearTimeout(this._timerRef),this._timerRef=setTimeout(function(){a._timer=!1},200),i.computeIntersections(e.glX,e.glY)}},savePosition:function(e){this._lastX=e.glX,this._lastY=e.glY},setMode:function(e,t,i){this._inMotion||this._manipulator.computeIntersections(this._lastX,this._lastY),r.a.prototype.setMode.call(this,e,t,i)},center:function(e){var t=this._manipulator;t.getZoomInterpolator().set(0);var i=t.getZoomInterpolator().getTarget()[0]-10;t.getZoomInterpolator().setTarget(i),t.computeIntersections(e.glX,e.glY)}})),t.a=o},function(e,t,i){"use strict";t.a={ROTATE:0,PAN:1,ZOOM:2}},function(e,t,i){"use strict";var r=i(601),a=i(78),n=i(9),o=function(e){r.a.call(this,e),this._timer=!1};n.a.createPrototypeObject(o,n.a.objectInherit(r.a.prototype,{_initInputs:function(){r.a.prototype._initInputs.call(this,a.a.CAD_MANIPULATOR_TOUCH)},startMotion:function(e,t,i){r.a.prototype.startMotion.call(this,e,t,i),this._manipulator.computeIntersections(i.glX,i.glY)}})),t.a=o},function(e,t,i){"use strict";var r=i(601),a=i(78),n=i(9),o=function(e){r.a.call(this,e),this._timer=!1};n.a.createPrototypeObject(o,n.a.objectInherit(r.a.prototype,{_initInputs:function(){r.a.prototype._initInputs.call(this,a.a.FPS_MANIPULATOR_TOUCH)}})),t.a=o},function(e,t,i){"use strict";var r=i(250),a=i(9),n=i(10),o=i(78),s=n.d.create(),u=n.f.create(),l=function(e){r.a.call(this,e),this.init()};a.a.createPrototypeObject(l,a.a.objectInherit(r.a.prototype,{init:function(){this._pos=n.f.create(),this._quat=n.d.create();var e=this._manipulator.getInputManager();e.group(o.a.FPS_MANIPULATOR_WEBVR).addMappings({update:"vrdisplayposechanged"},this),e.setEnable(o.a.FPS_MANIPULATOR_WEBVR,!1)},update:function(e){var t=e.pose.orientation;t&&(e.sitToStandMatrix&&(t=n.c.getRotation(s,e.sitToStandMatrix),n.d.mul(t,t,e.pose.orientation)),this._quat[0]=t[0],this._quat[1]=-t[2],this._quat[2]=t[1],this._quat[3]=t[3]);var i=e.pose.position;i&&(e.sitToStandMatrix&&(i=n.f.transformMat4(u,i,e.sitToStandMatrix)),this._pos[0]=i[0]*e.worldFactor,this._pos[1]=-i[2]*e.worldFactor,this._pos[2]=i[1]*e.worldFactor),this._manipulator.setPoseVR(this._quat,this._pos)}})),t.a=l},function(e,t,i){"use strict";var r=i(250),a=i(9),n=i(78),o=function(e){r.a.call(this,e),this.init()};a.a.createPrototypeObject(o,a.a.objectInherit(r.a.prototype,{init:function(){this._delay=.15,this._stepFactor=1,this._looking=!1;var e=this._manipulator.getInputManager();e.group(n.a.FPS_MANIPULATOR_MOUSEKEYBOARD).addMappings({startLookAt:"mousedown",lookAt:"mousemove",stopLookAt:["mouseup","mouseout"],goForward:["keydown w","keydown z","keydown ArrowUp"],goBackward:["keydown s","keydown ArrowDown"],goLeft:["keydown a","keydown q","keydown ArrowLeft"],goRight:["keydown d","keydown ArrowRight"],stopMoving:["keyup w","keyup z","keyup ArrowUp","keyup s","keyup ArrowDown"],stopStrafing:["keyup a","keyup q","keyup ArrowLeft","keyup d","keyup ArrowRight"],changeStepFactor:"wheel"},this),e.group(n.a.FPS_MANIPULATOR_RESETTOHOME).addMappings({reset:"keydown space"},this)},setEnable:function(e){e||(this._buttonup=!0),r.a.prototype.setEnable.call(this,e)},setManipulator:function(e){this._manipulator=e,this._manipulator.setStepFactor(this._stepFactor)},stopLookAt:function(){this._looking=!1},startLookAt:function(e){this._manipulator.getLookPositionInterpolator().set(e.canvasX,-e.canvasY),this._looking=!0},lookAt:function(e){this._looking&&(this._manipulator.getLookPositionInterpolator().setDelay(this._delay),this._manipulator.getLookPositionInterpolator().setTarget(e.canvasX,-e.canvasY))},changeStepFactor:function(e){this._stepFactor=Math.min(Math.max(.001,this._stepFactor+.01*e.deltaY),4),this._manipulator.setStepFactor(this._stepFactor)},reset:function(){this._manipulator.computeHomePosition()},goForward:function(){this._manipulator.getForwardInterpolator().setDelay(this._delay),this._manipulator.getForwardInterpolator().setTarget(1)},goBackward:function(){this._manipulator.getForwardInterpolator().setDelay(this._delay),this._manipulator.getForwardInterpolator().setTarget(-1)},goLeft:function(){this._manipulator.getSideInterpolator().setDelay(this._delay),this._manipulator.getSideInterpolator().setTarget(-1)},goRight:function(){this._manipulator.getSideInterpolator().setDelay(this._delay),this._manipulator.getSideInterpolator().setTarget(1)},stopMoving:function(){this._manipulator.getForwardInterpolator().setDelay(this._delay),this._manipulator.getForwardInterpolator().setTarget(0)},stopStrafing:function(){this._manipulator.getSideInterpolator().setDelay(this._delay),this._manipulator.getSideInterpolator().setTarget(0)}})),t.a=o},function(e,t,i){"use strict";var r=i(9),a=i(10),n=i(597),o=i(817),s=i(818),u=i(601),l=i(687),c=i(819),h=i(602),d=i(78),p=function(e){n.a.call(this,e),this._homePosition=a.f.create(),this._frustum={},this.init()};p.AvailableControllerList=["StandardMouseKeyboard","GamePad","Hammer","DeviceOrientation","WebVR"],p.ControllerList=["StandardMouseKeyboard","GamePad","Hammer","DeviceOrientation","WebVR"];var f=2*Math.PI,m=function(e,t){return e<t+1e-5};r.a.createPrototypeObject(p,r.a.objectInherit(n.a.prototype,{init:function(){this._distance=25,this._target=a.f.create(),this._upz=a.f.fromValues(0,0,1),a.f.init(this._target);var e=a.c.fromRotation(a.c.create(),-Math.PI,this._upz),t=a.c.fromRotation(a.c.create(),Math.PI/10,a.f.fromValues(1,0,0));this._rotation=a.c.create(),a.c.mul(this._rotation,e,t),this._time=0,this._vrMatrix=a.c.create(),this._rotate=new h.a(2),this._pan=new h.a(2),this._zoom=new h.a(1),this._minSpeed=1e-4,this._scaleMouseMotion=1,this._inverseMatrix=a.c.create(),this._autoPushTarget=!0,this._limitPitchUp=.5*Math.PI*.9,this._limitPitchDown=-this._limitPitchUp,this._limitYawLeft=-Math.PI,this._limitYawRight=-this._limitYawLeft,this._limitZoomIn=1e-4,this._limitZoomOut=1/0;var i=this;p.ControllerList.forEach(function(e){void 0!==p[e]&&(i._controllerList[e]?i._controllerList[e].init():i._controllerList[e]=new p[e](i))})},setLimitPitchUp:function(e){this._limitPitchUp=e},setLimitPitchDown:function(e){this._limitPitchDown=e},setLimitYawLeft:function(e){this._limitYawLeft=e},setLimitYawRight:function(e){this._limitYawRight=e},setLimitZoomOut:function(e){this._limitZoomOut=e},setLimitZoomIn:function(e){this._limitZoomIn=e},setDelay:function(e){this._rotate.setDelay(e),this._pan.setDelay(e),this._zoom.setDelay(e)},reset:function(){this.init()},setTarget:function(e){a.f.copy(this._target,e);var t=a.f.create();this.getEyePosition(t),this._distance=a.f.distance(e,t)},setEyePosition:function(){var e=a.f.create(),t=a.f.create(),i=a.f.create();return function(r){var n=this._rotation,o=this._target;a.f.sub(e,r,o),a.f.normalize(e,e),a.f.cross(t,e,this._upz),a.f.normalize(t,t),a.f.cross(i,t,e),a.f.normalize(i,i),n[0]=t[0],n[1]=e[0],n[2]=i[0],n[3]=0,n[4]=t[1],n[5]=e[1],n[6]=i[1],n[7]=0,n[8]=t[2],n[9]=e[2],n[10]=i[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this._distance=a.f.distance(o,r)}}(),setEnable:function(e){this.getInputManager().setEnable(d.a.ORBIT_MANIPULATOR,e)},computeHomePosition:function(e){var t=this.getHomeBoundingSphere(e);t&&t.valid()&&(this.setDistance(this.getHomeDistance(t)),this.setTarget(t.center()))},getHomePosition:function(){if(void 0!==this._node){var e=this._target,t=this.getDistance();this.computeEyePosition(e,t,this._homePosition)}return this._homePosition},setMinSpeed:function(e){this._minSpeed=e},getMinSpeed:function(){return this._minSpeed},setDistance:function(e){this._distance=e},getDistance:function(){return this._distance},getSpeedFactor:function(){return Math.max(this._distance,this._minSpeed)},computePan:function(){var e=a.c.create(),t=a.f.create(),i=a.f.create();return function(r,n){var o=this._camera.getProjectionMatrix(),s=1===o[15]?1:2/o[5],u=this.getSpeedFactor()*s;n*=u,r*=u,a.c.invert(e,this._rotation),t[0]=e[0],t[1]=e[1],t[2]=e[2],a.f.normalize(t,t),i[0]=e[8],i[1]=e[9],i[2]=e[10],a.f.normalize(i,i),a.f.scale(t,t,-r),a.f.scale(i,i,n),a.f.add(this._target,this._target,t),a.f.add(this._target,this._target,i)}}(),computeRotation:function(){var e=a.f.fromValues(1,0,0);return function(t,i){var r=Math.atan(-this._rotation[6]/this._rotation[5]),n=this._computePitch(r,i),o=t/10,s=Math.atan2(this._rotation[4],this._rotation[0]),u=this._computeYaw(s,o);a.c.fromRotation(this._rotation,-n,e),a.c.rotate(this._rotation,this._rotation,-u,this._upz)}}(),_computePitch:function(e,t){var i=e+t/10;return Math.min(Math.max(i,this._limitPitchDown),this._limitPitchUp)},_computeYaw:function(e,t){var i=e+t,r=this._limitYawLeft,a=this._limitYawRight;if(a!==Math.PI||r!==-Math.PI){if(a<r&&(i>Math.PI&&(e-=f,i-=f),i<-Math.PI&&(e+=f,i+=f)),0===t){var n=!1;n=r>a?i<r&&i>a:i<r||i>a,n&&(i=Math.abs(i-r)>Math.abs(i-a)?a:r)}t>0&&m(e,a)&&i>a?i=a:t<0&&m(r,e)&&i<r&&(i=r)}return i},computeZoom:function(e){this.zoom(e)},setAutoPushTarget:function(e){this._autoPushTarget=e},zoom:function(){var e=a.f.create();return function(t){var i=this._distance+this.getSpeedFactor()*(t-1);this._autoPushTarget&&i<this._limitZoomIn&&(a.f.sub(e,this._target,this.getEyePosition(e)),a.f.normalize(e,e),a.f.scale(e,e,this._limitZoomIn-i),a.f.add(this._target,this._target,e)),this._distance=Math.max(this._limitZoomIn,Math.min(this._limitZoomOut,i))}}(),getRotateInterpolator:function(){return this._rotate},getPanInterpolator:function(){return this._pan},getZoomInterpolator:function(){return this._zoom},getTarget:function(e){return a.f.copy(e,this._target)},getEyePosition:function(e){return this.computeEyePosition(this._target,this._distance,e),e},computeEyePosition:function(){var e=a.f.create(),t=a.c.create();return function(i,r,n){a.c.invert(t,this._rotation),e[1]=r,a.f.transformMat4(n,e,t),a.f.add(n,i,n)}}(),update:function(){var e=a.f.create();return function(t){var i,r=t.getFrameStamp().getDeltaTime();i=this._rotate.update(r),this.computeRotation(.1*-i[0]*this._scaleMouseMotion,.1*-i[1]*this._scaleMouseMotion);i=this._pan.update(r),this.computePan(.002*-i[0],.002*-i[1]),i=this._zoom.update(r),this.computeZoom(1+i[0]/10);var n=this._target,o=this._distance;a.c.invert(this._inverseMatrix,this._rotation),a.c.mul(this._inverseMatrix,this._vrMatrix,this._inverseMatrix),a.f.set(e,0,o,0),a.f.transformMat4(e,e,this._inverseMatrix),a.c.lookAt(this._inverseMatrix,a.f.add(e,n,e),n,this._upz)}}(),setPoseVR:function(e){a.c.fromQuat(this._vrMatrix,e)}}),"osgGA","OrbitManipulator"),p.DeviceOrientation=o.a,p.GamePad=s.a,p.Hammer=u.a,p.WebVR=c.a,p.StandardMouseKeyboard=l.a,t.a=p},function(e,t,i){"use strict";var r=i(250),a=i(9),n=i(10),o=i(688),s=i(78),u=function(e){r.a.call(this,e),this.init()};a.a.createPrototypeObject(u,a.a.objectInherit(r.a.prototype,{init:function(){this._quat=n.d.create(),this._pos=n.f.create(),this._deviceOrientation=void 0,this._screenOrientation=void 0;var e=this._manipulator.getInputManager();e.group(s.a.ORBIT_MANIPULATOR_DEVICEORIENTATION).addMappings({setDeviceOrientation:"deviceorientation",setScreenOrientation:"orientationchange"},this),e.setEnable(s.a.ORBIT_MANIPULATOR_DEVICEORIENTATION,!1)},setDeviceOrientation:function(e){if(this._deviceOrientation||(this._deviceOrientation={}),this._deviceOrientation.alpha=e.alpha,this._deviceOrientation.beta=e.beta,this._deviceOrientation.gamma=e.gamma,e.screenOrientation)return void this.setScreenOrientation(e);this._update()},setScreenOrientation:function(e){this._screenOrientation=e.screenOrientation,this._update()},_update:function(){this._deviceOrientation&&this._screenOrientation&&(o.a.computeQuaternion(this._quat,this._deviceOrientation,this._screenOrientation),this._manipulator.setPoseVR(this._quat,this._pos))}})),t.a=u},function(e,t,i){"use strict";var r=i(250),a=i(9),n=i(10),o=i(78),s=function(e){r.a.call(this,e),this.init()};a.a.createPrototypeObject(s,a.a.objectInherit(r.a.prototype,{init:function(){this._delay=.15,this._zoomFactor=.5,this._rotateFactor=5,this._panFactor=10,this._rotate=this._manipulator.getRotateInterpolator(),this._zoom=this._manipulator.getZoomInterpolator(),this._pan=this._manipulator.getPanInterpolator(),this._rotate.setDelay(this._delay),this._zoom.setDelay(this._delay),this._pan.setDelay(this._delay);var e=this._manipulator.getInputManager();e.group(o.a.ORBIT_MANIPULATOR_GAMEPAD).addMappings({addZoom:"axis 3",addRotateX:"axis 0",addRotateY:"axis 1"},this),e.group(o.a.ORBIT_MANIPULATOR_GAMEPAD).addMappings({panUp:"buttonvalue 12"},this.pan.bind(this,n.e.fromValues(0,1))),e.group(o.a.ORBIT_MANIPULATOR_GAMEPAD).addMappings({panDown:"buttonvalue 13"},this.pan.bind(this,n.e.fromValues(0,-1))),e.group(o.a.ORBIT_MANIPULATOR_GAMEPAD).addMappings({panLeft:"buttonvalue 14"},this.pan.bind(this,n.e.fromValues(1,0))),e.group(o.a.ORBIT_MANIPULATOR_GAMEPAD).addMappings({panRight:"buttonvalue 15"},this.pan.bind(this,n.e.fromValues(-1,0)))},pan:function(e){var t=this._pan.getTarget();this._pan.setTarget(t[0]-e[0]*this._panFactor,t[1]+e[1]*this._panFactor)},addZoom:function(e){this._zoom.addTarget(-e.value*this._zoomFactor)},addRotateX:function(e){this._rotate.addTarget(-e.value*this._rotateFactor)},addRotateY:function(e){this._rotate.addTarget(0,e.value*this._rotateFactor)}})),t.a=s},function(e,t,i){"use strict";var r=i(250),a=i(9),n=i(10),o=i(78),s=n.d.create(),u=n.f.create(),l=function(e){r.a.call(this,e),this.init()};a.a.createPrototypeObject(l,a.a.objectInherit(r.a.prototype,{init:function(){this._pos=n.f.create(),this._quat=n.d.create();var e=this._manipulator.getInputManager();e.group(o.a.ORBIT_MANIPULATOR_WEBVR).addMappings({update:"vrdisplayposechanged"},this),e.setEnable(o.a.ORBIT_MANIPULATOR_WEBVR,!1)},update:function(e){var t=e.pose.orientation;t&&(e.sitToStandMatrix&&(t=n.c.getRotation(s,e.sitToStandMatrix),n.d.mul(t,t,e.pose.orientation)),this._quat[0]=t[0],this._quat[1]=-t[2],this._quat[2]=t[1],this._quat[3]=t[3]);var i=e.pose.position;i&&(e.sitToStandMatrix&&(i=n.f.transformMat4(u,i,e.sitToStandMatrix)),this._pos[0]=i[0]*e.worldFactor,this._pos[1]=-i[2]*e.worldFactor,this._pos[2]=i[1]*e.worldFactor),this._manipulator.setPoseVR(this._quat,this._pos)}})),t.a=l},function(e,t,i){"use strict";var r=i(399),a=function(e,t){var i,r;t?(i=t[0],r=t[1]):(i=e[14]/(e[10]-1),r=e[14]/(1+e[10]));var a=i*(e[8]-1)/e[0],n=i*(1+e[8])/e[0],o=i*(1+e[9])/e[5],s=i*(e[9]-1)/e[5],u=r*(e[8]-1)/e[0],l=r*(1+e[8])/e[0],c=r*(1+e[9])/e[5],h=r*(e[9]-1)/e[5],d=this.getAttributes().Vertex,p=d.getElements();p[0]=a,p[1]=s,p[2]=-i,p[3]=n,p[4]=s,p[5]=-i,p[6]=n,p[7]=o,p[8]=-i,p[9]=a,p[10]=o,p[11]=-i,p[12]=u,p[13]=h,p[14]=-r,p[15]=l,p[16]=h,p[17]=-r,p[18]=l,p[19]=c,p[20]=-r,p[21]=u,p[22]=c,p[23]=-r,d.dirty()},n=function(){var e=r.a.createBoundingBoxGeometry();return e.updateGeometry=a,e};t.a={createDebugFrustumGeometry:n}},function(e,t,i){"use strict";var r=i(9),a=i(54),n=i(121),o=i(128),s=i(185),u=i(99),l=i(182),c=i(72),h=i(249),d=i(10),p=i(552),f=i(553),m=i(453),g=i(398),_=i(594),v=function(){f.a.apply(this,arguments)},b=f.a.cloneStateAttributeConfig(f.a);b.textureAttribute=[],f.a.setStateAttributeConfig(v,b),r.a.createPrototypeObject(v,r.a.objectInherit(f.a.prototype,{getCompilerName:function(){return"CompilerOffsetNormal"},initTextureAttributes:function(){},createFragmentShaderGraph:function(){var e=this.getNode("glFragColor");return this.getNode("SetAlpha").inputs({color:this.getOrCreateUniform("vec3","uColorDebug"),alpha:this.createVariable("float").setValue("1.0")}).outputs({result:e}),[e]},getOffsetDirection:function(){return this.getOrCreateModelNormal()},getOrCreateModelVertex:function(){var e=this.getVariable("vertexOffset");if(e)return e;e=this.createVariable("vec3","vertexOffset");return this.getNode("InlineCode").code("%out = %offset == 1.0 ? %vertex + normalize(%direction.xyz) * %scale: %vertex;").inputs({offset:this.getOrCreateAttribute("float","Offset"),direction:this.getOffsetDirection(),vertex:f.a.prototype.getOrCreateModelVertex.call(this),scale:this.getOrCreateUniform("float","uScale")}).outputs({out:e}),e},getOrCreateViewVertex:function(){var e=this._variables.FragEyeVector;return e&&!e.isEmpty()?e:(e=this._varyings.FragEyeVector||this.createVariable("vec4","FragEyeVector"),this.getNode("MatrixMultPosition").inputs({matrix:this.getOrCreateUniform("mat4","uViewMatrix"),vec:this.getOrCreateModelVertex()}).outputs({vec:e}),e)}}),"osgUtil","CompilerOffsetNormal");var y=function(){p.a.apply(this,arguments),this.setShaderCompiler(v)};r.a.createPrototypeObject(y,r.a.objectInherit(p.a.prototype,{}),"osgUtil","ShaderGeneratorCompilerOffsetNormal");var x=function(){v.apply(this,arguments)},S=b;f.a.setStateAttributeConfig(x,S),r.a.createPrototypeObject(x,r.a.objectInherit(v.prototype,{getCompilerName:function(){return"CompilerOffsetTangent"},getOffsetDirection:function(){return this.getOrCreateModelTangent()}}),"osgUtil","CompilerOffsetTangent");var M=function(){p.a.apply(this,arguments),this.setShaderCompiler(x)};r.a.createPrototypeObject(M,r.a.objectInherit(p.a.prototype,{}),"osgUtil","ShaderGeneratorCompilerOffsetTangent");var w=function(){a.a.call(this),this._unifScale=c.a.createFloat(1,"uScale");var e=this._normalStateSet=new l.a;e.addUniform(c.a.createFloat3(d.f.fromValues(1,0,0),"uColorDebug")),e.addUniform(this._unifScale),e.setAttributeAndModes(new h.a(h.a.NEVER)),e.setShaderGeneratorName("debugNormal");var t=this._tangentStateSet=new l.a;t.addUniform(c.a.createFloat3(d.f.fromValues(0,1,0),"uColorDebug")),t.addUniform(this._unifScale),t.setAttributeAndModes(new h.a(h.a.NEVER)),t.setShaderGeneratorName("debugTangent")};w.CompilerOffsetNormal=v,w.CompilerOffsetTangent=x,w.ShaderGeneratorCompilerOffsetNormal=y,w.ShaderGeneratorCompilerOffsetTangent=M,r.a.createPrototypeObject(w,r.a.objectInherit(a.a.prototype,{setScale:function(e){this._unifScale.setFloat(e)},setTangentVisibility:function(e){this._tangentStateSet.setAttributeAndModes(new h.a(e?h.a.LESS:h.a.NEVER))},setNormalVisibility:function(e){this._normalStateSet.setAttributeAndModes(new h.a(e?h.a.LESS:h.a.NEVER))},apply:function(e){if(!e._isVisitedNormalDebug){if(e._isVisitedNormalDebug=!0,e instanceof n.a)return this._createDebugGeom(e,"Normal",this._normalStateSet),void this._createDebugGeom(e,"Tangent",this._tangentStateSet);this.traverse(e);for(var t=e.getUpdateCallbackList(),i=0,r=t.length;i<r;++i)t[i]instanceof _.a&&t[i].init(e)}},_createDoubleOffsetArray:function(e){for(var t=new Float32Array(2*e),i=0;i<e;++i)t[2*i]=1;return new o.a(o.a.ARRAY_BUFFER,t,1)},_createDoubledBufferArray:function(e){e.getInitialBufferArray&&(e=e.getInitialBufferArray());for(var t=e.getItemSize(),i=e.getElements(),r=i.length/t,a=i.constructor,n=new a(2*i.length),s=0;s<r;++s)for(var u=s*t,l=2*u,c=0;c<t;++c)n[l+c]=n[l+c+t]=i[u+c];return new o.a(o.a.ARRAY_BUFFER,n,t)},_addMorphTargets:function(e,t,i){var r=t.getMorphTargets();t.setName(e.getName());for(var a=e.getMorphTargets(),o=0,s=a.length;o<s;++o){var u=a[o],l=u.getVertexAttributeList(),c=new n.a;c.setName(u.getName());var h=c.getVertexAttributeList();h.Vertex=this._createDoubledBufferArray(l.Vertex),l[i]&&(h[i]=this._createDoubledBufferArray(l[i])),r.push(c)}return t.mergeChildrenVertexAttributeList(),t},_createDebugGeom:function(e,t,i){var r=e.getAttributes(),a=r[t];if(a){var o=r.Vertex;if(o){var l;e instanceof g.a?l=e:e.getSourceGeometry&&e.getSourceGeometry()instanceof g.a&&(l=e.getSourceGeometry());var c=o.getElements().length/o.getItemSize(),h=l?new g.a:new n.a;h.getAttributes().Vertex=this._createDoubledBufferArray(o),h.getAttributes().Offset=this._createDoubleOffsetArray(c),h.getAttributes()[t]=this._createDoubledBufferArray(a),h.getPrimitives().push(new s.a(u.a.LINES,0,2*c)),l&&this._addMorphTargets(l,h,t);var d;if(e instanceof m.a){var p=new m.a;p.setSourceGeometry(h),p.getVertexAttributeList().Bones=this._createDoubledBufferArray(r.Bones),p.getVertexAttributeList().Weights=this._createDoubledBufferArray(r.Weights),p._rigTransformImplementation=e._rigTransformImplementation,p._stateSetAnimation=e._stateSetAnimation,p.mergeChildrenData(),d=p}else d=h;var f=e.getParents(),_=f.length;d._isVisitedNormalDebug=!0,d._isNormalDebug=!0,d.setStateSet(i);for(var v=0;v<_;++v)f[v].addChild(d);return d}}}}),"osgUtil","DisplayNormalVisitor"),t.a=w},function(e,t,i){"use strict";var r=i(21),a=i(1058),n=i(1060),o=i(689),s=i(789),u=i(790),l=function(){this._nodes=new window.Map,this.extractFunctions(s.a,"lights.glsl"),this.extractFunctions(s.a,"lightCommon.glsl"),this.extractFunctions(s.a,"skinning.glsl"),this.extractFunctions(s.a,"morphing.glsl"),this.extractFunctions(s.a,"billboard.glsl"),this.extractFunctions(s.a,"functions.glsl"),this.extractFunctions(s.a,"textures.glsl"),this.extractFunctions(u.a,"shadowCast.glsl"),this.extractFunctions(u.a,"shadowReceive.glsl"),this.registerNodes(a.a),this.registerNodes(n.a)};l.prototype={registerNodes:function(e){for(var t in e)this.registerNode(t,e[t])},registerNode:function(e,t){this._nodes.has(e)&&r.a.warn("Node "+e+" already registered"),this._nodes.set(e,t)},extractFunctions:function(e,t){this.registerNodes(o.a.extractFunctions(e,t))},getNode:function(e){var t=this._nodes.get(e);if(!t)return void r.a.warn("Node "+e+" does not exist");var i=window.Object.create(t.prototype);return t.apply(i,Array.prototype.slice.call(arguments,1)),i}};var c=new l;t.a=c},function(e,t,i){"use strict";var r=i(552),a=i(824),n=function(){r.a.apply(this,arguments),this.setShaderCompiler(a.a)};n.prototype=r.a.prototype,t.a=n},function(e,t,i){"use strict";var r=i(9),a=i(553),n=function(){a.a.apply(this,arguments)},o=a.a.cloneStateAttributeConfig(a.a);o.attribute=["ShadowCast","Morph","Skinning","PointSize"],a.a.setStateAttributeConfig(n,o),r.a.createPrototypeObject(n,r.a.objectInherit(a.a.prototype,{getCompilerName:function(){return"ShadowCast"},initAttributes:function(){for(var e=this._attributes,t=0,i=e.length;t<i;t++){var r=e[t].className();"ShadowCastAttribute"===r?this._shadowCastAttribute=e[t]:"Billboard"===r?this._isBillboard=!!e[t]:"SkinningAttribute"===r?this._skinningAttribute=e[t]:"MorphAttribute"===r?this._morphAttribute=e[t]:"PointSizeAttribute"===r&&(this._pointSizeAttribute=e[t])}},registerTextureAttributes:function(){},createShadowCastDepth:function(e){var t=this._shadowCastAttribute.getDefines();return this.getNode("ShadowCast").inputs({shadowDepthRange:this.getOrCreateUniform("vec4","uShadowDepthRange"),fragEye:this.getOrCreateViewVertex()}).outputs({result:e}).getDefines=function(){return t},e},createFragmentShaderGraph:function(){var e=this.getNode("glFragColor");return[this.createShadowCastDepth(e)]}}),"osgShader","CompilerShadowCast"),t.a=n},function(e,t,i){"use strict";var r=i(9),a=i(54),n=i(121),o=i(453),s=i(72),u=i(182),l=i(10),c=i(552),h=i(553),d=i(128),p=i(185),f=i(99),m=i(143),g=i(249),_=function(){h.a.apply(this,arguments)},v=h.a.cloneStateAttributeConfig(h.a);v.textureAttribute=[],v.attribute=["PointSize","Morph","Skinning"],h.a.setStateAttributeConfig(_,v),r.a.createPrototypeObject(_,r.a.objectInherit(h.a.prototype,{getCompilerName:function(){return"CompilerDebugGeometry"},initTextureAttributes:function(){},createFragmentShaderGraph:function(){var e=this.getNode("glFragColor");return this.getNode("SetAlpha").inputs({color:this.getOrCreateUniform("vec3","uColorDebug"),alpha:this.createVariable("float").setValue("1.0")}).outputs({result:e}),[e]}}),"osgUtil","CompilerColorGeometry");var b=function(){c.a.apply(this,arguments),this.setShaderCompiler(_)};r.a.createPrototypeObject(b,r.a.objectInherit(c.a.prototype,{}),"osgUtil","ShaderGeneratorCompilerColorGeometry");var y=function(){h.a.apply(this,arguments)},x=h.a.cloneStateAttributeConfig(h.a);x.textureAttribute=[],h.a.setStateAttributeConfig(y,x),r.a.createPrototypeObject(y,r.a.objectInherit(h.a.prototype,{getCompilerName:function(){return"CompilerDebugSkinning"},initTextureAttributes:function(){},createFragmentShaderGraph:function(){var e=this.getNode("glFragColor");return this.getNode("SetAlpha").inputs({color:this.getOrCreateVarying("vec3","vBonesColor"),alpha:this.createVariable("float").setValue("1.0")}).outputs({result:e}),[e]},declareVertexVaryings:function(e){var t=this.getOrCreateVarying("vec3","vBonesColor");return this.getNode("SetFromNode").inputs(this.getOrCreateAttribute("vec3","BonesColor")).outputs(t),h.a.prototype.declareVertexVaryings.call(this,e)}}),"osgUtil","CompilerColorSkinning");var S=function(){c.a.apply(this,arguments),this.setShaderCompiler(y)};r.a.createPrototypeObject(S,r.a.objectInherit(c.a.prototype,{}),"osgUtil","ShaderGeneratorCompilerColorSkinning");var M=function(){a.a.call(this),this._debugColor=!0,this._debugSkinning=!1,this._stCenter=new u.a,this._stCenter.setShaderGeneratorName("debugGeometry")};M.CompilerColorGeometry=_,M.ShaderGeneratorCompilerColorGeometry=b,M.CompilerSkinningGeometry=y,M.ShaderGeneratorCompilerColorSkinning=S,r.a.createPrototypeObject(M,r.a.objectInherit(a.a.prototype,{setGeometryDebug:function(e){this._stCenter.setAttributeAndModes(new g.a(g.a.ALWAYS)),this._debugColor=!0,this._debugSkinning=!1,this.apply(e)},setSkinningDebug:function(e){this._stCenter.setAttributeAndModes(new g.a(g.a.NEVER)),this._debugColor=!1,this._debugSkinning=!0,this.apply(e)},disableDebug:function(e){this._stCenter.setAttributeAndModes(new g.a(g.a.NEVER)),this._debugColor=!1,this._debugSkinning=!1,this.apply(e)},_debugCenterGeometry:function(e,t){var i=e.getBound(),r=new Float32Array(18),a=.1*i.radius();r[0]=a,r[3]=-a,r[7]=a,r[10]=-a,r[14]=a,r[17]=-a;var o=new n.a;o.getAttributes().Vertex=new d.a(d.a.ARRAY_BUFFER,r,3);var u=new p.a(f.a.LINES,0,6);o.getPrimitives().push(u);var c=new m.a,h=i.center();c.getMatrix()[12]=h[0],c.getMatrix()[13]=h[1],c.getMatrix()[14]=h[2],c.addChild(o),this.nodePath[this.nodePath.length-2].addChild(c),t=l.f.fromValues(.8*t[0],.8*t[1],.8*t[2]),o.getOrCreateStateSet().addUniform(s.a.createFloat3(t,"uColorDebug")),c.setStateSet(this._stCenter),c._isCenterDebug=!0},_debugRigGeometry:function(e){var t=e.getVertexAttributeList();if(!t.BonesColor){for(var i=t.Bones.getElements(),r=t.Weights.getElements(),a=e._rigTransformImplementation._bones,n=i.length/4,o=new Float32Array(3*n),s=0;s<n;++s){var u=4*s,l=a[i[u]].getOrCreateDebugColor(),c=a[i[u+1]].getOrCreateDebugColor(),h=a[i[u+2]].getOrCreateDebugColor(),p=a[i[u+3]].getOrCreateDebugColor(),f=r[u],m=r[u+1],g=r[u+2],_=r[u+3],v=3*s;o[v]=f*l[0]+m*c[0]+g*h[0]+_*p[0],o[v+1]=f*l[1]+m*c[1]+g*h[1]+_*p[1],o[v+2]=f*l[2]+m*c[2]+g*h[2]+_*p[2]}t.BonesColor=new d.a(d.a.ARRAY_BUFFER,o,3)}},_debugGeometry:function(e){var t=this._debugColor,i=this._debugSkinning&&e instanceof o.a;if(!t&&!i)return void(void 0!==e._originalStateSet&&e.setStateSet(e._originalStateSet||void 0));void 0===e._originalStateSet&&(e._originalStateSet=e.getStateSet()||null);var r=new u.a;if(e.setStateSet(r),i)return r.setShaderGeneratorName("debugSkinning"),void this._debugRigGeometry(e);var a=l.f.fromValues(Math.random(),Math.random(),Math.random());r.addUniform(s.a.createFloat3(a,"uColorDebug")),r.setShaderGeneratorName("debugGeometry"),this._debugCenterGeometry(e,a)},apply:function(e){e._isNormalDebug||e._isCenterDebug||(e instanceof n.a&&this._debugGeometry(e),this.traverse(e))}}),"osgUtil","GeometryColorDebugVisitor"),t.a=M},function(e,t,i){"use strict";var r=i(9),a=i(54),n=i(398),o=function(e){a.a.call(this,a.a.TRAVERSE_ALL_CHILDREN),this._selectables=e,this._nodeList=[],this._linkList=[],this._uniqueNodes=new window.Set,this._uniqueEdges=new window.Set};r.a.createPrototypeObject(o,r.a.objectInherit(a.a.prototype,{getColorFromClassName:function(e){switch(e){case"ShadowedScene":return"#3D3D3D";case"Camera":return"#AB7BCF";case"RenderBin":return"#59778B";case"LightSource":return"#53967D";case"RenderStage":return"#DDCC55";case"RenderLeaf":case"Geometry":return"#FFCC55";case"RigGeometry":return"#DD8800";case"MorphGeometry":return"#AA5500";case"MatrixTransform":return"#CE697E";case"StateSet":return"#0099FF";case"StateGraph":case"Skeleton":return"#96999E";case"Bone":return"#A9DEAA";case"Node":return"#FFFFFF";default:return"#FF00AA"}},createGraph:function(e){this.reset(),e.accept(this)},reset:function(){this._nodeList.length=0,this._linkList.length=0,this._uniqueNodes.clear(),this._uniqueEdges.clear()},apply:function(e){if(!e._isNormalDebug){if(this._uniqueNodes.has(e.getInstanceID())||(this._uniqueNodes.add(e.getInstanceID()),this._nodeList.push(e)),this.nodePath.length>=2){var t=this.nodePath[this.nodePath.length-2].getInstanceID(),i=e.getInstanceID(),r=t+"+"+i;this._uniqueEdges.has(r)||(this._linkList.push({parentNode:t,childrenNode:i}),this._uniqueEdges.add(r))}this.traverse(e)}},createMatrixGrid:function(e,t){var i="";return i+="<table><tr><td>"+t[0]+"</td>",i+="<td>"+t[4]+"</td>",i+="<td>"+t[8]+"</td>",i+="<td>"+t[12]+"</td></tr>",i+="<tr><td>"+t[1]+"</td>",i+="<td>"+t[5]+"</td>",i+="<td>"+t[9]+"</td>",i+="<td>"+t[13]+"</td></tr>",i+="<tr><td>"+t[2]+"</td>",i+="<td>"+t[6]+"</td>",i+="<td>"+t[10]+"</td>",i+="<td>"+t[14]+"</td></tr>",i+="<tr><td>"+t[3]+"</td>",i+="<td>"+t[7]+"</td>",i+="<td>"+t[11]+"</td>",i+="<td>"+t[15]+"</td></tr></table>"},getLabel:function(e){var t=e.className()+" ("+e.getInstanceID()+")";return e.getName&&e.getName()&&(t+="\n"+e.getName()),t},generateNode:function(e,t){var i="";t.getMatrix&&t.getMatrix()&&(i+="<br /><br />"+this.createMatrixGrid(t,t.getMatrix())),this._selectables.set(t.getInstanceID().toString(),t),e.addNode(t.getInstanceID(),{label:this.getLabel(t),description:i,style:"fill: "+this.getColorFromClassName(t.className())+";stroke-width: 0px;"})},generateStateSet:function(e,t){var i=t.getStateSet(),r=i.getInstanceID(),a=this.getLabel(i);a+="\nNbTexture : "+i.getNumTextureAttributeLists(),e.hasNode(r)||(this._selectables.set(r.toString(),i),e.addNode(r,{label:a,style:"fill: "+this.getColorFromClassName(i.className())+";stroke-width: 0px;"})),e.addEdge(null,t.getInstanceID(),r,{style:"stroke: "+this.getColorFromClassName(i.className())+";"})},generateSourceGeometry:function(e,t){var i=t.getSourceGeometry(),r=i.getInstanceID();this._selectables.set(r.toString(),i),e.addNode(r,{label:this.getLabel(i),style:"fill: "+this.getColorFromClassName(i.className())+";stroke-width: 0px;"}),e.addEdge(null,t.getInstanceID(),r,{style:"stroke: "+this.getColorFromClassName(i.className())+";"})},generateNodeAndLink:function(e){for(var t=0,i=this._nodeList.length;t<i;t++){var r=this._nodeList[t];this.generateNode(e,r),r.getStateSet()&&this.generateStateSet(e,r),r.getSourceGeometry&&r.getSourceGeometry()instanceof n.a&&this.generateSourceGeometry(e,r)}for(var a=0,o=this._linkList.length;a<o;a++)e.addEdge(null,this._linkList[a].parentNode,this._linkList[a].childrenNode)}}),"osgUtil","DisplayGraphNode"),t.a=o},function(e,t,i){"use strict";var r=i(9),a=i(71),n=i(803),o=function(){a.a.call(this),this._databasePager=new n.a,this._sceneData=void 0};r.a.createPrototypeObject(o,r.a.objectInherit(a.a.prototype,{getSceneData:function(){return this._sceneData},setSceneData:function(e){this._sceneData=e},setDatabasePager:function(e){this._databasePager=e},getDatabasePager:function(){return this._databasePager},updateSceneGraph:function(e){this._databasePager&&this._databasePager.updateSceneGraph(e.getFrameStamp()),this._sceneData&&this._sceneData.accept(e)}}),"osgViewer","Scene"),t.a=o},function(e,t,i){"use strict";var r,a,n,o=i(128),s=i(121),u=i(99),l=i(185),c=i(183),h=i(186),d=i(217),p=["#ifdef GL_ES","precision highp float;","#endif"].join("\n"),f=function(){if(r)return r;var e="#define SHADER_NAME GizmoLine3D",t=[p,"attribute vec3 Vertex;","uniform mat4 uModelViewMatrix;","uniform mat4 uProjectionMatrix;",e,"","void main(void) {","  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex, 1.0);","}"].join("\n"),i=[p,"uniform vec4 uColor;",e,"","void main(void) {","  gl_FragColor = uColor;","}"].join("\n");return r=new h.a(new d.a(d.a.VERTEX_SHADER,t),new d.a(d.a.FRAGMENT_SHADER,i))},m=function(){if(a)return a;var e="#define SHADER_NAME GizmoLine2D",t=[p,"attribute vec2 Vertex;",e,"","void main(void) {","  gl_Position = vec4(Vertex, 0.0, 1.0);","}"].join("\n"),i=[p,e,"","void main(void) {","  gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);","}"].join("\n");return a=new h.a(new d.a(d.a.VERTEX_SHADER,t),new d.a(d.a.FRAGMENT_SHADER,i))},g=function(){if(n)return n;var e="#define SHADER_NAME GizmoQuadCircle",t=[p,"attribute vec3 Vertex;","uniform mat4 uModelViewMatrix;","uniform mat4 uProjectionMatrix;","varying vec3 vViewVertex;",e,"","void main(void) {","  vViewVertex = Vertex;","  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex, 1.0);","}"].join("\n"),i=[p,"uniform float uAngle;","uniform vec3 uBase;","varying vec3 vViewVertex;","const float PI = 3.14159265358979323846264;","const float PI2 = PI * 2.0;",e,"","void main(void) {","  if(length(vViewVertex) > 0.5)","    discard;","  vec3 vn = normalize(vViewVertex);","  float angle = atan(uBase.y * vn.x - uBase.x * vn.y, dot(uBase, vn));","  if(angle > 0.0) {","    if(uAngle >= 0.0 && angle > uAngle) discard;","    if(uAngle < -PI && angle < uAngle + PI2) discard;","    if(uAngle < 0.0 && uAngle > -PI) discard;","  }","  if(angle < 0.0) {","    if(uAngle <= 0.0 && angle < uAngle) discard;","    if(uAngle > PI && angle > uAngle - PI2) discard;","    if(uAngle > 0.0 && uAngle < PI) discard;","  }","  gl_FragColor = vec4(1.0, 1.0, 0.0, 0.5);","}"].join("\n");return n=new h.a(new d.a(d.a.VERTEX_SHADER,t),new d.a(d.a.FRAGMENT_SHADER,i))},_=function(){r=void 0,a=void 0,n=void 0},v=function(){var e=new s.a;e.getAttributes().Vertex=new o.a(o.a.ARRAY_BUFFER,new Float32Array(4),2);var t=new l.a(u.a.LINES,0,2);return e.getPrimitives().push(t),e.getOrCreateStateSet().setAttributeAndModes(m()),e},b=function(e,t,i,r,a){var n=void 0!==e?e:1,l=void 0!==t?t:.2,h=void 0!==i?i:6,d=void 0!==r?r:64,p=void 0!==a?a:2*Math.PI,m=(h+1)*(d+1),g=h*d*2,_=new s.a,v=new Float32Array(3*m),b=new Uint16Array(3*g);p=p||2*Math.PI;var y=0,x=0,S=0,M=0;for(M=0;M<=h;++M)for(S=0;S<=d;++S){var w=S/d*p,T=M/h*Math.PI*2;x=3*y,v[x]=(n+l*Math.cos(T))*Math.cos(w),v[x+1]=(n+l*Math.cos(T))*Math.sin(w),v[x+2]=l*Math.sin(T),y++}for(y=0,M=1;M<=h;++M)for(S=1;S<=d;++S)x=6*y,b[x]=(d+1)*M+S-1,b[x+1]=b[x+3]=(d+1)*(M-1)+S-1,b[x+2]=b[x+5]=(d+1)*M+S,b[x+4]=(d+1)*(M-1)+S,y++;return _.getAttributes().Vertex=new o.a(o.a.ARRAY_BUFFER,v,3),_.getOrCreateStateSet().setAttributeAndModes(f()),_.getPrimitives().push(new c.a(u.a.TRIANGLES,new o.a(o.a.ELEMENT_ARRAY_BUFFER,b,1))),_},y=function(e,t,i,r,a,n,l){var h=void 0!==e?e:1,d=void 0!==t?t:1,p=void 0!==i?i:5,m=void 0!==r?r:32,g=void 0!==a?a:1,_=void 0===n||n,v=void 0===l||l;_=_&&h>0,v=v&&d>0;var b=.5*p,y=(g+1)*(m+1),x=g*m*2;_&&(y+=1,x+=m),v&&(y+=1,x+=m);var S=new s.a,M=new Float32Array(3*y),w=new Uint16Array(3*x),T=0,C=0,E=0,L=0;for(E=0;E<=g;E++){var P=E/g,A=P*(d-h)+h;for(L=0;L<=m;L++){var D=L/m;C=3*T,M[C]=A*Math.sin(D*Math.PI*2),M[C+1]=A*Math.cos(D*Math.PI*2),M[C+2]=-P*p+b,T++}}for(T=0,L=0;L<m;L++)for(E=0;E<g;E++)C=6*T,w[C]=(m+1)*E+L,w[C+1]=w[C+3]=(m+1)*(E+1)+L,w[C+2]=w[C+5]=(m+1)*E+L+1,w[C+4]=(m+1)*(E+1)+L+1,T++;T*=2;var O;if(_)for(O=(v?M.length-6:M.length-3)/3,M[3*O+2]=b,L=0;L<m;L++)C=3*T,w[C]=L,w[C+1]=L+1,w[C+2]=O,T++;if(v){O=(M.length-3)/3,M[3*O+2]=-b;var k=(m+1)*E;for(L=0;L<m;L++)C=3*T,w[C]=k+L+1,w[C+1]=k+L,w[C+2]=O,T++}return S.getAttributes().Vertex=new o.a(o.a.ARRAY_BUFFER,M,3),S.getOrCreateStateSet().setAttributeAndModes(f()),S.getPrimitives().push(new c.a(u.a.TRIANGLES,new o.a(o.a.ELEMENT_ARRAY_BUFFER,w,1))),S},x=function(e,t,i){for(var r=new s.a,a=new Float32Array(3*e),n=i||2*Math.PI,c=0;c<e;++c){var h=3*c,d=n*c/e;a[h]=Math.cos(d)*t,a[h+1]=Math.sin(d)*t}r.getAttributes().Vertex=new o.a(o.a.ARRAY_BUFFER,a,3);var p=new l.a(u.a.LINE_STRIP,0,e);return r.getOrCreateStateSet().setAttributeAndModes(f()),r.getPrimitives().push(p),r},S=function(e,t){var i=e?.5*e:.5,r=t?.5*t:.5,a=new s.a,n=new Float32Array(12);n[0]=-i,n[1]=-r,n[3]=i,n[4]=-r,n[6]=-i,n[7]=r,n[9]=i,n[10]=r,a.getAttributes().Vertex=new o.a(o.a.ARRAY_BUFFER,n,3);var c=new l.a(u.a.TRIANGLE_STRIP,0,4);return a.getOrCreateStateSet().setAttributeAndModes(f()),a.getPrimitives().push(c),a},M=function(){var e=S();return e.getOrCreateStateSet().setAttributeAndModes(g()),e},w={};w.createCircleGeometry=x,w.createCylinderGeometry=y,w.createTorusGeometry=b,w.createDebugLineGeometry=v,w.createPlaneGeometry=S,w.createQuadCircleGeometry=M,w.resetPrograms=_,t.a=w},function(e,t,i){"use strict";var r=i(9),a=i(247),n=i(142),o=i(450),s=i(249),u=i(143),l=i(186),c=i(217),h=i(214),d=i(84),p=i(10),f=i(830),m=i(831),g=i(694),_=i(832),v=i(550),b=i(551),y=i(399),x=i(215),S=i(78),M=function(){var e=["attribute vec4 Vertex;","uniform mat4 uModelViewMatrix;","uniform mat4 uProjectionMatrix;","","varying vec2 vTexCoord0;","","void main(void) {","  vTexCoord0 = Vertex.zw;","  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xy,0.0, 1.0));","}"].join("\n"),t=["#define SHADER_NAME STATS","varying vec2 vTexCoord0;","uniform sampler2D Texture0;","void main(void) {","  vec4 color = vec4(1.0);","  vec2 uv =  vTexCoord0;","  int isText = 0;","  if ( uv.y < 0.0 ) {","     isText = 1;","     uv.y = -uv.y;","  }","  if ( uv.y >= "+(f.a.backgroundColor-1).toFixed(1)+" ) {","     color = vec4(0.0,0.0,0.0,0.5);","     uv.y -= "+f.a.backgroundColor.toFixed(1)+";","  } else if ( uv.y >= "+(f.a.redColor-1).toFixed(1)+" ) {","     color = vec4(1.0,0.0,0.0,1.0);","     uv.y -= "+f.a.redColor.toFixed(1)+";","  } else if ( uv.y == "+(f.a.greyColor-1).toFixed(1)+" ) {","     color = vec4(0.5,0.5,0.5,1.0);","     uv.y -= "+f.a.greyColor.toFixed(1)+";","  } else {","     uv.y -= "+f.a.whiteColor.toFixed(1)+";","  }","  if ( isText == 1 ) {","     color *= texture2D( Texture0, uv.xy);","  }","  gl_FragColor = color;","}"].join("\n");return new l.a(new c.a("VERTEX_SHADER",e),new c.a("FRAGMENT_SHADER",t))},w=function(e,t){this._captionsBuffer=void 0,this._valuesBuffer=void 0,this._dirtyCaptions=!0,this._dirtyValues=!0,this._viewer=e,this._labelMaxWidth=0,this._viewport=e.getCamera().getViewport(),this._node=void 0,this._text=void 0,this._offsetGroup=void 0,this._counters={},this._groups={},this._updates=[],this._displayableCounters={},this._x=0,this._y=0,this._width=0,this._height=0,this._maxCaptionTextLength=32,this._lineFactor=1.1,this._displayFilter=[],this._backgroundWidth=0,this._backgroundHeight=0,this._bufferStats=new f.a,this._historyGraph={},this._graphToDisplay=[],this._valuesMaxWidth=72,this._showGraph=!1,this._backgroundPicking=y.a.createTexturedQuadGeometry(0,0,0,10,0,0,0,10,0),this._backgroundPicking.setName("osgStats-Background-picking"),this._dragStop=p.e.create(),this._dragStart=p.e.create(),this._startTransformation=p.c.create(),this._init(t)};r.a.createPrototypeObject(w,{getCounter:function(e){return this._counters[e]||(this._counters[e]=new m.a({caption:e,average:!0})),this._counters[e]},getBufferStats:function(){return this._bufferStats},addConfig:function(e){if(!e.init||e.init()){for(var t in e.values){var i=e.values[t],r=new m.a(i);this._counters[t]=r}if(e.groups)for(var a=0;a<e.groups.length;a++){var n=e.groups[a],o={caption:n.caption,values:n.values,textCursorY:new Float32Array(n.values.length)},s=n.name?n.name:n.caption;this._groups[s]=o}e.update&&this._updates.push(e.update)}},reset:function(){this._bufferStats.resetCaptions(),this._bufferStats.resetValues(),this._dirtyCaptions=!0,this._dirtyValue=!0,this._bufferStats.resize(this._bufferStats._maxNbVertexes)},update:function(){for(var e=0;e<this._updates.length;e++)this._updates[e](this);this._dirtyValues=!0,(this._checkViewportChanged()||this._checkCounterDisplayableChanged())&&(this._dirtyCaptions=!0),this._dirtyCaptions&&(this._bufferStats.resetCaptions(),this._generateCaptions(),this._dirtyCaptions=!1),this._dirtyValues&&(this._bufferStats.resetValues(),this._generateValues(),this._dirtyValues=!1)},getNode:function(){return this._node},setShowFilter:function(e){if(this._dirtyCaptions=!0,!e)return void(this._displayFilter.length=0);this._displayFilter=e.slice()},_init:function(e){var t=new n.a;t.setRenderOrder(n.a.POST_RENDER,0),t.setReferenceFrame(h.a.ABSOLUTE_RF),t.setClearMask(0);var i=new u.a;i.setName("StatsNode"),i.addChild(this._backgroundPicking),this._nodeTransform=i,this._backgroundPicking.setNodeMask(0),t.addChild(i),t.setName("osgStats"),t.setViewport(this._viewport),this._node=t,this._text=new _.a;var r=12;if(e){var l=e.getString("statsFilter");if(l){var c=l.split(";");this.setShowFilter(c)}var p=e.getNumber("statsFontSize");void 0!==p&&(r=p),this._showGraph=e.getBoolean("statsShowGraph")}var f=new d.default;f.setMinFilter(d.default.NEAREST),f.setMagFilter(d.default.NEAREST),this._text.setFontSize(r*this._viewer.getCanvasPixelRatio()),this._text.getCanvas().then(function(e){this._dirtyCaptions=!0;var t=this._bufferStats.getGeometry();t.setNodeMask(-32769),i.addChild(t),f.setImage(e),t.setBound(new x.a)}.bind(this)),i.getOrCreateStateSet().setAttributeAndModes(M()),i.getOrCreateStateSet().setAttributeAndModes(new o.a(o.a.DISABLE));var m=new a.a("SRC_ALPHA","ONE_MINUS_SRC_ALPHA");i.getOrCreateStateSet().setAttributeAndModes(m),i.getOrCreateStateSet().setAttributeAndModes(new s.a(s.a.DISABLE)),i.getOrCreateStateSet().setTextureAttributeAndModes(0,f);var g=this._viewer.getGraphicContext().canvas;this._canvas=g;var v=this._viewer.getInputManager();v.group(S.a.STATS).addMappings({onMouseMove:["mousemove","touchmove"],onMouseDown:["mousedown","touchstart"],onMouseUp:["mouseup","mouseout","touchend","touchcancel"]},this),v.setPriority(S.a.STATS,v.getHigherPriority(S.a.SCENE))},onMouseDown:function(e){var t=this.computeNearestIntersection(e);this._onStats=!!t.length,this._onStats&&(this._viewer.getInputManager().setEnable(S.a.SCENE,!1),p.c.copy(this._startTransformation,this._nodeTransform.getMatrix()),p.e.set(this._dragStart,e.canvasX,e.canvasY),this._dragStop[1]=this._dragStart[1])},onMouseMove:function(){var e=p.f.create();return function(t){if(this._onStats){p.e.set(this._dragStop,t.canvasX,t.canvasY);var i=this._dragStop[1]-this._dragStart[1];p.c.translate(this._nodeTransform.getMatrix(),this._startTransformation,p.f.set(e,0,-i,0))}}}(),onMouseUp:function(){this._viewer.getInputManager().setEnable(S.a.SCENE,!0),this._onStats=!1},computeNearestIntersection:function(){var e=new b.a,t=p.f.create(),i=p.f.create(),r=new v.a;return r.setIntersector(e),function(a){var n=a.glX,o=a.glY;e.reset(),e.set(p.f.set(t,n,o,0),p.f.set(i,n,o,1)),r.reset(),this._backgroundPicking.setNodeMask(32768),r.setTraversalMask(32768),this._node.accept(r);var s=e.getIntersections();return this._backgroundPicking.setNodeMask(0),s}}(),_updateBackgroundPicking:function(e,t,i,r){var a=this._backgroundPicking.getVertexAttributeList().Vertex.getElements();a[0]=e,a[1]=t+r,a[3]=e,a[4]=t,a[6]=e+i,a[7]=t,a[9]=e+i,a[10]=t+r,this._backgroundPicking.getVertexAttributeList().Vertex.dirty(),this._backgroundPicking.dirtyBound()},_generateCaptions:function(){var e=this._text.getCharacterHeight(),t=0,i=this._viewport.height()-e;this._labelMaxWidth=0,this._bufferStats.generateBackground(0,this._viewport.height()-this._backgroundHeight,this._backgroundWidth,this._backgroundHeight),this._updateBackgroundPicking(0,this._viewport.height()-this._backgroundHeight,this._backgroundWidth,this._backgroundHeight);var r=this._displayFilter;for(var a in this._groups)if(!a||!r.length||-1!==r.indexOf(a)){var n=this._groups[a],o="--- "+n.caption+" ---",s=this._bufferStats.generateText(t,i,o,this._text,f.a.whiteColor);this._labelMaxWidth=Math.max(s,this._labelMaxWidth),t=0,i-=this._lineFactor*e;for(var u=0;u<n.values.length;u++){var l=n.values[u],c=this._counters[l];if(c&&c.isDisplayable()){n.textCursorY[u]=i;for(var h=c._caption,d=h.length/this._maxCaptionTextLength,p=0;p<d;p++){var m=p*this._maxCaptionTextLength,g=h.substr(m,this._maxCaptionTextLength);s=this._bufferStats.generateText(t,i,g,this._text,f.a.whiteColor),this._labelMaxWidth=Math.max(s,this._labelMaxWidth),i-=e,t=0}}}i-=e}this._bufferStats.captionsEnd()},_generateValues:function(){var e,t=this._text.getCharacterWidth(),i=this._labelMaxWidth+2*t,r=this._valuesMaxWidth+2*t,a=this._text.getCharacterHeight(),n=i,o=this._displayFilter,s=0;for(var u in this._groups)if(!u||!o.length||-1!==o.indexOf(u)){var l=this._groups[u];n=i;for(var c=0;c<l.values.length;c++){var h=l.values[c],d=this._counters[h];if(d&&d.isDisplayable()){var p,m=d.getAverageMs()?d.getAverageValue():d.getValue();p=Number.isInteger(m)?m.toString():m.toFixed(2),e=l.textCursorY[c];var _=f.a.whiteColor,v=d.getOver(),b=d.getBelow();0!==v?_=m>v?f.a.redColor:_:0!==b&&(_=m<b?f.a.redColor:_);var y=this._bufferStats.generateText(n,e,p,this._text,_);s=Math.max(y,s),this._showGraph&&d._graph&&(this._historyGraph[h]||(this._historyGraph[h]=new g.a),this._graphToDisplay.push(this._historyGraph[h]),this._historyGraph[h].setDisplayPosition(i+r,e),this._historyGraph[h].addValue(m,_)),n=i}}}this._bufferStats.valuesEnd(),this._valuesMaxWidth=s;for(var x=0;x<this._graphToDisplay.length;x++){var S=this._graphToDisplay[x];this._bufferStats.generateGraph(S,a-2)}var M=i+r;this._graphToDisplay.length&&(M+=2*g.a.maxGraphValue+1);var w=this._viewport.height()-e;this._backgroundWidth===M&&this._backgroundHeight===w||(this._backgroundWidth=M,this._backgroundHeight=w,this._dirtyCaptions=!0),this._graphToDisplay.length=0,this._bufferStats.graphsEnd(),this._bufferStats.update()},_checkCounterDisplayableChanged:function(){var e=!1;for(var t in this._counters){var i=this._counters[t];this._displayableCounters[t]!==i.isDisplayable()&&(this._displayableCounters[t]=i.isDisplayable(),e=!0)}return e},_checkViewportChanged:function(){var e=this._viewport.x(),t=this._viewport.y(),i=this._viewport.width(),r=this._viewport.height();if(e!==this._x||t!==this._y||i!==this._width||r!==this._height){this._x=e,this._y=t,this._width=i,this._height=r;var a=this._node;return p.c.ortho(a.getProjectionMatrix(),this._x,this._width,this._y,this._height,-5,5),!0}return!1}}),t.a=w},function(e,t,i){"use strict";var r=i(9),a=i(128),n=i(121),o=i(99),s=i(183),u=i(185),l=i(21),c=i(694),h=function(){this._usageHint=a.a.DYNAMIC_DRAW;this._nbVertexes=0,this._maxNbVertexes=0,this._captionNbVertexes=0,this._valuesNbVertexes=0,this._graphsNbVertexes=0,this.resize(6560)};h.backgroundColor=10,h.redColor=7,h.greyColor=4,h.whiteColor=1,r.a.createPrototypeObject(h,{getGeometry:function(){return this._geometry},generateBackground:function(e,t,i,r){var a=this._vertexes;this._nbVertexes+=4,a[0]=e,a[1]=t,a[2]=0,a[3]=h.backgroundColor;var n=e+i,o=t+r;a[4]=e,a[5]=o,a[6]=0,a[7]=h.backgroundColor,a[8]=n,a[9]=o,a[10]=0,a[11]=h.backgroundColor,a[12]=n,a[13]=t,a[14]=0,a[15]=h.backgroundColor},generateCharacter:function(e,t,i,r,a,n,o){var s=this._vertexes,u=this._nbVertexes;this._nbVertexes+=4;var l=4*u;s[l++]=e,s[l++]=t,s[l++]=a,s[l++]=-(0+o);var c=e+i,h=t+r;s[l++]=e,s[l++]=h,s[l++]=a,s[l++]=-(1+o),s[l++]=c,s[l++]=h,s[l++]=n,s[l++]=-(1+o),s[l++]=c,s[l++]=t,s[l++]=n,s[l++]=-(0+o)},generateText:function(e,t,i,r,a){var n=i.length;this._nbVertexes+4*n>=this._maxNbVertexes&&this.resize(2*this._maxNbVertexes);for(var o=r._characterSizeUV,s=r._characterWidth,u=r._characterHeight,l=0;l<n;l++){var c=i.charCodeAt(l),h=r.getCharacterUV(c);this.generateCharacter(e,t,s,u,h,h+o,a),e+=s}return n*s},generateGraph:function(e,t){this._nbVertexes+2*c.a.maxGraphValue>=this._maxNbVertexes&&this.resize(2*this._maxNbVertexes);var i=this._vertexes,r=this._nbVertexes,a=e.getValues(),n=a.length,o=e.getIndex(),s=e.getX(),u=e.getY();this._nbVertexes+=2*n;for(var l=0;l<n;l++){var d=(o+l)%n,p=a[d],f=r+2*l,m=4*f,g=p,_=h.greyColor;g>=h.redColor&&(_=h.redColor,g-=h.redColor),g>1&&(g=1),g*=t,g<1&&(g=1),i[m]=s+2*l,i[m+1]=u,i[m+2]=0,i[m+3]=_,i[m+4]=s+2*l,i[m+5]=u+g,i[m+6]=0,i[m+7]=_}},resize:function(e){l.a.log("resize buffer to "+e),this._maxNbVertexes=e;var t=new Float32Array(4*e);this._vertexes&&t.set(this._vertexes),this._vertexes=t;var i=Math.ceil(e/4);this._indexes=new Uint16Array(6*i);for(var r=0,c=0;r<i;r++)this._indexes[c++]=4*r+0,this._indexes[c++]=4*r+1,this._indexes[c++]=4*r+3,this._indexes[c++]=4*r+3,this._indexes[c++]=4*r+1,this._indexes[c++]=4*r+2;if(this._geometry)return this._geometry.getAttributes().Vertex.setElements(this._vertexes),void this._characterPrimitive.getIndices().setElements(this._indexes);this._geometry=new n.a,this._geometry.setName("osgStats-Stats"),this._geometry.getAttributes().Vertex=new a.a(a.a.ARRAY_BUFFER,this._vertexes,4,!0);var h=new a.a(a.a.ELEMENT_ARRAY_BUFFER,this._indexes,1);this._geometry.getAttributes().Vertex.setUsage(this._usageHint);var d=new s.a(o.a.TRIANGLES,h);this._characterPrimitive=d,this._geometry.getPrimitives().push(this._characterPrimitive);var p=new u.a(o.a.LINES,0,0);this._graphPrimitive=p,this._geometry.getPrimitives().push(this._graphPrimitive)},update:function(){var e=this._captionNbVertexes+this._valuesNbVertexes;this._characterPrimitive.setCount(e/4*6),this._graphPrimitive.setCount(this._graphsNbVertexes),this._graphPrimitive.setFirst(e),this._geometry.getAttributes().Vertex.dirty()},resetCaptions:function(){this._nbVertexes=0,this._captionNbVertexes=0},resetValues:function(){this._nbVertexes=this._captionNbVertexes,this._valuesNbVertexes=0,this._graphsNbVertexes=0},captionsEnd:function(){this._captionNbVertexes=this._nbVertexes},valuesEnd:function(){this._valuesNbVertexes=this._nbVertexes-this._captionNbVertexes},graphsEnd:function(){this._graphsNbVertexes=this._nbVertexes-(this._valuesNbVertexes+this._captionNbVertexes)},getCharacterPrimitive:function(){return this._characterPrimitive},getGraphPrimitive:function(){return this._graphPrimitive},getNbVertexes:function(){return this._nbVertexes}}),t.a=h},function(e,t,i){"use strict";var r=i(9),a=window.performance,n=function(e){this._caption=e.caption,this._accumValue=0,this._accumSamples=0,this._accumStart=0,this._value=0,this._averageValue=0,this._time=0,this._avgMs=0,this._over=e.over>0?e.over:0,this._below=e.below>0?e.below:0,this._graph=!!e.graph,e.average&&(this._avgMs=e.avgMs?e.avgMs:1e3),this._display=!1};r.a.createPrototypeObject(n,{isDisplayable:function(){return this._display},setDisplayable:function(e){this._display=e},getOver:function(){return this._over},getBelow:function(){return this._below},getGraph:function(){return this._graph},getAverageMs:function(){return this._avgMs},getAverageValue:function(){return this._averageValue},getValue:function(){return this._value},average:function(e){if(this._avgMs){this._accumValue+=e,this._accumSamples++;var t=a.now();t-this._accumStart>this._avgMs&&(this._averageValue=this._accumValue/this._accumSamples,this._accumValue=0,this._accumStart=t,this._accumSamples=0)}},start:function(){this._display=!0,this._time=a.now()},end:function(){this._value=a.now()-this._time,this.average(this._value)},set:function(e){this._display=!0,this._value=e,this.average(e)},tick:function(){this.end(),this.start()},frame:function(){var e=a.now()-this._time;this.set(1e3/e),this.start()}}),t.a=n},function(e,t,i){"use strict";var r=i(9),a=i(7),n=i.n(a),o=i(21),s=function(e){var t=document.getElementsByTagName("body")[0],i=document.createElement("div"),r=document.createTextNode("M");i.appendChild(r),i.setAttribute("style",e),t.appendChild(i);var a=i.offsetHeight;return t.removeChild(i),a},u=function(e){return new n.a(function(t,i){window.WebFontConfig={google:{families:[e+":200"]},active:function(){t(e)},inactive:function(e){i("loadFont error:"+e)}};var r=document.createElement("script"),a=document.scripts[0];r.src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js",r.async=!0,r.onerror=function(){i()},a.parentNode.insertBefore(r,a)})},l=function(){this._canvas=void 0,this._characterHeight=0,this._characterWidth=0,this._fontSize=16,this._fontFamily="Source Code Pro",this._characterFirstCode=" ".charCodeAt(),this._characterLastCode="z".charCodeAt(),this._characterSizeUV=0,this._backgroundColor="rgba(0,0,0,0.0)",this._createCanvas()};r.a.createPrototypeObject(l,{setFontSize:function(e){this._fontSize=e},getCharacterWidth:function(){return this._characterWidth},getCharacterHeight:function(){return this._characterHeight},getCanvas:function(){return this._promise},getCharacterUV:function(e){return(e-this._characterFirstCode)*this._characterSizeUV},_fillCanvas:function(e,t){var i=t+"px",r="font-family: "+e+"; font-size: "+i+";",a=s(r);o.a.debug(e+" "+i+" ==> "+a+" pixels high."),this._characterHeight=Math.ceil(a);var n=t+"px '"+e+"'",u=document.createElement("canvas"),l=u.getContext("2d");this._canvas=u,l.font=n,l.textBaseline="middle",this._characterWidth=l.measureText(" ").width,this._characterWidth=Math.ceil(this._characterWidth);var c=this._characterLastCode-this._characterFirstCode+1;o.a.info("Stats character size "+this._characterWidth+" x "+this._characterHeight+" texture width "+this._characterWidth*c),u.width=Math.ceil(this._characterWidth*c),u.height=this._characterHeight,this._characterSizeUV=this._characterWidth/u.width,l.font=n,l.textBaseline="middle",l.fillStyle="rgb(255,255,255)";for(var h=this._characterFirstCode,d=0;h<=this._characterLastCode;h++,d++){var p=String.fromCharCode(h),f=d*this._characterWidth,m=this._characterHeight/2;l.fillText(p,f,m)}return u},_createCanvas:function(){this._promise=u(this._fontFamily).then(function(e){return this._fillCanvas(e,this._fontSize)}.bind(this)).catch(function(){return this._fillCanvas("Courier New",this._fontSize)}.bind(this))}}),t.a=l},function(e,t,i){"use strict";var r={frame:{caption:"Total frame time",over:16,average:!0,graph:!0,max:4},stats:{caption:"stats",over:1,graph:!0},fps:{caption:"Framerate (FPS)",below:30,average:!0},raf:{caption:"Time since last rAF",average:!0,avgMs:500},update:{caption:"update",average:!0,graph:!0},cull:{caption:"cull",average:!0,graph:!0,max:16},render:{caption:"render",average:!0,graph:!0},glframe:{caption:"glframe",average:!0,graph:!0},textureused:{caption:"texture used"},texturereserved:{caption:"texture reserved"},texturetotal:{caption:"texture total"},pushstateset:{caption:"num pushStateSet"},applyStateSet:{caption:"num applyStateSet"},updatecallback:{caption:"num updateCallback"},cullcamera:{caption:"camera"},cullmatrixtransform:{caption:"matrixTransform"},cullprojection:{caption:"projection"},cullnode:{caption:"node"},culllightsource:{caption:"lightSource"},cullgeometry:{caption:"geometry"}},a=[{name:"framerate",caption:"Framerate",values:["fps","raf"]},{name:"frameBudget",caption:"Frame Budget",base:"frame",values:["frame","update","cull","render","glframe","stats"]},{name:"sceneGraph",caption:"Scene Graph ",values:["pushstateset","updatecallback","applyStateSet"]},{name:"cullVisitor",caption:"Cull",values:["cullnode","cullmatrixtransform","cullcamera","culllighsource","cullprojection","cullgeometry"]},{name:"texture",caption:"Texture Memory",values:["texturereserved","textureused","texturetotal"]}],n={values:r,groups:a};t.a=n},function(e,t,i){"use strict";var r=window.WebGLRenderingContext,a=window.WebGL2RenderingContext,n=[r,a],o=function(e,t){return function(){t.apply(this,arguments),e.apply(this,arguments)}},s=0,u=0,l=0,c=0,h=0,d=0,p=0,f=0,m=0,g=0,_=function(){for(var e=!1,t=0;t<n.length;t++){var i=n[t];i&&(e=!0,i.prototype.drawArrays=o(i.prototype.drawArrays,function(){s++,arguments[0]===this.POINTS?d+=arguments[2]:h+=arguments[2]}),i.prototype.drawElements=o(i.prototype.drawElements,function(){u++,c+=arguments[1]/3,h+=arguments[1]}),i.prototype.useProgram=o(i.prototype.useProgram,function(){l++}),i.prototype.bindTexture=o(i.prototype.bindTexture,function(){p++}))}return e},v=function(e){var t=e.getBufferStats(),i=t.getNbVertexes(),r=t.getCharacterPrimitive(),a=t.getGraphPrimitive();u-=1,a.getCount()&&(s-=1),p-=2,l-=1,h-=r.getCount()+a.getCount(),c-=r.getCount()/3,f=i,m=r.getCount()/3,g=a.getCount()/2,e.getCounter("glDrawCalls").set(u+s),e.getCounter("glDrawElements").set(u),e.getCounter("glDrawArrays").set(s),e.getCounter("glBindTexture").set(p),e.getCounter("glUseProgram").set(l),e.getCounter("glFaces").set(c),e.getCounter("glVertices").set(h),e.getCounter("glPoints").set(d),e.getCounter("statsVertices").set(f),e.getCounter("statsFaces").set(m),e.getCounter("statsLines").set(g),f=0,m=0,g=0,s=0,u=0,l=0,c=0,h=0,d=0,p=0}.bind(this),b={values:{glDrawCalls:{caption:"drawCalls"},glDrawElements:{caption:"drawElements"},glDrawArrays:{caption:"drawArrays"},glBindTexture:{caption:"bindTexture"},glUseProgram:{caption:"useProgram"},glFaces:{caption:"totalFaces"},glVertices:{caption:"totalVertices"},glPoints:{caption:"totalPoints"},statsFaces:{caption:"statsFaces"},statsVertices:{caption:"statsVertices"},statsLines:{caption:"statsLines"}},groups:[{name:"webgl",caption:"WebGL",values:["glDrawCalls","glDrawElements","glDrawArrays","glUseProgram","glBindTexture","glFaces","glVertices","glPoints","statsVertices","statsFaces","statsLines"]}],update:v,init:_};t.a=b},function(e,t,i){"use strict";var r=i(21),a=void 0,n=Math.log(1024),o=function(e){var t=Math.floor(Math.log(e)/n);return 0===e&&(t=1),Math.round(100*e/Math.pow(1024,t))/100},s=function(){return window.performance&&window.performance.memory&&(a=window.performance.memory),a&&0!==a.totalJSHeapSize||r.a.warn("Stats will not report memory, not supported by your browse"),!!a},u=function(e){var t=0,i=0;a&&(t=o(a.usedJSHeapSize),i=o(a.totalJSHeapSize)),e.getCounter("browserMemory").set(t),e.getCounter("browserMemoryTotal").set(i)},l={values:{browserMemory:{caption:"Used Memory",average:!0,avgMs:1e3},browserMemoryTotal:{caption:"Total Memory"}},groups:[{name:"browser",caption:"Browser",values:["browserMemory","browserMemoryTotal"]}],update:u,init:s};t.a=l},function(e,t,i){"use strict";var r=i(9),a=i(58),n=function(e,t){a.a.call(this),this._enable=!e,this._shadowReceiveAttribute=t,this._dirtyHash=!0,this._hash=""};r.a.createPrototypeStateAttribute(n,r.a.objectInherit(a.a.prototype,{attributeType:"ShadowCast",cloneType:function(){return new n(!0)},setReceiveAttribute:function(e){this._shadowReceiveAttribute=e},getReceiveAttribute:function(){return this._shadowReceiveAttribute},getDefines:function(){return this._shadowReceiveAttribute.getDefines()},_computeInternalHash:function(){return"ShadowCast"+this._enable+this._shadowReceiveAttribute.getPrecision()},getHash:function(){return this._shadowReceiveAttribute&&this._shadowReceiveAttribute._dirtyHash&&(this._receiveAttributeDirty=!0),this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!1,this._hash):this._hash},isEnabled:function(){return this._enable}}),"osgShadow","ShadowCastAttribute"),t.a=n},function(e,t,i){"use strict";var r=i(247),a=i(142),n=i(249),o=i(548),s=i(677),u=i(54),l=i(9),c=function(e){u.a.call(this),this._noCastMask=e,this._nodeList=[]};l.a.createPrototypeObject(c,l.a.objectInherit(u.a.prototype,{reset:function(){this._nodeList=[]},removeNodeFromCasting:function(e){var t=e.getNodeMask();-1===t?(t=this._noCastMask,e.setNodeMask(t),this._nodeList.push(e)):0!=(t&~this._noCastMask)&&(e.setNodeMask(t|this._noCastMask),this._nodeList.push(e))},apply:function(e){var t=e.getStateSet();if(t){var i=t.getAttribute("BlendFunc");if(void 0!==i&&i.getSource()!==r.a.DISABLE){var u=t.getAttribute("Depth");if(u&&(u.getFunc()===n.a.DISABLE||!1===u.getWriteMask()))return void this.removeNodeFromCasting(e)}}return e.getTypeID()===o.a.typeID||e.getTypeID()===s.a.typeID?void this.removeNodeFromCasting(e):e.getTypeID()===a.a.typeID&&e.isRenderToTextureCamera()?void this.removeNodeFromCasting(e):void this.traverse(e)},setNoCastMask:function(e){this._noCastMask=e},restore:function(){for(var e=0,t=this._nodeList.length;e<t;e++){var i=this._nodeList[e],r=i.getNodeMask();r===this._noCastMask?i.setNodeMask(-1):i.setNodeMask(r&~this._noCastMask)}}}),"osgShadow","ShadowCasterVisitor"),t.a=c},function(e,t,i){"use strict";var r=i(142),a=i(545),n=i(247),o=i(249),s=i(248),u=i(10),l=i(143),c=i(21),h=i(399),d=i(58),p=i(182),f=i(820),m=i(84),g=i(214),_=i(72),v=i(9),b=i(99),y=i(417),x=i(246),S=i(839),M=i(836),w=i(695),T=i(696),C=i(682),E=function(e){this._shadowTechnique=e};v.a.createPrototypeObject(E,{cull:function(e,t){this._shadowTechnique.getShadowedScene().nodeTraverse(t);var i=t.getCurrentCullingSet(),r=t.getCurrentProjectionMatrix(),a=t.getComputedNear(),n=t.getComputedFar();return a===1/0&&n===-1/0?(this._shadowTechnique.markSceneAsNoShadow(),!1):(u.c.getFrustumPlanes(i.getFrustum().getPlanes(),r,t.getCurrentModelViewMatrix(),!1),i.getFrustum().setupMask(6),this._shadowTechnique.setLightFrustum(i.getFrustum(),a,n),!1)}},"osgShadow","CameraCullCallback");var L=function(e,t){w.a.call(this),this._projectionMatrix=u.c.create(),this._projection=u.f.create(),this._viewMatrix=u.c.create(),this._lightNumberArrayIndex=-1,this._lightUp=u.f.fromValues(0,0,1),this._light=e.light,this._cameraShadow=new r.a,this._cameraShadow.setCullCallback(new E(this)),this._cameraShadow.setRenderOrder(r.a.PRE_RENDER,0),this._cameraShadow.setReferenceFrame(g.a.ABSOLUTE_RF),this._cameraShadow.setClearColor(u.g.fromValues(1,1,1,1)),t?this._texture=t:(this._texture=new T.a,this._textureUnitBase=4,this._textureUnit=this._textureUnitBase,this._textureMagFilter=void 0,this._textureMinFilter=void 0),this._textureSize=256;var i=_.a.createFloat2("RenderSize");this._texelSizeUniform=_.a.createFloat1(1/this._textureSize,"texelSize"),this._renderSize=i.getInternalArray(),this._renderSize[0]=this._renderSize[1]=this._textureSize,this._receivingStateset=void 0,this._casterStateSet=new p.a,this._casterStateSet.addUniform(_.a.createFloat1(0,"exponent0")),this._casterStateSet.addUniform(_.a.createFloat1(0,"exponent1")),this._casterStateSet.addUniform(_.a.createFloat1(.005,"bias")),this._casterStateSet.addUniform(this._texelSizeUniform),this._casterStateSet.addUniform(i),this._casterStateSet.setAttributeAndModes(new o.a(o.a.LESS),d.a.ON|d.a.OVERRIDE),this._casterStateSet.setAttributeAndModes(new n.a,d.a.ON|d.a.OVERRIDE),this._shadowReceiveAttribute=new S.a(this._light.getLightNumber()),this._casterStateSet.setAttributeAndModes(this._shadowReceiveAttribute,d.a.ON|d.a.OVERRIDE),this._shadowCastShaderGeneratorName="ShadowCast";var a=_.a.createFloat4("uShadowDepthRange");this._casterStateSet.addUniform(a),this._depthRange=a.getInternalArray(),this._depthRange[0]=.001,this._depthRange[1]=1e3,this._worldLightPos=u.g.create(),this._worldLightPos[3]=0,this._worldLightDir=u.g.create(),this._worldLightDir[3]=1,this._castsShadowDrawTraversalMask=4294967295,this._castsShadowBoundsTraversalMask=4294967295,this._shaderProcessor=void 0,this._tmpVec=u.f.create(),this._tmpVecBis=u.f.create(),this._tmpVecTercio=u.f.create(),this._tmpMatrix=u.c.create(),e&&this.setShadowSettings(e),this._infiniteFrustum=!0;var s=new M.a(!1,this._shadowReceiveAttribute);this._casterStateSet.setAttributeAndModes(s,d.a.ON|d.a.OVERRIDE),this._casterStateSet.setShaderGeneratorName(this._shadowCastShaderGeneratorName,d.a.OVERRIDE|d.a.ON),this._debug=!1};v.a.createPrototypeObject(L,v.a.objectInherit(w.a.prototype,{getDepthRange:function(){return this._depthRange},setLightFrustum:function(e,t,i){this._lightFrustum=e,this._depthRange[0]=t,this._depthRange[1]=i,this.nearFarBounding(),this._debug&&(this._debugGeomFrustum.updateGeometry(this._projectionMatrix,this._depthRange),u.c.invert(this._debugNodeFrustum.getMatrix(),this._viewMatrix))},getCamera:function(){return this._cameraShadow},getTexture:function(){return this._texture},isDirty:function(){return this._dirty},setTextureUnitBase:function(e){this._textureUnitBase=e,this._textureUnit=e},setShadowSettings:function(e){e&&(this._light=e.light,this._shadowCastShaderGeneratorName=e.getShadowCastShaderGeneratorName(),this.setCastsShadowDrawTraversalMask(e.castsShadowDrawTraversalMask),this.setCastsShadowBoundsTraversalMask(e.castsShadowBoundsTraversalMask),this.setLight(this._light),this.setTextureSize(e.textureSize),this.setTexturePrecision(e.textureType),this.setKernelSizePCF(e.kernelSizePCF),this.setBias(e.bias),this.setNormalBias(e.normalBias))},setCastsShadowDrawTraversalMask:function(e){this._castsShadowDrawTraversalMask=e},getCastsShadowDrawTraversalMask:function(){return this._castsDrawShadowTraversalMask},setCastsShadowBoundsTraversalMask:function(e){this._castsShadowBoundsTraversalMask=e},getCastsShadowBoundsTraversalMask:function(){return this._castsShadowBoundsTraversalMask},getNormalBias:function(){return this._shadowReceiveAttribute.getNormalBias()},setNormalBias:function(e){this._shadowReceiveAttribute.setNormalBias(e)},getJitterOffset:function(){return this._shadowReceiveAttribute.getJitterOffset()},setJitterOffset:function(e){this._shadowReceiveAttribute.setJitterOffset(e)},getBias:function(){return this._shadowReceiveAttribute.getBias()},setBias:function(e){this._shadowReceiveAttribute.setBias(e),this._casterStateSet.getUniformList().bias.getUniform().setFloat(e)},getKernelSizePCF:function(){return this._shadowReceiveAttribute.getKernelSizePCF()},setKernelSizePCF:function(e){this._shadowReceiveAttribute.setKernelSizePCF(e)},setShadowedScene:function(e){w.a.prototype.setShadowedScene.call(this,e),this._receivingStateset=this._shadowedScene.getReceivingStateSet(),this.dirty()},checkLightNumber:function(){var e=this._light.getLightNumber();this._shadowReceiveAttribute.getLightNumber()!==e&&this._receivingStateset.getAttribute(this._shadowReceiveAttribute.getTypeMember())===this._shadowReceiveAttribute&&this._receivingStateset.removeAttribute(this._shadowReceiveAttribute.getTypeMember()),this._texture&&!this._texture.hasLightNumber(e)&&this._receivingStateset.getTextureAttribute(this._textureUnit,this._texture.getTypeMember())===this._texture&&this._receivingStateset.removeTextureAttribute(this._textureUnit,this._texture.getTypeMember())},_rebindFbo:function(){this._cameraShadow.detachAll(),this._cameraShadow.attachTexture(s.a.COLOR_ATTACHMENT0,this._texture),this._cameraShadow.attachRenderBuffer(s.a.DEPTH_ATTACHMENT,s.a.DEPTH_COMPONENT16)},init:function(e,t,i){if(this._shadowedScene){this._needRedraw=!0,this.checkLightNumber();var r=this._light.getLightNumber();e?(this._texture=e,this._lightNumberArrayIndex=t,this._textureUnit=i,this._shadowReceiveAttribute.setAtlas(!0)):(this.initTexture(),this._rebindFbo(),this._textureUnit=this._textureUnitBase+r,this._texture.setLightNumber(r),this._texture.setName("ShadowTexture"+this._textureUnit),this._shadowReceiveAttribute.setAtlas(!1)),this._cameraShadow.setName("light_shadow_camera"+this._light.getName()),this._shadowReceiveAttribute.setLightNumber(r);var a=d.a.OVERRIDE|d.a.ON;this._receivingStateset.setAttributeAndModes(this._shadowReceiveAttribute,a),this._preventTextureBindingDuringShadowCasting(),this._casterStateSet.setTextureAttributeAndModes(this._textureUnit,m.default.textureNull,d.a.PROTECTED),this._receivingStateset.setTextureAttributeAndModes(this._textureUnit,this._texture,a),this._dirty=!1}},_preventTextureBindingDuringShadowCasting:function(){for(var e=x.a.instance().getWebGLParameter("MAX_TEXTURE_IMAGE_UNITS"),t=0;t<e;t++)this._casterStateSet.setTextureAttributeAndModes(t,m.default.textureNull,d.a.OVERRIDE|d.a.ON)},valid:function(){return!0},updateShadowTechnique:function(e,t,i){var r=this._cameraShadow,a=this._texture;if(r&&a){var n=r.getViewport();if(n||(n=new y.a,r.setViewport(n)),t){var o=r.getScissor();o||(o=new C.a(t[0],t[1],t[2],t[3]),r.setScissor(o)),n.x()===t[0]&&n.y()===t[1]&&n.width()===t[2]&&n.height()===t[3]||(r.setFrameBufferObject(i),n.setViewport(t[0],t[1],t[2],t[3]),o.setScissor(t[0],t[1],t[2],t[3]))}else n.width()===a.getWidth()&&n.height()===a.getHeight()||(this._rebindFbo(),n.setViewport(0,0,a.getWidth(),a.getHeight()))}},updateShadowTechnic:function(){c.a.log("ShadowMap.updateShadowTechnic() is deprecated, use updateShadowTechnique instead"),this.updateShadowTechnique()},setTextureFiltering:function(){var e;switch(this.getTexturePrecision()){case"HALF_FLOAT":e=m.default.HALF_FLOAT;break;case"FLOAT":e=m.default.FLOAT;break;default:case"UNSIGNED_BYTE":e=m.default.UNSIGNED_BYTE}this._texture.setInternalFormatType(e),this._texture.setMinFilter(m.default.NEAREST),this._texture.setMagFilter(m.default.NEAREST),this._textureMagFilter=m.default.NEAREST,this._textureMinFilter=m.default.NEAREST},initTexture:function(){if(this._dirty){this._texture||(this._texture=new T.a,this._textureUnit=this._textureUnitBase),this._texture.setTextureSize(this._textureSize,this._textureSize),this._texelSizeUniform.setFloat(1/this._textureSize),this._renderSize[0]=this._textureSize,this._renderSize[1]=this._textureSize;var e;e=m.default.RGBA,this.setTextureFiltering(),this._texture.setInternalFormat(e),this._texture.setWrapS(m.default.CLAMP_TO_EDGE),this._texture.setWrapT(m.default.CLAMP_TO_EDGE),this._texture.dirty()}},setTexturePrecision:function(e){e!==this._shadowReceiveAttribute.getPrecision()&&(this._shadowReceiveAttribute.setPrecision(e),this.dirty())},getTexturePrecision:function(){return this._shadowReceiveAttribute.getPrecision()},setTextureSize:function(e){e!==this._textureSize&&(this._textureSize=e,this.dirty())},getCasterStateSet:function(){return this._casterStateSet},setLight:function(e){e&&e!==this._light&&(this._light=e,this.dirty())},getUp:function(e){return Math.abs(u.f.dot(this._lightUp,e))>=1&&(1===this._lightUp[0]?(this._lightUp[0]=0,this._lightUp[1]=1,this._lightUp[2]=0):(this._lightUp[0]=1,this._lightUp[1]=0,this._lightUp[2]=0)),this._lightUp},nearFarBounding:function(){var e=this._depthRange[0],t=this._depthRange[1],i=L.EPSILON;t<e-i?(this._emptyCasterScene=!0,t=1,e=i):e<i&&(e=i),this._depthRange[0]=e,this._depthRange[1]=t},makePerspectiveFromBoundingBox:function(e,t,i,r,a,n){var o=e.center(this._tmpVec),s=e.radius(),l=L.EPSILON,c=l,h=1;this._radius=s;var d=u.f.distance(o,i);d<=s?(c=l,h=d+s):(c=d-s,h=d+s),this._depthRange[0]=c,this._depthRange[1]=h,this.nearFarBounding();var p=this._depthRange[0]*Math.tan(t*Math.PI/180);p=p>s?s:p;var f=p,m=-f,g=p,_=-g,v=this.getUp(r);this._infiniteFrustum?u.c.infiniteFrustum(n,_,g,m,f,this._depthRange[0]):u.c.frustum(n,_,g,m,f,this._depthRange[0],this._depthRange[1]),this._projection[0]=this._projectionMatrix[0],this._projection[1]=this._projectionMatrix[5],this._projection[2]=0,u.c.lookAtDirection(a,i,r,v)},makeOrthoFromBoundingBox:function(e,t,i,r){var a=e.center(this._tmpVecTercio),n=e.radius(),o=n+n,s=1e-4,l=o+1e-4,c=this._tmpVec;u.f.scaleAndAdd(c,a,t,-o),s=n,l+=n;s<.001*l&&(s=.001*l);var h=this.getUp(t);u.c.lookAtDirection(i,c,t,h);var d,p;p=n,d=p,u.c.ortho(r,-d,d,-p,p,s,l),this._projection[0]=d,this._projection[1]=p,this._projection[2]=1,this._depthRange[0]=s,this._depthRange[1]=l},aimShadowCastingCamera:function(e,t){var i=this._light;if(!i)return void(this._emptyCasterScene=!0);var r=this._cameraShadow,a=this._worldLightPos,n=this._worldLightDir;u.c.copy(this._projectionMatrix,r.getProjectionMatrix()),u.c.copy(this._viewMatrix,r.getViewMatrix());for(var o,s=this._projectionMatrix,l=this._viewMatrix,h=e.getCurrentRenderBin().getPositionedAttribute(),d=h.getArray(),p=0;p<h.getLength();p++){var f=d[p],m=f[1],g=f[0];if(m===i){o=g;break}}if(void 0===o)return c.a.warn("light isnt inside children of shadowedScene Node"),void(this._emptyCasterScene=!0);var _=this._tmpMatrix;if(u.c.invert(_,e.getCurrentModelViewMatrix()),this._light.isDirectionLight())u.g.transformMat4(a,i.getPosition(),o),u.g.transformMat4(a,a,_),u.f.scale(a,a,-1),u.f.normalize(a,a),this.makeOrthoFromBoundingBox(t,a,l,s),this._debug&&u.c.invert(this._debugNodeFrustum.getMatrix(),l);else{u.c.mul(this._tmpMatrix,_,o);var v=this._tmpMatrix;u.f.transformMat4(a,i.getPosition(),v),v[12]=0,v[13]=0,v[14]=0,u.c.invert(v,v),u.c.transpose(v,v),u.f.copy(n,i.getDirection()),u.g.transformMat4(n,n,v),u.f.normalize(n,n),this.makePerspectiveFromBoundingBox(t,i.getSpotCutoff(),a,n,l,s)}u.c.copy(r.getProjectionMatrix(),this._projectionMatrix),u.c.copy(r.getViewMatrix(),this._viewMatrix)},frameShadowCastingFrustum:function(e){this._infiniteFrustum||a.a.prototype.clampProjectionMatrix(this._projectionMatrix,this._depthRange[0],this._depthRange[1],e.getNearFarRatio(),this._depthRange);var t=this._cameraShadow;u.c.copy(t.getProjectionMatrix(),this._projectionMatrix),u.c.copy(t.getViewMatrix(),this._viewMatrix),this.setShadowUniformsReceive(!1)},setShadowUniformsReceive:function(e){if(e&&u.e.set(this._depthRange,0,0),-1!==this._lightNumberArrayIndex){var t=this._light.getLightNumber();this._texture.setViewMatrix(t,this._viewMatrix),this._texture.setProjection(t,this._projection),this._texture.setDepthRange(t,this._depthRange)}else this._texture.setViewMatrix(this._viewMatrix),this._texture.setProjection(this._projection),this._texture.setDepthRange(this._depthRange)},markSceneAsNoShadow:function(){this.setShadowUniformsReceive(!0),this._needRedraw=!1},cullShadowCasting:function(e,t){if(this._debug){var i=t.getMin(),r=t.getMax();t.center(this._tmpVec);var a=this._debugNodeSceneCast.getMatrix();u.c.fromScaling(a,[r[0]-i[0],r[1]-i[1],r[2]-i[2],1]),u.c.setTranslation(a,this._tmpVec)}if(this._emptyCasterScene=!1,this.aimShadowCastingCamera(e,t),this._emptyCasterScene)return void this.markSceneAsNoShadow();var n=e.getTraversalMask();e.setTraversalMask(this._castsShadowDrawTraversalMask),e.pushStateSet(this._casterStateSet),this._cameraShadow.setEnableFrustumCulling(!0),this._cameraShadow.setComputeNearFar(!0),this._debug&&this._debugNode.accept(e),this._cameraShadow.accept(e),this.nearFarBounding(),this.frameShadowCastingFrustum(e),this._cameraShadow.setComputeNearFar(!1),e.popStateSet(),e.setTraversalMask(n),this._needRedraw=!1},cleanReceivingStateSet:function(e){if(this._receivingStateset){if(this._receivingStateset.getAttribute(this._shadowReceiveAttribute.getTypeMember())===this._shadowReceiveAttribute&&this._receivingStateset.removeAttribute(this._shadowReceiveAttribute.getTypeMember()),e)return;this._texture&&this._receivingStateset.getTextureAttribute(this._textureUnit,this._texture.getTypeMember())===this._texture&&this._receivingStateset.removeTextureAttribute(this._textureUnit,this._texture.getTypeMember())}},cleanSceneGraph:function(e){this._needRedraw=!0,this.cleanReceivingStateSet(e),this._texture=void 0,this._shadowedScene=void 0},setDebug:function(e){e&&!this._debug&&(this._debugNode||(this._debugGeomFrustum=f.a.createDebugFrustumGeometry(),this._debugGeomSceneCast=h.a.createBoundingBoxGeometry(),this._debugGeomSceneCast.getPrimitives()[0].mode=b.a.LINES,this._debugNode=new l.a,this._debugNodeFrustum=new l.a,this._debugNodeSceneCast=new l.a,this._debugNodeFrustum.addChild(this._debugGeomFrustum),this._debugNodeSceneCast.addChild(this._debugGeomSceneCast),this._debugNode.addChild(this._debugNodeFrustum),this._debugNode.addChild(this._debugNodeSceneCast))),this._debug=e},getDebug:function(){return this._debug},getLightNumber:function(){return this._light.getLightNumber()},getLight:function(){return this._light}}),"osgShadow","ShadowMap"),L.EPSILON=.005,t.a=L},function(e,t,i){"use strict";var r=i(9),a=i(58),n=i(72),o=function(e,t){a.a.call(this),this._lightNumber=e,this._bias=.001,this._normalBias=void 0,this._precision="UNSIGNED_BYTE",this._kernelSizePCF=void 0,this._fakePCF=!0,this._jitterOffset="none",this._enable=!t,this._isAtlasTexture=!1,this._dirtyHash=!0,this._hash=""};o.uniforms={},r.a.createPrototypeStateAttribute(o,r.a.objectInherit(a.a.prototype,{attributeType:"ShadowReceive",cloneType:function(){return new o(this._lightNumber,!0)},getTypeMember:function(){return this.attributeType+this.getLightNumber()},getLightNumber:function(){return this._lightNumber},getUniformName:function(e){return"u"+(this.getType()+this.getLightNumber().toString())+"_"+e},getAtlas:function(){return this._isAtlasTexture},setAtlas:function(e){this._isAtlasTexture=e},setBias:function(e){this._bias=e},getBias:function(){return this._bias},setNormalBias:function(e){this._normalBias=e},getNormalBias:function(){return this._normalBias},setJitterOffset:function(e){this._jitterOffset=e},getJitterOffset:function(){return this._jitterOffset},getKernelSizePCF:function(){return this._kernelSizePCF},setKernelSizePCF:function(e){this._kernelSizePCF=e,this._dirtyHash=!0},setPrecision:function(e){this._precision=e,this._dirtyHash=!0},getPrecision:function(){return this._precision},setLightNumber:function(e){this._lightNumber=e,this._dirtyHash=!0},getOrCreateUniforms:function(){var e=o,t=this.getTypeMember();return e.uniforms[t]?e.uniforms[t]:(e.uniforms[t]={bias:n.a.createFloat(this.getUniformName("bias")),normalBias:n.a.createFloat(this.getUniformName("normalBias"))},e.uniforms[t])},getDefines:function(){var e=[];switch(this.getKernelSizePCF()){case"4Tap(16texFetch)":e.push("#define _PCFx4");break;case"9Tap(36texFetch)":e.push("#define _PCFx9");break;case"16Tap(64texFetch)":e.push("#define _PCFx25");break;default:case"1Tap(4texFetch)":e.push("#define _PCFx1")}return"UNSIGNED_BYTE"!==this.getPrecision()&&e.push("#define _FLOATTEX"),this.getAtlas()&&e.push("#define _ATLAS_SHADOW"),this.getNormalBias()&&e.push("#define _NORMAL_OFFSET"),"none"!==this.getJitterOffset()&&e.push("#define _JITTER_OFFSET"),e},apply:function(){if(this._enable){var e=this.getOrCreateUniforms();e.normalBias.setFloat(this._normalBias),e.bias.setFloat(this._bias)}},isEnabled:function(){return this._enable},getHash:function(){return this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!1,this._hash):this._hash},_computeInternalHash:function(){return this.getTypeMember()+"_"+this.getKernelSizePCF()}}),"osgShadow","ShadowReceiveAttribute"),t.a=o},function(e,t,i){"use strict";var r=i(21),a=i(84),n=i(696),o=i(72),s=i(9),u=i(10),l=function(){a.default.call(this),this._uniforms={},this._lightNumberArray=[],this._viewMatrices=[],this._projection=[],this._depthRanges=[],this._mapSizes=[],this._renderSize=u.e.create(),this._dirtyHash=!0,this._hash=""};l.uniforms={},s.a.createPrototypeStateAttribute(l,s.a.objectInherit(a.default.prototype,{cloneType:function(){return new l},getLightNumberArray:function(){return this._lightNumberArray},hasLightNumber:function(e){return-1!==this._lightNumberArray.indexOf(e)},setLightNumberArray:function(e){this._lightNumberArray=e,this._dirtyHash=!0},getUniformName:function(e,t){return"uShadow_"+this.getType()+e.toString()+"_"+t},setInternalFormatType:function(e){a.default.prototype.setInternalFormatType.call(this,e),this._dirtyHash=!0},createUniforms:function(e,t){t["ViewRight_"+e]=o.a.createFloat4(this.getUniformName(e,"ViewRight")),t["ViewUp_"+e]=o.a.createFloat4(this.getUniformName(e,"ViewUp")),t["ViewLook_"+e]=o.a.createFloat4(this.getUniformName(e,"ViewLook")),t["Projection_"+e]=o.a.createFloat3(this.getUniformName(e,"projection")),t["DepthRange_"+e]=o.a.createFloat2(this.getUniformName(e,"depthRange")),t["MapSize_"+e]=o.a.createFloat4(this.getUniformName(e,"mapSize")),t["RenderSize_"+e]=t.RenderSize},getOrCreateUniforms:function(e){var t=l;if(r.a.assert(void 0!==e||0!==this._lightNumberArray.length),void 0!==t.uniforms[e])return t.uniforms[e];var i=t.uniforms[e]={},a=o.a.createFloat2(this.getUniformName(0,"renderSize"));i.RenderSize=a;for(var n=0,s=this._lightNumberArray.length;n<s;n++)this.createUniforms(this._lightNumberArray[n],i);var u="Texture"+e,c=o.a.createInt1(e,u);return i[u]=c,t.uniforms[e]},setViewMatrix:function(e,t){this._viewMatrices[e]=t},setProjection:function(e,t){this._projection[e]=t},setDepthRange:function(e,t){this._depthRanges[e]=t},setLightShadowMapSize:function(e,t){this._mapSizes[e]=t},apply:function(e,t){if(a.default.prototype.apply.call(this,e,t),0!==this._lightNumberArray.length){for(var i=this.getOrCreateUniforms(t),r=0,o=this._lightNumberArray.length;r<o;r++){var s=this._lightNumberArray[r];i["ViewRight_"+s]||this.createUniforms(s,i),n.a.prototype._updateViewMatrixUniforms.call(this,this._viewMatrices[s],i["ViewRight_"+s],i["ViewUp_"+s],i["ViewLook_"+s]),i["Projection_"+s].setFloat3(this._projection[s]),i["DepthRange_"+s].setFloat2(this._depthRanges[s]),i["MapSize_"+s].setFloat4(this._mapSizes[s])}i.RenderSize.setFloat2(this._renderSize)}},setTextureSize:function(e,t){this._renderSize[0]=1/e,this._renderSize[1]=1/t,a.default.prototype.setTextureSize.call(this,e,t),this.dirty()},_computeInternalHash:function(){for(var e=this.getTypeMember(),t=0,i=this._lightNumberArray.length;t<i;t++)e+="_"+this._lightNumberArray[t];return e+="_"+this._type},getHash:function(){return this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!1,this._hash):this._hash}}),"osgShadow","ShadowTextureAtlas"),t.a=l},function(e,t,i){"use strict";i.d(t,"b",function(){return s}),i.d(t,"a",function(){return o});var r=i(136),a=!0,n=0,o=function(e){a=e},s=function(e){var t=e.osg.WebGLCaps.instance(),o=t.getWebGLParameter("UNMASKED_RENDERER_WEBGL"),s=t.getWebGLParameter("UNMASKED_VENDOR_WEBGL"),u=t.getWebGLParameter("MAX_VARYING_VECTORS"),l=t.getWebGLParameter("MAX_VERTEX_ATTRIBS"),c=t.getWebGLParameter("MAX_FRAGMENT_UNIFORM_VECTORS"),h=t.getWebGLParameter("MAX_VERTEX_UNIFORM_VECTORS"),d=i(42),p=d.apple.device;e.osg.Program.registerErrorCallback(function(e,i,d){if(a){if(!(!d||0===d.length)&&-1===d.indexOf("Internal linking error")){var f="Shader Error: ";if(f+=d,!p)if(o&&(f+="\n"+o),s&&(f+="\n"+s),30!==u&&(f+="\nVarying: "+u),e&&(16!==l&&(f+="\nAttributes:"+l),4096!==h&&(f+="\nVertUnif:"+h)),1024!==c&&(f+="\nFragUnif:"+c),t.isWebGL2())f+="\nWebGL2";else{var m,g=t.getWebGLExtensions(),_=["EXT_shader_texture_lod","OES_standard_derivatives","OES_vertex_array_object","EXT_texture_filter_anisotropic"];for(m=0;m<_.length;m++){var v=_[m];g[v]&&(f+="\n"+v.substring(v.indexOf("_")+1))}var b=["hasLinearFloatRTT","hasLinearHalfFloatRTT","hasHalfFloatRTT","hasFloatRTT"];for(m;m<b.length;m++){var y=b[m];t[y]()&&(f+="\n"+y.substring(3))}}e&&(f+="\nVS\n"+e),i&&(f+="\nFS\n "+i);var x="errorLogs ";c<64&&(x="ultraLowGPU");var S={tags:{shaderErrors:x}};r.a.client.captureMessage(f,S),n++,n>2&&(a=!1)}}})}},function(e,t,i){"use strict";function r(e){a.copy(e,this)}var a=i(456);e.exports=r},function(e,t,i){"use strict";e.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var i="boolean"==typeof t.cycles&&t.cycles,r=t.cmp&&function(e){return function(t){return function(i,r){var a={key:i,value:t[i]},n={key:r,value:t[r]};return e(a,n)}}}(t.cmp),a=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var n,o;if(Array.isArray(t)){for(o="[",n=0;n<t.length;n++)n&&(o+=","),o+=e(t[n])||"null";return o+"]"}if(null===t)return"null";if(-1!==a.indexOf(t)){if(i)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=a.push(t)-1,u=Object.keys(t).sort(r&&r(t));for(o="",n=0;n<u.length;n++){var l=u[n],c=e(t[l]);c&&(o&&(o+=","),o+=JSON.stringify(l)+":"+c)}return a.splice(s,1),"{"+o+"}"}}(e)}},function(e,t,i){"use strict";e.exports=function(e,t,i){function r(e){for(var t=e.rules,i=0;i<t.length;i++)if(a(t[i]))return!0}function a(t){return void 0!==e.schema[t.keyword]||t.implements&&n(t)}function n(t){for(var i=t.implements,r=0;r<i.length;r++)if(void 0!==e.schema[i[r]])return!0}var o="",s=!0===e.schema.$async,u=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),l=e.self._getId(e.schema);if(e.isTop&&(o+=" var validate = ",s&&(e.async=!0,o+="async "),o+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",l&&(e.opts.sourceCode||e.opts.processCode)&&(o+=" /*# sourceURL="+l+" */ ")),"boolean"==typeof e.schema||!u&&!e.schema.$ref){var c,h=e.level,d=e.dataLevel,p=e.schema["false schema"],f=e.schemaPath+e.util.getProperty("false schema"),m=e.errSchemaPath+"/false schema",g=!e.opts.allErrors,_="data"+(d||""),v="valid"+h;if(!1===e.schema){e.isTop?g=!0:o+=" var "+v+" = false; ";var b=b||[];b.push(o),o="",!1!==e.createErrors?(o+=" { keyword: '"+(c||"false schema")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(m)+" , params: {} ",!1!==e.opts.messages&&(o+=" , message: 'boolean schema is false' "),e.opts.verbose&&(o+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+_+" "),o+=" } "):o+=" {} ";var y=o;o=b.pop(),!e.compositeRule&&g?e.async?o+=" throw new ValidationError(["+y+"]); ":o+=" validate.errors = ["+y+"]; return false; ":o+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?o+=s?" return data; ":" validate.errors = null; return true; ":o+=" var "+v+" = true; ";return e.isTop&&(o+=" }; return validate; "),o}if(e.isTop){var x=e.isTop,h=e.level=0,d=e.dataLevel=0,_="data";e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[void 0],o+=" var vErrors = null; ",o+=" var errors = 0;     ",o+=" if (rootData === undefined) rootData = data; "}else{var h=e.level,d=e.dataLevel,_="data"+(d||"");if(l&&(e.baseId=e.resolve.url(e.baseId,l)),s&&!e.async)throw new Error("async schema in sync schema");o+=" var errs_"+h+" = errors;"}var c,v="valid"+h,g=!e.opts.allErrors,S="",M="",w=e.schema.type,T=Array.isArray(w);if(T&&1==w.length&&(w=w[0],T=!1),e.schema.$ref&&u){if("fail"==e.opts.extendRefs)throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');!0!==e.opts.extendRefs&&(u=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(o+=" "+e.RULES.all.$comment.code(e,"$comment")),w){if(e.opts.coerceTypes)var C=e.util.coerceToTypes(e.opts.coerceTypes,w);var E=e.RULES.types[w];if(C||T||!0===E||E&&!r(E)){var f=e.schemaPath+".type",m=e.errSchemaPath+"/type",f=e.schemaPath+".type",m=e.errSchemaPath+"/type",L=T?"checkDataTypes":"checkDataType";if(o+=" if ("+e.util[L](w,_,!0)+") { ",C){var P="dataType"+h,A="coerced"+h;o+=" var "+P+" = typeof "+_+"; ","array"==e.opts.coerceTypes&&(o+=" if ("+P+" == 'object' && Array.isArray("+_+")) "+P+" = 'array'; "),o+=" var "+A+" = undefined; ";var D="",O=C;if(O)for(var k,R=-1,I=O.length-1;R<I;)k=O[R+=1],R&&(o+=" if ("+A+" === undefined) { ",D+="}"),"array"==e.opts.coerceTypes&&"array"!=k&&(o+=" if ("+P+" == 'array' && "+_+".length == 1) { "+A+" = "+_+" = "+_+"[0]; "+P+" = typeof "+_+";  } "),"string"==k?o+=" if ("+P+" == 'number' || "+P+" == 'boolean') "+A+" = '' + "+_+"; else if ("+_+" === null) "+A+" = ''; ":"number"==k||"integer"==k?(o+=" if ("+P+" == 'boolean' || "+_+" === null || ("+P+" == 'string' && "+_+" && "+_+" == +"+_+" ","integer"==k&&(o+=" && !("+_+" % 1)"),o+=")) "+A+" = +"+_+"; "):"boolean"==k?o+=" if ("+_+" === 'false' || "+_+" === 0 || "+_+" === null) "+A+" = false; else if ("+_+" === 'true' || "+_+" === 1) "+A+" = true; ":"null"==k?o+=" if ("+_+" === '' || "+_+" === 0 || "+_+" === false) "+A+" = null; ":"array"==e.opts.coerceTypes&&"array"==k&&(o+=" if ("+P+" == 'string' || "+P+" == 'number' || "+P+" == 'boolean' || "+_+" == null) "+A+" = ["+_+"]; ");o+=" "+D+" if ("+A+" === undefined) {   ";var b=b||[];b.push(o),o="",!1!==e.createErrors?(o+=" { keyword: '"+(c||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(m)+" , params: { type: '",o+=T?""+w.join(","):""+w,o+="' } ",!1!==e.opts.messages&&(o+=" , message: 'should be ",o+=T?""+w.join(","):""+w,o+="' "),e.opts.verbose&&(o+=" , schema: validate.schema"+f+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+_+" "),o+=" } "):o+=" {} ";var y=o;o=b.pop(),!e.compositeRule&&g?e.async?o+=" throw new ValidationError(["+y+"]); ":o+=" validate.errors = ["+y+"]; return false; ":o+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",o+=" } else {  ";var F=d?"data"+(d-1||""):"parentData",N=d?e.dataPathArr[d]:"parentDataProperty";o+=" "+_+" = "+A+"; ",d||(o+="if ("+F+" !== undefined)"),o+=" "+F+"["+N+"] = "+A+"; } "}else{var b=b||[];b.push(o),o="",!1!==e.createErrors?(o+=" { keyword: '"+(c||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(m)+" , params: { type: '",o+=T?""+w.join(","):""+w,o+="' } ",!1!==e.opts.messages&&(o+=" , message: 'should be ",o+=T?""+w.join(","):""+w,o+="' "),e.opts.verbose&&(o+=" , schema: validate.schema"+f+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+_+" "),o+=" } "):o+=" {} ";var y=o;o=b.pop(),!e.compositeRule&&g?e.async?o+=" throw new ValidationError(["+y+"]); ":o+=" validate.errors = ["+y+"]; return false; ":o+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}o+=" } "}}if(e.schema.$ref&&!u)o+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",g&&(o+=" } if (errors === ",o+=x?"0":"errs_"+h,o+=") { ",M+="}");else{var V=e.RULES;if(V)for(var E,B=-1,U=V.length-1;B<U;)if(E=V[B+=1],r(E)){if(E.type&&(o+=" if ("+e.util.checkDataType(E.type,_)+") { "),e.opts.useDefaults&&!e.compositeRule)if("object"==E.type&&e.schema.properties){var p=e.schema.properties,j=Object.keys(p),G=j;if(G)for(var Y,H=-1,z=G.length-1;H<z;){Y=G[H+=1];var W=p[Y];if(void 0!==W.default){var q=_+e.util.getProperty(Y);o+="  if ("+q+" === undefined) "+q+" = ","shared"==e.opts.useDefaults?o+=" "+e.useDefault(W.default)+" ":o+=" "+JSON.stringify(W.default)+" ",o+="; "}}}else if("array"==E.type&&Array.isArray(e.schema.items)){var X=e.schema.items;if(X)for(var W,R=-1,J=X.length-1;R<J;)if(W=X[R+=1],void 0!==W.default){var q=_+"["+R+"]";o+="  if ("+q+" === undefined) "+q+" = ","shared"==e.opts.useDefaults?o+=" "+e.useDefault(W.default)+" ":o+=" "+JSON.stringify(W.default)+" ",o+="; "}}var K=E.rules;if(K)for(var $,Q=-1,Z=K.length-1;Q<Z;)if($=K[Q+=1],a($)){var ee=$.code(e,$.keyword,E.type);ee&&(o+=" "+ee+" ",g&&(S+="}"))}if(g&&(o+=" "+S+" ",S=""),E.type&&(o+=" } ",w&&w===E.type&&!C)){o+=" else { ";var f=e.schemaPath+".type",m=e.errSchemaPath+"/type",b=b||[];b.push(o),o="",!1!==e.createErrors?(o+=" { keyword: '"+(c||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(m)+" , params: { type: '",o+=T?""+w.join(","):""+w,o+="' } ",!1!==e.opts.messages&&(o+=" , message: 'should be ",o+=T?""+w.join(","):""+w,o+="' "),e.opts.verbose&&(o+=" , schema: validate.schema"+f+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+_+" "),o+=" } "):o+=" {} ";var y=o;o=b.pop(),!e.compositeRule&&g?e.async?o+=" throw new ValidationError(["+y+"]); ":o+=" validate.errors = ["+y+"]; return false; ":o+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",o+=" } "}g&&(o+=" if (errors === ",o+=x?"0":"errs_"+h,o+=") { ",M+="}")}}return g&&(o+=" "+M+" "),x?(s?(o+=" if (errors === 0) return data;           ",o+=" else throw new ValidationError(vErrors); "):(o+=" validate.errors = vErrors; ",o+=" return errors === 0;       "),o+=" }; return validate;"):o+=" var "+v+" = errors === errs_"+h+";",o=e.util.cleanUpCode(o),x&&(o=e.util.finalCleanUpCode(o,s)),o}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r,a,n=" ",o=e.level,s=e.dataLevel,u=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,h=!e.opts.allErrors,d="data"+(s||""),p=e.opts.$data&&u&&u.$data;p?(n+=" var schema"+o+" = "+e.util.getData(u.$data,s,e.dataPathArr)+"; ",a="schema"+o):a=u;var f="maximum"==t,m=f?"exclusiveMaximum":"exclusiveMinimum",g=e.schema[m],_=e.opts.$data&&g&&g.$data,v=f?"<":">",b=f?">":"<",r=void 0;if(_){var y=e.util.getData(g.$data,s,e.dataPathArr),x="exclusive"+o,S="exclType"+o,M="exclIsNumber"+o,w="op"+o,T="' + "+w+" + '";n+=" var schemaExcl"+o+" = "+y+"; ",y="schemaExcl"+o,n+=" var "+x+"; var "+S+" = typeof "+y+"; if ("+S+" != 'boolean' && "+S+" != 'undefined' && "+S+" != 'number') { ";var r=m,C=C||[];C.push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(r||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: '"+m+" should be boolean' "),e.opts.verbose&&(n+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var E=n;n=C.pop(),!e.compositeRule&&h?e.async?n+=" throw new ValidationError(["+E+"]); ":n+=" validate.errors = ["+E+"]; return false; ":n+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else if ( ",p&&(n+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),n+=" "+S+" == 'number' ? ( ("+x+" = "+a+" === undefined || "+y+" "+v+"= "+a+") ? "+d+" "+b+"= "+y+" : "+d+" "+b+" "+a+" ) : ( ("+x+" = "+y+" === true) ? "+d+" "+b+"= "+a+" : "+d+" "+b+" "+a+" ) || "+d+" !== "+d+") { var op"+o+" = "+x+" ? '"+v+"' : '"+v+"='; ",void 0===u&&(r=m,c=e.errSchemaPath+"/"+m,a=y,p=_)}else{var M="number"==typeof g,T=v;if(M&&p){var w="'"+T+"'";n+=" if ( ",p&&(n+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),n+=" ( "+a+" === undefined || "+g+" "+v+"= "+a+" ? "+d+" "+b+"= "+g+" : "+d+" "+b+" "+a+" ) || "+d+" !== "+d+") { "}else{M&&void 0===u?(x=!0,r=m,c=e.errSchemaPath+"/"+m,a=g,b+="="):(M&&(a=Math[f?"min":"max"](g,u)),g===(!M||a)?(x=!0,r=m,c=e.errSchemaPath+"/"+m,b+="="):(x=!1,T+="="));var w="'"+T+"'";n+=" if ( ",p&&(n+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),n+=" "+d+" "+b+" "+a+" || "+d+" !== "+d+") { "}}r=r||t;var C=C||[];C.push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(r||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { comparison: "+w+", limit: "+a+", exclusive: "+x+" } ",!1!==e.opts.messages&&(n+=" , message: 'should be "+T+" ",n+=p?"' + "+a:a+"'"),e.opts.verbose&&(n+=" , schema:  ",n+=p?"validate.schema"+l:""+u,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var E=n;return n=C.pop(),!e.compositeRule&&h?e.async?n+=" throw new ValidationError(["+E+"]); ":n+=" validate.errors = ["+E+"]; return false; ":n+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } ",h&&(n+=" else { "),n}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r,a,n=" ",o=e.level,s=e.dataLevel,u=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,h=!e.opts.allErrors,d="data"+(s||""),p=e.opts.$data&&u&&u.$data;p?(n+=" var schema"+o+" = "+e.util.getData(u.$data,s,e.dataPathArr)+"; ",a="schema"+o):a=u;var f="maxItems"==t?">":"<";n+="if ( ",p&&(n+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),n+=" "+d+".length "+f+" "+a+") { ";var r=t,m=m||[];m.push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(r||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+a+" } ",!1!==e.opts.messages&&(n+=" , message: 'should NOT have ",n+="maxItems"==t?"more":"less",n+=" than ",n+=p?"' + "+a+" + '":""+u,n+=" items' "),e.opts.verbose&&(n+=" , schema:  ",n+=p?"validate.schema"+l:""+u,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var g=n;return n=m.pop(),!e.compositeRule&&h?e.async?n+=" throw new ValidationError(["+g+"]); ":n+=" validate.errors = ["+g+"]; return false; ":n+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",h&&(n+=" else { "),n}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r,a,n=" ",o=e.level,s=e.dataLevel,u=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,h=!e.opts.allErrors,d="data"+(s||""),p=e.opts.$data&&u&&u.$data;p?(n+=" var schema"+o+" = "+e.util.getData(u.$data,s,e.dataPathArr)+"; ",a="schema"+o):a=u;var f="maxLength"==t?">":"<";n+="if ( ",p&&(n+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),!1===e.opts.unicode?n+=" "+d+".length ":n+=" ucs2length("+d+") ",n+=" "+f+" "+a+") { ";var r=t,m=m||[];m.push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(r||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+a+" } ",!1!==e.opts.messages&&(n+=" , message: 'should NOT be ",n+="maxLength"==t?"longer":"shorter",n+=" than ",n+=p?"' + "+a+" + '":""+u,n+=" characters' "),e.opts.verbose&&(n+=" , schema:  ",n+=p?"validate.schema"+l:""+u,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var g=n;return n=m.pop(),!e.compositeRule&&h?e.async?n+=" throw new ValidationError(["+g+"]); ":n+=" validate.errors = ["+g+"]; return false; ":n+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",h&&(n+=" else { "),n}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r,a,n=" ",o=e.level,s=e.dataLevel,u=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,h=!e.opts.allErrors,d="data"+(s||""),p=e.opts.$data&&u&&u.$data;p?(n+=" var schema"+o+" = "+e.util.getData(u.$data,s,e.dataPathArr)+"; ",a="schema"+o):a=u;var f="maxProperties"==t?">":"<";n+="if ( ",p&&(n+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),n+=" Object.keys("+d+").length "+f+" "+a+") { ";var r=t,m=m||[];m.push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(r||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+a+" } ",!1!==e.opts.messages&&(n+=" , message: 'should NOT have ",n+="maxProperties"==t?"more":"less",n+=" than ",n+=p?"' + "+a+" + '":""+u,n+=" properties' "),e.opts.verbose&&(n+=" , schema:  ",n+=p?"validate.schema"+l:""+u,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var g=n;return n=m.pop(),!e.compositeRule&&h?e.async?n+=" throw new ValidationError(["+g+"]); ":n+=" validate.errors = ["+g+"]; return false; ":n+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",h&&(n+=" else { "),n}},function(e,t,i){"use strict";var r=i(0);i.n(r);t.a={addNewImage:function(e){if(!this.model)throw new Error("This collection must implement a model.");var t,i=e.uid;i?t=i.replace(/tmp_/,""):(t=e.id||Object(r.uniqueId)(),i="tmp_"+t);var a=new this.model({images:[{uid:i,url:e.url,width:e.width,height:e.height}],uid:i,id:t,name:e.name||"newImage",imageFile:e.imageFile});return this.set(a,{merge:!0,add:!0,remove:!1}),a}}},function(e,t,i){"use strict";var r=i(5),a=r.a.osg,n=function(){a.TextureCubeMap.call(this),this._imageProxy=void 0};a.createPrototypeStateAttribute(n,a.objectInherit(a.TextureCubeMap.prototype,{getHash:function(){return"osgSketchfabTexture"}}),"osgSketchfab","TextureCubeMap"),n.dummyTexture=new n,n.dummyTexture.setTextureSize(1,1),t.a=n},function(e,t,i){"use strict";var r=3.14159265359,a={},n=function(e,t,i,n,o,s){n=n||.25,o=o||720;var u=Math.cos(.01745329251*n),l=0,c=a.table;if(void 0===c)for(c=a.table=new Float32Array(1801779),a.nphi=o,a.epsilon=n,l=0;l<1801779;++l)c[l]=1/0;var h=r/(o-1),d=1.57079632679/(o-1),p=s?3:2,f=o!==a.nphi||n!==a.epsilon,m=e.length/p;for(l=0;l<m;++l){var g=l*i,_=l*p,v=e[_],b=e[_+1];4!==i||s||(t[g+3]=1024&v?-1:1,v&=-1025);var y,x,S,M=3*(v+o*b),w=M>=1801779;if(f||w||c[M]===1/0){var T=v*h,C=Math.cos(T),E=Math.sin(T);T+=d;var L=(u-C*Math.cos(T))/Math.max(1e-5,E*Math.sin(T));L>1?L=1:L<-1&&(L=-1);var P=6.28318530718*b/Math.ceil(r/Math.max(1e-5,Math.acos(L)));y=E*Math.cos(P),x=E*Math.sin(P),S=C,w||f||(c[M]=y,c[M+1]=x,c[M+2]=S)}else y=c[M],x=c[M+1],S=c[M+2];if(s){var A=47938362584151635e-21*e[_+2],D=Math.sin(A);t[g]=D*y,t[g+1]=D*x,t[g+2]=D*S,t[g+3]=Math.cos(A)}else t[g]=y,t[g+1]=x,t[g+2]=S}return t};t.a=n},function(e,t,i){"use strict";var r=function(e,t,i,r,a){for(var n=e.length/a,o=0;o<n;++o)for(var s=o*a,u=0;u<a;++u)t[s+u]=i[u]+e[s+u]*r[u];return t};t.a=r},function(e,t,i){"use strict";var r=i(5),a=r.a.osg,n=function(e,t,i){for(var r=new a[i](t),n=0,o=0;n!==t;){var s=0,u=0;do{s|=(127&e[o])<<u,u+=7}while(0!=(128&e[o++]));r[n++]=s}if("U"!==i[0])for(var l=0;l<t;++l){var c=r[l];r[l]=c>>1^-(1&c)}return r};t.a=n},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(5)),n=i(12),o=i(700),s=i(59),u=a.a.osg,l=Object(r.invert)(u.Texture),c=["magFilter","minFilter","wrapS","wrapT","textureTarget","internalFormat"],h=n.a.extend({initialize:function(){if(n.a.prototype.initialize.apply(this,arguments),!this.attributes.image)return void u.error("no image found in attributes, TextureModel invalid");var e=o.a.createValidOptionsForMaterial(this.attributes);this.set(e),this.setMultiresTextureFromValidOptions(e),void 0===this.get("texCoordUnit")&&this.set("texCoordUnit",0),this.bind("change:image",this.updateMultiresTexture,this)},getImageModel:function(){return this.get("image")},setImageModel:function(e){this.set("image",e)},getResourceManager:function(){return this._resourceManager||s.default.instance},getMultiresTexture:function(){return this.get("multiresTexture")},getURL:function(){console.trace("dont call TextureModel.getURL")},setMultiresTextureFromValidOptions:function(e){var t=this.get("image").getUID(),i=this.getResourceManager().getOrCreateMultiresTexture(t,e);i&&this.set("multiresTexture",i.resource)},updateMultiresTexture:function(){this.setMultiresTextureFromValidOptions(o.a.createValidOptionsForMaterial(this.attributes))},isLuminance:function(){return this.get("internalFormat")===u.Texture.LUMINANCE},isAlpha:function(){return this.get("internalFormat")===u.Texture.ALPHA},getUID:function(){return this.getImageModel().getUID()},getJSON:function(){for(var e={},t=0,i=c.length;t<i;++t){var r=c[t];e[r]=l[this.get(r)]}return e.texCoordUnit=this.get("texCoordUnit"),e.uid=this.getUID(),e}});t.a=h},function(e,t,i){"use strict";var r=i(5),a=i(34),n=i(43),o=i(16),s=i(251),u=i(57),l=i(63),c=r.a.osg,h=r.a.osgUtil,d=r.a.osgAnimation,p=n.a.SHADOW_CAST|n.a.PICK_GEOMETRY_ANIMATED;d.MorphGeometry.MAX_MORPH_GPU=Math.min(4,Object(o.a)().morphGpu);var f=h.IntersectionVisitor.prototype.enter;h.IntersectionVisitor.prototype.enter=function(e){return!!e._forceEnterIntersection||f.call(this,e)};var m=function(){};c.createPrototypeObject(m,{cull:function(){return!1}},"osgSketchfab","HideCullCallback");var g=new m,_=function(){var e=c.vec3.create(),t=c.vec3.create();return function(i){i.center(e),c.vec3.sub(t,i.getMax(),i.getMin());var r=c.createTexturedBoxGeometry(e[0],e[1],e[2],t[0],t[1],t[2]);return r.setName("BoneBox"),3!==Object(o.a)().showBones&&r.setCullCallback(g),r._isBoneBox=!0,r.setNodeMask(n.a.PICK_GEOMETRY_RIG_BOX|n.a.SHADOW_BOUNDS),r}}(),v=function(e){for(var t=h.GizmoGeometry.createCylinderGeometry(.1*e,.02*e,e),i=t.getAttributes().Vertex.getElements(),r=0,a=i.length/3;r<a;++r)i[3*r+2]+=.5*e;return t._isSkeleton=!0,t},b=function(e){c.NodeVisitor.call(this),this._visitedNodes={},this._drawNames=e;var t=c.StateAttribute.OVERRIDE_ON,i=this._geoStateSet=new c.StateSet;i.setShaderGeneratorName("skeleton",t),i.setAttributeAndModes(l.a.DEPTH_ALWAYS,t),i.setRenderBinDetails(u.a.DEBUG_2,"RenderBin"),s.a.set("hasExtra",!0)};c.createPrototypeObject(b,c.objectInherit(c.NodeVisitor.prototype,{drawBone:function(){var e=c.vec3.create(),t=c.vec3.fromValues(0,0,1),i=c.quat.create();return function(r){var a=r.getChildren();if(a.length)for(var n=0;n<a.length;++n){var o=a[n];if(o instanceof d.Bone!=!1){c.vec3.transformMat4(e,c.vec3.set(e,0,0,0),o.getMatrix());var s=v(c.vec3.len(e));s.setStateSet(this._geoStateSet),s._boundingBoxComputed=!0,s._boundingSphereComputed=!0;var u=new c.MatrixTransform;c.quat.rotationTo(i,t,c.vec3.normalize(e,e)),c.mat4.fromRotationTranslation(u.getMatrix(),i,c.vec3.ZERO);var l=c.Uniform.createFloat4("uColor"),h=l.getInternalArray(),p=r.getOrCreateDebugColor();h[0]=.9*p[0],h[1]=.9*p[1],h[2]=.9*p[2],h[3]=1,u.getOrCreateStateSet().addUniform(l);var f="Debug "+r.getName();u.setName(f),s.setName(f),u.addChild(s),r.addChild(u)}}}}(),apply:function(e){var t=e.getInstanceID();this._visitedNodes[t]||(this._visitedNodes[t]=!0,e instanceof d.Bone&&this._drawNames[e.getName()]&&this.drawBone(e),this.traverse(e))}}),"osgSketchfab","DrawBoneVisitor");var y=function(e,t){c.NodeVisitor.call(this),this._wirePromise=a.a.getWireframeOptimized(),this._wireNodes=t.getOrCreateScene().getWireframeNodes(),this.nodeMaskOverride=-1,this._visitedNodes={},this._drawBoneNames={},this._rigIndexed=[],this._boneGeomIndexed=[],this._skls=e;var i=t.getFeatures().material.getModel(),r=c.WebGLCaps.instance();this._maxVA=r.getWebGLParameter("MAX_VERTEX_ATTRIBS");var n=0;n+=1,n+=1,n+=1,n+=3,n+=3,n+=4,n+=4,n+=4,n+=4,n+=1,n+=1,n+=1,n+=1,n+=1,n+=1,n+=1,n+=1,n+=1,n+=1,n+=1*i.getMaxUvCount(),n=Math.ceil(n);var s=r.getWebGLParameter("MAX_VERTEX_UNIFORM_VECTORS");s=Math.min(s,Object(o.a)().maxVertexUniforms),this._maxBones=Math.floor((s-n)/3),d.SkinningAttribute.maxBoneUniformAllowed=3*this._maxBones,this._minUniformsRequired=n+39};c.createPrototypeObject(y,c.objectInherit(c.NodeVisitor.prototype,{createSplitRigGeometry:function(e){var t=new d.RigGeometry;t.setName("Split ("+e.getInstanceID()+")"),t.setStateSet(e.getStateSet()),t.setUserData(e.getUserData()),t.userDataMap=e.userDataMap,t.setSourceGeometry(e.getSourceGeometry()),t._forceEnterIntersection=!0,t.setNodeMask(e.getNodeMask());var i=e.getVertexAttributeList(),r=t.getVertexAttributeList();for(var a in i)r[a]=i[a];var n=i.Bones.getElements(),o=new n.constructor(n.length);r.Bones=new c.BufferArray(c.BufferArray.ARRAY_BUFFER,o,i.Bones.getItemSize(),!0),t.userDataMap.wireframe&&this._wireNodes.push(t);var s=t.userDataMap.rigIndex;return void 0!==s&&(this._rigIndexed[s]=t),t._boundingSphereComputed=!0,t._boundingBoxComputed=!0,t},checkVertex:function(e,t){var i=t.baseBones,r=t.baseWeights,a=t.mappedUsedBones,n=0;return r[e]&&!a[i[e]]&&n++,r[e+1]&&!a[i[e+1]]&&n++,r[e+2]&&!a[i[e+2]]&&n++,r[e+3]&&!a[i[e+3]]&&n++,n},tagBoneVertex:function(e,t){var i=t.baseBones,r=t.baseWeights,a=t.mappedUsedBones,n=t.boneNameID,o=t.boneToName,s=i[e];r[e]&&!a[s]&&(n[o[s]]=t.nbUsedBones,a[s]=++t.nbUsedBones),t.newBones[e]=a[s]-1,s=i[e+1],r[e+1]&&!a[s]&&(n[o[s]]=t.nbUsedBones,a[s]=++t.nbUsedBones),t.newBones[e+1]=a[s]-1,s=i[e+2],r[e+2]&&!a[s]&&(n[o[s]]=t.nbUsedBones,a[s]=++t.nbUsedBones),t.newBones[e+2]=a[s]-1,s=i[e+3],r[e+3]&&!a[s]&&(n[o[s]]=t.nbUsedBones,a[s]=++t.nbUsedBones),t.newBones[e+3]=a[s]-1},splitTriangle:function(e,t,i,r){if(r.currentIdPrimitive++,e===t||e===i||t===i||r.processedPrimitive[r.currentIdPrimitive-1])return!0;var a=r.nbUsedBones,n=this.checkVertex(4*e,r);if(a+n<this._maxBones&&(n+=this.checkVertex(4*t,r)),a+n<this._maxBones&&(n+=this.checkVertex(4*i,r)),a+n>=this._maxBones)return void(r.finished=!1);this.tagBoneVertex(4*e,r),this.tagBoneVertex(4*t,r),this.tagBoneVertex(4*i,r);var o=r.first+r.countIdPrimitive;r.countIdPrimitive+=3,r.newIndexesElements[o]=e,r.newIndexesElements[o+1]=t,r.newIndexesElements[o+2]=i,r.processedPrimitive[r.currentIdPrimitive-1]=1},splitLine:function(e,t,i){if(i.currentIdPrimitive++,e===t||i.processedPrimitive[i.currentIdPrimitive-1])return!0;var r=i.nbUsedBones,a=this.checkVertex(4*e,i);if(r+a<this._maxBones&&(a+=this.checkVertex(4*t,i)),r+a>=this._maxBones)return void(i.finished=!1);this.tagBoneVertex(4*e,i),this.tagBoneVertex(4*t,i);var n=i.first+i.countIdPrimitive;i.countIdPrimitive+=2,i.newIndexesElements[n]=e,i.newIndexesElements[n+1]=t,i.processedPrimitive[i.currentIdPrimitive-1]=1},callbackDrawElementsTriangles:function(e,t,i){for(var r=0;r<e;r+=3)this.splitTriangle(t[r],t[r+1],t[r+2],i)},callbackDrawElementsTriangleStrip:function(e,t,i){for(var r=2,a=0;r<e;++r,++a)r%2?this.splitTriangle(t[a],t[a+2],t[a+1],i):this.splitTriangle(t[a],t[a+1],t[a+2],i)},callbackDrawElementsLines:function(e,t,i){for(var r=0;r<e;r+=2)this.splitLine(t[r],t[r+1],i)},splitPrimitive:function(e,t){e.finished=!0;var i=e.baseRig,r=e.primitive,a=this.createSplitRigGeometry(i);e.boneNameID=a._boneNameID,e.newBones=a.getVertexAttributeList().Bones.getElements(),e.mappedUsedBones=new Uint32Array(t),e.nbUsedBones=0,e.currentIdPrimitive=0,e.countIdPrimitive=0;var n=r.getIndices().getElements(),o=r.getCount(),s=r.getMode();if(s===c.primitiveSet.TRIANGLE_STRIP?this.callbackDrawElementsTriangleStrip(o,n,e):s===c.primitiveSet.TRIANGLES?this.callbackDrawElementsTriangles(o,n,e):this.callbackDrawElementsLines(o,n,e),0===e.countIdPrimitive){var u="Only "+this._maxBones+" bones supported per draw call (min is 13)";return u+="\nMinium uniforms count should be "+this._minUniformsRequired,console.warn(u),!1}var l=new c.DrawElements(s===c.primitiveSet.LINES?c.primitiveSet.LINES:c.primitiveSet.TRIANGLES,e.newIndexesBuffer);l.setFirst(e.first*e.newIndexesElements.BYTES_PER_ELEMENT),l.setCount(e.countIdPrimitive),e.first+=e.countIdPrimitive,a.getPrimitives().push(l);for(var h=i.getParents(),d=h.length,p=0;p<d;++p)h[p].addChild(a);return!e.finished},getBoneToNames:function(e,t){for(var i=t.length,r=new Array(i),a=0;a<i;++a){var n=t[a];r[e[n]]=n}return r},splitRigGeometry:function(e){for(var t=e._boneNameID,i=Object.keys(t),r=i.length,a=e.getPrimitives(),n=a.length,o={baseRig:e,baseWeights:e.getVertexAttributeList().Weights.getElements(),baseBones:e.getVertexAttributeList().Bones.getElements(),boneToName:this.getBoneToNames(e._boneNameID,i)},s=0;s<n;++s){var u=a[s],l=u.getMode();if(0!==u.getCount())if(u instanceof c.DrawElements!=!1)if(l===c.primitiveSet.TRIANGLE_STRIP||l===c.primitiveSet.TRIANGLES||l===c.primitiveSet.LINES){var h=u.getIndices(),d=h.getElements(),p=l===c.primitiveSet.TRIANGLE_STRIP?3:1;for(o.newIndexesElements=new d.constructor(u.getCount()*p),o.newIndexesBuffer=new c.BufferArray(c.BufferArray.ELEMENT_ARRAY_BUFFER,o.newIndexesElements,h.getItemSize(),!0),o.first=u.getFirst(),o.processedPrimitive=new Uint8Array(u.getCount()),o.primitive=u;this.splitPrimitive(o,r););o.newIndexesBuffer.setElements(o.newIndexesElements.subarray(0,o.first))}else c.error("Split rigged primitives mode not yet handled : ",l);else c.error("Split rigged primitives type not yet handled",u)}},handleRigGeometry:function(e){var t=e._boneNameID,i=Object(o.a)().showBones,r=e.userDataMap.wireframe,a=e.userDataMap.rigIndex;if(void 0!==a&&(this._rigIndexed[a]=e),1===i||2===i)if(r)e.setCullCallback(g);else{2!==i&&e.setNodeMask(0);var n=this._drawBoneNames;for(var s in t)n[s]=!0}else this._maxBones<Object.keys(t).length&&(r?(e._boundingBoxComputed=!0,e._boundingSphereComputed=!0,this._wirePromise.then(this.splitRigGeometry.bind(this,e))):this.splitRigGeometry(e),e.setCullCallback(g));this.tagForceIntersection()},tagForceIntersection:function(){for(var e=this._skls[this._skls.length-1],t=1+this.nodePath.indexOf(e);t<this.nodePath.length;++t)this.nodePath[t]._forceEnterIntersection=!0},popTargetAttribute:function(e,t,i){for(var r=t.getMorphTargets(),a=r.length,n=e.getVertexAttributeList(),o=t.getVertexAttributeList(),s=0;s<a;++s){delete r[s].getVertexAttributeList()[i];var u=i+"_"+s;delete n[u],n!==o&&delete o[u]}},computeUsedVA:function(e,t,i,r){var a=Object.keys(e).length-Object.keys(t).length*(i.length-Math.min(r,i.length));return e.Color||a++,a},handleMorphGeometry:function(e,t){var i=t.getMaximumPossibleMorphGPU(),r=t.getMorphTargets(),a=r[0].getVertexAttributeList(),n=e.getVertexAttributeList(),o=this.computeUsedVA(n,a,r,i),s=this._maxVA;if(!(o<=s||n.Tangent_1&&(this.popTargetAttribute(e,t,"Tangent"),(o=this.computeUsedVA(n,a,r,i))<=s)||n.Normal_1&&(this.popTargetAttribute(e,t,"Normal"),(o=this.computeUsedVA(n,a,r,i))<=s))){for(;i>0;)if(i--,t.setMaximumPossibleMorphGPU(i),(o=this.computeUsedVA(n,a,r,i))<=s)return;console.warn("Too much vertex attributes!")}},apply:function(e){var t=e.getInstanceID();if(!this._visitedNodes[t]){this._visitedNodes[t]=!0;var i=e instanceof d.RigGeometry,r=i?e.getSourceGeometry():e,a=r instanceof d.MorphGeometry;if(!a&&!i||e.userDataMap.wireframe||e.setNodeMask(p),a&&this.handleMorphGeometry(e,r),i)this.handleRigGeometry(e);else if(e instanceof d.Bone){var n=e.getBoneBoundingBox();if(n.valid()){var o=_(n);e.addChild(o);var s=e.userDataMap.rigIndex;void 0!==s&&this._boneGeomIndexed.push(o)}}else e instanceof d.Skeleton&&this._skls.push(e);this.traverse(e)}}}),"osgSketchfab","InitVisitor");var x={};x.DrawBones=b,x.hideCullCallback=g,x.init=function(e,t){var i=new y(e,t),r=t.getRootModel();c.time("InitGraphAnimation"),r.accept(i),c.timeEnd("InitGraphAnimation");for(var a=i._boneGeomIndexed,n=i._rigIndexed,o=a.length,s=0;s<o;++s){var u=a[s];u._mostInfluencedRig=n[u.getParents()[0].userDataMap.rigIndex]}Object.keys(i._drawBoneNames).length>0&&r.accept(new b(i._drawBoneNames))},t.a=x},function(e,t,i){"use strict";var r=i(5),a=i(401),n=r.a.osg,o=function(){a.a.apply(this,arguments),this._metaMapColor={kd:"DiffuseColor",ka:"EmitColor",ks:"SpecularColor"},this._metaMapFactor={ns:"SpecularHardness",tr:"Opacity",d:"Opacity"},this._metaMapTexture={map_ka:"EmitColor",map_kd:"DiffuseColor",map_occlusion:"DiffuseIntensity",map_d:"Opacity",map_ks:"SpecularColor",map_ns:"SpecularHardness",map_normal:"NormalMap",bump:"BumpMap"}};n.createPrototypeObject(o,n.objectInherit(a.a.prototype,{checkOpacityFactor:function(e){var t=e.getChannels().Opacity;t.getFactor()<.001&&t.setFactor(1)},setMaterialChannelColor:function(e,t,i,r){var a=t.getChannels()[i];a.setColor(r),a.setEnable(!0),"SpecularColor"===i&&a.setFactor(1)},setMaterialChannelFactor:function(e,t,i,r){var a=t.getChannels()[i];if(a.setFactor(r),a.setEnable(!0),"SpecularHardness"===i){var n=void 0!==e.ks?JSON.parse(e.ks):[0,0,0];this.setGlossinessPBRFromSpecularGlossiness(t,n,r)}},processMaterial:function(e,t,i){var r=this.createMaterial(e,t);this.setChannelsFromMetaDataColor(i,r),this.setChannelsFromMetaDataFactor(i,r),this.setChannelsFromMetaDataTexture(i,t,r),this.checkOpacityFactor(r),t.removeAttribute("Material"),r.setStateSet(t)}})),t.a=o},function(e,t,i){"use strict";var r=i(5),a=i(858),n=i(57),o=i(63),s=r.a.osg,u=s.Uniform.createFloat4("uColor"),l=new a.a(u.getInternalArray(),1),c=function(){s.StateSet.call(this),this.init()};c.updateCallback=l,s.createPrototypeObject(c,s.objectInherit(s.StateSet.prototype,{setRenderBinVR:function(e){var t=e?n.a.TRANSPARENT_NO_EARLYZ_POST:n.a.WIREFRAME;this.setRenderBinDetails(t,"RenderBin")},init:function(){this.setRenderBinDetails(n.a.WIREFRAME,"RenderBin"),this.setAttributeAndModes(o.a.DEPTH_LEQUAL_WRITE),this.setAttributeAndModes(o.a.BLEND_SUBSTRACTIVE),this.setShaderGeneratorName("wireframe"),this.addUniform(u),this.addUpdateCallback(l)},setWireframeColorSmooth:function(e){l.setColorTarget(e)},setWireframeColor:function(e){u.setFloat4(e)},setWireframeEnable:function(e,t){if(!e)return void l.hide();!0===l._finished&&(u.setFloat3(t),u.getInternalArray()[3]=0),l.show(t[3])}})),t.a=c},function(e,t,i){"use strict";var r=i(5),a=i(704),n=i(37),o=r.a.osg,s=function(e,t){this._color=e,this._colorDelta=o.vec4.create(),this._lastRatio=0,a.a.call(this,t),this._finished=!0,this._disableAfterFinished=!1,this._finishCallback=void 0,this._lastFrame=0};o.createPrototypeObject(s,o.objectInherit(a.a.prototype,{hide:function(){o.vec3.init(this._colorDelta),this._colorDelta[3]=-this._color[3],this._disableAfterFinished=!0,this._lastRatio=0,this.reset()},show:function(e){o.vec3.init(this._colorDelta),this._colorDelta[3]=void 0!==e?e:1-this._color[3],this._disableAfterFinished=!1,this._lastRatio=0,this.reset()},setColorTarget:function(e){o.vec4.sub(this._colorDelta,e,this._color),this._disableAfterFinished=!1,this._lastRatio=0,this.reset()},setFinishCallback:function(e){this._finishCallback=e},finished:function(){!0===this._disableAfterFinished&&this._finishCallback&&this._finishCallback()},update:function(e,t){if(!0===this._finished)return!0;n.a.draw();var i=t.getFrameStamp(),r=i.getFrameNumber();if(this._lastFrame===r)return!0;this._lastFrame=r;var a=i.getSimulationTime(),s=this.interpolate(a,e,t);s=o.smoothStep(0,1,s);var u=s-this._lastRatio;return this._lastRatio=s,o.vec4.scaleAndAdd(this._color,this._color,this._colorDelta,u),!0}})),t.a=s},function(e,t,i){"use strict";var r=i(5),a=i(457),n=i(1208),o=i(557),s=i(57),u=i(251),l=i(34),c=i(113),h=i(556),d=i(63),p=i(16),f=r.a.osg,m=f.Texture.textureNull,g=d.a.CULL_BACK,_=d.a.CULL_DISABLE,v=new f.PointSizeAttribute,b=new f.PointSizeAttribute;b.setCircleShape(!0);var y=function(e){this._stateSet=void 0,this._materialModel=e,this._material=new a.a,this._material.setMaterialModel(this._materialModel),this._material.setStateSetContext(this);var t=new f.Texture;t.setImage(new Uint8Array(12),f.Texture.RGB),t.setTextureSize(4,1),t.setMinFilter(f.Texture.NEAREST),t.setMagFilter(f.Texture.NEAREST),this._colorAtlas=new n.a(t),this._colorAtlas.setIsColorAtlas(!0),this._packedMaterialTextureCache={},this._maxTextureUnits=Object(o.a)()};y.cachedSquarePoint=v,y.cachedCirclePoint=b,y.prototype={dirtyMaterial:function(){this._material&&this._material.dirtyMaterial()},getStateSet:function(){return this._stateSet},getChannelPacking:function(e){var t=this._packedMaterialTextureCache[e];return t.getChannelPacking&&t.getChannelPacking(e)},setStateSet:function(e){this._stateSet=e,e.getAttribute("SketchfabMaterial")||(this._material.setName(e.getName()),e.setAttributeAndModes(this._material));for(var t=0,i=e.getNumTextureAttributeLists();t<i;t++)e.removeTextureAttribute(t,"Texture")},setStateSetAlphaBlending:function(){this._stateSet&&(this._stateSet.setRenderBinDetails(s.a.TRANSPARENT,"DepthSortedBin"),u.a.registerStateSetIsTransparent(this._stateSet,!0),u.a.registerStateSetIsRefraction(this._stateSet,!1))},setStateSetOpaque:function(){this._stateSet&&(this._stateSet.setRenderBinDetails(s.a.OPAQUE,"RenderBin"),u.a.registerStateSetIsTransparent(this._stateSet,!1),u.a.registerStateSetIsRefraction(this._stateSet,!1))},setStateSetRefraction:function(){this._stateSet&&(this._stateSet.setRenderBinDetails(s.a.REFRACTION,"RenderBin"),u.a.registerStateSetIsTransparent(this._stateSet,!1),u.a.registerStateSetIsRefraction(this._stateSet,!0))},setCullface:function(e){this._stateSet&&(this._stateSet.setAttributeAndModes(e?g:_),this._material.dirtyMaterial())},setPointCircle:function(e){this._stateSet&&(this._stateSet.setAttributeAndModes(e?b:v),this._material.dirtyMaterial())},isFreeSlot:function(e,t){return void 0===e||e===m||(!(!e.getChannelCount||0!==e.getChannelCount())||!(!t||e!==this._colorAtlas))},isProtectedUnit:function(e){return!(!u.a.get("protectDepthAndColorUnit")||4!==e&&5!==e)||(6===e||8===e||Object(p.a)().shadowAtlas&&7===e)},_getFirstFreeUnit:function(e){for(;this.isProtectedUnit(e);)e++;return Math.min(e,this._maxTextureUnits-1)},getAvailableTextureUnit:function(e,t){for(var i=t===this._colorAtlas,r=t===m,a=this._stateSet,n=a.getNumTextureAttributeLists(),o=this._getFirstFreeUnit(n),s=-1,u=0;u<=o;++u)if(!this.isProtectedUnit(u)){var l=a.getTextureAttribute(u,"Texture");if(-1===s&&this.isFreeSlot(l,i)&&(s=u,i||r))break;if(!r&&!i&&l&&l.packChannelIfPossible&&l.packChannelIfPossible(e,t)){s=u;break}}return s},setPackedMaterialTextureToStateSet:function(e,t){var i=e.getName(),r=this._packedMaterialTextureCache[i];r&&r instanceof n.a&&(r.removeChannel(i),h.a.removePackedTexture(r));var a=this.getAvailableTextureUnit(i,t);if(a<0)return this._packedMaterialTextureCache[i]=m,void this._material.setChannelMapping(i,-1);var o=this._stateSet.getTextureAttribute(a,"Texture");t===this._colorAtlas?o=this._colorAtlas:o&&o!==this._colorAtlas||(o=new n.a),o.setName("Texture"+a),this._material.setChannelMapping(i,t===m?-1:a),this._packedMaterialTextureCache[i]=o,o&&o.addChannel&&t!==m&&o.addChannel(i,t);var s=o instanceof n.a,u=s&&o.isProtectedTexture(),l=u?f.StateAttribute.PROTECTED:f.StateAttribute.ON;this._stateSet.setTextureAttributeAndModes(a,o,l),s&&h.a.addPackedTexture(o)},setTexture:function(e){var t=e.getTextureModel(),i=t.getImageModel(),r=t.getMultiresTexture();if(i&&r){this.setPackedMaterialTextureToStateSet(e,r),r.isTextureNull()&&r.setTextureSize(1,1);var a=l.a.getLowResLoaded();if(a.isFulfilled())return r.setImageMaxSupported();r.setImageSmallest().promise.then(function(){a.then(r.setImageMaxSupported.bind(r))})}},setColor:function(e){var t=c.a.getColorPacking(e.getName());if(t<0)return void this.setPackedMaterialTextureToStateSet(e,m);var i=e.getColor();t*=3;var r=this._colorAtlas.getTexture(),a=r.getImage().getImage();a[t]=Math.round(255*i[0]),a[t+1]=Math.round(255*i[1]),a[t+2]=Math.round(255*i[2]),r.dirty(),this.setPackedMaterialTextureToStateSet(e,this._colorAtlas)},setChannelEnable:function(e,t){return!1===t?this.setPackedMaterialTextureToStateSet(e,m):e.getTextureModel()?this.setTexture(e):void this.setColor(e)},setChannelOpacity:function(e,t){var i=e.getTransparency(),r="additive"===i,a="alphaBlend"===i,n="alphaMask"===i,o="dithering"===i,s="refraction"===i;return this._material&&this._material.updateOpacity(),!1===t||n||o?this.setStateSetOpaque():a||r?this.setStateSetAlphaBlending():s?this.setStateSetRefraction():void f.warn("Unknow alpha type : "+i)},updateChannel:function(e){if(this._stateSet){var t=e.isEffective();this.setChannelEnable(e,t);var i=e.getName();"Opacity"===i&&this.setChannelOpacity(e,t),"SubsurfaceScattering"===i&&(u.a.registerStateSetIsScattering(this._stateSet,t),this._materialModel.getChannels().Opacity.trigger("updateChannel")),this._material.dirtyMaterial()}}},t.a=y},function(e,t,i){"use strict";var r=i(5),a=i(59),n=i(107),o=i(609),s=i(861),u=i.n(s),l=i(862),c=i.n(l),h=i(63),d=r.a.osg,p={},f=function(e,t){if(p[e])return p[e];var i=e.toLowerCase();return p[e]=n.a.createShader(u.a,c.a,i,t,e),p[e]},m=function(){return f("LINE","LightingLineGizmo")},g=function(){return f("HEMI","LightingHemiGizmo")},_=function(){return f("ICON","LightingIcon")},v=h.a.BLEND_SUBSTRACTIVE,b={},y=function(e){if(b[e])return b[e];var t=o.a.iconsLight[e];t||(t=o.a.iconsLight.DIRECTION);var i=a.default.instance,r=i.getOrCreateTexture(t,{internalFormat:d.Texture.RGBA});return b[e]=r.texture,r.texture},x={};x.createIconGeometry=function(){var e=d.createTexturedQuadGeometry(-.5,-.5,0,1,0,0,0,1,0),t=e.getOrCreateStateSet();return t.setTextureAttributeAndModes(1,y("DIRECTION")),t.addUniform(d.Uniform.createInt(1,"uTextureIcon")),t.setAttributeAndModes(v),t.setAttributeAndModes(_()),e.setLightType=function(e){t.setTextureAttributeAndModes(1,y(e))},e},x.createDirectionalGeometry=function(e){for(var t=void 0===e?-1:-e,i=t/15,r=2*Math.PI,a=new Float32Array(180),n=0;n<5;++n){var o=6*n,s=r*n/5;a[o]=a[o+3]=Math.cos(s)*i,a[o+1]=a[o+4]=Math.sin(s)*i,a[o+5]=t}var u=new d.DrawArrays(d.primitiveSet.LINES,0,30),l=new d.Geometry;return l.getAttributes().Vertex=new d.BufferArray(d.BufferArray.ARRAY_BUFFER,a,3),l.getPrimitives().push(u),l.getOrCreateStateSet().setAttributeAndModes(m()),l.getOrCreateStateSet().setAttributeAndModes(v),l},x.createSpotGeometry=function(e){var t=void 0===e?-1:-e,i=2*Math.PI,r=new d.Geometry,a=new Float32Array(300),n=r.getAttributes().Vertex=new d.BufferArray(d.BufferArray.ARRAY_BUFFER,a,3),o=0,s=new Uint16Array(50);for(o=0;o<50;++o)s[o]=2*o+1;var u=new d.DrawElements(d.primitiveSet.LINE_LOOP,new d.BufferArray(d.BufferArray.ELEMENT_ARRAY_BUFFER,s,1)),l=new Uint16Array(10);for(o=0;o<5;++o)l[2*o]=20*o,l[2*o+1]=20*o+1;var c=new d.DrawElements(d.primitiveSet.LINES,new d.BufferArray(d.BufferArray.ELEMENT_ARRAY_BUFFER,l,1));return r.getPrimitives().push(c,u),r.getOrCreateStateSet().setAttributeAndModes(m()),r.getOrCreateStateSet().setAttributeAndModes(v),r.updateCone=function(e,s){var u=s?2*-s:t,l=Math.cos(e)*u,c=Math.sin(e)*u;for(o=0;o<50;++o){var h=6*o,d=i*o/50;a[h+3]=Math.cos(d)*c,a[h+4]=Math.sin(d)*c,a[h+5]=l}n.dirty(),r.dirtyBound()},r.updateCone(.1),r},x.createHemiGeometry=function(e){for(var t=void 0===e?-1:-e,i=new d.Geometry,r=new Float32Array(450),a=Math.PI,n=0;n<50;++n){var o=3*n,s=a*n/49,u=Math.cos(s),l=Math.sin(s);r[o]=u*t,r[o+2]=-l*t,r[150+o+1]=u*t,r[150+o+2]=-l*t,s=2*a*n/49,r[300+o]=Math.cos(s)*t,r[300+o+1]=Math.sin(s)*t}i.getAttributes().Vertex=new d.BufferArray(d.BufferArray.ARRAY_BUFFER,r,3);var c=new d.DrawArrays(d.primitiveSet.LINE_STRIP,0,50),h=new d.DrawArrays(d.primitiveSet.LINE_STRIP,50,50),p=new d.DrawArrays(d.primitiveSet.LINE_STRIP,100,50);i.getPrimitives().push(c,h,p);var f=i.getOrCreateStateSet();return f.setAttributeAndModes(g()),f.setAttributeAndModes(v),f.addUniform(d.Uniform.createFloat(-t,"uRadius")),i},x.createPointGeometry=function(){var e=2*Math.PI,t=new d.Geometry,i=new Float32Array(1350),r=t.getAttributes().Vertex=new d.BufferArray(d.BufferArray.ARRAY_BUFFER,i,3),a=new d.DrawArrays(d.primitiveSet.LINE_STRIP,0,50),n=new d.DrawArrays(d.primitiveSet.LINE_STRIP,50,50),o=new d.DrawArrays(d.primitiveSet.LINE_STRIP,100,50);return t.getPrimitives().push(a,n,o),t.getOrCreateStateSet().setAttributeAndModes(m()),t.getOrCreateStateSet().setAttributeAndModes(v),t.updateRadius=function(a){for(var n=0;n<50;++n){var o=3*n,s=e*n/49;i[o]=i[150+o]=i[300+o+1]=Math.cos(s)*a,i[o+1]=i[150+o+2]=i[300+o+2]=Math.sin(s)*a}r.dirty(),t.dirtyBound()},t.updateRadius(1),t},t.a=x},function(e,t){e.exports="#ifdef ICON\nattribute vec2 TexCoord0;\nvarying vec2 vTexCoord0;\n#endif\n\n#ifdef HEMI\nvarying vec3 vLocalVertex;\n#endif\n\nattribute vec3 Vertex;\n\nvarying vec4 vViewPos;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n#ifdef ICON\n  vTexCoord0 = TexCoord0;\n#endif\n\n#ifdef HEMI\n  vLocalVertex = Vertex;\n#endif\n\n  vViewPos = uModelViewMatrix * vec4(Vertex.xyz, 1.0);\n  gl_Position = uProjectionMatrix * vViewPos;\n}\n"},function(e,t){e.exports='#pragma include "sketchfabFunctions.glsl"\n\n#ifdef HEMI\nuniform vec4 uGround;\nvarying vec3 vLocalVertex;\nuniform float uRadius;\n#endif\n\n#ifdef ICON\nuniform sampler2D uTextureIcon;\nvarying vec2 vTexCoord0;\nuniform int uEnable;\n#endif\n\nvarying vec4 vViewPos;\nuniform vec2 uNearFar;\nuniform sampler2D uTextureDepth;\nuniform vec2 uGlobalTexSize;\nuniform vec2 uGlobalTexRatio;\n\nuniform vec4 uColor;\n\nvoid main(void) {\n  float distDepth = distanceToDepth(uTextureDepth, uGlobalTexRatio * gl_FragCoord.xy / uGlobalTexSize, vViewPos, uNearFar);\n  float alpha = distDepth < 0.0 ? 1.0 : 0.1;\n\n  // handles colors with values higher than 1\n  vec3 normColor = uColor.rgb / max(max(1.0, uColor.r), max(uColor.g, uColor.b));\n\n#ifdef HEMI\n  gl_FragColor = vec4(mix(uGround.rgb, normColor, vLocalVertex.z / uRadius), alpha);\n#endif\n\n#ifdef LINE\n  gl_FragColor = vec4(normColor, alpha);\n#endif\n\n#ifdef ICON\n  gl_FragColor = vec4(float(uEnable) * normColor, alpha) * texture2D(uTextureIcon, vTexCoord0);\n#endif\n\n  gl_FragColor.rgb *= gl_FragColor.a;\n\n  gl_FragColor.rgb = sRGBToLinear(gl_FragColor.rgb);\n}\n'},function(e,t,i){"use strict";var r=i(5),a=r.a.osg,n={ambient:a.Uniform.createInt1(0,"uAmbient"),texture0:a.Uniform.createInt1(0,"uTexture0"),backgroundExposure:a.Uniform.createFloat(1,"uBackgroundExposure"),size:a.Uniform.createFloat(1,"uSize"),color:a.Uniform.createFloat3(a.vec3.fromValues(0,0,1),"uBackgroundColor"),scale:a.Uniform.createFloat2(a.vec2.fromValues(1,1),"uFixedScale")};t.a=n},function(e,t,i){"use strict";var r=i(5),a=r.a.osg,n={environmentTransform:a.Uniform.createMatrix4(a.mat4.create(),"uEnvironmentTransform"),exposure:a.Uniform.createFloat1(1,"uEnvironmentExposure"),diffuseSPH:a.Uniform.createFloat3Array(new Float32Array(27),"uDiffuseSPH"),textureSpecular:a.Uniform.createInt1("sEnvironmentSpecular"),textureSpecularPBR:a.Uniform.createInt1("sSpecularPBR"),textureIntegrateBRDF:a.Uniform.createInt1("sIntegrateBRDF"),factorShadowEnv0:a.Uniform.createFloat(0,"uFactorShadowEnv0")};t.a=n},function(e,t,i){"use strict";var r=i(5),a=i(43),n=i(57),o=i(1245),s=i(3),u=i.n(s),l=i(866),c=(i.n(l),r.a.osg),h=r.a.osgUtil,d=c.createTexturedQuadGeometry(-.5,-.5,0,1,0,0,0,1,0),p=h.GizmoGeometry.createCylinderGeometry(.0025,.0025,1,8,1,!1,!1),f=new c.MatrixTransform;f.getMatrix()[14]=.5,f.addChild(p),p._boundingBoxComputed=!0,p._boundingSphereComputed=!0;var m=function(e,t){c.Node.call(this),this._idHotspot=e,this._viewer=t,this._hotspotMT=new c.MatrixTransform,this._cardPanel=new o.a,this._lineToCardMT=new c.MatrixTransform,this._hotspotMT.addChild(d),this.addChild(this._hotspotMT),this.addChild(this._lineToCardMT),this.addChild(this._cardPanel),this._cardPanel.setVisible(!1),this._lineToCardMT.setNodeMask(0),this._worldTeleportPos=void 0,this._cardInitialized=!1,this._texCard=new c.Texture,this._texCard.setTextureSize(1,1),this._canTeleport=!1,this._uAlpha=void 0,this._color=void 0,this._lineToCardMT.addChild(f),this._hotspotMT._boundingBoxComputed=!0,this._hotspotMT._boundingSphereComputed=!0,this.init()};m.COLOR_NORMAL=c.vec3.fromValues(1,1,1),m.COLOR_HOVERED=c.vec3.fromValues(0,.8,1),m.COLOR_DRAG_OK=c.vec3.fromValues(0,.4,1),m.COLOR_DRAG_FAIL=c.vec3.fromValues(.8,.2,.2),m.initLineShader=function(e){var t=p.getOrCreateStateSet();t.setAttributeAndModes(e),t.addUniform(c.Uniform.createFloat4(c.vec4.fromValues(.03,.59,.78,.4),"uLineColor")),t.setRenderBinDetails(n.a.TOOLTIP,"RenderBin")},c.createPrototypeNode(m,c.objectInherit(c.Node.prototype,{init:function(){var e=this.getOrCreateStateSet();e.addUniform(c.Uniform.createFloat(this._idHotspot,"uHotspotIndex"));var t=c.Uniform.createFloat3(c.vec3.fromValues(1,1,1),"uColor");this._color=t.getInternalArray(),e.addUniform(t)},getIndex:function(){return this._idHotspot},getHotspotMatrix:function(){return this._hotspotMT.getMatrix()},getColor:function(){return this._color},isFullyVisibleCard:function(){return this._cardPanel.isVisible()},isVisibleCard:function(){return this._cardPanel.isHinted()||this._cardPanel.isVisible()},canTeleport:function(){return this._canTeleport&&!this.isFullyVisibleCard()},setWorldTeleportPosition:function(){var e=c.vec3.create(),t=c.vec3.create(),i=c.vec3.create();return function(r,a,n){if(!this.isFullyVisibleCard()){var o=this._cardPanel.getMatrix();this._worldTeleportPos=c.vec3.copy(this._worldTeleportPos||c.vec3.create(),a),c.vec3.copy(i,a),i[2]+=1.5*n,c.vec3.sub(t,r,i),t[2]=0,c.vec3.normalize(t,t),c.vec3.scale(t,t,1*n),c.vec3.add(t,i,t),this.lookToWorld(o,t,i,n),c.vec3.sub(e,a,r);var s=c.vec3.length(e);c.vec3.sub(e,a,t);var u=c.vec3.length(e),l=s<u?-1:1;t[2]+=.5*l*.5625*n;var h=this._lineToCardMT.getMatrix();this.lookToWorld(h,r,t,1);var d=c.vec3.dist(t,r);c.vec3.set(e,n,n,d),c.mat4.scale(h,h,e),this._cardPanel.dirtyBound()}}}(),setCardVisibilityListener:function(e){this._cardVisibilityListener=e},setVisibleCard:function(e){this._isCardInitialized||this.initCard(),this._cardPanel.setVisible(e),this._lineToCardMT.setNodeMask(e?a.a.NO_PICK:0),this._cardVisibilityListener&&this._cardVisibilityListener(this,e)},setHovered:function(e){this._isCardInitialized||this.initCard(),c.vec3.copy(this.getColor(),e?m.COLOR_HOVERED:m.COLOR_NORMAL),this.isFullyVisibleCard()||(this._cardPanel.setHinted(e),this._lineToCardMT.setNodeMask(e?a.a.NO_PICK:0))},initCard:function(){var e=u()(".hotspots"),t=u()(e.get(0).childNodes[this._idHotspot]),i=this._viewer.getFeatures().hotspot._views[0]._hotspots;this._setDescriptionStyle(t,{width:"1024px",lineHeight:"2",fontSize:"38px"});var r=t.find(".description").outerHeight()+4*t.find(".title").outerHeight(),a=Math.max(1,Math.round(r/576)+(r%576>0?1:0));this._setDescriptionStyle(t,null),this._cardPanel.initialize("skfb_front/macros/hotspot",{hotspotIndex:this._idHotspot,displayNavigation:i.length&&i.length>1,column:a,widthContent:1024*a,title:t.find(".title")[0].innerText,description:t.find(".description").html()}),this._isCardInitialized=!0},_setDescriptionStyle:function(e,t){e.find(".description").css({width:null!==t?t.width:"",lineHeight:null!==t?t.lineHeight:"",fontSize:null!==t?t.fontSize:""})},updateCardHit:function(e){this._hoveredCard=this._cardPanel.updateHit(e)},onCardHit:function(e){this._isCallbackSetup||(this._setupCallback(e),this._isCallbackSetup=!0),this._hoveredCard?this._cardPanel.click():this._cardPanel.setVisible(!1)},_setupCallback:function(e){this._cardPanel.setClickAction("closeButton",function(){this.setVisibleCard(!1)}.bind(this)),this._cardPanel.setClickAction("nextButton",function(){e.goToNextHotspot()}),this._cardPanel.setClickAction("prevButton",function(){e.goToPrevHotspot()})},lookToWorld:function(){var e=c.vec3.create(),t=c.vec3.fromValues(0,0,-1),i=c.mat4.fromXRotation(c.mat4.create(),Math.PI);return function(r,a,n,o){c.mat4.lookAt(r,a,n,t),c.mat4.multiply(r,i,r),c.mat4.invert(r,r),c.mat4.scale(r,r,c.vec3.set(e,o,o,o))}}(),updatePositionVR:function(e,t,i,r){var a=this._hotspotMT.getMatrix(),n=e.get("lastComputedWorldPosition");i=Math.max(1.5*i,.1*r),i=Math.min(4*i,i),this.lookToWorld(a,n,t,i);var o=1/0;this._worldTeleportPos&&(o=c.vec2.dist(this._worldTeleportPos,t));var s=o<.5*r;this._canTeleport=!s,this._hotspotMT.dirtyBound()},updatePosition:function(){var e=c.vec3.create();return function(t,i,r,a){var n=this._hotspotMT.getMatrix(),o=t.get("lastComputedWorldPosition");c.mat4.copy(n,a),c.vec3.set(e,r,r,r),c.mat4.scale(n,n,e),c.mat4.setTranslation(n,o),this.isVisibleCard()&&this.setVisibleCard(!1),this._hotspotMT.dirtyBound()}}()}),"osgSketchfab","Hotspot"),t.a=m},function(e,t){!function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/hotspot.jinja"]=function(){function e(e,t,i,r,a){var n=null,o=null;try{var s=null,u=r.makeMacro([],["options"],function(a){var s=i;i=new r.Frame,a=a||{},a.hasOwnProperty("caller")&&i.set("caller",a.caller),i.set("options",a.hasOwnProperty("options")?a.options:{});var u="";u+="\n";var l;l=30,i.set("width_before",l,!0),i.topLevel&&t.setVariable("width_before",l),i.topLevel&&t.addExport("width_before",l),u+="\n";var c;c=960,i.set("width_next",c,!0),i.topLevel&&t.setVariable("width_next",c),i.topLevel&&t.addExport("width_next",c),u+='\n        <div class="vr-hotspot-content" style="width:',u+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"widthContent"),e.opts.autoescape),u+='px;" id="hotspot',u+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"hotspotIndex"),e.opts.autoescape),u+='">\n            <div class="cell" id="default" style="width:1024px;height:576px;position:absolute;top:0;left:0"></div>',i=i.push();var h=(n=5,o=32,r.callWrap(r.contextOrFrameLookup(t,i,"range"),"range",t,[0,r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"column")]));if(h)for(var d=h.length,p=0;p<h.length;p++){var f=h[p];i.set("column",f),i.set("loop.index",p+1),i.set("loop.index0",p),i.set("loop.revindex",d-p),i.set("loop.revindex0",d-p-1),i.set("loop.first",0===p),i.set("loop.last",p===d-1),i.set("loop.length",d),u+='<div class="page" id="column',u+=r.suppressValue(f,e.opts.autoescape),u+='" style="width:1024px;height:576px;position:absolute;top:0;left:',u+=r.suppressValue(1024*f,e.opts.autoescape),u+='px; overflow: visible">',f>0&&(u+='<div style="width:40px;height:40px;position:absolute;top:250px;left:30px" class="vr-icon vr-icon-arrow-left-white"></div>\n                        <button id="prevPage" style="opacity:0; height: 100%; width:10%; top:0; position: absolute; left: 0;"></button>');var m;if(m=r.contextOrFrameLookup(t,i,"width_before")+1024,i.set("width_before",m,!0),i.topLevel&&t.setVariable("width_before",m),i.topLevel&&t.addExport("width_before",m),u+='\n                    <div class="vr-hotspot-title">',u+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"title"),e.opts.autoescape),u+="</div>",f<1&&(u+='<div class="vr-hotspot-description" style="column-count:',u+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"column"),e.opts.autoescape),u+=";width:",u+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"widthContent"),e.opts.autoescape),u+='px">',u+=r.suppressValue(e.getFilter("safe").call(t,r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"description")),e.opts.autoescape),u+="</div>"),f+1<r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"column")){u+='<button id="nextPage" style="opacity:0; height: 100%; width:10%; top:0; position: absolute; right: 0;"></button>\n                        <div style="width:40px;height:40px;position:absolute;top:250px;left:960px" class="vr-icon vr-icon-arrow-right-white"></div>\n                        ';var g;g=r.contextOrFrameLookup(t,i,"width_next")+1024,i.set("width_next",g,!0),i.topLevel&&t.setVariable("width_next",g),i.topLevel&&t.addExport("width_next",g)}u+='<div class="vr-hotspot-footer">\n                        <div class="vr-hotspot-container-button" >',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"displayNavigation")?u+='<button id="prevButton" class="vr-hotspot-button">Prev</button>\n                                <button id="closeButton" class="vr-hotspot-button">Close annotation</button>\n                                <button id="nextButton" class="vr-hotspot-button">Next</button>':u+='<button id="closeButton" class="vr-hotspot-button">Close annotation</button>',u+="</div>\n                    </div>\n                </div>"}return i=i.pop(),u+="</div>\n",i=s,new r.SafeString(u)});t.addExport("panel"),t.setVariable("panel",u),s?s.rootRenderFunc(e,t,i,r,a):a(null,"")}catch(e){a(r.handleError(e,n,o))}}return{root:e}}()}()},function(e,t){e.exports="attribute vec3 Vertex;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying float vHeight;\n\nvoid main(void) {\n  vHeight = Vertex.z;\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xyz, 1.0));\n}\n"},function(e,t){e.exports='uniform vec3 uColor;\nuniform float uAlpha;\nuniform int uOutputLinear;\n\nvarying float vHeight;\n\n#pragma include "functions.glsl"\n\nvoid main(void) {\n  vec4 color = vec4(uColor, 1.0) * uAlpha * smoothstep(1.0, 0.0, pow(vHeight, 0.3));\n\n  gl_FragColor = uOutputLinear == 0 ? linearTosRGB(color) : color;\n}\n'},function(e,t){e.exports="attribute vec3 Vertex;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec3 vLocalVertex;\n\nvoid main(void) {\n  vLocalVertex = Vertex;\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xyz, 1.0));\n}\n"},function(e,t){e.exports='varying vec3 vLocalVertex;\n\nuniform int uOutputLinear;\nuniform float uAlpha;\n\n#pragma include "functions.glsl"\n\nvoid main(void) {\n  vec4 color = linearTosRGB(vec4(0.1, 0.66, 0.85, 1.0)) * (smoothstep(1.0, 0.0, vLocalVertex.y) * smoothstep(1.0, 0.0, abs(vLocalVertex.x * 4.0))) * uAlpha;\n\n  gl_FragColor = color;\n}\n'},function(e,t){!function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/vr/vr-menu.jinja"]=function(){function e(e,t,i,r,a){var n="";try{var o=null,s=r.makeMacro([],["options"],function(e){var a=i;i=new r.Frame,e=e||{},e.hasOwnProperty("caller")&&i.set("caller",e.caller),i.set("options",e.hasOwnProperty("options")?e.options:{});var n="";return n+='\n\n<div style="width:700px;">',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"hasHotspotsNavigation")&&(n+='<div class="vr-menu-row">\n            <button  id="vrPrevButton" class="vr-button vr-button-small">\n                <div style="width:100px;height:100px;margin:auto" class="vr-icon vr-icon-arrow-left-white"></div>                \n            </button>\n            <span class="vr-localize-icon">\n                <div style="width:100px;height:100px;margin:auto" class="vr-icon vr-icon-map-marker-white"></div>                                \n            </span>\n            <button id="vrNextButton" class="vr-button vr-button-small">\n                <div style="width:100px;height:100px;margin:auto" class="vr-icon vr-icon-arrow-right-white"></div>                                \n            </button>\n        </div>'),n+='<button id="vrHomeButton" class="vr-button">Home</button>\n    <button id="vrHelpButton" class="vr-button">Help</button>\n    <button id="vrExitButton" class="vr-button vr-round-button">\n        <div style="width:100px;height:100px;margin:auto" class="vr-icon vr-icon-times-white"></div>            \n    </button>\n</div>\n',i=a,new r.SafeString(n)});t.addExport("panel"),t.setVariable("panel",s),n+="\n",o?o.rootRenderFunc(e,t,i,r,a):a(null,n)}catch(e){a(r.handleError(e,null,null))}}return{root:e}}()}()},function(e,t,i){"use strict";var r=i(5),a=r.a.osg,n=a.mat4.fromRotation(a.mat4.create(),.5*Math.PI,a.vec3.fromValues(1,0,0)),o=a.mat4.fromRotation(a.mat4.create(),.5*-Math.PI,a.vec3.fromValues(1,0,0)),s=function(){window.updateARKit=this._onARKitEvent.bind(this),this._cameraListeners=[],this._planeListeners=[]};s.prototype={update:function(){if(!this._lastARKitData)return!0;for(var e=0;e<this._cameraListeners.length;e++)this._cameraListeners[e].onCameraChange(this._lastARKitData.camera,this._lastARKitData.projection);if(this._lastARKitData.planes.length)for(var t=0;t<this._planeListeners.length;t++)this._planeListeners[t].onPlanesChange(this._lastARKitData.planes);return!0},_onARKitEvent:function(e){this._lastARKitData=e},getCameraMatrix:function(e,t){a.mat4.multiply(e,t,o)},getMatrixTransformFromARPlane:function(){var e=a.vec3.create(),t=a.mat4.create();return function(i,r){a.vec3.set(e,r.center[0],r.center[1],r.center[2]),a.mat4.fromTranslation(i,e),a.mat4.multiply(i,r.transform,i);var o=a.vec3.set(e,r.extent[0],1,r.extent[2]);a.mat4.multiply(i,i,a.mat4.fromScaling(t,o)),a.mat4.multiply(i,n,i)}}(),addCameraListener:function(e){this._cameraListeners.push(e)},addPlaneListener:function(e){this._planeListeners.push(e)}};var u=new s;t.a=u},function(e,t,i){"use strict";var r=i(5),a=i(57),n=r.a.osg,o=r.a.osgUtil,s=function(){o.DisplayNormalVisitor.call(this),this._tangentStateSet.setRenderBinDetails(a.a.DEBUG,"RenderBin"),this._normalStateSet.setRenderBinDetails(a.a.DEBUG,"RenderBin")};n.createPrototypeObject(s,n.objectInherit(o.DisplayNormalVisitor.prototype,{apply:function(e,t){e instanceof n.Geometry&&e.getCullCallback()||o.DisplayNormalVisitor.prototype.apply.call(this,e,t)}})),t.a=s},function(e,t,i){"use strict";var r=i(15),a=i.n(r),n=i(3),o=i.n(n),s=i(0),u=(i.n(s),i(137));t.a=u.a.extend({el:['<div class="widget slider-widget">','          <div class="widget-wrapper">','              <div class="bar">','                  <div class="slide">','                      <div class="cursor"></div>',"                  </div>","              </div>","          </div>","      </div>"].join(""),events:Object(s.extend)({},u.a.prototype.events,{"mousedown .bar":"trackDrag","mousedown .cursor":"cursorDrag","touchstart .bar":"trackDrag","touchstart .cursor":"cursorDrag"}),constructor:function(e,t){t=Object(s.defaults)(t||{},{model:new a.a.Model,name:"value",minimum:0,maximum:100,step:1,orientation:"horizontal"}),u.a.prototype.constructor.call(this,e,t),void 0===this.get()&&this.set(0)},initialize:function(){this.$slide=this.$(".slide"),"vertical"===this.options.orientation&&this.$el.addClass("--vertical"),this.started=!1,this.render()},delegateEvents:function(){u.a.prototype.delegateEvents.apply(this,arguments),o()(window).on("mousemove.delegateEvents"+this.cid,this.moveEvent.bind(this)),o()(window).on("mouseup.delegateEvents"+this.cid,this.stopEvent.bind(this)),o()(window).on("touchmove.delegateEvents"+this.cid,this.moveEvent.bind(this)),o()(window).on("touchend.delegateEvents"+this.cid,this.stopEvent.bind(this))},undelegateEvents:function(){u.a.prototype.undelegateEvents.apply(this,arguments),o()(window).off(".delegateEvents"+this.cid)},render:function(){var e=this.options.maximum-this.options.minimum,t=(this.get()-this.options.minimum)/e*100,i={};"vertical"===this.options.orientation?i.height=t+"%":i.width=t+"%",this.$slide.css(i)},startEvent:function(e){e.preventDefault(),this.$el.addClass("fast"),this.started=!0},stopEvent:function(e){this.started&&(e.preventDefault(),this.$el.removeClass("fast"),this.started=!1)},moveEvent:function(e){this.started&&(e.preventDefault(),this.selectEvent(e))},selectEvent:function(e){e.preventDefault();var t,i;if("horizontal"===this.options.orientation){var r=this.$el.offset().left,a=this.$el.width();i=e.pageX,void 0===i&&(i=e.originalEvent.touches[0].pageX),t=(i-r)/a}else if("vertical"===this.options.orientation){var n=this.$el.offset().top,o=this.$el.height();i=e.pageY,i||(i=e.originalEvent.touches[0].pageY),t=(n+o-i)/o}t=Math.min(Math.max(0,t),1),t=this.options.minimum+t*(this.options.maximum-this.options.minimum),this.change(t)},cursorDrag:function(e){this.startEvent(e),e.stopPropagation()},trackDrag:function(e){this.startEvent(e),this.moveEvent(e)}})},function(e,t,i){"use strict";i.d(t,"b",function(){return M});var r=i(3),a=i.n(r),n=i(0),o=(i.n(n),i(4)),s=i(42),u=i.n(s),l=i(230),c=i(11),h=i(479),d=i(55),p=i(16),f=i(166),m=i(1359),g=i(22),_=i(6),v=i(710),b=i(74),y=i(17),x=y.a.shortcuts;Object(p.a)().uiInspector?(x.inspectorControl.shortcuts[0].keyCombinations="1",x.inspectorControl.shortcuts[1].keyCombinations="2",x.inspectorControl.shortcuts[2].keyCombinations="3",x.inspectorControl.shortcuts[3].keyCombinations="4",x.viewerRendering.shortcuts[0].keyCombinations="",x.viewerRendering.shortcuts[1].keyCombinations="",x.viewerRendering.shortcuts[2].keyCombinations="",x.viewerRendering.shortcuts[3].keyCombinations="5"):(x.inspectorControl.shortcuts[0].keyCombinations="",x.inspectorControl.shortcuts[1].keyCombinations="",x.inspectorControl.shortcuts[2].keyCombinations="",x.inspectorControl.shortcuts[3].keyCombinations="");var S=new h.a(x.viewerRendering),M=function(e){var t=[{title:"Off",className:"colors-none",dataSetting:"wireframeEnable",dataValue:"0"},{title:"Black",className:"colors-black",dataSetting:"wireframeColor",dataValue:"000000FF"},{title:"White",className:"colors-white",dataSetting:"wireframeColor",dataValue:"ffffffFF"},{title:"Red",className:"colors-red",dataSetting:"wireframeColor",dataValue:"ff0000FF"},{title:"Blue",className:"colors-blue",dataSetting:"wireframeColor",dataValue:"0000FFFF"},{title:"Green",className:"colors-green",dataSetting:"wireframeColor",dataValue:"00FF00FF"},{title:"Yellow",className:"colors-yellow",dataSetting:"wireframeColor",dataValue:"FFFF00FF"}],i=o.default.getFromString('<a           class="{{ className }} {{ "active" if isActive else "" }}"           data-setting="{{ dataSetting }}"           data-value="{{ dataValue }}"           title="{{ title }}">        </a>');return o.default.getFromString('<p class="wireframe-title">        Wireframe         <span class="shortcut" title="Keyboard shortcut">           {{ shortcut | safe }}        </span>        </p>        <div class="wireframe-colors">           {{ colorItems | safe }}        </div>')({shortcut:S.getShortDescriptionById("toggleWireframe"),colorItems:t.map(function(t){return i(Object(n.extend)({},t,{isActive:e.wireframeColor===t.dataValue}))}).join("")})},w=function(e){var t=o.default.getFromString('    <div class="setting-list-header">               <a class="back control-menu-back">Back</a>               <span class="setting-list-header-help">Key</span>           </div>            <ul class="setting-list" data-setting="{{ name }}">                {{ listItems | safe }}            </ul>            {{ wireframe | safe }}'),i=e.viewerSettings.hasWireframe,r=e.viewerSettings.wireframeColor;return t(Object(n.extend)({},e,{wireframe:i?M({wireframeColor:r}):""}))},T={};Object(p.a)().uiInspector||(T.shadingStyle={label:"Rendering",settings:[{label:"Lit",value:"lit",shortcut:S.getShortDescriptionById("defaultRenderingMode")},{label:"Shadeless",value:"shadeless",shortcut:S.getShortDescriptionById("shadelessRenderingMode")},{label:"MatCap",value:"matcap",shortcut:S.getShortDescriptionById("matcapRenderingMode")}],paneTemplate:w,order:2}),t.a=f.a.extend({events:{"click .help":"onHelpClick","click .vr":"onVrClick","click .fullscreen":"onFullscreenClick","click .theatre":"onTheatreClick","touchend .control.tooltip":"replaceDOMElement"},constructor:function(){this.fullScreenChange=this.fullScreenChange.bind(this),this.onVrClick=this.onVrClick.bind(this),this.onFullscreenClick=this.onFullscreenClick.bind(this),this.onTheatreClick=this.onTheatreClick.bind(this),f.a.prototype.constructor.apply(this,arguments)},initialize:function(){f.a.prototype.initialize.apply(this,arguments),this.enableVR=!1,this.wasClicked=this.$el.parents(".model-container").hasClass("theatre"),!v.a.hasFullscreen()&&Object(l.default)()&&window.self===window.top&&(this.viewer.$el.addClass("no-fullscreen"),this.viewer.$el.find(".controls .settings").addClass("shift-menu-left")),this.initializeTheatreMode(),this.viewer.on("model-loaded",this.updateNavigationSettings.bind(this))},delegateEvents:function(){f.a.prototype.delegateEvents.apply(this,arguments),this.onFullScreenChange(this.fullScreenChange),this.viewer.proxySettings.on("change",this.renderSettings,this),this.viewer.on("model-loaded",this.setModelListeners.bind(this))},undelegateEvents:function(){if(f.a.prototype.undelegateEvents.apply(this,arguments),!this.$el)return this;this.offFullScreenChange(this.fullScreenChange),this.viewer.proxySettings.off("change",this.renderSettings,this),this.viewer.on("model-loaded",this.removeModelListeners.bind(this))},setModelListeners:function(){this.viewer.scene.getFeatures().animation.getModel().get("animations").on("add remove reset",this.renderSettings,this);var e=this.viewer.scene.getFeatures().camera.getModel();this.listenTo(e,"change:useCameraConstraints",this.updateNavigationSettings.bind(this))},removeModelListeners:function(){this.viewer.scene.getFeatures().animation.getModel().get("animations").off("add remove reset",this.renderSettings,this);var e=this.viewer.scene.getFeatures().camera.getModel();this.stopListening(e,"change:useCameraConstraints",this.updateNavigationSettings.bind(this))},setHasAnimations:function(e){this.hasAnimations=e},getSettingLabelForValue:function(e,t){return Object(n.find)(T[e].settings,function(e){return e.value===t}).label},getEmbedUrl:function(e){var t=g.b.craft(Object(n.extend)({},Object(b.a)(location.search),e||{}));return this.viewer._currentModel.get("embedUrl")+"?"+t},onHelpClick:function(e){e.preventDefault(),e.stopPropagation(),c.a.modelViewerHelpButtonCliked(),this.viewer.subviews.helpOverlay.show()},generateTextureQualitySettings:function(e){T.textureQuality={label:"Textures",group:"textureQuality",settings:[{label:"LD",value:"0"},{label:"SD",value:"1"},{label:"HD",value:"2"}],order:5};var t=["low","mid","high"],i=0;t.forEach(function(t,r){if(!e[t]){T.textureQuality.settings.splice(r-i,1),i++}}.bind(this)),Object(n.last)(T.textureQuality.settings).label="HD",this.renderSettings()},updateNavigationSettings:function(){this.viewer.scene.getFeatures().camera.getModel().get("useCameraConstraints")?delete T.viewerMode:T.viewerMode||(T.viewerMode={label:"Navigation",settings:[{label:"Orbit",value:"0"},{label:"First Person",value:"1"}],order:4}),this.renderSettings()},renderSettings:function(){if(Object(n.isEmpty)(T))return void this.$(".control.settings").hide();this.$(".control.settings").show(),this.settings||(this.settings=new m.a({el:this.$(".settings-menu"),viewer:this.viewer,settings:T})),this.settings.render()},onVrClick:function(e){e.stopPropagation(),this.widgets.hotspots&&(this.widgets.hotspots.hideTooltips(),this.widgets.hotspots.currentHotspot=-1,this.widgets.hotspots.renderControl());var t=this.viewer.scene.getFeatures().webVR.getModel();void 0!==navigator.getVRDisplays?(t.set("enable",!t.get("enable")),c.a.modelViewerVrButtonClicked("nativeVR")):u.a.any?(this.fullscreenVR(e),c.a.modelViewerVrButtonClicked("mobile")):(this.openVrInstructions(),c.a.modelViewerVrButtonClicked("desktop"))},openVrWindow:function(){this.viewer._currentModel&&window.open(this.getEmbedUrl({cardboard:1,autostart:1}),"skfbCardboard","menubar=no,toolbar=no")},openVrInstructions:function(){this.viewer._currentModel.sharing().then(function(){var e=this.viewer._currentModel.get("sharing").shortUrl;this.viewer.subviews.helperVrOverlay.setUrl(e),this.viewer.subviews.helperVrOverlay.show()}.bind(this))},initializeTheatreMode:function(){this._theatreActive="false"!==d.a.get("theatre_mode","false")},isTheatreActive:function(){return this._theatreActive},onTheatreClick:function(e){e.stopPropagation(),e.preventDefault();var t=this.isTheatreActive(),i=_.a.me().get("isAnonymous"),r=i&&!this.wasClicked;return this.wasClicked=!0,this.viewer.trigger(t&&!r?"leaveTheatreMode":"enterTheatreMode"),d.a.set("theatre_mode",!t),this._theatreActive=!t,!1},onFullscreenClick:function(e,t){if(e.stopPropagation(),v.a.hasFullscreen()){var i=v.a.isFullscreen();c.a.modelViewerFullscreenButtonClicked(!i),i?v.a.exitFullscreen():v.a.requestFullscreen(this.viewer.el)}else t?this.openVrWindow():this.openFakeFullscreen()},openFakeFullscreen:function(){this.viewer._currentModel&&(u.a.any?window.open(this.getEmbedUrl()):window.open(this.getEmbedUrl(),"skfbFullscreenFallback","menubar=no,toolbar=no"))},onFullScreenChange:function(e){v.a.onFullScreenChange(e)},offFullScreenChange:function(e){v.a.offFullScreenChange(e)},fullScreenChange:function(){a()('[data-action="fullscreen"] > .icon').toggleClass("icon-fullscreen-icon").toggleClass("icon-fullscreen-off-icon"),this.viewer.$el.toggleClass("fullscreen",v.a.isFullscreen()),this.viewer.scene.trigger("resizeViewerOnNextFrame",-1,-1);var e=this.viewer.scene.getFeatures().webVR;if(e){var t=e.getModel();v.a.isFullscreen()?!0===this.enableVR&&t.set("enable",!0):!0===this.enableVR&&(t.set("enable",!1),this.enableVR=!1)}},fullscreenVR:function(e){return this.enableVR=!0,this.onFullscreenClick(e,!0)},replaceDOMElement:Object(n.debounce)(function(e){var t=e.target.parentElement,i=e.target.nextSibling;t&&(t.removeChild(e.target),Object(n.defer)(function(){t.insertBefore(e.target,i)}))},2e3)})},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(5)),n=a.a.osg,o=function(e){this._model=void 0!==e?e.model:void 0,this._viewer=void 0!==e?e.viewer:void 0,this._scene=void 0!==e?e.scene:void 0,this._widgetAPI=void 0!==e?e.widgetAPI:void 0,this._features={}};o.prototype={getModel:function(){return this._model},getFeatures:function(){return this._features},getViewer:function(){return this._viewer},getScene:function(){return this._scene},getWidgetAPI:function(){return this._widgetAPI},addFeature:function(e){if(e){var t=e.getName();this._features[t]?n.error("Feature already added"+t):this._features[t]=e}return this._features},getModelByName:function(e){if(e){var t=Object(r.find)(this._features,function(t){var i=t.getModel();return!(!i||!i.getName)&&i.getName()===e});return t?t.getModel():void 0}},getViewsByName:function(e){if(e){var t=[];return Object(r.forEach)(this._features,function(i){if(i){var r=i._views.filter(function(t){return!!t.getName&&t.getName()===e});Array.prototype.push.apply(t,r)}}),t}}},t.a=o},function(e,t,i){"use strict";var r=i(554),a=i(7),n=i.n(a),o=i(0),s=(i.n(o),i(419)),u=i.n(s),l=i(5),c=i(17),h=i(8),d=i(47),p=i(618),f=i(211),m=i(878),g=i(558),_=i(1370),v=i(59),b=i(876),y=i(1371),x=i(1373),S=i(557),M=i(16),w=i(37),T=i(1376),C=i(70),E=i(707),L=i(34),P=i(79),A=i(83),D=i(1386),O=i(556),k=i(841),R=i(702),I=i(136),F=i(145),N=l.a.osg,V=l.a.osgViewer,B=new u.a({device:"VWR"}),U=function(e){if(e.byteLength)return Array.prototype.slice.call(e)},j=function(e){return Object(o.cloneDeepWith)(e,U)},G=function(e){this._dataScene=e,this._modelFile=this.selectModelFile(),this._rootModel=new N.Node,this._rootModel.setName("Scene - Root"),this._polygonNode=new N.Node,this._polygonNode.setName("Scene - PolygonNode"),this._wireframeNodes=[],this._resourcePromises=[],this._cleanLegacyAbsoluteUrl()};G.prototype={addResourcePromise:function(e){this._resourcePromises.push(e)},getJSON:function(){return this._dataScene},getPolygonURL:function(){return this._modelFile.osgjsUrl},getWireframeURL:function(){return this._modelFile.wireframeUrl},getOsgjsSize:function(){return this._modelFile.osgjsSize},getPolygonSize:function(){return this._modelFile.modelSize},getWireframeSize:function(){return this._modelFile.wireframeSize},getResourceManager:function(){return this._resourceManager||v.default.instance},getRootModel:function(){return this._rootModel},getWireframeNodes:function(){return this._wireframeNodes},createOptionDownload:function(e,t,i){return{node:i,progress:t,binarySize:"polygon"===e?this.getPolygonSize():this.getWireframeSize(),binaryKey:e,osgjsSize:this.getOsgjsSize(),osgjsKey:"osgjs",secondary:!1}},loadPolygon:function(e,t,i,r){var a=this.createOptionDownload("polygon",e,this._polygonNode);if(t){var n=r?e:void 0;a.wireframeOptions=this.createOptionDownload("wireframe",n),a.wireframeOptions.startPromise=i,a.wireframeOptions.deferDownload=new A.a,a.wireframeOptions.nodes=this.getWireframeNodes(),r&&this._resourcePromises.push(a.wireframeOptions.deferDownload);var o=N.Timer.instance().tick();a.wireframeOptions.deferDownload.then(function(){L.a.resolveWireframe({time:N.Timer.instance().tick()-o})})}var s=this.getResourceManager().getOrCreateModel(this.getPolygonURL(),a);return this.getRootModel().addChild(this._polygonNode),this.getResourceManager().run(),s.promise},loadWireframeLegacy:function(e){var t=this.createOptionDownload("wireframe",e,new N.Node),i=this.getResourceManager().getOrCreateModel(this.getWireframeURL(),t);return this.getWireframeNodes().push(t.node),this.getRootModel().addChild(t.node),i.promise},selectModelFile:function(){var e=Object(d.a)()||Object(C.a)()?0:1;void 0!==Object(M.a)().modelOptimization&&(e=Object(M.a)().modelOptimization?1:0);for(var t=this._dataScene.files,i=0;i<t.length;++i)if(t[i].flag===e)return t[i];return t[0]},_cleanLegacyAbsoluteUrl:function(){var e=this._dataScene.options&&this._dataScene.options.materials;if(e){var t=this.getPolygonURL(),i=t.substr(0,t.lastIndexOf("/")+1);for(var r in e){var a=e[r].channels;for(var n in a){var o=a[n],s=o.texture;s&&(s.image&&(s.image=i.concat(s.image)),s.url&&(s.url=i.concat(s.url)))}}}}};var Y=h.a.extend({initialize:function(){if(h.a.prototype.initialize.apply(this,arguments),I.a.client.setTagsContext({frontend:"3d"}),this._root=null,this._features=this.options.features,this._widgetAPI=this.options.widgetAPI,this._viewerAPI=this.options.viewerAPI,this._progressManager=new D.a(this.trigger.bind(this)),this._widgetAPI&&this._widgetAPI.getTabbedWidget().model.on("change",w.a.draw),!this.options.model)throw new Error("no model provided to ViewerWebGL");v.default.instance.setModelUid(this.model.get("uid")),this._featuresInstancied={};var e=this.$(".canvas"),t=e[0];t.oncontextmenu=function(){return!1},this._initOptions(),N.Geometry.enableVAO=Object(M.a)().useVao;var i=this._viewer=new V.Viewer(t,{powerPreference:Object(M.a)().powerPreference,antialias:!1,depth:!1,stencil:!1,alpha:this._requireAlphaContext(),premultipliedAlpha:!0,fullscreen:!1,overrideDevicePixelRatio:Object(M.a)().pratio,preserveDrawingBuffer:Object(M.a)().preserveDrawingBuffer,enableFrustumCulling:!1,maxDevicePixelRatio:1.5,InputSources:{Mouse:{scrollwheel:Object(M.a)().scrollwheel},Keyboard:{sourceElement:e[0]},WebVR:{pollInterval:-1},GamePad:{enable:!1}}});F.a.init(i.getInputManager()),i.getState().getExcludeUniforms().uDrawOpaque=!0,i.getState().getExcludeUniforms().uQVT=!0,i.getState().getExcludeUniforms().uQVS=!0,i.getState().getExcludeUniforms().uQW=!0,i.getViewerStats()&&i.getViewerStats().addConfig(this._createOptionStats());var r=N.TimerGPU.instance();Object(M.a)().webglTimerGpu&&(r.setFrameAverageCount(20),r.enable()),E.a.setTimerGPU(r);var a=Object(p.a)();this._contextLostCount=a?0:Object(M.a)().webglRestore,this._restoreContextBinded=this.restoreContext.bind(this),i.setContextRestoreCallback(this.requestRestoreContext.bind(this)),i.setContextLostCallback(function(){return N.warn("Context Lost"),Object(k.a)(!1),this._contextLostCount++,!0}.bind(this)),T.a.register(i.getState().getShaderGeneratorProxy());for(var n=Object(S.a)(),o=i.getState(),s=0;s<n;s++)o.setGlobalDefaultTextureAttribute(s,N.Texture.textureNull);i.requestContinuousUpdate(Object(M.a)().continuousRender),e[0].setAttribute("tabindex","0"),i.init();var u=this.getCamera();u.getRenderer().setCullVisitor(new g.a),i.setupManipulator(),this._rootScene=new N.MatrixTransform,this._rootScene.setName("Root scene"),u.setClearColor(N.vec4.fromValues(.25,.3,.3,1)),i.setSceneData(this._rootScene),w.a.setViewer(i),this._superSample=new _.a(this),w.a.setSuperSample(this._superSample),this._superSample.setRoot(this._rootScene),i.getManipulator().computeHomePosition(),Object(M.a)().forceMs?i._requestAnimationFrame=function(e){window.setTimeout(e,Object(M.a)().forceMs)}:i._requestAnimationFrame=f.a.get(),i.run(),this._currentScene=void 0,I.a.client.setTagsContext({frontend:"web"})},_initOptions:function(){var e=this.options.model;void 0===e.get("options").version&&(e.get("options").version=c.a.optionsVersion),N.time("processModelJSON"),Object(y.a)(e),N.timeEnd("processModelJSON"),Object(M.a)().processOptions&&e.set("options",{version:c.a.optionsVersion,sound:{},orientation:{},wireframe:{},scene:{},hotspot:{},materials:{},environment:{},vr:{},camera:{},lighting:{},background:{},shading:{},animation:{}})},updateProgress:function(e,t,i){this._progressManager.updateProgress(e,t,i)},setFakeSecondaryProgress:function(e,t){this._progressManager.setFakeProgress(e,!0,t)},setFakePrimaryProgress:function(e,t){this._progressManager.setFakeProgress(e,!1,t)},setFakeProgress:function(e,t,i){this._progressManager.setFakeProgress(e,t,i)},requestRestoreContext:function(){if(this._contextLostCount<3)return void this.restoreContext();new(0,i(26).default)({title:"3D/WebGL context error",text:"Your browser seems to have hit its 3D capability limit. The page needs to be reloaded to fix this. <br/>If the problems persists, you can try to close other tabs with 3D/WebGL or restart your browser entirely.",safe:!0,buttons:{continue:!0,continueLabel:"Reload Current Page",cancel:!1}}).open().then(function(){window.location.reload()}.bind(this))},restoreContext:function(){if(Object(R.b)())return void document.addEventListener(R.a,this._restoreContextBinded);if(this._featuresManager){var e=this._featuresManager._features;if(e){if(e.postProcess){var t=e.postProcess.getModel();t.set("enable",!1),t.set("enable",!0)}e.quality&&e.material&&(e.quality.getModel().trigger("updateTexelPolicy"),O.a.resetCaches(),O.a.packAllMaterialsTextures(e.material.getModel().getMaterials())),w.a.draw(),document.removeEventListener(R.a,this._restoreContextBinded)}}},getModelUID:function(){return this.model.get("uid")},_requireAlphaContext:function(){if(Object(d.a)()||Object(M.a)().transparent||Object(M.a)().arkit)return!0;var e=this.options.model.get("options");return"none"===(e&&e.background&&e.background.enable)},_getLower:function(e,t){for(var i=[],r=0,a=e.length;r<a;++r)i.push(e[r]),t[i[r]]={caption:e[r],average:!0};return i},_createOptionStats:function(){var e=["EarlyOpaque","EarlyTransparency","ShadingOpaque","ShadingTransparency","ShadingRefraction","Extra"],t=["ShadowMap0","ShadowMap1","ShadowMap2","ShadowMap3"],i=["Total GL","Shading","PostProcess","ShadowMap"],r={};return{values:r,groups:[{name:i[0],caption:"GL Total (ms)",values:this._getLower(i,r)},{name:i[1],caption:"GL Shading (ms)",values:this._getLower(e,r)},{name:i[2],caption:"GL PostProcess (ms)",values:[]},{name:i[3],caption:"GL ShadowMap (ms)",values:this._getLower(t,r)}]}},setOptionStatsPostProcess:function(e){var t={},i=[{name:"PostProcess",caption:"GL PostProcess (ms)",values:this._getLower(e,t)}],r=this._viewer.getViewerStats();r.addConfig({values:t,groups:i}),r.update()},getRootUserData:function(){return this._currentScene?this.getRootModel().userDataMap||{}:{}},getRootScene:function(){return this._rootScene},getRootModel:function(){return this._currentScene.getRootModel()},getWidth:function(){return this._viewer.getCanvasWidth()},getHeight:function(){return this._viewer.getCanvasHeight()},getOptions:function(){return this.options},isViewerReady:function(){return L.a.getModelDisplayed()},getViewerAPI:function(){return this._viewerAPI},createContext:function(e){return new b.a({model:e.model,viewer:this,scene:e.scene,widgetAPI:this._widgetAPI})},loadWireframeLegacy:function(e,t){var i=e.loadWireframeLegacy(t),r=N.Timer.instance().tick();return i.then(function(){L.a.resolveWireframe({time:N.Timer.instance().tick()-r})}),i},_dataSizePromisesResolve:function(e){L.a.resolveDataSizeOSGJS(e.getOsgjsSize()),L.a.resolveDataSizePolygon(e.getPolygonSize()),L.a.getHasSound().then(function(e){var t=0;if(e){this.getFeatures().sound.getModel("soundtracks").get("soundtracks").each(function(e){var i=e.get("size");i&&(t+=i)})}L.a.resolveDataSizeSound(t)}.bind(this))},hasIntegratedWireframe:function(){var e=this._currentScene;return!e._modelFile.wireframeUrl||!e._modelFile.wireframeSize},run:function(){var e=this.options.model,t=this,i=this.getOrCreateScene(e.toJSON()),r=e.get("options"),a=i.getJSON().animationCount>0||Object(d.a)()&&r.animation&&r.animation.order&&e.get("options").animation.order.length>0;L.a.resolveHasAnimation(a),this._dataSizePromisesResolve(i);var o=this.createContext({model:e,scene:i}),s=i._resourcePromises,u=Object(M.a)().preload,l=i._modelFile,c=!0===e.get("options").wireframe.enable&&!0===u&&void 0!==l.wireframeSize&&l.wireframeSize>0,h=this.hasIntegratedWireframe();L.a.resolveDataSizeWireframe(l.wireframeSize||0);var p=c?n.a.resolve():L.a.getHighResLoaded(),f=i.loadPolygon(this.updateProgress.bind(this),h,p,c);s.push(f);var m=N.Timer.instance().tick();return f.then(function(){L.a.resolvePolygon({time:N.Timer.instance().tick()-m})}),!h&&c&&s.push(this.loadWireframeLegacy(i,this.updateProgress.bind(this))),N.time("createAndInitFeatures"),t._features.forEach(function(e){t.addFeature(e,o)}),N.timeEnd("createAndInitFeatures"),this._progressManager.initPrimaryProgress(i.getOsgjsSize(),i.getPolygonSize(),c?i.getWireframeSize():0),n.a.all(s).then(this._launchViewer.bind(this,o,h,c,m)),this._featuresInstancied=o.getFeatures(),L.a.getModelDisplayed()},_launchViewer:function(e,t,i,a){N.time("featureFinished"),this.featureFinished(e,this._rootScene),N.timeEnd("featureFinished"),t||i||L.a.getHighResLoaded().then(this.loadWireframeLegacy.bind(this,this._currentScene,void 0)),this.trigger("primary-progress",{progress:1}),r.default.logBound(P.a.getModelBoxWithoutDisplacement()),r.default.showMessage(),(Object(M.a)().preload?L.a.getHighResBound():L.a.getLowResBound()).then(this._onViewerLaunched.bind(this,a))},_onViewerLaunched:function(e){if(this._featuresManager.setInitialAnimation(),this.drawFrame(),L.a.resolveModelDisplayed({time:N.Timer.instance().tick()-e}),this.trigger("success"),this.trigger("viewerready"),Object(M.a)().messaging){B.createMessage({data:"ready"}).appendToHash()}},onFail:function(e,t){N.error(t.stack),e.reject(t),this.trigger("failure")},addFeature:function(e,t){if(!e)return console.warn("Feature undefined!"),!0;var i=new e;if(i.init(t),Object(d.a)()){var r=i.getModel(),a=i.getName();r.editorSetJSON&&!window.editorModels[a]&&(window.editorModels[a]={setJSON:this._makeCallbackSetJSON(r),getJSON:this._makeCallbackGetJSON(r)})}},_makeCallbackSetJSON:function(e){return function(t){var i=e.editorSetJSON(j(t));return i&&i.then?i:i?n.a.reject(i):n.a.resolve()}},_makeCallbackGetJSON:function(e){return function(){var t=e.editorGetJSON();return n.a.resolve(j(t))}},drawFrame:function(){this._viewer.requestRedraw(),this._viewer.frame()},getCanvas:function(){return this._viewer.getGraphicContext().canvas},getInputManager:function(){return this._viewer.getInputManager()},setTimeline:function(e){this._timeline=e},getTimeline:function(){return this._timeline},getScreenShot:function(e,t,i){return Object(m.a)(e,t,this,i)},getCamera:function(){return this._viewer.getCamera()},getFeatures:function(){return this._featuresInstancied},getSuperSample:function(){return this._superSample},getFeaturesManager:function(){return this._featuresManager},getViewerOSGJS:function(){return this._viewer},getOrCreateScene:function(e){if(this._currentScene)return this._currentScene;var t=new G(e);return t.getResourceManager().setStateContextOSG(this._viewer.getState()),this._currentScene=t,t},featureFinished:function(e,t){return this._featuresManager=new x.a(this,e),this._featuresManager.finished(t)},getOptionsJSON:function(){var e=this.getFeatures(),t={};t.version=c.a.optionsVersion,t.background=e.background.getModel().getJSON(),t.environment=e.environment.getModel().getJSON(),t.lighting=e.lighting.getModel().getJSON(),t.materials=e.material.getModel().getJSON(),t.orientation=e.orientation.getModel().getJSON(),t.camera=e.camera.getModel().getJSON(),t.animation=e.animation.getModel().getJSON(),t.hotspot=e.hotspot.getModel().getJSON(),t.vr=e.webVR.getModel().getJSON(),t.scene=t.scene||{},t.scene.postProcess=e.postProcess.getModel().getJSON(),t.scene.sssProfiles=e.postProcess.getModel().getProfilesJSON(),t.sound=e.sound.getModel().getJSON();var i=e.shadingStyle.getModel().getJSON();return t.shading=i.shading,t.wireframe=i.wireframe,y.a.readOptions(t)}});t.a=Y},function(e,t,i){"use strict";var r,a,n,o=i(16),s=i(37),u=document.createElement("canvas"),l=document.createElement("canvas"),c=function(e,t,i){u.width===t&&u.height===i||(l.width=t,l.height=i,u.width=t,u.height=i,a=new Uint8Array(4*t*i));var r=e.getGraphicContext(),n=r.checkFramebufferStatus(r.FRAMEBUFFER);if(n!==r.FRAMEBUFFER_COMPLETE)return console.error("FRAMEBUFFER status invalid.",n);r.flush(),r.finish(),r.readPixels(0,0,t,i,r.RGBA,r.UNSIGNED_BYTE,a);var o=u.getContext("2d"),s=o.getImageData(0,0,t,i);s.data.set(a),o.putImageData(s,0,0);var c=l.getContext("2d");c.clearRect(0,0,t,i),c.fillStyle="transparent",c.fillRect(0,0,t,i),c.save(),c.globalCompositeOperation="copy",c.scale(1,-1),c.drawImage(u,0,0,t,i,0,-i,t,i),c.restore()},h=function(e,t,i){return c(e,t,i),Object(o.a)().downloadPicture&&(r||(r=document.createElement("a"),document.body.appendChild(r),r.style.display="none"),r.href=l.toDataURL("image/jpeg"),r.download="image.jpg",r.click()),l},d=function(e){e.getScene().updateSceneGraph(e.getUpdateVisitor());var t=e.getCamera().getRenderer();t.cull(),t.draw()},p=function(e,t,i){var r=e.getFeatures(),a=e.getSuperSample(),o=e.getViewerOSGJS(),u=e.getFeaturesManager().getNodeGizmo(),l=o.getCamera();for(var c in r)r[c].prepareForScreenShot();n=void 0,u&&u.getNodeMask()&&(n=u.getNodeMask(),u.setNodeMask(0)),e.trigger("resizeViewer",t,i),o.updateViewport(),s.a.setPoseForScreenshot(!0),o.checkNeedToDoFrame(),d(o),l.setFinalDrawCallback(function(e){a.isEnabled()||h(e,t,i)})},f=function(e){var t=e.getFeatures(),i=e.getViewerOSGJS(),r=e.getFeaturesManager().getNodeGizmo(),a=i.getCamera();s.a.setPoseForScreenshot(!1),a.setFinalDrawCallback(void 0);for(var o in t)t[o].resetAfterScreenShot();n&&r.setNodeMask(n),e.trigger("resizeViewerOnNextFrame",-1,-1)},m=function(e,t,i,r){var a=i.getSuperSample(),n=i.getViewerOSGJS();if(e&&t||(e=n.getCanvasWidth(),t=n.getCanvasHeight()),p(i,e,t),a.canBeEnabled())for(a.forceEnable();a.isEnabled();)a.updateFrame(),d(n);else d(n);return f(i),r||(n.updateViewport(),i.getFeatures().inspector.getModel().trigger("change:viewerToCanvasRatio")),l};t.a=m},function(e,t,i){"use strict";var r=i(5),a=i(37),n=r.a.osg,o=r.a.osgUtil,s=o.NodeGizmo,u=function(){s.apply(this,arguments),this._forcePicking=!1};n.createPrototypeNode(u,n.objectInherit(s.prototype,{setForcePicking:function(e){this._forcePicking=e},onMouseUp:function(e){this.isEditing()&&a.a.draw();var t=this._attachedNode;s.prototype.onMouseUp.call(this,e),t!==this._attachedNode&&a.a.draw(),this._forcePicking&&!this._attachedNode&&(this._attachedNode=t)},onMouseMove:function(e){var t=this._hoverNode;s.prototype.onMouseMove.call(this,e),this.isEditing()&&a.a.redrawShadow(),(this.isEditing()||t!==this._hoverNode)&&a.a.draw()}}),"osgSketchfab","NodeGizmo"),t.a=u},function(e,t,i){e.exports=i.p+"cardboard-instructions-3559e10f564c87ffc582505a3919b0ad.svg"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(12)),n=i(542),o=i(571),s=i(17);t.a=a.a.extend(Object(r.extend)({},n.a,{endpoint:function(){return"/environments/"+this.get("uid")}}),Object(o.a)({fileTypes:s.a.environmentFiletypes,maxFileSize:s.a.maxEnvironmentFilesize}))},function(e,t,i){"use strict";var r=i(29),a=i.n(r),n=i(3),o=i.n(n),s=i(12),u=i(605),l=i(571),c=i(17);t.a=s.a.extend({save:function(e,t){null!=e&&"object"!==(void 0===e?"undefined":a()(e))||(t=e);var i=new FormData;return i.append("imageFile",this.get("imageFile")),i.append("modelUid",t.modelUID),o.a.ajax({url:this.url(),data:i,processData:!1,contentType:!1,type:"POST"})},endpoint:function(){return"/backgrounds"+(this.isNew()?"":"/"+this.get("uid"))}},Object(l.a)({fileTypes:c.a.backgroundFiletypes,maxFileSize:c.a.maxBackgroundFilesize})).extend(u.a)},function(e,t,i){"use strict";function r(e,t){var i,a,o=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,s=/(^[ ]*|[ ]*$)/g,u=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,l=/^0x[0-9a-f]+$/i,c=/^0/,h=function(e){return r.insensitive&&(""+e).toLowerCase()||""+e},d=h(e).slice(0,50).replace(s,"")||"",p=h(t).slice(0,50).replace(s,"")||"",f=d.replace(o,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),m=p.replace(o,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),g=parseInt(d.match(l))||1!==f.length&&d.match(u)&&Date.parse(d),_=parseInt(p.match(l))||g&&p.match(u)&&Date.parse(p)||null;if(_){if(g<_)return-1;if(g>_)return 1}for(var v=0,b=Math.max(f.length,m.length);v<b;v++){if(i=!(f[v]||"").match(c)&&parseFloat(f[v])||f[v]||0,a=!(m[v]||"").match(c)&&parseFloat(m[v])||m[v]||0,isNaN(i)!==isNaN(a))return isNaN(i)?1:-1;if((void 0===i?"undefined":n()(i))!==(void 0===a?"undefined":n()(a))&&(i+="",a+=""),i<a)return-1;if(i>a)return 1}return 0}var a=i(29),n=i.n(a);t.a=r},function(e,t,i){"use strict";var r=i(29),a=i.n(r),n=i(7),o=i.n(n),s=i(3),u=i.n(s),l=i(12),c=i(605),h=i(571),d=i(17);t.a=l.a.extend({endpoint:function(){return"/matcaps"+(this.isNew()?"":"/"+this.get("uid"))},save:function(e,t){null!=e&&"object"!==(void 0===e?"undefined":a()(e))||(t=e);var i=new FormData;return i.append("imageFile",this.get("imageFile"),this.get("name")),i.append("modelUid",t.modelUID),o.a.resolve(u.a.ajax({url:this.url(),data:i,processData:!1,contentType:!1,type:"POST"}))},getProxyImage:function(){var e=this.findImageSmallest();return e||console.error("MISSING IMAGE DATA!"),{label:this.get("name"),value:this.get("uid")||this.get("id"),image:e.url,imageModel:this,deletable:!this.get("isDefault")}}},Object(h.a)({fileTypes:d.a.matcapFiletypes,maxFileSize:d.a.maxMatcapFilesize})).extend(c.a)},function(e,t,i){"use strict";t.a=["4024128cf8904b69946e891caac5f305","b83e3a8794ae47e0b4039e7fdb031602","16cdcddf277d423d99094f8db0c731e9","efd4ef0fc18a4ec0a1313d782fade965","675ff0f13b474c62947097939fe9aa1e","df5b82c5ccec42cbb9c5ba9528f0be52","491ddabd93aa49ecb5ad36538f7d00e3","02751cd893a14f3986fb17a90245f64f","78a54c2fd53a4ba4891a4bbdac7f30f7","956bb00775a044e7afdd1c17f6bdab63","003c1543cd754a19a0e14bc89726ccf5","268447ca0a954f44b06d1387863d114e","80fba9759ab94307a782f38d359b8ea8","e73867d210de4bc2b5eb261738cf3e79","2e9c3708feb74137b0436f946b8b66b8","591b2c2db5744df1803a09d477f5a2c7"]},,,,function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(44)),n=i(874),o=i(11);t.a=n.a.extend({el:['<div class="widget slider-widget volume-slider-widget">','          <div class="widget-wrapper">','              <a class="fa fa-volume-up"></a>','              <div class="bar">','                  <div class="slide">','                      <div class="cursor"></div>',"                  </div>","              </div>","          </div>","      </div>"].join(""),events:Object(r.extend)({},n.a.prototype.events,{"click .fa":"onoff","touchstart .fa":"onoff"}),constructor:function(e,t){t=Object(r.defaults)(t||{},{name:"volume",minimum:0,maximum:1,step:.1}),n.a.prototype.constructor.call(this,e,t)},initialize:function(){n.a.prototype.initialize.apply(this,arguments),this.isMute=0===this.get(),this.value=this.get(),this.model.on("change:"+this.options.name,Object(a.a)(function(){0===this.get()?(this.isMute=!0,this.mute(this.$(".fa"))):this.isMute&&(this.isMute=!1,this.unmute(this.$(".fa")))}.bind(this)))},mute:function(e){e.removeClass("fa-volume-up").addClass("fa-volume-off")},unmute:function(e){e.removeClass("fa-volume-off").addClass("fa-volume-up")},onoff:function(){this.isMute?(0!==this.value&&null!==this.value||(this.value=1),this.model.set("mute",!1),this.set(this.value),this.model.set("playing",!0),o.a.modelViewerMuteButtonClicked(0)):(this.value=this.get(),this.set(0),this.model.set("mute",!0),o.a.modelViewerMuteButtonClicked(1))},cursorDrag:function(){n.a.prototype.cursorDrag.apply(this,arguments),this.value=null}})},function(e,t,i){"use strict";var r=i(62),a=i(1352),n={FeatureName:"saveUI",ModelName:"Material",ViewListType:[a.a]};t.a=r.a.create(n)},function(e,t,i){"use strict";var r=i(29),a=i.n(r),n=i(3),o=i.n(n),s=i(12);t.a=s.a.extend({save:function(e,t){null!=e&&"object"!==(void 0===e?"undefined":a()(e))||(t=e);var i=new FormData;return i.append("imageFile",this.get("imageFile")),i.append("source",this.get("source")),i.append("modelUid",t.modelUID),o.a.ajax({url:this.url(),data:i,processData:!1,contentType:!1,type:"POST"})},endpoint:function(){return"/thumbnails"}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";var r=i(664),a=i(38),n=i(2),o=i(259);t.a=a.a.extend({optionTypes:{modelUid:n.b.string},comparator:"order",model:r.a,url:function(){return Object(o.a)("hotspots",this.options.modelUid,this.options.checkPrefetch)}})},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";var r=i(62),a=i(1006),n=i(1154),o=i(34),s={FeatureName:"animation",ModelType:a.a,ViewListType:[n.a]},u=!1;o.a.getHasAnimation().then(function(e){e&&(u=e)});var l=r.a.create(s);l.prototype.prepareForScreenShot=function(){return!!u&&(this._oldPlayingAnimation=this.getModel().get("playing"),this.getModel().set("playing",!1),!0)},l.prototype.resetAfterScreenShot=function(){this._oldPlayingAnimation&&this.getModel().set("playing",!0)},t.a=l},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(120)),n=i(47),o=i(59),s=i(16),u=i(70),l=a.a.extend({getModelOptionPath:function(){return"animation"},defaults:function(){var e=this.getResourceManager().getAnimationCollection(),t=[];return Object(n.a)()||(t=e.remove(e.where({isEnabled:!1}))),{animations:e,disabledAnimations:t,currentUID:"-1",playing:!0,fps:-1,progress:0}},getName:function(){return"Animation"},getResourceManager:function(){return this._resourceManager||o.default.instance},getAnimationByUID:function(e){return this.get("animations").find(function(t){return t.get("uid")===e})},getCurrentAnimation:function(){return this.getAnimationByUID(this.get("currentUID"))},canActivateTAA:function(){return!this.isPlaying()||Object(s.a)().taaAnimation},isPlaying:function(){return!!this.get("animations").length&&(!!this.get("playing")&&"-1"!==this.get("currentUID"))},getEnabledAnimationsCount:function(){return this.get("animations").where({isEnabled:!0}).length},getFirstEnabledAnimation:function(){for(var e=this.get("animations"),t=e.length,i=0;i<t;++i){var r=e.at(i);if(r&&r.get("isEnabled"))return r}},init:function(e){this._viewer=e.getViewer();var t=e.getModel().get("options"),i=t.animation;i&&i.order&&(this.setJSON(i),this.set("playing",Object(s.a)().animationAutoplay))},setJSON:function(e,t){var i=t||{};i.ignore=["order"],a.a.prototype.setJSON.call(this,e,i);var n=this.get("animations"),o=Object(r.invert)(e.order);n.forEach(function(e){e.set("order",parseInt(o[e.get("uid")],10))}),n.sort()},getJSON:function(){for(var e=a.a.prototype.getJSON.call(this),t=this.get("animations").pluck("uid"),i=this.get("disabledAnimations"),r=0;r<i.length;++r)t.push(i[r].get("uid"));return e.order=t,!Object(u.a)()&&this.getEnabledAnimationsCount()&&(e.initializeWithRestPose="-1"===this.get("currentUID")),e}});t.a=l},function(e,t){function i(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i}if(window.Set&&window.Map&&window.Uint8ClampedArray){if(Math.sign||(Math.sign=function(e){return e>0?1:e<0?-1:0}),Math.log2||(Math.log2=function(e){return Math.log(e)*Math.LOG2E}),Math.log10||(Math.log10=function(e){return Math.log(e)*Math.LOG10E}),String.prototype.endsWith||(String.prototype.endsWith=function(e){return this.slice(-e.length)===e}),String.prototype.startsWith||(String.prototype.startsWith=function(e){return this.slice(0,e.length)===e}),!Float32Array.prototype.slice){var r=function(e,t){return new this.constructor(this.subarray(e,t))};Int8Array.prototype.slice=r,Uint8Array.prototype.slice=r,Uint8ClampedArray.prototype.slice=r,Int16Array.prototype.slice=r,Uint16Array.prototype.slice=r,Int32Array.prototype.slice=r,Uint32Array.prototype.slice=r,Float32Array.prototype.slice=r,Float64Array.prototype.slice=r}if(!new window.Set(["test"]).has("test")){var a=window.Set;window.Set=function(e){var t=new a;if(e)for(var i=0;i<e.length;++i)t.add(e[i]);return t}}"object"==typeof window.Event&&(i.prototype=window.Event.prototype,window.Event=i)}},function(e,t){e.exports={devDependencies:{chai:"^3.5.0",eslint:"4.1.1","eslint-config-google":"^0.8.0","eslint-config-standard":"^10.2.1","eslint-plugin-import":"^2.6.0","eslint-plugin-node":"^5.1.0","eslint-plugin-prettier":"^2.6.0","eslint-plugin-private-variables":"*","eslint-plugin-promise":"^3.5.0","eslint-plugin-standard":"^3.0.1","grunt-contrib-connect":"~0.9","grunt-documentation":"*","grunt-execute":"^0.2.2","grunt-plato":"~0.2.1","grunt-release":"^0.10.0","grunt-update-submodules":"^0.4.1",jsdom:"11.0.0","jsdom-global":"3.0.2",mocha:"^2.5.3",prettier:"1.12.0"},peerDependencies:{grunt:">=0.4.0"},dependencies:{bluebird:"^3.0.5",d3:"^4.9.1",dagre:"^0.7.4","dat.gui":"dataarts/dat.gui#v0.6.4",extend:"*","gl-matrix":"2.3.2",glob:"*",grunt:"> 1.0.0","grunt-contrib-clean":"*","grunt-contrib-copy":"*","grunt-contrib-uglify":"^3.1.0","grunt-eslint":"^20.1.0","grunt-git":"*","grunt-shell":"*","grunt-webpack":"^3.0.2",hammerjs:"^2.0.8",jquery:"3.0.0","json-loader":"^0.5.4",path:"^0.11.14","raw-loader":"^0.5.1",webpack:"^3.7.1","webpack-dev-server":"^2.9.2","webpack-strip-block":"^0.2.0",zlibjs:"^0.3.1","@trigrou/zip-js":"1.0.0"},contributors:["Paul Cheyrou-Lagrze <tuan.kuranes@gmail.com>","Jordi Torres <jtorresfabra@gmail.com>","Matt Fontaine <tehqin@gmail.com>","Stephane Ginier <stephane.ginier@gmail.com>"],version:"0.2.9",author:"Cedric Pinson <trigrou@trigrou.com> (http://cedricpinson.com)",license:"MIT",description:"OpenSceneGraph implementation in javascript",repository:{url:"git@github.com:cedricpinson/osgjs.git",type:"git"},name:"OpenSceneGraph"}},function(e,t,i){t.glMatrix=i(245),t.mat2=i(1010),t.mat2d=i(1011),t.mat3=i(774),t.mat4=i(1012),t.quat=i(1013),t.vec2=i(1014),t.vec3=i(775),t.vec4=i(776)},function(e,t,i){var r=i(245),a={};a.create=function(){var e=new r.ARRAY_TYPE(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},a.clone=function(e){var t=new r.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},a.fromValues=function(e,t,i,a){var n=new r.ARRAY_TYPE(4);return n[0]=e,n[1]=t,n[2]=i,n[3]=a,n},a.set=function(e,t,i,r,a){return e[0]=t,e[1]=i,e[2]=r,e[3]=a,e},a.transpose=function(e,t){if(e===t){var i=t[1];e[1]=t[2],e[2]=i}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},a.invert=function(e,t){var i=t[0],r=t[1],a=t[2],n=t[3],o=i*n-a*r;return o?(o=1/o,e[0]=n*o,e[1]=-r*o,e[2]=-a*o,e[3]=i*o,e):null},a.adjoint=function(e,t){var i=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=i,e},a.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},a.multiply=function(e,t,i){var r=t[0],a=t[1],n=t[2],o=t[3],s=i[0],u=i[1],l=i[2],c=i[3];return e[0]=r*s+n*u,e[1]=a*s+o*u,e[2]=r*l+n*c,e[3]=a*l+o*c,e},a.mul=a.multiply,a.rotate=function(e,t,i){var r=t[0],a=t[1],n=t[2],o=t[3],s=Math.sin(i),u=Math.cos(i);return e[0]=r*u+n*s,e[1]=a*u+o*s,e[2]=r*-s+n*u,e[3]=a*-s+o*u,e},a.scale=function(e,t,i){var r=t[0],a=t[1],n=t[2],o=t[3],s=i[0],u=i[1];return e[0]=r*s,e[1]=a*s,e[2]=n*u,e[3]=o*u,e},a.fromRotation=function(e,t){var i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=-i,e[3]=r,e},a.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},a.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},a.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))},a.LDU=function(e,t,i,r){return e[2]=r[2]/r[0],i[0]=r[0],i[1]=r[1],i[3]=r[3]-e[2]*i[1],[e,t,i]},a.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e},a.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e},a.sub=a.subtract,a.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},a.equals=function(e,t){var i=e[0],a=e[1],n=e[2],o=e[3],s=t[0],u=t[1],l=t[2],c=t[3];return Math.abs(i-s)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(a-u)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(n-l)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(o-c)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))},a.multiplyScalar=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},a.multiplyScalarAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e},e.exports=a},function(e,t,i){var r=i(245),a={};a.create=function(){var e=new r.ARRAY_TYPE(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},a.clone=function(e){var t=new r.ARRAY_TYPE(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},a.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},a.fromValues=function(e,t,i,a,n,o){var s=new r.ARRAY_TYPE(6);return s[0]=e,s[1]=t,s[2]=i,s[3]=a,s[4]=n,s[5]=o,s},a.set=function(e,t,i,r,a,n,o){return e[0]=t,e[1]=i,e[2]=r,e[3]=a,e[4]=n,e[5]=o,e},a.invert=function(e,t){var i=t[0],r=t[1],a=t[2],n=t[3],o=t[4],s=t[5],u=i*n-r*a;return u?(u=1/u,e[0]=n*u,e[1]=-r*u,e[2]=-a*u,e[3]=i*u,e[4]=(a*s-n*o)*u,e[5]=(r*o-i*s)*u,e):null},a.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},a.multiply=function(e,t,i){var r=t[0],a=t[1],n=t[2],o=t[3],s=t[4],u=t[5],l=i[0],c=i[1],h=i[2],d=i[3],p=i[4],f=i[5];return e[0]=r*l+n*c,e[1]=a*l+o*c,e[2]=r*h+n*d,e[3]=a*h+o*d,e[4]=r*p+n*f+s,e[5]=a*p+o*f+u,e},a.mul=a.multiply,a.rotate=function(e,t,i){var r=t[0],a=t[1],n=t[2],o=t[3],s=t[4],u=t[5],l=Math.sin(i),c=Math.cos(i);return e[0]=r*c+n*l,e[1]=a*c+o*l,e[2]=r*-l+n*c,e[3]=a*-l+o*c,e[4]=s,e[5]=u,e},a.scale=function(e,t,i){var r=t[0],a=t[1],n=t[2],o=t[3],s=t[4],u=t[5],l=i[0],c=i[1];return e[0]=r*l,e[1]=a*l,e[2]=n*c,e[3]=o*c,e[4]=s,e[5]=u,e},a.translate=function(e,t,i){var r=t[0],a=t[1],n=t[2],o=t[3],s=t[4],u=t[5],l=i[0],c=i[1];return e[0]=r,e[1]=a,e[2]=n,e[3]=o,e[4]=r*l+n*c+s,e[5]=a*l+o*c+u,e},a.fromRotation=function(e,t){var i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=-i,e[3]=r,e[4]=0,e[5]=0,e},a.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},a.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},a.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},a.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},a.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e},a.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e},a.sub=a.subtract,a.multiplyScalar=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e},a.multiplyScalarAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e[4]=t[4]+i[4]*r,e[5]=t[5]+i[5]*r,e},a.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},a.equals=function(e,t){var i=e[0],a=e[1],n=e[2],o=e[3],s=e[4],u=e[5],l=t[0],c=t[1],h=t[2],d=t[3],p=t[4],f=t[5];return Math.abs(i-l)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(a-c)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(n-h)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(o-d)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(s-p)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(u-f)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(f))},e.exports=a},function(e,t,i){var r=i(245),a={scalar:{},SIMD:{}};a.create=function(){var e=new r.ARRAY_TYPE(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},a.clone=function(e){var t=new r.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.fromValues=function(e,t,i,a,n,o,s,u,l,c,h,d,p,f,m,g){var _=new r.ARRAY_TYPE(16);return _[0]=e,_[1]=t,_[2]=i,_[3]=a,_[4]=n,_[5]=o,_[6]=s,_[7]=u,_[8]=l,_[9]=c,_[10]=h,_[11]=d,_[12]=p,_[13]=f,_[14]=m,_[15]=g,_},a.set=function(e,t,i,r,a,n,o,s,u,l,c,h,d,p,f,m,g){return e[0]=t,e[1]=i,e[2]=r,e[3]=a,e[4]=n,e[5]=o,e[6]=s,e[7]=u,e[8]=l,e[9]=c,e[10]=h,e[11]=d,e[12]=p,e[13]=f,e[14]=m,e[15]=g,e},a.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},a.scalar.transpose=function(e,t){if(e===t){var i=t[1],r=t[2],a=t[3],n=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=i,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=n,e[11]=t[14],e[12]=a,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},a.SIMD.transpose=function(e,t){var i,r,a,n,o,s,u,l,c,h;return i=SIMD.Float32x4.load(t,0),r=SIMD.Float32x4.load(t,4),a=SIMD.Float32x4.load(t,8),n=SIMD.Float32x4.load(t,12),o=SIMD.Float32x4.shuffle(i,r,0,1,4,5),s=SIMD.Float32x4.shuffle(a,n,0,1,4,5),u=SIMD.Float32x4.shuffle(o,s,0,2,4,6),l=SIMD.Float32x4.shuffle(o,s,1,3,5,7),SIMD.Float32x4.store(e,0,u),SIMD.Float32x4.store(e,4,l),o=SIMD.Float32x4.shuffle(i,r,2,3,6,7),s=SIMD.Float32x4.shuffle(a,n,2,3,6,7),c=SIMD.Float32x4.shuffle(o,s,0,2,4,6),h=SIMD.Float32x4.shuffle(o,s,1,3,5,7),SIMD.Float32x4.store(e,8,c),SIMD.Float32x4.store(e,12,h),e},a.transpose=r.USE_SIMD?a.SIMD.transpose:a.scalar.transpose,a.scalar.invert=function(e,t){var i=t[0],r=t[1],a=t[2],n=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],_=t[15],v=i*s-r*o,b=i*u-a*o,y=i*l-n*o,x=r*u-a*s,S=r*l-n*s,M=a*l-n*u,w=c*m-h*f,T=c*g-d*f,C=c*_-p*f,E=h*g-d*m,L=h*_-p*m,P=d*_-p*g,A=v*P-b*L+y*E+x*C-S*T+M*w;return A?(A=1/A,e[0]=(s*P-u*L+l*E)*A,e[1]=(a*L-r*P-n*E)*A,e[2]=(m*M-g*S+_*x)*A,e[3]=(d*S-h*M-p*x)*A,e[4]=(u*C-o*P-l*T)*A,e[5]=(i*P-a*C+n*T)*A,e[6]=(g*y-f*M-_*b)*A,e[7]=(c*M-d*y+p*b)*A,e[8]=(o*L-s*C+l*w)*A,e[9]=(r*C-i*L-n*w)*A,e[10]=(f*S-m*y+_*v)*A,e[11]=(h*y-c*S-p*v)*A,e[12]=(s*T-o*E-u*w)*A,e[13]=(i*E-r*T+a*w)*A,e[14]=(m*b-f*x-g*v)*A,e[15]=(c*x-h*b+d*v)*A,e):null},a.SIMD.invert=function(e,t){var i,r,a,n,o,s,u,l,c,h,d=SIMD.Float32x4.load(t,0),p=SIMD.Float32x4.load(t,4),f=SIMD.Float32x4.load(t,8),m=SIMD.Float32x4.load(t,12);return o=SIMD.Float32x4.shuffle(d,p,0,1,4,5),r=SIMD.Float32x4.shuffle(f,m,0,1,4,5),i=SIMD.Float32x4.shuffle(o,r,0,2,4,6),r=SIMD.Float32x4.shuffle(r,o,1,3,5,7),o=SIMD.Float32x4.shuffle(d,p,2,3,6,7),n=SIMD.Float32x4.shuffle(f,m,2,3,6,7),a=SIMD.Float32x4.shuffle(o,n,0,2,4,6),n=SIMD.Float32x4.shuffle(n,o,1,3,5,7),o=SIMD.Float32x4.mul(a,n),o=SIMD.Float32x4.swizzle(o,1,0,3,2),s=SIMD.Float32x4.mul(r,o),u=SIMD.Float32x4.mul(i,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,o),s),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,o),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),o=SIMD.Float32x4.mul(r,a),o=SIMD.Float32x4.swizzle(o,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,o),s),c=SIMD.Float32x4.mul(i,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(n,o)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,o),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),o=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,2,3,0,1),n),o=SIMD.Float32x4.swizzle(o,1,0,3,2),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),s),l=SIMD.Float32x4.mul(i,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(a,o)),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,o),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),o=SIMD.Float32x4.mul(i,r),o=SIMD.Float32x4.swizzle(o,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,o),l),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,o),c),o=SIMD.Float32x4.swizzle(o,2,3,0,1),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,o),l),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(a,o)),o=SIMD.Float32x4.mul(i,n),o=SIMD.Float32x4.swizzle(o,1,0,3,2),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(a,o)),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,o),l),o=SIMD.Float32x4.swizzle(o,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),u),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(r,o)),o=SIMD.Float32x4.mul(i,a),o=SIMD.Float32x4.swizzle(o,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,o),u),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(r,o)),o=SIMD.Float32x4.swizzle(o,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(n,o)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,o),c),h=SIMD.Float32x4.mul(i,s),h=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(h,2,3,0,1),h),h=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(h,1,0,3,2),h),o=SIMD.Float32x4.reciprocalApproximation(h),h=SIMD.Float32x4.sub(SIMD.Float32x4.add(o,o),SIMD.Float32x4.mul(h,SIMD.Float32x4.mul(o,o))),(h=SIMD.Float32x4.swizzle(h,0,0,0,0))?(SIMD.Float32x4.store(e,0,SIMD.Float32x4.mul(h,s)),SIMD.Float32x4.store(e,4,SIMD.Float32x4.mul(h,u)),SIMD.Float32x4.store(e,8,SIMD.Float32x4.mul(h,l)),SIMD.Float32x4.store(e,12,SIMD.Float32x4.mul(h,c)),e):null},a.invert=r.USE_SIMD?a.SIMD.invert:a.scalar.invert,a.scalar.adjoint=function(e,t){var i=t[0],r=t[1],a=t[2],n=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],_=t[15];return e[0]=s*(d*_-p*g)-h*(u*_-l*g)+m*(u*p-l*d),e[1]=-(r*(d*_-p*g)-h*(a*_-n*g)+m*(a*p-n*d)),e[2]=r*(u*_-l*g)-s*(a*_-n*g)+m*(a*l-n*u),e[3]=-(r*(u*p-l*d)-s*(a*p-n*d)+h*(a*l-n*u)),e[4]=-(o*(d*_-p*g)-c*(u*_-l*g)+f*(u*p-l*d)),e[5]=i*(d*_-p*g)-c*(a*_-n*g)+f*(a*p-n*d),e[6]=-(i*(u*_-l*g)-o*(a*_-n*g)+f*(a*l-n*u)),e[7]=i*(u*p-l*d)-o*(a*p-n*d)+c*(a*l-n*u),e[8]=o*(h*_-p*m)-c*(s*_-l*m)+f*(s*p-l*h),e[9]=-(i*(h*_-p*m)-c*(r*_-n*m)+f*(r*p-n*h)),e[10]=i*(s*_-l*m)-o*(r*_-n*m)+f*(r*l-n*s),e[11]=-(i*(s*p-l*h)-o*(r*p-n*h)+c*(r*l-n*s)),e[12]=-(o*(h*g-d*m)-c*(s*g-u*m)+f*(s*d-u*h)),e[13]=i*(h*g-d*m)-c*(r*g-a*m)+f*(r*d-a*h),e[14]=-(i*(s*g-u*m)-o*(r*g-a*m)+f*(r*u-a*s)),e[15]=i*(s*d-u*h)-o*(r*d-a*h)+c*(r*u-a*s),e},a.SIMD.adjoint=function(e,t){var i,r,a,n,o,s,u,l,c,h,d,p,f,i=SIMD.Float32x4.load(t,0),r=SIMD.Float32x4.load(t,4),a=SIMD.Float32x4.load(t,8),n=SIMD.Float32x4.load(t,12);return c=SIMD.Float32x4.shuffle(i,r,0,1,4,5),s=SIMD.Float32x4.shuffle(a,n,0,1,4,5),o=SIMD.Float32x4.shuffle(c,s,0,2,4,6),s=SIMD.Float32x4.shuffle(s,c,1,3,5,7),c=SIMD.Float32x4.shuffle(i,r,2,3,6,7),l=SIMD.Float32x4.shuffle(a,n,2,3,6,7),u=SIMD.Float32x4.shuffle(c,l,0,2,4,6),l=SIMD.Float32x4.shuffle(l,c,1,3,5,7),c=SIMD.Float32x4.mul(u,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.mul(s,c),d=SIMD.Float32x4.mul(o,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),h),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,c),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),c=SIMD.Float32x4.mul(s,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),h),f=SIMD.Float32x4.mul(o,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(l,c)),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,c),f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),c=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,3,0,1),l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),u=SIMD.Float32x4.swizzle(u,2,3,0,1),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),h),p=SIMD.Float32x4.mul(o,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(u,c)),p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,c),p),p=SIMD.Float32x4.swizzle(p,2,3,0,1),c=SIMD.Float32x4.mul(o,s),c=SIMD.Float32x4.swizzle(c,1,0,3,2),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),p),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,c),f),c=SIMD.Float32x4.swizzle(c,2,3,0,1),p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,c),p),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(u,c)),c=SIMD.Float32x4.mul(o,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(u,c)),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),p),c=SIMD.Float32x4.swizzle(c,2,3,0,1),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),d),p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(s,c)),c=SIMD.Float32x4.mul(o,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),d),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(s,c)),c=SIMD.Float32x4.swizzle(c,2,3,0,1),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(l,c)),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),f),SIMD.Float32x4.store(e,0,h),SIMD.Float32x4.store(e,4,d),SIMD.Float32x4.store(e,8,p),SIMD.Float32x4.store(e,12,f),e},a.adjoint=r.USE_SIMD?a.SIMD.adjoint:a.scalar.adjoint,a.determinant=function(e){var t=e[0],i=e[1],r=e[2],a=e[3],n=e[4],o=e[5],s=e[6],u=e[7],l=e[8],c=e[9],h=e[10],d=e[11],p=e[12],f=e[13],m=e[14],g=e[15];return(t*o-i*n)*(h*g-d*m)-(t*s-r*n)*(c*g-d*f)+(t*u-a*n)*(c*m-h*f)+(i*s-r*o)*(l*g-d*p)-(i*u-a*o)*(l*m-h*p)+(r*u-a*s)*(l*f-c*p)},a.SIMD.multiply=function(e,t,i){var r=SIMD.Float32x4.load(t,0),a=SIMD.Float32x4.load(t,4),n=SIMD.Float32x4.load(t,8),o=SIMD.Float32x4.load(t,12),s=SIMD.Float32x4.load(i,0),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),n),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),o))));SIMD.Float32x4.store(e,0,u);var l=SIMD.Float32x4.load(i,4),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,2,2,2,2),n),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,3,3,3,3),o))));SIMD.Float32x4.store(e,4,c);var h=SIMD.Float32x4.load(i,8),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),n),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),o))));SIMD.Float32x4.store(e,8,d);var p=SIMD.Float32x4.load(i,12),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(p,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(p,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(p,2,2,2,2),n),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(p,3,3,3,3),o))));return SIMD.Float32x4.store(e,12,f),e},a.scalar.multiply=function(e,t,i){var r=t[0],a=t[1],n=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],d=t[9],p=t[10],f=t[11],m=t[12],g=t[13],_=t[14],v=t[15],b=i[0],y=i[1],x=i[2],S=i[3];return e[0]=b*r+y*s+x*h+S*m,e[1]=b*a+y*u+x*d+S*g,e[2]=b*n+y*l+x*p+S*_,e[3]=b*o+y*c+x*f+S*v,b=i[4],y=i[5],x=i[6],S=i[7],e[4]=b*r+y*s+x*h+S*m,e[5]=b*a+y*u+x*d+S*g,e[6]=b*n+y*l+x*p+S*_,e[7]=b*o+y*c+x*f+S*v,b=i[8],y=i[9],x=i[10],S=i[11],e[8]=b*r+y*s+x*h+S*m,e[9]=b*a+y*u+x*d+S*g,e[10]=b*n+y*l+x*p+S*_,e[11]=b*o+y*c+x*f+S*v,b=i[12],y=i[13],x=i[14],S=i[15],e[12]=b*r+y*s+x*h+S*m,e[13]=b*a+y*u+x*d+S*g,e[14]=b*n+y*l+x*p+S*_,e[15]=b*o+y*c+x*f+S*v,e},a.multiply=r.USE_SIMD?a.SIMD.multiply:a.scalar.multiply,a.mul=a.multiply,a.scalar.translate=function(e,t,i){var r,a,n,o,s,u,l,c,h,d,p,f,m=i[0],g=i[1],_=i[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*_+t[12],e[13]=t[1]*m+t[5]*g+t[9]*_+t[13],e[14]=t[2]*m+t[6]*g+t[10]*_+t[14],e[15]=t[3]*m+t[7]*g+t[11]*_+t[15]):(r=t[0],a=t[1],n=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],d=t[9],p=t[10],f=t[11],e[0]=r,e[1]=a,e[2]=n,e[3]=o,e[4]=s,e[5]=u,e[6]=l,e[7]=c,e[8]=h,e[9]=d,e[10]=p,e[11]=f,e[12]=r*m+s*g+h*_+t[12],e[13]=a*m+u*g+d*_+t[13],e[14]=n*m+l*g+p*_+t[14],e[15]=o*m+c*g+f*_+t[15]),e},a.SIMD.translate=function(e,t,i){var r=SIMD.Float32x4.load(t,0),a=SIMD.Float32x4.load(t,4),n=SIMD.Float32x4.load(t,8),o=SIMD.Float32x4.load(t,12),s=SIMD.Float32x4(i[0],i[1],i[2],0);t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11]),r=SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(s,0,0,0,0)),a=SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(s,1,1,1,1)),n=SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(s,2,2,2,2));var u=SIMD.Float32x4.add(r,SIMD.Float32x4.add(a,SIMD.Float32x4.add(n,o)));return SIMD.Float32x4.store(e,12,u),e},a.translate=r.USE_SIMD?a.SIMD.translate:a.scalar.translate,a.scalar.scale=function(e,t,i){var r=i[0],a=i[1],n=i[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*a,e[5]=t[5]*a,e[6]=t[6]*a,e[7]=t[7]*a,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.SIMD.scale=function(e,t,i){var r,a,n,o=SIMD.Float32x4(i[0],i[1],i[2],0);return r=SIMD.Float32x4.load(t,0),SIMD.Float32x4.store(e,0,SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(o,0,0,0,0))),a=SIMD.Float32x4.load(t,4),SIMD.Float32x4.store(e,4,SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(o,1,1,1,1))),n=SIMD.Float32x4.load(t,8),SIMD.Float32x4.store(e,8,SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(o,2,2,2,2))),e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.scale=r.USE_SIMD?a.SIMD.scale:a.scalar.scale,a.rotate=function(e,t,i,a){var n,o,s,u,l,c,h,d,p,f,m,g,_,v,b,y,x,S,M,w,T,C,E,L,P=a[0],A=a[1],D=a[2],O=Math.sqrt(P*P+A*A+D*D);return Math.abs(O)<r.EPSILON?null:(O=1/O,P*=O,A*=O,D*=O,n=Math.sin(i),o=Math.cos(i),s=1-o,u=t[0],l=t[1],c=t[2],h=t[3],d=t[4],p=t[5],f=t[6],m=t[7],g=t[8],_=t[9],v=t[10],b=t[11],y=P*P*s+o,x=A*P*s+D*n,S=D*P*s-A*n,M=P*A*s-D*n,w=A*A*s+o,T=D*A*s+P*n,C=P*D*s+A*n,E=A*D*s-P*n,L=D*D*s+o,e[0]=u*y+d*x+g*S,e[1]=l*y+p*x+_*S,e[2]=c*y+f*x+v*S,e[3]=h*y+m*x+b*S,e[4]=u*M+d*w+g*T,e[5]=l*M+p*w+_*T,e[6]=c*M+f*w+v*T,e[7]=h*M+m*w+b*T,e[8]=u*C+d*E+g*L,e[9]=l*C+p*E+_*L,e[10]=c*C+f*E+v*L,e[11]=h*C+m*E+b*L,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},a.scalar.rotateX=function(e,t,i){var r=Math.sin(i),a=Math.cos(i),n=t[4],o=t[5],s=t[6],u=t[7],l=t[8],c=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=n*a+l*r,e[5]=o*a+c*r,e[6]=s*a+h*r,e[7]=u*a+d*r,e[8]=l*a-n*r,e[9]=c*a-o*r,e[10]=h*a-s*r,e[11]=d*a-u*r,e},a.SIMD.rotateX=function(e,t,i){var r=SIMD.Float32x4.splat(Math.sin(i)),a=SIMD.Float32x4.splat(Math.cos(i));t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);var n=SIMD.Float32x4.load(t,4),o=SIMD.Float32x4.load(t,8);return SIMD.Float32x4.store(e,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(n,a),SIMD.Float32x4.mul(o,r))),SIMD.Float32x4.store(e,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(n,r))),e},a.rotateX=r.USE_SIMD?a.SIMD.rotateX:a.scalar.rotateX,a.scalar.rotateY=function(e,t,i){var r=Math.sin(i),a=Math.cos(i),n=t[0],o=t[1],s=t[2],u=t[3],l=t[8],c=t[9],h=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=n*a-l*r,e[1]=o*a-c*r,e[2]=s*a-h*r,e[3]=u*a-d*r,e[8]=n*r+l*a,e[9]=o*r+c*a,e[10]=s*r+h*a,e[11]=u*r+d*a,e},a.SIMD.rotateY=function(e,t,i){var r=SIMD.Float32x4.splat(Math.sin(i)),a=SIMD.Float32x4.splat(Math.cos(i));t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);var n=SIMD.Float32x4.load(t,0),o=SIMD.Float32x4.load(t,8);return SIMD.Float32x4.store(e,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),SIMD.Float32x4.mul(o,r))),SIMD.Float32x4.store(e,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(n,r),SIMD.Float32x4.mul(o,a))),e},a.rotateY=r.USE_SIMD?a.SIMD.rotateY:a.scalar.rotateY,a.scalar.rotateZ=function(e,t,i){var r=Math.sin(i),a=Math.cos(i),n=t[0],o=t[1],s=t[2],u=t[3],l=t[4],c=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=n*a+l*r,e[1]=o*a+c*r,e[2]=s*a+h*r,e[3]=u*a+d*r,e[4]=l*a-n*r,e[5]=c*a-o*r,e[6]=h*a-s*r,e[7]=d*a-u*r,e},a.SIMD.rotateZ=function(e,t,i){var r=SIMD.Float32x4.splat(Math.sin(i)),a=SIMD.Float32x4.splat(Math.cos(i));t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);var n=SIMD.Float32x4.load(t,0),o=SIMD.Float32x4.load(t,4);return SIMD.Float32x4.store(e,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(n,a),SIMD.Float32x4.mul(o,r))),SIMD.Float32x4.store(e,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(n,r))),e},a.rotateZ=r.USE_SIMD?a.SIMD.rotateZ:a.scalar.rotateZ,a.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},a.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},a.fromRotation=function(e,t,i){var a,n,o,s=i[0],u=i[1],l=i[2],c=Math.sqrt(s*s+u*u+l*l);return Math.abs(c)<r.EPSILON?null:(c=1/c,s*=c,u*=c,l*=c,a=Math.sin(t),n=Math.cos(t),o=1-n,e[0]=s*s*o+n,e[1]=u*s*o+l*a,e[2]=l*s*o-u*a,e[3]=0,e[4]=s*u*o-l*a,e[5]=u*u*o+n,e[6]=l*u*o+s*a,e[7]=0,e[8]=s*l*o+u*a,e[9]=u*l*o-s*a,e[10]=l*l*o+n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},a.fromXRotation=function(e,t){var i=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=i,e[7]=0,e[8]=0,e[9]=-i,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},a.fromYRotation=function(e,t){var i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-i,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=i,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},a.fromZRotation=function(e,t){var i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=0,e[3]=0,e[4]=-i,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},a.fromRotationTranslation=function(e,t,i){var r=t[0],a=t[1],n=t[2],o=t[3],s=r+r,u=a+a,l=n+n,c=r*s,h=r*u,d=r*l,p=a*u,f=a*l,m=n*l,g=o*s,_=o*u,v=o*l;return e[0]=1-(p+m),e[1]=h+v,e[2]=d-_,e[3]=0,e[4]=h-v,e[5]=1-(c+m),e[6]=f+g,e[7]=0,e[8]=d+_,e[9]=f-g,e[10]=1-(c+p),e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e},a.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},a.getRotation=function(e,t){var i=t[0]+t[5]+t[10],r=0;return i>0?(r=2*Math.sqrt(i+1),e[3]=.25*r,e[0]=(t[6]-t[9])/r,e[1]=(t[8]-t[2])/r,e[2]=(t[1]-t[4])/r):t[0]>t[5]&t[0]>t[10]?(r=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/r,e[0]=.25*r,e[1]=(t[1]+t[4])/r,e[2]=(t[8]+t[2])/r):t[5]>t[10]?(r=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/r,e[0]=(t[1]+t[4])/r,e[1]=.25*r,e[2]=(t[6]+t[9])/r):(r=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/r,e[0]=(t[8]+t[2])/r,e[1]=(t[6]+t[9])/r,e[2]=.25*r),e},a.fromRotationTranslationScale=function(e,t,i,r){var a=t[0],n=t[1],o=t[2],s=t[3],u=a+a,l=n+n,c=o+o,h=a*u,d=a*l,p=a*c,f=n*l,m=n*c,g=o*c,_=s*u,v=s*l,b=s*c,y=r[0],x=r[1],S=r[2];return e[0]=(1-(f+g))*y,e[1]=(d+b)*y,e[2]=(p-v)*y,e[3]=0,e[4]=(d-b)*x,e[5]=(1-(h+g))*x,e[6]=(m+_)*x,e[7]=0,e[8]=(p+v)*S,e[9]=(m-_)*S,e[10]=(1-(h+f))*S,e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e},a.fromRotationTranslationScaleOrigin=function(e,t,i,r,a){var n=t[0],o=t[1],s=t[2],u=t[3],l=n+n,c=o+o,h=s+s,d=n*l,p=n*c,f=n*h,m=o*c,g=o*h,_=s*h,v=u*l,b=u*c,y=u*h,x=r[0],S=r[1],M=r[2],w=a[0],T=a[1],C=a[2];return e[0]=(1-(m+_))*x,e[1]=(p+y)*x,e[2]=(f-b)*x,e[3]=0,e[4]=(p-y)*S,e[5]=(1-(d+_))*S,e[6]=(g+v)*S,e[7]=0,e[8]=(f+b)*M,e[9]=(g-v)*M,e[10]=(1-(d+m))*M,e[11]=0,e[12]=i[0]+w-(e[0]*w+e[4]*T+e[8]*C),e[13]=i[1]+T-(e[1]*w+e[5]*T+e[9]*C),e[14]=i[2]+C-(e[2]*w+e[6]*T+e[10]*C),e[15]=1,e},a.fromQuat=function(e,t){var i=t[0],r=t[1],a=t[2],n=t[3],o=i+i,s=r+r,u=a+a,l=i*o,c=r*o,h=r*s,d=a*o,p=a*s,f=a*u,m=n*o,g=n*s,_=n*u;return e[0]=1-h-f,e[1]=c+_,e[2]=d-g,e[3]=0,e[4]=c-_,e[5]=1-l-f,e[6]=p+m,e[7]=0,e[8]=d+g,e[9]=p-m,e[10]=1-l-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},a.frustum=function(e,t,i,r,a,n,o){var s=1/(i-t),u=1/(a-r),l=1/(n-o);return e[0]=2*n*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*n*u,e[6]=0,e[7]=0,e[8]=(i+t)*s,e[9]=(a+r)*u,e[10]=(o+n)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*n*2*l,e[15]=0,e},a.perspective=function(e,t,i,r,a){var n=1/Math.tan(t/2),o=1/(r-a);return e[0]=n/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(a+r)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*a*r*o,e[15]=0,e},a.perspectiveFromFieldOfView=function(e,t,i,r){var a=Math.tan(t.upDegrees*Math.PI/180),n=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(o+s),l=2/(a+n);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-(o-s)*u*.5,e[9]=(a-n)*l*.5,e[10]=r/(i-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*i/(i-r),e[15]=0,e},a.ortho=function(e,t,i,r,a,n,o){var s=1/(t-i),u=1/(r-a),l=1/(n-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+i)*s,e[13]=(a+r)*u,e[14]=(o+n)*l,e[15]=1,e},a.lookAt=function(e,t,i,n){var o,s,u,l,c,h,d,p,f,m,g=t[0],_=t[1],v=t[2],b=n[0],y=n[1],x=n[2],S=i[0],M=i[1],w=i[2];return Math.abs(g-S)<r.EPSILON&&Math.abs(_-M)<r.EPSILON&&Math.abs(v-w)<r.EPSILON?a.identity(e):(d=g-S,p=_-M,f=v-w,m=1/Math.sqrt(d*d+p*p+f*f),d*=m,p*=m,f*=m,o=y*f-x*p,s=x*d-b*f,u=b*p-y*d,m=Math.sqrt(o*o+s*s+u*u),m?(m=1/m,o*=m,s*=m,u*=m):(o=0,s=0,u=0),l=p*u-f*s,c=f*o-d*u,h=d*s-p*o,m=Math.sqrt(l*l+c*c+h*h),m?(m=1/m,l*=m,c*=m,h*=m):(l=0,c=0,h=0),e[0]=o,e[1]=l,e[2]=d,e[3]=0,e[4]=s,e[5]=c,e[6]=p,e[7]=0,e[8]=u,e[9]=h,e[10]=f,e[11]=0,e[12]=-(o*g+s*_+u*v),e[13]=-(l*g+c*_+h*v),e[14]=-(d*g+p*_+f*v),e[15]=1,e)},a.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},a.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},a.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e[9]=t[9]+i[9],e[10]=t[10]+i[10],e[11]=t[11]+i[11],e[12]=t[12]+i[12],e[13]=t[13]+i[13],e[14]=t[14]+i[14],e[15]=t[15]+i[15],e},a.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e[9]=t[9]-i[9],e[10]=t[10]-i[10],e[11]=t[11]-i[11],e[12]=t[12]-i[12],e[13]=t[13]-i[13],e[14]=t[14]-i[14],e[15]=t[15]-i[15],e},a.sub=a.subtract,a.multiplyScalar=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12]*i,e[13]=t[13]*i,e[14]=t[14]*i,e[15]=t[15]*i,e},a.multiplyScalarAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e[4]=t[4]+i[4]*r,e[5]=t[5]+i[5]*r,e[6]=t[6]+i[6]*r,e[7]=t[7]+i[7]*r,e[8]=t[8]+i[8]*r,e[9]=t[9]+i[9]*r,e[10]=t[10]+i[10]*r,e[11]=t[11]+i[11]*r,e[12]=t[12]+i[12]*r,e[13]=t[13]+i[13]*r,e[14]=t[14]+i[14]*r,e[15]=t[15]+i[15]*r,e},a.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},a.equals=function(e,t){var i=e[0],a=e[1],n=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],m=e[12],g=e[13],_=e[14],v=e[15],b=t[0],y=t[1],x=t[2],S=t[3],M=t[4],w=t[5],T=t[6],C=t[7],E=t[8],L=t[9],P=t[10],A=t[11],D=t[12],O=t[13],k=t[14],R=t[15];return Math.abs(i-b)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(a-y)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(y))&&Math.abs(n-x)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(o-S)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(S))&&Math.abs(s-M)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(u-w)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(l-T)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(c-C)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(h-E)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(d-L)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(L))&&Math.abs(p-P)<=r.EPSILON*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(f-A)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(m-D)<=r.EPSILON*Math.max(1,Math.abs(m),Math.abs(D))&&Math.abs(g-O)<=r.EPSILON*Math.max(1,Math.abs(g),Math.abs(O))&&Math.abs(_-k)<=r.EPSILON*Math.max(1,Math.abs(_),Math.abs(k))&&Math.abs(v-R)<=r.EPSILON*Math.max(1,Math.abs(v),Math.abs(R))},e.exports=a},function(e,t,i){var r=i(245),a=i(774),n=i(775),o=i(776),s={};s.create=function(){var e=new r.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},s.rotationTo=function(){var e=n.create(),t=n.fromValues(1,0,0),i=n.fromValues(0,1,0);return function(r,a,o){var u=n.dot(a,o);return u<-.999999?(n.cross(e,t,a),n.length(e)<1e-6&&n.cross(e,i,a),n.normalize(e,e),s.setAxisAngle(r,e,Math.PI),r):u>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(n.cross(e,a,o),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+u,s.normalize(r,r))}}(),s.setAxes=function(){var e=a.create();return function(t,i,r,a){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=a[0],e[4]=a[1],e[7]=a[2],e[2]=-i[0],e[5]=-i[1],e[8]=-i[2],s.normalize(t,s.fromMat3(t,e))}}(),s.clone=o.clone,s.fromValues=o.fromValues,s.copy=o.copy,s.set=o.set,s.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},s.setAxisAngle=function(e,t,i){i*=.5;var r=Math.sin(i);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(i),e},s.getAxisAngle=function(e,t){var i=2*Math.acos(t[3]),r=Math.sin(i/2);return 0!=r?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),i},s.add=o.add,s.multiply=function(e,t,i){var r=t[0],a=t[1],n=t[2],o=t[3],s=i[0],u=i[1],l=i[2],c=i[3];return e[0]=r*c+o*s+a*l-n*u,e[1]=a*c+o*u+n*s-r*l,e[2]=n*c+o*l+r*u-a*s,e[3]=o*c-r*s-a*u-n*l,e},s.mul=s.multiply,s.scale=o.scale,s.rotateX=function(e,t,i){i*=.5;var r=t[0],a=t[1],n=t[2],o=t[3],s=Math.sin(i),u=Math.cos(i);return e[0]=r*u+o*s,e[1]=a*u+n*s,e[2]=n*u-a*s,e[3]=o*u-r*s,e},s.rotateY=function(e,t,i){i*=.5;var r=t[0],a=t[1],n=t[2],o=t[3],s=Math.sin(i),u=Math.cos(i);return e[0]=r*u-n*s,e[1]=a*u+o*s,e[2]=n*u+r*s,e[3]=o*u-a*s,e},s.rotateZ=function(e,t,i){i*=.5;var r=t[0],a=t[1],n=t[2],o=t[3],s=Math.sin(i),u=Math.cos(i);return e[0]=r*u+a*s,e[1]=a*u-r*s,e[2]=n*u+o*s,e[3]=o*u-n*s,e},s.calculateW=function(e,t){var i=t[0],r=t[1],a=t[2];return e[0]=i,e[1]=r,e[2]=a,e[3]=Math.sqrt(Math.abs(1-i*i-r*r-a*a)),e},s.dot=o.dot,s.lerp=o.lerp,s.slerp=function(e,t,i,r){var a,n,o,s,u,l=t[0],c=t[1],h=t[2],d=t[3],p=i[0],f=i[1],m=i[2],g=i[3];return n=l*p+c*f+h*m+d*g,n<0&&(n=-n,p=-p,f=-f,m=-m,g=-g),1-n>1e-6?(a=Math.acos(n),o=Math.sin(a),s=Math.sin((1-r)*a)/o,u=Math.sin(r*a)/o):(s=1-r,u=r),e[0]=s*l+u*p,e[1]=s*c+u*f,e[2]=s*h+u*m,e[3]=s*d+u*g,e},s.sqlerp=function(){var e=s.create(),t=s.create();return function(i,r,a,n,o,u){return s.slerp(e,r,o,u),s.slerp(t,a,n,u),s.slerp(i,e,t,2*u*(1-u)),i}}(),s.invert=function(e,t){var i=t[0],r=t[1],a=t[2],n=t[3],o=i*i+r*r+a*a+n*n,s=o?1/o:0;return e[0]=-i*s,e[1]=-r*s,e[2]=-a*s,e[3]=n*s,e},s.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},s.length=o.length,s.len=s.length,s.squaredLength=o.squaredLength,s.sqrLen=s.squaredLength,s.normalize=o.normalize,s.fromMat3=function(e,t){var i,r=t[0]+t[4]+t[8];if(r>0)i=Math.sqrt(r+1),e[3]=.5*i,i=.5/i,e[0]=(t[5]-t[7])*i,e[1]=(t[6]-t[2])*i,e[2]=(t[1]-t[3])*i;else{var a=0;t[4]>t[0]&&(a=1),t[8]>t[3*a+a]&&(a=2);var n=(a+1)%3,o=(a+2)%3;i=Math.sqrt(t[3*a+a]-t[3*n+n]-t[3*o+o]+1),e[a]=.5*i,i=.5/i,e[3]=(t[3*n+o]-t[3*o+n])*i,e[n]=(t[3*n+a]+t[3*a+n])*i,e[o]=(t[3*o+a]+t[3*a+o])*i}return e},s.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},s.exactEquals=o.exactEquals,s.equals=o.equals,e.exports=s},function(e,t,i){var r=i(245),a={};a.create=function(){var e=new r.ARRAY_TYPE(2);return e[0]=0,e[1]=0,e},a.clone=function(e){var t=new r.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},a.fromValues=function(e,t){var i=new r.ARRAY_TYPE(2);return i[0]=e,i[1]=t,i},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},a.set=function(e,t,i){return e[0]=t,e[1]=i,e},a.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e},a.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e},a.sub=a.subtract,a.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e},a.mul=a.multiply,a.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e},a.div=a.divide,a.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},a.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},a.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e},a.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e},a.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},a.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e},a.scaleAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e},a.distance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(i*i+r*r)},a.dist=a.distance,a.squaredDistance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1];return i*i+r*r},a.sqrDist=a.squaredDistance,a.length=function(e){var t=e[0],i=e[1];return Math.sqrt(t*t+i*i)},a.len=a.length,a.squaredLength=function(e){var t=e[0],i=e[1];return t*t+i*i},a.sqrLen=a.squaredLength,a.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},a.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},a.normalize=function(e,t){var i=t[0],r=t[1],a=i*i+r*r;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a),e},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},a.cross=function(e,t,i){var r=t[0]*i[1]-t[1]*i[0];return e[0]=e[1]=0,e[2]=r,e},a.lerp=function(e,t,i,r){var a=t[0],n=t[1];return e[0]=a+r*(i[0]-a),e[1]=n+r*(i[1]-n),e},a.random=function(e,t){t=t||1;var i=2*r.RANDOM()*Math.PI;return e[0]=Math.cos(i)*t,e[1]=Math.sin(i)*t,e},a.transformMat2=function(e,t,i){var r=t[0],a=t[1];return e[0]=i[0]*r+i[2]*a,e[1]=i[1]*r+i[3]*a,e},a.transformMat2d=function(e,t,i){var r=t[0],a=t[1];return e[0]=i[0]*r+i[2]*a+i[4],e[1]=i[1]*r+i[3]*a+i[5],e},a.transformMat3=function(e,t,i){var r=t[0],a=t[1];return e[0]=i[0]*r+i[3]*a+i[6],e[1]=i[1]*r+i[4]*a+i[7],e},a.transformMat4=function(e,t,i){var r=t[0],a=t[1];return e[0]=i[0]*r+i[4]*a+i[12],e[1]=i[1]*r+i[5]*a+i[13],e},a.forEach=function(){var e=a.create();return function(t,i,r,a,n,o){var s,u;for(i||(i=2),r||(r=0),u=a?Math.min(a*i+r,t.length):t.length,s=r;s<u;s+=i)e[0]=t[s],e[1]=t[s+1],n(e,e,o),t[s]=e[0],t[s+1]=e[1];return t}}(),a.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},a.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},a.equals=function(e,t){var i=e[0],a=e[1],n=t[0],o=t[1];return Math.abs(i-n)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(n))&&Math.abs(a-o)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(o))},e.exports=a},function(e,t,i){"use strict";t.a={ArrayType:Float64Array}},function(e,t,i){"use strict";var r=i(21),a=i(213),n=function(e,t,i,r){this._target=e,this._internalFormat=t,this._width=i,this._height=r,this._size=0,this.computeSize()};n.prototype={match:function(e){return e._target===this._target&&e._internalFormat===this._internalFormat&&e._width===this._width&&e._height===this._height},computeSize:function(){var e=i(84).default,t=0;switch(this._internalFormat){case 1:case e.ALPHA:case e.LUMINANCE:t=8;break;case e.LUMINANCE_ALPHA:case 2:t=16;break;case e.RGB:case 3:t=24;break;case e.RGBA:case 4:t=32}var r=Math.ceil(this._width*this._height*t)/8;this._target===e.TEXTURE_CUBE_MAP&&(r*=6),r+=r/3,this._size=r},getSize:function(){return this._size}},n.getHash=function(){var e=Array.prototype.slice.call(arguments),t="";return e.forEach(function(e){t+=e}),t};var o=function(e,t,i){this._texture=e,this._id=t,this._textureSet=i};o.prototype={target:function(){return this._textureSet._profile._target},id:function(){return this._id},getTextureSet:function(){return this._textureSet},reset:function(){this._textureObject=null,this._texture=void 0},bind:function(e){e.bindTexture(this.target(),this._id)}};var s=function(e){this._profile=e,this._usedTextureObjects=[],this._orphanedTextureObjects=[]};s.prototype={getProfile:function(){return this._profile},getUsedTextureObjects:function(){return this._usedTextureObjects},getOrphanedTextureObjects:function(){return this._orphanedTextureObjects},takeOrGenerate:function(e,t){var i;if(this._orphanedTextureObjects.length>0)return i=this.takeFromOrphans(),i._texture=t,this._usedTextureObjects.push(i),i;var r=e.createTexture();return i=new o(t,r,this),this._usedTextureObjects.push(i),i},takeFromOrphans:function(){if(this._orphanedTextureObjects.length)return this._orphanedTextureObjects.pop()},orphan:function(e){var t=this._usedTextureObjects.indexOf(e);-1!==t&&(this._orphanedTextureObjects.push(this._usedTextureObjects[t]),this._usedTextureObjects.splice(t,1))},flushDeletedTextureObjects:function(e,t){if(t<=0)return t;var i,r=this._orphanedTextureObjects.length,n=0,o=a.a.instance().tick();for(i=0;i<r&&n<t;i++)e.deleteTexture(this._orphanedTextureObjects[i].id()),this._orphanedTextureObjects[i].reset(),n=a.a.instance().deltaS(o,a.a.instance().tick());return this._orphanedTextureObjects.splice(0,i),t-n},flushAllDeletedTextureObjects:function(e){for(var t=this._orphanedTextureObjects.length,i=this.getProfile().getSize(),a=0,n=t;a<n;++a)e.deleteTexture(this._orphanedTextureObjects[a].id()),this._orphanedTextureObjects[a].reset();this._orphanedTextureObjects.length=0,r.a.info("TextureManager: released "+t+" with "+t*i/1048576+" MB")},onLostContext:function(){var e,t;for(t=this._orphanedTextureObjects.length,e=0;e<t;++e)this._orphanedTextureObjects[e].reset();for(this._orphanedTextureObjects.length=0,t=this._usedTextureObjects.length,e=0;e<t;++e)this._usedTextureObjects[e].reset();this._usedTextureObjects.length=0}};var u=function(){this._textureSetMap={}};u.prototype={generateTextureObject:function(e,t,i,r,a,o){var u=n.getHash(i,r,a,o);return void 0===this._textureSetMap[u]&&(this._textureSetMap[u]=new s(new n(i,r,a,o))),this._textureSetMap[u].takeOrGenerate(e,t)},updateStats:function(e,t){var i=0,r=0;for(var a in this._textureSetMap){var n=this._textureSetMap[a].getProfile(),o=n.getSize(),s=this._textureSetMap[a].getUsedTextureObjects().length,u=this._textureSetMap[a].getOrphanedTextureObjects().length;i+=s*o,r+=u*o}var l=1048576;t.getCounter("textureused").set(i/l),t.getCounter("texturereserved").set(r/l),t.getCounter("texturetotal").set((i+r)/l)},reportStats:function(){var e=0;for(var t in this._textureSetMap){var i=this._textureSetMap[t].getProfile(),a=i.getSize()/1048576,n=this._textureSetMap[t].getUsedTextureObjects().length;a*=n,e+=a,r.a.notice(String(a)+" MB with "+n+" texture of "+i._width+"x"+i._height+" "+i._internalFormat)}r.a.notice(String(e)+" MB in total")},flushAllDeletedTextureObjects:function(e){for(var t in this._textureSetMap)this._textureSetMap[t].flushAllDeletedTextureObjects(e)},onLostContext:function(e){for(var t in this._textureSetMap)this._textureSetMap[t].onLostContext(e)},flushDeletedTextureObjects:function(e,t){var i=t;for(var r in this._textureSetMap)if((i=this._textureSetMap[r].flushDeletedTextureObjects(e,i))<=0)break;return i},releaseTextureObject:function(e){if(e){e.getTextureSet().orphan(e)}}},t.a=u},function(e,t,i){"use strict";var r=i(9),a=i(58),n=function(){a.a.call(this),this._attributeEnable=!1};r.a.createPrototypeStateAttribute(n,r.a.objectInherit(a.a.prototype,{attributeType:"Billboard",cloneType:function(){return new n},setEnabled:function(e){this._attributeEnable=e},isEnabled:function(){return this._attributeEnable},apply:function(){}}),"osg","Billboard"),t.a=n},function(e,t,i){"use strict";var r=i(9),a=i(58),n=i(10),o=function(e){a.a.call(this),this._constantColor=n.g.create(),n.g.set(this._constantColor,1,1,1,1),void 0!==e&&this.setConstantColor(e)};r.a.createPrototypeStateAttribute(o,r.a.objectInherit(a.a.prototype,{attributeType:"BlendColor",cloneType:function(){return new o},setConstantColor:function(e){n.g.copy(this._constantColor,e)},getConstantColor:function(){return this._constantColor},apply:function(e){e.getGraphicContext().blendColor(this._constantColor[0],this._constantColor[1],this._constantColor[2],this._constantColor[3])}}),"osg","BlendColor"),t.a=o},function(e,t,i){"use strict";var r=i(9),a=i(58),n=function(e,t,i,r){a.a.call(this),this._red=!0,this._green=!0,this._blue=!0,this._alpha=!0,void 0!==e&&void 0!==t&&void 0!==i&&this.setMask(e,t,i,r)};r.a.createPrototypeStateAttribute(n,r.a.objectInherit(a.a.prototype,{attributeType:"ColorMask",cloneType:function(){return new n},setMask:function(e,t,i,r){this._red=!!e,this._green=!!t,this._blue=!!i,this._alpha=!!r},apply:function(e){e.applyColorMask(this)}}),"osg","ColorMask"),t.a=n},function(e,t,i){"use strict";var r=i(9),a=i(21),n=i(71),o=i(1021),s=function(){n.a.call(this)};r.a.createPrototypeObject(s,r.a.objectInherit(n.a.prototype,{init:function(e){var t=new o.a;if(e.getParents().length>1&&a.a.warn("A RigGeometry should not have multi parent ( "+e.getName()+" )"),e.getParents()[0].accept(t),!t._root)return void a.a.warn("A RigGeometry did not find a parent skeleton for RigGeometry ( "+e.getName()+" )");e.setSkeleton(t._root),e.setPathToSkeleton(t._pathToRoot)},update:function(e){if(e&&"RigGeometry"!==e.className())return!0;var t=e;return t.getSkeleton()||0===t.getParents().length||this.init(t),!t.getSkeleton()||(t.getNeedToComputeMatrix()&&t.computeMatrixFromRootSkeleton(),t.update(),!0)}}),"osgAnimation","UpdateRigGeometry"),t.a=s},function(e,t,i){"use strict";var r=i(9),a=i(54),n=i(590),o=function(){a.a.call(this,a.a.TRAVERSE_PARENTS),this._root=void 0,this._pathToRoot=void 0};r.a.createPrototypeObject(o,r.a.objectInherit(a.a.prototype,{apply:function(e){if(!this._root)return e.typeID===n.a.typeID?(this._root=e,void(this._pathToRoot=this.nodePath.slice(1))):void this.traverse(e)}}),"osgAnimation","FindNearestParentSkeleton"),t.a=o},function(e,t,i){"use strict";var r=i(10),a=i(58),n=i(784),o=i(1023),s=function(){this._isInitialized=!1,this._bones=[]};s.prototype={computeBonePalette:function(e,t){var i=this._bones;for(var r in e){var a=t[r],n=e[r];void 0!==a&&(i[a]=n)}return i},init:function(e){var t=new o.a;e.getSkeleton().accept(t);var i=t.getBoneMap();this.computeBonePalette(i,e._boneNameID);var r=3*this._bones.length,s=this._skinningAttribute=new n.a;return s.setMatrixPalette(new Float32Array(4*r)),e.getStateSetAnimation().setAttributeAndModes(s,a.a.ON),this._isInitialized=!0,!0},computeMatrixPalette:function(){var e=r.c.create();return function(t,i){for(var a=this._bones,n=this._skinningAttribute.getMatrixPalette(),o=0,s=0,u=a.length;s<u;s++){var l=a[s],c=l.getInvBindMatrixInSkeletonSpace(),h=l.getMatrixInSkeletonSpace();r.c.mul(e,h,c),r.c.mul(e,i,e),r.c.mul(e,e,t),n[o++]=e[0],n[o++]=e[4],n[o++]=e[8],n[o++]=e[12],n[o++]=e[1],n[o++]=e[5],n[o++]=e[9],n[o++]=e[13],n[o++]=e[2],n[o++]=e[6],n[o++]=e[10],n[o++]=e[14]}}}(),update:function(e){this._isInitialized||this.init(e),this.computeMatrixPalette(e.getMatrixFromSkeletonToGeometry(),e.getInvMatrixFromSkeletonToGeometry())}},t.a=s},function(e,t,i){"use strict";var r=i(9),a=i(54),n=i(21),o=i(452),s=function(){a.a.call(this,a.a.TRAVERSE_ALL_CHILDREN),this._boneMap={}};r.a.createPrototypeObject(s,r.a.objectInherit(a.a.prototype,{apply:function(e){if(e.typeID===o.a.typeID){var t=e.getName();t?this._boneMap[t]=e:n.a.warn("found Bone without name")}this.traverse(e)},getBoneMap:function(){return this._boneMap}}),"osgAnimation","CollectBoneVisitor"),t.a=s},function(e,t,i){"use strict";var r=i(10),a=function(){this._radiusEquator=a.WGS_84_RADIUS_EQUATOR,this._radiusPolar=a.WGS_84_RADIUS_POLAR,this.computeCoefficients()};a.WGS_84_RADIUS_EQUATOR=6378137,a.WGS_84_RADIUS_POLAR=6356752.3142,a.prototype={setRadiusEquator:function(e){this._radiusEquator=e,this.computeCoefficients()},getRadiusEquator:function(){return this._radiusEquator},setRadiusPolar:function(e){this._radiusPolar=e,this.computeCoefficients()},getRadiusPolar:function(){return this._radiusPolar},convertLatLongHeightToXYZ:function(e,t,i,r){var a=Math.sin(e),n=Math.cos(e),o=this._radiusEquator/Math.sqrt(1-this._eccentricitySquared*a*a),s=(o+i)*n*Math.cos(t),u=(o+i)*n*Math.sin(t),l=(o*(1-this._eccentricitySquared)+i)*a;return r[0]=s,r[1]=u,r[2]=l,r},convertXYZToLatLongHeight:function(e,t,i,r){var a=Math.sqrt(e*e+t*t),n=Math.atan2(i*this._radiusEquator,a*this._radiusPolar),o=(this._radiusEquator*this._radiusEquator-this._radiusPolar*this._radiusPolar)/(this._radiusPolar*this._radiusPolar),s=Math.sin(n),u=Math.cos(n),l=Math.atan((i+o*this._radiusPolar*s*s*s)/(a-this._eccentricitySquared*this._radiusEquator*u*u*u)),c=Math.atan2(t,e),h=Math.sin(l),d=this._radiusEquator/Math.sqrt(1-this._eccentricitySquared*h*h),p=Math.cos(l);0===p&&(p=1);var f=a/p-d;return r[0]=l,r[1]=c,r[2]=f,r},computeLocalUpVector:function(e,t,i){var a,n,o=this.convertXYZToLatLongHeight(e,t,i,r.f.create());return a=o[0],n=o[1],[Math.cos(n)*Math.cos(a),Math.sin(n)*Math.cos(a),Math.sin(a)]},isWGS84:function(){return this._radiusEquator===a.WGS_84_RADIUS_EQUATOR&&this._radiusPolar===a.WGS_84_RADIUS_POLAR},computeCoefficients:function(){var e=(this._radiusEquator-this._radiusPolar)/this._radiusEquator;this._eccentricitySquared=2*e-e*e},computeLocalToWorldTransformFromLatLongHeight:function(e,t,i,a){var n=this.convertLatLongHeightToXYZ(e,t,i,a);return r.c.fromTranslation(a,n),this.computeCoordinateFrame(e,t,a),a},computeLocalToWorldTransformFromXYZ:function(e,t,i){var a=this.convertXYZToLatLongHeight(e,t,i,r.f.create()),n=r.c.fromTranslation(r.c.create(),r.f.fromValues(e,t,i));return this.computeCoordinateFrame(a[0],a[1],n),n},computeCoordinateFrame:function(){var e=r.f.create(),t=r.f.create(),i=r.f.create();return function(a,n,o){e[0]=Math.cos(n)*Math.cos(a),e[1]=Math.sin(n)*Math.cos(a),e[2]=Math.sin(a),t[0]=-Math.sin(n),t[1]=-Math.cos(n),r.f.cross(i,e,t),r.c.set(o,t[0],t[1],t[2],0,i[0],i[1],i[2],0,e[0],e[1],e[2],0,0,0,0,1)}}()},t.a=a},function(e,t,i){"use strict";var r=i(7),a=i.n(r),n=i(9),o=i(449),s=function(e){o.a.call(this,e),this._canPlayDefered=void 0};s.PAUSE=0,s.PLAYING=1,n.a.createPrototypeObject(s,n.a.objectInherit(o.a.prototype,{isDirty:function(){return this._status===s.PLAYING},setImage:function(e){o.a.prototype.setImage.call(this,e),this._status=s.STOP,e.addEventListener("ended",function(){this._imageObject.loop||this.stop()}.bind(this),!0),this.dirty()},setLooping:function(e){this._imageObject.loop=e},play:function(){this._imageObject.play(),this._status=s.PLAYING},stop:function(){this._imageObject.pause(),this._status=s.PAUSE},whenReady:function(){if(!this._imageObject)return a.a.reject();var e=this;return new a.a(function(t){e._canPlayDefered||(e._canPlayDefered=t,e._imageObject.readyState>3?e._canPlayDefered(e):e._imageObject.addEventListener("canplaythrough",e._canPlayDefered.bind(e._canPlayDefered,e),!0))})}}),"osg","ImageStream"),t.a=s},function(e,t,i){"use strict";var r=i(9),a=i(54),n=i(787),o=function(e){if(a.a.call(this),this._buildOptions={_numVerticesProcessed:0,_targetNumTrianglesPerLeaf:50,_maxNumLevels:20},e){var t=e._targetNumTrianglesPerLeaf,i=e._maxNumLevels;void 0!==t&&(this._buildOptions._targetNumTrianglesPerLeaf=t),void 0!==i&&(this._buildOptions._maxNumLevels=i)}};r.a.createPrototypeObject(o,r.a.objectInherit(a.a.prototype,{apply:function(e){if(e.getShape){if(void 0===e.getShape()){var t=new n.a;t.build(this._buildOptions,e)&&e.setShape(t)}}this.traverse(e)}}),"osg","KdTreeBuilder"),t.a=o},function(e,t,i){"use strict";var r=i(9),a=i(58),n=function(e){a.a.call(this),this.lineWidth=1,void 0!==e&&(this.lineWidth=e)};r.a.createPrototypeStateAttribute(n,r.a.objectInherit(a.a.prototype,{attributeType:"LineWidth",cloneType:function(){return new n},apply:function(e){e.getGraphicContext().lineWidth(this.lineWidth)}}),"osg","LineWidth"),t.a=n},function(e,t,i){"use strict";var r=i(9),a=i(58),n=i(72),o=function(e){a.a.call(this),this._enable=!e,this._pointSize=1,this._circleShape=!1,this._dirtyHash=!0,this._hash=""};r.a.createPrototypeStateAttribute(o,r.a.objectInherit(a.a.prototype,{attributeType:"PointSize",cloneType:function(){return new o(!0)},setCircleShape:function(e){this._circleShape=e,this._dirtyHash=!0},isCircleShape:function(){return this._circleShape},setEnabled:function(e){this._enable=e,this._dirtyHash=!0},isEnabled:function(){return this._enable},setPointSize:function(e){this._pointSize=e},getOrCreateUniforms:function(){var e=o;return e.uniforms?e.uniforms:(e.uniforms={pointSize:n.a.createFloat(1,"uPointSize")},e.uniforms)},getHash:function(){return this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!1,this._hash):this._hash},_computeInternalHash:function(){return this.getTypeMember()+(this.isEnabled()?"1":"0")+(this._circleShape?"1":"0")},apply:function(){if(this._enable){this.getOrCreateUniforms().pointSize.setFloat(this._pointSize)}}}),"osg","PointSizeAttribute"),t.a=o},function(e,t,i){"use strict";var r=i(10),a=i(99),n=i(183),o=i(185),s=[],u=[];s[a.a.POINTS]=function(){var e=r.f.create();return function(t,i,r,a,n){for(var o=t+i,s=t;s<o;++s){var u=3*r[s];e[0]=n[u],e[1]=n[u+1],e[2]=n[u+2],a.operatorPoint(e)}}}(),s[a.a.LINES]=function(){var e=r.f.create(),t=r.f.create();return function(i,r,a,n,o){for(var s=i+r,u=i;u<s-1;u+=2){var l=3*a[u];e[0]=o[l],e[1]=o[l+1],e[2]=o[l+2],l=3*a[u+1],t[0]=o[l],t[1]=o[l+1],t[2]=o[l+2],n.operatorLine(e,t)}}}(),s[a.a.LINE_STRIP]=function(){var e=r.f.create(),t=r.f.create();return function(i,r,a,n,o){for(var s=i+r,u=i;u<s-1;++u){var l=3*a[u];e[0]=o[l],e[1]=o[l+1],e[2]=o[l+2],l=3*a[u+1],t[0]=o[l],t[1]=o[l+1],t[2]=o[l+2],n.operatorLine(e,t)}}}(),s[a.a.LINE_LOOP]=function(){var e=r.f.create(),t=r.f.create();return function(i,r,a,n,o){for(var s=i+r-1,u=i;u<s;++u){var l=3*a[u];e[0]=o[l],e[1]=o[l+1],e[2]=o[l+2],l=3*a[u+1],t[0]=o[l],t[1]=o[l+1],t[2]=o[l+2],n.operatorLine(e,t)}s=3*a[s],e[0]=o[s],e[1]=o[s+1],e[2]=o[s+2];var c=3*a[0];t[0]=o[c],t[1]=o[c+1],t[2]=o[c+2],n.operatorLine(e,t)}}(),s[a.a.TRIANGLES]=function(){var e=r.f.create(),t=r.f.create(),i=r.f.create();return function(r,a,n,o,s){for(var u=r+a,l=r;l<u;l+=3){var c=3*n[l];e[0]=s[c],e[1]=s[c+1],e[2]=s[c+2],c=3*n[l+1],t[0]=s[c],t[1]=s[c+1],t[2]=s[c+2],c=3*n[l+2],i[0]=s[c],i[1]=s[c+1],i[2]=s[c+2],o.operatorTriangle(e,t,i)}}}(),s[a.a.TRIANGLE_STRIP]=function(){var e=r.f.create(),t=r.f.create(),i=r.f.create();return function(r,a,n,o,s){for(var u=2,l=r;u<a;++u,++l){var c=3*n[l];e[0]=s[c],e[1]=s[c+1],e[2]=s[c+2],c=3*n[l+1],t[0]=s[c],t[1]=s[c+1],t[2]=s[c+2],c=3*n[l+2],i[0]=s[c],i[1]=s[c+1],i[2]=s[c+2],u%2?o.operatorTriangle(e,i,t):o.operatorTriangle(e,t,i)}}}(),s[a.a.TRIANGLE_FAN]=function(){var e=r.f.create(),t=r.f.create(),i=r.f.create();return function(r,a,n,o,s){for(var u=n[r],l=2,c=r+1;l<a;++l,++c){e[0]=s[u],e[1]=s[u+1],e[2]=s[u+2];var h=3*n[c];t[0]=s[h],t[1]=s[h+1],t[2]=s[h+2],h=3*n[c+1],i[0]=s[h],i[1]=s[h+1],i[2]=s[h+2],o.operatorTriangle(e,t,i)}}}(),u[a.a.POINTS]=function(){var e=r.f.create();return function(t,i,r,a){for(var n=t;n<t+i;++n){var o=3*n;e[0]=a[o],e[1]=a[o+1],e[2]=a[o+2],r.operatorPoint(e)}}}(),u[a.a.LINES]=function(){var e=r.f.create(),t=r.f.create();return function(i,r,a,n){for(var o=i;o<i+r-1;o+=2){var s=3*o;e[0]=n[s],e[1]=n[s+1],e[2]=n[s+2],s=3*(o+1),t[0]=n[s],t[1]=n[s+1],t[2]=n[s+2],a.operatorLine(e,t)}}}(),u[a.a.LINE_STRIP]=function(){var e=r.f.create(),t=r.f.create();return function(i,r,a,n){for(var o=i;o<i+r-1;++o){var s=3*o;e[0]=n[s],e[1]=n[s+1],e[2]=n[s+2],s=3*(o+1),t[0]=n[s],t[1]=n[s+1],t[2]=n[s+2],a.operatorLine(e,t)}}}(),u[a.a.LINE_LOOP]=function(){var e=r.f.create(),t=r.f.create();return function(i,r,a,n){for(var o=i+r-1,s=i;s<o;++s){var u=3*s;e[0]=n[u],e[1]=n[u+1],e[2]=n[u+2],u=3*(s+1),t[0]=n[u],t[1]=n[u+1],t[2]=n[u+2],a.operatorLine(e,t)}o*=3,e[0]=n[o],e[1]=n[o+1],e[2]=n[o+2],i*=3,t[0]=n[i],t[1]=n[i+1],t[2]=n[i+2],a.operatorLine(e,t)}}(),u[a.a.TRIANGLES]=function(){var e=r.f.create(),t=r.f.create(),i=r.f.create();return function(r,a,n,o){for(var s=r;s<r+a;s+=3){var u=3*s;e[0]=o[u],e[1]=o[u+1],e[2]=o[u+2],u=3*(s+1),t[0]=o[u],t[1]=o[u+1],t[2]=o[u+2],u=3*(s+2),i[0]=o[u],i[1]=o[u+1],i[2]=o[u+2],n.operatorTriangle(e,t,i)}}}(),u[a.a.TRIANGLE_STRIP]=function(){var e=r.f.create(),t=r.f.create(),i=r.f.create();return function(r,a,n,o){for(var s=2,u=r;s<a;++s,++u){var l=3*u;e[0]=o[l],e[1]=o[l+1],e[2]=o[l+2],l=3*(u+1),t[0]=o[l],t[1]=o[l+1],t[2]=o[l+2],l=3*(u+2),i[0]=o[l],i[1]=o[l+1],i[2]=o[l+2],s%2?n.operatorTriangle(e,i,t):n.operatorTriangle(e,t,i)}}}(),u[a.a.TRIANGLE_FAN]=function(){var e=r.f.create(),t=r.f.create(),i=r.f.create();return function(r,a,n,o){for(var s=2,u=r+1;s<a;++s,++u){e[0]=o[r],e[1]=o[r+1],e[2]=o[r+2];var l=3*u;t[0]=o[l],t[1]=o[l+1],t[2]=o[l+2],l=3*(u+1),i[0]=o[l],i[1]=o[l+1],i[2]=o[l+2],n.operatorTriangle(e,t,i)}}}();var l=function(e,t,i){var r=e.getPrimitiveSetList();if(r)for(var a,l=r.length,c=0;c<l;c++){var h=r[c];if(h instanceof n.a){if(a=s[h.getMode()]){var d=h.indices.getElements();a(h.getFirst()/d.BYTES_PER_ELEMENT,h.getCount(),d,t,i)}}else h instanceof o.a&&(a=u[h.getMode()])&&a(h.getFirst(),h.getCount(),t,i)}};t.a=l},function(e,t){e.exports="#define PI 3.141593\n#define saturate(_x) clamp(_x, 0., 1.)\n"},function(e,t){e.exports="// approximation such as http://chilliant.blogspot.fr/2012/08/srgb-approximations-for-hlsl.html\n// introduced slightly darker colors and more slight banding in the darks.\n\n// so we stick with the reference implementation (except we don't check if color >= 0.0):\n// https://www.khronos.org/registry/gles/extensions/EXT/EXT_sRGB.txt\n#define LIN_SRGB(x) x < 0.0031308 ? x * 12.92 : 1.055 * pow(x, 1.0/2.4) - 0.055\n#define SRGB_LIN(x) x < 0.04045 ? x * (1.0 / 12.92) : pow((x + 0.055) * (1.0 / 1.055), 2.4)\n\n#pragma DECLARE_FUNCTION\nfloat linearTosRGB(const in float color) { return LIN_SRGB(color); }\n\n#pragma DECLARE_FUNCTION\nvec3 linearTosRGB(const in vec3 color) { return vec3(LIN_SRGB(color.r), LIN_SRGB(color.g), LIN_SRGB(color.b)); }\n\n#pragma DECLARE_FUNCTION\nvec4 linearTosRGB(const in vec4 color) { return vec4(LIN_SRGB(color.r), LIN_SRGB(color.g), LIN_SRGB(color.b), color.a); }\n\n#pragma DECLARE_FUNCTION NODE_NAME:sRGBToLinear\nfloat sRGBToLinear(const in float color) { return SRGB_LIN(color); }\n\n#pragma DECLARE_FUNCTION NODE_NAME:sRGBToLinear\nvec3 sRGBToLinear(const in vec3 color) { return vec3(SRGB_LIN(color.r), SRGB_LIN(color.g), SRGB_LIN(color.b)); }\n\n#pragma DECLARE_FUNCTION NODE_NAME:sRGBToLinear\nvec4 sRGBToLinear(const in vec4 color) { return vec4(SRGB_LIN(color.r), SRGB_LIN(color.g), SRGB_LIN(color.b), color.a); }\n\n//http://graphicrants.blogspot.fr/2009/04/rgbm-color-encoding.html\nvec3 RGBMToRGB( const in vec4 rgba ) {\n    const float maxRange = 8.0;\n    return rgba.rgb * maxRange * rgba.a;\n}\n\nconst mat3 LUVInverse = mat3( 6.0013, -2.700, -1.7995, -1.332, 3.1029, -5.7720, 0.3007, -1.088, 5.6268 );\n\nvec3 LUVToRGB( const in vec4 vLogLuv ) {\n    float Le = vLogLuv.z * 255.0 + vLogLuv.w;\n    vec3 Xp_Y_XYZp;\n    Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n    Xp_Y_XYZp.z = Xp_Y_XYZp.y / vLogLuv.y;\n    Xp_Y_XYZp.x = vLogLuv.x * Xp_Y_XYZp.z;\n    vec3 vRGB = LUVInverse * Xp_Y_XYZp;\n    return max(vRGB, 0.0);\n}\n\n// http://graphicrants.blogspot.fr/2009/04/rgbm-color-encoding.html\n#pragma DECLARE_FUNCTION\nvec4 encodeRGBM(const in vec3 color, const in float range) {\n    if(range <= 0.0) return vec4(color, 1.0);\n    vec4 rgbm;\n    vec3 col = color / range;\n    rgbm.a = clamp( max( max( col.r, col.g ), max( col.b, 1e-6 ) ), 0.0, 1.0 );\n    rgbm.a = ceil( rgbm.a * 255.0 ) / 255.0;\n    rgbm.rgb = col / rgbm.a;\n    return rgbm;\n}\n\n#pragma DECLARE_FUNCTION\nvec3 decodeRGBM(const in vec4 color, const in float range) {\n    if(range <= 0.0) return color.rgb;\n    return range * color.rgb * color.a;\n}\n\n// https://twitter.com/pyalot/status/711956736639418369\n// https://github.com/mrdoob/three.js/issues/10331\n#pragma DECLARE_FUNCTION NODE_NAME:FrontNormal\n#define _frontNormal(normal) gl_FrontFacing ? normal : -normal\n\n#pragma DECLARE_FUNCTION NODE_NAME:Normalize\n#define _normalize(vec) normalize(vec)\n\n#pragma DECLARE_FUNCTION\nvec4 preMultAlpha(const in vec3 color, const in float alpha) { return vec4(color.rgb * alpha, alpha); }\n\n#pragma DECLARE_FUNCTION\nvec4 preMultAlpha(const in vec4 color) { return vec4(color.rgb * color.a, color.a); }\n\n#pragma DECLARE_FUNCTION\nvec4 setAlpha(const in vec3 color, const in float alpha) { return vec4(color, alpha); }\n\n#pragma DECLARE_FUNCTION\nvec4 setAlpha(const in vec3 color, const in vec4 alpha) { return vec4(color, alpha.a); }\n"},function(e,t){e.exports="float getLightAttenuation(const in float dist, const in vec4 lightAttenuation) {\n    // lightAttenuation(constantEnabled, linearEnabled, quadraticEnabled)\n    // TODO find a vector alu instead of 4 scalar\n    float constant = lightAttenuation.x;\n    float linear = lightAttenuation.y * dist;\n    float quadratic = lightAttenuation.z * dist * dist;\n    return 1.0 / (constant + linear + quadratic);\n}\n\n#pragma DECLARE_FUNCTION\nvoid precomputeSpot(\n        const in vec3 normal,\n        const in vec3 viewVertex,\n                          \n        const in vec3 lightViewDirection,\n        const in vec4 lightAttenuation,\n        const in vec3 lightViewPosition,\n        const in float lightSpotCutOff,\n        const in float lightSpotBlend,\n                          \n        out float attenuation,\n        out vec3 eyeLightDir,\n        out float dotNL) {\n\n    eyeLightDir = lightViewPosition - viewVertex;\n    float dist = length(eyeLightDir);\n    eyeLightDir = dist > 0.0 ? eyeLightDir / dist : vec3( 0.0, 1.0, 0.0 );\n\n    float cosCurAngle = dot(-eyeLightDir, lightViewDirection);\n    float spot = cosCurAngle * smoothstep(0.0, 1.0, (cosCurAngle - lightSpotCutOff) / lightSpotBlend);\n\n    dotNL = dot(eyeLightDir, normal);\n    attenuation = spot * getLightAttenuation(dist, lightAttenuation);\n}\n\n#pragma DECLARE_FUNCTION\nvoid precomputePoint(\n        const in vec3 normal,\n        const in vec3 viewVertex,\n\n        const in vec4 lightAttenuation,\n        const in vec3 lightViewPosition,\n\n        out float attenuation,\n        out vec3 eyeLightDir,\n        out float dotNL) {\n\n    eyeLightDir = lightViewPosition - viewVertex;\n    float dist = length(eyeLightDir);\n\n    attenuation = getLightAttenuation(dist, lightAttenuation);\n    eyeLightDir = dist > 0.0 ? eyeLightDir / dist :  vec3( 0.0, 1.0, 0.0 );\n    dotNL = dot(eyeLightDir, normal);\n}\n\n#pragma DECLARE_FUNCTION\nvoid precomputeSun(\n        const in vec3 normal,\n        const in vec3 lightViewDirection,\n  \n        out float attenuation,\n        out vec3 eyeLightDir,\n        out float dotNL) {\n\n    attenuation = 1.0;\n    eyeLightDir = -lightViewDirection;\n    dotNL = dot(eyeLightDir, normal);\n}"},function(e,t){e.exports='#pragma include "lightCommon.glsl"\n\n////////////////\n// COOK TORRANCE\n////////////////\nvec3 specularCookTorrance(\n        const in vec3 normal,\n        const in vec3 lightDir,\n        const in vec3 eyeVector,\n        const in float materialShininess,\n        const in vec3 materialSpecular,\n        const in vec3 lightSpecular) {\n  \n    vec3 h = normalize(eyeVector + lightDir);\n    float nh = dot(normal, h);\n    float specfac = 0.0;\n\n    if(nh > 0.0) {\n        float nv = max( dot(normal, eyeVector), 0.0 );\n        float i = pow(nh, materialShininess);\n        i = i / (0.1 + nv);\n        specfac = i;\n    }\n    // ugly way to fake an energy conservation (mainly to avoid super bright stuffs with low glossiness)\n    float att = materialShininess > 100.0 ? 1.0 : smoothstep(0.0, 1.0, materialShininess * 0.01);\n    return specfac * materialSpecular * lightSpecular * att;\n}\n\nvec3 lambert(const in float dotNL,  const in vec3 materialDiffuse, const in vec3 lightDiffuse) {\n    return dotNL * materialDiffuse * lightDiffuse;\n}\n\n#pragma DECLARE_FUNCTION\nvoid computeLightLambertCookTorrance(\n        const in vec3 normal,\n        const in vec3 eyeVector,\n        const in float dotNL,\n        const in float attenuation,\n\n        const in vec3 materialDiffuse,\n        const in vec3 materialSpecular,\n        const in float materialShininess,\n\n        const in vec3 lightDiffuse,\n        const in vec3 lightSpecular,\n        const in vec3 eyeLightDir,\n\n        out vec3 diffuseOut,\n        out vec3 specularOut,\n        out bool lighted) {\n\n    lighted = dotNL > 0.0;\n    if (lighted == false) {\n        specularOut = diffuseOut = vec3(0.0);\n        return;\n    }\n\n    specularOut = attenuation * specularCookTorrance(normal, eyeLightDir, eyeVector, materialShininess, materialSpecular, lightSpecular);\n    diffuseOut = attenuation * lambert(dotNL, materialDiffuse, lightDiffuse);\n}\n\n///////\n// HEMI\n///////\n#pragma DECLARE_FUNCTION\nvoid hemiLight(\n        const in vec3 normal,\n        const in vec3 eyeVector,\n        const in float dotNL,\n        const in float eyeLightDir,\n\n        const in vec3 materialDiffuse,\n        const in vec3 materialSpecular,\n        const in float materialShininess,\n\n        const in vec3 lightDiffuse,\n        const in vec3 lightGround,\n\n        out vec3 diffuseOut,\n        out vec3 specularOut,\n        out bool lighted) {\n\n    lighted = false;\n    float weight = 0.5 * dotNL + 0.5;\n    diffuseOut = materialDiffuse * mix(lightGround, lightDiffuse, weight);\n\n    // same cook-torrance as above for sky/ground\n    float skyWeight = 0.5 * dot(normal, normalize(eyeVector + eyeLightDir)) + 0.5;\n    float gndWeight = 0.5 * dot(normal, normalize(eyeVector - eyeLightDir)) + 0.5;\n    float skySpec = pow(skyWeight, materialShininess);\n    float skyGround = pow(gndWeight, materialShininess);\n    float divisor = (0.1 + max( dot(normal, eyeVector), 0.0 ));\n    float att = materialShininess > 100.0 ? 1.0 : smoothstep(0.0, 1.0, materialShininess * 0.01);\n    \n    specularOut = lightDiffuse * materialSpecular * weight * att * (skySpec + skyGround) / divisor;\n}\n'},function(e,t){e.exports="//////////////////////////////\n// OPTIMIZED VERSION (NO IF)\n//////////////////////////////\n#pragma DECLARE_FUNCTION\nmat4 skinning( const in vec4 weights, const in vec4 bonesIndex ) {\n    mat4 outMat_1;\n    mat4 tmpMat_2;\n    highp ivec4 tmpvar_3;\n    tmpvar_3 = (3 * ivec4(bonesIndex));\n    tmpMat_2 = mat4(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0);\n    vec4 tmpvar_4;\n    tmpvar_4 = -(abs(weights));\n    tmpMat_2[0] = uBones[tmpvar_3.x];\n    tmpMat_2[1] = uBones[(tmpvar_3.x + 1)];\n    tmpMat_2[2] = uBones[(tmpvar_3.x + 2)];\n    outMat_1 = ((float(\n    ((tmpvar_4.x + tmpvar_4.y) >= -((tmpvar_4.z + tmpvar_4.w)))\n    ) * mat4(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0)) + (weights.x * tmpMat_2));\n    tmpMat_2[0] = uBones[tmpvar_3.y];\n    tmpMat_2[1] = uBones[(tmpvar_3.y + 1)];\n    tmpMat_2[2] = uBones[(tmpvar_3.y + 2)];\n    outMat_1 = (outMat_1 + (weights.y * tmpMat_2));\n    tmpMat_2[0] = uBones[tmpvar_3.z];\n    tmpMat_2[1] = uBones[(tmpvar_3.z + 1)];\n    tmpMat_2[2] = uBones[(tmpvar_3.z + 2)];\n    outMat_1 = (outMat_1 + (weights.z * tmpMat_2));\n    tmpMat_2[0] = uBones[tmpvar_3.w];\n    tmpMat_2[1] = uBones[(tmpvar_3.w + 1)];\n    tmpMat_2[2] = uBones[(tmpvar_3.w + 2)];\n    outMat_1 = (outMat_1 + (weights.w * tmpMat_2));\n\n    return outMat_1;\n}\n\n//////////////////////////////\n// UN-OPTIMIZED VERSION (WITH IF)\n//////////////////////////////\n\n// //http://http.developer.nvidia.com/GPUGems/gpugems_ch04.html\n// mat4 getMat4FromVec4( const int index, inout mat4 myMat ) {\n//     // We have to use a global variable because we can't access dynamically\n//     // matrix is transpose so we should do vec * matrix\n//     myMat[0] = uBones[ index ];\n//     myMat[1] = uBones[ index + 1];\n//     myMat[2] = uBones[ index + 2];\n//     return myMat;\n// }\n\n// mat4 skinning( const in vec4 weights, const in vec4 bonesIndex ) {\n//     ivec4 idx =  3 * ivec4(bonesIndex);\n//     mat4 tmpMat = mat4(1.0);\n//     mat4 outMat = mat4(0.0);\n\n//     // we handle negative weights\n//     if(all(equal(weights, vec4(0.0)))) return tmpMat;\n\n//     if(weights.x != 0.0) outMat += weights.x * getMat4FromVec4( idx.x, tmpMat );\n//     if(weights.y != 0.0) outMat += weights.y * getMat4FromVec4( idx.y, tmpMat );\n//     if(weights.z != 0.0) outMat += weights.z * getMat4FromVec4( idx.z, tmpMat );\n//     if(weights.w != 0.0) outMat += weights.w * getMat4FromVec4( idx.w, tmpMat );\n//     return outMat;\n// }\n\n//////////////////////////////\n// UN-OPTIMIZED VERSION (NO IF)\n//////////////////////////////\n\n// mat4 skinning( const in vec4 weights, const in vec4 bonesIndex ) {\n//     ivec4 idx =  3 * ivec4(bonesIndex);\n//     mat4 tmpMat = mat4(1.0);\n\n//     // if sum is 0, return identity\n//     vec4 absWeights = -abs(weights);\n//     mat4 outMat = step(0.0, absWeights.x + absWeights.y + absWeights.z + absWeights.w) * tmpMat;\n\n//     // we handle negative weights\n//     // outMat[3][3] += weights.x + weights.y + weights.z + weights.w;\n\n//     tmpMat[0] = uBones[ idx.x ];\n//     tmpMat[1] = uBones[ idx.x + 1];\n//     tmpMat[2] = uBones[ idx.x + 2];\n//     outMat += weights.x * tmpMat;\n\n//     tmpMat[0] = uBones[ idx.y ];\n//     tmpMat[1] = uBones[ idx.y + 1];\n//     tmpMat[2] = uBones[ idx.y + 2];\n//     outMat += weights.y * tmpMat;\n\n//     tmpMat[0] = uBones[ idx.z ];\n//     tmpMat[1] = uBones[ idx.z + 1];\n//     tmpMat[2] = uBones[ idx.z + 2];\n//     outMat += weights.z * tmpMat;\n\n//     tmpMat[0] = uBones[ idx.w ];\n//     tmpMat[1] = uBones[ idx.w + 1];\n//     tmpMat[2] = uBones[ idx.w + 2];\n//     outMat += weights.w * tmpMat;\n\n//     return outMat;\n// }\n"},function(e,t){e.exports="#pragma DECLARE_FUNCTION\nvec3 morphing(\n        const in vec4 weights,\n        const in vec3 vertex,\n        const in vec3 target0) {\n\n    return mix(vertex, target0, weights[0]);\n}\n\n#pragma DECLARE_FUNCTION\nvec3 morphing(\n        const in vec4 weights,\n        const in vec3 vertex,\n        const in vec3 target0,\n        const in vec3 target1) {\n\n    vec3 vecOut = vertex * (1.0 - ( weights[0] + weights[1]));\n    vecOut += target0 * weights[0];\n    vecOut += target1 * weights[1];\n    return vecOut;\n}\n\n#pragma DECLARE_FUNCTION\nvec3 morphing(\n        const in vec4 weights,\n        const in vec3 vertex,\n        const in vec3 target0,\n        const in vec3 target1,\n        const in vec3 target2) {\n  \n    vec3 vecOut = vertex * (1.0 - ( weights[0] + weights[1] + weights[2]));\n    vecOut += target0 * weights[0];\n    vecOut += target1 * weights[1];\n    vecOut += target2 * weights[2];\n    return vecOut;\n}\n\n#pragma DECLARE_FUNCTION\nvec3 morphing(\n        const in vec4 weights,\n        const in vec3 vertex,\n        const in vec3 target0,\n        const in vec3 target1,\n        const in vec3 target2,\n        const in vec3 target3) {\n\n    vec3 vecOut = vertex * (1.0 - ( weights[0] + weights[1] + weights[2] + weights[3]));\n    vecOut += target0 * weights[0];\n    vecOut += target1 * weights[1];\n    vecOut += target2 * weights[2];\n    vecOut += target3 * weights[3];\n    return vecOut;\n}\n"},function(e,t){e.exports="#pragma DECLARE_FUNCTION\nvec3 textureRGB(const in sampler2D tex, const in vec2 uv) {\n    return texture2D(tex, uv.xy).rgb;\n}\n\n#pragma DECLARE_FUNCTION\nvec4 textureRGBA(const in sampler2D tex, const in vec2 uv) {\n    return texture2D(tex, uv.xy).rgba;\n}\n\n#pragma DECLARE_FUNCTION\nfloat textureIntensity(const in sampler2D tex, const in vec2 uv) {\n    return texture2D(tex, uv).r;\n}\n\n#pragma DECLARE_FUNCTION\nfloat textureAlpha(const in sampler2D tex, const in vec2 uv) {\n    return texture2D(tex, uv.xy).a;\n}\n"},function(e,t){e.exports="\nfloat decodeFloatRGBA( vec4 rgba ) {\n    return dot( rgba, vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/16581375.0) );\n}\n\nvec4 encodeFloatRGBA( float v ) {\n    vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * v;\n    enc = fract(enc);\n    enc -= enc.yzww * vec4(1.0/255.0,1.0/255.0,1.0/255.0,0.0);\n    return enc;\n}\n\nvec2 decodeHalfFloatRGBA( vec4 rgba ) {\n    return vec2(rgba.x + (rgba.y / 255.0), rgba.z + (rgba.w / 255.0));\n}\n\nvec4 encodeHalfFloatRGBA( vec2 v ) {\n    const vec2 bias = vec2(1.0 / 255.0, 0.0);\n    vec4 enc;\n    enc.xy = vec2(v.x, fract(v.x * 255.0));\n    enc.xy = enc.xy - (enc.yy * bias);\n\n    enc.zw = vec2(v.y, fract(v.y * 255.0));\n    enc.zw = enc.zw - (enc.ww * bias);\n    return enc;\n}\n"},function(e,t){e.exports="vec3 getScale( const in mat4 matrix ) {\n      // Only working with positive scales.\n      float xs = matrix[0][0] * matrix[0][1] * matrix[0][2] * matrix[0][3] < 0. ? -1. : 1.;\n      float ys = matrix[1][0] * matrix[1][1] * matrix[1][2] * matrix[1][3] < 0. ? -1. : 1.;\n      float zs = matrix[2][0] * matrix[2][1] * matrix[2][2] * matrix[2][3] < 0. ? -1. : 1.;\n      vec3 scale;\n      scale.x = xs * sqrt( matrix[0][0] * matrix[0][0] + matrix[0][1] * matrix[0][1] + matrix[0][2] * matrix[0][2]);\n      scale.y = ys * sqrt( matrix[1][0] * matrix[1][0] + matrix[1][1] * matrix[1][1] + matrix[1][2] * matrix[1][2]);\n      scale.z = zs * sqrt( matrix[2][0] * matrix[2][0] + matrix[2][1] * matrix[2][1] + matrix[2][2] * matrix[2][2]);\n      return scale;\n}\n\n#pragma DECLARE_FUNCTION\nvec4 billboard( const in vec3 vertex, const in mat4 modelViewMatrix, const in mat4 projectionMatrix ) {\n      vec3 scale = getScale( modelViewMatrix );\n      return projectionMatrix * ( vec4( scale.x* vertex.x , scale.y * vertex.y, scale.z * vertex.z, 1.0 ) + vec4( modelViewMatrix[ 3 ].xyz, 0.0 ) );\n}\n"},function(e,t){e.exports='#pragma include "colorEncode.glsl"\n\n#pragma DECLARE_FUNCTION\nvec4 shadowCast(const in vec4 fragEye, const in vec2 shadowDepthRange){\n    // distance to camera (we make sure we are near 0 and in [0,1])\n    float depth = (-fragEye.z * fragEye.w - shadowDepthRange.x) / (shadowDepthRange.y - shadowDepthRange.x);\n\n#ifdef _FLOATTEX\n    return vec4(depth, 0.0, 0.0, 1.0);\n#else\n    return encodeFloatRGBA(depth);\n#endif\n}\n'},function(e,t){e.exports="#ifdef _OUT_DISTANCE\n#define OPT_ARG_outDistance ,out float outDistance\n#define OPT_INSTANCE_ARG_outDistance ,outDistance\n#else\n#define OPT_ARG_outDistance\n#define OPT_INSTANCE_ARG_outDistance\n#endif\n\n#ifdef _ATLAS_SHADOW\n#define OPT_ARG_atlasSize ,const in vec4 atlasSize\n#else\n#define OPT_ARG_atlasSize\n#endif\n\n#ifdef _NORMAL_OFFSET\n#define OPT_ARG_normalBias ,const in float normalBias\n#else\n#define OPT_ARG_normalBias\n#endif\n\n#ifdef _JITTER_OFFSET\n#define OPT_ARG_jitter ,const in float jitter\n#define OPT_INSTANCE_ARG_jitter ,jitter\n#else\n#define OPT_ARG_jitter\n#define OPT_INSTANCE_ARG_jitter\n#endif\n\n#pragma include \"tapPCF.glsl\"\n\n#pragma DECLARE_FUNCTION DERIVATIVES:enable\nfloat shadowReceive(const in bool lighted,\n                    const in vec3 normalWorld,\n                    const in vec3 vertexWorld,\n\n                    const in sampler2D shadowTexture,\n\n                    const in vec2 shadowSize,\n                    const in vec3 shadowProjection,\n\n                    const in vec4 shadowViewRight,\n                    const in vec4 shadowViewUp,\n                    const in vec4 shadowViewLook,\n\n\n                    const in vec2 shadowDepthRange,\n                    const in float shadowBias\n                    OPT_ARG_atlasSize\n                    OPT_ARG_normalBias\n                    OPT_ARG_outDistance\n                    OPT_ARG_jitter) {\n\n    // 0 for early out\n    bool earlyOut = false;\n\n    // Calculate shadow amount\n    float shadow = 1.0;\n\n    if (!lighted) {\n        shadow = 0.0;\n#ifndef _OUT_DISTANCE\n        earlyOut = true;\n#endif // _OUT_DISTANCE\n    }\n\n    if (shadowDepthRange.x == shadowDepthRange.y) {\n        earlyOut = true;\n    }\n\n    vec4 shadowVertexEye;\n    vec4 shadowNormalEye;\n    float shadowReceiverZ = 0.0;\n    vec4 shadowVertexProjected;\n    vec2 shadowUV;\n    float N_Dot_L;\n    float invDepthRange;\n\n    if (!earlyOut) {\n\n        shadowVertexEye.x = dot(shadowViewRight.xyz, vertexWorld.xyz) + shadowViewRight.w;\n        shadowVertexEye.y = dot(shadowViewUp.xyz, vertexWorld.xyz) + shadowViewUp.w;\n        shadowVertexEye.z = dot(shadowViewLook.xyz, vertexWorld.xyz) + shadowViewLook.w;\n        shadowVertexEye.w = 1.0;\n\n\n        // derivated, only need z.\n        //vec3 shadowLightDir = vec3(0.0, 0.0, 1.0); // in shadow view light is camera\n        //shadowNormalEye =  shadowViewMatrix * normalFront;\n        //shadowNormalEye.x = dot(shadowViewRight.xyz, normalWorld.xyz);\n        //shadowNormalEye.y = dot(shadowViewUp.xyz, normalWorld.xyz);\n        shadowNormalEye.z = dot(shadowViewLook.xyz, normalWorld.xyz);\n        //shadowNormalEye.w = 0.0;\n\n        //N_Dot_L = dot(shadowNormalEye.xyz, shadowLightDir);\n        N_Dot_L = shadowNormalEye.z;\n\n        if (!earlyOut) {\n\n            invDepthRange = 1.0 / (shadowDepthRange.y - shadowDepthRange.x);\n\n#ifdef _NORMAL_OFFSET\n\n            // http://www.dissidentlogic.com/old/images/NormalOffsetShadows/GDC_Poster_NormalOffset.png\n            float normalOffsetScale = clamp(1.0  - N_Dot_L, 0.0 , 1.0);\n            normalOffsetScale *= abs((shadowVertexEye.z - shadowDepthRange.x) * invDepthRange);\n            normalOffsetScale *= max(shadowProjection.x, shadowProjection.y);\n            normalOffsetScale *= normalBias * invDepthRange;\n\n\n            vec4 shadowNormalShift =  vec4(normalWorld, 0.0) * normalOffsetScale;\n            shadowNormalEye.x = dot(shadowViewRight.xyz, shadowNormalShift.xyz);\n            shadowNormalEye.y = dot(shadowViewUp.xyz, shadowNormalShift.xyz);\n            shadowNormalEye.z = dot(shadowViewLook.xyz, shadowNormalShift.xyz);\n            shadowNormalEye.w = 0.0;\n\n            vec4 viewShadow = shadowVertexEye + shadowNormalEye;\n#else\n            vec4 viewShadow = shadowVertexEye;\n#endif\n\n\n            if (shadowProjection.z == 0.0){\n\n               // X, 0, 0, 0,\n               // 0, Y, 0, 0,\n               // 0, 0, -1, -1,\n               // 0, 0, -2.0*znear, 0\n               // mat4 shadowProjectionMatrix;\n               // shadowProjectionMatrix[0] = vec4(shadowProjection.x, 0.0, 0.0, 0.0 );\n               // shadowProjectionMatrix[1] = vec4(0.0, shadowProjection.y, 0.0, 0.0 );\n               // shadowProjectionMatrix[2] = vec4(0.0, 0.0, -1.0, -1.0 );\n               // shadowProjectionMatrix[3] = vec4(0.0, 0.0, -2.0*shadowDepthRange.x, 0.0 );\n               // shadowVertexProjected = shadowProjectionMatrix * shadowVertexEye;\n\n               // derivated optimisation\n               shadowVertexProjected.x = shadowProjection.x * viewShadow.x;\n               shadowVertexProjected.y = shadowProjection.y * viewShadow.y;\n\n               shadowVertexProjected.z = - viewShadow.z - (2.0 * shadowDepthRange.x * viewShadow.w);\n               shadowVertexProjected.w = - viewShadow.z;\n\n            }\n            else{\n                // lr = 1/(left-right);\n                // bt = 1/(bottom-top);\n                // nf = 1/(near-far);\n                // -2*lr,           0,               0,              0,\n                // 0,               -2*bt,           0,              0,\n                // 0,               0,               2*nf,           0.0,\n                // (left+right)*lr, (top+bottom)*bt, (far+near)*nf), 1\n                // here left = -right && top = -bottom\n                // float lr = 1.0 / (-2.0 * shadowProjection.x);\n                // float bt = 1.0 / (-2.0 * shadowProjection.y);\n                // float nf = 1.0 / (shadowDepthRange.x - shadowDepthRange.y);\n                float nfNeg = 1.0 / (shadowDepthRange.x - shadowDepthRange.y);\n                float nfPos = (shadowDepthRange.x + shadowDepthRange.y)*nfNeg;\n\n                //mat4 shadowProjectionMatrix;\n                //shadowProjectionMatrix[0] = vec4(1.0 / shadowProjection.x, 0.0,     0.0,  0.0 );\n                //shadowProjectionMatrix[1] = vec4(0.0,     1.0 / shadowProjection.y, 0.0,  0.0 );\n                //shadowProjectionMatrix[2] = vec4(0.0,     0.0, 2.0*nfNeg, 0.0 );\n                //shadowProjectionMatrix[3] = vec4(0.0,     0.0, nfPos, 1.0 );\n                //shadowdertexProjected = shadowProjectionMatrix * shadowVertexEye;\n\n                // derivated optimisation\n                shadowVertexProjected.x = viewShadow.x / shadowProjection.x;\n                shadowVertexProjected.y = viewShadow.y / shadowProjection.y;\n\n                shadowVertexProjected.z = 2.0 * nfNeg* viewShadow.z + nfPos * viewShadow.w;\n                shadowVertexProjected.w = viewShadow.w;\n\n            }\n\n\n            if (shadowVertexProjected.w < 0.0) {\n                earlyOut = true; // notably behind camera\n            }\n\n        }\n\n        if (!earlyOut) {\n\n            shadowUV.xy = shadowVertexProjected.xy / shadowVertexProjected.w;\n            shadowUV.xy = shadowUV.xy * 0.5 + 0.5;// mad like\n\n            if (any(bvec4 ( shadowUV.x > 1., shadowUV.x < 0., shadowUV.y > 1., shadowUV.y < 0.))) {\n                earlyOut = true;// limits of light frustum\n            }\n\n            // most precision near 0, make sure we are near 0 and in [0,1]\n            shadowReceiverZ = - shadowVertexEye.z;\n            shadowReceiverZ =  (shadowReceiverZ - shadowDepthRange.x) * invDepthRange;\n\n            if(shadowReceiverZ < 0.0) {\n                earlyOut = true; // notably behind camera\n            }\n\n        }\n    }\n\n    // pcf pbias to add on offset\n    vec2 shadowBiasPCF = vec2 (0.);\n\n#ifdef GL_OES_standard_derivatives\n#ifdef _RECEIVERPLANEDEPTHBIAS\n    vec2 biasUV;\n\n    vec3 texCoordDY = dFdx(shadowVertexEye.xyz);\n    vec3 texCoordDX = dFdy(shadowVertexEye.xyz);\n\n    biasUV.x = texCoordDY.y * texCoordDX.z - texCoordDX.y * texCoordDY.z;\n    biasUV.y = texCoordDX.x * texCoordDY.z - texCoordDY.x * texCoordDX.z;\n    biasUV *= 1.0 / ((texCoordDX.x * texCoordDY.y) - (texCoordDX.y * texCoordDY.x));\n\n    // Static depth biasing to make up for incorrect fractional sampling on the shadow map grid\n    float fractionalSamplingError = dot(vec2(1.0, 1.0) * shadowSize.xy, abs(biasUV));\n    float receiverDepthBias = min(fractionalSamplingError, 0.01);\n\n    shadowBiasPCF.x = biasUV.x;\n    shadowBiasPCF.y = biasUV.y;\n\n    shadowReceiverZ += receiverDepthBias;\n\n#else // _RECEIVERPLANEDEPTHBIAS\n    shadowBiasPCF.x = clamp(dFdx(shadowReceiverZ) * shadowSize.x, -1.0, 1.0 );\n    shadowBiasPCF.y = clamp(dFdy(shadowReceiverZ) * shadowSize.y, -1.0, 1.0 );\n#endif\n\n#endif // GL_OES_standard_derivatives\n\n\n    vec4 clampDimension;\n\n#ifdef _ATLAS_SHADOW\n    shadowUV.xy  = ((shadowUV.xy * atlasSize.zw ) + atlasSize.xy) * shadowSize.xy;\n\n    // clamp uv bias/filters by half pixel to avoid point filter on border\n    clampDimension.xy = atlasSize.xy + vec2(0.5);\n    clampDimension.zw = (atlasSize.xy + atlasSize.zw) - vec2(0.5);\n\n    clampDimension = clampDimension * shadowSize.xyxy;\n#else\n    clampDimension = vec4(0.0, 0.0, 1.0, 1.0);\n#endif // _RECEIVERPLANEDEPTHBIAS\n\n\n    // now that derivatives is done and we don't access any mipmapped/texgrad texture we can early out\n    // see http://teknicool.tumblr.com/post/77263472964/glsl-dynamic-branching-and-texture-samplers\n    if (earlyOut) {\n        // empty statement because of weird gpu intel bug\n    } else {\n\n        // depth bias: fighting shadow acne (depth imprecsion z-fighting)\n        // cosTheta is dot( n, l ), clamped between 0 and 1\n        // float shadowBias = 0.005*tan(acos(N_Dot_L));\n        // same but 4 cycles instead of 15\n        float depthBias = 0.05 * sqrt( 1.0 - N_Dot_L * N_Dot_L) / clamp(N_Dot_L, 0.0005, 1.0);\n\n        // That makes sure that plane perpendicular to light doesn't flicker due to\n        // selfshadowing and 1 = dot(Normal, Light) using a min bias\n        depthBias = clamp(depthBias, 0.00005, 2.0 * shadowBias);\n\n        // shadowZ must be clamped to [0,1]\n        // otherwise it's not comparable to shadow caster depth map\n        // which is clamped to [0,1]\n        // Not doing that makes ALL shadowReceiver > 1.0 black\n        // because they ALL becomes behind any point in Caster depth map\n        shadowReceiverZ = clamp(shadowReceiverZ, 0.0, 1.0 -depthBias) - depthBias;\n\n        // Now computes Shadow\n        float res = getShadowPCF(shadowTexture,\n                                 shadowSize,\n                                 shadowUV,\n                                 shadowReceiverZ,\n                                 shadowBiasPCF,\n                                 clampDimension\n                                 OPT_INSTANCE_ARG_outDistance\n                                 OPT_INSTANCE_ARG_jitter);\n#ifdef _OUT_DISTANCE\n        if (lighted) shadow = res;\n        outDistance *= shadowDepthRange.y - shadowDepthRange.x; // world space distance\n#else\n        shadow = res;\n#endif  // _OUT_DISTANCE\n    }\n\n    return shadow;\n\n}\n"},function(e,t){e.exports='#pragma include "floatFromTex.glsl"\n#pragma include "rand.glsl"\n\n// simulation of texture2Dshadow glsl call on HW\n// http://codeflow.org/entries/2013/feb/15/soft-shadow-mapping/\nfloat texture2DCompare(const in sampler2D depths,\n                       const in vec2 uv,\n                       const in float compare,\n                       const in vec4 clampDimension){\n    float depth = getSingleFloatFromTex(depths, clamp(uv, clampDimension.xy, clampDimension.zw));\n    return compare - depth;\n}\n\n#ifdef _JITTER_OFFSET\n// TODO could be in a random.glsl file\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Private/Random.ush#L27\nfloat shadowInterleavedGradientNoise(const in vec2 fragCoord, const in float frameMod) {\n    vec3 magic = vec3(0.06711056, 0.00583715, 52.9829189);\n    return fract(magic.z * fract(dot(fragCoord.xy + frameMod * vec2(47.0, 17.0) * 0.695, magic.xy)));\n}\n#endif\n\n// simulates linear fetch like texture2d shadow\nfloat texture2DShadowLerp(\n    const in sampler2D depths,\n    const in vec2 size,\n    const in vec2 uv,\n    const in float compare,\n    const in vec4 clampDimension\n    OPT_ARG_outDistance\n    OPT_ARG_jitter){\n\n    vec2 centroidCoord = uv / size.xy;\n\n#ifdef _JITTER_OFFSET\n    if (jitter > 0.0){\n        centroidCoord += shadowInterleavedGradientNoise(gl_FragCoord.xy, jitter);\n    }\n#endif\n\n    centroidCoord = centroidCoord + 0.5;\n    vec2 f = fract(centroidCoord);\n    vec2 centroidUV = floor(centroidCoord) * size.xy;\n\n    vec4 fetches;\n    const vec2 shift  = vec2(1.0, 0.0);\n    fetches.x = texture2DCompare(depths, centroidUV + size.xy * shift.yy, compare, clampDimension);\n    fetches.y = texture2DCompare(depths, centroidUV + size.xy * shift.yx, compare, clampDimension);\n    fetches.z = texture2DCompare(depths, centroidUV + size.xy * shift.xy, compare, clampDimension);\n    fetches.w = texture2DCompare(depths, centroidUV + size.xy * shift.xx, compare, clampDimension);\n\n\n\n#ifdef _OUT_DISTANCE\n    float _a = mix(fetches.x, fetches.y, f.y);\n    float _b = mix(fetches.z, fetches.w, f.y);\n    outDistance = mix(_a, _b, f.x);\n#endif\n\n    vec4 st = step(fetches, vec4(0.0));\n\n    float a = mix(st.x, st.y, f.y);\n    float b = mix(st.z, st.w, f.y);\n    return mix(a, b, f.x);\n}\n'},function(e,t){e.exports='#pragma include "colorEncode.glsl"\n\n// end Float codec\nfloat getSingleFloatFromTex(const in sampler2D depths, const in vec2 uv){\n#ifndef _FLOATTEX\n    return  decodeFloatRGBA(texture2D(depths, uv));\n#else\n    return texture2D(depths, uv).x;\n#endif\n}\n\nvec2 getDoubleFloatFromTex(const in sampler2D depths, const in vec2 uv){\n#ifndef _FLOATTEX\n    return decodeHalfFloatRGBA(texture2D(depths, uv));\n#else\n    return texture2D(depths, uv).xy;\n#endif\n}\n\nvec4 getQuadFloatFromTex(const in sampler2D depths, const in vec2 uv){\n    return texture2D(depths, uv).xyzw;\n}\n// end Float codec\n'},function(e,t){e.exports='#pragma include "shadowLinearSoft.glsl"\n\nfloat getShadowPCF(\n    const in sampler2D depths,\n    const in vec2 size,\n    const in vec2 uv,\n    const in float compare,\n    const in vec2 biasPCF,\n    const in vec4 clampDimension\n    OPT_ARG_outDistance\n    OPT_ARG_jitter) {\n\n     float res = 0.0;\n\n     res += texture2DShadowLerp(depths, size, uv + biasPCF, compare, clampDimension OPT_INSTANCE_ARG_outDistance OPT_INSTANCE_ARG_jitter);\n\n\n#if defined(_PCFx1)\n\n#else\n\n    float dx0 = -size.x;\n    float dy0 = -size.y;\n    float dx1 = size.x;\n    float dy1 = size.y;\n\n#define TSF(o1,o2) texture2DShadowLerp(depths, size, uv + vec2(o1, o2) + biasPCF, compare, clampDimension OPT_INSTANCE_ARG_outDistance OPT_INSTANCE_ARG_jitter)\n\n    res += TSF(dx0, dx0);\n    res += TSF(dx0, .0);\n    res += TSF(dx0, dx1);\n\n#if defined(_PCFx4)\n\n    res /=4.0;\n\n#elif defined(_PCFx9)\n    res += TSF(.0, dx0);\n    res += TSF(.0, dx1);\n\n    res += TSF(dx1, dx0);\n    res += TSF(dx1, .0);\n    res += TSF(dx1, dx1);\n\n\n    res /=9.0;\n\n#elif defined(_PCFx25)\n\n    float dx02 = 2.0*dx0;\n    float dy02 = 2.0*dy0;\n    float dx2 = 2.0*dx1;\n    float dy2 = 2.0*dy1;\n\n    // complete row above\n    res += TSF(dx0, dx02);\n    res += TSF(dx0, dx2);\n\n    res += TSF(.0, dx02);\n    res += TSF(.0, dx2);\n\n    res += TSF(dx1, dx02);\n    res += TSF(dx1, dx2);\n\n    // two new col\n    res += TSF(dx02, dx02);\n    res += TSF(dx02, dx0);\n    res += TSF(dx02, .0);\n    res += TSF(dx02, dx1);\n    res += TSF(dx02, dx2);\n\n    res += TSF(dx2, dx02);\n    res += TSF(dx2, dx0);\n    res += TSF(dx2, .0);\n    res += TSF(dx2, dx1);\n    res += TSF(dx2, dx2);\n\n\n    res/=25.0;\n\n#endif\n\n#undef TSF\n\n#endif\n    return res;\n}\n/////// end Tap\n'},function(e,t,i){"use strict";var r=i(249),a=i(247),n=i(450),o=function(){return{buffer:{separate:!1,enable:!1,sourceFactor:a.a.ONE,destinationFactor:a.a.ZERO,sourceFactorAlpha:a.a.ONE,destinationFactorAlpha:a.a.ZERO},state:{separate:void 0,enable:!1,sourceFactor:void 0,destinationFactor:void 0,sourceFactorAlpha:void 0,destinationFactorAlpha:void 0},changed:!0}},s=function(){return{buffer:{func:r.a.LESS,enable:!1,near:0,far:1},state:{func:void 0,enable:!1,near:void 0,far:void 0},changed:!0}},u=function(){return{buffer:{enable:!1,mode:n.a.BACK},state:{enable:!1,mode:void 0},changed:!0}},l=function(){return{buffer:{enable:!1,x:0,y:0,width:640,height:480},state:{enable:!1,x:void 0,y:void 0,width:void 0,height:void 0},changed:!0}},c=function(){return{buffer:{red:!0,green:!0,blue:!0,alpha:!0},state:{red:void 0,green:void 0,blue:void 0,alpha:void 0},changed:!0}},h=function(){return{buffer:{x:0,y:0,width:640,height:480},state:{x:void 0,y:void 0,width:void 0,height:void 0},changed:!0}},d=function(){return{state:{value:!0},buffer:{value:void 0},changed:!0}},p=function(){return{buffer:{value:1},state:{value:void 0},changed:!0}},f=function(){return{buffer:{red:0,green:0,blue:0,alpha:0},state:{red:void 0,green:void 0,blue:void 0,alpha:void 0},changed:!0}},m=function(){this._stateClearColor=f(),this._stateClearDepth=p(),this._stateDepthMask=d(),this._stateViewport=h(),this._stateColorMask=c(),this._stateScissor=l(),this._stateDepth=s(),this._stateCullFace=u(),this._stateBlendFunc=o()};m.prototype={clearColor:function(e){var t=this._stateClearColor,i=t.buffer,r=t.state;t.changed=!1,i.red=e[0],i.green=e[1],i.blue=e[2],i.alpha=e[3],r.red===e[0]&&r.green===e[1]&&r.blue===e[2]&&r.alpha===e[3]||(t.changed=!0)},applyClearColor:function(e){var t=this._stateClearColor,i=t.state,r=t.buffer;t.changed=!1,i.red=r.red,i.green=r.green,i.blue=r.blue,i.alpha=r.alpha,e.clearColor(i.red,i.green,i.blue,i.alpha)},clearDepth:function(e){var t=this._stateClearDepth,i=t.buffer,r=t.state;t.changed=!1,i.value=e,r.value!==e&&(t.changed=!0)},applyClearDepth:function(e){var t=this._stateClearDepth,i=t.buffer,r=t.state;t.changed=!1,r.value=i.value,e.clearDepth(r.value)},depthMask:function(e){var t=this._stateDepthMask,i=t.buffer,r=t.state;t.changed=!1,i.value=e,r.value!==e&&(t.changed=!0)},applyDepthMask:function(e){var t=this._stateDepthMask,i=t.buffer,r=t.state;t.changed=!1,r.value=i.value,e.depthMask(r.value)},applyViewportAttribute:function(e){this.viewport(e._x,e._y,e._width,e._height)},viewport:function(e,t,i,r){var a=this._stateViewport,n=a.buffer,o=a.state;a.changed=!1,n.x=e,n.y=t,n.width=i,n.height=r,o.x===e&&o.y===t&&o.width===i&&o.height===r||(a.changed=!0)},applyViewport:function(e){var t=this._stateViewport,i=t.buffer,r=t.state;t.changed=!1,r.x=i.x,r.y=i.y,r.width=i.width,r.height=i.height,e.viewport(r.x,r.y,r.width,r.height)},applyColorMaskAttribute:function(e){var t=this._stateColorMask,i=t.buffer,r=t.state;t.changed=!1,i.red=e._red,i.green=e._green,i.blue=e._blue,i.alpha=e._alpha,r.red===e._red&&r.green===e._green&&r.blue===e._blue&&r.alpha===e._alpha||(t.changed=!0)},applyColorMask:function(e){var t=this._stateColorMask,i=t.buffer,r=t.state;t.changed=!1,r.red=i.red,r.green=i.green,r.blue=i.blue,r.alpha=i.alpha,e.colorMask(r.red,r.green,r.blue,r.alpha)},applyScissorAttribute:function(e){var t=-1!==e._x,i=this._stateScissor,r=i.buffer,a=i.state;i.changed=!1,r.enable=t,r.x=e._x,r.y=e._y,r.width=e._width,r.height=e._height,a.enable===t&&a.x===e._x&&a.y===e._y&&a.width===e._width&&a.height===e._height||(i.changed=!0)},applyScissor:function(e){var t=this._stateScissor,i=t.buffer,r=t.state;t.changed=!1,r.enable!==i.enable&&(r.enable=i.enable,r.enable?e.enable(e.SCISSOR_TEST):e.disable(e.SCISSOR_TEST)),r.enable&&(r.x===i.x&&r.y===i.y&&r.width===i.width&&r.height===i.height||(r.x=i.x,r.y=i.y,r.width=i.width,r.height=i.height,e.scissor(r.x,r.y,r.width,r.height)))},applyCullFaceAttribute:function(e){var t=this._stateCullFace,i=t.buffer,r=t.state,a=e._mode!==n.a.DISABLE;t.changed=!1,i.enable=a,i.mode=e._mode,r.enable===a&&r.mode===e._mode||(t.changed=!0)},applyCullFace:function(e){var t=this._stateCullFace,i=t.buffer,r=t.state;t.changed=!1,r.enable!==i.enable&&(r.enable=i.enable,r.enable?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE)),r.enable&&r.mode!==i.mode&&(r.mode=i.mode,e.cullFace(r.mode))},applyDepthAttribute:function(e){var t=e._func!==r.a.DISABLE,i=this._stateDepth,a=i.buffer,n=i.state;i.changed=!1,a.enable=t,a.func=e._func,a.far=e._far,a.near=e._near,n.enable===t&&n.func===e._func&&n.near===e._near&&n.far===e._far||(i.changed=!0),this.depthMask(e._writeMask)},applyDepth:function(e){var t=this._stateDepth,i=t.buffer,r=t.state;t.changed=!1,r.enable!==i.enable&&(r.enable=i.enable,r.enable?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST)),r.enable&&(r.func!==i.func&&(r.func=i.func,e.depthFunc(r.func)),r.near===i.near&&r.far===i.far||(r.far=i.far,r.near=i.near,e.depthRange(r.near,r.far)))},applyBlendFuncAttribute:function(e){var t=this._stateBlendFunc,i=t.buffer,r=t.state,n=e._sourceFactor!==a.a.DISABLE&&e._destinationFactor!==a.a.DISABLE;t.changed=!1,i.enable=n,i.separate=e._separate,i.sourceFactor=e._sourceFactor,i.destinationFactor=e._destinationFactor,i.sourceFactorAlpha=e._sourceFactorAlpha,i.destinationFactorAlpha=e._destinationFactorAlpha,r.enable===n&&r.sourceFactor===e._sourceFactor&&r.destinationFactor===e._destinationFactor&&r.sourceFactorAlpha===e._sourceFactorAlpha&&r.destinationFactorAlpha===e._destinationFactorAlpha||(t.changed=!0)},applyBlendFunc:function(e){var t=this._stateBlendFunc,i=t.buffer,r=t.state;t.changed=!1,r.enable!==i.enable&&(r.enable=i.enable,r.enable?e.enable(e.BLEND):e.disable(e.BLEND)),r.enable&&(r.separate=i.separate,r.separate?r.sourceFactor===i.sourceFactor&&r.destinationFactor===i.destinationFactor&&r.sourceFactorAlpha===i.sourceFactorAlpha&&r.destinationFactorAlpha===i.destinationFactorAlpha||(r.sourceFactor=i.sourceFactor,r.destinationFactor=i.destinationFactor,r.sourceFactorAlpha=i.sourceFactorAlpha,r.destinationFactorAlpha=i.destinationFactorAlpha,e.blendFuncSeparate(r.sourceFactor,r.destinationFactor,r.sourceFactorAlpha,r.destinationFactorAlpha)):r.sourceFactor===i.sourceFactor&&r.destinationFactor===i.destinationFactor||(r.sourceFactor=i.sourceFactor,r.destinationFactor=i.destinationFactor,e.blendFunc(r.sourceFactor,r.destinationFactor)))},applyClearStates:function(e){this._stateDepthMask.changed&&this.applyDepthMask(e),this._stateScissor.changed&&this.applyScissor(e),this._stateClearColor.changed&&this.applyClearColor(e),this._stateClearDepth.changed&&this.applyClearDepth(e),this._stateColorMask.changed&&this.applyColorMask(e)},applyDrawStates:function(e){this._stateViewport.changed&&this.applyViewport(e),this._stateScissor.changed&&this.applyScissor(e),this._stateDepth.changed&&this.applyDepth(e),this._stateDepthMask.changed&&this.applyDepthMask(e),this._stateCullFace.changed&&this.applyCullFace(e),this._stateBlendFunc.changed&&this.applyBlendFunc(e),this._stateColorMask.changed&&this.applyColorMask(e)},clear:function(e,t){this.applyClearStates(e),e.clear(t)},drawGeometry:function(e){this.applyDrawStates(e)}},t.a=m},function(e,t,i){"use strict";var r=i(9),a=i(449),n=i(21),o=i(84),s=function(){o.default.call(this),this._images={};for(var e=0;e<6;e++)this._images[o.default.TEXTURE_CUBE_MAP_POSITIVE_X+e]=new a.a};r.a.createPrototypeStateAttribute(s,r.a.objectInherit(o.default.prototype,{setDefaultParameters:function(){o.default.prototype.setDefaultParameters.call(this),this._textureTarget=o.default.TEXTURE_CUBE_MAP,this._flipY=!1},invalidate:function(){o.default.prototype.invalidate.call(this);for(var e=o.default.TEXTURE_CUBE_MAP_POSITIVE_X;e<o.default.TEXTURE_CUBE_MAP_POSITIVE_X+6;e++){var t=this._images[e];this._images[o.default.TEXTURE_CUBE_MAP_POSITIVE_X].getImage()&&t.dirty()}this.dirty()},cloneType:function(){return new s},setImage:function(e,t,i){var r=e;"string"==typeof r&&(r=o.default[r]),this._images[r].setImage(t,i),this.setImageFormat(i),this.setTextureSize(this._images[r].getWidth(),this._images[r].getHeight()),this._textureNull=!1,this.dirty()},getImage:function(e){return this._images[e].getImage()},initCubemapContent:function(e){var t=this._internalFormat;return this.applyTexImage2D(e,e.TEXTURE_CUBE_MAP_POSITIVE_X,0,t,this._textureWidth,this._textureHeight,0,t,this._type,null),this.applyTexImage2D(e,e.TEXTURE_CUBE_MAP_NEGATIVE_X,0,t,this._textureWidth,this._textureHeight,0,t,this._type,null),this.applyTexImage2D(e,e.TEXTURE_CUBE_MAP_POSITIVE_Y,0,t,this._textureWidth,this._textureHeight,0,t,this._type,null),this.applyTexImage2D(e,e.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,t,this._textureWidth,this._textureHeight,0,t,this._type,null),this.applyTexImage2D(e,e.TEXTURE_CUBE_MAP_POSITIVE_Z,0,t,this._textureWidth,this._textureHeight,0,t,this._type,null),this.applyTexImage2D(e,e.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,t,this._textureWidth,this._textureHeight,0,t,this._type,null),!0},generateMipmap:function(e,t){if(this.hasMipmapFilter()){if(this._images[o.default.TEXTURE_CUBE_MAP_POSITIVE_X].hasMipmap())for(var i=0;i<6;i++){var r=this._images[o.default.TEXTURE_CUBE_MAP_POSITIVE_X+i];r.hasMipmap()||n.a.error("mipmap not set correctly for TextureCubemap");for(var a=this._internalFormat,s=1;s<r.getMipmap().length;s++){var u=r.getMipmap()[s].getWidth();this.applyTexImage2D(e,e.TEXTURE_CUBE_MAP_POSITIVE_X+i,s,a,u,u,0,a,this._type,r.getMipmap()[s].getImage())}}else e.generateMipmap(t);this._dirtyMipmap=!1}},applyImageTarget:function(e,t,i){var r=this._images[i];return r.getImage()&&r.isReady()?r.isDirty()?(this.setTextureSize(r.getWidth(),r.getHeight()),r.setDirty(!1),r.isTypedArray()?this.applyTexImage2D(e,i,0,t,this._textureWidth,this._textureHeight,0,t,this._type,r.getImage()):this.applyTexImage2D(e,i,0,t,t,this._type,r.getImage()),!this._unrefImageDataAfterApply||this.hasMipmap()&&r.hasMipmap()||r.release(),1):1:0},initCubemapContentImage:function(e){var t=this._internalFormat,i=0;return i+=this.applyImageTarget(e,t,e.TEXTURE_CUBE_MAP_POSITIVE_X),i+=this.applyImageTarget(e,t,e.TEXTURE_CUBE_MAP_NEGATIVE_X),i+=this.applyImageTarget(e,t,e.TEXTURE_CUBE_MAP_POSITIVE_Y),i+=this.applyImageTarget(e,t,e.TEXTURE_CUBE_MAP_NEGATIVE_Y),i+=this.applyImageTarget(e,t,e.TEXTURE_CUBE_MAP_POSITIVE_Z),6===(i+=this.applyImageTarget(e,t,e.TEXTURE_CUBE_MAP_NEGATIVE_Z))},apply:function(e){var t=e.getGraphicContext();if(this._dirtyTextureObject&&(this.releaseGLObjects(),this.setGraphicContext(t)),void 0===this._textureObject||this.isDirty())if(this._textureNull)t.bindTexture(this._textureTarget,null);else{this._textureObject||(this.computeTextureFormat(),this.init(e)),this._textureObject.bind(t);var i;i=this._images[o.default.TEXTURE_CUBE_MAP_POSITIVE_X].getImage()?this.initCubemapContentImage(t):this.initCubemapContent(t),i&&(this._dirty=!1,this.applyFilterParameter(t,this._textureTarget),this.generateMipmap(t,this._textureTarget))}else this._textureObject.bind(t),this.isDirtyMipmap()&&this.generateMipmap(t,this._textureTarget)}}),"osg","TextureCubeMap"),t.a=s},function(e,t,i){"use strict";var r=i(99),a=i(183),n=i(185),o=function(){},s=o.functorDrawElements=[],u=o.functorDrawArrays=[];s[r.a.TRIANGLES]=function(e,t,i,r){for(var a=e+t,n=e;n<a;n+=3)r(i[n],i[n+1],i[n+2])},s[r.a.TRIANGLE_STRIP]=function(e,t,i,r){for(var a=2,n=e;a<t;++a,++n)a%2?r(i[n],i[n+2],i[n+1]):r(i[n],i[n+1],i[n+2])},s[r.a.TRIANGLE_FAN]=function(e,t,i,r){for(var a=i[e],n=2,o=e+1;n<t;++n,++o)r(a,i[o],i[o+1])},u[r.a.TRIANGLES]=function(e,t,i){for(var r=2,a=e;r<t;r+=3,a+=3)i(a,a+1,a+2)},u[r.a.TRIANGLE_STRIP]=function(e,t,i){for(var r=2,a=e;r<t;++r,++a)r%2?i(a,a+2,a+1):i(a,a+1,a+2)},u[r.a.TRIANGLE_FAN]=function(e,t,i){for(var r=2,a=e+1;r<t;++r,++a)i(e,a,a+1)},o.prototype={init:function(e,t){this._geom=e,this._cb=t},apply:function(){var e=this._geom,t=e.getPrimitiveSetList();if(t)for(var i,r=this._cb,o=t.length,l=0;l<o;l++){var c=t[l];if(c instanceof a.a){if(i=s[c.getMode()]){var h=c.indices.getElements();i(c.getFirst()/h.BYTES_PER_ELEMENT,c.getCount(),h,r)}}else c instanceof n.a&&(i=u[c.getMode()])&&i(c.getFirst(),c.getCount(),r)}}},t.a=o},function(e,t,i){"use strict";var r=i(9),a=i(593),n=i(784),o=i(547),s=i(796),u=i(452),l=i(454),c=i(798),h=i(1048),d=i(797),p=i(783),f=i(398),m=i(453),g=i(590),_=i(799),v=i(800),b=i(1049),y=i(683),x=i(801),S=i(680),M=i(591),w=i(594),T=i(782),C={};r.a.objectMix(C,h.a),r.a.objectMix(C,d.a),C.Animation=a.a,C.SkinningAttribute=n.a,C.AnimationUpdateCallback=o.a,C.BasicAnimationManager=s.a,C.Bone=u.a,C.Channel=l.a,C.CollectAnimationUpdateCallbackVisitor=c.a,C.MorphAttribute=p.a,C.MorphGeometry=f.a,C.RigGeometry=m.a,C.Skeleton=g.a,C.StackedMatrix=_.a,C.StackedQuaternion=v.a,C.StackedRotateAxis=b.a,C.StackedScale=y.a,C.StackedTranslate=x.a,C.UpdateBone=S.a,C.UpdateMatrixTransform=M.a,C.UpdateMorph=w.a,C.UpdateSkeleton=T.a,t.a=C},function(e,t,i){"use strict";var r=function(e){return-e*(e-2)},a=function(e){return e*e},n=function(e){return(e-=1)*e*e+1},o=function(e){return e*e*e},s=function(e){return-((e-=1)*e*e*e-1)},u=function(e){return e*e*e*e},l=function(e){return Math.pow(2,-10*e)*Math.sin((e-.075)*(2*Math.PI)/.3)+1},c=function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375};t.a={easeOutQuad:r,easeInQuad:a,easeOutCubic:n,easeInCubic:o,easeOutQuart:s,easeInQuart:u,easeOutElastic:l,easeOutBounce:c,EaseOutQuad:r,EaseInQuad:a,EaseOutCubic:n,EaseInCubic:o,EaseOutQuart:s,EaseInQuart:u,EaseOutElastic:l,EaseOutBounce:c}},function(e,t,i){"use strict";var r=i(9),a=i(71),n=i(10),o=i(400),s=function(e,t,i){a.a.call(this),this._axis=n.f.fromValues(0,0,1),t&&n.f.copy(this._axis,t),this._target=o.a.createFloatTarget("number"==typeof i?i:0),e&&this.setName(e)};r.a.createPrototypeObject(s,r.a.objectInherit(a.a.prototype,{init:function(e,t){this.setAxis(e),this.setAngle(t),this._target.defaultValue=t},setAxis:function(e){n.f.copy(this._axis,e)},setAngle:function(e){this._target.value=e},getTarget:function(){return this._target},resetToDefaultValue:function(){this.setAngle(this._target.defaultValue)},applyToMatrix:function(){var e=n.c.create(),t=n.d.create();return function(i){var r=this._axis,a=t,o=e,s=this._target.value;n.d.setAxisAngle(a,r,s),n.c.fromQuat(o,a),n.c.mul(i,i,o)}}()}),"osgAnimation","StackedRotateAxis"),t.a=s},function(e,t,i){"use strict";var r=i(9),a=i(684),n=i(418),o=i(803),s=i(596),u=i(804),l=i(805),c=i(549),h=i(595),d=i(802),p=i(685),f=i.n(p),m={};m.Input=a.default,r.a.objectMix(m,n.default),m.DatabasePager=o.a,m.ObjectWrapper.serializers.osg=s.a,m.ObjectWrapper.serializers.osgAnimation=u.a,m.ObjectWrapper.serializers.osgText=l.a,m.Registry=c.a,m.fileHelper=h.a,m.requestFile=d.a,r.a.objectMix(m,f.a),t.a=m},function(e,t,i){"use strict";var r={prefixURL:"",databasePath:"",progressXHRCallback:void 0,readNodeURL:void 0,readImageURL:void 0,readBinaryArrayURL:void 0,imageLoadingUsePromise:!0,imageOnload:void 0,imageCrossOrigin:void 0};t.a=r},function(e,t,i){"use strict";var r=i(686),a=i.n(r),n=i(1053),o=i(810),s=i(812),u=i(1054),l=i(688),c=i(813),h=i(815),d=i(814),p=i(597),f=i(816),m=i(817),g=i(818),_=i(601),v=i(687),b=i(819),y=i(1055),x=i(811),S=i(250),M={};a.a.NO_MOUSEEVENTS=!0,M.CADManipulator=n.a,M.getCADManipulatorStandardMouseKeyboardController=function(){return o.a},M.getCADManipulatorHammerController=function(){return s.a},M.FirstPersonManipulator=u.a,M.getFirstPersonDeviceOrientationController=function(){return l.a},M.getFirstPersonManipulatorHammerController=function(){return c.a},M.getFirstPersonStandardMouseKeyboardControllerClass=function(){return h.a},M.getFirstPersonWebVRControllerClass=function(){return d.a},M.Manipulator=p.a,M.OrbitManipulator=f.a,M.getOrbitManipulatorDeviceOrientationController=function(){return m.a},M.getOrbitManipulatorGamePadController=function(){return g.a},M.getOrbitManipulatorHammerController=function(){return _.a},M.getOrbitManipulatorStandardMouseKeyboardController=function(){return v.a},M.getOrbitManipulatorWebVRController=function(){return b.a},M.SwitchManipulator=y.a,M.OrbitManipulator.Rotate=x.a.ROTATE,M.OrbitManipulator.Pan=x.a.PAN,M.OrbitManipulator.Zoom=x.a.ZOOM,M.Controller=S.a,t.a=M},function(e,t,i){"use strict";var r=i(9),a=i(597),n=i(550),o=i(551),s=i(808),u=i(543),l=i(10),c=i(810),h=i(812),d=i(602),p=i(599),f=i(78),m=function(e){a.a.call(this,e),this._tmpHomePosition=l.f.create(),this._intersectionVisitor=new n.a,this._lineSegmentIntersector=new o.a,this._polytopeIntersector=void 0,this._usePolytopeIntersector=!1,this._primitiveMask=p.a.ALL_PRIMITIVES,this.init()};m.Interpolator=function(){this._current=l.e.create(),this._target=l.e.create(),this._delta=l.e.create(),this._reset=!1,this.reset(),this._width=void 0,this._height=void 0},m.Interpolator.prototype={setWidth:function(e){this._width=e},setHeight:function(e){this._height=e},reset:function(){for(var e=0,t=this._current.length;e<t;e++)this._current[e]=this._target[e]=0;this._reset=!0},update:function(){var e,t;return e=void 0===this._width?0:(this._target[0]-this._current[0])/this._width,this._delta[0]=e,this._current[0]=this._target[0],t=void 0===this._height?0:(this._target[1]-this._current[1])/this._height,this._delta[1]=t,this._current[1]=this._target[1],this._delta},set:function(){for(var e=0,t=this._current.length;e<t;e++)this._current[e]=this._target[e]=arguments[e];this._reset=!1},isReset:function(){return this._reset},getCurrent:function(){return this._current},setTarget:function(){for(var e=0,t=this._target.length;e<t;e++)this._reset?this._target[e]=this._current[e]=arguments[e]:this._target[e]=arguments[e];this._reset=!1},addTarget:function(){for(var e=0;e<arguments.length;e++)this._target[e]+=arguments[e]},getTarget:function(){return this._target},getDelta:function(){return this._delta}},m.AvailableControllerList=["StandardMouseKeyboard","Hammer"],m.ControllerList=["StandardMouseKeyboard","Hammer"],r.a.createPrototypeObject(m,r.a.objectInherit(a.a.prototype,{init:function(){this._distance=25,this._target=l.f.create(),this._upz=l.f.fromValues(0,0,1),this._right=l.f.fromValues(1,0,0),l.f.init(this._target);var e=l.c.fromRotation(l.c.create(),-Math.PI,this._upz),t=l.c.fromRotation(l.c.create(),Math.PI/10,this._right);this._rotation=l.c.create(),l.c.mul(this._rotation,e,t),this._time=0,this._rotate=new m.Interpolator,this._pan=new m.Interpolator,this._zoom=new d.a(1),this._panFactor=1.5,this._rotateFactor=1,this._zoomFactor=1,this._inverseMatrix=l.c.create(),this._homeEye=void 0,this._homeCenter=void 0,this._homeUp=l.f.fromValues(0,0,1),this._orientation=l.d.create(),this._pivotPoint=l.f.create(),this._eye=void 0,this._zoomDir=l.f.create();var i=this;m.ControllerList.forEach(function(e){void 0!==m[e]&&(i._controllerList[e]?i._controllerList[e].init():i._controllerList[e]=new m[e](i))})},setViewer:function(e){this._viewer=e},reset:function(){this.init()},setEnable:function(e){this.getInputManager().setEnable(f.a.CAD_MANIPULATOR,e)},setNode:function(e){this._node=e},setPivotPoint:function(e){l.f.copy(this._pivotPoint,e)},setTarget:function(){var e=l.f.create();return function(t){l.f.copy(this._target,t),this.getEyePosition(e),this._distance=l.f.distance(t,e)}}(),setEyePosition:function(e){l.f.copy(this._eye,e),this._distance=l.f.distance(this._target,e)},setHomePosition:function(e,t,i){this._homeEye=e,this._homeCenter=t,this._homeUp=i},computeHomePosition:function(){var e=l.f.create(),t=l.f.create(),i=l.f.create(),r=l.c.create();return function(a){var n=this.getHomeBoundingSphere(a);if(n){this.setDistance(this.getHomeDistance(n)),this.setTarget(n.center()),this.setPivotPoint(n.center()),void 0===this._homeEye&&(this._homeEye=l.f.create(),this.getEyePosition(this._homeEye)),void 0===this._homeCenter&&(this._homeCenter=l.f.create(),l.f.copy(this._homeCenter,n.center())),void 0===this._eye&&(this._eye=l.f.create()),l.f.copy(this._eye,this._homeEye),l.f.copy(this._target,this._homeCenter),l.f.copy(this._upz,this._homeUp),l.c.copy(r,this._rotation);var o=this._target,s=this._eye;l.f.sub(e,o,s),l.f.normalize(e,e),l.f.cross(t,e,this._upz),l.f.normalize(t,t),l.f.cross(i,t,e),l.f.normalize(i,i),r[0]=t[0],r[1]=i[0],r[2]=-e[0],r[3]=0,r[4]=t[1],r[5]=i[1],r[6]=-e[1],r[7]=0,r[8]=t[2],r[9]=i[2],r[10]=-e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,l.c.getRotation(this._orientation,r),l.d.invert(this._orientation,this._orientation)}}}(),setZoomFactor:function(e){this._zoomFactor=e},setRotateFactor:function(e){this._rotateFactor=e},setPanFactor:function(e){this._panFactor=e},setDistance:function(e){this._distance=e},setUsePolytopeIntersector:function(e){this._usePolytopeIntersector=e},getUsePolytopeIntersector:function(){return this._usePolytopeIntersector},getDistance:function(){return this._distance},zoom:function(e){this._distance=e},getRotateInterpolator:function(){return this._rotate},getPanInterpolator:function(){return this._pan},getZoomInterpolator:function(){return this._zoom},getIntersectionVisitor:function(){return this._intersectionVisitor},getLineSegmentIntersector:function(){return this._lineSegmentIntersector},getOrCreatePolytopeIntersector:function(){return void 0===this._polytopeIntersector&&(this._polytopeIntersector=new s.a,this._polytopeIntersector.setIntersectionLimit(p.a.LIMIT_ONE_PER_DRAWABLE),this._polytopeIntersector.setPrimitiveMask(p.a.POINT_PRIMITIVES|p.a.LINE_PRIMITIVES)),this._polytopeIntersector},getTarget:function(e){return l.f.copy(e,this._target),e},getEyePosition:function(e){void 0===this._eye?this.computeEyePosition(this._target,this._distance,e):l.f.copy(e,this._eye)},computeEyePosition:function(){var e=l.f.create(),t=l.c.create();return function(i,r,a){l.c.invert(t,this._rotation),e[1]=r,l.f.transformMat4(a,e,t),l.f.add(a,i,a)}}(),computePan:function(){var e=l.f.create(),t=l.f.create(),i=l.f.create();return function(r,a,n){var o=l.f.length(l.f.sub(i,this._eye,this._pivotPoint))/this._panFactor;o<10&&(o=10),e[0]=r*o/2,e[1]=a*o/2,e[2]=0,l.f.transformMat4(t,e,n),l.f.add(this._eye,this._eye,t)}}(),computeZoom:function(){var e=l.f.create(),t=l.f.create();return function(i){var r=i*this._zoomFactor;l.f.sub(e,this._pivotPoint,this._eye),l.f.add(this._eye,this._eye,l.f.scale(t,e,r))}}(),computeRotation:function(){var e=l.f.create(),t=l.f.create(),i=l.f.create(),r=l.f.create(),a=l.d.create(),n=l.d.create(),o=l.d.create(),s=l.f.create(),u=l.f.create();return function(c,h){l.f.transformQuat(t,this._right,this._orientation),l.f.normalize(e,t),l.f.sub(i,this._eye,this._pivotPoint);var d=l.f.dot(e,i);l.f.sub(r,i,l.f.scale(u,e,d));var p=l.f.fromValues(-r[0],-r[1],0),f=Math.atan2(-r[2],l.f.length(p));h=Math.max(-Math.PI/2+.01,Math.min(Math.PI/2-.01,f+h))-f,l.d.setAxisAngle(a,t,h*this._rotateFactor),l.d.setAxisAngle(n,this._upz,c*this._rotateFactor),l.d.mul(o,n,a),l.f.transformQuat(s,i,o),l.f.add(this._eye,s,this._pivotPoint),l.d.mul(this._orientation,n,this._orientation),l.f.transformQuat(t,this._right,this._orientation),l.d.setAxisAngle(a,t,h*this._rotateFactor),l.d.mul(this._orientation,a,this._orientation)}}(),update:function(){var e=l.c.create(),t=l.c.create();return function(i){var r=i.getFrameStamp().getDeltaTime(),a=this._rotate.update();this.computeRotation(10*-a[0],10*a[1]),l.c.fromQuat(e,this._orientation);var n=this._pan.update();this.computePan(10*-n[0],10*-n[1],e),a=this._zoom.update(r),this.computeZoom(-a[0]/10),l.c.fromTranslation(t,this._eye),l.c.mul(this._inverseMatrix,t,e),l.c.invert(this._inverseMatrix,this._inverseMatrix)}}(),getInverseMatrix:function(){return this._inverseMatrix},computeIntersections:function(){var e=[],t=l.f.create();return function(i,r){var a=this._camera.getView(),n=this._camera,o=n.getViewport().width(),s=n.getViewport().height();this._rotate.setWidth(o),this._rotate.setHeight(s),this._pan.setWidth(o),this._pan.setHeight(s);var c,h;if(0!=(this._primitiveMask&p.a.TRIANGLE_PRIMITIVES)&&(e=a.computeIntersections(i,r),e.length>0&&(c=e[0]._localIntersectionPoint,e[0]._nodePath.shift(),h=u.a.computeLocalToWorld(e[0]._nodePath),l.f.transformMat4(t,c,h),this.setPivotPoint(t))),0===e.length&&this._usePolytopeIntersector){var d=this.getOrCreatePolytopeIntersector();d.reset(),d.setPolytopeFromWindowCoordinates(i-5,r-5,i+5,r+5);var f=this._intersectionVisitor;f.setIntersector(d),a.getCamera().accept(f),e=d.getIntersections(),e.sort(function(e,t){return e._distance-t._distance}),e.length>0&&(c=e[0]._localIntersectionPoint,e[0]._nodePath.shift(),h=u.a.computeLocalToWorld(e[0]._nodePath),l.f.transformMat4(t,c,h),this.setPivotPoint(t))}}}(),getPositionRelativeToCanvas:function(){var e=l.e.create(),t=l.e.create();return function(i,r){var a=this._camera._graphicContext.canvas;this.getOffsetRect(a,e);var n=a.width/a.clientWidth,o=a.height/a.clientHeight;return t[0]=(i-e[1])*n,t[1]=(a.clientHeight-(r-e[0]))*o,t}}(),getCanvasCenter:function(){var e=l.e.create(),t=l.e.create();return function(){var i=this._camera.getGraphicContext().canvas;this.getOffsetRect(i,e);var r=i.width/i.clientWidth,a=i.height/i.clientHeight;return t[0]=i.clientWidth/2*r,t[1]=i.clientHeight/2*a,t}}(),getOffsetRect:function(e,t){var i=e.getBoundingClientRect(),r=document.body,a=document.documentElement,n=window.pageYOffset||a.scrollTop||r.scrollTop,o=window.pageXOffset||a.scrollLeft||r.scrollLeft,s=a.clientTop||r.clientTop||0,u=a.clientLeft||r.clientLeft||0,l=i.top+n-s,c=i.left+o-u;return t[0]=Math.round(l),t[1]=Math.round(c),t}}),"osgGA","CADManipulator"),m.StandardMouseKeyboard=c.a,m.Hammer=h.a,t.a=m},function(e,t,i){"use strict";var r=i(9),a=i(597),n=i(10),o=i(688),s=i(813),u=i(814),l=i(815),c=i(602),h=i(78),d=function(e){a.a.call(this,e),this.init()};d.AvailableControllerList=["StandardMouseKeyboard","WebVR","DeviceOrientation","Hammer"],d.ControllerList=["StandardMouseKeyboard","WebVR","DeviceOrientation","Hammer"],r.a.createPrototypeObject(d,r.a.objectInherit(a.a.prototype,{computeHomePosition:function(e){var t=this.getHomeBoundingSphere(e);if(t&&t.valid()){this._distance=this.getHomeDistance(t);var i=t.center();n.f.scale(this._eye,this._direction,-this._distance),n.f.add(this._eye,i,this._eye),this.setTarget(i)}},init:function(){this._direction=n.f.fromValues(0,1,0),this._eye=n.f.fromValues(0,25,10),this._up=n.f.fromValues(0,0,1),this._distance=1,this._forward=new c.a(1),this._side=new c.a(1),this._lookPosition=new c.a(2),this._pan=new c.a(2),this._zoom=new c.a(1),this._stepFactor=1,this._angleVertical=0,this._angleHorizontal=0,this._tmpGetTargetDir=n.f.create(),this._vrEnable=!1,this._vrRot=n.d.create(),this._vrPos=n.f.create(),this._vrTrans=n.f.create();var e=this;this._controllerList={},d.ControllerList.forEach(function(t){void 0!==d[t]&&(e._controllerList[t]?e._controllerList[t].init():e._controllerList[t]=new d[t](e))})},setDelay:function(e){this._forward.setDelay(e),this._side.setDelay(e),this._lookPosition.setDelay(e),this._pan.setDelay(e),this._zoom.setDelay(e)},getEyePosition:function(e){return e[0]=this._eye[0],e[1]=this._eye[1],e[2]=this._eye[2],e},setEyePosition:function(e){return this._eye[0]=e[0],this._eye[1]=e[1],this._eye[2]=e[2],this},getTarget:function(e){var t=n.f.scale(this._tmpGetTargetDir,this._direction,this._distance);return n.f.add(e,this._eye,t),e},setEnable:function(e){this.getInputManager().setEnable(h.a.FPS_MANIPULATOR,e)},setTarget:function(e){var t=this._tmpGetTargetDir;n.f.sub(t,e,this._eye),t[2]=0,n.f.normalize(t,t),this._angleHorizontal=Math.acos(t[1]),t[0]<0&&(this._angleHorizontal=-this._angleHorizontal),n.f.sub(t,e,this._eye),n.f.normalize(t,t),this._angleVertical=-Math.asin(t[2]),n.f.copy(this._direction,t)},getLookPositionInterpolator:function(){return this._lookPosition},getSideInterpolator:function(){return this._side},getForwardInterpolator:function(){return this._forward},getPanInterpolator:function(){return this._pan},getZoomInterpolator:function(){return this._zoom},getRotateInterpolator:function(){return this._lookPosition},computeRotation:function(){var e=n.c.create(),t=n.c.create(),i=n.f.fromValues(1,0,0),r=n.f.fromValues(0,1,0),a=n.f.fromValues(0,0,1),o=.5*Math.PI;return function(s,u){this._angleVertical+=.01*u,this._angleHorizontal-=.01*s,this._angleVertical>o?this._angleVertical=o:this._angleVertical<-o&&(this._angleVertical=-o),this._vrEnable?(n.f.transformQuat(this._direction,r,this._vrRot),n.f.normalize(this._direction,this._direction),n.f.transformQuat(this._up,a,this._vrRot)):(n.c.fromRotation(e,-this._angleVertical,i),n.c.fromRotation(t,-this._angleHorizontal,a),n.c.mul(t,t,e),n.f.transformMat4(this._direction,r,t),n.f.normalize(this._direction,this._direction),n.f.transformMat4(this._up,a,t))}}(),reset:function(){this.init()},setDistance:function(e){this._distance=e},getDistance:function(){return this._distance},setStepFactor:function(e){this._stepFactor=e},computePosition:function(){var e=n.e.create();return function(t){this._forward.update(t),this._side.update(t);var i=this._distance<.001?.001:this._distance,r=this._camera.getProjectionMatrix(),a=1===r[15]?1:2/r[5];e[0]=this._forward.getCurrent()[0],e[1]=this._side.getCurrent()[0];var o=n.e.sqrLen(e);o>1&&n.e.scale(e,e,1/Math.sqrt(o));var s=this._pan.update(t),u=this._zoom.update(t),l=this._stepFactor*i*a*t,c=this._stepFactor*i*a*.005;this.moveForward(e[0]*l-u[0]*c*20),this.strafe(e[1]*l-s[0]*c),this.strafeVertical(-s[1]*c),this._vrEnable&&(n.f.add(this._eye,this._eye,this._vrTrans),n.f.init(this._vrTrans))}}(),update:function(){var e=n.f.create();return function(t){var i=t.getFrameStamp().getDeltaTime(),r=this._lookPosition.update(i);this.computeRotation(.5*-r[0],.5*-r[1]),this.computePosition(i),n.f.add(e,this._eye,this._direction),n.c.lookAt(this._inverseMatrix,this._eye,e,this._up),this._vrEnable=!1}}(),setPoseVR:function(e,t){this._vrEnable=!0,n.d.copy(this._vrRot,e),n.f.sub(this._vrTrans,t,this._vrPos),n.f.copy(this._vrPos,t)},moveForward:function(){var e=n.f.create();return function(t){n.f.normalize(e,this._direction),n.f.scale(e,e,t),n.f.add(this._eye,this._eye,e)}}(),strafe:function(){var e=n.f.create();return function(t){n.f.cross(e,this._direction,this._up),n.f.normalize(e,e),n.f.scale(e,e,t),n.f.add(this._eye,this._eye,e)}}(),strafeVertical:function(){var e=n.f.create();return function(t){n.f.normalize(e,this._up),n.f.scale(e,e,t),n.f.add(this._eye,this._eye,e)}}()}),"osgGA","FirstPersonManipulator"),d.DeviceOrientation=o.a,d.Hammer=s.a,d.WebVR=u.a,d.StandardMouseKeyboard=l.a,t.a=d},function(e,t,i){"use strict";var r=i(21),a=function(e){this._manipulatorList=[],this._currentManipulator=void 0,this._inputManager=e};a.prototype={getCamera:function(){return this.getCurrentManipulator().getCamera()},setCamera:function(e){for(var t=this.getManipulatorList(),i=0,r=t.length;i<r;++i)t[i].setCamera(e)},update:function(e){var t=this.getCurrentManipulator();if(void 0!==t)return t.update(e)},getInputManager:function(){return this._inputManager},setEnable:function(e){this.getCurrentManipulator().setEnable(e)},getNode:function(){return this.getCurrentManipulator()._node},setNode:function(e){for(var t=this.getManipulatorList(),i=0,r=t.length;i<r;++i)t[i].setNode(e)},getControllerList:function(){return this.getCurrentManipulator().getControllerList()},getNumManipulator:function(){return this._manipulatorList.length},addManipulator:function(e){this._manipulatorList.push(e),void 0===this._currentManipulator&&this.setManipulatorIndex(0)},getManipulatorList:function(){return this._manipulatorList},setManipulatorIndex:function(e){this._currentManipulator=e},getCurrentManipulatorIndex:function(){return this._currentManipulator},getCurrentManipulator:function(){return this._manipulatorList[this._currentManipulator]},reset:function(){this.getCurrentManipulator().reset()},computeHomePosition:function(e){var t=this.getCurrentManipulator();void 0!==t&&t.computeHomePosition(e)},getInverseMatrix:function(){var e=this.getCurrentManipulator();if(void 0!==e)return e.getInverseMatrix()},getHomeBound:function(e){return r.a.warn("Please use getHomeBoundingSphere instead"),this.getHomeBoundingSphere(e)},getHomeBoundingSphere:function(e){return this.getCurrentManipulator().getHomeBoundingSphere(e)},getHomeDistance:function(e){return this.getCurrentManipulator().getHomeDistance(e)}},t.a=a},function(e,t,i){"use strict";var r=i(1057),a=i(820),n=i(602),o=i(821),s=i(825),u=i(691),l=i(600),c=i(598),h=i(550),d=i(551),p=i(807),f=i(9),m=i(1064),g=i(828),_=i(808),v=i(809),b=i(1065),y=i(1067),x=i(1068),S=i(1069),M=i(599),w={};w.ComposerPostProcess=r.a,f.a.objectMix(w,a.a),w.DelayInterpolator=n.a,w.DisplayNormalVisitor=o.a,w.DisplayGeometryVisitor=s.a,w.DisplayGraph=u.a,w.IntersectFunctor=l.a,w.Intersector=c.a,w.IntersectionVisitor=h.a,w.LineSegmentIntersector=d.a,w.LineSegmentIntersectFunctor=p.a,w.NodeGizmo=m.a,w.GizmoGeometry=g.a,w.WebVRCustom=x.a,w.PolytopeIntersector=_.a,w.PolytopeIntersectFunctor=v.a,w.SphereIntersector=b.a,w.TangentSpaceGenerator=y.a,w.WebVR=S.a,w.NO_LIMIT=M.a.NO_LIMIT,w.LIMIT_ONE_PER_DRAWABLE=M.a.LIMIT_ONE_PER_DRAWABLE,w.LIMIT_ONE=M.a.LIMIT_ONE,w.POINT_PRIMITIVES=M.a.POINT_PRIMITIVES,w.LINE_PRIMITIVES=M.a.LINE_PRIMITIVES,w.TRIANGLE_PRIMITIVES=M.a.TRIANGLE_PRIMITIVES,w.ALL_PRIMITIVES=M.a.ALL_PRIMITIVES,t.a=w},function(e,t,i){"use strict";var r=i(9),a=i(98),n=i(450),o=i(249),s=i(84),u=i(72),l=i(182),c=i(142),h=i(248),d=i(417),p=i(186),f=i(217),m=i(399),g=i(127),_=i(592),v=function(){a.a.call(this),this._feedbackSwapped=!1,this._syncFeedbackUniforms=!1,this._syncOnNextFrame=!1,this._lastXratio=1,this._lastYratio=1,this._xViewportRatio=1,this._yViewportRatio=1,this._xTextureRatio=1,this._yTextureRatio=1,this._finalPassUpScaleToScreen=!0,this._methodWrapUV=0,this._thresholdWrapUV=1,this._texInfos=void 0,this._screenWidth=this._screenHeight=0,this._shaderProcessor=Object(_.a)(),this._feedbackData={},this._cameras=[],this._stateSets=[],this._textureUniforms=[],this._programs={},this._externalTextures={},this._internalPasses=[],this._textures={},this._userTextures={},this._currentPoolIndex=0,this._texturePool={},this._firstTexture="";var e=this.getOrCreateStateSet();e.setAttributeAndModes(new o.a(o.a.DISABLE)),e.setAttributeAndModes(new n.a(n.a.BACK)),this.setCullCallback(this)};v.VertexShader=["attribute vec3 Vertex;","void main(void) {","  gl_Position = vec4(Vertex * 2.0 - 1.0, 1.0);","}","","#define SHADER_NAME %name%",""].join("\n"),v.FragmentShader=["#ifdef GL_FRAGMENT_PRECISION_HIGH\n precision highp float;\n#else\n precision mediump float;\n#endif","uniform float uRGBMRange;","vec2 gTexCoord;","%uniforms%","",'#pragma include "functions.glsl"',"","%header%","","%texturesColorSpace%","","%functionBodies%","","void main() {","\tgTexCoord = gl_FragCoord.xy / uTextureOutputSize.xy;","\tvec4 color = %firstFunc%(%firstArg%);","%optionalFuncs%","%colorSpaces%","\tgl_FragColor = color;","}","","#define SHADER_NAME %name%",""].join("\n"),r.a.createPrototypeObject(v,r.a.objectInherit(a.a.prototype,{clear:function(){this._textures={},this._internalPasses.length=0,this._firstTexture="";for(var e in this._texturePool)this._texturePool[e].usage=-1;this._feedbackData={},this._cameras.length=0,this._stateSets.length=0,this._textureUniforms.length=0,this.removeChildren()},clearShaderCache:function(){this._programs={}},getGlobalXRatio:function(){return this._xViewportRatio*this._xTextureRatio},getGlobalYRatio:function(){return this._yViewportRatio*this._yTextureRatio},setFinalPassUpScaleToScreen:function(e){this._finalPassUpScaleToScreen=e},_enforceFromInputParameter:function(e,t){var i=t.name,r=this._textures[i],a=this._textures[i+"FeedbackTexture"],n=t[e];void 0!==n&&(void 0!==r[e]&&r[e]!==n&&console.error("Mismatch on parameter "+e+" : "+i),r[e]=n,a&&(a[e]=n))},_updatePassInfoFromInputs:function(e,t,i){var r=this._textures[t],a=i.srgb;i.srgb=void 0;for(var n=0;n<e.textures.length;n++){var o=e.textures[n];this._renameTextureAlias(o,t,i.name);var s=o.name;if(!this._externalTextures[s]){this._usages[s]=(this._usages[s]||0)+1;var u=o.srgb;this._enforceFromInputParameter("filter",o),this._enforceFromInputParameter("rgbm",o),this._enforceFromInputParameter("srgb",o);var l=this._textures[s];if(!l){var c=s.substring(0,s.indexOf("FeedbackTexture"));l=this._textures[c]}void 0!==a&&void 0!==u&&a!==u&&(l.encodeSRGB=!0),this._setInferredParameter("rgbmInferred","rgbm",r,l),this._setInferredParameter("srgbInferred","srgb",r,l)}}void 0===i.srgb&&(i.srgb=void 0===r.srgb?r.srgbInferred:r.srgb)},_setInferredParameter:function(e,t,i,r){void 0===i[e]&&(i[e]=void 0===r[t]?r[e]:r[t])},_createTextureOut:function(e,t,i){var r={srgb:e.out.srgb,rgbm:e.out.rgbm,filter:e.out.filter,type:e.out.type},a=e.out.type!==s.default.UNSIGNED_BYTE;return void 0===r.rgbm&&(i||a)&&(r.rgbm=!1),void 0===r.srgb&&(i?r.srgb=!0:(r.rgbm||a)&&(r.srgb=!1)),r},_processUserPasses:function(e){e=this._internalPasses.concat(e);for(var t=this._preprocessUserPasses(e),i=t.length,r=[],a={name:this._firstTexture,srgb:void 0},n={},o=0;o<i;o++){var s=t[o],u=o===i-1;if(u||!this._collapsePasses(s,t[o+1])){var l=s.out.name,c="%next"===l;c&&(l=s.funcs.join("_"),n[l]?l+=n[l]++:n[l]=1);var h=this._createTextureOut(s,l,u);this._textures[l]=h,this._updatePassInfoFromInputs(s,l,a),s.feedbackLoop&&(this._textures[l+"FeedbackTexture"]={srgb:h.srgb,rgbm:h.rgbm,srgbInferred:h.srgbInferred,rgbmInferred:h.rgbmInferred,filter:h.filter}),c&&(a.name=l,s.out.name=l),r.push(s)}else t.splice(o+1,1),i--,o--}return r},_hasFreeTexture:function(e,t,i){if(e===i.name&&this._texturePool[e])return e;if(!i.immuable)for(var r in this._texturePool){var a=this._texturePool[r];if(a.reusable&&(!(a.usage>0)&&a.texture.divisor===i.divisor&&a.texture.getInternalFormatType()===i.type)){if(-1===a.usage)return a.texture.getMinFilter()!==t&&(a.texture.setMinFilter(t),a.texture.setMagFilter(t)),r;if(a.texture.getMinFilter()===t)return r}}},_setOrCreateTextureKey:function(e,t,i){var r="linear"===this._textures[t].filter,a=r?s.default.LINEAR:s.default.NEAREST,n=this._hasFreeTexture(t,a,i);if(n)return this._texturePool[n].usage=e,void(this._textures[t].key=n);n=i.immuable?t:"key"+this._currentPoolIndex++,this._texturePool[n]={usage:e,texture:this._createTexture(t,i.divisor,i.type,a),immuable:i.immuable,reusable:i.reusable},-1===i.divisor&&(this._texturePool[n].width=i.width,this._texturePool[n].height=i.height),this._textures[t].key=n},_addStateSet:function(e,t){for(var i=0;i<e.funcs.length;i++){var r=e.funcs[i].name;this._stateSets[r]=t}},_addTextureToStateSet:function(e,t,i,r,a){t.addUniform(u.a.createInt1(i,e.uniformName));var n,o=e.name;if(void 0!==this._textures[o]){var s=this._textures[o].key;n=this._texturePool[s].texture}else n=this._externalTextures[o];if(this._addTextureUniforms(e.uniformName,n,t,r,a),"TexturePrevious"===e.uniformName)return i;t.setTextureAttributeAndModes(i,n)},_getUniformName:function(e){return"u"+e[0].toUpperCase()+e.slice(1)},_addTextureUniforms:function(e,t,i,r,a){var n=this._getUniformName(e),o=u.a.createFloat2(n+"Size"),s=u.a.createFloat2(n+"Ratio");i.addUniform(o),i.addUniform(s),r.push(o),r.push(s),this._textureUniforms.push({size:o,ratio:s,texture:t,isFeedback:!!a})},_checkInferredParameters:function(){for(var e in this._textures){var t=this._textures[e];void 0===t.srgb&&(t.srgb=t.srgbInferred),void 0===t.rgbm&&(t.rgbm=t.rgbmInferred)}},_buildPass:function(e,t){var i=t[e],r=i.out.name;this._setOrCreateTextureKey(this._usages[r],r,i.out);var a=i.out.name+"FeedbackTexture";if(i.feedbackLoop&&this._setOrCreateTextureKey(this._usages[a],a,i.out),!i.funcs.length){var n=this._textures[r].key;return void(this._userTextures[r]=this._texturePool[n].texture)}var o=new l.a;this._addStateSet(i,o);var s;for(s=0;s<i.uniforms.length;s++)o.addUniform(i.uniforms[s]);var u=[],c=void 0;for(s=0;s<i.textures.length;s++){var h=i.textures[s],d=h.name===a;if(!d&&!this._externalTextures[h.name]){var p=this._textures[h.name].key;this._texturePool[p].usage--}var f=this._addTextureToStateSet(h,o,s,u,d);if(void 0!==f&&(c=f),void 0!==this._feedbackData[h.name]){var m={stateSet:o,textureUnit:s};this._feedbackData[h.name].nextPasses.push(m)}}var g=void 0;if(e!==t.length-1){var _=this._textures[r].key;g=this._texturePool[_].texture}this._addTextureUniforms("TextureOutput",g,o,u),o.setAttributeAndModes(this._createProgram(i,u)),i.feedbackLoop?this._feedbackData[r]=this._createFeedbackLoopCameras(r,o,g,c):this.addChild(this._createCamera(r,o,g))},_buildGraphFromPasses:function(e){for(var t=0;t<e.length;t++)this._buildPass(t,e)},build:function(e){this._usages={};var t=this._processUserPasses(e);this._checkInferredParameters(t),this._buildGraphFromPasses(t),this.resize(this._screenWidth,this._screenHeight)},_createFeedbackLoopCameras:function(e,t,i,r){var n=this._textures[e+"FeedbackTexture"].key,o=this._texturePool[n].texture,s=new a.a;s.setStateSet(t);var u=this._createFeedbackLoopCamera(e,i,o,r),l=this._createFeedbackLoopCamera(e+"FeedbackTexture",o,i,r);l.setNodeMask(0),s.addChild(u),s.addChild(l),this.addChild(s);var c={};return c.camera1=u,c.camera2=l,c.texture1=i,c.texture2=o,c.nextPasses=[],c},_createFeedbackLoopCamera:function(e,t,i,r){var a=new l.a;a.setTextureAttributeAndModes(r,i);var n=this._createCamera(e,a,t);return n.setStateSet(a),n},_createCamera:function(e,t,i){var r=new c.a;r.setName(e),r.setStateSet(t),r.setClearMask(0),r.setReferenceFrame(g.a.ABSOLUTE_RF),i&&(r.setRenderOrder(c.a.PRE_RENDER,0),r.attachTexture(h.a.COLOR_ATTACHMENT0,i)),r.setViewport(new d.a);var a=m.a.createTexturedFullScreenFakeQuadGeometry();return a.setName("composer layer"),r.addChild(a),this._cameras.push(r),r},swapFeedbackLoopTextures:function(e){for(var t in this._feedbackData){var i=this._feedbackData[t];i.camera1.setNodeMask(e?-1:0),i.camera2.setNodeMask(e?0:-1);for(var r=e?i.texture1:i.texture2,a=0;a<i.nextPasses.length;a++){var n=i.nextPasses[a];n.stateSet.setTextureAttributeAndModes(n.textureUnit,r)}}this._feedbackSwapped=!0},_createFuncFromUserData:function(e){var t="string"==typeof e?{name:e,file:e+".glsl"}:e;return t.toString=function(){return this.name},t},_createTextureInfoFromUserData:function(e){var t={name:"",uniformName:"",rgbm:void 0,srgb:void 0,filter:void 0};return"string"==typeof e?t.name=e:(t.name=e.name,e.uniformName&&(t.uniformName=e.uniformName),void 0!==e.rgbm&&(t.rgbm=e.rgbm),void 0!==e.srgb&&(t.srgb=e.srgb),void 0!==e.filter&&(t.filter=e.filter)),t},_preprocessUserPasses:function(e){for(var t=[],i=0;i<e.length;i++){var r=e[i],a={};if(a.funcs=[],r.func&&a.funcs.push(this._createFuncFromUserData(r.func)),a.textures=[],a.feedbackLoop=!1,void 0!==r.textures){Array.isArray(r.textures)||(r.textures=[r.textures]);for(var n=0;n<r.textures.length;n++){var o=this._createTextureInfoFromUserData(r.textures[n]);"%previous"===o.name&&(a.feedbackLoop=!0),a.textures.push(o)}}"string"==typeof r.header?a.header=[r.header]:a.header=r.header||[],void 0!==r.uniforms?Array.isArray(r.uniforms)?a.uniforms=r.uniforms:a.uniforms=[r.uniforms]:a.uniforms=[],a.out=r.out,a.out.divisor=a.out.divisor||1,a.out.type=a.out.type||s.default.UNSIGNED_BYTE,void 0===a.out.immuable&&(a.out.immuable=!1),void 0===a.out.reusable&&(a.out.reusable=!0),(a.feedbackLoop||-1===a.out.divisor)&&(a.out.immuable=!0,a.out.reusable=!1),a.collapsible=r.collapsible||!1,t.push(a)}return t},_canBeCollapsed:function(e,t){return e.funcs.length&&t.collapsible&&"%next"===e.out.name&&e.out.divisor===t.out.divisor&&e.out.width===e.out.width&&e.out.height===e.out.height},_collapsePasses:function(e,t){return!!this._canBeCollapsed(e,t)&&(e.funcs=e.funcs.concat(t.funcs),e.header=e.header.concat(t.header),e.textures=this._mergeWithoutDuplicates(e.textures,t.textures,function(e,t){return e.name===t.name}),e.uniforms=this._mergeWithoutDuplicates(e.uniforms,t.uniforms,function(e,t){return e.getName()===t.getName()}),!0)},_renameTextureAlias:function(e,t,i){"%last"===e.name?(e.name=i,e.uniformName=e.uniformName||"TextureInput"):"%previous"===e.name?(e.name=t+"FeedbackTexture",e.uniformName=e.uniformName||"TexturePrevious"):e.uniformName||(e.uniformName=e.name)},_createTexture:function(e,t,i,r){var a=new s.default;return a.setTextureSize(1,1),a.setInternalFormatType(i),a.setInternalFormat(s.default.RGBA),a.setMinFilter(r),a.setMagFilter(r),a.divisor=t,a.setName(e),a},_computeHashFromPass:function(e){for(var t="",i=0;i<e.funcs.length;i++)t+=e.funcs[i].name+"_"+e.funcs[i].file+"_";for(e.header&&(t+=e.header.join("_")),i=0;i<e.textures.length;i++)t+=!!e.textures[i].rgbm+"_"+!!e.textures[i].srgb+"_";return t+=!!e.out.encodeSRGB+"_",t+=!!this._textures[e.out.name].rgbm+"_"},_writeDeclarations:function(e,t,i,r){var a,n="uniform sampler2D TextureInput;\n";for(a=0;a<i.length;a++){n+="uniform sampler2D "+(i[a].uniformName||i[a].name)+";\n"}for(a=0;a<t.length;a++){var o=t[a];n+="uniform "+o.getType()+" "+o.getName()+";\n"}return e=e.replace("%uniforms%",n),r&&(e=e.replace("%header%",r.join("\n"))),e},setMethodWrapUV:function(e,t){void 0!==e&&(this._methodWrapUV=e),void 0!==t&&(this._thresholdWrapUV=t),this._texInfos=void 0},_getInfos:function(){if(this._texInfos)return this._texInfos;var e="texture2D(%tex, (uv) * %ratio)",t="texture2D(%tex, (floor((uv) * %size) + 0.5) * %ratio / %size, -99999.0)",i="texture2D(%tex, (uv) * %ratio)",r=this._thresholdWrapUV.toExponential();if(1===this._methodWrapUV){var a="min(uv, 1.0 - "+r+" / %size.xy)";e=e.replace(/(uv)/g,a),t=t.replace(/(uv)/g,a),i=i.replace(/(uv)/g,a)}else if(2===this._methodWrapUV){var n="step((uv).x, 1.0 - "+r+" / %size.x) *";n+="step((uv).y, 1.0 - "+r+" / %size.y) * ",e=n+e,t=n+t,i=n+i}return this._texInfos={TEXTURE_2D:{signature:"TEXTURE_2D_%tex(uv)",body:e},TEXTURE_2D_NEAREST:{signature:"TEXTURE_2D_NEAREST_%tex(uv)",body:t},TEXTURE_2D_BIAS:{signature:"TEXTURE_2D_BIAS_%tex(uv, bias)",body:i}},this._texInfos},_extractTextures:function(e){var t=this._getInfos(),i=e.match(/TEXTURE_2D(?:_BIAS|_NEAREST)?_\w+\(/g);if(!i)return{};for(var r={},a=0;a<i.length;a++){var n=i[a].match(/((TEXTURE_2D(?:_BIAS|_NEAREST)?)_(\w+))\(/),o=t[n[2]];r[n[1]]={name:n[3],signature:o.signature,body:o.body}}return r},_writeFunctionBodies:function(e,t,i,r){for(var a=[],n="",o={},s=0;s<t.length;s++){n+=this._shaderProcessor.getShaderTextPure(t[s].file)+"\n"}var u=["functions.glsl"];n=this._shaderProcessor.preprocess(n,0,u);var l=this._extractTextures(n);if(r){var c=this._getInfos().TEXTURE_2D;l.TEXTURE_2D_TextureInput={name:"TextureInput",signature:c.signature,body:c.body}}for(var h in l)if(!o[h]){o[h]=!0;for(var d=l[h],p=d.name,f=!1,m=0;m<i.length;m++){var g=i[m];if(g.uniformName===p){var _=this._textures[g.name];if(_&&_.rgbm){f=_.rgbm;break}}}var v=d.body;f&&(v="vec4(decodeRGBM("+v+", uRGBMRange), 1.0)"),v="#define "+d.signature+" ("+v+")";var b=this._getUniformName(p);v=v.replace(/%size/g,b+"Size"),v=v.replace(/%ratio/g,b+"Ratio"),v=v.replace(/%tex/g,p),a.push(v)}return e=e.replace("%texturesColorSpace%",a.join("\n")),e.replace("%functionBodies%",n.replace(/\\\n/g,""))},_writeMainFunction:function(e,t,i,r){e=e.replace("%firstFunc%",t[0].name);var a=i?"TEXTURE_2D_TextureInput(gTexCoord)":"";e=e.replace("%firstArg%",a);for(var n="",o=1;o<t.length;o++)n+="\tcolor = "+t[o].name+"(color);\n";if(e=e.replace("%optionalFuncs%",n),!0===this._textures[r].encodeSRGB){n="\tcolor.rgb = "+(this._textures[r].srgb?"linearTosRGB":"sRGBToLinear")+"(color.rgb);\n"}else n="";return this._textures[r].rgbm?n+="\tcolor = encodeRGBM(color.rgb, uRGBMRange);":n+="",e.replace("%colorSpaces%",n)},_removeDuplicatedUniforms:function(e){for(var t=e.split("\n"),i={},r=t.length,a=0;a<r;a++){var n=t[a].match(/uniform(?:\s+){1,}\w+(?:\s+){1,}(\w+)/);if(null!==n){var o=n[1];void 0!==i[o]?(t.splice(a,1),r--,a--):i[o]=!0}}return t.join("\n")},_createProgram:function(e,t){var i=this._computeHashFromPass(e);if(void 0!==this._programs[i])return this._programs[i];var r=this._writeDeclarations(v.FragmentShader,t,e.textures,e.header);r=this._writeFunctionBodies(r,e.funcs,e.textures,e.collapsible),r=this._writeMainFunction(r,e.funcs,e.collapsible,e.out.name),r=r.replace("%name%",e.out.name),r=this._removeDuplicatedUniforms(r);var a=v.VertexShader.replace("%name%",e.out.name),n=new p.a(new f.a(f.a.VERTEX_SHADER,a),new f.a(f.a.FRAGMENT_SHADER,r));return this._programs[i]=n,n},resize:function(e,t){this.setScreenSize(e,t);for(var i in this._texturePool){var r=this._texturePool[i].texture;void 0===this._texturePool[i].width?r.setTextureSize(this._getTextureSize(e,r.divisor),this._getTextureSize(t,r.divisor)):r.setTextureSize(this._texturePool[i].width,this._texturePool[i].height)}this.resizeRatio()},resizeRatio:function(e,t,i,r){void 0!==e&&(this._xViewportRatio=e),void 0!==t&&(this._yViewportRatio=t),void 0!==i&&(this._xTextureRatio=i),void 0!==r&&(this._yTextureRatio=r),this._resizeViewports(),this._resizeTextureUniforms()},_resizeViewports:function(){for(var e=this.getGlobalXRatio(),t=this.getGlobalYRatio(),i=this._cameras,r=0;r<i.length;++r){var a=i[r],n=a.isRenderToTextureCamera(),o=1;if(n){o=a.getAttachments()[h.a.COLOR_ATTACHMENT0].texture.divisor}if(r===i.length-1&&this._finalPassUpScaleToScreen&&(e=this._xViewportRatio,t=this._yViewportRatio),-1!==o){var s=this._getTextureSize(this._screenWidth,o/e),u=this._getTextureSize(this._screenHeight,o/t);a.getViewport().setViewport(0,0,s,u)}}},_resizeTextureUniforms:function(){var e=this.getGlobalXRatio(),t=this.getGlobalYRatio(),i=this._finalPassUpScaleToScreen?this._xViewportRatio:e,r=this._finalPassUpScaleToScreen?this._yViewportRatio:t;this._syncFeedbackUniforms=!0;for(var a=this._textureUniforms,n=0;n<a.length;++n){var o=a[n],s=o.size.getInternalArray(),u=o.ratio.getInternalArray();if(!o.isFeedback||!s[0]){u[0]=e,u[1]=t;var l=o.texture;l?!l.divisor||l.divisor<0?(s[0]=l.getWidth(),s[1]=l.getHeight(),u[0]=u[1]=1):(s[0]=e*l.getWidth(),s[1]=t*l.getHeight()):(s[0]=this._screenWidth*i,s[1]=this._screenHeight*r)}}},_resizeFeedbackTextureUniforms:function(){for(var e=this._lastXratio,t=this._lastYratio,i=this._textureUniforms,r=0;r<i.length;++r){var a=i[r];if(a.isFeedback){var n=a.size.getInternalArray(),o=a.ratio.getInternalArray(),s=a.texture;o[0]=e,o[1]=t,n[0]=e*s.getWidth(),n[1]=t*s.getHeight()}}},cull:function(){return this._syncOnNextFrame&&(this._resizeFeedbackTextureUniforms(),this._syncOnNextFrame=!1),this._syncFeedbackUniforms&&this._feedbackSwapped&&(this._syncFeedbackUniforms=!1,this._syncOnNextFrame=!0,this._lastXratio=this.getGlobalXRatio(),this._lastYratio=this.getGlobalYRatio()),this._feedbackSwapped=!1,!0},_mergeWithoutDuplicates:function(e,t,i){for(var r=0;r<t.length;r++){for(var a=t[r],n=!0,o=0;o<e.length;o++)if(i(e[o],a)){n=!1;break}n&&e.push(a)}return e},_getTextureSize:function(e,t){return Math.max(1,Math.round(e/t))},setScreenSize:function(e,t){this._screenWidth=e,this._screenHeight=t},setShaderProcessor:function(e){this._shaderProcessor=e},addInternalTexture:function(e){this._internalPasses.push({out:{name:e.name,divisor:e.divisor,type:e.type,filter:e.filter,srgb:e.srgb,rgbm:e.rgbm,immuable:e.immuable,reusable:e.reusable}})},addExternalTexture:function(e,t){this._externalTextures[e]=t},setInputTexture:function(e){this._firstTexture=e},getCameras:function(){return this._cameras},getStateSetPass:function(e){return this._stateSets[e]},getInternalTexture:function(e){return this._userTextures[e]}}),"osgUtil","ComposerPostProcess"),t.a=v},function(e,t,i){"use strict";var r=i(9),a=i(689),n=i(603),o=a.a.sprintf,s=function(e,t){n.a.call(this),this._name="Variable",this._prefix=t,this._type=e,this._value=void 0};r.a.createPrototypeObject(s,r.a.objectInherit(n.a.prototype,{getType:function(){return this._type},getVariable:function(){return this._prefix},setValue:function(e){return this._value=e,this},toString:function(){var e=this._name+" "+this._prefix;return this._type&&(e+=" ("+this._type+")"),e+=" - id:"+this._id},declare:function(){return void 0!==this._value?o("%s %s = %s;",[this._type,this.getVariable(),this._value]):o("%s %s;",[this._type,this.getVariable()])},isEmpty:function(){return void 0===this._value&&0===this._inputs.length},reset:function(){this._inputs=[],this._outputs=null,this._value=void 0,this._text=void 0}}),"osgShader","Variable");var u=function(e,t){s.call(this,e,t)};r.a.createPrototypeObject(u,r.a.objectInherit(s.prototype,{declare:function(){return o("const %s %s = %s;",[this._type,this.getVariable(),this._value])}}),"osgShader","Constant");var l=function(e,t,i){s.call(this,e,t),this._size=i};r.a.createPrototypeObject(l,r.a.objectInherit(s.prototype,{declare:function(){},globalDeclaration:function(){return this._size?o("uniform %s %s[%s];",[this._type,this.getVariable(),this._size]):o("uniform %s %s;",[this._type,this.getVariable()])}}),"osgShader","Uniform");var c=function(e,t){s.call(this,e,t)};r.a.createPrototypeObject(c,r.a.objectInherit(s.prototype,{declare:function(){},globalDeclaration:function(){return o("attribute %s %s;",[this._type,this.getVariable()])}}),"osgShader","Attribute");var h=function(e,t){s.call(this,e,t)};r.a.createPrototypeObject(h,r.a.objectInherit(s.prototype,{declare:function(){},globalDeclaration:function(){return o("varying %s %s;",[this._type,this.getVariable()])}}),"osgShader","Varying");var d=function(e,t){s.call(this,e,t)};r.a.createPrototypeObject(d,r.a.objectInherit(s.prototype,{declare:function(){},globalDeclaration:function(){return o("uniform %s %s;",[this._type,this.getVariable()])}}),"osgShader","Sampler");var p=function(e,t){s.call(this,e,t)};r.a.createPrototypeObject(p,r.a.objectInherit(s.prototype,{_unique:!0,isUnique:function(){return this._unique},outputs:function(){return this},getVariable:function(){return this._prefix}}),"osgShader","Output");var f=function(){p.call(this,"vec4","gl_FragColor"),this._name="glFragColor"};r.a.createPrototypeObject(f,r.a.objectInherit(p.prototype,{}),"osgShader","glFragColor");var m=function(){p.call(this,"vec4","gl_Position"),this._name="glPosition"};r.a.createPrototypeObject(m,r.a.objectInherit(p.prototype,{}),"osgShader","glPosition");var g=function(){p.call(this,"float","gl_PointSize"),this._name="glPointSize"};r.a.createPrototypeObject(g,r.a.objectInherit(p.prototype,{}),"osgShader","glPointSize");var _=function(e){n.a.call(this),this._defineName=e,this._defineValue=""};r.a.createPrototypeObject(_,r.a.objectInherit(n.a.prototype,{type:"Define",setValue:function(e){return this._defineValue=e,this},getDefines:function(){return["#define "+this._defineName+" "+this._defineValue]}}),"osgShader","Define"),t.a={Output:p,glPointSize:g,glPosition:m,glFragColor:f,Sampler:d,Variable:s,Constant:u,Attribute:c,Varying:h,Uniform:l,Define:_}},function(e,t,i){"use strict";var r=i(21),a=i(552),n=i(823),o=i(821),s=i(825),u=function(){return this._generators={},this.addShaderGenerator("default",new a.a),this.addShaderGenerator("ShadowCast",new n.a),this.addShaderGenerator("debugNormal",new o.a.ShaderGeneratorCompilerOffsetNormal),this.addShaderGenerator("debugTangent",new o.a.ShaderGeneratorCompilerOffsetTangent),this.addShaderGenerator("debugGeometry",new s.a.ShaderGeneratorCompilerColorGeometry),this.addShaderGenerator("debugSkinning",new s.a.ShaderGeneratorCompilerColorSkinning),this};u.prototype={getShaderGenerator:function(e){if(!e)return this._generators.default;var t=this._generators[e];return t||(r.a.error("ShaderGenerator "+e+" does not exist in ShaderGeneratorProxy"),this._generators.default)},addShaderGenerator:function(e,t){this._generators[e]=t}},t.a=u},function(e,t,i){"use strict";var r=i(21),a=i(9),n=i(603),o=function(){n.a.call(this)};o.prototype=n.a.prototype;var s=function(){o.call(this)};a.a.createPrototypeObject(s,a.a.objectInherit(o.prototype,{type:"Add",operator:"+",_getFirstVariableCast:function(){var e=this._inputs[0].getVariable(),t=this._inputs[0].getType(),i=this._outputs.getType();return i===t?e:"float"===t?i+"("+e+")":"vec3"===i?e+".rgb":"vec2"===i?e+".rg":"float"===i?e+".r":(r.a.error("Mismatch type : "+i+" with "+t+", "+e),e)},computeShader:function(){var e=this._outputs.getType(),t="";"vec4"===e?t=".rgba":"vec3"===e?t=".rgb":"vec2"===e&&(t=".rg");for(var i=this._getFirstVariableCast(),r=this._outputs.getVariable()+" = "+i,a=1,n=this._inputs.length;a<n;a++){var o=this._inputs[a];r+=this.operator+o.getVariable();var s=o.getType();"float"!==s&&s!==e&&(r+=t)}return r+=";"}}),"osgShader","Add");var u=function(){s.call(this)};a.a.createPrototypeObject(u,a.a.objectInherit(s.prototype,{type:"Mult",operator:"*"}),"osgShader","Mult");var l=function(){s.call(this)};a.a.createPrototypeObject(l,a.a.objectInherit(s.prototype,{type:"SetFromNode"}),"osgShader","SetFromNode");var c=function(){s.call(this),this._overwriteW=!0,this._forceComplement=!0,this._inverseOp=!1};a.a.createPrototypeObject(c,a.a.objectInherit(s.prototype,{type:"MatrixMultDirection",operator:"*",validInputs:["vec","matrix"],validOutputs:["vec"],complement:"0.",setInverse:function(e){return this._inverseOp=e,this},setForceComplement:function(e){return this._forceComplement=e,this},setOverwriteW:function(e){return this._overwriteW=e,this},computeShader:function(){var e=this._inputs.vec.getVariable(),t=this._inputs.matrix.getVariable(),i=this._outputs.vec.getVariable(),r=this._inputs.vec.getType(),a=this._outputs.vec.getType(),n=this._inputs.matrix.getType(),o=i;if("mat4"===n){o+=" = ","vec4"!==a&&(o+=a+"(");var s=e;(this._forceComplement||"vec4"!==r)&&(s="vec4("+e+".xyz, "+this.complement+")"),o+=this._inverseOp?s+this.operator+t:t+this.operator+s,"vec4"!==a&&(o+=")"),o+=";",this._overwriteW||"vec4"!==r||(o+="\n"+i+".a = "+e+".a;")}else{"vec4"===a&&(o+=".xyz"),o+=" = ";var u=e+".xyz";o+=(this._inverseOp?u+this.operator+t:t+this.operator+u)+";",this._overwriteW||"vec4"!==a||"vec4"!==r||(o+="\n"+i+".a = "+e+".a;")}return o}}),"osgShader","MatrixMultDirection");var h=function(){c.call(this),this._forceComplement=!1};a.a.createPrototypeObject(h,a.a.objectInherit(c.prototype,{type:"MatrixMultPosition",complement:"1."}),"osgShader","MatrixMultPosition");var d=function(){o.apply(this),this._mode="MIX"};a.a.createPrototypeObject(d,a.a.objectInherit(o.prototype,{type:"Blend",mode:function(e){return this._mode=e,this},computeShader:function(){return this[void 0===this._mode?"MIX":this._mode]()},ADD:function(){return this._outputs.getVariable()+" = "+this._inputs[0].getVariable()+" + ("+this._inputs[1].getVariable()+" * "+this._inputs[2].getVariable()+");"},MIX:function(){return this._outputs.getVariable()+" = mix("+this._inputs[0].getVariable()+", "+this._inputs[1].getVariable()+", "+this._inputs[2].getVariable()+");"},MULTIPLY:function(){return this._outputs.getVariable()+" = "+this._inputs[0].getVariable()+" * mix( "+this._inputs[0].getType()+"(1.0), "+this._inputs[1].getVariable()+", "+this._inputs[2].getVariable()+");"}}));var p=function(){n.a.call(this)};a.a.createPrototypeObject(p,a.a.objectInherit(n.a.prototype,{type:"InlineCode",code:function(e){return this._text=e,this},computeShader:function(){var e=a.a.objectMix({},this._inputs);e=a.a.objectMix(e,this._outputs);for(var t=new RegExp("%[A-Za-z0-9_]+","gm"),i=this._text,n=this._text.match(t),o=new Set,s=0;s<n.length;s++){var u=n[s].substr(1);if(!o.has(u)){e[u]||(r.a.error("error with inline code\n"+this._text),r.a.error("input "+u+" not provided for "+n[s]));var l=new RegExp(n[s].toString(),"gm");i=i.replace(l,e[u].getVariable()),o.add(u)}}return i}}),"osgShader","InlineCode"),t.a={BaseOperator:o,Mult:u,MatrixMultPosition:h,MatrixMultDirection:c,Add:s,Blend:d,InlineCode:p,SetFromNode:l}},function(e,t,i){"use strict";var r=i(21),a={_createVertexShader:function(){var e=this.declareVertexMain(),t=this.getVertexShaderName();t&&e.push(this.getNode("Define","SHADER_NAME").setValue(t));var i=this.createShaderFromGraphs(e);return r.a.debug(this.getDebugIdentifier()),r.a.debug(i),i},declareVertexMain:function(){var e=[this.declarePointSize(),this.declareVertexPosition()];return this.declareVertexVaryings(e),e},declarePointSize:function(){var e=this.getNode("glPointSize");return this._pointSizeAttribute&&this._pointSizeAttribute.isEnabled()?(this.getNode("InlineCode").code("%pointSize = min(64.0, max(1.0, -%size / %position.z));").inputs({position:this.getOrCreateViewVertex(),size:this.getOrCreateUniform("float","uPointSize")}).outputs({pointSize:e}),e):(this.getNode("SetFromNode").inputs(this.getOrCreateConstantOne("float")).outputs(e),e)},declareVertexVaryings:function(e){var t=this._varyings;t.vModelVertex&&this.getNode("SetFromNode").inputs(this.getOrCreateModelVertex()).outputs(t.vModelVertex),t.vModelNormal&&this.getNode("SetFromNode").inputs(this.getOrCreateModelNormal()).outputs(t.vModelNormal),t.vModelTangent&&this.getNode("SetFromNode").inputs(this.getOrCreateModelTangent()).outputs(t.vModelTangent),t.vViewVertex&&this.getNode("SetFromNode").inputs(this.getOrCreateViewVertex()).outputs(t.vViewVertex),t.vViewNormal&&this.getNode("SetFromNode").inputs(this.getOrCreateViewNormal()).outputs(t.vViewNormal),t.vViewTangent&&this.getNode("SetFromNode").inputs(this.getOrCreateViewTangent()).outputs(t.vViewTangent),t.vVertexColor&&this.getNode("InlineCode").code("%vcolor = %venabled == 1.0 ? %acolor : vec4(1.0, 1.0, 1.0, 1.0);").inputs({venabled:this.getOrCreateUniform("float","uArrayColorEnabled"),acolor:this.getOrCreateAttribute("vec4","Color")}).outputs({vcolor:this.getOrCreateVarying("vec4","vVertexColor")});for(var i in t){var r=t[i];e.push(r);var a=r.getVariable();-1!==a.indexOf("vTexCoord")&&this.getNode("SetFromNode").inputs(this.getOrCreateAttribute("vec2",a.substring(1))).outputs(r)}},declareVertexPosition:function(){var e=this.getNode("glPosition");return this._isBillboard?this.declareVertexTransformBillboard(e):this.declareScreenVertex(e),e},declareScreenVertex:function(e){this.getNode("MatrixMultPosition").inputs({matrix:this.getOrCreateProjectionMatrix(),vec:this.getOrCreateViewVertex()}).outputs({vec:e})},declareVertexTransformBillboard:function(e){this.getNode("Billboard").inputs({Vertex:this.getOrCreateAttribute("vec3","Vertex"),ModelViewMatrix:this.getOrCreateUniform("mat4","uModelViewMatrix"),ProjectionMatrix:this.getOrCreateUniform("mat4","uProjectionMatrix")}).outputs({result:e})},getOrCreateBoneMatrix:function(){var e=this._variables.boneMatrix;if(e)return e;e=this.createVariable("mat4","boneMatrix");var t=this.getOrCreateAttribute("vec4","Weights"),i=this.getOrCreateAttribute("vec4","Bones"),r=this.getOrCreateUniform("vec4","uBones",this._skinningAttribute.getBoneUniformSize());return this.getNode("Skinning").inputs({weights:t,bonesIndex:i,matrixPalette:r}).outputs({result:e}),e},getTarget:function(e,t){var i=-1!==e.indexOf("Tangent")?"vec4":"vec3";return this.getOrCreateAttribute(i,e+"_"+t)},morphTangentApproximation:function(e,t){var i=this.getOrCreateLocalNormal();return this._skinningAttribute&&(i=this.createVariable("vec3"),this.getNode("Normalize").inputs({vec:this.getOrCreateMorphNormal()}).outputs({result:i})),this.getNode("InlineCode").code("%out = %tangent.rgb - dot(%tangent.rgb, %normal) * %normal;").inputs({tangent:e,normal:i}).outputs({out:t}),t},getTargetWeights:function(e){var t=this.getOrCreateUniform("vec4","uTargetWeights");if(-1===e.indexOf("Normal")&&-1===e.indexOf("Tangent"))return t;var i=this.getVariable("nTargetWeights");if(i)return i;i=this.createVariable("vec4","nTargetWeights");var r="%output = abs(%wts)\n;";return r+="%output = %wts / max(1.0, %output.x + %output.y + %output.z + %output.w);",this.getNode("InlineCode").code(r).inputs({wts:t}).outputs({output:i}),i},morphTransformVec3:function(e,t){for(var i={vertex:e,weights:this.getTargetWeights(e.getVariable())},r=this._morphAttribute.getNumTargets(),a=0;a<r;a++)i["target"+a]=this.getTarget(e.getVariable(),a);return this.getNode("Morphing").inputs(i).outputs({result:t}),t},skinTransformVertex:function(e,t){return this.getNode("MatrixMultPosition").setInverse(!0).inputs({matrix:this.getOrCreateBoneMatrix(),vec:e}).outputs({vec:t}),t},skinTransformNormal:function(e,t){return this.getNode("MatrixMultDirection").setInverse(!0).inputs({matrix:this.getOrCreateBoneMatrix(),vec:e}).outputs({vec:t}),t},getOrCreateMorphVertex:function(){var e=this.getVariable("morphVertex");if(e)return e;var t=this.getOrCreateAttribute("vec3","Vertex");return this._morphAttribute&&this._morphAttribute.hasTarget("Vertex")?this.morphTransformVec3(t,this.createVariable("vec3","morphVertex")):t},getOrCreateMorphNormal:function(){var e=this.getVariable("morphNormal");if(e)return e;var t=this.getOrCreateAttribute("vec3","Normal");return this._morphAttribute&&this._morphAttribute.hasTarget("Normal")?this.morphTransformVec3(t,this.createVariable("vec3","morphNormal")):t},getOrCreateMorphTangent:function(){var e=this.getVariable("morphTangent");if(e)return e;var t=this.getOrCreateAttribute("vec4","Tangent");return this._morphAttribute&&this._morphAttribute.hasTarget("Tangent")?this.morphTransformVec3(t,this.createVariable("vec3","morphTangent")):t},getOrCreateSkinVertex:function(){var e=this.getVariable("skinVertex");if(e)return e;var t=this.getOrCreateMorphVertex();return this._skinningAttribute?this.skinTransformVertex(t,this.createVariable("vec3","skinVertex")):t},getOrCreateSkinNormal:function(){var e=this.getVariable("skinNormal");if(e)return e;var t=this.getOrCreateMorphNormal();return this._skinningAttribute?this.skinTransformNormal(t,this.createVariable("vec3","skinNormal")):t},getOrCreateSkinTangent:function(){var e=this.getVariable("skinTangent");if(e)return e;var t=this.getOrCreateMorphTangent();return this._skinningAttribute?this.skinTransformNormal(t,this.createVariable("vec3","skinTangent")):t},getOrCreateLocalVertex:function(){return this.getOrCreateSkinVertex()},getOrCreateLocalNormal:function(){var e=this.getVariable("localNormal");if(e)return e;var t=this.getOrCreateSkinNormal();return t===this.getOrCreateAttribute("vec3","Normal")?t:(e=this.createVariable("vec3","localNormal"),this.getNode("Normalize").inputs({vec:t}).outputs({result:e}),e)},getOrCreateLocalTangent:function(){var e=this.getVariable("localTangent");if(e)return e;var t=this.getOrCreateAttribute("vec4","Tangent"),i=this.getOrCreateSkinTangent();return i===t?i:this.normalizeAndSetAlpha(i,t,this.createVariable("vec4","localTangent"))},normalizeAndSetAlpha:function(e,t,i){var r=this.createVariable("vec3");return this.getNode("Normalize").inputs({vec:e}).outputs({result:r}),this.getNode("SetAlpha").inputs({color:r,alpha:t}).outputs({result:i}),i}};for(var n in a)a[n]=function(e,t){return function(){return this._fragmentShaderMode&&this.logError("This function should not be called from fragment shader : "+t),e.apply(this,arguments)}}(a[n],n);t.a=a},function(e,t,i){"use strict";var r=i(548),a=i(21),n={_createFragmentShader:function(){var e=this.createFragmentShaderGraph(),t=this.getFragmentShaderName();t&&e.push(this.getNode("Define","SHADER_NAME").setValue(t));var i=this.createShaderFromGraphs(e);return a.a.debug(this.getDebugIdentifier()),a.a.debug(i),this.cleanAfterFragment(),i},applyPointSizeCircle:function(e){return this._pointSizeAttribute&&this._pointSizeAttribute.isEnabled()&&this._pointSizeAttribute.isCircleShape()?(this.getNode("InlineCode").code("if (length(2.0 * gl_PointCoord - 1.0) > %radius) discard;").inputs({radius:this.getOrCreateConstantOne("float")}).outputs({output:e}),e):e},cleanAfterFragment:function(){this._variables={},this._activeNodeMap={};for(var e in this._texturesByName)this._texturesByName[e].variable=void 0;for(var t in this._varyings){var i=this._varyings[t];i.reset(),this._activeNodeMap[i.getID()]=i,this._variables[t]=i}},createDefaultFragmentShaderGraph:function(){var e=this.getOrCreateConstant("vec4","fofd").setValue("vec4(1.0, 0.0, 1.0, 0.7)"),t=this.getNode("glFragColor");return this.getNode("SetFromNode").inputs(e).outputs(t),t},createFragmentShaderGraph:function(){var e=[];if(!this._material)return e.push(this.createDefaultFragmentShaderGraph()),e;var t=this._lights.length>0?this.getLighting():this.getOrCreateMaterialDiffuseColor(),i=this.getOrCreateMaterialEmission();if(i){var r=this.createVariable("vec3");this.getNode("Add").inputs(t,i).outputs(r),t=r}var a=this.getDiffuseColorFromTextures();if(a){var n=this.createVariable("vec3");this.getNode("Mult").inputs(t,a).outputs(n),t=n}var o=this.getAlpha();t=this.getPremultAlpha(t,o);var s=this.getNode("glFragColor");return this.applyPointSizeCircle(s),this.getNode("SetAlpha").inputs({color:t,alpha:o}).outputs({result:s}),e.push(s),e},getAlpha:function(){var e=this.createVariable("float"),t=this.getFirstValidTexture(),i={color:this.getOrCreateMaterialDiffuseColor()};t&&(i.texelAlpha=t);var r=t?"%alpha = %color.a * %texelAlpha.a;":"%alpha = %color.a;";return this._isBillboard&&(r+="if ( %alpha == 0.0) discard;"),this.getNode("InlineCode").code(r).inputs(i).outputs({alpha:e}),e},getOrCreateFrontViewTangent:function(){var e=this._variables.frontViewTangent;return e||(e=this.createVariable("vec4","frontViewTangent"),this.getNode("FrontNormal").inputs({normal:this.getOrCreateViewTangent()}).outputs({result:e}),e)},getOrCreateFrontViewNormal:function(){var e=this._variables.frontViewNormal;return e||(e=this.createVariable("vec3","frontViewNormal"),this.getNode("FrontNormal").inputs({normal:this.getOrCreateViewNormal()}).outputs({result:e}),e)},getOrCreateNormalizedViewEyeDirection:function(){var e=this._variables.eyeVector;return e||(e=this.createVariable("vec3","eyeVector"),this.getNode("SetFromNode").inputs(this.getOrCreateViewVertex()).outputs(e),this.getNode("Normalize").inputs({vec:e}).outputs({result:e}),this.getNode("Mult").inputs(e,this.createVariable("float").setValue("-1.0")).outputs(e),e)},getOrCreateNormalizedFrontViewNormal:function(){var e=this._variables.nFrontViewNormal;return e||(e=this.createVariable("vec3","nFrontViewNormal"),this.getNode("Normalize").inputs({vec:this.getOrCreateFrontViewNormal()}).outputs({result:e}),e)},getOrCreateFrontModelNormal:function(){var e=this._variables.frontModelNormal;return e||(e=this.createVariable("vec3","frontModelNormal"),this.getNode("FrontNormal").inputs({normal:this.getOrCreateModelNormal()}).outputs({result:e}),e)},getOrCreateNormalizedFrontModelNormal:function(){var e=this._variables.nFrontModelNormal;return e||(e=this.createVariable("vec3","nFrontModelNormal"),this.getNode("Normalize").inputs({vec:this.getOrCreateFrontModelNormal()}).outputs({result:e}),e)},getPremultAlpha:function(e,t){if(void 0===t)return e;var i=this.createVariable("vec4");return this.getNode("PreMultAlpha").inputs({color:e,alpha:t}).outputs({result:i}),i},getColorsRGB:function(e){var t=this.createVariable("vec3");return this.getNode("LinearTosRGB").inputs({color:e}).outputs({color:t}),t},multiplyDiffuseWithVertexColor:function(e){var t=this.getOrCreateVarying("vec4","vVertexColor"),i=this.getOrCreateUniform("float","uArrayColorEnabled"),r=this.createVariable("vec4"),a=["","%color = %diffuse;","if ( %hasVertexColor == 1.0)","  %color *= %vertexColor;"].join("\n");return this.getNode("InlineCode").code(a).inputs({diffuse:e,hasVertexColor:i,vertexColor:t}).outputs({color:r}).comment("diffuse color = diffuse color * vertex color"),r},getDiffuseColorFromTextures:function(){var e=[],t=this._texturesByName;for(var i in t){t[i].shadow||e.push(this.getTextureByName(i).variable)}if(e.length>1){var r=this.createVariable("vec3","texDiffuseAccum");return this.getNode("Mult").inputs(e).outputs(r),r}if(1===e.length)return e[0]},getFirstValidTexture:function(){for(var e=this._textures,t=0,i=e.length;t<i;++t){var r=e[t];if(r)return this.getTextureByName(r.getName()).variable}},_getShadowReceiveAttributeFromLightNum:function(e,t){for(var i=0;i<e.length;i++){var r=e[i];if(r&&r.getLightNumber()===t)return r}},_getShadowTextureFromLightNum:function(e,t){for(var i=0;i<e.length;i++){var r=e[i];if(r&&r.hasLightNumber(t))return r}},getInputsFromShadow:function(e,t,i,r){var a=e.getOrCreateUniforms(),n=this._shadowsTextures.indexOf(t),o=t.getOrCreateUniforms(n),s=e.getAtlas()?"_"+r:"",u={lighted:i,normalWorld:this.getOrCreateNormalizedFrontModelNormal(),vertexWorld:this.getOrCreateModelVertex(),shadowTexture:this.getOrCreateSampler("sampler2D","Texture"+n),shadowSize:this.getOrCreateUniform(o.RenderSize),shadowProjection:this.getOrCreateUniform(o["Projection"+s]),shadowViewRight:this.getOrCreateUniform(o["ViewRight"+s]),shadowViewUp:this.getOrCreateUniform(o["ViewUp"+s]),shadowViewLook:this.getOrCreateUniform(o["ViewLook"+s]),shadowDepthRange:this.getOrCreateUniform(o["DepthRange"+s]),shadowBias:this.getOrCreateUniform(a.bias)};return e.getAtlas()&&(u.atlasSize=this.getOrCreateUniform(o["MapSize"+s])),e.getNormalBias()&&(u.normalBias=this.getOrCreateUniform(a.normalBias)),u},getOrCreateDistanceShadow:function(e){if(this._computeShadowOutDistance){var t="shadowDistance"+e,i=this.getVariable(t);return i||(i=this.createVariable("float",t).setValue("0.0")),i}},getOrCreateJitterShadow:function(){return!1},hasLightShadow:function(e){var t=this._getShadowTextureFromLightNum(this._shadowsTextures,e),i=this._getShadowReceiveAttributeFromLightNum(this._shadows,e);return!!t&&!!i},createShadowingLight:function(e,t){var i=e.getLightNumber(),r=this._getShadowTextureFromLightNum(this._shadowsTextures,i),a=this._getShadowReceiveAttributeFromLightNum(this._shadows,i);if(r&&a){var n=this.getInputsFromShadow(a,r,t,i),o=this.createVariable("float"),s={result:o},u=a.getDefines(),l=this.getOrCreateDistanceShadow(i);l&&(s.outDistance=l,u.push("#define _OUT_DISTANCE"));var c=this.getOrCreateJitterShadow(i);return c&&(n.jitter=c),this.getNode("ShadowReceive").inputs(n).outputs(s).addDefines(u),o}},getOrCreateMaterialNormal:function(){return this.getOrCreateNormalizedFrontViewNormal()},getOrCreateMaterialDiffuseColor:function(){var e=this.getVariable("materialDiffuseColor");if(e)return e;e=this.createVariable("vec4","materialDiffuseColor");var t=this.getOrCreateUniform(this._material.getOrCreateUniforms().diffuse);return this.getNode("Mult").inputs(this.multiplyDiffuseWithVertexColor(t)).outputs(e),e},getOrCreateMaterialEmission:function(){return this.getOrCreateUniform(this._material.getOrCreateUniforms().emission)},getOrCreateMaterialSpecularColor:function(){return this.getOrCreateUniform(this._material.getOrCreateUniforms().specular)},getOrCreateMaterialSpecularHardness:function(){return this.getOrCreateUniform(this._material.getOrCreateUniforms().shininess)},getOrCreateMaterialAmbient:function(){return this.getOrCreateUniform(this._material.getOrCreateUniforms().ambient)},getLighting:function(){if(0!==this._lights.length){var e=this.getLightingSeparate(),t=this.createVariable("vec3");return this.getNode("Add").inputs(e.diffuse,e.specular).outputs(t),t}},getLightingSeparate:function(){if(0!==this._lights.length){for(var e=[],t=[],i=0;i<this._lights.length;i++){var r=this._lights[i],a=this.getLightSeparate(r);e.push(a.diffuseOut),t.push(a.specularOut)}var n,o;return 1===this._lights.length?(n=e[0],o=t[0]):(n=this.createVariable("vec3"),this.getNode("Add").inputs(e).outputs(n),o=this.createVariable("vec3"),this.getNode("Add").inputs(t).outputs(o)),{diffuse:n,specular:o}}},getLightSeparate:function(e){var t=this.getPrecomputeLight(e),i=this.getLightWithPrecompute(e,t),r=this.createShadowingLight(e,i.lighted);r&&(this.getNode("Mult").inputs(i.diffuseOut,r).outputs(i.diffuseOut),this.getNode("Mult").inputs(i.specularOut,r).outputs(i.specularOut));var a=this.getAmbientLight(e);return a&&this.getNode("Add").inputs(i.diffuseOut,a).outputs(i.diffuseOut),{diffuseOut:i.diffuseOut,specularOut:i.specularOut,lighted:i.lighted,attenuation:t.attenuation,eyeLightDir:t.eyeLightDir,dotNL:t.dotNL}},getPrecomputeLight:function(e){var t,i=e.getOrCreateUniforms(),a={attenuation:this.createVariable("float"),eyeLightDir:this.createVariable("vec3"),dotNL:this.createVariable("float")},n={normal:this.getOrCreateMaterialNormal()},o=e.getLightType();return o===r.a.POINT?(t="PrecomputePoint",n.viewVertex=this.getOrCreateViewVertex(),n.lightAttenuation=this.getOrCreateUniform(i.attenuation),n.lightViewPosition=this.getOrCreateUniform(i.viewPosition)):o===r.a.SPOT?(t="PrecomputeSpot",n.viewVertex=this.getOrCreateViewVertex(),n.lightViewDirection=this.getOrCreateUniform(i.viewDirection),n.lightAttenuation=this.getOrCreateUniform(i.attenuation),n.lightSpotCutOff=this.getOrCreateUniform(i.spotCutOff),n.lightSpotBlend=this.getOrCreateUniform(i.spotBlend),n.lightViewPosition=this.getOrCreateUniform(i.viewPosition)):(t="PrecomputeSun",n.lightViewDirection=this.getOrCreateUniform(i.viewDirection)),this.getNode(t).inputs(n).outputs(a),a},getLightWithPrecompute:function(e,t){var i=e.getOrCreateUniforms(),a={normal:this.getOrCreateMaterialNormal(),eyeVector:this.getOrCreateNormalizedViewEyeDirection(),dotNL:t.dotNL,attenuation:t.attenuation,materialDiffuse:this.getOrCreateMaterialDiffuseColor(),materialSpecular:this.getOrCreateMaterialSpecularColor(),materialShininess:this.getOrCreateMaterialSpecularHardness(),lightDiffuse:this.getOrCreateUniform(i.diffuse),lightSpecular:this.getOrCreateUniform(i.specular),eyeLightDir:t.eyeLightDir},n="ComputeLightLambertCookTorrance";e.getLightType()===r.a.HEMI&&(a.lightGround=this.getOrCreateUniform(i.ground),n="HemiLight");var o=this.getOutputsFromLight();return this.getNode(n).inputs(a).outputs(o),o},getAmbientLight:function(e){var t=this.createVariable("vec3"),i=this.getOrCreateUniform(e.getOrCreateUniforms().ambient),r=this.getOrCreateMaterialAmbient();return this.getNode("Mult").inputs(r,i).outputs(t),t},getOutputsFromLight:function(){var e={diffuseOut:this.createVariable("vec3"),specularOut:this.createVariable("vec3"),lighted:this.createVariable("bool")};return e.lighted.silenceWarning=!0,e},createTextureRGBA:function(e,t,i){var r=this.createVariable("vec4");return this.getNode("TextureRGBA").inputs({tex:t,uv:i}).outputs({result:r}),r}};for(var o in n)n[o]=function(e,t){return function(){return this._fragmentShaderMode||this.logError("This function should not be called from vertex shader : "+t),e.apply(this,arguments)}}(n[o],o);t.a=n},function(e,t,i){"use strict";var r=i(826),a=i(546),n=function(e){this._selectables=e,this._nodeList=[],this._linkList=[],this._renderBinMap=new window.Map,this._renderBinStack=[],this._generatorID=0,this._refID=0,this._uniqueEdges=new window.Set};n.prototype={getColorFromClassName:r.a.prototype.getColorFromClassName,createGraph:function(e){this.reset(),this.apply(e)},reset:function(){this._renderBinMap.clear(),this._renderBinStack.length=0,this._generatorID=0,this._refID++,this._nodeList.length=0,this._linkList.length=0,this._uniqueEdges.clear()},apply:function(e){var t=e.getInstanceID();if(this._renderBinMap.has(t)||this._renderBinMap.set(t,e),this._renderBinStack.push(e),e.getPreRenderStageList)for(var i=e.getPreRenderStageList(),r=0,a=i.length;r<a;++r)this.apply(i[r].renderStage);if(this.registerNode(e),e.getPostRenderStageList)for(var n=e.getPostRenderStageList(),o=0,s=n.length;o<s;++o)this.apply(n[o].renderStage);this._renderBinStack.pop()},registerNode:function(e){var t=e.getInstanceID();if(this._nodeList.push(e),e._bins.forEach(function(e,t){this.apply(t)}.bind(this)),e._leafs.length)for(var i=0,r=e._leafs.length;i<r;i++)this.createNodeAndSetID(t,e._leafs[i]);var a=this,n={},o=function(e){a.createNodeAndSetID(this.stateGraphID,e)}.bind(n),s=function(e){a.createNodeAndSetID(t,e);var i=e._instanceID,r=e.getLeafs();n.stateGraphID=i,r.forEach(o)};if(e.getStateGraphList().forEach(s),!(this._renderBinStack.length<2)){var u=this._renderBinStack[this._renderBinStack.length-2].getInstanceID();this.createLink(u,t)}},createLink:function(e,t){var i=e+"+"+t;this._uniqueEdges.has(i)||(this._linkList.push({parentNode:e,childrenNode:t}),this._uniqueEdges.add(i))},createNodeAndSetID:function(e,t){this._nodeList.push(t),(void 0===t._instanceID||t._instanceID<0&&t._refID!==this._refID)&&(t._instanceID=-1-this._generatorID++,t._refID=this._refID),this.createLink(e,t._instanceID)},generateRenderLeaf:function(e,t){var i=t._instanceID,r=t._geometry&&t._geometry.getName()?"\n"+t._geometry.getName():"Geometry",a="RenderLeaf ( "+t._instanceID+" )";a+="\n"+r+" ( "+t._geometry.getInstanceID()+" )",this._selectables.set(i.toString(),t),e.addNode(i,{label:a,description:"",style:"fill: "+this.getColorFromClassName("RenderLeaf")+";stroke-width: 0px;"})},generateStateGraph:function(e,t){var i=t._instanceID,r="StateGraph ( "+t._instanceID+" )";r+="\n"+t._leafs._length+" leafs",this._selectables.set(i.toString(),t),e.addNode(i,{label:r,description:"",style:"fill: "+this.getColorFromClassName("StateGraph")+";stroke-width: 0px;"})},generateRenderStage:function(e,t){var i=t.className()+" ( "+t._instanceID+" )";t.getName()&&(i+="\n"+t.getName()),i+="\nViewport ( "+t.getViewport().width()+" x "+t.getViewport().height()+" )",this._selectables.set(t.getInstanceID().toString(),t),e.addNode(t.getInstanceID(),{label:i,description:"",style:"fill: "+this.getColorFromClassName(t.className())+";stroke-width: 0px;"})},generateRenderBin:function(e,t){var i=t.className()+" ( "+t.getInstanceID()+" )";t.getName()&&(i+="\n"+t.getName());var r="";t.getSortMode()===a.a.SORT_BACK_TO_FRONT&&(r="SortMode: BackToFront");var n="BinNumber: "+t.getBinNumber()+"\n"+r;this._selectables.set(t.getInstanceID().toString(),t),e.addNode(t.getInstanceID(),{label:i,description:n,style:"fill: "+this.getColorFromClassName(t.className())+";stroke-width: 0px;"})},generateNodeAndLink:function(e){for(var t=0,i=this._nodeList.length;t<i;t++){var r=this._nodeList[t];r._geometry&&void 0!==r._depth?this.generateRenderLeaf(e,r):"StateGraph"===r.className()?this.generateStateGraph(e,r):"RenderStage"===r.className()?this.generateRenderStage(e,r):this.generateRenderBin(e,r)}for(var a=0,n=this._linkList.length;a<n;a++)e.addEdge(null,this._linkList[a].parentNode,this._linkList[a].childrenNode)}},t.a=n},function(e,t,i){"use strict";var r=i(98),a=i(54),n=i(143),o=i(249),s=i(247),u=i(450),l=i(72),c=i(10),h=i(550),d=i(551),p=i(828),f=i(127),m=i(9),g=i(78),_=function(){};_.prototype={cull:function(){return!1}};var v=new s.a(s.a.SRC_ALPHA,s.a.ONE_MINUS_SRC_ALPHA),b=function(e){this._testPlane=e,this._inter=c.f.create(),d.a.call(this)};m.a.createPrototypeObject(b,m.a.objectInherit(d.a.prototype,{setTestPlane:function(e){this._testPlane=e},getTranslateDistance:function(){return this._inter},enter:function(){var e=c.f.create(),t=c.f.create();return function(i){if(void 0===i._nbAxis)return!0;if(c.f.init(e),e[i._nbAxis]=1,this._testPlane){var r=c.f.dot(this._iStart,e),a=c.f.dot(this._iEnd,e);if(r===a)return!1;var n=-r/(a-r);this._inter[0]=this._iStart[0]+(this._iEnd[0]-this._iStart[0])*n,this._inter[1]=this._iStart[1]+(this._iEnd[1]-this._iStart[1])*n,this._inter[2]=this._iStart[2]+(this._iEnd[2]-this._iStart[2])*n}else{c.f.normalize(t,c.f.sub(t,this._iEnd,this._iStart));var o=-c.f.dot(t,e),s=c.f.dot(this._iStart,t),u=Math.abs(1-o*o),l=-c.f.dot(this._iStart,e);c.f.init(this._inter),this._inter[i._nbAxis]=(o*s-l)/u}return!1}}(),intersectTriangle:function(){},intersectLine:function(){},intersectPoint:function(){}}),"osgUtil","LineCustomIntersector");var y=c.c.create(),x=function(e){n.a.call(this),this._tmask=1,this._autoInsertMT=!1,this._correctPivotOnAutoInsert=!1,this._viewer=e,this._canvas=e.getGraphicContext().canvas,this._rotateNode=new n.a,this._translateNode=new n.a,this._planeNode=new n.a,this._rotateInLocal=!0,this._translateInLocal=!0,this._showAngle=new n.a,this._downCanvasCoord=c.e.create(),this._hoverNode=null,this._keepHoverColor=c.g.create(),this._isEditing=!1,this._editLineOrigin=c.f.create(),this._editLineDirection=c.f.create(),this._editOffset=c.f.create(),this._editLocal=c.c.create(),this._editWorldTrans=c.c.create(),this._editWorldScaleRot=c.c.create(),this._editInvWorldScaleRot=c.c.create(),this._debugNode=new r.a,this._lastDistToEye=0,this._attachedNode=null,this._pivotOffset=c.f.create(),this.attachToNode(null),this._lsi=new b,this._origIntersect=c.f.create(),this._dstIntersect=c.f.create(),this._iv=new h.a,this._iv.setIntersector(this._lsi),this.init()};x.NO_PICK=1,x.PICK_ARC_X=2,x.PICK_ARC_Y=4,x.PICK_ARC_Z=8,x.PICK_ARROW_X=16,x.PICK_ARROW_Y=32,x.PICK_ARROW_Z=64,x.PICK_PLANE_X=128,x.PICK_PLANE_Y=256,x.PICK_PLANE_Z=512,x.NO_FULL_CIRCLE=1024,x.CORRECT_PIVOT=2048,x.PICK_ARC=x.PICK_ARC_X|x.PICK_ARC_Y|x.PICK_ARC_Z,x.PICK_ARROW=x.PICK_ARROW_X|x.PICK_ARROW_Y|x.PICK_ARROW_Z,x.PICK_PLANE=x.PICK_PLANE_X|x.PICK_PLANE_Y|x.PICK_PLANE_Z,x.PICK_GIZMO=x.PICK_ARC|x.PICK_ARROW|x.PICK_PLANE;var S=function(){a.a.call(this,a.a.TRAVERSE_PARENTS),this._editableNode=null};m.a.createPrototypeObject(S,m.a.objectInherit(a.a.prototype,{reset:function(){a.a.prototype.reset.call(this),this._editableNode=null},getEditableNode:function(){return this._editableNode},apply:function(e){if(!this._editableNode){var t=e.editMask;if(t&&t&x.PICK_GIZMO)return void(this._editableNode=e);this.traverse(e)}}})),m.a.createPrototypeNode(x,m.a.objectInherit(n.a.prototype,{setRotateInLocal:function(e){this._rotateInLocal=e},setTranslateInLocal:function(e){this._translateInLocal=e},setTraversalMask:function(e){this._tmask=e},setAutoMatrixTransformInsertion:function(e){this._autoInsertMT=e},setCorrectPivotOnAutoInsert:function(e){this._correctPivotOnAutoInsert=e},isEditing:function(){return this._isEditing},getAttachedNode:function(){return this._attachedNode},init:function(){this.getOrCreateStateSet().setAttributeAndModes(new o.a(o.a.DISABLE)),this.getOrCreateStateSet().setAttributeAndModes(new u.a(u.a.DISABLE)),this.addUpdateCallback(this),this.addChild(this.initNodeTranslate()),this.addChild(this.initNodeTranslatePlane()),this.addChild(this.initNodeRotate()),this._debugNode&&(this._debugNode.addChild(p.a.createDebugLineGeometry()),this.addChild(this._debugNode),this._debugNode.setNodeMask(0));var e=this._viewer.getInputManager();e.group(g.a.NODE_GIZMO).addMappings({onMouseMove:"mousemove",onMouseDown:"mousedown",onMouseUp:["mouseup","mouseout"]},this),e.setPriority(g.a.NODE_GIZMO,e.getHigherPriority(g.a.MANIPULATORS))},_insertEditNode:function(e,t){var i=new n.a;return i.editMask=x.PICK_GIZMO,this._correctPivotOnAutoInsert&&(i.editMask|=x.CORRECT_PIVOT),e.addChild(i),e.removeChild(t),i.addChild(t),i._isInserted=!0,i},_findEditNodeFromNodePath:function(e){if(!e)return null;var t=e[e.length-1];if(t.editMask)return t;if(!this._autoInsertMT){for(var i=e.length-1;i>=0;--i){var r=e[i].editMask;if(r&&r&x.PICK_GIZMO)return e[i]}return null}var a=e[e.length-2];return a.editMask?a:this._insertEditNode(a,t)},_findEditNodeFromNode:function(e){if(!e)return null;if(e.editMask)return e;if(this._autoInsertMT){for(var t=e.getParents(),i=0;i<t.length;++i){var r=t[i].editMask;if(r&&r&x.PICK_GIZMO)return t[i]}return this._insertEditNode(t[0],e)}return this._getEditNodeVisitor?this._getEditNodeVisitor.reset():this._getEditNodeVisitor=new S,e.accept(this._getEditNodeVisitor),this._getEditNodeVisitor.getEditableNode()},attachToNodePath:function(e){var t=this._findEditNodeFromNodePath(e);this._attachEditNode(t,e&&e[e.length-1])},attachToNode:function(e){var t=this._findEditNodeFromNode(e);this._attachEditNode(t,e)},_attachEditNode:function(e,t){this._attachedNode=e,e&&t&&t!==e&&e.editMask&x.CORRECT_PIVOT&&c.f.copy(this._pivotOffset,t.getBoundingSphere().center()),this.updateGizmoMask()},updateGizmoMask:function(){if(!this._attachedNode)return c.f.init(this._pivotOffset),void this.setNodeMask(0);var e=this._attachedNode.editMask;this.setNodeMask(e&x.PICK_GIZMO?x.NO_PICK:0),this._translateNode.setNodeMask(e&x.PICK_ARROW?x.PICK_ARROW:0),this._rotateNode.setNodeMask(e&x.PICK_ARC?x.PICK_ARC:0),this._planeNode.setNodeMask(e&x.PICK_PLANE?x.PICK_PLANE:0);var t=this._translateNode.getChildren();t[0].setNodeMask(e&x.PICK_ARROW_X?x.PICK_ARROW_X:0),t[1].setNodeMask(e&x.PICK_ARROW_Y?x.PICK_ARROW_Y:0),t[2].setNodeMask(e&x.PICK_ARROW_Z?x.PICK_ARROW_Z:0);var i=this._rotateNode.getChildren();i[0].setNodeMask(e&x.NO_FULL_CIRCLE?0:x.NO_PICK),i[1].setNodeMask(e&x.PICK_ARC_X?x.PICK_ARC_X:0),i[2].setNodeMask(e&x.PICK_ARC_Y?x.PICK_ARC_Y:0),i[3].setNodeMask(e&x.PICK_ARC_Z?x.PICK_ARC_Z:0);var r=this._planeNode.getChildren();r[0].setNodeMask(e&x.PICK_PLANE_X?x.PICK_PLANE_X:0),r[1].setNodeMask(e&x.PICK_PLANE_Y?x.PICK_PLANE_Y:0),r[2].setNodeMask(e&x.PICK_PLANE_Z?x.PICK_PLANE_Z:0)},onNodeHovered:function(){var e=c.g.fromValues(1,1,0,1);return function(t){if(this._hoverNode&&this._hoverNode.getStateSet().getUniform("uColor").setFloat4(this._keepHoverColor),!t)return void(this._hoverNode=null);for(var i=t._nodePath,r=i.length-1,a=i[r];void 0===a._nbAxis;){if(0===r)return;a=i[--r]}var n=a.getStateSet().getUniform("uColor");this._hoverNode=a,c.g.copy(this._keepHoverColor,n.getInternalArray()),n.setFloat4(e)}}(),initNodeRotate:function(){var e=p.a.createTorusGeometry(1,.01,6,64,2*Math.PI),t=p.a.createTorusGeometry(1,.01,6,64,Math.PI),i=p.a.createTorusGeometry(1,.1,6,64,Math.PI),a=new n.a,o=new n.a,s=new n.a,u=new n.a;o._nbAxis=0,s._nbAxis=1,u._nbAxis=2;var h=new r.a;h.setCullCallback(new _),h.addChild(i),e.setNodeMask(x.NO_PICK),t.setNodeMask(x.NO_PICK),o.setNodeMask(x.PICK_ARC_X),s.setNodeMask(x.PICK_ARC_Y),u.setNodeMask(x.PICK_ARC_Z),a.addChild(e),o.addChild(t),s.addChild(t),u.addChild(t),o.addChild(h),s.addChild(h),u.addChild(h),a.getOrCreateStateSet().addUniform(l.a.createFloat4(c.g.fromValues(.2,.2,.2,1),"uColor")),o.getOrCreateStateSet().addUniform(l.a.createFloat4(c.g.fromValues(1,0,0,1),"uColor")),s.getOrCreateStateSet().addUniform(l.a.createFloat4(c.g.fromValues(0,1,0,1),"uColor")),u.getOrCreateStateSet().addUniform(l.a.createFloat4(c.g.fromValues(0,0,1,1),"uColor"));var d=this._showAngle;d.getOrCreateStateSet().setAttributeAndModes(v),d.setNodeMask(0),d.getOrCreateStateSet().addUniform(l.a.createFloat3(c.f.fromValues(1,0,0),"uBase")),d.getOrCreateStateSet().addUniform(l.a.createFloat(0,"uAngle")),d.addChild(p.a.createQuadCircleGeometry());var f=this._rotateNode;return f.setNodeMask(x.PICK_ARC),f.addChild(a),f.addChild(o),f.addChild(s),f.addChild(u),f.addChild(d),f},initNodeTranslate:function(){var e=new n.a;c.c.fromTranslation(e.getMatrix(),c.f.fromValues(0,0,1.65)),e.addChild(p.a.createCylinderGeometry(0,.07,.3,32,1,!0,!0));var t=new n.a;c.c.fromTranslation(t.getMatrix(),c.f.fromValues(0,0,.75)),t.addChild(p.a.createCylinderGeometry(.01,.01,1.5,32,1,!0,!0));var i=new r.a;i.addChild(t),i.addChild(e);var a=p.a.createCylinderGeometry(.1,.1,1.3*1.1,32,1,!0,!0),o=new n.a,s=new n.a,u=new n.a;o._nbAxis=0,s._nbAxis=1,u._nbAxis=2,c.c.fromRotation(o.getMatrix(),.5*Math.PI,c.f.fromValues(0,1,0)),c.c.fromRotation(s.getMatrix(),.5*-Math.PI,c.f.fromValues(1,0,0));var h=new n.a;h.setCullCallback(new _),c.c.fromTranslation(h.getMatrix(),c.f.fromValues(0,0,1.215)),h.addChild(a),i.setNodeMask(x.NO_PICK),o.setNodeMask(x.PICK_ARROW_X),s.setNodeMask(x.PICK_ARROW_Y),u.setNodeMask(x.PICK_ARROW_Z),o.addChild(i),s.addChild(i),u.addChild(i),o.addChild(h),s.addChild(h),u.addChild(h),o.getOrCreateStateSet().addUniform(l.a.createFloat4(c.g.fromValues(1,0,0,1),"uColor")),s.getOrCreateStateSet().addUniform(l.a.createFloat4(c.g.fromValues(0,1,0,1),"uColor")),u.getOrCreateStateSet().addUniform(l.a.createFloat4(c.g.fromValues(0,0,1,1),"uColor"));var d=this._translateNode;return d.setNodeMask(x.PICK_ARROW),d.addChild(o),d.addChild(s),d.addChild(u),d},initNodeTranslatePlane:function(){var e=new n.a;c.c.fromTranslation(e.getMatrix(),c.f.fromValues(.5,.5,0)),c.c.mul(e.getMatrix(),c.c.fromScaling(c.c.create(),c.f.fromValues(.5,.5,1)),e.getMatrix()),e.addChild(p.a.createPlaneGeometry());var t=new n.a,i=new n.a,r=new n.a;t._nbAxis=0,i._nbAxis=1,r._nbAxis=2,c.c.fromRotation(t.getMatrix(),.5*-Math.PI,c.f.fromValues(0,1,0)),c.c.fromRotation(i.getMatrix(),.5*Math.PI,c.f.fromValues(1,0,0)),t.setNodeMask(x.PICK_PLANE_X),i.setNodeMask(x.PICK_PLANE_Y),r.setNodeMask(x.PICK_PLANE_Z),t.addChild(e),i.addChild(e),r.addChild(e),t.getOrCreateStateSet().addUniform(l.a.createFloat4(c.g.fromValues(1,0,0,.3),"uColor")),i.getOrCreateStateSet().addUniform(l.a.createFloat4(c.g.fromValues(0,1,0,.3),"uColor")),r.getOrCreateStateSet().addUniform(l.a.createFloat4(c.g.fromValues(0,0,1,.3),"uColor"));var a=this._planeNode;return a.setNodeMask(x.PICK_PLANE),a.getOrCreateStateSet().setAttributeAndModes(v),a.addChild(t),a.addChild(i),a.addChild(r),a},updateArcRotation:function(){var e=c.d.create(),t=c.d.setAxisAngle(c.d.create(),[0,1,0],.5*-Math.PI),i=c.d.setAxisAngle(c.d.create(),[1,0,0],.5*-Math.PI);return function(r){var a=this._rotateNode,n=a.getChildren();e[0]=-r[1],e[1]=r[0],e[2]=0,e[3]=1+r[2],c.d.normalize(e,e),c.c.fromQuat(n[0].getMatrix(),e),c.d.setAxisAngle(e,[1,0,0],Math.atan2(r[2],r[1])),c.d.mul(e,e,t),c.c.fromQuat(n[1].getMatrix(),e),c.d.setAxisAngle(e,[0,1,0],Math.atan2(-r[0],-r[2])),c.d.mul(e,e,i),c.c.fromQuat(n[2].getMatrix(),e),c.d.setAxisAngle(e,[0,0,1],Math.atan2(-r[0],r[1])),c.c.fromQuat(n[3].getMatrix(),e),n[1].dirtyBound(),n[2].dirtyBound(),n[3].dirtyBound()}}(),getTransformType:function(e){for(var t=e;t.getParents().length>0;){var i=t.referenceFrame;if(void 0!==i&&i===f.a.ABSOLUTE_RF)return f.a.ABSOLUTE_RF;t=t.getParents()[0]}return f.a.RELATIVE_RF},getAttachedNodeWorldMatrix:function(){var e=this._attachedNode.getWorldMatrix(void 0,y);return c.c.translate(e,e,this._pivotOffset)},update:function(){var e=c.f.create(),t=c.f.create(),i=c.f.create(),r=c.c.create();return function(){if(this._attachedNode){var a=this.getTransformType(this._attachedNode);this.setReferenceFrame(a),this.setCullingActive(a===f.a.RELATIVE_RF);var n=this.getAttachedNodeWorldMatrix();c.c.getTranslation(t,n);var o=3;if(a===f.a.ABSOLUTE_RF)e[0]=e[1]=e[2]=0;else{var s=this._viewer.getCamera().getProjectionMatrix(),u=.023*this._canvas.clientWidth*s[0];this._viewer.getManipulator().getEyePosition(e),this._lastDistToEye=this._isEditing?this._lastDistToEye:c.f.distance(t,e),o*=this._lastDistToEye/u}var l=this.getMatrix();if(c.c.fromTranslation(l,t),c.f.set(i,o,o,o),c.c.mul(l,l,c.c.fromScaling(r,i)),c.f.sub(e,e,t),c.f.normalize(e,e),this._rotateInLocal||this._translateInLocal){c.c.getScale(i,n);var h=c.c.fromScaling(r,i);c.c.invert(h,h);var d=c.c.mul(n,n,h);d[12]=d[13]=d[14]=0,this._translateInLocal&&(c.c.copy(this._translateNode.getMatrix(),d),c.c.copy(this._planeNode.getMatrix(),d)),this._rotateInLocal&&(c.c.copy(this._rotateNode.getMatrix(),d),c.c.invert(d,d),c.f.transformMat4(e,e,d))}else c.c.identity(this._rotateNode.getMatrix());this.updateArcRotation(e),this._rotateNode.dirtyBound(),this._translateNode.dirtyBound(),this._planeNode.dirtyBound(),this._isEditing&&c.c.copy(this._showAngle.getMatrix(),this._hoverNode.getMatrix())}}}(),computeNearestIntersection:function(){var e=function(e,t){return e._ratio-t._ratio};return function(t,i){var r=this._viewer,a=this._canvas,n=t.canvasX*(r._canvasWidth/a.clientWidth),o=(a.clientHeight-t.canvasY)*(r._canvasHeight/a.clientHeight),s=this._viewer.computeIntersections(n,o,i);if(0!==s.length)return s.sort(e),s[0]}}(),setOnlyGizmoPicking:function(){this._viewer.getCamera().addChild(this),this._viewer.getSceneData().setNodeMask(0),this.setNodeMask(-1)},setOnlyScenePicking:function(){this._viewer.getCamera().removeChild(this),this._viewer.getSceneData().setNodeMask(-1),this.setNodeMask(x.NO_PICK)},pickGizmo:function(e,t){this.setOnlyGizmoPicking();var i=this.computeNearestIntersection(e,t);return this.setOnlyScenePicking(),i},getCanvasPositionFromWorldPoint:function(){var e=c.c.create();return function(t,i){var r=this._viewer.getCamera(),a=i;r.getViewport()?r.getViewport().computeWindowMatrix(e):c.c.identity(e),c.c.mul(e,e,r.getProjectionMatrix()),this.getReferenceFrame()===f.a.RELATIVE_RF&&c.c.mul(e,e,r.getViewMatrix()),c.f.transformMat4(a,t,e);var n=this._viewer,o=this._canvas;return a[0]=a[0]/(n._canvasWidth/o.clientWidth),a[1]=o.clientHeight-a[1]/(n._canvasHeight/o.clientHeight),a}}(),onMouseDown:function(e){if(c.e.set(this._downCanvasCoord,e.canvasX,e.canvasY),this._hoverNode&&this._attachedNode){this._viewer.setEnableManipulator(!1),this.saveEditMatrices();var t=this._hoverNode.getParents()[0].getNodeMask();this._isEditing=!0,t&x.PICK_ARC?(this._translateNode.setNodeMask(0),this._planeNode.setNodeMask(0),this.startRotateEdit(e)):t&x.PICK_ARROW?(this._rotateNode.setNodeMask(0),this._planeNode.setNodeMask(0),this.startTranslateEdit(e)):t&x.PICK_PLANE&&(this._rotateNode.setNodeMask(0),this._translateNode.setNodeMask(0),this.startPlaneEdit(e))}},saveEditMatrices:function(){c.c.copy(this._editLocal,this._attachedNode.getMatrix());var e=this.getAttachedNodeWorldMatrix();c.c.fromTranslation(this._editWorldTrans,c.f.fromValues(e[12],e[13],e[14])),c.c.copy(this._editWorldScaleRot,e),this._editWorldScaleRot[12]=this._editWorldScaleRot[13]=this._editWorldScaleRot[14]=0,c.c.invert(this._editInvWorldScaleRot,this._editWorldScaleRot)},startRotateEdit:function(e){var t=this._rotateNode.getWorldMatrix(void 0,y),i=c.f.create();c.f.transformMat4(i,i,t),this.getCanvasPositionFromWorldPoint(i,i);var r=this.pickGizmo(e,this._hoverNode.getNodeMask()|x.PICK_ARC);if(r){var a=0===this._hoverNode._nbAxis?-1:1,n=c.f.create();n[0]=a*r._localIntersectionPoint[1],n[1]=-a*r._localIntersectionPoint[0],n[2]=r._localIntersectionPoint[2];var o=c.f.create();c.f.transformMat4(o,n,this._hoverNode.getMatrix()),c.f.transformMat4(o,o,t),this.getCanvasPositionFromWorldPoint(o,o);var s=this._editLineDirection;c.e.sub(s,o,i),c.e.normalize(s,s),this._showAngle.setNodeMask(x.NO_PICK),r._localIntersectionPoint[2]=0;var u=this._showAngle.getStateSet();u.getUniform("uAngle").setFloat(0),u.getUniform("uBase").setVec3(c.f.normalize(r._localIntersectionPoint,r._localIntersectionPoint)),this._editLineOrigin[0]=e.canvasX,this._editLineOrigin[1]=e.canvasY}},startTranslateEdit:function(e){var t=this._editLineOrigin,i=this._editLineDirection,r=this._translateNode.getWorldMatrix(void 0,y);c.c.getTranslation(t,r),c.f.init(i),i[this._hoverNode._nbAxis]=1,this._translateInLocal&&(c.f.transformMat4(i,i,this._editWorldScaleRot),c.f.normalize(i,i)),c.f.add(i,t,i),this.getCanvasPositionFromWorldPoint(t,t),this.getCanvasPositionFromWorldPoint(i,i),c.e.sub(i,i,t),c.e.normalize(i,i);var a=this._editOffset;c.e.set(a,e.canvasX,e.canvasY),c.e.sub(a,a,t)},startPlaneEdit:function(e){var t=this._editLineOrigin,i=this._planeNode.getWorldMatrix(void 0,y);c.c.getTranslation(t,i),this.getCanvasPositionFromWorldPoint(t,t);var r=this._editOffset;c.e.set(r,e.canvasX,e.canvasY),c.e.sub(r,r,t)},drawLineCanvasDebug:function(e,t,i,r){this._debugNode.setNodeMask(x.NO_PICK);var a=this._debugNode.getChildren()[0].getAttributes().Vertex;a.getElements()[0]=e/this._canvas.clientWidth*2-1,a.getElements()[1]=(this._canvas.clientHeight-t)/this._canvas.clientHeight*2-1,a.getElements()[2]=i/this._canvas.clientWidth*2-1,a.getElements()[3]=(this._canvas.clientHeight-r)/this._canvas.clientHeight*2-1,a.dirty()},pickAndSelect:function(e){this.setNodeMask(0);var t=this.computeNearestIntersection(e,this._tmask);this.attachToNodePath(t?t._nodePath:t)},onMouseUp:function(e){this._viewer.setEnableManipulator(!0),this._debugNode&&this._debugNode.setNodeMask(0);var t=c.e.fromValues(e.canvasX,e.canvasY);0===c.e.distance(t,this._downCanvasCoord)&&this.pickAndSelect(e),this._showAngle.setNodeMask(0),this._isEditing=!1,this._hoverNode&&this.updateGizmoMask()},onMouseMove:function(e){if(this._attachedNode){var t;if(!1===this._isEditing)return t=this.pickGizmo(e,x.PICK_GIZMO),void this.onNodeHovered(t);if(this._hoverNode){var i=this._hoverNode.getParents()[0];i===this._rotateNode?this.updateRotateEdit(e):i===this._translateNode?this.updateTranslateEdit(e):i===this._planeNode&&this.updatePlaneEdit(e)}}},updateRotateEdit:function(){var e=c.c.create(),t=c.e.create(),i=c.f.fromValues(1,0,0),r=c.f.fromValues(0,1,0),a=c.f.fromValues(0,0,1),n=c.f.create();return function(o){var s=this._editLineOrigin,u=this._editLineDirection;c.e.set(t,o.canvasX,o.canvasY),c.e.sub(t,t,s);var l=c.e.dot(t,u);if(this._debugNode){var h=s[0],d=s[1];this.drawLineCanvasDebug(h,d,h+u[0]*l,d+u[1]*l)}var p=Math.min(this._canvas.clientWidth,this._canvas.clientHeight),f=7*l/p;f%=2*Math.PI;var m=this._hoverNode._nbAxis;0===m?c.c.fromRotation(e,-f,i):1===m?c.c.fromRotation(e,-f,r):2===m&&c.c.fromRotation(e,-f,a),this._showAngle.getOrCreateStateSet().getUniform("uAngle").setFloat(0===m?-f:f),this._rotateInLocal||(c.c.mul(e,this._editInvWorldScaleRot,e),c.c.mul(e,e,this._editWorldScaleRot));var g=this._attachedNode.getMatrix();c.c.translate(g,this._editLocal,this._pivotOffset),c.c.mul(g,g,e),c.c.translate(g,g,c.f.negate(n,this._pivotOffset)),this._attachedNode.dirtyBound()}}(),updateTranslateEdit:function(){var e=c.e.create(),t=c.f.create();return function(i){var r=this._editLineOrigin,a=this._editLineDirection;c.e.set(e,i.canvasX,i.canvasY),c.e.sub(e,e,r),c.e.sub(e,e,this._editOffset);var n=c.e.dot(e,a);e[0]=r[0]+a[0]*n,e[1]=r[1]+a[1]*n,this._debugNode&&this.drawLineCanvasDebug(r[0],r[1],e[0],e[1]);var o=this._viewer,s=this._canvas,u=e[0]*(o._canvasWidth/s.clientWidth),l=(s.clientHeight-e[1])*(o._canvasHeight/s.clientHeight);if(this._lsi.reset(),this._lsi.setTestPlane(!1),this._lsi.set(c.f.set(this._origIntersect,u,l,0),c.f.set(this._dstIntersect,u,l,1)),this._iv.reset(),this._iv.setTraversalMask(this._hoverNode.getNodeMask()),c.c.copy(this.getMatrix(),this._editWorldTrans),this.setOnlyGizmoPicking(),this._viewer._camera.accept(this._iv),this.setOnlyScenePicking(),this._translateInLocal){c.c.getScale(t,this._editInvWorldScaleRot);var h=this._lsi.getTranslateDistance();c.f.mul(t,t,h)}else c.f.transformMat4(t,this._lsi.getTranslateDistance(),this._editInvWorldScaleRot);c.c.translate(this._attachedNode.getMatrix(),this._editLocal,t),this._attachedNode.dirtyBound()}}(),updatePlaneEdit:function(){var e=c.e.create(),t=c.f.create();return function(i){c.e.set(e,i.canvasX,i.canvasY),c.e.sub(e,e,this._editOffset);var r=this._viewer,a=this._canvas,n=e[0]*(r._canvasWidth/a.clientWidth),o=(a.clientHeight-e[1])*(r._canvasHeight/a.clientHeight);if(this._lsi.reset(),this._lsi.setTestPlane(!0),this._lsi.set(c.f.set(this._origIntersect,n,o,0),c.f.set(this._dstIntersect,n,o,1)),this._iv.reset(),this._iv.setTraversalMask(this._hoverNode.getNodeMask()),c.c.copy(this.getMatrix(),this._editWorldTrans),this.setOnlyGizmoPicking(),this._viewer._camera.accept(this._iv),this.setOnlyScenePicking(),this._translateInLocal){c.c.getScale(t,this._editInvWorldScaleRot);var s=this._lsi.getTranslateDistance();c.f.mul(t,t,s)}else c.f.transformMat4(t,this._lsi.getTranslateDistance(),this._editInvWorldScaleRot);c.c.translate(this._attachedNode.getMatrix(),this._editLocal,t),this._attachedNode.dirtyBound()}}()}),"osgUtil","NodeGizmo"),t.a=x},function(e,t,i){"use strict";var r=i(9),a=i(10),n=i(598),o=i(1066),s=function(){n.a.call(this),this._center=a.f.create(),this._iCenter=a.f.create(),this._radius=1,this._iRadius=1};r.a.createPrototypeObject(s,r.a.objectInherit(n.a.prototype,{set:function(e,t){a.f.copy(this._center,e),a.f.copy(this._iCenter,e),this._radius=this._iRadius=t,this.reset()},setCenter:function(e){a.f.copy(this._center,e),a.f.copy(this._iCenter,e)},setRadius:function(e){this._radius=this._iRadius=e},intersectNode:function(e){return this.intersectBoundingSphere(e.getBoundingSphere())},intersectBoundingSphere:function(e){if(!e.valid())return!1;var t=this._iRadius+e.radius();return a.f.sqrDist(e.center(),this._iCenter)<=t*t},intersect:function(){var e=new o.a;return function(t,i){e.setGeometry(i),e.setIntersectionVisitor(t),e.setIntersector(this),e.set(this._iCenter,this._iRadius);var r=i.getShape();r?r.intersect(e,r.getNodes()[0]):(i.computeTransformedVertices&&e.setVertices(i.computeTransformedVertices()),e.apply(i)),e.reset()}}(),setCurrentTransformation:function(){var e=a.f.create();return function(t){a.c.invert(t,t),a.f.transformMat4(this._iCenter,this._center,t),a.c.getScale(e,t);var i=e[0],r=e[1],n=e[2],o=i>r?i>n?i:n:r>n?r:n;this._iRadius=this._radius*o}}()}),"osgUtil","SphereIntersector"),t.a=s},function(e,t,i){"use strict";var r=i(9),a=i(10),n=i(600),o=function(){n.a.Intersection.call(this),this._localIntersectionNormal=a.f.clone(a.f.ONE),this._i1=-1,this._i2=-1,this._i3=-1,this._r1=0,this._r2=0,this._r3=0},s=function(){n.a.apply(this),this._center=void 0,this._radius=0};r.a.createPrototypeObject(s,r.a.objectInherit(n.a.prototype,{set:function(e,t){this._center=e,this._radius=t},enter:function(e){for(var t=this._radius*this._radius,i=0,r=e.getMin(),a=e.getMax(),n=0,o=0;o<3;o++)this._center[o]<r[o]?(n=this._center[o]-r[o],i+=n*n):this._center[o]>a[o]&&(n=this._center[o]-a[o],i+=n*n);return i<=t},intersectPoint:function(e,t){var i=a.f.sqrDist(e,this._center);if(!(i>this._radius*this._radius)){var r=this.initIntersection(new o);r._i1=t,r._r1=1,a.f.copy(r._localIntersectionPoint,e),r._ratio=Math.sqrt(i)/this._radius}},intersectLine:function(){var e=a.f.create(),t=a.f.create();return function(i,r,n,s){a.f.sub(e,this._center,i),a.f.sub(t,r,i);var u=a.f.dot(e,t)/a.f.sqrLen(t),l=1;if(!((l=u<0?a.f.sqrLen(e):u>1?a.f.sqrDist(this._center,r):a.f.sqrLen(a.f.scaleAndAdd(e,e,t,-u)))>this._radius*this._radius)){var c=this.initIntersection(new o);c._i1=n,c._i2=s,c._r1=1-u,c._r2=u,a.f.scaleAndAdd(c._localIntersectionPoint,i,t,u),c._ratio=Math.sqrt(l)/this._radius}}}(),intersectTriangle:function(){var e=a.f.create(),t=a.f.create(),i=a.f.create();return function(r,n,s,u,l,c){if(!this._limitOneIntersection||!this._hit){a.f.sub(e,n,r),a.f.sub(t,s,r);var h=a.f.sqrLen(e),d=a.f.dot(e,t),p=a.f.sqrLen(t);a.f.sub(i,r,this._center);var f=a.f.dot(i,e),m=a.f.dot(i,t),g=a.f.sqrLen(i),_=Math.abs(h*p-d*d);if(!(_<1e-10)){var v,b=d*m-p*f,y=d*f-h*m,x=4;if(b+y<=_)if(b<0)y<0?(x=4,f<0?(y=0,-f>=h?(b=1,v=h+2*f+g):(b=-f/h,v=f*b+g)):(b=0,m>=0?(y=0,v=g):-m>=p?(y=1,v=p+2*m+g):(y=-m/p,v=m*y+g))):(x=3,b=0,m>=0?(y=0,v=g):-m>=p?(y=1,v=p+2*m+g):(y=-m/p,v=m*y+g));else if(y<0)x=5,y=0,f>=0?(b=0,v=g):-f>=h?(b=1,v=h+2*f+g):(b=-f/h,v=f*b+g);else{x=0;var S=1/_;b*=S,y*=S,v=b*(h*b+d*y+2*f)+y*(d*b+p*y+2*m)+g}else{var M,w,T,C;b<0?(x=2,M=d+f,w=p+m,w>M?(T=w-M,C=h-2*d+p,T>=C?(b=1,y=0,v=h+2*f+g):(b=T/C,y=1-b,v=b*(h*b+d*y+2*f)+y*(d*b+p*y+2*m)+g)):(b=0,w<=0?(y=1,v=p+2*m+g):m>=0?(y=0,v=g):(y=-m/p,v=m*y+g))):y<0?(x=6,M=d+m,w=h+f,w>M?(T=w-M,C=h-2*d+p,T>=C?(y=1,b=0,v=p+2*m+g):(y=T/C,b=1-y,v=b*(h*b+d*y+2*f)+y*(d*b+p*y+2*m)+g)):(y=0,w<=0?(b=1,v=h+2*f+g):f>=0?(b=0,v=g):(b=-f/h,v=f*b+g))):(x=1,T=p+m-d-f,T<=0?(b=0,y=1,v=p+2*m+g):(C=h-2*d+p,T>=C?(b=1,y=0,v=h+2*f+g):(b=T/C,y=1-b,v=b*(h*b+d*y+2*f)+y*(d*b+p*y+2*m)+g)))}if(!(v>this._radius*this._radius)){var E=a.f.create(),L=this.initIntersection(new o);L._i1=u,L._i2=l,L._i3=c,L._r1=1-b-y,L._r2=b,L._r3=y;var P=L._localIntersectionPoint;a.f.scaleAndAdd(P,a.f.scaleAndAdd(P,r,e,b),t,y),a.f.cross(L._localIntersectionNormal,e,t),a.f.normalize(E,L._localIntersectionNormal),L._ratio=Math.sqrt(v)/this._radius,L._zone=x}}}}}()}),"osgUtil","SphereIntersectFunctor"),t.a=s},function(e,t,i){"use strict";var r=i(9),a=i(128),n=i(121),o=i(54),s=i(99),u=i(10),l=function(){o.a.call(this),this._T=void 0,this._B=void 0,this._N=void 0,this._texCoordUnit=0};r.a.createPrototypeObject(l,r.a.objectInherit(o.a.prototype,{apply:function(e){e.getTypeID()===n.a.getTypeID()?this.generate(e,this._texCoordUnit):this.traverse(e)},setTexCoordUnit:function(e){this._texCoordUnit=e},computePrimitiveSet:function(e,t){if(t.getIndices){var i,r=t.getNumIndices(),a=e.getAttributes().Vertex,n=e.getAttributes().Normal,o=e.getAttributes()["TexCoord"+this._texCoordUnit];if(t.getMode()===s.a.TRIANGLES)for(i=0;i<r;i+=3)this.compute(t,a,n,o,i,i+1,i+2);else if(t.getMode()===s.a.TRIANGLE_STRIP)for(i=0;i<r-2;++i)i%2==0?this.compute(t,a,n,o,i,i+1,i+2):this.compute(t,a,n,o,i+1,i,i+2)}},generate:function(e,t){if(this._texCoordUnit=t,void 0===this._texCoordUnit&&(this._texCoordUnit=0),e.getAttributes()["TexCoord"+this._texCoordUnit]){var i=e.getAttributes().Vertex.getElements().length;this._T=new r.a.Float32Array(i),this._B=new r.a.Float32Array(i),this._N=new r.a.Float32Array(i),e.getPrimitiveSetList().forEach(function(t){this.computePrimitiveSet(e,t)},this);for(var n=i/3,o=new r.a.Float32Array(4*n),s=u.f.create(),l=u.f.create(),c=u.f.create(),h=0;h<n;h++){var d=this._T.subarray(3*h,3*h+3),p=this._N.subarray(3*h,3*h+3),f=this._B.subarray(3*h,3*h+3);u.f.normalize(p,p);var m=u.f.dot(p,d);u.f.scale(l,p,m),u.f.sub(s,d,l),u.f.normalize(c,s),u.f.cross(s,p,d);var g=u.f.dot(s,f);g=g<0?-1:0,o[4*h]=c[0],o[4*h+1]=c[1],o[4*h+2]=c[2],o[4*h+3]=g}e.getAttributes().Normal.setElements(this._N),e.getAttributes().Tangent=new a.a("ARRAY_BUFFER",o,4)}},compute:function(e,t,i,r,a,n,o){var s,l,c=e.index(a),h=e.index(n),d=e.index(o),p=t.getElements().subarray(3*c,3*c+3),f=t.getElements().subarray(3*h,3*h+3),m=t.getElements().subarray(3*d,3*d+3),g=i.getElements().subarray(3*c,3*c+3),_=i.getElements().subarray(3*h,3*h+3),v=i.getElements().subarray(3*d,3*d+3),b=r.getElements().subarray(2*c,2*c+2),y=r.getElements().subarray(2*h,2*h+2),x=r.getElements().subarray(2*d,2*d+2),S=u.f.create(),M=u.f.create(),w=u.f.create(),T=u.f.create(),C=u.f.create(),E=u.f.create(),L=u.f.create(),P=u.f.create(),A=u.f.create();u.f.set(P,f[0]-p[0],y[0]-b[0],y[1]-b[1]),u.f.set(A,m[0]-p[0],x[0]-b[0],x[1]-b[1]),u.f.cross(S,P,A),0!==S[0]&&(u.f.normalize(S,S),l=-S[1]/S[0],s=-S[2]/S[0],C[0]+=l,M[0]+=s,E[0]+=l,w[0]+=s,L[0]+=l,T[0]+=s),u.f.set(P,f[1]-p[1],y[0]-b[0],y[1]-b[1]),u.f.set(A,m[1]-p[1],x[0]-b[0],x[1]-b[1]),u.f.cross(S,P,A),0!==S[0]&&(u.f.normalize(S,S),l=-S[1]/S[0],s=-S[2]/S[0],C[1]+=l,M[1]+=s,E[1]+=l,w[1]+=s,L[1]+=l,T[1]+=s),u.f.set(P,f[2]-p[2],y[0]-b[0],y[1]-b[1]),u.f.set(A,m[2]-p[2],x[0]-b[0],x[1]-b[1]),u.f.cross(S,P,A),0!==S[0]&&(u.f.normalize(S,S),l=-S[1]/S[0],s=-S[2]/S[0],C[2]+=l,M[2]+=s,E[2]+=l,w[2]+=s,L[2]+=l,T[2]+=s);var D,O,k,R=u.f.create(),I=u.f.create();u.f.cross(R,g,C),u.f.cross(I,R,g),D=this._T.subarray(3*c,3*c+3),u.f.add(D,I,D),u.f.cross(R,M,g),u.f.cross(I,g,R),O=this._B.subarray(3*c,3*c+3),u.f.add(O,I,O),u.f.cross(R,_,E),u.f.cross(I,R,_),D=this._T.subarray(3*h,3*h+3),u.f.add(D,I,D),u.f.cross(R,w,_),u.f.cross(I,_,R),O=this._B.subarray(3*h,3*h+3),u.f.add(O,I,O),u.f.cross(R,v,L),u.f.cross(I,R,v),D=this._T.subarray(3*d,3*d+3),u.f.add(D,I,D),u.f.cross(R,T,v),u.f.cross(I,v,R),O=this._B.subarray(3*d,3*d+3),u.f.add(O,I,O),k=this._N.subarray(3*c,3*c+3),u.f.add(k,g,k),k=this._N.subarray(3*h,3*h+3),u.f.add(k,_,k),k=this._N.subarray(3*d,3*d+3),u.f.add(k,v,k)}}),"osgUtil","TangentSpaceGenerator"),t.a=l},function(e,t,i){"use strict";var r=i(142),a=i(248),n=i(10),o=i(98),s=i(186),u=i(217),l=i(399),c=i(84),h=i(214),d=i(72),p=i(417),f={},m=function(e,t,i,r,a){this._viewer=e,this._rttScene=t,this._hmdConfig=i,this._root=r,this._canvas=a,this._width=a.width,this._height=a.height};m.prototype={update:function(){var e=this._canvas,t=e.width,i=e.height;if(t!==this._width||i!==this._height){this._root.removeChildren();var r=this._hmdConfig;r&&r.isCardboard&&(r.hResolution=t,r.vResolution=i),this._width=t,this._height=i,f.createScene(this._viewer,this._rttScene,r,this._root)}return!0}};var g=function(e,t){this._rootView=e,this._offsetView=t};g.prototype={update:function(e){var t=e.getViewMatrix();return n.c.mul(t,this._offsetView,this._rootView),!0}};var _=function(e,t,i,r){var a=t.hResolution/(2*t.vResolution),o=-1-4*(.25*t.hScreenSize-.5*t.lensSeparationDistance)/t.hScreenSize,s=t.distortionK[0]+t.distortionK[1]*Math.pow(o,2)+t.distortionK[2]*Math.pow(o,4)+t.distortionK[3]*Math.pow(o,6),u=180/Math.PI*2*Math.atan2(t.vScreenSize*s,2*t.eyeToScreenDistance),l=n.c.perspective(n.c.create(),Math.PI/180*u,a,.3,1e4),c=4*(.25*t.hScreenSize-.5*t.interpupillaryDistance)/t.hScreenSize,h=4*(.25*t.hScreenSize-.5*t.lensSeparationDistance)/t.hScreenSize,d=n.c.create(),p=n.c.create();r.projectionLeft=n.c.mul(d,n.c.fromTranslation(d,n.f.fromValues(c,0,0)),l),r.projectionRight=n.c.mul(p,n.c.fromTranslation(p,n.f.fromValues(-c,0,0)),l),r.viewLeft=n.c.fromTranslation(n.c.create(),n.f.fromValues(e*t.interpupillaryDistance*.5,0,0)),r.viewRight=n.c.fromTranslation(n.c.create(),n.f.fromValues(-e*t.interpupillaryDistance*.5,0,0)),i.lensCenterLeft=n.e.fromValues(h,0),i.lensCenterRight=n.e.fromValues(-h,0),i.hmdWarpParam=t.distortionK,i.chromAbParam=t.chromaAbParameter,i.scaleIn=n.e.fromValues(1,1/a),i.scale=n.e.fromValues(1/s,1*a/s)},v=function(){var e=["","#ifdef GL_ES","precision highp float;","#endif","uniform vec2 uScale;","uniform vec2 uScaleIn;","uniform vec2 uLensCenter;","uniform vec4 uHmdWarpParam;","uniform vec4 uChromAbParam;","uniform sampler2D Texture0;","varying vec2 vTexCoord0;","void main(void) {","  vec2 uv = (vTexCoord0 * 2.0) - 1.0;","  vec2 theta = (uv - uLensCenter) * uScaleIn;","  float rSq = theta.x * theta.x + theta.y * theta.y;","  vec2 rvector = theta * (uHmdWarpParam.x + uHmdWarpParam.y * rSq + uHmdWarpParam.z * rSq * rSq + uHmdWarpParam.w * rSq * rSq * rSq);","  vec2 rBlue = rvector * (uChromAbParam.z + uChromAbParam.w * rSq);","  vec2 tcBlue = (uLensCenter + uScale * rBlue);","  tcBlue = (tcBlue + 1.0) * 0.5;","  if (any(bvec2(clamp(tcBlue, vec2(0.0, 0.0), vec2(1.0, 1.0)) - tcBlue))) {","    gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","    return;","  }","  vec2 tcGreen = uLensCenter + uScale * rvector;","  tcGreen = (tcGreen + 1.0) * 0.5;","  vec2 rRed = rvector * (uChromAbParam.x + uChromAbParam.y * rSq);","  vec2 tcRed = uLensCenter + uScale * rRed;","  tcRed = (tcRed + 1.0) * 0.5;","  gl_FragColor = vec4(texture2D(Texture0, tcRed).r, texture2D(Texture0, tcGreen).g, texture2D(Texture0, tcBlue).b, 1);","}",""].join("\n");return new s.a(new u.a(u.a.VERTEX_SHADER,["attribute vec3 Vertex;","varying vec2 vTexCoord0;","void main(void) {","  gl_Position = vec4(Vertex * 2.0 - 1.0, 1.0);","  vTexCoord0 = Vertex.xy;","}","","#define SHADER_NAME VRpostProcessing",""].join("\n")),new u.a(u.a.FRAGMENT_SHADER,e))},b=function(e){var t=new c.default;return t.setTextureSize(e[0],e[1]),t.setMinFilter("LINEAR"),t.setMagFilter("LINEAR"),t},y=function(e,t,i,a,o,s){var u=new r.a,l=t[0],c=t[1],f=i[0],m=i[1];!0===a?e?u.setViewport(new p.a(0,0,f/2,m)):u.setViewport(new p.a(f/2,0,f/2,m)):e?u.setViewport(new p.a(.5*f-l,.5*(m-c),l,c)):u.setViewport(new p.a(.5*f,.5*(m-c),l,c)),n.c.ortho(u.getProjectionMatrix(),-.5,.5,-.5,.5,-5,5),u.setRenderOrder(r.a.NESTED_RENDER,0),u.setReferenceFrame(h.a.ABSOLUTE_RF);var g=u.getOrCreateStateSet();return g.setTextureAttributeAndModes(0,o),g.setAttributeAndModes(v()),g.addUniform(d.a.createFloat2(s.scale,"uScale")),g.addUniform(d.a.createFloat2(s.scaleIn,"uScaleIn")),g.addUniform(d.a.createFloat2(e?s.lensCenterLeft:s.lensCenterRight,"uLensCenter")),g.addUniform(d.a.createFloat4(s.hmdWarpParam,"uHmdWarpParam")),g.addUniform(d.a.createFloat4(s.chromAbParam,"uChromAbParam")),u},x=function(e,t){var i=new r.a;return i.setName("rtt camera"),i.setViewport(new p.a(0,0,e.getWidth(),e.getHeight())),i.setProjectionMatrix(t),i.setClearColor(n.g.fromValues(.3,.3,.3,0)),i.setRenderOrder(r.a.POST_RENDER,0),i.attachTexture(a.a.COLOR_ATTACHMENT0,e),i.attachRenderBuffer(a.a.DEPTH_ATTACHMENT,a.a.DEPTH_COMPONENT16),i.setReferenceFrame(h.a.ABSOLUTE_RF),i};f.createScene=function(e,t,i,r,a){var s=f.getDefaultConfig(i),u=n.e.fromValues(.5*s.hResolution,s.vResolution),c=n.e.fromValues(.5*s.hResolution,s.vResolution),h=e.getCamera().getViewport(),d=n.e.fromValues(h.width(),h.height()),p=e.getGraphicContext().canvas;s.isCardboard&&(d[0]=p.width,d[1]=p.height);var v=void 0!==a?a:1,S={},M={};_(v,s,S,M);var w=e.getCamera().getViewMatrix(),T=r||new o.a;T.addUpdateCallback(new m(e,t,i,T,p));var C=b(u),E=x(C,M.projectionLeft),L=y(!0,c,d,s.isCardboard,C,S);E.addUpdateCallback(new g(w,M.viewLeft));var P=b(u),A=x(P,M.projectionRight),D=y(!1,c,d,s.isCardboard,P,S);return A.addUpdateCallback(new g(w,M.viewRight)),E.addChild(t),A.addChild(t),L.addChild(l.a.createTexturedFullScreenFakeQuadGeometry()),D.addChild(l.a.createTexturedFullScreenFakeQuadGeometry()),T.addChild(E),T.addChild(A),T.addChild(L),T.addChild(D),T},f.getDefaultConfig=function(e){var t={hResolution:1920,vResolution:1080,hScreenSize:.1296,vScreenSize:.0729,interpupillaryDistance:.064,lensSeparationDistance:.0635,eyeToScreenDistance:.04,distortionK:n.g.fromValues(1,.22,.13,.02),chromaAbParameter:n.g.fromValues(.996,-.004,1.014,0),isCardboard:!1};return 2===e||void 0===e?t:1===e?(t.hResolution=1280,t.vResolution=800,t.hScreenSize=.14976,t.vScreenSize=.0936,t.lensSeparationDistance=.064,t.eyeToScreenDistance=.041,t.distortionK=n.g.fromValues(1,.22,.24,0),t):(void 0!==e.hResolution&&(t.hResolution=e.hResolution),void 0!==e.vResolution&&(t.vResolution=e.vResolution),void 0!==e.hScreenSize&&(t.hScreenSize=e.hScreenSize),void 0!==e.vScreenSize&&(t.vScreenSize=e.vScreenSize),void 0!==e.interpupillaryDistance&&(t.interpupillaryDistance=e.interpupillaryDistance),void 0!==e.lensSeparationDistance&&(t.lensSeparationDistance=e.lensSeparationDistance),void 0!==e.eyeToScreenDistance&&(t.eyeToScreenDistance=e.eyeToScreenDistance),void 0!==e.distortionK&&(t.distortionK=e.distortionK),void 0!==e.chromaAbParameter&&(t.chromaAbParameter=e.chromaAbParameter),void 0!==e.isCardboard&&(t.isCardboard=e.isCardboard),t)},t.a=f},function(e,t,i){"use strict";var r=i(142),a=i(248),n=i(10),o=i(98),s=i(186),u=i(217),l=i(399),c=i(84),h=i(214),d=i(72),p=i(417),f=function(e,t){this._rootView=e,this._offsetView=t};f.prototype={update:function(e){var t=e.getViewMatrix();return n.c.mul(t,this._offsetView,this._rootView),!0}};var m=function(e){var t=new c.default;return t.setTextureSize(e.width,e.height),t.setMinFilter("LINEAR"),t.setMagFilter("LINEAR"),t},g=function(){var e=["#ifdef GL_ES","   precision highp float;","#endif","varying vec2 vTexCoord0;","uniform sampler2D TextureLeft;","uniform sampler2D TextureRight;","void main() {","   if (vTexCoord0.x < 0.5)","       gl_FragColor = texture2D(TextureLeft, vec2(vTexCoord0.x * 2.0, vTexCoord0.y));","   else","       gl_FragColor = texture2D(TextureRight, vec2(vTexCoord0.x * 2.0 - 1.0, vTexCoord0.y));","}"].join("\n");return new s.a(new u.a(u.a.VERTEX_SHADER,["attribute vec3 Vertex;","varying vec2 vTexCoord0;","void main(void) {","  gl_Position = vec4(Vertex * 2.0 - 1.0, 1.0);","  vTexCoord0 = Vertex.xy;","}","","#define SHADER_NAME VRpostProcessing",""].join("\n")),new u.a(u.a.FRAGMENT_SHADER,e))},_=function(e,t,i){var a=new r.a;a.setViewport(i),a.setRenderOrder(r.a.NESTED_RENDER,0),a.setReferenceFrame(h.a.ABSOLUTE_RF),n.c.ortho(a.getProjectionMatrix(),0,1,0,1,-5,5);var o=a.getOrCreateStateSet();return o.addUniform(d.a.createInt(0,"TextureLeft")),o.addUniform(d.a.createInt(1,"TextureRight")),o.setTextureAttributeAndModes(0,e),o.setTextureAttributeAndModes(1,t),o.setAttributeAndModes(g()),a.addChild(l.a.createTexturedFullScreenFakeQuadGeometry()),a},v=function(e,t){var i=new r.a;return i.setName("rtt camera"),i.setViewport(new p.a(0,0,e.getWidth(),e.getHeight())),i.setProjectionMatrix(t),i.setClearColor(n.g.fromValues(.3,.3,.3,0)),i.setRenderOrder(r.a.POST_RENDER,0),i.attachTexture(a.a.COLOR_ATTACHMENT0,e),i.attachRenderBuffer(a.a.DEPTH_ATTACHMENT,a.a.DEPTH_COMPONENT16),i.setReferenceFrame(h.a.ABSOLUTE_RF),i},b={};b.createScene=function(e,t,i,r,a){var s=r||new o.a;return i.requestAnimationFrame(function(){var r=void 0!==a?a:1,o=i.getEyeParameters("left"),u=i.getEyeParameters("right"),l=new window.VRFrameData;i.getFrameData(l);var c=n.c.fromTranslation(n.c.create(),n.f.fromValues(-r*o.offset[0],o.offset[1],o.offset[2])),h=n.c.fromTranslation(n.c.create(),n.f.fromValues(-r*u.offset[0],u.offset[1],u.offset[2])),d={width:Math.max(o.renderWidth,u.renderWidth),height:Math.max(o.renderHeight,u.renderHeight)},p=m(d),g=m(d),b=v(p,l.leftProjectionMatrix),y=v(g,l.rightProjectionMatrix),x=e.getCamera().getViewMatrix();b.addUpdateCallback(new f(x,c)),y.addUpdateCallback(new f(x,h));var S=_(p,g,e.getCamera().getViewport());b.addChild(t),y.addChild(t),s.addChild(b),s.addChild(y),s.addChild(S)}),s},t.a=b},function(e,t,i){"use strict";var r=i(692),a=i(693),n=i(1071),o=i(827),s=i(78),u={};u.Renderer=r.default,u.View=a.default,u.Viewer=n.a,u.Scene=o.a,u.InputGroups=s.a,t.a=u},function(e,t,i){"use strict";var r=i(21),a=i(10),n=i(585),o=i(7),s=i.n(o),u=i(213),l=i(794),c=i(793),h=i(9),d=i(397),p=i(248),f=i(128),m=i(586),g=i(217),_=i(186),v=i(84),b=i(816),y=i(693),x=i(777),S=i(1072),M=i(829),w=i(833),T=i(834),C=i(835),E=i(1073),L=i(1074),P=i(1075),A=i(1076),D=i(1077),O=i(1078),k=i(1079),R=i(546),I=i(589),F=i(588),N=function(e,t,i){y.default.call(this),this._startTick=u.a.instance().tick(),this._stats=void 0,this._done=!1,this._canvas=e;var r=this.initOptions(t),a=this.initWebGLContext(e,r,i);if(!a)throw"No WebGL implementation found";this._updateVisitor=new c.a,this.setUpView(a.canvas,r),this.initInputManager(r,e),this.initStats(r,e),this._hmd=null,this._requestAnimationFrame=window.requestAnimationFrame.bind(window),this._options=r,this._contextLost=!1,this._forceRestoreContext=!0,this.renderBinded=this.render.bind(this)};h.a.createPrototypeObject(N,h.a.objectInherit(y.default.prototype,{initInputManager:function(e,t){var i=new E.a;this._inputManager=i,this._initInputSource(L.a,"Mouse",t,e),this._initInputSource(P.a,"Keyboard",document,e),"ontouchstart"in window&&this._initInputSource(k.a,"TouchScreen",t,e),this._initInputSource(A.a,"WebVR",void 0,e),this._initInputSource(O.a,"DeviceOrientation",void 0,e),navigator.getGamepads&&this._initInputSource(D.a,"GamePad",void 0,e),i.addMappings({"viewer.internals:hmdConnect":"vrdisplayconnected"},function(e){this.setVRDisplay(e.vrDisplay)}.bind(this)),i.setParam("pixelRatio",[this._devicePixelRatio,this._devicePixelRatio])},_initInputSource:function(e,t,i,r){var a=r.InputSources?r.InputSources[t]:void 0;if(a){if(!1!==a.enable){var n=a.sourceElement||i;this._inputManager.registerInputSource(new e(n,a))}}else this._inputManager.registerInputSource(new e(i))},getInputManager:function(){return this._inputManager},initOptions:function(e){var t=new n.a;return e&&t.extend(e),t.extendWithOptionsURL(),!0===t.getBoolean("traceLogCall")&&(r.a.traceLogCall=!0),!0===t.getBoolean("enableFrustumCulling")&&this.getCamera().getRenderer().getCullVisitor().setEnableFrustumCulling(!0),t},initWebGLContext:function(e,t,i){t.get("SimulateWebGLLostContext")&&(e=S.a.makeLostContextSimulatingCanvas(e),e.loseContextInNCalls(t.get("SimulateWebGLLostContext")),this._canvas=e);var a=x.a.setupWebGL(e,t,i);return e.addEventListener("webglcontextlost",function(e){this.contextLost(),!1!==this._forceRestoreContext&&e.preventDefault()}.bind(this),!1),e.addEventListener("webglcontextrestored",function(){this.contextRestored()}.bind(this),!1),(r.a.reportWebGLError||t.get("reportWebGLError"))&&(a=S.a.makeDebugContext(a)),this.initWebGLCaps(a),this.setGraphicContext(a),a},setContextLostCallback:function(e){this._contextLostCallback=e,this._contextLost&&(this._forceRestoreContext=e())},setContextRestoreCallback:function(e){this._contextRestoreCallback=e},contextLost:function(){r.a.log("webgl context lost"),this._contextLostCallback&&(this._forceRestoreContext=this._contextLostCallback()),this._contextLost=!0,window.cancelAnimationFrame(this._requestID)},contextRestored:function(){if(!1===this._forceRestoreContext)return void r.a.log("webgl context restore not supported - please reload the page - ");this.restoreContext(),r.a.log("webgl context restored")},restoreContext:function(){var e=this.getGraphicContext();g.a.onLostContext(e),_.a.onLostContext(e),f.a.onLostContext(e),m.a.onLostContext(e),p.a.onLostContext(e),v.default.getTextureManager(e).onLostContext(e),d.a.onLostContext(e),this.getCamera().getRenderer().getState().resetCaches(),this.initWebGLCaps(e,!0),this.setGraphicContext(e),l.a.instance(this.getGraphicContext(),!0),this._stats&&this._stats.reset(),this._contextLost=!1,this._requestRedraw=!0,this._contextRestoreCallback&&this._contextRestoreCallback(e),this._runImplementation()},init:function(){},getUpdateVisitor:function(){return this._updateVisitor},getState:function(){return this.getCamera().getRenderer().getState()},initStats:function(e){var t=l.a.instance(this.getGraphicContext());if(!e.getBoolean("stats"))return void t.disable();this._stats=new M.a(this,e),this._stats.addConfig(w.a),this._stats.addConfig(T.a),this._stats.addConfig(C.a),this.getCamera().addChild(this._stats.getNode()),t.setCallback(this.callbackTimerGPU.bind(this))},callbackTimerGPU:function(e,t){this._stats&&this._stats.getCounter(t).set(e/1e6)},getViewerStats:function(){return this._stats},renderingTraversal:function(){if(this.getState()._frameStamp=this._frameStamp,this.getScene().getSceneData()&&this.getScene().getSceneData().getBound(),this.getCamera()){var e=this._stats,t=l.a.instance(this.getGraphicContext()),i=this.getCamera().getRenderer();if(e&&e.getCounter("cull").start(),i.cull(),e&&e.getCounter("cull").end(),t.pollQueries(),t.start("glframe"),e&&e.getCounter("render").start(),i.draw(),e&&e.getCounter("render").end(),t.end("glframe"),e){var r=i.getCullVisitor();e.getCounter("cullcamera").set(r._numCamera),e.getCounter("cullmatrixtransform").set(r._numMatrixTransform),e.getCounter("cullprojection").set(r._numProjection),e.getCounter("cullnode").set(r._numNode),e.getCounter("culllightsource").set(r._numLightSource),e.getCounter("cullgeometry").set(r._numGeometry),e.getCounter("pushstateset").set(i.getState()._numPushStateSet),e.getCounter("applyStateSet").set(i.getState()._numApply)}}},updateTraversal:function(){var e=this._stats;e&&e.getCounter("update").start(),this._updateVisitor.resetStats(),this.getScene().updateSceneGraph(this._updateVisitor),e&&e.getCounter("updatecallback").set(this._updateVisitor._numUpdateCallback),this.getDatabasePager().releaseGLExpiredSubgraphs(.005),this.flushDeletedGLObjects(.005),e&&e.getCounter("update").end()},advance:function(e){var t=e;void 0===t&&(t=Number.MAX_VALUE);var i=this._frameStamp,r=i.getFrameNumber();i.setFrameNumber(r+1);var a=u.a.instance().deltaS(this._startTick,u.a.instance().tick());i.setReferenceTime(a);var n=i.getSimulationTime();i.setSimulationTime(t===Number.MAX_VALUE?a:t),i.setDeltaTime(i.getSimulationTime()-n)},beginFrame:function(){var e=this._stats;e&&(e.getCounter("frame").start(),e.getCounter("raf").tick(),e.getCounter("fps").frame())},endFrame:function(){var e=this.getFrameStamp().getFrameNumber();this._stats&&(v.default.getTextureManager(this.getGraphicContext()).updateStats(e,this._stats),this._stats.getCounter("stats").start(),this._stats.update(),this._stats.getCounter("stats").end(),this._stats.getCounter("frame").end())},checkNeedToDoFrame:function(){return this._requestContinousUpdate||this._requestRedraw},frame:function(){if(!this._contextLost){this.beginFrame(),this.advance();var e=this.updateViewport();this._inputManager.update(),this._updateVisitor.setFrameStamp(this.getFrameStamp()),this.getManipulator()&&(this.getManipulator().update(this._updateVisitor),a.c.copy(this.getCamera().getViewMatrix(),this.getManipulator().getInverseMatrix())),(this.checkNeedToDoFrame()||e)&&(this._requestRedraw=!1,this.updateTraversal(),this.renderingTraversal()),this.endFrame(),this._hmd&&this._hmd.isPresenting&&this._hmd.submitFrame()}},setDone:function(e){this._done=e},done:function(){return this._done},render:function(){this.done()||(this._requestID=this._requestAnimationFrame(this.renderBinded,this._canvas),this.frame())},_runImplementation:function(){this.render()},run:function(){this._runImplementation()},setVRDisplay:function(e){this._hmd=e},getVRDisplay:function(){return this._hmd},setPresentVR:function(e){if(!this._hmd)return r.a.warn("no hmd device provided to the viewer!"),s.a.reject();if(!this._hmd.capabilities.canPresent)return s.a.reject();if(e){this._requestAnimationFrame=this._hmd.requestAnimationFrame.bind(this._hmd);var t=[{source:this.getGraphicContext().canvas}];return this._hmd.requestPresent(t)}return this._requestAnimationFrame=window.requestAnimationFrame.bind(window),this._hmd.exitPresent()},setupManipulator:function(e){void 0===e&&(e=new b.a({inputManager:this._inputManager})),void 0!==e.setNode?e.setNode(this.getSceneData()):e.view=this,e.setCamera(this.getCamera()),this.setManipulator(e)},updateViewport:function(){var e=this.getGraphicContext(),t=e.canvas;if(!this.computeCanvasSize(t))return!1;var i=this.getCamera(),r=i.getViewport(),n=r.width(),o=r.height(),s=t.width/n,u=t.height/o,l=s/u;return r.setViewport(Math.round(r.x()*s),Math.round(r.y()*u),Math.round(r.width()*s),Math.round(r.height()*u)),1!==l&&a.c.mul(i.getProjectionMatrix(),i.getProjectionMatrix(),a.c.fromScaling(a.c.create(),[1/l,1,1])),!0},setManipulator:function(e){this.setEnableManipulator(!1),e.getCamera()||e.setCamera(this.getCamera()),e.setEnable(!0),y.default.prototype.setManipulator.call(this,e)},setEnableManipulator:function(e){this._manipulator&&this._manipulator.setEnable(e)},dispose:function(){R.a.clean(),I.a.clean(),F.a.pooledStateGraph.clean()}}),"osgViewer","Viewer"),t.a=N},function(e,t,i){"use strict";var r=function(){function e(e){if(null==p){p={},f={};for(var t in e)"number"==typeof e[t]&&(p[e[t]]=t,f[t]=e[t])}}function t(){if(null==p)throw"WebGLDebugUtils.init(ctx) not called"}function i(e){return t(),void 0!==p[e]}function r(e){t();var i=p[e];return void 0!==i?"gl."+i:"/*UNKNOWN WebGL ENUM*/ 0x"+e.toString(16)}function a(e,t,i,a){var n=d[e];if(void 0!==n){var n=n[t];if(void 0!==n&&n[i]){if("object"==typeof n[i]&&void 0!==n[i].enumBitwiseOr){for(var o=n[i].enumBitwiseOr,s=0,u=[],l=0;l<o.length;++l){var c=f[o[l]];0!=(a&c)&&(s|=c,u.push(r(c)))}return s===a?u.join(" | "):r(a)}return r(a)}}return null===a?"null":void 0===a?"undefined":a.toString()}function n(e,t){for(var i="",r=t.length,n=0;n<r;++n)i+=(0==n?"":", ")+a(e,r,n,t[n]);return i}function o(e,t,i){e.__defineGetter__(i,function(){return t[i]}),e.__defineSetter__(i,function(e){t[i]=e})}function s(t,i,n,u){function l(e,t){return function(){n&&n(t,arguments);var r=e[t].apply(e,arguments),a=u.getError();return 0!=a&&(c[a]=!0,i(a,t,arguments)),r}}u=u||t,e(t),i=i||function(e,t,i){for(var n="",o=i.length,s=0;s<o;++s)n+=(0==s?"":", ")+a(t,o,s,i[s]);h("WebGL error "+r(e)+" in "+t+"("+n+")")};var c={},d={};for(var p in t)if("function"==typeof t[p])if("getExtension"!=p)d[p]=l(t,p);else{var f=l(t,p);d[p]=function(){var e=f.apply(t,arguments);return e?s(e,i,n,u):null}}else o(d,t,p);return d.getError=function(){for(var e in c)if(c.hasOwnProperty(e)&&c[e])return c[e]=!1,e;return t.NO_ERROR},d}function u(e){var t=!!e.createTransformFeedback;t&&e.bindVertexArray(null);var i=e.getParameter(e.MAX_VERTEX_ATTRIBS),r=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,r);for(var a=0;a<i;++a)e.disableVertexAttribArray(a),e.vertexAttribPointer(a,4,e.FLOAT,!1,0,0),e.vertexAttrib1f(a,0),t&&e.vertexAttribDivisor(a,0);e.deleteBuffer(r);for(var n=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),a=0;a<n;++a)e.activeTexture(e.TEXTURE0+a),e.bindTexture(e.TEXTURE_CUBE_MAP,null),e.bindTexture(e.TEXTURE_2D,null),t&&(e.bindTexture(e.TEXTURE_2D_ARRAY,null),e.bindTexture(e.TEXTURE_3D,null),e.bindSampler(a,null));if(e.activeTexture(e.TEXTURE0),e.useProgram(null),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.DITHER),e.disable(e.SCISSOR_TEST),e.blendColor(0,0,0,0),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.clearColor(0,0,0,0),e.clearDepth(1),e.clearStencil(-1),e.colorMask(!0,!0,!0,!0),e.cullFace(e.BACK),e.depthFunc(e.LESS),e.depthMask(!0),e.depthRange(0,1),e.frontFace(e.CCW),e.hint(e.GENERATE_MIPMAP_HINT,e.DONT_CARE),e.lineWidth(1),e.pixelStorei(e.PACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.UNPACK_COLORSPACE_CONVERSION_WEBGL&&e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.BROWSER_DEFAULT_WEBGL),e.polygonOffset(0,0),e.sampleCoverage(1,!1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilMask(4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.viewport(0,0,e.canvas.width,e.canvas.height),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT),t){e.drawBuffers([e.BACK]),e.readBuffer(e.BACK),e.bindBuffer(e.COPY_READ_BUFFER,null),e.bindBuffer(e.COPY_WRITE_BUFFER,null),e.bindBuffer(e.PIXEL_PACK_BUFFER,null),e.bindBuffer(e.PIXEL_UNPACK_BUFFER,null);for(var o=e.getParameter(e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS),a=0;a<o;++a)e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,a,null);for(var s=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS),a=0;a<s;++a)e.bindBufferBase(e.UNIFORM_BUFFER,a,null);e.disable(e.RASTERIZER_DISCARD),e.pixelStorei(e.UNPACK_IMAGE_HEIGHT,0),e.pixelStorei(e.UNPACK_SKIP_IMAGES,0),e.pixelStorei(e.UNPACK_ROW_LENGTH,0),e.pixelStorei(e.UNPACK_SKIP_ROWS,0),e.pixelStorei(e.UNPACK_SKIP_PIXELS,0),e.pixelStorei(e.PACK_ROW_LENGTH,0),e.pixelStorei(e.PACK_SKIP_ROWS,0),e.pixelStorei(e.PACK_SKIP_PIXELS,0),e.hint(e.FRAGMENT_SHADER_DERIVATIVE_HINT,e.DONT_CARE)}for(;e.getError(););}function l(e){function t(e){return"function"==typeof e?e:function(t){e.handleEvent(t)}}function i(){for(var e=Object.keys(S),t=0;t<e.length;++t)delete S[e[t]]}function r(){++b,g||v==b&&e.loseContext()}function a(e,t){var i=e[t];return function(){if(r(),!g){return i.apply(e,arguments)}}}function n(){for(var e=0;e<_.length;++e){var t=_[e];t instanceof WebGLBuffer?c.deleteBuffer(t):t instanceof WebGLFramebuffer?c.deleteFramebuffer(t):t instanceof WebGLProgram?c.deleteProgram(t):t instanceof WebGLRenderbuffer?c.deleteRenderbuffer(t):t instanceof WebGLShader?c.deleteShader(t):t instanceof WebGLTexture?c.deleteTexture(t):d&&(t instanceof WebGLQuery?c.deleteQuery(t):t instanceof WebGLSampler?c.deleteSampler(t):t instanceof WebGLSync?c.deleteSync(t):t instanceof WebGLTransformFeedback?c.deleteTransformFeedback(t):t instanceof WebGLVertexArrayObject&&c.deleteVertexArray(t))}}function s(e){return{statusMessage:e,preventDefault:function(){y=!0}}}function l(e){for(var t in e)"function"==typeof e[t]?h[t]=a(e,t):o(h,e,t);h.getError=function(){if(r(),!g)for(var e;e=c.getError();)S[e]=!0;for(var e in S)if(S[e])return delete S[e],e;return h.NO_ERROR};var i=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"];d&&i.push("createQuery","createSampler","fenceSync","createTransformFeedback","createVertexArray");for(var n=0;n<i.length;++n){var s=i[n];h[s]=function(t){return function(){if(r(),g)return null;var i=t.apply(e,arguments);return i.__webglDebugContextLostId__=m,_.push(i),i}}(e[s])}var u=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"];d&&u.push("getInternalformatParameter","getQuery","getQueryParameter","getSamplerParameter","getSyncParameter","getTransformFeedbackVarying","getIndexedParameter","getUniformIndices","getActiveUniforms","getActiveUniformBlockParameter","getActiveUniformBlockName");for(var n=0;n<u.length;++n){var s=u[n];h[s]=function(t){return function(){return r(),g?null:t.apply(e,arguments)}}(h[s])}var l=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"];d&&l.push("isQuery","isSampler","isSync","isTransformFeedback","isVertexArray");for(var n=0;n<l.length;++n){var s=l[n];h[s]=function(t){return function(){return r(),!g&&t.apply(e,arguments)}}(h[s])}return h.checkFramebufferStatus=function(t){return function(){return r(),g?h.FRAMEBUFFER_UNSUPPORTED:t.apply(e,arguments)}}(h.checkFramebufferStatus),h.getAttribLocation=function(t){return function(){return r(),g?-1:t.apply(e,arguments)}}(h.getAttribLocation),h.getVertexAttribOffset=function(t){return function(){return r(),g?0:t.apply(e,arguments)}}(h.getVertexAttribOffset),h.isContextLost=function(){return g},d&&(h.getFragDataLocation=function(t){return function(){return r(),g?-1:t.apply(e,arguments)}}(h.getFragDataLocation),h.clientWaitSync=function(t){return function(){return r(),g?h.WAIT_FAILED:t.apply(e,arguments)}}(h.clientWaitSync),h.getUniformBlockIndex=function(t){return function(){return r(),g?h.INVALID_INDEX:t.apply(e,arguments)}}(h.getUniformBlockIndex)),h}var c,h,d,p=[],f=[],h={},m=1,g=!1,_=[],v=0,b=0,y=!1,x=0,S={};e.getContext=function(t){return function(){var i=t.apply(e,arguments);if(i instanceof WebGLRenderingContext||window.WebGL2RenderingContext&&i instanceof WebGL2RenderingContext){if(i!=c){if(c)throw"got different context";d=window.WebGL2RenderingContext&&i instanceof WebGL2RenderingContext,c=i,h=l(c)}return h}return i}}(e.getContext);var M=function(e){p.push(t(e))},w=function(e){f.push(t(e))};return function(e){var t=e.addEventListener;e.addEventListener=function(i,r,a){switch(i){case"webglcontextlost":M(r);break;case"webglcontextrestored":w(r);break;default:t.apply(e,arguments)}}}(e),e.loseContext=function(){if(!g){for(g=!0,v=0,++m;c.getError(););i(),S[c.CONTEXT_LOST_WEBGL]=!0;var t=s("context lost"),r=p.slice();setTimeout(function(){for(var i=0;i<r.length;++i)r[i](t);x>=0&&setTimeout(function(){e.restoreContext()},x)},0)}},e.restoreContext=function(){g&&f.length&&setTimeout(function(){if(!y)throw"can not restore. webglcontestlost listener did not call event.preventDefault";n(),u(c),g=!1,b=0,y=!1;for(var e=f.slice(),t=s("context restored"),i=0;i<e.length;++i)e[i](t)},0)},e.loseContextInNCalls=function(e){if(g)throw"You can not ask a lost contet to be lost";v=b+e},e.getNumCalls=function(){return b},e.setRestoreTimeout=function(e){x=e},e}var c=function(e){window.console&&window.console.log&&window.console.log(e)},h=function(e){window.console&&window.console.error?window.console.error(e):c(e)},d={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},bindBuffer:{2:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}},bufferData:{3:{0:!0,2:!0},4:{0:!0,2:!0},5:{0:!0,2:!0}},bufferSubData:{3:{0:!0},4:{0:!0},5:{0:!0}},copyBufferSubData:{5:{0:!0,1:!0}},getBufferSubData:{3:{0:!0},4:{0:!0},5:{0:!0}},blitFramebuffer:{10:{8:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]},9:!0}},framebufferTextureLayer:{5:{0:!0,1:!0}},invalidateFramebuffer:{2:{0:!0}},invalidateSubFramebuffer:{6:{0:!0}},readBuffer:{1:{0:!0}},getInternalformatParameter:{3:{0:!0,1:!0,2:!0}},renderbufferStorageMultisample:{5:{0:!0,2:!0}},texStorage2D:{5:{0:!0,2:!0}},texStorage3D:{6:{0:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0},10:{0:!0,2:!0,6:!0,7:!0}},texImage3D:{10:{0:!0,2:!0,7:!0,8:!0},11:{0:!0,2:!0,7:!0,8:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0},10:{0:!0,6:!0,7:!0}},texSubImage3D:{11:{0:!0,8:!0,9:!0},12:{0:!0,8:!0,9:!0}},copyTexSubImage3D:{9:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0},8:{0:!0,2:!0},9:{0:!0,2:!0}},compressedTexImage3D:{8:{0:!0,2:!0},9:{0:!0,2:!0},10:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0},9:{0:!0,6:!0},10:{0:!0,6:!0}},compressedTexSubImage3D:{10:{0:!0,8:!0},11:{0:!0,8:!0},12:{0:!0,8:!0}},vertexAttribIPointer:{5:{2:!0}},drawArraysInstanced:{4:{0:!0}},drawElementsInstanced:{5:{0:!0,2:!0}},drawRangeElements:{6:{0:!0,4:!0}},readPixels:{7:{4:!0,5:!0},8:{4:!0,5:!0}},clearBufferfv:{3:{0:!0},4:{0:!0}},clearBufferiv:{3:{0:!0},4:{0:!0}},clearBufferuiv:{3:{0:!0},4:{0:!0}},clearBufferfi:{4:{0:!0}},beginQuery:{2:{0:!0}},endQuery:{1:{0:!0}},getQuery:{2:{0:!0,1:!0}},getQueryParameter:{2:{1:!0}},samplerParameteri:{3:{1:!0,2:!0}},samplerParameterf:{3:{1:!0}},getSamplerParameter:{2:{1:!0}},fenceSync:{2:{0:!0,1:{enumBitwiseOr:[]}}},clientWaitSync:{3:{1:{enumBitwiseOr:["SYNC_FLUSH_COMMANDS_BIT"]}}},waitSync:{3:{1:{enumBitwiseOr:[]}}},getSyncParameter:{2:{1:!0}},bindTransformFeedback:{2:{0:!0}},beginTransformFeedback:{1:{0:!0}},transformFeedbackVaryings:{3:{2:!0}},bindBufferBase:{3:{0:!0}},bindBufferRange:{5:{0:!0}},getIndexedParameter:{2:{0:!0}},getActiveUniforms:{3:{2:!0}},getActiveUniformBlockParameter:{3:{2:!0}}},p=null,f=null;return{init:e,mightBeEnum:i,glEnumToString:r,glFunctionArgToString:a,glFunctionArgsToString:n,makeDebugContext:s,makeLostContextSimulatingCanvas:l,resetToInitialState:u}}();t.a=r},function(e,t,i){"use strict";var r=i(21),a=["shift","alt","ctrl","meta"],n=function(e,t){this._enabled=!0,this._name=t,this._mask=[],this._events={},this._mappings={},this._inputManager=e,this._boundCallback=this._collectNativeEvents.bind(this),this._priority=10,this._hasSources=!1};n.prototype={addMappings:function(e,t){for(var i in e)e[this._name+":"+i]=e[i],delete e[i];this._inputManager.addMappings(e,t)},_collectNativeEvents:function(e){if(this._enabled&&!this._mask.length){var t=this._mappings[e.type];if(t)for(var i=0;i<t.length;i++){var r=t[i];if(!r._source.isEventRegistered||r._source.isEventRegistered(e,r._parsedEvent)){if(r._source.populateEvent(e,r),r._nativeEvents||(r._nativeEvents=[]),!r._nativeEvents.length){var a=this._inputManager._queues[r._priority];a||(a=[],this._inputManager._queues[r._priority]=a),a.push(r)}r._nativeEvents.push(e)}}}},_addEvent:function(e,t){var i,r=this._name+":"+t,a=!1,n=this._mappings[e.name];n?i=this._findEvent(n,r,e.raw):(n=[],this._mappings[e.name]=n,a=!0);var o=this._events[t];o||(o=[],this._events[t]=o),i||(i=new Event(r),n.push(i),o.push(i)),i._parsedEvent=e,i._priority=10;var s=this._inputManager._getSource(e.name);s&&(this._enabled&&a&&s.setEnable(e.name,this._boundCallback,!0),this._hasSources=!0,i._source=s)},_findEvent:function(e,t,i){for(var r=0;r<e.length;r++){var a=e[r];if(a.type===t&&a._parsedEvent.raw===i)return a}},_setEnable:function(e){this._enabled=e;for(var t in this._mappings){var i=this._mappings[t],r=i[0];r._source&&r._source.setEnable(t,this._boundCallback,e)}}};var o=function(){this._groups={},this._sources=[],this._queues=[],this._queues[10]=[],this._callbacks={},this._params={},this._maskedGroups=[],window.dumpInputGroups=this._dumpInputGroups.bind(this),window.dumpEventSequence=this._dumpEventSequence.bind(this)};o.prototype={registerInputSource:function(e){if(!e.setEnable||!e.supportsEvent||!e.getName)throw"Invalid input target "+JSON.stringify(e);this._sources.push(e),e.setInputManager(this)},getInputSource:function(e){for(var t=0;t<this._sources.length;t++){var i=this._sources[t];if(i.getName()===e)return i}},addMappings:function(e,t){for(var i in e){var r=e[i],a=i.split(":");if(2!==a.length)throw"Mapping should be of the form 'group:methodName': ['nativeevent1, 'nativeevent2',...] ";var n,o=this._getOrCreateGroup(a[0]),s=a[1];if(t)if("object"==typeof t){if(!(n=t[s])||"function"!=typeof n)throw"Cannot find method "+s+" on "+t;n=n.bind(t)}else{if("function"!=typeof t)throw"Invalid listener "+t;n=t}var u;if("string"==typeof r)u=this._parseNativeEvent(r),o._addEvent(u,s);else for(var l=0;l<r.length;l++){var c=r[l];u=this._parseNativeEvent(c),o._addEvent(u,s)}this._callbacks[o._name+":"+s]=n}},group:function(e){return this._getOrCreateGroup(e)},setEnable:function(e,t){var i=this._groups[e];i&&i._setEnable(t);var r;for(var a in this._groups)i=this._groups[a],t?(r=i._mask.indexOf(e))>=0&&(i._mask.splice(r,1),this._maskedGroups.splice(this._maskedGroups.indexOf(e),1)):0===(r=i._name.indexOf(e))&&"."===i._name[r+e.length]&&(i._mask.push(e),this._maskedGroups.push(e));if(!t)for(var n=0;n<this._queues.length;n++){var o=this._queues[n];if(o)for(var s=o.length-1;s>=0;s--){var u=o[s];u.type.indexOf(e)>=0&&(o.splice(s,1),u._nativeEvents.length=0)}}},setPriority:function(e,t){var i=e.split(":");if(t<0)throw"priority must be a positive number";var r,a,n,o=this._groups[i[0]];if(o&&i[1]){for(a=o._events[i[1]],n=0;n<a.length;n++)r=a[n],r._priority=t;o._priority>t&&(o._priority=t)}else for(var s in this._groups)if(o=this._groups[s],o._name.indexOf(e)>=0)for(var u in o._events)for(a=o._events[u],n=0;n<a.length;n++)r=a[n],r._priority=t},getHigherPriority:function(e){var t=10;for(var i in this._groups){var r=this._groups[i];r._name.indexOf(e)>=0&&r._priority<t&&(t=r._priority)}return t>0?t-1:0},getParam:function(e){return this._params[e]},setParam:function(e,t){this._params[e]=t},cleanup:function(){for(var e in this._groups){this._groups[e]._setEnable(!1)}},_parseNativeEvent:function(e){var t=e.split(" "),i={};i.name=t[0];var r;for(r=1;r<t.length;r++){var n=t[r],o=!0;0===n.indexOf("!")&&(o=!1,n=n.substring(1,n.length)),a.indexOf(n)>=0?i[n]=o:i.action=n.toLowerCase()}if(i.action)for(r=0;r<a.length;r++){var s=a[r];0===i.action.indexOf(s)&&(i[s]=!0)}return 0===i.name.indexOf("key")&&!i.action&&t.length>1&&(i.action=t[t.length-1]),i.raw=e,i},_getOrCreateGroup:function(e){var t=this._groups[e];if(!t){t=new n(this,e),this._groups[e]=t;for(var i=0;i<this._maskedGroups.length;i++){var r=this._maskedGroups[i];0===e.indexOf(r)&&t._mask.push(r)}}return t},update:function(){var e;for(e=0;e<this._sources.length;e++){var t=this._sources[e];t.poll&&t.poll()}for(e=0;e<this._queues.length;e++){var i=this._queues[e];if(i){for(var r=0;r<i.length;r++){var a=i[r];this._callbacks[a.type](a),a._nativeEvents.length=0}i.length=0}}},_getSource:function(e){for(var t=0;t<this._sources.length;t++){var i=this._sources[t];if(i.supportsEvent(e))return i}},_dumpInputGroups:function(e,t){!0===e&&(t=e,e=void 0);for(var i in this._groups)if(!(e&&i.indexOf(e)<0)){var a=this._groups[i],n=a._enabled&&!a._mask.length&&a._hasSources;if(!t||n){r.a.groupCollapsed("%c"+i+(n?" (enabled)":" (disabled)"),n?"":"color: #888888"),r.a.log("enabled:",a._enabled),r.a.log("masks:",a._mask),r.a.log("input sources:",a._hasSources),r.a.group("events");for(var o in a._events){r.a.groupCollapsed(o);for(var s=a._events[o],u=0;u<s.length;u++){var l=s[u],c="%c"+l._parsedEvent.raw+" ("+(l._source?l._source.getName():"unknown source")+")",h=l._source?"":"color: #888888";r.a.log(c,h)}r.a.groupCollapsed("function"),r.a.log(this._callbacks[a._name+":"+o]),r.a.groupEnd(),r.a.groupEnd()}r.a.groupEnd(),r.a.groupEnd()}}},_dumpEventSequence:function(e,t){var i=[];!0===e&&(t=e,e=void 0);var a;for(var n in this._groups){var o=this._groups[n];if(a=o._enabled&&!o._mask.length&&o._hasSources,!t||a)for(var s in o._events){var u=o._events[s],l=i[u[0]._priority];l||(l=[],i[u[0]._priority]=l);for(var c=0;c<u.length;c++){var h=u[c];(!e||e&&h._parsedEvent.raw.indexOf(e)>=0)&&l.push({name:h.type,group:o._name,on:h._parsedEvent.raw,enabled:o._enabled&&!o._mask.length&&!!h._source,source:h._source?"("+h._source.getName()+")":"(unknown source)"})}}}for(var d=0;d<i.length;d++){var p=i[d];if(p){r.a.group("priority "+d);for(var f,m=0;m<p.length;m++){var g=p[m];if(0!==m&&f!==g.name&&r.a.groupEnd(),f!==g.name){var _=this._groups[g.group];a=_._enabled&&!_._mask.length&&_._hasSources,r.a.groupCollapsed("%c"+g.name,a?"":"color:#888888")}f=g.name,r.a.groupCollapsed("%c"+g.on+" "+g.source,g.enabled?"":"color:#888888"),r.a.log(this._callbacks[g.name]),r.a.groupEnd()}r.a.groupEnd(),r.a.groupEnd()}}}},t.a=o},function(e,t,i){"use strict";var r=i(9),a=i(455),n=i(10),o=0===navigator.platform.indexOf("Mac")?-1:-3,s=function(e,t){a.a.call(this,e),this._defaultRatio=n.e.fromValues(1,1),this._supportedEvents=["click","contextmenu","dblclick","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseout","mouseup"],t&&!1===t.scrollwheel||this._supportedEvents.push("wheel")};r.a.createPrototypeObject(s,r.a.objectInherit(a.a.prototype,{getName:function(){return"Mouse"},setEnable:function(e,t,i){i?this._target.addEventListener(e,t):this._target.removeEventListener(e,t)},populateEvent:function(e,t){t.canvasX=void 0===e.offsetX?e.layerX:e.offsetX,t.canvasY=void 0===e.offsetY?e.layerY:e.offsetY;var i=this._inputManager.getParam("pixelRatio");i||(i=this._defaultRatio),t.glX=t.canvasX*i[0],t.glY=(this._target.clientHeight-t.canvasY)*i[1],t.clientX=e.clientX,t.clientY=e.clientY,t.screenX=e.screenX,t.screenX=e.screenX,t.pageX=e.pageX,t.pageY=e.pageY,t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.altKey=e.altKey,t.metaKey=e.metaKey,t.button=e.button,t.buttons=e.buttons,"wheel"===e.type&&(void 0!==e.wheelDelta?t.deltaY=e.wheelDelta/120:1===e.deltaMode?t.deltaY=e.deltaY/o:t.deltaY=e.deltaY/(10*o),t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaZ=e.deltaZ)},isEventRegistered:function(e,t){return e.preventDefault(),(!t.action||e.button===parseInt(t.action))&&((void 0===t.ctrl||e.ctrlKey===t.ctrl)&&((void 0===t.shift||e.shiftKey===t.shift)&&((void 0===t.alt||e.altKey===t.alt)&&(void 0===t.meta||e.metaKey===t.meta))))}}),"osgViewer","InputSourceMouse"),t.a=s},function(e,t,i){"use strict";var r=i(9),a=i(455),n=function(e){a.a.call(this,e),this._supportedEvents=["keydown","keyup","keypress"]};r.a.createPrototypeObject(n,r.a.objectInherit(a.a.prototype,{getName:function(){return"Keyboard"},setEnable:function(e,t,i){i?this._target.addEventListener(e,t):this._target.removeEventListener(e,t)},populateEvent:function(e,t){t.key=e.key,t.keyCode=e.keyCode,t.code=e.code,t.location=e.location,t.repeat=e.repeat,t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.altKey=e.altKey,t.metaKey=e.metaKey},isEventRegistered:function(e,t){if(!t.action)return!0;if(!e.key||"string"!=typeof e.key){var i="";for(var r in e)void 0!==r&&void 0!==e[r]&&(i+=r+":"+e[r]+",\n");throw new Error("Invalid keyboard event: "+i)}return(e.key.toLowerCase()===t.action||e.code.toLowerCase()===t.action)&&((void 0===t.ctrl||e.ctrlKey===t.ctrl)&&((void 0===t.shift||e.shiftKey===t.shift)&&((void 0===t.alt||e.altKey===t.alt)&&(void 0===t.meta||e.metaKey===t.meta))))}}),"osgViewer","InputSourceKeyboard"),t.a=n},function(e,t,i){"use strict";var r=i(9),a=i(455),n=i(21),o=function(e,t){a.a.call(this),this._supportedEvents=["vrdisplayposechanged","vrdisplayconnected","vrdisplaynotfound","vrdisplaydisconnected"],this._callbacks={},this._events={};for(var i=0;i<this._supportedEvents.length;i++){var r=this._supportedEvents[i],n=new Event(r);this._events[r]=n}this._nbCallbacks=0,this._pollInterval=t&&void 0!==t.pollInterval?t.pollInterval:3e3};r.a.createPrototypeObject(o,r.a.objectInherit(a.a.prototype,{getName:function(){return"WebVR"},setEnable:function(e,t,i){var r=this._callbacks[e];r||(r=[],this._callbacks[e]=r);var a=r.indexOf(t);i?a<0&&(r.push(t),this._nbCallbacks++,this._schedulePolling()):a>=0&&(r.splice(a,1),--this._nbCallbacks||this._cancelPolling())},populateEvent:function(e,t){if(e.vrDisplay)return void(t.vrDisplay=e.vrDisplay);t.pose=e.pose,t.sitToStandMatrix=e.sitToStandMatrix,t.worldFactor=this._inputManager.getParam("worldFactor"),t.worldFactor||(t.worldFactor=1)},_schedulePolling:function(){this._pollInterval>0&&void 0===this._pollingTimeout&&(this._pollingTimeout=setInterval(this.pollHeadset.bind(this),this._pollInterval))},_cancelPolling:function(){void 0!==this._pollingTimeout&&clearInterval(this._pollingTimeout)},pollHeadset:function(){if(!navigator.getVRDisplays)return this._hmd=void 0,this._frameData=void 0,void this.triggerNotFoundEvent();var e=this;navigator.getVRDisplays().then(function(t){if(0===t.length)return void this.triggerNotFoundEvent();if(e._hmd!==t[0]){n.a.log("Found a VR display");var i=e._events.vrdisplaydisconnected;i.vrDisplay=e._hmd,this._dispatchEvent(i,e._callbacks.vrdisplaydisconnected),i=e._events.vrdisplayconnected,i.vrDisplay=t[0],this._dispatchEvent(i,e._callbacks.vrdisplayconnected),e._hmd=t[0],e._frameData=new window.VRFrameData}}.bind(this)).catch(function(e){this._hmd=void 0,this._frameData=void 0,this.triggerNotFoundEvent(),n.a.warn(e.message)})},triggerNotFoundEvent:function(){if(!(this._pollInterval>0)){var e=this._events.vrdisplaynotfound;this._dispatchEvent(e,this._callbacks.vrdisplaynotfound)}},setPollInterval:function(e){this._pollInterval=e},_dispatchEvent:function(e,t){if(t)for(var i=0;i<t.length;i++){var r=t[i];r(e)}},poll:function(){if(this._hmd){var e=this._callbacks.vrdisplayposechanged;if(e&&e.length){this._hmd.getFrameData(this._frameData);var t=this._frameData.pose;if(t){var i=this._hmd.stageParameters&&this._hmd.stageParameters.sittingToStandingTransform,r=this._events.vrdisplayposechanged;r.pose=t,r.sitToStandMatrix=i,this._dispatchEvent(r,e)}}}}}),"osgViewer","InputSourceWebVR"),t.a=o},function(e,t,i){"use strict";var r=i(9),a=i(455),n=function(){a.a.call(this),this._target=window,this._supportedEvents=["buttondown","buttonup","buttonvalue","axis","gamepadconnected","gamepaddisconnected"],this._callbacks={},this._nbCallbacks=0,this._gamePadState=[],this._valueThreshold=.05,window.addEventListener("gamepadconnected",function(e){this._newGamePad(e.gamepad),this._onConnectionStateChange(e,"gamepadconnected")}.bind(this)),window.addEventListener("gamepaddisconnected",function(e){this._previousState[e.gamepad.index]=void 0,this._onConnectionStateChange(e,"gamepaddisconnected")}.bind(this))};r.a.createPrototypeObject(n,r.a.objectInherit(a.a.prototype,{getName:function(){return"GamePad"},setEnable:function(e,t,i){var r=this._callbacks[e];r||(r=[],this._callbacks[e]=r);var a=r.indexOf(t);i?a<0&&(r.push(t),this._nbCallbacks++):a>=0&&(r.splice(a,1),this._nbCallbacks--)},_onConnectionStateChange:function(e,t){var i=this._callbacks[t];i&&i(e)},_newGamePad:function(e){var t={buttons:[]};t._buttonEvents=[],t._axisEvents=[];var i;for(i=0;i<e.buttons.length;i++)t._buttonEvents[i]={buttondown:this._initEvent("buttondown",i,e.index,"button"),buttonup:this._initEvent("buttonup",i,e.index,"button"),buttonvalue:this._initEvent("buttonvalue",i,e.index,"button")};for(i=0;i<e.axes.length;i++)t._axisEvents[i]={axis:this._initEvent("axis",i,e.index,"axis")};this._gamePadState[e.index]=t},setValueThreshold:function(e){this._valueThreshold=e},_initEvent:function(e,t,i,r){var a=new Event(e);return a[r]=t,a.gamepadIndex=i,a},populateEvent:function(e,t){t.gamepadIndex=e.gamepadIndex,void 0!==e.button&&(t.button=e.button,t.value=e.value),void 0!==e.axis&&(t.axis=e.axis,t.value=e.value)},isEventRegistered:function(e,t){if(!t.action)return!0;var i=parseInt(t.action);return(void 0===e.button||e.button===i)&&(void 0===e.axis||e.axis===i)},_fireCallbacks:function(e,t){for(var i=0;i<e.length;i++)e[i](t)},poll:function(){if(this._nbCallbacks){var e=navigator.getGamepads();if(e)for(var t=0;t<e.length;t++){var i=e[t];if(i){var r=this._gamePadState[t];if(r){var a=this._callbacks.buttondown,n=this._callbacks.buttonup,o=this._callbacks.buttonvalue;if(a||n||o)for(var s=0;s<i.buttons.length;s++){var u=i.buttons[s],l=r._buttonEvents[s].buttondown;l.value=u.value;var c=r._buttonEvents[s].buttonup;if(c.value=u.value,u.pressed&&!r.buttons[s]&&(a&&a.length&&this._fireCallbacks(a,l),r.buttons[s]=u.pressed),!u.pressed&&r.buttons[s]&&(n&&n.length&&this._fireCallbacks(n,c),r.buttons[s]=!1),u.pressed&&o&&o.length){var h=r._buttonEvents[s].buttonvalue;h.value=u.value,Math.abs(u.value)>=this._valueThreshold&&this._fireCallbacks(o,h)}}var d=this._callbacks.axis;if(d)for(s=0;s<i.axes.length;s++){var p=i.axes[s],f=r._axisEvents[s].axis;f.value=p,Math.abs(p)>=this._valueThreshold&&this._fireCallbacks(d,f)}}}}}}}),"osgViewer","InputSourceGamePad"),t.a=n},function(e,t,i){"use strict";var r=i(9),a=i(455),n=function(){a.a.call(this),this._target=window,this._callbacks=[],this._nbCallbacks=0,this._event=new Event("deviceorientation"),this._supportedEvents=["deviceorientation","orientationchange"],this._update=this.onDeviceOrientation.bind(this)};r.a.createPrototypeObject(n,r.a.objectInherit(a.a.prototype,{getName:function(){return"DeviceOrientation"},setEnable:function(e,t,i){if("orientationchange"===e)return void(i?this._target.addEventListener(e,t):this._target.removeEventListener(e,t));var r=this._callbacks,a=r.indexOf(t);i?a<0&&(r.push(t),this._nbCallbacks++):a>=0&&(r.splice(a,1),this._nbCallbacks--),1===this._nbCallbacks&&window.addEventListener(e,this._update),0===this._nbCallbacks&&window.removeEventListener(e,this._update)},onDeviceOrientation:function(e){this.populateEvent(e,this._event)},populateEvent:function(e,t){t.absolute=e.absolute,t.alpha=e.alpha,t.beta=e.beta,t.gamma=e.gamma,t.screenOrientation=window.orientation},isEventRegistered:function(e){if("deviceorientation"===e.type){if(null===e.alpha||void 0===e.alpha)return!1}else if(null===window.orientation||void 0===window.orientation)return!1;return!0},poll:function(){if(this._nbCallbacks)for(var e=0;e<this._callbacks.length;e++)this._callbacks[e](this._event)}}),"osgViewer","InputSourceDeviceOrientation"),t.a=n},function(e,t,i){"use strict";var r=i(9),a=i(455),n=i(686),o=i.n(n),s=i(10),u=function(e){a.a.call(this,e),this._defaultRatio=s.e.fromValues(1,1),this._hammerEvents=["pan","pinch","press","rotate","swipe","doubletap","doubletap2fingers","singletap"],this._supportedEvents=["touchstart","touchend","touchcancel","touchmove"],this._hammer=new o.a.Manager(e),this._hammer.add(new o.a.Pan),this._hammer.add(new o.a.Pinch),this._hammer.get("pan").set({threshold:0,pointers:0});var t=this._hammer.get("pinch");t.set({threshold:.1,enable:!1}),t.recognizeWith(this._hammer.get("pan")),this._hammer.add(new o.a.Tap({event:"doubletap",pointers:1,taps:2,time:250,interval:450,threshold:5,posThreshold:50})),this._hammer.add(new o.a.Tap({event:"doubletap2fingers",pointers:2,taps:2,time:250,interval:450,threshold:5,posThreshold:50})),this._hammer.add(new o.a.Tap({event:"singletap",pointers:1,taps:1,time:250,interval:450,threshold:5,posThreshold:20}))};r.a.createPrototypeObject(u,r.a.objectInherit(a.a.prototype,{getName:function(){return"TouchScreen"},setEnable:function(e,t,i){this._isNativeEvent(e)?i?this._target.addEventListener(e,t):this._target.removeEventListener(e,t):(e.indexOf("pinch")>=0&&i&&this._hammer.get("pinch").set({enable:!0}),i?this._hammer.on(e,t):this._hammer.off(e,t))},populateEvent:function(e,t){if(this._isNativeEvent(e.type)){t.canvasX=t.canvasY=0;for(var i=e.touches.length?e.touches:e.changedTouches,r=i.length,a=0;a<r;++a)t.canvasX+=i[a].clientX/r,t.canvasY+=i[a].clientY/r;t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.altKey=e.altKey,t.metaKey=e.metaKey,t.pointers=e.touches}else t.canvasX=e.center.x,t.canvasY=e.center.y,t.scale=e.scale,t.rotation=e.rotation,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaTime=e.deltaTime,t.direction=e.direction,t.offsetDirection=e.offsetDirection,t.pointers=e.pointers,t.velocity=e.velocity;var n=this._target.getBoundingClientRect();t.canvasX+=-n.left,t.canvasY+=-n.top;var o=this._inputManager.getParam("pixelRatio");o||(o=this._defaultRatio),t.glX=t.canvasX*o[0],t.glY=(this._target.clientHeight-t.canvasY)*o[1]},_isNativeEvent:function(e){return this._supportedEvents.indexOf(e)>=0},isEventRegistered:function(e,t){if(e.preventDefault(),e.pointerType&&"touch"!==e.pointerType)return!1;if(!t.action)return!0;if(isNaN(t.action))throw"touch action should be a number representing the number of touches";var i=e.pointers;i||(i=e.touches);var r=parseInt(t.action);if("touchend"===e.type||"touchcancel"===e.type){if(i.length>=r)return!1}else if(i.length!==r)return!1;return!0},supportsEvent:function(e){var t=a.a.prototype.supportsEvent.call(this,e);if(t)return t;for(var i=0;i<this._hammerEvents.length;i++){var r=this._hammerEvents[i];if(0===e.indexOf(r))return!0}return!1},getHammer:function(){return this._hammer}}),"osgViewer","InputSourceTouchScreen"),t.a=u},function(e,t,i){"use strict";var r=i(836),a=i(824),n=i(823),o=i(837),s=i(1081),u=i(838),l=i(1082),c=i(839),h=i(1083),d=i(695),p=i(696),f=i(840),m=i(1084),g={};g.ShadowCastAttribute=r.a,g.ShadowCastCompiler=a.a,g.ShadowReceiveAttribute=c.a,g.ShadowCasterVisitor=o.a,g.ShadowFrustumIntersection=s.a,g.ShadowMap=u.a,g.ShadowMapAtlas=l.a,g.ShadowedScene=m.a,g.ShadowSettings=h.a,g.ShadowCastShaderGenerator=n.a,g.ShadowTechnique=d.a,g.ShadowTexture=p.a,g.ShadowTextureAtlas=f.a,t.a=g},function(e,t,i){"use strict";var r=i(215),a=i(448),n=i(142),o=i(121),s=i(548),u=i(10),l=i(216),c=i(184),h=i(143),d=i(54),p=i(451),f=i(9),m=function(){d.a.call(this,d.a.TRAVERSE_ALL_CHILDREN),this._pooledMatrix=new l.a(u.c.create),this._matrixStack=new c.a,this._matrixStack.push(u.c.IDENTITY),this._bb=new r.a,this._bs=new a.a};f.a.createPrototypeObject(m,f.a.objectInherit(d.a.prototype,{reset:function(e,t,i,r,a){this.setTraversalMask(e),this._cameraFrustum=i,this._lightFrustum=a,this.getCameraPlaneMaskForLightNear(t,i,r?6:4),this._pooledMatrix.reset(),this._matrixStack.reset(),this._matrixStack.push(u.c.IDENTITY),this._bb.init()},getBoundingBox:function(){return this._bb},getCameraPlaneMaskForLightNear:function(e,t,i){var r,a=1,n=15;for(r=0;r<i;++r)n=n<<1|1;var o=t.getPlanes();for(r=0;r<i;++r)p.a.distanceToPlane(o[r],e)<0&&(n^=a),a<<=1;return this._cameraPlaneMaskedByLightNear=n,t.setResultMask(n),t.pushCurrentMask(n),n},applyTransform:function(e){var t=this._pooledMatrix.getOrCreateObject();u.c.copy(t,this._matrixStack.back()),e.computeLocalToWorldMatrix(t,this);var i=this._bs;e.getBound().transformMat4(this._bs,t),(0===this._cameraFrustum.getCurrentMask()||this._cameraFrustum.containsBoundingSphere(i))&&(0===this._lightFrustum.getCurrentMask()||this._lightFrustum.containsBoundingSphere(i))&&(this._cameraFrustum.pushCurrentMask(),this._lightFrustum.pushCurrentMask(),this.pushMatrix(t),this.traverse(e),this._cameraFrustum.popCurrentMask(),this._lightFrustum.popCurrentMask(),this.popMatrix())},applyBoundingBox:function(){var e=new r.a;return function(t){var i=this._matrixStack.back();u.c.exactEquals(i,u.c.IDENTITY)?this._bb.expandByBoundingBox(t):t.valid()&&(t.transformMat4(e,i),this._bb.expandByBoundingBox(e))}}(),apply:function(e){var t=e.getTypeID();if(e instanceof h.a)return void this.applyTransform(e);if(t===o.a.getTypeID()){var i=this._bs;if(e.getBound().transformMat4(i,this._matrixStack.back()),0!==this._cameraFrustum.getCurrentMask()&&!this._cameraFrustum.containsBoundingSphere(i))return;if(0!==this._lightFrustum.getCurrentMask()&&!this._lightFrustum.containsBoundingSphere(i))return;return void this.applyBoundingBox(e.getBoundingBox())}t===n.a.getTypeID()||s.a.getTypeID(),this.traverse(e)},pushMatrix:function(e){this._matrixStack.push(e)},popMatrix:function(){this._matrixStack.pop()}}),"osgShadow","ComputeMultiFrustumBoundsVisitor"),t.a=m},function(e,t,i){"use strict";var r=i(21),a=i(10),n=i(142),o=i(9),s=i(695),u=i(840),l=i(838),c=i(84),h=i(248),d=i(72),p=i(417),f=function(e){this._lights=[],this._shadowMaps=[],this._viewportDimension=[],s.a.apply(this,arguments),this._shadowSettings=e,this._texture=new u.a,this._textureUnitBase=4,this._textureUnit=this._textureUnitBase,this._textureMagFilter=void 0,this._textureMinFilter=void 0,this._textureSize=1024,this._shadowMapSize=256,this._receivingStateset=void 0,this._shaderProcessor=void 0,e&&(this.setShadowSettings(e),e.atlasSize&&(this._textureSize=e.atlasSize),e.textureSize&&(this._shadowMapSize=e.textureSize)),this._texelSizeUniform=d.a.createFloat1(1/this._textureSize,"texelSize");var t=d.a.createFloat2("RenderSize");this._renderSize=t.getInternalArray(),this._renderSize[0]=this._renderSize[1]=this._textureSize,this._numShadowWidth=this._textureSize/this._shadowMapSize,this._numShadowHeight=this._textureSize/this._shadowMapSize,this._cameraClear=new n.a,this._cameraClear.setName("shadowAtlasCameraClear"),this._cameraClear.setRenderOrder(n.a.PRE_RENDER,0),this._cameraClear.setClearColor(a.g.fromValues(1,1,1,1)),this._cameraClear.setFrameBufferObject(new h.a),this._cameraClear.setClearMask(0)};o.a.createPrototypeObject(f,o.a.objectInherit(s.a.prototype,{getTexture:function(){return this._texture},isDirty:function(e){if(void 0!==e)return this._shadowMaps[e].isDirty();for(var t=0,i=this._shadowMaps.length;t<i;t++)if(this._shadowMaps[t].isDirty())return!0;return!1},setTextureUnitBase:function(e){this._textureUnitBase=e,this._textureUnit=e;for(var t=0,i=this._shadowMaps.length;t<i;t++)this._shadowMaps[t].setTextureUnitBase(e)},setShadowSettings:function(e){if(e){this._shadowSettings=e;for(var t=0,i=this._shadowMaps.length;t<i;t++)this._shadowMaps[t].setShadowSettings(e);this.setTextureSize(e.textureSize),this.setTexturePrecision(e.textureType)}},setCastsShadowDrawTraversalMask:function(e){for(var t=0,i=this._shadowMaps.length;t<i;t++)this._shadowMaps[t].setCastsShadowDrawTraversalMask(e)},getCastsShadowDrawTraversalMask:function(e){return void 0!==e?this._shadowMaps[e].getCastsShadowDrawTraversalMask():0!==this._shadowMaps.length?this._shadowMaps[0].getCastsShadowDrawTraversalMask():void 0},setCastsShadowBoundsTraversalMask:function(e){for(var t=0,i=this._shadowMaps.length;t<i;t++)this._shadowMaps[t].setCastsShadowBoundsTraversalMask(e)},getCastsShadowBoundsTraversalMask:function(e){return void 0!==e?this._shadowMaps[e].getCastsShadowDrawTraversalMask():0!==this._shadowMaps.length?this._shadowMaps[0].getCastsShadowDrawTraversalMask():void 0},getNormalBias:function(e){return void 0!==e?this._shadowMaps[e].getNormalBias():0!==this._shadowMaps.length?this._shadowMaps[0].getNormalBias():void 0},setNormalBias:function(e){for(var t=0,i=this._shadowMaps.length;t<i;t++)this._shadowMaps[t].setNormalBias(e)},getBias:function(e){return void 0!==e?this._shadowMaps[e].getBias():0!==this._shadowMaps.length?this._shadowMaps[0].getBias():void 0},setBias:function(e){for(var t=0,i=this._shadowMaps.length;t<i;t++)this._shadowMaps[t].setBias(e)},getKernelSizePCF:function(e){return void 0!==e?this._shadowMaps[e].getKernelSizePCF():1!==this._shadowMaps.length?this._shadowMaps[0].getKernelSizePCF():void 0},setKernelSizePCF:function(e){for(var t=0,i=this._shadowMaps.length;t<i;t++)this._shadowMaps[t].setKernelSizePCF(e)},setShadowedScene:function(e){s.a.prototype.setShadowedScene.call(this,e),this._receivingStateset=this._shadowedScene.getReceivingStateSet();for(var t=0,i=this._shadowMaps.length;t<i;t++)this._shadowMaps[t].setShadowedScene(e)},setTexturePrecision:function(e){for(var t=0,i=this._shadowMaps.length;t<i;t++)this._shadowMaps[t].setTexturePrecision(e)},getTexturePrecision:function(e){return void 0!==e?this._shadowMaps[e].getTexturePrecision():1!==this._shadowMaps.length?this._shadowMaps[0].getTexturePrecision():void 0},setTextureSize:function(e){e!==this._textureSize&&(this._shadowMapSize=e,this._numShadowWidth=this._textureSize/this._shadowMapSize,this._numShadowHeight=this._textureSize/this._shadowMapSize,this.dirty())},getShadowMap:function(e){return this._shadowMaps[e]},addLight:function(e){if(!e||-1!==this._lights.indexOf(e))return r.a.warn("no light or light already added"),-1;if(this._lights.length===this._numShadowWidth*this._numShadowHeight)return void r.a.warn("can't allocate shadow for light "+e.getLightNumber()+" ShadowAtlas already full ");this._lights.push(e),this._shadowSettings.setLight(e);var t=new l.a(this._shadowSettings,this._texture);return this._shadowMaps.push(t),this._shadowedScene&&t.setShadowedScene(this._shadowedScene),this.recomputeViewports(),t},init:function(){if(this._shadowedScene){this.initTexture();for(var e=[],t=0;t<this._lights.length;t++)e.push(this._lights[t].getLightNumber());this._texture.setLightNumberArray(e),this._textureUnit=this._textureUnitBase,this._texture.setName("ShadowTexture"+this._textureUnit);var i=d.a.createFloat2("RenderSize");this._texelSizeUniform=d.a.createFloat1(1/this._textureSize,"texelSize"),this._renderSize=i.getInternalArray(),this._renderSize[0]=this._renderSize[1]=this._textureSize,this.recomputeViewports();for(var r=0,a=this._shadowMaps.length;r<a;r++){var n=this._shadowMaps[r];this._shadowedScene||(this._shadowedScene=n.getShadowedScene(this._shadowedScene)),this._shadowedScene&&n.setShadowedScene(this._shadowedScene),n.init(this._texture,r,this._textureUnitBase)}}},recomputeViewports:function(){for(var e=this._shadowMaps.length,t=e>2?Math.sqrt(2*Math.ceil(e/2)):e,i=t,r=this._textureSize/i,n=this._textureSize/t,o=this._textureSize/r,s=this._textureSize/n,u=0;u<e;u++){var l=this._shadowMaps[u],c=r*(u%o),h=n*Math.floor(u/s);this._viewportDimension.length<=u?this._viewportDimension.push(a.g.fromValues(c,h,r,n)):a.g.set(this._viewportDimension[u],c,h,r,n),this._texture.setLightShadowMapSize(this._lights[u].getLightNumber(),this._viewportDimension[u]),l.dirty()}},valid:function(){return!0},updateCameraClear:function(){var e=this._cameraClear,t=this._texture;if(e&&t){var i=e.getViewport();i||(i=new p.a,e.setViewport(i)),i.width()===t.getWidth()&&i.height()===t.getHeight()||(e.detachAll(),e.attachTexture(h.a.COLOR_ATTACHMENT0,t),e.attachRenderBuffer(h.a.DEPTH_ATTACHMENT,h.a.DEPTH_COMPONENT16),e.getViewport().setViewport(0,0,t.getWidth(),t.getHeight()))}},updateShadowTechnique:function(e){this.updateCameraClear();for(var t=this._cameraClear.getFrameBufferObject(),i=0,r=this._shadowMaps.length;i<r;i++)this._shadowMaps[i].updateShadowTechnique(e,this._viewportDimension[i],t)},initTexture:function(){if(this._dirty){this._texture||(this._texture=new u.a,this._textureUnit=this._textureUnitBase),this._texture.setTextureSize(this._textureSize,this._textureSize),this._texelSizeUniform.setFloat(1/this._textureSize),this._renderSize[0]=this._textureSize,this._renderSize[1]=this._textureSize;var e;e=c.default.RGBA,l.a.prototype.setTextureFiltering.call(this),this._texture.setInternalFormat(e),this._texture.setWrapS(c.default.CLAMP_TO_EDGE),this._texture.setWrapT(c.default.CLAMP_TO_EDGE),this._texture.dirty()}},cullShadowCasting:function(e,t){this._cameraClear.accept(e);for(var i=0,r=this._shadowMaps.length;i<r;i++){var a=this._shadowMaps[i];(a.isContinuousUpdate()||a.needRedraw())&&a.cullShadowCasting(e,t)}},isContinuousUpdate:function(){for(var e=0,t=this._shadowMaps.length;e<t;e++)if(this._shadowMaps[e].isContinuousUpdate())return!0;return!1},needRedraw:function(){for(var e=0,t=this._shadowMaps.length;e<t;e++)if(this._shadowMaps[e].needRedraw())return!0;return!1},removeShadowMap:function(e){if(this._shadowMaps.length>0){var t=this._shadowMaps.indexOf(e);if(-1!==t){this._shadowMaps[t].valid()&&this._shadowMaps[t].cleanSceneGraph(!0),this._shadowMaps.splice(t,1);var i=this._texture.getLightNumberArray();t=i.indexOf(e.getLightNumber()),-1!==t&&i.splice(t,1);var r=e.getLight();t=this._lights.indexOf(r),-1!==t&&this._lights.splice(t,1),this._viewportDimension.length>t&&this._viewportDimension.splice(t,1),this.recomputeViewports()}}},addShadowMap:function(e){if(!(this._shadowMaps.length>0&&-1!==this._shadowMaps.indexOf(e))){this._shadowMaps.push(e);var t=e.getLight();-1===this._lights.indexOf(t)&&this._lights.push(t),this._shadowedScene&&e.setShadowedScene(this._shadowedScene);var i=this._texture.getLightNumberArray();-1===i.indexOf(e.getLightNumber())&&i.push(t.getLightNumber()),this.recomputeViewports()}},cleanReceivingStateSet:function(){if(this._receivingStateset){this._texture&&this._receivingStateset.getTextureAttribute(this._textureUnit,this._texture.getTypeMember())===this._texture&&this._receivingStateset.removeTextureAttribute(this._textureUnit,this._texture.getTypeMember());for(var e=0,t=this._shadowMaps.length;e<t;e++)this._shadowMaps[e].cleanReceivingStateSet()}},cleanSceneGraph:function(){this._texture=void 0,this._shadowedScene=void 0},setDebug:function(e,t){if(t)this._shadowMaps[t].setDebug(e);else for(var i=0,r=this._shadowMaps.length;i<r;i++)this._shadowMaps[i].setDebug(e)},markSceneAsNoShadow:function(){for(var e=0,t=this._shadowMaps.length;e<t;e++)this._shadowMaps[e].markSceneAsNoShadow()}}),"osgShadow","ShadowMapAtlas"),t.a=f},function(e,t,i){"use strict";var r=i(9),a=i(84),n=["1Tap(4texFetch)","4Tap(16texFetch)","9Tap(36texFetch)","16Tap(64texFetch)"],o=function(e){this.castsShadowDrawTraversalMask=4294967295,this.castsShadowBoundsTraversalMask=4294967295,this.textureSize=1024,this.textureType="UNSIGNED_BYTE",this.textureFormat=a.default.RGBA,this.shadowProjection="fov",this.fov=50,this.kernelSizePCF="4Tap(4texFetch)",this.bias=.005,this.normalBias=void 0,this.shadowCastShaderGeneratorName="ShadowCast",r.a.objectMix(this,e)};o.kernelSizeList=n,o.prototype={setCastsShadowDrawTraversalMask:function(e){this.castsShadowDrawTraversalMask=e},getCastsShadowDrawTraversalMask:function(){return this.castsDrawShadowTraversalMask},setCastsShadowBoundsTraversalMask:function(e){this.castsShadowBoundsTraversalMask=e},getCastsShadowBoundsTraversalMask:function(){return this.castsShadowBoundsTraversalMask},setLight:function(e){this.light=e},getLight:function(){return this.light},setTextureSize:function(e){this.textureSize=e},getTextureSize:function(){return this.textureSize},setTextureType:function(e){this.textureType=e},getTextureType:function(){return this.textureType},setTextureFormat:function(e){this.textureFormat=e},getTextureFormat:function(){return this.textureFormat},setShadowCastShaderGeneratorName:function(e){this.shadowCastShaderGeneratorName=e},getShadowCastShaderGeneratorName:function(){return this.shadowCastShaderGeneratorName}},t.a=o},function(e,t,i){"use strict";var r=i(545),a=i(10),n=i(98),o=i(54),s=i(182),u=i(9),l=i(584),c=i(837),h=function(e){n.a.call(this),this._shadowTechniques=[],this._optimizedFrustum=!1,this._frustumReceivers=[a.g.create(),a.g.create(),a.g.create(),a.g.create(),a.g.create(),a.g.create()],this._tmpMat=a.c.create(),this._receivingStateset=new s.a,this._computeBoundsVisitor=new l.default,this._castsShadowDrawTraversalMask=4294967295,this._castsShadowBoundsTraversalMask=4294967295,e&&this.setShadowSettings(e)};u.a.createPrototypeNode(h,u.a.objectInherit(n.a.prototype,{getReceivingStateSet:function(){return this._receivingStateset},getShadowTechniques:function(){return this._shadowTechniques},addShadowTechnique:function(e){this._shadowTechniques.length>0&&-1!==this._shadowTechniques.indexOf(e)||(this._shadowTechniques.push(e),e.valid()&&(e.setShadowedScene(this),e.dirty()))},removeShadowTechnique:function(e){if(this._shadowTechniques.length>0){var t=this._shadowTechniques.indexOf(e);-1!==t&&(this._shadowTechniques[t].valid()&&this._shadowTechniques[t].cleanSceneGraph(),this._shadowTechniques.splice(t,1))}},cleanSceneGraph:function(){for(var e=0,t=this._shadowTechniques.length;e<t;e++)this._shadowTechniques[e]&&this._shadowTechniques[e].valid()&&this._shadowTechniques[e].cleanSceneGraph()},dirty:function(){for(var e=0;e<this._shadowTechniques.length;e++)this._shadowTechniques[e].dirty()},nodeTraverse:function(e){n.a.prototype.traverse.call(this,e)},setShadowSettings:function(e){this._settings=e,this.setCastsShadowDrawTraversalMask(e.castsShadowDrawTraversalMask),this.setCastsShadowBoundsTraversalMask(e.castsShadowBoundsTraversalMask),!1!==e.userShadowCasterVisitor&&(this._removeNodesNeverCastingVisitor=e.userShadowCasterVisitor||new c.a(this._castsShadowTraversalMask))},setCastsShadowDrawTraversalMask:function(e){this._castsShadowDrawTraversalMask=e},getCastsShadowDrawTraversalMask:function(){return this._castsDrawShadowTraversalMask},setCastsShadowBoundsTraversalMask:function(e){this._castsShadowBoundsTraversalMask=e},getCastsShadowBoundsTraversalMask:function(){return this._castsShadowBoundsTraversalMask},computeShadowedSceneBounds:function(){return this._removeNodesNeverCastingVisitor&&(this._removeNodesNeverCastingVisitor.setNoCastMask(~(this._castsShadowBoundsTraversalMask|this._castsShadowDrawTraversalMask)),this._removeNodesNeverCastingVisitor.reset(),this.accept(this._removeNodesNeverCastingVisitor)),this._computeBoundsVisitor.setTraversalMask(this._castsShadowBoundsTraversalMask),this._computeBoundsVisitor.reset(),this.accept(this._computeBoundsVisitor),!!this._computeBoundsVisitor.getBoundingBox().valid()||(this._removeNodesNeverCastingVisitor&&this._removeNodesNeverCastingVisitor.restore(),!1)},traverse:function(e){if(e.getVisitorType()===o.a.CULL_VISITOR){var t,i,r=this._shadowTechniques.length;r&&e.pushStateSet(this._receivingStateset),this.nodeTraverse(e),r&&e.popStateSet();var a=!1;for(t=0;t<r;t++)(i=this._shadowTechniques[t])&&i.valid()&&(i.isDirty()&&(a=!0,i.init()),(i.isContinuousUpdate()||i.needRedraw())&&(a=!0));if(!a)return;if(!this.computeShadowedSceneBounds(e)){for(t=0;t<r;t++)i=this._shadowTechniques[t],i.markSceneAsNoShadow();return}var n=this._computeBoundsVisitor.getBoundingBox(),s=e.getCurrentModelMatrix();for(n.transformMat4(n,s),t=0;t<r;t++)i=this._shadowTechniques[t],(i.isContinuousUpdate()||i.needRedraw())&&(i.updateShadowTechnique(e),i.cullShadowCasting(e,n));this._removeNodesNeverCastingVisitor&&this._removeNodesNeverCastingVisitor.restore()}else this.nodeTraverse(e)}}),"osgShadow","ShadowedScene"),r.a.registerApplyFunction(h.nodeTypeID,r.a.getApplyFunction(n.a.nodeTypeID)),t.a=h},function(e,t,i){"use strict";var r=i(829),a=i(830),n=i(694),o=i(832),s=i(831),u=i(833),l=i(835),c=i(834),h={Stats:r.a,BufferStats:a.a,Graph:n.a,TextGenerator:o.a,Counter:s.a,defaultStats:u.a,browserStats:l.a,glStats:c.a};t.a=h},function(e,t,i){"use strict";var r=i(806),a={};a.Text=r.a,t.a=a},function(e,t,i){"use strict";var r=i(596),a=i(804),n=i(805),o={};o.osg=r.a,o.osgAnimation=a.a,o.osgText=n.a,t.a=o},function(e,t,i){"use strict";var r=i(1089),a=i(1090),n={};n.ReaderWriterGLTF=r.a,n.ReaderWriterZIP=a.a,t.a=n},function(e,t,i){"use strict";function r(e){for(var t=window.atob(e),i=t.length,r=new Uint8Array(i),a=0;a<i;a++)r[a]=t.charCodeAt(a);return r.buffer}var a=i(7),n=i.n(a),o=i(215),s=i(182),u=i(684),l=i(549),c=i(796),h=i(590),d=i(452),p=i(801),f=i(800),m=i(683),g=i(453),_=i(398),v=i(454),b=i(593),y=i(21),x=i(98),S=i(121),M=i(84),w=i(143),T=i(247),C=i(450),E=i(449),L=i(183),P=i(99),A=i(128),D=i(680),O=i(594),k=i(591),R=i(595),I=i(72),F=i(10),N=v.a.createQuatChannel,V=v.a.createVec3Channel,B=v.a.createFloatChannel,U=function(){this._filesMap=void 0,this._loadedFiles=void 0,this._bufferViewCache=void 0,this._basicAnimationManager=void 0,this._visitedNodes=void 0,this._animatedNodes=void 0,this._bones=void 0,this._skeletonToInfluenceMap=void 0,this._inputImgReader=void 0,this._localPath="",this._extensions=[],this._nodeAnimationTypes=void 0,this.init()};U.WEBGL_COMPONENT_TYPES={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},U.TYPE_TABLE={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},U.ATTRIBUTE_OSGJS_TABLE={POSITION:"Vertex",NORMAL:"Normal",TANGENT:"Tangent",TEXCOORD_0:"TexCoord0",TEXCOORD_1:"TexCoord1",TEXCOORD_2:"TexCoord2",TEXCOORD_3:"TexCoord3",TEXCOORD_4:"TexCoord4",TEXCOORD_5:"TexCoord5",TEXCOORD_6:"TexCoord6",TEXCOORD_7:"TexCoord7",TEXCOORD_8:"TexCoord8",TEXCOORD_9:"TexCoord9",TEXCOORD_10:"TexCoord10",TEXCOORD_11:"TexCoord11",TEXCOORD_12:"TexCoord12",TEXCOORD_13:"TexCoord13",TEXCOORD_14:"TexCoord14",TEXCOORD_15:"TexCoord15",COLOR_0:"Color",JOINTS_0:"Bones",WEIGHTS_0:"Weights"},U.TEXTURE_FORMAT={6406:M.default.ALPHA,6407:M.default.RGB,6408:M.default.RGBA,6409:M.default.LUMINANCE,6410:M.default.LUMINANCE_ALPHA},U.TYPE_CHANNEL_PATH={translation:{VEC3:V},scale:{VEC3:V},rotation:{VEC4:N},weights:{SCALAR:B}},U.TYPE_STACKED_TRANSFORMS={translation:p.a,scale:m.a,rotation:f.a},U.PBR_SPEC_EXT="KHR_materials_pbrSpecularGlossiness",U.PBR_SPEC_MODE="PBR_specular_glossiness",U.PBR_METAL_MODE="PBR_metal_roughness",U.ALBEDO_TEXTURE_UNIT=2,U.DIFFUSE_TEXTURE_UNIT=2,U.SPECULAR_GLOSSINESS_TEXTURE_UNIT=3,U.METALLIC_ROUGHNESS_TEXTURE_UNIT=3,U.SPECULAR_TEXTURE_UNIT=4,U.NORMAL_TEXTURE_UNIT=5,U.AO_TEXTURE_UNIT=6,U.EMISSIVE_TEXTURE_UNIT=7,U.ALBEDO_UNIFORM="albedoMap",U.METALLIC_ROUGHNESS_UNIFORM="metallicRoughnessMap",U.SPECULAR_UNIFORM="specularMap",U.NORMAL_UNIFORM="normalMap",U.AO_UNIFORM="aoMap",U.EMISSIVE_UNIFORM="emissiveMap",U.prototype={init:function(){this._glTFJSON=void 0,this._nodeAnimationTypes=[],this._bufferViewCache={},this._basicAnimationManager=void 0,this._localPath="",this._visitedNodes={},this._animatedNodes={},this._bones={},this._skeletonToInfluenceMap={},this._stateSetMap={},this._filesMap={},this._inputReader=new u.default,this._rootStateSet=new s.a,this._defaultBlendFunc=new T.a,this._transparentBlendFunc=new T.a("SRC_ALPHA","ONE_MINUS_SRC_ALPHA"),this._defaultCullFace=new C.a,this._doubleSideCullFace=new C.a(C.a.DISABLE)},_preProcessNodes:function(){for(var e,t=this._gltfJSON.nodes,i=this._gltfJSON.meshes,r=0;r<t.length;r++){var a=t[r];e=a.name||"",e+="_"+r.toString(),a.osgjsNodeName=e;var n=a.children;if(n)for(var o=0;o<n.length;o++){var s=n[o];t[s].parent=r}}for(var u=0;u<i.length;u++){var l=i[u];e=l.name||"",e+="_"+u.toString(),l.osgjsNodeName=e}},loadBuffers:n.a.method(function(){for(var e=[],t=this._gltfJSON.buffers,i=0;i<t.length;i++){var r=t[i];e.push(this.loadURI(r.uri,{responseType:"arraybuffer"}).then(function(e){r.data=e}))}return n.a.all(e)}),loadBufferViews:function(){for(var e=this._gltfJSON.buffers,t=this._gltfJSON.bufferViews,i=0;i<t.length;i++){var r=t[i],a=r.buffer,n=e[a],o=r.byteLength||0,s=r.byteOffset||0;r.data=n.data.slice(s,s+o)}},loadAccessors:function(){for(var e=this._gltfJSON.bufferViews,t=this._gltfJSON.accessors,i=0;i<t.length;i++){var r,a=t[i],n=a.bufferView,o=e[n],s=U.TYPE_TABLE[a.type],u=U.WEBGL_COMPONENT_TYPES[a.componentType],l=u.BYTES_PER_ELEMENT,c=l*s,h=o.byteStride,d=!0===a.normalized;if(h&&h!==c)y.a.warn("GLTF interleaved accessors not supported");else{var p=new u(o.data,a.byteOffset,a.count*s);r=new A.a(void 0,p,s),r.setNormalize(d)}a.data=r}},_computeNodeMatrix:function(e){var t;if(e.matrix)t=F.c.clone(e.matrix);else if(e.translation||e.rotation||e.scale){var i=F.c.IDENTITY,r=F.c.IDENTITY,a=F.c.IDENTITY;e.translation&&(i=F.c.fromTranslation(F.c.create(),e.translation)),e.rotation&&(r=F.c.fromQuat(F.c.create(),e.rotation)),e.scale&&(a=F.c.fromScaling(F.c.create(),e.scale)),t=F.c.create(),F.c.multiply(t,r,a),F.c.multiply(t,i,t)}return t},loadNodes:function(){for(var e=this._gltfJSON.nodes,t=this._gltfJSON.skins,i=this._gltfJSON.meshes,r=0;r<e.length;r++){var a=e[r];if(!a.usedAsBone){if(void 0!==a.skin){var n=t[a.skin],o=n.osgjsNode;n.osgjsNodeAttached||(a.osgjsNode=o,n.osgjsNodeAttached=r);var s=i[a.mesh];s.osgjsGeometry.setBoneNameID(n.osgjsBoneMapID),o.addChild(s.osgjsGeometry)}else(a.matrix||a.translation||a.rotation||a.scale)&&(a.osgjsNode=this._createMatrixTransform(r)),void 0!==a.mesh&&(a.osgjsNode?a.osgjsNode.addChild(i[a.mesh].osgjsGeometry):a.osgjsNode=i[a.mesh].osgjsGeometry),a.osgjsNode||(a.osgjsNode=new x.a);a.name&&a.osgjsNode.setName(a.name)}}},_linkNodes:function(e){var t=this._gltfJSON.nodes,i=e.children;if(i)for(var r=0;r<i.length;r++){var a=t[i[r]];if(!a.usedAsBone){var n=a.osgjsNode;n&&!e.osgjsNode.hasChild(n)&&(e.osgjsNode.addChild(n),this._linkNodes(a))}}},loadSkins:function(){var e=this._gltfJSON.skins;if(e)for(var t=0;t<e.length;t++)this._processSkin(t)},loadScenes:function(){var e=this._gltfJSON.nodes,t=this._gltfJSON.scenes;this._osgjsScene=[];for(var i=0;i<t.length;i++){for(var r=t[i],a=r.nodes,n=[],o=0;o<a.length;o++){var s=e[a[o]];this._linkNodes(s),n.push(s.osgjsNode)}var u=n[0];if(n.length>1){u=new x.a;for(var l=0;l<n.length;l++)u.addChild(n[l])}this._osgjsScene.push(u)}},_assignGeometryAttributes:function(e,t,i){var r=this._gltfJSON.accessors;for(var a in t){var n=t[a],o=r[n],s=U.ATTRIBUTE_OSGJS_TABLE[a];void 0!==i&&(s+="_"+i.toString()),e.getVertexAttributeList()[s]=o.data,o.data._target=A.a.ARRAY_BUFFER}},_assignGeometryPrimitives:function(e,t){var i=this._gltfJSON.accessors,r=i[t.indices];r.data._target=A.a.ELEMENT_ARRAY_BUFFER;var a=void 0!==t.mode?t.mode:P.a.TRIANGLES,n=new L.a(a,r.data);e.getPrimitiveSetList().push(n)},_getMorphTargetName:function(e,t){return e.osgjsNodeName+"_target_"+t.toString()},_computeAbsoluteMorphData:function(e,t){var i=this._gltfJSON.accessors;for(var r in t){var a=t[r],n=i[a];if(!n.morphAbsoluteComputed){n.morphAbsoluteComputed=!0;for(var o=e[r],s=i[o],u=s.data.getElements(),l=n.data.getElements(),c=u.length,h=0;h<c;h++)l[h]+=u[h]}}},_processMorphGeometry:function(e,t){var i=e.primitives[t],r=new _.a,a=new O.a;a.setName(e.osgjsNodeName),r.setName(e.osgjsNodeName);for(var n=0;n<i.targets.length;n++){this._computeAbsoluteMorphData(i.attributes,i.targets[n]);var o=this._getMorphTargetName(e,n),s=new S.a;s.setName(o),a.addTarget(o,n),this._assignGeometryAttributes(s,i.targets[n]),r.getMorphTargets().push(s)}this._assignGeometryAttributes(r,i.attributes),this._assignGeometryPrimitives(r,i),r.mergeChildrenVertexAttributeList(),e.osgjsMorphGeometry=r,e.osgjsUpdateMorph=a},loadMeshes:function(){for(var e=this._gltfJSON.meshes,t=this._gltfJSON.materials,i=0;i<e.length;i++){for(var r=e[i],a=r.name,n=[],s=0;s<r.primitives.length;s++){var u=void 0,l=r.primitives[s],c=void 0;if(l.targets&&l.targets.length&&(this._processMorphGeometry(r,s),u=r.osgjsMorphGeometry,c=r.osgjsUpdateMorph),l.attributes.JOINTS_0){var h=new g.a;u||(u=new S.a,this._assignGeometryAttributes(u,l.attributes),this._assignGeometryPrimitives(u,l));var d=new o.a;u.computeBoundingBox(d),h.setBound(d),h.setSourceGeometry(u),h.mergeChildrenData(),u=h}u||(u=new S.a,this._assignGeometryAttributes(u,l.attributes),this._assignGeometryPrimitives(u,l)),a&&u.setName(a),c&&u.addUpdateCallback(c);var p=t[l.material].osgjsStateSet;u.setStateSet(p),u.setUserData(p.getUserData()),n.push(u)}if(n.length>1){for(var f=new x.a,m=0;m<n.length;m++)f.addChild(n[m]);u=f}r.osgjsGeometry=u}},loadImages:function(){var e=this._gltfJSON.images;if(!e)return n.a.resolve();for(var t=[],i=0;i<e.length;i++){var r=e[i],a=window.decodeURI(r.uri),o=this.loadURI(a).then(function(e){var t=new E.a;t.setImage(e),this.osgjsImage=t}.bind(r));t.push(o)}return n.a.all(t)},_texture:function(e){var t=this._gltfJSON.textures,i=this._gltfJSON.images,r=t[e.index],a=i[r.source];if(r.osgjsTexture)return r.osgjsTexture;var n=new M.default;if(r.osgjsTexture=n,n.setFlipY(!1),n.setWrapS("REPEAT"),n.setWrapT("REPEAT"),a.osgjsImage){var o=U.TEXTURE_FORMAT[r.format];n.setImage(a.osgjsImage,o)}return n},_pbrMetallicRoughnessTextureUniforms:function(){var e=this._rootStateSet;if(!e.getUniformList()[U.ALBEDO_UNIFORM]){var t=I.a.createInt(U.ALBEDO_TEXTURE_UNIT,U.ALBEDO_UNIFORM),i=I.a.createInt(U.METALLIC_ROUGHNESS_TEXTURE_UNIT,U.METALLIC_ROUGHNESS_UNIFORM);e.addUniform(t),e.addUniform(i)}},_pbrMetallicRoughness:function(e,t){t.setUserData({pbrWorklow:U.PBR_METAL_MODE}),this._pbrMetallicRoughnessTextureUniforms();var i;if(e.baseColorTexture)i=this._texture(e.baseColorTexture),t.setTextureAttributeAndModes(U.ALBEDO_TEXTURE_UNIT,i);else if(e.baseColorFactor){var r=I.a.createFloat4(e.baseColorFactor,"uBaseColorFactor");t.addUniform(r)}if(void 0!==e.metallicFactor){var a=I.a.createFloat1(e.metallicFactor,"uMetallicFactor");t.addUniform(a)}if(void 0!==e.roughnessFactor){var n=I.a.createFloat1(e.roughnessFactor,"uRoughnessFactor");t.addUniform(n)}e.metallicRoughnessTexture&&(i=this._texture(e.metallicRoughnessTexture),t.setTextureAttributeAndModes(U.METALLIC_ROUGHNESS_TEXTURE_UNIT,i))},_KHR_materials_pbrSpecularGlossinessTextureUniforms:function(){if(!this._extensions.KHR_materials_pbrSpecularGlossinessTextureUniforms){this._extensions.KHR_materials_pbrSpecularGlossinessTextureUniforms=!0;var e=this._rootStateSet,t=I.a.createInt(U.DIFFUSE_TEXTURE_UNIT,U.ALBEDO_UNIFORM),i=I.a.createInt(U.SPECULAR_GLOSSINESS_TEXTURE_UNIT,U.METALLIC_ROUGHNESS_UNIFORM),r=I.a.createInt(U.SPECULAR_TEXTURE_UNIT,U.SPECULAR_UNIFORM);e.addUniform(t),e.addUniform(i),e.addUniform(r)}},_KHR_materials_pbrSpecularGlossiness:function(e,t){t.setUserData({pbrWorklow:U.PBR_SPEC_MODE}),this._KHR_materials_pbrSpecularGlossinessTextureUniforms();var i,r;if(e.diffuseTexture?(i=this._texture(e.diffuseTexture),t.setTextureAttributeAndModes(U.DIFFUSE_TEXTURE_UNIT,i)):e.diffuseFactor&&(r=I.a.createFloat4(e.diffuseFactor,"uBaseColorFactor"),t.addUniform(r)),e.specularFactor&&(r=I.a.createFloat3(e.specularFactor,"uSpecularFactor"),t.addUniform(r)),void 0!==e.glossinessFactor){var a=I.a.createFloat(e.glossinessFactor,"uGlossinessFactor");t.addUniform(a)}e.specularGlossinessTexture&&(i=this._texture(e.specularGlossinessTexture),t.setTextureAttributeAndModes(U.SPECULAR_GLOSSINESS_TEXTURE_UNIT,i))},loadMaterials:function(){var e=this._gltfJSON.materials,t=!1,i=!1,r=this._rootStateSet;r.addUniform(I.a.createInt(U.EMISSIVE_TEXTURE_UNIT,U.EMISSIVE_UNIFORM)),r.addUniform(I.a.createInt(U.AO_TEXTURE_UNIT,U.AO_UNIFORM)),r.addUniform(I.a.createInt(U.NORMAL_TEXTURE_UNIT,U.NORMAL_UNIFORM)),r.addUniform(I.a.createFloat3(F.f.ZERO,"uEmissiveFactor"));for(var a=0;a<e.length;a++){var n,o=e[a],u=new s.a;o.osgjsStateSet=u,o.pbrMetallicRoughness?this._pbrMetallicRoughness(o.pbrMetallicRoughness,u):o.extensions.KHR_materials_pbrSpecularGlossiness&&this._KHR_materials_pbrSpecularGlossiness(o.extensions.KHR_materials_pbrSpecularGlossiness,u),o.normalTexture&&(n=this._texture(o.normalTexture),u.setTextureAttributeAndModes(U.NORMAL_TEXTURE_UNIT,n)),o.occlusionTexture&&(n=this._texture(o.occlusionTexture),u.setTextureAttributeAndModes(U.AO_TEXTURE_UNIT,n)),o.emissiveTexture?(n=this._texture(o.emissiveTexture),u.setTextureAttributeAndModes(U.EMISSIVE_TEXTURE_UNIT,n)):o.emissiveFactor&&u.addUniform(I.a.createFloat3(o.emissiveFactor,"uEmissiveFactor")),"BLEND"===o.alphaMode&&(t=!0,u.setAttributeAndModes(this._transparentBlendFunc),u.setRenderingHint("TRANSPARENT_BIN")),o.doubleSided&&(i=!0,u.setAttributeAndModes(this._doubleSideCullFace))}t&&r.setAttributeAndModes(this._defaultBlendFunc),i&&r.setAttributeAndModes(this._defaultCullFace)},_createBone:function(e){var t=this._gltfJSON.nodes,i=t[e];i.usedAsBone=!0;var r=this._nodeAnimationTypes,a=new d.a,n=i.osgjsNodeName;a.setName(n);var o=this._computeNodeMatrix(i)||F.c.IDENTITY;a.setMatrix(o);var s=new D.a;if(s.setName(a.getName()),a.addUpdateCallback(s),r[e]){var u=s.getStackedTransforms();for(var l in r[e]){var c=U.TYPE_STACKED_TRANSFORMS[l],h=new c(l);u.push(h)}}return s.setMatrix(o),a},_createMatrixTransform:function(e){var t=this._gltfJSON.nodes,i=t[e],r=this._nodeAnimationTypes,a=new w.a,n=i.osgjsNodeName;a.setName(n);var o=this._computeNodeMatrix(i)||F.c.IDENTITY;if(a.setMatrix(o),r[e]){var s=new k.a;s.setName(a.getName()),a.addUpdateCallback(s),s.setMatrix(o);var u=s.getStackedTransforms();for(var l in r[e]){var c=U.TYPE_STACKED_TRANSFORMS[l],h=new c(l);u.push(h)}}return a},_processSkin:function(e){var t,i,r=this._gltfJSON.skins,a=this._gltfJSON.nodes,n=r[e],o=n.joints;void 0!==n.inverseBindMatrices&&(t=this._gltfJSON.accessors[n.inverseBindMatrices].data,i=t.getElements().buffer);var s=new h.a;n.osgjsNode=s,s.setName("skin ID "+e);for(var u,l,c,d={},p={},f=0;f<o.length;f++){if(u=o[f],c=this._createBone(u),void 0!==n.inverseBindMatrices){var m=new Float32Array(i,16*f*4,16);c.setInvBindMatrixInSkeletonSpace(m)}d[u]=c,p[c.getName()]=f}n.osgjsBoneMapID=p;for(var g in d){l=a[g];var _=l.parent;if(c=d[g],void 0===_||-1===o.indexOf(_))s.addChild(c);else{d[_].addChild(c)}}},loadAnimations:function(){var e=this._gltfJSON.animations;if(e){for(var t=this._gltfJSON.accessors,i=this._nodeAnimationTypes,r=this._gltfJSON.nodes,a=this._gltfJSON.meshes,n=[],o=0;o<e.length;o++){for(var s=e[o].channels,u=e[o].samplers,l=[],h=0;h<s.length;h++){var d=s[h],p=u[d.sampler],f=t[p.input].data.getElements(),m=t[p.output],g=m.data.getElements(),_=d.target,v=U.TYPE_CHANNEL_PATH[_.path][m.type],y=void 0!==_.node?_.node:_.id,x=r[y],S=_.path,M=r[y].osgjsNodeName;if("weights"===S)for(var w=a[x.mesh],T=w.primitives[0].targets.length,C=f.length,E=0;E<T;E++){for(var L=new Float32Array(C),P=0;P<C;P++)L[P]=g[P*T+E];M=this._getMorphTargetName(w,E),l.push(v(L,f,M,E))}else l.push(v(g,f,M,S));i[y]||(i[y]={}),i[y][S]=!0}var A="animation-"+o.toString();n.push(b.a.createAnimation(l,A))}var D=new c.a;D.init(n),this._animationManager=D}},loadURI:n.a.method(function(e,t){if("data:"===e.substr(0,5))return r(e);var i=this._filesMap[e];return void 0!==i?i:R.a.requestURI(e,t)}),readNodeURL:function(e,t){var i=this;if(this.init(),t&&void 0!==t.filesMap&&Object.keys(t.filesMap).length>0){this._filesMap=t.filesMap;var r=this._filesMap[e];return this.readJSON(r,e)}var a=e.lastIndexOf("/");return this._localPath=-1===a?"":e.substr(0,a+1),R.a.requestURI(e).then(function(e){return i.readJSON(e)})},readJSON:n.a.method(function(e,t){return this._gltfJSON=e,n.a.all([this.loadBuffers(),this.loadImages()]).then(function(){this.loadBufferViews(),this.loadAccessors(),this._preProcessNodes(),this.loadMaterials(),this.loadMeshes(),this.loadAnimations(),this.loadSkins(),this.loadNodes(),this.loadScenes();var e=new w.a;return e.addChild(this._osgjsScene[0]),e.setName(t),this._animationManager&&e.addUpdateCallback(this._animationManager),e.setStateSet(this._rootStateSet),e}.bind(this))})},l.a.instance().addReaderWriter("gltf",new U),t.a=U},function(e,t,i){"use strict";var r=i(7),a=i.n(r),n=i(21),o=i(595),s=i(549),u=i(418),l=window.JSZip,c=function(){this._options=void 0,this._filesMap={},this._fileName=""};c.prototype={readNodeURL:function(e,t){if(void 0===l)return n.a.error("You need to add JSZip as a dependency"),a.a.reject(this);n.a.log("starting to read: "+e);var i=this;if(t&&void 0!==t.filesMap&&void 0!==t.filesMap[e]){var r=t.filesMap[e];return this.readZipFile(r).then(function(){return i._fileName?u.default.readNodeURL(i._fileName,{filesMap:i._filesMap}):a.a.reject(i)})}return o.a.requestURI(e,{responseType:"blob"}).then(function(e){i.readZipFile(e).then(function(){return u.default.readNodeURL(i._fileName,{filesMap:i._filesMap})})})},readZipFile:function(e){o.a.unzip(e).then(function(e){for(var t in e){var i=o.a.getExtension(t);if(void 0!==s.a.instance().getReaderWriterForExtension(i)||"osgjs"===i){this._fileName=t;break}}}.bind(this))}},s.a.instance().addReaderWriter("zip",new c),t.a=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(416),a=i(16),n=r.a.osg,o=n.BufferArray.prototype.compile,s=function(e,t){return e+Math.random()*(t-e)},u=n.vec3.fromValues(s(.1,10),s(4.2,7.5),s(.7,1.5));n.BufferArray.randa=u;var l=function(e){i(554).default.logMessage(e)},c=function(e,t,i,r,a){var n=e.getElements(),s=e.getItemSize(),u=e.getNormalize();e.setNormalize(r),e.setItemSize(i),e.setElements(t),e._glType=e.getType(),e._glItemSize=i,e._glNormalize=r,o.call(e,a),e.setElements(n),e.setItemSize(s),e.setNormalize(u),e._dirty=!1},h=function(e,t){for(var i=e.getElements(),r=i.length,n=e.getItemSize(),o=n-1,s=0,u=new Int16Array(o*r/n),l=Object(a.a)().zoct,h=0;h<r;h+=n){var d=i[h],p=i[h+1],f=i[h+2],m=1/Math.sqrt(d*d+p*p+f*f);if(d*=m,p*=m,f*=m,l){var g=1/(Math.abs(d)+Math.abs(p)+Math.abs(f)),_=d*g,v=p*g,b=f*g,y=b>=0?_:(1-Math.abs(v))*(Math.sign(_)||1),x=b>=0?v:(1-Math.abs(_))*(Math.sign(v)||1);u[s]=32767*y,u[s+1]=32767*x}else if(f<=-.99999)u[s]=32767*Math.sqrt(.5),u[s+1]=32767*Math.sqrt(.5);else{var S=1/Math.sqrt(2*f+2);u[s]=32767*d*S,u[s+1]=32767*p*S}3===o&&(u[s+2]=32767*i[h+3]),s+=o}c(e,u,o,!0,t)},d=function(e,t){var i=e._QVS,r=e._QVT,n=e.getElements(),o=e._FQU||e._minMax&&e._minMax._FQU;o&&l("vFQU - "+e.getInstanceID());for(var s=Object(a.a)().zq&&!o,h=s?65535:1,d=s?Uint16Array:Float32Array,p=1/(u[0]*i[0]),f=1/(u[1]*i[1]),m=1/(u[2]*i[2]),g=r[0],_=r[1],v=r[2],b=Object(a.a)().zw,y=e.getItemSize(),x=b?4:3,S=n.length,M=new d(x*S/y),w=0,T=0;T<S;T+=y){var C=p*(n[T]-g),E=f*(n[T+1]-_),L=m*(n[T+2]-v);if(b){var P=0;P=Math.min(1,Math.max(C,E,L,1e-6)),s&&(P=Math.ceil(P*h)/h);var A=1/P;C*=A,E*=A,L*=A,M[w+3]=h*P}M[w]=h*C,M[w+1]=h*E,M[w+2]=h*L,w+=x}c(e,M,x,s,t)},p=function(e,t){var i=e._QUV,r=i[0],a=i[1],s=1/i[2],u=1/i[3],h=e.getElements(),d=h.length,p=0;if(Math.max(i[2],i[3])/65535>1/2048)return l("NoQUV - "+e.getInstanceID()),o.call(e,t),void n.vec4.set(i,0,0,1,1);var f=65535*s,m=65535*u,g=new Uint16Array(d);for(p=0;p<d;p+=2)g[p]=f*(h[p]-r),g[p+1]=m*(h[p+1]-a);c(e,g,2,!0,t)},f=n.BufferArray.prototype;f.compile=function(e){if(this._dirty)return this._QTAN||this._QNOR?h(this,e):this._QVS?d(this,e):this._QUV?p(this,e):void o.call(this,e)},f.getGlItemSize=function(){return this._glItemSize||this._itemSize},f.getGlType=function(){return this._glType||this._type},f.getGlNormalize=function(){return this._glNormalize||this._normalize};var m=n.BufferArrayProxy.prototype;m.getGlItemSize=function(){return this._bufferArray.getGlItemSize()},m.getGlType=function(){return this._bufferArray.getGlType()},m.getGlNormalize=function(){return this._bufferArray.getGlNormalize()};var g=function(e,t,i,r){for(var a=1/0,n=1/0,o=1/0,s=-1/0,u=-1/0,l=-1/0,c=t.getElements(),h=void 0===r?c.length:r,d=i||0;d<h;d+=3){var p=c[d],f=c[d+1],m=c[d+2];p<a&&(a=p),f<n&&(n=f),m<o&&(o=m),p>s&&(s=p),f>u&&(u=f),m>l&&(l=m)}return s<=a&&(s=.001),u<=n&&(u=.001),l<=o&&(l=.001),e.xmin=a,e.xmax=s,e.ymin=n,e.ymax=u,e.zmin=o,e.zmax=l,e},_=function(e,t,i,r){for(var a=1/0,n=1/0,o=-1/0,s=-1/0,u=t.getElements(),l=void 0===r?u.length:r,c=i||0;c<l;c+=2){var h=u[c],d=u[c+1];h<a&&(a=h),d<n&&(n=d),h>o&&(o=h),d>s&&(s=d)}return o<=a&&(o=.001),s<=n&&(s=.001),e.xmin=a,e.ymin=n,e.xmax=o,e.ymax=s,e};f.computeMinMaxVertex=function(e,t,i){return g(e,this,t,i)},f.computeMinMaxUV=function(e,t,i){return _(e,this,t,i)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(416),a=i(16),n=r.a.osg,o=r.a.osgUtil,s=r.a.osgShader,u=s.Compiler,l=u.prototype.getOrCreateAttribute,c=Math.random(),h=function(){var e,t=n.BufferArray.randa,i=t[0],r=t[1],a=t[2];c>.5?e="*":(e="/",i=1/i,r=1/r,a=1/a),i=i.toExponential(),r=r.toExponential(),a=a.toExponential();var o=Math.random();return o<.33?e+"vec3("+a+","+i+","+r+").yzx":o<.66?e+"vec3("+r+","+a+","+i+").zxy":e+"vec3("+a+","+i+","+r+").yzx"},d=function(e,t,i,r){var a=l.call(e,t,i);return e.getNode("InlineCode").code("%out = (%vert.xyz * %vert.w * %qs "+h()+") + %qt;").inputs({vert:a,qt:e.getOrCreateUniform("vec3","uQVT"),qs:e.getOrCreateUniform("vec3","uQVS")}).outputs({out:r}),r},p=function(e,t,i,r){var a=l.call(e,t,i),n=i.substr(8);return e.getNode("InlineCode").code("%out = (%uv.xy * %quv.zw) + %quv.xy;").inputs({uv:a,quv:e.getOrCreateUniform("vec4","uQUV"+n)}).outputs({out:r}),r},f=function(e,t,i,r){var n,o=l.call(e,t,i);return Object(a.a)().zoct?(n="%out.z = 1.0 - abs(%inp.x) - abs(%inp.y);",n+="\n%out.xy = %out.z >= 0.0 ? %inp.xy : (1.0 - abs(%inp.yx)) * sign(%inp.xy);"):(n="%tmp = dot(%inp.xy, %inp.xy);",n+="\n%out.xyz = vec3(2.0 * %inp.xy * sqrt(1.0 - %tmp), 1.0 - 2.0 * %tmp);"),"vec4"===r.getType()&&(n+="\n%out.w = %inp.z;"),e.getNode("InlineCode").code(n).inputs({inp:o,tmp:e.createVariable("float")}).outputs({out:r}),r},m={Vertex:!0,Normal:!0,Tangent:!0},g=function(e,t){return!(!e._vertexCompression||!Object(a.a)().zz)&&(!(e._morphAttribute||!m[t])||t.startsWith("TexCoord"))},_=function(e,t){if(!g(this,t))return l.call(this,e,t);var i="q"+t,r=this._variables[i];return r||(r=this.createVariable(e,i),"Vertex"===t?d(this,"vec4",t,r):"Normal"===t?f(this,"vec2",t,r):"Tangent"===t?f(this,"vec3",t,r):p(this,"vec2",t,r))},v=u.prototype.initAttributes,b=function(){v.call(this);for(var e=this._attributes,t=0,i=e.length;t<i;t++){if("VertexCompression"===e[t].className()){this._vertexCompression=e[t];break}}},y={attribute:["VertexCompression","SketchfabMaterial","Morph","Skinning","PointSize"],textureAttribute:[]},x=o.DisplayGeometryVisitor.CompilerColorGeometry,S=o.DisplayGeometryVisitor.CompilerSkinningGeometry;u.setStateAttributeConfig(x,y),u.setStateAttributeConfig(S,y),u.prototype.getOrCreateAttribute=_,x.prototype.getOrCreateAttribute=_,S.prototype.getOrCreateAttribute=_,u.prototype.initAttributes=b,x.prototype.initAttributes=b,S.prototype.initAttributes=b,t.default=u},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(416),a=r.a.osg,n=a.DrawElements.prototype.setIndices;a.DrawElements.prototype.setIndices=function(e){var t=e.getElements();a.WebGLCaps.instance().isWebGL2()&&(1===t.BYTES_PER_ELEMENT?-1!==t.indexOf(255)&&e.setElements(new Uint16Array(t)):2===t.BYTES_PER_ELEMENT&&-1!==t.indexOf(65535)&&e.setElements(new Uint32Array(t))),n.call(this,e)},t.default=a.DrawElements},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(416),a=r.a.osg,n=a.Geometry.prototype.computeBoundingBox;a.Geometry.prototype.computeBoundingBox=function(e){n.call(this,e);var t=this._displacementFactor=this._displacementFactor||0;if(t){var i=e.getMin(),r=e.getMax();i[0]-=t,i[1]-=t,i[2]-=t,r[0]+=t,r[1]+=t,r[2]+=t}return e};var o=a.Geometry.prototype.computeBoundingSphere;a.Geometry.prototype.computeBoundingSphere=function(e){o.call(this,e);var t=this._displacementFactor=this._displacementFactor||0;return t&&e.set(e.center(),e.radius()+t),e},t.default=a.Geometry},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(416),a=r.a.osg,n=new a.BoundingSphere;a.Node.prototype.getMinimumBound=function(){var e=this.getBoundingBox(),t=this.getBoundingSphere();return!e.valid()||t.volume()<e.volume()?t:(n.copyBoundingBox(e),n)},t.default=a.Node},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(416),a=r.a.osg;a.State.prototype.setVertexAttribArray=function(e,t){var i=this._vertexAttribMap;i._disable[e]=!1;var r=this._graphicContext,a=!1;t.isDirty()&&(t.bind(r),t.compile(r),a=!0);var n=i[e];n!==t&&(a||t.bind(r),n||(r.enableVertexAttribArray(e),void 0===n&&i._keys.push(e)),i[e]=t,r.vertexAttribPointer(e,t.getGlItemSize(),t.getGlType(),t.getGlNormalize(),0,0))},t.default=a.DrawElements},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"http://sketchfab.com/schema/modeloptions",title:"Camera settings",description:"Camera position and direction",type:"object",definitions:{vec2:{type:"array",minItems:2,maxItems:2,items:{type:"number"}},vec3:{type:"array",minItems:3,maxItems:3,items:{type:"number"}},intVec3:{type:"array",minItems:3,maxItems:3,items:{type:"integer"}},vec4:{type:"array",minItems:4,maxItems:4,items:{type:"number"}},matrix:{type:"array",minItems:16,maxItems:16,items:{type:"number"}},quaternion:{type:"array",minItems:4,maxItems:4,items:{type:"number"}},unitVec3:{type:"array",minItems:3,maximum:3,items:{$ref:"#/definitions/unitNumber"}},unitVec3Neg:{type:"array",minItems:3,maximum:3,items:{$ref:"#/definitions/unitNumberNeg"}},unitVec2Neg:{type:"array",minItems:2,maximum:2,items:{$ref:"#/definitions/unitNumberNeg"}},unitVec4:{type:"array",minItems:4,maximum:4,items:{$ref:"#/definitions/unitNumber"}},unitNumber:{type:"number",minimum:0,maximum:1},unitNumberNeg:{type:"number",minimum:-1,maximum:1},uid:{type:"string",pattern:"^[A-Fa-f0-9]{32}$"},uuid:{type:"string",pattern:"^[A-Fa-f0-9]{8}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{12}$"},hotspotData:{type:"object",properties:{geometryUid:{type:"integer"},uid:{$ref:"#/definitions/uid"},indices:{$ref:"#/definitions/intVec3"},barycentricWeights:{$ref:"#/definitions/vec3"},localPosition:{$ref:"#/definitions/vec3"}},additionalProperties:!1,required:["uid","geometryUid","indices","barycentricWeights","localPosition"]},soundtrack:{type:"object",properties:{uid:{$ref:"#/definitions/uid"},name:{type:"string",default:""},enable:{type:"boolean",default:!0},position:{$ref:"#/definitions/vec3",default:[0,0,0]},distance:{type:"number",minimum:0,default:-1},distanceMax:{type:"number",minimum:-1,default:-1},distanceModel:{type:"string",default:"exponential"},startTime:{type:"number",minimum:0,default:0},volume:{type:"number",minimum:0,default:1},ambient:{type:"boolean",default:!0},loop:{type:"boolean",default:!1},snap:{type:"boolean",default:!1},sync:{type:"boolean",default:!1},geometryUid:{type:"integer",default:-1},indices:{$ref:"#/definitions/intVec3",default:[-1,-1,-1]},barycentricWeights:{$ref:"#/definitions/vec3",default:[0,0,0]},localPosition:{$ref:"#/definitions/vec3",default:[0,0,0]}},required:["uid","name","enable","position","distance","distanceMax","distanceModel","startTime","volume","ambient","loop","snap","sync","geometryUid","indices","barycentricWeights","localPosition"],additionalProperties:!1},light:{type:"object",properties:{type:{type:"string",enum:["NONE","DIRECTION","POINT","SPOT","HEMI"],default:"NONE"},enable:{type:"boolean",default:!0},color:{$ref:"#/definitions/unitVec3",default:[1,1,1]},intensity:{type:"number",minimum:0,default:1},ground:{$ref:"#/definitions/unitVec3",default:[.3,.2,.2]},intensityGround:{type:"number",minimum:0,default:1},matrix:{$ref:"#/definitions/matrix"},falloff:{type:"number",minimum:0,default:-1},attachedToCamera:{type:"boolean",default:!1},angle:{type:"number",minimum:0,maximum:90,default:45},hardness:{$ref:"#/definitions/unitNumber",default:.5},castShadows:{type:"boolean",default:!0},shadowBias:{$ref:"#/definitions/unitNumber",default:.005}},required:["type","enable","color","intensity","ground","intensityGround","matrix","falloff","attachedToCamera","angle","hardness","castShadows","shadowBias"],additionalProperties:!1},texture:{type:"object",properties:{internalFormat:{type:"string",enum:["RGB","ALPHA","LUMINANCE"]},magFilter:{type:"string",enum:["LINEAR","NEAREST"]},minFilter:{type:"string",enum:["LINEAR","NEAREST","LINEAR_MIPMAP_LINEAR","NEAREST_MIPMAP_LINEAR"]},textureTarget:{type:"string",enum:["TEXTURE_2D"]},uid:{$ref:"#/definitions/uid"},wrapS:{type:"string",enum:["CLAMP_TO_EDGE","REPEAT","MIRRORED_REPEAT"]},wrapT:{type:"string",enum:["CLAMP_TO_EDGE","REPEAT","MIRRORED_REPEAT"]},texCoordUnit:{type:"integer",minimum:0}},required:["internalFormat","magFilter","minFilter","texCoordUnit","textureTarget","uid","wrapS","wrapT"],additionalProperties:!1},materialChannel:{type:"object",properties:{enable:{type:"boolean"},factor:{$ref:"#/definitions/unitNumber"},color:{$ref:"#/definitions/unitVec3"},texture:{$ref:"#/definitions/texture"}},oneOf:[{required:["color"]},{required:["texture"]}],required:["enable","factor"],additionalProperties:!1},materialChannelGrayScale:{type:"object",properties:{enable:{type:"boolean"},factor:{$ref:"#/definitions/unitNumber"},texture:{$ref:"#/definitions/texture"}},required:["enable","factor"],additionalProperties:!1},cullFace:{type:"string",enum:["DISABLE","BACK"]}},properties:{version:{type:"integer",minimum:0},background:{type:"object",properties:{enable:{type:"string",enum:["fixed","environment","color","ambient","none"],default:"fixed"},uid:{$ref:"#/definitions/uid",default:"51af6a870cce449eb75b0345feebaebb"},color:{$ref:"#/definitions/unitVec3",default:[.2,.2,.2]}},additionalProperties:!1,required:["enable","uid","color"]},lighting:{type:"object",properties:{enable:{type:"boolean",default:!1},lights:{type:"array",minItems:3,maxItems:3,items:{$ref:"#/definitions/light"},additionalItems:!1}},additionalProperties:!1,required:["lights","enable"]},camera:{type:"object",properties:{position:{$ref:"#/definitions/vec3"},target:{$ref:"#/definitions/vec3"},fov:{type:"number",minimum:0,maximum:180,default:45},nearFarRatio:{type:"number",minimum:1e-4,maximum:.005,default:.005},useCameraConstraints:{type:"boolean",default:!1},usePanConstraints:{type:"boolean",default:!0},useZoomConstraints:{type:"boolean",default:!1},usePitchConstraints:{type:"boolean",default:!1},useYawConstraints:{type:"boolean",default:!1},zoomIn:{type:"number",minimum:0,default:0},zoomOut:{type:"number",minimum:0,default:-1},left:{type:"number",minimum:-3.141593,maximum:3.141593,default:-3.141593},right:{type:"number",minimum:-3.141593,maximum:3.141593,default:3.141593},up:{type:"number",minimum:-1.570797,maximum:1.570797,default:1.555089},down:{type:"number",minimum:-1.570797,maximum:1.570797,default:-1.555089}},additionalProperties:!1,required:["position","target","fov","nearFarRatio","useCameraConstraints","usePanConstraints","useZoomConstraints","usePitchConstraints","useYawConstraints","zoomIn","zoomOut","left","right","up","down"]},environment:{type:"object",properties:{enable:{type:"boolean"},backgroundExposure:{type:"number",minimum:0,maximum:2,default:1},exposure:{type:"number",minimum:0,maximum:35},rotation:{type:"number",minimum:0,maximum:6.2831853072,default:0},uid:{$ref:"#/definitions/uid"},blur:{type:"number",minimum:0,maximum:1,default:.1},shadowEnable:{type:"boolean"},lightIntensity:{type:"number",minimum:0,default:1},shadowBias:{type:"number",minimum:0,default:.005}},additionalProperties:!1,required:["enable","backgroundExposure","exposure","rotation","uid","blur","shadowEnable","lightIntensity","shadowBias"]},materials:{type:"object",patternProperties:{"^[A-Fa-f0-9]{8}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{12}$":{type:"object",properties:{channels:{type:"object",properties:{Opacity:{type:"object",properties:{enable:{type:"boolean",default:!1},factor:{$ref:"#/definitions/unitNumber",default:1},type:{type:"string",enum:["alphaBlend","alphaMask","additive","dithering","refraction"],default:"alphaBlend"},invert:{type:"boolean",default:!1},texture:{$ref:"#/definitions/texture"},ior:{type:"number",minimum:1,maximum:2,default:1.05},roughnessFactor:{$ref:"#/definitions/unitNumber",default:0},useMicrosurfaceTexture:{type:"boolean",default:!0},useAlbedoTint:{type:"boolean"},thinLayer:{type:"boolean",default:!1},refractionColor:{$ref:"#/definitions/unitVec3",default:[1,1,1]}},required:["enable","factor","type","invert","ior","roughnessFactor","useMicrosurfaceTexture","useAlbedoTint","refractionColor","thinLayer"],additionalProperties:!1},SpecularHardness:{type:"object",properties:{enable:{type:"boolean",default:!0},factor:{type:"number",minimum:0,maximum:1e4,default:12.5},texture:{$ref:"#/definitions/texture"}},required:["enable","factor"],additionalProperties:!1},BumpMap:{type:"object",properties:{enable:{type:"boolean",default:!1},factor:{type:"number",minimum:0,maximum:10,default:1},texture:{$ref:"#/definitions/texture"}},required:["enable","factor"],additionalProperties:!1},Displacement:{type:"object",properties:{enable:{type:"boolean",default:!1},factor:{type:"number",minimum:0,default:0},texture:{$ref:"#/definitions/texture"}},required:["enable","factor"],additionalProperties:!1},SubsurfaceTranslucency:{type:"object",properties:{enable:{type:"boolean",default:!1},factor:{$ref:"#/definitions/unitNumber",default:1},thicknessFactor:{type:"number",minimum:0,default:-1},color:{$ref:"#/definitions/unitVec3",default:[1,.37,.3]},texture:{$ref:"#/definitions/texture"}},required:["enable","factor","thicknessFactor","color"],additionalProperties:!1},EmitColor:{type:"object",properties:{enable:{type:"boolean",default:!1},factor:{type:"number",minimum:0,maximum:10,default:0},color:{$ref:"#/definitions/unitVec3",default:[1,1,1]},texture:{$ref:"#/definitions/texture"},type:{type:"string",enum:["additive","multiplicative"],default:"additive"}},oneOf:[{required:["color"]},{required:["texture"]}],required:["enable","factor","type"],additionalProperties:!1},SubsurfaceScattering:{type:"object",properties:{enable:{type:"boolean",default:!1},factor:{type:"number",minimum:0,default:-1},texture:{$ref:"#/definitions/texture"},profile:{type:"integer",minimum:1,maximum:3,default:1}},required:["enable","factor","profile"],additionalProperties:!1},NormalMap:{type:"object",properties:{enable:{type:"boolean",default:!1},factor:{$ref:"#/definitions/unitNumber",default:1},texture:{$ref:"#/definitions/texture"},flipY:{type:"boolean",default:!0}},required:["enable","factor","flipY"],additionalProperties:!1},AOPBR:{type:"object",properties:{enable:{type:"boolean",default:!1},factor:{$ref:"#/definitions/unitNumber",default:1},texture:{$ref:"#/definitions/texture"},occludeSpecular:{type:"boolean",default:!1}},required:["enable","factor","occludeSpecular"],additionalProperties:!1},Matcap:{type:"object",properties:{enable:{type:"boolean",default:!0},factor:{$ref:"#/definitions/unitNumber",default:1},curvature:{type:"number",minimum:0,default:0},color:{$ref:"#/definitions/unitVec3",default:[1,1,1]},texture:{$ref:"#/definitions/texture"}},required:["texture","color","curvature","enable","factor"],additionalProperties:!1},DiffuseColor:{$ref:"#/definitions/materialChannel",default:{color:[1,1,1],factor:1,enable:!0}},DiffuseIntensity:{$ref:"#/definitions/materialChannel",default:{color:[1,1,1],factor:1,enable:!0}},SpecularColor:{$ref:"#/definitions/materialChannel",default:{color:[.5,.5,.5],factor:0,enable:!0}},DiffusePBR:{$ref:"#/definitions/materialChannel",default:{color:[1,1,1],factor:1,enable:!1}},AlbedoPBR:{$ref:"#/definitions/materialChannel",default:{color:[1,1,1],factor:1,enable:!0}},SpecularPBR:{$ref:"#/definitions/materialChannel",default:{color:[1,1,1],factor:.05,enable:!1}},GlossinessPBR:{$ref:"#/definitions/materialChannelGrayScale",default:{factor:.4,enable:!1}},RoughnessPBR:{$ref:"#/definitions/materialChannelGrayScale",default:{factor:.6,enable:!0}},MetalnessPBR:{$ref:"#/definitions/materialChannelGrayScale",default:{factor:0,enable:!0}},SpecularF0:{$ref:"#/definitions/materialChannelGrayScale",default:{factor:.5,enable:!0}},CavityPBR:{$ref:"#/definitions/materialChannelGrayScale",default:{factor:1,enable:!1}}},required:["DiffuseColor","DiffuseIntensity","EmitColor","NormalMap","BumpMap","Displacement","Opacity","SpecularColor","SpecularHardness","DiffusePBR","AlbedoPBR","SpecularPBR","GlossinessPBR","RoughnessPBR","MetalnessPBR","SpecularF0","AOPBR","CavityPBR","Matcap","SubsurfaceScattering","SubsurfaceTranslucency"],additionalProperties:!1},cullFace:{$ref:"#/definitions/cullFace",default:"DISABLE"},id:{$ref:"#/definitions/uuid",default:"0"},name:{type:"string",default:"noname"},reflection:{$ref:"#/definitions/unitNumber",defaults:.3},shadeless:{type:"boolean",default:!1},stateSetID:{type:"integer",default:0},version:{type:"integer",minimum:2}},required:["channels","cullFace","id","name","reflection","shadeless","stateSetID","version"],additionalProperties:!1}},properties:{updatedAt:{type:"integer"}},additionalProperties:!1},orientation:{type:"object",properties:{matrix:{$ref:"#/definitions/matrix",default:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},additionalProperties:!1,required:["matrix"]},scene:{type:"object",properties:{sssProfiles:{type:"array",minItems:3,maxItems:3,additionalItems:!1,items:[{type:"object",properties:{strength:{$ref:"#/definitions/unitVec3",default:[.48,.41,.28]},falloff:{$ref:"#/definitions/unitVec3",default:[1,.37,.3]}},additionalProperties:!1,required:["strength","falloff"]},{type:"object",properties:{strength:{$ref:"#/definitions/unitVec3",default:[.38,.61,.68]},falloff:{$ref:"#/definitions/unitVec3",default:[.5,.67,.6]}},additionalProperties:!1,required:["strength","falloff"]},{type:"object",properties:{strength:{$ref:"#/definitions/unitVec3",default:[.88,.61,.28]},falloff:{$ref:"#/definitions/unitVec3",default:[.7,.77,.3]}},additionalProperties:!1,required:["strength","falloff"]}]},postProcess:{type:"object",properties:{enable:{type:"boolean",default:!0},grain:{type:"object",properties:{enable:{type:"boolean",default:!1},animated:{type:"boolean",default:!1},factor:{type:"number",minimum:0,maximum:.5,default:.15}},additionalProperties:!1,required:["enable","animated","factor"]},sharpen:{type:"object",properties:{enable:{type:"boolean",default:!1},factor:{type:"number",minimum:0,maximum:5,default:.2}},additionalProperties:!1,required:["enable","factor"]},chromaticAberration:{type:"object",properties:{enable:{type:"boolean",default:!1},factor:{type:"number",minimum:0,maximum:.1,default:.05}},additionalProperties:!1,required:["enable","factor"]},vignette:{type:"object",properties:{enable:{type:"boolean",default:!1},amount:{$ref:"#/definitions/unitNumber",default:.475},hardness:{$ref:"#/definitions/unitNumber",default:.725}},additionalProperties:!1,required:["enable","amount","hardness"]},bloom:{type:"object",properties:{enable:{type:"boolean",default:!1},factor:{type:"number",minimum:0,maximum:2,default:0},threshold:{$ref:"#/definitions/unitNumber",default:.5},radius:{$ref:"#/definitions/unitNumber",default:.7}},additionalProperties:!1,required:["enable","factor","threshold","radius"]},toneMapping:{type:"object",properties:{enable:{type:"boolean",default:!1},method:{type:"string",enum:["default","reinhard","filmic"],default:"default"},exposure:{type:"number",minimum:0,maximum:2,default:1},brightness:{type:"number",minimum:-1,maximum:1,default:0},contrast:{type:"number",minimum:-1,maximum:1,default:0},saturation:{type:"number",minimum:0,maximum:2,default:1}},additionalProperties:!1,required:["enable","method","exposure","brightness","contrast","saturation"]},colorBalance:{type:"object",properties:{enable:{type:"boolean",default:!1},low:{$ref:"#/definitions/unitVec3Neg"},mid:{$ref:"#/definitions/unitVec3Neg"},high:{$ref:"#/definitions/unitVec3Neg"}},additionalProperties:!1,required:["enable","low","mid","high"]},dof:{type:"object",properties:{enable:{type:"boolean",default:!1},blurNear:{$ref:"#/definitions/unitNumber",default:.5},blurFar:{$ref:"#/definitions/unitNumber",default:.5},focusPoint:{$ref:"#/definitions/vec3"}},additionalProperties:!1,required:["enable","blurNear","blurFar","focusPoint"]},ssr:{type:"object",properties:{enable:{type:"boolean",default:!1},factor:{$ref:"#/definitions/unitNumber",default:1}},additionalProperties:!1,required:["enable","factor"]},ssao:{type:"object",properties:{enable:{type:"boolean",default:!1},radius:{type:"number",minimum:0,default:-1},intensity:{type:"number",minimum:0,maximum:1,default:.5},bias:{type:"number",minimum:0,default:-1}},additionalProperties:!1,required:["enable","radius","intensity","bias"]},taa:{type:"object",properties:{enable:{type:"boolean",default:!0},transparent:{type:"boolean",default:!0}},additionalProperties:!1,required:["enable","transparent"]}},additionalProperties:!1,required:["enable","grain","sharpen","chromaticAberration","vignette","bloom","toneMapping","colorBalance","dof","ssr","ssao","taa"]}},additionalProperties:!1,required:["sssProfiles","postProcess"]},shading:{type:"object",properties:{renderer:{type:"string",enum:["classic","pbr"],default:"classic"},type:{type:"string",enum:["lit","shadeless","matcap"],default:"lit"},vertexColor:{type:"object",properties:{enable:{type:"boolean",default:!0},useAlpha:{type:"boolean",default:!0},colorSpace:{type:"string",enum:["linear","srgb"],defaul:"srgb"}},additionalProperties:!1,required:["enable","useAlpha","colorSpace"]},pointSize:{type:"number",minimum:0,maximum:10,default:0}},additionalProperties:!1,required:["renderer","type","vertexColor","pointSize"]},wireframe:{type:"object",properties:{enable:{type:"boolean",default:!1},color:{type:"string",pattern:"^[A-Fa-f0-9]{8}$",default:"000000FF"}},additionalProperties:!1,required:["enable","color"]},animation:{type:"object",properties:{order:{type:"array",items:{type:"string"}},speed:{type:"number",minimum:0,default:1},cycleMode:{type:"string",enum:["one","all","none"],default:"one"},initializeWithRestPose:{type:"boolean",default:!1}},additionalProperties:!1,required:["order","speed","cycleMode","initializeWithRestPose"]},hotspot:{type:"object",properties:{hotspots:{type:"array",items:{$ref:"#/definitions/hotspotData"}},visible:{type:"boolean"}},additionalProperties:!1,required:["hotspots","visible"]},vr:{type:"object",properties:{worldFactor:{type:"number",default:-1},floorHeight:{type:"number",default:0},displayFloor:{type:"boolean",default:!0},initialCamera:{type:"object",properties:{position:{$ref:"#/definitions/vec3",default:[0,0,0]},rotation:{$ref:"#/definitions/vec4",default:[0,0,0,1]}},additionalProperties:!1,required:["position","rotation"]}},additionalProperties:!1,required:["worldFactor","initialCamera","floorHeight","displayFloor"]},sound:{type:"object",properties:{soundtracks:{type:"array",minItems:0,maxItems:32,items:{$ref:"#/definitions/soundtrack"},additionalItems:!1}},additionalProperties:!1,required:["soundtracks"]}}}},function(e,t,i){"use strict";function r(e){if(!(this instanceof r))return new r(e);e=this._opts=V.copy(e)||{},L(this),this._schemas={},this._refs={},this._fragments={},this._formats=I(e.format);var t=this._schemaUriFormat=this._formats["uri-reference"];this._schemaUriFormatFunc=function(e){return t.test(e)},this._cache=e.cache||new O,this._loadingSchemas={},this._compilations=[],this.RULES=F(),this._getId=_(e),e.loopRequired=e.loopRequired||1/0,"property"==e.errorDataPath&&(e._errorDataPathProperty=!0),void 0===e.serialize&&(e.serialize=R),this._metaOpts=E(this),e.formats&&T(this),M(this),"object"==typeof e.meta&&this.addMetaSchema(e.meta),w(this)}function a(e,t){var i;if("string"==typeof e){if(!(i=this.getSchema(e)))throw new Error('no schema with key or ref "'+e+'"')}else{var r=this._addSchema(e);i=r.validate||this._compile(r)}var a=i(t);return!0!==i.$async&&(this.errors=i.errors),a}function n(e,t){var i=this._addSchema(e,void 0,t);return i.validate||this._compile(i)}function o(e,t,i,r){if(Array.isArray(e)){for(var a=0;a<e.length;a++)this.addSchema(e[a],void 0,i,r);return this}var n=this._getId(e);if(void 0!==n&&"string"!=typeof n)throw new Error("schema id must be string");return t=D.normalizeId(t||n),C(this,t),this._schemas[t]=this._addSchema(e,i,r,!0),this}function s(e,t,i){return this.addSchema(e,t,i,!0),this}function u(e,t){var i=e.$schema;if(void 0!==i&&"string"!=typeof i)throw new Error("$schema must be a string");if(!(i=i||this._opts.defaultMeta||l(this)))return this.logger.warn("meta-schema not available"),this.errors=null,!0;var r=this._formats.uri;this._formats.uri="function"==typeof r?this._schemaUriFormatFunc:this._schemaUriFormat;var a;try{a=this.validate(i,e)}finally{this._formats.uri=r}if(!a&&t){var n="schema is invalid: "+this.errorsText();if("log"!=this._opts.validateSchema)throw new Error(n);this.logger.error(n)}return a}function l(e){var t=e._opts.meta;return e._opts.defaultMeta="object"==typeof t?e._getId(t)||t:e.getSchema(j)?j:void 0,e._opts.defaultMeta}function c(e){var t=d(this,e);switch(typeof t){case"object":return t.validate||this._compile(t);case"string":return this.getSchema(t);case"undefined":return h(this,e)}}function h(e,t){var i=D.schema.call(e,{schema:{}},t);if(i){var r=i.schema,a=i.root,n=i.baseId,o=A.call(e,r,a,void 0,n);return e._fragments[t]=new k({ref:t,fragment:!0,schema:r,root:a,baseId:n,validate:o}),o}}function d(e,t){return t=D.normalizeId(t),e._schemas[t]||e._refs[t]||e._fragments[t]}function p(e){if(e instanceof RegExp)return f(this,this._schemas,e),f(this,this._refs,e),this;switch(typeof e){case"undefined":return f(this,this._schemas),f(this,this._refs),this._cache.clear(),this;case"string":var t=d(this,e);return t&&this._cache.del(t.cacheKey),delete this._schemas[e],delete this._refs[e],this;case"object":var i=this._opts.serialize,r=i?i(e):e;this._cache.del(r);var a=this._getId(e);a&&(a=D.normalizeId(a),delete this._schemas[a],delete this._refs[a])}return this}function f(e,t,i){for(var r in t){var a=t[r];a.meta||i&&!i.test(r)||(e._cache.del(a.cacheKey),delete t[r])}}function m(e,t,i,r){if("object"!=typeof e&&"boolean"!=typeof e)throw new Error("schema should be object or boolean");var a=this._opts.serialize,n=a?a(e):e,o=this._cache.get(n);if(o)return o;r=r||!1!==this._opts.addUsedSchema;var s=D.normalizeId(this._getId(e));s&&r&&C(this,s);var u,l=!1!==this._opts.validateSchema&&!t;l&&!(u=s&&s==D.normalizeId(e.$schema))&&this.validateSchema(e,!0);var c=D.ids.call(this,e),h=new k({id:s,schema:e,localRefs:c,cacheKey:n,meta:i});return"#"!=s[0]&&r&&(this._refs[s]=h),this._cache.put(n,h),l&&u&&this.validateSchema(e,!0),h}function g(e,t){function i(){var t=e.validate,r=t.apply(this,arguments);return i.errors=t.errors,r}if(e.compiling)return e.validate=i,i.schema=e.schema,i.errors=null,i.root=t||i,!0===e.schema.$async&&(i.$async=!0),i;e.compiling=!0;var r;e.meta&&(r=this._opts,this._opts=this._metaOpts);var a;try{a=A.call(this,e.schema,t,e.localRefs)}catch(t){throw delete e.validate,t}finally{e.compiling=!1,e.meta&&(this._opts=r)}return e.validate=a,e.refs=a.refs,e.refVal=a.refVal,e.root=a.root,a}function _(e){switch(e.schemaId){case"auto":return y;case"id":return v;default:return b}}function v(e){return e.$id&&this.logger.warn("schema $id ignored",e.$id),e.id}function b(e){return e.id&&this.logger.warn("schema id ignored",e.id),e.$id}function y(e){if(e.$id&&e.id&&e.$id!=e.id)throw new Error("schema $id is different from id");return e.$id||e.id}function x(e,t){if(!(e=e||this.errors))return"No errors";t=t||{};for(var i=void 0===t.separator?", ":t.separator,r=void 0===t.dataVar?"data":t.dataVar,a="",n=0;n<e.length;n++){var o=e[n];o&&(a+=r+o.dataPath+" "+o.message+i)}return a.slice(0,-i.length)}function S(e,t){return"string"==typeof t&&(t=new RegExp(t)),this._formats[e]=t,this}function M(e){var t;if(e._opts.$data&&(t=i(1130),e.addMetaSchema(t,t.$id,!0)),!1!==e._opts.meta){var r=i(1131);e._opts.$data&&(r=N(r,Y)),e.addMetaSchema(r,j,!0),e._refs["http://json-schema.org/schema"]=j}}function w(e){var t=e._opts.schemas;if(t)if(Array.isArray(t))e.addSchema(t);else for(var i in t)e.addSchema(t[i],i)}function T(e){for(var t in e._opts.formats){var i=e._opts.formats[t];e.addFormat(t,i)}}function C(e,t){if(e._schemas[t]||e._refs[t])throw new Error('schema with key or id "'+t+'" already exists')}function E(e){for(var t=V.copy(e._opts),i=0;i<G.length;i++)delete t[G[i]];return t}function L(e){var t=e._opts.logger;if(!1===t)e.logger={log:P,warn:P,error:P};else{if(void 0===t&&(t=console),!("object"==typeof t&&t.log&&t.warn&&t.error))throw new Error("logger must implement log, warn and error methods");e.logger=t}}function P(){}var A=i(1099),D=i(697),O=i(1103),k=i(842),R=i(843),I=i(1104),F=i(1105),N=i(1126),V=i(456);e.exports=r,r.prototype.validate=a,r.prototype.compile=n,r.prototype.addSchema=o,r.prototype.addMetaSchema=s,r.prototype.validateSchema=u,r.prototype.getSchema=c,r.prototype.removeSchema=p,r.prototype.addFormat=S,r.prototype.errorsText=x,r.prototype._addSchema=m,r.prototype._compile=g,r.prototype.compileAsync=i(1127);var B=i(1128);r.prototype.addKeyword=B.add,r.prototype.getKeyword=B.get,r.prototype.removeKeyword=B.remove;var U=i(699);r.ValidationError=U.Validation,r.MissingRefError=U.MissingRef,r.$dataMetaSchema=N;var j="http://json-schema.org/draft-07/schema",G=["removeAdditional","useDefaults","coerceTypes"],Y=["/properties"]},function(e,t,i){"use strict";function r(e,t,i,o){function y(){var e=U.validate,t=e.apply(this,arguments);return y.errors=e.errors,t}function x(e,i,a,n){var o=!i||i&&i.schema==e;if(i.schema!=t.schema)return r.call(A,e,i,a,n);var m=!0===e.$async,y=g({isTop:!0,schema:e,isRoot:o,baseId:n,root:i,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:f.MissingRef,RULES:G,validate:g,util:p,resolve:d,resolveRef:S,usePattern:E,useDefault:L,useCustomRule:P,opts:D,formats:j,logger:A.logger,self:A});y=h(O,l)+h(R,s)+h(F,u)+h(V,c)+y,D.processCode&&(y=D.processCode(y));var x;try{x=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",y)(A,G,j,t,O,F,V,v,_,b),O[0]=x}catch(e){throw A.logger.error("Error compiling schema, function code:",y),e}return x.schema=e,x.errors=null,x.refs=k,x.refVal=O,x.root=o?x:i,m&&(x.$async=!0),!0===D.sourceCode&&(x.source={code:y,patterns:R,defaults:F}),x}function S(e,a,n){a=d.url(e,a);var o,s,u=k[a];if(void 0!==u)return o=O[u],s="refVal["+u+"]",C(o,s);if(!n&&t.refs){var l=t.refs[a];if(void 0!==l)return o=t.refVal[l],s=M(a,o),C(o,s)}s=M(a);var c=d.call(A,x,t,a);if(void 0===c){var h=i&&i[a];h&&(c=d.inlineRef(h,D.inlineRefs)?h:r.call(A,h,t,i,e))}if(void 0!==c)return T(a,c),C(c,s);w(a)}function M(e,t){var i=O.length;return O[i]=t,k[e]=i,"refVal"+i}function w(e){delete k[e]}function T(e,t){var i=k[e];O[i]=t}function C(e,t){return"object"==typeof e||"boolean"==typeof e?{code:t,schema:e,inline:!0}:{code:t,$async:e&&!!e.$async}}function E(e){var t=I[e];return void 0===t&&(t=I[e]=R.length,R[t]=e),"pattern"+t}function L(e){switch(typeof e){case"boolean":case"number":return""+e;case"string":return p.toQuotedString(e);case"object":if(null===e)return"null";var t=m(e),i=N[t];return void 0===i&&(i=N[t]=F.length,F[i]=e),"default"+i}}function P(e,t,i,r){var a=e.definition.validateSchema;if(a&&!1!==A._opts.validateSchema){if(!a(t)){var n="keyword schema is invalid: "+A.errorsText(a.errors);if("log"!=A._opts.validateSchema)throw new Error(n);A.logger.error(n)}}var o,s=e.definition.compile,u=e.definition.inline,l=e.definition.macro;if(s)o=s.call(A,t,i,r);else if(l)o=l.call(A,t,i,r),!1!==D.validateSchema&&A.validateSchema(o,!0);else if(u)o=u.call(A,r,e.keyword,t,i);else if(!(o=e.definition.validate))return;if(void 0===o)throw new Error('custom keyword "'+e.keyword+'"failed to compile');var c=V.length;return V[c]=o,{code:"customRule"+c,validate:o}}var A=this,D=this._opts,O=[void 0],k={},R=[],I={},F=[],N={},V=[];t=t||{schema:e,refVal:O,refs:k};var B=a.call(this,e,t,o),U=this._compilations[B.index];if(B.compiling)return U.callValidate=y;var j=this._formats,G=this.RULES;try{var Y=x(e,t,i,o);U.validate=Y;var H=U.callValidate;return H&&(H.schema=Y.schema,H.errors=null,H.refs=Y.refs,H.refVal=Y.refVal,H.root=Y.root,H.$async=Y.$async,D.sourceCode&&(H.source=Y.source)),Y}finally{n.call(this,e,t,o)}}function a(e,t,i){var r=o.call(this,e,t,i);return r>=0?{index:r,compiling:!0}:(r=this._compilations.length,this._compilations[r]={schema:e,root:t,baseId:i},{index:r,compiling:!1})}function n(e,t,i){var r=o.call(this,e,t,i);r>=0&&this._compilations.splice(r,1)}function o(e,t,i){for(var r=0;r<this._compilations.length;r++){var a=this._compilations[r];if(a.schema==e&&a.root==t&&a.baseId==i)return r}return-1}function s(e,t){return"var pattern"+e+" = new RegExp("+p.toQuotedString(t[e])+");"}function u(e){return"var default"+e+" = defaults["+e+"];"}function l(e,t){return void 0===t[e]?"":"var refVal"+e+" = refVal["+e+"];"}function c(e){return"var customRule"+e+" = customRules["+e+"];"}function h(e,t){if(!e.length)return"";for(var i="",r=0;r<e.length;r++)i+=t(r,e);return i}var d=i(697),p=i(456),f=i(699),m=i(843),g=i(844),_=p.ucs2length,v=i(698),b=f.Validation;e.exports=r},function(e,t,i){/** @license URI.js v4.2.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */
!function(e,i){i(t)}(0,function(e){"use strict";function t(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];if(t.length>1){t[0]=t[0].slice(0,-1);for(var r=t.length-1,a=1;a<r;++a)t[a]=t[a].slice(1,-1);return t[r]=t[r].slice(1),t.join("")}return t[0]}function i(e){return"(?:"+e+")"}function r(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function a(e){return e.toUpperCase()}function n(e){return void 0!==e&&null!==e?e instanceof Array?e:"number"!=typeof e.length||e.split||e.setInterval||e.call?[e]:Array.prototype.slice.call(e):[]}function o(e,t){var i=e;if(t)for(var r in t)i[r]=t[r];return i}function s(e){var r=t("[0-9]","[A-Fa-f]"),a=i(i("%[EFef]"+r+"%"+r+r+"%"+r+r)+"|"+i("%[89A-Fa-f]"+r+"%"+r+r)+"|"+i("%"+r+r)),n="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",o=t("[\\:\\/\\?\\#\\[\\]\\@]",n),s=e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",u=e?"[\\uE000-\\uF8FF]":"[]",l=t("[A-Za-z]","[0-9]","[\\-\\.\\_\\~]",s),c=i("[A-Za-z]"+t("[A-Za-z]","[0-9]","[\\+\\-\\.]")+"*"),h=i(i(a+"|"+t(l,n,"[\\:]"))+"*"),d=(i(i("25[0-5]")+"|"+i("2[0-4][0-9]")+"|"+i("1[0-9][0-9]")+"|"+i("[1-9][0-9]")+"|[0-9]"),i(i("25[0-5]")+"|"+i("2[0-4][0-9]")+"|"+i("1[0-9][0-9]")+"|"+i("0?[1-9][0-9]")+"|0?0?[0-9]")),p=i(d+"\\."+d+"\\."+d+"\\."+d),f=i(r+"{1,4}"),m=i(i(f+"\\:"+f)+"|"+p),g=i(i(f+"\\:")+"{6}"+m),_=i("\\:\\:"+i(f+"\\:")+"{5}"+m),v=i(i(f)+"?\\:\\:"+i(f+"\\:")+"{4}"+m),b=i(i(i(f+"\\:")+"{0,1}"+f)+"?\\:\\:"+i(f+"\\:")+"{3}"+m),y=i(i(i(f+"\\:")+"{0,2}"+f)+"?\\:\\:"+i(f+"\\:")+"{2}"+m),x=i(i(i(f+"\\:")+"{0,3}"+f)+"?\\:\\:"+f+"\\:"+m),S=i(i(i(f+"\\:")+"{0,4}"+f)+"?\\:\\:"+m),M=i(i(i(f+"\\:")+"{0,5}"+f)+"?\\:\\:"+f),w=i(i(i(f+"\\:")+"{0,6}"+f)+"?\\:\\:"),T=i([g,_,v,b,y,x,S,M,w].join("|")),C=i(i(l+"|"+a)+"+"),E=(i(T+"\\%25"+C),i(T+i("\\%25|\\%(?!"+r+"{2})")+C)),L=i("[vV]"+r+"+\\."+t(l,n,"[\\:]")+"+"),P=i("\\["+i(E+"|"+T+"|"+L)+"\\]"),A=i(i(a+"|"+t(l,n))+"*"),D=i(P+"|"+p+"(?!"+A+")|"+A),O=i("[0-9]*"),k=i(i(h+"@")+"?"+D+i("\\:"+O)+"?"),R=i(a+"|"+t(l,n,"[\\:\\@]")),I=i(R+"*"),F=i(R+"+"),N=i(i(a+"|"+t(l,n,"[\\@]"))+"+"),V=i(i("\\/"+I)+"*"),B=i("\\/"+i(F+V)+"?"),U=i(N+V),j=i(F+V),G="(?!"+R+")",Y=(i(V+"|"+B+"|"+U+"|"+j+"|"+G),i(i(R+"|"+t("[\\/\\?]",u))+"*")),H=i(i(R+"|[\\/\\?]")+"*"),z=i(i("\\/\\/"+k+V)+"|"+B+"|"+j+"|"+G),W=i(c+"\\:"+z+i("\\?"+Y)+"?"+i("\\#"+H)+"?"),q=i(i("\\/\\/"+k+V)+"|"+B+"|"+U+"|"+G),X=i(q+i("\\?"+Y)+"?"+i("\\#"+H)+"?");i(W+"|"+X),i(c+"\\:"+z+i("\\?"+Y)+"?"),i(i("\\/\\/("+i("("+h+")@")+"?("+D+")"+i("\\:("+O+")")+"?)")+"?("+V+"|"+B+"|"+j+"|"+G+")"),i("\\?("+Y+")"),i("\\#("+H+")"),i(i("\\/\\/("+i("("+h+")@")+"?("+D+")"+i("\\:("+O+")")+"?)")+"?("+V+"|"+B+"|"+U+"|"+G+")"),i("\\?("+Y+")"),i("\\#("+H+")"),i(i("\\/\\/("+i("("+h+")@")+"?("+D+")"+i("\\:("+O+")")+"?)")+"?("+V+"|"+B+"|"+j+"|"+G+")"),i("\\?("+Y+")"),i("\\#("+H+")"),i("("+h+")@"),i("\\:("+O+")");return{NOT_SCHEME:new RegExp(t("[^]","[A-Za-z]","[0-9]","[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",l,n),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",l,n),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",l,n),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",l,n),"g"),NOT_QUERY:new RegExp(t("[^\\%]",l,n,"[\\:\\@\\/\\?]",u),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",l,n,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",l,n),"g"),UNRESERVED:new RegExp(l,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",l,o),"g"),PCT_ENCODED:new RegExp(a,"g"),IPV4ADDRESS:new RegExp("^("+p+")$"),IPV6ADDRESS:new RegExp("^\\[?("+T+")"+i(i("\\%25|\\%(?!"+r+"{2})")+"("+C+")")+"?\\]?$")}}function u(e){throw new RangeError(N[e])}function l(e,t){for(var i=[],r=e.length;r--;)i[r]=t(e[r]);return i}function c(e,t){var i=e.split("@"),r="";return i.length>1&&(r=i[0]+"@",e=i[1]),e=e.replace(F,"."),r+l(e.split("."),t).join(".")}function h(e){for(var t=[],i=0,r=e.length;i<r;){var a=e.charCodeAt(i++);if(a>=55296&&a<=56319&&i<r){var n=e.charCodeAt(i++);56320==(64512&n)?t.push(((1023&a)<<10)+(1023&n)+65536):(t.push(a),i--)}else t.push(a)}return t}function d(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase()}function p(e){for(var t="",i=0,r=e.length;i<r;){var a=parseInt(e.substr(i+1,2),16);if(a<128)t+=String.fromCharCode(a),i+=3;else if(a>=194&&a<224){if(r-i>=6){var n=parseInt(e.substr(i+4,2),16);t+=String.fromCharCode((31&a)<<6|63&n)}else t+=e.substr(i,6);i+=6}else if(a>=224){if(r-i>=9){var o=parseInt(e.substr(i+4,2),16),s=parseInt(e.substr(i+7,2),16);t+=String.fromCharCode((15&a)<<12|(63&o)<<6|63&s)}else t+=e.substr(i,9);i+=9}else t+=e.substr(i,3),i+=3}return t}function f(e,t){function i(e){var i=p(e);return i.match(t.UNRESERVED)?i:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,i).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,i).replace(t.NOT_USERINFO,d).replace(t.PCT_ENCODED,a)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,i).toLowerCase().replace(t.NOT_HOST,d).replace(t.PCT_ENCODED,a)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,i).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,d).replace(t.PCT_ENCODED,a)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,i).replace(t.NOT_QUERY,d).replace(t.PCT_ENCODED,a)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,i).replace(t.NOT_FRAGMENT,d).replace(t.PCT_ENCODED,a)),e}function m(e){return e.replace(/^0*(.*)/,"$1")||"0"}function g(e,t){var i=e.match(t.IPV4ADDRESS)||[],r=D(i,2),a=r[1];return a?a.split(".").map(m).join("."):e}function _(e,t){var i=e.match(t.IPV6ADDRESS)||[],r=D(i,3),a=r[1],n=r[2];if(a){for(var o=a.toLowerCase().split("::").reverse(),s=D(o,2),u=s[0],l=s[1],c=l?l.split(":").map(m):[],h=u.split(":").map(m),d=t.IPV4ADDRESS.test(h[h.length-1]),p=d?7:8,f=h.length-p,_=Array(p),v=0;v<p;++v)_[v]=c[v]||h[f+v]||"";d&&(_[p-1]=g(_[p-1],t));var b=_.reduce(function(e,t,i){if(!t||"0"===t){var r=e[e.length-1];r&&r.index+r.length===i?r.length++:e.push({index:i,length:1})}return e},[]),y=b.sort(function(e,t){return t.length-e.length})[0],x=void 0;if(y&&y.length>1){var S=_.slice(0,y.index),M=_.slice(y.index+y.length);x=S.join(":")+"::"+M.join(":")}else x=_.join(":");return n&&(x+="%"+n),x}return e}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i={},r=!1!==t.iri?A:P;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var a=e.match(K);if(a){$?(i.scheme=a[1],i.userinfo=a[3],i.host=a[4],i.port=parseInt(a[5],10),i.path=a[6]||"",i.query=a[7],i.fragment=a[8],isNaN(i.port)&&(i.port=a[5])):(i.scheme=a[1]||void 0,i.userinfo=-1!==e.indexOf("@")?a[3]:void 0,i.host=-1!==e.indexOf("//")?a[4]:void 0,i.port=parseInt(a[5],10),i.path=a[6]||"",i.query=-1!==e.indexOf("?")?a[7]:void 0,i.fragment=-1!==e.indexOf("#")?a[8]:void 0,isNaN(i.port)&&(i.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?a[4]:void 0)),i.host&&(i.host=_(g(i.host,r),r)),void 0!==i.scheme||void 0!==i.userinfo||void 0!==i.host||void 0!==i.port||i.path||void 0!==i.query?void 0===i.scheme?i.reference="relative":void 0===i.fragment?i.reference="absolute":i.reference="uri":i.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==i.reference&&(i.error=i.error||"URI is not a "+t.reference+" reference.");var n=J[(t.scheme||i.scheme||"").toLowerCase()];if(t.unicodeSupport||n&&n.unicodeSupport)f(i,r);else{if(i.host&&(t.domainHost||n&&n.domainHost))try{i.host=X.toASCII(i.host.replace(r.PCT_ENCODED,p).toLowerCase())}catch(e){i.error=i.error||"Host's domain name can not be converted to ASCII via punycode: "+e}f(i,P)}n&&n.parse&&n.parse(i,t)}else i.error=i.error||"URI can not be parsed.";return i}function b(e,t){var i=!1!==t.iri?A:P,r=[];return void 0!==e.userinfo&&(r.push(e.userinfo),r.push("@")),void 0!==e.host&&r.push(_(g(String(e.host),i),i).replace(i.IPV6ADDRESS,function(e,t,i){return"["+t+(i?"%25"+i:"")+"]"})),"number"==typeof e.port&&(r.push(":"),r.push(e.port.toString(10))),r.length?r.join(""):void 0}function y(e){for(var t=[];e.length;)if(e.match(Q))e=e.replace(Q,"");else if(e.match(Z))e=e.replace(Z,"/");else if(e.match(ee))e=e.replace(ee,"/"),t.pop();else if("."===e||".."===e)e="";else{var i=e.match(te);if(!i)throw new Error("Unexpected dot segment condition");var r=i[0];e=e.slice(r.length),t.push(r)}return t.join("")}function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.iri?A:P,r=[],a=J[(t.scheme||e.scheme||"").toLowerCase()];if(a&&a.serialize&&a.serialize(e,t),e.host)if(i.IPV6ADDRESS.test(e.host));else if(t.domainHost||a&&a.domainHost)try{e.host=t.iri?X.toUnicode(e.host):X.toASCII(e.host.replace(i.PCT_ENCODED,p).toLowerCase())}catch(i){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+i}f(e,i),"suffix"!==t.reference&&e.scheme&&(r.push(e.scheme),r.push(":"));var n=b(e,t);if(void 0!==n&&("suffix"!==t.reference&&r.push("//"),r.push(n),e.path&&"/"!==e.path.charAt(0)&&r.push("/")),void 0!==e.path){var o=e.path;t.absolutePath||a&&a.absolutePath||(o=y(o)),void 0===n&&(o=o.replace(/^\/\//,"/%2F")),r.push(o)}return void 0!==e.query&&(r.push("?"),r.push(e.query)),void 0!==e.fragment&&(r.push("#"),r.push(e.fragment)),r.join("")}function S(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments[3],a={};return r||(e=v(x(e,i),i),t=v(x(t,i),i)),i=i||{},!i.tolerant&&t.scheme?(a.scheme=t.scheme,a.userinfo=t.userinfo,a.host=t.host,a.port=t.port,a.path=y(t.path||""),a.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(a.userinfo=t.userinfo,a.host=t.host,a.port=t.port,a.path=y(t.path||""),a.query=t.query):(t.path?("/"===t.path.charAt(0)?a.path=y(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?a.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:a.path=t.path:a.path="/"+t.path,a.path=y(a.path)),a.query=t.query):(a.path=e.path,void 0!==t.query?a.query=t.query:a.query=e.query),a.userinfo=e.userinfo,a.host=e.host,a.port=e.port),a.scheme=e.scheme),a.fragment=t.fragment,a}function M(e,t,i){var r=o({scheme:"null"},i);return x(S(v(e,r),v(t,r),r,!0),r)}function w(e,t){return"string"==typeof e?e=x(v(e,t),t):"object"===r(e)&&(e=v(x(e,t),t)),e}function T(e,t,i){return"string"==typeof e?e=x(v(e,i),i):"object"===r(e)&&(e=x(e,i)),"string"==typeof t?t=x(v(t,i),i):"object"===r(t)&&(t=x(t,i)),e===t}function C(e,t){return e&&e.toString().replace(t&&t.iri?A.ESCAPE:P.ESCAPE,d)}function E(e,t){return e&&e.toString().replace(t&&t.iri?A.PCT_ENCODED:P.PCT_ENCODED,p)}function L(e){var t=p(e);return t.match(le)?t:e}var P=s(!1),A=s(!0),D=function(){function e(e,t){var i=[],r=!0,a=!1,n=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(i.push(o.value),!t||i.length!==t);r=!0);}catch(e){a=!0,n=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw n}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),O=function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)},k=2147483647,R=/^xn--/,I=/[^\0-\x7E]/,F=/[\x2E\u3002\uFF0E\uFF61]/g,N={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},V=Math.floor,B=String.fromCharCode,U=function(e){return String.fromCodePoint.apply(String,O(e))},j=function(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:36},G=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},Y=function(e,t,i){var r=0;for(e=i?V(e/700):e>>1,e+=V(e/t);e>455;r+=36)e=V(e/35);return V(r+36*e/(e+38))},H=function(e){var t=[],i=e.length,r=0,a=128,n=72,o=e.lastIndexOf("-");o<0&&(o=0);for(var s=0;s<o;++s)e.charCodeAt(s)>=128&&u("not-basic"),t.push(e.charCodeAt(s));for(var l=o>0?o+1:0;l<i;){for(var c=r,h=1,d=36;;d+=36){l>=i&&u("invalid-input");var p=j(e.charCodeAt(l++));(p>=36||p>V((k-r)/h))&&u("overflow"),r+=p*h;var f=d<=n?1:d>=n+26?26:d-n;if(p<f)break;var m=36-f;h>V(k/m)&&u("overflow"),h*=m}var g=t.length+1;n=Y(r-c,g,0==c),V(r/g)>k-a&&u("overflow"),a+=V(r/g),r%=g,t.splice(r++,0,a)}return String.fromCodePoint.apply(String,t)},z=function(e){var t=[];e=h(e);var i=e.length,r=128,a=0,n=72,o=!0,s=!1,l=void 0;try{for(var c,d=e[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var p=c.value;p<128&&t.push(B(p))}}catch(e){s=!0,l=e}finally{try{!o&&d.return&&d.return()}finally{if(s)throw l}}var f=t.length,m=f;for(f&&t.push("-");m<i;){var g=k,_=!0,v=!1,b=void 0;try{for(var y,x=e[Symbol.iterator]();!(_=(y=x.next()).done);_=!0){var S=y.value;S>=r&&S<g&&(g=S)}}catch(e){v=!0,b=e}finally{try{!_&&x.return&&x.return()}finally{if(v)throw b}}var M=m+1;g-r>V((k-a)/M)&&u("overflow"),a+=(g-r)*M,r=g;var w=!0,T=!1,C=void 0;try{for(var E,L=e[Symbol.iterator]();!(w=(E=L.next()).done);w=!0){var P=E.value;if(P<r&&++a>k&&u("overflow"),P==r){for(var A=a,D=36;;D+=36){var O=D<=n?1:D>=n+26?26:D-n;if(A<O)break;var R=A-O,I=36-O;t.push(B(G(O+R%I,0))),A=V(R/I)}t.push(B(G(A,0))),n=Y(a,M,m==f),a=0,++m}}}catch(e){T=!0,C=e}finally{try{!w&&L.return&&L.return()}finally{if(T)throw C}}++a,++r}return t.join("")},W=function(e){return c(e,function(e){return R.test(e)?H(e.slice(4).toLowerCase()):e})},q=function(e){return c(e,function(e){return I.test(e)?"xn--"+z(e):e})},X={version:"2.1.0",ucs2:{decode:h,encode:U},decode:H,encode:z,toASCII:q,toUnicode:W},J={},K=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,$=void 0==="".match(/(){0}/)[1],Q=/^\.\.?\//,Z=/^\/\.(\/|$)/,ee=/^\/\.\.(\/|$)/,te=/^\/?(?:.|\n)*?(?=\/|$)/,ie={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){return e.port!==("https"!==String(e.scheme).toLowerCase()?80:443)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}},re={scheme:"https",domainHost:ie.domainHost,parse:ie.parse,serialize:ie.serialize},ae={},ne="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",oe="[0-9A-Fa-f]",se=i(i("%[EFef][0-9A-Fa-f]%"+oe+oe+"%"+oe+oe)+"|"+i("%[89A-Fa-f][0-9A-Fa-f]%"+oe+oe)+"|"+i("%"+oe+oe)),ue=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),le=new RegExp(ne,"g"),ce=new RegExp(se,"g"),he=new RegExp(t("[^]","[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]","[\\.]",'[\\"]',ue),"g"),de=new RegExp(t("[^]",ne,"[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]"),"g"),pe=de,fe={scheme:"mailto",parse:function(e,t){var i=e,r=i.to=i.path?i.path.split(","):[];if(i.path=void 0,i.query){for(var a=!1,n={},o=i.query.split("&"),s=0,u=o.length;s<u;++s){var l=o[s].split("=");switch(l[0]){case"to":for(var c=l[1].split(","),h=0,d=c.length;h<d;++h)r.push(c[h]);break;case"subject":i.subject=E(l[1],t);break;case"body":i.body=E(l[1],t);break;default:a=!0,n[E(l[0],t)]=E(l[1],t)}}a&&(i.headers=n)}i.query=void 0;for(var p=0,f=r.length;p<f;++p){var m=r[p].split("@");if(m[0]=E(m[0]),t.unicodeSupport)m[1]=E(m[1],t).toLowerCase();else try{m[1]=X.toASCII(E(m[1],t).toLowerCase())}catch(e){i.error=i.error||"Email address's domain name can not be converted to ASCII via punycode: "+e}r[p]=m.join("@")}return i},serialize:function(e,t){var i=e,r=n(e.to);if(r){for(var o=0,s=r.length;o<s;++o){var u=String(r[o]),l=u.lastIndexOf("@"),c=u.slice(0,l).replace(ce,L).replace(ce,a).replace(he,d),h=u.slice(l+1);try{h=t.iri?X.toUnicode(h):X.toASCII(E(h,t).toLowerCase())}catch(e){i.error=i.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+e}r[o]=c+"@"+h}i.path=r.join(",")}var p=e.headers=e.headers||{};e.subject&&(p.subject=e.subject),e.body&&(p.body=e.body);var f=[];for(var m in p)p[m]!==ae[m]&&f.push(m.replace(ce,L).replace(ce,a).replace(de,d)+"="+p[m].replace(ce,L).replace(ce,a).replace(pe,d));return f.length&&(i.query=f.join("&")),i}},me=/^([^\:]+)\:(.*)/,ge={scheme:"urn",parse:function(e,t){var i=e.path&&e.path.match(me),r=e;if(i){var a=t.scheme||r.scheme||"urn",n=i[1].toLowerCase(),o=i[2],s=a+":"+(t.nid||n),u=J[s];r.nid=n,r.nss=o,r.path=void 0,u&&(r=u.parse(r,t))}else r.error=r.error||"URN can not be parsed.";return r},serialize:function(e,t){var i=t.scheme||e.scheme||"urn",r=e.nid,a=i+":"+(t.nid||r),n=J[a];n&&(e=n.serialize(e,t));var o=e,s=e.nss;return o.path=(r||t.nid)+":"+s,o}},_e=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,ve={scheme:"urn:uuid",parse:function(e,t){var i=e;return i.uuid=i.nss,i.nss=void 0,t.tolerant||i.uuid&&i.uuid.match(_e)||(i.error=i.error||"UUID is not valid."),i},serialize:function(e,t){var i=e;return i.nss=(e.uuid||"").toLowerCase(),i}};J[ie.scheme]=ie,J[re.scheme]=re,J[fe.scheme]=fe,J[ge.scheme]=ge,J[ve.scheme]=ve,e.SCHEMES=J,e.pctEncChar=d,e.pctDecChars=p,e.parse=v,e.removeDotSegments=y,e.serialize=x,e.resolveComponents=S,e.resolve=M,e.normalize=w,e.equal=T,e.escapeComponent=C,e.unescapeComponent=E,Object.defineProperty(e,"__esModule",{value:!0})})},function(e,t,i){"use strict";e.exports=function(e){for(var t,i=0,r=e.length,a=0;a<r;)i++,(t=e.charCodeAt(a++))>=55296&&t<=56319&&a<r&&56320==(64512&(t=e.charCodeAt(a)))&&a++;return i}},function(e,t,i){"use strict";function r(e,t,i,o,s,u,l,c,h){if(i&&"object"==typeof i&&!Array.isArray(i)){t(i,o,s,u,l,c,h);for(var d in i){var p=i[d];if(Array.isArray(p)){if(d in n.arrayKeywords)for(var f=0;f<p.length;f++)r(e,t,p[f],o+"/"+d+"/"+f,s,o,d,i,f)}else if(d in n.propsKeywords){if(p&&"object"==typeof p)for(var m in p)r(e,t,p[m],o+"/"+d+"/"+a(m),s,o,d,i,m)}else(d in n.keywords||e.allKeys&&!(d in n.skipKeywords))&&r(e,t,p,o+"/"+d,s,o,d,i)}}}function a(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}var n=e.exports=function(e,t,i){"function"==typeof t&&(i=t,t={}),r(t,i,e,"",e)};n.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0},n.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},n.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},n.skipKeywords={enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},function(e,t,i){"use strict";var r=e.exports=function(){this._cache={}};r.prototype.put=function(e,t){this._cache[e]=t},r.prototype.get=function(e){return this._cache[e]},r.prototype.del=function(e){delete this._cache[e]},r.prototype.clear=function(){this._cache={}}},function(e,t,i){"use strict";function r(e){return e="full"==e?"full":"fast",h.copy(r[e])}function a(e){return e%4==0&&(e%100!=0||e%400==0)}function n(e){var t=e.match(d);if(!t)return!1;var i=+t[1],r=+t[2],n=+t[3];return r>=1&&r<=12&&n>=1&&n<=(2==r&&a(i)?29:p[r])}function o(e,t){var i=e.match(f);if(!i)return!1;var r=i[1],a=i[2],n=i[3],o=i[5];return(r<=23&&a<=59&&n<=59||23==r&&59==a&&60==n)&&(!t||o)}function s(e){var t=e.split(w);return 2==t.length&&n(t[0])&&o(t[1],!0)}function u(e){return e.length<=255&&m.test(e)}function l(e){return T.test(e)&&g.test(e)}function c(e){if(C.test(e))return!1;try{return new RegExp(e),!0}catch(e){return!1}}var h=i(456),d=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,p=[0,31,28,31,30,31,30,31,31,30,31,30,31],f=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d:\d\d)?$/i,m=/^[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*$/i,g=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@\/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@\/?]|%[0-9a-f]{2})*)?$/i,_=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@\/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@\/?]|%[0-9a-f]{2})*)?$/i,v=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#.\/;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,b=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,y=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,x=/^(?:\/(?:[^~\/]|~0|~1)*)*$/,S=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,M=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~\/]|~0|~1)*)*)$/;e.exports=r,r.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d:\d\d)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d:\d\d)$/i,uri:/^(?:[a-z][a-z0-9+-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":v,url:b,email:/^[a-z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:m,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:c,uuid:y,"json-pointer":x,"json-pointer-uri-fragment":S,"relative-json-pointer":M},r.full={date:n,time:o,"date-time":s,uri:l,"uri-reference":_,"uri-template":v,url:b,email:/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&''*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:u,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:c,uuid:y,"json-pointer":x,"json-pointer-uri-fragment":S,"relative-json-pointer":M};var w=/t|\s/i,T=/\/|:/,C=/[^\\]\\Z/},function(e,t,i){"use strict";var r=i(1106),a=i(456).toHash;e.exports=function(){var e=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],t=["type","$comment"],i=["$schema","$id","id","$data","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"],n=["number","integer","string","array","object","boolean","null"];return e.all=a(t),e.types=a(n),e.forEach(function(i){i.rules=i.rules.map(function(i){var a;if("object"==typeof i){var n=Object.keys(i)[0];a=i[n],i=n,a.forEach(function(i){t.push(i),e.all[i]=!0})}return t.push(i),e.all[i]={keyword:i,code:r[i],implements:a}}),e.all.$comment={keyword:"$comment",code:r.$comment},i.type&&(e.types[i.type]=i)}),e.keywords=a(t.concat(i)),e.custom={},e}},function(e,t,i){"use strict";e.exports={$ref:i(1107),allOf:i(1108),anyOf:i(1109),$comment:i(1110),const:i(1111),contains:i(1112),dependencies:i(1113),enum:i(1114),format:i(1115),if:i(1116),items:i(1117),maximum:i(845),minimum:i(845),maxItems:i(846),minItems:i(846),maxLength:i(847),minLength:i(847),maxProperties:i(848),minProperties:i(848),multipleOf:i(1118),not:i(1119),oneOf:i(1120),pattern:i(1121),properties:i(1122),propertyNames:i(1123),required:i(1124),uniqueItems:i(1125),validate:i(844)}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r,a,n=" ",o=e.level,s=e.dataLevel,u=e.schema[t],l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,h="data"+(s||""),d="valid"+o;if("#"==u||"#/"==u)e.isRoot?(r=e.async,a="validate"):(r=!0===e.root.schema.$async,a="root.refVal[0]");else{var p=e.resolveRef(e.baseId,u,e.isRoot);if(void 0===p){var f=e.MissingRefError.message(e.baseId,u);if("fail"==e.opts.missingRefs){e.logger.error(f);var m=m||[];m.push(n),n="",!1!==e.createErrors?(n+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { ref: '"+e.util.escapeQuotes(u)+"' } ",!1!==e.opts.messages&&(n+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(u)+"' "),e.opts.verbose&&(n+=" , schema: "+e.util.toQuotedString(u)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),n+=" } "):n+=" {} ";var g=n;n=m.pop(),!e.compositeRule&&c?e.async?n+=" throw new ValidationError(["+g+"]); ":n+=" validate.errors = ["+g+"]; return false; ":n+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c&&(n+=" if (false) { ")}else{if("ignore"!=e.opts.missingRefs)throw new e.MissingRefError(e.baseId,u,f);e.logger.warn(f),c&&(n+=" if (true) { ")}}else if(p.inline){var _=e.util.copy(e);_.level++;var v="valid"+_.level;_.schema=p.schema,_.schemaPath="",_.errSchemaPath=u;var b=e.validate(_).replace(/validate\.schema/g,p.code);n+=" "+b+" ",c&&(n+=" if ("+v+") { ")}else r=!0===p.$async||e.async&&!1!==p.$async,a=p.code}if(a){var m=m||[];m.push(n),n="",e.opts.passContext?n+=" "+a+".call(this, ":n+=" "+a+"( ",n+=" "+h+", (dataPath || '')",'""'!=e.errorPath&&(n+=" + "+e.errorPath);n+=" , "+(s?"data"+(s-1||""):"parentData")+" , "+(s?e.dataPathArr[s]:"parentDataProperty")+", rootData)  ";var y=n;if(n=m.pop(),r){if(!e.async)throw new Error("async schema referenced by sync schema");c&&(n+=" var "+d+"; "),n+=" try { await "+y+"; ",c&&(n+=" "+d+" = true; "),n+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",c&&(n+=" "+d+" = false; "),n+=" } ",c&&(n+=" if ("+d+") { ")}else n+=" if (!"+y+") { if (vErrors === null) vErrors = "+a+".errors; else vErrors = vErrors.concat("+a+".errors); errors = vErrors.length; } ",c&&(n+=" else { ")}return n}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r=" ",a=e.schema[t],n=e.schemaPath+e.util.getProperty(t),o=e.errSchemaPath+"/"+t,s=!e.opts.allErrors,u=e.util.copy(e),l="";u.level++;var c="valid"+u.level,h=u.baseId,d=!0,p=a;if(p)for(var f,m=-1,g=p.length-1;m<g;)f=p[m+=1],e.util.schemaHasRules(f,e.RULES.all)&&(d=!1,u.schema=f,u.schemaPath=n+"["+m+"]",u.errSchemaPath=o+"/"+m,r+="  "+e.validate(u)+" ",u.baseId=h,s&&(r+=" if ("+c+") { ",l+="}"));return s&&(r+=d?" if (true) { ":" "+l.slice(0,-1)+" "),r=e.util.cleanUpCode(r)}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r=" ",a=e.level,n=e.dataLevel,o=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,c="data"+(n||""),h="valid"+a,d="errs__"+a,p=e.util.copy(e),f="";p.level++;var m="valid"+p.level;if(o.every(function(t){return e.util.schemaHasRules(t,e.RULES.all)})){var g=p.baseId;r+=" var "+d+" = errors; var "+h+" = false;  ";var _=e.compositeRule;e.compositeRule=p.compositeRule=!0;var v=o;if(v)for(var b,y=-1,x=v.length-1;y<x;)b=v[y+=1],p.schema=b,p.schemaPath=s+"["+y+"]",p.errSchemaPath=u+"/"+y,r+="  "+e.validate(p)+" ",p.baseId=g,r+=" "+h+" = "+h+" || "+m+"; if (!"+h+") { ",f+="}";e.compositeRule=p.compositeRule=_,r+=" "+f+" if (!"+h+") {   var err =   ",!1!==e.createErrors?(r+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&l&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+=" } else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } ",e.opts.allErrors&&(r+=" } "),r=e.util.cleanUpCode(r)}else l&&(r+=" if (true) { ");return r}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r=" ",a=e.schema[t],n=e.errSchemaPath+"/"+t,o=(e.opts.allErrors,e.util.toQuotedString(a));return!0===e.opts.$comment?r+=" console.log("+o+");":"function"==typeof e.opts.$comment&&(r+=" self._opts.$comment("+o+", "+e.util.toQuotedString(n)+", validate.root.schema);"),r}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r=" ",a=e.level,n=e.dataLevel,o=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,c="data"+(n||""),h="valid"+a,d=e.opts.$data&&o&&o.$data;d&&(r+=" var schema"+a+" = "+e.util.getData(o.$data,n,e.dataPathArr)+"; "),d||(r+=" var schema"+a+" = validate.schema"+s+";"),r+="var "+h+" = equal("+c+", schema"+a+"); if (!"+h+") {   ";var p=p||[];p.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { allowedValue: schema"+a+" } ",!1!==e.opts.messages&&(r+=" , message: 'should be equal to constant' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ";var f=r;return r=p.pop(),!e.compositeRule&&l?e.async?r+=" throw new ValidationError(["+f+"]); ":r+=" validate.errors = ["+f+"]; return false; ":r+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }",l&&(r+=" else { "),r}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r=" ",a=e.level,n=e.dataLevel,o=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,c="data"+(n||""),h="valid"+a,d="errs__"+a,p=e.util.copy(e);p.level++;var f="valid"+p.level,m="i"+a,g=p.dataLevel=e.dataLevel+1,_="data"+g,v=e.baseId,b=e.util.schemaHasRules(o,e.RULES.all);if(r+="var "+d+" = errors;var "+h+";",b){var y=e.compositeRule;e.compositeRule=p.compositeRule=!0,p.schema=o,p.schemaPath=s,p.errSchemaPath=u,r+=" var "+f+" = false; for (var "+m+" = 0; "+m+" < "+c+".length; "+m+"++) { ",p.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers,!0);var x=c+"["+m+"]";p.dataPathArr[g]=m;var S=e.validate(p);p.baseId=v,e.util.varOccurences(S,_)<2?r+=" "+e.util.varReplace(S,_,x)+" ":r+=" var "+_+" = "+x+"; "+S+" ",r+=" if ("+f+") break; }  ",e.compositeRule=p.compositeRule=y,r+="  if (!"+f+") {"}else r+=" if ("+c+".length == 0) {";var M=M||[];M.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'should contain a valid item' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ";var w=r;return r=M.pop(),!e.compositeRule&&l?e.async?r+=" throw new ValidationError(["+w+"]); ":r+=" validate.errors = ["+w+"]; return false; ":r+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { ",b&&(r+="  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } "),e.opts.allErrors&&(r+=" } "),r=e.util.cleanUpCode(r)}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r=" ",a=e.level,n=e.dataLevel,o=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,c="data"+(n||""),h="errs__"+a,d=e.util.copy(e),p="";d.level++;var f="valid"+d.level,m={},g={},_=e.opts.ownProperties;for(x in o){var v=o[x],b=Array.isArray(v)?g:m;b[x]=v}r+="var "+h+" = errors;";var y=e.errorPath;r+="var missing"+a+";";for(var x in g)if(b=g[x],b.length){if(r+=" if ( "+c+e.util.getProperty(x)+" !== undefined ",_&&(r+=" && Object.prototype.hasOwnProperty.call("+c+", '"+e.util.escapeQuotes(x)+"') "),l){r+=" && ( ";var S=b;if(S)for(var M,w=-1,T=S.length-1;w<T;){M=S[w+=1],w&&(r+=" || ");var C=e.util.getProperty(M),E=c+C;r+=" ( ( "+E+" === undefined ",_&&(r+=" || ! Object.prototype.hasOwnProperty.call("+c+", '"+e.util.escapeQuotes(M)+"') "),r+=") && (missing"+a+" = "+e.util.toQuotedString(e.opts.jsonPointers?M:C)+") ) "}r+=")) {  ";var L="missing"+a,P="' + "+L+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(y,L,!0):y+" + "+L);var A=A||[];A.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { property: '"+e.util.escapeQuotes(x)+"', missingProperty: '"+P+"', depsCount: "+b.length+", deps: '"+e.util.escapeQuotes(1==b.length?b[0]:b.join(", "))+"' } ",!1!==e.opts.messages&&(r+=" , message: 'should have ",1==b.length?r+="property "+e.util.escapeQuotes(b[0]):r+="properties "+e.util.escapeQuotes(b.join(", ")),r+=" when property "+e.util.escapeQuotes(x)+" is present' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ";var D=r;r=A.pop(),!e.compositeRule&&l?e.async?r+=" throw new ValidationError(["+D+"]); ":r+=" validate.errors = ["+D+"]; return false; ":r+=" var err = "+D+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{r+=" ) { ";var O=b;if(O)for(var M,k=-1,R=O.length-1;k<R;){M=O[k+=1];var C=e.util.getProperty(M),P=e.util.escapeQuotes(M),E=c+C;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(y,M,e.opts.jsonPointers)),r+=" if ( "+E+" === undefined ",_&&(r+=" || ! Object.prototype.hasOwnProperty.call("+c+", '"+e.util.escapeQuotes(M)+"') "),r+=") {  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { property: '"+e.util.escapeQuotes(x)+"', missingProperty: '"+P+"', depsCount: "+b.length+", deps: '"+e.util.escapeQuotes(1==b.length?b[0]:b.join(", "))+"' } ",!1!==e.opts.messages&&(r+=" , message: 'should have ",1==b.length?r+="property "+e.util.escapeQuotes(b[0]):r+="properties "+e.util.escapeQuotes(b.join(", ")),r+=" when property "+e.util.escapeQuotes(x)+" is present' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}r+=" }   ",l&&(p+="}",r+=" else { ")}e.errorPath=y;var I=d.baseId;for(var x in m){var v=m[x];e.util.schemaHasRules(v,e.RULES.all)&&(r+=" "+f+" = true; if ( "+c+e.util.getProperty(x)+" !== undefined ",_&&(r+=" && Object.prototype.hasOwnProperty.call("+c+", '"+e.util.escapeQuotes(x)+"') "),r+=") { ",d.schema=v,d.schemaPath=s+e.util.getProperty(x),d.errSchemaPath=u+"/"+e.util.escapeFragment(x),r+="  "+e.validate(d)+" ",d.baseId=I,r+=" }  ",l&&(r+=" if ("+f+") { ",p+="}"))}return l&&(r+="   "+p+" if ("+h+" == errors) {"),r=e.util.cleanUpCode(r)}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r=" ",a=e.level,n=e.dataLevel,o=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,c="data"+(n||""),h="valid"+a,d=e.opts.$data&&o&&o.$data;d&&(r+=" var schema"+a+" = "+e.util.getData(o.$data,n,e.dataPathArr)+"; ");var p="i"+a,f="schema"+a;d||(r+=" var "+f+" = validate.schema"+s+";"),r+="var "+h+";",d&&(r+=" if (schema"+a+" === undefined) "+h+" = true; else if (!Array.isArray(schema"+a+")) "+h+" = false; else {"),r+=h+" = false;for (var "+p+"=0; "+p+"<"+f+".length; "+p+"++) if (equal("+c+", "+f+"["+p+"])) { "+h+" = true; break; }",d&&(r+="  }  "),r+=" if (!"+h+") {   ";var m=m||[];m.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { allowedValues: schema"+a+" } ",!1!==e.opts.messages&&(r+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ";var g=r;return r=m.pop(),!e.compositeRule&&l?e.async?r+=" throw new ValidationError(["+g+"]); ":r+=" validate.errors = ["+g+"]; return false; ":r+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }",l&&(r+=" else { "),r}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r=" ",a=e.level,n=e.dataLevel,o=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,c="data"+(n||"");if(!1===e.opts.format)return l&&(r+=" if (true) { "),r;var h,d=e.opts.$data&&o&&o.$data;d?(r+=" var schema"+a+" = "+e.util.getData(o.$data,n,e.dataPathArr)+"; ",h="schema"+a):h=o;var p=e.opts.unknownFormats,f=Array.isArray(p);if(d){var m="format"+a,g="isObject"+a,_="formatType"+a;r+=" var "+m+" = formats["+h+"]; var "+g+" = typeof "+m+" == 'object' && !("+m+" instanceof RegExp) && "+m+".validate; var "+_+" = "+g+" && "+m+".type || 'string'; if ("+g+") { ",e.async&&(r+=" var async"+a+" = "+m+".async; "),r+=" "+m+" = "+m+".validate; } if (  ",d&&(r+=" ("+h+" !== undefined && typeof "+h+" != 'string') || "),r+=" (","ignore"!=p&&(r+=" ("+h+" && !"+m+" ",f&&(r+=" && self._opts.unknownFormats.indexOf("+h+") == -1 "),r+=") || "),r+=" ("+m+" && "+_+" == '"+i+"' && !(typeof "+m+" == 'function' ? ",e.async?r+=" (async"+a+" ? await "+m+"("+c+") : "+m+"("+c+")) ":r+=" "+m+"("+c+") ",r+=" : "+m+".test("+c+"))))) {"}else{var m=e.formats[o];if(!m){if("ignore"==p)return e.logger.warn('unknown format "'+o+'" ignored in schema at path "'+e.errSchemaPath+'"'),l&&(r+=" if (true) { "),r;if(f&&p.indexOf(o)>=0)return l&&(r+=" if (true) { "),r;throw new Error('unknown format "'+o+'" is used in schema at path "'+e.errSchemaPath+'"')}var g="object"==typeof m&&!(m instanceof RegExp)&&m.validate,_=g&&m.type||"string";if(g){var v=!0===m.async;m=m.validate}if(_!=i)return l&&(r+=" if (true) { "),r;if(v){if(!e.async)throw new Error("async format in sync schema");var b="formats"+e.util.getProperty(o)+".validate";r+=" if (!(await "+b+"("+c+"))) { "}else{r+=" if (! ";var b="formats"+e.util.getProperty(o);g&&(b+=".validate"),r+="function"==typeof m?" "+b+"("+c+") ":" "+b+".test("+c+") ",r+=") { "}}var y=y||[];y.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { format:  ",r+=d?""+h:""+e.util.toQuotedString(o),r+="  } ",!1!==e.opts.messages&&(r+=" , message: 'should match format \"",r+=d?"' + "+h+" + '":""+e.util.escapeQuotes(o),r+="\"' "),e.opts.verbose&&(r+=" , schema:  ",r+=d?"validate.schema"+s:""+e.util.toQuotedString(o),r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ";var x=r;return r=y.pop(),!e.compositeRule&&l?e.async?r+=" throw new ValidationError(["+x+"]); ":r+=" validate.errors = ["+x+"]; return false; ":r+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",l&&(r+=" else { "),r}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r=" ",a=e.level,n=e.dataLevel,o=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,c="data"+(n||""),h="valid"+a,d="errs__"+a,p=e.util.copy(e);p.level++;var f="valid"+p.level,m=e.schema.then,g=e.schema.else,_=void 0!==m&&e.util.schemaHasRules(m,e.RULES.all),v=void 0!==g&&e.util.schemaHasRules(g,e.RULES.all),b=p.baseId;if(_||v){var y;p.createErrors=!1,p.schema=o,p.schemaPath=s,p.errSchemaPath=u,r+=" var "+d+" = errors; var "+h+" = true;  ";var x=e.compositeRule;e.compositeRule=p.compositeRule=!0,r+="  "+e.validate(p)+" ",p.baseId=b,p.createErrors=!0,r+="  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; }  ",e.compositeRule=p.compositeRule=x,_?(r+=" if ("+f+") {  ",p.schema=e.schema.then,p.schemaPath=e.schemaPath+".then",p.errSchemaPath=e.errSchemaPath+"/then",r+="  "+e.validate(p)+" ",p.baseId=b,r+=" "+h+" = "+f+"; ",_&&v?(y="ifClause"+a,r+=" var "+y+" = 'then'; "):y="'then'",r+=" } ",v&&(r+=" else { ")):r+=" if (!"+f+") { ",v&&(p.schema=e.schema.else,p.schemaPath=e.schemaPath+".else",p.errSchemaPath=e.errSchemaPath+"/else",r+="  "+e.validate(p)+" ",p.baseId=b,r+=" "+h+" = "+f+"; ",_&&v?(y="ifClause"+a,r+=" var "+y+" = 'else'; "):y="'else'",r+=" } "),r+=" if (!"+h+") {   var err =   ",!1!==e.createErrors?(r+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { failingKeyword: "+y+" } ",!1!==e.opts.messages&&(r+=" , message: 'should match \"' + "+y+" + '\" schema' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&l&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+=" }   ",l&&(r+=" else { "),r=e.util.cleanUpCode(r)}else l&&(r+=" if (true) { ");return r}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r=" ",a=e.level,n=e.dataLevel,o=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,c="data"+(n||""),h="valid"+a,d="errs__"+a,p=e.util.copy(e),f="";p.level++;var m="valid"+p.level,g="i"+a,_=p.dataLevel=e.dataLevel+1,v="data"+_,b=e.baseId;if(r+="var "+d+" = errors;var "+h+";",Array.isArray(o)){var y=e.schema.additionalItems;if(!1===y){r+=" "+h+" = "+c+".length <= "+o.length+"; ";var x=u;u=e.errSchemaPath+"/additionalItems",r+="  if (!"+h+") {   ";var S=S||[];S.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+o.length+" } ",!1!==e.opts.messages&&(r+=" , message: 'should NOT have more than "+o.length+" items' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ";var M=r;r=S.pop(),!e.compositeRule&&l?e.async?r+=" throw new ValidationError(["+M+"]); ":r+=" validate.errors = ["+M+"]; return false; ":r+=" var err = "+M+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",u=x,l&&(f+="}",r+=" else { ")}var w=o;if(w)for(var T,C=-1,E=w.length-1;C<E;)if(T=w[C+=1],e.util.schemaHasRules(T,e.RULES.all)){r+=" "+m+" = true; if ("+c+".length > "+C+") { ";var L=c+"["+C+"]";p.schema=T,p.schemaPath=s+"["+C+"]",p.errSchemaPath=u+"/"+C,p.errorPath=e.util.getPathExpr(e.errorPath,C,e.opts.jsonPointers,!0),p.dataPathArr[_]=C;var P=e.validate(p);p.baseId=b,e.util.varOccurences(P,v)<2?r+=" "+e.util.varReplace(P,v,L)+" ":r+=" var "+v+" = "+L+"; "+P+" ",r+=" }  ",l&&(r+=" if ("+m+") { ",f+="}")}if("object"==typeof y&&e.util.schemaHasRules(y,e.RULES.all)){p.schema=y,p.schemaPath=e.schemaPath+".additionalItems",p.errSchemaPath=e.errSchemaPath+"/additionalItems",r+=" "+m+" = true; if ("+c+".length > "+o.length+") {  for (var "+g+" = "+o.length+"; "+g+" < "+c+".length; "+g+"++) { ",p.errorPath=e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers,!0);var L=c+"["+g+"]";p.dataPathArr[_]=g;var P=e.validate(p);p.baseId=b,e.util.varOccurences(P,v)<2?r+=" "+e.util.varReplace(P,v,L)+" ":r+=" var "+v+" = "+L+"; "+P+" ",l&&(r+=" if (!"+m+") break; "),r+=" } }  ",l&&(r+=" if ("+m+") { ",f+="}")}}else if(e.util.schemaHasRules(o,e.RULES.all)){p.schema=o,p.schemaPath=s,p.errSchemaPath=u,r+="  for (var "+g+" = 0; "+g+" < "+c+".length; "+g+"++) { ",p.errorPath=e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers,!0);var L=c+"["+g+"]";p.dataPathArr[_]=g;var P=e.validate(p);p.baseId=b,e.util.varOccurences(P,v)<2?r+=" "+e.util.varReplace(P,v,L)+" ":r+=" var "+v+" = "+L+"; "+P+" ",l&&(r+=" if (!"+m+") break; "),r+=" }"}return l&&(r+=" "+f+" if ("+d+" == errors) {"),r=e.util.cleanUpCode(r)}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r,a=" ",n=e.level,o=e.dataLevel,s=e.schema[t],u=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,h="data"+(o||""),d=e.opts.$data&&s&&s.$data;d?(a+=" var schema"+n+" = "+e.util.getData(s.$data,o,e.dataPathArr)+"; ",r="schema"+n):r=s,a+="var division"+n+";if (",d&&(a+=" "+r+" !== undefined && ( typeof "+r+" != 'number' || "),a+=" (division"+n+" = "+h+" / "+r+", ",e.opts.multipleOfPrecision?a+=" Math.abs(Math.round(division"+n+") - division"+n+") > 1e-"+e.opts.multipleOfPrecision+" ":a+=" division"+n+" !== parseInt(division"+n+") ",a+=" ) ",d&&(a+="  )  "),a+=" ) {   ";var p=p||[];p.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { multipleOf: "+r+" } ",!1!==e.opts.messages&&(a+=" , message: 'should be multiple of ",a+=d?"' + "+r:r+"'"),e.opts.verbose&&(a+=" , schema:  ",a+=d?"validate.schema"+u:""+s,a+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),a+=" } "):a+=" {} ";var f=a;return a=p.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+f+"]); ":a+=" validate.errors = ["+f+"]; return false; ":a+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+="} ",c&&(a+=" else { "),a}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r=" ",a=e.level,n=e.dataLevel,o=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,c="data"+(n||""),h="errs__"+a,d=e.util.copy(e);d.level++;var p="valid"+d.level;if(e.util.schemaHasRules(o,e.RULES.all)){d.schema=o,d.schemaPath=s,d.errSchemaPath=u,r+=" var "+h+" = errors;  ";var f=e.compositeRule;e.compositeRule=d.compositeRule=!0,d.createErrors=!1;var m;d.opts.allErrors&&(m=d.opts.allErrors,d.opts.allErrors=!1),r+=" "+e.validate(d)+" ",d.createErrors=!0,m&&(d.opts.allErrors=m),e.compositeRule=d.compositeRule=f,r+=" if ("+p+") {   ";var g=g||[];g.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'should NOT be valid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ";var _=r;r=g.pop(),!e.compositeRule&&l?e.async?r+=" throw new ValidationError(["+_+"]); ":r+=" validate.errors = ["+_+"]; return false; ":r+=" var err = "+_+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else {  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; } ",e.opts.allErrors&&(r+=" } ")}else r+="  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'should NOT be valid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l&&(r+=" if (false) { ");return r}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r=" ",a=e.level,n=e.dataLevel,o=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,c="data"+(n||""),h="valid"+a,d="errs__"+a,p=e.util.copy(e),f="";p.level++;var m="valid"+p.level,g=p.baseId,_="prevValid"+a,v="passingSchemas"+a;r+="var "+d+" = errors , "+_+" = false , "+h+" = false , "+v+" = null; ";var b=e.compositeRule;e.compositeRule=p.compositeRule=!0;var y=o;if(y)for(var x,S=-1,M=y.length-1;S<M;)x=y[S+=1],e.util.schemaHasRules(x,e.RULES.all)?(p.schema=x,p.schemaPath=s+"["+S+"]",p.errSchemaPath=u+"/"+S,r+="  "+e.validate(p)+" ",p.baseId=g):r+=" var "+m+" = true; ",S&&(r+=" if ("+m+" && "+_+") { "+h+" = false; "+v+" = ["+v+", "+S+"]; } else { ",f+="}"),r+=" if ("+m+") { "+h+" = "+_+" = true; "+v+" = "+S+"; }";return e.compositeRule=p.compositeRule=b,r+=f+"if (!"+h+") {   var err =   ",!1!==e.createErrors?(r+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { passingSchemas: "+v+" } ",!1!==e.opts.messages&&(r+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&l&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+="} else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; }",e.opts.allErrors&&(r+=" } "),r}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r,a=" ",n=e.level,o=e.dataLevel,s=e.schema[t],u=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,h="data"+(o||""),d=e.opts.$data&&s&&s.$data;d?(a+=" var schema"+n+" = "+e.util.getData(s.$data,o,e.dataPathArr)+"; ",r="schema"+n):r=s;var p=d?"(new RegExp("+r+"))":e.usePattern(s);a+="if ( ",d&&(a+=" ("+r+" !== undefined && typeof "+r+" != 'string') || "),a+=" !"+p+".test("+h+") ) {   ";var f=f||[];f.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { pattern:  ",a+=d?""+r:""+e.util.toQuotedString(s),a+="  } ",!1!==e.opts.messages&&(a+=" , message: 'should match pattern \"",a+=d?"' + "+r+" + '":""+e.util.escapeQuotes(s),a+="\"' "),e.opts.verbose&&(a+=" , schema:  ",a+=d?"validate.schema"+u:""+e.util.toQuotedString(s),a+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),a+=" } "):a+=" {} ";var m=a;return a=f.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+m+"]); ":a+=" validate.errors = ["+m+"]; return false; ":a+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+="} ",c&&(a+=" else { "),a}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r=" ",a=e.level,n=e.dataLevel,o=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,c="data"+(n||""),h="errs__"+a,d=e.util.copy(e),p="";d.level++;var f="valid"+d.level,m="key"+a,g="idx"+a,_=d.dataLevel=e.dataLevel+1,v="data"+_,b="dataProperties"+a,y=Object.keys(o||{}),x=e.schema.patternProperties||{},S=Object.keys(x),M=e.schema.additionalProperties,w=y.length||S.length,T=!1===M,C="object"==typeof M&&Object.keys(M).length,E=e.opts.removeAdditional,L=T||C||E,P=e.opts.ownProperties,A=e.baseId,D=e.schema.required;if(D&&(!e.opts.$data||!D.$data)&&D.length<e.opts.loopRequired)var O=e.util.toHash(D);if(r+="var "+h+" = errors;var "+f+" = true;",P&&(r+=" var "+b+" = undefined;"),L){if(r+=P?" "+b+" = "+b+" || Object.keys("+c+"); for (var "+g+"=0; "+g+"<"+b+".length; "+g+"++) { var "+m+" = "+b+"["+g+"]; ":" for (var "+m+" in "+c+") { ",w){if(r+=" var isAdditional"+a+" = !(false ",y.length)if(y.length>8)r+=" || validate.schema"+s+".hasOwnProperty("+m+") ";else{var k=y;if(k)for(var R,I=-1,F=k.length-1;I<F;)R=k[I+=1],r+=" || "+m+" == "+e.util.toQuotedString(R)+" "}if(S.length){var N=S;if(N)for(var V,B=-1,U=N.length-1;B<U;)V=N[B+=1],r+=" || "+e.usePattern(V)+".test("+m+") "}r+=" ); if (isAdditional"+a+") { "}if("all"==E)r+=" delete "+c+"["+m+"]; ";else{var j=e.errorPath,G="' + "+m+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers)),T)if(E)r+=" delete "+c+"["+m+"]; ";else{r+=" "+f+" = false; ";var Y=u;u=e.errSchemaPath+"/additionalProperties";var H=H||[];H.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { additionalProperty: '"+G+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is an invalid additional property":r+="should NOT have additional properties",r+="' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ";var z=r;r=H.pop(),!e.compositeRule&&l?e.async?r+=" throw new ValidationError(["+z+"]); ":r+=" validate.errors = ["+z+"]; return false; ":r+=" var err = "+z+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u=Y,l&&(r+=" break; ")}else if(C)if("failing"==E){r+=" var "+h+" = errors;  ";var W=e.compositeRule;e.compositeRule=d.compositeRule=!0,d.schema=M,d.schemaPath=e.schemaPath+".additionalProperties",d.errSchemaPath=e.errSchemaPath+"/additionalProperties",d.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);var q=c+"["+m+"]";d.dataPathArr[_]=m;var X=e.validate(d);d.baseId=A,e.util.varOccurences(X,v)<2?r+=" "+e.util.varReplace(X,v,q)+" ":r+=" var "+v+" = "+q+"; "+X+" ",r+=" if (!"+f+") { errors = "+h+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+c+"["+m+"]; }  ",e.compositeRule=d.compositeRule=W}else{d.schema=M,d.schemaPath=e.schemaPath+".additionalProperties",d.errSchemaPath=e.errSchemaPath+"/additionalProperties",d.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);var q=c+"["+m+"]";d.dataPathArr[_]=m;var X=e.validate(d);d.baseId=A,e.util.varOccurences(X,v)<2?r+=" "+e.util.varReplace(X,v,q)+" ":r+=" var "+v+" = "+q+"; "+X+" ",l&&(r+=" if (!"+f+") break; ")}e.errorPath=j}w&&(r+=" } "),r+=" }  ",l&&(r+=" if ("+f+") { ",p+="}")}var J=e.opts.useDefaults&&!e.compositeRule;if(y.length){var K=y;if(K)for(var R,$=-1,Q=K.length-1;$<Q;){R=K[$+=1];var Z=o[R];if(e.util.schemaHasRules(Z,e.RULES.all)){var ee=e.util.getProperty(R),q=c+ee,te=J&&void 0!==Z.default;d.schema=Z,d.schemaPath=s+ee,d.errSchemaPath=u+"/"+e.util.escapeFragment(R),d.errorPath=e.util.getPath(e.errorPath,R,e.opts.jsonPointers),d.dataPathArr[_]=e.util.toQuotedString(R);var X=e.validate(d);if(d.baseId=A,e.util.varOccurences(X,v)<2){X=e.util.varReplace(X,v,q);var ie=q}else{var ie=v;r+=" var "+v+" = "+q+"; "}if(te)r+=" "+X+" ";else{if(O&&O[R]){r+=" if ( "+ie+" === undefined ",P&&(r+=" || ! Object.prototype.hasOwnProperty.call("+c+", '"+e.util.escapeQuotes(R)+"') "),r+=") { "+f+" = false; ";var j=e.errorPath,Y=u,re=e.util.escapeQuotes(R);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(j,R,e.opts.jsonPointers)),u=e.errSchemaPath+"/required";var H=H||[];H.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+re+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+re+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ";var z=r;r=H.pop(),!e.compositeRule&&l?e.async?r+=" throw new ValidationError(["+z+"]); ":r+=" validate.errors = ["+z+"]; return false; ":r+=" var err = "+z+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u=Y,e.errorPath=j,r+=" } else { "}else l?(r+=" if ( "+ie+" === undefined ",P&&(r+=" || ! Object.prototype.hasOwnProperty.call("+c+", '"+e.util.escapeQuotes(R)+"') "),r+=") { "+f+" = true; } else { "):(r+=" if ("+ie+" !== undefined ",P&&(r+=" &&   Object.prototype.hasOwnProperty.call("+c+", '"+e.util.escapeQuotes(R)+"') "),r+=" ) { ");r+=" "+X+" } "}}l&&(r+=" if ("+f+") { ",p+="}")}}if(S.length){var ae=S;if(ae)for(var V,ne=-1,oe=ae.length-1;ne<oe;){V=ae[ne+=1];var Z=x[V];if(e.util.schemaHasRules(Z,e.RULES.all)){d.schema=Z,d.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(V),d.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(V),r+=P?" "+b+" = "+b+" || Object.keys("+c+"); for (var "+g+"=0; "+g+"<"+b+".length; "+g+"++) { var "+m+" = "+b+"["+g+"]; ":" for (var "+m+" in "+c+") { ",r+=" if ("+e.usePattern(V)+".test("+m+")) { ",d.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);var q=c+"["+m+"]";d.dataPathArr[_]=m;var X=e.validate(d);d.baseId=A,e.util.varOccurences(X,v)<2?r+=" "+e.util.varReplace(X,v,q)+" ":r+=" var "+v+" = "+q+"; "+X+" ",l&&(r+=" if (!"+f+") break; "),r+=" } ",l&&(r+=" else "+f+" = true; "),r+=" }  ",l&&(r+=" if ("+f+") { ",p+="}")}}}return l&&(r+=" "+p+" if ("+h+" == errors) {"),r=e.util.cleanUpCode(r)}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r=" ",a=e.level,n=e.dataLevel,o=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,c="data"+(n||""),h="errs__"+a,d=e.util.copy(e);d.level++;var p="valid"+d.level;if(e.util.schemaHasRules(o,e.RULES.all)){d.schema=o,d.schemaPath=s,d.errSchemaPath=u;var f="key"+a,m="idx"+a,g="i"+a,_="' + "+f+" + '",v=d.dataLevel=e.dataLevel+1,b="data"+v,y="dataProperties"+a,x=e.opts.ownProperties,S=e.baseId;r+=" var "+h+" = errors; ",x&&(r+=" var "+y+" = undefined; "),r+=x?" "+y+" = "+y+" || Object.keys("+c+"); for (var "+m+"=0; "+m+"<"+y+".length; "+m+"++) { var "+f+" = "+y+"["+m+"]; ":" for (var "+f+" in "+c+") { ",r+=" var startErrs"+a+" = errors; ";var M=f,w=e.compositeRule;e.compositeRule=d.compositeRule=!0;var T=e.validate(d);d.baseId=S,e.util.varOccurences(T,b)<2?r+=" "+e.util.varReplace(T,b,M)+" ":r+=" var "+b+" = "+M+"; "+T+" ",e.compositeRule=d.compositeRule=w,r+=" if (!"+p+") { for (var "+g+"=startErrs"+a+"; "+g+"<errors; "+g+"++) { vErrors["+g+"].propertyName = "+f+"; }   var err =   ",!1!==e.createErrors?(r+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { propertyName: '"+_+"' } ",!1!==e.opts.messages&&(r+=" , message: 'property name \\'"+_+"\\' is invalid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&l&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),l&&(r+=" break; "),r+=" } }"}return l&&(r+="  if ("+h+" == errors) {"),r=e.util.cleanUpCode(r)}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r=" ",a=e.level,n=e.dataLevel,o=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,c="data"+(n||""),h="valid"+a,d=e.opts.$data&&o&&o.$data;d&&(r+=" var schema"+a+" = "+e.util.getData(o.$data,n,e.dataPathArr)+"; ");var p="schema"+a;if(!d)if(o.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var f=[],m=o;if(m)for(var g,_=-1,v=m.length-1;_<v;){g=m[_+=1];var b=e.schema.properties[g];b&&e.util.schemaHasRules(b,e.RULES.all)||(f[f.length]=g)}}else var f=o;if(d||f.length){var y=e.errorPath,x=d||f.length>=e.opts.loopRequired,S=e.opts.ownProperties;if(l)if(r+=" var missing"+a+"; ",x){d||(r+=" var "+p+" = validate.schema"+s+"; ");var M="i"+a,w="schema"+a+"["+M+"]",T="' + "+w+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(y,w,e.opts.jsonPointers)),r+=" var "+h+" = true; ",d&&(r+=" if (schema"+a+" === undefined) "+h+" = true; else if (!Array.isArray(schema"+a+")) "+h+" = false; else {"),r+=" for (var "+M+" = 0; "+M+" < "+p+".length; "+M+"++) { "+h+" = "+c+"["+p+"["+M+"]] !== undefined ",S&&(r+=" &&   Object.prototype.hasOwnProperty.call("+c+", "+p+"["+M+"]) "),r+="; if (!"+h+") break; } ",d&&(r+="  }  "),r+="  if (!"+h+") {   ";var C=C||[];C.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+T+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+T+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ";var E=r;r=C.pop(),!e.compositeRule&&l?e.async?r+=" throw new ValidationError(["+E+"]); ":r+=" validate.errors = ["+E+"]; return false; ":r+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { "}else{r+=" if ( ";var L=f;if(L)for(var P,M=-1,A=L.length-1;M<A;){P=L[M+=1],M&&(r+=" || ");var D=e.util.getProperty(P),O=c+D;r+=" ( ( "+O+" === undefined ",S&&(r+=" || ! Object.prototype.hasOwnProperty.call("+c+", '"+e.util.escapeQuotes(P)+"') "),r+=") && (missing"+a+" = "+e.util.toQuotedString(e.opts.jsonPointers?P:D)+") ) "}r+=") {  ";var w="missing"+a,T="' + "+w+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(y,w,!0):y+" + "+w);var C=C||[];C.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+T+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+T+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ";var E=r;r=C.pop(),!e.compositeRule&&l?e.async?r+=" throw new ValidationError(["+E+"]); ":r+=" validate.errors = ["+E+"]; return false; ":r+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { "}else if(x){d||(r+=" var "+p+" = validate.schema"+s+"; ");var M="i"+a,w="schema"+a+"["+M+"]",T="' + "+w+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(y,w,e.opts.jsonPointers)),d&&(r+=" if ("+p+" && !Array.isArray("+p+")) {  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+T+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+T+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+p+" !== undefined) { "),r+=" for (var "+M+" = 0; "+M+" < "+p+".length; "+M+"++) { if ("+c+"["+p+"["+M+"]] === undefined ",S&&(r+=" || ! Object.prototype.hasOwnProperty.call("+c+", "+p+"["+M+"]) "),r+=") {  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+T+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+T+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",d&&(r+="  }  ")}else{var k=f;if(k)for(var P,R=-1,I=k.length-1;R<I;){P=k[R+=1];var D=e.util.getProperty(P),T=e.util.escapeQuotes(P),O=c+D;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(y,P,e.opts.jsonPointers)),r+=" if ( "+O+" === undefined ",S&&(r+=" || ! Object.prototype.hasOwnProperty.call("+c+", '"+e.util.escapeQuotes(P)+"') "),r+=") {  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+T+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+T+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=y}else l&&(r+=" if (true) {");return r}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r,a=" ",n=e.level,o=e.dataLevel,s=e.schema[t],u=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,h="data"+(o||""),d="valid"+n,p=e.opts.$data&&s&&s.$data;if(p?(a+=" var schema"+n+" = "+e.util.getData(s.$data,o,e.dataPathArr)+"; ",r="schema"+n):r=s,(s||p)&&!1!==e.opts.uniqueItems){p&&(a+=" var "+d+"; if ("+r+" === false || "+r+" === undefined) "+d+" = true; else if (typeof "+r+" != 'boolean') "+d+" = false; else { "),a+=" var i = "+h+".length , "+d+" = true , j; if (i > 1) { ";var f=e.schema.items&&e.schema.items.type,m=Array.isArray(f);if(!f||"object"==f||"array"==f||m&&(f.indexOf("object")>=0||f.indexOf("array")>=0))a+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+h+"[i], "+h+"[j])) { "+d+" = false; break outer; } } } ";else{a+=" var itemIndices = {}, item; for (;i--;) { var item = "+h+"[i]; ";var g="checkDataType"+(m?"s":"");a+=" if ("+e.util[g](f,"item",!0)+") continue; ",m&&(a+=" if (typeof item == 'string') item = '\"' + item; "),a+=" if (typeof itemIndices[item] == 'number') { "+d+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}a+=" } ",p&&(a+="  }  "),a+=" if (!"+d+") {   ";var _=_||[];_.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { i: i, j: j } ",!1!==e.opts.messages&&(a+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(a+=" , schema:  ",a+=p?"validate.schema"+u:""+s,a+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),a+=" } "):a+=" {} ";var v=a;a=_.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+v+"]); ":a+=" validate.errors = ["+v+"]; return false; ":a+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } ",c&&(a+=" else { ")}else c&&(a+=" if (true) { ");return a}},function(e,t,i){"use strict";var r=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];e.exports=function(e,t){for(var i=0;i<t.length;i++){e=JSON.parse(JSON.stringify(e));var a,n=t[i].split("/"),o=e;for(a=1;a<n.length;a++)o=o[n[a]];for(a=0;a<r.length;a++){var s=r[a],u=o[s];u&&(o[s]={anyOf:[u,{$ref:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#"}]})}}return e}},function(e,t,i){"use strict";(function(t){function r(e,i,n){function o(e){var i=e.$schema;return i&&!u.getSchema(i)?r.call(u,{$ref:i},!0):t.resolve()}function s(e){try{return u._compile(e)}catch(t){if(t instanceof a)return function(t){function r(){delete u._loadingSchemas[n]}function a(e){return u._refs[e]||u._schemas[e]}var n=t.missingSchema;if(a(n))throw new Error("Schema "+n+" is loaded but "+t.missingRef+" cannot be resolved");var l=u._loadingSchemas[n];return l||(l=u._loadingSchemas[n]=u._opts.loadSchema(n),l.then(r,r)),l.then(function(e){if(!a(n))return o(e).then(function(){a(n)||u.addSchema(e,n,void 0,i)})}).then(function(){return s(e)})}(t);throw t}}var u=this;if("function"!=typeof this._opts.loadSchema)throw new Error("options.loadSchema should be a function");"function"==typeof i&&(n=i,i=void 0);var l=o(e).then(function(){var t=u._addSchema(e,void 0,i);return t.validate||s(t)});return n&&l.then(function(e){n(null,e)},n),l}var a=i(699).MissingRef;e.exports=r}).call(t,i(407))},function(e,t,i){"use strict";function r(e,t){function i(e,t,i){for(var r,n=0;n<a.length;n++){var o=a[n];if(o.type==t){r=o;break}}r||(r={type:t,rules:[]},a.push(r));var u={keyword:e,definition:i,custom:!0,code:s,implements:i.implements};r.rules.push(u),a.custom[e]=u}function r(e){if(!a.types[e])throw new Error("Unknown type "+e)}var a=this.RULES;if(a.keywords[e])throw new Error("Keyword "+e+" is already defined");if(!o.test(e))throw new Error("Keyword "+e+" is not a valid identifier");if(t){if(t.macro&&void 0!==t.valid)throw new Error('"valid" option cannot be used with macro keywords');var n=t.type;if(Array.isArray(n)){var u,l=n.length;for(u=0;u<l;u++)r(n[u]);for(u=0;u<l;u++)i(e,n[u],t)}else n&&r(n),i(e,n,t);var c=!0===t.$data&&this._opts.$data;if(c&&!t.validate)throw new Error('$data support: "validate" function is not defined');var h=t.metaSchema;h&&(c&&(h={anyOf:[h,{$ref:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#"}]}),t.validateSchema=this.compile(h,!0))}return a.keywords[e]=a.all[e]=!0,this}function a(e){var t=this.RULES.custom[e];return t?t.definition:this.RULES.keywords[e]||!1}function n(e){var t=this.RULES;delete t.keywords[e],delete t.all[e],delete t.custom[e];for(var i=0;i<t.length;i++)for(var r=t[i].rules,a=0;a<r.length;a++)if(r[a].keyword==e){r.splice(a,1);break}return this}var o=/^[a-z_$][a-z0-9_$-]*$/i,s=i(1129);e.exports={add:r,get:a,remove:n}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r,a,n=" ",o=e.level,s=e.dataLevel,u=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,h=!e.opts.allErrors,d="data"+(s||""),p="valid"+o,f="errs__"+o,m=e.opts.$data&&u&&u.$data;m?(n+=" var schema"+o+" = "+e.util.getData(u.$data,s,e.dataPathArr)+"; ",a="schema"+o):a=u;var g,_,v,b,y,x=this,S="definition"+o,M=x.definition,w="";if(m&&M.$data){y="keywordValidate"+o;var T=M.validateSchema;n+=" var "+S+" = RULES.custom['"+t+"'].definition; var "+y+" = "+S+".validate;"}else{if(!(b=e.useCustomRule(x,u,e.schema,e)))return;a="validate.schema"+l,y=b.code,g=M.compile,_=M.inline,v=M.macro}var C=y+".errors",E="i"+o,L="ruleErr"+o,P=M.async;if(P&&!e.async)throw new Error("async keyword in sync schema");if(_||v||(n+=C+" = null;"),n+="var "+f+" = errors;var "+p+";",m&&M.$data&&(w+="}",n+=" if ("+a+" === undefined) { "+p+" = true; } else { ",T&&(w+="}",n+=" "+p+" = "+S+".validateSchema("+a+"); if ("+p+") { ")),_)M.statements?n+=" "+b.validate+" ":n+=" "+p+" = "+b.validate+"; ";else if(v){var A=e.util.copy(e),w="";A.level++;var D="valid"+A.level;A.schema=b.validate,A.schemaPath="";var O=e.compositeRule;e.compositeRule=A.compositeRule=!0;var k=e.validate(A).replace(/validate\.schema/g,y);e.compositeRule=A.compositeRule=O,n+=" "+k}else{var R=R||[];R.push(n),n="",n+="  "+y+".call( ",e.opts.passContext?n+="this":n+="self",g||!1===M.schema?n+=" , "+d+" ":n+=" , "+a+" , "+d+" , validate.schema"+e.schemaPath+" ",n+=" , (dataPath || '')",'""'!=e.errorPath&&(n+=" + "+e.errorPath);var I=s?"data"+(s-1||""):"parentData",F=s?e.dataPathArr[s]:"parentDataProperty";n+=" , "+I+" , "+F+" , rootData )  ";var N=n;n=R.pop(),!1===M.errors?(n+=" "+p+" = ",P&&(n+="await "),n+=N+"; "):P?(C="customErrors"+o,n+=" var "+C+" = null; try { "+p+" = await "+N+"; } catch (e) { "+p+" = false; if (e instanceof ValidationError) "+C+" = e.errors; else throw e; } "):n+=" "+C+" = null; "+p+" = "+N+"; "}if(M.modifying&&(n+=" if ("+I+") "+d+" = "+I+"["+F+"];"),n+=""+w,M.valid)h&&(n+=" if (true) { ");else{n+=" if ( ",void 0===M.valid?(n+=" !",n+=v?""+D:""+p):n+=" "+!M.valid+" ",n+=") { ",r=x.keyword;var R=R||[];R.push(n),n="";var R=R||[];R.push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(r||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { keyword: '"+x.keyword+"' } ",!1!==e.opts.messages&&(n+=" , message: 'should pass \""+x.keyword+"\" keyword validation' "),e.opts.verbose&&(n+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var V=n;n=R.pop(),!e.compositeRule&&h?e.async?n+=" throw new ValidationError(["+V+"]); ":n+=" validate.errors = ["+V+"]; return false; ":n+=" var err = "+V+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var B=n;n=R.pop(),_?M.errors?"full"!=M.errors&&(n+="  for (var "+E+"="+f+"; "+E+"<errors; "+E+"++) { var "+L+" = vErrors["+E+"]; if ("+L+".dataPath === undefined) "+L+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+L+".schemaPath === undefined) { "+L+'.schemaPath = "'+c+'"; } ',e.opts.verbose&&(n+=" "+L+".schema = "+a+"; "+L+".data = "+d+"; "),n+=" } "):!1===M.errors?n+=" "+B+" ":(n+=" if ("+f+" == errors) { "+B+" } else {  for (var "+E+"="+f+"; "+E+"<errors; "+E+"++) { var "+L+" = vErrors["+E+"]; if ("+L+".dataPath === undefined) "+L+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+L+".schemaPath === undefined) { "+L+'.schemaPath = "'+c+'"; } ',e.opts.verbose&&(n+=" "+L+".schema = "+a+"; "+L+".data = "+d+"; "),n+=" } } "):v?(n+="   var err =   ",!1!==e.createErrors?(n+=" { keyword: '"+(r||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { keyword: '"+x.keyword+"' } ",!1!==e.opts.messages&&(n+=" , message: 'should pass \""+x.keyword+"\" keyword validation' "),e.opts.verbose&&(n+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&h&&(e.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; ")):!1===M.errors?n+=" "+B+" ":(n+=" if (Array.isArray("+C+")) { if (vErrors === null) vErrors = "+C+"; else vErrors = vErrors.concat("+C+"); errors = vErrors.length;  for (var "+E+"="+f+"; "+E+"<errors; "+E+"++) { var "+L+" = vErrors["+E+"]; if ("+L+".dataPath === undefined) "+L+".dataPath = (dataPath || '') + "+e.errorPath+";  "+L+'.schemaPath = "'+c+'";  ',e.opts.verbose&&(n+=" "+L+".schema = "+a+"; "+L+".data = "+d+"; "),n+=" } } else { "+B+" } "),n+=" } ",h&&(n+=" else { ")}return n}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON Schema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(5)),n=i(604),o=i(1133),s=i(1134),u=i(1137),l=a.a.osg,c=function(e,t,i){i?l.error("ResourceLoader: "+e+" failed "+t+" error "+i):l.error("ResourceLoader: "+e+" failed "+t)},h=function(){this._nbThreads=5,this._processing=[],this._queue=[],this._finished=[],this._running=!1};h.prototype={checkResource:function(e){var t;return[this._processing,this._queue,this._finished].forEach(function(i){t||(t=Object(r.find)(i,function(t){return t._url===e}))}),t},run:function(){this._running=!0,this.runPendingProcess()},runPendingProcess:function(){for(;this._processing.length<this._nbThreads&&this._queue.length>0;){var e=this._queue.shift();this._processing.push(e),e.start()}},queue:function(e){e.start||(console.log(e.url),e=new n.a(e.url,e.response)),this._queue.push(e);var t=e.getPromise();return t.finally(function(){t.isFulfilled()&&this._finished.push(e),this._processing.splice(this._processing.indexOf(e),1),this.runPendingProcess()}.bind(this)),this._running&&this.runPendingProcess(),e},getModel:function(e,t){var i=this.checkResource(e);return i||(i=this.queue(new o.a(e,"text",t)),i.getPromise().catch(function(t){c(e,"model",t)}),i)},getImage:function(e,t){var i=this.checkResource(e);if(i)return i;var r=t||{};return"data:image"===e.substr(0,"data:image".length)||(r.crossOrigin="anonymous"),i=this.queue(new s.a(e,r)),i.getPromise().catch(function(){c(e,"image")}),i},getBinaryArray:function(e,t){var i=this.checkResource(e);return i||(i=this.queue(new u.a(e,t)),i.getPromise().catch(function(t){c(e,"binary array",t)}),i)}},t.a=h},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(604)),n=function(){a.a.apply(this,arguments)};n.prototype=Object(r.extend)({},a.a.prototype,{load:function(){this._model=this._xhr.response,this._defer.resolve(this._model)},getModel:function(){return this._model}}),t.a=n},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(5)),n=i(605),o=i(604),s=i(16),u=i(1135),l=i.n(u),c=i(1136),h=i.n(c),d=a.a.osg,p={},f={},m=parseInt((/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[0,0])[1],10),g=Object(s.a)().asyncImage;g&&(g=window.Worker&&window.fetch&&window.createImageBitmap&&m>=52);var _=[];window.closeBitmaps=function(){_.forEach(function(e){e.close()})};var v=function(e){var t=0,i=Math.max(2,Math.min(4,navigator.hardwareConcurrency||2)),r=[],a=URL.createObjectURL(new Blob([e],{type:"text/javascript"}));return function(){var e=r[t];return e||(e=r[t]=new Worker(a),e.onmessage=function(e){var t=e.data,i=t.uid,r=f[i];t.bitmap?(r.setImage(t.bitmap),_.push(t.bitmap)):(r.setImage(t.img),r.setWidth(t.width),r.setHeight(t.height)),p[i]()}),t=(t+1)%i,e}},b=v(l.a),y=v(h.a),x=function(e,t){o.a.call(this,e,"blob",t),this._responseType="arraybuffer"};x.prototype=Object(r.extend)({},o.a.prototype,{isVideo:function(e){return n.a.isVideoURL(e)},createVideo:function(){var e=document.createElement("video");return document.body.appendChild(e),e.style.display="none",e},start:function(){var e=this.getURL();if(this.isVideo(e)){var t=this.createVideo();return this._osgjsImage=new d.ImageStream(t),window.video=this._osgjsImage,t.preload="auto",t.crossOrigin="anonymous",t.src=e,void this._osgjsImage.whenReady().then(function(e){e.play(),this._defer.resolve(this._osgjsImage)}.bind(this))}this._osgjsImage=new d.Image;var i=this._options;return i.panoramaLUV||i.integrateBRDFLUV||i.cubemapLUV?void o.a.prototype.start.call(this):this._url.endsWith(".astc.gz")?(i.astc=!0,void o.a.prototype.start.call(this)):this._url.endsWith(".svg")?(i.svg=!0,void this.loadImage()):i.decodeAsync&&g?void this.loadImageAsync():void this.loadImage()},load:function(){var e=this._options;e.panoramaLUV||e.integrateBRDFLUV?this.loadLUV():e.cubemapLUV?this.loadCubemapLUV():e.astc&&this.loadAstc()},loadImageAsync:function(){p[this._url]=this._defer.resolve.bind(this._defer,this._osgjsImage),f[this._url]=this._osgjsImage,y().postMessage({uid:this._url,url:this._url})},loadAstc:function(){var e=this._xhr.response;p[this._url]=this._defer.resolve.bind(this._defer,this._osgjsImage),f[this._url]=this._osgjsImage,b().postMessage({uid:this._url,buffer:e,swizzle:!0,nbComponents:3},[e])},loadImage:function(){this._htmlImage=new Image,this._options.crossOrigin&&(this._htmlImage.crossOrigin=this._options.crossOrigin),this._htmlImage.onload=function(){if(this._options.svg){var e=document.createElement("canvas"),t=Object(s.a)().svgSize;e.width=t,e.height=t;e.getContext("2d").drawImage(this._htmlImage,0,0,t,t),this._osgjsImage.setImage(e)}this._defer.resolve(this._osgjsImage)}.bind(this),this._htmlImage.onerror=function(){this._htmlImage._aborted?this._defer.cancel(this._osgjsImage):this._defer.reject(this._osgjsImage)}.bind(this),this._htmlImage.src=this._url,this._osgjsImage.setImage(this._htmlImage)},abort:function(){this._htmlImage?(this._htmlImage.src="",this._htmlImage._aborted=!0):o.a.prototype.abort.call(this)},loadLUV:function(){var e,t=this._xhr.response,i=Math.sqrt(t.byteLength/4);e=this._options.integrateBRDFLUV?new Uint8Array(t):this.deinterleaveImage4(i,new Uint8Array(t),new Uint8Array(t.byteLength));var r=this._osgjsImage;r.setImage(e),r.setWidth(i),r.setHeight(i),this._defer.resolve(this._osgjsImage)},loadCubemapLUV:function(){for(var e=this._xhr.response,t=Math.log(this._options.size)/Math.LN2,i=0,r={},a=0;a<=t&&!(i>=e.byteLength);a++)for(var n=Math.pow(2,t-a),o=0;o<6;o++){r[d.Texture.TEXTURE_CUBE_MAP_POSITIVE_X+o]||(r[d.Texture.TEXTURE_CUBE_MAP_POSITIVE_X+o]=[]);var s=n*n*4,u=new Uint8Array(s);this.deinterleaveImage4(n,new Uint8Array(e,i,s),u);var l=new d.Image;l.setImage(u),l.setWidth(n),l.setHeight(n),r[d.Texture.TEXTURE_CUBE_MAP_POSITIVE_X+o].push(l),i+=s}this._defer.resolve(r)},deinterleaveImage4:function(e,t,i){for(var r=e*e,a=2*e*e,n=3*e*e,o=0,s=0;s<r;s++)i[o++]=t[s],i[o++]=t[s+r],i[o++]=t[s+a],i[o++]=t[s+n];return i},getImage:function(){return this._osgjsImage}}),t.a=x},function(e,t){e.exports="(function webpackUniversalModuleDefinition(root, factory) {\n  if(typeof exports === 'object' && typeof module === 'object')\n    module.exports = factory();\n  else if(typeof define === 'function' && define.amd)\n    define([], factory);\n  else {\n    var a = factory();\n    for(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n  }\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/  // The module cache\n/******/  var installedModules = {};\n\n/******/  // The require function\n/******/  function __webpack_require__(moduleId) {\n\n/******/    // Check if module is in cache\n/******/    if(installedModules[moduleId])\n/******/      return installedModules[moduleId].exports;\n\n/******/    // Create a new module (and put it into the cache)\n/******/    var module = installedModules[moduleId] = {\n/******/      exports: {},\n/******/      id: moduleId,\n/******/      loaded: false\n/******/    };\n\n/******/    // Execute the module function\n/******/    modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n/******/    // Flag the module as loaded\n/******/    module.loaded = true;\n\n/******/    // Return the exports of the module\n/******/    return module.exports;\n/******/  }\n\n\n/******/  // expose the modules object (__webpack_modules__)\n/******/  __webpack_require__.m = modules;\n\n/******/  // expose the module cache\n/******/  __webpack_require__.c = installedModules;\n\n/******/  // __webpack_public_path__\n/******/  __webpack_require__.p = \"\";\n\n/******/  // Load entry module and return exports\n/******/  return __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n  'use strict';\n\n  var decompressor = __webpack_require__( 1 );\n\n  /*jshint worker: true */\n\n  self.onmessage = function ( event ) {\n      var input = event.data;\n      var result = decompressor.decompress( input.buffer );\n\n      var img = new Uint8Array( result.img.buffer );\n      var width = result.width;\n      var height = result.height;\n\n      if ( input.swizzle ) {\n          var nbComponents = input.nbComponents || 3;\n          var nbPixel = width * height * 4;\n          for ( var i = 0, j = 0; i < nbPixel; i += 4, j += nbComponents ) {\n              var r = img[ i ];\n              var a = img[ i + 3 ];\n\n              var x = ( r / 255.0 ) * 2.0 - 1.0;\n              var y = ( a / 255.0 ) * 2.0 - 1.0;\n              var z = Math.sqrt( 1.0 - x * x - y * y );\n              z = Math.round( ( z * 0.5 + 0.5 ) * 255.0 );\n\n              img[ j ] = r;\n              img[ j + 1 ] = a;\n              img[ j + 2 ] = z;\n          }\n\n          img = img.subarray( 0, width * height * nbComponents );\n      }\n\n      postMessage( {\n          img: img,\n          width: width,\n          height: height,\n          uid: input.uid || 'uid'\n      }, [ img.buffer ] );\n  };\n\n  /*jshint worker: false */\n\n  module.exports = {\n      astcDecompressor: decompressor\n  };\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n  'use strict';\n\n  var precompute = __webpack_require__(2);\n  var cacheUnquantizeSimple = precompute.cacheUnquantizeSimple;\n  var cacheUnquantizeTrits = precompute.cacheUnquantizeTrits;\n  var cacheUnquantizeQuints = precompute.cacheUnquantizeQuints;\n  var cacheDecodeSimple = precompute.cacheDecodeSimple;\n  var cacheDecodeTrits = precompute.cacheDecodeTrits;\n  var cacheDecodeQuints = precompute.cacheDecodeQuints;\n\n  var bitUtils = __webpack_require__(3);\n  var popCount = bitUtils.popCount;\n  var readBits = bitUtils.readBits;\n  var writeBits = bitUtils.writeBits;\n  var extractBits = bitUtils.extractBits;\n  var replicateBits = bitUtils.replicateBits;\n  var bitTransferSigned = bitUtils.bitTransferSigned;\n  var reverseU8Array = bitUtils.reverseU8Array;\n\n\n  // Counting how many bits have been read for each block\n  // the value is reseted when computing a new block\n  var bitsReadCount = 0;\n  // Counting how many bits have been written\n  // useful when extracting color endpoint data\n  var bitsWrittenCount = 0;\n  // Counting how many bits have been read in the\n  // current block color data stream\n  var colorDataBitsRead = 0;\n  // Keeping track of the current index\n  // when calling the computeEndpoints routine\n  var decodedColorValuesIdx = 0;\n\n  // Contains the information\n  // of the current processed block\n  var CURRENT_BLOCK_INFO = {};\n  // Describes how trit/quint/bit is packed\n  // for a single encoded integer in the maxWeightQuintsTritsMapper\n  var TRIT_IDX = 0;\n  var QUINT_IDX = 1;\n  var BIT_IDX = 2;\n\n  // Maximum number of encoded values = 288\n  var resultDecodedStorage = new Uint16Array(288 * 6);\n  var subDecodedValue = new Array(8);\n  var classSelectorBitsArray = new Uint8Array(4);\n  var colorModeLSB = new Uint8Array(4);\n  var texelWeightData = new Uint8Array(16);\n  var colorEndpointData = new Uint8Array(16);\n  var endpoints = new Uint8Array(4 * 2 * 4);\n  var blockPixelsOutput = null;\n\n  /**\n   * Encodes a given value into its quints/trits/bits representation\n   * @param  {uint} val the value to encode\n   * @return {Object} contains the number of trits/quints/bits to encode the given value.\n   */\n  var getEncodedInteger = function(val) {\n    var encodedInt = {\n      trits: 0,\n      quints: 0,\n      bits: 0,\n      tritValue: 0,\n      quintValue: 0,\n      bitValue: 0\n    };\n    while (val > 0) {\n      var check = val + 1;\n\n      if (!(check & (check - 1))) {\n        encodedInt.bits = popCount(val);\n        return encodedInt;\n      }\n      if ((check % 3 === 0) && !(Math.floor(check / 3) & Math.floor((check / 3) - 1))) {\n        encodedInt.bits = popCount(Math.floor(check / 3 - 1));\n        encodedInt.trits = 1;\n        return encodedInt;\n      }\n      if ((check % 5 === 0) && !(Math.floor(check / 5) & Math.floor((check / 5) - 1))) {\n        encodedInt.bits = popCount(Math.floor(check / 5 - 1));\n        encodedInt.quints = 1;\n        return encodedInt;\n      }\n\n      val--;\n    }\n    return encodedInt;\n  };\n\n  var replicateBits0816Map = new Uint16Array(256);\n  for (var i = 0; i < 256; ++i)\n    replicateBits0816Map[i] = replicateBits(i, 8, 16);\n\n  var maxWeightQuintsTritsMapper = new Uint16Array(256 * 3);\n  var idx = 0;\n  for (var i = 0; i < 256; i++) {\n    var encodedInt = getEncodedInteger(i);\n    maxWeightQuintsTritsMapper[idx + TRIT_IDX] = encodedInt.trits;\n    maxWeightQuintsTritsMapper[idx + QUINT_IDX] = encodedInt.quints;\n    maxWeightQuintsTritsMapper[idx + BIT_IDX] = encodedInt.bits;\n\n    idx += 3;\n  }\n\n  /**\n   * Gives additional precision to RGB colors near gray\n   * pixel is changed in-place in the endpoints array\n   * Refers to ASTC specifications (Section 3.8)\n   * @param  {int} a the alpha channel component\n   * @param  {int} r the red channel component\n   * @param  {int} g the green channel component\n   * @param  {int} b the blue channel component\n   */\n  var blueContract = function(a, r, g, b) {\n    var idx = endpoints.currIdx;\n    endpoints[idx] = a;\n    endpoints[idx + 1] = (r + b) >> 1;\n    endpoints[idx + 2] = (g + b) >> 1;\n    endpoints[idx + 3] = b;\n  };\n\n  /**\n   * Expands a given seed\n   * Refers to ASTC specifications (Section 3.15)\n   * @param  {uint32} p the seed to expand\n   * @return {uint32} the processed expanded seed\n   */\n  var hash52 = function(p) {\n    p ^= (p >>> 15) >>> 0;\n    p -= (p << 17) >>> 0;\n    p += (p << 7) >>> 0;\n    p += (p << 4) >>> 0;\n    p ^= (p >>> 5) >>> 0;\n    p += (p << 16) >>> 0;\n    p ^= (p >>> 7) >>> 0;\n    p ^= (p >>> 3) >>> 0;\n    p ^= (p << 6) >>> 0;\n    p ^= (p >>> 17) >>> 0;\n\n    return p;\n  };\n\n  /**\n   * Computes the partition index for a given texel\n   * @param  {uint32} seed partition pattern index\n   * @param  {int} x texel x position withing the block\n   * @param  {int} y texel y position withing the block\n   * @param  {int} z texel z position withing the block\n   * @param  {uint} partitionCount maximum number of existing partitions\n   * @param  {bool} smallBlock set to true, number of texel in the block is less than 31\n   * @return {uint} the partition index of the given texel\n   */\n\n  var seedsPartitionTable = new Uint8Array(12);\n\n  var precomputeSelectPartition = function(seed, partitionCount) {\n\n    // Refers to ASTC specifications (Section 3.15)\n    seed += (partitionCount - 1) * 1024;\n    var seedUint32 = seed >>> 0;\n\n    var rnum = hash52(seedUint32);\n\n    // The seeds values should be saved in an uint8 variable\n    seedsPartitionTable[0] = rnum & 0xF;\n    seedsPartitionTable[1] = (rnum >> 4) & 0xF;\n    seedsPartitionTable[2] = (rnum >> 8) & 0xF;\n    seedsPartitionTable[3] = (rnum >> 12) & 0xF;\n    seedsPartitionTable[4] = (rnum >> 16) & 0xF;\n    seedsPartitionTable[5] = (rnum >> 20) & 0xF;\n    seedsPartitionTable[6] = (rnum >> 24) & 0xF;\n    seedsPartitionTable[7] = (rnum >> 28) & 0xF;\n    seedsPartitionTable[8] = (rnum >> 18) & 0xF;\n    seedsPartitionTable[9] = (rnum >> 22) & 0xF;\n    seedsPartitionTable[10] = (rnum >> 26) & 0xF;\n    seedsPartitionTable[11] = ((rnum >> 30) | (rnum << 2)) & 0xF;\n\n    seedsPartitionTable[0] *= seedsPartitionTable[0];\n    seedsPartitionTable[1] *= seedsPartitionTable[1];\n    seedsPartitionTable[2] *= seedsPartitionTable[2];\n    seedsPartitionTable[3] *= seedsPartitionTable[3];\n    seedsPartitionTable[4] *= seedsPartitionTable[4];\n    seedsPartitionTable[5] *= seedsPartitionTable[5];\n    seedsPartitionTable[6] *= seedsPartitionTable[6];\n    seedsPartitionTable[7] *= seedsPartitionTable[7];\n    seedsPartitionTable[8] *= seedsPartitionTable[8];\n    seedsPartitionTable[9] *= seedsPartitionTable[9];\n    seedsPartitionTable[10] *= seedsPartitionTable[10];\n    seedsPartitionTable[11] *= seedsPartitionTable[11];\n\n    var sh1 = 0;\n    var sh2 = 0;\n    var sh3 = 0;\n    if (seed & 1) {\n      sh1 = (seed & 2) ? 4 : 5;\n      sh2 = (partitionCount === 3) ? 6 : 5;\n    } else {\n      sh1 = (partitionCount === 3) ? 6 : 5;\n      sh2 = (seed & 2) ? 4 : 5;\n    }\n    sh3 = (seed & 0x10) ? sh1 : sh2;\n\n    seedsPartitionTable[0] >>= sh1;\n    seedsPartitionTable[1] >>= sh2;\n    seedsPartitionTable[2] >>= sh1;\n    seedsPartitionTable[3] >>= sh2;\n    seedsPartitionTable[4] >>= sh1;\n    seedsPartitionTable[5] >>= sh2;\n    seedsPartitionTable[6] >>= sh1;\n    seedsPartitionTable[7] >>= sh2;\n    seedsPartitionTable[8] >>= sh3;\n    seedsPartitionTable[9] >>= sh3;\n    seedsPartitionTable[10] >>= sh3;\n    seedsPartitionTable[11] >>= sh3;\n\n    return rnum;\n  };\n\n  var selectPartition = function(rnum, x, y, z, partitionCount, smallBlock) {\n    if (partitionCount === 1)\n      return 0;\n\n    if (smallBlock) {\n      x <<= 1;\n      y <<= 1;\n      z <<= 1;\n    }\n\n    var a = seedsPartitionTable[0] * x + seedsPartitionTable[1] * y + seedsPartitionTable[10] * z + (rnum >> 14);\n    var b = seedsPartitionTable[2] * x + seedsPartitionTable[3] * y + seedsPartitionTable[11] * z + (rnum >> 10);\n    var c = seedsPartitionTable[4] * x + seedsPartitionTable[5] * y + seedsPartitionTable[8] * z + (rnum >> 6);\n    var d = seedsPartitionTable[6] * x + seedsPartitionTable[7] * y + seedsPartitionTable[9] * z + (rnum >> 2);\n\n    a &= 0x3F;\n    b &= 0x3F;\n    c &= 0x3F;\n    d &= 0x3F;\n\n    if (partitionCount < 4)\n      d = 0;\n    if (partitionCount < 3)\n      c = 0;\n\n    if (a >= b && a >= c && a >= d)\n      return 0;\n    else if (b >= c && b >= d)\n      return 1;\n    else if (c >= d)\n      return 2;\n\n    return 3;\n  };\n\n  /**\n   * Simple swap util procedure swapping to cells in a given array\n   * @param  {array} array contains the cells to swap\n   * @param  {uint} i the first index\n   * @param  {uint} j the second index\n   */\n  var swapCell = function(array, i, j) {\n    var a = array[i];\n    array[i] = array[j];\n    array[j] = a;\n  };\n\n  /**\n   * Computes the total number of bits required to encoded\n   * the same encoded integer a given amount of times.\n   * @param  {uint} nbValues the number of encoded values\n   * @param  {[type]} encodedInteger the encoded value\n   * @return {uint} the number of bits to encoded nbValues of encodedInteger\n   */\n  var getBitsNbrFromEncodedInt = function(nbValues, trits, quints, bits) {\n    var totalBits = bits * nbValues;\n\n    if (trits)\n      totalBits += Math.floor((nbValues * 8 + 4) / 5);\n    else if (quints)\n      totalBits += Math.floor((nbValues * 7 + 2) / 3);\n\n    return totalBits;\n  };\n\n  /**\n   * Computes the number of weight values\n   * available in a given block\n   * @param  {Object} blockInfo the block info containing block size, max weight, etc...\n   * @return {uint} the number of weight values encoded inside the block\n   */\n  var getNumberWeightValues = function(blockInfo) {\n    var nbValues = blockInfo.width * blockInfo.height;\n    if (blockInfo.dualPlane)\n      nbValues *= 2;\n\n    // max nbValues = 12*12*2\n    return nbValues;\n  };\n\n\n  /**\n   * Computes the total number of bits needed to\n   * encode all the weights using Integer Sequence Encoding\n   * @param  {Object} blockInfo the block info containing block size, max weight, etc...\n   * @return {uint} the number of required bits to encoded the weights.\n   */\n  var getPackedBitSize = function(blockInfo) {\n    var nbValues = getNumberWeightValues(blockInfo);\n\n    var idx = blockInfo.maxWeight * 3;\n    var trits = maxWeightQuintsTritsMapper[idx + TRIT_IDX];\n    var quints = maxWeightQuintsTritsMapper[idx + QUINT_IDX];\n    var bits = maxWeightQuintsTritsMapper[idx + BIT_IDX];\n\n    return getBitsNbrFromEncodedInt(nbValues, trits, quints, bits);\n  };\n\n  /**\n   * Reads n values from a given array\n   * @param  {array} decodedColorValues the array to read\n   * @param  {uint} n the number of array cells to read\n   * @return {array} sub-array containing the read data\n   */\n  var readNDecodedColor = function(decodedColorValues, n) {\n    for (var i = 0; i < n; ++i)\n      subDecodedValue[i] = decodedColorValues[decodedColorValuesIdx++];\n    return subDecodedValue;\n  };\n\n  /**\n   * Clamps a pixel to the [0...255] range\n   * @param  {uint} beginIdx the index of the pixel alpha channel\n   * in the endpoints global array\n   */\n  var clampPixel = function(beginIdx) {\n    for (var i = 0; i < 4; ++i)\n      endpoints[beginIdx + i] = Math.max(0, Math.min(255, endpoints[beginIdx + i]));\n  };\n\n  /**\n   * Fills the endpoints global array with the given channel colors\n   * @param  {int} a the alpha channel component\n   * @param  {int} r the red channel component\n   * @param  {int} g the green channel component\n   * @param  {int} b the blue channel component\n   */\n  var fillEndpointsWithPixel = function(a, r, g, b) {\n    var idx = endpoints.currIdx;\n    endpoints[idx] = a;\n    endpoints[idx + 1] = r;\n    endpoints[idx + 2] = g;\n    endpoints[idx + 3] = b;\n  };\n\n  /**\n   * Parses the first 16 bytes a buffer\n   * considering it as an ASTC file buffer.\n   * @param  {ArrayBuffer} imgBuffer buffer containing the ASTC raw data\n   * @return {Object} contains data about the compressed image\n   */\n  var parseHeader = function(imgBuffer) {\n    var header = {};\n\n    var u8buffer = new Uint8Array(imgBuffer);\n    var u32Buffer = new Uint32Array(imgBuffer);\n\n    header.magic = u32Buffer[0];\n\n    var littleEndian = u8buffer[0] === (header.magic & 0xFF);\n\n    var isFormatCorrect = false;\n    if (littleEndian && header.magic === 0x5CA1AB13)\n      isFormatCorrect = true;\n    else if (!littleEndian && header.magic === 0x13ABA15C)\n      isFormatCorrect = true;\n\n    if (!isFormatCorrect)\n      console.error('The ASTC header does not meet the requirements.');\n\n    header.blockDimX = u8buffer[4];\n    header.blockDimY = u8buffer[5];\n    header.blockDimZ = u8buffer[6];\n\n    if (header.blockDimX > 12 || header.blockDimY > 12)\n      console.error('Incorrect ASTC file: block can not be larger than 12x12 pixels.');\n    if (header.blockDimZ > 1)\n      console.error('3D ASTC file are not supported.');\n\n    // Image width\n    header.xSize = u8buffer[7] + (u8buffer[8] << 8) + (u8buffer[9] << 16);\n    // Image height\n    header.ySize = u8buffer[10] + (u8buffer[11] << 8) + (u8buffer[12] << 16);\n    // Image depth\n    header.zSize = u8buffer[13] + (u8buffer[14] << 8) + (u8buffer[15] << 16);\n\n    if (header.zSize > 1)\n      console.error('3D ASTC file are not supported.');\n\n    return header;\n  };\n\n  /**\n   * Computes the layout of 2D block\n   * @param  {uint} blockModeBits extracted 11 first bit of the block\n   * @return {int} contains the layout of the block [0...9]\n   */\n  var findBlockLayout = function(blockModeBits) {\n    var layout = -1;\n\n    // Layout is in [0-4]\n    if ((blockModeBits & 0x1) || blockModeBits & 0x2) {\n      // layout is in [2-4]\n      if (blockModeBits & 0x8) {\n        // layout is in [3-4]\n        if (blockModeBits & 0x4)\n          layout = (blockModeBits & 0x100) ? 4 : 3;\n        else\n          layout = 2;\n      }\n      // layout is in [0-1]\n      else\n        layout = blockModeBits & 0x4 ? 1 : 0;\n\n      return layout;\n    }\n\n    // Layout is in [7-9]\n    if (blockModeBits & 0x100) {\n      // Layout [7-8]\n      if (blockModeBits & 0x80) {\n        if ((blockModeBits & 0x40))\n          console.error('Invalid block layout found.');\n        layout = (blockModeBits & 0x20) ? 8 : 7;\n      } else\n        layout = 9;\n\n      return layout;\n    }\n\n    layout = (blockModeBits & 0x80) ? 6 : 5;\n    return layout;\n  };\n\n  /**\n   * Extracts data regarding how block data are organized\n   * @param  {Uint8Array} u8buffer the ASTC raw data\n   * @param  {uint} blockId the first byte id of the current block\n   * @return {Object} contains block related data (void extent, maximum weight, etc;..)\n   */\n  var getBlockInfo = function(u8buffer, blockId) {\n    var blockInfo = CURRENT_BLOCK_INFO;\n    blockInfo.isVoidExtent = false;\n    blockInfo.error = false;\n\n    // Get the 'block mode' represented by the last 11 bits\n    var blockModeBits = readBits(u8buffer, blockId, bitsReadCount, 11);\n    bitsReadCount += 11;\n\n    // Checks the 9 least significant bits\n    // allowing to know if the block is a void-extent block (uniform color)\n    if ((blockModeBits & 0x01FF) === 0x1FC) {\n      blockInfo.isVoidExtent = true;\n      return blockInfo;\n    }\n\n    // Checks the first reserved pattern\n    // (xxxxx0000)\n    if ((blockModeBits & 0xF) === 0) {\n      blockInfo.error = true;\n      console.log('Warning: Block layout is reserved (xxxxx0000)');\n    }\n\n    // Checks the second reserved pattern\n    // (111xxxx00)\n    if ((blockModeBits & 0x3) === 0 &&\n      (blockModeBits & 0x1C0) === 0x1C0) {\n      blockInfo.error = true;\n      console.log('Warning: Block layout is reserved (111xxxx00)');\n    }\n\n    var layout = findBlockLayout(blockModeBits);\n    if (layout < 0)\n      console.error('Invalid block layout found.');\n\n    // Retrieves the R least significant bit according\n    // to the current block layout\n    var R = !!(blockModeBits & 0x10);\n    if (layout < 5)\n      R |= (blockModeBits & 0x3) << 1;\n    else\n      R |= (blockModeBits & 0xC) >> 1;\n\n    if (R < 2 || R > 7)\n      console.error('Invalid block mode. The file is not encoded in ASTC or corrupted.');\n\n    var a = 0;\n    var b = 0;\n    // Computes weights grid dimension\n    // Refers to ASTC specifications(Table 11)\n    switch (layout) {\n      case 0:\n        a = (blockModeBits >> 5) & 0x3;\n        b = (blockModeBits >> 7) & 0x3;\n        blockInfo.width = b + 4;\n        blockInfo.height = a + 2;\n        break;\n      case 1:\n        a = (blockModeBits >> 5) & 0x3;\n        b = (blockModeBits >> 7) & 0x3;\n        blockInfo.width = b + 8;\n        blockInfo.height = a + 2;\n        break;\n      case 2:\n        a = (blockModeBits >> 5) & 0x3;\n        b = (blockModeBits >> 7) & 0x3;\n        blockInfo.width = a + 2;\n        blockInfo.height = b + 8;\n        break;\n      case 3:\n        a = (blockModeBits >> 5) & 0x3;\n        b = (blockModeBits >> 7) & 0x1;\n        blockInfo.width = a + 2;\n        blockInfo.height = b + 6;\n        break;\n      case 4:\n        a = (blockModeBits >> 5) & 0x3;\n        b = (blockModeBits >> 7) & 0x1;\n        blockInfo.width = b + 2;\n        blockInfo.height = a + 2;\n        break;\n      case 5:\n        a = (blockModeBits >> 5) & 0x3;\n        blockInfo.width = 12;\n        blockInfo.height = a + 2;\n        break;\n      case 6:\n        a = (blockModeBits >> 5) & 0x3;\n        blockInfo.width = a + 2;\n        blockInfo.height = 12;\n        break;\n      case 7:\n        blockInfo.width = 6;\n        blockInfo.height = 10;\n        break;\n      case 8:\n        blockInfo.width = 10;\n        blockInfo.height = 6;\n        break;\n      case 9:\n        a = (blockModeBits >> 5) & 0x3;\n        b = (blockModeBits >> 9) & 0x3;\n        blockInfo.width = a + 6;\n        blockInfo.height = b + 6;\n        break;\n      default:\n        console.error('The block layout is not recognized. Layout should be [0-9].');\n    }\n\n    // The dual plane mode bit is the most significant bit\n    blockInfo.dualPlane = (layout !== 9) && (blockModeBits & 0x400);\n    // The high precision mode bit is the second most significant bit\n    blockInfo.highPrecisionRange = (layout !== 9) && (blockModeBits & 0x200);\n\n    // Selects the appropriate weight range\n    if (blockInfo.highPrecisionRange) {\n      var highWeightRanges = [9, 11, 15, 19, 23, 31];\n      blockInfo.maxWeight = highWeightRanges[R - 2];\n    } else {\n      var weightRanges = [1, 2, 3, 4, 5, 7];\n      blockInfo.maxWeight = weightRanges[R - 2];\n    }\n\n    return blockInfo;\n  };\n\n  /**\n   * Decodes a trit in colorData raw data\n   * @param  {Uint8Array} colorData encoded raw data\n   * @param  {uint} nbBitsPerValue number of bits\n   * on which the integer is encoded\n   * @param  {array} resultStorage contains decoded integer,\n   * the decoded trit will be pushed back at the end of this procedure\n   */\n\n  var lsbDecodingValues = new Uint8Array(5);\n  var msbDecodingValues = new Uint8Array(5);\n\n  var decodeTrit = function(colorData, nbBitsPerValue) {\n    var m = lsbDecodingValues;\n    var t = msbDecodingValues;\n    var T = 0;\n\n    // Refers to ASTC specifications (Table 17)\n    m[0] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    T = readBits(colorData, 0, colorDataBitsRead, 2);\n    colorDataBitsRead += 2;\n\n    m[1] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    T |= readBits(colorData, 0, colorDataBitsRead, 2) << 2;\n    colorDataBitsRead += 2;\n\n    m[2] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    T |= readBits(colorData, 0, colorDataBitsRead, 1) << 4;\n    colorDataBitsRead += 1;\n\n    m[3] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    T |= readBits(colorData, 0, colorDataBitsRead, 2) << 5;\n    colorDataBitsRead += 2;\n\n    m[4] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    T |= readBits(colorData, 0, colorDataBitsRead, 1) << 7;\n    colorDataBitsRead += 1;\n\n    var C = 0 >>> 0;\n    if (extractBits(T, 2, 4) === 7) {\n      C = (extractBits(T, 5, 7) << 2) | extractBits(T, 0, 1);\n      t[3] = 2;\n      t[4] = 2;\n    } else {\n      C = extractBits(T, 0, 4);\n      if (extractBits(T, 5, 6) === 3) {\n        t[4] = 2;\n        t[3] = extractBits(T, 7, 7);\n      } else {\n        t[4] = extractBits(T, 7, 7);\n        t[3] = extractBits(T, 5, 6);\n      }\n    }\n\n    if (extractBits(C, 0, 1) === 3) {\n      t[2] = 2;\n      t[1] = extractBits(C, 4, 4);\n      t[0] = (extractBits(C, 3, 3) << 1) | (extractBits(C, 2, 2) & ~extractBits(C, 3, 3));\n    } else if (extractBits(C, 2, 3) === 3) {\n      t[2] = 2;\n      t[1] = 2;\n      t[0] = extractBits(C, 0, 1);\n    } else {\n      t[2] = extractBits(C, 4, 4);\n      t[1] = extractBits(C, 2, 3);\n      t[0] = (extractBits(C, 1, 1) << 1) | (extractBits(C, 0, 0) & ~extractBits(C, 1, 1));\n    }\n\n    for (var i = 0; i < 5; ++i) {\n      var idx = resultDecodedStorage.currIndex;\n      resultDecodedStorage[idx] = 1;\n      resultDecodedStorage[idx + 1] = 0;\n      resultDecodedStorage[idx + 2] = nbBitsPerValue;\n      resultDecodedStorage[idx + 3] = t[i];\n      resultDecodedStorage[idx + 4] = 0;\n      resultDecodedStorage[idx + 5] = m[i];\n\n      resultDecodedStorage.currIndex += 6;\n    }\n  };\n\n  /**\n   * Decodes a quint in colorData raw data\n   * @param  {Uint8Array} colorData encoded raw data\n   * @param  {uint} nbBitsPerValue number of bits\n   * on which the integer is encoded\n   * @param  {array} resultStorage contains decoded integer,\n   * the decoded quint will be pushed back at the end of this procedure\n   */\n  var decodeQuint = function(colorData, nbBitsPerValue) {\n    var m = lsbDecodingValues;\n    var q = msbDecodingValues;\n    var Q = 0;\n\n    // Refers to ASTC specifications (Table 18)\n    m[0] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    Q = readBits(colorData, 0, colorDataBitsRead, 3);\n    colorDataBitsRead += 3;\n\n    m[1] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    Q |= readBits(colorData, 0, colorDataBitsRead, 2) << 3;\n    colorDataBitsRead += 2;\n\n    m[2] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    Q |= readBits(colorData, 0, colorDataBitsRead, 2) << 5;\n    colorDataBitsRead += 2;\n\n    if (extractBits(Q, 1, 2) === 3 && extractBits(Q, 5, 6) === 0) {\n      q[0] = 4;\n      q[1] = 4;\n      q[2] = (extractBits(Q, 0, 0) << 2) | ((extractBits(Q, 4, 4) & ~extractBits(Q, 0, 0)) << 1) | (extractBits(Q, 3, 3) & ~extractBits(Q, 0, 0));\n    } else {\n      var C = 0 >>> 0;\n      if (extractBits(Q, 1, 2) === 3) {\n        q[2] = 4;\n        C = (extractBits(Q, 3, 4) << 3) | ((~extractBits(Q, 5, 6) & 3) << 1) | (extractBits(Q, 0, 0));\n      } else {\n        q[2] = extractBits(Q, 5, 6);\n        C = extractBits(Q, 0, 4);\n      }\n\n      if (extractBits(C, 0, 2) === 5) {\n        q[1] = 4;\n        q[0] = extractBits(C, 3, 4);\n      } else {\n        q[1] = extractBits(C, 3, 4);\n        q[0] = extractBits(C, 0, 2);\n      }\n    }\n\n    for (var i = 0; i < 3; ++i) {\n      var idx = resultDecodedStorage.currIndex;\n      resultDecodedStorage[idx] = 0;\n      resultDecodedStorage[idx + 1] = 1;\n      resultDecodedStorage[idx + 2] = nbBitsPerValue;\n      resultDecodedStorage[idx + 3] = 0;\n      resultDecodedStorage[idx + 4] = q[i];\n      resultDecodedStorage[idx + 5] = m[i];\n\n      resultDecodedStorage.currIndex += 6;\n    }\n  };\n\n  /**\n   * Decodes nbValues of colorData raw data\n   * according to its max range value\n   * @param  {Uint8Array} colorData encoded raw data\n   * @param  {uint} range max value of the Integere Sequence\n   * @param  {uint} nbValues contains the number of values to decode\n   * @return {array} contains decoded integer\n   */\n  var decodeIntegerSequence = function(colorData, range, nbValues) {\n    var baseIdx = range * 3;\n    var trits = maxWeightQuintsTritsMapper[baseIdx + TRIT_IDX];\n    var quints = maxWeightQuintsTritsMapper[baseIdx + QUINT_IDX];\n    var bits = maxWeightQuintsTritsMapper[baseIdx + BIT_IDX];\n\n    resultDecodedStorage.currIndex = 0;\n\n    var nbDecodedValues = 0;\n    while (nbDecodedValues < nbValues) {\n\n      if (quints === 0 && trits === 0) {\n        var idx = resultDecodedStorage.currIndex;\n        resultDecodedStorage[idx] = trits;\n        resultDecodedStorage[idx + 1] = quints;\n        resultDecodedStorage[idx + 2] = bits;\n        resultDecodedStorage[idx + 3] = 0;\n        resultDecodedStorage[idx + 4] = 0;\n        resultDecodedStorage[idx + 5] = readBits(colorData, 0, colorDataBitsRead, bits);\n        colorDataBitsRead += bits;\n\n        resultDecodedStorage.currIndex += 6;\n\n        nbDecodedValues++;\n      } else if (quints === 1 && trits === 0) {\n        decodeQuint(colorData, bits);\n        nbDecodedValues += 3;\n      } else {\n        decodeTrit(colorData, bits);\n        nbDecodedValues += 5;\n      }\n    }\n  };\n\n  /**\n   * Decodes color from the colorData encoded Integer Sequence\n   * @param  {Uint8Array} colorData encoded color raw data\n   * @param  {array} colorModes contains the color for each partition\n   * @param  {uint} nbPartitions Number of available partitions\n   * @param  {uint} colorDataBits remaining bits number on which color data are encoded\n   * @return {array} decoded endpoints value in the [0...255] range\n   */\n\n  var endpointValuesOutput = new Uint8Array(32);\n\n  var decodeColorValues = function(colorData, colorModes, nbPartitions, colorDataBits) {\n    var trits = 0;\n    var quints = 0;\n    var bits = 0;\n    var i = 0;\n    // Computes the number of endpoint by using the associated class\n    // max endpoint values = 32\n    var nbEndpointValues = 0;\n    for (i = 0; i < nbPartitions; ++i)\n      nbEndpointValues += ((colorModes[i] >> 2) + 1) << 1;\n\n    // Finds the max range for each color endpoints\n    var range = 256;\n    while (--range > 0) {\n\n      var idx = range * 3;\n      trits = maxWeightQuintsTritsMapper[idx + TRIT_IDX];\n      quints = maxWeightQuintsTritsMapper[idx + QUINT_IDX];\n      bits = maxWeightQuintsTritsMapper[idx + BIT_IDX];\n\n      var bitsNbr = getBitsNbrFromEncodedInt(nbEndpointValues, trits, quints, bits);\n      if (bitsNbr <= colorDataBits) {\n        // Some integers share the same encoding\n        // this piece of code finds the smallest one\n        while (--range > 0) {\n          var newIdx = range * 3;\n          var newTrits = maxWeightQuintsTritsMapper[newIdx + TRIT_IDX];\n          var newQuints = maxWeightQuintsTritsMapper[newIdx + QUINT_IDX];\n          var newBits = maxWeightQuintsTritsMapper[newIdx + BIT_IDX];\n\n          if (newTrits !== trits || newQuints !== quints || newBits !== bits)\n            break;\n        }\n\n        range++;\n        break;\n      }\n    }\n\n    // Decodes the integer sequence based on the range and\n    // the number of values\n    var endpointIdx = 0;\n    decodeIntegerSequence(colorData, range, nbEndpointValues);\n\n    for (i = 0; i < nbEndpointValues * 6; i += 6) {\n      var bitLength = resultDecodedStorage[i + BIT_IDX];\n      var bitValue = resultDecodedStorage[i + BIT_IDX + 3];\n\n      // Refers to ASTC specifications(Section 3.11)\n      var result;\n      if (resultDecodedStorage[i + TRIT_IDX]) result = cacheDecodeTrits[bitLength + resultDecodedStorage[i + TRIT_IDX + 3] * 7 + bitValue * 21];\n      else if (resultDecodedStorage[i + QUINT_IDX]) result = cacheDecodeQuints[bitLength + resultDecodedStorage[i + QUINT_IDX + 3] * 6 + bitValue * 30];\n      else result = cacheDecodeSimple[bitLength + bitValue * 9];\n\n      endpointValuesOutput[endpointIdx++] = result;\n    }\n\n    // Makes sure each decoded value is not ambiguous\n    for (i = 0; i < nbEndpointValues; ++i)\n      if (endpointValuesOutput[i] > 255)\n        console.error('Decoded endpoint value can not be above 255.');\n  };\n\n  /**\n   * Computes the two color endpoint values\n   * from the decoded Integer Sequence data\n   * @param  {[type]} endpointColorValues [description]\n   * @param  {[type]} colorMode           [description]\n   */\n  var computeColorEndpointsLDR = function(endpointColorValues, colorMode) {\n    var v = 0;\n    var currIdx = 0;\n\n    switch (colorMode) {\n      case 0:\n        v = readNDecodedColor(endpointColorValues, 2);\n        fillEndpointsWithPixel(0xFF, v[0], v[0], v[0]);\n        endpoints.currIdx += 4;\n        fillEndpointsWithPixel(0xFF, v[1], v[1], v[1]);\n        endpoints.currIdx += 4;\n        break;\n      case 1:\n        v = readNDecodedColor(endpointColorValues, 2);\n        var L0 = (v[0] >> 2) | (v[1] & 0xC0);\n        var L1 = Math.max(L0 + (v[1] & 0x3F), 0xFF);\n\n        fillEndpointsWithPixel(0xFF, L0, L0, L0);\n        endpoints.currIdx += 4;\n        fillEndpointsWithPixel(0xFF, L1, L1, L1);\n        endpoints.currIdx += 4;\n        break;\n      case 4:\n        v = readNDecodedColor(endpointColorValues, 4);\n\n        fillEndpointsWithPixel(v[2], v[0], v[0], v[0]);\n        endpoints.currIdx += 4;\n        fillEndpointsWithPixel(v[3], v[1], v[1], v[1]);\n        endpoints.currIdx += 4;\n        break;\n      case 5:\n        v = readNDecodedColor(endpointColorValues, 4);\n\n        bitTransferSigned(v, 1, 0);\n        bitTransferSigned(v, 3, 2);\n\n        currIdx = endpoints.currIdx;\n\n        fillEndpointsWithPixel(v[2], v[0], v[0], v[0]);\n        endpoints.currIdx += 4;\n\n        fillEndpointsWithPixel(v[2] + v[3], v[0] + v[1], v[0] + v[1], v[0] + v[1]);\n        endpoints.currIdx += 4;\n\n        clampPixel(currIdx);\n        clampPixel(currIdx + 4);\n        break;\n      case 6:\n        v = readNDecodedColor(endpointColorValues, 4);\n\n        fillEndpointsWithPixel(0xFF, v[0] * v[3] >> 8, v[1] * v[3] >> 8, v[2] * v[3] >> 8);\n        endpoints.currIdx += 4;\n        fillEndpointsWithPixel(0xFF, v[0], v[1], v[2]);\n        endpoints.currIdx += 4;\n        break;\n      case 8:\n        v = readNDecodedColor(endpointColorValues, 6);\n        if (v[1] + v[3] + v[5] >= v[0] + v[2] + v[4]) {\n          fillEndpointsWithPixel(0xFF, v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n          fillEndpointsWithPixel(0xFF, v[1], v[3], v[5]);\n          endpoints.currIdx += 4;\n        } else {\n          blueContract(0xFF, v[1], v[3], v[5]);\n          endpoints.currIdx += 4;\n          blueContract(0xFF, v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n        }\n        break;\n      case 9:\n        v = readNDecodedColor(endpointColorValues, 6);\n\n        bitTransferSigned(v, 1, 0);\n        bitTransferSigned(v, 3, 2);\n        bitTransferSigned(v, 5, 4);\n\n        currIdx = endpoints.currIdx;\n\n        if (v[1] + v[3] + v[5] >= 0) {\n          fillEndpointsWithPixel(0xFF, v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n\n          fillEndpointsWithPixel(0xFF, v[0] + v[1], v[2] + v[3], v[4] + v[5]);\n          endpoints.currIdx += 4;\n        } else {\n          blueContract(0xFF, v[0] + v[1], v[2] + v[3], v[4] + v[5]);\n          endpoints.currIdx += 4;\n\n          blueContract(0xFF, v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n        }\n        clampPixel(currIdx);\n        clampPixel(currIdx + 4);\n        break;\n      case 10:\n        v = readNDecodedColor(endpointColorValues, 6);\n\n        fillEndpointsWithPixel(v[4], v[0] * v[3] >> 8, v[1] * v[3] >> 8, v[2] * v[3] >> 8);\n        endpoints.currIdx += 4;\n        fillEndpointsWithPixel(v[5], v[0], v[1], v[2]);\n        endpoints.currIdx += 4;\n        break;\n      case 12:\n        v = readNDecodedColor(endpointColorValues, 8);\n        if (v[1] + v[3] + v[5] >= v[0] + v[2] + v[4]) {\n          fillEndpointsWithPixel(v[6], v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n          fillEndpointsWithPixel(v[7], v[1], v[3], v[5]);\n          endpoints.currIdx += 4;\n        } else {\n          blueContract(v[7], v[1], v[3], v[5]);\n          endpoints.currIdx += 4;\n          blueContract(v[6], v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n        }\n        break;\n      case 13:\n        v = readNDecodedColor(endpointColorValues, 8);\n\n        bitTransferSigned(v, 1, 0);\n        bitTransferSigned(v, 3, 2);\n        bitTransferSigned(v, 5, 4);\n        bitTransferSigned(v, 7, 6);\n\n        currIdx = endpoints.currIdx;\n\n        if (v[1] + v[3] + v[5] >= 0) {\n          fillEndpointsWithPixel(v[6], v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n\n          fillEndpointsWithPixel(v[7] + v[6], v[0] + v[1], v[2] + v[3], v[4] + v[5]);\n          endpoints.currIdx += 4;\n        } else {\n          blueContract(v[6] + v[7], v[0] + v[1], v[2] + v[3], v[4] + v[5]);\n          endpoints.currIdx += 4;\n\n          blueContract(v[6], v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n        }\n        clampPixel(currIdx);\n        clampPixel(currIdx + 4);\n        break;\n      default:\n        console.error('Unsupported color endpoint mode. Only LDR modes are supported.');\n    }\n  };\n\n  /**\n   * Unquantizes a single texel returning it to a standard\n   * [0...64] range according to its trit/quint/bit encoding\n   * @param  {uint} val the decoded integer\n   * @return {uint} the unquantized weight in the range [0...64]\n   */\n  var unquantizeTexel = function(i) {\n    var bitLength = resultDecodedStorage[i + BIT_IDX];\n    var bitValue = resultDecodedStorage[i + BIT_IDX + 3];\n\n    // Refers to ASTC specifications (Section 3.11)\n    if (resultDecodedStorage[i + TRIT_IDX]) return cacheUnquantizeTrits[bitLength + resultDecodedStorage[i + TRIT_IDX + 3] * 4 + bitValue * 12];\n    if (resultDecodedStorage[i + QUINT_IDX]) return cacheUnquantizeQuints[bitLength + resultDecodedStorage[i + QUINT_IDX + 3] * 3 + bitValue * 15];\n    return cacheUnquantizeSimple[bitLength + bitValue * 8];\n  };\n\n  /**\n   * Returns weights in a standard range [0...64]\n   * @param  {array} weightValues contains the decoded\n   * Integer Sequence of the weight data\n   * @param  {uint} blockId the current block index\n   * @param  {uint} blockWidth the width of the blocks\n   * @param  {uint} blockHeight the height of the blocks\n   * @return {array} multidimensional array containing the weights\n   * for both planes\n   */\n\n  var unquantizedOutput = new Uint8Array(2 * 144);\n  var infilledWeightsOutput = new Uint8Array(2 * 144);\n\n  var unquantizeWeights = function(blockInfo, blockWidth, blockHeight, nbWeightValues) {\n\n    var bw = blockInfo.width;\n    var bh = blockInfo.height;\n    var bwh = bw * bh;\n\n    var i = 0;\n    var end = 0;\n\n    if (blockInfo.dualPlane) {\n      end = Math.min(nbWeightValues * 2, bwh);\n      for (i = 0; i < end; ++i) {\n        unquantizedOutput[i] = unquantizeTexel(i * 12);\n        unquantizedOutput[i + 144] = unquantizeTexel(i * 12 + 6);\n      }\n\n    } else {\n      // Unquantizes the whole weight grid\n      end = Math.min(nbWeightValues, bwh);\n      for (i = 0; i < end; ++i) {\n        unquantizedOutput[i] = unquantizeTexel(i * 6);\n      }\n    }\n\n    // Applies the weight infill procedure\n    // Refers to ASTC specifications (Section 3.12)\n    // 3D blocks are not handled for the moment\n    var Ds = ((1024 + (blockWidth / 2)) / (blockWidth - 1)) >>> 0;\n    var Dt = ((1024 + (blockHeight / 2)) / (blockHeight - 1)) >>> 0;\n    var dPlane = (blockInfo.dualPlane) ? 2 : 1;\n\n    for (var planeId = 0; planeId < dPlane; ++planeId) {\n      var idp = planeId * 144;\n      for (var t = 0; t < blockHeight; ++t) {\n        for (var s = 0; s < blockWidth; ++s) {\n          var cs = Ds * s;\n          var ct = Dt * t;\n\n          var gs = (cs * (bw - 1) + 32) >> 6;\n          var gt = (ct * (bh - 1) + 32) >> 6;\n\n          var js = gs >> 4;\n          var fs = gs & 0xF;\n\n          var jt = gt >> 4;\n          var ft = gt & 0x0F;\n\n          var w11 = (fs * ft + 8) >> 4;\n          var w10 = (ft - w11) >>> 0;\n          var w01 = (fs - w11) >>> 0;\n          var w00 = (16 - fs - ft + w11) >>> 0;\n\n          var v0 = js + jt * bw;\n\n          var val = 8;\n          var vid = v0;\n          if (vid < bwh) val += w00 * unquantizedOutput[vid + idp];\n\n          vid = v0 + 1;\n          if (vid < bwh) val += w01 * unquantizedOutput[vid + idp];\n\n          vid = v0 + bw;\n          if (vid < bwh) val += w10 * unquantizedOutput[vid + idp];\n\n          vid = v0 + bw + 1;\n          if (vid < bwh) val += w11 * unquantizedOutput[vid + idp];\n\n          infilledWeightsOutput[t * blockWidth + s + idp] = val >> 4;\n        }\n      }\n    }\n  };\n\n  /**\n   * Decompresses a single void-extent block,\n   * in other words, a block containing only one color\n   * @param  {Uint8Array} u8buffer the ASTC raw data\n   * @param  {uint} blockId the current block index\n   * @param  {uint} blockWidth the width of the blocks\n   * @param  {uint} blockHeight the height of the blocks\n   * @return {array} containing blockWidth * blockHeight Pixels\n   */\n  var decompressVoidExtent = function(u8buffer, blockId, blockInfo, blockWidth, blockHeight) {\n    // Do not read extra data\n    bitsReadCount += 53;\n\n    var r16 = readBits(u8buffer, blockId, bitsReadCount, 16);\n    bitsReadCount += 16;\n    var g16 = readBits(u8buffer, blockId, bitsReadCount, 16);\n    bitsReadCount += 16;\n    var b16 = readBits(u8buffer, blockId, bitsReadCount, 16);\n    bitsReadCount += 16;\n    var a16 = readBits(u8buffer, blockId, bitsReadCount, 16);\n    bitsReadCount += 16;\n\n    if (bitsReadCount !== 128)\n      console.error('Invalid void-extent bits reading.');\n\n    var nbPixel = blockWidth * blockHeight * 4;\n    for (var i = 0; i < nbPixel; i += 4) {\n      blockPixelsOutput[i] = extractBits(a16, 0, 7);\n      blockPixelsOutput[i + 1] = extractBits(r16, 0, 7);\n      blockPixelsOutput[i + 2] = extractBits(g16, 0, 7);\n      blockPixelsOutput[i + 3] = extractBits(b16, 0, 7);\n    }\n  };\n\n  /**\n   * Decompresses a single block by returning\n   * the error color (0xFF, 0xFF, 0x00, 0xFF)\n   * @param  {uint} blockWidth the width of the blocks\n   * @param  {uint} blockHeight the height of the blocks\n   * @return {array} containing blockWidth * blockHeight Pixels\n   */\n  var getErrorPixelBlock = function(blockWidth, blockHeight) {\n    var nbPixel = blockWidth * blockHeight * 4;\n    for (var i = 0; i < nbPixel; i += 4) {\n      blockPixelsOutput[i] = 0xFF;\n      blockPixelsOutput[i + 1] = 0xFF;\n      blockPixelsOutput[i + 2] = 0x00;\n      blockPixelsOutput[i + 3] = 0xFF;\n    }\n  };\n\n  /**\n   * Decompresses a single block by retrieving\n   * the block layout as well as the number of partitions,\n   * the color endpoints and weights data.\n   * @param  {Uint8Array} u8buffer the ASTC raw data\n   * @param  {uint} blockId the current block index\n   * @param  {uint} blockWidth the width of the blocks\n   * @param  {uint} blockHeight the height of the blocks\n   * @return {array} containing blockWidth * blockHeight Pixels\n   */\n  var decompressBlock = function(u8buffer, blockId, blockWidth, blockHeight) {\n    bitsReadCount = 0;\n    bitsWrittenCount = 0;\n    colorDataBitsRead = 0;\n    decodedColorValuesIdx = 0;\n\n    var i = 0;\n    var CEM = 0;\n    var blockInfo = getBlockInfo(u8buffer, blockId);\n\n    if (blockInfo.error)\n      return getErrorPixelBlock(blockWidth, blockHeight);\n\n    // Handles the case whenever the block is filled with only one color\n    if (blockInfo.isVoidExtent)\n      return decompressVoidExtent(u8buffer, blockId, blockInfo, blockWidth, blockHeight);\n\n    if (blockInfo.width > blockWidth)\n      console.error('Texel weight grid width can not be larger than the block width.');\n    if (blockInfo.height > blockHeight)\n      console.error('Texel weight grid height can not be larger than the block height.');\n\n    // Extracts the partitions number\n    var nbPartitions = readBits(u8buffer, blockId, bitsReadCount, 2) + 1;\n    bitsReadCount += 2;\n\n    if (nbPartitions > 4)\n      console.error('The block partitions number is too high.');\n    if (nbPartitions === 4 && blockInfo.dualPlane)\n      return getErrorPixelBlock(blockWidth, blockHeight);\n\n    // Reads the extra configuration field\n    // At most 4 modes describing how color data is encoded\n    var colorEndpointModes = [0, 0, 0, 0];\n    var partitionIndex = -1;\n    var planeIndex = -1;\n    var cemBits = 0;\n    if (nbPartitions === 1) {\n      colorEndpointModes[0] = readBits(u8buffer, blockId, bitsReadCount, 4);\n      bitsReadCount += 4;\n      partitionIndex = 0;\n    } else {\n      // Reads 10 bits containing the partition index\n      partitionIndex = readBits(u8buffer, blockId, bitsReadCount, 10);\n      bitsReadCount += 10;\n      // Reads 6 bits containing the cem extra\n      cemBits = readBits(u8buffer, blockId, bitsReadCount, 6);\n      bitsReadCount += 6;\n    }\n    var baseMode = (cemBits & 3);\n\n    // Computes remaining bits containing color endpoint data\n    //var numberWeightBits = getPackedBitSize(blockInfo);\n    var remainingBits = 128 - getPackedBitSize(blockInfo) - bitsReadCount;\n    var dualPlaneSelectorBits = (blockInfo.dualPlane) ? 2 : 0;\n    remainingBits -= dualPlaneSelectorBits;\n\n    // Gets extra bits number according to CEM\n    // mode 0 does not need any extra CEM bits\n    var extraCEMbitsNb = 0;\n    if (baseMode) {\n      if (nbPartitions === 2)\n        extraCEMbitsNb = 2;\n      else if (nbPartitions === 3)\n        extraCEMbitsNb = 5;\n      else if (nbPartitions === 4)\n        extraCEMbitsNb = 8;\n    }\n    remainingBits -= extraCEMbitsNb;\n\n    // Reads color data\n    // read data are written to a buffer for later use\n    var colorDataBits = remainingBits;\n    for (i = 0; i < 16; ++i)\n      colorEndpointData[i] = 0;\n\n    while (remainingBits > 0) {\n      var bitsNb = Math.min(remainingBits, 8);\n      var bits = readBits(u8buffer, blockId, bitsReadCount, bitsNb);\n      bitsReadCount += bitsNb;\n\n      writeBits(colorEndpointData, bits, bitsNb, bitsWrittenCount);\n      bitsWrittenCount += bitsNb;\n\n      remainingBits -= 8;\n    }\n\n    planeIndex = readBits(u8buffer, blockId, bitsReadCount, dualPlaneSelectorBits);\n    bitsReadCount += dualPlaneSelectorBits;\n\n    // Reads extra CEM data\n    if (baseMode) {\n      var extraCEMbits = readBits(u8buffer, blockId, bitsReadCount, extraCEMbitsNb);\n      bitsReadCount += extraCEMbitsNb;\n\n      CEM = (extraCEMbits << 6) | cemBits;\n      CEM >>= 2;\n\n      // Extracts the class selector bit by bit\n      var C = classSelectorBitsArray;\n      var M = colorModeLSB;\n      for (i = 0; i < nbPartitions; ++i) {\n        C[i] = CEM & 1;\n        CEM >>= 1;\n      }\n      // Extracts the color endoint mode low bits\n      /*for (i = 0; i < nbPartitions; ++i) {\n        M[i] = CEM & 3;\n        CEM >>= 2;\n        if (M[i] > 3)\n          console.error(  'Error while extracting the color endpoint mode LSB.'); \n      }*/\n      for (i = 0; i < nbPartitions; ++i) {\n        M[i] = CEM & 3;\n        CEM >>= 2;\n        if (M[i] > 3)\n          console.error('Error while extracting the color endpoint mode LSB.');\n\n        colorEndpointModes[i] = baseMode;\n        if (!(C[i]))\n          colorEndpointModes[i] -= 1;\n        colorEndpointModes[i] <<= 2;\n        colorEndpointModes[i] |= M[i];\n      }\n    } else if (nbPartitions > 1) {\n      CEM = cemBits >> 2;\n      for (i = 0; i < nbPartitions; ++i)\n        colorEndpointModes[i] = CEM;\n    }\n\n    // Makes sure the extracted data obtained until here is correct\n    var blockBitsRead = bitsReadCount + getPackedBitSize(blockInfo);\n\n    for (i = 0; i < nbPartitions; ++i)\n      if (colorEndpointModes[i] >= 16)\n        console.error('The color endpoint mode ' + colorEndpointModes[i] + ' is not correct.');\n\n    if (blockBitsRead < 128)\n      console.error('The current block as not been read entirely. (' + blockBitsRead + ' read)');\n    else if (blockBitsRead > 128)\n      console.error('Too many bits have been read for the current block. (' + blockBitsRead + ' read)');\n\n    // Decodes color data\n    decodeColorValues(colorEndpointData, colorEndpointModes, nbPartitions, colorDataBits);\n\n    // Computes endpoint for all partitions\n    endpoints.currIdx = 0;\n    for (i = 0; i < nbPartitions; i++)\n      computeColorEndpointsLDR(endpointValuesOutput, colorEndpointModes[i]);\n\n    // Reads remaining bits containing packed texel weight data\n    // This code can be factorized with the color data reading above\n    var texelWeightDataIndex = 0;\n    for (i = 0; i < 16; ++i)\n      texelWeightData[texelWeightDataIndex++] = u8buffer[blockId + i];\n\n    // Reverses the textWeightData array\n    // and each byte\n    reverseU8Array(texelWeightData);\n\n    var weightPackedSize = getPackedBitSize(blockInfo);\n    var clearByteStart = (weightPackedSize >> 3) + 1;\n    var nbBytesToClean = 16 - clearByteStart;\n    texelWeightData[clearByteStart - 1] &= (1 << (weightPackedSize % 8)) - 1;\n    for (i = 0; i < nbBytesToClean; ++i)\n      texelWeightData[clearByteStart + i] = 0;\n\n    // Decodes the weight\n    colorDataBitsRead = 0;\n    var nbWeightValues = getNumberWeightValues(blockInfo);\n    decodeIntegerSequence(texelWeightData, blockInfo.maxWeight, nbWeightValues);\n\n    unquantizeWeights(blockInfo, blockWidth, blockHeight, nbWeightValues);\n\n    // Interpolates colors\n    var smallBlock = (blockHeight * blockWidth) < 32;\n    var rnum = precomputeSelectPartition(partitionIndex, nbPartitions);\n    for (var j = 0; j < blockHeight; j++) {\n      for (i = 0; i < blockWidth; i++) {\n        var partition = selectPartition(rnum, i, j, 0, nbPartitions, smallBlock);\n        if (partition >= nbPartitions)\n          console.error('The block partition index can not be larger or equal to the number of partitions.');\n\n        var rowIndex = (j * blockWidth + i) * 4;\n        var endpointBaseIdx = partition * 8;\n        for (var c = 0; c < 4; ++c) {\n          var C0 = endpoints[endpointBaseIdx + c] >>> 0;\n          C0 = replicateBits0816Map[C0];\n\n          var C1 = endpoints[endpointBaseIdx + c + 4] >>> 0;\n          C1 = replicateBits0816Map[C1];\n\n          var plane = 0 >>> 0;\n          if (blockInfo.dualPlane && (((planeIndex + 1) & 3) === c))\n            plane = 1;\n\n          var weight = infilledWeightsOutput[j * blockWidth + i + plane * 144];\n          var color = Math.floor(((C0 * (64 - weight) + C1 * weight + 32) / 64));\n\n          if (color === 65535)\n            blockPixelsOutput[rowIndex + c] = 255;\n          else\n            blockPixelsOutput[rowIndex + c] = Math.round(255.0 * (color / 65536.0));\n        }\n      }\n    }\n  };\n\n  /**\n   * Decompresses a complete buffer containing ASTC file raw data\n   * @param  {ArrayBuffer} contains the compressed ASTC raw data\n   * @return {Object} contains the uncompressed image buffer\n   * as well as the image dimensions\n   */\n  // TODO export\n  var decompress = function(imgBuffer) {\n    var u8buffer = new Uint8Array(imgBuffer);\n\n    // Retrieves the header\n    var header = parseHeader(imgBuffer);\n\n    var imgWidth = header.xSize;\n    var imgHeight = header.ySize;\n    var halfImgHeight = (imgHeight >> 1);\n\n    var blockWidth = header.blockDimX;\n    var blockHeight = header.blockDimY;\n\n    var firstBlockIndex = 16;\n    var blockNb = 0;\n\n    // Initializes temp storages used\n    // in helper functions\n    blockPixelsOutput = new Uint8Array(blockWidth * blockHeight * 4);\n\n    var j = 0;\n    var i = 0;\n    var resultImg = new Uint8ClampedArray(imgWidth * imgHeight * 4);\n\n    for (j = 0; j < imgHeight; j += blockHeight) {\n      for (i = 0; i < imgWidth; i += blockWidth) {\n\n        var currentBlockIndex = firstBlockIndex + blockNb * 16;\n        // Decompresses the current block\n        decompressBlock(u8buffer, currentBlockIndex, blockWidth, blockHeight);\n\n        var widthBound = Math.min(blockWidth, imgWidth - i);\n        var heightBound = Math.min(blockHeight, imgHeight - j);\n        var rowIndex = (j * imgWidth + i) * 4;\n        for (var jj = 0; jj < heightBound; jj++) {\n          var destId = rowIndex + jj * imgWidth * 4;\n          var srcId = jj * blockWidth * 4;\n\n          for (var x = 0; x < widthBound * 4; x += 4) {\n            resultImg[destId + x] = blockPixelsOutput[srcId + x + 1];\n            resultImg[destId + x + 1] = blockPixelsOutput[srcId + x + 2];\n            resultImg[destId + x + 2] = blockPixelsOutput[srcId + x + 3];\n            resultImg[destId + x + 3] = blockPixelsOutput[srcId + x];\n          }\n        }\n\n        ++blockNb;\n      }\n    }\n\n    // Flips the image using the Y-axis\n    for (j = 0; j < halfImgHeight; j++) {\n      for (i = 0; i < imgWidth; i++) {\n        var beginByte = (j * imgWidth + i) * 4;\n        var endByte = ((imgHeight - j - 1) * imgWidth + i) * 4;\n\n        swapCell(resultImg, beginByte, endByte);\n        swapCell(resultImg, beginByte + 1, endByte + 1);\n        swapCell(resultImg, beginByte + 2, endByte + 2);\n        swapCell(resultImg, beginByte + 3, endByte + 3);\n      }\n    }\n\n    var result = {};\n    result.img = resultImg;\n    result.width = imgWidth;\n    result.height = imgHeight;\n\n    return result;\n  };\n\n  module.exports = {\n    decompress: decompress\n  };\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n  'use strict';\n\n  var replicateBits = __webpack_require__(3).replicateBits;\n\n  // Describes how to unpack trit/quint\n  // with no additional bits\n  var WEIGHT_TRIT_RANGE = [0, 32, 63];\n  var WEIGHT_QUINT_RANGE = [0, 16, 32, 47, 63];\n\n  ///////////////////\n  // CACHE UNQUANTIZE\n  ///////////////////\n\n  // -----------------\n  // UNQUANTIZE SIMPLE\n  // -----------------\n  var cacheUnquantizeSimple = new Uint8Array(256 * 8);\n  for (var bitValue = 0; bitValue < 256; ++bitValue) {\n    for (var bitLength = 1; bitLength < 8; ++bitLength) {\n\n      var result = replicateBits(bitValue, bitLength, 6);\n      if (result > 32) result++;\n\n      cacheUnquantizeSimple[bitLength + bitValue * 8] = result;\n    }\n  }\n\n  // ----------------\n  // UNQUANTIZE TRITS\n  // ----------------\n  var cacheUnquantizeTrits = new Uint8Array(256 * 3 * 4);\n  for (var bitValue = 0; bitValue < 256; ++bitValue) {\n    for (var tri = 0; tri < 3; ++tri) {\n      for (var bitLength = 0; bitLength < 4; ++bitLength) {\n\n        var C = 0;\n        var B = 0;\n        var result;\n        switch (bitLength) {\n          case 0:\n            result = WEIGHT_TRIT_RANGE[tri];\n            break;\n          case 1:\n            C = 50;\n            break;\n          case 2:\n            C = 23;\n            var bBit = (bitValue >> 1) & 1;\n            B = (bBit << 6) | (bBit << 2) | bBit;\n            break;\n          case 3:\n            C = 11;\n            var cbBits = (bitValue >> 1) & 3;\n            B = (cbBits << 5) | cbBits;\n            break;\n        }\n\n        if (bitLength > 0) {\n          var A = bitValue % 2 ? 127 : 0;\n          result = tri * C + B;\n          result ^= A;\n          result = (A & 0x20) | (result >> 2);\n        }\n\n        if (result > 32) result++;\n\n        cacheUnquantizeTrits[bitLength + tri * 4 + bitValue * 12] = result;\n      }\n    }\n  }\n\n  // -----------------\n  // UNQUANTIZE QUINTS\n  // -----------------\n  var cacheUnquantizeQuints = new Uint8Array(256 * 5 * 3);\n  for (var bitValue = 0; bitValue < 256; ++bitValue) {\n    for (var quint = 0; quint < 5; ++quint) {\n      for (var bitLength = 0; bitLength < 3; ++bitLength) {\n\n        var C = 0;\n        var B = 0;\n        var result;\n        switch (bitLength) {\n          case 0:\n            result = WEIGHT_QUINT_RANGE[quint];\n            break;\n          case 1:\n            C = 28;\n            break;\n          case 2:\n            C = 13;\n            var bBits = (bitValue >> 1) & 1;\n            B = (bBits << 6) | (bBits << 1);\n            break;\n        }\n\n        if (bitLength > 0) {\n          var A = bitValue % 2 ? 127 : 0;\n          result = quint * C + B;\n          result ^= A;\n          result = (A & 0x20) | (result >> 2);\n        }\n\n        if (result > 32) result++;\n\n        cacheUnquantizeQuints[bitLength + quint * 3 + bitValue * 15] = result;\n      }\n    }\n  }\n\n  ///////////////\n  // CACHE DECODE\n  ///////////////\n\n  // -------------\n  // DECODE SIMPLE\n  // -------------\n  var cacheDecodeSimple = new Uint8Array(256 * 9);\n  for (var bitValue = 0; bitValue < 256; ++bitValue) {\n    for (var bitLength = 1; bitLength < 9; ++bitLength) {\n      cacheDecodeSimple[bitLength + bitValue * 9] = replicateBits(bitValue, bitLength, 8);\n    }\n  }\n\n  // ----------------\n  // UNQUANTIZE TRITS\n  // ----------------\n  var cacheDecodeTrits = new Uint8Array(256 * 3 * 7);\n  for (var bitValue = 0; bitValue < 256; ++bitValue) {\n    for (var tri = 0; tri < 3; ++tri) {\n      for (var bitLength = 0; bitLength < 7; ++bitLength) {\n\n        var C = 0;\n        var B = 0;\n        var result;\n        switch (bitLength) {\n          case 1:\n            C = 204;\n            break;\n          case 2:\n            C = 93;\n            // b000b0bb0\n            var bBit = (bitValue >> 1) & 1;\n            B = (bBit << 8) | (bBit << 4) | (bBit << 2) | (bBit << 1);\n            break;\n          case 3:\n            C = 44;\n            // cb000cbcb\n            var cbBit = (bitValue >> 1) & 3;\n            B = (cbBit << 7) | (cbBit << 2) | cbBit;\n            break;\n          case 4:\n            C = 22;\n            // dcb000dcb\n            var dcbBit = (bitValue >> 1) & 7;\n            B = (dcbBit << 6) | dcbBit;\n            break;\n          case 5:\n            C = 11;\n            // edcb000ed\n            var edcbBit = (bitValue >> 1) & 0xF;\n            B = (edcbBit << 5) | (edcbBit >> 2);\n            break;\n          case 6:\n            C = 5;\n            // fedcb000f\n            var fedcbBit = (bitValue >> 1) & 0x1F;\n            B = (fedcbBit << 4) | (fedcbBit >> 4);\n            break;\n        }\n\n        if (bitLength > 0) {\n          var A = bitValue % 2 ? 511 : 0;\n          result = (tri * C + B) >>> 0;\n          result ^= A;\n          result = (A & 0x80) | (result >> 2);\n        }\n\n        cacheDecodeTrits[bitLength + tri * 7 + bitValue * 21] = result;\n      }\n    }\n  }\n\n  // -----------------\n  // UNQUANTIZE QUINTS\n  // -----------------\n  var cacheDecodeQuints = new Uint8Array(256 * 5 * 6);\n  for (var bitValue = 0; bitValue < 256; ++bitValue) {\n    for (var quint = 0; quint < 5; ++quint) {\n      for (var bitLength = 0; bitLength < 6; ++bitLength) {\n\n        var C = 0;\n        var B = 0;\n        var result;\n        switch (bitLength) {\n          case 1:\n            C = 113;\n            break;\n          case 2:\n            C = 54;\n            // b0000bb00\n            var bBit = (bitValue >> 1) & 1;\n            B = (bBit << 8) | (bBit << 3) | (bBit << 2);\n            break;\n          case 3:\n            C = 26;\n            // cb0000cbc\n            var cbBit = (bitValue >> 1) & 3;\n            B = (cbBit << 7) | (cbBit << 1) | (cbBit >> 1);\n            break;\n          case 4:\n            C = 13;\n            // dcb0000dc\n            var dcbBit = (bitValue >> 1) & 7;\n            B = (dcbBit << 6) | (dcbBit >> 1);\n            break;\n          case 5:\n            C = 6;\n            // edcb0000e\n            var edcbBit = (bitValue >> 1) & 0xF;\n            B = (edcbBit << 5) | (edcbBit >> 3);\n            break;\n        }\n\n        if (bitLength > 0) {\n          var A = bitValue % 2 ? 511 : 0;\n          result = (quint * C + B) >>> 0;\n          result ^= A;\n          result = (A & 0x80) | (result >> 2);\n        }\n\n        cacheDecodeQuints[bitLength + quint * 6 + bitValue * 30] = result;\n      }\n    }\n  }\n\n\n  // TOTO module exports\n  module.exports = {\n    cacheUnquantizeSimple: cacheUnquantizeSimple,\n    cacheUnquantizeTrits: cacheUnquantizeTrits,\n    cacheUnquantizeQuints: cacheUnquantizeQuints,\n    cacheDecodeSimple: cacheDecodeSimple,\n    cacheDecodeTrits: cacheDecodeTrits,\n    cacheDecodeQuints: cacheDecodeQuints\n  };\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n  'use strict';\n\n  /**\n   * Creates a binary mask between two given bounds\n   * @param  {int} a starting bit\n   * @param  {int} b ending bit\n   * @return {int} mask integer containing binary 1 between a and b\n   */\n  var createMask = function(a, b) {\n    var r = 0;\n    for (var i = a; i <= b; ++i)\n      r |= 1 << i;\n\n    return r;\n  };\n\n  /**\n   * Applies the Hamming weight algorithm: looks for the number of bits set to 1\n   * @param  {int} value\n   * @return {int} the number of bits set to 1\n   */\n  var popCount = function(value) {\n    var i = 0;\n    for (; value; ++i)\n      value &= value - 1;\n    return i;\n  };\n\n  /**\n   * Extracts bits from a bounded range\n   * @param  {int} value representing the integer value where the bits are extracted\n   * @param  {int} start the index of the starting bit\n   * @param  {int} stop  the index of the ending bit\n   * @return {int} the integer composed by the extracted bits\n   */\n  var extractBits = function(value, start, stop) {\n    return (value & createMask(start, stop)) >> start;\n  };\n\n\n  /**\n   * Replicates the n lower bits until the given bit index\n   * @param  {int} val contains the bits to replicate\n   * @param  {int} bitsNb describes the number of lower bits to replicate\n   * @param  {int} endBit the \"index\" of the included final bit\n   * @return {int} result containing a number made of the replicated bits\n   */\n  var replicateBits = function(val, bitsNb, endBit) {\n    // Extracts the bitsNb lower bits from the val value\n    var extractedBits = val & ((1 << bitsNb) - 1);\n    var result = extractedBits;\n    var resultLength = bitsNb;\n\n    while (resultLength < endBit) {\n\n      var extractedBitsShift = 0;\n      if (bitsNb > endBit - resultLength) {\n        var newShift = endBit - resultLength;\n        extractedBitsShift = bitsNb - newShift;\n        bitsNb = newShift;\n      }\n\n      // Shifts the result to \"add\" the pattern\n      result <<= bitsNb;\n      result |= extractedBits >> extractedBitsShift;\n      resultLength += bitsNb;\n    }\n\n    return result;\n  };\n\n  /**\n   * Transfers one bit from an integer to another\n   * @param  {array} array containing the two cells to transfer\n   * @param  {uint} i1 the index of the first cell\n   * @param  {uint} i2 the index of the second cell\n   */\n  var bitTransferSigned = function(array, i1, i2) {\n    var a = array[i1];\n    var b = array[i2];\n\n    b >>= 1;\n    b |= a & 0x80;\n    a >>= 1;\n    a &= 0x3F;\n    if (a & 0x20)\n      a -= 0x40;\n\n    array[i1] = a;\n    array[i2] = b;\n  };\n\n  /**\n   * Reads at most 30 bits from the given U8Int array\n   * @param  {U8IntArray} u8buffer buffer containing data to read\n   * @param  {int} beginByteId first byte at which the reading should begin\n   * @param  {int} bitsOffset nth bits at which the reading should begin\n   * @param  {int} bitsNb number of bits to read\n   * @return {int} an integer containing the read bits\n   */\n  var readBits = function(u8buffer, beginByteId, bitsOffset, bitsNb) {\n    if (bitsNb > 30)\n      console.error('The reader can not read more than 30 bits in a row.');\n    if (bitsNb <= 0)\n      return 0;\n\n    // Updates the total number of extracted bits\n    // for the current block\n    //bitsReadCount += bitsNb;\n\n    var bitsReadResult = 0;\n    var offsetByteId = beginByteId + Math.floor(bitsOffset / 8);\n    var endByteId = beginByteId + Math.floor((bitsOffset + bitsNb) / 8);\n    var bornInfBit = bitsOffset % 8;\n    var bornSupBit = (bitsOffset + bitsNb - 1) % 8;\n\n    // Simple reading where data lies on the same byte\n    if (offsetByteId === endByteId)\n      return (u8buffer[offsetByteId] & createMask(bornInfBit, bornSupBit)) >> bornInfBit;\n\n    // Recreates the integer by shifting bytes\n    // the created integer is at most a 24bits integer\n    var shift = 8;\n    bitsReadResult += u8buffer[offsetByteId];\n    for (var i = offsetByteId + 1; i <= endByteId; ++i) {\n      bitsReadResult += u8buffer[i] << shift;\n      shift *= 2;\n    }\n\n    bitsReadResult = (bitsReadResult & createMask(bornInfBit, bornInfBit + bitsNb - 1)) >> bornInfBit;\n\n    return bitsReadResult;\n  };\n\n  /**\n   * Write a given value in colorEndpointData at the byte index\n   * computed from the number of bits currently written.\n   * It is important to note that the number of bits to write in\n   * a row never exceed the size of a byte (8 bits)\n   * @param  {Uint8Array} colorEndpointData destination byte array\n   * @param  {int} bits the value to write\n   * @param  {uint} bitsNb the number of bits to write\n   * @param  {uint} bitsWritten the current number of bits written\n   */\n  var writeBits = function(colorEndpointData, bits, bitsNb, bitsWritten) {\n    colorEndpointData[Math.floor(bitsWritten / 8)] = bits;\n  };\n\n  /**\n   * Reverses the bits in a byte\n   * @param  {uint8} b the byte to reverse\n   * @return {uint32} the reversed byte not casted\n   */\n  var reverseByte = function(b) {\n    // Converts x to a 32 bits unsigned integer\n    b = b >>> 0;\n    return ((b * 0x0802 & 0x22110) | (b * 0x8020 & 0x88440)) * 0x10101 >> 16;\n  };\n\n  /**\n   * Reverses each byte just as the global bytes order\n   * @param  {Uint8Array} u8array the array to reverse\n   */\n  var reverseU8Array = function(u8array) {\n    for (var i = 0; i < u8array.length / 2; ++i) {\n      var a = reverseByte(u8array[i]);\n      var b = reverseByte(u8array[u8array.length - 1 - i]);\n\n      u8array[i] = b;\n      u8array[u8array.length - 1 - i] = a;\n    }\n  };\n\n  module.exports = {\n    popCount: popCount,\n    readBits: readBits,\n    writeBits: writeBits,\n    extractBits: extractBits,\n    replicateBits: replicateBits,\n    bitTransferSigned: bitTransferSigned,\n    reverseU8Array: reverseU8Array\n  };\n\n/***/ }\n/******/ ])\n});\n;"},function(e,t){e.exports="/*jshint worker: true */\n\nself.onmessage = function(event) {\n    var data = event.data;\n\n    var opt = {\n        imageOrientation: 'flipY',\n        premultiplyAlpha: 'none',\n        colorSpaceConversion: 'none'\n    };\n\n    self.fetch(data.url).then(function(response) {\n        response.blob().then(function(blob) {\n            self.createImageBitmap(blob, opt).then(function(bitmap) {\n                postMessage(\n                    {\n                        bitmap: bitmap,\n                        url: data.url,\n                        uid: data.uid\n                    },\n                    [bitmap]\n                );\n            });\n        });\n    });\n};\n\n/*jshint worker: false */\n"},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(604)),n=function(e,t){a.a.call(this,e,"arraybuffer",t)};n.prototype=Object(r.extend)({},a.a.prototype,{load:function(){var e=this.getXHR().response;this._defer.resolve(e)}}),t.a=n},function(e,t,i){"use strict";var r=i(934),a=i(38),n=i(2),o=i(259);t.a=a.a.extend({optionTypes:{modelUid:n.b.string},model:r.a,url:function(){return Object(o.a)("environments",this.options.modelUid,this.options.checkPrefetch)}})},function(e,t,i){"use strict";var r=i(935),a=i(38),n=i(2),o=i(259);t.a=a.a.extend({optionTypes:{modelUid:n.b.string},model:r.a,url:function(){return Object(o.a)("backgrounds",this.options.modelUid,this.options.checkPrefetch)}})},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(649)),n=i(38),o=i(2),s=i(936),u=i(849),l=i(259);t.a=n.a.extend(Object(r.extend)({optionTypes:{modelUid:o.b.string},model:a.a,url:function(){return Object(l.a)("textures",this.options.modelUid,this.options.checkPrefetch)},comparator:function(e,t){return e.get("value")?Object(s.a)(e.get("name"),t.get("name")):-1},isValid:function(){this.each(function(e){e.isValid()})},getImageFromURL:function(e){var t=e.split("/").pop();return this.find(function(e){var i=!1;return e.get("images").forEach(function(e){i||-1!==e.url.indexOf(t)&&(i=!0)}),i})}},u.a))},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(937)),n=i(38),o=i(2),s=i(849),u=i(259);t.a=n.a.extend(Object(r.extend)({optionTypes:{modelUid:o.b.string},model:a.a,url:function(){return Object(u.a)("matcaps",this.options.modelUid,this.options.checkPrefetch)}},s.a))},function(e,t,i){"use strict";var r=i(1143),a=i(38),n=i(2),o=i(259);t.a=a.a.extend({optionTypes:{modelUid:n.b.string},comparator:"order",model:r.a,_trashbin:[],url:function(){return Object(o.a)("animations",this.options.modelUid,this.options.checkPrefetch)}})},function(e,t,i){"use strict";var r=i(7),a=i.n(r),n=i(3),o=i.n(n),s=i(12);t.a=s.a.extend({defaults:{name:"",uid:"",duration:0,isLoop:!1,isEnabled:!0},endpoint:function(){return"/animations/"+this.get("uid")},registerOptions:function(){this._lastOptions={name:this.get("name"),isLoop:this.get("isLoop"),isEnabled:this.get("isEnabled")}},hasChangedOptions:function(){if(!this._lastOptions)return!0;var e=this._lastOptions;for(var t in e)if(e[t]!==this.get(t))return!0;return!1},save:function(){if(!this.hasChangedOptions())return a.a.resolve();this.registerOptions();var e=new FormData;e.append("name",this.get("name")),e.append("isLoop",this.get("isLoop")),e.append("isEnabled",this.get("isEnabled"));var t=o.a.ajax({type:"PATCH",url:this.url(),data:e,cache:!1,contentType:!1,processData:!1});return a.a.resolve(t)}})},function(e,t,i){"use strict";var r=i(701),a=i(38),n=i(2),o=i(259);t.a=a.a.extend({optionTypes:{modelUid:n.b.string},comparator:"order",model:r.a,url:function(){return Object(o.a)("sounds",this.options.modelUid,this.options.checkPrefetch)},modelId:function(e){return e.cid},triggerEditTrack:function(e){this.trigger("editTrack",e)},triggerDeleteTrack:function(e){this.trigger("removeTrack",e)},triggerDuplicateTrack:function(e){this.trigger("duplicateTrack",e)},triggerSelectTrack:function(e){this.trigger("select",e)}})},function(e,t,i){"use strict";var r=i(5),a=i(16),n=i(34),o=i(144),s=i(1146),u=i(1151),l=i(1153),c=r.a.osg,h=r.a.osgDB,d=function(e,t){for(var i=e.getPrimitiveSetList(),r=0,a=i.length;r<a;++r){var n=i[r];if(!(n instanceof c.DrawArrays||n instanceof c.DrawArrayLengths)){var o=n.getIndices();o.getInitialBufferArray&&(o=o.getInitialBufferArray());var s=t[o.getInstanceID()];return s.inlined?"":s.vb.File}}var u=e.getVertexAttributeList().Vertex;u.getInitialBufferArray&&(u=u.getInitialBufferArray());var l=t[u.getInstanceID()];return l.inlined?"":l.vb.File},p="",f=function(e,t){var i=t.wireframeOptions&&t.wireframeOptions.nodes,r=[],n=[],s=[],u="",l="",c=o.a.instanceIDGeometryMap;for(var h in c){var f=c[h];0!==f.getPrimitiveSetList().length||Object(a.a)().keepEmptyGeometries?1!==f.userDataMap.wireframe?(n.push(f),u||(u=d(f,e))===p&&(u="")):(s.push(f),i&&i.push(f),f.setNodeMask(0),l||(l=d(f,e))):r.push(f)}p=u||p;for(var m=0,g=r.length;m<g;++m)for(var _=r[m],v=_.getParents(),b=v.length-1;b>=0;--b)v[b].removeChild(_);return{urlPolygon:t.prefixURL+u,urlWireframe:t.prefixURL+l,namePolygon:u,nameWireframe:l,polygons:n,wireframes:s}},m=function(e,t,i,r){var a="Uncompress "+r;c.time(a);for(var n=0;n<e.length;++n)Object(s.a)(e[n],t,i);Object(l.a)(e),Object(u.a)(),c.timeEnd(a)},g=function(e,t,i,r){if(r){var a="Download "+e.nameWireframe+" (Async)";r.startPromise.then(function(){var n=i.getBinaryArray(e.urlWireframe,r).getPromise();c.time(a),n.then(function(i){c.timeEnd(a),m(e.wireframes,t,i,e.nameWireframe),r.deferDownload.resolve()})})}},_=function(e,t,i,r,a){var n=t.bufferMap,o=f(n,t);if(!o.namePolygon)return m(o.polygons,n,null,a),i.addChild(e),i;var s="Download "+o.namePolygon+" (Async)",u=r.getBinaryArray(o.urlPolygon,t).getPromise();return c.time(s),u.then(function(a){return c.timeEnd(s),m(o.polygons,n,a,o.namePolygon),g(o,n,r,t.wireframeOptions),i.addChild(e),i})},v=function(e,t){var i="UserDataVisitor "+t;c.time(i);var r=new o.a;e.accept(r),c.timeEnd(i)},b=function(e,t,i,r,a){t.size=t.binarySize,t.progressKey=t.binaryKey;var o="JSON.parse "+a,s="osgDB.parseSceneGraph "+a+" (Async)";c.time(o);var u=JSON.parse(e);return c.timeEnd(o),n.a.OSG_VERSION=u.Version,c.time(s),h.parseSceneGraph(u,t).then(function(e){return c.timeEnd(s),v(e,a),_(e,t,i,r,a)})},y=function(e,t,i,r,a){i.size=i.osgjsSize,i.progressKey=i.osgjsKey;var n=t.split("/").pop(),o="Download "+n+" (Async)";return c.time(o),e.then(function(e){return c.timeEnd(o),b(e,i,r,a,n)})};t.a=y},function(e,t,i){"use strict";var r=i(5),a=i(851),n=i(1147),o=i(1148),s=i(1149),u=i(852),l=i(853),c=i(1150),h=i(16),d=r.a.osg,p=r.a.osgWrappers.osg.functionSortAttributes,f={Vertex:1,Normal:2,TexCoord:4,Color:8,Triangle:16,Tangent:32},m={quantization:1,prediction:2,delta:4},g={delta:1,highWatermark:2,implicit:4},_=function(e){return-1!==e.indexOf("TexCoord")?f.TexCoord:f[e]},v=function(e,t,i,r,a){var s,u=t.vb,h=u.Offset?u.Offset:0,p=e.getIndices();s=u.Encoding&&"varint"===u.Encoding?Object(l.a)(new Uint8Array(a,h),p.getItemSize()*u.Size,t.type):new d[t.type](a,h,p.getItemSize()*u.Size),1===s.BYTES_PER_ELEMENT&&(s=new Uint16Array(s));var f=i.attributes,m=_("Triangle"),v=s,b=e.getMode()===d.primitiveSet.TRIANGLE_STRIP;if(0==(f&m)||!b&&e.getMode()!==d.primitiveSet.TRIANGLES)return s instanceof Uint16Array==!1&&(v=new Uint16Array(s.buffer,s.byteOffset,s.length),v.set(s)),p.setElements(v),void e.setIndices(p);var y=i.triangle_mode,x=0;if(y&g.implicit&&b&&(x=o.a.IMPLICIT_HEADER_LENGTH+s[o.a.IMPLICIT_HEADER_MASK_LENGTH],v=new Uint16Array(s[o.a.IMPLICIT_HEADER_PRIMITIVE_LENGTH])),y&g.delta&&Object(n.a)(s,x),y&g.implicit&&b&&Object(o.a)(s,v,x,y&g.highWatermark),y&g.highWatermark&&Object(c.a)(v,v,r),v instanceof Uint16Array==!1){var S=v;v=new Uint16Array(S.buffer,S.byteOffset,S.length),v.set(S)}p.setElements(v),e.setIndices(p)},b=d.vec3.create(),y=d.vec3.create(),x=function(e,t,i,r,a){var n="Vertex"===r?"vtx_":"uv_"+r.substr(8)+"_",o=e&m.quantization&&void 0!==a[n+"bbl_x"],s=t instanceof Float32Array==!0;if(!o&&s)return t;var l=4===t.BYTES_PER_ELEMENT?new Float32Array(t.buffer,t.byteOffset,t.length):new Float32Array(t.length);return o?(b[0]=a[n+"bbl_x"],b[1]=a[n+"bbl_y"],y[0]=a[n+"h_x"],y[1]=a[n+"h_y"],3===i&&(b[2]=a[n+"bbl_z"],y[2]=a[n+"h_z"]),Object(u.a)(t,l,b,y,i)):(l.set(t),l)},S=function(e,t){if(4===t.BYTES_PER_ELEMENT&&Object(h.a)().convertVertexColor8Bit){for(var i=t.length,r=new Uint8Array(t.buffer,t.byteOffset,i),a=0;a<i;++a)r[a]=Math.round(255*Math.max(0,Math.min(1,t[a])));t=r}return 1===t.BYTES_PER_ELEMENT&&e.setNormalize(!0),t},M=function(e,t){if(1===t.BYTES_PER_ELEMENT)return t;for(var i=0,r=t.length;i<r;++i)if(t[i]>255)return t;var a=new Uint8Array(t.buffer,t.byteOffset,r);return a.set(t),a},w=function(e,t,i,r,n,o){var u,c=t.vb,h=e.getItemSize(),p=c.Size,f=c.Offset?c.Offset:0;if(u=c.Encoding&&"varint"===c.Encoding?Object(l.a)(new Uint8Array(o,f),h*p,t.type):new d[t.type](o,f,h*p),0==(r.attributes&_(i)))return"Color"===i?u=S(e,u):"Bones"===i&&(u=M(0,u)),void e.setElements(u);if("Normal"===i)return e.setElements(Object(a.a)(u,new Float32Array(3*p),3,r.epsilon,r.nphi)),void e.setItemSize(3);if("Tangent"===i)return e.setElements(Object(a.a)(u,new Float32Array(4*p),4,r.epsilon,r.nphi)),void e.setItemSize(4);var g=null;if("Vertex"===i)g=r.vertex_mode;else if(-1!==i.indexOf("TexCoord")){var v="uv_"+i.substr(8)+"_mode";g=void 0!==r[v]?r[v]:r.vertex_mode}g&m.prediction&&void 0!==n&&Object(s.a)(u,h,n.getElements()),e.setElements(x(g,u,h,i,r))},T=function(e,t,i){for(var r,a=e.userDataMap,n=e.getPrimitiveSetList(),o=[0],s=0,u=n.length;s<u;++s){var l=n[s];if(!(l instanceof d.DrawArrays||l instanceof d.DrawArrayLengths)){var c=l.getIndices();c.getInitialBufferArray&&(c=c.getInitialBufferArray());var h=t[c.getInstanceID()];!0!==h.visited&&(h.visited=!0,h.inlined?(c.setElements(new Uint16Array(h.inlined)),l.setIndices(c)):(v(l,h,a,o,i),l.getMode()===d.primitiveSet.TRIANGLE_STRIP&&(r=c)))}}for(s=u-1;s>=0;s--)l=n[s],l.getCount()||n.splice(s,1);return r},C=function(e,t,i,r){var a=e.userDataMap,n=e.getVertexAttributeList(),o=Object.keys(n);o.sort(p);for(var s=o.length,u=0;u<s;++u){var l=o[u],c=n[l];c.getInitialBufferArray&&(c=c.getInitialBufferArray());var h=t[c.getInstanceID()];if(!0!==h.visited)if(h.visited=!0,h.inlined)c.setElements(new Float32Array(h.inlined));else{var d=a,f=l.indexOf("_");if(-1!==f){var m=l.slice(f+1);d=a["morph_"+m],l=l.slice(0,f)}w(c,h,l,d,r,i)}}},E=function(e,t,i){var r=T(e,t,i);C(e,t,i,r)};t.a=E},function(e,t,i){"use strict";var r=function(e,t){for(var i=t||0,r=e.length,a=e[i],n=i+1;n<r;++n){var o=e[n];a=e[n]=a+(o>>1^-(1&o))}return e};t.a=r},function(e,t,i){"use strict";var r=function(e,t,i,a){for(var n=e[r.IMPLICIT_HEADER_EXPECTED_INDEX],o=e[r.IMPLICIT_HEADER_MASK_LENGTH],s=new Uint32Array(e.subarray(r.IMPLICIT_HEADER_LENGTH,o+r.IMPLICIT_HEADER_LENGTH)),u=32*o-t.length,l=0;l<o;++l)for(var c=s[l],h=32*l,d=l===o-1?u:0,p=d;p<32;++p,++h)t[h]=c&1<<31>>>p?e[i++]:a?n:n++;return t};r.IMPLICIT_HEADER_PRIMITIVE_LENGTH=0,r.IMPLICIT_HEADER_MASK_LENGTH=1,r.IMPLICIT_HEADER_EXPECTED_INDEX=2,r.IMPLICIT_HEADER_LENGTH=3,t.a=r},function(e,t,i){"use strict";var r=function(e,t,i){var r=e.length/t,a=new Uint8Array(r),n=i.length-1;a[i[0]]=1,a[i[1]]=1,a[i[2]]=1;for(var o=2;o<n;++o){var s=o-2,u=i[s],l=i[s+1],c=i[s+2],h=i[s+3];if(1!==a[h]){a[h]=1,u*=t,l*=t,c*=t,h*=t;for(var d=0;d<t;++d)e[h+d]=e[h+d]+e[l+d]+e[c+d]-e[u+d]}}return e};t.a=r},function(e,t,i){"use strict";var r=function(e,t,i){for(var r=i[0],a=e.length,n=0;n<a;++n){var o=r-e[n];t[n]=o,r<=o&&(r=o+1)}return i[0]=r,t};t.a=r},function(e,t,i){"use strict";var r=i(5),a=i(144),n=i(457),o=r.a.osg,s=[o.primitiveSet.TRIANGLES,o.primitiveSet.TRIANGLE_STRIP,o.primitiveSet.TRIANGLE_FAN],u=[o.primitiveSet.LINES,o.primitiveSet.LINE_LOOP,o.primitiveSet.LINE_STRIP],l=function(e,t){var i=t.getItemSize(),r=t.getElements(),a=1;1===r.BYTES_PER_ELEMENT?a=255:2===r.BYTES_PER_ELEMENT&&(a=65535);var o=!1,s=r.length,u=0;if(4===i){var l=!0,c=!0;for(u=3;u<s;u+=4){var h=r[u];if(0!==h&&(l=!1),h!==a&&(c=!1),!l&&!c)break}if(l&&4===i)for(u=3;u<s;u+=4)r[u]=a;o=!l&&!c}var d=!0;if(!o){var p=!0;for(u=0;u<s&&(r[u]!==a&&(p=!1),r[u+1]!==a&&(p=!1),r[u+2]!==a&&(p=!1),p);u+=i);p&&delete e.getVertexAttributeList().Color,d=!p}o&&(n.a.hasVertexAlpha=e.userDataMap.hasVertexAlpha=!0),d&&(n.a.hasVertexColor=!0)},c=function(e){for(var t=e.getPrimitiveSetList(),i=t.length,r=!1,n=!1,l=!1,c=void 0!==e.getVertexAttributeList().Normal,h=0;h<i;++h){var d=t[h].getMode();0!==t[h].getCount()&&(r||(r=d===o.primitiveSet.POINTS),l||(l=-1!==s.indexOf(d)),n||(n=-1!==u.indexOf(d)))}a.a.hasPoints||(a.a.hasPoints=r),a.a.hasTriangles||(a.a.hasTriangles=l),a.a.hasLines||(a.a.hasLines=n),a.a.hasVertexNormals||(a.a.hasVertexNormals=c),e.userDataMap.hasPoints=r,e.userDataMap.hasTriangles=l,e.userDataMap.hasLines=n},h=function(){for(var e in a.a.instanceIDGeometryMap){var t=a.a.instanceIDGeometryMap[e];if(!t.userDataMap.wireframe){var i=t.getVertexAttributeList().Color;i&&l(t,i),c(t)}}a.a.instanceIDGeometryMap={}};t.a=h},function(e,t,i){"use strict";var r=i(5),a=r.a.osg,n=function(){a.ComputeBoundsVisitor.call(this),this._minBox=new a.BoundingBox,this._visitedBuffers={}};a.createPrototypeObject(n,a.objectInherit(a.ComputeBoundsVisitor.prototype,{getPreciseBox:function(){return this._minBox},apply:function(e){if(e instanceof a.Transform)return void this.applyTransform(e);if(e instanceof a.Geometry){var t=this._matrixStack.getLength(),i=t>0?this._matrixStack.back():a.mat4.IDENTITY,r=e.getVertexAttributeList().Vertex,n=this._visitedBuffers[r.getInstanceID()];if(n&&a.mat4.exactEquals(n.matrix,i))return;var o=e.computeTransformedVertices?e.computeTransformedVertices():r.getElements();this._visitedBuffers[r.getInstanceID()]={buffer:o,matrix:a.mat4.copy(a.mat4.create(),i)};for(var s=i[0],u=i[1],l=i[2],c=i[3],h=i[4],d=i[5],p=i[6],f=i[7],m=i[8],g=i[9],_=i[10],v=i[11],b=i[12],y=i[13],x=i[14],S=i[15],M=1/0,w=1/0,T=1/0,C=-1/0,E=-1/0,L=-1/0,P=0,A=o.length;P<A;P+=3){var D=o[P],O=o[P+1],k=o[P+2],R=c*D+f*O+v*k+S||1,I=(s*D+h*O+m*k+b)/R,F=(u*D+d*O+g*k+y)/R,N=(l*D+p*O+_*k+x)/R;I<M&&(M=I),F<w&&(w=F),N<T&&(T=N),I>C&&(C=I),F>E&&(E=F),N>L&&(L=N)}var V=this._minBox.getMin(),B=this._minBox.getMax();return M<V[0]&&(V[0]=M),w<V[1]&&(V[1]=w),T<V[2]&&(V[2]=T),C>B[0]&&(B[0]=C),E>B[1]&&(B[1]=E),void(L>B[2]&&(B[2]=L))}this.traverse(e)}})),t.a=n},function(e,t,i){"use strict";var r=i(5),a=i(554),n=i(16),o=r.a.osg,s={},u=function(e){for(var t=o.vec3.create(),i=0,r=e.length;i<r;i+=3)if(e[i]===e[i]&&e[i+1]===e[i+1]&&e[i+2]===e[i+2]){t[0]=e[i],t[1]=e[i+1],t[2]=e[i+2];break}return t},l=function(e){var t=e.getVertexAttributeList(),i=t.Vertex;if(void 0!==i.processedNaN)return i.processedNaN;i.processedNaN=!1;for(var r,a=i.getInstanceID(),n=i.getElements(),o=0,l=n.length;o<l;o+=3)n[o]===n[o]&&n[o+1]===n[o+1]&&n[o+2]===n[o+2]||(i.processedNaN=!0,r||(r=u(n)),n[o]=r[0],n[o+1]=r[1],n[o+2]=r[2],s[a]||(s[a]={}),s[a][o/3]=!0);return i.processedNaN},c=function(e,t,i){e[i]||t.push(i)},h=function(e,t,i,r){e[i]||e[r]||t.push(i,r)},d=function(e,t,i,r,a){e[i]||e[r]||e[a]||t.push(i,r,a)},p=function(e){if(l(e)||Object(n.a)().forceTriangles){var t=e.getVertexAttributeList().Vertex,i=s[t.getInstanceID()]||{},r=[],a=[],u=[],p={operatorPoint:c.bind(this,i,r),operatorLine:h.bind(this,i,a),operatorTriangle:d.bind(this,i,u)};o.primitiveIndexFunctor(e,p);var f=e.getPrimitiveSetList();f.length=0;var m,g;r.length&&(g=new Uint16Array(r),m=new o.BufferArray(o.BufferArray.ELEMENT_ARRAY_BUFFER,g,1),f.push(new o.DrawElements(o.primitiveSet.POINTS,m))),a.length&&(g=new Uint16Array(a),m=new o.BufferArray(o.BufferArray.ELEMENT_ARRAY_BUFFER,g,1),f.push(new o.DrawElements(o.primitiveSet.LINES,m))),u.length&&(g=new Uint16Array(u),m=new o.BufferArray(o.BufferArray.ELEMENT_ARRAY_BUFFER,g,1),f.push(new o.DrawElements(o.primitiveSet.TRIANGLES,m)))}},f=function(e){for(var t=!1,i=0,r=e.length;i<r;++i)t=p(e[i])||t;t&&a.default.logMessage("NaN values detected in vertices!")};t.a=f},function(e,t,i){"use strict";var r=(i(1155),i(7)),a=i.n(r),n=i(5),o=i(34),s=i(8),u=i(855),l=i(37),c=i(144),h=i(16),d=n.a.osg,p=n.a.osgAnimation,f=n.a.osgWrappers,m=f.osg,g=s.a.extend({initialize:function(){s.a.prototype.initialize.apply(this,arguments);var e=this.model;e.bind("change:playing",this.onPlayingChanged,this),e.bind("change:speed",this.onSpeedChanged,this),e.bind("change:currentUID",this.onCurrentAnimationChanged,this),e.bind("seek",this.onSeek,this),this._manager=null,this._idLoop=0,this._loopEnded=!1,this._skeletons=[],this._viewer=this.options.context.getViewer(),this._firstAnimationPlayed=!1,this._animationPromises=[],this._hookBasicAnimationManager(o.a.getPolygon()),o.a.getMaterial().then(this._initAnimation.bind(this)),o.a.getModelDisplayed().then(this._resolveAllAnimations.bind(this))},_resolveAllAnimations:function(){0===this._animationPromises.length?(o.a.resolveFirstAnimation(),o.a.resolveAllAnimations()):a.a.all(this._animationPromises).then(o.a.resolveAllAnimations.bind(o.a))},_initAnimation:function(){if(!this._manager)return void o.a.getWireframeOptimized().then(o.a.resolveWireframeOptimizedSplit.bind(o.a));this.onSpeedChanged(),u.a.init(this._skeletons,this._viewer),o.a.getWireframeOptimized().then(o.a.resolveWireframeOptimizedSplit.bind(o.a))},_getHookUpdateManager:function(){var e=this,t=p.BasicAnimationManager.prototype.updateManager;return function(i){var r=e.getCurrentInstanceAnimation();return!(r&&!e._loopEnded)||(-1===this._seekTime&&this._pause||l.a.draw(),i=e._detectAnimationEnd(i,r),i=e._snapTimeOnFrame(i,r),t.call(this,i))}},_snapTimeOnFrame:function(e,t){var i=this.model.get("fps");if(i<=0)return e;var r=1/i,a=(e-t.start)%r;return a>.5*r?e+r-a:e-a},_detectAnimationEnd:function(e,t){var i=Math.max(0,e-t.start),r=i%t.duration*100/t.duration,a=Math.floor(i/t.duration);return a<=this._idLoop?(this._idLoop=a,this.model.set("progress",r),e):(this._onAnimationEnd(),t=this.getCurrentInstanceAnimation(),this._loopEnded?(e=t.duration-.01,this.model.set("progress",100)):(this._idLoop=a,e=t.start,this.model.set("progress",0)),e)},_onAnimationEnd:function(){var e=this.model.get("cycleMode");if("one"===e)return void this.model.trigger("cycleMode");for(var t,i=this.model.get("animations"),r=i.indexOf(this.getCurrentAnimation()),a="-1",n=r+1,o=i.length;n<o;++n)if((t=i.at(n))&&t.get("isEnabled")){a=t.get("uid");break}if("-1"===a&&"all"===e){var s=this.model.getFirstEnabledAnimation();a=s?s.get("uid"):"-1"}"-1"!==a?this.model.set("currentUID",a):(this.model.set("playing",!1),this._loopEnded=!0)},_debugSnapKeyFrameHook:function(){if(Object(h.a)().snapKeyframe){p.BasicAnimationManager.prototype._updateChannelsType=function(e,t,i){for(var r=0,a=t.length;r<a;r++){var n=t[r],o=n.instanceAnimation,s=o.loop,u=e-n.t;s&&o.duration>0&&(u%=o.duration),u+=o.firstKeyTime;var l=n.channel;if(u>l.start&&u<l.end){var c=l.times,h=n.key;if(u>c[h])for(;c[h+1]<u;)h++;else if(u<c[h])for(;c[h]>u;)h--;var d=c[h],p=c[h+1];u=Math.abs(u-d)<Math.abs(u-p)?d:p}i(u,n)}}}},_hookBasicAnimationManager:function(e){var t=this,i=this._animationPromises,r=this._getHookUpdateManager();this._debugSnapKeyFrameHook(),f.osgAnimation.BasicAnimationManager=function(n,s){var u=n.getJSON();return u.Animations?(m.Object(n,s),o.a.OSG_VERSION<8?a.a.resolve(s):t._manager?(d.error("More than one basicAnimationManager !"),a.a.resolve(s)):(t._manager=s,t.model.get("playing")||s.togglePause(),s.updateManager=r,e.then(function(){var e=n.getOptions();e.progress=void 0;for(var r=u.Animations.length,a=0;a<r;++a){var o=u.Animations[a],s=n.setJSON(o["osgAnimation.Animation"].UserDataContainer).readUserDataContainer(),l=c.a.convertUserDataToObject(s),h=t.model.getAnimationByUID(l.AnimationUID);if(h){e.currentAnimationUID=h.get("url");var p=n.setJSON(o).readObject();p.isRejected()?d.Notify.warn("An Animation failed on the parsing!"):(p.then(t.onAddAnimation.bind(t,a,l)),i.push(p))}}}),a.a.resolve(s))):a.a.reject(new Error)}},onAddAnimation:function(e,t,i){var r=t.AnimationUID;i.name=r,i.duration||(i.duration=2.5,i.still=!0),this._manager.addAnimations([i]),0===i.duration&&(this._manager.getAnimations()[r].duration=2.5);var a=this.model;a.trigger("change:animations");var n=a.getAnimationByUID(r);n.on("change:isLoop",this.onAnimationChangeLoop.bind(this)),n.get("isLoop")&&this.onAnimationChangeLoop(n),this.model.get("currentUID")===r&&this.onCurrentAnimationChanged(),this._firstAnimationPlayed||(this._playFirstAnimation(r)&&(this._firstAnimationPlayed=!0,this.model.set("currentUID",r)),o.a.getModelDisplayed().then(o.a.resolveFirstAnimation.bind(o.a)))},_playFirstAnimation:function(e){if(this.model.get("initializeWithRestPose"))return!1;var t=this.model.getFirstEnabledAnimation();return t&&e===t.get("uid")},onAnimationChangeLoop:function(e){var t=this._manager.getAnimations()[e.get("uid")];this._manager.setAnimationLerpEndStart(t,e.get("isLoop")?1/30:0)},onCurrentAnimationChanged:function(){this._loopEnded=!1,this._idLoop=0;var e=this._manager;if(e.stopAllAnimation(),e.resetAllStackedTransforms(),this.getCurrentAnimation()){var t=this.getCurrentInstanceAnimation();t&&(e.playAnimation(t),e.setSeekTime(t.start))}l.a.draw()},getCurrentAnimation:function(){return this.model.getCurrentAnimation()},getCurrentInstanceAnimation:function(){var e=this.getCurrentAnimation();return e?this._manager.getAnimations()[e.get("uid")]:void 0},onPlayingChanged:function(){if(this._loopEnded){this._loopEnded=!1;var e=this.model.getFirstEnabledAnimation().get("uid")||"-1";e===this.getCurrentAnimation().get("uid")?this.model.trigger("seek",0):this.model.set("currentUID",e)}this._manager.togglePause(),l.a.draw()},onSeek:function(e){var t=this.getCurrentInstanceAnimation();if(t){this._loopEnded=!1;var i=this._manager;i.setSeekTime(t.start+t.duration*(e/100)/i.getTimeFactor()),l.a.draw(),l.a.redrawShadow()}},onSpeedChanged:function(){this._manager.setTimeFactor(this.model.get("speed"))}});t.a=g},function(e,t,i){"use strict";var r=i(7),a=i.n(r),n=i(5),o=i(144),s=i(59),u=i(1156),l=i(1157),c=i(1158),h=i(853),d=i(852),p=i(851),f=n.a.osg,m=n.a.osgDB,g=n.a.osgAnimation,_=n.a.osgWrappers.osgAnimation,v=g.Channel,b=function(){},y=m.registry();y.registerObject("osgAnimation.Vec3LerpChannelCompressedPacked",b),y.registerObject("osgAnimation.Vec3LerpChannelCompressed",b),y.registerObject("osgAnimation.Vec3LerpChannelPacked",b),y.registerObject("osgAnimation.QuatSlerpChannelCompressedPacked",b),y.registerObject("osgAnimation.QuatSlerpChannelCompressed",b),y.registerObject("osgAnimation.QuatSlerpChannelPacked",b),y.registerObject("osgAnimation.FloatLerpChannelCompressedPacked",b),y.registerObject("osgAnimation.FloatLerpChannelCompressed",b),y.registerObject("osgAnimation.FloatLerpChannelPacked",b);var x={},S=(new s.default)._resourceLoader,M={quantization:1,prediction:2,delta:4,quat:8,deltaTime:16},w=function(e,t,i,r,a,n){var o,s=t.ItemSize,m=Object.keys(t.Array)[0],g=t.Array[m],_=g.Offset?g.Offset:0,v=g.Size,b=i.channel_mode||0,y=!!(1===n?b&M.deltaTime:b&M.delta),x=new ArrayBuffer(4*(y?v+2:v+1)*n),S=new Float32Array(x,y?4*n:0,v*n);return o=g.Encoding&&"varint"===g.Encoding?Object(h.a)(new Uint8Array(e,_),s*v,m):new f[m](e,_,s*v),4===n&&b&M.quat?(a&&(o=Object(u.a)(o,new Float32Array(o.length),s)),Object(p.a)(o,S,n,i.epsilon,i.nphi,!0),y&&(S=new Float32Array(x,0,(v+1)*n),S[0]=i.ox,S[1]=i.oy,S[2]=i.oz,S[3]=i.ow,Object(c.a)(S)),S):(a&&1!==n?Object(u.a)(o,S,s):S.set(o),r?(3===n&&b&M.quantization&&Object(d.a)(S,S,[i.bx,i.by,i.bz],[i.hx,i.hy,i.hz],n),y&&(S=new Float32Array(x,0,(v+1)*n),3===n?(S[0]=i.ox,S[1]=i.oy,S[2]=i.oz):S[0]=i.ot,Object(l.a)(S,s)),S):S)},T=function(e,t,i,r,n,s){var u=e.getJSON();if(!(void 0!==u.TargetName&&u.KeyFrames&&u.Name&&u.KeyFrames.Time&&u.KeyFrames.Key))return a.a.reject(new Error);var l=u.UserDataContainer,c=l?o.a.convertUserDataToObject(e.setJSON(l).readUserDataContainer()):x;return S.getBinaryArray(e.getOptions().currentAnimationUID).getPromise().then(function(e){var a=w(e,u.KeyFrames.Time,c,r,!1,1),o=w(e,u.KeyFrames.Key,c,r,n,s);return i(o,a,u.TargetName,u.Name,t),t})};_.Vec3LerpChannel=function(e,t){return T(e,t,v.createVec3Channel,!1,!1,3)},_.Vec3LerpChannelCompressedPacked=function(e,t){return T(e,t,v.createVec3Channel,!0,!0,3)},_.Vec3LerpChannelCompressed=function(e,t){return T(e,t,v.createVec3Channel,!0,!1,3)},_.Vec3LerpChannelPacked=function(e,t){return T(e,t,v.createVec3Channel,!1,!0,3)},_.QuatSlerpChannel=function(e,t){return T(e,t,v.createQuatChannel,!1,!1,4)},_.QuatSlerpChannelCompressedPacked=function(e,t){return T(e,t,v.createQuatChannel,!0,!0,4)},_.QuatSlerpChannelCompressed=function(e,t){return T(e,t,v.createQuatChannel,!0,!1,4)},_.QuatSlerpChannelPacked=function(e,t){return T(e,t,v.createQuatChannel,!1,!0,4)},_.FloatLerpChannel=function(e,t){return T(e,t,v.createFloatChannel,!1,!1,1)},_.FloatLerpChannelCompressedPacked=function(e,t){return T(e,t,v.createFloatChannel,!0,!0,1)},_.FloatLerpChannelCompressed=function(e,t){return T(e,t,v.createFloatChannel,!0,!1,1)},_.FloatLerpChannelPacked=function(e,t){return T(e,t,v.createFloatChannel,!1,!0,1)}},function(e,t,i){"use strict";var r=function(e,t,i){for(var r=e.length/i,a=0;a<r;++a)for(var n=a*i,o=0;o<i;++o)t[n+o]=e[a+r*o];return t};t.a=r},function(e,t,i){"use strict";var r=function(e,t){for(var i=t||1,r=1,a=e.length/i;r<a;++r)for(var n=(r-1)*i,o=r*i,s=0;s<i;++s)e[o+s]+=e[n+s];return e};t.a=r},function(e,t,i){"use strict";var r=function(e){for(var t=1,i=e.length/4;t<i;++t){var r=4*(t-1),a=4*t,n=e[r],o=e[r+1],s=e[r+2],u=e[r+3],l=e[a],c=e[a+1],h=e[a+2],d=e[a+3];e[a]=n*d+o*h-s*c+u*l,e[a+1]=-n*h+o*d+s*l+u*c,e[a+2]=n*c-o*l+s*d+u*h,e[a+3]=-n*l-o*c-s*h+u*d}return e};t.a=r},function(e,t,i){"use strict";var r=i(62),a=i(1160),n=i(1161),o={FeatureName:"camera",ModelType:a.a,ViewListType:[n.a]},s=r.a.create(o);s.prototype.getManipulator=function(){return this._views[0]._switchManipulator},s.prototype.canMoveTarget=function(){return this._views[0].canMoveTarget()},s.prototype.getNode=function(){return this._views[0].getNode()},s.prototype.getWidgetNode=function(){return this._views[0].getWidgetNode()},t.a=s},function(e,t,i){"use strict";var r=i(5),a=i(120),n=i(16),o=i(7),s=i.n(o),u=i(79),l=i(0),c=(i.n(l),r.a.osg),h=Math.PI/2,d=a.a.extend({getModelOptionPath:function(){return"camera"},defaults:{webVR:!1,indexManipulator:"fps"===Object(n.a)().navigation?1:0,node:void 0,eyeCamera:c.vec3.create(),targetCamera:c.vec3.create(),minSpeed:.1,displayGizmo:!1,animationEye:c.vec3.create(),animationTarget:c.vec3.create(),animationDuration:1,enableCameraConstraints:!0,offset:0,angle:2*Math.PI},getName:function(){return"Camera"},setTargetAndEye:function(e,t,i){return this.set("animationTarget",e),this.set("animationEye",t),this.trigger("setTargetAndEye",i)},init:function(e){this._viewer=e.getViewer();var t=e.getModel().get("options"),i=t.camera;this.set("enableCameraConstraints",Object(n.a)().cameraConstraints);var r=this._getUrlOptions(),a=Object(l.merge)(i,r);this.setJSON(a),this.yawLeftRightToAngleOffset(),this.on("change:zoomIn",this.checkOverLap.bind(this,"zoomOut","zoomIn","zoomOut")),this.on("change:zoomOut",this.checkOverLap.bind(this,"zoomOut","zoomIn","zoomIn")),this.on("change:up",this.checkOverLap.bind(this,"up","down","down")),this.on("change:down",this.checkOverLap.bind(this,"up","down","up")),this.on("change:offset",this.yawAngleOffsetToLeftRight.bind(this)),this.on("change:angle",this.yawAngleOffsetToLeftRight.bind(this))},shouldPlayFirstCameraAnimation:function(){return!0===Object(n.a)().camera&&!this.get("useCameraConstraints")},initAfterFirstFrame:function(){var e=Math.floor(20*u.a.getModelBoxWithoutDisplacement().radius());-1===this.get("zoomOut")&&this.set("zoomOut",e),-1===this.get("zoomIn")&&this.set("zoomIn",e),this.set("maxZoom",e),this.trigger("uiReady")},_getUrlOptions:function(){var e={usePanConstraints:Object(n.a)().orbitConstraintPan,zoomIn:Object(n.a)().orbitConstraintZoomIn,zoomOut:Object(n.a)().orbitConstraintZoomOut,left:Object(n.a)().orbitConstraintYawLeft,right:Object(n.a)().orbitConstraintYawRight,up:Object(n.a)().orbitConstraintPitchUp,down:Object(n.a)().orbitConstraintPitchDown};return e.useZoomConstraints=void 0!==e.zoomOut||void 0!==e.zoomIn||void 0,e.useYawConstraints=void 0!==e.left||void 0!==e.right||void 0,e.usePitchConstraints=void 0!==e.up||void 0!==e.down||void 0,e.useCameraConstraints=e.useZoomConstraints||e.useYawConstraints||e.usePitchConstraints||e.usePanConstraints,e},getCameraPosition:function(e,t){var i=this._viewer.getFeaturesManager();if(i&&(i.getCameraWithoutAutospin(e,t),0!==this.get("indexManipulator")&&this.get("node"))){var r=this.get("node").getMinimumBound(),a=c.vec3.dist(e,r.center()),n=Math.max(.1*r.radius(),a);c.vec3.sub(t,t,e),c.vec3.normalize(t,t),c.vec3.scale(t,t,n),c.vec3.add(t,e,t)}},saveCameraPosition:function(){if(this.get("useCameraConstraints")&&!this.get("enableCameraConstraints"))return void this.getCameraPosition(this.get("eyeCamera"),c.vec3.create());this.getCameraPosition(this.get("eyeCamera"),this.get("targetCamera"))},validateEyeTarget:function(e,t){var i=c.vec3.dist(e,t);if(i<=1e-8)return!1;var r=this.get("node").getMinimumBound().radius();return i<=.001*r&&(c.vec3.sub(t,t,e),c.vec3.scale(t,t,.01*r/i),c.vec3.add(t,e,t)),!0},setJSON:function(e){a.a.prototype.setJSON.call(this,e,{ignore:["position","target"]}),e.position&&this.get("eyeCamera").set(e.position),e.target&&this.get("targetCamera").set(e.target)},getJSON:function(){var e=a.a.prototype.getJSON.call(this);return e.position=c.vec3.copy(c.vec3.create(),this.get("eyeCamera")),e.target=c.vec3.copy(c.vec3.create(),this.get("targetCamera")),e},editorGetJSON:function(){return this.getJSON()},editorSetJSON:function(e){var t={validate:!0},i=this.setJSON(e,t);return i||s.a.resolve(!0)},range:function(e){return"["+e.min+", "+e.max+"]"},limits:function(){return{zoomIn:{min:0,max:this.get("maxZoom")},zoomOut:{min:0,max:this.get("maxZoom")},offset:{min:0,max:2*Math.PI},angle:{min:0,max:2*Math.PI},up:{min:-h,max:h},down:{min:-h,max:h},fov:{min:1,max:179},nearFarRatio:{min:1e-4,max:.005}}},yawAngleOffsetToLeftRight:function(){var e=this.get("offset"),t=this.get("angle"),i=e-t/2,r=0;t===2*Math.PI&&(r=-.001);var a=e+t/2+r;i>=Math.PI&&(i-=2*Math.PI),a>=Math.PI&&(a-=2*Math.PI),this.set("left",i),this.set("right",a)},yawLeftRightToAngleOffset:function(){var e=this.get("left"),t=this.get("right"),i=t-e;i<0&&(i+=2*Math.PI);var r=e+i/2;r<0&&(r+=2*Math.PI),this.set("angle",i),this.set("offset",r)},checkOverLap:function(e,t,i){var r=this.get(e),a=this.get(t);a>r&&this.set(i,i===e?a:r)}});t.a=d},function(e,t,i){"use strict";var r=i(8),a=i(608),n=i(1164),o=i(34),s=i(47),u=i(118),l=i(37),c=i(5),h=i(43),d=i(1187),p=c.a.osg,f=c.a.InputGroups,m=Math.PI/180,g=r.a.extend({initialize:function(){r.a.prototype.initialize.apply(this,arguments);var e=this.model;if(e.bind("change:indexManipulator",this.onIndexManipulatorChanged,this),e.bind("change:node",this.onNodeChanged,this),e.bind("change:minSpeed",this.onNodeChanged,this),e.bind("change:webVR",this.setVR,this),e.bind("change:fov",this.onFov,this),e.bind("change:nearFarRatio",this.onNearFarRatio,this),e.bind("change:animationDuration",this.onDurationChanged,this),e.bind("setTargetAndEye",this.onTargetAndEyeChanged,this),e.bind("change:useCameraConstraints",this._onUseCamConstrainsToggle,this),e.bind("change:usePanConstraints",this.refreshConstraints,this),e.bind("change:useZoomConstraints",this.refreshConstraints,this),e.bind("change:zoomIn",this.refreshConstraints,this),e.bind("change:zoomOut",this.refreshConstraints,this),e.bind("change:usePitchConstraints",this.refreshConstraints,this),e.bind("change:right",this.refreshConstraints,this),e.bind("change:useYawConstraints",this.refreshConstraints,this),e.bind("change:up",this.refreshConstraints,this),e.bind("change:down",this.refreshConstraints,this),e.bind("targetCameraChanged",this.onTargetCameraChanged,this),e.bind("refreshConstraints",this.refreshConstraints,this),e.bind("saveZoomIn",this._saveZoom.bind(this,"zoomIn")),e.bind("saveZoomOut",this._saveZoom.bind(this,"zoomOut")),e.bind("change:displayGizmo",this._updateGizmoDisplay.bind(this)),this._viewer=this.options.context.getViewer(),this._viewerOSGJS=this._viewer.getViewerOSGJS(),this._switchManipulator=new a.a(this._viewer.getInputManager(),this.cameraMove.bind(this)),this._viewerOSGJS.setupManipulator(this._switchManipulator),this._featureNode=new p.Node("Camera"),this._callbackCameraAnimation=new d.a(this._switchManipulator,e.get("animationDuration"),this.cameraMove.bind(this)),this._featureNode.addUpdateCallback(this._callbackCameraAnimation),this.model.bind("change:enableCameraConstraints",this.focusOnTarget,this),this.onIndexManipulatorChanged(),this._dolly=!1,this.onFov(),this.onNearFarRatio(),this._dolly=!0,o.a.getFirstCameraAnimation().then(function(){!e.get("webVR")&&this.model.get("useCameraConstraints")&&(this._updateGizmoDisplay(),this.focusOnTarget(),this._switchManipulator.getOrbitManipulator().enableRecenter(!this.model.get("useCameraConstraints")),this.initFeatureBridge())}.bind(this)),!Object(u.a)()){this._cameraIdle=!0;var t=l.a.getFrameTimeAverage();this.cameraIdleNessDetectBinded=this.cameraIdleNessDetect.bind(this),this.timer=window.setTimeout(this.cameraIdleNessDetectBinded,t)}},initFeatureBridge:function(){this.model._viewer.getFeatures().inspector.getModel().bind("change:uiVisible",this._onInspectorVisiblilityChange.bind(this))},_onInspectorVisiblilityChange:function(e){var t=e.get("uiVisible");this.model.set("enableCameraConstraints",!t)},setVR:function(){var e=this._viewerOSGJS.getManipulator(),t=this.model.get("webVR");e.setDelay(t?1:.15);var i=this._viewerOSGJS.getInputManager();if(this._viewerOSGJS.requestContinuousUpdate(!0),t){this.lastMode=this.model.get("indexManipulator");var r=this._viewerOSGJS.getVRDisplay(),n=!!r,o=!n;if(!o){var s=r.displayName.toLowerCase();-1===s.indexOf("cardboard")&&-1===s.indexOf("samsung")||(o=!0)}i.setEnable(f.FPS_MANIPULATOR_TOUCH,!1),i.setEnable(f.FPS_MANIPULATOR_WEBVR,n),i.setEnable(f.FPS_MANIPULATOR_DEVICEORIENTATION,!n),this.model.set("indexManipulator",a.a.FPS)}else i.setEnable(f.FPS_MANIPULATOR_TOUCH,!0),i.setEnable(f.FPS_MANIPULATOR_WEBVR,!1),i.setEnable(f.FPS_MANIPULATOR_DEVICEORIENTATION,!1),void 0!==this.lastMode&&this.model.set("indexManipulator",this.lastMode);var u=this._viewer.getFeatures();!u||u.webVR&&u.webVR.getModel().get("modeLauncher")||e.computeHomePosition()},onDurationChanged:function(){this._callbackCameraAnimation.setDuration(this.model.get("animationDuration"))},onTargetAndEyeChanged:function(e){this._callbackCameraAnimation.setTargetAndEye(this.model.get("animationTarget"),this.model.get("animationEye"),e)},canMoveTarget:function(){return this.model.get("indexManipulator")===a.a.FPS||!this._switchManipulator.getOrbitManipulator().isConstrainPan()},onFov:function(){var e=this._viewer.getCamera(),t=e.getViewport(),i=t.width()/t.height();if(p.mat4.perspective(e.getProjectionMatrix(),this.model.get("fov")*m,i,1,1e3),this._dolly){var r=this.options.context.getViewer().getViewerOSGJS().getManipulator(),a=r.getCurrentManipulator();if(a){var n=a.getHomeBoundingSphere();n&&r.setDistance(a.getHomeDistance(n))}}this.model.saveCameraPosition(),l.a.draw()},onNearFarRatio:function(){this.model.set("minSpeed",15*this.model.get("nearFarRatio")),l.a.draw()},getNode:function(){return this._featureNode},getWidgetNode:function(){return this._widgetNode||(this._widgetNode=new p.Node,this._widgetNode.setNodeMask(0)),this._widgetNode},onIndexManipulatorChanged:function(){this._switchManipulator.setManipulatorIndex(this.model.get("indexManipulator"))},onNodeChanged:function(){if(this._dolly){var e=this._switchManipulator;e.setNode(this.model.get("node"));var t=e.getOrbitManipulator(),i=this._switchManipulator.getHomeBoundingSphere().radius();t.setMinSpeed(this.model.get("minSpeed")*i),this.refreshConstraints()}},focusOnTarget:function(){this.model.get("enableCameraConstraints")&&this.lookatTarget(),this.refreshConstraints()},lookatTarget:function(){var e=p.vec3.create();return function(){this._switchManipulator.getOrbitManipulator().getEyePosition(e),this._viewer.getFeaturesManager().focusOnTargetAndEye(this.model.get("targetCamera"),e,.3,!0)}}(),onTargetCameraChanged:function(){this.model.get("usePanConstraints")&&this.model.get("enableCameraConstraints")&&this.focusOnTarget()},_initGizmo:function(){this._widgetNode=new p.Camera,this._widgetNode.setName("Camera - Constraints - Widgets"),this._featureNode.addChild(this._widgetNode),this._widgetNode.setNearFarRatio(5e-5),this._widgetNode.setNodeMask(h.a.NO_SHADOW),this._gizmo=new n.a(this._switchManipulator.getOrbitManipulator(),this.model),this._widgetNode.addChild(this._gizmo),this._widgetNode.addUpdateCallback(this)},_updateGizmoDisplay:function(){if(o.a.getFirstCameraAnimation().isFulfilled()){var e=this.model.get("displayGizmo");!this._gizmo&&e&&(this._initGizmo(),this.refreshConstraints(),Object(s.a)()&&this._gizmo.setPivotSelected(this.model.get("useCameraConstraints"))),this._gizmo&&this._gizmo.setVisible(e)}},_onUseCamConstrainsToggle:function(){var e=this.model.get("useCameraConstraints");this._gizmo&&this._gizmo.setPivotSelected(e),this.refreshConstraints(),this._switchManipulator.getOrbitManipulator().enableRecenter(!e)},refreshConstraints:function(){o.a.getFirstCameraAnimation().isFulfilled()&&this.applyConstraints()},applyConstraints:function(){if(!this._hasHotSpots()){var e=this.model,t=e.getInstance();e.get("enableCameraConstraints")&&this._applyModel(t);var i=this._switchManipulator.getOrbitManipulator();i.setLimitYawLeft(t.left),i.setLimitYawRight(t.right),i.setConstrainYaw(t.useYawConstraints);var r=.5*Math.PI*.99;i.setLimitPitchDown(Math.min(r,Math.max(-r,t.down))),i.setLimitPitchUp(Math.min(r,Math.max(-r,t.up))),i.setConstrainPitch(t.usePitchConstraints),-1===t.zoomOut&&(t.zoomOut=1/0),i.setLimitZoomOut(t.zoomOut),i.setConstrainZoom(t.useZoomConstraints);var a=!(t.usePanConstraints&&e.get("enableCameraConstraints"));if(t.zoomIn>0)i.setLimitZoomIn(t.zoomIn);else{var n=this._switchManipulator.getHomeBoundingSphere().radius();i.setLimitZoomIn(.001*n)}i.setAutoPushTarget(a&&!t.useZoomConstraints),i.setConstrainPan(!a),i.setPanConstraintTarget(e.get("targetCamera")),this._gizmo&&(this._gizmo.updateConstraints(),a||this.lookatTarget()),l.a.draw()}},update:function(){if(this._hasHotSpots())return!1;var e=this._viewer.getOptions().widgetAPI,t=e&&e.getTabbedWidget().get();return this.model.get("displayGizmo")&&this._gizmo.update(this._viewer.getCamera()),"scene"===t?this._currentTab!==t&&this.model.trigger("TabEnter"):this._currentTab!==t&&(this.model.trigger("TabLeave"),this.model.set("displayGizmo",!1)),this._currentTab=t,!0},_hasHotSpots:function(){var e=this._viewer.getFeatures().hotspot.getModel(),t=e.get("hotspots").length&&e.get("visible");return t&&this.model.get("useCameraConstraints")&&(this.model.set("useCameraConstraints",!1),Object(s.a)()&&this.model.trigger("ForceDisable")),t},_applyModel:function(e){var t=this.model;t.get("useCameraConstraints")&&(e.useCameraConstraints=!0,e.usePanConstraints=t.get("usePanConstraints"),e.useZoomConstraints=t.get("useZoomConstraints"),e.useZoomConstraints&&(e.zoomIn=t.get("zoomIn"),e.zoomOut=t.get("zoomOut")),e.useYawConstraints=t.get("useYawConstraints"),e.useYawConstraints&&(e.left=t.get("left"),e.right=t.get("right")),e.usePitchConstraints=t.get("usePitchConstraints"),e.usePitchConstraints&&(e.up=t.get("up"),e.down=t.get("down")))},_saveZoom:function(e){var t=this.model.limits(),i=p.clamp(this._switchManipulator.getOrbitManipulator().getDistance(),t[e].min,t[e].max);this.model.set(e,i)},cameraMove:function(e){e&&l.a.draw(),this._cameraMoved=p.Timer.instance().tick(),this._cameraIdle&&(this._viewer.trigger("cameraStart"),this._cameraIdle=!1)},cameraIdleNessDetect:function(){var e=2*l.a.getFrameTimeAverage();this.timer=window.setTimeout(this.cameraIdleNessDetectBinded,e),p.Timer.instance().tick()-this._cameraMoved-e<=e||this._cameraIdle||(this._viewer.trigger("cameraStop"),this._cameraIdle=!0)}});t.a=g},function(e,t,i){"use strict";var r=i(5),a=i(16),n=r.a.osg,o=r.a.osgGA,s=function(e){o.FirstPersonManipulator.call(this,e);var t=Math.max(0,Math.min(4,Object(a.a)().fpsSpeed/25));this._stepFactor=t,this.getControllerList().StandardMouseKeyboard._stepFactor=t,this._postMultRotate=n.quat.create(),this._resetInitialVR=!1,this._lookPosition._delay=.25};n.createPrototypeObject(s,n.objectInherit(o.FirstPersonManipulator.prototype,{getPostMultRotate:function(){return this._postMultRotate},setResetInitialRotationVR:function(e){this._resetInitialVR=e,e||n.quat.identity(this._postMultRotate)},setNode:function(e){o.FirstPersonManipulator.prototype.setNode.call(this,e);var t=this.getHomeBoundingSphere();t&&t.valid()&&(this._distance=this.getHomeDistance(t))},setInitialPoseVR:function(){var e=n.quat.create(),t=n.mat4.create(),i=n.vec3.fromValues(0,0,1);return function(r,a){n.mat4.lookAt(t,r,a,i),n.mat4.invert(t,t),n.mat4.getRotation(e,t),e[1]=e[0]=0,n.quat.normalize(e,e),n.quat.copy(this._postMultRotate,e),this.setEyePosition(r),this.setTarget(a),this.setResetInitialRotationVR(!0)}}(),setPoseVR:function(){var e=n.vec3.create();return function(t,i){this._resetInitialVR&&(n.quat.invert(this._vrRot,t),this._vrRot[0]=this._vrRot[1]=0,n.quat.normalize(this._vrRot,this._vrRot),n.quat.multiply(this._postMultRotate,this._vrRot,this._postMultRotate)),n.quat.multiply(this._vrRot,this._postMultRotate,t),n.vec3.transformQuat(e,i,this._postMultRotate),this._resetInitialVR?(n.vec3.set(this._vrTrans,0,0,0),this._resetInitialVR=!1):n.vec3.sub(this._vrTrans,e,this._vrPos),n.vec3.copy(this._vrPos,e),this._vrEnable=!0}}()}),"osgSketchfab","FirstPersonManipulator"),t.a=s},function(e,t,i){"use strict";var r=i(5),a=.5*Math.PI*.99,n=r.a.osg,o=r.a.osgGA,s=function(e){o.OrbitManipulator.call(this,e),this.setLimitPitchUp(a),this.setLimitPitchDown(-a),this._enableRecenter=!0,this._zoomEMA=0,this._pitchEMA=0,this._yawEMA=0,this._panVEMA=0,this._panHEMA=0,this._constrainPan=!1,this._constrainPitch=!1,this._constrainYaw=!1,this._constrainZoom=!1,this._constrainedTarget=n.vec3.create()};n.createPrototypeObject(s,n.objectInherit(o.OrbitManipulator.prototype,{setEyePosition:function(){var e=n.vec3.create(),t=n.vec3.create(),i=n.vec3.create();return function(r,a){var o=this._rotation,s=this._target;if(n.vec3.sub(e,r,s),n.vec3.normalize(e,e),a){var u=n.vec3.dot(e,this._upz);if(Math.abs(u)>.99){var l=Math.sqrt((1-.9801)/(e[0]*e[0]+e[1]*e[1]));e[0]*=l,e[1]*=l,e[2]=.99*Math.sign(u)}}n.vec3.cross(t,e,this._upz),n.vec3.normalize(t,t),n.vec3.cross(i,t,e),n.vec3.normalize(i,i),o[0]=t[0],o[1]=e[0],o[2]=i[0],o[3]=0,o[4]=t[1],o[5]=e[1],o[6]=i[1],o[7]=0,o[8]=t[2],o[9]=e[2],o[10]=i[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,this._distance=n.vec3.dist(s,r)}}(),enableRecenter:function(e){this._enableRecenter=e},computeHomePosition:function(e){this._enableRecenter&&o.OrbitManipulator.prototype.computeHomePosition.call(this,e)},_computeEMA:function(e,t){return 0===t?e:.2*e+.8*t},_getLimitReached:function(e,t,i){return Math.abs(e-i)<.001?i:Math.abs(e-t)<.001?t:void 0},computeZoom:function(e){if(o.OrbitManipulator.prototype.computeZoom.call(this,e),this._constrainZoom){e-=1;var t=1;e<0&&(e=-e,t=-1);var i=this.getSpeedFactor()*e,r=this._getLimitReached(this.getDistance(),this._limitZoomIn,this._limitZoomOut);void 0!==r&&(void 0===this._prevDistance&&(this._prevDistance=r),i=i/(1+i)*(.1*this.getDistance()),this._zoomEMA=this._computeEMA(i,this._zoomEMA),t<0&&this._prevDistance>r||t>0&&this._prevDistance<r?this._distance=this._prevDistance+this.getSpeedFactor()*e*t:this._distance=r+this._zoomEMA*t),this._prevDistance=this._distance}},_computePitch:function(e,t){var i;if(e=void 0!==this._previousPitch?this._previousPitch:e,i=o.OrbitManipulator.prototype._computePitch.call(this,e,t),!this._constrainPitch||0===t)return this._previousPitch=void 0,i;this._previousPitch=i;var r=t/10;r=r/(1+r)*.5;var n=this._getLimitReached(i,this._limitPitchUp,this._limitPitchDown);return void 0!==n&&(this._pitchEMA=this._computeEMA(r,this._pitchEMA),i=n+this._pitchEMA),Math.max(Math.min(i,a),-a)},_computeYaw:function(e,t){var i;if(e=void 0!==this._previousYaw?this._previousYaw:e,i=o.OrbitManipulator.prototype._computeYaw.call(this,e,t),!this._constrainYaw||0===t)return this._previousYaw=void 0,i;this._previousYaw=i;var r=t/10;r=r/(1+r)*3;var a=this._getLimitReached(i,this._limitYawLeft,this._limitYawRight);return void 0!==a&&(this._yawEMA=this._computeEMA(r,this._yawEMA),i=a+this._yawEMA),i},computePan:function(e,t){!this._constrainPan||0===e&&0===t||(this._panVEMA=this._computeEMA(e/(1+e)*.5,this._panVEMA),this._panHEMA=this._computeEMA(t/(1+t)*.5,this._panHEMA),e=this._panVEMA,t=this._panHEMA,n.vec3.copy(this._target,this._constrainedTarget)),o.OrbitManipulator.prototype.computePan.call(this,e,t)},setConstrainPan:function(e){this._constrainPan=e},setPanConstraintTarget:function(e){n.vec3.copy(this._constrainedTarget,e)},isConstrainPan:function(){return this._constrainPan},setConstrainPitch:function(e){this._constrainPitch=e,this._previousPitch=void 0},isConstrainPitch:function(){return this._constrainPitch},setConstrainYaw:function(e){this._constrainYaw=e,this._previousYaw=void 0},isConstrainYaw:function(){return this._constrainYaw},setConstrainZoom:function(e){this._constrainZoom=e},isConstrainZoom:function(){return this._constrainZoom}}),"osgSketchfab","OrbitManipulator"),t.a=s},function(e,t,i){"use strict";var r=i(5),a=i(43),n=i(107),o=i(1176),s=i.n(o),u=i(1177),l=i.n(u),c=i(57),h=i(59),d=i(37),p=i(609),f=i(445),m=i(119),g=i(63),_=i(145),v=r.a.osg,b=r.a.osgUtil,y=r.a.InputGroups,x=v.vec4.fromValues(.309375,.8640625,1,1),S=v.vec4.fromValues(1,1,0,1),M=v.vec3.fromValues(-1,0,0),w=v.vec3.fromValues(.05,.05,.05),T=2*Math.PI,C=g.a.BLEND_SUBSTRACTIVE,E=g.a.DEPTH_DISABLE,L=v.StateAttribute.ON,P=function(e,t){return(e%t+t)%t},A=function(e,t){v.MatrixTransform.call(this),this.setName("Camera - Constraints Gizmo"),this._manipulator=e,this._model=t,this._circleGeom=b.GizmoGeometry.createCircleGeometry(128,1,2.015*Math.PI),this._arcGeom=b.GizmoGeometry.createCircleGeometry(64,1,1.015*Math.PI),this._pivotNode=new v.MatrixTransform,this._arcNode=new v.MatrixTransform,this._circleNode=new v.MatrixTransform,this._circleNode.setName("Camera - Constraints Gizmo - circleNode"),this._pivotNode.addChild(this._arcNode),this._pivotNode.addChild(this._circleNode),this._arcCenter=this._makeArc(this._arcGeom),this._arcLeft=this._makeArc(this._arcGeom,-Math.PI),this._arcRight=this._makeArc(this._arcGeom,Math.PI),this._arcHalfLeft=this._makeArc(this._arcGeom,.5*-Math.PI),this._arcHalfRight=this._makeArc(this._arcGeom,.5*Math.PI),this._circleCenter=this._makeCircle(),this._circleUp=this._makeCircle(),this._circleDown=this._makeCircle(),this._pivotNode.editMask=b.NodeGizmo.PICK_ARROW|b.NodeGizmo.PICK_PLANE,this.addChild(this._pivotNode),this.setGizmoStateset(x),this._makeCenter(),this._geomHandle=new v.createTexturedBoxGeometry(0,0,0,.02,.02,.02),this._handleCenter=this._makeHandle("handleCenter"),this._handleUp=this._makeHandle("handleUp"),this._handleDown=this._makeHandle("handleDown"),this._handleLeft=this._makeHandle("handleLeft"),this._handleRight=this._makeHandle("handleRight"),this._startCoord=v.vec2.create(),_.a.initCamera(this),this.setVisible(!1)};A.prototype=v.objectInherit(v.MatrixTransform.prototype,{_makeArc:function(e,t){var i=new v.MatrixTransform,r=new v.MatrixTransform;return r.addChild(e),v.mat4.fromRotation(r.getMatrix(),.5*-Math.PI,v.vec3.fromValues(0,1,0)),t&&v.mat4.fromZRotation(i.getMatrix(),t),i.addChild(r),this._arcNode.addChild(i),i},_makeCircle:function(){var e=new v.MatrixTransform;return this._circleNode.addChild(e),e.addChild(this._circleGeom),e},_makeCenter:function(){this._centerNode=new v.MatrixTransform,this._pivotNode.addChild(this._centerNode);var e=this._centerNode.getOrCreateStateSet(),t=n.a.getOrCreateShader(s.a,l.a,"icon","CamConstraintsIcon","ICON");e.setAttributeAndModes(t),this._centerIcon=this._addIcon(this._centerNode,p.a.iconCamCenter,"center")},_makeHandle:function(e){var t=new v.MatrixTransform;t.setName(e),t.setNodeMask(-1),t.addChild(this._geomHandle),v.mat4.fromTranslation(t.getMatrix(),M);var i=t.getOrCreateStateSet();return this._setupColorAndAlpha(x,1,i),i.addUniform(v.Uniform.createFloat(1,"uUp")),i.addUniform(v.Uniform.createFloat(-1,"uDown")),this._circleNode.addChild(t),t},_getIconGeom:function(){return this._quadGeom||(this._quadGeom=v.createTexturedQuadGeometry(-.5,-.5,0,1,0,0,0,1,0),this._quadGeom.setNodeMask(-1),this._quadGeom.setName("iconGeom")),this._quadGeom},_addIcon:function(e,t,i){var r=new v.MatrixTransform;r.addChild(this._getIconGeom()),r.setName(i+"Icon"),e.addChild(r);var a=h.default.instance.getOrCreateTexture(t,{internalFormat:v.Texture.RGBA}),n=r.getOrCreateStateSet();return n.setTextureAttributeAndModes(0,a.texture,L),n.addUniform(v.Uniform.createInt(0,"uTextureIcon")),this._setupColorAndAlpha(x,1,n),r},_getGizmo:function(){var e=this._model._viewer.getFeaturesManager();return e?e.getNodeGizmo():null},setPivotSelected:function(e){this._getGizmo().attachToNode(e?this._centerNode:void 0)},setGizmoStateset:function(e){this._circleGeom.getOrCreateStateSet().removeAttribute("Program"),this._arcGeom.getOrCreateStateSet().removeAttribute("Program");var t=this._pivotNode.getOrCreateStateSet();t.setRenderBinDetails(c.a.EDITOR_GIZMO,"RenderBin"),t.setAttributeAndModes(n.a.getOrCreateShader(s.a,l.a,"gizmo","CamConstraintsGizmo"),L),t.setAttributeAndModes(C,L),t.setAttributeAndModes(E,L),this._setupColorAndAlpha(e,.4,t),this._setupColorAndAlpha(e,1,this._circleDown.getOrCreateStateSet()),this._setupColorAndAlpha(e,1,this._circleUp.getOrCreateStateSet()),this._setupColorAndAlpha(e,1,this._arcLeft.getOrCreateStateSet()),this._setupColorAndAlpha(e,1,this._arcRight.getOrCreateStateSet());var i=this._arcNode.getOrCreateStateSet();this._uUp=v.Uniform.createFloat(1,"uUp"),i.addUniform(this._uUp),this._uDown=v.Uniform.createFloat(-1,"uDown"),i.addUniform(this._uDown);var r=this._circleNode.getOrCreateStateSet();this._uHUp=v.Uniform.createFloat(1,"uUp"),r.addUniform(this._uHUp),r.addUniform(v.Uniform.createFloat(-1,"uDown"))},_setupColorAndAlpha:function(e,t,i){i.addUniform(v.Uniform.createFloat4(e,"uColor")),i.addUniform(v.Uniform.createFloat(t,"uAlpha"))},setVisible:function(e){this.setNodeMask(e?a.a.NO_SHADOW:0),e?this._manipulator.getInputManager().setEnable(y.CAMERA_GIZMO,!0):this._manipulator.getInputManager().setEnable(y.CAMERA_GIZMO,!1)},motion:function(){var e=v.vec2.create();return function(t){if(v.vec2.set(e,t.canvasX,t.canvasY),this._dragging)return void this._onDrag(e);if(m.a.isInitialized()){var i=m.a.computeNearestIntersection2D(e[0],e[1],a.a.PICK,this);if(!i)return void this._onHover();var r=i._nodePath.length,n=i._nodePath[r-1];if(n===this._getIconGeom()||n===this._geomHandle){var o=i._nodePath[r-2];this._onHover(o)}}}}(),_onDrag:function(){var e=v.vec3.create(),t=v.vec3.create();return function(i){var r=this._model._viewer.getCanvas(),a=r.height,n=this._model.get("usePitchConstraints"),o=this._model.get("useYawConstraints");if(n){var s=(this._startCoord[1]-i[1])/a*2;if(this._dragging===this._handleUp)return void this._model.set("up",Math.asin(v.clamp(this._startModel.up+s,-1,1)));if(this._dragging===this._handleDown)return void this._model.set("down",Math.asin(v.clamp(this._startModel.down+s,-1,1)))}if(o){this._getDragPosition(t,i),v.vec3.sub(e,t,this._model.get("targetCamera")),v.vec3.normalize(e,e);var u=this._startModel.a1,l=Math.atan2(e[0],e[1]),c=Math.sign(v.vec3.cross(e,this._startModel.baseDir,e)[2]),h=0,d=this._model.get("angle");if(this._dragging===this._handleLeft)return h=this._clampAngle(2*(l-u),-c,d),void this._model.set("angle",h);if(l>0&&(l-=T),this._dragging===this._handleRight)return h=this._clampAngle(2*(u-l),c,d),void this._model.set("angle",h);this._dragging===this._handleCenter&&this._model.set("offset",P(this._startModel.offset+(u-l),T))}}}(),_getDragPosition:function(){var e=v.vec3.create(),t=v.vec3.create(),i=v.vec3.create(),r=v.vec3.create(),a=v.vec3.create(),n=v.vec3.create();return function(o,s){f.a.canvasCoordToGL(s[0],s[1],r),r[2]=0,m.a.getWorldPositionFromScreenPoint(r,e),r[2]=1,m.a.getWorldPositionFromScreenPoint(r,t),v.vec3.sub(n,t,e),v.vec3.normalize(n,n),v.vec3.set(a,0,0,1);var u=-this._startModel.startPosition[2],l=v.vec3.dot(a,n);if(Math.abs(l)<.05){var c=this._startModel.startPosition;v.vec3.sub(a,c,this._model.get("targetCamera")),a[2]=0,v.vec3.normalize(a,a),v.vec3.set(i,c[0],c[1],0),i[2]=0,u=-v.vec3.dot(a,i),l=v.vec3.dot(a,n)}var h=-(v.vec3.dot(a,e)+u),d=h/l;return v.vec3.scaleAndAdd(o,e,n,d),o}}(),_clampAngle:function(e,t,i){return e=P(e,T),t<0?i<T-i?0:T:e},startDrag:function(){var e=v.vec3.create(),t=v.vec3.create(),i=v.mat4.create();return function(r){this._hovered&&this._hovered!==this._centerNode&&(this._dragging=this._hovered,v.vec2.set(this._startCoord,r.canvasX,r.canvasY),this._handleCenter.getWorldMatrix(this,i),v.mat4.getTranslation(e,i),v.vec3.sub(t,e,this._model.get("targetCamera")),v.vec3.normalize(t,t),this._dragging.getWorldMatrix(this,i),v.mat4.getTranslation(e,i),this._startModel={up:Math.sin(this._model.get("up")),down:Math.sin(this._model.get("down")),offset:this._model.get("offset"),angle:this._model.get("angle"),startPosition:e,baseDir:t,a1:Math.atan2(t[0],t[1])},this._manipulator.getInputManager().setEnable(y.MANIPULATORS,!1),this._savedEnableState=this._model.get("enableCameraConstraints"),this._model.set("enableCameraConstraints",!1))}}(),endDrag:function(e){this._dragging&&(this._manipulator.getInputManager().setEnable(y.MANIPULATORS,!0),this._dragging=void 0,this.motion(e),this._model.set("enableCameraConstraints",this._savedEnableState))},_onHover:function(e){if(e!==this._hovered){if(this._hovered&&(this._changeColor(this._hovered.getStateSet(),x),this._changeColor(this._circleUp.getStateSet(),x),this._changeColor(this._arcLeft.getStateSet(),x),this._changeColor(this._arcRight.getStateSet(),x),this._changeColor(this._circleDown.getStateSet(),x),d.a.draw()),!e)return void(this._hovered=void 0);switch(this._hovered=e,this._changeColor(e.getStateSet(),S),e){case this._handleCenter:this._changeColor(this._circleDown.getStateSet(),S),this._changeColor(this._circleUp.getStateSet(),S),this._changeColor(this._arcLeft.getStateSet(),S),this._changeColor(this._arcRight.getStateSet(),S);break;case this._handleUp:this._changeColor(this._circleUp.getStateSet(),S);break;case this._handleDown:this._changeColor(this._circleDown.getStateSet(),S);break;case this._handleLeft:this._changeColor(this._arcLeft.getStateSet(),S);break;case this._handleRight:this._changeColor(this._arcRight.getStateSet(),S)}d.a.draw()}},_changeColor:function(e,t){var i=e.getUniform("uColor").getInternalArray();v.vec4.copy(i,t)},update:function(){var e=v.vec4.create(),t=v.vec3.create(),i=v.vec3.create();return function(r){var a=r.getViewport(),n=a.width()/a.height(),o=v.mat4.getScale(e,r.getProjectionMatrix())[0],s=Math.max(1.2,n*(1.1+.2/o)*o);this._manipulator.getEyePosition(t);var u=this._model.get("targetCamera"),l=this._getGizmo();l.isEditing()?(v.mat4.getTranslation(u,l.getMatrix()),this._needsCameraUpdate=!0):this._needsCameraUpdate&&(this._needsCameraUpdate=!1,this._model.trigger("targetCameraChanged"));var c=v.vec3.dist(t,u)/s,h=this._pivotNode.getMatrix();v.vec3.set(i,c,c,c),v.mat4.fromTranslation(h,u),v.mat4.scale(h,h,i);var d=this._centerNode.getMatrix();v.mat4.invert(d,r.getViewMatrix()),v.mat4.setTranslation(d,v.vec3.ZERO),v.mat4.scale(d,d,w),this._pivotNode.dirtyBound(),this._centerNode.dirtyBound()}}(),updateConstraints:function(){var e=this._model.get("usePitchConstraints"),t=this._model.get("useYawConstraints"),i=e?this._model.get("up"):this._model.defaults.up,r=e?this._model.get("down"):this._model.defaults.down,a=.5*(i+r);this._updatePitchWidget(this._circleUp,i),this._updatePitchWidget(this._circleDown,r),this._updatePitchWidget(this._circleCenter,a);var n=t?this._model.get("offset"):this._model.defaults.offset,o=t?this._model.get("angle"):this._model.defaults.angle,s=.5*o;e||t?(this._circleNode.setNodeMask(-1),this._arcNode.setNodeMask(-1),v.mat4.fromZRotation(this._circleNode.getMatrix(),n-.5*Math.PI),v.mat4.fromZRotation(this._arcCenter.getMatrix(),n),v.mat4.fromZRotation(this._arcLeft.getMatrix(),n-s),v.mat4.fromZRotation(this._arcRight.getMatrix(),n+s),v.mat4.fromZRotation(this._arcHalfLeft.getMatrix(),n-.5*s),v.mat4.fromZRotation(this._arcHalfRight.getMatrix(),n+.5*s)):(this._circleNode.setNodeMask(0),this._arcNode.setNodeMask(0)),this._updateHandles(e,t,i,r,a,s),v.mat4.fromTranslation(this._pivotNode.getMatrix(),this._model.get("targetCamera")),this._uUp.getInternalArray()[0]=Math.sin(i),this._uDown.getInternalArray()[0]=Math.sin(r),this._uHUp.getInternalArray()[0]=-Math.cos(.5*o),this.dirtyBound(),this._pivotNode.dirtyBound(),this._circleNode.dirtyBound(),d.a.draw()},_updateHandles:function(e,t,i,r,a,n){if(e){this._handleUp.setNodeMask(-1),this._handleDown.setNodeMask(-1);var o=i-r;this._updateHandleWidget(this._handleUp,o<.07?a+.035:i,0),this._updateHandleWidget(this._handleDown,o<.07?a-.035:r,0)}else this._handleUp.setNodeMask(0),this._handleDown.setNodeMask(0);t?(this._handleRight.setNodeMask(-1),this._handleLeft.setNodeMask(-1),this._handleCenter.setNodeMask(-1),n=n<.035?.035:n,n=n>Math.PI-.035?Math.PI-.035:n,this._updateHandleWidget(this._handleRight,a,n),this._updateHandleWidget(this._handleLeft,a,-n),this._updateHandleWidget(this._handleCenter,a,0)):(this._handleRight.setNodeMask(0),this._handleLeft.setNodeMask(0),this._handleCenter.setNodeMask(0))},_updateHandleWidget:function(e,t,i){var r=e.getMatrix();v.mat4.fromZRotation(r,i),v.mat4.rotateY(r,r,t),v.mat4.translate(r,r,M),e.dirtyBound()},_updatePitchWidget:function(){var e=v.vec3.create(),t=v.vec3.create();return function(i,r){var a=i.getMatrix(),n=Math.sin(r),o=Math.cos(r);v.vec3.set(e,0,0,n),v.vec3.set(t,o,o,1),v.mat4.fromTranslation(a,e),v.mat4.scale(a,a,t)}}()}),t.a=A},function(e,t){e.exports='#pragma include "functions.glsl"\n\n#define _linTest(color, keepLinear) { return keepLinear == 1 ? color : linearTosRGB(color); }\n\n#pragma DECLARE_FUNCTION\nfloat linearTosRGBWithTest(const in float color, const in int keepLinear) _linTest(color, keepLinear)\n\n#pragma DECLARE_FUNCTION\nvec3 linearTosRGBWithTest(const in vec3 color, const in int keepLinear) _linTest(color, keepLinear)\n\n#pragma DECLARE_FUNCTION\nvec4 linearTosRGBWithTest(const in vec4 color, const in int keepLinear) _linTest(color, keepLinear)\n\n#pragma DECLARE_FUNCTION\nfloat adjustSpecular( const in float specular, const in vec3 normal ) {\n    // Based on The Order : 1886 SIGGRAPH course notes implementation (page 21 notes)\n    float normalLen = length(normal);\n    if ( normalLen < 1.0) {\n        float normalLen2 = normalLen * normalLen;\n        float kappa = ( 3.0 * normalLen -  normalLen2 * normalLen )/( 1.0 - normalLen2 );\n        // http://www.frostbite.com/2014/11/moving-frostbite-to-pbr/\n        // page 91 : they use 0.5/kappa instead\n        return 1.0-min(1.0, sqrt( (1.0-specular) * (1.0-specular) + 1.0/kappa ));\n    }\n    return specular;\n}\n\n#pragma DECLARE_FUNCTION\nvec3 normalTangentSpace(const in vec4 tangent, const in vec3 normal, const in vec3 texNormal) {\n    vec3 tang = vec3(0.0,1.0,0.0);\n    float l = length(tangent.xyz);\n    if (l != 0.0) {\n        //normalize reusing length computations\n        // tang =  normalize(tangent.xyz);\n        tang =  tangent.xyz / l;\n    }\n    vec3 B = tangent.w * normalize(cross(normal, tang));\n    return normalize( texNormal.x * tang + texNormal.y * B + texNormal.z * normal);\n}\n\n#pragma DECLARE_FUNCTION\nvec2 normalMatcap(const in vec3 normal, const in vec3 eyeVector) {\n    vec3 nm_x = vec3(-eyeVector.z, 0.0, eyeVector.x);\n    vec3 nm_y = cross(nm_x, eyeVector);\n    return vec2(dot(normal.xz, -nm_x.xz), dot(normal, nm_y)) * vec2(0.5)  + vec2(0.5);\n}\n\n#pragma DECLARE_FUNCTION\nvec3 textureNormalMap(const in vec3 normal, const in int flipY) {\n    vec3 rgb = normal * vec3(2.0) + vec3(-1.0); // MADD vec form\n    rgb[1] = flipY == 1 ? -rgb[1] : rgb[1];\n    return rgb;\n}\n\n#pragma DECLARE_FUNCTION\nvec3 bumpMap(const in vec4 tangent, const in vec3 normal, const in vec2 gradient) {\n    vec3 outnormal;\n    float l = length(tangent.xyz);\n    if (l != 0.0) {\n        //normalize reusing length computations\n        // vec3 tang =  normalize(tangent.xyz);\n        vec3 tang =  tangent.xyz / l;\n        vec3 binormal = tangent.w * normalize(cross(normal, tang));\n        outnormal = normal + gradient.x * tang + gradient.y * binormal;\n    }\n    else {\n       outnormal = vec3(normal.x + gradient.x, normal.y + gradient.y, normal.z);\n    }\n    return normalize(outnormal);\n}\n\n#pragma DECLARE_FUNCTION\nfloat checkerboard(const in vec2 uv, const in vec4 halton) {\n    float taaSwap = step(halton.z, 0.0);\n    return mod(taaSwap + floor(uv.x) + floor(uv.y), 2.0);\n}\n\n// random links on packing :\n// cesium attributes packing\n// https://cesiumjs.org/2015/05/18/Vertex-Compression/\n\n// float packing in 24 bits or 32 bits\n// https://skytiger.wordpress.com/2010/12/01/packing-depth-into-color/\n\n#pragma DECLARE_FUNCTION\nvec4 encodeDepthAlphaProfileScatter(const in float depth, const in float alpha, const in float profile, const in float scatter) {\n    vec4 pack = vec4(0.0);\n\n    // opacity in alpha\n    pack.a = alpha;\n\n    if(profile == 0.0) {\n        const vec3 code = vec3(1.0, 255.0, 65025.0);\n        pack.rgb = vec3(code * depth);\n        pack.gb = fract(pack.gb);\n        pack.rg -= pack.gb * (1.0 / 256.0);\n    } else {\n        // depth in rg\n        pack.g = fract(depth * 255.0);\n        pack.r = depth - pack.g / 255.0;\n\n        // scatter 6 bits\n        pack.b = floor(0.5 + scatter * 63.0) * 4.0 / 255.0;\n    }\n\n    // profile on 2 lower bits\n    pack.b -= mod(pack.b, 4.0 / 255.0);\n    pack.b += profile / 255.0; // 3 profile possible for sss\n\n    return pack;\n}\n\nint decodeProfile(const in vec4 pack) {\n    float packValue = floor(pack.b * 255.0 + 0.5);\n    // we extract the 2 lowest bits\n    float profile = mod(packValue, 2.0);\n    profile += mod(packValue - profile, 4.0);\n    return int(profile);\n}\n\nfloat decodeDepth(const in vec4 pack) {\n    if(decodeProfile(pack) == 0){\n        const vec3 decode = 1.0 / vec3(1.0, 255.0, 65025.0);\n        return dot(pack.rgb, decode);\n    }\n\n    return pack.r + pack.g / 255.0;\n}\n\nfloat decodeScatter(const in vec4 pack) {\n    float scatter = pack.b - mod(pack.b, 4.0 / 255.0);\n    return scatter * 255.0 / 4.0 / 63.0;\n}\n\nfloat decodeAlpha(const in vec4 pack) {\n    return pack.a;\n}\n\nfloat getLuminance(const in vec3 color) {\n    // http://stackoverflow.com/questions/596216/formula-to-determine-brightness-of-rgb-color\n    const vec3 colorBright = vec3(0.2126, 0.7152, 0.0722);\n    return dot(color, colorBright);\n}\n\nfloat distanceToDepth(const in sampler2D depth, const in vec2 uv, const in vec4 viewPos, const vec2 nearFar) {\n    float fragDepth = clamp( (-viewPos.z * viewPos.w - nearFar.x) / (nearFar.y - nearFar.x), 0.0, 1.0);\n    return fragDepth - decodeDepth(texture2D(depth, uv));\n}\n\nvec3 encode24(const in float x){\n    const vec3 code = vec3(1.0, 255.0, 65025.0);\n    vec3 pack = vec3(code * x);\n    pack.gb = fract(pack.gb);\n    pack.rg -= pack.gb * (1.0 / 256.0);\n    return pack;\n}\n\nfloat decode24(const in vec3 x) {\n    const vec3 decode = 1.0 / vec3(1.0, 255.0, 65025.0);\n    return dot(x, decode);\n}'},function(e,t){e.exports='#pragma include "functions.glsl"\n\nvec3 cubemapSeamlessFixDirection(const in vec3 direction, const in float size ) {\n    vec3 dir = direction;\n    float scale = 1.0 - 1.0 / size;\n    // http://seblagarde.wordpress.com/2012/06/10/amd-cubemapgen-for-physically-based-rendering/\n    vec3 absDir = abs(dir);\n    float M = max(max(absDir.x, absDir.y), absDir.z);\n\n    if (absDir.x != M) dir.x *= scale;\n    if (absDir.y != M) dir.y *= scale;\n    if (absDir.z != M) dir.z *= scale;\n\n    return dir;\n}\n\n// seamless cubemap for background ( no lod )\nvec3 textureCubeFixed(const in samplerCube tex, const in vec3 direction, const in float scale ) {\n    // http://seblagarde.wordpress.com/2012/06/10/amd-cubemapgen-for-physically-based-rendering/\n    vec3 dir = cubemapSeamlessFixDirection( direction, scale);\n    return LUVToRGB( textureCube( tex, dir ) );\n}\n\n#pragma DECLARE_FUNCTION\nvec3 textureEnvironmentCube( const in samplerCube tex, const in mat3 envTransform, const in vec3 normal, const in vec3 eyeVector, const in vec2 texSize){\n    vec3 R = normalize((2.0 * clamp(dot(normal, eyeVector), 0.0, 1.0)) * normal - eyeVector);\n    return textureCubeFixed(tex, envTransform * R, texSize[0] );\n}\n\n#ifndef TEX_BUMP\n#define TEX_BUMP(tex, uv) 1.0\n#endif\n\n// Todo use #idfef and derivatives (dDFx, dDFy, fwidth) extension ?\n// float valuetexture2D(tex, uv);\n// return vec2(dFdx(value), dFdy(value));\n#pragma DECLARE_FUNCTION\nvec2 textureGradient(in sampler2D tex, const in vec2 uv, const in vec2 texSize) {\n    vec2 invSize = 1.0 / texSize;\n    float dx = TEX_BUMP(tex, uv - vec2(invSize.x, 0.0)) - TEX_BUMP(tex, uv + vec2(invSize.x, 0.0));\n    float dy = TEX_BUMP(tex, uv - vec2(0.0, invSize.y)) - TEX_BUMP(tex, uv + vec2(0.0, invSize.y));\n    return vec2(dx, dy);\n}\n'},function(e,t){e.exports='#pragma include "common.glsl"\n#pragma include "lightCommon.glsl"\n\n// light PBR glsl\n#define G1V(dotNV, k) (1./(dotNV*(1.-k)+k))\n\n#pragma DECLARE_FUNCTION\nvec4 precomputeGGX(const in vec3 normal, const in vec3 eyeVector, const in float roughness) {\n    float dotNV = saturate(dot(normal, eyeVector));\n    float alpha = roughness * roughness;\n    float k = alpha * 0.5;\n    float visNV = G1V(dotNV, k);\n\n    return vec4(alpha, alpha * alpha, k, visNV);\n}\n\nvec3 computeGGX(const vec4 precomputeGGX, const vec3 normal, const vec3 eyeVector, const vec3 eyeLightDir, const vec3 F0, const float dotNL) {\n\n    vec3 H = normalize(eyeVector + eyeLightDir);\n    float dotNH = saturate(dot(normal, H));\n\n    // D - Normal distribution functon\n    float alphaSqr = precomputeGGX.y;\n    float denom = dotNH * dotNH * (alphaSqr - 1.0) + 1.0;\n    float D = alphaSqr / (PI * denom * denom);\n\n    // F - Fresnel (Schlick)\n    float dotLH = saturate(dot(eyeLightDir, H));\n    float dotLH5 = pow(1.0 - dotLH, 5.0);\n    vec3 F = saturate(50.0 * F0.g) * dotLH5 + (1.0 - dotLH5) * F0;\n\n    // V - Specular geometry attenuation\n    float visNL = G1V(dotNL, precomputeGGX.z);\n    return D * F * visNL * precomputeGGX.w;\n}\n\n// pure compute Light PBR\n#pragma DECLARE_FUNCTION\nvoid computeLightLambertGGX(\n    const in vec3 normal,\n    const in vec3 eyeVector,\n    const in float dotNL,\n    const in vec4 precomputeGGX,\n    \n    const in vec3 diffuse,\n    const in vec3 specular,\n    \n    const in float attenuation,\n    const in vec3 lightColor,\n    const in vec3 eyeLightDir,\n    \n    out vec3 diffuseOut,\n    out vec3 specularOut,\n    out bool lighted) {\n\n    lighted = dotNL > 0.0;\n    if (lighted == false) {\n        specularOut = diffuseOut = vec3(0.0);\n        return;\n    }\n\n    vec3 colorAttenuate = attenuation * dotNL * lightColor;\n    specularOut = colorAttenuate * computeGGX(precomputeGGX, normal, eyeVector, eyeLightDir, specular, dotNL);\n    diffuseOut = colorAttenuate * diffuse;\n}\n'},function(e,t){e.exports='#pragma include "common.glsl"\n#pragma include "lightCommon.glsl"\n\n/////////////////////////\n/// SUBSURFACE SCATTERING\n/////////////////////////\n#pragma DECLARE_FUNCTION\nvec3 computeLightSSS(\n        const in float dotNL,\n        const in float attenuation,\n        const in float thicknessFactor,\n        const in vec3 translucencyColor,\n        const in float translucencyFactor,\n        const in float shadowDistance,\n        const in vec3 diffuse,\n        const in vec3 lightColor) {\n\n    // http://blog.stevemcauley.com/2011/12/03/energy-conserving-wrapped-diffuse/\n    // float scatter = 0.5;\n    // float wrap = saturate((dotNL + scatter) / ((1.0 + scatter) * (1.0 + scatter)));\n\n    // https://github.com/iryoku/separable-sss/blob/master/SeparableSSS.h#L362\n    float wrap = saturate(0.3 - dotNL);\n    float thickness = max(0.0, shadowDistance / max(0.001, thicknessFactor));\n\n    // http://www.crytek.com/download/2014_03_25_CRYENGINE_GDC_Schultz.pdf\n    // skin approximation vec3(0.98, 0.3, 0.2)\n    float finalAttenuation = translucencyFactor * attenuation * wrap;\n    return finalAttenuation * lightColor * diffuse * exp(-thickness / max(translucencyColor, vec3(0.001))); \n}\n'},function(e,t){e.exports='#pragma include "common.glsl"\r\n#pragma include "functions.glsl"\r\n\r\n#define LUV\r\n\r\n#pragma DECLARE_FUNCTION\r\nfloat specularOcclusion(const in int occlude, const in float ao, const in vec3 normal, const in vec3 eyeVector) {\r\n    if(occlude == 0) return 1.0;\r\n    // Yoshiharu Gotanda\'s specular occlusion approximation:\r\n    // cf http://research.tri-ace.com/Data/cedec2011_RealtimePBR_Implementation_e.pptx pg59\r\n    float d = dot(normal, eyeVector) + ao;\r\n    return clamp((d * d) - 1.0 + ao, 0.0, 1.0);\r\n}\r\n\r\n#pragma DECLARE_FUNCTION\r\nfloat adjustRoughnessNormalMap(const in float roughness, const in vec3 normal) {\r\n    // Based on The Order : 1886 SIGGRAPH course notes implementation (page 21 notes)\r\n    float normalLen = length(normal);\r\n    if ( normalLen < 1.0) {\r\n        float normalLen2 = normalLen * normalLen;\r\n        float kappa = ( 3.0 * normalLen -  normalLen2 * normalLen )/( 1.0 - normalLen2 );\r\n        // http://www.frostbite.com/2014/11/moving-frostbite-to-pbr/\r\n        // page 91 : they use 0.5/kappa instead\r\n        return min(1.0, sqrt( roughness * roughness + 1.0/kappa ));\r\n    }\r\n    return roughness;\r\n}\r\n\r\n#pragma DECLARE_FUNCTION\r\nfloat adjustRoughnessGeometry(const in float roughness, const in vec3 normal) {\r\n    // Geometric Specular Aliasing (slide 43)\r\n    // http://alex.vlachos.com/graphics/Alex_Vlachos_Advanced_VR_Rendering_GDC2015.pdf\r\n// #ifdef GL_OES_standard_derivatives\r\n//     vec3 vDx = dFdx( normal.xyz );\r\n//     vec3 vDy = dFdy( normal.xyz );\r\n//     return max(roughness, pow( clamp( max( dot( vDx, vDx ), dot( vDy, vDy ) ), 0.0, 1.0 ), 0.333 ));\r\n// #else\r\n    return roughness;\r\n// #endif\r\n}\r\n\r\n#pragma DECLARE_FUNCTION\r\nmat3 environmentTransformPBR(const in mat4 transform) {\r\n    // TODO trick from animation matrix transpose?\r\n    vec3 x = vec3(transform[0][0], transform[1][0], transform[2][0]);\r\n    vec3 y = vec3(transform[0][1], transform[1][1], transform[2][1]);\r\n    vec3 z = vec3(transform[0][2], transform[1][2], transform[2][2]);\r\n    mat3 m = mat3(x, y, z);\r\n    return m;\r\n}\r\n\r\n#pragma DECLARE_FUNCTION\r\nvec3 computeDiffuseSPH(const in vec3 sphCoef[9], const in mat3 envTransform, const in vec3 normal) {\r\n    vec3 n = envTransform * normal;\r\n    // https://github.com/cedricpinson/envtools/blob/master/Cubemap.cpp#L523\r\n    vec3 result =\r\n        sphCoef[0] +\r\n        sphCoef[1] * n.y +\r\n        sphCoef[2] * n.z +\r\n        sphCoef[3] * n.x +\r\n        sphCoef[4] * n.y * n.x +\r\n        sphCoef[5] * n.y * n.z +\r\n        sphCoef[6] * (3.0 * n.z * n.z - 1.0) +\r\n        sphCoef[7] * (n.z * n.x) +\r\n        sphCoef[8] * (n.x * n.x - n.y * n.y);\r\n     return max(result, vec3(0.0));\r\n}\r\n\r\n// Frostbite, Lagarde paper p67\r\n// http://www.frostbite.com/wp-content/uploads/2014/11/course_notes_moving_frostbite_to_pbr.pdf\r\nfloat linRoughnessToMipmap( const in float roughnessLinear ) {\r\n    return sqrt(roughnessLinear);\r\n}\r\n\r\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Private/BRDF.ush#L202\r\nvec3 integrateBRDF( const in vec3 specular, const in float r, const in float NoV, const in sampler2D tex ) {\r\n    vec4 rgba = texture2D( tex, vec2(NoV, r) );\r\n    float b = (rgba[3] * 65280.0 + rgba[2] * 255.0);\r\n    float a = (rgba[1] * 65280.0 + rgba[0] * 255.0);\r\n    const float div = 1.0/65535.0;\r\n    return (specular * a + b * saturate(50.0 * specular.g)) * div;\r\n}\r\n\r\n// https://www.unrealengine.com/blog/physically-based-shading-on-mobile\r\nvec3 integrateBRDFApprox( const in vec3 specular, const in float roughness, const in float NoV ) {\r\n    const vec4 c0 = vec4( -1, -0.0275, -0.572, 0.022 );\r\n    const vec4 c1 = vec4( 1, 0.0425, 1.04, -0.04 );\r\n    vec4 r = roughness * c0 + c1;\r\n    float a004 = min( r.x * r.x, exp2( -9.28 * NoV ) ) * r.x + r.y;\r\n    vec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\r\n    return specular * AB.x + AB.y * saturate(50.0 * specular.g);\r\n}\r\n\r\n// basically whether it\'s panorama or cubemap we load the adequate glsl\r\n// and we set samplerEnv and prefilterEnvMap\r\n#ifdef CUBEMAP\r\n#pragma include "cubemapSampler.glsl" "CUBEMAP"\r\n#define samplerEnv samplerCube\r\n#define prefilterEnvMap prefilterEnvMapCube\r\n\r\n#else\r\n#ifdef PANORAMA\r\n#pragma include "panoramaSampler.glsl" "PANORAMA"\r\n#define samplerEnv sampler2D\r\n#define prefilterEnvMap prefilterEnvMapPanorama\r\n\r\n#else\r\n// in case there is no environment node ?\r\nvec3 prefilterEnvMap( const in float rLinear, const in vec3 R, const in sampler2D tex, const in vec2 lodRange, const in vec2 size ) {\r\n    return vec3(0.0);\r\n}\r\n#define samplerEnv sampler2D\r\n#endif // PANORAMA\r\n\r\n#endif // CUBEMAP\r\n\r\nvec3 getSpecularDominantDir( const in vec3 N, const in vec3 R, const in float realRoughness ) {\r\n    float smoothness = 1.0 - realRoughness;\r\n    float lerpFactor = smoothness * ( sqrt( smoothness ) + realRoughness );\r\n    // The result is not normalized as we fetch in a cubemap\r\n    return mix( N, R, lerpFactor );\r\n}\r\n\r\n#ifdef TEXTURE_BRDF\r\n#define OPT_ARG_texBRDF ,const in sampler2D texBRDF\r\n#else\r\n#define OPT_ARG_texBRDF\r\n#endif\r\n\r\n// samplerEnv and prefilterEnvMap are both defined above (cubemap or panorama)\r\n#pragma DECLARE_FUNCTION\r\nvec3 computeIBLSpecularUE4(\r\n    const in vec3 normal,\r\n    const in vec3 eyeVector,\r\n    const in float roughness,\r\n    const in vec3 specular,\r\n    const in mat3 envTransform,\r\n    const in samplerEnv texSpecular,\r\n    const in vec2 lodRange,\r\n    const in vec2 texSize,\r\n    const in vec3 frontNormal\r\n    OPT_ARG_texBRDF) {\r\n\r\n    float rough = max( roughness, 0.0 );\r\n\r\n    float NoV = dot( normal, eyeVector );\r\n    vec3 R = normalize( NoV * 2.0 * normal - eyeVector );\r\n    R = getSpecularDominantDir( normal, R, roughness );\r\n    // could use that, especially if NoV comes from shared preCompSpec\r\n    //vec3 R = reflect( -eyeVector, normal );\r\n\r\n    vec3 prefilteredColor = prefilterEnvMap( rough, envTransform * R, texSpecular, lodRange, texSize );\r\n    // http://marmosetco.tumblr.com/post/81245981087\r\n    // marmoset uses 1.3, we force it to 1.0\r\n    float factor = clamp( 1.0 + dot( R, frontNormal ), 0.0, 1.0 );\r\n    prefilteredColor *= factor * factor;\r\n    #ifdef TEXTURE_BRDF\r\n    return prefilteredColor * integrateBRDF( specular, rough, NoV, texBRDF );\r\n    #else\r\n    return prefilteredColor * integrateBRDFApprox( specular, rough, NoV );\r\n    #endif\r\n}\r\n'},function(e,t){e.exports="vec2 computeUVForMipmap( const in float level, const in vec2 uv, const in float size, const in float maxLOD ) {\r\n\r\n    // width for level\r\n    float widthForLevel = exp2( maxLOD-level);\r\n\r\n    // the height locally for the level in pixel\r\n    // to opimitize a bit we scale down the v by two in the inputs uv\r\n    float heightForLevel = widthForLevel * 0.5;\r\n\r\n\r\n    // compact version\r\n    float texelSize = 1.0/size;\r\n    vec2 uvSpaceLocal =  vec2(1.0) + uv * vec2(widthForLevel - 2.0, heightForLevel - 2.0);\r\n    uvSpaceLocal.y += size - widthForLevel;\r\n    return uvSpaceLocal * texelSize;\r\n}\r\n\r\n//for y up\r\nvec2 normalToPanoramaUVY( const in vec3 dir ) {\r\n    float n = length(dir.xz);\r\n\r\n    // to avoid bleeding the max(-1.0,dir.x / n) is needed\r\n    vec2 pos = vec2( (n>0.0000001) ? max(-1.0,dir.x / n) : 0.0, dir.y);\r\n\r\n    // fix edge bleeding\r\n    if ( pos.x > 0.0 ) pos.x = min( 0.999999, pos.x );\r\n\r\n    pos = acos(pos) * 0.3183098861837907; // inv_pi\r\n\r\n    pos.x = (dir.z > 0.0) ? pos.x*0.5 : 1.0-(pos.x*0.5);\r\n\r\n    // shift u to center the panorama to -z\r\n    pos.x = mod(pos.x-0.25+1.0, 1.0 );\r\n    pos.y = 1.0-pos.y;\r\n    return pos;\r\n}\r\n\r\nvec3 texturePanorama(const in sampler2D tex, const in vec2 uv) {\r\n    vec4 rgba = texture2D(tex, uv );\r\n#ifdef FLOAT\r\n    return rgba.rgb;\r\n#endif\r\n#ifdef RGBM\r\n    return RGBMToRGB( rgba );\r\n#endif\r\n#ifdef LUV\r\n    return LUVToRGB( rgba );\r\n#endif\r\n}\r\n\r\nvec3 texturePanoramaLod(const in sampler2D tex, const in vec2 size, const in vec3 direction, const in float lodInput, const in float maxLOD ) {\r\n    float lod = min( maxLOD, lodInput );\r\n    vec2 uvBase = normalToPanoramaUVY( direction );\r\n\r\n    // // we scale down v here because it avoid to do twice in sub functions\r\n    // uvBase.y *= 0.5;\r\n\r\n    float lod0 = floor(lod);\r\n    vec2 uv0 = computeUVForMipmap(lod0, uvBase, size.x, maxLOD );\r\n    vec3 texel0 = texturePanorama( tex, uv0.xy);\r\n\r\n    float lod1 = ceil(lod);\r\n    vec2 uv1 = computeUVForMipmap(lod1, uvBase, size.x, maxLOD );\r\n    vec3 texel1 = texturePanorama( tex, uv1.xy);\r\n\r\n    return mix(texel0, texel1, fract( lod ) );\r\n}\r\n\r\nvec3 prefilterEnvMapPanorama( const in float rLinear, const in vec3 R, const in sampler2D tex, const in vec2 lodRange, const in vec2 size ){\r\n    return texturePanoramaLod( tex, size, R, linRoughnessToMipmap(rLinear) * lodRange[1], lodRange[0] );\r\n}\r\n"},function(e,t){e.exports="// has to be before anything else, just after glsl language version\r\n// it's require. enable just allow\r\nvec3 textureCubemapLod(const in samplerCube texture, const in vec3 dir, const in float lod ) {\r\n    vec4 rgba = textureCubeLodEXT( texture, dir, lod );\r\n#ifdef FLOAT\r\n    return rgba.rgb;\r\n#endif\r\n#ifdef RGBM\r\n    return RGBMToRGB( rgba );\r\n#endif\r\n#ifdef LUV\r\n    return LUVToRGB( rgba );\r\n#endif\r\n}\r\n\r\nvec3 textureCubeLodEXTFixed(const in samplerCube texture, const in vec2 size, const in vec3 direction, const in float lodInput, const in float maxLod ) {\r\n    vec3 dir = direction;\r\n    float lod = min( maxLod, lodInput );\r\n\r\n    // http://seblagarde.wordpress.com/2012/06/10/amd-cubemapgen-for-physically-based-rendering/\r\n    float scale = 1.0 - exp2(lod) / size.x;\r\n    vec3 absDir = abs(dir);\r\n    float M = max(max(absDir.x, absDir.y), absDir.z);\r\n\r\n    if (absDir.x != M) dir.x *= scale;\r\n    if (absDir.y != M) dir.y *= scale;\r\n    if (absDir.z != M) dir.z *= scale;\r\n\r\n    return textureCubemapLod( texture, dir, lod );\r\n}\r\n\r\nvec3 prefilterEnvMapCube( const in float rLinear, const in vec3 R, const in samplerCube tex, const in vec2 lodRange, const in vec2 size ){\r\n    float lod = linRoughnessToMipmap(rLinear) * lodRange[1]; //( uEnvironmentMaxLod - 1.0 );\r\n    return textureCubeLodEXTFixed( tex, size, R, lod, lodRange[0] );\r\n}\r\n"},function(e,t){e.exports="// http://madebyevan.com/shaders/curvature/\n#pragma DECLARE_FUNCTION DERIVATIVES:enable\nvec3 applyCurvature(const in vec3 normal, const in vec3 color, const in float factor) {\n  if(factor == 0.0) return color;\n\n#ifndef GL_OES_standard_derivatives\n    return color;\n#else\n  vec3 n = normalize(normal);\n  // Compute curvature\n  vec3 dx = dFdx(n);\n  vec3 dy = dFdy(n);\n  vec3 xneg = n - dx;\n  vec3 xpos = n + dx;\n  vec3 yneg = n - dy;\n  vec3 ypos = n + dy;\n\n  float curvature = (cross(xneg, xpos).y - cross(yneg, ypos).x) * factor;\n\n  float curvDirt = clamp(-curvature * 1.5, 0.0, 1.0);\n  float curvEdge = clamp(curvature * 2.5, 0.0, 1.0);\n\n  float factorDirt = mix(1.0, 0.3, curvDirt);\n  float factorEdge = 2.0;\n\n  return color * mix(factorDirt, factorEdge, curvEdge);\n#endif\n}\n"},function(e,t){e.exports="\n// white vs interleaved vs blue noise\n// https://blog.demofox.org/2017/10/31/animating-noise-for-integration-over-time/\n\n// to test in a shadertoy\n// https://www.shadertoy.com/view/lsdfD4\n\n// https://www.shadertoy.com/view/4djSRW\n// most combinations are possible : in[1,2,3] -> out[1,2,3]\n#define INT_SCALE1 .1031\nfloat pseudoRandom(const in vec2 fragCoord) {\n    vec3 p3  = fract(vec3(fragCoord.xyx) * INT_SCALE1);\n    p3 += dot(p3, p3.yzx + 19.19);\n    return fract((p3.x + p3.y) * p3.z);\n}\n\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Private/Random.ush#L27\nfloat interleavedGradientNoise(const in vec2 fragCoord, const in float frameMod) {\n    vec3 magic = vec3(0.06711056, 0.00583715, 52.9829189);\n    return fract(magic.z * fract(dot(fragCoord.xy + frameMod * vec2(47.0, 17.0) * 0.695, magic.xy)));\n}\n\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Private/MaterialTemplate.ush#L1863\n// we slighty change it by multiplying by 1.2 (to match with other noise), otherwise the range seems to be between [0 - 0.83]\nfloat ditheringNoise(const in vec2 fragCoord, const in float frameMod) {\n    // float fm = mod(frameMod, 2.0) == 0.0 ? 1.0 : -1.0;\n    float fm = frameMod;\n    float dither5 = fract((fragCoord.x + fragCoord.y * 2.0 - 1.5 + fm) / 5.0);\n    float noise = fract(dot(vec2(171.0, 231.0) / 71.0, fragCoord.xy));\n    return (dither5 * 5.0 + noise) * (1.2 / 6.0);\n}\n\n#pragma DECLARE_FUNCTION\nvoid ditheringMaskingDiscard(\n    const in vec4 fragCoord,\n    const in int dithering,\n    const in float alpha,\n    const in float factor,\n\n    const in float thinLayer,\n\n    const in float frameMod,\n    const in vec2 nearFar,\n\n    const in vec4 halton) {\n\n    if (dithering != 1) {\n        if (alpha < factor) discard;\n        return;\n    }\n\n    float rnd;\n\n    if (thinLayer == 0.0) {\n        float linZ = (1.0 / fragCoord.w - nearFar.x) / (nearFar.y - nearFar.x);\n        float sliceZ = floor(linZ * 500.0) / 500.0;\n        rnd = interleavedGradientNoise(fragCoord.xy + sliceZ, frameMod);\n    } else {\n        rnd = pseudoRandom(fragCoord.xy + halton.xy * 1000.0 + fragCoord.z * (abs(halton.z) == 2.0 ? 1000.0 : 1.0));\n    }\n\n    if (alpha * factor < rnd) discard;\n}\n"},function(e,t){e.exports="#pragma include \"sketchfabFunctions.glsl\"\n\n// manual refract mostly to re-use dot(I, N)\nvec3 batchRefract(const in vec3 I, const in vec3 N , const in float eta, const in float dotNI)\n{\n    float k = 1.0 - eta * eta * (1.0 - dotNI * dotNI);\n    return (k < 0.0) ? vec3(0.0) :  eta * I - (eta * dotNI + sqrt(k)) * N;\n}\n\n#pragma DECLARE_FUNCTION\nvec3 refraction(\n    const in float indexRefraction,\n    const in float roughness,\n\n    const in vec3 normal,\n    const in vec3 eyeVector,\n    const in vec3 viewVertex,\n    const in float boxRadius,\n\n    const in sampler2D colorTex,\n    const in sampler2D depthTex,\n    const in vec2 refractionSize,\n\n    const in vec2 nearFar,\n    const in vec2 currentRatio,\n\n    const in vec2 previousSize,\n    const in vec2 previousRatio,\n    const in vec2 previousHalton,\n\n    const in mat4 reprojectViewProj,\n    const in mat4 projection,\n    const in vec4 corners[2],\n    const in int isVr\n    ) {\n\n    float dotNI = -dot(eyeVector, normal);\n\n    // compute UV at distortion point\n    // https://en.wikibooks.org/wiki/GLSL_Programming/Unity/Curved_Glass\n    vec3 pos = viewVertex + boxRadius * batchRefract(-eyeVector, normal, 1.0 / indexRefraction, dotNI);\n    pos = (projection * vec4(pos, 1.0)).xyw; // we discard z and only keep the perspective divide\n    vec2 uv = 0.5 + 0.5 * pos.xy / pos.z;\n    if (isVr == 1) uv.x *= 0.5;\n\n    // we discard refraction on pixels that are in front of refracted surface by\n    // comparing current pixel depth with depth at refraction point\n    // if we are on the background we take the depth of the current position\n#ifdef DEPTH_MIPMAP\n    vec3 pack = texture2D(depthTex, previousRatio * vec2(uv.x, (1.0 - uv.y) * 0.5)).xyz;\n    float depthRefracted = pack.x == 1.0 ? (-viewVertex.z - nearFar.x) / (nearFar.y - nearFar.x) : decode24(pack);\n#else\n    vec4 pack = texture2D(depthTex, currentRatio * uv);\n    float depthRefracted = pack.x == 1.0 ? (-viewVertex.z - nearFar.x) / (nearFar.y - nearFar.x) : decodeDepth(pack);\n#endif\n\n    // compute view space refracted position from depth\n    vec4 AB = mix(corners[0], corners[1], uv.x);\n    pos = vec3(mix(AB.xy, AB.zw, uv.y), 1.0) * -(nearFar.x + (nearFar.y - nearFar.x) * depthRefracted);\n\n    // pos is computed with last frame projection which is not entirely correct\n    if (dot(pos.xyz - viewVertex.xyz, normal) > 0.0) {\n        pos = viewVertex;\n    }\n\n    // reproject view vector\n    pos = (reprojectViewProj * vec4(pos, 1.0)).xyw;\n    uv.xy = 0.5 + 0.5 * pos.xy / pos.z;\n    if (isVr == 1) uv.x *= 0.5;\n\n    // unjitter (so that the refraction is stable when doing supersampling)\n    uv -= 0.5 * previousHalton.xy / previousSize.xy;\n\n    // repeat mirror for out of screen fetches (it's better than a sudden cut)\n    // we can't simply use MIRRORED_REPEAT because of manual mipmap\n    uv = abs(uv); \n    if (uv.x > 1.0) uv.x -= 2.0 * (uv.x - 1.0);\n    if (uv.y > 1.0) uv.y -= 2.0 * (uv.y - 1.0);\n\n    // adjusts roughness-to-mipmap depending of distance from surface (aka: consistent blurring even when we unzoom)\n    float adjustRoughness = clamp(projection[1][1] / 12.0 * boxRadius / -viewVertex.z, 0.0, 1.0);\n    float adjustFactor = 0.05; // the higher it is, the sharper it will be when we are far away\n    adjustRoughness = (1.0 + adjustFactor) * adjustRoughness / (adjustFactor + adjustRoughness);\n\n    // roughness support\n    float maxLod = 7.0;\n    float lodLevel = maxLod * min(0.99, roughness * adjustRoughness); // same as in pbr\n\n    float lowerLevel = floor(lodLevel);\n    float higherLevel = min(maxLod, lowerLevel + 1.0);\n    float lerpFactor = lodLevel - lowerLevel; // [0,1]\n\n    // see packMipmapRefraction.glsl\n    // mipmap packing of refracted texture (the packing is not optimal and is a bit naive):\n    // level0: (1-uv)/2\n    // level1: (3-uv)/4\n    // level2: (7-uv)/8\n    // level3: (15-uv)/16\n    // level4: (31-uv)/32\n    // etc...\n\n    float powLevel = pow(2.0, higherLevel);\n\n    // border pixel issue with bilinear...\n    vec2 pixelSize = 2.0 * powLevel / refractionSize;\n    uv = max(pixelSize, min(1.0 - pixelSize, uv));\n\n    // lower uv\n    vec2 uvLower = vec2(2.0 * uv.x, powLevel - 1.0 - uv.y) * previousRatio.xy / powLevel;\n\n    // higher uv\n    powLevel *= 2.0;\n    vec2 uvHigher = vec2(2.0 * uv.x, powLevel - 1.0 - uv.y) * previousRatio.xy / powLevel;\n\n    // manual lerp, mixing rgbm colors exhibits visible seams\n    vec3 fetch = mix(decodeRGBM(texture2D(colorTex, uvLower), 7.0), decodeRGBM(texture2D(colorTex, uvHigher), 7.0), lerpFactor);\n\n    // reduce bright fresnel effect, it darkens/accentuates the edges in some cases (very rough surface)\n    fetch.rgb -= fetch.rgb * pow(clamp(1.0 + dotNI, 0.0, 1.0), 4.0);\n\n    return fetch.rgb;\n}\n"},function(e,t){e.exports='#pragma include "sketchfabFunctions.glsl"\n#pragma include "rand.glsl"\n\n#define SSR_STEPS 8\n\n#define LOD_COLOR 7.0\n#define LOD_DEPTH 5.0\n\nvec3 computeLodNearestPixelSizePowLevel(const in float lodLevelIn, const in float maxLod, const in vec2 size) {\n    float lodLevel = min(maxLod - 0.01, lodLevelIn);\n    float lowerLevel = floor(lodLevel);\n    float higherLevel = min(maxLod, lowerLevel + 1.0);\n\n    float powLevel = pow(2.0, higherLevel);\n    vec2 pixelSize = 2.0 * powLevel / size;\n\n    if (lodLevel - lowerLevel > 0.5) powLevel *= 2.0;\n    return vec3(pixelSize, powLevel);\n}\n\n// lerping between 2 mipmap is too costly (with no notable quality gain in the end)\nvec2 computeLodUVNearest(const in vec2 uvIn, const in vec3 pixelSizePowLevel) {\n    // border pixel issue with bilinear...\n    vec2 uv = max(pixelSizePowLevel.xy, min(1.0 - pixelSizePowLevel.xy, uvIn));\n    return vec2(2.0 * uv.x, pixelSizePowLevel.z - 1.0 - uv.y) / pixelSizePowLevel.z;\n}\n\nfloat fetchDepthLod(const in sampler2D depthTex, const in vec2 uv, const in vec2 nearFar, const in vec3 pixelSizePowLevel, const in vec2 ratio) {\n#ifdef DEPTH_MIPMAP\n    vec2 uvNearest = computeLodUVNearest(uv, pixelSizePowLevel);\n    float depth =  decodeDepth(texture2D(depthTex, uvNearest * ratio));\n#else\n    float depth = decodeDepth(texture2D(depthTex, uv * ratio));\n#endif\n\n    if (depth >= 1.0) return -nearFar.y * 100.0; // very far so it won\'t reflect background\n    return -nearFar.x - depth * (nearFar.y - nearFar.x);\n}\n\nvec4 fetchDepthLod(const in sampler2D depthTex, const in vec4 uv0, const in vec4 uv1, const in vec2 nearFar, const in vec3 pixelSizePowLevel, const in vec2 ratio) {\n    vec4 result = vec4(0.0);\n    result.x = fetchDepthLod(depthTex, uv0.xy, nearFar, pixelSizePowLevel, ratio);\n    result.y = fetchDepthLod(depthTex, uv0.zw, nearFar, pixelSizePowLevel, ratio);\n    result.z = fetchDepthLod(depthTex, uv1.xy, nearFar, pixelSizePowLevel, ratio);\n    result.w = fetchDepthLod(depthTex, uv1.zw, nearFar, pixelSizePowLevel, ratio);\n    return result;\n}\n\nvec3 ssrViewToScreen(const in mat4 projection, const in vec3 viewVertex) {\n    vec4 projected = projection * vec4(viewVertex, 1.0);\n    return vec3(0.5 + 0.5 * projected.xy / projected.w, projected.w);\n}\n\nvec3 fetchColorLod(const in float level, const in sampler2D colorTex, const in vec2 refractionSize, const in vec2 ratio, const in vec2 uv) {\n    vec3 pixelSizePowLevel = computeLodNearestPixelSizePowLevel(LOD_COLOR * level, LOD_COLOR, refractionSize); \n    vec2 uvNearest = computeLodUVNearest(uv, pixelSizePowLevel);\n    return decodeRGBM(texture2D(colorTex, uvNearest * ratio), 7.0);\n}\n\n// #define HASHSCALE1 .1031\n// #define HASHSCALE3 vec3(.1031, .1030, .0973)\n// #define HASHSCALE4 vec4(.1031, .1030, .0973, .1099)\n\n// vec2 hash23(vec3 p3)\n// {\n//     p3 = fract(p3 * HASHSCALE3);\n//     p3 += dot(p3, p3.yzx + 19.19);\n//     return fract((p3.xx + p3.yz) * p3.zy);\n// }\n\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Private/ScreenSpaceReflections.usf#L143\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Private/MonteCarlo.ush#L169\nvec3 unrealImportanceSampling(const in float frameMod, const in vec3 tangentX, const in vec3 tangentY, const in vec3 tangentZ, const in vec3 eyeVector, const in float rough4) {\n    vec2 E;\n\n    // could be improved (visible patterns)\n    E.x = interleavedGradientNoise(gl_FragCoord.yx, frameMod);\n    E.y = fract(E.x * 52.9829189);\n    // E = hash23(vec3(gl_FragCoord.xy + frameMod * 150.2420, frameMod * 100.0));\n\n    // Reduces BRDF tail is noisy, we clamp it\n    // https://www.slideshare.net/DICEStudio/stochastic-screenspace-reflections#p=67\n    E.y = mix(E.y, 1.0, 0.7);\n\n    float phi = 2.0 * 3.14159 * E.x;\n    // float cosTheta = sqrt((1.0 - E.y) / (1.0 + (rough4 - 1.0) * E.y)); // ggx (long tail, more noisy)\n    float cosTheta = pow(max(E.y, 0.000001), rough4 / (2.0 - rough4)); // blinn\n    float sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n\n    vec3 h = vec3(sinTheta * cos(phi), sinTheta * sin(phi), cosTheta);\n    h = h.x * tangentX + h.y * tangentY + h.z * tangentZ;\n    return normalize((2.0 * dot(eyeVector, h)) * h - eyeVector);\n}\n\nfloat getStepOffset(const in float frameMod) {\n    return (interleavedGradientNoise(gl_FragCoord.xy, frameMod) - 0.5);\n}\n\nvec3 computeRayDirUV(const in vec3 rayOriginUV, const in float rayLen, const in vec3 viewVertex, const in vec3 rayDirView, const in mat4 projection) {\n    vec3 rayDirUV = ssrViewToScreen(projection, viewVertex.xyz + rayDirView * rayLen);\n    rayDirUV.z = 1.0 / rayDirUV.z;\n    rayDirUV -= rayOriginUV;\n\n    // clip the line to the viewport edges\n    // https://github.com/godotengine/godot/blob/master/drivers/gles3/shaders/screen_space_reflection.glsl#L124\n    float scaleMaxX = min(1.0, 0.99 * (1.0 - rayOriginUV.x) / max(1e-5, rayDirUV.x));\n    float scaleMaxY = min(1.0, 0.99 * (1.0 - rayOriginUV.y) / max(1e-5, rayDirUV.y));\n    float scaleMinX = min(1.0, 0.99 * rayOriginUV.x / max(1e-5, -rayDirUV.x));\n    float scaleMinY = min(1.0, 0.99 * rayOriginUV.y / max(1e-5, -rayDirUV.y));\n    return rayDirUV * min(scaleMaxX, scaleMaxY) * min(scaleMinX, scaleMinY);\n}\n\n#define SSR_RAY_FETCH() \\\nsampleUV = rayOriginUV + rayDirUV * diffSampleW.y; \\\ndepth = fetchDepthLod(depthTex, sampleUV.xy, nearFar, pixelSizePowLevel, depthRatio); \\\ndepthDiff = -1.0 / sampleUV.z - depth; \\\nhit = abs(depthDiff + depthTolerance) < depthTolerance; \\\ntimeLerp = clamp(diffSampleW.x / (diffSampleW.x - depthDiff), 0.0, 1.0); \\\nhitTime = hit ? (diffSampleW.y + timeLerp * invNumSteps - invNumSteps) : 1.0; \\\ndiffSampleW.z = min(diffSampleW.z, hitTime); \\\ndiffSampleW.x = depthDiff; \\\ndiffSampleW.y += invNumSteps; \\\n\n#define SSR_RAY_UNROLLED() \\\nSSR_RAY_FETCH() \\\nSSR_RAY_FETCH() \\\nSSR_RAY_FETCH() \\\nSSR_RAY_FETCH() \\\nSSR_RAY_FETCH() \\\nSSR_RAY_FETCH() \\\nSSR_RAY_FETCH() \\\nSSR_RAY_FETCH() \\\n\nvec4 rayTraceUnrealSimple(\n    const in vec3 rayOriginUV,\n    const in float rayLen,\n    in float depthTolerance,\n    const in vec3 viewVertex,\n    const in vec3 rayDirView,\n    const in mat4 projection,\n    const in sampler2D depthTex,\n    const in vec2 depthRatio,\n    const in vec2 nearFar,\n    const in float boxRadius,\n    const in float roughness,\n    const in vec2 depthSize,\n    const in float frameMod,\n    const in float quality) {\n\n    vec3 pixelSizePowLevel = computeLodNearestPixelSizePowLevel(LOD_DEPTH * roughness, LOD_DEPTH, depthSize); \n\n    float invNumSteps = 1.0 / float(SSR_STEPS);\n    if (quality > 1.0) invNumSteps /= 2.0;\n\n    depthTolerance *= invNumSteps;\n\n    vec3 rayDirUV = computeRayDirUV(rayOriginUV, rayLen, viewVertex, rayDirView, projection);\n\n    float sampleTime = getStepOffset(frameMod) * invNumSteps + invNumSteps;\n    vec3 diffSampleW = vec3(0.0, sampleTime, 1.0);\n\n    vec3 sampleUV;\n    float depth, depthDiff, timeLerp, hitTime;\n    bool hit;\n\n    SSR_RAY_UNROLLED()\n    if (quality > 1.0) { SSR_RAY_UNROLLED() }\n\n    // alternative : ray refinement around the intersected cell\n    // if (quality > 1.0) {\n    //     rayOriginUV = rayOriginUV + rayDirUV * diffSampleW.z - rayDirUV * invNumSteps * 0.5;\n    //     diffSampleW = vec3(0.0, sampleTime, 1.0);\n    //     rayDirUV *= invNumSteps;\n    //     depthTolerance *= invNumSteps;\n    //     SSR_RAY_UNROLLED()\n    // }\n\n    return vec4(rayOriginUV + rayDirUV * diffSampleW.z, 1.0 - diffSampleW.z);\n}\n\nvec4 fetchColorContribution(\n    in vec4 resRay,\n    const in float maskSsr,\n    const in vec3 specularEnvironment,\n    const in vec3 specularColor,\n    const in mat4 reprojectViewProj,\n    const in float roughness,\n    const in vec2 previousSize,\n    const in vec2 previousRatio,\n    const in sampler2D colorTex,\n    const in vec4 corners[2]) {\n\n    // reprojection\n    vec4 AB = mix(corners[0], corners[1], resRay.x);\n    resRay.xyz = vec3(mix(AB.xy, AB.zw, resRay.y), 1.0) * -1.0 / resRay.z;\n    resRay.xyz = (reprojectViewProj * vec4(resRay.xyz, 1.0)).xyw;\n    resRay.xy /= resRay.z;\n\n    // fade edge of screen\n    float maskEdge = clamp(6.0 - 6.0 * max(abs(resRay.x), abs(resRay.y)), 0.0, 1.0);\n\n    resRay.xy = 0.5 + 0.5 * resRay.xy;\n\n    vec3 fetchColor = specularColor * fetchColorLod(roughness * (1.0 - resRay.w), colorTex, previousSize, previousRatio, resRay.xy);\n\n    // fade ray count\n    // maskEdge *= resRay.w;\n\n    return vec4(mix(specularEnvironment, fetchColor, maskSsr * maskEdge), 1.0);\n}\n\n#pragma DECLARE_FUNCTION\nvec3 ssr(\n    const in float quality,\n    const in float frameMod,\n    const in float ssrFactor,\n\n    const in vec3 specularEnvironment,\n    const in vec3 specularColor,\n    const in float roughness,\n\n    const in vec3 normal,\n    const in vec3 eyeVector,\n    const in vec3 viewVertex,\n    const in float boxRadius,\n\n    const in sampler2D colorTex,\n    const in sampler2D depthTex,\n    const in vec2 mipmapSize,\n\n    const in vec2 nearFar,\n    const in vec2 currentRatio,\n\n    const in vec2 previousSize,\n    const in vec2 previousRatio,\n    const in vec4 previousHalton,\n\n    const in mat4 reprojectViewProj,\n    const in mat4 projection,\n\n    const in mat4 previousProjection,\n    const in mat4 previousViewInvView,\n\n    const in vec4 corners[2]\n    ) {\n\n    #ifdef DEPTH_MIPMAP\n        mat4 proj = previousProjection;\n        vec2 ratio = previousRatio;\n    #else\n        mat4 proj = projection;\n        vec2 ratio = currentRatio;\n    #endif\n\n    vec4 result = vec4(0.0);\n\n    // precompute importance sampling roughness^4\n    float rough4 = roughness * roughness;\n    rough4 = rough4 * rough4;\n\n    // precompute importance sampling basis tangent\n    vec3 upVector = abs(normal.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\n    vec3 tangentX = normalize(cross(upVector, normal));\n    vec3 tangentY = cross(normal, tangentX);\n\n    // fade ray that points toward camera\n    float maskSsr = ssrFactor * clamp(-4.0 * dot(eyeVector, normal) + 3.8, 0.0, 1.0);\n    maskSsr *= clamp(4.7 - roughness * 5.0, 0.0, 1.0); // fade out ssr for high roughness values\n\n    // compute ray uv origin\n    vec3 rayOriginUV = ssrViewToScreen(projection, viewVertex.xyz);\n    rayOriginUV.z = 1.0 / rayOriginUV.z;\n\n    // direction of reflection\n    vec3 rayDirView = unrealImportanceSampling(frameMod, tangentX, tangentY, normal, eyeVector, rough4);\n\n    // if reflection is toward us, we cast [near, vertex], otherwise [vertex, far]\n    float rayLen = mix(nearFar.y + viewVertex.z, -viewVertex.z - nearFar.x, rayDirView.z * 0.5 + 0.5);\n    float depthTolerance = 0.5 * rayLen;\n\n    // ray under the surface (normalmap or inverted normal)\n    if (dot(rayDirView, normal) > 0.001 && maskSsr > 0.0) {\n        vec4 resRay = rayTraceUnrealSimple(rayOriginUV, rayLen, depthTolerance, viewVertex, rayDirView, proj, depthTex, ratio, nearFar, boxRadius, roughness, mipmapSize, frameMod, quality);\n        if (resRay.w > 0.0) result += fetchColorContribution(resRay, maskSsr, specularEnvironment, specularColor, reprojectViewProj, roughness, previousSize, previousRatio, colorTex, corners);\n    }\n\n    // if (quality > 0.4) {\n    //     for (int i = 1; i < 4; ++i) {\n    //         float frameRay = frameMod + float(i) * 50.0;\n    //         rayDirView = unrealImportanceSampling(frameRay, tangentX, tangentY, normal, eyeVector, rough4);\n    //         rayLen = mix(nearFar.y + viewVertex.z, -viewVertex.z - nearFar.x, rayDirView.z * 0.5 + 0.5);\n    //         depthTolerance = 0.5 * rayLen;\n\n    //         if (dot(rayDirView, normal) > 0.001) {\n    //             vec4 resRay = rayTraceUnrealSimple(rayOriginUV, rayLen, depthTolerance, viewVertex, rayDirView, proj, depthTex, ratio, nearFar, boxRadius, roughness, mipmapSize, frameRay, quality);\n    //             if (resRay.w > 0.0) result += fetchColorContribution(resRay, maskSsr, specularEnvironment, specularColor, reprojectViewProj, roughness, previousSize, previousRatio, colorTex, corners);\n    //         }\n    //     }\n    // }\n\n    return result.w > 0.0 ? result.rgb / result.w : specularEnvironment;\n}\n'},function(e,t){e.exports="attribute vec3 Vertex;\n\n#ifdef ICON\n attribute vec2 TexCoord0;\n varying vec2 vTexCoord0;\n#else\n varying vec3 pos;\n#endif\n\n\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n  #ifdef ICON\n    vTexCoord0 = TexCoord0;\n  #else\n    pos = Vertex.xyz;\n  #endif\n\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xyz, 1.0));\n}\n"},function(e,t){e.exports="\nuniform float uAlpha;\n\nuniform vec4 uColor;\n\nuniform float uUp;\nuniform float uDown;\n\n#ifdef ICON\n    uniform sampler2D uTextureIcon;\n    varying vec2 vTexCoord0;\n#else\n    varying vec3 pos;\n#endif\n\nvoid main(void) {\n\n    #ifdef ICON\n        gl_FragColor = vec4(uColor.rgb, uAlpha) * texture2D(uTextureIcon, vTexCoord0);\n    #else\n        float alpha = step(pos.x, uUp) * step(uDown, pos.x);\n        gl_FragColor = vec4(uColor.rgb, uAlpha * alpha);\n    #endif\n\n    gl_FragColor.rgb *= gl_FragColor.a;\n}\n"},function(e,t,i){e.exports=i.p+"target-0866e5fb9cf68854331bdbfb5fa4b4dc.png"},function(e,t,i){e.exports=i.p+"eye-slash-8e28e3d3425c918e878de1aba50dab7b.png"},function(e,t,i){e.exports=i.p+"Direction-da0354ccc70bc3322aa657cdcd356e39.png"},function(e,t,i){e.exports=i.p+"Spot-7484bdcd407b8b2416471e8e6cd23770.png"},function(e,t,i){e.exports=i.p+"Point-7493691bc0625a4c8a09393c65c39e5c.png"},function(e,t,i){e.exports=i.p+"Hemi-069d53239a191b55450d472c13408320.png"},function(e,t,i){e.exports=i.p+"Sound-c9d6e5b9ed6c02f1dfaea84e549485c1.png"},function(e,t,i){e.exports=i.p+"Hotspot-091f212d5a1a99daeaa8089a72d1cb80.png"},function(e,t,i){"use strict";var r=i(686),a=i.n(r),n={initGestures:function(e){var t=e.getInputSource("TouchScreen");if(t){var i=t.getHammer();i.get("pan").set({enable:!1});var r=new a.a.Pinch({enable:!0,threshold:.1}),n=new a.a.Pan({event:"panh",direction:a.a.DIRECTION_HORIZONTAL}),o=new a.a.Pan({event:"panv",direction:a.a.DIRECTION_VERTICAL});o.requireFailure(n),n.requireFailure(r),i.add(n),i.add(o),i.add(r)}}};t.a=n},function(e,t,i){"use strict";var r=i(5),a=i(34),n=i(704),o=i(608),s=r.a.osg,u=r.a.osgAnimation,l=function(e,t,i){this.cameraUpdateCallback=i,this._fpsDist=-1,this._manipulator=e,this._eyeEnd=s.vec3.create(),this._eyeDeltaLen=0,this._targetEnd=s.vec3.create(),this._targetDeltaLen=0,this._lastRatio=0,this._preventFlip=!1,n.a.call(this,t),this._finished=!0};s.createPrototypeObject(l,s.objectInherit(n.a.prototype,{setTargetAndEye:function(){var e=s.vec3.create();return function(t,i,r){if(this._preventFlip=r,this._finished){var a=this._manipulator.getManipulatorList()[o.a.FPS];this._fpsDist=a.getDistance()}s.vec3.copy(this._eyeEnd,i),this._manipulator.getEyePosition(e),this._eyeDeltaLen=s.vec3.len(s.vec3.sub(e,i,e)),s.vec3.copy(this._targetEnd,t),this._manipulator.getTarget(e),this._targetDeltaLen=s.vec3.len(s.vec3.sub(e,t,e)),this._lastRatio=0,this.reset()}}(),update:function(){var e=s.vec3.create(),t=s.vec3.create(),i=s.vec3.create(),r=s.vec3.create();return function(n,l){if(!0===this._finished)return!0;var c=this._manipulator,h=c.getCurrentManipulatorIndex();h===o.a.FPS&&c.setManipulatorIndex(o.a.ORBIT);var d=l.getFrameStamp().getSimulationTime(),p=this.interpolate(d,n,l);p=u.easeOutQuart(p);var f=p-this._lastRatio;this._lastRatio=p;var m=this._manipulator;if(m.getEyePosition(e),m.getTarget(t),s.vec3.sub(i,this._targetEnd,t),s.vec3.normalize(i,i),s.vec3.add(r,t,s.vec3.scale(r,i,f*this._targetDeltaLen)),m.setTarget(r),s.vec3.sub(i,this._eyeEnd,e),s.vec3.normalize(i,i),s.vec3.add(r,e,s.vec3.scale(r,i,f*this._eyeDeltaLen)),m.setEyePosition(r,this._preventFlip),h===o.a.FPS){var g=c.getDistance();c.setManipulatorIndex(h),c.getCurrentManipulator().setDistance(this._finished?this._fpsDist:g)}return!0===this._finished&&a.a.resolveFirstCameraAnimation(),this.cameraUpdateCallback(),!0}}()}),"osgSketchfab","UpdateCallbackCameraAnimation"),t.a=l},function(e,t,i){"use strict";var r=i(62),a=i(1189),n=i(705),o=n.a.extend({_textureTrashbin:[],_matcapTrashbin:[],getName:function(){return"Material"}}),s={FeatureName:"material",ModelType:o,ViewListType:[a.a]},u=r.a.create(s);u.prototype.getSceneLights=function(){return this._views[0].getSceneLights()},t.a=u},function(e,t,i){"use strict";var r=i(7),a=i.n(r),n=i(5),o=i(0),s=(i.n(o),i(83)),u=i(8),l=i(34),c=i(16),h=i(59),d=i(1190),p=i(1200),f=i(187),m=i(113),g=i(93),_=i(857),v=i(556),b=i(1203),y=i(70),x=i(47),S=i(251),M=n.a.osg,w=u.a.extend({getName:function(){return"MaterialManagerView3D"},initialize:function(){u.a.prototype.initialize.apply(this,arguments),this.model.bind("change",this.render,this),g.a.bind("change:mask",this.cleanAndApplyMaterials,this),this._sceneLights=[],this._defaultStateSet=void 0,this._defaultMaterial=void 0,this._tracePathVisitor=new p.a,this.model.setImageCollection(this.getTextureCollection()),this.model.setMatcapCollection(this.getMatcapCollection()),this.init()},init:function(){this._context=this.options.context,this._viewer=this._context.getViewer();var e=this._context.getScene();this._resourceDefer=new s.a,e.addResourcePromise(this._resourceDefer),l.a.getPolygon().then(this.initSceneGraph.bind(this))},getTextureCollection:function(){return this.getResourceManager().getTextureCollection()},getMatcapCollection:function(){return this.getResourceManager().getMatcapCollection()},getResourceManager:function(){return this._resourceManager||h.default.instance},getOrCreateDefaultStateSet:function(){return void 0===this._defaultStateSet&&(this._defaultStateSet=new M.StateSet,this._defaultStateSet._uniqueID=0),this._defaultStateSet},setDefaultMaterial:function(e,t){var i=this.getOrCreateDefaultStateSet();if(e.setStateSet(i),!this._defaultMaterial){if(this._defaultMaterial=t.getMaterialByStateSet(i),this._defaultMaterial){var r=i.getAttributeMap().Material,a=t.getUniqueMaterialName(r,i,e);this._defaultMaterial.set("name",a)}else this._defaultMaterial=t.createMaterial(e,i);this._defaultMaterial.setStateSet(i)}},addDefaultMaterial:function(e,t,i){0===e.getMaterials().length&&this.setDefaultMaterial(t,i);for(var r=this._tracePathVisitor.getPathList(),a=0,n=r.length;a<n;++a){for(var o=r[a],s=o.length,u=!1,l=0;l<s;++l){var c=o[l].getStateSet();if(c&&c.getAttribute("SketchfabMaterial")){u=!0;break}}if(!u){var h=o[s-1];this.setDefaultMaterial(h,i)}}},_handleCullFace:function(e){var t=this._context.getModel().get("options"),i=e.userDataMap.sourceTool.toLowerCase(),r=Object(c.a)().singleSided,a=-1!==i.indexOf("sketchup"),n=a&&t.version<6,o=a&&Object(y.a)();if(void 0!==r||o||n){var s=!1===r?M.CullFace.DISABLE:M.CullFace.BACK,u=this.model.getMaterials();for(var l in u)u[l].set("cullFace",s)}},processSceneGraph:function(e,t){var i=new d.a(t),r=i.apply(e);if(e.accept(this._tracePathVisitor),this.deleteUnusedMaterials(this._tracePathVisitor),this.addDefaultMaterial(r,e,t),this._sceneLights=r.getLights(),this._handleCullFace(e),Object(y.a)()&&"substancepainter"===e.userDataMap.source){this._viewer.getFeatures().shadingStyle.getModel().set("vertexColorEnable",!1)}return r},getSceneLights:function(){return this._sceneLights},initSceneGraph:function(){var e=this.model,t=this._viewer.getRootModel(),i=this._viewer.getFeatures();if(M.time("initSceneGraph - create saved materials"),!1===Object(c.a)().processMaterial){var r=this._context.getModel().get("options").materials;for(var a in r)e.addMaterial(r[a])}M.timeEnd("initSceneGraph - create saved materials"),M.time("initSceneGraph - processSceneGraph");var n=this.processSceneGraph(t,e);M.timeEnd("initSceneGraph - processSceneGraph"),M.time("initSceneGraph - apply materials"),e.removeUnboundMaterial();var o=i.shadingStyle.getModel(),s=o.get("vertexColorEnable")&&o.get("vertexColorUseAlpha");e.tagMaterialWithGeometryInfo(t,s),this._requestTextures(),e._style=n.getStyle();var u=n.hasMetallicWorkflow();void 0!==u&&e.setWorkFlowMetalSpec(u,!1),e.overrideMaterialChannels(Object(c.a)()),e.updateTexCoordUnitList(),S.a.set("protectDepthAndColorUnit",this._checkProtectDepthColor()),this.applyMaterials(),this.setWireframeStateSets(),M.timeEnd("initSceneGraph - apply materials"),b.a.optimize(this._tracePathVisitor,this._viewer),i.quality&&i.quality.getModel().trigger("updateTexelPolicy"),l.a.resolveMaterial(),v.a.packAllMaterialsTextures(e.getMaterials())},_checkProtectDepthColor:function(){if(window.RunningTests)return!1;if(Object(x.a)()||Object(c.a)().materialShowcase||Object(c.a)().apiVersion)return!0;if(this._viewer.getFeatures().postProcess.getModel().isEffectiveSsr())return!0;var e=this.model.getMaterials();for(var t in e){var i=e[t],r=i.getChannels().Opacity;if(r.isEffective()&&"refraction"===r.getTransparency())return!0}return!1},setWireframeStateSets:function(){if(this._viewer.hasIntegratedWireframe()){var e=0,t=this.model,i={},r=this._tracePathVisitor.getPathList(),a=r.length;for(e=0;e<a;++e){var n=r[e],o=n[n.length-1];if(o instanceof M.Geometry!=!1){var s=o.getVertexAttributeList().Vertex;s&&(i[s.getInstanceID()]=n)}}var u={},l=this._tracePathVisitor.getWireframePathList(),c=this._context.getScene().getWireframeNodes(),h=c.length;for(e=0;e<h;++e){var d=c[e],p=d.getVertexAttributeList(),f=i[p.Vertex.getInstanceID()];if(f){var m=f[f.length-1],g=t.findFirstMaterial(f);g.get("wireframeList").push(d);var v=g.get("stateSet");d._attributes=m.getVertexAttributeList();var b=v.getAttribute("SketchfabMaterial"),y=b.getInstanceID(),x=u[y];x||(x=u[y]=new _.a,x._textureAttributeArrayList=v._textureAttributeArrayList,x._activeTextureAttributeUnit=v._activeTextureAttributeUnit,x._activeTextureAttribute=v._activeTextureAttribute,x.setAttributeAndModes(b),b.getMaterialModel().set("stateSetWireframe",x)),d.setStateSet(x)}else{c.splice(e,1),e--,h--;for(var S=d.getParents(),w=0,T=S.length;w<T;++w)S[w].removeChild(d);for(var C=0;C<l.length;++C){var E=l[C];E[E.length-1]===d&&(l.splice(C,1),C--)}}}}},deleteUnusedMaterials:function(e){for(var t=e.getStateSetMapNodes(),i=e.getStateSetPathList(),r=e.getStateSetMap(),a={},n=0,o=i.length;n<o;n++){var s=i[n];if(s.length>0){var u=s.length-1;a[s[u]._uniqueID]=s[u]}}for(var l in t)if(void 0===a[l]){this.model.removeMaterialByStateSet(r[l]);for(var c=0,h=t[l].length;c<h;c++){var d=t[l][c];d.setStateSet(void 0)}}},cleanAndApplyMaterials:function(){var e=this.model.getMaterials();for(var t in e){var i=e[t];i.get("stateSet")&&i.trigger("change:stateSet")}this.applyMaterials()},applyMaterials:function(){var e=this.model.getMaterials();for(var t in e){e[t].trigger("apply")}},_requestTexture:function(e,t,i){if(e){var r=e.getChannels()[t],a=r.getTextureModel();if(a&&r.isEffective()){var n=a.getMultiresTexture();if(n){if(0===n.getImageCount())return void r.setColor(M.vec3.fromValues(.9,.9,.9));return(i?n.getImageSmallest():n.getImageMaxSupported()).promise}}}},_requestAllTextures:function(e,t){for(var i=[],r=new window.Set,a=0;a<m.a.length;++a){var n=m.a[a];for(var o in e){var s=e[o],u=this._requestTexture(s,n,t);u&&!r.has(u)&&(r.add(u),i.push(u))}}return i},_resolvePromiseTextures:function(e,t,i){for(var r=(new Date).getTime()-t,a=0,n=0,o=e.length;n<o;++n)!0!==e[n]&&a++;(i?l.a.resolveLowResLoaded:l.a.resolveHighResLoaded)({time:a>0?r:0,count:a})},requestAllLowResTextures:function(e){return this._requestAllTextures(e,!0)},requestAllHighResTextures:function(e){for(var t=this._requestAllTextures(e,!1),i=0,r=0,a=t.length;r<a;r++)i+=t[r].progressSize;return l.a.resolveDataSizeTextures(i),t},_resolvePromiseLowResTextures:function(e,t){return this._resolvePromiseTextures(e,t,!0)},_resolvePromiseHighResTextures:function(e,t){return this._resolvePromiseTextures(e,t,!1)},_requestTextures:function(){var e=this,t=Object(c.a)(),i=t.preload;f.a.WAIT_ANIMATION=!i;var r=this.model.toJSON(),n=this.requestAllLowResTextures(r),s=(new Date).getTime();i||this._viewer.setFakePrimaryProgress(n,"texture"),a.a.all(Object(o.map)(n,function(e){return e.reflect()})).then(function(){e._resolvePromiseLowResTextures(n,s);var t=(new Date).getTime(),u=e.requestAllHighResTextures(r);e._viewer.setFakeProgress(u,!i,"texture"),a.a.all(Object(o.map)(u,function(e){return e.reflect()})).then(function(){e._resolvePromiseHighResTextures(u,t),i&&e._resourceDefer.resolve()}),i||e._resourceDefer.resolve()})},_getUniqueTextures:function(){var e={},t=this.model.getMaterials(),i=[];for(var r in t)for(var a=t[r],n=a.get("stateSet"),o=n.getNumTextureAttributeLists(),s=0;s<o;++s){var u=n.getTextureAttribute(s,"Texture");u&&u.getChannelPacking&&(u.isTextureNull()||u.isColorAtlas()||e[u.getInstanceID()]||(e[u.getInstanceID()]=!0,i.push(u)))}return i},getOrCreateTexelInfos:function(){if(this._infoTex)return this._infoTex;for(var e=this._infoTex={missingTextures:{},gpuTextureCount:0,gpuPixelCount:0,min:1/0,max:-1/0},t={width:0,height:0,missingTextures:e.missingTextures},i=this._getUniqueTextures(),r=i.length,a=0;a<r;++a){t=i[a].getMaxTextureSizePacked(t),e.gpuTextureCount++,e.gpuPixelCount+=t.width*t.height;var n=Math.max(t.width,t.height);e.min=Math.min(n,e.min),e.max=Math.max(n,e.max)}return e}});t.a=w},function(e,t,i){"use strict";var r=i(1191),a=i(1192),n=i(144),o=i(70),s=function(e){this._materialManager=e};s.prototype={apply:function(e){var t=new r.a;e.accept(t);var i=t.getSource(),s=t.getAuthoringTool();i=i?i.toLowerCase():"default";var u=a.a[i]?a.a[i]:a.a.default,l=new u(this._materialManager,s,i);e.accept(l),Object(o.a)()&&l.handleSingleMaterialMapping();var c=!n.a.hasTriangles&&!n.a.hasVertexNormals;("q3d"===i||c)&&(l._style="shadeless");var h=e.getUserData()||[];return h.push({Name:"source",Value:i}),h.push({Name:"authoringTool",Value:s}),h.push({Name:"sourceTool",Value:t.getSourceTool()}),e.setUserData(h),e.userDataMap=n.a.convertUserDataToObject(h),l}},t.a=s},function(e,t,i){"use strict";var r=i(5),a=r.a.osg,n=function(){a.NodeVisitor.call(this,a.NodeVisitor.TRAVERSE_ALL_CHILDREN),this._source="",this._authoringTool="",this._sourceTool=""};a.createPrototypeObject(n,a.objectInherit(a.NodeVisitor.prototype,{getSource:function(){return this._source},getAuthoringTool:function(){return this._authoringTool},getSourceTool:function(){return this._sourceTool},extractSource:function(e){for(var t=0,i=e.length;t<i;++t){var r=e[t],a=r.Name;"source"===a?this._source=r.Value:"authoring_tool"===a?this._authoringTool=r.Value:"source_tool"===a&&(this._sourceTool=r.Value)}},checkStateSet:function(e){e&&e.getUserData()&&this.extractSource(e.getUserData())},checkNode:function(e){var t=e.getUserData();if(!t){if("LightSource"!==e.className())return;if(!e.getLight())return;if(!(t=e.getLight().getUserData()))return}this.extractSource(t)},apply:function(e){this._source||(this.checkNode(e),this._source||(this.checkStateSet(e.getStateSet()),this._source||this.traverse(e)))}})),t.a=n},function(e,t,i){"use strict";var r=i(1193),a=i(1194),n=i(1195),o=i(1196),s=i(1197),u=i(1198),l=i(856),c=i(1199);t.a={default:n.a,wavefront:l.a,blender:r.a,ksp:r.a,lightwave:s.a,minecraft:u.a,collada:a.a,fbx:o.a,substancepainter:a.a,mineways:u.a,gltf:c.a}},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(5)),n=i(401),o=i(555),s=i(144),u=a.a.osg,l=function(){n.a.apply(this,arguments)};u.createPrototypeObject(l,u.objectInherit(n.a.prototype,{cyclesNodeToMaterial:function(e,t,i,r,a,n,o,s){var l=e.nodes[a];if(void 0!==l){void 0===s&&(s=a);var c="setChannel"+r;if(void 0===t[c])return void u.warn("material has not method "+c);if(!(o&&n&&l.inputs)&&l.value)return void t[c](s,l.value);for(var h=0;h<l.inputs.length;h++){var d=l.inputs[h];if(d.name===n){var p=d.default_value;if(void 0!==p)if(Array.isArray(p))if("Opacity"===s||"Transparent BSDF"===s||"Glass BSDF"===s)if("Color"===n){var f=p[0]*p[1]*p[2]*p[3];1===f&&(f=.15),t[c](s,f)}else t[c](s,p);else"SpecularPBR"===s?"Color"===n?t[c](s,p):(p=p[0]*p[1]*p[2]*p[3],t[c](s,p)):"Color"===n&&"NormalMap"===s||t[c](s,p);else"setChannelColor"!==s&&"Color"!==r&&("Strength"===n&&"Emission"===a&&(p/=10),t[c](s,p));if(d.links&&"SpecularPBR"!==s){for(var m=0;m<d.links.length;m++){var g=d.links[m];if(g.from_node){var _=e.nodes[g.from_node];if(_){var v=_.texture_slot;if(p=i.getTextureAttribute(v,"Texture")){var b=t.getChannels()[s];b.setupTextureModel(this.createTextureOptionsFromTextureOSG(p)),b.resetTextureFormat(),b.setTexCoordUnit(v),b.setEnable(!0),this._texturesAssigned.push(p)}}void 0!==_&&void 0!==p||u.warn("Missing Texture linked in "+a+" node destined to "+s)}}return}}}l=this.findNodeByValueCyclesMetadata(e.nodes,a),l&&l.value&&t[c](s,l.value)}},findNodeByValueCyclesMetadata:function(e,t){for(var i in e){var r=e[i];if(r instanceof Object){var a=this.findNodeByValueCyclesMetadata(r,t);if(void 0!==a)return a}else if(r===t)return e}},metaDataToMaterial:function(e,t,i,r,a,n){if(void 0!==e[r]){void 0===a&&(a=r);var o="setChannel"+i;if(void 0===t[o])return void u.warn("material has not method "+o);void 0===n||!0===n?t[o](a,JSON.parse(e[r])):t[o](a,e[r])}},setTextureFromBlender:function(e,t,i,r,a){var n=e.getChannels()[t];n.setFactor(a),n.setupTextureModel(this.createTextureOptionsFromTextureOSG(r)),n.setTexCoordUnit(i),n.setEnable(!0)},processDefaultMaterial:function(e,t){t.removeAttribute("Material");for(var i=0,r=t.getNumTextureAttributeLists();i<r;i++)t.removeTextureAttribute(i,"Texture");e.setStateSet(void 0)},processLightSource:function(e){var t=e.getLight();if(t&&void 0!==t.getUserData()&&t.typeID!==o.a.typeID){var i=t.getUserData(),r=s.a.convertUserDataToObject(i),a=new o.a;"AREA"!==r.Type&&"SUN"!==r.Type&&"HEMI"!==r.Type||(r.Type="DIRECTION"),a.setLightType(r.Type),void 0!==r.SpotSize&&a.setSpotCutoff(90*JSON.parse(r.SpotSize)/Math.PI),void 0!==r.SpotBlend&&a.setSpotBlend(JSON.parse(r.SpotBlend)),u.vec3.scale(a.getDiffuse(),JSON.parse(r.Color),JSON.parse(r.Energy));var n=1/JSON.parse(r.Distance);a.setQuadraticAttenuation(Math.abs(n)===1/0?0:n),this.pushLight(a)}},processCyclesGraph:function(e,t,i){var r;try{r=JSON.parse(i.NodeTree)}catch(e){return u.warn("error in blender cycle graph json "+e),!0}if(void 0===r)return!0;this._texturesAssigned=[],this.cyclesNodeToMaterial(r,e,t,"Color","Diffuse BSDF","Color",!0,"DiffusePBR"),this.cyclesNodeToMaterial(r,e,t,"Factor","Diffuse BSDF","Roughness",!0,"RoughnessPBR"),this.cyclesNodeToMaterial(r,e,t,"Color","Diffuse BSDF","Normal",!0,"NormalMap"),this.cyclesNodeToMaterial(r,e,t,"Color","Glossy BSDF","Color",!0,"SpecularPBR"),e.setChannelFactor("SpecularPBR",1),this.cyclesNodeToMaterial(r,e,t,"Factor","Glossy BSDF","Roughness",!0,"RoughnessPBR"),this.cyclesNodeToMaterial(r,e,t,"Color","Glossy BSDF","Normal",!0,"NormalMap"),this.cyclesNodeToMaterial(r,e,t,"Color","Bump","Height",!0,"NormalMap"),this.cyclesNodeToMaterial(r,e,t,"Factor","Bump","Strength",!0,"NormalMap"),this.cyclesNodeToMaterial(r,e,t,"Color","Emission","Color",!0,"EmitColor"),this.cyclesNodeToMaterial(r,e,t,"Factor","Emission","Strength",!0,"EmitColor"),this.cyclesNodeToMaterial(r,e,t,"Color","Ambient Occlusion","Color",!0,"AOPBR"),this.cyclesNodeToMaterial(r,e,t,"Factor","Ambient Occlusion","Strength",!0,"AOPBR"),this.cyclesNodeToMaterial(r,e,t,"Factor","Transparency","Strength",!0,"Opacity"),this.cyclesNodeToMaterial(r,e,t,"Factor","Transparent BSDF","Color",!0,"Opacity"),this.cyclesNodeToMaterial(r,e,t,"Factor","Glass BSDF","Color",!0,"Opacity");for(var a=[],n=0,o=t.getNumTextureAttributeLists();n<o;n++){var s=t.getTextureAttribute(n,"Texture");s&&-1===this._texturesAssigned.indexOf(s)&&a.push(s)}return this.assignPBRTextureFromFilenames(a,e),e.setWorkFlowMetalSpec(!1,!1),e.setWorkFlowRoughGloss(!0,!1),this._hasMetal=!1,!1},processMaterial:function(e,t,i){var a=this.createMaterial(e,t),n=t.getAttribute("Material"),o=n&&n.getUserData(),l=s.a.convertUserDataToObject(o),c=!0;l.NodeTree&&(c=this.processCyclesGraph(a,t,l)),c&&(this.metaDataToMaterial(l,a,"Color","DiffuseColor"),this.metaDataToMaterial(l,a,"Factor","DiffuseIntensity","DiffuseColor"),a.setChannelEnable("DiffuseColor",!0),this.metaDataToMaterial(l,a,"Color","SpecularColor"),this.metaDataToMaterial(l,a,"Factor","SpecularIntensity","SpecularColor"),a.setChannelEnable("SpecularColor",!0),this.metaDataToMaterial(l,a,"Factor","Emit","EmitColor"),a.setChannelEnable("EmitColor",!0),this.metaDataToMaterial(l,a,"Factor","SpecularHardness"),a.setChannelEnable("SpecularHardness",!0),void 0!==l.Translucency&&(a.setChannelFactor("Opacity",1-JSON.parse(l.Translucency)),a.setChannelEnable("Opacity",!0)),void 0!==i.Shadeless&&a.set("shadeless",i.Shadeless));var h=Object(r.chain)(t.getUserData()).map(function(e){var t=e.Name.substr(0,2),i=parseInt(t,10);if(!isNaN(i))return i}).without(void 0).uniq().sortBy(function(e){return e}).value();t.removeAttribute("Material");var d={},p=["DiffuseColor","DiffuseIntensity","SpecularColor","Normal","Bump","Translucency","Alpha","EmitColor","SpecularHardness"],f=this;Object(r.each)(h,function(e){var i=Object(r.chain)(t.getUserData()).filter(function(t){var i=t.Name.substr(0,2);return parseInt(i,10)===e}).value();Object(r.each)(i,function(e){var i=e.Name.substr(0,2),n=parseInt(i,10),o=t.getTextureAttribute(n,"Texture");if(void 0===o)return void u.warn("missing texture");d[n]=o;var s=e.Name.substr(3);if(!0===Object(r.includes)(p,s)){var l=parseFloat(e.Value);"DiffuseColor"===s?void 0!==a.getChannels().DiffuseColor.getTextureModel()&&void 0===a.getChannels().DiffuseIntensity.getTextureModel()&&(s="DiffuseIntensity"):"Alpha"===s?s="Opacity":"Translucency"===s?(s="Opacity",l=1-l):"Normal"===s?s="NormalMap":"Bump"===s&&(s="BumpMap"),f.setTextureFromBlender(a,s,n,o,l)}else"UsePremultiplyAlpha"===s?u.warn("UsePremultiplyAlpha not supported"):"UseAlpha"===s?u.warn("UseAlpha not supported"):u.warn("channel "+s+" not supported")})});for(var m in d)t.removeTextureAttribute(parseInt(m,10),"Texture");"ksp"===l.source&&(-1===a.attributes.name.toLowerCase().indexOf("wheel")?a.getChannels().MetalnessPBR.setFactor(1):a.getChannels().SpecularF0.setFactor(0),-1!==a.attributes.name.toLowerCase().indexOf("fairing")&&a.getChannels().Opacity.setFactor(.25)),a.setStateSet(t)}})),t.a=l},function(e,t,i){"use strict";var r=i(5),a=i(401),n=r.a.osg,o=function(){a.a.apply(this,arguments),this._metaMapColor={emission_color:"EmitColor",diffuse_color:"DiffuseColor",specular_color:"SpecularColor",transparency_color:"Opacity"},this._metaMapFactor={bump_amount:"BumpMap",normal_amount:"NormalMap",shininess_amount:"SpecularHardness",transparency_amount:"Opacity"},this._metaMapTexture={emissive_unit:"EmitColor",diffuse_unit:"DiffuseColor",specular_unit:"SpecularColor",shininess_unit:"SpecularHardness",transparency_unit:"Opacity",bump_unit:"BumpMap",normal_unit:"NormalMap"}};n.createPrototypeObject(o,n.objectInherit(a.a.prototype,{setMaterialChannelColor:function(e,t,i,r){var a=t.getChannels()[i];if(a.setEnable(!0),"Opacity"===i)return void a.setFactor(r[3]);a.setColor(r),"SpecularColor"===i&&a.setFactor(1)},setMaterialChannelFactor:function(e,t,i,r){var a=t.getChannels()[i];if(a.setEnable(!0),"SpecularHardness"===i){r*=128;var o=e.specular_color?JSON.parse(e.specular_color):n.vec3.ZERO;this.setGlossinessPBRFromSpecularGlossiness(t,o,r)}a.setFactor(r)},_extractMetaData:function(e,t,i){for(var r in t)if(r.startsWith(i)){var a=r.substr(i.length+1);e[a]||(e[a]=t[r])}},_cleanMetaData:function(e){var t={};return this._extractMetaData(t,e,"lambert"),this._extractMetaData(t,e,"blinn"),this._extractMetaData(t,e,"phong"),this._extractMetaData(t,e,"extra"),t},processMaterial:function(e,t,i){var r=this.createMaterial(e,t),a=r.getChannels();i=this._cleanMetaData(i),this.setChannelsFromMetaDataFactor(i,r),this.setChannelsFromMetaDataColor(i,r),this.setChannelsFromMetaDataTexture(i,t,r),i.transparency_alphamask&&a.Opacity.getTextureModel()&&a.Opacity.setTransparency("alphaMask"),"substancepainter"===this._source&&a.NormalMap.set("flipY",!1),t.removeAttribute("Material"),r.setStateSet(t)}})),t.a=o},function(e,t,i){"use strict";var r=i(5),a=i(401),n=r.a.osg,o=function(){a.a.apply(this,arguments)};n.createPrototypeObject(o,n.objectInherit(a.a.prototype,{processMaterial:function(e,t){return this.processDefaultMaterial(e,t)},processDefaultMaterial:function(e,t){var i=this.createMaterial(e,t),r=t.getAttribute("Material");return void 0!==r&&(i.setChannelColor("EmitColor",r.getAmbient()),i.setChannelColor("DiffuseColor",r.getDiffuse()),i.setChannelColor("SpecularColor",r.getSpecular()),i.setChannelFactor("SpecularHardness",r.getShininess()),i.setChannelFactor("Opacity",r.getDiffuse()[3]),i.setChannelEnable("EmitColor",!0),i.setChannelEnable("DiffuseColor",!0),i.setChannelEnable("SpecularColor",!0),i.setChannelEnable("SpecularHardness",!0),i.setChannelEnable("Opacity",!0),t.removeAttribute("Material")),this.mapTexturesOnMaterial(t,i),i.setStateSet(t),i}})),t.a=o},function(e,t,i){"use strict";var r=i(5),a=i(401),n=i(555),o=i(144),s=r.a.osg,u=function(){a.a.apply(this,arguments),this._textureFactor1=!0,this._metaMapColor={LambertDiffuseColor:"DiffuseColor",LambertEmissiveColor:"EmitColor",PhongSpecularColor:"SpecularColor"},this._metaMapFactor={LambertDiffuseFactor:"DiffuseColor",LambertBumpFactor:"BumpMap",LambertEmissiveFactor:"EmitColor",PhongSpecularFactor:"SpecularColor",PhongShininess:"SpecularHardness"},this._metaMapTexture={sDiffuse:"DiffuseColor",sNormalMap:"NormalMap",sBump:"BumpMap",sEmissive:"EmitColor",sSpecular:"SpecularColor",sOpacity:"Opacity",sAo:"AOPBR",sRoughness:"RoughnessPBR",sMetallic:"MetalnessPBR"}};s.createPrototypeObject(u,s.objectInherit(a.a.prototype,{setMaterialChannelColor:function(e,t,i,r){var a=t.getChannels()[i];a.setColor(r),a.setEnable(!0)},setMaterialChannelFactor:function(e,t,i,r){var a=t.getChannels()[i];if(a.setFactor(r),a.setEnable(!0),"SpecularHardness"===i){var n=e.PhongSpecularColor?JSON.parse(e.PhongSpecularColor):[0,0,0];this.setGlossinessPBRFromSpecularGlossiness(t,n,r)}},processLightSource:function(e){var t=e.getLight();if(t){var i=t.getUserData();if(void 0!==i&&t.typeID!==n.a.typeID){var r=o.a.convertUserDataToObject(i),a=new n.a;if("directional"===r.Type)a.setLightType("DIRECTION");else if("point"===r.Type)a.setLightType("POINT");else{if("spot"!==r.Type)return;a.setLightType("SPOT")}if("spot"===r.Type){a.setSpotCutoff(JSON.parse(r.OuterAngle)/2);var u=JSON.parse(r.InnerAngle)/JSON.parse(r.OuterAngle);a.setSpotBlend(u!==u||Math.abs(u)===1/0?.5:Math.min(u,1))}s.vec3.scale(a.getDiffuse(),JSON.parse(r.Color),JSON.parse(r.Intensity)/100);var l=1/JSON.parse(r.DecayStart);a.setQuadraticAttenuation(Math.abs(l)===1/0?0:l),this.pushLight(a)}}},processMaterial:function(e,t,i){var r=this.createMaterial(e,t);if(this.setChannelsFromMetaDataColor(i,r),this.setChannelsFromMetaDataFactor(i,r),this.setChannelsFromMetaDataTexture(i,t,r),i.LambertBumpFactor&&!i.sBump&&r.getChannels().BumpMap.setEnable(!1),"Tilt Brush"===this._authoringTool){var a=r.getChannels(),n=a.EmitColor;if(n.set("type","multiplicative"),!n.getTextureModel()){var o=n.getColor();0===o[0]&&0===o[1]&&0===o[2]&&n.setColor(s.vec3.ONE)}a.SpecularF0.setFactor(0),a.RoughnessPBR.setFactor(1);var u=i.BlendMode;"AlphaMask"===u?(a.Opacity.setFactor(JSON.parse(i.LambertTransparencyFactor||0)),a.Opacity.setTransparency("alphaMask")):"AdditiveBlend"===u?(a.Opacity.setFactor(1-JSON.parse(i.LambertTransparencyFactor||0)),a.Opacity.setTransparency("additive")):a.Opacity.setEnable(!1)}t.removeAttribute("Material"),r.setStateSet(t)}})),t.a=u},function(e,t,i){"use strict";var r=i(5),a=i(401),n=r.a.osg,o=function(){a.a.apply(this,arguments),this._metaMapTexture={diffuse:"DiffuseColor",specular:"SpecularColor",transparency:"Opacity"}};n.createPrototypeObject(o,n.objectInherit(a.a.prototype,{processMaterial:function(e,t,i){var r=this.createMaterial(e,t);this.setChannelsFromMetaDataTexture(i,t,r),t.removeAttribute("Material"),r.setStateSet(t)}})),t.a=o},function(e,t,i){"use strict";var r=i(5),a=i(401),n=i(856),o=i(555),s=r.a.osg,u=function(){a.a.apply(this,arguments),this._metaMapColor={kd:"DiffuseColor"},this._metaMapFactor={tr:"Opacity",d:"Opacity"}};s.createPrototypeObject(u,s.objectInherit(n.a.prototype,{isSelfIlluminationSurface:function(e){if(!e.length)return!1;var t=e[0],i=t.getImage().getURL().split("/").pop().split(".").shift();return!!(i.match("carrot_crop_(.*)")||i.match("crops_(.*)")||"fern"===i||"dead_shrub"===i||"flower_red"===i||"flower_yellow"===i||"lilypad"===i||"mushroom_brown"===i||"mushroom_red"===i||i.match("netherwart_(.*)")||i.match("potato_crop_(.*)")||i.match("sapling_(.*)")||"tall_grass"===i||"torch"===i||"torch_flame"===i)},getReferencedTextures:function(e){for(var t=[],i=0;i<e.getNumTextureAttributeLists();i++){var r=e.getTextureAttribute(i,"Texture");void 0!==r&&("PackedMaterialTexture"===r.className()&&(r=r.getTexture()),t[i]=r)}return t},setMaterialChannelTexture:function(e,t,i,r,a,n,o){e.removeTextureAttribute(i,"Texture");var u=t.getChannels()[a],l=this.createTextureOptionsFromTextureOSG(r);l.wrapT=s.Texture[n],l.wrapS=s.Texture[n],o&&(l.minFilter=s.Texture.NEAREST_MIPMAP_LINEAR,l.magFilter=s.Texture.NEAREST),u.setupTextureModel(l),u.setTexCoordUnit(0),u.setEnable(!0)},processMaterial:function(e,t,i){var r=this.createMaterial(e,t);this.setChannelsFromMetaDataColor(i,r),this.setChannelsFromMetaDataFactor(i,r),void 0!==i.ka&&(r.setChannelFactor("EmitColor",.1),r.setChannelEnable("EmitColor",!0)),r.setChannelColor("SpecularColor",s.vec3.create()),r.setChannelEnable("SpecularColor",!0),r.setChannelFactor("SpecularHardness",1),r.setChannelEnable("SpecularHardness",!0),this.checkOpacityFactor(r);var a,n,u="mineways"===i.source,l=this.getReferencedTextures(t),c=this.isSelfIlluminationSurface(l),h=c?"CLAMP_TO_EDGE":"REPEAT";if(void 0!==i.map_kd&&(a=JSON.parse(i.map_kd),void 0!==(n=l[a])&&this.setMaterialChannelTexture(t,r,a,n,"DiffuseColor",h,u)),c||(void 0!==i.map_ke?(a=JSON.parse(i.map_ke),void 0!==(n=l[a])&&(this.setMaterialChannelTexture(t,r,a,n,"EmitColor",h,u),r.setChannelFactor("EmitColor",1))):void 0!==i.map_ka?(a=JSON.parse(i.map_ka),void 0!==(n=l[a])&&this.setMaterialChannelTexture(t,r,a,n,"EmitColor",h,u)):(a=JSON.parse(i.map_kd),void 0!==(n=l[a])&&(this.setMaterialChannelTexture(t,r,a,n,"EmitColor",h,u),r.setChannelFactor("EmitColor",.1)))),c&&(r.set("shadeless",!0),r.setChannelFactor("EmitColor",0),r.setChannelEnable("EmitColor",!0)),void 0!==i.map_d&&(a=JSON.parse(i.map_d),void 0!==(n=l[a]))){this.setMaterialChannelTexture(t,r,a,n,"Opacity",h,u);var d=r.getChannels().Opacity;u?(d.getTextureModel().set("internalFormat",s.Texture.ALPHA),-1!==r.attributes.name.toLowerCase().indexOf("leaves")&&(d.setTransparency("alphaMask"),r.setChannelFactor("Opacity",.2))):(d.getTextureModel().set("internalFormat",s.Texture.LUMINANCE),d.setTransparency("alphaBlend")),r.set("cullFace",s.CullFace.BACK)}if(r.setChannelFactor("RoughnessPBR",1),r.setChannelFactor("SpecularF0",0),!this._lights.length){var p=new o.a;p.setLightType("DIRECTION"),s.vec3.set(p.getDiffuse(),1,1,1),this._lights.push(p),p._worldMatrix=s.mat4.fromRotation(s.mat4.create(),Math.PI/6,s.vec3.fromValues(1,1,0))}t.removeAttribute("Material"),r.setStateSet(t)}})),t.a=u},function(e,t,i){"use strict";var r=i(5),a=i(401),n=r.a.osg,o=function(){a.a.apply(this,arguments),this._textureFactor1=!0,this._metaMapColor={DiffuseColor:"DiffuseColor",SpecularPBRColor:"SpecularPBR",EmissiveColor:"EmitColor"},this._metaMapFactor={DiffuseFactor:"DiffuseColor",EmissiveFactor:"EmitColor",MetallicFactor:"MetalnessPBR",RoughnessFactor:"RoughnessPBR",GlossinessPBRFactor:"GlossinessPBR",SpecularPBRFactor:"SpecularPBR",AOFactor:"AOPBR",NormalFactor:"NormalMap"},this._metaMapTexture={sDiffuse:"DiffuseColor",sMetallic:"MetalnessPBR",sRoughness:"RoughnessPBR",sSpecularPBR:"SpecularPBR",sGlossinessPBR:"GlossinessPBR",sNormalMap:"NormalMap",sEmissive:"EmitColor",sOpacity:"Opacity",sAO:"AOPBR"}};n.createPrototypeObject(o,n.objectInherit(a.a.prototype,{setMaterialChannelColor:function(e,t,i,r){var a=t.getChannels()[i];a.getTextureModel()||(a.setColor(r),a.setFactor(1))},checkWorkflowPBR:function(e){e.sMetallic||e.MetallicFactor||!e.sSpecularPBR&&!e.SpecularPBRColor&&!e.SpecularPBRFactor?this._hasMetal=!0:void 0===this._hasMetal&&(this._hasMetal=!1)},checkWorkflowRoughGloss:function(e){e.RoughnessPBR||e.RoughnessFactor||!e.GlossinessPBR&&!e.GlossinessPBRFactor?this._globalEnforceRoughness=!0:void 0===this._globalEnforceRoughness&&(this._globalEnforceRoughness=!1)},checkAlphaMode:function(e,t){var i=t.getChannels();if(e.alphaMode&&"OPAQUE"!==e.alphaMode){var r=i.Opacity;if(this.hasTextureChannel(t,"DiffuseColor")){var a=i.DiffuseColor,o=a.getTextureModel().clone();o.set("internalFormat",n.Texture.ALPHA),o.updateMultiresTexture(),r.setTextureModel(o),r.setTexCoordUnit(a.getTexCoordUnit())}"BLEND"===e.alphaMode?r.setFactor(JSON.parse(e.OpacityFactor||1)):"MASK"===e.alphaMode&&(r.setTransparency("alphaMask"),r.setFactor(JSON.parse(e.alphaCutoff||0)))}},checkNormalMap:function(e,t){t.getChannels().NormalMap.set("flipY",void 0!==e.yUp&&!1===JSON.parse(e.yUp))},checkCullFace:function(e,t){void 0!==e.doubleSided&&!1!==JSON.parse(e.doubleSided)||t.set("cullFace",n.CullFace.BACK)},processMaterial:function(e,t,i){var r=this.createMaterial(e,t);this.checkWorkflowPBR(i),this.checkWorkflowRoughGloss(i),this.setChannelsFromMetaDataTexture(i,t,r),this.setChannelsFromMetaDataFactor(i,r),this.setChannelsFromMetaDataColor(i,r),this.checkAlphaMode(i,r),this.checkNormalMap(i,r),this.checkCullFace(i,r),r.getChannels().AOPBR.set("occludeSpecular",!0),this.copyDiffuse(r),t.removeAttribute("Material"),r.setStateSet(t)}})),t.a=o},function(e,t,i){"use strict";var r=i(5),a=r.a.osg,n=function(){a.NodeVisitor.call(this,a.NodeVisitor.TRAVERSE_ALL_CHILDREN),this._paths=[],this._pathsStateSet=[],this._currentStateSet=[],this._stateSetMap={},this._stateSetMapNodes={},this._wireframePaths=[],this._noGeometryPaths=[],this.nodeMaskOverride=-1};a.createPrototypeObject(n,a.objectInherit(a.NodeVisitor.prototype,{getPathList:function(){return this._paths},getStateSetMap:function(){return this._stateSetMap},getStateSetMapNodes:function(){return this._stateSetMapNodes},getStateSetPathList:function(){return this._pathsStateSet},getWireframePathList:function(){return this._wireframePaths},getNoGeometryPathList:function(){return this._noGeometryPaths},apply:function(e){var t=e.getStateSet();if(t){var i=t._uniqueID;this._stateSetMap[i]||(this._stateSetMap[i]=t,this._stateSetMapNodes[i]=[]),this._stateSetMapNodes[i].push(e),this._currentStateSet.push(t)}e instanceof a.Geometry?e.userDataMap&&e.userDataMap.wireframe?this._wireframePaths.push(this.nodePath.slice(0)):(this._pathsStateSet.push(this._currentStateSet.slice(0)),this._paths.push(this.nodePath.slice(0))):(this.traverse(e),0===e.getChildren().length&&this._noGeometryPaths.push(this.nodePath.slice(0))),t&&this._currentStateSet.pop()}})),t.a=n},function(e,t){e.exports="uniform sampler2D uTexture0;\nuniform sampler2D uTexture1;\nuniform sampler2D uTexture2;\nuniform sampler2D uTexture3;\n\n// vec4 (up to 4 textures input)\n// int meaning :\n// 0 -> read R\n// 1 -> read A\n// 2 -> read RGB\nuniform ivec4 uReadPacking;\n\nvarying vec2 vTexCoord0;\n\nvoid main(void) {\n    // check if we are in a 2 or 4 texture packing pattern\n    if ( uReadPacking.x == 3 ) {\n        gl_FragColor.rgb = texture2D( uTexture0, vTexCoord0 ).aaa;\n        gl_FragColor.a = uReadPacking.y == 0 ? texture2D( uTexture1, vTexCoord0 ).r : texture2D( uTexture1, vTexCoord0 ).a;\n\n    } else if ( uReadPacking.x == 2 ) {\n        gl_FragColor.rgb = texture2D( uTexture0, vTexCoord0 ).rgb;\n        gl_FragColor.a = uReadPacking.y == 0 ? texture2D( uTexture1, vTexCoord0 ).r : texture2D( uTexture1, vTexCoord0 ).a;\n\n    } else {\n        gl_FragColor.r = uReadPacking.x == 0 ? texture2D( uTexture0, vTexCoord0 ).r : texture2D( uTexture0, vTexCoord0 ).a;\n        gl_FragColor.g = uReadPacking.y == 0 ? texture2D( uTexture1, vTexCoord0 ).r : texture2D( uTexture1, vTexCoord0 ).a;\n        gl_FragColor.b = uReadPacking.z == 0 ? texture2D( uTexture2, vTexCoord0 ).r : texture2D( uTexture2, vTexCoord0 ).a;\n        gl_FragColor.a = uReadPacking.w == 0 ? texture2D( uTexture3, vTexCoord0 ).r : texture2D( uTexture3, vTexCoord0 ).a;\n    }\n}"},function(e,t){e.exports="attribute vec3 Vertex;\nvarying vec2 vTexCoord0;\n\nvoid main(void) {\n    gl_Position = vec4(Vertex * 2.0 - 1.0, 1.0);\n    vTexCoord0 = Vertex.xy;\n}\n"},function(e,t,i){"use strict";var r,a,n=i(5),o=i(34),s=i(113),u=i(93),l=i(16),c=i(144),h=i(1204),d=i(1205),p=n.a.osg,f=n.a.osgAnimation,m={channelTargetNames:{}},g=function(e){var t=e.getStateSet();return t&&t.getAttribute("SketchfabMaterial")?t:void 0},_=function(e,t){for(var i=t||0,r=e.length-1;r>=i;--r){var a=g(e[r]);if(a)return a}},v=function(e){for(var t=0,i=e.length;t<i;++t)e[t].removeChildren()},b=function(e){for(var t=0,i=e.length-1;t<i;++t)e[t].addChild(e[t+1])},y=function(e){for(var t=e.length,i=0;i<t;++i)v(e[i])},x=function(e){for(var t=!1,i=m.channelTargetNames,r=0,a=e.length;r<a;++r){var n,o=e[r],s=!1;if(o instanceof f.Bone)n=f.UpdateBone;else{if(!(o instanceof p.MatrixTransform))continue;n=f.UpdateMatrixTransform,s=!0}for(var u=o.getUpdateCallbackList(),l=u.length-1;l>=0;--l){var c=u[l];c instanceof n!=!1&&(i[c.getName()]||!s?t=!0:(c.update(o),o.removeUpdateCallback(c)))}}var h=e[e.length-1];return t||h instanceof f.RigGeometry||h instanceof f.MorphGeometry},S=function(){var e=[];return function(t){return e[0]=t,x(e)}}();n.a.osgDB.Input.prototype.getJSON=function(){return a=this,this._json.Animations&&(r=this._json),this._json};var M=function(e){var t=m.channelTargetNames;if(!r||!r.Animations||o.a.OSG_VERSION<8)return t;for(var i=e.getFeatures().animation.getModel(),n=r.Animations,s=0,u=n.length;s<u;++s){var l=n[s]["osgAnimation.Animation"],h=a.setJSON(l.UserDataContainer).readUserDataContainer(),d=c.a.convertUserDataToObject(h);if(i.getAnimationByUID(d.AnimationUID))for(var p=l.Channels,f=0,g=p.length;f<g;++f){var _=p[f];t[_[Object.keys(_)[0]].TargetName]=1}}return t},w=function(e,t,i){for(var r=t.length-1;r>=0;--r){var a=t[r],n=a.length,o=a[n-1],s=o._uniqueID;if(o.getVertexAttributeList&&(s=o.getVertexAttributeList().Vertex.getInstanceID()),e[o._uniqueID]||e[s])e[s]=!0,i.push(a),t.splice(r,1);else if(o instanceof p.Geometry||o instanceof f.Bone)x(a)&&(i.push(a),t.splice(r,1));else{for(var u=n-2;u>=0;--u)if(a[u]instanceof f.Bone){i.push(a);break}t.splice(r,1)}}},T=function(e){var t=e.getFeatures(),i=t.hotspot.getModel().get("hotspots"),r=i.length,a={},n=0;for(n=0;n<r;++n){var o=i.at(n).get("geometryUid");o>=0&&(a[o]=!0)}var s=t.sound.getModel().get("soundtracks"),u=s.length;for(n=0;n<u;++n){var l=s.at(n).get("geometryUid");l>=0&&(a[l]=!0)}return a},C=function(e){for(var t=d.a.protectedGeometries,i=0,r=e.length;i<r;++i){var a=e[i],n=a[a.length-1];n instanceof p.Geometry&&(t[n.getInstanceID()]=!0)}},E=function(e,t,i,r){var a=T(e);w(a,t.getPathList(),i),w(a,t.getNoGeometryPathList(),i),w(a,t.getWireframePathList(),r),C(i),C(r)},L=function(e){for(var t=d.a.multiParentPathFromGeometryID,i=0,r=e.length;i<r;++i){for(var a=e[i],n=!1,o=0,s=a.length;o<s;++o)if(a[o].getParents().length>1){n=!0;break}t[a[a.length-1].getInstanceID()]=n}},P=function(e){L(e.getPathList()),L(e.getNoGeometryPathList()),L(e.getWireframePathList())},A=function(e){y(e.getPathList()),y(e.getNoGeometryPathList()),y(e.getWireframePathList())},D=function(e,t,i,r){var a=0,n=e.length,o=i.length,s=!1;for(a=n-1;a>=0;--a){var u=e[a];b(u);var l=u[0]===t;_(u,l?1:0)||(s=!0),l||t.addChild(u[0])}for(a=o-1;a>=0;--a){var c=i[a];b(c),r.push(c[c.length-1]),c[0]!==t&&t.addChild(c[0])}s||t.setStateSet(void 0)},O=function(e,t){var i=e.length;if(0!==i)for(var r=e[0].indexOf(t),a=t.getStateSet()?0:1,n=0;n<i;++n){var o=e[n];o.splice(0,r+a)}},k=function(e){for(var t=e.getUpdateCallbackList(),i=0,r=t.length;i<r;++i){var a=t[i];if(a instanceof f.BasicAnimationManager)return e.removeUpdateCallback(a),a}},R=function(e){for(var t,i,r=e.getPathList(),a=r[0][0],n=a,o=[];;){t=g(n)||t,i=i||k(n);var s=n.getChildren();if(1!==s.length)break;if(s[0]instanceof f.Skeleton)break;if(s[0]instanceof p.Geometry)break;if(S(n))break;o.push(n),n=s[0]}if(a.removeChildren(),i&&a.addUpdateCallback(i),a===n)return n;for(var u=n.getParents(),l=0,c=u.length;l<c;++l)u[l].removeChild(n);n.removeChildren(),a.setStateSet(void 0),n.setStateSet(t);var h=p.computeLocalToWorld(o);if(p.mat4.equals(p.mat4.IDENTITY,h))a.addChild(n);else{var d=new p.MatrixTransform;d.setName("Optim - RootMatrix"),p.mat4.copy(d.getMatrix(),h),a.addChild(d),d.addChild(n)}return O(r,n),O(e.getWireframePathList(),n),O(e.getNoGeometryPathList(),n),n},I=function(e){var t,i=e.getFeatures().material.getModel().attributes,r={},a=s.a.length;for(var n in i){var o=i[n];if(!o.get("uidUniqueMerged")){var u=o.get("texCoordUnitList");u.length=0;var l=o.getChannels();for(t=0;t<a;++t){var c=s.a[t],h=l[c];if(h.isEnableEffective()&&h.getTextureModel()&&"Matcap"!==c){var d=h.getTexCoordUnit();-1===u.indexOf(d)&&u.push(d)}}var p=o.get("geometryList"),f=p.length;for(t=0;t<f;++t){var m=p[t],g=r[m.getInstanceID()];if(g)for(var _=u.length,v=0;v<_;++v)-1===g.uvList.indexOf(u[v])&&g.uvList.push(u[v]);else r[m.getInstanceID()]={geometry:m,uvList:u.slice()}}}}for(var b in r){var y=r[b],x=y.uvList,S=y.geometry.getVertexAttributeList();for(var M in S)-1!==M.indexOf("TexCoord")&&-1===x.indexOf(parseInt(M.substring(8)))&&delete S[M]}},F=function(e,t){I(t);var i=t.getOrCreateScene().getWireframeNodes();i.length=0;var r=[],a=[],n=e.getPathList(),s=e.getWireframePathList();M(t);var u=R(e);if(P(e),A(e),E(t,e,r,a),d.a.optimizePaths(u,n),D(r,u,a,i),s.length>0){var l=i.slice(0);o.a.getWireframe().then(function(){for(var e=i.length=l.length,t=0;t<e;++t)i[t]=l[t];p.time("optimizer - wireframe"),d.a.optimizeWireframe(u,s,i),p.timeEnd("optimizer - wireframe"),o.a.resolveWireframeOptimized()})}else o.a.getWireframe().then(function(){o.a.resolveWireframeOptimized()})},N=function(e,t){for(var i=t.length,r=0;r<i;++r)-1===e.indexOf(t[r])&&e.push(t[r]);t.length=0},V=function(e){var t=e.getFeatures().material.getModel().attributes,i={},r={},a=s.a.length,n=0;for(var o in t){var l=t[o],c=l.get("stateSet");if(!c)return;var d=l.getChannels(),f=u.a.get("mask"),m=[];m.push(l.get("cullFace")?1:0),m.push(l.hasOnlyPoints()?1:0),f&u.a.LIT&&m.push(l.get("shadeless")?1:0),f===u.a.CLASSIC_LIT&&m.push(l.get("reflection")),f!==u.a.MATCAP&&m.push(l.get("hasVertexColor")?1:0),d.Opacity.isEffective()&&m.push(l.get("hasVertexAlpha")?1:0);for(var g=0;g<a;++g){var _=s.a[g],v=d[_];if(v.isEnableEffective()){var b=v.isEffective(),y=b?JSON.stringify(v.getJSON()):v.getFactor();m.push(_+y)}}m=m.join(" / ");var x=i[m];if(x){r[c.getInstanceID()]=x.get("stateSet"),n++,x.get("uidListUnusedDuplicates").push(l.get("id")),l.set("uidUniqueMerged",x.get("id"));var S=l.get("stateSetWireframe");if(S){var M=x.get("stateSetWireframe");r[S.getInstanceID()]=M}N(x.get("geometryList"),l.get("geometryList")),N(x.get("wireframeList"),l.get("wireframeList")),l.get("texCoordUnitList").length=0}else i[m]=l}var w=Object.keys(r).length,T=Object.keys(t).length;if(h.a.stats.materialCountBefore=T,h.a.stats.materialCountAfter=T-n,0!==w){var C=function(){p.NodeVisitor.call(this)};p.createPrototypeObject(C,p.objectInherit(p.NodeVisitor.prototype,{apply:function(e){var t=e.getStateSet();if(t){var i=r[t.getInstanceID()];i&&e.setStateSet(i)}this.traverse(e)}}));var E=e.getRootModel(),L=new C;L.setNodeMaskOverride(-1),E.accept(L)}},B={};B.reports=h.a.stats,B.optimize=function(e,t){if(Object(l.a)().graphOptimizer||o.a.getWireframe().then(o.a.resolveWireframeOptimized),Object(l.a)().graphOptimizer||Object(l.a)().mergeMaterials){p.time("optimizer");var i=t.getRootModel();h.a.registerStats(i,"Before"),Object(l.a)().mergeMaterials&&(p.time("optimizer - materials"),V(t),p.timeEnd("optimizer - materials")),Object(l.a)().graphOptimizer&&(p.time("optimizer - nodes"),F(e,t),p.timeEnd("optimizer - nodes"),h.a.stats.transparent=d.a.hasTransparency),h.a.registerStats(i,"After"),h.a.computeStats(t),p.timeEnd("optimizer")}},t.a=B},function(e,t,i){"use strict";var r=i(5),a=i(83),n=i(554),o=i(93),s=i(16),u=i(118),l=r.a.osg,c=r.a.osgAnimation,h=function(){l.NodeVisitor.call(this),this._stats={nodeCount:0,matrixTransformCount:0,geometryCount:0,boneCount:0,skeletonCount:0,morphGeometryCount:0,rigGeometryCount:0}},d=new a.a;h.stats=window.sketchfabViewerStats={promiseReady:d.promise,materialCountBefore:0,materialCountAfter:0,nodeCountBefore:0,nodeCountAfter:0,matrixTransformCountBefore:0,matrixTransformCountAfter:0,geometryCountBefore:0,geometryCountAfter:0,boneCountBefore:0,boneCountAfter:0,skeletonCountBefore:0,skeletonCountAfter:0,morphGeometryCountBefore:0,morphGeometryCountAfter:0,rigGeometryCountBefore:0,rigGeometryCountAfter:0},h.registerStats=function(e,t){var i=new h;e.accept(i);var r=i.getStats(),a=h.stats;a["nodeCount"+t]=r.nodeCount,a["matrixTransformCount"+t]=r.matrixTransformCount,a["geometryCount"+t]=r.geometryCount,a["boneCount"+t]=r.boneCount,a["skeletonCount"+t]=r.skeletonCount,a["morphGeometryCount"+t]=r.morphGeometryCount,a["rigGeometryCount"+t]=r.rigGeometryCount};var p=function(e){for(var t=["geometry","rigGeometry","morphGeometry"],i=0,r=0;r<t.length;++r)i+=h.stats[t[r]+e];return i};h.computeStats=function(e){if(!Object(u.a)()&&!window.RunningTests){var t=h.stats;if(Object(s.a)().graphOptimizer){var i=p("CountBefore"),r=p("CountAfter");n.default.logMessage("Geometry count : before "+i+", after "+r)}if(Object(s.a)().mergeMaterials){var a="Material count : before ";a+=t.materialCountBefore,a+=", after ",a+=t.materialCountAfter,n.default.logMessage(a)}var l=e.getFeatures(),c=l.animation.getModel(),f=l.environment.getModel(),m=l.lighting.getModel(),g=c.getEnabledAnimationsCount(),_=0,v=0,b=0;if(o.a.get("mask")&o.a.LIT){for(var y=m.get("lights"),x=0,S=y.length;x<S;++x){var M=y[x];M&&M.get("enable")&&"NONE"!==M.get("type")&&(b++,M.isCastingShadows()&&(v++,(g||M.isAttachedToCamera())&&_++))}f.get("enable")&&(b++,f.get("shadowEnable")&&(b++,v++,g&&_++)),t.pbr=o.a.get("mask")&o.a.PBR?1:0}t.lights=b,t.shadows=v,t.realTimeShadows=_,t.vertexCount=e._currentScene._dataScene.vertexCount;var w=t.materialCountAfter/10;w*=b>0&&t.pbr?t.lights+t.shadows:1,w*=t.transparent?4:1;var T=0;T+=t.boneCountAfter/35,T+=t.morphGeometryCountAfter/2,T+=t.geometryCountAfter/5,T+=t.vertexCount/15e4,T+=t.matrixTransformCountAfter/50,T+=t.nodeCountAfter/100,T*=t.realTimeShadows>0?t.realTimeShadows+1:1;var C=w+T;t.complexity=C,t.shadingComplexity=w,t.meshComplexity=T,d.resolve(t)}};var f=l.Node.typeID,m=l.MatrixTransform.typeID,g=c.Bone.typeID,_=c.Skeleton.typeID,v=l.Geometry.typeID,b=c.MorphGeometry.typeID,y=c.RigGeometry.typeID;l.createPrototypeObject(h,l.objectInherit(l.NodeVisitor.prototype,{getStats:function(){return this._stats},apply:function(e){var t=this._stats,i=e.typeID;e.userDataMap&&e.userDataMap.wireframe||(i===f?t.nodeCount++:i===m?t.matrixTransformCount++:i===v?t.geometryCount++:i===g?t.boneCount++:i===_?t.skeletonCount++:i===b?t.morphGeometryCount++:i===y?(t.rigGeometryCount++,e.getSourceGeometry().typeID===b&&t.morphGeometryCount++):console.error("Unknown node type ID : "+i+" "+e.className()),this.traverse(e))}})),t.a=h},function(e,t,i){"use strict";var r=i(5),a=i(57),n=i(16),o=r.a.osg,s=o.WebGLCaps.instance().getWebGLExtension("OES_element_index_uint"),u=s?4294967296:65535,l={splitLimit:Math.min(Object(n.a)().splitLimit,u),limitMergePerMaterial:100,canMergeGeometry:!0,isWireframe:!1,bakedGeometriesFromID:{},hasTransparency:!0,multiParentPathFromGeometryID:{},protectedGeometries:{}},c={};c[o.primitiveSet.POINTS]=!0,c[o.primitiveSet.LINES]=!0,c[o.primitiveSet.TRIANGLES]=!0;var h={};h[o.primitiveSet.POINTS]=!0,h[o.primitiveSet.LINES]=!0,h[o.primitiveSet.TRIANGLES]=!0,h[o.primitiveSet.TRIANGLE_STRIP]=!0;var d={Vertex:1,Normal:1,Tangent:1},p=function(e){var t=e.getStateSet();return t&&t.getAttribute("SketchfabMaterial")?t:void 0},f=function(e,t){for(var i=t||0,r=e.length-1;r>=i;--r){var a=p(e[r]);if(a)return a}},m=function(e,t){var i=e[e.length-1].getVertexAttributeList().Vertex;return t[t.length-1].getVertexAttributeList().Vertex.getElements().length-i.getElements().length},g=function(e){return e===a.a.TRANSPARENT},_=function(e){return e.getVertexAttributeList().Vertex.getElements().length/3},v=function(e){return e[e.length-1].getVertexAttributeList().Vertex.getElements().length/3},b=function(e){var t=e[e.length-1].getInstanceID(),i=l.multiParentPathFromGeometryID;return Boolean(i[t])},y=function(e){return 9===e.length?o.mat3.equals(o.mat3.IDENTITY,e):o.mat4.equals(o.mat4.IDENTITY,e)},x=function(e,t){t.xmin<e.xmin&&(e.xmin=t.xmin),t.ymin<e.ymin&&(e.ymin=t.ymin),t.zmin<e.zmin&&(e.zmin=t.zmin),t.xmax>e.xmax&&(e.xmax=t.xmax),t.ymax>e.ymax&&(e.ymax=t.ymax),t.zmax>e.zmax&&(e.zmax=t.zmax)},S=function(e,t){var i=Math.min(e.xmax-e.xmin,t.xmax-t.xmin),r=Math.min(e.ymax-e.ymin,t.ymax-t.ymin),a=Math.min(e.zmax-e.zmin,t.zmax-t.zmin);x(e,t),i=0===i?0:(e.xmax-e.xmin)/i,r=0===r?0:(e.ymax-e.ymin)/r,a=0===a?0:(e.zmax-e.zmin)/a;return Math.max(i,r,a)>200},M=function(e,t,i){if(!t._FQU){var r=e.getElements().length,a=Math.min(r,t.getElements().length-i);t._boxTest||(t._boxTest=t.computeMinMaxVertex({},0,i));var n=t.computeMinMaxVertex({},i,a);t._FQU=S(t._boxTest,n)}},w=function(e){if(!l.isWireframe){var t={};t.xmin=1/0,t.ymin=1/0,t.zmin=1/0,t.xmax=-1/0,t.ymax=-1/0,t.zmax=-1/0;for(var i=l.bakedGeometriesFromID,r={},a=0,n=e.length;a<n;++a){var o=e[a].getVertexAttributeList().Vertex;i[o.getInstanceID()]&&(o._minMax||(o._minMax=t,o.computeMinMaxVertex(r),t.xmin===1/0||t._FQU||o._FQU?(o._FQU&&(t._FQU=!0),x(t,r)):t._FQU=S(t,r)))}}},T=function(e,t,i){var r=e.getElements(),a=t.getElements(),n=e.getItemSize(),o=t.getItemSize();if(n===o)return void r.set(a,i);for(var s=a.length/o,u=0;u<s;++u){var l=u*n,c=u*o;r[i+l]=a[c],r[i+l+1]=a[c+1],r[i+l+2]=a[c+2]}},C=function(e,t,i){var r=t.getVertexAttributeList().Vertex,a=e.getVertexAttributeList().Vertex.getElements(),n=r.getElements();r.setElements(a.subarray(i,i+n.length)),e._boundingBox.copy(t.getBoundingBox()),e._boundingBoxComputed=!0;var s=t.getBoundingSphere(),u=e._boundingSphere;u.set(o.vec3.copy(u.center(),s.center()),s.radius()),e._boundingSphereComputed=!0,r.setElements(n),t.dirtyBound()},E=function(e,t,i,r){var a=l.bakedGeometriesFromID[t.getInstanceID()];if(a||(l.bakedGeometriesFromID[i.getInstanceID()]=!0),a||y(e))return void(i!==t&&T(i,t,r||0));var n=i.getElements();r&&(n=n.subarray(r));for(var s=t.getElements(),u=9===e.length?o.vec3.transformMat3:o.vec3.transformMat4,c=t.getItemSize(),h=o.vec3.create(),d=Math.min(s.length,n.length),p=0;p<d;p+=c)h[0]=s[p],h[1]=s[p+1],h[2]=s[p+2],u(h,h,e),n[p]=h[0],n[p+1]=h[1],n[p+2]=h[2],4===c&&(n[p+3]=s[p+3])},L=function(e,t,i,r){var a=i.getIndices(),n=a.getElements(),s=n.length,u=0,c=i.getMode(),d=e[c],p=d.primitive,f=p.getIndices().getElements(),m=p.getCount(),g=h[c]&&l.canMergeGeometry,_=m;if(c===o.primitiveSet.TRIANGLE_STRIP&&g){var v=f[m-1],b=n[0]+r,y=v!==b&&0!==m?2:0,x=m%2;y&&(f[m]=v,f[m+1]=b),x&&(f[m+y]=b),_+=y+x,f.set(n,_)}else f.set(n,_);p.setCount(_+s);var S=_+s;for(u=_;u<S;++u)f[u]+=r;g||(i.setIndices(p.getIndices()),i.setCount(s),i.setFirst(_*f.BYTES_PER_ELEMENT),l.canMergeGeometry&&t.push(i))},P=function(e,t,i,r){for(var a=i.length,n=l.canMergeGeometry,s=e.DrawElements,u=e.DrawArrays,c=0;c<a;++c){var h=i[c],d=h.getMode();if(h instanceof o.DrawElements)L(s,t,h,r);else if(h instanceof o.DrawArrays){var p=u[d];if(n)if(p&&p.primitive.count===r&&0===h.getFirst())p.primitive.count+=h.getCount();else{var f=h.getFirst()+r;t.push(new o.DrawArrays(d,f,h.getCount()))}else h.first+=r}else if(h instanceof o.DrawArrayLengths)if(n){var m=h.getFirst()+r,g=h.getArrayLengths().slice();t.push(new o.DrawArrayLengths(d,m,g))}else h.first+=r}},A=function(e){for(var t=[{nbVertex:v(e[0]),pathList:[e[0]]}],i=e.length,r=1;r<i;++r){var a=e[r],n=t[t.length-1],o=v(a);o+n.nbVertex>=l.splitLimit?t.push({nbVertex:o,pathList:[a]}):(n.nbVertex+=o,n.pathList.push(a))}return t},D=function(e,t,i){if(!b(e))return void Array.prototype.push.apply(t,i);for(var r=0,a=i.length;r<a;++r){var n,s=i[r],u=s.getMode(),l=s.getFirst();if(s instanceof o.DrawElements){var c=s.getIndices(),h=c.getElements(),d=new h.constructor(h),p=c.getItemSize(),f=new o.BufferArray(o.BufferArray.ELEMENT_ARRAY_BUFFER,d,p);n=new o.DrawElements(u,f)}else s instanceof o.DrawArrays?n=new o.DrawArrays(u,l,s.getCount()):s instanceof o.DrawArrayLengths&&(n=new o.DrawArrayLengths(u,l,s.getArrayLengths().slice()));t.push(n)}},O=function(e,t){var i=e.getElements(),r=i.BYTES_PER_ELEMENT;e.setNormalize(4!==r);var a=1;1===r?a=255:2===r&&(a=65535);for(var n=i.length,o=e.getItemSize(),s=t*o;s<n;++s)i[s]=a},k=function(e,t){var i=new o.Geometry;return i.setName(t.getName()),D(e,i.getPrimitiveSetList(),t.getPrimitiveSetList()),i},R=function(e,t){var i=t.getVertexAttributeList().Color;if(i&&4===i.getItemSize())return 4;for(var r=0,a=e.length;r<a;++r){var n=e[r],o=n[n.length-1],s=o.getVertexAttributeList().Color;if(s&&4===s.getItemSize())return 4}return 3},I=function(e,t,i){var r=e[e.length-1],a=k(e,r),n=o.computeLocalToWorld(e),s=o.mat3.create();o.mat3.normalFromMat4(s,n);var u=R(i,r),c=t!==_(r),h=b(e),p=a.getVertexAttributeList(),f=r.getVertexAttributeList();for(var m in f){var g,v=f[m],y=d[m],x="Color"===m,S=x?u:v.getItemSize();if(c){g=new(x?v.getElements().constructor:Float32Array)(t*S)}else y&&h?g=new Float32Array(v.getElements().length):p[m]=v;if(g){var M=new o.BufferArray(o.BufferArray.ARRAY_BUFFER,g,S);x&&O(M,v.getElements().length/v.getItemSize()),p[m]=M,y||T(M,v,0)}if(y){E("Vertex"===m?n:s,v,p[m],0)}}return l.canMergeGeometry||C(a,r,0),a},F=function(e,t,i){var r=t[t.length-1],a=e.getVertexAttributeList(),n=r.getVertexAttributeList(),s=o.computeLocalToWorld(t),u=o.mat3.create();o.mat3.normalFromMat4(u,s);for(var l in n){var c=a[l],h=n[l],p=i*c.getItemSize();if(d[l]){E("Vertex"===l?s:u,h,c,p),"Vertex"===l&&M(h,c,p)}else T(c,h,p)}},N=function(e,t,i){for(var r in t)if(!e[r]){var a=t[r].getItemSize(),n="Color"===r,s=n?t[r].getElements().constructor:Float32Array,u=new s(i*a),l=new o.BufferArray(o.BufferArray.ARRAY_BUFFER,u,a);e[r]=l,n&&O(l,0)}},V=function(e,t,i,r){for(var a=t.DrawElements,n=t.DrawArrays,s=l.canMergeGeometry,u=0,d=i.length;u<d;++u){var p=i[u],f=p.getMode();if(p instanceof o.DrawElements){var m=a[f];if(!m){var g=p.getIndices().getItemSize(),_=new o.BufferArray(o.BufferArray.ELEMENT_ARRAY_BUFFER,new Uint16Array,g);m=a[f]={primitive:new o.DrawElements(f,_),lastElement:-1,initCount:0},s&&e.push(m.primitive)}var v=m.primitive;if(f===o.primitiveSet.TRIANGLE_STRIP&&h[f]&&s){var b=p.getIndices().getElements(),y=b[0]+r,x=m.lastElement!==y&&0!==v.getCount()?2:0,S=v.getCount()%2;v.setCount(v.getCount()+p.getCount()+x+S),m.lastElement=b[b.length-1]+r}else v.setCount(v.getCount()+p.getCount())}else p instanceof o.DrawArrays&&c[f]&&s&&(n[f]||(n[f]={primitive:new o.DrawArrays(f,0,0),initCount:0},e.push(n[f].primitive)))}},B=function(e){for(var t={DrawElements:{},DrawArrays:{}},i=l.canMergeGeometry,r=0,a=e.length;r<a;++r){var n=e[r],s=n.getMode();if(n instanceof o.DrawElements){var u=n.getIndices().getElements();t.DrawElements[s]={primitive:n,lastElement:u[u.length-1],initCount:n.getCount()}}else n instanceof o.DrawArrays&&c[s]&&i&&(t.DrawArrays[s]={primitive:n,first:n.getFirst(),initCount:n.getCount()})}return t},U=function(e){for(var t in e){var i=e[t],r=i.primitive,a=r.getIndices(),n=a.getElements(),o=r.getCount()>=65535?Uint32Array:Uint16Array;a.setElements(new o(r.getCount())),a.getElements().set(n),r.setIndices(a),r.setCount(n.length)}},j=function(e,t,i,r){for(var a=e.getVertexAttributeList(),n=e.getPrimitiveSetList(),o=_(e),s=r,u=0,l=t.length;u<l;++u){var c=t[u],h=c[c.length-1];N(a,h.getVertexAttributeList(),o),V(n,i,h.getPrimitiveSetList(),s),s+=v(c)}U(i.DrawElements)},G=function(e){var t=e.DrawElements,i=l.canMergeGeometry;for(var r in t){var a=t[r];i&&h[r]||a.primitive.setCount(a.initCount)}},Y=function(e,t){var i=e.pathList,r=i.pop(),a=_(r[r.length-1]),n=I(r,e.nbVertex,i);if(t.addChild(n),0!==i.length){var o=n.getPrimitiveSetList(),s=B(o);j(n,i,s,a);for(var u=l.canMergeGeometry,c=0,h=i.length;c<h;++c){var d=i[c];F(n,d,a);var p=d[d.length-1];if(!u||b(d)){var f=k(d,p);u||(f._attributes=n.getVertexAttributeList(),t.addChild(f),C(f,p,3*a)),p=f}var m=p.getPrimitiveSetList();P(s,o,m,a),a+=v(d)}G(s)}},H=function(e){var t=e.localRoot;e.renderPathList.sort(m);for(var i=A(e.renderPathList),r=i.length,a=0;a<r;++a)Y(i[a],t)},z=function(e,t){for(var i=e.getAttribute("SketchfabMaterial").getMaterialModel(),r=i.get(l.isWireframe?"wireframeList":"geometryList"),a=l.protectedGeometries,n=[],o=0,s=r.length;o<s;++o){var u=r[o];a[u.getInstanceID()]&&n.push(u)}r.length=0,Array.prototype.push.apply(r,n),Array.prototype.push.apply(r,t.getChildren()),l.isWireframe&&i.getChannels().Displacement.updateGeometryOffsets(),w(r)},W=function(e){var t=e.localRoot,i=t.getStateSet(),r=i&&g(i.getBinNumber());r&&(l.hasTransparency=!0),l.canMergeGeometry=!r,e.renderPathList.length>l.limitMergePerMaterial&&(l.canMergeGeometry=!0),H(e),z(i,t)},q=function(e,t,i){var r=f(e),a=r.getInstanceID(),n=t[a];n||(t[a]=n={localRoot:new o.Node,renderPathList:[]},n.localRoot.setStateSet(r),n.localRoot.setName(r.getName()),i.addChild(n.localRoot)),n.renderPathList.push(e),e[0]===i&&e.shift()};l.optimizePaths=function(e,t,i){l.isWireframe=!!i;for(var r={},a=t.length,n=0;n<a;++n)q(t[n],r,e);for(var o in r)W(r[o])},l.optimizeWireframe=function(e,t,i){var r=e.getChildren(),a=r.length;l.optimizePaths(e,t,!0);for(var n=r.length,o=a;o<n;++o)i.push(r[o])},t.a=l},function(e,t,i){"use strict";var r=i(5),a=i(120),n=i(703),o=i(70),s=i(113),u=r.a.osg,l=function(e,t){return e-t},c={Matcap:"Matcap",SubsurfaceScattering:"Subsurface scattering",SubsurfaceTranslucency:"Subsurface translucency",DiffuseColor:"Diffuse",DiffuseIntensity:"Lightmap",SpecularColor:"Specular Color",SpecularHardness:"Glossiness",Displacement:"Displacement",NormalMap:"Normal map",BumpMap:"Bump map",Opacity:"Opacity",EmitColor:"Emission",DiffusePBR:"Albedo",AlbedoPBR:"Base Color",SpecularPBR:"Specular",GlossinessPBR:"Glossiness",RoughnessPBR:"Roughness",MetalnessPBR:"Metalness",SpecularF0:"Specular F0",AOPBR:"Ambient Occlusion",CavityPBR:"Cavity"},h=a.a.extend({initDefaults:function(e){var t=e.channels;delete e.channels,e.reflection=Object(o.a)()?.1:.3,e.verison=3,a.a.prototype.initDefaults.call(this,e),t.Inspector={factor:1,enable:!0,maskThreshold:0,invert:!1,color:u.vec3.fromValues(1,1,1)};for(var i in t){var r=t[i];switch(r.name=i,r.material=this,r.displayName=c[i],i){case"DiffuseColor":r.color=Object(o.a)()?u.vec3.fromValues(1,1,1):u.vec3.fromValues(.5,.5,.5);break;case"Opacity":r.useAlbedoTint=!Object(o.a)(),r.thinLayer=!Object(o.a)()}t[i]=new n.default[i].model(r)}this.set("channels",t)},getModelOptionPath:function(){return"materials:0"},defaults:function(){return{geometryList:[],wireframeList:[],texCoordUnitList:[],vertexColorColorSpace:"srgb",vertexColorEnable:!1,vertexAlphaEnable:!1,hasVertexColor:!1,hasVertexAlpha:!1,hasTriangles:!1,hasPoints:!1,hasLines:!1,stateSet:void 0,stateSetWireframe:void 0,uidUniqueMerged:"",uidListUnusedDuplicates:[]}},setMaterial:function(e){this.set(e);var t=this.getChannels();for(var i in e.channels)t[i].set(e.channels[i])},setMaterialJSON:function(e,t,i){var r=i||{},n=e.channels;r.ignore=["channels"];var o=a.a.prototype.setJSON.call(this,e,r);if(n){for(var u=this.getChannels(),l=s.a.length,c=0;c<l;++c){var h=s.a[c],d=n[h];if(d){var p=u[h];if(p){var f=p.setChannelJSON(d,t,r);f.length&&o.concat(f)}}}return o}},getChannels:function(){return this.get("channels")},setStateSet:function(e){return this.set("stateSet",e),this},setChannelEnable:function(e,t){var i=this.get("channels");return i[e]?(i[e].setEnable(t),this):this},setChannelColor:function(e,t){var i=this.get("channels"),r=i[e];return r&&r.setColor?(r.setColor(t),this):this},setChannelTexture:function(e,t){var i=this.get("channels");return i[e]?(i[e].setTextureModel(t),this):this},setChannelFactor:function(e,t){var i=this.get("channels");return i[e]?(i[e].setFactor(t),this):this},getJSON:function(){var e=a.a.prototype.getJSON.call(this,{ignore:["channels"]});e.version=3,e.channels={};var t=this.get("channels");for(var i in t)"Inspector"!==i&&(e.channels[i]=t[i].getJSON());return e},copyDualChannel:function(e,t){var i=this.getChannels(),r=i[e],a=i[t],n=a.getTextureModel(),o="MetalnessPBR"===e||"SpecularPBR"===e,s="NormalMap"===e||"BumpMap"===e;n?(n=n.clone(),(o||s)&&(n.setImageModel(n.getImageModel()),n.set("internalFormat","NormalMap"===e||"SpecularPBR"===e?u.Texture.RGB:u.Texture.LUMINANCE),n.updateMultiresTexture()),r.setTextureModel(n)):o||(r.setColor?a.getColor&&r.setColor(a.getColor()):r.setTextureModel(void 0)),s||r.setFactor(a.getFactor())},isWorkflowMetalness:function(){return this.getChannels().MetalnessPBR.getEnable()},setWorkFlowRoughGloss:function(e,t){var i=e?"GlossinessPBR":"RoughnessPBR",r=e?"RoughnessPBR":"GlossinessPBR",a=this.getChannels();a[i].setEnable(!1),a[r].setEnable(!0),t&&this.copyDualChannel(r,i,a)},setWorkFlowMetalSpec:function(e,t){var i=e?"DiffusePBR":"AlbedoPBR",r=e?"SpecularPBR":"MetalnessPBR",a=e?"AlbedoPBR":"DiffusePBR",n=e?"MetalnessPBR":"SpecularPBR",o=this.getChannels();o[i].setEnable(!1),o[r].setEnable(!1),o.SpecularF0.setEnable(e),o[a].setEnable(!0),o[n].setEnable(!0),t&&(this.copyDualChannel(a,i),this.copyDualChannel(n,r))},hasOnlyPoints:function(){return this.get("hasPoints")&&!this.get("hasTriangles")&&!this.get("hasLines")},updateTexCoordUnitList:function(){var e=this.get("texCoordUnitList");e.length=0;for(var t,i,r=this.get("geometryList"),a=r.length,n=[],o=[],u=0;u<a;++u){var c=r[u].getVertexAttributeList();o.length=0;for(var h in c)-1!==h.indexOf("TexCoord")&&o.push(parseInt(h.substring(8)));for(o.sort(l),t=o.length-1;t>=0;--t){var d=o[t],p=c["TexCoord"+d];for(i=0;i<t;++i){var f=o[i];if(p===c["TexCoord"+f]){var m=n[d];void 0!==m&&m!==f?-1===e.indexOf(d)&&e.push(d):n[d]=f;break}}var g=o[i];-1===e.indexOf(g)&&e.push(g)}}if(e.sort(l),0!==n.length){var _=e.length;for(t=0;t<_;++t)n[e[t]]=e[t];var v=this.getChannels(),b=s.a.length;for(t=0;t<b;++t){var y=v[s.a[t]];y.setTexCoordUnit(n[y.getTexCoordUnit()])}}}});t.a=h},function(e,t,i){"use strict";var r=i(8),a=i(703),n=i(859),o=i(37),s=i(113),u=i(93),l=r.a.extend({initialize:function(){r.a.prototype.initialize.apply(this,arguments),this.model.bind("change:stateSet",this.stateSet,this),this.model.bind("change:cullFace",this.onCullFace,this),this.model.bind("change:shadeless",this.onDirty,this),this.model.bind("change:vertexColorEnable",this.onDirty,this),this.model.bind("change:vertexColorColorSpace",this.onDirty,this),this.model.bind("change:vertexAlphaEnable",this.onDirty,this),u.a.bind("change:hasSsr",this.onDirty,this),this.model.bind("change:hasPoints",this.onPrimitive,this),this.model.bind("change:hasTriangles",this.onPrimitive,this),this.model.bind("change:hasLines",this.onPrimitive,this),this.model.bind("apply",this.apply,this),this.model.bind("change",o.a.draw),this._context=new n.a(this.model),this._views={};for(var e=this.model.get("channels"),t=s.a.length,i=0;i<t;++i){var l=s.a[i],c=e[l];this._views[l]=new a.default[l].view({model:c,stateSetContext:this._context}),c.bind("change:enable",this.onEnableChanged,this)}},getStateSetContext:function(){return this._context},stateSet:function(){var e=this.model.get("stateSet");return e.setName(this.model.get("name")),this.getStateSetContext().setStateSet(e),this},apply:function(){for(var e in this._views)this._views[e].apply();this.onCullFace(),this.onDirty()},onDirty:function(){this.getStateSetContext().dirtyMaterial()},onCullFace:function(){this.getStateSetContext().setCullface(this.model.get("cullFace"))},onPrimitive:function(){this.getStateSetContext().setPointCircle(this.model.hasOnlyPoints())},onEnableChanged:function(e,t){if(!0===t){var i=e.getName(),r=this.model.getChannels();"BumpMap"===i?r.NormalMap.setEnable(!1):"NormalMap"===i&&r.BumpMap.setEnable(!1),"GlossinessPBR"===i?r.RoughnessPBR.setEnable(!1):"RoughnessPBR"===i&&r.GlossinessPBR.setEnable(!1),"AlbedoPBR"===i||"MetalnessPBR"===i?(r.DiffusePBR.setEnable(!1),r.SpecularPBR.setEnable(!1)):"DiffusePBR"!==i&&"SpecularPBR"!==i||(r.AlbedoPBR.setEnable(!1),r.MetalnessPBR.setEnable(!1))}return this}});t.a=l},function(e,t,i){"use strict";var r=i(5),a=i(187),n=i(457),o=i(556),s=i(113),u=i(16),l=r.a.osg,c="rgba",h={};h[l.Texture.LUMINANCE]="r",h[l.Texture.ALPHA]="a",h[l.Texture.RGB]="rgb";var d=function(e){l.Texture.call(this),this._texture=e,this._isColorAtlas=!1,this._channels=[],this._packedTextures={}},p=function(e,t){var i=s.a.getDefaultComponentCount(e),r=s.a.getDefaultComponentCount(t);return r===i?e<t?1:-1:r-i};l.createPrototypeStateAttribute(d,l.objectInherit(l.Texture.prototype,{attributeType:"Texture",invalidate:function(){this._isColorAtlas||(this._texture=void 0)},isColorAtlas:function(){return this._isColorAtlas},setIsColorAtlas:function(e){this._isColorAtlas=e},getChannelPacking:function(e){var t=this._packedTextures[e];return t?t.pack:""},getPackedTextures:function(){return this._packedTextures},getOrderedChannels:function(){return this._channels},getTexture:function(){return this._texture||(this._texture=o.a.packTextures(this)),this._texture},setTexture:function(e){this._texture=e},getChannelCount:function(){return this._channels.length},addChannel:function(e,t,i){this._packedTextures[e]||(this._packedTextures[e]={texture:t,pack:"rgb"},i||this._channels.push(e),this._isColorAtlas||(this._texture=void 0,this.updatePacking()))},removeChannel:function(e){this._packedTextures[e]&&(delete this._packedTextures[e],this._channels.splice(this._channels.indexOf(e),1),this._isColorAtlas||(this._texture=void 0,this.updatePacking()))},packChannelIfPossible:function(e,t){if(this._isColorAtlas||!Object(u.a)().materialPacking||t.isVideo())return!1;var i=this._channels,r=i.length;if(0===r)return!1;for(var a=4,n=0;n<r;++n)a-=this._packedTextures[i[n]].pack.length;return 0!==a&&(!(3===s.a.getDefaultComponentCount(e)&&a<3)&&(!!this.isFilteringFriendly(t,this._packedTextures[i[0]].texture)&&(i.push(e),this.addChannel(e,t,!0),this.updatePacking(),!0)))},isFilteringFriendly:function(e,t){return e.getMinFilter()===t.getMinFilter()&&(e.getMagFilter()===t.getMagFilter()&&(e.getWrapS()===t.getWrapS()&&e.getWrapT()===t.getWrapT()))},getSinglePacking:function(e,t){if("Opacity"===e){var i=t.getInternalFormat(),r=i&&h[t.getInternalFormat()];return r&&1===r.length?r:"r"}return"EmitColor"===e&&t.getInternalFormat()===l.Texture.ALPHA?"aaa":s.a.getDefaultFormatComponent(e)},updatePacking:function(){var e=this._channels,t=0,i=e.length;if(1===i){var r=this._packedTextures[e[0]];return void(r.pack=this.getSinglePacking(e[0],r.texture))}e.sort(p);for(var a=0;a<i;++a){var n=e[a],o=this._packedTextures[n];if(o){var u=s.a.getDefaultFormatComponent(n).length;o.pack=c.substr(t,u),t+=u}}},getMaxTextureSizePacked:function(e){e.width=0,e.height=0;for(var t=this._channels,i=t.length,r=0;r<i;++r){var a=t[r],n=this._packedTextures[a];if(n){var o=n.texture;if(o.getImageJSONMaxSupported){var s=o.getImageJSONMaxSupported();if(e.width=Math.max(e.width,s.width),e.height=Math.max(e.height,s.height),!(s.width<=512&&s.height<=512)){var u=o.getImageJSONMaxSupported(512);if(512!==u.width&&512!==u.height){var l=o.getImageModel().getUID(),c=e.missingTextures[l];c?-1===c.indexOf("channelName")&&c.push(a):e.missingTextures[l]=[a]}}}}}return e},isProtectedTexture:function(){for(var e=n.a.compilerChannels[n.a.EARLYZ_COMPILER],t=0;t<e.length;++t)if(this._packedTextures[e[t]])return!0;return!1},getImage:function(){return this.getTexture().getImage()},cloneType:function(){return new d(new a.a)},isTextureNull:function(){return!(!this._isColorAtlas||0!==this._channels.length)||this.getTexture().isTextureNull()},apply:function(e){var t=e.getGraphicContext();this.setGraphicContext(t),this.getTexture().apply(e)},getHash:function(){return""}}),"osgSketchfab","PackedMaterialTexture"),t.a=d},function(e,t,i){"use strict";t.a=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}},function(e,t,i){"use strict";var r=i(62),a=i(1211),n=i(1212),o={FeatureName:"shadingStyle",ModelType:a.a,ViewListType:[n.a]},s=r.a.create(o);t.a=s},function(e,t,i){"use strict";var r=i(120),a=i(34),n=i(70),o=r.a.extend({initialize:function(){r.a.prototype.initialize.apply(this,arguments),this._wireframeSchema=this.getSubSchema("wireframe");var e=this.getInstance(this._wireframeSchema);this.set("wireframeEnable",e.enable),this.set("wireframeColor",e.color)},getModelOptionPath:function(){return"shading"},defaults:function(){return{hasWireframe:!0,hasVertexColor:!1,hasVertexAlpha:!1,hasPoints:!1,hasLines:!1,hasTriangles:!1,webVR:!1}},getName:function(){return"ShadingStyle"},init:function(e){this.set("hasWireframe",!!e.getScene().getWireframeSize()),this.set("vertexColorUseAlpha",Object(n.a)()),this.set("vertexColorColorSpace",Object(n.a)()?"srgb":"linear"),this.set("pointSize",Object(n.a)()?2:0);var t=e.getModel().get("options"),i=t.shading,r=t.wireframe;i&&this.setJSON({shading:i,wireframe:r}),Object(n.a)()&&a.a.getMaterial().then(function(){var t=e.getFeatures().material.getModel();this.set("renderer","pbr",{copyChannel:!0,overrideTexture:!1}),t._style&&this.set("type",t._style)}.bind(this))},setWireframeColorSmooth:function(e){this.trigger("setWireframeColorSmooth",e)},setWireframeJSON:function(e,t){if(t&&t.validate){var i=this.validate(e,{schema:this._wireframeSchema});if(i.length)return i.join("\n")}return void 0!==e.enable&&this.set("wireframeEnable",e.enable),e.color&&e.enable&&this.set("wireframeColor",e.color),[]},setJSON:function(e,t){var i=r.a.prototype.setJSON.call(this,e.shading,t),a=this.setWireframeJSON(e.wireframe,t);return i.concat(a),i},getJSON:function(){return{shading:r.a.prototype.getJSON.call(this),wireframe:{enable:this.get("wireframeEnable"),color:this.get("wireframeColor")}}},editorGetJSON:function(){return this.getJSON()},editorSetJSON:function(e){return this.setJSON(e,{validate:!0})}});t.a=o},function(e,t,i){"use strict";var r=i(5),a=i(34),n=i(8),o=i(857),s=i(43),u=i(93),l=i(37),c=i(251),h=i(457),d=i(144),p=i(859),f=i(79),m=i(47),g=r.a.osg,_=n.a.extend({initialize:function(e){n.a.prototype.initialize.apply(this,arguments);var t=this.model;t.bind("change:webVR",this.onWebVRChanged,this),t.bind("change:renderer",this.onRendererChanged,this),t.bind("change:type",this.onShadingChanged,this),t.bind("change:pointSize",this.onPointSizeChanged,this),t.bind("change:wireframeEnable",this.onWireframeEnableChanged,this),t.bind("change:wireframeColor",this.onWireframeColorChanged,this),t.bind("change:vertexColorEnable",this.onVertexColorChanged,this),t.bind("change:vertexColorUseAlpha",this.onVertexColorChanged,this),t.bind("change:vertexColorColorSpace",this.onVertexColorChanged,this),t.bind("setWireframeColorSmooth",this.onSetWireframeColorSmooth,this),this._viewer=e.context.getViewer(),this._viewerOSGJS=this._viewer.getViewerOSGJS(),this._rootStateSet=this._viewerOSGJS.getSceneData().getOrCreateStateSet(),this._rootStateSet.setShaderGeneratorName(this.getCompilerName()),this.updateShadingGlobal(),this._wireframeNodes=e.context.getScene().getWireframeNodes(),a.a.getPolygon().then(function(){this.model.set("hasVertexColor",h.a.hasVertexColor),this.model.set("hasVertexAlpha",h.a.hasVertexAlpha),!1===h.a.hasVertexColor&&this.model.set("vertexColorEnable",!1),!1===h.a.hasVertexAlpha&&this.model.set("vertexColorUseAlpha",!1),this.onVertexColorChanged(),this.model.set("hasPoints",d.a.hasPoints),this.model.set("hasTriangles",d.a.hasTriangles),this.model.set("hasLines",d.a.hasLines)}.bind(this)),f.a.getBoxReady().then(this.onPointSizeChanged.bind(this)),a.a.getWireframeOptimizedSplit().then(this.initWireframe.bind(this)),this._viewer.bind("resizeRatio",this.onPointSizeChanged,this),a.a.getMaterial().then(function(){this._viewer.getFeatures().camera.getModel().bind("change:fov",this.onPointSizeChanged,this)}.bind(this))},onWebVRChanged:function(){for(var e=this._wireframeNodes,t=0,i=e.length;t<i;++t)e[t].getStateSet().setRenderBinVR(this.model.get("webVR"))},onPointSizeChanged:function(){var e=this._viewer.getFeatures(),t=this._viewer.getFeaturesManager(),i=f.a.getModelBoxWithDisplacement().radius();i*=this.model.get("pointSize"),i*=45/e.camera.getModel().get("fov"),i*=75e-5*t.getViewport3d().height(),p.a.cachedSquarePoint.setPointSize(i),p.a.cachedCirclePoint.setPointSize(i),Object(m.a)()&&l.a.draw()},initWireframe:function(){var e=!0===this.model.get("wireframeEnable")?s.a.NO_PICK_NO_SHADOW:0;this.setWireframeNodesMask(e);for(var t=this._wireframeNodes,i=0,r=t.length;i<r;++i)t[i].getStateSet()||t[i].setStateSet(new o.a);var a=this.setWireframeNodesMask.bind(this,0);o.a.updateCallback.setFinishCallback(a),this.onWireframeColorChanged(),this.model.get("wireframeEnable")&&this.onWireframeEnableChanged()},setWireframeNodesMask:function(e){for(var t=this._wireframeNodes,i=0,r=t.length;i<r;++i)t[i].setNodeMask(e);c.a.setWireframe(0!==e)},getCompilerName:function(){var e=this.model.get("type");return"matcap"===e||"inspector"===e?e:e+"-"+this.model.get("renderer")},updateShadingGlobal:function(){var e,t=this.model.get("type"),i=this.model.get("renderer"),r="pbr"===i;e="matcap"===t?u.a.MATCAP:"inspector"===t?u.a.INSPECTOR:"shadeless"===t?r?u.a.PBR_SHADELESS:u.a.CLASSIC_SHADELESS:r?u.a.PBR_LIT:u.a.CLASSIC_LIT,u.a.set("mask",e)},_overrideChannelTexture:function(e,t,i){e.getTextureModel()?!i&&t.getTextureModel()||t.setTextureModel(e.getTextureModel().clone()):!t.getTextureModel()&&t.setColor&&e.getColor&&t.setColor(e.getColor())},copyChannels:function(e,t,i){var r={DiffusePBR:"DiffuseColor",AlbedoPBR:"DiffuseColor",AOPBR:"DiffuseIntensity"};for(var a in r){var n=t.getChannels(),o=n[a],s=n[r[a]];if("pbr"!==e){var u=t.isWorkflowMetalness();(u&&"DiffusePBR"!==a||!u&&"AlbedoPBR"!==a)&&this._overrideChannelTexture(o,s,i)}else this._overrideChannelTexture(s,o,i)}},onRendererChanged:function(e,t,i){this.onShadingChanged();var r=this.model.get("renderer"),a=void 0===i.copyChannel||i.copyChannel,n=void 0===i.overrideTexture||i.overrideTexture,o=this._viewer.getFeatures().material;if(!o)return void g.error("The renderer has been changed before the material feature is initialized");var s=o.getModel().attributes,u=this;if(a)for(var c in s)u.copyChannels(r,s[c],n);l.a.draw()},onShadingChanged:function(){this.updateShadingGlobal(),this._rootStateSet.setShaderGeneratorName(this.getCompilerName()),l.a.draw()},onWireframeColorChanged:function(){for(var e=this._wireframeNodes,t=0,i=e.length;t<i;++t)e[t].getStateSet().setWireframeColor(this.getRGBA())},onSetWireframeColorSmooth:function(e){var t=this.model;t.off("change:wireframeColor",this.onWireframeColorChanged,this),t.set("wireframeColor",e),t.bind("change:wireframeColor",this.onWireframeColorChanged,this);for(var i=this._wireframeNodes,r=0,a=i.length;r<a;++r)i[r].getStateSet().setWireframeColorSmooth(this.getRGBA());t.off("change:wireframeColor",this.onWireframeColorChanged,this),t.set("wireframeColor",e),t.on("change:wireframeColor",this.onWireframeColorChanged,this)},onWireframeEnableChanged:function(){this.setWireframeNodesMask(s.a.NO_PICK_NO_SHADOW);for(var e=this._wireframeNodes,t=this.model.get("wireframeEnable"),i=0,r=e.length;i<r;++i)e[i].getStateSet().setWireframeEnable(t,this.getRGBA())},getRGBA:function(){var e=g.vec4.create();return function(t){var i=t||this.model.get("wireframeColor");return e[0]=parseInt(i.substr(0,2),16)/255,e[1]=parseInt(i.substr(2,2),16)/255,e[2]=parseInt(i.substr(4,2),16)/255,e[3]=parseInt(i.substr(6,2),16)/255,e}}(),onVertexColorChanged:function(){var e=this.model.get("vertexColorEnable"),t=e&&this.model.get("vertexColorUseAlpha"),i=this.model.get("vertexColorColorSpace"),r=this._viewer.getFeatures().material;if(r){var a=r.getModel().attributes;for(var n in a){var o=a[n];o.set("vertexColorEnable",e&&o.get("hasVertexColor")),o.set("vertexColorColorSpace",i);var s=t&&o.get("hasVertexAlpha");o.set("vertexAlphaEnable",s)}l.a.draw()}}});t.a=_},function(e,t,i){"use strict";var r=i(62),a=i(1214),n=i(1215),o={FeatureName:"quality",ModelType:a.a,ViewListType:[n.a]},s=r.a.create(o);s.prototype.prepareForScreenShot=function(){this._model.set("maxQuality",!0)},s.prototype.resetAfterScreenShot=function(){this._model.set("maxQuality",!1)},t.a=s},function(e,t,i){"use strict";var r=i(42),a=i.n(r),n=i(5),o=i(12),s=i(16),u=i(83),l=i(47),c=n.a.osg,h=o.a.extend({defaults:function(){var e=1;return a.a.any?e=0:Object(l.a)()&&(e=2),this._deferReady=Object(u.a)(),{promiseReady:this._deferReady.promise,level:e,maxQuality:!1,dynamicResolutionScaling:c.vec2.fromValues(1,1)}},getBudget:function(){var e=Object(s.a)();return void 0!==e.pixelBudget?0===e.pixelBudget?1/0:e.pixelBudget:this.getBudgetFromLevel(this.get("level"))},getBudgetFromLevel:function(e){return 0===e?6144:1===e?12288:1/0},getName:function(){return"Quality"}});t.a=h},function(e,t,i){"use strict";var r=i(8),a=i(34),n=i(16),o=i(607),s=i(606),u=i(37),l=i(5),c=l.a.osg,h=c.Timer.instance(),d=Object(n.a)().drs?Object(n.a)().drsRatio:0,p=Object(n.a)().drsMin,f=1e3/Object(n.a)().drsFps,m=r.a.extend({initialize:function(){r.a.prototype.initialize.apply(this,arguments);var e=this.options.context;this._viewer=e.getViewer(),this._fMaterial=e.getFeatures().material,this._version=e.getModel().get("options").version,this.model.bind("change:level",this.onLevelChanged,this),this.model.bind("updateTexelPolicy",this.updateTexelPolicy,this),this.model.bind("updateDynamicResolutionScaling",this._updatePixelRatio.bind(this)),this._maxSize=Object(o.a)(),this._resumeDrs=1,this._resumeQuality=1,this._resumeAfterSSAA=!0,this._drsTest=Object(n.a)().drsTest,this._lastTickIncreaseDrs=0,this._lastTickIncreasePP=0,this._continuousDrs=0,this._continuousQuality=0,a.a.getFirstCameraAnimation().then(this.initTimers.bind(this))},initTimers:function(){this._lastTick=h.tick(),this._viewer.getRootScene().addUpdateCallback(this)},_updatePixelRatio:function(){var e=this.model.get("dynamicResolutionScaling"),t=this._viewer.getViewerOSGJS().getCanvasPixelRatio(),i=this._viewer.getInputManager().getParam("pixelRatio");i[0]=t*e[0],i[1]=t*e[1]},_forceFullRes:function(){if(this.model.get("maxQuality"))return!0;var e=this._viewer.getSuperSample();return!(!e.isEnabled()&&!e.isFakeEnabled())||!!this._viewer.getFeatures().webVR.getModel().get("enable")},_sceneBeingDrawn:function(){return this._viewer.getFeatures().postProcess.getCamera().getNodeMask()},_handleQualitySSAA:function(){var e=this._viewer.getFeatures(),t=e.postProcess.getModel(),i=this.model.get("dynamicResolutionScaling");if(this._forceFullRes()){if(this._resumeAfterSSAA)return!0;this._resumeQuality=t.getQuality(),this._resumeDrs=i[0],i[0]=1;var r=this.model.get("maxQuality"),a=r?1.01:Math.max(.5,.3+this._resumeQuality);return t.setQuality(a),this._resumeAfterSSAA=!0,!0}return!this._sceneBeingDrawn()||!!this._resumeAfterSSAA&&(this._resumeAfterSSAA=!1,i[0]=this._resumeDrs,t.setQuality(this._resumeQuality),this._continuousQuality=this._resumeQuality,this._continuousDrs=this._resumeDrs,!0)},_updateQuality:function(e,t){if(!this._handleQualitySSAA()){var i=e-t,r=this._viewer.getFeatures(),a=r.postProcess.getModel(),n=this.model.get("dynamicResolutionScaling"),o=(f-i)/f;this._continuousDrs=this._continuousDrs+this._continuousDrs*d*o,this._continuousDrs=Math.min(1,Math.max(p,this._continuousDrs));var s=Math.min(1,1.2*n[0]);if(this._continuousDrs<n[0]?(n[0]=this._continuousDrs,this._lastTickIncreaseDrs=e):this._continuousDrs>=s&&e-this._lastTickIncreaseDrs>500&&(n[0]=s,this._lastTickIncreaseDrs=e),this._drsTest){this._drsTest++,n[0]=this._drsTest%200>100?1:.3,u.a.draw()}var l=(1e3/55-i)/(1e3/55);this._continuousQuality=Math.min(Math.max(0,this._continuousQuality+l),1);var c=a.getQuality(),h=Math.min(1,c+.2),m=Math.max(0,c-.2);e-this._lastTickIncreasePP>500&&(this._continuousQuality<m?(a.setQuality(m),this._lastTickIncreasePP=e):this._continuousQuality>=h&&(a.setQuality(h),this._lastTickIncreasePP=e))}},update:function(){var e=this.model.get("dynamicResolutionScaling"),t=e[0],i=h.tick();return this._updateQuality(i,this._lastTick),this._lastTick=i,e[1]=e[0],t!==e[0]&&this.model.trigger("updateDynamicResolutionScaling"),!0},getMaterials:function(){return this._fMaterial.getModel().attributes},onLevelChanged:function(){this.updateTexelPolicy();var e=this._fMaterial._views[0],t=e.requestAllHighResTextures(this._fMaterial.getModel().attributes);this._viewer.setFakeSecondaryProgress(t,"texture"),this._fMaterial._views[0].cleanAndApplyMaterials()},getOrCreateTexelInfos:function(){return this._fMaterial._views[0].getOrCreateTexelInfos()},getMaxSizeFromBudget:function(e){var t=e*e,i=this.getOrCreateTexelInfos();if(0===i.gpuTextureCount||i.gpuPixelCount<=t)return this._maxSize;var r=Math.min(this._maxSize,Math.sqrt(t/i.gpuTextureCount));return r=s.a.snapToPowerOf2(r,.75),this._version<2&&(r<1024?r=512:r>=1024&&r<2048&&(r=2048)),i.max<=r||i.gpuPixelCount<=r*r?this._maxSize:r},_printErrorMissingResolution:function(e){var t=Object.keys(e.missingTextures).length;if(0===t)return 0;var i="",r=e.missingTextures;for(var a in r)i+="\n"+a+" ("+r[a].join(", ")+")";return console.error("Multi-resolution textures missing : "+t+i),t},updateTexelPolicy:function(){if(Object(n.a)().imageCompression){var e=this.getOrCreateTexelInfos(),t=this._printErrorMissingResolution(e);0===e.gpuTextureCount||t>=e.gpuTextureCount||(this.model.get("promiseReady").isPending()&&this.initAvailableTextureQuality(),Object(n.a)().maxTextureSize=this.getMaxSizeFromBudget(this.model.getBudget()))}},initAvailableTextureQuality:function(){var e=this.getMaxSizeFromBudget(this.model.getBudgetFromLevel(0)),t=this.getMaxSizeFromBudget(this.model.getBudgetFromLevel(1)),i={low:!0,mid:t!==e,high:t!==this._maxSize},r=this.model.get("level");i.high||2!==r||(r=1),i.mid||1!==r||(r=0),1===r&&(i.low=!1),this.model.off(null,this.onLevelChanged,this),this.model.set("level",r),this.model.on("change:level",this.onLevelChanged,this),this.model._deferReady.resolve(i)}});t.a=m},function(e,t,i){"use strict";var r=i(62),a=i(1217),n=i(1218),o={FeatureName:"autospin",ModelType:a.a,ViewListType:[n.a]},s=r.a.create(o);s.prototype.getNode=function(){return this._views[0]._nodeAutospin},t.a=s},function(e,t,i){"use strict";var r=i(15),a=i.n(r),n=i(16),o=a.a.Model.extend({defaults:{enable:!1,paused:!1,speed:.6},getName:function(){return"Autospin"},init:function(){var e=Object(n.a)();void 0!==e.autospin&&(this.set("enable",!!e.autospin),this.set("speed",e.autospin))}});t.a=o},function(e,t,i){"use strict";var r=i(5),a=i(8),n=i(608),o=i(1219),s=i(34),u=i(145),l=r.a.osg,c=r.a.InputGroups,h=a.a.extend({initialize:function(){a.a.prototype.initialize.apply(this,arguments),this._viewer=this.options.context.getViewer(),this._inputManager=this._viewer.getInputManager();var e=this.model;e.bind("change:enable",this.onEnableChanged,this),e.bind("change:paused",this.onPausedChanged,this),e.bind("change:speed",this.onSpeedChanged,this),this._nodeAutospin=new l.MatrixTransform,this._nodeAutospin.setName("Feature - Autospin"),this._callbackAutospin=new o.a(e.get("speed"),1,1),this._nodeAutospin.addUpdateCallback(this._callbackAutospin),!1===e.get("enable")&&this._callbackAutospin.deactivate(),u.a.initAutospin(this,this.model.get("enable")),s.a.getModelDisplayed().then(this.linkWithEvents.bind(this))},isOrbit:function(){var e=this._viewer.getFeatures().camera;return e&&e.getModel().get("indexManipulator")===n.a.ORBIT},linkWithEvents:function(){this._viewer.getFeatures().camera.getModel().bind("change:indexManipulator",this.onManipulatorChange.bind(this)),this.onManipulatorChange()},onManipulatorChange:function(){clearTimeout(this._timerAutospin),this.model.set("paused",!this.isOrbit())},pause:function(){clearTimeout(this._timerAutospin),this.model.set("paused",!0)},resume:function(){if(this.isOrbit()){var e=this.model;this._timerAutospin=setTimeout(function(){e.set("paused",!1)},5e3)}},onEnableChanged:function(){!0===this.model.get("enable")?(this._callbackAutospin.resume(),this._inputManager.setEnable(c.AUTOSPIN,!0)):(this._callbackAutospin.deactivate(),this._inputManager.setEnable(c.AUTOSPIN,!1))},onPausedChanged:function(){!1!==this.model.get("enable")&&(!0===this.model.get("paused")?this._callbackAutospin.pause():this._callbackAutospin.resume())},onSpeedChanged:function(){this._callbackAutospin.setSpeed(this.model.get("speed"))}});t.a=h},function(e,t,i){"use strict";var r=i(5),a=i(37),n=r.a.osg,o=function(e,t,i){this._speed=void 0!==e?e:-.6,this._fadeStart=void 0!==t?t:2,this._fadeEnd=void 0!==i?i:2,this._enable=!0,this._rotation=0,this._lastTime=-1,this._startTime=0,this._endTime=0,this._checkIfFinished=!1,this._fixedCenter=void 0};n.createPrototypeObject(o,{setSpeed:function(e){this._speed=e},setFadeStart:function(e){this._fadeStart=e},setFadeEnd:function(e){this._fadeEnd=e},deactivate:function(){this._enable=!1},resume:function(){this._enable=!0,this._checkIfFinished=!1;var e=Math.max((this._endTime-this._lastTime)/this._fadeEnd,0);this._startTime=this._lastTime-this._fadeStart*e,this._endTime=this._lastTime,a.a.draw()},pause:function(){var e=Math.min((this._lastTime-this._startTime)/this._fadeStart,1);this._endTime=this._lastTime+this._fadeEnd*e,this._checkIfFinished=!0},update:function(){var e=n.mat4.create();return function(t,i){if(!1===this._enable)return!0;a.a.draw();var r=i.getFrameStamp().getSimulationTime();if(!0===this._checkIfFinished&&this._endTime<r)return this._enable=!1,this._checkIfFinished=!1,this._lastTime=-1,!0;if(this._lastTime<0)return this._lastTime=r,this._startTime=r,!0;var o=r-this._lastTime;this._lastTime=r,this._endTime>r?this._rotation+=o*n.smoothStep(0,1,(this._endTime-r)/this._fadeEnd):r-this._startTime<this._fadeStart?this._rotation+=o*n.smoothStep(0,1,(r-this._startTime)/this._fadeStart):this._rotation+=o;var s=t.getMatrix();n.mat4.fromZRotation(s,-this._rotation*this._speed);var u=t.getChildren();if(u.length>0){if(!this._fixedCenter){var l=u[0].getMinimumBound();l.valid()&&(this._fixedCenter=n.vec3.create(),n.vec3.copy(this._fixedCenter,l.center()))}var c=this._fixedCenter||u[0].getMinimumBound().center();n.vec3.negate(c,c),n.mat4.fromTranslation(e,c),n.mat4.multiply(s,s,e),n.vec3.negate(c,c),n.mat4.fromTranslation(e,c),n.mat4.multiply(s,e,s)}return t.dirtyBound(),!0}}()},"osgSketchfab","UpdateCallbackAutospin"),t.a=o},function(e,t,i){"use strict";var r=i(62),a=i(1221),n=i(1222),o={FeatureName:"orientation",ModelType:a.a,ViewListType:[n.a]},s=r.a.create(o);s.prototype.getNode=function(){return this._views[0].getNodeOrientation()},s.prototype.getWidgetNode=function(){return this._views[0].getNodeGrid()},t.a=s},function(e,t,i){"use strict";var r=i(120),a=i(5),n=i(16),o=a.a.osg,s=r.a.extend({getModelOptionPath:function(){return"orientation"},defaults:{showGizmo:!1},getName:function(){return"Orientation"},init:function(e){this.setJSON(e.getModel().get("options").orientation);var t=Object(n.a)().scale,i=this.get("matrix");1!==t&&o.mat4.scale(i,i,o.vec3.fromValues(t,t,t))},editorGetJSON:function(){return this.getJSON()},editorSetJSON:function(e){return this.setJSON(e,{validate:!0})}});t.a=s},function(e,t,i){"use strict";var r=i(5),a=i(8),n=i(1223),o=i(1224),s=r.a.osg,u=r.a.osgUtil,l=a.a.extend({initialize:function(){a.a.prototype.initialize.apply(this,arguments);var e=this.model;e.bind("change:matrix",this.onMatrixChanged,this),e.bind("change:showGizmo",this.onGizmoShowChanged,this),e.bind("turn",this.onTurn,this),e.bind("reset",this.onReset,this);var t=this.options.context;this._viewer=t.getViewer(),this._nodeGrid=new o.a,this._nodeGrid.setName("Node grid"),this._nodeOrientation=new s.MatrixTransform,this._nodeOrientation.setName("Feature - Orientation"),this._nodeOrientation.addChild(this._nodeGrid),this._nodeGizmo=new s.MatrixTransform,this._nodeGizmo.setCullingActive(!1),this._nodeGizmo.editMask=u.NodeGizmo.PICK_ARC|u.NodeGizmo.PICK_ARROW_Z,this._gizmoTra=new s.MatrixTransform,this._gizmoTra.setReferenceFrame(s.Transform.ABSOLUTE_RF),this._gizmoTra.addChild(this._nodeGizmo);var i=this.model.get("matrix");this._nodeOrientation.setMatrix(i);var r=s.mat4.getRotation(s.quat.create(),i);s.mat4.fromQuat(this._nodeGizmo.getMatrix(),r);var l=this._viewer.getRootModel(),c=this._viewer.getViewerOSGJS().getManipulator();this._callbackOrientation=new n.a(c,.5,this,l),this._nodeOrientation.addUpdateCallback(this._callbackOrientation)},onReset:function(){var e=s.mat4.getTranslation(s.vec3.create(),this.model.get("matrix"));s.mat4.fromTranslation(this.model.get("matrix"),e),this.onMatrixChanged()},onTurn:function(e,t){var i="right"===t?1:-1,r="x"===e?i:0,a="y"===e?i:0,n="z"===e?i:0,o=s.mat4.fromRotation(s.mat4.create(),-Math.PI/2,s.vec3.fromValues(r,a,n)),u=this.model.get("matrix");s.mat4.multiply(u,o,u),this.onMatrixChanged()},onGizmoShowChanged:function(){var e=this.model.get("showGizmo"),t=this._viewer.getFeaturesManager();if(t){var i=t.getNodeGizmo();if(i){var r=this._nodeGizmo.getMatrix(),a=r[14];s.mat4.copy(r,this.model.get("matrix")),r[12]=0,r[13]=0,r[14]=a,i.setForcePicking(e),i.setRotateInLocal(!e),i.setTranslateInLocal(!e),i.attachToNode(e?this._nodeGizmo:null),this._nodeGrid.showGridTemporary(e?0:2.5),this._callbackOrientation.setGizmoMode(e)}}},onMatrixChanged:function(){this.model.get("showGizmo")||this._nodeGrid.showGridTemporary(2.5),this._callbackOrientation.setQuatTarget(s.mat4.getRotation(s.quat.create(),this.model.get("matrix")))},getNodeGrid:function(){return this._nodeGrid},getNodeOrientation:function(){return this._nodeOrientation}});t.a=l},function(e,t,i){"use strict";var r=i(5),a=i(704),n=i(37),o=i(79),s=r.a.osg,u=function(e,t,i,r){this._model=i.model,this._manipulator=e,this._applyWithoutTranslation=!1,this._quatCurrent=s.mat4.getRotation(s.quat.create(),this._model.get("matrix")),this._quatTarget=s.quat.create(),this._quatStart=s.quat.create(),this._nodeGrid=i._nodeGrid,a.a.call(this,t),this._finished=!0,this._nodeGizmo=i._nodeGizmo,this._gizmoTra=i._gizmoTra,this._gizmoMode=!1,this._rootModel=r,this._nodeOrientation=i._nodeOrientation,this._features=i.options.context.getFeatures(),this._scaleModel=s.vec3.create(),this._worldCenter=s.vec3.create(),this._negateLocalCenter=s.vec3.create(),o.a.getBoxReady().then(this.initModelBound.bind(this))};s.createPrototypeObject(u,s.objectInherit(a.a.prototype,{setQuatTarget:function(e){s.quat.copy(this._quatStart,this._quatCurrent),s.quat.copy(this._quatTarget,e),this.reset(),this._gizmoMode=!1},initModelBound:function(){var e=o.a.getModelBoxWithoutDisplacement();e.center(this._worldCenter);var t=this._rootModel.getMinimumBound();s.vec3.negate(this._negateLocalCenter,t.center());var i=e.radius();s.vec3.set(this._scaleModel,i,i,i),this._nodeGizmo.getMatrix()[14]-=.51*(e.getMax()[2]-e.getMin()[2])},setGizmoMode:function(e){this._gizmoMode=e,this.rotateNode(this._nodeOrientation)},getQuatTarget:function(){return this._quatTarget},getQuatStart:function(){return this._quatStart},update:function(e,t){if(this._gizmoMode)return s.mat4.getRotation(this._quatCurrent,this._nodeGizmo.getMatrix()),this.rotateNode(e),!0;if(this._finished)return!0;n.a.draw();var i=t.getFrameStamp().getSimulationTime(),r=this.interpolate(i,e,t);if(r=s.smoothStep(0,1,r),s.quat.slerp(this._quatCurrent,this._quatStart,this._quatTarget,r),this.rotateNode(e),this._finished){var a=this._nodeGizmo.getMatrix(),o=a[14];s.mat4.fromQuat(a,this._quatCurrent),a[14]=o,this._gizmoMode=this._model.get("showGizmo")}return!0},rotateNode:function(){var e=s.mat4.create();return function(t){var i=this._gizmoTra.getMatrix();s.mat4.fromTranslation(i,this._worldCenter);var r=t.getMatrix();s.mat4.fromQuat(r,this._quatCurrent),s.mat4.mul(r,i,r),s.mat4.translate(r,r,this._negateLocalCenter);var a=this._nodeGrid.getMatrix();s.mat4.scale(a,i,this._scaleModel),a[14]+=this._nodeGizmo.getMatrix()[14],s.mat4.invert(e,r),s.mat4.mul(a,e,a),this.updateShadows(),t.dirtyBound()}}(),updateShadows:function(){var e=this._features.environment;e&&e.getNode().updateShadow();var t=this._features.lighting;if(t)for(var i=t.getModel().get("lights"),r=0,a=i.length;r<a;++r)i[r].dirty()}})),t.a=u},function(e,t,i){"use strict";var r=i(5),a=i(858),n=i(107),o=i(1225),s=i.n(o),u=i(1226),l=i.n(u),c=i(1227),h=i.n(c),d=i(1228),p=i.n(d),f=i(43),m=i(57),g=i(63),_=r.a.osg,v=function(){_.MatrixTransform.call(this),this._timeGrid=0;var e=_.Uniform.createFloat4(_.vec4.fromValues(.5,.5,.5,0),"uColor");this._callbackColor=new a.a(e.getInternalArray(),1),this._callbackColor.setFinishCallback(this._disableGrid.bind(this)),this.addUpdateCallback(this._callbackColor);var t=this.getOrCreateStateSet();t.setAttributeAndModes(g.a.DEPTH_LEQUAL_WRITE),t.setAttributeAndModes(g.a.BLEND_SUBSTRACTIVE),t.setRenderBinDetails(m.a.GRID,"RenderBin"),t.addUniform(e),this._grid=_.createGridGeometry(-1,-1,0,2,0,0,0,2,0,10,10),this._axis=_.createAxisGeometry(1),this.addChild(this._grid),this.addChild(this._axis),this._grid.getOrCreateStateSet().setAttributeAndModes(n.a.createShader(s.a,l.a,"orientation-grid","Grid")),this._axis.getOrCreateStateSet().setAttributeAndModes(n.a.createShader(h.a,p.a,"orientation-axis","OrientationAxis")),this._disableGrid()};_.createPrototypeNode(v,_.objectInherit(_.MatrixTransform.prototype,{showGridTemporary:function(e){this._grid.dirtyBound(),this._axis.dirtyBound(),this.setNodeMask(f.a.NO_PICK_NO_SHADOW),this._callbackColor.show(),window.clearTimeout(this._timeGrid),e&&(this._timeGrid=window.setTimeout(this.hideGrid.bind(this),1e3*e))},_invalidateNodeBound:function(e){e.dirtyBound(),e.getBoundingBox().init(),e.getBoundingSphere().init()},_disableGrid:function(){this.setNodeMask(0),this._invalidateNodeBound(this._grid),this._invalidateNodeBound(this._axis),this._invalidateNodeBound(this)},hideGrid:function(){this._timeGrid=0,this._callbackColor.hide()}}),"osgSketchfab","Grid"),t.a=v},function(e,t){e.exports="attribute vec3 Vertex;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex, 1.0);\n}\n"},function(e,t){e.exports="uniform vec4 uColor;\n\nvoid main(void) {\n  gl_FragColor = vec4(uColor.xyz * uColor.a, uColor.a);\n}\n"},function(e,t){e.exports="attribute vec3 Vertex;\nattribute vec4 Color;\nvarying vec4 vColor;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n    vColor = Color;\n    gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex, 1.0);\n}\n"},function(e,t){e.exports="uniform vec4 uColor;\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vec4( vec3(vColor) * uColor.a, uColor.a);\n}\n"},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(62)),n=i(1230),o=i(1232),s={FeatureName:"environment",ModelType:n.a,ViewListType:[o.a]},u=a.a.create(s);u.prototype=Object(r.extend)({},a.a.prototype,{getNode:function(){return this._views[0].getNodeEnvironment()},getRotating:function(){return this._views[0].getRotating()}}),t.a=u},function(e,t,i){"use strict";var r=i(34),a=i(120),n=i(70),o=i(1231),s=i(59),u=i(938),l=i(5),c=l.a.osg,h={uid:"2fa15e0b1cee45a5b02605a288934e1b",brightness:4.063},d=a.a.extend({_trashbin:[],getModelOptionPath:function(){return"environment"},getRandomEnvironment:function(){var e=[];return this.environmentCollection.each(function(t){t.get("isDefault")&&-1===u.a.indexOf(t.get("uid"))&&e.push({uid:t.get("uid"),brightness:t.get("brightness")})}),0===e.length?h:e[Math.round(Math.random()*(e.length-1))]},defaults:function(){return{}},initDefaults:function(e){e.enable=Object(n.a)(),e.uid=h.uid,e.exposure=h.brightness,e.shadowEnable=Object(n.a)(),a.a.prototype.initDefaults.call(this,e)},init:function(e){this._context=e,this._viewer=e.getViewer();var t=e.getModel().get("options"),i=t.environment,a=void 0===i.uid;if(i&&this.setJSON(i),this.environmentCollection=s.default.instance.getEnvironmentCollection(),a){var o=this.getRandomEnvironment();this.set("uid",o.uid),this.set("exposure",o.brightness)}this.checkEnvironmentValidity(),Object(n.a)()?r.a.getPolygon().then(this.updateEnvironmentConfig.bind(this)):r.a.getPolygon().then(function(){var e=this.getEnvironment();if(!e)return void this.checkEnvironmentValidity();var t=this._getYRotationFromLightDirection(e);this.set("lightRotation",t)}.bind(this))},_getYRotationFromLightDirection:function(e){var t=e.get("lights"),i=0;if(t.length){var r=c.vec3.clone(t[0].direction);if(Math.abs(r[1])<.99999){r[1]=0,c.vec3.normalize(r,r);var a=Math.acos(r[0]);i=r[2]>0?a:2*Math.PI-a}}return i},updateEnvironmentConfig:function(){var e=this.getEnvironment();if(!e)return void this.checkEnvironmentValidity();var t=this.get("rotation"),i=this.get("lightRotation"),r=this._getYRotationFromLightDirection(e);this.set("lightRotation",r);var a=0;void 0!==i&&(a=i-r);var s=2*Math.PI,u=(s+t+a)%s,l=Object(o.a)(this._viewer.getRootUserData().source)[e.get("uid")];l?(void 0!==l.environmentExposure&&this.set("exposure",parseFloat(l.environmentExposure)),void 0!==l.lightIntensity&&this.set("lightIntensity",parseFloat(l.lightIntensity)),void 0!==l.brightness&&this.set("backgroundExposure",parseFloat(l.brightness)),void 0!==l.rotation&&(u=parseFloat(l.rotation))):this.set("exposure",parseFloat(e.get("brightness"))||1),this.set("rotation",u);var c=this._viewer.getRootUserData();Object(n.a)()&&"Tilt Brush"===c.authoringTool&&(this.set("uid","3e2ad3e1f1ea47679f045a7eb0e6af49"),this.set("exposure",.5))},getEnvironmentCollection:function(){return this.environmentCollection},checkEnvironmentValidity:function(){this.getEnvironment()||(this.set("uid",h.uid),this.set("exposure",h.brightness))},getName:function(){return"Environment"},getEnvironment:function(){var e=this.get("uid");return this.environmentCollection.find(function(t){return t.get("uid")===e})},isShadowEnable:function(){return this.get("shadowEnable")},editorGetJSON:function(){return this.getJSON()},editorSetJSON:function(e){return this.setJSON(e,{validate:!0})}});t.a=d},function(e,t,i){"use strict";var r={"80fba9759ab94307a782f38d359b8ea8":{rotation:1.57,environmentExposure:8.5,lightIntensity:1.5,brightness:1},"2e9c3708feb74137b0436f946b8b66b8":{rotation:1.6,environmentExposure:2.5,lightIntensity:2,brightness:1.12},"268447ca0a954f44b06d1387863d114e":{rotation:6.25,environmentExposure:1.2,lightIntensity:2.5,brightness:1},"3e2ad3e1f1ea47679f045a7eb0e6af49":{rotation:.3,environmentExposure:.59,lightIntensity:2.5,brightness:1},"2fa15e0b1cee45a5b02605a288934e1b ":{rotation:.68,environmentExposure:2.5,lightIntensity:2.5,brightness:1},"9190e8da70694ef3b9d1d0c01541917e":{rotation:3.24,environmentExposure:1.7,lightIntensity:2.5,brightness:.57},"749a0594343e4ff9a2875cb411d0ad1a":{rotation:4.73,environmentExposure:.35,lightIntensity:3,brightness:1},f2dabeb04674446696486eea67028bd8:{rotation:4.71,environmentExposure:.35,lightIntensity:3,brightness:1.5},df380da788ee444885722735039b0c09:{rotation:.27,environmentExposure:.55,lightIntensity:3,brightness:1.46},"16cdcddf277d423d99094f8db0c731e9":{rotation:3.73,environmentExposure:1.5,lightIntensity:2.2,brightness:.53},c281dff366844cbc8b33179337037f42:{rotation:3.64,environmentExposure:4.5,lightIntensity:3,brightness:.53}},a={substancepainter:r},n={};n={e871dd2920334a0f9c3107a00da3c24a:{uid:"e871dd2920334a0f9c3107a00da3c24a",name:"Gareoult",environmentExposure:.7,lightIntensity:3},"102d22e28ca34190a8470402ccdc35d3":{uid:"102d22e28ca34190a8470402ccdc35d3",name:"Milkyway",environmentExposure:6.8,lightIntensity:3},cd5e5b1607d844cdb928e96ff9c36b5c:{uid:"cd5e5b1607d844cdb928e96ff9c36b5c",name:"QueenMary chimney",environmentExposure:7,lightIntensity:3},"8653449395004fd58820874bfff93ce7":{uid:"8653449395004fd58820874bfff93ce7",name:"Kirby_cove",environmentExposure:.6,lightIntensity:4},"3e2ad3e1f1ea47679f045a7eb0e6af49":{uid:"3e2ad3e1f1ea47679f045a7eb0e6af49",name:"Gdansk shipyard buildings",environmentExposure:.4,lightIntensity:3},d348dfd2a8104ab0b8528f885d645eb3:{uid:"d348dfd2a8104ab0b8528f885d645eb3",name:"footprint",environmentExposure:1.2,lightIntensity:5},"2fa15e0b1cee45a5b02605a288934e1b":{uid:"2fa15e0b1cee45a5b02605a288934e1b",name:"glazed patio by restaurant",environmentExposure:2.7,lightIntensity:3},"5335c7c5c2434866ac8a442157f24f5e":{uid:"5335c7c5c2434866ac8a442157f24f5e",name:"tropical ruins",environmentExposure:2,lightIntensity:3},"9190e8da70694ef3b9d1d0c01541917e":{uid:"9190e8da70694ef3b9d1d0c01541917e",name:"industrial room",environmentExposure:1,lightIntensity:3},df380da788ee444885722735039b0c09:{uid:"df380da788ee444885722735039b0c09",name:"studio",environmentExposure:.8,lightIntensity:3},"4eda3e78ed214dc8852c439dc64b9c9d":{uid:"4eda3e78ed214dc8852c439dc64b9c9d",name:"road in dordogne",environmentExposure:.6,lightIntensity:2.5},"749a0594343e4ff9a2875cb411d0ad1a":{uid:"749a0594343e4ff9a2875cb411d0ad1a",name:"road in tenerife mountain",environmentExposure:.7,lightIntensity:3.5},c281dff366844cbc8b33179337037f42:{uid:"c281dff366844cbc8b33179337037f42",name:"urban exploring interior",environmentExposure:12,lightIntensity:3.3},"41192cc664484a0fa565da3361d10c9c":{uid:"41192cc664484a0fa565da3361d10c9c",name:"muir wood",environmentExposure:.9,lightIntensity:3},"5e7120378b00431ea18151e97a8366ec":{uid:"5e7120378b00431ea18151e97a8366ec",name:"treasure island",environmentExposure:.55,lightIntensity:3.5},e00dc642058b4176a4aaa449ea8ad5f8:{uid:"e00dc642058b4176a4aaa449ea8ad5f8",name:"trinitatis church",environmentExposure:.6,lightIntensity:4},e2aa1ab3582c4feab7371baf1e4cd734:{uid:"e2aa1ab3582c4feab7371baf1e4cd734",name:"arche pinetree",environmentExposure:2.3,lightIntensity:3.5},"2a016b232e444ef3a6ba323c51aa5063":{uid:"2a016b232e444ef3a6ba323c51aa5063",name:"tokyo bigsight",environmentExposure:2.3,lightIntensity:3.5}};var o=function(e){return a[e]||n};t.a=o},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(42)),n=i.n(a),o=i(7),s=i.n(o),u=i(5),l=i(83),c=i(8),h=i(34),d=i(1233),p=i(59),f=i(649),m=i(93),g=i(16),_=i(37),v=i(145),b=u.a.osg,y=u.a.InputGroups,x=c.a.extend({initialize:function(){c.a.prototype.initialize.apply(this,arguments),this._viewer=this.options.context.getViewer(),this._inputManager=this._viewer.getInputManager(),this._nodeEnvironment=new d.a(this._viewer),this._nodeEnvironment.setName("Feature - Environment"),this._backgroundLoaded={},this.model.bind("change:enable",this.onEnableChanged,this),this.model.bind("change:exposure",this.onExposureChanged,this),this.model.bind("change:backgroundExposure",this.onExposureChanged,this),this.model.bind("change:rotation",this.onRotationChanged,this),this.model.bind("change:uid",this.onUIDChanged,this),this.model.bind("updateBackground",this.onBackgroundEnableChanged,this),this.model.bind("change:blur",this.onBlurChanged,this),m.a.bind("change:mask",this.onEnvironmentChanged,this),this.model.bind("change",_.a.draw),this._resourceDefer=new l.a,this.options.context.getScene().addResourcePromise(this._resourceDefer),this.model.bind("change:shadowEnable",this.onShadowEnable,this),this.model.bind("change:shadowBias",this.onShadowBiasChanged,this),this.model.bind("change:lightIntensity",this.onLightIntensityChanged,this),h.a.getMaterial().then(function(){this.initEnvironment(),this.initRotateEnvironment()}.bind(this))},getBackgroundEnableType:function(){var e=this._viewer.getFeatures().background;return e?e.getModel().getEnableType():"none"},isBackgroundEnvironment:function(){return"environment"===this.getBackgroundEnableType()},initEnvironment:function(){this.onRotationChanged(),this.onExposureChanged(),this.onEnableChanged(),this.model.get("enable")||h.a.resolveDataSizeEnvironment(0)},initRotateEnvironment:function(){this._viewer.getViewerOSGJS()&&(this._rotEnv=!1,this.mx_=0,v.a.initEnvironment(this))},startRotate:function(e){this._rotEnv=!0,this.mx_=e.canvasX,this._inputManager.setEnable(y.MANIPULATORS,!1)},_computeDelta:function(e){_.a.draw();var t=(e.canvasX-this.mx_)/100;return this.mx_=e.canvasX,t},rotateEnv:function(e,t){if(this._rotEnv){t||(t=this._computeDelta(e));var i=(this.model.get("rotation")+t)%(2*Math.PI);this.model.set("rotation",i<0?i+2*Math.PI:i)}},rotateLight:function(){var e=b.mat4.create(),t=b.mat4.create();return function(i,r){if(this._rotEnv){r||(r=this._computeDelta(i));var a=this.options.context,n=a.getFeatures().lighting;if(n){var o=this._viewer.getFeaturesManager().getWorldNode(),s=o.getMinimumBound().center();b.mat4.fromZRotation(e,-r%(2*Math.PI)),b.vec3.negate(s,s),b.mat4.multiply(e,e,b.mat4.fromTranslation(t,s)),b.vec3.negate(s,s),b.mat4.multiply(e,b.mat4.fromTranslation(t,s),e);for(var u=n.getModel().get("lights"),l=0,c=u.length;l<c;++l){var h=u[l];if(!h.isAttachedToCamera()){var d=h.get("matrix");b.mat4.multiply(d,e,d),h.dirty()}}}}}}(),rotateEnvAndLight:function(e){if(this._rotEnv){var t=this._computeDelta(e);this.rotateEnv(e,t),this.rotateLight(e,t)}},endRotate:function(){this._rotEnv&&(this._rotEnv=!1,this._inputManager.setEnable(y.MANIPULATORS,!0))},onUIDChanged:function(){this.model.updateEnvironmentConfig(),this.onEnvironmentChanged(),this.onBackgroundEnableChanged()},getRotating:function(){return this._rotEnv},getNodeEnvironment:function(){return this._nodeEnvironment},getResourceManager:function(){return this._resourceManager||p.default.instance},onEnableChanged:function(){this.model.get("enable")?(this._nodeEnvironment.enable(),this._nodeEnvironment.setLightShadowEnabled(this.model.get("shadowEnable")),this._nodeEnvironment.setLightIntensity(this.model.get("lightIntensity")),this._nodeEnvironment.setShadowBias(this.model.get("shadowBias"))):(this._nodeEnvironment.disable(),this._nodeEnvironment.setLightShadowEnabled(!1)),this.onEnvironmentChanged()},onShadowEnable:function(){var e=this.getEnvironment().get("lights");if(this.model.get("shadowEnable")&&(!e||0===e.length))return void this.model.set("shadowEnable",!1);this._nodeEnvironment.setLightShadowEnabled(this.model.get("shadowEnable"))},onShadowBiasChanged:function(){this._nodeEnvironment.setShadowBias(this.model.get("shadowBias"))},onLightIntensityChanged:function(){this._nodeEnvironment.setLightIntensity(this.model.get("lightIntensity"))},onExposureChanged:function(){this._nodeEnvironment.setExposure(this.model.get("exposure")),this._nodeEnvironment.setBackgroundExposure(this.model.get("backgroundExposure"))},onRotationChanged:function(){this._nodeEnvironment.updateRotation(this.model.get("rotation"))},onBlurChanged:function(){this.abortLastDownloadEnv(),this.isBackgroundEnvironment()&&this.setBackgroundTexture()},onBackgroundEnableChanged:function(){var e=this.getBackgroundEnableType();"environment"===e?this.setBackgroundTexture():"ambient"===e&&this.setBackgroundAmbient()},resolvePreload:function(){this._resourceDefer&&(this._resourceDefer.resolve(),this._resourceDefer=void 0)},onEnvironmentChanged:function(){var e=this.getEnvironment();if(!e||!this.model.get("enable"))return void this.resolvePreload();this._onlyLowRes=!0,this.setEnvironment(e).then(function(){var t=e.get("uid")===this.model.get("uid");Object(g.a)().preload&&t||this.resolvePreload(),t&&(this._onlyLowRes=!1,this.setEnvironment(e).finally(this.resolvePreload.bind(this)))}.bind(this))},getEnvironment:function(){return this.model.getEnvironment()},getName:function(){return"Environment3D"},abortLastDownloadEnv:function(){for(var e=this.model.get("uid"),t=this.model.get("blur"),i=this.getResourceManager()._resourceLoader._processing,r=0,a=i.length;r<a;++r){var n=i[r],o=n.getXHR();o&&(void 0!==n._envUID&&n._envUID!==e&&o.abort(),void 0!==n._envBlur&&n._envBlur!==t&&o.abort())}},setEnvironment:function(e){this.abortLastDownloadEnv();var t=[];if(m.a.get("mask")&m.a.LIT){var i=m.a.get("mask")&m.a.PBR;this._nodeEnvironment.setIsPBR(i),this._nodeEnvironment.setDiffuseSPH(e.get("diffuseSPH"));var a=e.get("lights")||[];this._nodeEnvironment.setLightProbes(a,e.id),this.model.get("shadowEnable")&&this.model.set("shadowEnable",a.length>0),this._nodeEnvironment.setDefaultExposure(e.get("brightness")),i?this.setEnvironmentPBR(e,t):this.setEnvironmentOld(e,t),this.setProgress(t.slice(),"environment")}return this.isBackgroundEnvironment()&&t.push(this.setBackgroundTexture()),0===t.length?s.a.resolve():s.a.all(Object(r.map)(t,function(e){return e.reflect()}))},setEnvironmentPBR:function(e,t){var i=this._nodeEnvironment,a=e.get("textures"),o=!1;b.WebGLCaps.instance().getWebGLExtension("EXT_shader_texture_lod")&&(o=!0),Object(g.a)().panorama&&(o=!1);var s=Object(r.find)(a,{encoding:"luv",type:"specular_ue4",format:o?"cubemap":"panorama"}),u=this.getImageRes(s),l={cubemap:o,panoramaLUV:!o,cubemapLUV:o,size:u.width,minFilter:o?b.Texture.LINEAR_MIPMAP_LINEAR:b.Texture.LINEAR,magFilter:b.Texture.LINEAR,wrapS:b.Texture.CLAMP_TO_EDGE,wrapT:b.Texture.CLAMP_TO_EDGE,transferToGPU:!0,internalFormat:b.Texture.RGBA},c=this.getResourceManager().getOrCreateTexture(u.file,l);this.markLastXHR(this.model.get("uid")),c.texture.setFlipY(!o);var d=this.getPromiseTexture(c);d.then(i.setSpecularPBRTexture.bind(i,c.texture,s.limitSize)),t.push(d);var p=u.sizeCompressed;if(!n.a.any){var f=Object(r.find)(a,{type:"brdf_ue4"});l={integrateBRDFLUV:!0,minFilter:b.Texture.NEAREST,magFilter:b.Texture.NEAREST,wrapS:b.Texture.CLAMP_TO_EDGE,wrapT:b.Texture.CLAMP_TO_EDGE,transferToGPU:!0,internalFormat:b.Texture.RGBA},u=this.getImageRes(f),p+=u.sizeCompressed;var m=this.getResourceManager().getOrCreateTexture(u.file,l);this.markLastXHR(this.model.get("uid")),m.texture.setFlipY(!1);var _=this.getPromiseTexture(m);_.then(i.setIntegrateBRDFTexture.bind(i,m.texture)),t.push(_)}h.a.resolveDataSizeEnvironment(p)},getBackgroundResource:function(e,t,i){var a,n=Object(r.find)(e,{encoding:"luv",type:"background",format:"cubemap"});return a=void 0!==i?this.getClosestBlur(n,i):this.getImageRes(n,512),t.cubemap=!0,t.cubemapLUV=!0,t.size=a.width,t.minFilter=b.Texture.LINEAR,t.magFilter=b.Texture.LINEAR,t.wrapS=b.Texture.CLAMP_TO_EDGE,t.wrapT=b.Texture.CLAMP_TO_EDGE,t.transferToGPU=!0,t.internalFormat=b.Texture.RGBA,a},setEnvironmentOld:function(e,t){var i=this._nodeEnvironment,r={},a=this.getBackgroundResource(e.get("textures"),r),n=this.getResourceManager().getOrCreateTexture(a.file,r);this.markLastXHR(this.model.get("uid"));var o=this.getPromiseTexture(n);o.then(i.setSpecularTexture.bind(i,n.texture)),h.a.resolveDataSizeEnvironment(a.sizeCompressed),t.push(o)},setBackgroundTexture:function(){var e=this.getEnvironment();if(!e)return s.a.reject(new Error);var t={},i=this.getBackgroundResource(e.get("textures"),t,this.model.get("blur")),r=this._backgroundLoaded;if(this.getRequestLowRes()){if(r[i.file])return r[i.file].promise;i=this.getBackgroundResource(e.get("textures"),t,1)}var a=this._nodeEnvironment,n=this.getResourceManager().getOrCreateTexture(i.file,t);this.markLastXHR(this.model.get("uid"),this.model.get("blur"));var o=this.getPromiseTexture(n);return o.then(function(){a.setBackgroundTexture(n.texture,i.width),r[i.file]=n}),this.setProgress(o,"background"),o},setProgress:function(e,t){var i=this._viewer.setFakeSecondaryProgress.bind(this._viewer,e,t);h.a.getHighResLoaded().then(i)},setBackgroundAmbient:function(){var e=this.getEnvironment();return e?(this._nodeEnvironment.setDiffuseSPH(e.get("diffuseSPH")),s.a.resolve()):s.a.reject(new Error)},markLastXHR:function(e,t){var i=this.getResourceManager()._resourceLoader._processing;if(i.length>0){var r=i[i.length-1];r._envUID=e,void 0===t||this.getRequestLowRes()||(r._envBlur=t)}},getPromiseTexture:function(e){return this._onlyLowRes||Object(g.a)().preload?e.promise:s.a.all([e.promise,h.a.getFirstCameraAnimation()])},getRequestLowRes:function(){return this._onlyLowRes&&!Object(g.a)().preload},getImageRes:function(e,t){var i=new f.a(e);if(this.getRequestLowRes())return i.findImageSmallest();var r=void 0!==t?t:1/0;return i.findImageNearestPowerOfTwoUpToResolution(r,r)},getClosestBlur:function(e,t){for(var i=e.images,r=0,a=1/0,n=0,o=i.length;n<o;++n){var s=Math.abs(i[n].blur-t);s<a&&(r=n,a=s)}return i[r]}});t.a=x},function(e,t,i){"use strict";var r=i(5),a=i(16),n=i(555),o=i(860),s=i(706),u=i(1235),l=i(43),c=i(1238),h=i(864),d=i(557),p=i(93),f=i(37),m=r.a.osg,g=function(e){m.Node.call(this),this.getOrCreateStateSet(),this._enable=!0,this._viewer=e,this._isPBR=!1,this._textureSpecular=void 0,this._textureSpecularUnit=6,this._textureSpecularPBR=void 0,this._textureIntegrateBRDF=void 0,this._textureSpecularPBRUnit=6,this._textureIntegrateBRDFUnit=8,this._nodeBackground=new u.a,this._adjustRotation=m.mat4.fromXRotation(m.mat4.create(),Math.PI/2),this._root=new m.MatrixTransform,m.mat4.multiply(this._root.getMatrix(),this._root.getMatrix(),this._adjustRotation),this._lightProbes=[];var t=Object(s.b)("Environment",3,n.a.DIRECTION);this._light=t.light,this._mtLight=t.node,this._shadow=t.shadowMap,this._mtLight.addChild(t.lightSource),this._lightIntensity=1,this._lightShadowEnabled=!1,this._shadowBias=5e-4,this._shadowedScene=void 0,this._lightNodeRoot=new m.MatrixTransform,this._lightNodeRoot.setName("Env Lighting - Light"),m.mat4.copy(this._lightNodeRoot.getMatrix(),this._root.getMatrix()),this._lightNodeRoot.addChild(this._mtLight),this.addUpdateCallback(this),p.a.bind("change:mask",this.updateLightShadow,this)};m.createPrototypeNode(g,m.objectInherit(m.Node.prototype,{getBackground:function(){return this._nodeBackground},enable:function(){this._enable=!0,this.setTexturesStateSet(),f.a.draw()},disable:function(){this._enable=!1,this.removeTexturesStateSet(),f.a.draw()},setBackgroundExposure:function(e){this._nodeBackground.setExposure(e),f.a.draw()},setBackgroundTexture:function(e,t){this._nodeBackground.setEnvironment(e,t),f.a.draw()},createCameraNode:function(){var e={},t=this,i=function(){this.cull=function(i,r){m.mat4.getPerspective(e,t._mainCamera.getProjectionMatrix()),m.mat4.perspective(r.getCurrentProjectionMatrix(),e.fovy*Math.PI/180,e.aspectRatio,1,1e3),m.mat4.copy(r.getCurrentModelViewMatrix(),t._mainCamera.getViewMatrix()),m.mat4.setTranslation(r.getCurrentModelViewMatrix(),m.vec3.ZERO);var a=r.getCurrentModelViewMatrix();return m.mat4.multiply(h.a.environmentTransform.getInternalArray(),a,t._root.getMatrix()),!0}},r=new m.Camera;return r.setName("Environment - Camera"),r.setCullCallback(new i),r.setReferenceFrame(m.Transform.ABSOLUTE_RF),r},init:function(e,t){this._mainCamera=e,this._shadowedScene=t,this._shadowedScene.addChild(this._lightNodeRoot);for(var i in h.a)this.getStateSet().addUniform(h.a[i]);var r=this.createCameraNode();r.setNodeMask(l.a.NO_PICK_NO_SHADOW),this.addChild(r),r.addChild(this._root),this._root.addChild(this._nodeBackground),this.updateTextureUnits(),this.updateLightShadow()},setLightShadowEnabled:function(e){this._lightShadowEnabled=e&&Object(a.a)().shadow,this.updateLightShadow()},setLightIntensity:function(e){this._lightIntensity=e,this.updateLightColorAndIntensity(),f.a.draw()},setShadowBias:function(e){this._shadowBias=e,this._shadow&&(this._shadow.setBias(e),this._shadow.requestRedraw(),f.a.draw())},setLightProbes:function(e){this._lightProbes=e,this.updateLightShadow()},removeTexturesStateSet:function(){var e=this.getStateSet();e&&(this._isPBR?(this._textureSpecularPBR&&e.removeTextureAttribute(this._textureSpecularPBRUnit,this._textureSpecularPBR.getTypeMember()),this._textureIntegrateBRDF&&e.removeTextureAttribute(this._textureIntegrateBRDFUnit,this._textureIntegrateBRDF.getTypeMember())):this._textureSpecular&&e.removeTextureAttribute(this._textureSpecularUnit,this._textureSpecular.getTypeMember()))},setTexturesStateSet:function(){var e=this.getStateSet();e&&(this._isPBR?(this._textureSpecularPBR&&e.setTextureAttributeAndModes(this._textureSpecularPBRUnit,this._textureSpecularPBR),this._textureIntegrateBRDF&&e.setTextureAttributeAndModes(this._textureIntegrateBRDFUnit,this._textureIntegrateBRDF)):this._textureSpecular&&e.setTextureAttributeAndModes(this._textureSpecularUnit,this._textureSpecular))},updateLightColorAndIntensity:function(){if(this._light&&0!==this._lightProbes.length){var e=h.a.exposure.getInternalArray()[0]/this._defaultExposure,t=this._lightProbes[0].color;m.vec3.normalize(t,t),m.vec3.scale(this._light.getDiffuse(),t,this._lightIntensity*e)}},setDefaultExposure:function(e){this._defaultExposure=e},setExposure:function(e){h.a.exposure.setFloat(e),this.updateLightColorAndIntensity()},updateLightFromProbes:function(){var e=this._lightProbes[0].direction,t=Math.abs(e[2])>.999?m.vec3.fromValues(0,1,0):m.vec3.fromValues(0,0,1),i=this._mtLight.getMatrix();m.mat4.lookAtDirection(i,m.vec3.ZERO,e,t),m.mat4.invert(i,i),this.updateLightColorAndIntensity(),Object(a.a)().debugEnvShadow&&this._debugShadow()},_debugShadow:function(){if(!this._debugDone){this._debugDone=!0;var e=m.createAxisGeometry(),t=new m.MatrixTransform;t.setMatrix(m.mat4.fromScaling(m.mat4.create(),[100,100,-500])),m.mat4.setTranslation(t.getMatrix(),[0,0,500]),t.addChild(e);var i=new o.a.createDirectionalGeometry(5);t.addChild(i),t.setNodeMask(l.a.NO_PICK_NO_SHADOW),this._mtLight.addChild(t)}},isUsingLightShadow:function(){return p.a.get("mask")&p.a.LIT&&this._lightShadowEnabled&&this._lightProbes.length>0},updateLightShadow:function(){if(this._shadowedScene){var e=this.isUsingLightShadow();if(this._light.setEnabled(e),Object(s.d)(this._shadowedScene,this._shadow),e){var t=Object(d.a)();(Object(a.a)().shadowAtlas&&t>7||t>12)&&Object(s.a)(this._shadowedScene,this._shadow),this._shadow.setBias(this._shadowBias),m.mat4.copy(this._lightNodeRoot.getMatrix(),this._root.getMatrix()),this.updateLightFromProbes(),this._shadow.requestRedraw(),f.a.draw()}}},update:function(e,t){if(e.getNumChildrenRequiringUpdateTraversal()>0&&t.traverse(e),!this._light||!this._shadow)return!1;var i=this._viewer.getFeaturesManager();return i&&i.getShadowForcedUpdate()&&this._shadow.requestRedraw(),!1},updateShadow:function(){this._light&&this._shadow&&this._shadow.requestRedraw()},updateRotation:function(e){m.mat4.fromZRotation(this._root.getMatrix(),-e),m.mat4.multiply(this._root.getMatrix(),this._root.getMatrix(),this._adjustRotation),m.mat4.copy(this._lightNodeRoot.getMatrix(),this._root.getMatrix()),this._shadow&&this._shadow.requestRedraw()},setDiffuseSPH:function(e){for(var t=h.a.diffuseSPH.getInternalArray(),i=1/(2*Math.sqrt(Math.PI)),r=-.5*Math.sqrt(3/Math.PI),a=-r,n=r,o=.5*Math.sqrt(15/Math.PI),s=-o,u=.25*Math.sqrt(5/Math.PI),l=s,c=.25*Math.sqrt(15/Math.PI),d=[i,i,i,r,r,r,a,a,a,n,n,n,o,o,o,s,s,s,u,u,u,l,l,l,c,c,c],p=0;p<27;++p)t[p]=e[p]*d[p]},setSpecularTexture:function(e){this._enable&&(this._textureSpecular=new c.a(e,"Specular"),this.updateTextureUnits(),h.a.textureSpecular.setInt(this._textureSpecularUnit),f.a.draw())},setSpecularPBRTexture:function(e,t){if(this._enable){this._textureSpecularPBR=new c.a(e,"SpecularPBR");var i="TextureCubeMap"===e.className();this._textureSpecularPBR.setIsCubemap(i),this._textureSpecularPBR.updateLodRange(t),this.updateTextureUnits(),h.a.textureSpecularPBR.setInt(this._textureSpecularPBRUnit),f.a.draw()}},setIntegrateBRDFTexture:function(e){this._enable&&(this._textureIntegrateBRDF=new c.a(e,"IntegrateBRDF"),this.updateTextureUnits(),h.a.textureIntegrateBRDF.setInt(this._textureIntegrateBRDFUnit),f.a.draw())},updateTextureUnits:function(){this.setTexturesStateSet()},setIsPBR:function(e){this._isPBR=e}}),"osgSketchfab","Environment"),t.a=g},function(e,t,i){"use strict";var r=i(5),a=i(558),n=i(63),o=i(146),s=r.a.osg,u={DEFAULT:1,EARLYZ_OPAQUE:2,EARLYZ_TRANSPARENT:4,OPAQUE_SHADING:8,TRANSPARENT_SHADING:16,REFRACTION:32,EXTRA:64,SHADOWMAP:128};u.ANY_OPAQUE=u.EARLYZ_OPAQUE|u.OPAQUE_SHADING,u.ANY_TRANSPARENT=u.REFRACTION|u.EARLYZ_TRANSPARENT|u.TRANSPARENT_SHADING;var l={depth:void 0,blend:void 0,colorMask:void 0},c={LAST_LEAF:void 0,passTypes:u,forceAttribute:l,currentPass:u.DEFAULT},h=a.a.vrConfig,d={},p=s.RenderLeaf.prototype.drawGeometry,f=s.getOrCreateStateAttributeTypeMemberIndexFromName("SketchfabMaterial"),m=function(e,t,i){if(!i)return t.applyAttribute(n.a.CULL_DISABLE),void p.call(e,t);var r=c.currentPass,a=!1;if(r===u.TRANSPARENT_SHADING){var o=t._attributeArray[f],l=o?o._lastApplied:void 0;if(l){a=!l.getAdditive()&&l.getCullFace()===s.CullFace.DISABLE}}a&&t.applyAttribute(n.a.CULL_FRONT),p.call(e,t),a&&(t.applyAttribute(n.a.CULL_BACK),e._geometry.drawImplementation(t))},g=function(e,t,i){var r=t.uDrawOpaque;if(void 0!==r){var a=c.currentPass,n=o.a.uDrawOpaque,s=n.getInternalArray(),l=a&u.ANY_TRANSPARENT?0:1;s[0]=l;var h=i.getInstanceID();d[h]!==l&&(d[h]=l,n.apply(e,r))}},_=function(e,t,i){i._QVT&&void 0!==t.uQVT&&(o.a.uQVT.setFloat3(i._QVT),o.a.uQVT.apply(e,t.uQVT),o.a.uQVS.setFloat3(i._QVS),o.a.uQVS.apply(e,t.uQVS));var r=i._listQuantUV;if(r)for(var a=0,n=r.length;a<n;++a){var s=r[a],u=s.uniformName,l=t[u];void 0!==l&&(o.a[u].setFloat4(s._QUV),o.a[u].apply(e,l))}},v=function(e){var t=e._attributeArray[f],i=t?t._lastApplied:void 0;if(!i)return!0;var r=c.currentPass;if(!i.getDepthWrite()&&r&u.ANY_OPAQUE)return!1;if(!i.getCastShadows()&&r&u.SHADOWMAP)return!1;if(r!==u.EARLYZ_TRANSPARENT)return!0;var a=i.getAdditive(),o=a?n.a.BLEND_ADDITIVE:n.a.BLEND_SUBSTRACTIVE;return e.applyAttribute(o),!0},b=function(e){for(var t=e.getPrimitiveSetList(),i=0,r=t.length;i<r;++i)if(t[i].getMode()>=s.primitiveSet.TRIANGLES)return!0;return!1};s.RenderLeaf.prototype.drawGeometry=function(e){if(v(e)){l.depth&&e.applyAttribute(l.depth),l.blend&&e.applyAttribute(l.blend),l.colorMask&&e.applyAttribute(l.colorMask);var t=e.getGraphicContext(),i=e.getLastProgramApplied(),r=i.getUniformsCache();g(t,r,i),_(t,r,this._geometry);var a=b(this._geometry),n=c.LAST_LEAF;if(!n.isVR)return void m(this,e,a);var o=h.leftRenderWidth;e.viewport(0,0,o,h.leftRenderHeight),this._projection=n.leftProjection,this._modelView=n.leftModelView,this._view=n.leftView,m(this,e,a),e.viewport(o,0,o,h.rightRenderHeight),this._projection=n.rightProjection,this._modelView=n.rightModelView,this._view=n.rightView,m(this,e,a)}},t.a=c},function(e,t,i){"use strict";var r=i(5),a=i(107),n=i(1236),o=i.n(n),s=i(1237),u=i.n(s),l=i(850),c=i(863),h=i(57),d=i(37),p=i(63),f=r.a.osg,m=function(){f.Node.call(this),this._geometry=f.createTexturedBoxGeometry(0,0,0,5,5,5),this._show="NONE",this._bgEnv=null,this._bgFixed=null,this._texRatio=1,this._canvasWidth=1,this._canvasHidth=1,this.init(),this.hide()};f.createPrototypeNode(m,f.objectInherit(f.Node.prototype,{init:function(){var e=this._geometry,t=e.getOrCreateStateSet();t.setAttributeAndModes(p.a.DEPTH_LEQUAL_BACKGROUND_NO_WRITE,f.StateAttribute.PROTECTED),t.setRenderBinDetails(h.a.BACKGROUND,"RenderBin"),t.setAttributeAndModes(a.a.createShader(o.a,u.a,"environment-background","Environment")),t.setTextureAttributeAndModes(0,l.a.dummyTexture);for(var i in c.a)t.addUniform(c.a[i]);this.addChild(e)},rescale:function(e,t){e&&(this._canvasWidth=e),t&&(this._canvasHeight=t);var i=this._canvasWidth/this._canvasHeight,r=c.a.scale.getInternalArray();i>=this._texRatio?(r[0]=1,r[1]=this._texRatio/i):(r[0]=i/this._texRatio,r[1]=1)},getBackground:function(){return this._bgFixed},getEnvironment:function(){return this._bgEnv},hide:function(){this._show="NONE",this._update()},showColor:function(){this._show="COLOR",this._update()},showEnvironment:function(){this._show="ENV",this._update()},setEnvironment:function(e,t){this._bgEnv=e,void 0!==t&&c.a.size.setFloat(t),this._update()},setExposure:function(e){c.a.backgroundExposure.setFloat(e)},showAmbient:function(){this._show="AMBIENT",this._update()},showBackground:function(){this._show="FIXED",this._update()},setBackground:function(e){this._texRatio=e.getWidth()/e.getHeight(),this._bgFixed=e,this._update()},_update:function(){if(d.a.draw(),"ENV"!==this._show&&"AMBIENT"!==this._show)return void this._geometry.setNodeMask(0);this._geometry.setNodeMask(-1),c.a.ambient.getInternalArray()[0]="AMBIENT"===this._show,this._bgEnv&&"ENV"===this._show&&this._geometry.getOrCreateStateSet().setTextureAttributeAndModes(0,this._bgEnv)}}),"osgSketchfab","Background"),t.a=m},function(e,t){e.exports="attribute vec3 Vertex;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nuniform vec4 uHalton;\nuniform vec2 uGlobalTexSize;\nuniform vec2 uGlobalTexRatio;\n\nvarying vec3 vLocalVertex;\n\nvoid main(void)\n{\n    vLocalVertex = Vertex.rgb;\n\n    mat4 projectionMatrix = uProjectionMatrix;\n    vec2 halt = uGlobalTexRatio.xy * uHalton.xy / uGlobalTexSize.xy;\n    projectionMatrix[2][0] += halt.x;\n    projectionMatrix[2][1] += halt.y;\n\n    gl_Position = (projectionMatrix * (uModelViewMatrix * vec4(Vertex, 1.0))).xyww;\n}\n"},function(e,t){e.exports='varying vec3 vLocalVertex;\n\n// common stuffs\nuniform int uOutputLinear;\nuniform float uRGBMRange;\n\nuniform float uEnvironmentExposure;\nuniform float uBackgroundExposure;\n\nuniform vec3 uDiffuseSPH[9];\nuniform samplerCube uTexture0;\nuniform float uSize;\nuniform int uAmbient;\n\nuniform float uFrameModTaaSS;\n\n#pragma include "functions.glsl"\n#pragma include "sketchfabTextures.glsl"\n#pragma include "rand.glsl"\n\n// sph env\nvec3 evaluateDiffuseSphericalHarmonics(const in vec3 s[9], const in vec3 n) {\n    // https://github.com/cedricpinson/envtools/blob/master/Cubemap.cpp#L523\n    vec3 result = (s[0]+s[1]*n.y+s[2]*n.z+s[3]*n.x+s[4]*n.y*n.x+s[5]*n.y*n.z+s[6]*(3.0*n.z*n.z-1.0)+s[7]*(n.z*n.x)+s[8]*(n.x*n.x-n.y*n.y));\n    return max(result, vec3(0.0));\n}\n\nvoid main(void) {\n\n    vec3 color;\n    if (uAmbient == 1) {\n        vec3 normal = normalize(vLocalVertex + (interleavedGradientNoise(gl_FragCoord.xy, uFrameModTaaSS) - 0.5) * 0.4);\n        color = evaluateDiffuseSphericalHarmonics(uDiffuseSPH, normal);\n    } else {\n        color = textureCubeFixed(uTexture0, normalize(vLocalVertex), uSize);\n    }\n\n    color *= uEnvironmentExposure * uBackgroundExposure;\n\n    if (uOutputLinear == 0 ) color = linearTosRGB(color);\n\n    gl_FragColor = encodeRGBM(color, uRGBMRange);\n}\n'},function(e,t,i){"use strict";var r=i(5),a=i(864),n=r.a.osg,o=function(e,t){this._texture=e,this._channel=t||"Specular",this._isCubemap=!1,this._hash="Specular"===t?"EnvSpec":"SpecularPBR"===t?"EnvSpecPBR":"EnvBRDF"};o.uniforms={},n.createPrototypeStateAttribute(o,n.objectInherit(n.Texture.prototype,{attributeType:"Texture",channelType:["Specular","SpecularPBR","IntegrateBRDF"],getUniformName:function(e){return"uTextureEnvironment"+this.getChannel()+e},getOrCreateUniforms:function(){var e=o.uniforms,t=this.getChannel();if(e[t])return e[t];var i=this._texture;return e[t]={size:n.Uniform.createFloat2([i.getWidth(),i.getHeight()],this.getUniformName("TextureSize"))},e[t]},setIsCubemap:function(e){this._isCubemap=e},getIsCubemap:function(){return this._isCubemap},getUniforms:function(){return a.a},getTexture:function(){return this._texture},getChannel:function(){return this._channel},cloneType:function(){return new o(new n.Texture)},getHash:function(){return this._hash},updateLodRange:function(e){var t=this.getOrCreateUniforms(),i=Math.log(this._texture.getWidth())/Math.LN2,r=i-Math.log(e)/Math.LN2;if(t.lodRange){var a=t.lodRange.getInternalArray();a[0]=i,a[1]=r}else t.lodRange=n.Uniform.createFloat2([i,r],this.getUniformName("LodRange"))},apply:function(e,t){var i=this._texture;void 0!==i&&i.apply(e);var r=this.getOrCreateUniforms(t),a=r.size.getInternalArray();a[0]=i.getWidth(),a[1]=i.getHeight()}}),"osgSketchfab","TextureEnvironment"),t.a=o},function(e,t,i){"use strict";var r=i(62),a=i(1240),n=i(1241),o={FeatureName:"background",ModelType:a.a,ViewListType:[n.a]};t.a=r.a.create(o)},function(e,t,i){"use strict";var r=i(5),a=i(34),n=i(120),o=i(16),s=i(70),u=i(59),l=r.a.osg,c=n.a.extend({_trashbin:[],getModelOptionPath:function(){return"background"},defaults:function(){return{webVR:!1}},init:function(e){this.backgroundCollection=u.default.instance.getBackgroundCollection(),this._defaultBackground=this.get("uid"),this.set("enable",Object(s.a)()?"ambient":"fixed");var t=e.getModel().get("options").background;t&&this.setJSON(t),Object(o.a)().transparent&&this.set("enable","none");var i=e.getViewer();Object(s.a)()&&a.a.getPolygon().then(function(){"Tilt Brush"===i.getRootUserData().authoringTool&&(this.set("enable","color"),this.set("color",l.vec3.create()))}.bind(this))},getName:function(){return"Background"},setBackground:function(e){return this.setBackgroundUID(e.uid)},setBackgroundUID:function(e){e&&this.set("uid",e)},getBackground:function(){if(this.backgroundCollection){var e=this.get("uid"),t=this.backgroundCollection.find(function(t){return t.get("uid")===e||t.get("id")===e});if(t)return t;this.set("uid",this._defaultBackground)}},resetToDefaultBackground:function(){this.set("uid",this._defaultBackground)},getEnableType:function(){var e=this.get("enable");return"fixed"!==e&&"none"!==e||!this.get("webVR")||Object(o.a)().vrAr?e:"ambient"},getColor:function(){return this.get("color")},validate:function(e,t){var i=n.a.prototype.validate.call(this,e,t),r=this.get("uid");if(r!==this._defaultBackground){this.getBackground()||console.warn("Couldn't find background "+r)}return i},editorGetJSON:function(){return this.getJSON()},editorSetJSON:function(e){return this.setJSON(e,{validate:!0})}});t.a=c},function(e,t,i){"use strict";var r=i(83),a=i(5),n=i(34),o=i(8),s=i(59),u=i(607),l=i(37),c=a.a.osg,h=o.a.extend({initialize:function(){o.a.prototype.initialize.apply(this,arguments),this.model.bind("change:enable",this.onEnableChanged,this),this.model.bind("change:webVR",this.onEnableChanged,this),this.model.bind("change:uid",this.onBackgroundChanged,this),this.model.bind("change",l.a.draw),this._viewer=this.options.context.getViewer();var e=this.options.context.getFeatures().environment;e&&(this._resourceDefer=new r.a,this.options.context.getScene().addResourcePromise(this._resourceDefer.promise),this._modelEnvironment=e.getModel(),this._nodeBackground=e.getNode().getBackground(),this._nodeBackground.addUpdateCallback(this),n.a.getMaterial().then(this.onEnableChanged.bind(this)))},getResourceManager:function(){return this._resourceManager||s.default.instance},onBackgroundChanged:function(){var e=this.model.getBackground();if(e){var t=this.options.context.getViewer(),i=Math.max(Object(u.a)(t.getWidth()),Object(u.a)(t.getHeight())),r=e.findImageNearestToResolution(i,i),a=r.url;return this.getResources(a)}},getResources:function(e){for(var t={minFilter:c.Texture.LINEAR,magFilter:c.Texture.LINEAR,transferToGPU:!0,convertNPOT:!1,backgroundUid:this.model.get("uid"),internalFormat:c.Texture.RGB},i=this.getResourceManager()._resourceLoader._processing,r=0;r<i.length;++r){var a=i[r],o=a._options;o&&o.backgroundUid&&o.backgroundUid!==this.model.get("uid")&&a.abort()}var s=this.getResourceManager().getOrCreateTexture(e,t);s.promise.then(function(e){this._nodeBackground.setBackground(e),this._nodeBackground.rescale(this._viewWidth,this._viewHeight),this.model.trigger("backgroundUpdated",e),"fixed"===this.model.getEnableType()&&this._nodeBackground.showBackground()}.bind(this));var u=this.options.context.getViewer();return this._resourceDefer?(s.promise.finally(this._resourceDefer.resolve.bind(this._resourceDefer)),this._resourceDefer=void 0):n.a.getHighResLoaded().then(u.setFakeSecondaryProgress.bind(u,s.promise,"background")),s.promise},onEnableChanged:function(){var e=this.model.getEnableType();"color"===e?this._nodeBackground.showColor():"fixed"===e?this._nodeBackground.getBackground()?this._nodeBackground.showBackground():void 0!==this.model.get("uid")&&this.onBackgroundChanged():"environment"===e?(this._modelEnvironment.trigger("updateBackground"),this._nodeBackground.showEnvironment()):"ambient"===e?(this._modelEnvironment.trigger("updateBackground"),this._nodeBackground.showAmbient()):"none"===e&&this._nodeBackground.hide(),this._resourceDefer&&(this._resourceDefer.resolve(),this._resourceDefer=void 0)},requireBiggerTexture:function(){var e=this.options.context.getViewer(),t=Math.max(Object(u.a)(e.getWidth()),Object(u.a)(e.getHeight())),i=this.model.getBackground();if(i){var r=i.findImageNearestUpToResolution(t,t);if(void 0!==this._nodeBackground&&!this._nodeBackground.getBackground())return!1;if(r.width<this._nodeBackground.getBackground().getWidth())return!1}return!0},update:function(){if("fixed"!==this.model.getEnableType())return!0;var e=this._viewer.getCamera().getViewport(),t=e.width(),i=e.height();return this._viewWidth===t&&this._viewHeight===i||(this._viewWidth=t,this._viewHeight=i,!0===this.requireBiggerTexture()&&this.onBackgroundChanged(),this._nodeBackground.rescale(t,i)),!0}});t.a=h},function(e,t,i){"use strict";var r=i(62),a=i(1243),n=i(1244),o={FeatureName:"hotspot",ModelType:a.a,ViewListType:[n.a]},s=r.a.create(o);s.prototype.getNode=function(){return this._views[0].getNodeHotspot()},s.prototype.getWidgetNode=function(){return this._views[0].getNodeProxy()},t.a=s},function(e,t,i){"use strict";var r=i(120),a=i(5),n=i(0),o=(i.n(n),i(611)),s=i(664),u=i(59),l=i(16),c=i(612),h=i(458),d=i(119),p=a.a.osg,f=a.a.osgAnimation,m=function(e){var t=p.vec3.create(),i=p.vec3.create();e.getFeatures().camera.getModel().getCameraPosition(t,i),this.set("eye",t),this.set("target",i);var r=e.getScreenShot(128,128),a=r.toDataURL("image/jpeg");this.set("uidImage",void 0),this.set("imageFile",Object(o.a)(a)),this.set("preview",a)},g=r.a.extend({getModelOptionPath:function(){return"hotspot"},defaults:function(){return{webVR:!1,currentHotspotIndex:-1}},getName:function(){return"Hotspot"},getResourceManager:function(){return this._resourceManager||u.default.instance},init:function(e){var t=this.getResourceManager().getHotspotCollection();this.set("hotspots",t),t.on("remove",this.onRemove,this),this._viewer=e.getViewer(),this.hotspotsToBeDeleted=[];var i=e.getModel().get("options"),r=i.hotspot;this.setJSON(r)},onRemove:function(e){e.isNew()||this.hotspotsToBeDeleted.push(e)},setUpdateCallback:function(e){this.callback=e},updateHotspotHit:function(e,t){d.a.getScenePositionFromHit(t,e.get("position"));var i=t._nodePath[t._nodePath.length-1],r=void 0!==i._uniqueID?i._uniqueID:-1,a=i instanceof f.RigGeometry||i instanceof f.MorphGeometry,n=a||Object(c.a)(t._nodePath);e.set("geometryUid",n?r:-1);var o=e.get("indices");o[0]=a?t._i1:-1,o[1]=a?t._i2:-1,o[2]=a?t._i3:-1;var s=e.get("barycentricWeights");s[0]=a?t._r1:0,s[1]=a?t._r2:0,s[2]=a?t._r3:0;var u=e.get("localPosition");u[0]=n?t._localIntersectionPoint[0]:0,u[1]=n?t._localIntersectionPoint[1]:0,u[2]=n?t._localIntersectionPoint[2]:0},createHotspot:function(e){var t=this.get("hotspots"),i=new s.a;return i.set("uid","tmp_"+Object(n.uniqueId)()),Object(h.b)(i,e),t.add(i,{sort:!1}),i.set("order",t.indexOf(i)),i.set("refreshAction",m.bind(i,this._viewer)),i.get("refreshAction")(),t.trigger("select",i),i},setJSON:function(e,t){if(t&&t.validate){var i=this.validate(e);if(i.length)return i.join("\n")}void 0!==Object(l.a)().annotationsVisible?this.set("visible",Object(l.a)().annotationsVisible):void 0!==e.visible?this.set("visible",e.visible):this.set("visible",!0);var r=e&&e.hotspots&&Object(n.keyBy)(e.hotspots,"uid"),a=this.get("hotspots");return a.each(function(e){e.collection=null;var t=e.get("images")[0];t&&(e.set("uidImage",t.uid),e.set("imageFile",Object(o.a)(t.url)),e.set("preview",t.url)),e.set("refreshAction",m.bind(e,this._viewer));var i=r&&r[e.get("uid")];i&&(e.set("geometryUid",i.geometryUid),e.set("indices",i.indices),e.set("barycentricWeights",i.barycentricWeights),e.set("localPosition",i.localPosition)),a.add(e)}.bind(this)),[]},getJSON:function(){var e=[];return this.get("hotspots").each(function(t){e.push({uid:t.get("uid"),geometryUid:t.get("geometryUid"),indices:t.get("indices"),barycentricWeights:t.get("barycentricWeights"),localPosition:t.get("localPosition")})}),{hotspots:e,visible:this.get("visible")}}});t.a=g},function(e,t,i){"use strict";var r=i(5),a=i(8),n=i(34),o=i(59),s=i(107),u=i(609),l=i(43),c=i(37),h=i(57),d=i(47),p=i(11),f=i(17),m=i(6),g=i(251),_=i(865),v=i(25),b=i(1250),y=i.n(b),x=i(1251),S=i.n(x),M=i(1252),w=i.n(M),T=i(1253),C=i.n(T),E=i(445),L=i(119),P=i(458),A=i(63),D=i(145),O=r.a.osg,k=r.a.InputGroups,R=a.a.extend({initialize:function(){a.a.prototype.initialize.apply(this,arguments),this._nodeHotspot=new O.Node,this._nodeHotspot.setName("Feature - Hotspot"),this._hotspots=this.model.get("hotspots");var e=this._hotspots.length>0;g.a.setHotspot(e),this._hotspots.on("sort",c.a.draw),this._hotspots.on("remove",this.onHotspotRemoved,this),this._hotspots.on("add",this.onHotspotAdded,this),this._hotspots.on("select",this.onHotspotSelected,this),this._hotspots.on("inserted",this.onHotspotInserted,this),this.model.on("change:visible",this.onVisible,this),this._lastSuccessHit=void 0;var t=this.options.context;this._viewer=t.getViewer(),this._viewerOSGJS=this._viewer.getViewerOSGJS(),this._manipulator=this._viewerOSGJS.getManipulator(),this._inputManager=this._viewerOSGJS.getInputManager(),this._idDragging=-1,this._dragHotspotStarted=!1,this._lastHoveredIndex=-1,this._dragCamera=!1,this._lastCoordNotDragging=O.vec2.create(),this._proxyHotspot=new O.Node,this._proxyHotspot.setName("Hotspot - Proxy"),this._proxyHotspot.setNodeMask(0),this._nodeHotspot.addChild(this._proxyHotspot),this.initHotspotProxy(),this._hotspots.each(this.onHotspotAdded.bind(this)),(e||Object(d.a)())&&n.a.getModelDisplayed().then(this.hotspotReady.bind(this))},getNodeHotspot:function(){return this._nodeHotspot},getNodeProxy:function(){return this._proxyHotspot},getScreenThresholdHover:function(){return 20*E.a.getPixelRatio()[0]},onVisible:function(){this._proxyHotspot.setNodeMask(this.model.get("visible")?l.a.NO_SHADOW:0),c.a.draw()},hotspotReady:function(){D.a.initHotspot(this),this.onVisible();var e=this._viewer.getFeaturesManager().getTextureDepth();e&&this._proxyHotspot.getOrCreateStateSet().setTextureAttributeAndModes(0,e),c.a.draw()},onHotspotInserted:function(){for(var e=0;e<this._proxyHotspot.children.length;e++)this._proxyHotspot.children[e].initCard()},initHotspotProxy:function(){this._proxyHotspot.setCullCallback(this);var e=this._proxyHotspot.getOrCreateStateSet();e.setRenderBinDetails(h.a.HOTSPOT,"RenderBin"),e.setAttributeAndModes(A.a.DEPTH_DISABLE),e.setAttributeAndModes(A.a.BLEND_SUBSTRACTIVE);var t=o.default.instance.getOrCreateTexture(u.a.iconHotspot,{internalFormat:O.Texture.RGBA});e.addUniform(O.Uniform.createInt(0,"uTextureDepth")),e.addUniform(O.Uniform.createInt(1,"uTextureHotspot")),e.setTextureAttributeAndModes(1,t.texture),e.setAttributeAndModes(s.a.createShader(y.a,S.a,"hotspot","Hotspot")),e.setAttributeAndModes(A.a.CULL_DISABLE),_.a.initLineShader(s.a.createShader(w.a,C.a,"hotspotline","VRHotspotLine"))},createHotspot:function(e){if("annotations"===this._viewer.getOptions().widgetAPI.getTabbedWidget().get()){var t=this.options.context.getModel().get("user").account,i=f.a.maxHotspotsPerModel[t];if(this._hotspots.length>=i)return this.model.trigger("hotspot-error",new v.c(void 0,"hotspot",i,m.a.me().toJSON().account));if(this._viewer.getFeaturesManager()){var r=L.a.pickNearestSurface(e);r&&(this.model.createHotspot(r),p.a.annotationEditorCreateButtonClicked(this.options.context.getModel().get("uid")))}}},getColorHotspot:function(e){return this._proxyHotspot.getChildren()[e].getColor()},setHotspotHovered:function(e,t){t>=0&&O.vec3.copy(this.getColorHotspot(t),e?_.a.COLOR_HOVERED:_.a.COLOR_NORMAL)},updateCameraDragged:function(){var e=O.vec2.create();return function(t){this._dragCamera=this._dragCamera||O.vec2.dist(O.vec2.set(e,t.glX,t.glX),this._lastCoordNotDragging)>5}}(),hoverHotspot:function(e){var t=this.pickHotspot(e);this.setHotspotHovered(0,this._lastHoveredIndex),this.setHotspotHovered(1,t),-1===this._idDragging&&O.vec2.set(this._lastCoordNotDragging,e.glX,e.glY),this._lastHoveredIndex!==t&&(this._viewer.trigger("annotationMouseLeave",this._lastHoveredIndex),this._viewer.trigger("annotationMouseEnter",t),this._lastHoveredIndex=t,c.a.draw())},selectHotspot:function(e){var t=this.pickHotspot(e);this._hotspots.trigger("select",this._hotspots.at(t)),this._viewer.trigger("annotationSelect",t)},startDrag:function(e){this._idDragging=this.pickHotspot(e),this._dragCamera=!1,O.vec2.set(this._lastCoordNotDragging,e.glX,e.glY),this._idDragging>=0&&this._inputManager.setEnable(k.MANIPULATORS,!1)},cancelDrag:function(){this._dragCamera=!0,this.stopDrag()},stopDrag:function(){if(this._dragCamera)this._idDragging>=0&&(this._lastSuccessHit&&this.model.updateHotspotHit(this._hotspots.at(this._idDragging),this._lastSuccessHit),O.vec3.copy(this.getColorHotspot(this._idDragging),_.a.COLOR_NORMAL),c.a.draw(),p.a.annotationEditorPositionMoved(this.options.context.getModel().get("uid")));else if(this._hotspots.trigger("select",this._hotspots.at(this._idDragging)),this._idDragging>-1){var e=this.options.context.getModel().get("uid")+"_"+(this._idDragging+1);p.a.modelViewerAnnotationClicked(e)}this._idDragging>=0&&this._inputManager.setEnable(k.MANIPULATORS,!0),this._dragHotspotStarted=!1,this._dragCamera=!1,this._idDragging=-1},dragHotspot:function(){var e=O.vec3.create();return function(t){if(!(this._idDragging<0)&&(this.updateCameraDragged(t),this._dragHotspotStarted=!0,L.a.isInitialized())){var i=L.a.pickNearestSurface(t),r=this._hotspots.at(this._idDragging);O.vec3.copy(this.getColorHotspot(this._idDragging),i?_.a.COLOR_DRAG_OK:_.a.COLOR_DRAG_FAIL),i?(this._lastSuccessHit=i,this.model.updateHotspotHit(r,i)):(O.vec2.set(e,t.glX,t.glY),e[2]=L.a.getScreenPositionFromScenePoint(r.get("position"),O.vec3.create())[2],L.a.getScenePositionFromScreenPoint(e,r.get("position")),r.set("geometryUid",-1)),c.a.draw()}}}(),onHotspotSelected:function(){var e=O.vec3.create(),t=O.vec3.create();return function(i){if(i){var r=this._viewer.getFeaturesManager();r&&(O.vec3.copy(e,i.get("eye")),O.vec3.copy(t,i.get("target")),r.applyAutospinToCamera(e,t),r.focusOnTargetAndEye(t,e,1.5),c.a.draw())}}}(),onHotspotAdded:function(e){var t=new _.a(this._hotspots.indexOf(e),this._viewer);t.setCardVisibilityListener(this._onCardVisibilityChange.bind(this)),this._proxyHotspot.addChild(t),c.a.draw()},_onCardVisibilityChange:function(e,t){t?this._viewer.trigger("annotationFocus",e.getIndex()):this._viewer.trigger("annotationBlur",e.getIndex())},onHotspotRemoved:function(){this.setHotspotHovered(0,this._lastHoveredIndex),this._lastHoveredIndex=-1;var e=this._proxyHotspot.getChildren();this._proxyHotspot.removeChild(e[e.length-1]),c.a.draw()},screenDistanceToHotspot:function(){var e=O.vec3.create();return function(t,i){return L.a.getScreenPositionFromWorldPoint(this._hotspots.at(t).get("lastComputedWorldPosition"),e),O.vec2.dist(e,i)}}(),pickHotspot:function(){var e=O.vec2.create();return function(t){if(!this._viewer.getFeaturesManager()||!this.model.get("visible"))return-1;O.vec2.set(e,t.glX,t.glY);for(var i=1/0,r=this._hotspots.length,a=-1,n=this.getScreenThresholdHover(),o=0;o<r;++o){var s=this.screenDistanceToHotspot(o,e);s<n&&s<i&&(i=s,a=o)}return a}}(),cull:function(){var e=O.mat4.create(),t=O.quat.create(),i=O.vec3.create();return function(){this.model.callback&&this.model.callback();var r=this._viewer.getFeaturesManager();if(this._lastHoveredIndex>=0&&-1===this._idDragging){this.screenDistanceToHotspot(this._lastHoveredIndex,this._lastCoordNotDragging)>=this.getScreenThresholdHover()&&this.setHotspotHovered(0,this._lastHoveredIndex)}var a=this._hotspots,n=this._proxyHotspot.getChildren(),o=n.length,s=this._viewer.getFeatures(),u=s.webVR.getModel().get("worldFactor"),l=this.model.get("webVR");this._manipulator.getEyePosition(i);var c=r.getIconScaleFov();if(!l){var h=this._viewer.getCamera();O.mat4.invert(e,h.getViewMatrix()),O.mat4.fromQuat(e,O.mat4.getRotation(t,e))}for(var d=0;d<o;++d){var p=n[d],f=a.at(d);Object(P.d)(f);var m=f.get("lastComputedWorldPosition"),g=O.vec3.dist(m,i)/c;l?p.updatePositionVR(f,i,g,u):p.updatePosition(f,i,g,e)}return!0}}()});t.a=R},function(e,t,i){"use strict";var r=i(559),a=i(43),n=i(5),o=n.a.osg,s=function(e,t){r.a.call(this,e,t),this._round=.005};s.prototype=o.objectInherit(r.a.prototype,{initialize:function(e,t){r.a.prototype.initialize.call(this,e,t,function(){this.setClickAction("nextPage",function(){this.setPage(this._currentPage+1)}.bind(this)),this.setClickAction("prevPage",function(){this.setPage(this._currentPage-1)}.bind(this))}.bind(this)),this._nbColumns=t.column,this._currentPage=0},setHinted:function(e){this._hinted=e,this.setNodeMask(e?a.a.NO_PICK:0),this._uAlpha&&(this._uAlpha[0]=.1)},isHinted:function(){return this._hinted},getNbPage:function(){return this._nbColumns},getCurrentPage:function(){return this._currentPage},setPage:function(e){if(this._currentPage!==e){var t=this.getNbPage(),i=Math.min(t-1,Math.max(0,e));this.setPageForCell("column"+i,"default"),this._currentPage=i}}}),t.a=s},function(e,t){e.exports="attribute vec2 TexCoord0;\nattribute vec3 Vertex;\n\nvarying vec2 vTexCoord0;\n\n// uniform mat4 uModelMatrix;\n// uniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat4 uModelViewMatrix;\n\nvoid main(void) {\n  vTexCoord0 = TexCoord0;\n  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex.xyz, 1.0);\n}\n"},function(e,t){e.exports='varying vec2 vTexCoord0;\n\nuniform sampler2D uTexturePanel;\nuniform vec4 uHoveredArea;\nuniform float uHoveredOpaque;\nuniform float uAlpha;\nuniform float uRatio;\nuniform float uRound;\nuniform float uVeilFactor;\n\n#pragma include "functions.glsl"\n\n// signed distance to a 2D rounded box\nfloat sdRoundBox( const in vec2 p, const in vec2 b, const in float r ) {\n    vec2 q = abs(p) - b;\n    vec2 m = vec2( min(q.x,q.y), max(q.x,q.y) );\n    float d = (m.x > 0.0) ? length(q) : m.y;\n    return d - r;\n}\n\nvoid main(void) {\n  vec4 color = texture2D(uTexturePanel, vTexCoord0);\n\n  float lerpValue = step(0.0, -vTexCoord0.x);\n  lerpValue += step(1.0, vTexCoord0.x);\n\n  float round = uRound;\n  float left = uHoveredArea.x + round;\n  float right = uHoveredArea.y - round;\n  float top = uHoveredArea.z - round;\n  float bottom = uHoveredArea.w + round;\n\n  vec2 halfSize = abs(vec2(left - right, top - bottom) * 0.5);\n  vec2 center = vec2(halfSize.x + left, halfSize.y + bottom);\n\n  lerpValue += max(0.0, -sign(sdRoundBox( vTexCoord0 - center, halfSize, round)));\n\n  color.rgba = mix(color.rgba, color.rgba + vec4(0.109, 0.664, 0.848, step(0.1, uHoveredOpaque)), lerpValue);\n\n  color.a *= uAlpha;\n  color.rgb *= (color.a * uVeilFactor);\n\n  gl_FragColor = color;\n}\n'},function(e,t,i){e.exports=i(1249)},function(e,t,i){!function(){var i,r=Array.prototype.forEach,a=Object.prototype.hasOwnProperty,n=Array.prototype.slice,o=0,s=function(){return{keys:Object.keys||function(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("keys() called on a non-object");var t,i=[];for(t in e)e.hasOwnProperty(t)&&(i[i.length]=t);return i},uniqueId:function(e){var t=++o+"";return e?e+t:t},has:function(e,t){return a.call(e,t)},each:function(e,t,i){if(null!=e)if(r&&e.forEach===r)e.forEach(t,i);else if(e.length===+e.length)for(var a=0,n=e.length;a<n;a++)t.call(i,e[a],a,e);else for(var o in e)this.has(e,o)&&t.call(i,e[o],o,e)},once:function(e){var t,i=!1;return function(){return i?t:(i=!0,t=e.apply(this,arguments),e=null,t)}}}}();i={on:function(e,t,i){return l(this,"on",e,[t,i])&&t?(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:i,ctx:i||this}),this):this},once:function(e,t,i){if(!l(this,"once",e,[t,i])||!t)return this;var r=this,a=s.once(function(){r.off(e,a),t.apply(this,arguments)});return a._callback=t,this.on(e,a,i)},off:function(e,t,i){var r,a,n,o,u,c,h,d;if(!this._events||!l(this,"off",e,[t,i]))return this;if(!e&&!t&&!i)return this._events={},this;for(o=e?[e]:s.keys(this._events),u=0,c=o.length;u<c;u++)if(e=o[u],n=this._events[e]){if(this._events[e]=r=[],t||i)for(h=0,d=n.length;h<d;h++)a=n[h],(t&&t!==a.callback&&t!==a.callback._callback||i&&i!==a.context)&&r.push(a);r.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=n.call(arguments,1);if(!l(this,"trigger",e,t))return this;var i=this._events[e],r=this._events.all;return i&&c(i,t),r&&c(r,arguments),this},stopListening:function(e,t,i){var r=this._listeners;if(!r)return this;var a=!t&&!i;"object"==typeof t&&(i=this),e&&((r={})[e._listenerId]=e);for(var n in r)r[n].off(t,i,this),a&&delete this._listeners[n];return this}};var u=/\s+/,l=function(e,t,i,r){if(!i)return!0;if("object"==typeof i){for(var a in i)e[t].apply(e,[a,i[a]].concat(r));return!1}if(u.test(i)){for(var n=i.split(u),o=0,s=n.length;o<s;o++)e[t].apply(e,[n[o]].concat(r));return!1}return!0},c=function(e,t){var i,r=-1,a=e.length,n=t[0],o=t[1],s=t[2];switch(t.length){case 0:for(;++r<a;)(i=e[r]).callback.call(i.ctx);return;case 1:for(;++r<a;)(i=e[r]).callback.call(i.ctx,n);return;case 2:for(;++r<a;)(i=e[r]).callback.call(i.ctx,n,o);return;case 3:for(;++r<a;)(i=e[r]).callback.call(i.ctx,n,o,s);return;default:for(;++r<a;)(i=e[r]).callback.apply(i.ctx,t)}},h={listenTo:"on",listenToOnce:"once"};s.each(h,function(e,t){i[t]=function(t,i,r){return(this._listeners||(this._listeners={}))[t._listenerId||(t._listenerId=s.uniqueId("l"))]=t,"object"==typeof i&&(r=this),t[e](i,r,this),this}}),i.bind=i.on,i.unbind=i.off,i.mixin=function(e){var t=["on","once","off","trigger","stopListening","listenTo","listenToOnce","bind","unbind"];return s.each(t,function(t){e[t]=this[t]},this),e},void 0!==e&&e.exports&&(t=e.exports=i),t.BackboneEvents=i}()},function(e,t){e.exports="attribute vec2 TexCoord0;\nattribute vec3 Vertex;\n\nvarying vec2 vTexCoord0;\nvarying vec4 vViewPos;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nuniform float uHotspotIndex;\n\n// icon size 48 pixel width and 2 pixel padding between them\nconst vec2 ICON_SIZE = 48.0 / vec2(512.0, -256.0);\nconst vec2 ICON_AND_PADDING = ICON_SIZE + 2.0 / vec2(512.0, -256.0);\n\nvoid main(void) {\n  vec2 offset = vec2(mod(uHotspotIndex, 10.0), floor(uHotspotIndex / 10.0));\n  vTexCoord0 = vec2(TexCoord0.x, 1.0 - TexCoord0.y) * ICON_SIZE + offset * ICON_AND_PADDING;\n\n  vViewPos = uModelViewMatrix * vec4(Vertex.xyz, 1.0);\n  gl_Position = uProjectionMatrix * vViewPos;\n}\n"},function(e,t){e.exports='#pragma include "sketchfabFunctions.glsl"\n\nvarying vec2 vTexCoord0;\nvarying vec4 vViewPos;\n\nuniform sampler2D uTextureHotspot;\nuniform vec3 uColor;\n\nuniform sampler2D uTextureDepth;\nuniform vec2 uGlobalTexSize;\nuniform vec2 uGlobalTexRatio;\nuniform vec2 uNearFar;\n\nconst float BIAS_VISIBILITY = 0.05;\n\nvoid main(void) {\n  float distDepth = distanceToDepth(uTextureDepth, uGlobalTexRatio * gl_FragCoord.xy / uGlobalTexSize, vViewPos, uNearFar);\n  float alpha = distDepth < BIAS_VISIBILITY ? 1.0 : 0.1;\n\n  gl_FragColor = vec4(uColor, 1.0) * texture2D(uTextureHotspot, vTexCoord0);\n  gl_FragColor.a *= alpha;\n\n  gl_FragColor.rgb *= gl_FragColor.a;\n}\n'},function(e,t){e.exports="attribute vec3 Vertex;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xyz, 1.0));\n}\n"},function(e,t){e.exports='uniform vec4 uLineColor;\n\n#pragma include "functions.glsl"\n\nvoid main(void) {\n    vec4 color = sRGBToLinear(uLineColor);\n    color.rgb *= color.a;\n    gl_FragColor = linearTosRGB(color);\n}\n'},function(e,t,i){"use strict";var r=i(62),a=i(1255),n=i(1258),o={FeatureName:"lighting",ModelType:a.a,ViewListType:[n.a]},s=r.a.create(o);s.prototype.getNode=function(){return this._views[0].getNode()},s.prototype.getNodeShadow=function(){return this._views[0].getNodeShadow()},s.prototype.prepareForScreenShot=function(){this._views[0].setIsScreenshot(!0)},s.prototype.resetAfterScreenShot=function(){this._views[0].setIsScreenshot(!1)},t.a=s},function(e,t,i){"use strict";var r=i(5),a=i(34),n=i(120),o=i(1256),s=i(1257),u=i(70),l=i(79),c=r.a.osg,h=n.a.extend({defaults:function(){return{select:-1,lights:[new o.a(0),new o.a(1),new o.a(2)],webVR:!1,forceShadowRedraw:!1}},getName:function(){return"Lighting"},getDefaultFalloff:function(){var e=this._root.getMinimumBound().radius();return e<0?0:3.90625/(e*e)},setPreset:function(e){s.a[e]||console.error("Preset does not exist: "+e),this.setJSON({enable:this.get("enable"),lights:s.a[e]()},{resetFalloff:!0})},init:function(e){this._viewer=e.getViewer(),this._root=this._viewer.getRootModel(),this.set("enable",!Object(u.a)());var t=e.getModel().get("options"),i=t.lighting;i&&i.lights&&(this._ignoreSceneLights=!0,this.setJSON(i)),a.a.getModelDisplayed().then(this.initDepthTexture.bind(this))},initDepthTexture:function(){for(var e=this._viewer.getFeaturesManager().getTextureDepth(),t=this.get("lights"),i=0;i<3;++i)t[i].setDepthTexture(e)},dirtyScene:function(){l.a.getModelBoxWithoutDisplacement()?this.recomputeLightsPositionAndFalloff():l.a.getBoxReady().then(this.recomputeLightsPositionAndFalloff.bind(this))},recomputeLightsPositionAndFalloff:function(){for(var e=l.a.getModelBoxWithoutDisplacement(),t=this.get("lights"),i=.8*e.radius(),r=this.getDefaultFalloff(),a=e.center(c.vec3.create()),n=c.vec3.fromValues(0,0,i),o=0;o<3;++o){var s=t[o],u=s.get("matrix");s.get("falloff")<0&&(s.set("falloff",r),u[12]=a[0],u[13]=a[1],u[14]=a[2],c.mat4.translate(u,u,n)),s.dirty()}},initLights:function(e){var t=0,i=this.get("lights");for(t=0;t<3;++t)i[t].setScene(this._root);if(this._ignoreSceneLights)return this.trigger("uiReady");var r=e.length;if(Object(u.a)()){if(0===r)return this.setPreset("ThreePointLight"),this.trigger("uiReady");this.set("enable",!0)}else{for(t=0;t<3;++t)i[t].set("castShadows",!1);if(0===r)return this.setPreset("TwoHeadLightV1"),this.trigger("uiReady");if(r>3)return this.setPreset("ThreePointLightV2"),this.trigger("uiReady")}e.sort(function(e,t){return c.vec3.len(e.getDiffuse())-c.vec3.len(t.getDiffuse())});var a=c.vec3.create();for(t=0;t<3;++t){var n=e[t],o=i[t];if(n){var s=n.getLightType();o.set("type",s),o.set("attachedToCamera",!1),"SPOT"===s&&(o.set("angle",Math.min(90,n.getSpotCutoff())),o.set("hardness",n.getSpotBlend()));var l=n.getDiffuse(),h=Math.max(l[0],l[1],l[2],1);o.set("intensity",h),c.vec3.scale(o.get("color"),l,1/h);var d=n.getGround(),p=Math.max(d[0],d[1],d[2],1);o.set("intensityGround",p),c.vec3.scale(o.get("ground"),d,1/p),o.set("falloff",n.getQuadraticAttenuation());var f=o.get("matrix");c.mat4.getScale(a,n._worldMatrix),c.mat4.fromScaling(f,a),c.mat4.invert(f,f),c.mat4.multiply(f,n._worldMatrix,f)}else o.set("falloff",this.getDefaultFalloff()),o.set("type","NONE")}return this.trigger("uiReady")},getJSON:function(){var e={},t=this.get("lights");return e.enable=this.get("enable"),e.lights=[t[0].getJSON(),t[1].getJSON(),t[2].getJSON()],e},setJSON:function(e,t){var i=t||{};i.ignore=["lights"],n.a.prototype.setJSON.call(this,e,i);var r=this.get("lights");void 0!==e.enable&&this.set("enable",e.enable);for(var a={validate:i.validate},o=0;o<3;++o){var s=e.lights[o];if(s){var u=r[o];u.setUpdateMatrixOnToggleCamera(!1),u.setJSON(s,a),u.setUpdateMatrixOnToggleCamera(!0),t&&t.resetFalloff&&u.set("falloff",-1),u.get("falloff")<0&&this.dirtyScene()}}},editorGetJSON:function(){return this.getJSON()},editorSetJSON:function(e){return this.setJSON(e,{validate:!0,resetFalloff:!0})}});t.a=h},function(e,t,i){"use strict";var r=i(120),a=i(5),n=i(706),o=i(860),s=i(43),u=i(93),l=i(37),c=i(187),h=i(16),d=a.a.osg,p=a.a.osgUtil,f=r.a.extend({getModelOptionPath:function(){return"#.definitions.light"},defaults:function(){return{matrixPrev:d.mat4.create(),shadowNormalBias:Object(h.a)().shadowNormalOffset?.075:void 0}},initialize:function(){r.a.prototype.initialize.apply(this,arguments),u.a.bind("change:mask",this.dirty,this),this.createNode(arguments[0])},createNode:function(e){this._mtLight=new d.MatrixTransform,this._mtLight.setName("Lighting - Mt");var t=Object(n.b)("Lighting",e);this._shadowMap=t.shadowMap,this._light=t.light,this._lightSource=t.lightSource,this._node=t.node,this._enableShadow=t.enableShadow,this._mtQuad=new d.MatrixTransform,this._mtQuad.setName("Lighting - TransformIcon "+e),this._quadGeom=o.a.createIconGeometry(),this._quadGeom.setName("Lighting -  GeomIcon "+e),this._pointGeom=new o.a.createPointGeometry,this._dirGeom=new o.a.createDirectionalGeometry(5),this._spotGeom=new o.a.createSpotGeometry(5),this._hemiGeom=new o.a.createHemiGeometry(4),this._hemiGeom.getOrCreateStateSet().addUniform(d.Uniform.createFloat4(d.vec4.fromValues(0,0,1,1),"uGround")),this._scale=new d.MatrixTransform,this._scale.setName("Lighting - ScaleIcon "+e),this._mtEditLight=new d.MatrixTransform,this._mtEditLight.getOrCreateStateSet().setTextureAttributeAndModes(0,c.a.dummyTexture),this._mtEditLight.setName("Lighting - MtEditLight "+e);var i=this._mtEditLight.getOrCreateStateSet();i.addUniform(d.Uniform.createFloat4(d.vec4.fromValues(1,1,1,1),"uColor")),i.addUniform(d.Uniform.createInt(1,"uEnable")),i.addUniform(d.Uniform.createInt(0,"uAttachedToCamera")),i.addUniform(d.Uniform.createInt(0,"uTextureDepth")),this._node.addChild(this._mtLight),this._node.addChild(this._mtEditLight),this._mtLight.addChild(this._lightSource),this._mtEditLight.addChild(this._scale),this._mtEditLight.addChild(this._spotGeom),this._mtEditLight.addChild(this._pointGeom),this._scale.addChild(this._mtQuad),this._scale.addChild(this._dirGeom),this._scale.addChild(this._hemiGeom),this._mtQuad.addChild(this._quadGeom),this._dirty=!0,this._updateMatrixOnToggleCamera=!0,this._scene=null},setDepthTexture:function(e){e&&this._mtEditLight.getOrCreateStateSet().setTextureAttributeAndModes(0,e)},setScene:function(e){this._scene=e},getShadowMap:function(){return this._shadowMap},isCastingShadows:function(){var e=this.get("type");return this._enableShadow&&this.get("castShadows")&&("DIRECTION"===e||"SPOT"===e)},getLightSource:function(){return this._lightSource},getNodeScale:function(){return this._scale},getNodeQuad:function(){return this._mtQuad},getNode:function(){return this._node},getNodeLight:function(){return this._mtLight},getNodeEditLight:function(){return this._mtEditLight},dirty:function(){this._dirty=!0},isDirty:function(){return this._dirty},updateNode:function(){if(this._dirty){this._dirty=!1;var e=this._node,t=this._light,i=this.get("type");if("NONE"===i)return e.setNodeMask(0),t.setEnabled(!1),void(this._mtEditLight.editMask=0);e.setNodeMask(-1),this._mtEditLight.editMask="POINT"===i?p.NodeGizmo.PICK_ARROW|p.NodeGizmo.PICK_PLANE:p.NodeGizmo.PICK_GIZMO;"HEMI"===i&&u.a.get("mask")&u.a.PBR&&(i="DIRECTION");var r=this.get("enable"),a=this.get("falloff");t.setLightType(i),t.setSpotCutoff("SPOT"===i?this.get("angle"):180),t.setEnabled(r),t.setConstantAttenuation("DIRECTION"!==i?1:a),t.setQuadraticAttenuation("DIRECTION"!==i?a:0),t.setSpotBlend(this.get("hardness")),d.mat4.copy(this._mtLight.getMatrix(),this.get("matrix")),this._mtLight.dirtyBound(),this._mtEditLight.dirtyBound(),d.vec3.scale(t.getDiffuse(),this.get("color"),this.get("intensity")),d.vec3.copy(t.getSpecular(),t.getDiffuse()),d.vec3.scale(t.getGround(),this.get("ground"),this.get("intensityGround"));var n=this.getShadowMap();n&&(n.setTextureSize(Object(h.a)().shadowTextureSize),n.setBias(this.get("shadowBias")),Object(h.a)().shadowNormalOffset&&n.setNormalBias(this.get("shadowNormalBias"))),this.isAttachedToCamera()?(this._mtLight.setReferenceFrame(d.Transform.ABSOLUTE_RF),this._mtLight.setCullingActive(!1)):(this._mtLight.setReferenceFrame(d.Transform.RELATIVE_RF),this._mtLight.setCullingActive(!0));var o=this._scene.getMinimumBound(),l=o.radius(),c=this.multUI_?this.multUI_:o.radius2()/1e3,f=Math.pow(a*c,.125);f=Math.min(Math.max(f,0),1);var m=.05*l*f+.8*l*(1-f);"SPOT"===i&&this._spotGeom.updateCone(t.getSpotCutoff()*Math.PI/180,m),"POINT"===i&&this._pointGeom.updateRadius(m),this._dirGeom.setNodeMask(r&&"DIRECTION"===i?s.a.NO_PICK_NO_SHADOW:0),this._spotGeom.setNodeMask(r&&"SPOT"===i?s.a.NO_PICK_NO_SHADOW:0),this._hemiGeom.setNodeMask(r&&"HEMI"===i?s.a.NO_PICK_NO_SHADOW:0),this._pointGeom.setNodeMask(r&&"POINT"===i?s.a.NO_PICK_NO_SHADOW:0),d.vec3.copy(this._hemiGeom.getOrCreateStateSet().getUniform("uGround").getInternalArray(),t.getGround()),d.vec3.copy(this._mtEditLight.getOrCreateStateSet().getUniform("uColor").getInternalArray(),this.get("color"));var g=this._mtEditLight.getOrCreateStateSet();g.getUniform("uEnable").setInt(0|r),g.getUniform("uAttachedToCamera").setInt(0|this.isAttachedToCamera()),this._quadGeom.setLightType(i)}},setLightUnit:function(e){this._light.getLightNumber()!==e&&(this._light.setLightNumber(e),this._light.setName("skfb"+this._light.getTypeMember()),this._shadowMap.dirty())},setIconVisibility:function(e){this._mtEditLight.setNodeMask(e?s.a.PICK_GIZMO_LIGHT:0)},isAttachedToCamera:function(){var e=this.get("type");return("DIRECTION"===e||"HEMI"===e)&&this.get("attachedToCamera")},resetPosition:function(){d.mat4.identity(this._mtLight.getMatrix()),this._scene&&d.mat4.translate(this._mtLight.getMatrix(),this._mtLight.getMatrix(),this._scene.getMinimumBound().center()),l.a.draw()},updateAttachedToCamera:function(){var e=d.mat4.create(),t=d.vec3.create();return function(i){if(this._updateMatrixOnToggleCamera){var r=this.get("matrix");d.mat4.getTranslation(t,r),this.get("attachedToCamera")?d.mat4.copy(e,i.getViewMatrix()):d.mat4.invert(e,i.getViewMatrix()),d.mat4.multiply(r,e,r),d.mat4.setTranslation(r,t)}}}(),setUpdateMatrixOnToggleCamera:function(e){this._updateMatrixOnToggleCamera=e}});t.a=f},function(e,t,i){"use strict";var r=i(5),a=r.a.osg,n={};n.ThreePointLight=function(){return[{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:a.mat4.fromValues(-.9815804500275482,.1909922167095499,-.004668327333101102,0,.13548347102422797,.7131126062169096,.6878332937084056,0,.13469984856318096,.6745312327912614,-.7258536813891331,0,0,0,0,1),color:a.vec3.fromValues(.7806122448979592,.7985214493960848,1),intensity:.96},{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:a.mat4.fromValues(.7755211495104662,-.0666602860002539,.6277924441503967,0,.2690483737361956,.9344846523281437,-.233133882464682,0,-.5711216326246741,.3497067926613838,.7426474533145686,0,0,0,0,1),color:a.vec3.fromValues(1,.8783319450229073,.7091836734693877),intensity:1},{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:a.mat4.fromValues(.6903299131022926,-.7076363669144057,-.15064986988498263,0,-.011089698239978026,.19785137301620165,-.9801692980238416,0,.7234097246160907,.6783108479272498,.12873524736872857,0,0,0,0,1),color:a.vec3.fromValues(.423469387755102,.7352665556018328,1),intensity:.12,ground:a.vec3.fromValues(.9642857142857143,.6484128636877489,.2607507288629738),intensityGround:.06}]},n.FullMoonNight=function(){return[{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:a.mat4.fromValues(.9997395789367833,.0037284998571004493,-.02251383121813605,0,-.003172416108909601,.9996902441347245,.024685047253076783,0,.02259889562202194,-.024607195505995896,.9994417320914686,0,0,0,0,1),color:a.vec3.fromValues(.14431486880466474,.20264621883738915,.3928571428571429),intensity:1.5400000000000005,ground:a.vec3.fromValues(.9744897959183674,.6276245973191442,.3331164098292378),intensityGround:.06},{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:a.mat4.fromValues(.9321120105125691,.3015730438836578,-.2005514873067817,0,.11902736304545063,-.7780729183457072,-.6167941476566071,0,-.34205216956578893,.5510501183556175,-.7611465564236605,0,0,0,0,1),color:a.vec3.fromValues(1,.613390254060806,.19387755102040816),intensity:2.9799999999999995},{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:a.mat4.fromValues(.5165535747993983,-.2459126458378022,-.8201825254045677,0,-.40819067915319995,.771302442076031,-.48833688402577136,0,.7526970000035951,.5870430252243886,.29803978378898704,0,0,0,0,1),color:a.vec3.fromValues(1,1,1),intensity:.38}]},n.LowKeyLight=function(){return[{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:a.mat4.fromValues(.022621146436927503,-.2660807408393079,-.9636852821789301,0,-.18898982664775527,.9454138725983617,-.26547213586781604,0,.9817184571747294,.1881319984823789,-.02890020742997683,0,0,0,0,1),color:a.vec3.fromValues(1,1,1),intensity:1},{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:a.mat4.fromValues(-.9330760233019924,.058913139300351657,.35482161258401,0,.19787524547993016,.9078715652207372,.36961413432105955,0,-.30035732380815566,.4150885003001482,-.8587706416461712,0,0,0,0,1),color:a.vec3.fromValues(1,1,1),intensity:.22},{type:"NONE",enable:!0}]},n.EvilGenius=function(){return[{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:a.mat4.fromValues(.9967621126545051,.025235816589958687,.07634424888336766,0,.000702423157861877,-.9521689363972996,.3055713061819492,0,.08040396369728874,-.3045282747481311,-.9491036468693457,0,0,0,0,1),color:a.vec3.fromValues(1,.3450645564348185,.056122448979591844),intensity:1.5400000000000005},{type:"DIRECTION",enable:!0,attachedToCamera:!0,castShadows:!1,matrix:a.mat4.fromValues(-.7932202797763206,.039941473670798935,.6076234577701727,0,.16089796285361985,.9761307284151629,.14587887644631273,0,-.5872933111326324,.21347945972549276,-.780713191238742,0,0,0,0,1),color:a.vec3.fromValues(.15368596418159094,.7346938775510203,.20111518159950362),intensity:1.9000000000000008},{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:a.mat4.fromValues(.9998681367204546,.01574007797565349,.003994886292083951,0,0,.24600379421877677,-.9692688652948499,0,-.016239124704439348,.9691410543235108,.24597135535169048,0,0,0,0,1),color:a.vec3.fromValues(.9897959183673469,.674842115105101,.02524989587671801),intensity:.02,ground:a.vec3.fromValues(.3,.2,.2),intensityGround:.98}]},n.FairyCamp=function(){return[{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:a.mat4.fromValues(.7285122591021403,-.5166704810444328,-.44980162555865727,0,.2899427624247639,.827461680647148,-.4808745798834604,0,.6206473095530125,.21990630067806594,.752620844826062,0,0,0,0,1),color:a.vec3.fromValues(.8476936693044566,.8957603762037927,.9948979591836735),intensity:.9},{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:a.mat4.fromValues(.08433618912371937,-.8568665398386119,-.5085932953835439,0,-.8584235966554874,-.3216498975444721,.39956260099599905,0,-.5059608047162799,.40289089877364465,-.7626811835729392,0,0,0,0,1),color:a.vec3.fromValues(.37244897959183676,.538942107455227,1),intensity:1.7200000000000006},{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:a.mat4.fromValues(.9766324883850551,-.001534767629049323,.21491074221438983,0,.14494434684687327,-.7336231034872216,-.6639188793421307,0,.15868244688039193,.6795548443783637,-.7162577012039377,0,0,0,0,1),color:a.vec3.fromValues(.3389212827988338,.7142857142857143,.346581781400607),intensity:.5,ground:a.vec3.fromValues(.9947417742607245,.48469387755102045,1),intensityGround:.14}]},n.ThreePointLightV2=function(){return[{type:"DIRECTION",enable:!0,attachedToCamera:!0,castShadows:!1,matrix:a.mat4.fromValues(-.9815804500275482,.1909922167095499,-.004668327333101102,0,.13548347102422797,.7131126062169096,.6878332937084056,0,.13469984856318096,.6745312327912614,-.7258536813891331,0,0,0,0,1),color:a.vec3.fromValues(.7806122448979592,.7985214493960848,1),intensity:.96},{type:"DIRECTION",enable:!0,attachedToCamera:!0,castShadows:!1,matrix:a.mat4.fromValues(.7755211495104662,-.0666602860002539,.6277924441503967,0,.2690483737361956,.9344846523281437,-.233133882464682,0,-.5711216326246741,.3497067926613838,.7426474533145686,0,0,0,0,1),color:a.vec3.fromValues(1,.8783319450229073,.7091836734693877),intensity:1},{type:"HEMI",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:a.mat4.fromValues(.6903299131022926,-.7076363669144057,-.15064986988498263,0,-.011089698239978026,.19785137301620165,-.9801692980238416,0,.7234097246160907,.6783108479272498,.12873524736872857,0,0,0,0,1),color:a.vec3.fromValues(.423469387755102,.7352665556018328,1),intensity:.12,ground:a.vec3.fromValues(.9642857142857143,.6484128636877489,.2607507288629738),intensityGround:.06}]},n.TwoHeadLightV1=function(){return[{type:"DIRECTION",enable:!0,attachedToCamera:!0,castShadows:!1,matrix:a.mat4.fromValues(Math.SQRT1_2,0,Math.SQRT1_2,0,-0,1,0,0,-Math.SQRT1_2,-0,Math.SQRT1_2,0,0,0,0,1),color:a.vec3.fromValues(.6,.48,.3),intensity:1},{enable:!0,attachedToCamera:!0,castShadows:!1,type:"DIRECTION",matrix:a.mat4.fromValues(Math.SQRT1_2,0,-Math.SQRT1_2,0,0,1,0,0,Math.SQRT1_2,0,Math.SQRT1_2,0,0,0,0,1),color:a.vec3.fromValues(.42,.42,.6),intensity:1},{type:"NONE",enable:!0}]},n.LightFromAbove=function(){return[{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!0,matrix:a.mat4.fromValues(.9997395789367833,.0037284998571004493,-.02251383121813605,0,-.003172416108909601,.9996902441347245,.024685047253076783,0,.02259889562202194,-.024607195505995896,.9994417320914686,0,0,0,0,1),color:a.vec3.fromValues(1,1,1),intensity:.01},{type:"NONE",enable:!0},{type:"NONE",enable:!0}]},t.a=n},function(e,t,i){"use strict";var r=i(5),a=i(34),n=i(8),o=i(43),s=i(37),u=i(57),l=i(706),c=i(16),h=r.a.osg,d=n.a.extend({initialize:function(e){n.a.prototype.initialize.apply(this,arguments),this.model.bind("change:select",this.onSelectChanged,this),this.model.bind("change:enable",this.onEnableChanged,this),this.model.bind("change",s.a.draw),this._viewer=e.context.getViewer(),this._viewerOSGJS=this._viewer.getViewerOSGJS(),this._manipulator=this._viewerOSGJS.getManipulator(),this._isScreenshot=!1,this._nodeFeature=new h.Node,this._nodeFeature.setName("Feature - Lighting"),this._shadowNode=new r.a.osgShadow.ShadowedScene(Object(l.c)()),this._shadowNode.setName("Shadowed scene"),this._lightNode=new h.Camera,this._lightNode.setName("Lighting - Camera"),this._lightNode.setNearFarRatio(5e-5),this._lightNode.getOrCreateStateSet().setRenderBinDetails(u.a.EDITOR_GIZMO,"RenderBin"),this._lightNode.setNodeMask(o.a.NO_SHADOW),this.initLightNode(),this.onEnableChanged(),this._nodeFeature.addChild(this._lightNode),a.a.getMaterial().then(this.handleDirtyShadows.bind(this))},getNode:function(){return this._nodeFeature},getNodeLight:function(){return this._lightNode},getNodeShadow:function(){return this._shadowNode},isLightNone:function(e){return-1===e||"NONE"===this.model.get("lights")[e].get("type")},isTabLighting:function(){var e=this._viewer.getFeaturesManager();return e&&"lighting"===e.getCurrentTabName()},handleDirtyShadows:function(){var e=this._viewer.getFeatures().material;if(e){var t=e.getModel().attributes,i=this.model.get("lights"),r=i.length;for(var a in t)for(var n=t[a],o=n.getChannels().Opacity,s=n.getChannels().Displacement,u=0;u<r;++u){var l=i[u];o.bind("change",l.dirty,l),s.bind("change",l.dirty,l)}}},onEnableChanged:function(){var e=this.model.get("enable");if(this._lightNode.setNodeMask(e?o.a.NO_SHADOW:0),!e){var t=this.getGizmo();t&&t.attachToNode(null)}for(var i=this.model.get("lights"),r=0,a=i.length;r<a;++r){var n=i[r],s=e&&n.get("enable");n.getLightSource().getLight().setEnabled(s),Object(c.a)().shadowAtlas&&!s&&Object(l.d)(this._shadowNode,n.getShadowMap())}e&&this._updateLightsAndIcons()},initLightNode:function(){this._nodeFeature.addUpdateCallback(this);for(var e=this.model.get("lights"),t=0,i=e.length;t<i;++t){var r=e[t];r.setLightUnit(t),r.bind("change",r.dirty,r),r.bind("change:attachedToCamera",r.updateAttachedToCamera.bind(r,this._viewer.getCamera()),r),r.bind("change",s.a.draw),this._lightNode.addChild(r.getNode())}},getGizmo:function(){var e=this._viewer.getFeaturesManager();return e?e.getNodeGizmo():null},onSelectChanged:function(){var e=this.getGizmo();if(e){var t=this.model.get("select");if(this.isLightNone(t))return void e.attachToNode(null);e.attachToNode(this.model.get("lights")[t].getNodeEditLight())}},updateSelection:function(){var e=this.getGizmo();if(e&&!e._isEditing){var t=e._attachedNode;if(!this.isLightNone(this.model.get("select"))||t)for(var i=this.model.get("lights"),r=0;r<3;++r)if(i[r].getNodeEditLight()===t){e.updateGizmoMask(),this.model.set("select",r);break}}},updateLightIcons:function(){var e=h.vec4.create(),t=h.vec3.create(),i=h.vec3.create(),r=h.quat.create();return function(){var a=this.model.get("lights"),n=this._viewer.getCamera(),o=this._viewer.getFeaturesManager().getIconScaleFov();this._manipulator.getEyePosition(i);for(var s=this.getGizmo(),u=0;u<3;++u){var l=a[u];if("NONE"!==l.get("type")){var c=l.getNodeEditLight(),d=l.getNodeLight(),p=l.getNodeQuad(),f=l.getNodeScale(),m=s._isEditing&&s._attachedNode===c,g=p.getMatrix(),_=c.getMatrix(),v=d.getMatrix();l.isAttachedToCamera()?m?(h.mat4.getTranslation(t,_),h.mat4.multiply(v,n.getViewMatrix(),_),h.mat4.setTranslation(v,t)):(h.mat4.getTranslation(t,v),h.mat4.invert(_,n.getViewMatrix()),h.mat4.multiply(_,_,v),h.mat4.setTranslation(_,t)):m?h.mat4.copy(v,_):h.mat4.copy(_,v),h.mat4.copy(l.get("matrix"),v),c.getWorldMatrix(void 0,g),h.mat4.getTranslation(t,g);var b=h.vec3.dist(i,t)/o;h.mat4.fromScaling(f.getMatrix(),h.vec3.set(e,b,b,b)),h.mat4.multiply(g,n.getViewMatrix(),g),h.mat4.invert(g,g),h.mat4.fromQuat(g,h.mat4.getRotation(r,g)),p.dirtyBound(),d.dirtyBound(),f.dirtyBound()}}}}(),setIsScreenshot:function(e){this._isScreenshot=e},_updateLightsAndIcons:function(){if(this._lightNode.getNodeMask()&&this._shadowNode.getChildren().length){for(var e=this._viewer.getFeatures().shadingStyle,t=this._viewer.getFeatures().ARKit,i=t.getModel().get("enable")||"lit"===e.getModel().get("type"),r=!this._isScreenshot&&i&&this.isTabLighting(),a=this._viewer.getFeaturesManager().getShadowForcedUpdate(),n=this.model.get("webVR"),o=this.model.get("lights"),s=0;s<3;++s){var u=o[s],c=a||u.isDirty();u.updateNode();var d=u.getShadowMap();if(d){var p=n&&u.isAttachedToCamera();if(!p&&i&&u.get("enable")&&u.isCastingShadows()){if(!(c=c||u.isAttachedToCamera()||a)){for(var f=u.get("matrix"),m=u.get("matrixPrev"),g=0;g<16;g++)if(f[g]!==m[g]){c=!0;break}h.mat4.copy(m,f)}c&&d.requestRedraw(),Object(l.a)(this._shadowNode,d)}else(c||p)&&Object(l.d)(this._shadowNode,d);u.setIconVisibility(r)}}r&&(this.updateLightIcons(),this.updateSelection())}},update:function(e,t){return e.getNumChildrenRequiringUpdateTraversal()>0&&t.traverse(e),this._updateLightsAndIcons(),!1}});t.a=d},function(e,t,i){"use strict";var r=i(62),a=i(1260),n=i(1261),o=i(146),s={FeatureName:"postProcess",ModelType:a.a,ViewListType:[n.a]},u=r.a.create(s);u.prototype.getNodeIn=function(){return this._views[0]._nodeIn},u.prototype.getNodeOut=function(){return this._views[0]._nodeOut},u.prototype.getCamera=function(){return this._views[0]._camera},u.prototype.getCurrentComposer=function(){return this._views[0]._nodeIn._composer},u.prototype.prepareForScreenShot=function(){o.a.uSSAARestart.setFloat(1),this._views[0].hideDofCross()},u.prototype.resetAfterScreenShot=function(){o.a.uSSAARestart.setFloat(0)},t.a=u},function(e,t,i){"use strict";var r=i(120),a=i(5),n=i(34),o=i(16),s=i(70),u=i(79),l=i(42),c=i.n(l),h=i(146),d=i(93),p=a.a.osg,f=r.a.extend({initialize:function(){r.a.prototype.initialize.apply(this,arguments),this._sssSchema=this.getSubSchema("scene.sssProfiles"),this.set("sssProfiles",this.getInstance(this._sssSchema))},getModelOptionPath:function(){return"scene.postProcess"},defaults:{postProcessReady:!1,rgbmDefault:7,rgbmBloom:1,sssCurrentProfile:0,webVR:!1,AR:!1,veilFactor:1,doDistortionVR:!1,distortion:p.vec2.fromValues(.441,.156),projectionLeft:p.vec4.fromValues(1,1,-.5,-.5),unprojectionLeft:p.vec4.fromValues(1,1,-.5,-.5),vrFadeLength:Object(o.a)().vrFade/1e3/2,vrStartFade:!1,vrFadeStartTime:0,vrFadeCallback:void 0,vrFading:!1},getName:function(){return"PostProcess"},getViewer:function(){return this._viewer},useSSSLookupFloat:function(){return p.WebGLCaps.instance().getWebGLExtension("OES_texture_float_linear")},getSSSWeightRange:function(){return 2*Object(o.a)().sssHalfKernel-1>20?3:2},setQuality:function(e){void 0!==Object(o.a)().quality&&(e=Object(o.a)().quality),h.a.uQuality.setFloat(e)},getQuality:function(){return h.a.uQuality.getInternalArray()[0]},_getBoundRadius:function(){return u.a.getModelBoxWithDisplacement().radius()},getMinimumSsaoRadius:function(){return.01*this._getBoundRadius()},getMaximumSsaoRadius:function(){return.1*this._getBoundRadius()},getMinimumSsaoBias:function(){return.002*this._getBoundRadius()},getMaximumSsaoBias:function(){return.01*this._getBoundRadius()},_makeValidOption:function(e,t,i,r){var a=this.get(e);a<t*u.a.BIAS_MIN||a>i*u.a.BIAS_MAX?this.set(e,r):this.set(e,Math.min(Math.max(a,t),i))},_makeValidSsaoRadius:function(){this._makeValidOption("ssaoRadius",this.getMinimumSsaoRadius(),this.getMaximumSsaoRadius(),.025*this._getBoundRadius())},_makeValidSsaoBias:function(){this._makeValidOption("ssaoBias",this.getMinimumSsaoBias(),this.getMaximumSsaoBias(),.005*this._getBoundRadius())},_isEffectivePP:function(){return this.get("enable")},isEffectiveGrain:function(){return this._isEffectivePP()&&!this.get("webVR")&&this.get("grainEnable")&&this.get("grainFactor")>=5e-4},isEffectiveSharpen:function(){return this._isEffectivePP()&&!this.get("webVR")&&this.get("sharpenEnable")&&this.get("sharpenFactor")>=5e-4},isEffectiveChromaticAberration:function(){return this._isEffectivePP()&&!this.get("webVR")&&this.get("chromaticAberrationEnable")&&this.get("chromaticAberrationFactor")>=.001},isEffectiveVignette:function(){return this._isEffectivePP()&&!this.get("webVR")&&this.get("vignetteEnable")&&this.get("vignetteHardness")-this.get("vignetteAmount")<=.5*Math.sqrt(2)},isEffectiveBloom:function(){return this._isEffectivePP()&&(!this.get("webVR")||!c.a.any)&&this.get("bloomEnable")&&this.get("bloomFactor")>=.01},isEffectiveToneMapping:function(){return this._isEffectivePP()&&this.get("toneMappingEnable")},isEffectiveColorBalance:function(){return this._isEffectivePP()&&this.get("colorBalanceEnable")},isEffectiveDof:function(){return this._isEffectivePP()&&!this.get("webVR")&&this.get("dofEnable")&&(this.get("dofBlurNear")>=.01||this.get("dofBlurFar")>=.01)},isEffectiveSsao:function(){return this._isEffectivePP()&&!this.get("webVR")&&this.get("ssaoEnable")&&this.get("ssaoIntensity")>=.01},isEffectiveSsr:function(){return this._isEffectivePP()&&d.a.get("mask")&d.a.LIT&&!this.get("webVR")&&this.get("ssrEnable")&&this.get("ssrFactor")>.01},hasAtLeastOneEffectiveEffect:function(){return!!this.isEffectiveGrain()||(!!this.isEffectiveSharpen()||(!!this.isEffectiveChromaticAberration()||(!!this.isEffectiveVignette()||(!!this.isEffectiveBloom()||(!!this.isEffectiveToneMapping()||(!!this.isEffectiveColorBalance()||(!!this.isEffectiveDof()||!!this.isEffectiveSsao())))))))},initAfterFirstFrame:function(){this._makeValidSsaoRadius(),this._makeValidSsaoBias(),this.trigger("uiReady"),this.set("postProcessReady",!0)},init:function(e){this._viewer=e.getViewer();var t=e.getModel().get("options");if(t.scene&&t.scene.sssProfiles&&this.setProfilesJSON(t.scene.sssProfiles),t.scene&&t.scene.postProcess){var i=t.scene.postProcess;this.setJSON(i),void 0!==Object(o.a)().postProcess&&this.set("enable",Object(o.a)().postProcess),void 0!==Object(o.a)().ssr&&this.set("ssrEnable",Object(o.a)().ssr);var r=i.taa,a=Object(o.a)().taa;if(r){this.set("taaEnable",void 0!==a?a:r.enable);var l=Object(o.a)().taaTransparent;this.set("taaTransparent",void 0!==l?l:r.transparent),void 0===a&&u.a.getBoxReady().then(function(){u.a.getMaxDistanceFromOrigin()>1e6&&this.set("taaEnable",!1)}.bind(this))}else void 0!==a&&this.set("taaEnable",a)}Object(s.a)()&&n.a.getMaterial().then(function(){"Tilt Brush"===this._viewer.getRootUserData().authoringTool?(this.set("bloomEnable",!0),this.set("bloomThreshold",.6),this.set("bloomFactor",1.6),this.set("bloomRadius",.2),this.set("toneMappingEnable",!0),this.set("toneMappingMethod","filmic")):"minecraft"!==this._viewer.getRootUserData().source&&"mineways"!==this._viewer.getRootUserData().source||(this.set("ssaoEnable",!0),this.set("ssaoRadius",.05),this.set("ssaoIntensity",1),this.set("ssaoBias",.006))}.bind(this))},fadeForTeleportVR:function(e){this.set("vrStartFade",!0),this.set("vrFadeCallback",e)},setProfilesJSON:function(e,t){if(t&&t.validate){var i=this.validate(e,{schema:this._sssSchema});if(i.length)return console.error("Failed to validate sss profile json",e,i),i.join("\n")}return this.set("sssProfiles",e),[]},getProfilesJSON:function(){return this.get("sssProfiles")},editorGetJSON:function(){return this.getJSON()},editorSetJSON:function(e){return this.setJSON(e,{validate:!0})}});t.a=f},function(e,t,i){"use strict";var r=i(5),a=i(8),n=i(37),o=i(1262),s=i(1301),u=i(610),l=i(146),c=i(93),h=r.a.osg,d=a.a.extend({initialize:function(){a.a.prototype.initialize.apply(this,arguments);var e=this.model;e.bind("change:webVR",this.dirty,this),e.bind("change:distortVR",this.dirty,this),e.bind("change:enable",this.dirty,this),e.bind("change:grainEnable",this.checkGrainEnable,this),e.bind("change:sharpenEnable",this.checkSharpenEnable,this),e.bind("change:chromaticAberrationEnable",this.checkChromaticAberrationEnable,this),e.bind("change:vignetteEnable",this.checkVignetteEnable,this),e.bind("change:bloomEnable",this.checkBloomEnable,this),e.bind("change:dofEnable",this.checkDofEnable,this),e.bind("change:toneMappingEnable",this.dirty,this),e.bind("change:colorBalanceEnable",this.dirty,this),e.bind("change:ssaoEnable",this.checkSsaoEnable,this),e.bind("change:ssrEnable",this.checkSsrEnable,this),c.a.bind("change:mask",this.checkSsrEnable,this),e.bind("change:taaEnable",this.checkTaaEnable,this),e.bind("change:taaTransparent",this.checkTaaTransparentEnable,this),e.bind("change:distortion",this.onDistortionChanged,this),e.bind("change:projectionLeft",this.onProjectionLeftChanged,this),e.bind("change:unprojectionLeft",this.onUnprojectionLeftChanged,this),e.bind("change:grainFactor",this.onGrainFactor,this),e.bind("change:sharpenFactor",this.onSharpenFactor,this),e.bind("change:chromaticAberrationFactor",this.onChromaticAberrationFactor,this),e.bind("change:vignetteAmount",this.onVignetteLensChanged,this),e.bind("change:vignetteHardness",this.onVignetteLensChanged,this),e.bind("change:bloomFactor",this.onBloomFactorChanged,this),e.bind("change:bloomThreshold",this.onBloomThresholdChanged,this),e.bind("change:bloomRadius",this.onBloomRadiusChanged,this),e.bind("change:toneMappingExposure",this.onToneMappingExposureChanged,this),e.bind("change:toneMappingBrightness",this.onToneMappingBrightnessChanged,this),e.bind("change:toneMappingContrast",this.onToneMappingContrastChanged,this),e.bind("change:toneMappingSaturation",this.onToneMappingSaturationChanged,this),e.bind("change:toneMappingMethod",this.onToneMappingMethodChanged,this),e.bind("change:colorBalanceLow",this.onColorBalanceShiftChanged,this),e.bind("change:colorBalanceMid",this.onColorBalanceShiftChanged,this),e.bind("change:colorBalanceHigh",this.onColorBalanceShiftChanged,this),e.bind("change:dofFocusPoint",this.onDofFocusPoint,this),e.bind("change:dofBlurNear",this.onDofBlurNear,this),e.bind("change:dofBlurFar",this.onDofBlurFar,this),e.bind("change:ssaoIntensity",this.onSsaoIntensity,this),e.bind("change:ssaoRadius",this.onSsaoRadius,this),e.bind("change:ssaoBias",this.onSsaoBias,this),e.bind("change:ssrFactor",this.onSsrFactor,this),e.bind("change",n.a.draw),this._effectiveConfig={},this._viewer=this.model._viewer,this._viewerOSGJS=this._viewer.getViewerOSGJS(),this._sssTexKernel=new h.Texture,this._sssTexKernel.divisor=-1,this._camera=this._createMainCamera(),this._nodeIn=new o.a(this),this._nodeOut=this._createNodeOut(),this._nodeIn.addChild(this._camera),this._camera.addChild(this._nodeOut),this._callbackPostProcess=new s.a(this),this._nodeIn.setCullCallback(this._callbackPostProcess),this._initUniforms()},dirty:function(){this._callbackPostProcess.dirty()},_initUniforms:function(){var e=this.model.attributes;for(var t in e)this.model.trigger("change:"+t)},_createNodeOut:function(){var e=new h.Node;return e.setName("PostProcess - node Out"),e},_createMainCamera:function(){var e=new h.Camera,t=this._viewerOSGJS.getCanvasWidth(),i=this._viewerOSGJS.getCanvasHeight();return e.setViewport(new h.Viewport(0,0,t,i)),e.setName("PostProcess - MainCamera"),e.setRenderOrder(h.Camera.PRE_RENDER,0),e.attachRenderBuffer(h.FrameBufferObject.DEPTH_ATTACHMENT,h.FrameBufferObject.DEPTH_COMPONENT16),e},methodToInt:function(e){return"reinhard"===e?1:"filmic"===e?2:0},checkGrainEnable:function(){this._effectiveConfig.useGrain!==this.model.isEffectiveGrain()&&this.dirty()},checkSharpenEnable:function(){this._effectiveConfig.useSharpen!==this.model.isEffectiveSharpen()&&this.dirty()},checkChromaticAberrationEnable:function(){this._effectiveConfig.useChromaticAberration!==this.model.isEffectiveChromaticAberration()&&this.dirty()},checkVignetteEnable:function(){this._effectiveConfig.useVignette!==this.model.isEffectiveVignette()&&this.dirty()},checkBloomEnable:function(){this._effectiveConfig.useBloom!==this.model.isEffectiveBloom()&&this.dirty()},checkDofEnable:function(){this._effectiveConfig.useDof!==this.model.isEffectiveDof()&&this.dirty()},checkSsaoEnable:function(){this._effectiveConfig.useSsao!==this.model.isEffectiveSsao()&&this.dirty()},checkSsrEnable:function(){this._effectiveConfig.useSsr!==this.model.isEffectiveSsr()&&this.dirty()},checkTaaEnable:function(){this._effectiveConfig.useTaa!==this.model.get("taaEnable")&&this.dirty()},checkTaaTransparentEnable:function(){this._effectiveConfig.useTaaTransparent!==(this.model.get("taaEnable")&&this.model.get("taaTransparent"))&&this.dirty()},onDistortionChanged:function(){u.a.uDistortion.setFloat2(this.model.get("distortion"))},onProjectionLeftChanged:function(){u.a.uProjectionLeft.setFloat4(this.model.get("projectionLeft"))},onUnprojectionLeftChanged:function(){u.a.uUnprojectionLeft.setFloat4(this.model.get("unprojectionLeft"))},onGrainFactor:function(){u.a.uGrainFactor.setFloat(this.model.get("grainFactor")),this.checkGrainEnable()},onSharpenFactor:function(){u.a.uSharpFactor.setFloat(this.model.get("sharpenFactor")),this.checkSharpenEnable()},onChromaticAberrationFactor:function(){u.a.uChromaFactor.setFloat(this.model.get("chromaticAberrationFactor")),this.checkChromaticAberrationEnable()},onVignetteLensChanged:function(){var e=u.a.uLensRadius.getInternalArray(),t=this.model.get("vignetteAmount"),i=this.model.get("vignetteHardness");e[0]=2-t-i,e[1]=i-t,this.checkVignetteEnable()},onBloomFactorChanged:function(){u.a.uBloomFactor.setFloat(this.model.get("bloomFactor")),this.checkBloomEnable()},onBloomThresholdChanged:function(){u.a.uBloomThreshold.setFloat(this.model.get("bloomThreshold")),this.checkBloomEnable()},onBloomRadiusChanged:function(){u.a.uBloomRadius.setFloat(this.model.get("bloomRadius")),this.checkBloomEnable()},onColorBalanceShiftChanged:function(){u.a.uColorBalanceLow.setFloat3(this.model.get("colorBalanceLow")),u.a.uColorBalanceMid.setFloat3(this.model.get("colorBalanceMid")),u.a.uColorBalanceHigh.setFloat3(this.model.get("colorBalanceHigh"))},onToneMappingExposureChanged:function(){u.a.uToneExposure.setFloat(this.model.get("toneMappingExposure"))},onToneMappingBrightnessChanged:function(){u.a.uToneBrightness.setFloat(this.model.get("toneMappingBrightness"))},onToneMappingContrastChanged:function(){u.a.uToneContrast.setFloat(this.model.get("toneMappingContrast"))},onToneMappingSaturationChanged:function(){u.a.uToneSaturation.setFloat(this.model.get("toneMappingSaturation"))},onToneMappingMethodChanged:function(){u.a.uToneMethod.setInt(this.methodToInt(this.model.get("toneMappingMethod")))},onDofFocusPoint:function(){this._callbackPostProcess.updateDofFocusPoint()},onDofBlurNear:function(){this._callbackPostProcess.updateTargetDofBlurNear(),this.checkDofEnable()},onDofBlurFar:function(){this._callbackPostProcess.updateTargetDofBlurFar(),this.checkDofEnable()},hideDofCross:function(){this._callbackPostProcess.hideDofCross()},onSsaoRadius:function(){u.a.uSsaoRadius.setFloat(this.model.get("ssaoRadius")),this.checkSsaoEnable()},onSsaoIntensity:function(){u.a.uSsaoIntensity.setFloat(this.model.get("ssaoIntensity")),this.checkSsaoEnable()},onSsaoBias:function(){u.a.uSsaoBias.setFloat(this.model.get("ssaoBias"))},onSsrFactor:function(){l.a.uSsrFactor.setFloat(this.model.get("ssrFactor")),this.checkSsrEnable()}});t.a=d},function(e,t,i){"use strict";var r=i(5),a=i(16),n=i(43),o=i(251),s=i(707),u=i(47),l=i(614),c=i(187),h=i(42),d=i.n(h),p=i(34),f=i(107),m=i(558),g=i(863),_=i(1263),v=i(93),b=i(610),y=i(146),x=i(1264),S=i.n(x),M=i(1265),w=i.n(M),T=i(1266),C=i.n(T),E=i(1267),L=i.n(E),P=i(1268),A=i.n(P),D=i(1269),O=i.n(D),k=i(1270),R=i.n(k),I=i(1271),F=i.n(I),N=i(1272),V=i.n(N),B=i(1273),U=i.n(B),j=i(1274),G=i.n(j),Y=i(1275),H=i.n(Y),z=i(1276),W=i.n(z),q=i(1277),X=i.n(q),J=i(1278),K=i.n(J),$=i(1279),Q=i.n($),Z=i(1280),ee=i.n(Z),te=i(1281),ie=i.n(te),re=i(1282),ae=i.n(re),ne=i(1283),oe=i.n(ne),se=i(1284),ue=i.n(se),le=i(1285),ce=i.n(le),he=i(1286),de=i.n(he),pe=i(1287),fe=i.n(pe),me=i(1288),ge=i.n(me),_e=i(1289),ve=i.n(_e),be=i(1290),ye=i.n(be),xe=i(1291),Se=i.n(xe),Me=i(1292),we=i.n(Me),Te=i(1293),Ce=i.n(Te),Ee=i(1294),Le=i.n(Ee),Pe=i(1295),Ae=i.n(Pe),De=i(1296),Oe=i.n(De),ke=i(1297),Re=i.n(ke),Ie=i(1298),Fe=i.n(Ie),Ne=i(1299),Ve=i.n(Ne),Be=i(1300),Ue=i.n(Be),je=r.a.osg,Ge=r.a.osgUtil,Ye=f.a.getShaderProcessor(),He=function(e){je.Node.call(this),this.setName("PostProcess - node In"),this._view3d=e,this._camera=e._camera,this._effectiveConfig=e._effectiveConfig,this._viewer=e._viewer,this._viewerOSGJS=e._viewerOSGJS,this._model=e.model,this._hasTriangles=this._viewer.getOrCreateScene().getJSON().faceCount>0,s.a.setHasTriangles(this._hasTriangles),this._viewer.getCamera().getRenderer().setRenderStage(new s.a),this._model.on("pingPongTexture0",this.onPingPongTexture0,this),p.a.getMaterial().then(function(){var e=this.getBackgroundModel();e.bind("backgroundUpdated",this.onBackgroundUpdated,this),e.bind("change:color",this.onBackgroundColor,this)}.bind(this)),this._composer=void 0,this._addShaders()};je.createPrototypeNode(He,je.objectInherit(je.Node.prototype,{_addShaders:function(){var e={"passThrough.glsl":S.a,"setDepthAlpha.glsl":w.a,"combineOpacity.glsl":C.a,"combineRefraction.glsl":L.a,"packMipmapRefraction.glsl":A.a,"sssCommon.glsl":O.a,"sssExtract.glsl":R.a,"sssBlur.glsl":F.a,"sssCombine.glsl":V.a,"packMipmapDepth.glsl":U.a,"depthMipmap.glsl":G.a,"ssaoExtract.glsl":H.a,"ssaoBlur.glsl":W.a,"dofCommon.glsl":X.a,"dofCoC.glsl":K.a,"dofNearDilate.glsl":Q.a,"dofDownsampleColor.glsl":ee.a,"dofBlurCircular.glsl":ie.a,"dofCombine.glsl":ae.a,"bloomExtract.glsl":oe.a,"bloomCombine.glsl":ue.a,"chromaticAberration.glsl":ce.a,"vignette.glsl":de.a,"toneMapping.glsl":fe.a,"colorBalance.glsl":ge.a,"supersample.glsl":ve.a,"supersampleTaa.glsl":ye.a,"composeExtra.glsl":Se.a,"composeFixedBackground.glsl":we.a,"fxaa.glsl":Ce.a,"grain.glsl":Le.a,"sharpen.glsl":Ae.a,"dofCross.glsl":Oe.a,"distortion.glsl":Re.a,"fadeVr.glsl":Fe.a,"veilVr.glsl":Ve.a,"outline.glsl":Ue.a};Ye.addShaders(e)},getNodeBackground:function(){return this._viewer.getFeatures().environment.getNode().getBackground()},getBackgroundModel:function(){return this._viewer.getFeatures().background.getModel()},getBackgroundType:function(){return this.getBackgroundModel().getEnableType()},onPingPongTexture0:function(e){this._composer&&this._composer.swapFeedbackLoopTextures(e)},_replaceTexture:function(e,t,i){var r=this._composer.getStateSetPass(t);if(r){var a=r.getUniform(i);a&&r.setTextureAttributeAndModes(a.getInternalArray()[0],e)}},onBackgroundUpdated:function(e){void 0!==this._composer&&"fixed"===this._effectiveConfig.bgType&&(this._replaceTexture(e,"composeFixedBackground","TextureFixed"),this._replaceTexture(e,"composeFixedBackgroundRefraction","TextureFixed"))},onBackgroundColor:function(){var e=s.a.getClearColor();if("color"!==this.getBackgroundType())return void je.vec4.set(e,0,0,0,0);je.vec3.copy(e,this.getBackgroundModel().getColor()),e[3]=1,1===y.a.uOutputLinear.getInternalArray()[0]&&l.a.srgbToLinear(e,e);var t=y.a.uRGBMRange.getInternalArray()[0];t>0&&l.a.encodeRGBM(e,t,e)},_getSupportedFloatTexture:function(){var e=je.WebGLCaps.instance();return 0===Object(a.a)().floatRtt?je.Texture.UNSIGNED_BYTE:e.hasLinearHalfFloatRTT()?je.Texture.HALF_FLOAT:e.hasHalfFloatRTT()?je.Texture.HALF_FLOAT:d.a.any&&this._model.get("webVR")&&2===Object(a.a)().floatRtt?je.Texture.UNSIGNED_BYTE:e.hasLinearFloatRTT()?je.Texture.FLOAT:e.hasFloatRTT()?je.Texture.FLOAT:je.Texture.UNSIGNED_BYTE},_updateEffectiveConfig:function(){var e=this._effectiveConfig,t=o.a.get("hasTransparency"),i=o.a.get("hasExtra"),r=o.a.get("hasRefraction"),n=o.a.get("hasScattering");e.webVR=this._model.get("webVR"),e.AR=this._model.get("AR");var s=this._model.get("doDistortionVR")&&Object(a.a)().vrStereo;e.useDistortionVR=e.webVR&&s,e.useSss=n,e.useSsao=this._model.isEffectiveSsao(),e.useDof=this._model.isEffectiveDof(),e.useBloom=this._model.isEffectiveBloom(),e.useChromaticAberration=this._model.isEffectiveChromaticAberration(),e.useToneMapping=this._model.isEffectiveToneMapping(),e.useColorBalance=this._model.isEffectiveColorBalance(),e.bgType=this.getBackgroundType(),e.hasBG="none"!==e.bgType,e.useTaa=!e.AR&&this._model.get("taaEnable"),e.useTaaTransparent=e.useTaa&&this._model.get("taaTransparent");var l=Object(a.a)().fxaa;return e.useFxaa=void 0===l?this._hasTriangles:l,e.useGrain=this._model.isEffectiveGrain(),e.useSharpen=this._model.isEffectiveSharpen(),e.useVignette=this._model.isEffectiveVignette(),e.useTransparency=t||e.webVR||Object(u.a)(),e.useSsr=this._model.isEffectiveSsr(),e.useRefraction=r,e.useDepth=this._needDepthTexture(),e.useExtra=i||e.webVR||e.AR,v.a.set("hasSsr",e.useSsr),this._effectiveConfig},_needDepthTexture:function(){if(Object(u.a)())return!0;var e=this._effectiveConfig;if(e.useRefraction||e.useSsr||e.useDof||e.useBloom||e.useSharpen||e.useSsao||e.useSss||e.useTaa||!e.useFxaa)return!0;if(this._viewer.getFeatures().hotspot.getModel().get("hotspots").length>0)return!0;var t=this.getBackgroundType();return"none"===t||"fixed"===t||this._model.get("webVR")},_addInternalTextures:function(e,t,i){e.addInternalTexture({name:"TextureOpaque",immuable:!0,srgb:i,rgbm:!i}),e.setInputTexture("TextureOpaque"),(t.useRefraction||t.useSsr)&&e.addInternalTexture({name:"TextureToBeRefracted",divisor:Object(a.a)().refractionRes,immuable:!0,reusable:!1,srgb:!1,rgbm:!0}),t.useRefraction&&e.addInternalTexture({name:"TextureRefraction",immuable:!0,srgb:!1,rgbm:!0}),(t.useSsr||t.useSsao)&&e.addInternalTexture({name:"TextureMipmapDepth",immuable:!0,reusable:!1,srgb:!1,rgbm:!1}),t.useDepth&&e.addInternalTexture({name:"TextureDepth",filter:"nearest",immuable:!0,srgb:!1,rgbm:!1}),t.useTransparency&&e.addInternalTexture({name:"TextureTransparent",filter:"nearest",immuable:!0,type:this._getSupportedFloatTexture(),rgbm:!1,srgb:!1}),t.useExtra&&e.addInternalTexture({name:"TextureExtra",filter:"nearest",immuable:!0,srgb:!t.webVR,rgbm:!1})},_addSss:function(e,t){var i=this._getSupportedFloatTexture();t.addExternalTexture("TextureSSSKernel",this._view3d._sssTexKernel),e.push({func:"sssExtract",textures:[{name:"%last",uniformName:"TextureSSSColor"},"TextureDepth"],out:{name:"TextureSSSExtract",rgbm:!1,divisor:2,type:i,filter:"linear"}});var r=[];r.push("#define SSS_HALF_KERNEL_SIZE "+Object(a.a)().sssHalfKernel),r.push("#define SSS_PROFILE_COUNT "+this._model.get("sssProfiles").length),r.push("#define SSS_JITTER "+Object(a.a)().sssJitter.toExponential());var n=this._model.useSSSLookupFloat(),o=n?"1.0":this._model.getSSSWeightRange().toExponential();r.push("#define SSS_BYTE_RANGE "+o);var s=je.Uniform.createFloat2(je.vec2.fromValues(0,1),"uBlurDir");e.push({func:"sssBlur",header:r,textures:[{name:"TextureSSSExtract",uniformName:"TextureSSSBlur"},"TextureDepth","TextureSSSKernel"],uniforms:s,out:{name:"TextureSSSBlur1",divisor:2,type:i,rgbm:!1,filter:"linear"}});var u=je.Uniform.createFloat2(je.vec2.fromValues(1,0),"uBlurDir");e.push({func:"sssBlur",header:r,textures:[{name:"TextureSSSBlur1",uniformName:"TextureSSSBlur"},"TextureDepth","TextureSSSKernel"],uniforms:u,out:{name:"TextureSSSBlur2",divisor:2,rgbm:!0,filter:"linear"}}),e.push({func:"sssCombine",textures:[{name:"TextureSSSBlur2",uniformName:"TextureSSSBlur"},{name:"%last",uniformName:"TextureSSSColor"},"TextureDepth"],out:{name:"%next"}})},_packMipmapDepth:function(e){for(var t=je.Uniform.createInt(1,"uFirstDepth"),i=je.Uniform.createInt(0,"uFirstDepth"),r=1;r<=5;r++){var a=1<<r+1,n=1===r?"TextureDepth":"TextureDepth"+(r-1),o="TextureDepth"+r;e.push({func:"depthMipmap",textures:[{name:n,uniformName:"TextureDepth"}],uniforms:1===r?t:i,out:{name:o,divisor:a,filter:"linear"}})}e.push({func:"packMipmapDepth",textures:[{name:"TextureDepth",uniformName:"TextureDepth0"},"TextureDepth1","TextureDepth2","TextureDepth3","TextureDepth4","TextureDepth5"],out:{name:"TextureMipmapDepth",filter:"linear"}})},_addSsao:function(e){var t=["#extension GL_OES_standard_derivatives : enable"],i=[t];Object(a.a)().ssaoNormal&&i.push("#define SSAO_NORMAL"),d.a.any&&i.push("#define MOBILE"),e.push({func:"ssaoExtract",header:i,textures:"TextureMipmapDepth",out:{name:"TextureSsaoExtract",filter:"linear"}}),e.push({func:{name:"ssaoBlurH",file:"ssaoBlur.glsl"},header:"#define SSAO_BLUR_H",textures:{name:"TextureSsaoExtract",uniformName:"TextureBlurInput"},out:{name:"TextureSsaoBlurH",filter:"nearest"}}),e.push({func:{name:"ssaoBlurV",file:"ssaoBlur.glsl"},header:"#define SSAO_BLUR_V",textures:[{name:"%last",filter:"linear"},{name:"TextureSsaoBlurH",uniformName:"TextureBlurInput"}],out:{name:"%next"}})},_addCombineOpacity:function(e){e.push({func:"combineOpacity",textures:[{name:"%last",filter:"nearest"},"TextureTransparent"],out:{name:"%next"},collapsible:!0})},_packMipmapColor:function(e,t,i){var r=this._addFixedBackgroundRefraction(e,t,i),a=[3,5,7,9,11,13,15];return Object(_.a)(e,r,"TextureRefractionBlur",a,!0),e.push({func:"packMipmapRefraction",textures:[{name:r,uniformName:"TextureRefractionBlur0"},"TextureRefractionBlur1","TextureRefractionBlur2","TextureRefractionBlur3","TextureRefractionBlur4","TextureRefractionBlur5","TextureRefractionBlur6","TextureRefractionBlur7"],out:{name:"TextureToBeRefracted",filter:"linear"}}),e.length},_addRefraction:function(e){e.push({func:"combineRefraction",textures:["%last","TextureRefraction"],out:{name:"%next"}})},_addDof:function(e){var t=Object(a.a)().dofRes;e.push({func:"dofCoC",textures:"TextureDepth",out:{name:"TextureDofCoC",divisor:t,filter:"nearest"}}),e.push({func:{name:"dofNearDilateH",file:"dofNearDilate.glsl"},textures:["TextureDofCoC","TextureDepth"],out:{name:"TextureDofNearDilateH",divisor:t,filter:"linear"}}),e.push({func:{name:"dofNearDilateV",file:"dofNearDilate.glsl"},textures:[{name:"TextureDofNearDilateH",uniformName:"TextureDofCoC"},"TextureDepth"],out:{name:"TextureDofNearDilateV",divisor:t,filter:"nearest"}});var i=this._getSupportedFloatTexture()===je.Texture.HALF_FLOAT,r=i?"#define COLOR_WITH_COC":"",n=["%last"];i&&n.push({name:"TextureDofNearDilateV",uniformName:"TextureDofCoC"}),e.push({func:"dofDownsampleColor",header:r,textures:n,out:{name:"TextureDofDownsampleColor",divisor:t,filter:"nearest",type:i?je.Texture.HALF_FLOAT:je.Texture.UNSIGNED_BYTE}});var o=[{name:"TextureDofDownsampleColor",uniformName:"TextureDofColor",rgbm:!i}];i||o.push({name:"TextureDofNearDilateV",uniformName:"TextureDofCoC"}),e.push({func:"dofBlurCircular",header:r,textures:o,out:{name:"TextureDofBlurCircular",divisor:t,filter:"linear",rgbm:!0}}),e.push({func:"dofCombine",textures:[{name:"%last",filter:"linear"},"TextureDofBlurCircular","TextureDofNearDilateV","TextureDepth"],out:{name:"%next"}})},_addBloom:function(e,t){var i,r=["%last"];t.hasBG&&(i="#define HAS_BACKGROUND",r.push("TextureDepth")),e.push({func:"bloomExtract",textures:r,header:i,out:{name:"TextureBloomExtract",filter:"linear"}});var a=[3,5,7,9,11];Object(_.a)(e,"TextureBloomExtract","TextureBloomBlur",a),e.push({func:"bloomCombine",textures:[{name:"%last"},"TextureBloomBlur1","TextureBloomBlur2","TextureBloomBlur3","TextureBloomBlur4","TextureBloomBlur5"],out:{name:"%next"}})},_addMergeable:function(e,t){if(t.useChromaticAberration&&e.push({func:"chromaticAberration",textures:[{name:"%last",filter:"nearest"}],out:{name:"%next"}}),t.useColorBalance&&e.push({func:"colorBalance",textures:[{name:"%last",filter:"nearest"}],out:{name:"%next"},collapsible:!0}),t.useToneMapping){var i=[{name:"%last",filter:"nearest"}],r="";"fixed"!==t.bgType||t.useRefraction||t.useSsr||(r="#define HAS_FIXED_BACKGROUND",i.push("TextureDepth")),e.push({func:"toneMapping",header:r,textures:i,out:{name:"%next"},collapsible:!0})}t.webVR&&t.useExtra&&(e.push({func:"veilVr",textures:"%last",out:{name:"%next",filter:"nearest"},collapsible:!0}),e.push({func:"composeExtra",header:"#define LINEAR_EXTRA",textures:["%last","TextureExtra"],out:{name:"%next",filter:"nearest"},collapsible:!0}))},_addSuperSample:function(e,t){if(t.hasBG||(e.push({func:"setDepthAlpha",textures:["%last","TextureDepth"],out:{name:"%next"},collapsible:!0}),!t.AR)){if(!t.useTaa)return void e.push({func:"supersample",textures:[{name:"%last",filter:"linear",rgbm:!1,srgb:!0},"%previous"],out:{name:"%next",filter:"linear"}});var i=[];t.useTaaTransparent&&i.push("#define TAA_TRANSPARENT"),i.push("#define FEEDBACK_MIN "+Object(a.a)().taaFeedbackMin),i.push("#define FEEDBACK_MAX "+Object(a.a)().taaFeedbackMax),m.a.vrConfig.doVR&&i.push("#define VR_ENABLED"),e.push({func:"supersampleTaa",textures:[{name:"%last",filter:"linear",rgbm:!1,srgb:!0},"%previous","TextureDepth"],header:i,out:{name:"%next",filter:"linear"}})}},_addFinalPass:function(e,t){var i=[],r=[{name:"%last",filter:"linear",srgb:!0,rgbm:!1}];t.useDistortionVR&&i.push("#define VR_DISTORTION"),t.useFxaa?e.push({func:"fxaa",header:i,textures:r,out:{name:"%next"}}):e.push({func:"passThrough",header:i,textures:r,out:{name:"%next"}}),t.useSharpen&&(i=[],r=["%last"],t.hasBG&&(i.push("#define HAS_BACKGROUND"),r.push("TextureDepth")),e.push({func:"sharpen",header:i,textures:r,out:{name:"%next"},collapsible:!0})),t.useVignette&&e.push({func:"vignette",textures:[{name:"%last",filter:"nearest"}],out:{name:"%next"},collapsible:!0}),t.useGrain&&e.push({func:"grain",textures:"%last",out:{name:"%next"},collapsible:!0}),t.useDof&&e.push({func:"dofCross",textures:"%last",out:{name:"%next"},collapsible:!0}),t.webVR?e.push({func:"fadeVr",textures:"%last",out:{name:"%next"},collapsible:!0}):t.useExtra&&e.push({func:"composeExtra",textures:["%last","TextureExtra"],out:{name:"%next"},collapsible:!0})},_addFixedBackground:function(e,t,i){if("fixed"===t.bgType){var r=this.getNodeBackground().getBackground(),a=r||c.a.dummyTexture;a.divisor=-1,i.addExternalTexture("TextureFixed",a);var n=["%last","TextureFixed","TextureDepth"],o=[];t.useRefraction&&(n.push("TextureRefraction"),o.push("#define REFRACTION_COMPOSITING_EXCLUSION")),e.push({func:"composeFixedBackground",header:o,textures:n,uniforms:[g.a.scale],out:{name:"%next"},collapsible:!0})}},_addFixedBackgroundRefraction:function(e,t,i){if(!t.useRefraction||"fixed"!==t.bgType)return"%last";var r=this.getNodeBackground().getBackground(),a=r||c.a.dummyTexture;return a.divisor=-1,i.addExternalTexture("TextureFixed",a),e.push({func:{name:"composeFixedBackgroundRefraction",file:"composeFixedBackground.glsl"},textures:["%last","TextureFixed","TextureDepth"],uniforms:[g.a.scale],out:{name:"TextureWithBackground"}}),"TextureWithBackground"},_addPassThrough:function(e){e.push({func:"passThrough",textures:"%last",out:{name:"%next"}})},_createComposer:function(){var e=this._updateEffectiveConfig(),t=this._composer||new Ge.ComposerPostProcess;void 0===this._composer&&this._initComposer(t),t.clear();var i=[],r=e.useSsr&&Object(a.a)().depthMipmap||e.useSsao,n=e.useSsr||e.useRefraction,o=0;r&&this._packMipmapDepth(i),e.useSsao&&this._addSsao(i),e.useSss&&this._addSss(i,t),e.useTransparency&&this._addCombineOpacity(i),n&&(o=this._packMipmapColor(i,e,t)),e.useRefraction&&this._addRefraction(i,e,t),e.useDof&&this._addDof(i),e.useBloom&&this._addBloom(i,e),this._addMergeable(i,e),this._addFixedBackground(i,e,t),o>0&&i.length===o&&this._addPassThrough(i);var s=0===i.length;if(this._addSuperSample(i,e),this._addFinalPass(i,e),this._addInternalTextures(t,e,s),t.build(i),this._assignInternalTextureToCamera(),y.a.uOutputLinear.setInt(s?0:1),y.a.uRGBMRange.setFloat(s?-1:this._model.get("rgbmDefault")),this.onBackgroundColor(),e.useRefraction||e.useSsr){var u=this.getOrCreateStateSet(),l=t.getInternalTexture("TextureToBeRefracted");u.setTextureAttributeAndModes(5,l),u.addUniform(je.Uniform.createInt(5,"uTextureToBeRefracted")),l=Object(a.a)().depthMipmap?t.getInternalTexture("TextureMipmapDepth"):t.getInternalTexture("TextureDepth"),u.setTextureAttributeAndModes(4,l),u.addUniform(je.Uniform.createInt(4,"uTextureMipmapDepth"))}},_assignInternalTextureToCamera:function(){var e=this._composer,t=this._effectiveConfig,i=this._camera;i._textureOpaque=e.getInternalTexture("TextureOpaque"),t.useDepth&&(i._textureDepth=e.getInternalTexture("TextureDepth")),t.useTransparency&&(i._textureTransparent=e.getInternalTexture("TextureTransparent")),t.useRefraction&&(i._textureRefraction=e.getInternalTexture("TextureRefraction")),t.useExtra&&(i._textureExtra=e.getInternalTexture("TextureExtra"))},_resizeMipmapHeight:function(e,t,i){var r=e.getInternalTexture(t);if(r){var a=e._screenWidth,n=e._screenHeight,o=e._getTextureSize(a,r.divisor),s=e._getTextureSize(n,.5*r.divisor);r.setTextureSize(o,s);var u=e.getStateSetPass(i);if(u){u.getUniform("uTextureOutputSize").getInternalArray()[1]=s;for(var l=e.getCameras(),c=0;c<l.length;++c){var h=l[c];if(h.getName()===t)return void h.getViewport().setViewport(0,0,o,s)}}}},_hookComposerResize:function(e){var t=this,i=Ge.ComposerPostProcess.prototype;e.resizeRatio=function(r,a,n,o){i.resizeRatio.call(e,r,a,n,o),t._resizeMipmapHeight(e,"TextureToBeRefracted","packMipmapRefraction"),t._resizeMipmapHeight(e,"TextureMipmapDepth","packMipmapDepth")}},_initComposer:function(e){e.setScreenSize(this._viewerOSGJS.getCanvasWidth(),this._viewerOSGJS.getCanvasHeight()),e.setMethodWrapUV(1,1),this._hookComposerResize(e),this._viewer.bind("resizeCanvas",e.resize,e),this._viewer.bind("resizeRatio",e.resizeRatio,e),e.setNodeMask(n.a.NO_PICK_NO_SHADOW),e.setName("PostProcess - Composer"),this.addChild(e),this._composer=e;var t=e.getOrCreateStateSet();for(var i in b.a)t.addUniform(b.a[i])},resetCameraAttachments:function(){var e=this._camera;e.resetAttachments(),e.fboOpaque&&(e.fboOpaque.reset(),e.fboOpaque=void 0),e.fboTransparent&&(e.fboTransparent.reset(),e.fboTransparent=void 0),e.fboRefraction&&(e.fboRefraction.reset(),e.fboRefraction=void 0),e.fboDepth&&(e.fboDepth.reset(),e.fboDepth=void 0),e.fboExtra&&(e.fboExtra.reset(),e.fboExtra=void 0),e.attachRenderBuffer(je.FrameBufferObject.DEPTH_ATTACHMENT,je.FrameBufferObject.DEPTH_COMPONENT16)},createPathStandard:function(){if(this._createComposer(),this.resetCameraAttachments(),Object(a.a)().stats){var e=this._composer.getCameras();e[e.length-1].setRenderOrder(je.Camera.POST_RENDER,0);var t,i=[];for(t=0;t<e.length;t++){var r=e[t].getName();-1===r.indexOf("FeedbackTexture")&&i.push(r)}this._viewer.setOptionStatsPostProcess(i);var n=s.a.getTimerGPU();for(t=0;t<e.length;++t){var o=e[t],u=o.getName();o.setInitialDrawCallback(n.start.bind(n,u)),o.setFinalDrawCallback(n.end.bind(n,u))}this._camera.setFinalDrawCallback(function(){n.start("PostProcess")});var l=this._viewerOSGJS.getCamera();l.setInitialDrawCallback(n.start.bind(n,"Total GL")),l.setFinalDrawCallback(function(){n.end("PostProcess"),n.end("Total GL")})}}}),"osgSketchfab","PostProcess"),t.a=He},function(e,t,i){"use strict";var r=i(5),a=i(107),n=r.a.osg,o=a.a.getShaderProcessor(),s={pascalCache:[[1]],getOrCreatePascalCoefficients:function(e){e=void 0===e?5:Math.min(e,128);var t=s.pascalCache;if(t[e])return t[e];for(var i=t.length-1;i<e;i++){var r=t[i],a=r.length,n=new Array(a);n[0]=1,n[a]=1;for(var o=i===t.length-1?Math.pow(2,i):1,u=0;u<a-1;u++)n[u+1]=(r[u]+r[u+1])*o;o=Math.pow(2,i+1);for(var l=0;l<a+1;l++)n[l]/=o;t.push(n)}return t[e]}},u=function(e){var t=e.toString();return-1===t.indexOf(".")?t+".0":t},l=function(e,t){var i=.005/e,r=e,a=s.getOrCreatePascalCoefficients(r),n=Math.floor(r/2),o=[],l=u(a[n]);n+1>=e&&(l="1.0");var c=1;o.push("vec3 pixel = "+l+" * %fetch(gTexCoord.xy).rgb;"),o.push("vec2 offset;"),o.push("vec2 blurDir = uPixelRatio.xy * uBlurDir.xy / uTextureOutputSize.xy;"),t&&o.push("blurDir *= uGlobalTexSize.y * 0.00075;");var h;for(h=n+1;h<e;h+=2){var d=a[h],p=a[h+1],f=d+p;if(f<i)break;var m=(c*d+(c+1)*p)/f;o.push("offset = blurDir * "+u(m)+";"),l=u(f),o.push("pixel += "+l+" * %fetch(gTexCoord.xy + offset.xy).rgb;"),o.push("pixel += "+l+" * %fetch(gTexCoord.xy - offset.xy).rgb;"),c+=2}o.push("return vec4(pixel, 1.0);");for(h=0;h<o.length;++h)o[h]="    "+o[h].replace("%fetch","TEXTURE_2D_TextureBlurInput");return["uniform sampler2D TextureBlurInput;","uniform vec2 uTextureOutputSize;","uniform vec2 uPixelRatio;","uniform vec2 uBlurDir;",t?"uniform vec2 uGlobalTexSize;\n":"","vec4 gaussianBlur() {",o.join("\n"),"}"].join("\n")},c=function(e,t,i,r,a){for(var s=2,u=n.Uniform.createFloat2(n.vec2.fromValues(0,1),"uBlurDir"),c=n.Uniform.createFloat2(n.vec2.fromValues(1,0),"uBlurDir"),h={},d=t,p=0;p<r.length;p++){var f=r[p]+1,m="gaussianBlur"+p;o.hasShader[m]||(h[m]=l(f,a)),e.push({func:{name:"gaussianBlur",file:m},uniforms:u,textures:{name:d,uniformName:"TextureBlurInput"},out:{name:"TextureBlurTemp"+p,divisor:s,filter:"linear"}}),d=i+(p+1),e.push({func:{name:"gaussianBlur",file:m},uniforms:c,textures:{name:"TextureBlurTemp"+p,uniformName:"TextureBlurInput"},out:{name:d,divisor:s,filter:"linear"}}),s*=2}o.addShaders(h)};t.a=c},function(e,t){e.exports='#ifdef VR_DISTORTION\nuniform vec2 uDistortion;\nuniform vec4 uProjectionLeft;\nuniform vec4 uUnprojectionLeft;\n\n#pragma include "distortion.glsl"\n#endif\n\nuniform sampler2D TextureInput;\n\nvec4 passThrough() {\n#ifdef VR_DISTORTION\n    gTexCoord = distortion(gTexCoord);\n#endif\n\n    return TEXTURE_2D_TextureInput(gTexCoord);\n}'},function(e,t){e.exports='#pragma include "sketchfabFunctions.glsl"\n\nuniform sampler2D TextureInput;\nuniform sampler2D TextureDepth;\n\n// no background scenario\nvec4 setDepthAlpha(const in vec4 color) {\n    float alpha = decodeAlpha(TEXTURE_2D_TextureDepth(gTexCoord));\n    return vec4(color.rgb, alpha);\n}'},function(e,t){e.exports="uniform sampler2D TextureTransparent;\n\nvec4 combineOpacity(const in vec4 color) {\n\t// should be replaced with TEXTURE_2D_TextureTransparent as is can make sense\n    vec4 transparent = TEXTURE_2D_TextureTransparent(gTexCoord);\n    return vec4(color.rgb * (1.0 - transparent.a) + transparent.rgb, 1.0);\n}"},function(e,t){e.exports="uniform sampler2D TextureInput;\nuniform sampler2D TextureRefraction;\n\nuniform vec2 uTextureRefractionSize;\nuniform vec2 uTextureRefractionRatio;\nuniform float uRGBMRange;\n\nvec4 combineRefraction() {\n    // manual fetch to check m value of rgba : we use m 0 (invalid of rgbm) as masking\n    vec2 uv = min(gTexCoord, 1.0 - 1.0 / uTextureRefractionSize.xy);\n    vec4 rgbmRefraction = texture2D(TextureRefraction, uv * uTextureRefractionRatio);\n\n    vec4 background = TEXTURE_2D_TextureInput(gTexCoord);\n    if (rgbmRefraction.a == 0.0) return background;\n    return vec4(decodeRGBM(rgbmRefraction, uRGBMRange), 1.0);\n}"},function(e,t){e.exports="uniform sampler2D TextureRefractionBlur0;\nuniform sampler2D TextureRefractionBlur1;\nuniform sampler2D TextureRefractionBlur2;\nuniform sampler2D TextureRefractionBlur3;\nuniform sampler2D TextureRefractionBlur4;\nuniform sampler2D TextureRefractionBlur5;\nuniform sampler2D TextureRefractionBlur6;\nuniform sampler2D TextureRefractionBlur7;\nuniform vec2 uTextureOutputRatio;\n\nvec4 packMipmapRefraction() {\n    vec4 result = vec4(0.0, 0.0, 0.0, 1.0);\n\n    // see _hookComposerResize in NodePostProcess.js (mipmap)\n    gTexCoord.y /= uTextureOutputRatio.y;\n\n    float levelLog = -log2(1.0 - gTexCoord.y) + 1.0;\n    float level = floor(levelLog) - 1.0;\n\n    float pLevel = pow(2.0, level + 1.0); // 2, 4, 8, 16...\n    gTexCoord.x = pLevel * gTexCoord.x * 0.5;\n    gTexCoord.y = pLevel * (1.0 - gTexCoord.y) - 1.0;\n\n    // unused part of the texture\n    if (gTexCoord.x > 1.0 || gTexCoord.y > 1.0) return result;\n\n    if (level < 0.1) result.rgb = TEXTURE_2D_TextureRefractionBlur0(gTexCoord).rgb;\n    else if (level < 1.1) result.rgb = TEXTURE_2D_TextureRefractionBlur1(gTexCoord).rgb;\n    else if (level < 2.1) result.rgb = TEXTURE_2D_TextureRefractionBlur2(gTexCoord).rgb;\n    else if (level < 3.1) result.rgb = TEXTURE_2D_TextureRefractionBlur3(gTexCoord).rgb;\n    else if (level < 4.1) result.rgb = TEXTURE_2D_TextureRefractionBlur4(gTexCoord).rgb;\n    else if (level < 5.1) result.rgb = TEXTURE_2D_TextureRefractionBlur5(gTexCoord).rgb;\n    else if (level < 6.1) result.rgb = TEXTURE_2D_TextureRefractionBlur6(gTexCoord).rgb;\n    else if (level < 7.1) result.rgb = TEXTURE_2D_TextureRefractionBlur7(gTexCoord).rgb;\n\n    return result;\n}\n"},function(e,t){e.exports='#pragma include "sketchfabFunctions.glsl"\n\n// blur jimenez\n// https://github.com/iryoku/separable-sss/blob/master/SeparableSSS.h#L454\n\n// blur UE4 (based on jimenez)\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/SeparableSSS.usf\n\n// UE 4 pre/post passes (down/upsample/checkerboard)\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/PostProcessSubsurface.usf\n\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Common.usf#L501\n// also solution 2 of http://stackoverflow.com/questions/596216/formula-to-determine-brightness-of-rgb-color\nfloat luminanceLinear(const in vec3 color) {\n    return dot(color, vec3(0.3, 0.59, 0.11));\n}\n\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/PostProcessSubsurface.usf#L247\nvoid uncheckerboard(out vec3 diffuse, out vec3 specular) {\n    vec2 coordCenter = floor(gTexCoord * uTextureSSSColorSize) + 0.5;\n    vec2 uvCenter = coordCenter / uTextureSSSColorSize;\n\n    vec3 offset = vec3(1.0 / uTextureSSSColorSize.xy, 0.0);\n    vec3 A = TEXTURE_2D_TextureSSSColor(uvCenter + offset.xz).rgb;\n    vec3 B = TEXTURE_2D_TextureSSSColor(uvCenter - offset.xz).rgb;\n    vec3 C = TEXTURE_2D_TextureSSSColor(uvCenter + offset.zy).rgb;\n    vec3 D = TEXTURE_2D_TextureSSSColor(uvCenter - offset.zy).rgb;\n\n    // Luminance could be green channel only\n    float a = luminanceLinear(A);\n    float b = luminanceLinear(B);\n    float c = luminanceLinear(C);\n    float d = luminanceLinear(D);\n\n    float ab = abs(a - b);\n    float cd = abs(c - d);\n\n    // take the average in the direction that avoids dither pattern\n    vec3 quant1 = 0.5 * mix(A + B, C + D, ab > cd ? 1.0 : 0.0);\n    vec3 quant0 = TEXTURE_2D_TextureSSSColor(uvCenter).rgb;\n\n    float checker = checkerboard(coordCenter, uHalton);\n    diffuse = mix(quant1, quant0, checker);\n    specular = mix(quant0, quant1, checker);\n}\n'},function(e,t){e.exports='#pragma include "sketchfabFunctions.glsl"\n\nuniform sampler2D TextureSSSColor;\nuniform sampler2D TextureDepth;\nuniform vec2 uTextureSSSColorSize;\n\nuniform vec4 uHalton;\n\n#pragma include "sssCommon.glsl"\n\n// hacky line to force the composerPostprocess to\n// hook texture funciton in sssCommon because pragma defines\n// aren\'t handled directly\n\n// TEXTURE_2D_TextureSSSColor(whatever)\nvec4 sssExtract() {\n    vec4 pack = TEXTURE_2D_TextureDepth(gTexCoord);\n    vec3 specular;\n    vec3 diffuse;\n    uncheckerboard(diffuse, specular);\n\n    // force depth "0" to tell sss blur to skip the pixel when blurring\n    float bgOrNotSSS = decodeProfile(pack) == 0 || pack.x == 1.0 ? 0.0 : 1.0;\n\n    return vec4(diffuse, bgOrNotSSS * decodeDepth(pack));\n}\n'},function(e,t){e.exports='#pragma include "functions.glsl"\n#pragma include "sketchfabFunctions.glsl"\n#pragma include "rand.glsl"\n\nuniform sampler2D TextureSSSBlur;\nuniform sampler2D TextureDepth;\nuniform sampler2D TextureSSSKernel;\n\nuniform vec2 uNearFar;\n\nuniform vec2 uBlurDir;\nuniform float uProjFactor;\nuniform float uScatteringFactorPacker;\nuniform float uFrameModTaaSS;\n\n#ifndef SSS_JITTER\n#define SSS_JITTER 1.0\n#endif\n\n#ifndef SSS_HALF_KERNEL_SIZE\n#define SSS_HALF_KERNEL_SIZE 11\n#endif\n\n#ifndef SSS_PROFILE_COUNT\n#define SSS_PROFILE_COUNT 1\n#endif\n\n#define SSS_FOLLOW_SURFACE\n\n// if we want to do it branchless\nvec3 sssFetchColorBranchless(const in vec2 uv, const in vec4 colorM, const in float depthNormBias){\n    vec4 fetch = TEXTURE_2D_TextureSSSBlur(uv);\n\n#ifdef SSS_FOLLOW_SURFACE\n    float mixer = smoothstep(0.0, 0.05, abs(colorM.a - fetch.a) * depthNormBias);\n    mixer = mix(mixer, 1.0, step(fetch.a, 0.0)); // force to 1 if fetch.a is 0 (background)\n    fetch.rgb = mix(fetch.rgb, colorM.rgb, mixer);\n#endif\n\n    // uv inside box\n    // https://stackoverflow.com/questions/12751080/glsl-point-inside-box-test\n    vec2 s = step(vec2(0.0), uv) - step(vec2(1.0), uv);\n    return mix(colorM.rgb, fetch.rgb, s.x * s.y);\n}\n\nvec3 sssFetchColor(const in vec2 uv, const in vec4 colorM, const in float depthNormBias){\n    if (uv.x < 0.0 || uv.y < 0.0 || uv.x > 1.0 || uv.y > 1.0) {\n        return colorM.rgb;\n    }\n\n    // ignore sss with big depth difference, original jimenez is clamp(dDiff, 0.0, 1.0)\n    // we use a much more aggressive function\n    vec4 fetch = TEXTURE_2D_TextureSSSBlur(uv);\n\n#ifdef SSS_FOLLOW_SURFACE\n    if (fetch.a == 0.0) return colorM.rgb;\n    return mix(fetch.rgb, colorM.rgb, smoothstep(0.0, 0.05, abs(colorM.a - fetch.a) * depthNormBias));\n#else\n    return fetch.rgb;\n#endif\n}\n\nvec4 sssBlur() {\n    vec4 colorM = TEXTURE_2D_TextureSSSBlur(gTexCoord);\n\n    vec4 pack = TEXTURE_2D_TextureDepth(gTexCoord);\n\n    // background or not sss stuffs\n    if (pack.x == 1.0) {\n        return colorM;\n    }\n\n    int profile = decodeProfile(pack);\n    float scatter = decodeScatter(pack);\n    if (scatter == 0.0) {\n        return colorM;\n    }\n\n    float scatterWorld = scatter / uScatteringFactorPacker;\n    float depthRange = (uNearFar.y - uNearFar.x);\n\n    // for follow surface\n    // factor to get a normalized depth difference depending of scatter but not of camera position\n    float depthNormBias = depthRange * 0.05 / scatterWorld;\n\n    float worldPos = uNearFar.x + depthRange * colorM.a;\n    // uScatteringFactorPacker is just a unpacking factor because subsurface factor \n    // is a world space value but written in 8 bit texture\n    vec2 finalStep = uBlurDir * uProjFactor * scatterWorld / worldPos;\n    finalStep *= 1.0 / 3.0;\n\n    float yProfile = 1.0 - (float(profile) - 0.5) / float(SSS_PROFILE_COUNT);\n    float xKernelSize = 1.0 / float(SSS_HALF_KERNEL_SIZE);\n\n    vec3 kernel0 = texture2D(TextureSSSKernel, vec2(xKernelSize * 0.5, yProfile)).rgb;\n    vec3 colorBlurred = colorM.rgb * kernel0;\n\n    // force nearest sample for sss texture kernel color\n    vec2 offKernelNearest = vec2(0.5 * xKernelSize, 0.0);\n\n    // randomize the sss texture alpha weight a bit\n    float rnd = interleavedGradientNoise(gl_FragCoord.xy, uFrameModTaaSS);\n    rnd = mix(0.5, rnd, SSS_JITTER);\n    vec2 offKernelJitter = vec2(rnd * xKernelSize, 0.0);\n\n    for (int i = 1; i < SSS_HALF_KERNEL_SIZE; i++) {\n        vec2 uvKernel = vec2(float(i) * xKernelSize, yProfile);\n\n        vec3 kernel = texture2D(TextureSSSKernel, uvKernel + offKernelNearest).rgb;\n        float kernelDither = texture2D(TextureSSSKernel, uvKernel + offKernelJitter).a;\n\n        vec2 offset = kernelDither * finalStep;\n\n        vec3 fetch = sssFetchColor(gTexCoord + offset, colorM, depthNormBias);\n        fetch += sssFetchColor(gTexCoord - offset, colorM, depthNormBias);\n\n        colorBlurred += kernel.rgb * fetch;\n    }\n\n    return vec4(colorBlurred, colorM.a);\n}\n'},function(e,t){e.exports='#pragma include "sketchfabFunctions.glsl"\n\nuniform sampler2D TextureSSSColor;\nuniform vec2 uTextureSSSColorSize;\n\nuniform vec4 uHalton;\nuniform vec2 uNearFar;\nuniform float uProjFactor;\nuniform float uScatteringFactorPacker;\n\n#pragma include "sssCommon.glsl"\n\nuniform sampler2D TextureSSSBlur;\nuniform sampler2D TextureDepth;\n\nvec4 sssCombine() {\n    // full res - not SSS\n    vec4 pack = TEXTURE_2D_TextureDepth(gTexCoord);\n    int profile = decodeProfile(pack);\n    // black pixels for background or non sss surfaces\n    if (pack.x == 1.0 || profile == 0) {\n        return TEXTURE_2D_TextureSSSColor(gTexCoord);\n    }\n\n    vec3 specular;\n    vec3 diffuse;\n    uncheckerboard(diffuse, specular);\n\n    // try to retain high res detail as much as possible (same ad dof)\n    // make sure to use a factor that is independent from bounding box\n    float scatterWorld = decodeScatter(pack) / uScatteringFactorPacker;\n    float worldPos = uNearFar.x + (uNearFar.y - uNearFar.x) * decodeDepth(pack);\n    float factor = uProjFactor * scatterWorld / worldPos;\n    \n    // magic factor 10 (can be tweaked, e.g: if sss effects disappears too fast when we are far away)\n    factor = smoothstep(0.05, 0.3, factor * 10.0);\n    // return vec4(vec3(factor), 1.0);\n\n    diffuse = mix(diffuse, TEXTURE_2D_TextureSSSBlur(gTexCoord).rgb, factor);\n\n    return vec4(diffuse + specular, 1.0);\n}\n'},function(e,t){e.exports='#pragma include "sketchfabFunctions.glsl"\n\nuniform sampler2D TextureDepth0;\nuniform sampler2D TextureDepth1;\nuniform sampler2D TextureDepth2;\nuniform sampler2D TextureDepth3;\nuniform sampler2D TextureDepth4;\nuniform sampler2D TextureDepth5;\nuniform vec2 uTextureOutputRatio;\n\nvec4 packMipmapDepth() {\n    vec4 result = vec4(0.0, 0.0, 0.0, 0.0);\n\n    // see _hookComposerResize in NodePostProcess.js (mipmap)\n    gTexCoord.y /= uTextureOutputRatio.y;\n\n    float levelLog = -log2(1.0 - gTexCoord.y) + 1.0;\n    float level = floor(levelLog) - 1.0;\n\n    float pLevel = pow(2.0, level + 1.0); // 2, 4, 8, 16...\n    gTexCoord.x = pLevel * gTexCoord.x * 0.5;\n    gTexCoord.y = pLevel * (1.0 - gTexCoord.y) - 1.0;\n\n    // unused part of the texture\n    if (gTexCoord.x > 1.0 || gTexCoord.y > 1.0) return result;\n\n    if (level < 0.1) result.rgba = vec4(encode24(decodeDepth(TEXTURE_2D_TextureDepth0(gTexCoord))), 1.0);\n    else if (level < 1.1) result.rgba = TEXTURE_2D_TextureDepth1(gTexCoord);\n    else if (level < 2.1) result.rgba = TEXTURE_2D_TextureDepth2(gTexCoord);\n    else if (level < 3.1) result.rgba = TEXTURE_2D_TextureDepth3(gTexCoord);\n    else if (level < 4.1) result.rgba = TEXTURE_2D_TextureDepth4(gTexCoord);\n    else if (level < 5.1) result.rgba = TEXTURE_2D_TextureDepth5(gTexCoord);\n\n    return result;\n}\n'},function(e,t){e.exports='#pragma include "sketchfabFunctions.glsl"\n\nuniform sampler2D TextureDepth;\nuniform int uFirstDepth;\n\nuniform vec2 uTextureDepthSize;\nuniform vec2 uTextureOutputSize;\n\n// For some reasons it requires unpacking *and* repacking to avoid transition between mipmap\nvec4 depthMipmap() {\n    vec2 invSize = 1.0 / uTextureDepthSize;\n    vec4 depths;\n    vec2 offDepth = vec2(0.25, -0.25);\n    if (uFirstDepth == 1) {\n        depths.x = decodeDepth(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.yy * invSize));\n        depths.y = decodeDepth(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.xy * invSize));\n        depths.z = decodeDepth(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.yx * invSize));\n        depths.w = decodeDepth(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.xx * invSize));\n    } else {\n        depths.x = decode24(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.yy * invSize).xyz);\n        depths.y = decode24(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.xy * invSize).xyz);\n        depths.z = decode24(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.yx * invSize).xyz);\n        depths.w = decode24(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.xx * invSize).xyz);\n    }\n\n    return vec4(encode24(min(min(depths.x, depths.y), min(depths.z, depths.w))), 1.0);\n}\n'},function(e,t){e.exports='#pragma include "functions.glsl"\n#pragma include "sketchfabFunctions.glsl"\n#pragma include "rand.glsl"\n\nuniform sampler2D TextureMipmapDepth;\nuniform vec2 uTextureMipmapDepthSize;\nuniform vec2 uTextureMipmapDepthRatio;\n\nuniform float uQuality; // mipmap usage\n\nuniform vec2 uTextureOutputSize;\n\nuniform float uSsaoRadius;\nuniform float uSsaoIntensity;\nuniform float uSsaoBias;\nuniform vec4 uSsaoProjectionInfo;\nuniform float uSsaoProjectionScale;\n\nuniform vec2 uNearFar;\n\nuniform float uFrameModTaaSS;\n\n// Constant used to scale the depth view value that is given to the blur pass\n#define MIN_RADIUS 1.0\n#define NB_SPIRAL_TURNS 3.0\n\nvec4 fetchDepthPackLevel(const in vec2 uv, const in float level){\n    float maxLod = 5.0;\n    float powLevel = pow(2.0, min(maxLod, floor(level)) + 1.0);\n    vec2 pixelSize = 2.0 * powLevel / uTextureMipmapDepthSize;\n\n    vec2 uvFetch = max(pixelSize, min(1.0 - pixelSize, uv));\n    uvFetch = vec2(2.0 * uvFetch.x, powLevel - 1.0 - uvFetch.y) * uTextureMipmapDepthRatio.xy / powLevel;\n\n    return texture2D(TextureMipmapDepth, uvFetch);\n}\n\nfloat fetchDepthLevel(const in vec2 uv, const in float level){\n    return decode24(fetchDepthPackLevel(uv, level).xyz);\n}\n\nfloat zValueFromScreenSpacePosition(const in float depth) {\n    return uNearFar.x + (uNearFar.y - uNearFar.x) * depth;\n}\n\nvec3 reconstructCSPosition(const in vec2 ssP, const in float z) {\n    return vec3((ssP.xy * uSsaoProjectionInfo.xy + uSsaoProjectionInfo.zw) * z, z);\n}\n\nvec3 getPosition(const in vec2 uv) {\n    return reconstructCSPosition(uv * uTextureOutputSize, zValueFromScreenSpacePosition(fetchDepthLevel(uv, 0.0)));\n}\n\n#define MAX_MIP_LEVEL 5\n// Determines at which point we should switch mip level\n// if number is too small (~3) will lead to flashing (bad variance as many taps give same pixel)\n// if number is too high, mip level are not used well and the cache is not used efficiently\n#define LOG_MAX_OFFSET 3\n\nvec3 getOffsetedPixelPos(\n    const in vec2 uv,\n    const in vec2 unitOffset,\n    const in float screenSpaceRadius) {\n\n    float mipLevel = clamp(floor(log2(screenSpaceRadius)) - float(LOG_MAX_OFFSET), 0.0, float(MAX_MIP_LEVEL));\n    vec2 uvOff = uv + floor(screenSpaceRadius * unitOffset) / uTextureOutputSize;\n\n    float d = zValueFromScreenSpacePosition(fetchDepthLevel(uvOff, mipLevel));\n    return reconstructCSPosition(uvOff * uTextureOutputSize, d);\n}\n\n#define PIOVER8 0.39269908169\nvec3 unpackNormal1(const in float pack1) {\n    float pack8 = floor(pack1 * 255.0);\n    float th = PIOVER8 * float(pack8 / 16.0);\n    float len = sqrt(mod(float(pack8), 16.0) / 15.001);\n    vec2 nv = vec2(cos(th), sin(th)) * len;\n    return -vec3(nv.x, nv.y, sqrt(max(0.0, 1.0 - nv.x * nv.x - nv.y * nv.y)));\n}\n\nvec3 unpackNormal2(const in vec2 pack2) {\n    vec3 nv = pack2.rgg * 2.0 - 1.0;\n    return -vec3(nv.x, nv.y, sqrt(max(0.0, 1.0 - nv.x * nv.x - nv.y * nv.y)));\n}\n\n#define SSAO_TAP_EXTRACT(id) screenSpaceRadius = (float(id) + 0.5) * (1.0 / nbSamples); \\\n    angle = screenSpaceRadius * (NB_SPIRAL_TURNS * 6.28) + randomAngle; \\\n    screenSpaceRadius = max(0.75, screenSpaceRadius * ssRadius); \\\n    offsetUnitVec = vec2(cos(angle), sin(angle)); \\\n    occludingPoint = getOffsetedPixelPos(uv, offsetUnitVec, screenSpaceRadius); \\\n    occludingPoint -= cameraSpacePosition; \\\n    vv = dot(occludingPoint, occludingPoint); \\\n    vn = dot(occludingPoint, normal); \\\n    contrib += max(1.0 - vv * invRadius2, 0.0) * max((vn - uSsaoBias) * inversesqrt(vv), 0.0); \\\n\n#define SSAO_DO_TAPS(void) SSAO_TAP_EXTRACT(offset + 0); \\\n    SSAO_TAP_EXTRACT(offset + 1); \\\n    SSAO_TAP_EXTRACT(offset + 2); \\\n    SSAO_TAP_EXTRACT(offset + 3); \\\n    SSAO_TAP_EXTRACT(offset + 4); \\\n    SSAO_TAP_EXTRACT(offset + 5); \\\n    SSAO_TAP_EXTRACT(offset + 6); \\\n    SSAO_TAP_EXTRACT(offset + 7); \\\n    SSAO_TAP_EXTRACT(offset + 8); \\\n    SSAO_TAP_EXTRACT(offset + 9); \\\n    SSAO_TAP_EXTRACT(offset + 10); \\\n    offset += 11; \\\n\n\nvec4 ssaoExtract() {\n    vec2 uv = gTexCoord;\n\n    vec3 depthPacked = fetchDepthPackLevel(uv, 0.0).xyz;\n\n    vec3 cameraSpacePosition = getPosition(uv);\n    float ssRadius = -uSsaoProjectionScale * uSsaoRadius / cameraSpacePosition.z;\n\n#ifdef SSAO_NORMAL\n    vec3 normal = unpackNormal2(TEXTURE_2D_TextureDepth(uv).ba); // g buffer normal 2 component on ba\n#elif defined(GL_OES_standard_derivatives) && !defined(MOBILE)\n    vec3 normal = cross(dFdy(cameraSpacePosition), dFdx(cameraSpacePosition));\n#else\n    vec2 offDepth = vec2(1.0, 0.0);\n    vec3 depthLeft = getPosition(uv - offDepth.xy / uTextureMipmapDepthSize);\n    vec3 depthRight = getPosition(uv + offDepth.xy / uTextureMipmapDepthSize);\n    vec3 depthBottom = getPosition(uv - offDepth.yx / uTextureMipmapDepthSize);\n    vec3 depthTop = getPosition(uv + offDepth.yx / uTextureMipmapDepthSize);\n    vec3 normal = cross(depthLeft - depthRight, depthTop - depthBottom);\n#endif\n\n    // early returns should be done derivatives usage to avoid bad edges\n\n    // early return background\n    if (depthPacked.x == 1.0) {\n        return vec4(depthPacked, 1.0);\n    }\n\n    // early return radius too small (note: needs to be in separate conditional because of nvidia/osx bug)\n    if (ssRadius < MIN_RADIUS) {\n        return vec4(depthPacked, 1.0);\n    }\n\n    normal = normalize(normal);\n    float nFalloff = mix(1.0, max(0.0, 1.5 * normal.z), 0.35);\n\n     // needs to be > 2PI\n    float randomAngle = 6.28 * interleavedGradientNoise(gl_FragCoord.xy, uFrameModTaaSS);\n   \n    float invRadius2 = 1.0 / (uSsaoRadius * uSsaoRadius);\n    float contrib = 0.0;\n\n    float vv;\n    float vn;\n    float screenSpaceRadius;\n    float angle;\n    vec3 occludingPoint;\n    vec2 offsetUnitVec;\n    int offset = 0;\n\n    float nbSamples = 11.0;\n    if (uQuality > 0.33) nbSamples += 11.0;\n    if (uQuality > 0.66) nbSamples += 11.0;\n\n    SSAO_DO_TAPS();\n    if (uQuality > 0.33) { SSAO_DO_TAPS(); }\n    if (uQuality > 0.66) { SSAO_DO_TAPS(); }\n\n    float aoValue = max(0.0, 1.0 - sqrt(contrib * nFalloff / nbSamples));\n    aoValue = pow(aoValue, 10.0 * uSsaoIntensity);\n\n    vec4 aoDepth;\n    aoDepth.rgb = depthPacked;\n    aoDepth.a = mix(1.0, aoValue, clamp(ssRadius - MIN_RADIUS, 0.0, 1.0));\n\n    return aoDepth;\n}\n'},function(e,t){e.exports='#pragma include "sketchfabFunctions.glsl"\n\nuniform sampler2D TextureBlurInput;\nuniform vec2 uTextureBlurInputSize;\n\n#define SSAO_FILTER_RADIUS 3\n\n#define SSAO_TAP_BLUR(id, absid) sampleTex = TEXTURE_2D_TextureBlurInput(uv + axis * float(id) * 2.0); \\\n    z = decode24(sampleTex.xyz); \\\n    weight = max(0.0, 1.0 - sharpnessFactor * abs(z - initialZ)) * (0.3 + gaussian[absid]); \\\n    sum += weight * sampleTex.a; \\\n    totalWeight += weight;\n\nvec4 ssaoBlur(const in vec2 axis) {\n    vec2 uv = gTexCoord;\n\n    vec4 aoDepth = TEXTURE_2D_TextureBlurInput(uv);\n\n    // background\n    if(aoDepth.x == 1.0){\n        return aoDepth;\n    }\n\n    float initialZ = decode24(aoDepth.xyz);\n\n    float gaussian[SSAO_FILTER_RADIUS + 2]; // dummy because of intel off-by-one bug\n    gaussian[0] = 0.153170;\n    gaussian[1] = 0.144893;\n    gaussian[2] = 0.122649;\n    gaussian[3] = 0.092902;\n    gaussian[4] = 0.0;\n\n    float totalWeight = gaussian[0];\n    float sum = aoDepth.a * totalWeight;\n    float sharpnessFactor = 400.0;\n\n    // ---- UNROLL ----\n    vec2 ofs;\n    float z;\n    float weight;\n    vec4 sampleTex;\n\n    SSAO_TAP_BLUR(-3, 3);\n    SSAO_TAP_BLUR(-2, 2);\n    SSAO_TAP_BLUR(-1, 1);\n    SSAO_TAP_BLUR(1, 1);\n    SSAO_TAP_BLUR(2, 2);\n    SSAO_TAP_BLUR(3, 3);\n    // ---- UNROLL ----\n\n    aoDepth.a = sum / totalWeight;\n    return aoDepth;\n}\n\n#ifdef SSAO_BLUR_H\nvec4 ssaoBlurH() {\n    return ssaoBlur(vec2(1.0, 0.0) / uTextureBlurInputSize);\n}\n#else\nvec4 ssaoBlurV() {\n    vec3 color = TEXTURE_2D_TextureInput(gTexCoord).rgb;\n    return vec4(color * ssaoBlur(vec2(0.0, 1.0) / uTextureBlurInputSize).aaa, 1.0);\n}\n#endif'},function(e,t){e.exports='#pragma include "sketchfabFunctions.glsl"\n\nconst float MAX_BLUR = 16.0;\nconst float EPS_EARLY_OUT = 0.01; // early out (typically when we move the camera fast and the dof might be not effective)\n\nfloat texDepthToCoC(const in vec4 fetch) {\n    // background should be always max blurred so that the near blur can expand onto the background (because of special dilate background codepath below)\n    if(fetch.x == 1.0) return max(uDofBlurNearFarFocal.x, uDofBlurNearFarFocal.y);\n\n    float coc = decodeDepth(fetch);\n    coc = clamp((coc - uDofBlurNearFarFocal.z) / coc, -1.0, 1.0);\n    return (coc < 0.0 ? coc * uDofBlurNearFarFocal.x : coc * uDofBlurNearFarFocal.y);\n}'},function(e,t){e.exports='uniform vec3 uDofBlurNearFarFocal;\n\n#pragma include "dofCommon.glsl"\n\nuniform sampler2D TextureDepth;\n\nvec4 dofCoC() {\n    if(uDofBlurNearFarFocal.x < EPS_EARLY_OUT && uDofBlurNearFarFocal.y < EPS_EARLY_OUT){\n        return vec4(0.0);\n    }\n\n    return vec4(vec3(0.0), texDepthToCoC(TEXTURE_2D_TextureDepth(gTexCoord)) * 0.5 + 0.5);\n}'},function(e,t){e.exports='uniform vec3 uDofBlurNearFarFocal;\n\n#pragma include "dofCommon.glsl"\n\nuniform sampler2D TextureDofCoC;\nuniform vec2 uTextureDofCoCSize;\nuniform sampler2D TextureDepth;\n\nuniform float uDofScale;\n\nvec4 dilateNear(const in vec2 offset) {\n    if(uDofBlurNearFarFocal.x < EPS_EARLY_OUT && uDofBlurNearFarFocal.y < EPS_EARLY_OUT){\n        return vec4(0.0);\n    }\n\n    // TODO DOF both the weights and the formula can be tweaked, also we could add a bit of jitter or something\n    vec2 uv = gTexCoord;\n    bool isBG = TEXTURE_2D_TextureDepth(uv).x == 1.0;\n\n    float coc = 0.0;\n    vec2 ofs = MAX_BLUR * offset / 5.0;\n\n    float coc0 = TEXTURE_2D_TextureDofCoC(uv).a * 2.0 - 1.0;\n    float coc1 = TEXTURE_2D_TextureDofCoC(uv - 5.0 * ofs).a * 2.0 - 1.0;\n    float coc2 = TEXTURE_2D_TextureDofCoC(uv - 4.0 * ofs).a * 2.0 - 1.0;\n    float coc3 = TEXTURE_2D_TextureDofCoC(uv - 3.0 * ofs).a * 2.0 - 1.0;\n    float coc4 = TEXTURE_2D_TextureDofCoC(uv - 2.0 * ofs).a * 2.0 - 1.0;\n    float coc5 = TEXTURE_2D_TextureDofCoC(uv - 1.0 * ofs).a * 2.0 - 1.0;\n    float coc6 = TEXTURE_2D_TextureDofCoC(uv + 1.0 * ofs).a * 2.0 - 1.0;\n    float coc7 = TEXTURE_2D_TextureDofCoC(uv + 2.0 * ofs).a * 2.0 - 1.0;\n    float coc8 = TEXTURE_2D_TextureDofCoC(uv + 3.0 * ofs).a * 2.0 - 1.0;\n    float coc9 = TEXTURE_2D_TextureDofCoC(uv + 4.0 * ofs).a * 2.0 - 1.0;\n    float coc10 = TEXTURE_2D_TextureDofCoC(uv + 5.0 * ofs).a * 2.0 - 1.0;\n\n    if(isBG == true){\n        // avoid "shrink" effect on the out of focus far part on the model edges\n        // gaussian weights (sigma 10), (doesn\'t have to be gaussian though), but the sum must be 1.0\n        // http://dev.theomader.com/gaussian-kernel-calculator/\n        coc = abs(coc0) * 0.095474 +\n        (abs(coc1) + abs(coc10)) * 0.084264 +\n        (abs(coc2) + abs(coc9)) * 0.088139 +\n        (abs(coc3) + abs(coc8)) * 0.091276 +\n        (abs(coc4) + abs(coc7)) * 0.093585 +\n        (abs(coc5) + abs(coc6)) * 0.094998;\n    } else {\n        // blur only near field (expand)\n        coc = min(coc0, 0.0);\n        coc = min(coc1 * 0.3, coc);\n        coc = min(coc2 * 0.5, coc);\n        coc = min(coc3 * 0.75, coc);\n        coc = min(coc4 * 0.8, coc);\n        coc = min(coc5 * 0.95, coc);\n        coc = min(coc6 * 0.95, coc);\n        coc = min(coc7 * 0.8, coc);\n        coc = min(coc8 * 0.75, coc);\n        coc = min(coc9 * 0.5, coc);\n        coc = min(coc10 * 0.3, coc);\n        if(abs(coc0) > abs(coc)) coc = coc0;\n    }\n\n    return vec4(0.0, 0.0, 0.0, coc * 0.5 + 0.5);\n}\n\nvec4 dofNearDilateH() {\n    vec2 offset = vec2(uDofScale / uTextureDofCoCSize.x, 0.0);\n    return dilateNear(offset);\n}\n\nvec4 dofNearDilateV() {\n    vec2 offset = vec2(0.0, uDofScale / uTextureDofCoCSize.y);\n    return dilateNear(offset);\n}'},function(e,t){e.exports="uniform sampler2D TextureInput;\n\n#ifdef COLOR_WITH_COC\nuniform sampler2D TextureDofCoC;\n#endif\n\nvec4 dofDownsampleColor() {\n    vec2 uv = gTexCoord;\n\n    vec4 color = TEXTURE_2D_NEAREST_TextureInput(uv);\n\n// premult with coc buffer\n#ifdef COLOR_WITH_COC\n    color.a = abs(TEXTURE_2D_TextureDofCoC(uv).a * 2.0 - 1.0);\n    color.a *= color.a * color.a;\n    color.rgb *= color.a;\n#endif\n\n    return color;\n}"},function(e,t){e.exports='#pragma include "rand.glsl"\n\nuniform vec3 uDofBlurNearFarFocal;\n#pragma include "dofCommon.glsl"\n\nuniform sampler2D TextureDofColor;\nuniform vec2 uTextureDofColorSize;\n\n#ifndef COLOR_WITH_COC\nuniform sampler2D TextureDofCoC;\nuniform vec2 uTextureDofCoCSize;\n#endif\n\nuniform float uDofScale;\nuniform float uQuality;\n\nuniform float uFrameModTaaSS;\n\n#ifdef COLOR_WITH_COC\n#define DOF_TAP(id) ofs = fTaps_Poisson[id]; \\\n                    ofs = gTexCoord + blurDist * vec2(dot(ofs, basis.xy), dot(ofs, basis.zw) ); \\\n                    sumcol += TEXTURE_2D_TextureDofColor(ofs);\n#else\n#define DOF_TAP(id) ofs = fTaps_Poisson[id]; \\\n                    ofs = gTexCoord + blurDist * vec2(dot(ofs, basis.xy), dot(ofs, basis.zw) ); \\\n                    cocWeight = abs(TEXTURE_2D_TextureDofCoC(ofs).a * 2.0 - 1.0); \\\n                    cocWeight *= cocWeight * cocWeight; \\\n                    sumcol.rgb += TEXTURE_2D_TextureDofColor(ofs).rgb * cocWeight; \\\n                    sumcol.a += cocWeight;\n#endif\n\nvec4 dofBlur16(const in vec2 blurDist, const in float ntime) {\n    float rnd = 6.28 * ditheringNoise(gl_FragCoord.xy, uFrameModTaaSS + ntime);\n\n    float cosa = cos(rnd);\n    float sina = sin(rnd);\n    vec4 basis = vec4(cosa, -sina, sina, cosa);\n\n    vec4 sumcol = vec4(0.0);\n\n    float total = 0.0;\n\n    vec2 fTaps_Poisson[17];\n    // https://github.com/bartwronski/PoissonSamplingGenerator\n    fTaps_Poisson[0] = vec2(0.343280198355, 0.921191856785);\n    fTaps_Poisson[1] = vec2(-0.116859107262, 0.873056831344);\n    fTaps_Poisson[2] = vec2(-0.646421287853, 0.760425284853);\n    fTaps_Poisson[3] = vec2(-0.0437332058416, 0.47196719804);\n    fTaps_Poisson[4] = vec2(0.48240473891, 0.464894594736);\n    fTaps_Poisson[5] = vec2(-0.718897237297, 0.352191304304);\n    fTaps_Poisson[6] = vec2(-0.939061387886, -0.0387376698953);\n    fTaps_Poisson[7] = vec2(0.546569494557, -0.0169516524446);\n    fTaps_Poisson[8] = vec2(-0.182644095652, -0.0702667761349);\n    fTaps_Poisson[9] = vec2(-0.576191305396, -0.252368997099);\n    fTaps_Poisson[10] = vec2(0.921914032366, -0.366530187909);\n    fTaps_Poisson[11] = vec2(-0.0582053944545, -0.510617206206);\n    fTaps_Poisson[12] = vec2(-0.783101528934, -0.601411360136);\n    fTaps_Poisson[13] = vec2(0.430604354377, -0.729559481383);\n    fTaps_Poisson[14] = vec2(-0.350716524868, -0.809522919973);\n    fTaps_Poisson[15] = vec2(0.0600898835968, -0.952568587297);\n    fTaps_Poisson[16] = vec2(0.0, 0.0); // dummy because of intel off-by-one bug\n\n    vec2 ofs;\n    vec4 sampleTex;\n    float cocWeight;\n\n    DOF_TAP(0);\n    DOF_TAP(1);\n    DOF_TAP(2);\n    DOF_TAP(3);\n    DOF_TAP(4);\n    DOF_TAP(5);\n    DOF_TAP(6);\n    DOF_TAP(7);\n    DOF_TAP(8);\n    DOF_TAP(9);\n    DOF_TAP(10);\n    DOF_TAP(11);\n    DOF_TAP(12);\n    DOF_TAP(13);\n    DOF_TAP(14);\n    DOF_TAP(15);\n\n    return sumcol;\n}\n\nvec4 dofBlurCircular() {\n    if(uDofBlurNearFarFocal.x < EPS_EARLY_OUT && uDofBlurNearFarFocal.y < EPS_EARLY_OUT) {\n        return vec4(0.0);\n    }\n\n    float factor = MAX_BLUR * uDofScale;\n\n#ifdef COLOR_WITH_COC\n    vec2 blurDist = factor * pow(TEXTURE_2D_TextureDofColor(gTexCoord).a, 0.333) / uTextureDofColorSize;\n#else\n    vec2 blurDist = factor * abs(TEXTURE_2D_TextureDofCoC(gTexCoord).a * 2.0 - 1.0) / uTextureDofCoCSize;\n#endif\n\n    // TODO optimize dofBlur16 (unroll...)\n    vec4 sumcol = dofBlur16(blurDist, 0.0); // 16\n    if (uQuality > 0.33) sumcol += dofBlur16(blurDist, 3.0); // 32\n    if (uQuality > 0.66) sumcol += dofBlur16(blurDist, 5.0); // 48\n\n    return vec4(sumcol.rgb / sumcol.a, 1.0);\n}\n'},function(e,t){e.exports='uniform vec3 uDofBlurNearFarFocal;\n\n#pragma include "dofCommon.glsl"\n\nuniform sampler2D TextureInput;\nuniform sampler2D TextureDofBlurCircular;\nuniform sampler2D TextureDofNearDilateV;\nuniform sampler2D TextureDepth;\n\nuniform vec2 uTextureDofNearDilateVSize;\nuniform vec2 uTextureDofBlurCircularSize;\n\nuniform float uDofScale;\n\nvec4 dofCombine() {\n    vec2 uv = gTexCoord;\n    vec3 color = TEXTURE_2D_TextureInput(uv).rgb;\n\n    if(uDofBlurNearFarFocal.x < EPS_EARLY_OUT && uDofBlurNearFarFocal.y < EPS_EARLY_OUT){\n        return vec4(color, 1.0);\n    }\n\n    vec4 depthPacked = TEXTURE_2D_TextureDepth(uv);\n\n    // half res color\n    vec3 blur;\n    // no bilinear for background pixels because it can displays artefacts on low frequency due to rgbm bilinear fetching\n    if (depthPacked.x == 1.0) {\n        blur = TEXTURE_2D_NEAREST_TextureDofBlurCircular(uv).rgb;\n        vec2 off = vec2(1.0, -1.0) * uDofScale;\n        blur += TEXTURE_2D_NEAREST_TextureDofBlurCircular(uv + off.xx / uTextureDofBlurCircularSize).rgb;\n        blur += TEXTURE_2D_NEAREST_TextureDofBlurCircular(uv + off.yy / uTextureDofBlurCircularSize).rgb;\n        blur += TEXTURE_2D_NEAREST_TextureDofBlurCircular(uv + off.xy / uTextureDofBlurCircularSize).rgb;\n        blur += TEXTURE_2D_NEAREST_TextureDofBlurCircular(uv + off.yx / uTextureDofBlurCircularSize).rgb;\n        blur /= 5.0;\n    } else {\n        blur = TEXTURE_2D_TextureDofBlurCircular(uv).rgb;\n        vec2 off = vec2(1.0, -1.0) * uDofScale;\n        blur += TEXTURE_2D_TextureDofBlurCircular(uv + off.xx / uTextureDofBlurCircularSize).rgb;\n        blur += TEXTURE_2D_TextureDofBlurCircular(uv + off.yy / uTextureDofBlurCircularSize).rgb;\n        blur += TEXTURE_2D_TextureDofBlurCircular(uv + off.xy / uTextureDofBlurCircularSize).rgb;\n        blur += TEXTURE_2D_TextureDofBlurCircular(uv + off.yx / uTextureDofBlurCircularSize).rgb;\n        blur /= 5.0;\n    }\n\n    // merge full res and half res coc\n    vec2 uvNearest = (floor(uv * uTextureDofNearDilateVSize) + 0.5) / uTextureDofNearDilateVSize;\n    float coc = abs(min(TEXTURE_2D_TextureDofNearDilateV(uvNearest).a * 2.0 - 1.0, texDepthToCoC(depthPacked)));\n\n    // merge half res blurred color and full res pixels\n    float cocLower = 0.05;\n    float cocHigher = 0.3;\n\n    return vec4(mix(color, blur, smoothstep(cocLower, cocHigher, coc)), 1.0);\n}\n\n'},function(e,t){e.exports='#pragma include "sketchfabFunctions.glsl"\n\nuniform sampler2D TextureInput;\n\n#ifdef HAS_BACKGROUND\nuniform sampler2D TextureDepth;\n#endif\n\nuniform float uBloomThreshold;\n\nvec3 extractBright(const in vec3 color) {\n    // TODO manage hdr pixel with high frequency? (use derivative??), for now we clamp the extracted pixel :(\n    return clamp(color * clamp(getLuminance(color) - uBloomThreshold, 0.0, 1.0), 0.0, 1.0);\n}\n\nvec4 bloomExtract() {\n    vec3 color = TEXTURE_2D_TextureInput(gTexCoord).rgb;\n\n#ifdef HAS_BACKGROUND\n\tfloat alpha = decodeAlpha(TEXTURE_2D_TextureDepth(gTexCoord));\n\tif(alpha == 0.0) {\n\t\treturn vec4(vec3(0.0), 1.0);\n    }\n#else\n\tfloat alpha = 1.0;\n#endif\n\n\treturn vec4(extractBright(color * alpha), 1.0);\n}'},function(e,t){e.exports="uniform sampler2D TextureInput;\nuniform sampler2D TextureBloomBlur1;\nuniform sampler2D TextureBloomBlur2;\nuniform sampler2D TextureBloomBlur3;\nuniform sampler2D TextureBloomBlur4;\nuniform sampler2D TextureBloomBlur5;\n\nuniform float uBloomRadius;\nuniform float uBloomFactor;\n\nfloat getRadiusFactored(const float value, const float middle) {\n    return mix(value, middle * 2.0 - value, uBloomRadius);\n}\n\nvec4 bloomCombine() {\n    vec3 bloom = vec3(0.0);\n\n    const float midVal = 0.6;\n\n    const float factor1 = 1.1;\n    const float factor2 = 0.9;\n    const float factor3 = 0.6;\n    const float factor4 = 0.3;\n    const float factor5 = 0.1;\n\n    bloom += TEXTURE_2D_TextureBloomBlur1(gTexCoord).rgb * getRadiusFactored(factor1, midVal);\n    bloom += TEXTURE_2D_TextureBloomBlur2(gTexCoord).rgb * getRadiusFactored(factor2, midVal);\n    bloom += TEXTURE_2D_TextureBloomBlur3(gTexCoord).rgb * getRadiusFactored(factor3, midVal);\n    bloom += TEXTURE_2D_TextureBloomBlur4(gTexCoord).rgb * getRadiusFactored(factor4, midVal);\n    bloom += TEXTURE_2D_TextureBloomBlur5(gTexCoord).rgb * getRadiusFactored(factor5, midVal);\n\n    vec3 color = TEXTURE_2D_TextureInput(gTexCoord).rgb;\n    return vec4(color + (bloom * uBloomFactor), 1.0);\n}"},function(e,t){e.exports="uniform sampler2D TextureInput;\n\nuniform float uChromaFactor;\n\nvec4 chromaticAberration() {\n    vec2 uv = gTexCoord;\n\n    vec2 dist = uv - 0.5;\n    vec2 offset = uChromaFactor * dist * length(dist);\n    vec3 col;\n    col.r = TEXTURE_2D_TextureInput(uv - offset).r;\n    col.g = TEXTURE_2D_TextureInput(uv).g;\n    col.b = TEXTURE_2D_TextureInput(uv + offset).b;\n\n    return vec4(col, 1.0);\n}"},function(e,t){e.exports='#pragma include "sketchfabFunctions.glsl"\n#pragma include "rand.glsl"\n\nuniform vec2 uLensRadius;\nuniform float uFrameMod;\n\nfloat vignetteDithered() {\n    vec2 lens = uLensRadius;\n    // smoothesp is not realiable with edge0 == edge1\n    lens.y = min(lens.y, lens.x - 1e-4);\n\n    float jitter = interleavedGradientNoise(gl_FragCoord.xy, uFrameMod);\n\n    // jitter a bit the uv to remove the banding in some cases\n    // (lens.x - lens.y) reduce flickering when the vignette is harder (hardness)\n    // (lens.x + lens.y) reduce the flickering when the vignette has a strong radius\n    jitter = (lens.x - lens.y) * (lens.x + lens.y) * 0.07 * (jitter - 0.5);\n    return smoothstep(lens.x, lens.y, jitter + distance(gTexCoord, vec2(0.5)));\n}\n\nvec4 vignette(const in vec4 color) {\n    float factor = vignetteDithered();\n    return vec4(linearTosRGB(sRGBToLinear(color.rgb) * factor), clamp(color.a + (1.0 - factor), 0.0, 1.0));\n}'},function(e,t){e.exports='#pragma include "sketchfabFunctions.glsl"\n\nuniform float uToneExposure;\nuniform float uToneBrightness;\nuniform float uToneContrast;\nuniform float uToneSaturation;\nuniform int uToneMethod;\n\n#ifdef HAS_FIXED_BACKGROUND\nuniform sampler2D TextureDepth;\n#endif\n\nvec3 toneMapping(const in vec3 color) {\n    vec3 col = color * uToneExposure;\n    float luminance = dot(col * (1.0 + uToneBrightness), vec3(0.2126, 0.7152, 0.0722));\n    col = mix(vec3(luminance), col * (1.0 + uToneBrightness), vec3(uToneSaturation));\n\n    // contrast is annoying and require special treatment in case of fixed background\n    // because it doesn\'t output black when the input is black\n    float toneContrast = uToneContrast;\n#ifdef HAS_FIXED_BACKGROUND\n    float alpha = decodeAlpha(TEXTURE_2D_TextureDepth(gTexCoord));\n    if(alpha == 0.0) toneContrast *= luminance;\n#endif\n    col = max(vec3(0.0), col * (1.0 + toneContrast) - 0.5 * toneContrast);\n\n    // simple reinhard and filmic\n    // http://filmicgames.com/archives/190\n    if(uToneMethod == 1) { // reinhard (on luminance)\n        col /= 1.0 + getLuminance(col);\n    } else if( uToneMethod == 2) { // filmic\n        vec3 x = max(vec3(0.0), col - 0.004);\n        col = (x * (6.2 * x + 0.5) ) / ( x * (6.2 * x + 1.7) + 0.06);\n        col = pow(col, vec3(2.2)); // filmic curve already encode srgb to linear\n    }\n\n    return col;\n}\n\nvec4 toneMapping(const in vec4 color) {\n    return vec4(toneMapping(color.rgb), 1.0);\n}\n'},function(e,t){e.exports="uniform vec3 uColorBalanceLow;\nuniform vec3 uColorBalanceMid;\nuniform vec3 uColorBalanceHigh;\n\nfloat RGBToL(const in vec3 color) {\n    float fmin = min(min(color.r, color.g), color.b);\n    float fmax = max(max(color.r, color.g), color.b);\n    return (fmax + fmin) / 2.0;\n}\n\nvec3 colorBalance(const in vec3 color) {\n    vec3 lrgb = uColorBalanceLow;\n    vec3 mrgb = uColorBalanceMid;\n    vec3 hrgb = uColorBalanceHigh;\n\n    float cLen = length(color);\n    if(cLen < 1e-5)\n        return color;\n\n    // TODO : I have no idea what I am doing, we should use a curve widge\n    float lightness = RGBToL(color);\n    // '  lightness=(lightness*0.9-1.0)/(lightness*2.0+1.0) +1.0;\n    lightness = (1.5 * lightness) / (lightness + 0.5);\n    // https://github.com/liovch/GPUImage/blob/master/framework/Source/GPUImageColorBalanceFilter\n    float a = 0.25;\n    float b = 0.333;\n    float scale = 0.7;\n    vec3 low = lrgb * clamp((lightness - b) / -a + 0.5, 0.0, 1.0);\n    vec3 mid = mrgb * clamp((lightness - b) / a + 0.5, 0.0, 1.0) * clamp((lightness + b - 1.0) / -a + 0.5, 0.0, 1.0);\n    vec3 high = hrgb * clamp((lightness + b - 1.0) / a + 0.5, 0.0, 1.0);\n    vec3 newColor = max(color + (low + mid + high) * scale, vec3(0.0));\n    // newColor can be negative\n    float len = length(newColor);\n    return len < 1e-5 ? newColor * cLen : newColor * cLen / len;\n}\n\nvec4 colorBalance(const in vec4 color) {\n    return vec4(colorBalance(color.rgb), 1.0);\n}"},function(e,t){e.exports="uniform vec4 uHalton;\n\nuniform float uSSAARestart;\nuniform sampler2D TexturePrevious;\nuniform vec2 uTexturePreviousSize;\n\n// static in place amortized supersampling\nvec4 supersample() {\n    vec4 currFragColor = TEXTURE_2D_TextureInput(gTexCoord).rgba;\n\n    float haltz = abs(uHalton.z);\n    if (haltz == 1.0) {\n        // just return the color.\n        return currFragColor;\n    }\n\n    // same pixel for same projected interpolated vertex on prev frame\n    vec4 accumColorN = TEXTURE_2D_NEAREST_TexturePrevious(gTexCoord).rgba;\n\n    // mix frames\n    float lerpFac = 1.0 / uHalton.w;\n\n    // if uTaaSSSRestart is 0.0, then we used the previous TAAed image to start supersampling\n    // we do that to avoid a sudden re-aliasing of the image (which is perceptible)\n    if (uHalton.w == 1.0) lerpFac = uSSAARestart;\n\n    if (haltz == 3.0) {\n        // No supersample, crude motion blur by accumulation\n        return mix(currFragColor, accumColorN, lerpFac);\n    }\n\n    // Supsersample, accumulation + jittering\n    // http://en.wikipedia.org/wiki/Moving_average#Cumulative_moving_average\n    // cumulative moving average over frameNum (which starts at 2)\n    // n is previous frame\n    // accumColorN = Accum(n)\n    // return value is accumColor( n +1 )\n    // Accum(n+1) = Accum(n) + ((x(n+1) - Accum(n)) / (n + 1)))\n    // formula above is equal to glsl  mix\n    return mix(accumColorN, currFragColor, lerpFac);\n}\n"},function(e,t){e.exports='#pragma include "sketchfabFunctions.glsl"\n#pragma include "supersample.glsl"\n\nuniform sampler2D TextureInput;\nuniform vec2 uTextureInputSize;\nuniform sampler2D TexturePrevious;\nuniform vec2 uTexturePreviousSize;\nuniform sampler2D TextureDepth;\n\nuniform vec4 uHalton;\nuniform vec2 uNearFar;\n\nuniform float uTaaEnabled;\nuniform mat4 uTaaInvViewMatrixLeft;\nuniform mat4 uTaaCurrentFramePVLeft;\nuniform mat4 uTaaLastFramePVLeft;\nuniform vec4 uTaaCornersCSLeft[2];\n\n#ifdef VR_ENABLED\nuniform mat4 uTaaInvViewMatrixRight;\nuniform mat4 uTaaCurrentFramePVRight;\nuniform mat4 uTaaLastFramePVRight;\nuniform vec4 uTaaCornersCSRight[2];\n#endif\n\nvec3 reconstructWSPosition(const in vec2 uv, const in vec4 corners[2], const in mat4 invView, const in float depth) {\n    vec2 finalUv = uv;\n#ifdef VR_ENABLED\n    float xViewportOffset = uv.x >= 0.5 ? -0.5 : 0.0;\n    finalUv.x = ( uv.x + xViewportOffset ) * 2.0;\n#endif\n\n    // the corners are in view space, it means if we interpolate between them we can retrieve the view space direction of the fragment\n    vec4 AB = mix(corners[0], corners[1], finalUv.x);\n\n    // multiply this view space direction by the depth gives us the view space position\n    vec3 vsPos = vec3(mix(AB.xy, AB.zw, finalUv.y), 1.0) * depth;\n\n    // multiply by the inverse of the view matrix gives us the world space position\n    return (invView * vec4(vsPos, 1.0)).xyz;\n}\n\n#define NEIGHBOUR_SET_IF_DMIN_Z_GREATER(d, x, y) if(d < dmin.z) dmin = vec3(x, y, d);\n#define NEIGHBOUR_CREATE_FROM_OFFSET(d, x, y) d = decodeDepth(TEXTURE_2D_TextureDepth(uv + vec2(x,y)));\n#define FIND_NEIGHBOUR_MIN(d, x, y) NEIGHBOUR_CREATE_FROM_OFFSET(d, x, y); NEIGHBOUR_SET_IF_DMIN_Z_GREATER(d, x, y)\n\n\n// Neighborhood clamping from Tiago Sousa\n// 4tap(decent) comment t, ml, mr, b\n// https://github.com/playdeadgames/temporal/blob/9e6a7704e69bb73f29fe393390e545b21ddfd42d/Assets/Shaders/IncDepth.cginc#L111\n// 9Tap(good) slower but nicer\n// https://github.com/playdeadgames/temporal/blob/9e6a7704e69bb73f29fe393390e545b21ddfd42d/Assets/Shaders/IncDepth.cginc#L37\n//#define CLOSEST_9TAP\nvec3 closestFragment(const in vec2 uv, const in vec2 texelSize) {\n\n    float d;\n    vec2 size = 2.0 * texelSize;\n    vec3 dmin = vec3(0.0, 0.0, 0.0);\n\n    // 5Tap\n    NEIGHBOUR_CREATE_FROM_OFFSET(dmin.z, 0.0, 0.0);\n    FIND_NEIGHBOUR_MIN(d, -size.x, size.y);\n    FIND_NEIGHBOUR_MIN(d, size.x, size.y);\n    FIND_NEIGHBOUR_MIN(d, -size.x, -size.y);\n    FIND_NEIGHBOUR_MIN(d, size.x, -size.y);\n\n#ifdef CLOSEST_9TAP\n    FIND_NEIGHBOUR_MIN(d, 0.0, size.y);\n    FIND_NEIGHBOUR_MIN(d, -size.x, 0.0);\n    FIND_NEIGHBOUR_MIN(d, size.x, 0.0);\n    FIND_NEIGHBOUR_MIN(d, 0.0, -size.y);\n#endif\n\n    return vec3(uv + dmin.xy, dmin.z);\n}\n\n// note: only clips towards aabb center (but fast!)\n// same as https://github.com/gokselgoktas/temporal-anti-aliasing/blob/master/Assets/Resources/Shaders/TemporalAntiAliasing.cginc#L199\n// which is adapted from https://github.com/playdeadgames/temporal\n// using the mathematical similar version of https://twitter.com/Stubbesaurus/status/890154773726580736\n// exhibits numerical issue (in a consistent way on intel/nvidia at least)\nvec4 clip_aabb_opti(const in vec4 minimum, const in vec4 maximum, const in vec4 color) {\n    const float eps = 0.00000001;\n\n    vec4 center = 0.5 * (maximum + minimum);\n    vec4 extents = 0.5 * (maximum - minimum) + eps;\n    vec4 offset = color - center;\n\n    vec4 ts = abs(offset / extents);\n    float t = max(max(ts.r, ts.g), max(ts.b, ts.a));\n    return center + offset / max(1.0, t);\n    // return t > 1.0 : center + offset / t : color;\n}\n\nvec4 taa(const in vec2 ssVel, const in vec2 texelSize) {\n    vec2 uv = gTexCoord;\n\n    vec4 tl = TEXTURE_2D_TextureInput(uv + vec2(-texelSize.x, texelSize.y));\n    vec4 t  = TEXTURE_2D_TextureInput(uv + vec2(0.0, texelSize.y));\n    vec4 tr = TEXTURE_2D_TextureInput(uv + vec2(texelSize.x, texelSize.y));\n\n    vec4 ml = TEXTURE_2D_TextureInput(uv + vec2(-texelSize.x, 0.0));\n    vec4 m  = TEXTURE_2D_TextureInput(uv);\n    vec4 mr = TEXTURE_2D_TextureInput(uv + vec2(texelSize.x, 0.0));\n\n    vec4 bl = TEXTURE_2D_TextureInput(uv + vec2(-texelSize.x, -texelSize.y));\n    vec4 b  = TEXTURE_2D_TextureInput(uv + vec2(0.0, -texelSize.y));\n    vec4 br = TEXTURE_2D_TextureInput(uv + vec2(texelSize.x, -texelSize.y));\n\n    // sharpen\n    // https://github.com/Unity-Technologies/PostProcessing/blob/v1/PostProcessing/Resources/Shaders/TAA.cginc#L143\n    // reduces blurring, but increases flickering with dense geometry\n    vec4 corners = 2.0 * (tr + bl + br + tl) - 2.0 * m;\n    m += (m - (corners * 0.166667)) * 2.718282 * 0.3;\n    m = max(vec4(0.0), m);\n\n    // Brian Karis neighbourhood rounding: http://advances.realtimerendering.com/s2014/epic/TemporalAA.pptx\n    // average of rounded pattern with cross pattern\n    vec4 cmin5 = min(mr, min(m, min(ml, min(t, b))));\n    vec4 cmin = min(cmin5, min(tl, min(tr, min(bl, br))));\n\n    vec4 cmax5 = max(mr, max(m, max(ml, max(t, b))));\n    vec4 cmax = max(cmax5, max(tl, max(tr, max(bl, br))));\n\n    cmin = 0.5 * (cmin + cmin5);\n    cmax = 0.5 * (cmax + cmax5);\n\n    vec4 previousColor = TEXTURE_2D_TexturePrevious(uv - ssVel);\n    previousColor = clip_aabb_opti(cmin, cmax, previousColor);\n\n    float lum0 = getLuminance(m.rgb);\n    float lum1 = getLuminance(previousColor.rgb);\n    float diff = abs(lum0 - lum1) / max(lum0, max(lum1, 0.2));\n    float unbiased_weight = 1.0 - diff;\n    float feedback = mix(FEEDBACK_MIN, FEEDBACK_MAX, unbiased_weight * unbiased_weight);\n\n    return mix(m, previousColor, feedback);\n}\n\nvec2 computeSSVelocity(const in vec3 wsPos, const in mat4 currentFrameProjView, const in mat4 lastFrameProjView, const in bool rightEye)\n{\n    vec4 ssCurrentPos = currentFrameProjView * vec4(wsPos, 1.0);\n    vec4 ssPrevPos = lastFrameProjView * vec4(wsPos, 1.0);\n\n    vec2 ndcCurrent = ssCurrentPos.xy / ssCurrentPos.w;\n    vec2 ndcPrev = ssPrevPos.xy / ssPrevPos.w;\n\n    //ndcPrev = clamp(ndcPrev, vec2(-1.0), vec2(1.0));\n    if(ndcPrev.x >= 1.0 || ndcPrev.x <= -1.0 || ndcPrev.x >= 1.0 || ndcPrev.y <= -1.0)\n        return vec2(0.0);\n\n#ifdef VR_ENABLED\n    ndcCurrent.x /= 2.0;\n    ndcPrev.x /= 2.0;\n\n    if (rightEye) {\n        ndcCurrent.x += 0.5;\n        ndcPrev.x += 0.5;\n    }\n#endif\n\n    return 0.5 * (ndcCurrent - ndcPrev);\n}\n\n\nvec4 computeTaa(const in mat4 invView, const in mat4 currentFrameProjView, const in mat4 lastFrameProjView, const in vec4 corners[2]) {\n    vec2 uv = gTexCoord;\n    float haltz = abs(uHalton.z);\n    if (haltz == 1.0) {\n        vec2 texelSize = vec2(1.0) / uTextureInputSize;\n        vec3 closest = closestFragment(uv, texelSize);\n\n        // discard background fragments to save fillrate\n        // make sure the mesh isn\'t transparent\n        if (closest.z >= 1.0\n#ifdef TAA_TRANSPARENT\n            && decodeAlpha(TEXTURE_2D_TextureDepth(closest.xy)) == 0.0\n#endif\n        ) {\n            // unjitter for fixed background with highres pattern or text\n            return TEXTURE_2D_TextureInput(uv - 0.5 * uHalton.xy * texelSize);\n        }\n\n        float depth = -(uNearFar.x + (uNearFar.y - uNearFar.x) * closest.z);\n        vec3 ws = reconstructWSPosition(closest.xy, corners, invView, depth);\n\n        vec2 ssVel = computeSSVelocity(ws, currentFrameProjView, lastFrameProjView, uv.x >= 0.5);\n        return taa(ssVel, texelSize);\n    }\n\n    return supersample();\n}\n\n// temporal anti-aliasing from Playdead\'s Inside\n// slides: http://www.gdcvault.com/play/1022970/Temporal-Reprojection-Anti-Aliasing-in\n// sources: https://github.com/playdeadgames/temporal\nvec4 supersampleTaa() {\n    if (uTaaEnabled == 0.0) {\n        return supersample();\n    }\n\n#ifdef VR_ENABLED\n    // left and right eyes have different matrices\n    if (gTexCoord.x >= 0.5) {\n        return computeTaa(uTaaInvViewMatrixRight, uTaaCurrentFramePVRight, uTaaLastFramePVRight, uTaaCornersCSRight);\n    }\n#endif\n\n    return computeTaa(uTaaInvViewMatrixLeft, uTaaCurrentFramePVLeft, uTaaLastFramePVLeft, uTaaCornersCSLeft);\n}'},function(e,t){e.exports="uniform sampler2D TextureExtra;\r\n\r\n// LINEAR should be deduce from TEXTURE_2D_TextureExtra with user data\r\nvec4 composeExtra(const in vec4 color) {\r\n#ifdef LINEAR_EXTRA\r\n\tvec4 extra = sRGBToLinear(TEXTURE_2D_TextureExtra(gTexCoord));\r\n#else\r\n\tvec4 extra = TEXTURE_2D_TextureExtra(gTexCoord);\r\n#endif\r\n\treturn extra + vec4(color) * (1.0 - extra.a);\r\n}"},function(e,t){e.exports='#pragma include "sketchfabFunctions.glsl"\r\n\r\nuniform sampler2D TextureFixed;\r\nuniform vec2 uFixedScale;\r\n\r\nuniform sampler2D TextureDepth;\r\nuniform vec2 uTextureOutputSize;\r\n\r\nuniform vec4 uHalton;\r\nuniform float uSplitView;\r\n\r\nvec4 composeBackground(const in vec3 color, const in float alpha) {\r\n    vec2 jitter = uHalton.xy * 0.5 / uTextureOutputSize;\r\n    vec2 uv = (gTexCoord - 0.5 + jitter) * uFixedScale + 0.5;\r\n\r\n    // we recenter and unstretch the background\r\n    if (uSplitView == 1.0) uv.x = uv.x * 0.5 + 0.25;\r\n\r\n    // composer can\'t guess based on user data, so SRGBToLinear should be defined (or not) by TEXTURE_2D_XXXXXXX\r\n    vec3 backgroundColor = sRGBToLinear(texture2D(TextureFixed, uv).rgb);\r\n    return vec4(color.rgb + backgroundColor * (1.0 - alpha), 1.0);\r\n}\r\n\r\nuniform sampler2D TextureInput;\r\nuniform vec2 uTextureInputSize;\r\nuniform vec2 uTextureInputRatio;\r\n\r\nuniform sampler2D TextureRefraction;\r\nuniform vec2 uTextureRefractionSize;\r\nuniform vec2 uTextureRefractionRatio;\r\nuniform float uRGBMRange;\r\n\r\nvec4 composeFixedBackground(const in vec4 color) {\r\n#ifdef REFRACTION_COMPOSITING_EXCLUSION\r\n    // detect if we are on a refraction pixel\r\n    vec2 uvRef = min(gTexCoord, 1.0 - 1.0 / uTextureRefractionSize.xy);\r\n    float onRefraction = texture2D(TextureRefraction, uvRef * uTextureRefractionRatio).a > 0.0 ? 1.0 : 0.0;\r\n    if (onRefraction == 1.0) return color;\r\n#endif\r\n\r\n    float alpha = decodeAlpha(TEXTURE_2D_TextureDepth(gTexCoord));\r\n    return composeBackground(color.rgb, alpha);\r\n}\r\n\r\nvec4 composeFixedBackgroundRefraction() {\r\n    vec3 color = TEXTURE_2D_TextureInput(gTexCoord).rgb;\r\n    float alpha = decodeAlpha(TEXTURE_2D_TextureDepth(gTexCoord));\r\n    return composeBackground(color.rgb, alpha);\r\n}'},function(e,t){e.exports='#ifdef VR_DISTORTION\nuniform vec2 uDistortion;\nuniform vec4 uProjectionLeft;\nuniform vec4 uUnprojectionLeft;\n\n#pragma include "distortion.glsl"\n#endif\n\nuniform sampler2D TextureInput;\nuniform vec2 uTextureInputSize;\n\n// G3D version of FXAA\n// green (y) as luma\n// Quality 12\nvec4 fxaa() {\n#ifdef VR_DISTORTION\n    gTexCoord = distortion(gTexCoord);\n#endif\n\n    vec2 fxaaQualityRcpFrame = 1.0 / uTextureInputSize;\n    float fxaaQualitySubpix = 0.75;\n    float fxaaQualityEdgeThreshold = 0.125;\n    float fxaaQualityEdgeThresholdMin = 0.0625;\n\n    vec2 posM = gTexCoord;\n    vec4 rgbyM = TEXTURE_2D_TextureInput(posM);\n    float lumaM = rgbyM.y;\n\n    // Swizzler Offseter Util\n    vec4 sw = vec4(-1.0, 1.0, 1.0, -1.0) * fxaaQualityRcpFrame.xxyy;\n\n    float lumaS = TEXTURE_2D_TextureInput(posM + vec2(0.0, sw.z)).y;\n    float lumaE = TEXTURE_2D_TextureInput(posM + vec2(sw.y, 0.0)).y;\n    float lumaN = TEXTURE_2D_TextureInput(posM + vec2(0.0, sw.w)).y;\n    float lumaW = TEXTURE_2D_TextureInput(posM + vec2(sw.x, 0.0)).y;\n\n    float maxSM = max(lumaS, lumaM);\n    float minSM = min(lumaS, lumaM);\n\n    float maxESM = max(lumaE, maxSM);\n    float minESM = min(lumaE, minSM);\n\n    float maxWN = max(lumaN, lumaW);\n    float minWN = min(lumaN, lumaW);\n\n    float rangeMax = max(maxWN, maxESM);\n    float rangeMin = min(minWN, minESM);\n\n    float rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;\n    float range = rangeMax - rangeMin;\n    float rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);\n\n    bool earlyExit = range < rangeMaxClamped;\n    if (earlyExit) return rgbyM;\n\n    float lumaNW = TEXTURE_2D_TextureInput(posM + sw.xw).y;\n    float lumaSE = TEXTURE_2D_TextureInput(posM + sw.yz).y;\n    float lumaNE = TEXTURE_2D_TextureInput(posM + sw.yw).y;\n    float lumaSW = TEXTURE_2D_TextureInput(posM + sw.xy).y;\n\n    float lumaNS = lumaN + lumaS;\n    float lumaWE = lumaW + lumaE;\n    float subpixRcpRange = 1.0/range;\n    float subpixNSWE = lumaNS + lumaWE;\n    float edgeHorz1 = (-2.0 * lumaM) + lumaNS;\n    float edgeVert1 = (-2.0 * lumaM) + lumaWE;\n\n    float lumaNESE = lumaNE + lumaSE;\n    float lumaNWNE = lumaNW + lumaNE;\n    float edgeHorz2 = (-2.0 * lumaE) + lumaNESE;\n    float edgeVert2 = (-2.0 * lumaN) + lumaNWNE;\n\n    float lumaNWSW = lumaNW + lumaSW;\n    float lumaSWSE = lumaSW + lumaSE;\n    float edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);\n    float edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);\n    float edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;\n    float edgeVert3 = (-2.0 * lumaS) + lumaSWSE;\n    float edgeHorz = abs(edgeHorz3) + edgeHorz4;\n    float edgeVert = abs(edgeVert3) + edgeVert4;\n\n    float subpixNWSWNESE = lumaNWSW + lumaNESE;\n    float lengthSign = fxaaQualityRcpFrame.x;\n    bool horzSpan = edgeHorz >= edgeVert;\n    float subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;\n\n    if(!horzSpan) lumaN = lumaW;\n    if(!horzSpan) lumaS = lumaE;\n    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;\n    float subpixB = (subpixA * (1.0/12.0)) - lumaM;\n\n    float gradientN = lumaN - lumaM;\n    float gradientS = lumaS - lumaM;\n    float lumaNN = lumaN + lumaM;\n    float lumaSS = lumaS + lumaM;\n    bool pairN = abs(gradientN) >= abs(gradientS);\n    float gradient = max(abs(gradientN), abs(gradientS));\n    if(pairN) lengthSign = -lengthSign;\n    float subpixC = clamp(abs(subpixB) * subpixRcpRange, 0.0, 1.0);\n\n    vec2 posB = posM.xy;\n    vec2 offNP;\n    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;\n    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;\n    if(!horzSpan) posB.x += lengthSign * 0.5;\n    if( horzSpan) posB.y += lengthSign * 0.5;\n\n    vec2 posN;\n    posN.x = posB.x - offNP.x;\n    posN.y = posB.y - offNP.y;\n    vec2 posP;\n    posP.x = posB.x + offNP.x;\n    posP.y = posB.y + offNP.y;\n    float subpixD = ((-2.0)*subpixC) + 3.0;\n    float lumaEndN = TEXTURE_2D_TextureInput(posN).y;\n    float subpixE = subpixC * subpixC;\n    float lumaEndP = TEXTURE_2D_TextureInput(posP).y;\n\n    if(!pairN) lumaNN = lumaSS;\n    float gradientScaled = gradient * 1.0/4.0;\n    float lumaMM = lumaM - lumaNN * 0.5;\n    float subpixF = subpixD * subpixE;\n    bool lumaMLTZero = lumaMM < 0.0;\n\n    lumaEndN -= lumaNN * 0.5;\n    lumaEndP -= lumaNN * 0.5;\n    bool doneN = abs(lumaEndN) >= gradientScaled;\n    bool doneP = abs(lumaEndP) >= gradientScaled;\n    if(!doneN) posN.x -= offNP.x * 1.5;\n    if(!doneN) posN.y -= offNP.y * 1.5;\n    bool doneNP = (!doneN) || (!doneP);\n    if(!doneP) posP.x += offNP.x * 1.5;\n    if(!doneP) posP.y += offNP.y * 1.5;\n\n    if(doneNP) {\n        if(!doneN) lumaEndN = TEXTURE_2D_TextureInput(posN.xy).y;\n        if(!doneP) lumaEndP = TEXTURE_2D_TextureInput(posP.xy).y;\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * 2.0;\n        if(!doneN) posN.y -= offNP.y * 2.0;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * 2.0;\n        if(!doneP) posP.y += offNP.y * 2.0;\n\n        if(doneNP) {\n            if(!doneN) lumaEndN = TEXTURE_2D_TextureInput(posN.xy).y;\n            if(!doneP) lumaEndP = TEXTURE_2D_TextureInput(posP.xy).y;\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * 4.0;\n            if(!doneN) posN.y -= offNP.y * 4.0;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * 4.0;\n            if(!doneP) posP.y += offNP.y * 4.0;\n\n            if(doneNP) {\n                if(!doneN) lumaEndN = TEXTURE_2D_TextureInput(posN.xy).y;\n                if(!doneP) lumaEndP = TEXTURE_2D_TextureInput(posP.xy).y;\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * 12.0;\n                if(!doneN) posN.y -= offNP.y * 12.0;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * 12.0;\n                if(!doneP) posP.y += offNP.y * 12.0;\n\n            }\n\n        }\n\n    }\n\n    float dstN = posM.x - posN.x;\n    float dstP = posP.x - posM.x;\n    if(!horzSpan) dstN = posM.y - posN.y;\n    if(!horzSpan) dstP = posP.y - posM.y;\n\n    bool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;\n    float spanLength = (dstP + dstN);\n    bool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;\n    float spanLengthRcp = 1.0/spanLength;\n\n    bool directionN = dstN < dstP;\n    float dst = min(dstN, dstP);\n    bool goodSpan = directionN ? goodSpanN : goodSpanP;\n    float subpixG = subpixF * subpixF;\n    float pixelOffset = (dst * (-spanLengthRcp)) + 0.5;\n    float subpixH = subpixG * fxaaQualitySubpix;\n\n    float pixelOffsetGood = goodSpan ? pixelOffset : 0.0;\n    float pixelOffsetSubpix = max(pixelOffsetGood, subpixH);\n    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;\n    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;\n\n    return TEXTURE_2D_TextureInput(posM);\n}'},function(e,t){e.exports='#pragma include "rand.glsl"\n\nuniform float uTimeGrain;\nuniform float uGrainFactor;\n\nfloat nrandTriangle() {\n    float nrnd0 = pseudoRandom(gl_FragCoord.xy + 1000.0 * fract(uTimeGrain));\n\n    // Convert uniform distribution into triangle-shaped distribution.\n    float orig = nrnd0 * 2.0 - 1.0;\n    nrnd0 = orig * inversesqrt(abs(orig));\n    nrnd0 = max(-1.0, nrnd0); // Nerf the NaN generated by 0 * rsqrt(0). Thanks @FioraAeterna!\n    nrnd0 = nrnd0 - sign(orig) + 0.5;\n\n    // Result is range [-0.5,1.5] which is useful for actual dithering. convert to [0,1] for histogram.\n    return (nrnd0 + 0.5) * 0.5;\n    // return nrnd0;\n}\n\nvec4 grain(const in vec4 color) {\n    float grainFactor = nrandTriangle();\n    return vec4(mix(color.rgb, color.rgb * (color.rgb + (1.0 - color.rgb) * 2.0 * grainFactor), uGrainFactor), color.a);\n}'},function(e,t){e.exports='#pragma include "sketchfabFunctions.glsl"\n\nuniform sampler2D TextureInput;\nuniform vec2 uTextureInputSize;\n\n#ifdef HAS_BACKGROUND\nuniform sampler2D TextureDepth;\n#endif\n\nuniform float uSharpFactor;\n\nuniform vec2 uPixelRatio;\n\nvec3 sharpColorFactor(const in vec3 color, const float sharp) {\n    vec2 off = uPixelRatio.xy / uTextureInputSize.xy;\n\n    // use useAA, 4 texFetch already in cache. perhaps we could cache ourself.\n    vec3 rgbNW = TEXTURE_2D_TextureInput(gTexCoord + off * vec2(-1.0, -1.0)).rgb; \n    vec3 rgbSE = TEXTURE_2D_TextureInput(gTexCoord + off * vec2(1.0, 1.0)).rgb;\n    vec3 rgbNE = TEXTURE_2D_TextureInput(gTexCoord + off * vec2(1.0, -1.0)).rgb;\n    vec3 rgbSW = TEXTURE_2D_TextureInput(gTexCoord + off * vec2(-1.0, 1.0)).rgb;\n\n    return color + sharp * (4.0 * color - rgbNW - rgbNE - rgbSW - rgbSE);\n}\n\nvec4 sharpen(const in vec4 color) {\n#ifdef HAS_BACKGROUND\n\tfloat alpha = decodeAlpha(TEXTURE_2D_TextureDepth(gTexCoord));\n\tif( alpha == 0.0 ) {\n\t\treturn vec4(color.rgb,1.0);\n    }\n#else\n\tfloat alpha = 1.0;\n#endif\n\n    return vec4(sharpColorFactor(color.rgb, uSharpFactor * alpha), color.a);\n}\n\nvec4 sharpen() {\n    return sharpen(TEXTURE_2D_TextureInput(gTexCoord));\n}'},function(e,t){e.exports="uniform vec2 uTextureInputSize;\nuniform vec3 uDofCross;\n\nuniform vec2 uPixelRatio;\n\nvec4 dofCross(const in vec4 color) {\n    float ratio = uTextureInputSize.y / uTextureInputSize.x;\n    float dist = distance(vec2(uDofCross.x, uDofCross.y * ratio), gTexCoord * vec2(1.0, ratio));\n    float widthCircle = uPixelRatio.x / uTextureInputSize.x;\n    return vec4(mix(color.rgb, vec3(1.0), abs(dist - 60.0 * widthCircle) > widthCircle ? 0.0 : uDofCross.z), color.a);\n}"},function(e,t){e.exports="// https://github.com/borismus/webvr-boilerplate/blob/master/src/distortion/barrel-distortion-fragment-v2.js\n\nvec2 barrel(const in vec2 v, const in vec4 projection, const in vec4 unprojection) {\n  vec2 w = (v + unprojection.zw) / unprojection.xy;\n  float val = dot(w, w);\n  // float poly = (showCenter == 1 && val < 0.00010) ? 10000.0 : 1.0 + (uDistortion.x + uDistortion.y * val) * val;\n  float poly = 1.0 + (uDistortion.x + uDistortion.y * val) * val;\n  return projection.xy * (poly * w) - projection.zw;\n}\n\nvec2 distortion(const in vec2 texCoord) {\n\n  if (abs(texCoord.x - 0.5) < .001) {\n    discard;\n  }\n\n  vec2 a;\n\n  if (texCoord.x < 0.5){\n    a = barrel(vec2(texCoord.x / 0.5, texCoord.y), uProjectionLeft, uUnprojectionLeft);\n  } else {\n    // right projections are shifted and vertically mirrored relative to left\n    const vec3 swi = vec3(1.0, -1.0, 0.0);\n    vec4 projectionRight = (uProjectionLeft + swi.zzxz) * swi.xxyx;\n    vec4 unprojectionRight = (uUnprojectionLeft + swi.zzxz) * swi.xxyx;\n    a = barrel(vec2((texCoord.x - 0.5) / 0.5, texCoord.y), projectionRight, unprojectionRight);\n  }\n\n  if (a.x < 0.0 || a.x > 1.0 || a.y < 0.0 || a.y > 1.0) {\n    discard;\n  }\n\n  return vec2(a.x * 0.5 + (texCoord.x < 0.5 ? 0.0 : 0.5), a.y);\n}"},function(e,t){e.exports="uniform float uVrFadeFactor;\r\n\r\nvec4 fadeVr(const in vec4 color) {\r\n\treturn vec4(mix(color.rgb, vec3(0.0), clamp(uVrFadeFactor, 0.0, 1.0)), color.a);\r\n}"},function(e,t){e.exports="uniform float uVrVeilFactor;\r\n\r\nvec4 veilVr(const in vec4 color) {\r\n\treturn vec4(color.rgb * uVrVeilFactor, 1.0);\r\n}"},function(e,t){e.exports="uniform float uOutlineFactor;\nuniform vec2 uPixelRatio;\nuniform float uHighlightFactor;\n\nuniform sampler2D TextureOutline;\nuniform vec2 uTextureOutlineSize;\n\nvec4 outline() {\n    float fac0 = 2.0;\n    float fac1 = 1.0;\n    float offsetx = uPixelRatio.x / uTextureOutlineSize[0];\n    float offsety = uPixelRatio.y / uTextureOutlineSize[1];\n\n    vec4 texel0 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(offsetx, offsety));\n    vec4 texel1 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(offsetx, 0.0));\n    vec4 texel2 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(offsetx, -offsety));\n    vec4 texel3 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(0.0, -offsety));\n    vec4 texel4 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(-offsetx, -offsety));\n    vec4 texel5 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(-offsetx, 0.0));\n    vec4 texel6 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(-offsetx, offsety));\n    vec4 texel7 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(0.0, offsety));\n\n    vec4 rowx = -fac0 * texel5 + fac0 * texel1 + -fac1 * texel6 + fac1 * texel0 + -fac1 * texel4 + fac1 * texel2;\n    vec4 rowy = -fac0 * texel3 + fac0 * texel7 + -fac1 * texel4 + fac1 * texel6 + -fac1 * texel2 + fac1 * texel0;\n\n    float magSqr = sqrt(dot(rowy, rowy) + dot(rowx, rowx));\n    bool infMag = magSqr < 1.0 / 65025.0;\n\n    vec3 texelCenter = TEXTURE_2D_TextureOutline(gTexCoord).rgb;\n    if (texelCenter == vec3(0.0) || (uHighlightFactor == 0.0 && infMag)) {\n        discard;\n    }       \n\n    float finalFactor = infMag ? uHighlightFactor : min(1.0, sqrt(magSqr) * uOutlineFactor);\n\n    return finalFactor * vec4(texelCenter, 1.0);\n}\n"},function(e,t,i){"use strict";var r=i(5),a=i(37),n=i(79),o=i(16),s=i(34),u=i(43),l=i(251),c=i(558),h=i(144),d=i(113),p=i(445),f=i(119),m=i(610),g=i(146),_=i(93),v=r.a.osg,b=r.a.osgUtil,y=!1,x=!1,S=!1,M=function(e){this._dirty=!0,this._view3d=e,this._effectiveConfig=e._effectiveConfig,this._viewer=e._viewer,this._viewerOSGJS=e._viewerOSGJS,this._model=e.model;var t=Object(o.a)().dofTransition;this._interpolatorDofFocal=new b.DelayInterpolator(1,t?.15:1),this._interpolatorDofBlurNear=new b.DelayInterpolator(1,t?.15:1),this._interpolatorDofBlurFar=new b.DelayInterpolator(1,t?.15:1),this._interpolatorDofCross=new b.DelayInterpolator(1,t?.08:1),this._interpolatorDofCross._epsilon=-.01,this._dofInitialized=!1,this._dofAutoFocus=!1,this._currentEye=v.vec3.create(),this._lastEye=v.vec3.create(),this._currentRot=v.quat.create(),this._lastRot=v.quat.create(),this._dofLastPos=v.vec3.create(),this._dofLastFocal=0,this._firstFrame=!0,this._cullConfig=c.a.vrConfig,this._skipTaaFrames=0,this._lastUpdateTime=this._viewerOSGJS.getFrameStamp().getSimulationTime();var i=this.dirty.bind(this);l.a.bind("change:hasTransparency",i),l.a.bind("change:hasExtra",i),l.a.on("change:hasScattering",i),l.a.on("change:hasRefraction",i),s.a.getMaterial().then(function(){this.getBackgroundModel().bind("change:enable",i)}.bind(this)),this._hookViewerCheckNeedToDoFrame(),this._hookViewerFrame(),this._hookViewerComputeCanvasSize(),this._model.on("resetTaa",this.onResetTaa.bind(this))};v.createPrototypeObject(M,{dirty:function(){this._dirty=!0,S=!0},onResetTaa:function(){this._skipTaaFrames=2},getMainCamera:function(){return this._view3d._camera},getNodeIn:function(){return this._view3d._nodeIn},getCurrentComposer:function(){return this._view3d._nodeIn._composer},getBackgroundModel:function(){return this._viewer.getFeatures().background.getModel()},updateTargetDofBlurNear:function(){this._interpolatorDofBlurNear.setTarget(this._model.get("dofBlurNear"))},updateTargetDofBlurFar:function(){this._interpolatorDofBlurFar.setTarget(this._model.get("dofBlurFar"))},getClampedProjectionMatrix:function(){var e=this.getMainCamera();return e.clampedProjectionMatrix||e.getProjectionMatrix()},onEffectChanged:function(){return a.a.draw(),this.getNodeIn().createPathStandard()},_toggleComposerCameras:function(e){this._viewer.getSuperSample().setSwitch(e);var t=e?-1:0;this.getMainCamera().setNodeMask(t);var i=this.getCurrentComposer(),r=i?i.getCameras():void 0;if(void 0!==r)for(var a=0;a<r.length-1;a++)r[a].setNodeMask(t)},_hookViewerCheckNeedToDoFrame:function(){var e=this._viewerOSGJS,t=e.checkNeedToDoFrame.bind(e),i=this;e.checkNeedToDoFrame=function(){this._requestContinousUpdate&&a.a.draw();var e=t(),r=y;return y=!1,e||!r?(i._toggleComposerCameras(!0),e):(i._toggleComposerCameras(!1),!0)}},_hookViewerFrame:function(){var e=this.getMainCamera(),t=this._viewerOSGJS,i=this._viewer.getSuperSample(),r=Object(o.a)().vrMirror,n=this,s=t.frame.bind(t);t.frame=function(){s(),a.a.setShadowForcedUpdate(!1),x&&(x=!1,n._skipTaaFrames=1,a.a.draw(),s(),S=!0),S&&(S=!1,n._skipTaaFrames=1,a.a.draw(),s()),e.setNodeMask(-1),this._hmd&&this._hmd.isPresenting&&r&&(i.setSwitch(!1),e.setNodeMask(0),this.getCamera().getRenderer().draw())}},_hookViewerComputeCanvasSize:function(){this._resizeCanvasTimeout=-1,this._doResizeCanvas=!1,this._overrideCanvasWidth=-1,this._overrideCanvasHeight=-1,this._viewer.bind("resizeViewer",this._onResizeCanvas,this),this._viewer.bind("resizeViewerOnNextFrame",this._onForceResizeCanvas,this),this._cbEnableResizeCanvas=this._enableResizeCanvas.bind(this);var e=this._viewerOSGJS,t=this._viewer.getCanvas();this._originalCanvasResize=e.computeCanvasSize.bind(e,t),e.computeCanvasSize=this._computeCanvasSize.bind(e,t,this)},_onResizeCanvas:function(e,t){this._overrideCanvasWidth=e,this._overrideCanvasHeight=t,a.a.draw()},_onForceResizeCanvas:function(e,t){this._enableResizeCanvas(),this._onResizeCanvas(e,t)},_enableResizeCanvas:function(){this._doResizeCanvas=!0},_resetResizeCanvas:function(){this._doResizeCanvas=!1,window.clearTimeout(this._resizeCanvasTimeout)},_computeCanvasSize:function(e,t){var i=t._overrideCanvasWidth,r=t._overrideCanvasHeight;if(i>0){var a=!1;return this._canvasWidth!==i&&(e.width=i,this._canvasWidth=i,a=!0),this._canvasHeight!==r&&(e.height=r,this._canvasHeight=r,a=!0),a}var n=t._viewer.getFeatures(),s=n.inspector;if(!s)return!1;var u=s.getModel();if(t._doResizeCanvas)return u.set("viewerToCanvasRatio",1),t._resetResizeCanvas(),t._originalCanvasResize();var l=Math.max(1,Math.floor(e.clientWidth*this._devicePixelRatio)),c=Math.max(1,Math.floor(e.clientHeight*this._devicePixelRatio)),h=l/c,d=this._canvasWidth/this._canvasHeight,p=h/d;if(p===u.get("viewerToCanvasRatio"))return!1;u.set("viewerToCanvasRatio",p),t._resetResizeCanvas();var f=Object(o.a)().resizeTimeout;return t._resizeCanvasTimeout=window.setTimeout(t._cbEnableResizeCanvas,f),!1},showDofCross:function(){this._interpolatorDofCross.getCurrent()[0]=1,this._interpolatorDofCross.setTarget(0),v.vec3.copy(this._dofLastPos,this._model.get("dofFocusPoint")),this._dofLastFocal=this._interpolatorDofFocal.getCurrent()[0],a.a.draw()},hideDofCross:function(){this._interpolatorDofCross.getCurrent()[0]=0,a.a.draw()},computeFocalDistance:function(){var e=v.vec4.create();return function(){var t=this._model.get("dofFocusPoint");v.vec3.copy(e,t)[3]=1;var i=this._viewer.getCamera();v.vec4.transformMat4(e,e,i.getViewMatrix()),v.vec4.transformMat4(e,e,this.getClampedProjectionMatrix());var r=g.a.uNearFar.getInternalArray();return(e[3]-r[0])/(r[1]-r[0])}}(),updateDofFocusPoint:function(){this._interpolatorDofFocal.setTarget(this.computeFocalDistance()),this.showDofCross(),this._dofAutoFocus=!1},updateGrain:function(e){if(this._effectiveConfig.useGrain&&this._model.get("grainAnimated")){y=!0;var t=e.getSimulationTime(),i=Object(o.a)().grainSpeed/1e3;i>0&&t-this._lastUpdateTime>=i&&(m.a.uTimeGrain.setFloat(t/1e3),this._lastUpdateTime=t)}},dofPickFocusPoint:function(){if(!(Object(o.a)().dofSticky||h.a.hasRigsOrMorphs&&this._dofAutoFocus)){var e=this._viewer.getFeaturesManager(),t=e.getViewport3d(),i=p.a.getPixelRatio(),r=f.a.computeNearestIntersection2D(.5*t.width()/i[0],.5*t.height()/i[1],u.a.PICK_GEOMETRY_SLOW);if(!r){var a=m.a.uDofCross.getInternalArray();r=f.a.computeNearestIntersection2D(t.width()*a[0]/i[0],t.height()*a[1]/i[1],u.a.PICK_GEOMETRY_SLOW)}r&&f.a.getWorldPositionFromHit(r,this._model.get("dofFocusPoint")),this._interpolatorDofFocal.setTarget(this.computeFocalDistance())}},dofUpdateShowCross:function(e,t){if(this._dofAutoFocus)this._interpolatorDofCross.getCurrent()[0]=0;else{var i=v.vec3.dist(this._dofLastPos,this._model.get("dofFocusPoint")),r=this._interpolatorDofFocal.getCurrent()[0];i>.1*e&&Math.abs(r-this._dofLastFocal)>.075&&t>.1&&this.showDofCross()}},dofUpdateInterpolators:function(e,t){this._interpolatorDofBlurNear.setTarget(this._model.get("dofBlurNear")*t),this._interpolatorDofBlurFar.setTarget(this._model.get("dofBlurFar")*t);var i=this._viewer.getFeaturesManager(),r=i.getViewport3d(),a=m.a.uDofCross.getInternalArray();f.a.getScreenPositionFromWorldPoint(this._model.get("dofFocusPoint"),a),a[0]/=r.width(),a[1]/=r.height();var n=e.getDeltaTime();this._interpolatorDofBlurNear.update(n),this._interpolatorDofBlurFar.update(n),this._interpolatorDofFocal.update(n),this._interpolatorDofCross.update(n);var o=m.a.uDofBlurNearFarFocal.getInternalArray();o[0]=this._interpolatorDofBlurNear.getCurrent()[0],o[1]=this._interpolatorDofBlurFar.getCurrent()[0],o[2]=this._interpolatorDofFocal.getCurrent()[0],m.a.uDofCross.getInternalArray()[2]=this._interpolatorDofCross.getCurrent()[0],this._interpolatorDofCross.isDone()||(y=!0)},_getAttenuationDof:function(e,t){var i=this._viewerOSGJS.getManipulator(),r=i.getHomeBoundingSphere(),a=t>=.01&&Object(o.a)().dofAttenuateSpeed?0:1,n=i.getHomeDistance(i.getHomeBoundingSphere());if(Object(o.a)().dofAttenuateDistance){var s=v.vec3.dist(r.center(),this._currentEye),u=(s-e)/(n-e);a*=Math.max(0,Math.min(1,1-u))}return a},_getCameraMoveFactorSinceLastFocus:function(e){var t=this._viewerOSGJS.getManipulator().getInverseMatrix();v.mat4.getRotation(this._currentRot,t),v.quat.normalize(this._currentRot,this._currentRot);var i=v.quat.dot(this._lastRot,this._currentRot);i=Math.abs(1-i*i),this._viewerOSGJS.getManipulator().getEyePosition(this._currentEye);var r=v.vec3.dist(this._lastEye,this._currentEye);return Math.max(r/e,.1*i)},updateDof:function(e){if(this._model.isEffectiveDof()){var t=g.a.uNearFar.getInternalArray();if(!(t[0]>t[1])){this.updateDofScaleUniform();var i=this._viewerOSGJS.getManipulator(),r=i.getHomeBoundingSphere().radius(),a=this._getCameraMoveFactorSinceLastFocus(r),n=this._getAttenuationDof(r,a),o=!0;this._dofInitialized?this._dofAutoFocus||a>.01?(this._dofAutoFocus=a>1e-5,this.dofPickFocusPoint(),this.dofUpdateShowCross(r,n)):(this._interpolatorDofFocal.setTarget(this.computeFocalDistance()),o=!1):(this._interpolatorDofFocal.setTarget(this.computeFocalDistance()),s.a.getFirstCameraAnimation().isFulfilled()&&(this._dofInitialized=!0)),this.dofUpdateInterpolators(e,n),o&&(v.vec3.copy(this._lastEye,this._currentEye),v.quat.copy(this._lastRot,this._currentRot))}}},updateDofScaleUniform:function(){var e=this._viewer.getFeaturesManager(),t=e.getViewport3d();m.a.uDofScale.getInternalArray()[0]=.0015*t.height()/Object(o.a)().dofRes},updateDirtyEffect:function(){var e=this._viewerOSGJS.getCanvasWidth(),t=this._viewerOSGJS.getCanvasHeight();this._width&&this._height||(this._width=this._height=-1),this._dirty&&(this.onEffectChanged(),this._dirty=!1),e===this._width&&t===this._height||(this._viewer.trigger("resizeCanvas",e,t),this.getNodeIn().resetCameraAttachments(),this._width=e,this._height=t,x=!0,a.a.draw())},updateFade:function(e){var t=this._model.get("vrFading");if(this._model.get("vrStartFade")&&!t&&(this._model.set("vrStartFade",!1),t=!0,this._model.set("vrFading",!0),this._model.set("vrFadeStartTime",e.getSimulationTime())),t){var i=this._model.get("vrFadeStartTime"),r=this._model.get("vrFadeLength"),a=e.getSimulationTime(),n=(a-i)/r,o=this._model.get("vrFadeCallback");a>i+r&&(n=1-(n-1),o&&(o(),this._model.set("vrFadeCallback",void 0)));var s=m.a.uVrFadeFactor.getInternalArray();n>=0?s[0]=n:(s[0]=0,this._model.set("vrFading",!1))}},updateVeil:function(){m.a.uVrVeilFactor.getInternalArray()[0]=this._model.get("veilFactor")},_sssGaussian:function(e,t,i){var r=t/(.001+i);return Math.exp(-r*r/(2*e))/(2*Math.PI*e)},_sssProfile:function(e,t){return.1*this._sssGaussian(.0484,e,t)+.118*this._sssGaussian(.187,e,t)+.113*this._sssGaussian(.567,e,t)+.358*this._sssGaussian(1.99,e,t)+.078*this._sssGaussian(7.41,e,t)},_computeSSSKernel:function(e,t,i,r){var a=Object(o.a)().sssHalfKernel,n=2*a-1,s=0,u=e*a*4,l=u+0,c=u+1,h=u+2,d=u+3,p=this._model.getSSSWeightRange(),f=Math.pow(p,2),m=2*p/(n-1);for(s=0;s<a;s++){var g=p-s*m;t[4*s+d]=p*Math.pow(g,2)/f}for(s=0;s<a;s++){var _=t[4*s+d],v=s>0?Math.abs(_-t[4*(s-1)+d]):0,b=s<a-1?Math.abs(_-t[4*(s+1)+d]):b,y=(v+b)/2;t[4*s+l]=y*this._sssProfile(_,r[0]),t[4*s+c]=y*this._sssProfile(_,r[1]),t[4*s+h]=y*this._sssProfile(_,r[2])}s=a-1;for(var x=t[4*s+l],S=t[4*s+c],M=t[4*s+h],w=t[4*s+d];s>0;s--){var T=4*s,C=4*(s-1);t[T+l]=t[C+l],t[T+c]=t[C+c],t[T+h]=t[C+h],t[T+d]=t[C+d]}t[l]=x,t[c]=S,t[h]=M,t[d]=w;var E=t[l],L=t[c],P=t[h];for(s=1;s<a;s++)E+=2*t[4*s+l],L+=2*t[4*s+c],P+=2*t[4*s+h];for(s=0;s<a;s++)t[4*s+l]/=E,t[4*s+c]/=L,t[4*s+h]/=P;for(t[l]=1*(1-i[0])+i[0]*t[l],t[c]=1*(1-i[1])+i[1]*t[c],t[h]=1*(1-i[2])+i[2]*t[h],s=1;s<a;s++)t[4*s+l]*=i[0],t[4*s+c]*=i[1],t[4*s+h]*=i[2]},updateSSS:function(){m.a.uProjFactor.getInternalArray()[0]=this.getClampedProjectionMatrix()[0];var e=n.a.getModelBoxWithoutDisplacement();if(e){var t=e.radius(),i=g.a.uScatteringFactorPacker.getInternalArray(),r=t*d.a.getBoxFactor("SubsurfaceScattering");i[0]=1/r;g.a.uNormalizeFactorThickness.getInternalArray()[0]=.2*t*.25}if(!this._model.get("sssKernelDone")){this._model.set("sssKernelDone",!0);for(var a=this._model.get("sssProfiles"),s=a.length,u=Object(o.a)().sssHalfKernel,l=new Float32Array(4*s*u),c=0,h=a.length;c<h;c++){var p=a[c];this._computeSSSKernel(c,l,p.strength,p.falloff)}var f=this._view3d._sssTexKernel;if(f.setTextureSize(u,s),f.setMinFilter(v.Texture.LINEAR),f.setMagFilter(v.Texture.LINEAR),this._model.useSSSLookupFloat())return f.setImage(l,v.Texture.RGBA),void f.setInternalFormatType(v.Texture.FLOAT);var _=new Uint8Array(4*u*s),b=this._model.getSSSWeightRange();for(c=0;c<u*s;++c){var y=4*c;_[y]=Math.floor(255*l[y]),_[y+1]=Math.floor(255*l[y+1]),_[y+2]=Math.floor(255*l[y+2]),_[y+3]=Math.floor(l[y+3]/b*255)}f.setImage(_,v.Texture.RGBA),f.setInternalFormatType(v.Texture.UNSIGNED_BYTE)}},updateSsao:function(){if(this._model.isEffectiveSsao()){var e=g.a.uNearFar.getInternalArray();if(!(e[0]>e[1])){var t=this._viewer.getFeaturesManager(),i=t.getViewport3d(),r=this.getClampedProjectionMatrix(),a=1===r[15]?1:2/r[5],n=-2*Math.tan(.5*a);m.a.uSsaoProjectionScale.setFloat(i.height()/n);var o=m.a.uSsaoProjectionInfo.getInternalArray();o[0]=-2/(i.width()*r[0]),o[1]=-2/(i.height()*r[5]),o[2]=(1-r[8])/r[0],o[3]=(1-r[9])/r[5]}}},updateViewSpaceCorners:function(){var e=[v.vec4.fromValues(-1,-1,0,1),v.vec4.fromValues(-1,1,0,1),v.vec4.fromValues(1,-1,0,1),v.vec4.fromValues(1,1,0,1)],t=v.mat4.create(),i=v.vec3.create();return function(r,a){v.mat4.invert(t,r);for(var n=0;n<4;n++)v.vec3.transformMat4(i,e[n],t),a[2*n]=i[0]/i[2],a[2*n+1]=i[1]/i[2]}}(),updateTaaMatrices:function(e,t,i){v.mat4.invert(i.invViewMatrix.getInternalArray(),e);var r=i.lastFrame.getInternalArray(),a=i.currentFrame.getInternalArray();v.mat4.copy(r,a),v.mat4.multiply(a,t,e),this._firstFrame&&v.mat4.copy(r,a),this.updateViewSpaceCorners(t,i.corners.getInternalArray())},updateTAA:function(){var e=v.mat4.create();return function(){var t=g.a.uNearFar.getInternalArray();if(t[0]>t[1]||!this._model.get("taaEnable"))return void m.a.uTaaEnabled.setFloat(0);var i,r=this._viewer.getCamera().getViewMatrix(),a=this._cullConfig.doVR;a?(v.mat4.multiply(e,this._cullConfig.leftOffsetView,r),i=this._cullConfig.leftProjection):(e=r,i=this.getClampedProjectionMatrix());var n=m.a;this.updateTaaMatrices(e,i,{invViewMatrix:n.uTaaInvViewMatrixLeft,lastFrame:n.uTaaLastFramePVLeft,currentFrame:n.uTaaCurrentFramePVLeft,corners:n.uTaaCornersCSLeft}),a&&(v.mat4.multiply(e,this._cullConfig.rightOffsetView,r),this.updateTaaMatrices(e,this._cullConfig.rightProjection,{invViewMatrix:n.uTaaInvViewMatrixRight,lastFrame:n.uTaaLastFramePVRight,currentFrame:n.uTaaCurrentFramePVRight,corners:n.uTaaCornersCSRight})),this._firstFrame&&(this._firstFrame=!1);var o=this._viewer.getFeatures().animation.getModel(),s=0===this._skipTaaFrames&&o.canActivateTAA();m.a.uTaaEnabled.setFloat(s?1:0),this._skipTaaFrames>0&&--this._skipTaaFrames}}(),updateNearFarRatio:function(){var e,t=this._viewer.getFeatures();if(this._model.get("webVR")){var i=n.a.getModelBoxWithDisplacement(),r=i?i.radius():1,a=t.webVR.getModel().get("worldFactor")/r;e=a>0?.005*Math.max(.1,a):.005}else e=t.camera.getModel().get("nearFarRatio");this.getMainCamera().setNearFarRatio(e)},updateGlobalTexUniforms:function(){var e=this._viewer.getFeaturesManager(),t=g.a.uGlobalTexSize.getInternalArray(),i=g.a.uGlobalTexRatio.getInternalArray(),r=g.a.uHalton.getInternalArray();g.a.uPreviousGlobalTexSize.setFloat2(t),g.a.uPreviousGlobalTexRatio.setFloat2(i),g.a.uPreviousHalton.setFloat4(r);var a=e.getViewport3d();t[0]=a.width(),t[1]=a.height();var n=this.getCurrentComposer();i[0]=n.getGlobalXRatio(),i[1]=n.getGlobalYRatio();var o=n.getInternalTexture("TextureToBeRefracted");if(o||this._model.isEffectiveSsr()){var s=g.a.uTextureToBeRefractedSize.getInternalArray();if(s[0]=o.getWidth(),s[1]=o.getHeight(),!this._model.get("taaEnable")){var u=this.getClampedProjectionMatrix(),l=m.a.uTaaCornersCSLeft.getInternalArray();this.updateViewSpaceCorners(u,l)}}},_shadowJitterUpdate:function(e){if(_.a.get("mask")&_.a.LIT){var t=1+e;g.a.uStaticFrameNumShadow0.setFloat(t),g.a.uStaticFrameNumShadow1.setFloat(t),g.a.uStaticFrameNumShadow2.setFloat(t),g.a.uStaticFrameNumShadow3.setFloat(t)}},updateGlobalUniforms:function(e){this.updateNearFarRatio(),this.updateGlobalTexUniforms(),g.a.uTimeViewer.setFloat(e.getSimulationTime()/1e3);var t=n.a.getModelBoxWithDisplacement();g.a.uBoxRadius.setFloat(t?t.radius():1),g.a.uPixelRatio.setFloat2(p.a.getPixelRatio());var i=e.getFrameNumber()%16;this._shadowJitterUpdate(i),g.a.uFrameMod.setFloat(i);var r=this._viewer.getSuperSample().isEnabled(),a=r||m.a.uTaaEnabled.getInternalArray()[0];g.a.uFrameModTaaSS.setFloat(a?i:0);var o=g.a.uReprojectViewProj.getInternalArray(),s=g.a.uPreviousProjection.getInternalArray(),u=g.a.uPreviousViewInvView.getInternalArray(),l=this._viewer.getCamera(),c=l.getViewMatrix(),h=this._cullConfig.doVR?this._cullConfig.leftProjection:this.getClampedProjectionMatrix();this._tmpView?(v.mat4.invert(u,c),v.mat4.mul(u,this._tmpView,u),v.mat4.mul(o,this._tmpProjection,u),v.mat4.copy(s,this._tmpProjection),v.mat4.copy(this._tmpView,c),v.mat4.copy(this._tmpProjection,h)):(this._tmpView=v.mat4.clone(c),this._tmpProjection=v.mat4.clone(h),v.mat4.copy(o,h))},cull:function(e,t){if(t.traverse(e),!this._model.get("postProcessReady"))return!1;var i=t.getFrameStamp();return this.updateTAA(i),this.updateSSS(i),this.updateSsao(i),this.updateGrain(i),this.updateDof(i),this.updateFade(i),this.updateVeil(i),this.updateDirtyEffect(),this.updateGlobalUniforms(i),!1}}),t.a=M},function(e,t,i){"use strict";var r=i(62),a=i(1303),n=i(1304),o={FeatureName:"outline",ModelType:a.a,ViewListType:[n.a]},s=r.a.create(o);s.prototype.getNode=function(){return this._views[0].getNodeOutline()},s.prototype.prepareForScreenShot=function(){return this.getNode().hideOutline(),!1},t.a=s},function(e,t,i){"use strict";var r=i(5),a=i(15),n=i.n(a),o=r.a.osg,s=n.a.Model.extend({defaults:{colorSelection:o.vec3.fromValues(1,1,0),colorHover:o.vec3.fromValues(1,.5,0),durationOutline:-1,durationHighlight:-1},getName:function(){return"Outline"}});t.a=s},function(e,t,i){"use strict";var r=i(5),a=i(8),n=i(1305),o=i(1306),s=r.a.osg,u=a.a.extend({initialize:function(){a.a.prototype.initialize.apply(this,arguments),this._viewer=this.options.context.getViewer(),this._viewerOSGJS=this._viewer.getViewerOSGJS();var e=this.model;e.bind("change:colorSelection",this.onColorSelectionChanged,this),e.bind("change:colorHover",this.onColorHoverChanged,this),e.bind("hideOutline",this.onHideOutline,this),e.bind("hideHighlight",this.onHideHighlight,this),e.bind("clearFocusTimeout",this.onClearFocusTimeout,this),this._nodeOutline=new n.a(this._viewer),this._nodeOutline.setName("Feature - Outline"),this.onColorSelectionChanged(),this.onColorHoverChanged(),this.model.bind("displayOutlineFocus",this._onMaterialChange.bind(this,!0)),this.model.bind("displayOutlineNoFocus",this._onMaterialChange.bind(this,!1))},getNodeOutline:function(){return this._nodeOutline},onColorSelectionChanged:function(){this._nodeOutline.setColorSelection(this.model.get("colorSelection"))},onColorHoverChanged:function(){this._nodeOutline.setColorHover(this.model.get("colorHover"))},onHideOutline:function(){this._nodeOutline.hideOutline()},onHideHighlight:function(){this._nodeOutline.hideHighlight()},onClearFocusTimeout:function(){void 0!==this._timer&&(window.clearTimeout(this._timer),this._timer=void 0)},_focusOnBound:function(e){var t=this._viewer.getFeaturesManager(),i=e.getBoundingBox(),r=this._nodeOutline;this.onClearFocusTimeout(),this._timer=window.setTimeout(function(){t.focusOnBound(i,1)||t.focusOnHomePosition(1),r.showOutline()},200)},_onMaterialChange:function(){var e=new o.a;return function(t,i,r){var a=this._viewer.getFeaturesManager();if(a){e.setStateSet(i||r),a.getWorldNode().accept(e);var n=e._paths;if(0===n.length)return void s.error("Cound not find nodes attached to the stateset.");t&&this._focusOnBound(e),this._nodeOutline.clearOutlineScene(),i?(this._nodeOutline.addPaths(n),r&&(e.setStateSet(r),a.getWorldNode().accept(e),this._nodeOutline.addPathsHover(e._paths))):this._nodeOutline.addPathsHover(n),this._nodeOutline.setDurationOutline(1e3*this.model.get("durationOutline")),this._nodeOutline.setDurationHighlight(1e3*this.model.get("durationHighlight")),t||this._nodeOutline.showOutline()}}}()});t.a=u},function(e,t,i){"use strict";var r=i(5),a=i(43),n=i(57),o=i(612),s=i(37),u=i(251),l=i(63),c=i(615),h=r.a.osg,d=r.a.osgUtil,p=h.StateAttribute.OVERRIDE_ON,f=function(e){h.Node.call(this),this._viewerWebGL=e,this._viewerOSGJS=e.getViewerOSGJS(),this._durationOutline=5e3,this._timerOutline=void 0,this._durationHighlight=5e3,this._timerHighlight=void 0,this._nodeProxy=new h.Node,this._outlineScene=new h.Node,this._paths=void 0,this._cbHideHighlight=this.hideHighlight.bind(this),this._cbHideOutline=this.hideOutline.bind(this);var t=l.a.DEPTH_DISABLE;this._stateSetSelection=new h.StateSet,this._uColorSelection=h.Uniform.createFloat3("uOutlineColor"),this._stateSetSelection.addUniform(this._uColorSelection),this._stateSetSelection.setAttributeAndModes(t,p),this._stateSetHover=new h.StateSet,this._uColorHover=h.Uniform.createFloat3("uOutlineColor"),this._stateSetHover.addUniform(this._uColorHover),this._stateSetHover.setAttributeAndModes(t,p),this._uOutlineFactor=h.Uniform.createFloat(.25,"uOutlineFactor"),this._uHighlightFactor=h.Uniform.createFloat(0,"uHighlightFactor"),this.init()};h.createPrototypeNode(f,h.objectInherit(h.Node.prototype,{getComposer:function(){return this._composer},setColorSelection:function(e){h.vec3.copy(this._uColorSelection.getInternalArray(),e)},setColorHover:function(e){h.vec3.copy(this._uColorHover.getInternalArray(),e)},setDurationHighlight:function(e){this._durationHighlight=e},setDurationOutline:function(e){this._durationOutline=e},showOutline:function(){u.a.setOutline(!0),this._nodeProxy.setNodeMask(a.a.NO_PICK_NO_SHADOW),this._clearTimeoutOutline(),this._durationOutline>=0&&(this._timerOutline=setTimeout(this._cbHideOutline,this._durationOutline)),this._uHighlightFactor.setFloat(.15),this._clearTimeoutHighlight(),this._durationHighlight>=0&&this._durationHighlight<this._durationOutline&&(this._timerHighlight=setTimeout(this._cbHideHighlight,this._durationHighlight)),s.a.draw()},hideOutline:function(){this._nodeProxy.setNodeMask(0),this._clearTimeoutOutline(),this.hideHighlight(),s.a.draw()},hideHighlight:function(){this._uHighlightFactor.setFloat(0),this._clearTimeoutHighlight(),s.a.draw()},_clearTimeoutOutline:function(){void 0!==this._timerOutline&&(clearTimeout(this._timerOutline),this._timerOutline=void 0)},_clearTimeoutHighlight:function(){void 0!==this._timerHighlight&&(clearTimeout(this._timerHighlight),this._timerHighlight=void 0)},clearOutlineScene:function(){for(var e=this._outlineScene,t=e.getChildren(),i=0,r=t.length;i<r;++i)t[i].removeChildren();e.removeChildren()},addPaths:function(){var e=function(e){this._path=e};return h.createPrototypeObject(e,{update:function(t){return t.setMatrix(h.computeLocalToWorld(this._path)),e}}),function(t,i){for(var r=this._outlineScene,a=i?this._stateSetHover:this._stateSetSelection,n=0,s=t.length;n<s;++n){var u=t[n],l=new h.MatrixTransform;r.addChild(l),l.addChild(u[u.length-1]),l.setStateSet(a),Object(o.a)(u)?l.addUpdateCallback(new e(u)):l.setMatrix(h.computeLocalToWorld(u))}}}(),addPathsHover:function(e){this.addPaths(e,!0)},createSubSceneRtt:function(e){var t=new h.Camera;t.setName("Outline Camera"),t.setClearColor(h.vec4.create()),t.setRenderOrder(h.Camera.PRE_RENDER,0),t.attachTexture(h.FrameBufferObject.COLOR_ATTACHMENT0,e);var i=t.getOrCreateStateSet();return i.setShaderGeneratorName("outline",p),i.setAttribute(new c.a),t},init:function(){var e=l.a.CULL_DISABLE;this._outlineScene.getOrCreateStateSet().setAttributeAndModes(e,p);var t=this._createComposer();this._composer=t;var i=t.getInternalTexture("TextureOutline"),r=this.createSubSceneRtt(i);this._cameraRtt=r,r.addChild(this._outlineScene),this._nodeProxy.addChild(r),this._nodeProxy.addChild(t),this.addChild(this._nodeProxy),this._nodeProxy.setNodeMask(0)},_createComposer:function(){var e=new d.ComposerPostProcess,t=this._viewerOSGJS;e.setMethodWrapUV(1,1),e.setScreenSize(t.getCanvasWidth(),t.getCanvasHeight()),e.setFinalPassUpScaleToScreen(!1),e.addInternalTexture({name:"TextureOutline",immuable:!0,srgb:!0,rgbm:!1}),e.build({func:"outline",textures:["TextureOutline"],uniforms:[this._uOutlineFactor,this._uHighlightFactor],out:{name:"%next"}});var i=e.getStateSetPass("outline"),r=l.a.BLEND_SUBSTRACTIVE;return i.setAttributeAndModes(r),i.setRenderBinDetails(n.a.OUTLINE,"RenderBin"),this._viewerWebGL.bind("resizeCanvas",e.resize,e),this._viewerWebGL.bind("resizeRatio",e.resizeRatio,e),e}}),"osgSketchfab","Outline"),t.a=f},function(e,t,i){"use strict";var r=i(5),a=r.a.osg,n=r.a.osgAnimation,o=function(e){a.ComputeBoundsVisitor.call(this),this._paths=[],this.setStateSet(e)};a.createPrototypeObject(o,a.objectInherit(a.ComputeBoundsVisitor.prototype,{reset:function(){a.ComputeBoundsVisitor.prototype.reset.call(this),this._pushIfGeo=!1,this._paths.length=0,this._bonesBoxMatrix={},this._usedBones={}},setStateSet:function(e){this.reset(),this._stateSet=e},getBoundingBox:function(){var e=new a.BoundingBox;return function(){for(var t in this._usedBones){var i=this._bonesBoxMatrix[t];i&&(e.copy(i.box),e.transformMat4(e,i.matrix),this._bb.expandByBoundingBox(e))}return this._bb}}(),apply:function(e){var t=e.getStateSet(),i=this._pushIfGeo;if(t&&void 0!==t._materialID&&(this._pushIfGeo=t===this._stateSet),this._pushIfGeo&&e instanceof a.Geometry&&(this._paths.push(this.nodePath.slice(0)),e instanceof n.RigGeometry)){var r=e.getBoneNameID();for(var o in r)this._usedBones[o]=1}a.ComputeBoundsVisitor.prototype.apply.call(this,e),this._pushIfGeo=i},pushMatrix:function(e){var t=this.nodePath[this.nodePath.length-1];if(t instanceof n.Bone){var i=t.getBoneBoundingBox();i.valid()&&(this._bonesBoxMatrix[t.getName()]={matrix:a.mat4.clone(e),box:i})}a.ComputeBoundsVisitor.prototype.pushMatrix.call(this,e)},applyBoundingBox:function(e){this._pushIfGeo&&a.ComputeBoundsVisitor.prototype.applyBoundingBox.call(this,e)}})),t.a=o},function(e,t,i){"use strict";var r=i(62),a=i(1308),n=i(1313),o={FeatureName:"webVR",ModelType:a.a,ViewListType:[n.a]},s=r.a.create(o);s.prototype.getNode=function(){return this._views[0].getNodeWebVR()},s.prototype.getWidgetNode=function(){return this._views[0].getProxyWebVR()},s.prototype.prepareForScreenShot=function(){var e=r.a.prototype.prepareForScreenShot.call(this);return e&&this._views[0].setPauseUpdate(!0),e},s.prototype.resetAfterScreenShot=function(){r.a.prototype.resetAfterScreenShot.call(this),this._views[0].setPauseUpdate(!1)},t.a=s},function(e,t,i){"use strict";var r=i(5),a=i(16),n=i(1309),o=i(1311),s=i(79),u=i(34),l=i(120),c=r.a.osg;Object(a.a)().vrForceRaf&&(r.a.osgViewer.Viewer.prototype.setVRDisplay=function(e){this._hmd=e,this._requestAnimationFrame=e.requestAnimationFrame.bind(e)});var h=l.a.extend({getModelOptionPath:function(){return"vr"},defaults:{enable:!1,deviceInfo:void 0,modeLauncher:!1,hit:void 0,hasNativeHMD:!1,humanMatrix:c.mat4.create(),humanInAir:!1},init:function(e){this._context=e,this._scene=e.getScene(),this._viewer=e.getViewer()},initAfterFirstFrame:function(){this.set("deviceInfo",this._initDeviceInfo());var e=this._context.getModel().get("options").vr;e&&e.worldFactor>0&&this.setJSON(e),this.initBoundAndWorldFactor(),this.set("enable",Object(a.a)().cardboard>0)},onVrDisplayReady:function(e){u.a.getVrDisplayReady().isFulfilled()?e():u.a.getVrDisplayReady().then(function(){e()})},_getBoundRadius:function(){return s.a.getModelBoxWithDisplacement().radius()},isDiorama:function(){return this._getBoundRadius()<2*this.get("worldFactor")},getMinimumWorldFactor:function(){return.001*this._getBoundRadius()},setLastControllerHit:function(e){this._lastControllerHit=e},getlastControllerHit:function(){return this._lastControllerHit},getMaximumWorldFactor:function(){return 10*this._getBoundRadius()},getDefaultHumanHeight:function(){return 1.65},_makeValidWorldFactor:function(){var e=this.get("worldFactor"),t=this.getMinimumWorldFactor(),i=this.getMaximumWorldFactor();if(e<t*s.a.BIAS_MIN||e>i*s.a.BIAS_MAX){var r=s.a.getModelBoxWithDisplacement(),a=r.getMin()[2],n=r.radius();this.set("worldFactor",.5*n),this.set("floorHeight",a);var o=r.center(c.vec3.create());o[1]-=1.2*n,o[2]=a,c.mat4.fromTranslation(this.get("humanMatrix"),o)}else this.set("worldFactor",Math.min(Math.max(e,t),i))},initBoundAndWorldFactor:function(){this._makeValidWorldFactor(),this.trigger("uiReady")},_initDeviceInfo:function(){var e=new o.a(!1),t=new n.a(e.getDeviceParams());return Object(a.a)().cardboard>1&&t.setViewer(n.a.Viewers.CardboardV2),t},getName:function(){return"WebVR"},setJSON:function(e,t){var i=t||{};i.ignore=["initialCamera"];var r=l.a.prototype.setJSON.call(this,e,i),a=this.get("humanMatrix"),n=e.initialCamera;return c.mat4.fromQuat(a,n.rotation),c.mat4.setTranslation(a,n.position),r},getJSON:function(){var e=c.mat4.copy(c.mat4.create(),this.get("humanMatrix")),t=c.mat4.getScale(c.vec3.create(),e);c.vec3.set(t,1/t[0],1/t[1],1/t[2]);var i=c.mat4.scale(e,e,t),r=c.quat.create();c.quat.normalize(r,c.mat4.getRotation(r,i));var a=l.a.prototype.getJSON.call(this,{ignore:"initialCamera"});return a.initialCamera={position:c.mat4.getTranslation(c.vec3.create(),i),rotation:r},a}});t.a=h},function(e,t,i){"use strict";function r(e){this.viewer=f.CardboardV1,this.updateDeviceParams(e)}var a=i(5),n=i(1310),o=i(708),s=a.a.osg,u=180/Math.PI,l=Math.PI/180,c=function(e){this.id=e.id,this.label=e.label,this.fov=e.fov,this.interLensDistance=e.interLensDistance,this.baselineLensDistance=e.baselineLensDistance,this.screenLensDistance=e.screenLensDistance,this.distortionCoefficients=e.distortionCoefficients,this.inverseCoefficients=e.inverseCoefficients},h=function(e){this.width=e.width||o.a.getScreenWidth(),this.height=e.height||o.a.getScreenHeight(),this.widthMeters=e.widthMeters,this.heightMeters=e.heightMeters,this.bevelMeters=e.bevelMeters},d=new h({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),p=new h({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),f={CardboardV1:new c({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new c({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};r.prototype.updateDeviceParams=function(e){this.device=this.determineDevice_(e)||this.device},r.prototype.getDevice=function(){return this.device},r.prototype.setViewer=function(e){this.viewer=e},r.prototype.determineDevice_=function(e){if(!e)return o.a.isIOS()?p:d;var t=.0254/e.xdpi,i=.0254/e.ydpi,r=o.a.getScreenWidth(),a=o.a.getScreenHeight();return new h({widthMeters:t*r,heightMeters:i*a,bevelMeters:.001*e.bevelMm})},r.prototype.getDistortedFieldOfViewLeftEye=function(){var e=this.viewer,t=this.device,i=new n.a(e.distortionCoefficients),r=e.screenLensDistance,a=(t.widthMeters-e.interLensDistance)/2,o=e.interLensDistance/2,s=e.baselineLensDistance-t.bevelMeters,l=t.heightMeters-s,c=u*Math.atan(i.distort(a/r)),h=u*Math.atan(i.distort(o/r)),d=u*Math.atan(i.distort(s/r)),p=u*Math.atan(i.distort(l/r));return{leftDegrees:Math.min(c,e.fov),rightDegrees:Math.min(h,e.fov),downDegrees:Math.min(d,e.fov),upDegrees:Math.min(p,e.fov)}},r.prototype.getFieldOfViewLeftEye=function(e){return e?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},r.prototype.getFieldOfViewRightEye=function(e){var t=this.getFieldOfViewLeftEye(e);return{leftDegrees:t.rightDegrees,rightDegrees:t.leftDegrees,upDegrees:t.upDegrees,downDegrees:t.downDegrees}},r.prototype.getProjectionMatrixLeftEye=function(e){var t=this.getFieldOfViewLeftEye(e),i=s.mat4.create(),r=.1*Math.tan(l*t.leftDegrees),a=.1*Math.tan(l*t.rightDegrees),n=.1*Math.tan(l*t.downDegrees),o=.1*Math.tan(l*t.upDegrees);return s.mat4.frustum(i,-r,a,-n,o,.1,1e3),i},r.prototype.getUndistortedViewportLeftEye=function(){var e=this.getUndistortedParams_(),t=this.viewer,i=this.device,r=t.screenLensDistance,a=i.widthMeters/r,n=i.heightMeters/r,o=i.width/a,s=i.height/n,u=Math.round((e.eyePosX-e.outerDist)*o),l=Math.round((e.eyePosY-e.bottomDist)*s);return{x:u,y:l,width:Math.round((e.eyePosX+e.innerDist)*o)-u,height:Math.round((e.eyePosY+e.topDist)*s)-l}},r.prototype.getUndistortedFieldOfViewLeftEye=function(){var e=this.getUndistortedParams_();return{leftDegrees:u*Math.atan(e.outerDist),rightDegrees:u*Math.atan(e.innerDist),downDegrees:u*Math.atan(e.bottomDist),upDegrees:u*Math.atan(e.topDist)}},r.prototype.getUndistortedParams_=function(){var e=this.viewer,t=this.device,i=new n.a(e.distortionCoefficients),r=e.screenLensDistance,a=e.interLensDistance/2/r,o=t.widthMeters/r,s=t.heightMeters/r,u=o/2-a,c=(e.baselineLensDistance-t.bevelMeters)/r,h=e.fov,d=i.distortInverse(Math.tan(l*h)),p=Math.min(u,d),f=Math.min(a,d),m=Math.min(c,d);return{outerDist:p,innerDist:f,topDist:Math.min(s-c,d),bottomDist:m,eyePosX:u,eyePosY:c}},r.Viewers=f,t.a=r},function(e,t,i){"use strict";var r=function(e){this.coefficients=e};r.prototype.distortInverse=function(e){for(var t=e/.9,i=.9*e,r=e-this.distort(t);Math.abs(i-t)>1e-4;){var a=e-this.distort(i),n=i-a*((i-t)/(a-r));t=i,i=n,r=a}return i},r.prototype.distort=function(e){return e*this.distortionFactor_(e)},r.prototype.distortionFactor_=function(e){for(var t=1,i=1,r=e*e,a=0;a<this.coefficients.length;a++){var n=this.coefficients[a];i*=r,t+=n*i}return t},t.a=r},function(e,t,i){"use strict";var r=i(1312),a=i(708),n=function(e){this.xdpi=e.xdpi,this.ydpi=e.ydpi,this.bevelMm=e.bevelMm},o=function(e,t){if(this.dpdb=r.a,this.recalculateDeviceParams_(),e){this.onDeviceParamsUpdated=t;var i=new XMLHttpRequest,a=this;i.open("GET","https://dpdb.webvr.rocks/dpdb.json",!0),i.addEventListener("load",function(){a.loading=!1,i.status>=200&&i.status<=299&&(a.dpdb=JSON.parse(i.response),a.recalculateDeviceParams_())}),i.send()}};o.prototype.getDeviceParams=function(){return this.deviceParams},o.prototype.recalculateDeviceParams_=function(){var e=this.calcDeviceParams_();e&&(this.deviceParams=e,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams))},o.prototype.calcDeviceParams_=function(){var e=this.dpdb;if(!e)return null;if(1!==e.format)return null;if(!e.devices||!e.devices.length)return null;var t=navigator.userAgent||navigator.vendor||window.opera,i=a.a.getScreenWidth(),r=a.a.getScreenHeight();if(!e.devices)return null;for(var o=0;o<e.devices.length;o++){var s=e.devices[o];if(s.rules&&(("ios"===s.type||"android"===s.type)&&a.a.isIOS()===("ios"===s.type))){for(var u=!1,l=0;l<s.rules.length;l++){var c=s.rules[l];if(this.matchRule_(c,t,i,r)){u=!0;break}}if(u){var h=s.dpi[0]||s.dpi,d=s.dpi[1]||s.dpi;return new n({xdpi:h,ydpi:d,bevelMm:s.bw})}}}return null},o.prototype.matchRule_=function(e,t,i,r){if(!e.ua&&!e.res)return!1;if(e.ua&&t.indexOf(e.ua)<0)return!1;if(e.res){if(!e.res[0]||!e.res[1])return!1;var a=e.res[0],n=e.res[1];if(Math.min(i,r)!==Math.min(a,n)||Math.max(i,r)!==Math.max(a,n))return!1}return!0},t.a=o},function(e,t,i){"use strict";var r={format:1,last_updated:"2017-08-27T14:39:31Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3}]};t.a=r},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(5)),n=i(8),o=i(34),s=i(558),u=i(37),l=i(708),c=i(57),h=i(43),d=i(16),p=i(419),f=i.n(p),m=i(865),g=i(42),_=i.n(g),v=i(1314),b=i(1317),y=i(1320),x=i(1323),S=i(1326),M=i(1327),w=i(119),T=i(63),C=i(145),E=i(146),L=a.a.osg,P=a.a.osgUtil,A=a.a.InputGroups,D=new f.a({device:"VWR",listen:!0}),O=n.a.extend({initialize:function(){n.a.prototype.initialize.apply(this,arguments);var e=this.model;e.bind("change:enable",this.onEnable,this),e.bind("change:worldFactor",this.onWorldFactor,this),e.bind("change:floorHeight",this.onFloorHeight,this),e.bind("doubleTap",this.onDoubleTap,this),e.bind("snapHumanOnFloor",this.snapHumanOnFloor,this),this._standaloneViewer=!Object(d.a)().messaging,D.on("message:requestPresent",this.onRequestPresent,this),this._viewer=this.options.context.getViewer(),this._viewerOSGJS=this._viewer.getViewerOSGJS(),this._manipulator=this._viewerOSGJS.getManipulator(),this._cullConfig=s.a.vrConfig,this._lastSelectedHotspot=void 0,this._lastHoveredHotspot=void 0,this._lastFloorHeight=0,this._lastTime=0,this._lastWorldFactor=-1,this._lastMouse=L.vec2.create(),this._interpolatorAlpha=new P.DelayInterpolator(1),this._interpolatorAlpha.setDelay(.1),this._webvrMaxHeight=this.getWebVRMaxHeight(),this._nodeWebVR=new L.Node,this._nodeWebVR.setName("Feature - WebVR"),this._proxyVR=new L.Node,this._proxyVR.setName("WebVR - Proxy"),this._proxyVR.setNodeMask(0),this._floorMT=new x.a(e),this._humanMT=new v.a(e),this._teleportNode=new b.a,this._cursorMT=new y.a,this._controllerMT=new S.a(e,this._viewer.getInputManager()),this._nodeMenu=new M.a(e),this._nodeMenu.setHomeAction(this._exitVR.bind(this)),this._nodeMenu.setNextAction(this.goToNextHotspot.bind(this)),this._nodeMenu.setPrevAction(this.goToPrevHotspot.bind(this)),this._dataDownloaded=!1,this._scaleControlEnabled=!0,this._frameData=void 0,this.onFloorHeight(),this.initGraphNodes(),this.hookComputeCanvasSize(),C.a.initWebVR(this),this._onVrDisplayActivateBinded=this._onVrDisplayActivate.bind(this),this._onVrDisplayDeactivateBinded=this._onVrDisplayDeactivate.bind(this),this._onVrDisplayPresentChangeBinded=this._onVrDisplayPresentChange.bind(this),this._onVrDisplayPointerRestrictedBinded=this._onVrDisplayPointerRestricted.bind(this),this._onVrDisplayPointerUnrestrictedBinded=this._onVrDisplayPointerUnrestricted.bind(this),this._viewerOSGJS.getInputManager().getInputSource("WebVR").pollHeadset(),o.a.getModelDisplayed().then(this.initWebVR.bind(this))},getNodeWebVR:function(){return this._nodeWebVR},getProxyWebVR:function(){return this._proxyVR},getWebVRMaxHeight:function(){return _.a.any?Math.min(window.screen.width,window.screen.height)*Math.min(2.5,window.devicePixelRatio):-1},_onVrDisplayPointerRestricted:function(){this._viewer.getCanvas().requestPointerLock()},_onVrDisplayPointerUnrestricted:function(){document.exitPointerLock()},onRequestPresent:function(e){this._standaloneViewer?L.log("Launcher onRequestPresent"):L.log("Viewer onRequestPresent"),this.startEnable(!0,!0),e.removeFromHash()},initWebVR:function(){this._nodeWebVR.addUpdateCallback(this)},setProxyVisible:function(e){this._proxyVR.setNodeMask(e?h.a.NO_SHADOW:0)},onDoubleTap:function(e){if(!this.model.get("enable")&&-1===e._nodePath.indexOf(this._humanMT)){var t=L.vec3.create();w.a.getWorldPositionFromHit(e,t),L.mat4.setTranslation(this._humanMT.getMatrix(),t),u.a.draw()}},scaleUp:function(){var e=this.model.get("worldFactor");e<=0||this.model.set("worldFactor",1.2*e)},scaleDown:function(){var e=this.model.get("worldFactor");e<=0||this.model.set("worldFactor",e*(1/1.2))},savePosition:function(e){this._lastMouse[0]=e.canvasX,this._lastMouse[1]=e.canvasX},onFloorHeight:function(){var e=this.model.get("floorHeight"),t=.05*this.model.get("worldFactor");Math.abs(this._humanMT.getMatrix()[14]-this._lastFloorHeight)<=t&&(this._humanMT.getMatrix()[14]=e),this._floorMT.getMatrix()[14]=e,this._lastFloorHeight=e},initGraphNodes:function(){this._nodeWebVR.addChild(this._proxyVR),this._proxyVR.addChild(this._floorMT),this._proxyVR.addChild(this._humanMT),this._proxyVR.addChild(this._teleportNode),this._proxyVR.addChild(this._cursorMT),this._proxyVR.addChild(this._controllerMT),this._proxyVR.addChild(this._nodeMenu);var e=this._proxyVR.getOrCreateStateSet();e.setRenderBinDetails(c.a.TRANSPARENT_NO_EARLYZ_POST,"RenderBin"),e.setAttributeAndModes(T.a.DEPTH_LESS_NO_WRITE),e.setAttributeAndModes(T.a.CULL_DISABLE)},resetCameraToHuman:function(){var e=L.vec3.create(),t=L.vec3.create(),i=L.mat4.create(),r=L.vec3.create();return function(){var a=this.getConfigWebVR(),n=a.capabilities.hasPosition&&a.stageParameters,o=L.mat4.copy(i,this._humanMT.getMatrix());L.mat4.getScale(e,o),L.vec3.set(e,1/e[0],1/e[1],1/e[2]),L.mat4.scale(o,o,e);var s=this._manipulator.getFirstPersonManipulator(),u=s.getPostMultRotate();L.quat.normalize(u,L.mat4.getRotation(u,o)),s.setResetInitialRotationVR(!0),L.mat4.getTranslation(t,o),n&&L.mat4.equals(L.mat4.IDENTITY,n.sittingToStandingTransform)&&this.handleBuggyStandingTransform(a,3),t[2]+=this.getEyeLevel(),L.vec3.set(r,0,1,0),L.vec3.transformQuat(r,r,u),L.vec3.add(r,t,r),this._viewer.getFeaturesManager().focusOnTargetAndEye(r,t)}}(),requestData:function(e,t){var i=this.model.get("modeLauncher");!e||i||this._dataDownloaded||(this._dataDownloaded=!0,this._teleportNode.initTextureTeleport(),this._floorMT.initTextureFloor(),this._nodeMenu.initialize(t))},notifyPresentVR:function(){this._startPresentTime=L.Timer.instance().tick();var e=this.model.get("enable"),t=this.model.get("modeLauncher");if(e&&(this._resetOnNextFrame=!0),t&&(this._scaleControlEnabled=!1,Object(d.a)().vrInNavigation)){var i=window.location.origin+window.location.pathname;i+=window.location.search+"&vr_in_navigation=1"+window.location.hash,window.history.pushState({vr_in_navigation:1},"vr started",i)}var r;this._standaloneViewer?!e&&t&&(L.log("Launcher sending requestPresent"),r=D.createMessage({data:"requestPresent"}),r.appendToHash(),L.log("Launcher sent requestPresent")):(L.log("Viewer enable after Promise"+e),e||(L.log("Viewer SendingExit"),r=D.createMessage({data:"exit"}),r.appendToHash(),L.log("Viewer SentExit")))},_exitVR:function(){if(Object(d.a)().vrLinkNavigation)return void window.history.back();if(Object(d.a)().isApp){D.createMessage({data:"exit"}).appendToHash()}else this.model.set("enable",!1)},startEnable:function(e,t){var i=this._viewer.getFeatures();this.setProxyVisible(e),this.requestData(e,i),this.updateDistortion(),i.background.getModel().set("webVR",e&&!Object(d.a)().vrAr),i.camera.getModel().set("webVR",e),i.hotspot.getModel().set("webVR",e),i.shadingStyle.getModel().set("webVR",e),i.lighting.getModel().set("webVR",e),i.postProcess.getModel().set("webVR",e),Object(d.a)().vrStereo?(this._cullConfig.doVR=e,E.a.uIsVr.setFloat(e)):(this._cullConfig.doVR=!1,E.a.uIsVr.setFloat(0)),this._controllerMT.setListenToEvents(e),e?this._floorMT.updateNodeVR():this._viewer.getFeaturesManager().focusOnHomePosition(),this._standaloneViewer?L.log("Launcher StartEnable: enabled:"+e+" doPresentVR: "+t):L.log("Viewer StartEnable: enabled:"+e+" doPresentVR: "+t);var r=this.getConfigWebVR();e&&!t||r.isPresenting===e||(this.model.get("hasNativeHMD")?this._viewerOSGJS.setPresentVR(e).then(this.notifyPresentVR.bind(this),this._failedPresentVR.bind(this)).catch(function(){L.log("VR notifyPresentVR Promise Fail")}):(r.isPresenting=e,this.notifyPresentVR()));var a=e&&!Object(d.a)().vrAr?1:0;this._viewer.getCamera().getClearColor()[3]=a},_failedPresentVR:function(){console.error("Failed to present VR"),this.model.set("enable",!1)},onEnable:function(){var e=this.model.get("enable");if(this._registerVRCallbacks(e),e){this._viewer.getInputManager().setEnable(A.WEBVR,e);this._viewerOSGJS.getVRDisplay()?this.onDisplayChange():this._viewerOSGJS.getInputManager().getInputSource("WebVR").pollHeadset()}else this._viewer.getInputManager().setEnable(A.WEBVR,e);this.model.onVrDisplayReady(function(){this.startEnable(e,this._standaloneViewer)}.bind(this))},_registerVRCallbacks:function(e){e?(window.addEventListener("vrdisplayactivate",this._onVrDisplayActivateBinded),window.addEventListener("vrdisplaydeactivate",this._onVrDisplayDeactivateBinded),window.addEventListener("vrdisplaypresentchange",this._onVrDisplayPresentChangeBinded),window.addEventListener("vrdisplaypointerrestricted",this._onVrDisplayPointerRestrictedBinded,!1),window.addEventListener("vrdisplaypointerunrestricted",this._onVrDisplayPointerUnrestrictedBinded,!1)):(window.removeEventListener("vrdisplayactivate",this._onVrDisplayActivateBinded),window.removeEventListener("vrdisplaydeactivate",this._onVrDisplayDeactivateBinded),window.removeEventListener("vrdisplaypresentchange",this._onVrDisplayPresentChangeBinded),window.removeEventListener("vrdisplaypointerrestricted",this._onVrDisplayPointerRestrictedBinded,!1),window.removeEventListener("vrdisplaypointerunrestricted",this._onVrDisplayPointerUnrestrictedBinded,!1))},onDisplayChange:function(){var e=this._viewerOSGJS.getVRDisplay();this.model.set("hasNativeHMD",!!e),e&&this.model.set("displayName",e.displayName),o.a.resolveVrDisplayReady()},_onVrDisplayActivate:function(){o.a.getModelDisplayed().isFulfilled()?this.model.onVrDisplayReady(this.model.set.bind(this.model,"enable",!0)):o.a.getModelDisplayed().then(function(){this.model.onVrDisplayReady(this.model.set.bind(this.model,"enable",!0))}),this.getConfigWebVR().isPresenting||this._viewerOSGJS.setPresentVR(!0).then(this.notifyPresentVR.bind(this)).catch(function(){L.log("VR setPresentVR/notifyPresentVR Promise Fail")})},_onVrDisplayDeactivate:function(){if(this._startPresentTime&&L.Timer.instance().tick()-this._startPresentTime<5){var e="Sorry, VR can not be enabled because your device doesnt have enough resources.";e+="Please try closing some tabs before enabling VR again.",this._viewer.subviews.osd.show(e,{duration:5e3,position:"top"})}this._standaloneViewer&&!this.model.get("modeLauncher")&&this.model.onVrDisplayReady(this.model.set.bind(this.model,"enable",!1));var t=this._viewer.getCanvas();document.pointerLockElement===t&&document.exitPointerLock()},_onVrDisplayPresentChange:function(e){e.display.isPresenting||this._standaloneViewer&&!this.model.get("modeLauncher")&&this.model.onVrDisplayReady(this.model.set.bind(this.model,"enable",!1))},handleBuggyStandingTransform:function(e,t){0!==t&&(L.warn("VR: Handling buggy standing transform Vive"),navigator.getVRDisplays().then(function(i){for(var r=0;r<i.length;++r)if(i[r].displayName===e.displayName){e=i[r];break}var a=e.capabilities.hasPosition&&e.stageParameters;if(a&&L.mat4.equals(L.mat4.IDENTITY,a.sittingToStandingTransform))return void setTimeout(this.handleBuggyStandingTransform.bind(this,e,--t),5e3)}.bind(this)).catch(function(){L.log("VR Display Promise Fail")}))},updateDistortion:function(){var e=this._viewer.getFeatures().postProcess.getModel(),t=!this.model.get("hasNativeHMD")&&!Object(d.a)().vrAr;if(e.set("doDistortionVR",t),t){var i=this.model.get("deviceInfo"),r=i.getProjectionMatrixLeftEye(),a=i.getProjectionMatrixLeftEye(!0),n=i.getUndistortedViewportLeftEye(),o=i.device,s={xScale:n.width/(o.width/2),yScale:n.height/o.height,xTrans:2*(n.x+n.width/2)/(o.width/2)-1,yTrans:2*(n.y+n.height/2)/o.height-1};e.set("distortion",i.viewer.distortionCoefficients),e.set("projectionLeft",l.a.projectionMatrixToVector_(r)),e.set("unprojectionLeft",l.a.projectionMatrixToVector_(a,s))}},snapHumanOnFloor:function(){this._humanMT.getMatrix()[14]-=this._humanMT.computeDistanceToFloor()},getEyeLevel:function(){var e=this.getConfigWebVR(),t=e.capabilities.hasPosition&&e.stageParameters,i=this.getPosVR()[2];return t&&i?i:this.model.get("worldFactor")*this.model.getDefaultHumanHeight()},snapOnFloor:function(){var e=this.model.get("worldFactor"),t=this._manipulator.getEyePosition(L.vec3.create()),i=L.vec3.copy(L.vec3.create(),t);i[2]-=5*e;var r=this._viewer.getFeaturesManager(),a=w.a.computeNearestIntersection3D(t,i,h.a.PICK_GEOMETRY_FAST,this._nodeWebVR);if(a){var n=L.vec3.create();w.a.getWorldPositionFromHit(a,n),n[2]+=this.getEyeLevel(),r.focusOnTargetAndEye(void 0,n)}},scaleMatrixTranslate:function(e,t){e[12]*=t,e[13]*=t,e[14]*=t},transformMatrixYuptoZup:function(){var e=L.vec3.create(),t=L.vec3.create();return function(i){var r=L.mat4.getScale(e,i),a=Math.abs(r[0]-1)>1e-7||Math.abs(r[1]-1)>1e-7||Math.abs(r[2]-1)>1e-7;a&&(t[0]=1/r[0],t[1]=1/r[1],t[2]=1/r[2],L.mat4.scale(i,i,t));var n=i,o=n[4],s=n[5],u=n[6],l=n[7];n[4]=-n[8],n[5]=n[9],n[6]=n[10],n[7]=n[11],n[8]=o,n[9]=s,n[10]=u,n[11]=l;var c=n[1];n[1]=-n[2],n[2]=c,c=n[5],n[5]=n[6],n[6]=-c,c=n[10],n[10]=n[9],n[9]=-c,c=n[13],n[13]=-n[14],a&&L.mat4.scale(i,i,r)}}(),computeHeadToEyeView:function(){var e=L.mat4.create();return function(t,i,r){var a=this._frameData.pose;a&&(a.orientation?L.mat4.fromQuat(e,a.orientation):L.mat4.identity(e),a.position&&L.mat4.setTranslation(e,a.position),L.mat4.multiply(t,this._frameData.leftViewMatrix,e),L.mat4.multiply(i,this._frameData.rightViewMatrix,e)),this.transformMatrixYuptoZup(t),this.transformMatrixYuptoZup(i),this.scaleMatrixTranslate(t,r),this.scaleMatrixTranslate(i,r)}}(),_getCorrectionPixel:function(e){return Object(d.a)().vrScaleRtt>0?Object(d.a)().vrScaleRtt:this._webvrMaxHeight>0?Math.min(1,this._webvrMaxHeight/(e.renderHeight||512)):1},_updateCullConfig:function(){var e=L.vec3.create();return function(t,i){var r=this.model.get("worldFactor"),a=this._cullConfig;t&&(L.mat4.copy(a.leftProjection,this._frameData.leftProjectionMatrix),L.mat4.copy(a.rightProjection,this._frameData.rightProjectionMatrix),this._frameData.leftViewMatrix&&(L.mat4.copy(a.leftOffsetView,this._frameData.leftViewMatrix),L.mat4.copy(a.rightOffsetView,this._frameData.rightViewMatrix),this.computeHeadToEyeView(a.leftOffsetView,a.rightOffsetView,r))),t&&this._frameData.leftViewMatrix||(L.vec3.set(e,-r*i.offset[0],0,0),L.mat4.fromTranslation(a.leftOffsetView,e),L.vec3.set(e,-r*i.offset[0],0,0),L.mat4.fromTranslation(a.rightOffsetView,e))}}(),onWorldFactor:function(){var e=this.model.get("worldFactor");if(this._lastWorldFactor>0&&this._lastWorldFactor!==e){var t=this.getPosVR();L.vec3.scale(t,t,e/this._lastWorldFactor),this.model.get("enable")&&this.snapOnFloor()}this._lastWorldFactor=e;var i=this.getConfigWebVR(),r=i.getEyeParameters("left"),a=i.getEyeParameters("right");if(r&&a){var n=this._getCorrectionPixel(r),o=this._cullConfig;o.leftRenderWidth=Math.floor(r.renderWidth*n)||512,o.leftRenderHeight=Math.floor(r.renderHeight*n)||512,o.rightRenderWidth=Math.floor(a.renderWidth*n)||512,o.rightRenderHeight=Math.floor(a.renderHeight*n)||512;var s=i.getFrameData(this._frameData);this._updateCullConfig(s,r)}this._viewer.getInputManager().setParam("worldFactor",e),u.a.draw()},perspectiveMatrixFromVRFieldOfView:function(e,t,i,r){var a=r||L.mat4.create(),n=Math.PI/180,o=Math.tan(e.upDegrees*n)*t,s=Math.tan(e.downDegrees*n)*t,u=Math.tan(e.leftDegrees*n)*t,l=Math.tan(e.rightDegrees*n)*t;return L.mat4.frustum(a,-u,l,-s,o,t,i),a},hookComputeCanvasSize:function(){var e=this._viewerOSGJS,t=e.computeCanvasSize,i=this,r=this._cullConfig;e.computeCanvasSize=function(a){var n=i.model.get("enable");if(!n)return t.call(e,a);i.model.get("hasNativeHMD")&&i.onWorldFactor();var o=Math.floor(r.leftRenderWidth+r.rightRenderWidth),s=Math.floor(Math.max(r.leftRenderHeight,r.rightRenderHeight)),u=Math.max(o,s);if(!n&&u>4096){var l=4096/u;o=Math.floor(o*l),s=Math.floor(s*l)}var c=!1;return this._canvasWidth!==o&&(a.width=o,this._canvasWidth=o,c=!0),this._canvasHeight!==s&&(a.height=s,this._canvasHeight=s,c=!0),c}},getConfigWebVR:function(){var e=this._viewerOSGJS,t=e.getVRDisplay();if(t)return this._frameData instanceof window.VRFrameData==!1&&(this._frameData=new window.VRFrameData),t;if(this._defaultHMD)return this._defaultHMD;var i=this.model.get("deviceInfo"),r=.5*i.viewer.interLensDistance,a=i.getUndistortedViewportLeftEye();this._frameData={leftProjectionMatrix:this.perspectiveMatrixFromVRFieldOfView(i.getFieldOfViewLeftEye(!1),.1,1e3,L.mat4.create()),rightProjectionMatrix:this.perspectiveMatrixFromVRFieldOfView(i.getFieldOfViewRightEye(!1),.1,1e3,L.mat4.create())};var n={left:{offset:L.vec3.fromValues(-r,0,0),renderWidth:a.width,renderHeight:a.height},right:{offset:L.vec3.fromValues(r,0,0),renderWidth:a.width,renderHeight:a.height}};return this._defaultHMD={displayName:"fake-cardboard",isPresenting:!1,getFrameData:function(e){return e},getEyeParameters:function(e){return n[e]},capabilities:{hasPosition:!1,hasRotation:!1,hasExternalDisplay:!1}},this._defaultHMD},getPosVR:function(){var e=L.vec3.create();return function(){return this._manipulator.getCurrentManipulator()._vrPos||L.vec3.set(e,0,0,0)}}(),getTeleportPosFromHotspot:function(){var e=L.vec3.create(),t=L.vec3.create(),i=L.vec3.create(),r=L.vec3.create();return function(a,n,o,s){var u=this.model.get("worldFactor");w.a.getWorldPositionFromScenePoint(L.mat4.getTranslation(e,a.getHotspotMatrix()),t);var l=2.5*u;L.vec3.sub(e,t,n);var c=L.vec3.length(e);e[2]=0,L.vec3.normalize(e,e),L.vec3.scale(e,e,l),L.vec3.sub(i,t,e),i[2]=t[2]+u,c<l+.1*l&&L.vec3.copy(i,n),L.vec3.copy(r,i),r[2]-=3.5*u;var d=w.a.computeNearestIntersection3D(i,r,h.a.PICK_GEOMETRY_FAST,this._nodeWebVR);d?(w.a.getWorldPositionFromHit(d,o,s),d.backface&&L.vec3.negate(s,s)):(L.vec3.copy(o,i),o[2]-=this.getEyeLevel(),L.vec3.set(s,0,0,1)),this._teleportNode.setHotspotHint(a.canTeleport(),o,t,u),a.setWorldTeleportPosition(t,o,u)}}(),updateHitHotspot:function(){var e=function(e){return e instanceof m.a};return function(t,i,a,n,o){var s=this._viewer.getFeatures().hotspot.getWidgetNode(),u=t&&-1!==t._nodePath.indexOf(s);if(this._lastHoveredHotspot&&this._lastHoveredHotspot.setHovered(!1),!u)return this._lastHoveredHotspot&&this._lastHoveredHotspot.updateCardHit(),this._lastHoveredHotspot=void 0,void this._teleportNode.setHotspotHint(!1);var l=this._lastHoveredHotspot=Object(r.find)(t._nodePath,e);return l.updateCardHit(t),l.setHovered(!0),l.isFullyVisibleCard()?l:(this.getTeleportPosFromHotspot(l,i,n,o),this._viewer.getFeatures().hotspot.getModel().set("currentHotspotIndex",l.getIndex()),l)}}(),handleHitPicking:function(e,t,i,r,a,n,o){var s,u=this._viewer.getFeaturesManager(),l=this.model.get("worldFactor"),c=this._floorMT.getBoundingSphere(),d=L.vec3.dist(c.center(),t)+c.radius();return e?s=w.a.computeNearestIntersection2D(this._lastMouse[0],this._lastMouse[1],h.a.PICK_GEOMETRY_FAST):this._controllerMT.isPosedController()?(s=this._controllerMT.raycastFromController(this._nodeWebVR,u,d,n,o),s?(w.a.getWorldPositionFromHit(s,r,a),s._backface&&L.vec3.negate(a,a),this._controllerMT.updatePointerScaleFromHit(r),this._cursorMT.setColor(L.vec3.fromValues(.1,.66,.85))):(this._controllerMT.resetPointerScale(),L.vec3.copy(r,o))):(L.vec3.copy(n,t),L.vec3.copy(o,i),L.vec3.scale(o,i,d),L.vec3.add(o,n,o),s=w.a.computeNearestIntersection3DHotspotFirst(n,o,h.a.PICK_GEOMETRY_FAST,this._nodeWebVR),s?(w.a.getWorldPositionFromHit(s,r,a),s._backface&&L.vec3.negate(a,a)):(L.vec3.scale(r,i,3*l),L.vec3.add(r,t,r))),this.model.setLastControllerHit(s),s},goToNextHotspot:function(){this._viewer.getFeatures().postProcess.getModel().fadeForTeleportVR(this.doTeleportToHotspot.bind(this,1))},doTeleportToHotspot:function(e){this._nodeMenu&&this._nodeMenu.isVisible()&&this._nodeMenu.hide();var t=this.computeHotspotIndex(e);-1!==t&&(this.moveToHotspotWithIndex(t),this.displayHotspotCardForIndex(t))},goToPrevHotspot:function(){this._viewer.getFeatures().postProcess.getModel().fadeForTeleportVR(this.doTeleportToHotspot.bind(this,-1))},displayHotspotCardForIndex:function(e){var t=this._viewer.getFeatures().hotspot.getWidgetNode().children[e];this.toggleHotspotCard(t)},computeHotspotIndex:function(e){var t=this._viewer.getFeatures().hotspot.getModel(),i=t.get("hotspots");if(0===i.length)return-1;if(1!==e&&-1!==e)return console.error("computeHotspotIndex was called with an invalid direction argument. Valid values are 1 for foward -1 for backward."),0;var r=t.get("currentHotspotIndex"),a=i.length;return r+=e,r<0&&(r=-1),r=(r%a+a)%a,t.set("currentHotspotIndex",r),r},moveToHotspotWithIndex:function(){var e=L.vec3.create(),t=L.vec3.create(),i=L.vec3.create();return function(r){var a=this._viewer.getFeatures().hotspot.getWidgetNode(),n=a.children[r],o=this._viewer.getFeatures().hotspot.getModel().get("hotspots").at(r);w.a.getWorldPositionFromScenePoint(o.get("eye"),t),w.a.getWorldPositionFromScenePoint(o.get("position"),e),this.getTeleportPosFromHotspot(n,t,t,i),t[2]+=this.getEyeLevel(),this._manipulator.getFirstPersonManipulator().setInitialPoseVR(t,e)}}(),doTeleport:function(e,t,i){var r=this._viewer.getFeaturesManager();e[2]+=this.getEyeLevel(),t[2]+=this.getEyeLevel(),r.focusOnTargetAndEye(t,e),this.toggleHotspotCard(i)},toggleHotspotCard:function(e){e&&(e.isFullyVisibleCard()?e.onCardHit(this):(this._lastSelectedHotspot&&this._lastSelectedHotspot.setVisibleCard(!1),this._lastSelectedHotspot=e,e&&e.setVisibleCard(!0)))},setPauseUpdate:function(e){this._pauseUpdate=e},update:function(){var e=L.vec3.create(),t=L.vec3.create(),i=L.vec3.create(),r=L.vec3.create(),a=L.vec3.create(),n=L.vec3.create(),o=L.vec3.create(),s=L.vec3.create(),l=L.vec3.create(),c=L.vec3.create();return function(h,p){var f=this._viewer.getFeatures(),m=this.model.get("enable"),g=this.model.get("modeLauncher"),_=this._viewer.getOptions().widgetAPI,v=!!_&&"virtual reality"===_.getTabbedWidget().get()&&!this._pauseUpdate,b=m||v;this.setProxyVisible(b);var y=f.background.getModel();y.get("webVR")!==b&&y.set("webVR",b);var x=f.postProcess.getModel();if(x.get("webVR")!==b&&x.set("webVR",b),this._humanMT.setVisible(v),!m&&!v)return!0;var S=this.model.get("worldFactor"),M=p.getFrameStamp(),w=M.getSimulationTime(),T=M.getDeltaTime(),C=this.getConfigWebVR();this._resetOnNextFrame&&(!this.model.get("hasNativeHMD")||!C.capabilities.hasPosition||C.stageParameters&&this.getPosVR()[2])&&(this._resetOnNextFrame=!1,this.resetCameraToHuman()),this._manipulator.getEyePosition(i),this._manipulator.getTarget(r),L.vec3.sub(r,r,i),L.vec3.normalize(r,r);var E=this._viewer.getCamera();this._controllerMT.updateNodeVR(C,T,L.vec3.sub(s,i,this.getPosVR()));var P=this.handleHitPicking(!m&&v,i,r,t,e,a,n);L.vec3.copy(o,t);var A=m&&!g&&this._controllerMT.isTeleportPressed(),D=!g&&this._controllerMT.isClickPressed(),O=this._nodeMenu&&this._controllerMT.isMenuPressed(this._nodeMenu.isVisible()),k=P&&-1===P._nodePath.indexOf(this._nodeMenu)&&(A||D)&&this._nodeMenu.isVisible(),R=m&&(O||k);R&&(this._manipulator.getTarget(s),this._nodeMenu.isVisible()?this._nodeMenu.hide():this._nodeMenu.display(i,s));var I,F;if(m&&!g){F=this._nodeMenu.updateHit(P),I=this.updateHitHotspot(P,a,n,o,e),this._teleportNode.updateWorldNormal(M,e);var N=P&&e[2]>.5,V=I?I.canTeleport():N,B=P&&-1!==P._nodePath.indexOf(this._floorMT),U=I?I.canTeleport():N&&(!this.model.isDiorama()||B);if(A&&w-this._lastTime>.5){if(V){L.vec3.add(c,o,r),L.vec3.copy(l,o);this._viewer.getFeatures().postProcess.getModel().fadeForTeleportVR(this.doTeleport.bind(this,l,c,I)),this._lastTime=w}V||this.toggleHotspotCard(I),F&&F.click()}this._interpolatorAlpha.setTarget(U?1:0),this._interpolatorAlpha.update(M.getDeltaTime())}var j=this._viewer.getFeaturesManager(),G=j.getIconScaleFov(this._cullConfig.leftProjection),Y=L.vec3.dist(t,i)/G,H=R?0:this._interpolatorAlpha.getCurrent()[0];this._cursorMT.setVisible(m),this._teleportNode.setVisible(P&&!g&&m&&!O);var z=!g&&!Object(d.a)().vrAr&&this.model.get("displayFloor");this._floorMT.setVisible(z),this._floorMT.updateNodeVR(),this._humanMT.updateNodeVR(P,w),this._teleportNode.updateNodeVR(H,P,M,o,S,Y,e),this._cursorMT.updateNodeVR(g||I?1:1-H,E,t,Y),this._nodeMenu&&this._lastSelectedHotspot&&this._nodeMenu.isVisible()&&this._lastSelectedHotspot.isFullyVisibleCard()&&this._lastSelectedHotspot.setVisibleCard(!1);var W=this._controllerMT.checkScaleChangeValue();return this._scaleControlEnabled&&0!==W&&(W=S*Math.abs(W)*(W>0?1.02:1/1.02),this.model.set("worldFactor",W)),u.a.draw(),!0}}()});t.a=O},function(e,t,i){"use strict";var r=i(5),a=i(107),n=i(57),o=i(43),s=i(47),u=i(437),l=i(705),c=i(867),h=i.n(c),d=i(868),p=i.n(d),f=i(1315),m=i.n(f),g=i(1316),_=i.n(g),v=i(119),b=i(63),y=r.a.osg,x=r.a.osgUtil,S=y.vec3.fromValues(.1,.4,.8),M=y.vec3.fromValues(1,.7,.1),w=y.vec3.fromValues(1,0,0),T=y.vec3.fromValues(0,0,.9),C=function(e){y.MatrixTransform.call(this),this._model=e,this.setMatrix(e.get("humanMatrix")),this.setName("WebVR - Human"),this.setNodeMask(0),this.editMask=x.NodeGizmo.NO_FULL_CIRCLE|x.NodeGizmo.PICK_PLANE_Z|x.NodeGizmo.PICK_ARROW|x.NodeGizmo.PICK_ARC_Z,this._humanMT=new y.MatrixTransform,y.mat4.fromZRotation(this._humanMT.getMatrix(),Math.PI),this._geoHuman=new y.Geometry,this._humanMT.addChild(this._geoHuman),this._uColorCylinder=y.Uniform.createFloat3(y.vec3.copy(y.vec3.create(),S),"uColor"),this._uColorHint=y.Uniform.createFloat3(y.vec3.copy(y.vec3.create(),M),"uColor"),this._hintToFloorMT=new y.MatrixTransform,this._geoHintToFloor=y.createTexturedBoxGeometry(0,0,-.5,.02,.02,1),this._hintToFloorMT.addChild(this._geoHintToFloor),this._hintToFloorMT.setNodeMask(o.a.NO_PICK),this._geoCylinder=x.GizmoGeometry.createCylinderGeometry(1,1,1,50,1,!1,!1),this._geoCylinder.setNodeMask(o.a.NO_PICK);for(var t=0,i=this._geoCylinder.getAttributes().Vertex.getElements(),r=i.length/3;t<r;++t)i[3*t+2]+=.5;this._cylinderMT=new y.MatrixTransform,y.mat4.fromScaling(this._cylinderMT.getMatrix(),y.vec3.fromValues(1,1,.5)),this._cylinderMT.addChild(this._geoCylinder),this.addChild(this._humanMT),this.addChild(this._cylinderMT),this.addChild(this._hintToFloorMT),this._boundingBoxComputed=!0,this._boundingSphereComputed=!0,this.init()};y.createPrototypeNode(C,y.objectInherit(y.MatrixTransform.prototype,{init:function(){this.getOrCreateStateSet().setAttributeAndModes(b.a.CULL_BACK);var e=this._humanMT.getOrCreateStateSet();e.setShaderGeneratorName("shadeless-pbr"),e.setName("vrHuman");var t=l.a.createMaterialModel(e);t.set("name","NodeHuman"),t.set("hasVertexColor",!0),t.set("vertexColorEnable",!0),t.set("vertexColorColorSpace","linear"),t.trigger("apply"),e.setAttributeAndModes(e.getAttribute("SketchfabMaterial")),Object(s.a)()&&u.a.getHuman(this.initHumanMesh.bind(this));var i=this._geoHintToFloor.getOrCreateStateSet();i.setAttributeAndModes(a.a.createShader(m.a,_.a,"webVR-hintToFloor","VRHintToFloor")),i.addUniform(this._uColorHint),i.setRenderBinDetails(n.a.TRANSPARENT_NO_EARLYZ_POST,"RenderBin");var r=this._geoCylinder.getOrCreateStateSet();r.setAttributeAndModes(a.a.createShader(h.a,p.a,"webVR-humanCylinder","VRHumanCylinder")),r.addUniform(this._uColorCylinder),r.addUniform(y.Uniform.createFloat(1,"uAlpha")),r.setRenderBinDetails(n.a.TRANSPARENT_NO_EARLYZ_POST,"RenderBin")},initHumanMesh:function(e){var t=this._geoHuman;t.getAttributes().Vertex=new y.BufferArray(y.BufferArray.ARRAY_BUFFER,e.VERTEX,3),t.getAttributes().Color=new y.BufferArray(y.BufferArray.ARRAY_BUFFER,e.COLOR,4),t.getPrimitives().push(new y.DrawElements(y.primitiveSet.TRIANGLES,new y.BufferArray(y.BufferArray.ELEMENT_ARRAY_BUFFER,e.TRIANGLES,1))),t.getPrimitives().push(new y.DrawElements(y.primitiveSet.TRIANGLE_STRIP,new y.BufferArray(y.BufferArray.ELEMENT_ARRAY_BUFFER,e.STRIP,1)))},setVisible:function(e){if(this._visible!==e){this._visible=e,this.setNodeMask(e?-1:0);var t=this._model._viewer.getFeaturesManager().getNodeGizmo();e?(t.attachToNode(this),this._initView()):this._restoreView()}},_initView:function(){var e=y.vec3.create(),t=y.vec3.create(),i=y.vec3.create(),r=y.quat.create(),a=y.vec3.create(),n=y.vec3.create(),o=y.vec3.fromValues(0,0,-1);return function(){var s=this._model._viewer.getFeaturesManager(),u=this._model.get("worldFactor"),l=this._model._viewer.getViewerOSGJS().getManipulator();this._eyePos||(this._eyePos=y.vec3.create(),this._eyeTarget=y.vec3.create()),l.getEyePosition(this._eyePos),l.getTarget(this._eyeTarget),y.mat4.getTranslation(e,this.getMatrix()),y.mat4.getRotation(r,this.getMatrix()),y.vec3.set(t,0,1,0),y.vec3.transformQuat(t,t,r),y.vec3.copy(a,T),y.vec3.scale(a,a,u),y.vec3.add(e,e,a),y.vec3.scale(a,t,-1),y.vec3.normalize(a,a),y.vec3.cross(n,a,o),y.vec3.copy(i,e),y.vec3.scale(a,a,3*u),y.vec3.scale(n,n,.5*u),y.vec3.add(a,a,n),y.vec3.add(i,i,a),s.focusOnTargetAndEye(e,i,1)}}(),_restoreView:function(){if(this._eyePos){this._model._viewer.getFeaturesManager().focusOnTargetAndEye(this._eyeTarget,this._eyePos)}},computeDistanceToFloor:function(){var e=y.vec3.create(),t=y.vec3.create();return function(){var i=this.getMatrix(),r=this._model,a=r.get("worldFactor"),n=r.get("floorHeight");y.mat4.getTranslation(e,i),y.vec3.copy(t,e);var s=.1*a;e[2]+=s,t[2]-=100*a,this.setNodeMask(o.a.NO_PICK);var u=v.a.computeNearestIntersection3D(e,t,o.a.PICK_GEOMETRY_SLOW);if(this.setNodeMask(-1),u)s=y.vec3.dist(v.a.getWorldPositionFromHit(u,t),e);else{if(!r.get("displayFloor"))return 0;s=e[2]-n}return Math.max(0,s-.1*a)}}(),updateNodeVR:function(){var e=y.vec3.create();return function(t,i){if(0!==this.getNodeMask()){var r=this.getMatrix(),a=this._model,n=a._viewer.getFeaturesManager(),o=a.get("worldFactor"),s=a.get("floorHeight");y.vec3.lerp(this._uColorHint.getInternalArray(),M,w,.5*Math.sin(10*i)+.5),y.mat4.getScale(e,r),y.vec3.set(e,o/e[0],o/e[1],o/e[2]),y.mat4.scale(r,r,e),a.get("displayFloor")&&(r[14]=Math.max(r[14],s));var u=n.getNodeGizmo().getAttachedNode()===this,l=u||t&&-1!==t._nodePath.indexOf(this._humanMT);y.vec3.copy(this._uColorCylinder.getInternalArray(),l?M:S);var c=this.computeDistanceToFloor()/o,h=c>.05;y.mat4.fromScaling(this._hintToFloorMT.getMatrix(),y.vec3.set(e,1,1,h?c:1e-7)),this._model.set("humanInAir",h),this.dirtyBound()}}}()}),"osgSketchfab","Human"),t.a=C},function(e,t){e.exports="attribute vec3 Vertex;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying float vHeight;\n\nvoid main(void) {\n  vHeight = Vertex.z;\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xyz, 1.0));\n}\n"},function(e,t){e.exports='uniform vec3 uColor;\nuniform int uOutputLinear;\n\nvarying float vHeight;\n\n#pragma include "functions.glsl"\n\nvoid main(void) {\n  vec4 color = vec4(uColor, 1.0) * smoothstep(1.0, 0.0, vHeight + 1.0);\n\n  gl_FragColor = uOutputLinear == 0 ? linearTosRGB(color) : color;\n}\n'},function(e,t,i){"use strict";var r=i(5),a=i(107),n=i(43),o=i(59),s=i(437),u=i(187),l=i(1318),c=i.n(l),h=i(1319),d=i.n(h),p=i(867),f=i.n(p),m=i(868),g=i.n(m),_=r.a.osg,v=r.a.osgUtil,b=function(){_.Node.call(this),this.setName("WebVR - Teleport"),this.setVisible(!0),this._interpolatorNormal=new v.DelayInterpolator(3),this._interpolatorNormal.setDelay(.08),this._geoCircle1=_.createTexturedQuadGeometry(-.5,-.5,0,1,0,0,0,1,0),this._geoCircle2=_.createTexturedQuadGeometry(-.5,-.5,.15,1,0,0,0,1,0),this._geoCircle3=_.createTexturedQuadGeometry(-.5,-.5,.15,1,0,0,0,1,0),this._uAlpha1=_.Uniform.createFloat(1,"uAlpha"),this._uAlpha2=_.Uniform.createFloat(1,"uAlpha"),this._uAlpha3=_.Uniform.createFloat(1,"uAlpha"),this._uScale1=_.Uniform.createFloat(1,"uScale"),this._uScale2=_.Uniform.createFloat(.99,"uScale"),this._uScale3=_.Uniform.createFloat(.99,"uScale"),this._geoCylinder=v.GizmoGeometry.createCylinderGeometry(1,1,1,50,1,!1,!1);for(var e=0,t=this._geoCylinder.getAttributes().Vertex.getElements(),i=t.length/3;e<i;++e)t[3*e+2]+=.5;this._cylinderMT=new _.MatrixTransform,_.mat4.fromScaling(this._cylinderMT.getMatrix(),_.vec3.fromValues(.38,.38,.125)),this._cylinderMT.addChild(this._geoCylinder),this._hotspotHintMT=new _.MatrixTransform,this._hotspotHintMT.addChild(this._geoCylinder),this._hotspotHintMT.setNodeMask(0),this._teleportMT=new _.MatrixTransform,this._teleportMT.addChild(this._geoCircle1),this._teleportMT.addChild(this._geoCircle2),this._teleportMT.addChild(this._geoCircle3),this._teleportMT.addChild(this._cylinderMT),this.addChild(this._teleportMT),this.addChild(this._hotspotHintMT),this.init()};_.createPrototypeNode(b,_.objectInherit(_.Node.prototype,{init:function(){var e=this.getOrCreateStateSet();e.setAttributeAndModes(a.a.createShader(c.a,d.a,"webVR-teleportCircle","VRTeleportCircle")),e.addUniform(_.Uniform.createInt(0,"uTextureTeleportCircle")),e.setTextureAttributeAndModes(0,u.a.dummyTexture),this._geoCircle1.getOrCreateStateSet().addUniform(this._uScale1),this._geoCircle2.getOrCreateStateSet().addUniform(this._uScale2),this._geoCircle3.getOrCreateStateSet().addUniform(this._uScale3),this._geoCircle1.getOrCreateStateSet().addUniform(this._uAlpha1),this._geoCircle2.getOrCreateStateSet().addUniform(this._uAlpha2),this._geoCircle3.getOrCreateStateSet().addUniform(this._uAlpha3);var t=this._cylinderMT.getOrCreateStateSet();t.addUniform(_.Uniform.createFloat3(_.vec3.fromValues(.7,.7,.3),"uColor")),t.addUniform(this._uAlpha1);var i=this._hotspotHintMT.getOrCreateStateSet();i.addUniform(_.Uniform.createFloat3(_.vec3.fromValues(.1,.66,.85),"uColor")),i.addUniform(this._uAlpha1),this._geoCylinder.getOrCreateStateSet().setAttributeAndModes(a.a.createShader(f.a,g.a,"webVR-teleportCylinder","VRTeleportCylinder"))},initTextureTeleport:function(){s.a.getBaseVR(this.replaceTextureTeleport.bind(this))},replaceTextureTeleport:function(e){this.getOrCreateStateSet().setTextureAttributeAndModes(0,o.default.instance.getOrCreateTexture(e.TELEPORT_CIRCLE,{internalFormat:_.Texture.RGBA}).texture)},setVisible:function(e){this.setNodeMask(e?n.a.NO_PICK:0)},setHotspotHint:function(){var e=_.vec3.create(),t=_.vec3.fromValues(0,0,1),i=_.quat.create();return function(r,a,n,o){if(this._hotspotHintMT.setNodeMask(r?-1:0),a){_.vec3.sub(e,n,a);var s=_.vec3.len(e);_.vec3.normalize(e,e),_.quat.rotationTo(i,t,e);var u=this._hotspotHintMT.getMatrix();_.mat4.fromQuat(u,i);_.mat4.scale(u,u,_.vec3.set(e,.02*o,.02*o,s)),_.mat4.setTranslation(u,a)}}}(),updateWorldNormal:function(e,t){this._interpolatorNormal.setTarget(t[0],t[1],t[2]),this._interpolatorNormal.update(e.getDeltaTime()),_.vec3.normalize(t,this._interpolatorNormal.getCurrent())},updateNodeVR:function(){var e=_.vec3.fromValues(0,0,1),t=_.vec3.create();return function(i,r,a,o,s,u,l){var c=this._teleportMT.getMatrix();if(this.getNodeMask()){var h=Math.acos(_.vec3.dot(e,l));_.vec3.cross(t,l,e),_.mat4.fromRotation(c,-h,t);var d=Math.min(Math.max(s,u),50*u);_.mat4.scale(c,c,_.vec3.set(t,d,d,d)),_.vec3.set(t,o[0],o[1],o[2]+.05*s),_.mat4.setTranslation(c,t),this.setNodeMask(n.a.NO_PICK)}var p=a.getSimulationTime(),f=p%.99,m=(p+.2)%.99;this._uScale2.setFloat(f),this._uScale3.setFloat(m),this._uAlpha1.setFloat(i),this._uAlpha2.setFloat(i*(1-f*f)),this._uAlpha3.setFloat(i*(1-m*m)),this._teleportMT.dirtyBound()}}()}),"osgSketchfab","Teleport"),t.a=b},function(e,t){e.exports="attribute vec2 TexCoord0;\nattribute vec3 Vertex;\n\nvarying vec2 vTexCoord0;\nuniform float uScale;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n  vTexCoord0 = TexCoord0;\n\n  vec3 posLocal = Vertex.xyz * vec3(uScale, uScale, 1.0 - uScale);\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(posLocal, 1.0));\n}\n"},function(e,t){e.exports='varying vec2 vTexCoord0;\n\nuniform sampler2D uTextureTeleportCircle;\nuniform float uScale;\nuniform float uAlpha;\nuniform int uOutputLinear;\n\n#pragma include "functions.glsl"\n\nvoid main(void) {\n  vec3 tex = sRGBToLinear(texture2D(uTextureTeleportCircle, vTexCoord0).rgb);\n  vec4 color = uScale == 1.0 ? vec4(tex.rrr, 1.0) * uAlpha * tex.g : vec4(uAlpha * tex.b);\n\n  gl_FragColor = uOutputLinear == 0 ? linearTosRGB(color) : color;\n}\n'},function(e,t,i){"use strict";var r=i(5),a=i(63),n=i(107),o=i(43),s=i(57),u=i(1321),l=i.n(u),c=i(1322),h=i.n(c),d=r.a.osg,p=function(){d.MatrixTransform.call(this),this.setName("WebVR - Cursor"),this.setVisible(!0),this._geom=d.createTexturedQuadGeometry(-.5,-.5,0,1,0,0,0,1,0),this._uAlpha=d.Uniform.createFloat(1,"uAlpha"),this._uColor=d.Uniform.createFloat3(d.vec3.fromValues(.7,.7,.7),"uCursorColor"),this.addChild(this._geom),this.init()};d.createPrototypeNode(p,d.objectInherit(d.MatrixTransform.prototype,{init:function(){var e=d.StateAttribute.OVERRIDE_ON,t=this.getOrCreateStateSet();t.setAttributeAndModes(n.a.createShader(l.a,h.a,"webVR-cursor","VRCursor"),e),t.setRenderBinDetails(s.a.VR_CURSOR,"RenderBin"),t.setAttributeAndModes(a.a.BLEND_SUBSTRACTIVE),t.addUniform(this._uColor),t.addUniform(this._uAlpha)},setVisible:function(e){this.setNodeMask(e?o.a.NO_PICK:0)},setColor:function(e){d.vec3.copy(this._uColor.getInternalArray(),e)},updateNodeVR:function(){var e=d.vec3.create(),t=d.quat.create();return function(i,r,a,n){var o=this.getMatrix();d.mat4.invert(o,r.getViewMatrix()),d.mat4.fromQuat(o,d.mat4.getRotation(t,o)),d.mat4.scale(o,o,d.vec3.set(e,n,n,n)),d.mat4.setTranslation(o,a),this._uAlpha.setFloat(i),this.dirtyBound()}}()}),"osgSketchfab","Cursor"),t.a=p},function(e,t){e.exports="attribute vec2 TexCoord0;\nattribute vec3 Vertex;\n\nvarying vec2 vLocalVertex;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n  vLocalVertex = Vertex.xy;\n\n  vec3 posLocal = Vertex.xyz * 0.5;\n  posLocal += vec3(0.0, 0.0, 0.1);\n\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(posLocal, 1.0));\n}\n"},function(e,t){e.exports='varying vec2 vLocalVertex;\n\nuniform float uAlpha;\nuniform int uOutputLinear;\nuniform vec3 uCursorColor;\n\n#pragma include "functions.glsl"\n\nvoid main(void) {\n  vec4 color = vec4(uCursorColor, 1.0) * uAlpha * smoothstep(0.0, 1.0, 1.0 - 2.0 * length(vLocalVertex));\n\n  gl_FragColor = linearTosRGB(color);\n}\n'},function(e,t,i){"use strict";var r=i(5),a=i(107),n=i(59),o=i(57),s=i(47),u=i(437),l=i(187),c=i(79),h=i(63),d=i(1324),p=i.n(d),f=i(1325),m=i.n(f),g=r.a.osg,_=function(e){g.MatrixTransform.call(this),this._model=e,this._postMultRotate=e._viewer.getViewerOSGJS().getManipulator().getFirstPersonManipulator().getPostMultRotate(),this.setName("WebVR - Floor"),this.setNodeMask(-1),this._cam=new g.Camera,this._cam.setNearFarRatio(5e-5),this._geom=g.createTexturedQuadGeometry(-.5,-.5,0,1,0,0,0,1,0),this._uScaleToMeter=g.Uniform.createFloat(1,"uScaleToMeter"),this._cam.addChild(this._geom),this.addChild(this._cam),this.init()};g.createPrototypeNode(_,g.objectInherit(g.MatrixTransform.prototype,{init:function(){var e=this.getOrCreateStateSet();e.setAttributeAndModes(a.a.createShader(p.a,m.a,"webVR-floor","VRFloor")),e.addUniform(g.Uniform.createInt(0,"uTextureFloor")),e.setTextureAttributeAndModes(0,l.a.dummyTexture),e.addUniform(this._uScaleToMeter),e.addUniform(g.Uniform.createInt(1,"uTextureDepth")),e.setTextureAttributeAndModes(1,l.a.dummyTexture),e.setRenderBinDetails(o.a.TRANSPARENT_NO_EARLYZ_PRE,"RenderBin"),e.setAttributeAndModes(h.a.DEPTH_DISABLE),e.setAttributeAndModes(h.a.CULL_BACK),Object(s.a)()&&this.initTextureFloor()},initTextureFloor:function(){u.a.getBaseVR(this.replaceTextureFloor.bind(this))},replaceTextureFloor:function(e){this.getOrCreateStateSet().setTextureAttributeAndModes(0,n.default.instance.getOrCreateTexture(e.FLOOR,{internalFormat:g.Texture.RGBA}).texture)},setVisible:function(e){if(this.setNodeMask(e?-1:0),e&&!this._depthInitialized){var t=this._model._viewer.getFeaturesManager().getTextureDepth();t&&(this.getOrCreateStateSet().setTextureAttributeAndModes(1,t),this._depthInitialized=!0)}},updateNodeVR:function(){var e=g.vec3.create(),t=g.vec3.create();return function(){var i=this.getMatrix(),r=c.a.getModelBoxWithDisplacement();r.center(t);var a=r.radius(),n=Math.max(15*this._model.get("worldFactor"),5*a);g.mat4.fromQuat(i,this._postMultRotate),g.mat4.scale(i,i,g.vec3.set(e,n,n,n)),i[12]=t[0],i[13]=t[1],i[14]=this._model.get("floorHeight")-1e-4*a,this._uScaleToMeter.setFloat(n/this._model.get("worldFactor")),this.dirtyBound()}}()}),"osgSketchfab","Floor"),t.a=_},function(e,t){e.exports="attribute vec2 TexCoord0;\nattribute vec3 Vertex;\n\nvarying vec2 vTexCoord0;\nvarying vec4 vViewPos;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n  vTexCoord0 = TexCoord0;\n  vViewPos = uModelViewMatrix * vec4(Vertex.xyz, 1.0);\n  gl_Position = (uProjectionMatrix * vViewPos).xyww;\n}\n"},function(e,t){e.exports='#pragma include "functions.glsl"\n#pragma include "sketchfabFunctions.glsl"\n\nvarying vec2 vTexCoord0;\n\nuniform sampler2D uTextureFloor;\nuniform float uScaleToMeter;\nuniform int uOutputLinear;\n\nvarying vec4 vViewPos;\nuniform vec2 uNearFar;\nuniform sampler2D uTextureDepth;\nuniform vec2 uGlobalTexSize;\nuniform vec2 uGlobalTexRatio;\n\nvoid main(void) {\n  float distDepth = distanceToDepth(uTextureDepth, uGlobalTexRatio * gl_FragCoord.xy / uGlobalTexSize, vViewPos, uNearFar);\n  if (distDepth >= 0.0) discard;\n\n  float x = length(vTexCoord0 * 2.0 - 1.0);\n  x *= x;\n  float fade = smoothstep(0.0, 1.0, 1.0 - x * x);\n\n  float value = sRGBToLinear(texture2D(uTextureFloor, (vTexCoord0 * 1.0 - 0.5) * uScaleToMeter).r);\n  vec4 color = vec4(vec3(value), fade * max(0.8, value));\n  color.rgb *= color.a;\n\n  gl_FragColor = uOutputLinear == 0 ? linearTosRGB(color) : color;\n}\n'},function(e,t,i){"use strict";var r=i(5),a=i(107),n=i(43),o=i(57),s=i(437),u=i(42),l=i.n(u),c=i(869),h=i.n(c),d=i(870),p=i.n(d),f=i(705),m=i(16),g=i(119),_=i(63),v=i(145),b=r.a.osg,y=r.a.InputGroups,x=b.vec3.create(),S={TOUCHPAD:0},M={SCALE_THRESHOLD:.3,TOUCHPAD:0,TRIGGER:1,LEFT_AND_RIGHT:2,MENU:3},w={SCALE_THRESHOLD:.7,THUMBSTICK:0,TRIGGER_UP:1,TRIGGER_SIDE:2,AX:3,BY:4,HOME:5},T={TOUCHPAD:0,HOME:1,CIRCULAR_UP:5,CIRCULAR_DOWN:4},C={SCALE_THRESHOLD:.7,TOUCHPAD:0},E={TOUCHPAD:0},L={SCALE_THRESHOLD:.3,THUMBSTICK:0,TRIGGER:1,GRIP:2,MENU:3,TOUCHPAD:4},P=function(e,t){b.MatrixTransform.call(this),this.setName("WebVR - Controller"),this.setNodeMask(n.a.NO_PICK),this._pointerMT=new b.MatrixTransform,this._pointerMTScale=new b.MatrixTransform,this._proxyControllerMT=new b.MatrixTransform,this._geomPointer=b.createTexturedQuadGeometry(-.5,0,0,1,0,0,0,1,0),this._geomController=new b.createTexturedBoxGeometry(0,-.1,0,.1,.2,.1),this.addChild(this._proxyControllerMT),this.addChild(this._pointerMT),this._pointerMT.addChild(this._pointerMTScale),this._pointerMTScale.addChild(this._geomPointer),this._proxyControllerMT.addChild(this._geomController),this._activeController=void 0,this._model=e,this._postMultRotate=e._viewer.getViewerOSGJS().getManipulator().getFirstPersonManipulator().getPostMultRotate(),this._uPointerAlpha=b.Uniform.createFloat1(1,"uAlpha"),this._hitScaleOffset=20,this._inputManager=t,this._controllerMeshDisplay=void 0,this._pressedButtons=[],this._gamepadType=void 0,this._pointerClicked=!1,this._timeSinceLastPointerClick=0,this._menuPressed=!1,this._clickPressed=!1,this._teleportPressed=!1,this._menuPressedFrame=!1,this._clickPressedFrame=!1,this._teleportPressedFrame=!1,this._scaleValueChange=0,this._cbClick=this.onClick.bind(this),this._canvasX=0,this._canvasY=0,this._preferLeftHand=!1,this.init()};b.createPrototypeNode(P,b.objectInherit(b.MatrixTransform.prototype,{init:function(){var e=this._proxyControllerMT.getOrCreateStateSet();this._createMaterialWithColor(e,b.vec3.fromValues(.8481,.8481,.8481));var t=this._geomPointer.getOrCreateStateSet();t.addUniform(this._uPointerAlpha),t.setRenderBinDetails(o.a.VR_CURSOR,"RenderBin"),t.setAttributeAndModes(_.a.BLEND_SUBSTRACTIVE),t.setAttributeAndModes(a.a.createShader(h.a,p.a,"webVR-laser","VRLaser")),v.a.initWebVRNavigation(this)},_createMaterialWithColor:function(e,t){e.setShaderGeneratorName("shading-vr"),this._uNormalScale||(this._uNormalScale=b.Uniform.createFloat(1,"uNormalScale")),e.addUniform(this._uNormalScale);var i=f.a.createMaterialModel(e);i.set("name","NodeController"),i.set("hasVertexColor",!0),i.set("vertexColorEnable",!0),i.set("vertexColorColorSpace","linear");var r=i.getChannels();r.AlbedoPBR.setColor(t),r.AlbedoPBR.setEnable(!0),r.MetalnessPBR.setFactor(0),r.MetalnessPBR.setEnable(!0),r.RoughnessPBR.setFactor(.4),r.RoughnessPBR.setEnable(!0),i.trigger("apply"),e.setAttributeAndModes(e.getAttribute("SketchfabMaterial"))},setEventListeners:function(){this._model.get("hasNativeHMD")?window.addEventListener("click",this._cbClick):this._inputManager.setEnable(y.WEBVR_NAVIGATION,!0)},removeEventListeners:function(){this._model.get("hasNativeHMD")?window.addEventListener("click",this._cbClick):this._inputManager.setEnable(y.WEBVR_NAVIGATION,!1)},onClick:function(){this._teleportPressed=!0,this._clickPressed=!0},setListenToEvents:function(e){e?this.setEventListeners():this.removeEventListeners()},isPosedController:function(){var e=this._activeController;return!!(e&&e.pose&&e.pose.hasOrientation)},replaceControllerMesh:function(e){var t=this._geomController;this._proxyControllerMT.removeChild(t);var i=e.BODY;this._geomController=new b.Geometry,this._geomController.getAttributes().Vertex=new b.BufferArray(b.BufferArray.ARRAY_BUFFER,i.VERTEX,3),this._geomController.getAttributes().Normal=new b.BufferArray(b.BufferArray.ARRAY_BUFFER,i.NORMAL,3),this._geomController.getAttributes().Color=new b.BufferArray(b.BufferArray.ARRAY_BUFFER,i.COLOR,1),this._geomController.getPrimitives().push(new b.DrawElements(b.primitiveSet.TRIANGLES,new b.BufferArray(b.BufferArray.ELEMENT_ARRAY_BUFFER,i.TRIANGLES,1))),this._geomController.getPrimitives().push(new b.DrawElements(b.primitiveSet.TRIANGLE_STRIP,new b.BufferArray(b.BufferArray.ELEMENT_ARRAY_BUFFER,i.STRIP,1))),this._proxyControllerMT.addChild(this._geomController);var r=e.BUTTON;this._geomControllerButtons=new b.Geometry,this._geomControllerButtons.getAttributes().Vertex=new b.BufferArray(b.BufferArray.ARRAY_BUFFER,r.VERTEX,3),this._geomControllerButtons.getAttributes().Normal=new b.BufferArray(b.BufferArray.ARRAY_BUFFER,r.NORMAL,3),this._geomControllerButtons.getAttributes().Color=new b.BufferArray(b.BufferArray.ARRAY_BUFFER,r.COLOR,1),this._geomControllerButtons.getPrimitives().push(new b.DrawElements(b.primitiveSet.TRIANGLES,new b.BufferArray(b.BufferArray.ELEMENT_ARRAY_BUFFER,r.TRIANGLES,1))),this._geomControllerButtons.getPrimitives().push(new b.DrawElements(b.primitiveSet.TRIANGLE_STRIP,new b.BufferArray(b.BufferArray.ELEMENT_ARRAY_BUFFER,r.STRIP,1))),this._proxyControllerMT.addChild(this._geomControllerButtons),this._createMaterialWithColor(this._geomControllerButtons.getOrCreateStateSet(),b.vec3.fromValues(.00237,.30699,.57048)),this._updateCorrectionMatrix()},_checkControllerHand:function(e){this._activeController&&"left"===this._activeController.hand?(b.mat4.scale(e,e,b.vec3.set(x,-1,1,1)),this._uNormalScale.setFloat(-1)):this._uNormalScale.setFloat(1)},_updateCorrectionMatrix:function(){var e=this._proxyControllerMT.getMatrix();if(this._gamepadType===w)b.mat4.fromTranslation(e,b.vec3.set(x,0,.03262643,.031930979)),b.mat4.rotateX(e,e,.22*Math.PI),this._checkControllerHand(e);else if(this._gamepadType===L){var t=Object(m.a)().forceControllerOrientation;b.mat4.fromXRotation(e,Math.PI*t),t=Object(m.a)().forceControllerRayOrientation,b.mat4.rotateX(this._pointerMT.getMatrix(),this._pointerMT.getMatrix(),Math.PI*t),this._checkControllerHand(e)}else b.mat4.identity(e)},onPointerDown:function(){l.a.any&&!this._activeController&&(this._pointerClicked=!0)},onPointerUp:function(e){this._pointerClicked=!1,l.a.any||Math.abs(e.canvasX-this._canvasX)<5&&Math.abs(e.canvasY-this._canvasY)<5&&(this._clickPressed=!0,this._teleportPressed=!0)},displayMenu:function(){this._menuPressed=!0},onMouseDown:function(e){l.a.any&&!this._activeController&&this._model.get("hasNativeHMD")&&(this._teleportPressed=!0),l.a.any||(this._canvasX=e.canvasX,this._canvasY=e.canvasY)},updateButtonsPressed:function(){if(this._activeController)for(var e=this._pressedButtons.length,t=0;t<e;++t){var i=this._activeController.buttons[t].pressed;i!==this._pressedButtons[t]&&(this._pressedButtons[t]=i,i?this.onButtonDown(t):this.onButtonUp(t))}},updateHoverAxes:function(){if(this._gamepadType===w)this._scaleValueChange=0,this.updateScaleChangeFromXAxis(w.SCALE_THRESHOLD);else if(this._gamepadType===L){var e=this._activeController.axes[1];e<-L.SCALE_THRESHOLD?(this._teleportPressedAiming=!0,this._uPointerAlpha.setFloat(.5)):this._teleportPressedAiming&&(this._uPointerAlpha.setFloat(1),this._teleportPressedAiming=!1,this._teleportPressed=!0),this._scaleValueChange=0,this.updateScaleChangeFromXAxis(L.SCALE_THRESHOLD,2,-1)}},updateScaleChangeFromXAxis:function(e,t,i){void 0===t&&(t=0);var r=this._activeController.axes[t];void 0===i&&(i=1),r>e?this._scaleValueChange=i:r<-e&&(this._scaleValueChange=-i)},updatePointerClick:function(e){if(this._pointerClicked){if(this._timeSinceLastPointerClick>1.2)return this._menuPressed=!0,this._pointerClicked=!1,void(this._timeSinceLastPointerClick=0);this._timeSinceLastPointerClick+=e}else this._timeSinceLastPointerClick>0&&this._timeSinceLastPointerClick<1.2&&(l.a.any&&(this._clickPressed=!0,this._teleportPressed=!0),this._timeSinceLastPointerClick=0)},onButtonUp:function(e){if(this._gamepadType===M)switch(e){case M.TRIGGER:this._clickPressed=!0,this._teleportPressed=!0;break;case M.TOUCHPAD:this._scaleValueChange=0;break;case M.MENU:this._menuPressed=!0}else if(this._gamepadType===L)switch(e){case L.TRIGGER:case L.THUMBSTICK:this._clickPressed=!0,this._teleportPressed=!0;break;case L.TOUCHPAD:this._scaleValueChange=0;break;case L.MENU:this._menuPressed=!0}else if(this._gamepadType===w)switch(e){case w.TRIGGER_UP:this._clickPressed=!0,this._teleportPressed=!0;break;case w.BY:this._menuPressed=!0}else if(this._gamepadType===T)switch(e){case T.TOUCHPAD:this._clickPressed=!0,this._teleportPressed=!0;break;case T.HOME:this._menuPressed=!0;break;case T.CIRCULAR_UP:case T.CIRCULAR_DOWN:this._scaleValueChange=0}else if(this._gamepadType===C)switch(e){case C.TOUCHPAD:0!==this._scaleValueChange&&(this._menuPressed=!1,this._pointerClicked=!1,this._teleportPressed=!1),this._pointerClicked=!1,this._scaleValueChange=0}else if(this._gamepadType===E)switch(e){case E.TOUCHPAD:this._pointerClicked=!1}else if(this._gamepadType===S)switch(e){case S.TOUCHPAD:this._clickPressed=!0,this._teleportPressed=!0}},onButtonDown:function(e){if(this._gamepadType===M)switch(e){case M.TOUCHPAD:this.updateScaleChangeFromXAxis(M.SCALE_THRESHOLD)}else if(this._gamepadType===L)switch(e){case L.TOUCHPAD:this.updateScaleChangeFromXAxis(L.SCALE_THRESHOLD,2,-1)}else if(this._gamepadType===T)switch(e){case T.CIRCULAR_UP:this._scaleValueChange=1;break;case T.CIRCULAR_DOWN:this._scaleValueChange=-1}else if(this._gamepadType===C)switch(e){case C.TOUCHPAD:this.updateScaleChangeFromXAxis(C.SCALE_THRESHOLD),this._pointerClicked=0===this._scaleValueChange}else if(this._gamepadType===E)switch(e){case E.TOUCHPAD:this._pointerClicked=!0}},getAndSetActiveController:function(){if(navigator.getGamepads){var e=navigator;try{if(!(e=window.parent.navigator))throw new Error("Host is not defined")}catch(t){e=navigator}var t=e.getGamepads(),i=this._activeController;if(this._activeController=this._getControllerWithPressedButtons(t),this._activeController||(this._hasController(t,i)?this._activeController=i:this._activeController=this._getControllerWithOrientationAndPreferredHand(t)),!this._activeController)return this._pressedButtons.length=0,void(this._gamepadType=void 0);if(i!==this._activeController){for(var r=this._pressedButtons.length=this._activeController.buttons.length,a=0;a<r;++a)this._pressedButtons[a]=!1;this._gamepadType=this._getGamepadType(this._activeController),this._updateCorrectionMatrix()}}},_hasController:function(e,t){if(!t)return!1;for(var i=0,r=e.length;i<r;++i)if(e[i]===t)return!0;return!1},_getControllerWithPressedButtons:function(e){for(var t=0,i=e.length;t<i;++t){var r=e[t];if(r){if(!(r.pose&&r.pose.hasOrientation)||r.pose.orientation)for(var a=r.buttons.length,n=0;n<a;++n)if(r.buttons[n].pressed)return r}}},setPreferLeftHand:function(e){this._preferLeftHand!==e&&(this._preferLeftHand=e,this.getAndSetActiveController(),this._updateCorrectionMatrix())},_getControllerWithOrientationAndPreferredHand:function(e){for(var t,i=this._preferLeftHand?"left":"right",r=0,a=e.length;r<a;++r){var n=e[r];if(n){var o=n.pose&&n.pose.hasOrientation;if(!o||n.pose.orientation){if(o&&n.hand===i)return n;!o&&t||(t=n)}}}return t},_getGamepadType:function(e){var t=e&&e.id;if(t)return t=t.toLowerCase(),-1!==t.indexOf("oculus")?-1!==t.indexOf("touch")?w:T:-1!==t.indexOf("cardboard button")?S:-1!==t.indexOf("daydream")?C:-1!==t.indexOf("gear vr")?E:-1!==t.indexOf("spatial controller")?L:-1!==t.indexOf("vive")?M:-1!==t.indexOf("openvr")?(t=this._model.get("displayName"),t=t.toLowerCase(),-1!==t.indexOf("oculus")?w:-1!==t.indexOf("windows")?L:M):void 0},applyPoseMatrix:function(){var e=b.quat.create(),t=b.vec3.create(),i=b.mat4.create();return function(r,a,n,o){if(a){var s=n.stageParameters&&n.stageParameters.sittingToStandingTransform,u=a.orientation;a.hasOrientation&&u&&(s&&(u=b.mat4.getRotation(e,s),b.quat.multiply(u,u,a.orientation)),u=b.quat.set(e,u[0],-u[2],u[1],u[3]),b.quat.multiply(u,this._postMultRotate,u),b.mat4.multiply(r,r,b.mat4.fromQuat(i,u)));var l=this._model.get("worldFactor"),c=a.position;if(a.hasPosition&&c)s&&(c=b.vec3.transformMat4(t,c,s)),c=b.vec3.set(t,c[0]*l,-c[2]*l,c[1]*l),b.vec3.transformQuat(c,c,this._postMultRotate),b.vec3.add(c,c,o),b.mat4.setTranslation(r,c);else if(!a.hasPosition){t[0]=.2*l*("left"===n.hand?-1:1),t[1]=.2*l,t[2]=0,b.vec3.transformQuat(t,t,e),t[2]-=.5*l,b.vec3.add(t,t,o),b.mat4.setTranslation(r,t)}}}}(),updatePointerScaleFromHit:function(e){var t=b.mat4.getTranslation(b.vec3.create(),this.getMatrix()),i=b.vec3.dist(t,e);this._hitScaleOffset=i/this._model.get("worldFactor")},resetPointerScale:function(){this._hitScaleOffset=20},isMenuPressed:function(){return this._menuPressedFrame},isTeleportPressed:function(){return this._teleportPressedFrame},isClickPressed:function(){return this._clickPressedFrame},checkScaleChangeValue:function(){return this._scaleValueChange},checkDownloadController:function(){var e=Object(m.a)().forceController,t=this._gamepadType;if(e)switch(e){case"daydream":t=C;break;case"oculus":t=w;break;case"windows":t=L;break;default:t=M}else if(!this.isPosedController())return;t===C?this._controllerMeshDisplay!==C&&(this._controllerMeshDisplay=C,s.a.getControllerDaydream(this.replaceControllerMesh.bind(this))):t===w?this._controllerMeshDisplay!==w&&(this._controllerMeshDisplay=w,s.a.getControllerOculusTouch(this.replaceControllerMesh.bind(this))):t===L?this._controllerMeshDisplay!==L&&(this._controllerMeshDisplay=L,s.a.getControllerWin(this.replaceControllerMesh.bind(this))):this._controllerMeshDisplay!==M&&(this._controllerMeshDisplay=M,s.a.getControllerVive(this.replaceControllerMesh.bind(this)))},updateNodeVR:function(){var e=b.vec3.create();return function(t,i,r){var a=this._model.get("worldFactor");this.getAndSetActiveController(),this.checkDownloadController(),this.updatePointerClick(i),this.updateButtonsPressed(),this.updateHoverAxes();var o=this.getMatrix();b.mat4.fromScaling(this._pointerMTScale.getMatrix(),b.vec3.set(e,.05,this._hitScaleOffset,1)),b.mat4.fromScaling(o,b.vec3.set(e,a,a,a)),Object(m.a)().forceController?(this.setNodeMask(n.a.NO_PICK),b.mat4.copy(o,this._model.get("humanMatrix")),o[14]+=2*a):this.isPosedController()?(this.setNodeMask(n.a.NO_PICK),this.applyPoseMatrix(o,this._activeController.pose,t,r)):this.setNodeMask(0),this._menuPressedFrame=this._menuPressed,this._clickPressedFrame=this._clickPressed,this._teleportPressedFrame=this._teleportPressed,this._clickPressed=!1,this._menuPressed=!1,this._teleportPressed=!1,this.dirtyBound()}}(),raycastFromController:function(){var e=b.vec3.fromValues(0,20,0),t=b.mat4.create();return function(i,r,a,o,s){var u=this.getMatrix();if(this._gamepadType===L){var l=2*Object(m.a)().forceControllerRayOrientation;u=t,b.mat4.rotateX(u,this.getMatrix(),Math.PI*l)}b.mat4.getTranslation(o,u),b.vec3.set(s,0,a/this._model.get("worldFactor"),0),b.vec3.transformMat4(s,s,u);var c=g.a.computeNearestIntersection3DHotspotFirst(o,s,n.a.PICK_GEOMETRY_FAST,i);return c||b.vec3.transformMat4(s,e,u),c}}()}),"osgSketchfab","Controller"),t.a=P},function(e,t,i){"use strict";var r=i(437),a=i(1328),n=i(559),o=i(613),s=i(5),u=i(59),l=i(871),c=(i.n(l),s.a.osgAnimation),h=s.a.osg,d=c.easeOutCubic,p=function(e){h.Node.call(this),this._menuPanel=new n.a(.9,2.5,o.a.AXIS_BOTH,.2,10,10),this._menuPanel.setUseCache(!0),this._menuPanel.setClickAction("vrHelpButton",this.displayHelp.bind(this)),this._menuPanel.setClickAction("vrExitButton",this.hide.bind(this)),this._menuPanel.setVisible(!1);var t=new a.a(h.vec3.fromValues(0,0,-.05),.15,d,this._menuPanel,e);this._menuPanel.setAnimation(t),this.addChild(this._menuPanel),this._helpPanel=new o.a(2,2,o.a.AXIS_BOTH,.2,10,10),this._helpPanel.setPanelClickAction(this.hideHelp.bind(this)),this._helpPanel.setVisible(!1);var i=new a.a(h.vec3.fromValues(0,0,0),.3,d,this._helpPanel,e);this._helpPanel.setAnimation(i),this.addChild(this._helpPanel),this._model=e};h.createPrototypeNode(p,h.objectInherit(h.Node.prototype,{initialize:function(e){var t=e.hotspot._views[0]._hotspots;this._menuPanel.initialize("skfb_front/macros/vr/vr-menu",{hasHotspotsNavigation:t.length&&t.length>1}),r.a.getBaseVR(function(e){var t=u.default.instance.getOrCreateTexture(e.MENU_HELP,{internalFormat:h.Texture.RGBA}).texture;this._helpPanel.initialize(t,{width:1e3,height:500})}.bind(this))},display:function(e,t){this._menuPanel.displayInView(e,t,this._model.get("worldFactor"))},hide:function(){this._menuPanel.setVisible(!1),this._helpPanel.isVisible()&&this._helpPanel.setVisible(!1)},setHomeAction:function(e){this._menuPanel.setClickAction("vrHomeButton",e)},setNextAction:function(e){this._menuPanel.setClickAction("vrNextButton",e)},setPrevAction:function(e){this._menuPanel.setClickAction("vrPrevButton",e)},displayHelp:function(){h.mat4.copy(this._helpPanel.getMatrix(),h.mat4.create()),h.mat4.setTranslation(this._helpPanel.getMatrix(),h.vec3.fromValues(0,0,.2)),h.mat4.multiply(this._helpPanel.getMatrix(),this._menuPanel.getMatrix(),this._helpPanel.getMatrix()),this._helpPanel.setVisible(!0)},hideHelp:function(){this._helpPanel.isVisible()&&this._helpPanel.setVisible(!1)},isVisible:function(){return this._menuPanel.isVisible()},isHelpVisible:function(){return this._helpPanel.isVisible()},updateHit:function(e){return this._helpPanel.isVisible()?this._helpPanel.updateHit(e):this._menuPanel.isVisible()?this._menuPanel.updateHit(e):void 0},click:function(){this._helpPanel.isVisible()?this._helpPanel.click():this._menuPanel.isVisible()&&this._menuPanel.click()}}),"osgSketchfab","Menu"),t.a=p},function(e,t,i){"use strict";var r=i(5),a=r.a.osg,n=function(e,t,i,r,n){this._startPosOffset=e,this._startPos=a.vec3.create(),this._targetPos=a.vec3.create(),this._duration=t,this._easingFunc=i,this._result=a.vec3.create(),this._hasStarted=!1,this._reverse=!1,this._finished=!0,this._node=r,this._model=n};n.prototype={isFinished:function(){return this._finished},_reverseAnim:function(){this._reverse=!this._reverse},start:function(){var e=a.vec3.create();return function(t){this._started=.05*-t,this._hasStarted=!1,this._finished=!1,a.vec3.scale(e,this._startPosOffset,this._model.get("worldFactor")),this._reverse?(a.mat4.getTranslation(this._startPos,this._node.getMatrix()),a.vec3.add(this._targetPos,this._startPos,e),this._node.setOpacity(1)):(a.mat4.getTranslation(this._targetPos,this._node.getMatrix()),a.vec3.add(this._startPos,this._targetPos,e),this._node.setOpacity(0)),a.mat4.setTranslation(this._node.getMatrix(),this._startPos)}}(),update:function(e,t){if(!this._finished){var i=t.getFrameStamp().getSimulationTime();if(this._started<0)return this._started+=t.getFrameStamp().getDeltaTime(),!0;this._hasStarted||(this._started=i,this._hasStarted=!0);var r=(i-this._started)/this._duration;return r>1&&(this._finished=!0,r=1),this._easingFunc&&(r=this._easingFunc(r)),this.interpolate(r,e),this._finished&&(this._reverseAnim(),this._onFinishCallback&&this._onFinishCallback(),this._node.dirtyBound()),!0}},interpolate:function(e,t){a.vec3.lerp(this._result,this._startPos,this._targetPos,e),a.mat4.setTranslation(t.getMatrix(),this._result),this._reverse?this._node.setOpacity(1-e):this._node.setOpacity(e)},setOnFinishCallback:function(e){this._onFinishCallback=e}},t.a=n},function(e,t,i){"use strict";var r=i(62),a=i(1330),n=i(1331),o={FeatureName:"ARKit",ModelType:a.a,ViewListType:[n.a]},s=r.a.create(o);s.prototype.getNodeIn=function(){return this._views[0].getFeatureNode()},s.prototype.getNodeOut=function(){return this._views[0].getArSceneNode()},s.prototype.getWidgetNode=function(){return this._views[0].getWidgetNode()},t.a=s},function(e,t,i){"use strict";var r=i(15),a=i.n(r),n=i(16),o=a.a.Model.extend({defaults:{enable:Object(n.a)().arkit}});t.a=o},function(e,t,i){"use strict";var r=i(5),a=i(8),n=i(34),o=i(872),s=i(608),u=i(1332),l=i(57),c=i(43),h=i(79),d=i(59),p=i(1333),f=i(187),m=i(119),g=i(16),_=i(63),v=i(1334),b=i(419),y=i.n(b),x=i(78),S=i(145),M=new y.a({device:"VWR",listen:!0}),w=r.a.osg,T=w.vec4.fromValues(1,1,1,.7),C=1.5,E=C+.5,L=.7;Object(g.a)().arkitDebug&&(L=1,T=w.vec4.fromValues(1,1,1,1),C=200);var P=w.vec3.create(),A=w.vec3.create(),D=w.vec3.create(),O=w.vec3.create(),k=w.vec3.create(),R=w.vec3.create(),I=w.vec3.create(),F=a.a.extend({initialize:function(){a.a.prototype.initialize.apply(this,arguments),this._viewer=this.options.context.getViewer(),this._featureNode=new w.MatrixTransform,this._featureNode.setName("Feature - ARKit"),this._arSceneNode=new w.MatrixTransform,this._arSceneNode.setName("ARKit - Scene"),this._featureNode.addChild(this._arSceneNode),n.a.getModelDisplayed().then(this.onEnable.bind(this))},initGraphNode:function(){this._elevationWidget=new v.a(this._viewer.getCamera()),this._widgetNode=new w.Node,this._widgetNode.setName("ARKit - Widget");var e=this._widgetNode.getOrCreateStateSet();this._widgetNode.setNodeMask(c.a.NO_SHADOW),this._createWidgetStateSet(e);var t=w.Uniform.createFloat4(T,"uColor");e.addUniform(t),this._uColor=t.getInternalArray(),e.setTextureAttributeAndModes(0,f.a.dummyTexture,w.StateAttribute.OVERRIDE),this._featureNode.addChild(this._widgetNode),this._shadowPlaneNode=new w.MatrixTransform,this._shadowPlaneNode.setName("ARKit - ShadowPlane"),e=this._shadowPlaneNode.getOrCreateStateSet(),e.setShaderGeneratorName("shading-ar"),e.setTextureAttributeAndModes(0,w.Texture.textureNull,w.StateAttribute.OVERRIDE)},_createWidgetStateSet:function(e){return e.setRenderBinDetails(l.a.EXTRA,"RenderBin"),e.setShaderGeneratorName("shading-ar"),e.setAttributeAndModes(_.a.CULL_DISABLE),e.setAttributeAndModes(_.a.BLEND_SUBSTRACTIVE),e.setAttributeAndModes(_.a.DEPTH_LESS_NO_WRITE),e.addUniform(w.Uniform.createInt(0,"uTextureIcon")),e.addUniform(w.Uniform.createFloat(0,"uDisplay2D")),e.addUniform(w.Uniform.createFloat2(w.vec2.fromValues(1,1),"uScale")),e},enableARShadows:function(e){e?(this._widgetNode.addChild(this._shadowPlaneNode),this._widgetNode.dirtyBound()):(this._widgetNode.removeChild(this._shadowPlaneNode),this._widgetNode.dirtyBound())},_setPlaneTexture:function(e){var t=d.default.instance.getOrCreateTexture(e.SKFB_LOGO,{internalFormat:w.Texture.RGBA});this._widgetNode.getOrCreateStateSet().setTextureAttributeAndModes(0,t.texture)},_getOrCreatePlaneGeometry:function(){return this._planeGeom||(this._planeGeom=w.createTexturedQuadGeometry(-.5,0,-.5,1,0,0,0,0,1),this._planeGeom.setName("PlaneGeometry")),this._planeGeom},initEvents:function(){this.model.bind("change:enable",this.onEnable,this),this.model.bind("pick",this.onPick,this),S.a.initAR(this)},onEnable:function(){if(this.model.get("enable")){this._planeNodes={},this._globalTranslation=w.vec3.create(),this._globalScale=w.vec3.fromValues(1,1,1),this._globalRotation=w.mat4.create(),this._startMat=w.mat4.create(),this._startPos=w.vec2.create(),this._curPos=w.vec2.create(),this._elevation=0,this.initGraphNode(),M.on("message:arShadows",function(e){this.enableARShadows(parseInt(e.data.arShadows,10)),e.removeFromHash()}.bind(this)),n.a.getFirstAnimation().then(function(){var e=this._viewer.getFeatures(),t=e.lighting;t.getModel().setPreset("LightFromAbove"),t.getModel().set("enable",!0);var i=e.environment;if(i.getModel().get("enable"))i.getModel().set("shadowEnable",!1);else{var r=d.default.instance.getEnvironmentCollection();if(r.length){var a=r.at(0).get("uid");i.getModel().set("uid",a)}else i.getModel().set("uid","2fa15e0b1cee45a5b02605a288934e1b");i.getModel().set("shadowEnable",!1),i.getModel().set("enable",!0)}this.enableARShadows(!0)}.bind(this)),this.initEvents(),this._viewer.getViewerOSGJS().requestContinuousUpdate(!0),p.a.getARKitAssets(this._setPlaneTexture.bind(this));var e=this._viewer.getFeatures();e.background.getModel().set("enable","none"),e.postProcess.getModel().set("enable",!1),e.postProcess.getModel().set("AR",!0),e.hotspot.getWidgetNode().setNodeMask(0),e.autospin.getModel().set("enable",!1),this._featureNode.addUpdateCallback(o.a),this._widgetNode.addUpdateCallback(this),this._widgetNode.addChild(this._elevationWidget),o.a.addPlaneListener(this),o.a.addCameraListener(new u.a(this._viewer.getCamera())),this._viewer.getViewerOSGJS().requestContinuousUpdate(!0),this._inputManager=this._viewer.getInputManager(),Object(g.a)().arkitDebug?(window.publicLibraries.$(".viewer").css("background","rgba(125,125,125,255)"),e.camera.getModel().set("indexManipulator",s.a.FPS)):(window.publicLibraries.$(".viewer").css("background","rgba(0,0,0,0)"),this._inputManager.setEnable(x.a.SCENE,!1)),this._arSceneNode.setNodeMask(0),this._viewer.getCamera().getClearColor()[3]=0,h.a.getBoxReady().then(function(){var e=h.a.getModelBoxWithDisplacement(),t=e.getMin()[2];this._bBoxHeight=e.getMax()[2]-t;var i=1/this._bBoxHeight;w.vec3.set(this._globalScale,i,i,i),this._invAnchorPoint=e.center(w.vec3.create()),this._invAnchorPoint[2]=t,w.vec3.negate(this._invAnchorPoint,this._invAnchorPoint),Object(g.a)().arkitDebug&&(this._viewer.getFeaturesManager().focusOnTargetAndEye(w.vec3.fromValues(0,0,0),w.vec3.fromValues(5,5,2),.1),this.onPlanesChange([{uid:"123",transform:w.mat4.IDENTITY,center:w.vec3.ZERO,extent:w.vec3.fromValues(10,1,10)}]));var r=e.radius()*i;this._shadowPlaneGeom=w.createTexturedQuadGeometry(-r,-r,0,2*r,0,0,0,2*r,0),this._shadowPlaneNode.addChild(this._shadowPlaneGeom),this._shadowPlaneNode.dirtyBound()}.bind(this))}},getFeatureNode:function(){return this._featureNode},getWidgetNode:function(){return this._widgetNode},getArSceneNode:function(){return this._arSceneNode},update:function(e,t){var i=t.getFrameStamp();if(this._time=i.getSimulationTime(),this._modelPlaced){var r=this._time-this._hitTime;return r<.5&&(this._uColor[3]=r/.5*L),r>C&&r<E&&(this._uColor[3]=(1-(r-C)/.5)*L),!0}},onPick:function(e){var t=m.a.computeNearestIntersection2D(e[0],e[1],c.a.PICK_GEOMETRY_FAST,this._widgetNode);this._hitTime=this._time,t&&(this._modelPlaced=!0,w.vec3.transformMat4(this._globalTranslation,t._localIntersectionPoint,w.computeLocalToWorld(t._nodePath.slice(1))),this._arSceneNode.setNodeMask(-1),this._updateSceneTransforms(),window.location.hash="buzz",window.setTimeout(function(){window.location.hash=""},200))},_updateSceneTransforms:function(){var e=this._arSceneNode.getMatrix();w.mat4.fromTranslation(e,this._globalTranslation),w.mat4.multiply(e,e,this._globalRotation),w.mat4.scale(e,e,this._globalScale),w.mat4.translate(e,e,this._invAnchorPoint),w.mat4.translate(e,e,w.vec3.set(P,0,0,this._elevation));var t=this._elevation>=0?this._bBoxHeight:0;this._elevationWidget.setAnchorAndElevation(this._globalTranslation,(this._elevation+t)*this._globalScale[0]);var i=this._shadowPlaneNode.getMatrix();w.mat4.fromTranslation(i,this._globalTranslation);for(var r=this._viewer.getFeatures(),a=r.lighting,n=a.getModel().get("lights"),o=0;o<n.length;o++){var s=n[o];s.isCastingShadows()&&s.dirty()}},_getPlaneNode:function(e){var t=this._planeNodes[e];if(!t){this._hitTime=this._time,t=new w.MatrixTransform,t.addChild(this._getOrCreatePlaneGeometry());var i=t.getOrCreateStateSet(),r=w.Uniform.createFloat2(w.vec2.fromValues(1,1),"uScale");i.addUniform(r),t._uScale=r.getInternalArray(),this._planeNodes[e]=t}return t},onPlanesChange:function(e){for(var t in this._planeNodes){var i=this._planeNodes[t];i.updated=!1}for(var r,a=0;a<e.length;a++){var n=e[a];r=this._getPlaneNode(n.uid),o.a.getMatrixTransformFromARPlane(r.getMatrix(),n),r._uScale[0]=n.extent[0],r._uScale[1]=n.extent[2],0===r.getParents().length&&this._widgetNode.addChild(r),r.updated=!0,r.dirtyBound()}for(t in this._planeNodes)i=this._planeNodes[t],!i.updated&&r.getParents().length&&this._widgetNode.removeChild(i);this._widgetNode.dirtyBound()},startMotion:function(e){this._inputManager.setEnable(x.a.MANIPULATORS,!1),w.vec2.set(this._startPos,e.canvasX,e.canvasY)},endMotion:function(){this._inputManager.setEnable(x.a.MANIPULATORS,!0),this.endElevate(),this.endRotate(),this.endScale()},motion:function(e){if(this._rotating)this.rotate(e);else if(this._scaling){w.vec2.set(this._curPos,e.canvasX,e.canvasY);var t=this._viewer.getCanvas().height,i=1-(this._curPos[1]-this._startPos[1])/t;e.scale=i,this.scale(e)}else this._elevating&&this.elevate(e)},startRotate:function(e){this._rotating=!0,w.vec2.set(this._startPos,e.canvasX,e.canvasY),w.mat4.copy(this._startMat,this._globalRotation)},endRotate:function(){this._rotating=!1},rotate:function(e){this._rotating||this.startRotate(e),w.vec2.set(this._curPos,e.canvasX,e.canvasY);var t=this._viewer.getCanvas().width,i=(this._curPos[0]-this._startPos[0])/t*Math.PI*2;w.mat4.rotateZ(this._globalRotation,this._startMat,i),this._updateSceneTransforms()},startScale:function(){this._scaling=!0,this._initScale=this._globalScale[0]},endScale:function(){this._scaling=!1},scale:function(e){var t=Math.max(e.scale*this._initScale,1e-8);w.vec3.set(this._globalScale,t,t,t),this._updateSceneTransforms()},startElevate:function(e){this._elevating=!0,this._initElevation=this._elevation,w.vec2.set(this._startPos,e.glX,e.glY),this._startWorldElevation=this._getElevationFromScreenCoord(this._startPos),this._elevationWidget.setVisible(!0,.5),this._hitTime=this._time},endElevate:function(){this._elevating=!1,this._elevationWidget.setVisible(!1,.5)},elevate:function(e){this._elevating||this.startElevate(e),w.vec2.set(this._curPos,e.glX,e.glY);var t=this._getElevationFromScreenCoord(this._curPos),i=t-this._startWorldElevation;this._elevation=this._initElevation+i,this._elevation<0&&(this._elevation=0),this._updateSceneTransforms()},_getElevationFromScreenCoord:function(e){w.vec2.copy(D,e),D[2]=0,m.a.getWorldPositionFromScreenPoint(D,O),D[2]=1,m.a.getWorldPositionFromScreenPoint(D,k),w.vec3.sub(I,k,O),w.vec3.normalize(I,I),w.mat4.getLookAt(R,P,A,this._viewer.getCamera().getViewMatrix()),w.vec3.subtract(R,R,P),R[2]=0,w.vec3.normalize(R,R),w.mat4.getTranslation(P,this._featureNode.getMatrix());var t=w.vec3.length(this._globalTranslation),i=w.vec3.dot(R,I),r=-(w.vec3.dot(R,O)+t),a=r/i;return 0===i&&(a=0),w.vec3.scaleAndAdd(P,O,I,a),P[2]/this._globalScale[0]}});t.a=F},function(e,t,i){"use strict";var r=i(5),a=i(872),n=r.a.osg,o=function(e){this._camera=e,this._prevFrame={valid:!1,position:n.mat4.create(),direction:n.mat4.create(),speed:-1,at:-1}};o.prototype={onCameraChange:function(e,t){return!e||!t||(a.a.getCameraMatrix(this._camera.getViewMatrix(),e),n.mat4.copy(this._camera.getProjectionMatrix(),t),!0)}},t.a=o},function(e,t,i){"use strict";t.a={getARKitAssets:function(e){i.e(12).then(function(){e(i(1573).default)}.bind(null,i)).catch(i.oe)}}},function(e,t,i){"use strict";var r=i(5),a=i(43),n=i(869),o=i.n(n),s=i(870),u=i.n(s),l=i(107),c=i(63),h=i(57),d=r.a.osg,p=d.createTexturedQuadGeometry(-.5,0,0,1,0,0,0,1,0),f=d.vec3.fromValues(0,0,1),m=d.vec3.create(),g=d.vec3.create(),_=d.mat4.create(),v=function(e){d.MatrixTransform.call(this),this._camera=e;var t=d.Uniform.createFloat1(.7,"uAlpha");this._uAlpha=t.getInternalArray();var i=p.getOrCreateStateSet();i.setRenderBinDetails(h.a.EDITOR_GIZMO,"RenderBin"),i.setAttributeAndModes(c.a.DEPTH_LESS_NO_WRITE),i.addUniform(t),i.setAttributeAndModes(l.a.createShader(o.a,u.a,"AR-Elevation-Widget","ARElevation")),this.addChild(p),this.addUpdateCallback(this),this.setNodeMask(0)};d.createPrototypeNode(v,d.objectInherit(d.MatrixTransform.prototype,{setVisible:function(e,t){e!==this._visible&&(t||(t=.01),this._delay=t,this._visible=e,e&&this.setNodeMask(a.a.NO_PICK_NO_SHADOW),this._isFading=!0)},update:function(e,t){var i=t.getFrameStamp();if(this._time=i.getSimulationTime(),this._updateTransforms(),this._isFading)return this._updateFading(),!0},_updateTransforms:function(){if(this._anchorPoint){var e=this.getMatrix();d.mat4.invert(_,this._camera.getViewMatrix()),d.mat4.getTranslation(m,_),m[2]=this._anchorPoint[2],d.mat4.lookAt(e,this._anchorPoint,m,f),d.mat4.invert(e,e),d.mat4.setTranslation(e,this._anchorPoint);var t=d.vec3.length(d.vec3.subtract(m,m,this._anchorPoint));d.mat4.scale(e,e,d.vec3.set(g,.01*t,this._elevation,1))}},_updateFading:function(){this._startTime||(this._startTime=this._time);var e=this._time-this._startTime;e<this._delay?this._visible?this._uAlpha[0]=e/this._delay*.7:this._uAlpha[0]=.7*(1-e/this._delay):(this._visible||this.setNodeMask(0),this._startTime=0,this._isFading=!1)},setAnchorAndElevation:function(e,t){this._anchorPoint=e,this._elevation=t}}),"osgSketchfab","ElevationWidget"),t.a=v},function(e,t,i){"use strict";var r=i(62),a=i(1336),n=i(1338),o={FeatureName:"sound",ModelType:a.a,ViewListType:[n.a]},s=r.a.create(o);s.prototype.getNode=function(){return this._views[0].getNode()},s.prototype.getWidgetNode=function(){return this._views[0].getNodeEditor()},s.prototype.prepareForScreenShot=function(){var e=r.a.prototype.prepareForScreenShot.call(this);return e&&this._views[0].setPauseUpdate(!0),e},s.prototype.resetAfterScreenShot=function(){r.a.prototype.resetAfterScreenShot.call(this),this._views[0].setPauseUpdate(!1)},t.a=s},function(e,t,i){"use strict";var r=i(120),a=i(16),n=i(701),o=i(59),s=i(572);t.a=r.a.extend({getModelOptionPath:function(){return"sound"},defaults:function(){return{currentSoundIndex:-1,visible:Object(a.a)().uiSound,autoplay:!0,playing:!1,volume:void 0,select:void 0,enable:!0}},getName:function(){return"Sound"},init:function(e){this._viewer=e.getViewer(),this.set("volume",s.a.getVolume());var t=e.getModel().get("options").sound;this.set("soundtracks",o.default.instance.getSoundCollection()),this.setJSON(t)},setJSON:function(e,t){var i=e&&e.soundtracks;if(i&&i.length)for(var r=this.get("soundtracks"),a=0;a<i.length;++a){var o=i[a],s=r.findWhere({uid:o.uid}),u=!0;s?s.get("isInit")?s=s.duplicate():u=!1:s=new n.a,s.setJSON(o,t),s.set("isInit",!0),u&&r.add(s)}},getJSON:function(){var e=[];return this.get("soundtracks").each(function(t){e.push(t.getJSON())}),{soundtracks:e}}})},function(e,t,i){"use strict";var r=i(5),a=i(42),n=i.n(a),o=i(7),s=i.n(o),u=i(83),l=i(670),c=r.a.osg,h=.2;l.a&&(h=.35);var d=function(e,t,i){var r=i.isNew()?i.get("url"):i.get("files")[0].url;this._src=r,t&&this.setMediaElement(t),this._manager=e,this._model=i,this._mediaElementSource=void 0,this._gain=void 0,this._panner=void 0,this._canPlayDefered=void 0,this._isPlaying=!1,this._seeking=!1,this._isPlayerPendingToPlay=!1,this._doPausePlayerWhenPendingToPlayFinished=void 0,this.pendingToPlayResolvedBound=this.pendingToPlayResolved.bind(this),this.releasePlayerBound=this.releasePlayer.bind(this)};d.prototype={setMediaElement:function(e){this._player=e,this._player.setAttribute("src",this._src),n.a.apple.device||this._player.load(),this._player.addEventListener("ended",this.onEnded.bind(this))},isPlayerPlaying:function(){return!!this._player&&!(!(this._player.currentTime>0)||this._player.paused||this._player.ended)},playerPlay:function(){if(this._player&&!this.isPlayerPlaying()){if(this._isPlayerPendingToPlay)return this._pendingToPlayPromise;this._managerContextVersion=this._manager._releaseSafeCounter;var e;try{e=this._player.play()}catch(e){return this.checkAndHandleDOMError(e),s.a.resolve()}return this._isPlayerPendingToPlay=!0,this._pendingToPlayPromise=e,e||(e=new s.a(function(e){this._player.addEventListener("play",e)}.bind(this))),e.then(this.pendingToPlayResolvedBound).catch(function(e){if(e instanceof DOMException&&"The element has no supported sources."===e.message)return this._isPlayerPendingToPlay=!1,void(this._pendingToPlayPromise=void 0);if(!this.checkAndHandleDOMError(e))return this._doPausePlayerWhenPendingToPlayFinished||this._managerContextVersion!==this._manager._releaseSafeCounter||this._manager.releasePending?void this.pendingToPlayResolved():(this._isPlayerPendingToPlay=!1,this._pendingToPlayPromise=void 0,void window.setTimeout(this.playerPlay.bind(this),1e3))}.bind(this)),e}},playerPause:function(){return this._gain&&0!==this._gain.gain.value&&this.setGainValue(0),this._doPausePlayerWhenPendingToPlayFinished?this._doPausePlayerWhenPendingToPlayFinished.promise:this._isPlayerPendingToPlay?(this._doPausePlayerWhenPendingToPlayFinished=new u.a,this._doPausePlayerWhenPendingToPlayFinished.promise):(this.isPlayerPlaying()&&this._player&&this._player.pause(),s.a.resolve())},pendingToPlayResolved:function(){this._isPlayerPendingToPlay=!1,this._pendingToPlayPromise=void 0,this._doPausePlayerWhenPendingToPlayFinished&&(this._player&&this._player.pause(),this._doPausePlayerWhenPendingToPlayFinished.resolve(),this._doPausePlayerWhenPendingToPlayFinished=void 0),this.updateVolume()},releasePlayer:function(){this._player=void 0,this._mediaElementSource=void 0},onEnded:function(){this._model.get("loop")||this.pause()},play:function(){this._isPlaying=!0,this.updateVolume()},pause:function(){this._isPlaying=!1,this.updateVolume()},getModel:function(){return this._model},updateVolume:function(){if(this._player){if(this._manager.getIsMute())return void this.setGainValue(0);if(!this._gain||!this._manager.isTabVisible()||this._panner&&!this._manager.getHas3D())return void this.setGainValue(0);if(void 0===this._model.get("volume")||!this._isPlaying||this._seeking||!this._manager.isPlaying()){if(this._player.muted)return;return c.debug("[SOUND] Volume Change: "+this._model.get("name")+" = 0"),void this.setGainValue(0)}this._volumeReal=this._model.get("volume")*this._manager.getVolume(),(this._player.muted||Math.abs(this._gain.gain.value-this._volumeReal)>1e-6)&&(c.debug("[SOUND] Volume Change: "+this._model.get("name")+" = "+this._volumeReal),this.setGainValue(this._volumeReal))}},updatePosition:function(e){if(this._panner){var t=this._manager.getRadius();this._manager._setPannerPosition(this._panner,e[0]/t,e[1]/t,e[2]/t)}},_seekToSync:function(e){return!!this._player&&(this._player.duration<1.5||(Math.abs(this._player.currentTime-e)>h?this._player.seeking?(this._seeking=!0,!1):(this._player.currentTime=e+.05,this._seeking=!0,!1):!(this._seeking&&!this._player.seeking&&(this._seeking=!1,0))))},setTime:function(e,t){if(this._manager.canPlay()){if(!this._player||!this._gain){if(!t)return;this.updateFromModel()}if(!isNaN(this._player.duration)&&0!==this._player.duration){var i=this._model.get("loop");if(this.isSoundAsync())return void(i||this._player.currentTime<this._player.duration?this.play():this.pause());var r=e-this._model.get("startTime"),a=r>=0;if(a&&(i?r%=this._player.duration:a=a&&this._player.duration>=r),!a)return this.isPlayerPlaying()&&(this._player.currentTime=0,this.playerPause()),void this.pause();this._seekToSync(r)&&this._manager.isPlaying()?(!this.isPlayerPlaying()&&this._manager.isPlaying()&&this.playerPlay(),this.play()):this.pause()}}},isSoundAsync:function(){return!1===this._manager._hasAnim||!this._model.get("sync")},setRefDistance:function(e){if(this._panner&&0!==e){var t=e/this._manager.getRadius();this._panner.refDistance=t}},setMaxDistance:function(e){this._panner&&(-1===e?(e=2*this._panner.refDistance,this._model.set("distanceMax",e*this._manager.getRadius())):e/=this._manager.getRadius(),this._panner.maxDistance=e)},updateFromModel:function(){if(this._manager.getHas3D()||this._manager.isTabVisible()){if(!this._player){var e=this._manager._createAudio();e&&this.setMediaElement(e)}this._player&&(this._player.loop=this._model.get("loop"));var t;if(t=this._model.get("ambient")?this._manager.connectAmbientSound(this):this._manager.connect3DSound(this),this.isSoundAsync()&&this.play(),t)return void t.catch(function(e){this.checkAndHandleDOMError(e)}.bind(this));this.isSoundAsync()&&this.playerPlay(),this.updateVolume()}},checkAndHandleDOMError:function(e){c.debug(e.message);var t=["Failed to execute 'play' on 'HTMLMediaElement': API can only be initiated by a user gesture.","play() can only be initiated by a user gesture."];return e instanceof DOMException&&-1!==t.indexOf(e.message)&&(this._authErrors=!0,this.pendingToPlayResolved(),this._manager._lock(),!0)},whenReady:function(){if(!this._canPlayDefered){var e=new s.a(function(e){this._player.addEventListener("canplaythrough",e)}.bind(this));this._canPlayDefered=e}return this._canPlayDefered},setGainValue:function(e){if(this._player&&(this._player.muted=e<=0),this._gain){var t=this._gain.gain;if(t.setValueAtTime){var i=this._manager.getOrCreateAudioContext();if(!i)return;t.setValueAtTime(e,i.currentTime)}else t.value=e}}},t.a=d},function(e,t,i){"use strict";var r=i(79),a=i(5),n=i(7),o=i.n(n),s=i(8),u=i(34),l=i(16),c=i(47),h=i(42),d=i.n(h),p=i(37),f=i(1339),m=i(572),g=i(458),_=i(702),v=i(118),b=a.a.osg;t.a=s.a.extend({initialize:function(e){s.a.prototype.initialize.apply(this,arguments),this._currentFrame=0,this._currentSimulationTime=0,this._soundPromises=[],this._soundObjects=[],this._context=e.context,this._viewer=this._context.getViewer();var t=Object(l.a)().soundEnable;this.model.set("enable",t),Object(l.a)().soundMute&&(this.model.set("mute",!0),this.model.set("volume",0),m.a.setMute(!0)),this._nodeFeature=new b.Node,this._nodeFeature.setName("Feature - Sound"),Object(c.a)()&&f.a.init(this.model,this._context,this._nodeFeature),this.listenTo(this.model,"change:playing",this.onPlayingChange.bind(this)),this.listenTo(this.model,"change:enable",this.onEnableChange.bind(this)),this.listenTo(this.model,"change:volume",this.updateVolume.bind(this)),this.listenTo(this.model,"change:mute",this.updateMute.bind(this));var i=this.model.get("soundtracks");Object(v.a)()||t&&m.a.checkWillHaveSounds(this._viewer.model)||i.reset();var r=i.length>0;if(!r&&(u.a.resolveHasSound(r),!Object(c.a)()))return void this.model.set("enable",!1);if(this._nodeFeature.setCullCallback(this),Object(c.a)()||r){var a=Object(_.a)();a&&document.addEventListener(a,this.tabChange.bind(this))}if(d.a.apple.device){var n,h,p=!1,g=[];for(n=0,h=i.length;n<h;n++){var y=i.at(n);!p&&y.get("ambient")?p=y:g.push(y)}for(n=0,h=g.length;n<h;n++)i.remove(g[n]);if(!p)return void u.a.resolveHasSound(!1)}this.listenTo(i,"add",this.onAdd.bind(this)),this.listenTo(i,"remove",this.onRemove.bind(this)),this.listenTo(i,"select",this.onSelectChanged.bind(this)),m.a.setWaiting(!Object(c.a)()),m.a.setHas3D(!1),i.each(this.onAdd.bind(this)),u.a.resolveHasSound(r);var x=[];x.push(u.a.getHasAnimation()),Object(l.a)().soundPreload&&x.push(o.a.all(this._soundPromises).then(function(){u.a.resolveSoundsCanPlayTrough(!0)})),o.a.all(x).then(function(e){this._hasAnim=e[0],m.a.setHasAnim(this._hasAnim),u.a.resolveSoundsCanPlayTrough(!0),this._hasAnim||(m.a.setWaiting(!1),this.play()),u.a.getFirstAnimation().then(function(){if(Object(c.a)()&&f.a.initDepthTexture(),m.a.setHas3D(!0),this.updatePositionAndTime(),this._hasAnim){m.a.setWaiting(!1);var e=this._viewer.getFeatures().animation.getModel();this._featureAnimationModel=e,e.bind("change:playing",this.onAnimationPlaying,this),e.bind("change:speed",this.onAnimationSpeedChange,this),e.bind("seek",this.onAnimationTimeSeek,this),e.bind("change:currentUID",this.onUidChange,this),this.onAnimationPlaying(e)}}.bind(this))}.bind(this))},isTabHidden:function(){return document[this._hidden]},tabChange:function(){this.model.get("enable")&&(Object(_.b)()?m.a.hide():(m.a.show(),this._hasAnim&&this._featureAnimationModel?this.onAnimationPlaying(this._featureAnimationModel):m.a.forcePlay(!0)))},animationTimeSync:function(){if(m.a.canPlay()&&this._featureAnimationModel){if(1===this._featureAnimationModel.get("speed")){var e=this.getTimeFromAnimationProgress();e!==this._currentSimulationTime&&(this._currentSimulationTime=e,this.updatePositionAndTime(this._featureAnimationModel.get("playing")))}}},updatePositionAndTime:function(e){if(m.a.canPlay())for(var t=this._currentSimulationTime,i=m.a.getHas3D()&&this._viewer.getFeaturesManager&&this._viewer.getFeaturesManager(),r=0,a=this._soundObjects.length;r<a;r++){var n=this._soundObjects[r];i&&n.updatePosition(Object(g.d)(n.getModel())),n.setTime(t,e)}},onAnimationPlaying:function(e){if(1===this._featureAnimationModel.get("speed")){var t=e.get("playing");this.model.set("playing",t),t?this.play():this.pause()}},onUidChange:function(e){"-1"===e.get("currentUID")?this.pause():e.get("playing")&&this.play()},getTimeFromAnimationProgress:function(){var e=this._featureAnimationModel.getFirstEnabledAnimation();if(void 0===e)return 0;var t=e.get("duration");return this._featureAnimationModel.get("progress")*t/100},onAnimationTimeSeek:function(){this._currentSimulationTime=this.getTimeFromAnimationProgress()},onAnimationSpeedChange:function(e){if(1!==e.get("speed")){if(this.pause(),!Object(c.a)())return;m.a.getProxyModel().trigger("sound-show","Warning. Changing the animation speed will not change the sound speed. This can lead to unexpected sound playback issues",{position:"top",duration:5e3})}else this.play()},onSoundChange:function(e){e.get("soundObject").updateFromModel(e),p.a.draw()},onSoundSnapChange:function(e){e.set("snapChanged",!0)},cull:function(){return this._hasAnim&&this._featureAnimationModel&&this.animationTimeSync(),Object(c.a)()&&!this._pauseUpdate&&f.a.updateVisibility(),!0},setPauseUpdate:function(e){this._pauseUpdate=e},getNode:function(){return this._nodeFeature},getNodeEditor:function(){return f.a.getNodeCamera()},onSelectChanged:function(e){this.model.get("select")!==e&&(this.model.set("select",e),this.model.get("soundtracks").trigger("select",e),p.a.draw())},onAdd:function(e){var t=m.a.createSound(e,this.model.get("playing")),i=e.get("distance");Object(c.a)()&&-1===i&&(e.set("distance",0),r.a.getBoxReady().then(function(){var t=r.a.getModelBoxWithDisplacement();e.set("distance",t.radius()),t.center(e.get("position"))}.bind(this)),this.onSelectChanged(e),this._hasAnim&&e.set("sync",!0)),e.set("soundObject",t),e.on("change",this.onSoundChange.bind(this)),e.on("change:snap",this.onSoundSnapChange.bind(this)),this._soundObjects.push(t);var a=new o.a(function(e){Object(l.a)().soundPreload?t.whenReady().then(function(){e(t)}):e(t)});if(this._soundPromises.push(a),Object(c.a)()){e.get("ambient")||f.a.addIcon(e);var n=this._viewer.getFeatures().animation;if(n){var s=n.getModel();if(s&&1!==s.get("speed")){m.a.getProxyModel().trigger("sound-show","Warning. The animation speed is not x1 but sound will play at normal speed. This can lead to unexpected sound playback issues.",{position:"top",duration:5e3})}}}},onRemove:function(e){e===this.model.get("select")&&this.onSelectChanged(),c.a&&f.a.removeIcon(e);var t=e.get("soundObject");m.a.removeSound(t),this._soundObjects.splice(this._soundObjects.indexOf(t),1)},onEnableChange:function(){this.model.set("playing",this.model.get("enable"))},onPlayingChange:function(){this.model.get("enable")&&(this.model.get("playing")?this.onPlay():this.onPause())},onPlay:function(){if(!Object(_.b)()){if(!this.model.get("enable"))return this.model.set("playing",!1),void this.pause();m.a.setPlaying(!0),m.a.canPlay()&&m.a.forcePlay(!0),this.updatePositionAndTime(!0)}},onPause:function(){m.a.pause(),this.updatePositionAndTime()},play:function(){this.model.get("enable")&&(this.model.set("playing",!0),this.onPlay())},pause:function(){this.model.get("enable")&&(this.model.set("playing",!1),this.onPause())},updateMute:function(e){var t=e.get("mute");m.a.setMute(t)},updateVolume:function(e){if(!e.get("mute")){var t=e.get("volume");m.a.setVolume(t)}}})},function(e,t,i){"use strict";var r,a,n=i(5),o=i(59),s=i(107),u=i(861),l=i.n(u),c=i(862),h=i.n(c),d=i(187),p=i(57),f=i(43),m=i(37),g=i(458),_=i(67),v=i(79),b=i(609),y=i(119),x=i(63),S=i(145),M=n.a.osg,w=n.a.osgUtil,T=n.a.InputGroups,C=x.a.BLEND_SUBSTRACTIVE,E=x.a.DEPTH_DISABLE,L=M.StateAttribute.ON,P=M.vec4.fromValues(.109375,.6640625,.84765625,1),A=M.vec4.fromValues(1,1,0,1),D=M.vec4.fromValues(.8,.8,.8,1),O=M.vec4.fromValues(1,1,0,1),k=function(){return a||(a=M.createTexturedQuadGeometry(-.5,-.5,0,1,0,0,0,1,0)),a},R={init:function(e,t,i){this.model=e,this._context=t,this._viewer=this._context.getViewer(),this._nodeFeature=i,this._viewerOSGJS=this._viewer.getViewerOSGJS(),this._manipulator=this._viewerOSGJS.getManipulator(),this._icons=[],this._nodeCamera=new M.Camera,this._nodeCamera.setNearFarRatio(5e-4),this._nodeCamera.setName("Sound - Camera"),this._nodeCamera.getOrCreateStateSet().setRenderBinDetails(p.a.EDITOR_GIZMO,"RenderBin"),this._nodeCamera.setNodeMask(0),this._nodeIcons=new M.MatrixTransform,this._nodeFeature.addChild(this._nodeCamera),this._nodeCamera.addChild(this._nodeIcons),this._nodeGizmos=new M.MatrixTransform,this._nodeGizmos.setNodeMask(0),this._nodeGizmos._forceEnterIntersection=!0,this._nodeCamera.addChild(this._nodeGizmos),this._prepareGeometriesGizmo(),this._gizmoRefDistance=this._makeGizmo(this._geomHandleDistance),this._nodeGizmos.addChild(this._gizmoRefDistance._nodeGizmo),this._gizmoFalloff=this._makeGizmo(this._geomHandleFalloff),this._nodeGizmos.addChild(this._gizmoFalloff._nodeGizmo),S.a.initSound(this),this.initStateset()},_prepareGeometriesGizmo:function(){this._geomHandleFalloff=new M.createTexturedBoxGeometry(0,0,0,.5,.5,.5),this._geomHandleDistance=new M.createTexturedBoxGeometry(0,0,0,.5,.5,.5),this._arc=w.GizmoGeometry.createCircleGeometry(64,1,3.2*Math.PI),this.setGizmoStateset(this._arc,P),this.setGizmoStateset(this._geomHandleDistance,P),this.setGizmoStateset(this._geomHandleFalloff,P)},_makeGizmo:function(e){var t={};return t._nodeGizmo=new M.MatrixTransform,t._arcScale=new M.MatrixTransform,this._arcScale=new M.MatrixTransform,t._arcX=this._makeArc(t._arcScale,"arcX"),t._arcY=this._makeArc(t._arcScale,"arcY",.5*-Math.PI,M.vec3.fromValues(1,0,0)),t._arcZ=this._makeArc(t._arcScale,"arcZ",.5*Math.PI,M.vec3.fromValues(0,1,0)),t._handleX=this._makeHandle(t._nodeGizmo,"handleX",M.vec3.fromValues(1,0,0),e),t._handleY=this._makeHandle(t._nodeGizmo,"handleY",M.vec3.fromValues(0,1,0),e),t._handleZ=this._makeHandle(t._nodeGizmo,"handleZ",M.vec3.fromValues(0,0,1),e),t._handleXNeg=this._makeHandle(t._nodeGizmo,"handleXNeg",M.vec3.fromValues(-1,0,0),e),t._handleYNeg=this._makeHandle(t._nodeGizmo,"handleYNeg",M.vec3.fromValues(0,-1,0),e),t._handleZNeg=this._makeHandle(t._nodeGizmo,"handleZNeg",M.vec3.fromValues(0,0,-1),e),t._nodeGizmo.editMask=w.NodeGizmo.PICK_ARROW|w.NodeGizmo.PICK_PLANE,t._nodeGizmo.setCullingActive(!1),t._nodeGizmo.addChild(t._arcScale),t},_makeHandle:function(e,t,i,r){var a=new M.MatrixTransform;return a.setName(t),e.addChild(a),a.addChild(r),M.mat4.fromTranslation(a.getMatrix(),i),a},_makeArc:function(e,t,i,r){var a=new M.MatrixTransform;return a.setName(t),e.addChild(a),a.addChild(this._arc),i&&r&&M.mat4.fromRotation(a.getMatrix(),i,r),a},initStateset:function(){this._nodeCamera.getOrCreateStateSet().setTextureAttributeAndModes(0,d.a.dummyTexture,L),this._nodeCamera.getOrCreateStateSet().addUniform(M.Uniform.createInt(0,"uTextureDepth"))},setGizmoStateset:function(e,t){var i=e.getOrCreateStateSet();i.setAttributeAndModes(s.a.createShader(l.a,h.a,"line","Handle3D","LINE"),L),i.setAttributeAndModes(C,L),i.setAttributeAndModes(E,L),i.addUniform(M.Uniform.createFloat4(t,"uColor"))},updateDragHandle:function(e,t){var i=e.getMatrix();M.mat4.fromTranslation(i,t);var r=e.getWorldMatrices()[0];M.mat4.getTranslation(t,r);var a=this.getIconSize(t);M.mat4.scale(i,i,a),e.dirtyBound()},updateArcScale:function(){var e=M.vec3.create();return function(t,i){var r=t._arcScale.getMatrix();M.mat4.scale(r,M.mat4.IDENTITY,M.vec3.set(e,i,i,i)),t._arcScale.dirtyBound(),this.updateDragHandle(t._handleX,M.vec3.set(e,i,0,0)),this.updateDragHandle(t._handleY,M.vec3.set(e,0,i,0)),this.updateDragHandle(t._handleZ,M.vec3.set(e,0,0,i)),this.updateDragHandle(t._handleXNeg,M.vec3.set(e,-i,0,0)),this.updateDragHandle(t._handleYNeg,M.vec3.set(e,0,-i,0)),this.updateDragHandle(t._handleZNeg,M.vec3.set(e,0,0,-i))}}(),_checkSelectNodeChanged:function(){var e=this.model.get("select");if(e!==this._select){this._select=e;var t=this.getGizmo();if(!e||e.get("ambient"))return t.attachToNode(null),void this.hideIcon(e);this.addIcon(e),Object(g.d)(e),this._setGizmoPositionFromSound()}},_updateFalloffGizmo:function(){var e=this.model.get("select");this.updateArcScale(this._gizmoRefDistance,e.get("distance")),"linear"===e.get("distanceModel")?(this._gizmoFalloff._nodeGizmo.setNodeMask(f.a.NO_SHADOW),this.updateArcScale(this._gizmoFalloff,e.get("distanceMax"))):this._gizmoFalloff._nodeGizmo.setNodeMask(0)},_setGizmoPositionFromSound:function(){var e=this.model.get("select"),t=e.get("lastComputedWorldPosition");M.mat4.setTranslation(this._nodeGizmos.getMatrix(),t)},_setSoundPositionFromGizmo:function(){var e=this.model.get("select"),t=e.get("lastComputedWorldPosition");M.mat4.getTranslation(t,this._nodeGizmos.getMatrix()),Object(g.c)(e,t)},updateGizmo:function(){var e=this.getGizmo();if(e){this._checkSelectNodeChanged();var t=this.model.get("select");if(!t||t.get("ambient"))return this._nodeGizmos.setNodeMask(0),void e.setNodeMask(0);e.attachToNode(this._nodeGizmos),this._nodeGizmos.setNodeMask(-1),e.setNodeMask(-1);var i=t.get("snap");i?this._nodeGizmos.editMask=w.NodeGizmo.NO_PICK:(this._nodeGizmos.editMask=w.NodeGizmo.PICK_ARROW|w.NodeGizmo.PICK_PLANE,t.set("geometryUid",-1)),this._dragging&&m.a.draw(),this._updateFalloffGizmo(),this._nodeGizmos.dirtyBound();var r=t.get("lastComputedWorldPosition"),a=t.get("snapChanged");if(a&&t.set("snapChanged",!1),!e.isEditing()&&!a)return void this._setGizmoPositionFromSound();i?(this.snapCheck(t,r),this._displaySnapHelp()):this._setSoundPositionFromGizmo()}},_updateSoundObjectPosition:function(e){Object(g.d)(e),e.get("soundObject").updatePosition(e.get("lastComputedWorldPosition"))},getNodeCamera:function(){return this._nodeCamera},getGizmo:function(){var e=this._viewer.getFeaturesManager();return e?e.getNodeGizmo():null},_displaySnapHelp:function(){new _.a({content:"Double-click to snap the sound on the object surface.",class:"info",delay:2e3})},initDepthTexture:function(){var e=this._viewer.getFeaturesManager().getTextureDepth();this._nodeCamera.getStateSet().setTextureAttributeAndModes(0,e,L);for(var t=0,i=this._icons.length;t<i;t++)this._icons[t].getStateSet().setTextureAttributeAndModes(0,e,L)},getIconSize:function(){var e=M.vec3.create(),t=M.vec3.create();return function(i){var r=this._viewer.getFeaturesManager(),a=r?r.getIconScaleFov():1;this._manipulator.getEyePosition(e);var n=M.vec3.dist(e,i||M.vec3.ZERO)/a;return M.vec3.set(t,n,n,n)}}(),updateIcons:function(){var e=M.quat.create(),t=M.mat4.create(),i=M.vec3.create(),r=M.vec3.create();return function(){var a=this.model.get("select"),n=this._viewer.getCamera(),o=M.mat4.getScale(i,n.getProjectionMatrix())[0],s=.02*this._viewerOSGJS.getCanvasClientWidth()*o;this._manipulator.getEyePosition(r),M.mat4.invert(t,n.getViewMatrix()),M.mat4.getRotation(e,t);for(var u=0,l=this._icons.length;u<l;u++){var c=this._icons[u],h=c.getUserData();c!==this._hovered&&this.setIconSelected(c,a===h);var d=c.getMatrix();this._updateSoundObjectPosition(h);var p=h.get("lastComputedWorldPosition"),f=M.vec3.dist(r,p)/s;M.vec3.set(i,f,f,f),M.mat4.fromRotationTranslationScale(d,e,p,i),c.dirtyBound()}}}(),addIcon:function(e){var t,i;if(i=this._findIcon(e))return i.setNodeMask(-1),i;t=k(),i=new M.MatrixTransform,i.addChild(t);var a=o.default.instance,n=a.getOrCreateTexture(b.a.iconSound,{internalFormat:M.Texture.RGBA});this.setGizmoStateset(i,D);var u=i.getOrCreateStateSet();u.setTextureAttributeAndModes(1,n.texture,L),u.addUniform(M.Uniform.createInt(1,"uTextureIcon")),u.addUniform(M.Uniform.createInt(0,"uAttachedToCamera")),u.addUniform(M.Uniform.createInt(1,"uEnable")),r||(r=s.a.createShader(l.a,h.a,"icon","LightingIcon","ICON")),u.setAttributeAndModes(r);var c=this._icons.length;i.setName("SOUNDIconMT_"+c);var d=i.getMatrix();M.mat4.fromTranslation(d,e.get("lastComputedWorldPosition")),M.mat4.scale(d,d,this.getIconSize()),this._icons.push(i),this._nodeIcons.addChild(i),i.setUserData(e),i.dirtyBound()},hideIcon:function(e){var t=this._findIcon(e);t&&t.setNodeMask(0)},_findIcon:function(e){for(var t=0;t<this._icons.length;t++)if(this._icons[t].getUserData()===e)return this._icons[t];return null},snapCheck:function(){var e=new w.SphereIntersector,t=new w.IntersectionVisitor,i=M.vec3.create();return function(r,a){t.setTraversalMask(f.a.PICK_GEOMETRY_SLOW);var n=v.a.getModelBoxWithDisplacement().radius(),o=10*n;y.a.getScenePositionFromWorldPoint(a,i),e.set(i,o),t.setIntersector(e),this._viewer.getRootModel().accept(t);var s=e.getIntersections(),u=s.length;if(u){for(var l=s[0],c=1;c<u;++c){var h=s[c];h._ratio<l._ratio&&(l=h)}Object(g.b)(r,l)}}}(),onDragStart:function(e){if(this.isSoundTabOpen()&&y.a.isInitialized()){var t=y.a.computeNearestIntersection2D(e.canvasX,e.canvasY,f.a.PICK_GEOMETRY,this._nodeCamera);if(this._dragging=!1,t){var i=t._nodePath[t._nodePath.length-1];if(i===k()){var r=t._nodePath[t._nodePath.length-2].getUserData();r&&this.model.get("soundtracks").trigger("select",r)}else if(i===this._geomHandleDistance||i===this._geomHandleFalloff){var a=this.model.get("select");if(void 0===a)return;var n=this.getGizmo();if(!n||n.isEditing())return;this._manipulator.getInputManager().setEnable(T.MANIPULATORS,!1),this._dragging=!0,this.model.set("dragging",!0);var o=n.getWorldMatrices()[0],s=M.vec3.create();M.vec3.transformMat4(s,s,o),n.getCanvasPositionFromWorldPoint(s,s),this._draggingStartGizmoCenterX=s[0],this._draggingStartGizmoCenterY=s[1],this._draggingStartX=e.canvasX,this._draggingStartY=e.canvasY;var u=(this._draggingStartX-this._draggingStartGizmoCenterX)/this._viewer.getWidth(),l=(this._draggingStartY-this._draggingStartGizmoCenterY)/this._viewer.getHeight();this._draggingStartScreenDistance=Math.sqrt(u*u+l*l),t._nodePath[t._nodePath.length-3]===this._gizmoFalloff._nodeGizmo?(this.draggingFallofGizmo=!0,this._draggingStartDistance=a.get("distanceMax")):(this.draggingRefDistanceGizmo=!0,this._draggingStartDistance=a.get("distance"))}}}},onHover:function(e,t,i){if(y.a.isInitialized()){var r,a=y.a.computeNearestIntersection2D(e,t,f.a.PICK_GEOMETRY,this._nodeCamera);if(a){var n=a._nodePath[a._nodePath.length-1];if(n===this._hovered||a._nodePath.length>2&&a._nodePath[a._nodePath.length-2]===this._hovered)return;n===k()?(this._hovered=a._nodePath[a._nodePath.length-2],this.setIconSelected(this._hovered,!0),m.a.draw()):n!==this._geomHandleDistance&&n!==this._geomHandleFalloff||(this._hovered=n,r=n.getStateSet().getUniform("uColor").getInternalArray(),M.vec4.copy(r,A),m.a.draw())}else this._hovered&&(this._hovered===this._geomHandleDistance||this._hovered===this._geomHandleFalloff?(r=this._hovered.getStateSet().getUniform("uColor").getInternalArray(),M.vec4.copy(r,P)):this._hovered.getUserData()!==i&&this.setIconSelected(this._hovered,!1),m.a.draw(),this._hovered=!1)}},setIconSelected:function(e,t){var i=e.getStateSet().getUniformList(),r=i.uColor.getAttribute().getInternalArray();t?M.vec4.copy(r,O):M.vec4.copy(r,D)},onDragMove:function(e){if(this.isSoundTabOpen()){var t=this.model.get("select");if(!this._dragging)return void this.onHover(e.canvasX,e.canvasY,t);if(void 0!==t){var i=this.getGizmo();if(i){if(i.isEditing())return void this.onDragEnd();var r=(e.canvasX-this._draggingStartGizmoCenterX)/this._viewer.getWidth(),a=(e.canvasY-this._draggingStartGizmoCenterY)/this._viewer.getHeight(),n=Math.sqrt(r*r+a*a);n=n*this._draggingStartDistance/this._draggingStartScreenDistance,this.draggingRefDistanceGizmo?(t.set("distance",n),n>t.get("distanceMax")&&t.set("distanceMax",n)):(t.set("distanceMax",n),n<t.get("distance")&&t.set("distance",n)),m.a.draw()}}}},onDragEnd:function(){if(this._dragging&&this.isSoundTabOpen()){void 0!==this.model.get("select")&&(this._manipulator.getInputManager().setEnable(T.MANIPULATORS,!0),this.draggingFallofGizmo=!1,this.draggingRefDistanceGizmo=!1,this._dragging=!1,this.model.set("dragging",!1),m.a.draw())}},onDoubleClick:function(e){if(this.isSoundTabOpen()){var t=this.model.get("select");if(void 0!==t&&!t.get("ambient")){if(this._viewer.getFeaturesManager()){var i=y.a.pickNearestSurface(e);i&&(Object(g.b)(t,i),Object(g.d)(t),t.get("snap")||t.set("geometryUid",-1),this._updateSoundObjectPosition(t))}}}},isSoundTabOpen:function(){var e=this._viewer.getOptions().widgetAPI;return e&&"sound"===e.getTabbedWidget().get()},removeIcon:function(e){for(var t=0,i=this._icons.length;t<i;t++){var r=this._icons[t];if(r.getUserData()===e){r.getParents()[0].removeChild(r);break}}},updateVisibility:function(){this.isSoundTabOpen()?(0===this._nodeCamera.getNodeMask()&&this._manipulator.getInputManager().setEnable(T.SOUND_GIZMO,!0),this._nodeCamera.setNodeMask(f.a.NO_SHADOW),this.updateGizmo(),this.updateIcons()):(0!==this._nodeCamera.getNodeMask()&&this._manipulator.getInputManager().setEnable(T.SOUND_GIZMO,!0),this._nodeCamera.setNodeMask(0))}};t.a=R},function(e,t,i){"use strict";var r=i(62),a=i(1341),n=i(1342),o={FeatureName:"inspector",ModelType:a.a,ViewListType:[n.a]},s=r.a.create(o);s.prototype.getNode=function(){return this._views[0]._nodeInspector},t.a=s},function(e,t,i){"use strict";var r=i(15),a=i.n(r),n=i(34),o=i(113),s=i(144),u=i(47),l=a.a.Model.extend({defaults:{availableDisplayView:["Default"],materialList:[],materialByUid:{},displayView:"Default",material:void 0,hoverMaterial:void 0,splitType:"3d",texCoord:0,focusMaterial:!Object(u.a)(),highlightOnHover:!Object(u.a)(),viewerToCanvasRatio:1,referenceShadingType:"lit",uiVisible:!1},init:function(e){this._viewer=e.getViewer(),n.a.getMaterial().then(this.initAvailableView.bind(this))},getMaterialModel:function(){return this._viewer.getFeatures().material.getModel()},getShadingStyleModel:function(){return this._viewer.getFeatures().shadingStyle.getModel()},getPostProcessModel:function(){return this._viewer.getFeatures().postProcess.getModel()},getCurrentMaterial:function(){return this.getMaterialByUid(this.get("material"))},getCurrentUVs:function(){return this.get("materialList").find(function(e){return e.uid===this.get("material")}.bind(this)).texCoordUnitList},getMaterialByUid:function(e){var t=this.getMaterialModel().getMaterials(),i=t[e],r=i.get("uidUniqueMerged");return r?t[r]:i},initAvailableView:function(){var e=this.get("displayView"),t=this.get("availableDisplayView"),i=this.get("materialList"),r=this.get("materialByUid");this.set("displayView","Default"),t.length=0,t.push("Default"),i.length=0;var a=o.a.length,n={},u=!1,l=this.getMaterialModel(),c=l.attributes;for(var h in c){var d=c[h];if(!d.get("uidUniqueMerged")){for(var p={},f=d.getChannels(),m=0;m<a;++m){var g=o.a[m],_=f[g],v=_.isEffective();_.set("backupJSON",void 0),p[g]=v,n[g]||_.isEnableEffective()&&("DiffuseIntensity"!==g||v)&&(n[g]=!0)}var b=d.get("texCoordUnitList");u=u||b.length>0,void 0===this.get("material")&&this.set("material",h);var y=n.MetalnessPBR&&!n.RoughnessPBR||n.SpecularPBR&&!n.GlossinessPBR,x={uid:h,name:d.get("name"),texCoordUnitList:b,uidUniqueMerged:d.get("uidUniqueMerged"),uidListUnusedDuplicates:d.get("uidListUnusedDuplicates"),effectiveChannels:p,swapMicrosurface:y};i.push(x),r[h]=x}}n.MetalnessPBR?(delete n.GlossinessPBR,n.RoughnessPBR=!0):n.SpecularPBR&&(delete n.RoughnessPBR,n.GlossinessPBR=!0);for(var S=0;S<a;++S){var M=o.a[S];n[M]&&t.push(M)}t.push("MatcapFlat"),-1===t.indexOf("NormalMap")&&-1===t.indexOf("BumpMap")||t.push("MatcapDetail");var w=this.getShadingStyleModel();w.get("hasWireframe")&&t.push("Wireframe"),w.get("hasVertexColor")&&w.get("vertexColorEnable")&&t.push("VertexColor"),w.get("hasVertexAlpha")&&w.get("vertexColorUseAlpha")&&t.push("VertexAlpha"),s.a.hasVertexNormals&&t.push("VertexNormal"),u&&t.push("UVChecker"),this.getPostProcessModel().hasAtLeastOneEffectiveEffect()&&t.push("DefaultNoPostProcess"),this.set("referenceShadingType",w.get("type")),this.trigger("change:availableDisplayView"),this.set("displayView",e)},_getCorrectedDisplayView:function(e){var t=this.get("displayView");return!this.get("materialByUid")[e].swapMicrosurface||"RoughnessPBR"!==t&&"GlossinessPBR"!==t?t:"RoughnessPBR"===t?"GlossinessPBR":"RoughnessPBR"},materialHasContentInView2d:function(e){var t=this.getMaterialByUid(e),i=this._getCorrectedDisplayView(e);return t.getChannels()[i]?this.get("materialByUid")[e].effectiveChannels[i]:"Wireframe"===i?t.get("geometryList").length>0:"VertexColor"===i?t.get("hasVertexColor"):"VertexAlpha"===i?t.get("hasVertexAlpha"):!("UVChecker"!==i||!t.get("texCoordUnitList").length)},materialHasTextureInView2d:function(e){var t=this.getMaterialByUid(e),i=this._getCorrectedDisplayView(e),r=t.getChannels()[i];if(r){return this.get("materialByUid")[e].effectiveChannels[i]&&!!r.getTextureModel()}return"Wireframe"===i?t.get("geometryList").length>0:"VertexColor"===i?t.get("hasVertexColor"):"VertexAlpha"===i&&t.get("hasVertexAlpha")},hasContentInView2d:function(){return this.materialHasContentInView2d(this.get("material"))},getName:function(){return"Inspector"}});t.a=l},function(e,t,i){"use strict";var r=i(5),a=i(8),n=i(0),o=(i.n(n),i(43)),s=i(37),u=i(113),l=i(1343),c=i(1345),h=i(251),d=i(873),p=i(79),f=i(34),m=i(119),g=i(16),_=i(145),v=i(146),b=r.a.osg,y=r.a.InputGroups,x=b.vec3.fromValues(.7,.75,.75),S={Opacity:!0,AOPBR:!0,CavityPBR:!0},M=a.a.extend({initialize:function(){a.a.prototype.initialize.apply(this,arguments);var e=this.model;e.bind("change:displayView",this.onDisplayView,this),e.bind("change:material",this.onMaterial,this),e.bind("change:texCoord",this.onTexCoord,this),e.bind("change:splitType",this.onSplitType,this),e.bind("change:viewerToCanvasRatio",this._onViewerToCanvasRatio,this),this._viewer=this.options.context.getViewer(),this._viewerOSGJS=this._viewer.getViewerOSGJS(),this._inputManager=this._viewer.getInputManager(),this._viewer.bind("resizeCanvas",this._updateSplitView,this),this._nodeInspector=new b.Node,this._nodeInspector.setName("Feature - Inspector"),this._normalVisitor=new d.a,this._camera2D=new c.a(this._viewer,this.model),_.a.initInspector(this),_.a.initInspectorCamera2D(this._camera2D),this._matcapJSON={factor:1,color:b.vec3.ONE,texture:{uid:"43a40dd3e9c34fc0b7da9cbf07b82ac8"}},f.a.getMaterial().then(this.initAfterMaterials.bind(this)),p.a.getBoxReady().then(this.initNormalVisitor.bind(this))},initAfterMaterials:function(){this._viewer.getFeatures().quality.getModel().bind("updateDynamicResolutionScaling",this._updateSplitView,this)},initNormalVisitor:function(){this._normalVisitor.setScale(.01*p.a.getModelBoxWithDisplacement().radius())},hasDisplayView:function(e){return-1!==this.model.get("availableDisplayView").indexOf(e)},getMaterialModel:function(){return this._viewer.getFeatures().material.getModel()},getOutlineModel:function(){return this._viewer.getFeatures().outline.getModel()},getQualityModel:function(){return this._viewer.getFeatures().quality.getModel()},getShadingStyleModel:function(){return this._viewer.getFeatures().shadingStyle.getModel()},getPostProcessModel:function(){return this._viewer.getFeatures().postProcess.getModel()},getImageCollection:function(){return this.getMaterialModel().getImageCollection()},getCurrentMaterial:function(){return this.model.getCurrentMaterial()},isOnView2D:function(e){var t=this.model.get("splitType");return"3d"!==t&&("2d"===t||"split"===t&&e.canvasX>.5*this._viewerOSGJS.getCanvasClientWidth())},isTabMaterial:function(){var e=this._viewer.getFeaturesManager();return e&&"materials"===e.getCurrentTabName()},canDisplayOutline:function(){return this.isTabMaterial()||"split"===this.model.get("splitType")},focusCheck:function(e){var t=this.isOnView2D(e);t===this._isView2DEnabled||this._cursorPressed||(this._inputManager.setEnable(y.UI_INSPECTOR,t),Object(g.a)().scrollwheel&&(this._inputManager.setEnable(y.UI_INSPECTOR_ZOOM,t),this._inputManager.setEnable(y.SCENE_INSPECTOR_ZOOM,!t)),this._inputManager.setEnable(y.SCENE,!t),this._isView2DEnabled=t)},onMouseMove:function(e){if(this._cursorPressed)return void this.getOutlineModel().trigger("hideOutline");if(this.model.get("highlightOnHover")&&this.canDisplayOutline()&&!this._freezeHoverOutline){var t;if(this.isOnView2D(e)||(t=this.hitMaterial(e)),this.model.set("hoverMaterial",t),!t)return void this.getOutlineModel().trigger("hideOutline");this.displayOutline("displayOutlineNoFocus",t)}},_freezeOutline:function(e){void 0!==this._timerFreezer&&(window.clearTimeout(this._timerFreezer),this._timerFreezer=void 0),this._freezeHoverOutline=!0;var t=1e3*e,i=this._enableOutline.bind(this);this._timerFreezer=window.setTimeout(i,t)},_enableOutline:function(){this._freezeHoverOutline=!1},hitMaterial:function(e){if(m.a.isInitialized()){var t=o.a.PICK_GEOMETRY_FAST,i=m.a.computeNearestIntersection2D(e.canvasX,e.canvasY,t);return i?m.a.getMaterialFromHit(i):void 0}},displayOutline:function(e,t){var i=(this.isTabMaterial(),this.getOutlineModel());i.set("durationOutline",2),i.set("durationHighlight",2),i.trigger(e,t.get("stateSet"))},onMouseWheel:function(){this.getOutlineModel().trigger("hideOutline"),this._freezeOutline(.25)},onCursorDown:function(){this._cursorPressed=!0},onCursorUp:function(){this._cursorPressed=!1,this._freezeOutline(.25)},autoSelectUV:function(){var e=this.getCurrentMaterial(),t=e.getChannels(),i=this.model.get("displayView");if(!t[i]){var r=e.get("texCoordUnitList");return void(r.length&&-1===r.indexOf(this.model.get("texCoord"))&&this.model.set("texCoord",r[0]))}var a=t[i].getTextureModel();a&&this.model.set("texCoord",a.get("texCoordUnit"))},onTexCoord:function(){this.updateMaterial()},onMaterial:function(){if(this.autoSelectUV(),this.updateMaterial(),this.updateVisible2D(),this.canDisplayOutline()){var e=this.model.get("focusMaterial")?"Focus":"NoFocus";this.displayOutline("displayOutline"+e,this.getCurrentMaterial()),this._freezeOutline(.25)}},updateVisible2D:function(){var e=this.model.get("splitType");this._camera2D.setVisible("3d"!==e&&this.model.hasContentInView2d())},updateMaterial:function(){var e=this.getCurrentMaterial(),t=this.model.get("texCoord");this._camera2D.setMaterial(e,t),"UVChecker"===this.model.get("displayView")&&e.getChannels().Inspector.setTexCoordUnit(t),s.a.draw()},onSplitType:function(){var e=this.model.get("splitType");v.a.uSplitView.setFloat("split"===e?1:0),"split"!==e&&this.getOutlineModel().trigger("hideOutline"),this._updateSplitView(),this.updateVisible2D(),s.a.draw()},setupCheckerTexture:function(e){if(!this._checkerImageProxy){var t=this.getImageCollection();this._checkerImageProxy=t.addNewImage({url:Object(l.a)(),width:1024,height:1024,id:"skfbUVChecker",name:"UVChecker"})}var i=e.setupTextureModel({image:this._checkerImageProxy});return i.updateMultiresTexture(),i},_getDisplayedChannel:function(e,t,i){return!i.swapMicrosurface||"RoughnessPBR"!==t&&"GlossinessPBR"!==t?("Opacity"===t&&e.Opacity.get("invert")&&e.Inspector.set("invert",!0),e[t]):(e.Inspector.set("invert",!0),"RoughnessPBR"===t?e.GlossinessPBR:e.RoughnessPBR)},_getColorProfile:function(e){var t=this.getPostProcessModel().get("sssProfiles"),i=t[e.get("profile")-1],r=b.vec3.create();return b.vec3.add(r,i.strength,i.falloff),b.vec3.scale(r,r,.5),r},_setDisplayChannel:function(e,t){e.setInspectorSRGB(t.getSRGB());var i=t.getName();if(!t.isEffective())return void(S[i]||e.setFactor(0));var r=t.getColor?t.getColor():void 0,a=t.getTextureModel();if(r&&!a){var n=1;if("SubsurfaceScattering"===i){n=1/(u.a.getBoxFactor("SubsurfaceScattering")*p.a.getModelBoxWithoutDisplacement().radius())}e.setFactor(t.getFactor()*n)}"SubsurfaceScattering"===i?e.setColor(this._getColorProfile(t)):r?e.setColor(r):e.setColor(b.vec3.ONE),a&&(e.setTextureModel(t.getTextureModel()),"Opacity"===i&&"alphaMask"===t.get("type")&&e.set("maskThreshold",t.get("factor")))},_setUVChecker:function(e,t){t._uvChecker=t._uvChecker||this.setupCheckerTexture(e);var i=this.getCurrentMaterial()===t,r=i?this.model.get("texCoord"):t.get("texCoordUnitList")[0];e.setTexCoordUnit(r||0)},_resetChannel:function(e){return e.get("backupJSON")?e.setChannelJSON(e.get("backupJSON"),this.getImageCollection()):e.set("backupJSON",Object(n.cloneDeepWith)(e.getJSON())),e},_resetState:function(){var e=this.getShadingStyleModel();e.set("type",this.model.get("referenceShadingType")),this.hasDisplayView("VertexColor")&&e.set("vertexColorEnable",!0),this.hasDisplayView("VertexAlpha")&&e.set("vertexColorUseAlpha",!0);for(var t=this.model.get("materialList"),i=this.getMaterialModel().getMaterials(),r=0;r<t.length;++r){var a=i[t[r].uid],n=a.getChannels();this._resetChannel(n.Inspector),this._resetChannel(n.Displacement),this._resetChannel(n.Opacity),this._resetChannel(n.Matcap),this._resetChannel(n.BumpMap),this._resetChannel(n.NormalMap),n.Opacity.isEffective()||n.Opacity.set("enable",!1)}},onDisplayView:function(){var e=this.model.get("displayView");if(-1===this.model.get("availableDisplayView").indexOf(e))return void console.error("Unknown display view : "+e);b.time("inps"),this._resetState();for(var t=this.getShadingStyleModel(),i="Default"===e||"DefaultNoPostProcess"===e,r="UVChecker"===e,a="Wireframe"===e,n="VertexColor"===e,o="VertexAlpha"===e,u="VertexNormal"===e,l="Opacity"===e,c="MatcapFlat"===e,d="MatcapDetail"===e,p=this.getMaterialModel().getMaterials(),f=this.model.get("materialList"),m=0;m<f.length;++m)if(!i&&!u){var g=f[m],_=p[g.uid],y=_.getChannels(),S=y.Inspector;S.setTextureModel(void 0);var M=y.Opacity;if(M.isEffective()&&"refraction"===M.get("type")&&M.set("type","alphaBlend"),r)this._setUVChecker(S,_);else if(a)S.setColor(x);else if(o)M.set("enable",!1);else if(!n)if(c||d)c&&(y.BumpMap.set("enable",!1),y.NormalMap.set("enable",!1)),y.Matcap.setChannelJSON(this._matcapJSON);else{var w=this._getDisplayedChannel(y,e,g);this._setDisplayChannel(S,w),w===y.Displacement?y.Displacement.set("enable",!1):w===M&&M.set("enable",!1)}}v.a.uDisplayVertexAlpha.setFloat(o),this.updateVisible2D(),this.autoSelectUV(),u&&!this._normalVisitor._alreadyRun&&(this._normalVisitor._alreadyRun=!0,this._normalVisitor.apply(this._viewer.getRootModel())),this._normalVisitor.setNormalVisibility(u),h.a.setDebugNormal(u),this.hasDisplayView("VertexColor")&&t.set("vertexColorEnable",n||o||i),this.hasDisplayView("VertexAlpha")&&t.set("vertexColorUseAlpha",!o&&!l),a?(this._backupWireframeEnable=t.get("wireframeEnable"),this._backupWireframeColor=t.get("wireframeColor"),t.set("wireframeColor","000000FF"),t.set("wireframeEnable",!0)):this._backupWireframeColor&&(t.set("wireframeColor",this._backupWireframeColor),t.set("wireframeEnable",this._backupWireframeEnable),this._backupWireframeColor=void 0),c||d?t.set("type","matcap"):i||u||t.set("type","inspector"),this.hasDisplayView("DefaultNoPostProcess")&&this.getPostProcessModel().set("enable","Default"===e),s.a.draw(),b.timeEnd("inps")},_onViewerToCanvasRatio:function(){this._updateViewports(),s.a.draw()},_updateViewports:function(){var e=this._viewer.getFeatures(),t=this._viewer.getCamera(),i=e.postProcess.getCamera().getViewport(),r=this._camera2D.getViewport(),a=t.getViewport(),n=a.width(),o=a.height(),s=this.getQualityModel(),u=s.get("dynamicResolutionScaling"),l=Math.round(n*u[0]),c=Math.round(o*u[1]),h=this.model.get("splitType"),d="split"===h;d?(i.setViewport(0,0,l>>1,c),r.setViewport(n>>1,0,n>>1,o)):"2d"===h?(i.setViewport(0,0,1,1),r.setViewport(0,0,n,o)):(i.setViewport(0,0,l,c),r.setViewport(0,0,0,0));var p=d?.5:1;p*=this.model.get("viewerToCanvasRatio");var f=t.getProjectionMatrix();f[0]=f[5]*c/(l*p)},_updateSplitView:function(){var e=this.getQualityModel(),t=this.model.get("splitType"),i=1,r=1;"split"===t?i=.5:"2d"===t&&(i=0,r=0);var a=e.get("dynamicResolutionScaling");this._updateViewports(),this._viewer.trigger("resizeRatio",i,r,a[0],a[1])}});t.a=M},function(e,t,i){"use strict";t.a=function(){return i(1344)}},function(e,t,i){e.exports=i.p+"UVChecker-83286689540c09bfb41a643ec5e2353d.png"},function(e,t,i){"use strict";var r=i(5),a=i(37),n=i(43),o=i(57),s=i(34),u=i(16),l=i(63),c=i(615),h=r.a.osg,d=r.a.osgUtil,p=function(e){h.StateAttribute.call(this),this._enable=!e,this._uv=0};p.prototype=h.objectLibraryClass(h.objectInherit(h.StateAttribute.prototype,{attributeType:"TexCoordAsVertex",cloneType:function(){return new p(!0)},setEnabled:function(e){this._enable=e},isEnabled:function(){return this._enable},setTexCoord:function(e){this._uv=e},getTexCoord:function(){return this._uv},getHash:function(){return this.getTypeMember()+this._uv}}),"osgSketchfab","TexCoordAsVertex"),h.setTypeID(p);var f=function(e,t){h.Camera.call(this),this._model=t,this._viewer=e,this._viewerOSGJS=e.getViewerOSGJS(),this.setNodeMask(0),this.setName("Camera 2D"),this.setReferenceFrame(h.Transform.ABSOLUTE_RF),this.setViewport(new h.Viewport),h.vec4.set(this.getClearColor(),.5,.5,1,1),this._manipulatorEnable=!1,this._scale=1,this._zoomCoord=h.vec2.create();var i=this.getCameraEasing();this._panInterpolator=new d.DelayInterpolator(2,i),this._zoomInterpolator=new d.DelayInterpolator(1,i),this.addUpdateCallback(this),this.initGraph()};f.prototype=h.objectInherit(h.Camera.prototype,{initGraph:function(){var e=h.StateAttribute.OVERRIDE_ON,t=this.getOrCreateStateSet();t.addUniform(h.Uniform.createFloat(1,"uDisplay2D")),t.addUniform(h.Uniform.createInt(0,"uOutputLinear"),e),t.setAttributeAndModes(l.a.DEPTH_DISABLE,e),t.setRenderBinDetails(o.a.OPAQUE_NO_EARLYZ,"RenderBin"),t.setShaderGeneratorName("inspector",e),this._attributeUV=new p,this._projectedGeometry=new h.Node,this._projectedGeometry.setName("Projected Geometry");var i=this._projectedGeometry.getOrCreateStateSet();i.setAttributeAndModes(this._attributeUV),i.addUniform(h.Uniform.createFloat4(h.vec4.ONE,"uColor")),i.addUniform(h.Uniform.createInt(0,"uProjectedWireframe")),i.setAttributeAndModes(new c.a),this._projectedWireframe=new h.Node,this._projectedWireframe.setName("Projected Wireframe"),this._projectedWireframe.getOrCreateStateSet().addUniform(h.Uniform.createInt(1,"uProjectedWireframe")),this._projectedPolygon=new h.Node,this._projectedPolygon.setName("Projected Polygon"),this._projectedGeometry.addChild(this._projectedPolygon),this._projectedGeometry.addChild(this._projectedWireframe),this._displayTexture=new h.Node,this._displayTexture.setName("Display Texture"),this._quadTexture=h.createTexturedQuadGeometry(-.5,-.5,0,1,0,0,0,1,0),this._quadTexture.setName("Texture display 2D"),this._displayTexture.addChild(this._quadTexture),this.addChild(this._displayTexture),this.addChild(this._projectedGeometry),s.a.getModelDisplayed().then(function(){var e=this._viewer.getFeatures(),t=e.environment.getNode();this._quadTexture.setStateSet(t.getStateSet()),e.postProcess.getNodeIn().addChild(this)}.bind(this))},getCameraEasing:function(){return void 0===Object(u.a)().cameraEasing?.8:1-Object(u.a)().cameraEasing},getViewportWidth:function(){return this.getViewport().width()},getViewportHeight:function(){return this.getViewport().height()},_replaceProjectedGeometry:function(e,t,i){e.removeChildren();for(var r=0;r<t.length;++r){var a=t[r],n=new h.Geometry;n._attributes=a.getAttributes(),n._primitives=a.getPrimitives(),n._QVT=a._QVT,n._QVS=a._QVS,n._listQuantUV=a._listQuantUV,n.setBound(this._quadTexture.getBoundingBox()),n.setStateSet(i),e.addChild(n)}},_updateProjectedGeometry:function(e,t,i,r){if(r.isFulfilled())return this._replaceProjectedGeometry(e,t,i,r);var a=this,n=this._material;r.then(function(){n===a._material&&a._replaceProjectedGeometry(e,t,i,r)})},_updateProjectedPolygon:function(e){this._updateProjectedGeometry(this._projectedPolygon,e.get("geometryList"),e.get("stateSet"),s.a.getModelDisplayed())},_updateProjectedWireframe:function(e){this._updateProjectedGeometry(this._projectedWireframe,e.get("wireframeList"),e.get("stateSetWireframe"),s.a.getWireframeOptimizedSplitCompressed())},setMaterial:function(e,t){this._material=e;var i=e.get("stateSet");if(this._displayTexture.setStateSet(i),this._attributeUV.setTexCoord(t),!e.get("texCoordUnitList").length)return this._projectedPolygon.removeChildren(),void this._projectedWireframe.removeChildren();var r=this._quadTexture.getVertexAttributeList(),a="TexCoord"+t;r[a]||(r[a]=r.TexCoord0),this._updateProjectedWireframe(e),this._updateProjectedPolygon(e)},setManipulatorEnable:function(e){this._manipulatorEnable=e},setVisible:function(e){this.setNodeMask(e?n.a.NO_PICK_NO_SHADOW_CAST:0)},updateOrtho:function(){var e=.5*this._scale,t=e*this.getViewportHeight()/this.getViewportWidth();h.mat4.ortho(this.getProjectionMatrix(),-e,e,-t,t,-10,10)},onEventStart:function(e){this._lastScale=e.scale||1,this._zoomInterpolator.reset(),this._panInterpolator.reset(),this._isPanning=!0},onEventEnd:function(){this._zoomInterpolator.reset(),this._panInterpolator.reset(),this._isPanning=!1},onEventUpdate:function(e){if(this._isPanning){if(this._panInterpolator.setTarget(e.glX,-e.glY),e.scale){var t=e.scale>this._lastScale?5:10,i=(e.scale-this._lastScale)*t,r=this._zoomInterpolator.getTarget()[0]-i;this._zoomInterpolator.setTarget(r),this._lastScale=e.scale}this.registerFocusZoom(e),a.a.draw()}},onMouseWheel:function(e){this._zoomInterpolator.setTarget(this._zoomInterpolator.getTarget()[0]-Math.sign(e.deltaY)),this.registerFocusZoom(e),a.a.draw()},registerFocusZoom:function(e){var t=this._viewerOSGJS.getCanvasPixelRatio(),i=this.getViewportWidth(),r=this.getViewportHeight(),a=h.vec2.set(this._zoomCoord,e.canvasX,e.canvasY),n="2d"===this._model.get("splitType")?.5:-.5;a[0]=n+(a[0]*t-i)/i,a[1]=a[1]*t/r-.5},_updateWireframeNodeMask:function(){var e=this._viewer.getOrCreateScene().getWireframeNodes();e.length&&this._projectedWireframe.setNodeMask(e[0].getNodeMask())},update:function(e,t){var i=t.getFrameStamp(),r=i.getDeltaTime(),a=this.getViewMatrix(),n=this.getViewportWidth(),o=this.getViewportHeight(),s=this._panInterpolator.update(r),u=.1*this._zoomInterpolator.update(r)[0],l=this._scale*(1+u),c=l*this._viewerOSGJS.getCanvasPixelRatio()/n,h=l-this._scale;a[12]+=s[0]*c+this._zoomCoord[0]*h,a[13]-=s[1]*c+this._zoomCoord[1]*h*o/n,this._scale=l,this.updateOrtho(),this._updateWireframeNodeMask();var d=this._model.get("displayView"),p="VertexColor"===d||"VertexAlpha"===d?-1:0;return this._projectedPolygon.setNodeMask(p),!0}}),t.a=f},,,,,,,function(e,t,i){"use strict";var r=i(7),a=i.n(r),n=i(3),o=i.n(n),s=i(0),u=(i.n(s),i(17)),l=i(6),c=i(5),h=i(649),d=i(8),p=i(26),f=i(611),m=i(425),g=c.a.osg;t.a=d.a.extend({savingEnabled:!1,constructor:function(){this.onSave=Object(s.throttle)(this.onSave,1e3),d.a.apply(this,arguments)},initialize:function(){d.a.prototype.initialize.apply(this,arguments),o()(".save-model").click(this.onSave.bind(this));var e=this.options.context;this._features=e.getFeatures();var t=e.getModel();t&&!this.maintenance&&this.listenTo(t,"status:loaded",this.enableSaving.bind(this))},onSave:function(e){e.preventDefault(),m.a.isMaintenance()?m.a.showPopup():this.save()},save:function(){var e=this._features.inspector.getModel(),t=e.get("displayView");e.set("displayView","Default");var i=this._save();return i.finally(function(){e.set("displayView",t)}),i},_save:function(){if(!this.savingEnabled)return a.a.reject(new Error("Model is still loading. Please try to save again later."));if(o()(".save-model").hasClass("progress"))return a.a.reject(new Error("Already saving previous changes. Please try to save again later."));o()(".save-model").addClass("progress");var e=this.options.context.getModel().get("uid"),t=this.options.context.getModel().get("user").uid,i={modelUID:e,userUID:t},r=this,n=[];return this.cancelSave=!1,a.a.all(Object(s.map)([this.saveBackgroundImages(i,n),this.saveMaterialImages(i,n),this.saveTexturesColorspace(i,n),this.saveHotspots(i,n),this.saveAnimations(i,n),this.saveSounds(i,n)],function(e){return e.reflect()})).then(function(){return n.length>0||this.cancelSave?a.a.reject(new Error):r.saveOptions()}.bind(this)).then(function(){return n.length>0?a.a.reject(new Error):a.a.all(Object(s.map)([r.deleteTextures(n),r.deleteMatcaps(n),r.deleteBackgroundImages(n),r.deleteAnimations(n),r.deleteEnvironments(n)],function(e){return e.reflect()}))}).then(function(){if(n.length>0)return a.a.reject(new Error);o()(".save-model").removeClass("progress"),o()(".save-model").addClass("success"),setTimeout(function(){o()(".save-model").removeClass("success")},4e3)}.bind(this)).catch(function(e){if(o()(".save-model").removeClass("progress"),e&&503===e.status)m.a.showPopup();else{if(this.cancelSave)return;var t="";if(n.length)t=n.join("<br/>");else{if(t="An unexpected error happened while saving the following settings : <br/><ul>",e&&e.responseJSON&&e.responseJSON.detail){var i=e.responseJSON.detail;g.error(i);for(var r="string"==typeof i?[i]:Object.keys(i),a=0;a<r.length;++a)t+="<li>&bullet; "+r[a]+"</li>"}t+="</ul>"}t+="<br/>Contact the support team at support@sketchfab.com if you need help.";var s=new p.default({title:"Error",text:t,buttons:{ok:!0},safe:!0});s.open().then(s.close.bind(s))}}.bind(this))},deleteUnusedResources:function(e,t,i){if(0===e.length)return a.a.resolve();var r="Errors while deleting the following "+t+" :<br/><ul>",n=!1,o=Object(s.map)(e,function(e){return a.a.resolve(e.destroy()).catch(function(t){var i=t&&t.responseJSON&&t.responseJSON.detail;r+="<li>&bullet; "+e.get("name")+" : "+i+"</li>",e.trigger("restore",e),n=!0})});return e.length=0,a.a.all(o).then(function(){if(n)return i.push(r+"</ul>"),a.a.reject(new Error)})},deleteTextures:function(e){var t=this._features.material.getModel()._textureTrashbin,i=Object(s.map)(t,function(e){return new h.a({uid:e})});return t.length=0,this.deleteUnusedResources(i,"material textures",e)},deleteMatcaps:function(e){var t=this._features.material.getModel()._matcapTrashbin;return this.deleteUnusedResources(t,"matcap textures",e)},deleteAnimations:function(e){var t=this._features.animation.getModel().get("animations")._trashbin;return this.deleteUnusedResources(t,"animations",e)},deleteEnvironments:function(e){var t=this._features.environment.getModel()._trashbin;return this.deleteUnusedResources(t,"environments",e)},deleteBackgroundImages:function(e){var t=this._features.background.getModel()._trashbin;return this.deleteUnusedResources(t,"backgrounds",e)},saveBackgroundImages:function(e,t){var i=this,r=[];return this._features.background.getModel().backgroundCollection.each(function(a){if(a.isNew()){var n=i.saveImage(a,e);n.catch(function(e){var i=0;if(e.responseJSON.detail.imageFile)for(i=0;i<e.responseJSON.detail.imageFile.length;i++)e.responseJSON.detail.imageFile[i].match("The image should be less than 4mb")&&t.push("Background image is too big (max: 4MB)")}),r.push(n)}}),a.a.all(r)},saveImage:function(e,t){return a.a.resolve(e.save(t).then(function(t){e.set("uid",t.uid)}))},_saveImageToBlob:function(e,t,i,r){var a,n=e.getImageModel(),o=e.getMultiresTexture().getImage().getImage();if(o.toBlob){var s=this;return void o.toBlob(function(e){e.name=t.name,n.set("imageFile",e),i(s.saveImage(n,r))},t.type,.95)}if(!o.toDataURL){var u=o;if(o=document.createElement("canvas"),void 0!==u.width)o.width=u.width,o.height=u.height,o.getContext("2d").drawImage(u,0,0);else{var l=o.getContext("2d"),c=e.getImageModel().getImages()[0];o.width=c.width,o.height=c.height;var h=l.getImageData(0,0,c.width,c.height);h.data.set(u),l.putImageData(h,0,0)}}a=Object(f.a)(o.toDataURL(t.type,.95)),a.name=t.name,n.set("imageFile",a),i(this.saveImage(n,r))},saveMaterialImages:function(e,t){var i=this,r=[],n={},o=this._features.material,u="Errors while saving the following texture materials :<br/><ul>",l=!1;return Object(s.each)(o.getModel().attributes,function(t){var o=t.getChannels();Object(s.each)(o,function(t){var o=t.getTextureModel();if(o){var s=o.getImageModel();if(s&&s.isNew()){var c=s.getUID();if(1!==n[c]){n[c]=1;var h=new a.a(function(t){var r=s.get("imageFile");if(void 0===r){var a=s.findImageNearestToResolution(16384,16384),n=Object(f.a)(a.url);return s.set("imageFile",n),void t(i.saveImage(s,e))}if(0===r.size)i._saveImageToBlob(o,r,t,e);else if(window.File){var u=new FileReader;u.onload=function(){this.readyState===FileReader.DONE?t(i.saveImage(s,e)):i._saveImageToBlob(o,r,t,e)},u.onerror=function(){i._saveImageToBlob(o,r,t,e)},u.readAsArrayBuffer(r)}});r.push(h.catch(function(e){var t=e&&e.responseJSON&&e.responseJSON.detail;u+="<li>&bullet; "+s.getName()+" : "+t+"</li>",l=!0}))}}}})}),a.a.all(r).then(function(){if(l)return t.push(u+"</ul>"),a.a.reject(new Error)})},saveOptions:function(){var e=this.options.context,t=e.getViewer(),i=t.getOptionsJSON();if(t.getFeaturesManager().registerOptionsJSON(i),i.animation)for(var r=this._features.animation.getModel().get("animations")._trashbin,n=0;n<r.length;n++)r[n]&&i.animation.order.splice(n,0,r[n].get("uid"));return a.a.resolve(e.getModel().save({options:i},{patch:!0}))},saveHotspot:function(e,t,i){return e.save(t).catch(function(t){if(i.push("Annotation #"+(+e.get("order")+1)+" could not be saved."),t.responseJSON&&t.responseJSON.detail){var r=0;if(t.responseJSON.detail.name)for(r=0;r<t.responseJSON.detail.name.length;r++)t.responseJSON.detail.name[r].match("This field is required.")&&i.push("Title is required."),t.responseJSON.detail.name[r].match("Ensure this value has at most 64 characters")&&i.push("Title is too long (64 characters max).");if(t.responseJSON.detail.content)for(r=0;r<t.responseJSON.detail.content.length;r++)t.responseJSON.detail.content[r].match("Ensure this value has at most 1024 characters")&&i.push("Description is too long (1024 characters max).")}})},deleteHotspot:function(e,t,i,r){return e.remove(t).catch(function(){r.push(e),i.push("An annotation could not be deleted. Please try saving your settings again.")})},saveHotspots:function(e,t){var i=this._features.hotspot,r=i.getModel(),n=r.get("hotspots"),o=this.options.context.getModel().get("user").account,c=u.a.maxHotspotsPerModel[o],h=n.length-c;if(n.length>c){var d="You have reached the maximum number of annotations allowed by your plan ("+c+").";return l.a.me().canUpgradePlan()&&(d+=1===h?'<br>Delete the last annotation you created or <a class="upgrade-link underlined" href="/plans" data-title="maximum-annotation-upgrade" target="_blank">upgrade your account</a>.':"<br>Delete the "+h+' last annotations you created or <a class="upgrade-link underlined" href="/plans" data-title="maximum-annotation-upgrade" target="_blank">upgrade your account</a>.'),r.trigger("hotspot-error",new Error(d)),this.cancelSave=!0,a.a.reject()}var p=!1;if(n.each(function(e){e.get("name")||(p=!0)}),p)return r.trigger("hotspot-error",new Error("All your annotations must have a title")),this.cancelSave=!0,a.a.reject();var f=[],m=[],g=this;return Object(s.each)(r.hotspotsToBeDeleted,function(i){f.push(g.deleteHotspot(i,e,t,m))}),r.hotspotsToBeDeleted=m,a.a.all(f).then(function(){var i=[];return n.each(function(r){r.set("order",n.indexOf(r)),i.push(g.saveHotspot(r,e,t))}),a.a.all(i)})},saveTexturesColorspace:function(e,t){var i="Errors while changing the following texture colorspace :<br/><ul>",r=!1,n=[];return this.model.getImageCollection().each(function(e){!e.isNew()&&e.hasChanged("colorSpace")&&n.push(e.saveColorspace().catch(function(t){var a=t&&t.responseJSON&&t.responseJSON.detail;i+="<li>&bullet; "+e.get("name")+" : "+a+"</li>",r=!0}))}),a.a.all(n).then(function(){if(r)return t.push(i+"</ul>"),a.a.reject(new Error)})},saveAnimations:function(e,t){var i=this._features.animation,r=i.getModel(),n="Errors while saving the following animations :<br/><ul>",o=!1,s=r.get("animations").map(function(t){return t.save(e).catch(function(e){var i=e&&e.responseJSON&&e.responseJSON.detail;n+="<li>&bullet; "+t.get("name")+" : "+i+"</li>",o=!0})});return a.a.all(s).then(function(){if(o)return t.push(n+"</ul>"),a.a.reject(new Error)})},saveSounds:function(e,t){var i,r=this._features.sound,n=r.getModel(),o=n.get("soundtracks"),s=u.a.maxSoundtracksPerModel[l.a.me().get("account")];if(o.length>s){var c=o.length-s;return i=["You have reached the maximum number of sounds allowed by your plan ("+s+").","<br>Delete "+c+' sounds or <a class="upgrade-link underlined" href="/plans" target="_blank">upgrade your account</a>.'].join("\n"),n.trigger("sound-error",new Error(i)),this.cancelSave=!0,a.a.reject()}var h=!1;i="Errors while saving the following sounds :<br/><ul>";var d=a.a.resolve();return o.each(function(t){d=d.then(function(){return t.save(e)}).catch(function(e){var r=e&&e.responseJSON&&e.responseJSON.detail;return r&&r.__all__&&(r=r.__all__[0]),i+="<li>&bullet; "+t+" : "+r+"</li>",h=!0,a.a.resolve()})}),d.then(function(){if(h)return t.push(i+"</ul>"),a.a.reject(new Error)})},enableSaving:function(){this.savingEnabled=!0,o()(".save-model").removeClass("btn-disabled")}})},,,function(e,t,i){var r;!function(a,n,o){function s(e,t,i){if(e.addEventListener)return void e.addEventListener(t,i,!1);e.attachEvent("on"+t,i)}function u(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return x[e.which]?x[e.which]:S[e.which]?S[e.which]:String.fromCharCode(e.which).toLowerCase()}function l(e,t){return e.sort().join(",")===t.sort().join(",")}function c(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}function h(e){if(e.preventDefault)return void e.preventDefault();e.returnValue=!1}function d(e){if(e.stopPropagation)return void e.stopPropagation();e.cancelBubble=!0}function p(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function f(){if(!y){y={};for(var e in x)e>95&&e<112||x.hasOwnProperty(e)&&(y[x[e]]=e)}return y}function m(e,t,i){return i||(i=f()[e]?"keydown":"keypress"),"keypress"==i&&t.length&&(i="keydown"),i}function g(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus"),e.split("+"))}function _(e,t){var i,r,a,n=[];for(i=g(e),a=0;a<i.length;++a)r=i[a],w[r]&&(r=w[r]),t&&"keypress"!=t&&M[r]&&(r=M[r],n.push("shift")),p(r)&&n.push(r);return t=m(r,n,t),{key:r,modifiers:n,action:t}}function v(e,t){return null!==e&&e!==n&&(e===t||v(e.parentNode,t))}function b(e){function t(e){e=e||{};var t,i=!1;for(t in y)e[t]?i=!0:y[t]=0;i||(M=!1)}function i(e,t,i,r,a,n){var o,s,u=[],c=i.type;if(!g._callbacks[e])return[];for("keyup"==c&&p(e)&&(t=[e]),o=0;o<g._callbacks[e].length;++o)if(s=g._callbacks[e][o],(r||!s.seq||y[s.seq]==s.level)&&c==s.action&&("keypress"==c&&!i.metaKey&&!i.ctrlKey||l(t,s.modifiers))){var h=!r&&s.combo==a,d=r&&s.seq==r&&s.level==n;(h||d)&&g._callbacks[e].splice(o,1),u.push(s)}return u}function r(e,t,i,r){g.stopCallback(t,t.target||t.srcElement,i,r)||!1===e(t,i)&&(h(t),d(t))}function a(e){"number"!=typeof e.which&&(e.which=e.keyCode);var t=u(e);if(t)return"keyup"==e.type&&x===t?void(x=!1):void g.handleKey(t,c(e),e)}function o(){clearTimeout(v),v=setTimeout(t,1e3)}function f(e,i,a,n){function s(i){r(a,i,e),"keyup"!==n&&(x=u(i)),setTimeout(t,10)}y[e]=0;for(var l=0;l<i.length;++l){var c=l+1===i.length,h=c?s:function(t){return function(){M=t,++y[e],o()}}(n||_(i[l+1]).action);m(i[l],h,n,e,l)}}function m(e,t,r,a,n){g._directMap[e+":"+r]=t,e=e.replace(/\s+/g," ");var o,s=e.split(" ");if(s.length>1)return void f(e,s,t,r);o=_(e,r),g._callbacks[o.key]=g._callbacks[o.key]||[],i(o.key,o.modifiers,{type:o.action},a,e,n),g._callbacks[o.key][a?"unshift":"push"]({callback:t,modifiers:o.modifiers,action:o.action,seq:a,level:n,combo:e})}var g=this;if(e=e||n,!(g instanceof b))return new b(e);g.target=e,g._callbacks={},g._directMap={};var v,y={},x=!1,S=!1,M=!1;g._handleKey=function(e,a,n){var o,s=i(e,a,n),u={},l=0,c=!1;for(o=0;o<s.length;++o)s[o].seq&&(l=Math.max(l,s[o].level));for(o=0;o<s.length;++o)if(s[o].seq){if(s[o].level!=l)continue;c=!0,u[s[o].seq]=1,r(s[o].callback,n,s[o].combo,s[o].seq)}else c||r(s[o].callback,n,s[o].combo);var h="keypress"==n.type&&S;n.type!=M||p(e)||h||t(u),S=c&&"keydown"==n.type},g._bindMultiple=function(e,t,i){for(var r=0;r<e.length;++r)m(e[r],t,i)},s(e,"keypress",a),s(e,"keydown",a),s(e,"keyup",a)}if(a){for(var y,x={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},S={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},M={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},w={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},T=1;T<20;++T)x[111+T]="f"+T;for(T=0;T<=9;++T)x[T+96]=T.toString();b.prototype.bind=function(e,t,i){var r=this;return e=e instanceof Array?e:[e],r._bindMultiple.call(r,e,t,i),r},b.prototype.unbind=function(e,t){var i=this;return i.bind.call(i,e,function(){},t)},b.prototype.trigger=function(e,t){var i=this;return i._directMap[e+":"+t]&&i._directMap[e+":"+t]({},e),i},b.prototype.reset=function(){var e=this;return e._callbacks={},e._directMap={},e},b.prototype.stopCallback=function(e,t){var i=this;return!((" "+t.className+" ").indexOf(" mousetrap ")>-1)&&(!v(t,i.target)&&("INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable))},b.prototype.handleKey=function(){var e=this;return e._handleKey.apply(e,arguments)},b.addKeycodes=function(e){for(var t in e)e.hasOwnProperty(t)&&(x[t]=e[t]);y=null},b.init=function(){var e=b(n);for(var t in e)"_"!==t.charAt(0)&&(b[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t))},b.init(),a.Mousetrap=b,void 0!==e&&e.exports&&(e.exports=b),void 0!==(r=function(){return b}.call(t,i,t,e))&&(e.exports=r)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)},function(e,t,i){"use strict";var r=i(3),a=i.n(r),n=i(166),o=i(11),s=i(0);i.n(s);t.a=n.a.extend({VIEWER_MODE_ORBIT:0,VIEWER_MODE_FPS:1,HOTSPOT_CYCLE_PAUSE:1e4,events:{"click .has-menu":"toggleMenu","touchstart .has-menu":"toggleMenuTouch",keydown:"onKeydown",mousewheel:"onMousewheel","mousedown  .webgl .canvas":"cameraMoveStart","touchstart .webgl .canvas":"cameraMoveStart","mousedown  .webgl":"mouseDownEvent","mouseup    .webgl":"mouseUpEvent","touchstart .webgl":"mouseDownEvent","touchend   .webgl":"mouseUpEvent","mousedown  .fallback":"mouseDownEvent","touchstart .fallback":"mouseDownEvent",'click      [data-action="watermark"]':"onWatermarkClick",'touchend   [data-action="watermark"]':"onWatermarkClick"},constructor:function(){this.globalCloseEvent=this.globalCloseEvent.bind(this),this.globalMouseUpEvent=this.globalMouseUpEvent.bind(this),this.onKeydown=this.onKeydown.bind(this),n.a.prototype.constructor.apply(this,arguments)},delegateEvents:function(){n.a.prototype.delegateEvents.apply(this,arguments);var e=a()(document);e.on("keydown",this.onKeydown),e.on("mousedown",this.globalCloseEvent),e.on("mouseup",this.globalMouseUpEvent),e.on("mousewheel.delegateEvents"+this.cid,".annotation",this.preventScroll)},undelegateEvents:function(){n.a.prototype.undelegateEvents.apply(this,arguments);var e=a()(document);e.off("keydown",this.onKeydown),e.off("mousedown",this.globalCloseEvent),e.off("mouseup",this.globalMouseUpEvent),e.off("mousewheel.delegateEvents"+this.cid,".annotation",this.preventScroll)},enable:function(){this.$(".gui").removeClass("hidden"),Object(s.defer)(function(){this.$(".gui").addClass("enabled")}.bind(this))},disable:function(){this.$(".gui").removeClass("enabled").addClass("hidden")},closeMenus:function(){this.$(".gui").find(".has-menu").removeClass("active"),this.viewer.subviews.generalControls&&this.viewer.subviews.generalControls.settings&&this.viewer.subviews.generalControls.settings.togglePane(!1)},cameraMoveStart:function(){this.viewer.$(".webgl").addClass("camera-moving"),this.viewer.subviews.hotspots&&this.viewer.subviews.hotspots.pauseHotspotCycleInterval()},cameraMoveEnd:function(){this.viewer.$(".webgl").removeClass("camera-moving"),this.viewer.subviews.hotspots&&this.viewer.subviews.hotspots._hotspotCycleIntervalPaused&&this.viewer.subviews.hotspots.beginHotspotCycleInterval(this.HOTSPOT_CYCLE_PAUSE)},onMousewheel:function(){var e;if(this.viewer.scene){var t=this.viewer.scene.getFeatures();t.hasOwnProperty("camera")&&(e=t.camera.getModel().get("indexManipulator"))}if(e===this.VIEWER_MODE_FPS){var i=this.viewer.scene.getViewerOSGJS().getManipulator().getCurrentManipulator()._stepFactor,r=Math.round(i/4*100);this.viewer.subviews.osd.show("Walking speed: "+r,{duration:1e3})}},onKeydown:function(e){var t=document.activeElement,i="",r=["BODY","CANVAS"];32===e.which&&t&&(i=t.tagName,-1!==r.indexOf(i)&&(this.recenter(),e.preventDefault())),e.which>=96&&e.which<=105&&this.timeline&&this.timeline.setCurrentAnimation(e.which-96),27===e.which&&(this.viewer.subviews.hotspots&&this.viewer.subviews.hotspots._hotspots.length&&(this.viewer.subviews.hotspots.currentHotspot=-1,this.viewer.subviews.hotspots.applyCurrentHotspot(),this.viewer.subviews.hotspots.unrevealHotspots(),this.viewer.subviews.hotspots.stopHotspotCycleInterval()),this.closeMenus(),this.viewer.subviews.helpOverlay.hide())},preventParentScroll:function(e,t){var i=a()(".hotspot-controls .list"),r=i.height(),n=i.children()[0].scrollHeight,o=i.children()[0].scrollTop;(o===n-r&&t<0||0===o&&t>0)&&e.preventDefault()},preventScroll:function(e){e.preventDefault()},globalMouseUpEvent:function(){this.cameraMoveEnd()},globalCloseEvent:function(e){a()(e.target).hasClass("has-menu")||a()(e.target).parents(".has-menu").length||this.closeMenus(e)},toggleMenuTouch:function(e){if("label"===e.target.tagName.toLowerCase())return e;e.preventDefault(),e.stopPropagation(),this.toggleMenu(e)},toggleMenu:function(e){if("label"===e.target.tagName.toLowerCase())return e;e.preventDefault(),e.stopPropagation();var t=a()(e.currentTarget);t.hasClass("active")?e.currentTarget===e.target&&t.attr("data-title",t.attr("title")).removeClass("active"):(this.closeMenus(),t.attr("title",t.attr("data-title")).removeAttr("data-title").addClass("active"))},renderSetting:function(e,t){this.viewer.$('[data-setting="'+e+'"]').removeClass("active"),"wireframeColor"===e&&!1===this.viewer.proxySettings.get("wireframeEnable")||this.viewer.$('[data-setting="'+e+'"][data-value="'+t+'"]').addClass("active")},getPointerPosition:function(e){var t,i=e.originalEvent?e.originalEvent:e,r={};return i.touches&&i.touches.length||i.changedTouches&&i.changedTouches.length?(t=i.touches&&i.touches.length?i.touches:i.changedTouches,t=t[0],r.x=t.pageX,r.y=t.pageY,r.type="Touch"):(r.x=e.pageX,r.y=e.pageY,r.type="Mouse"),r},mouseDownEvent:function(e){this.mouseDownPosition=this.getPointerPosition(e),this.viewer.subviews.hint.hide(),"touchstart"===e.type&&(e.target===e.currentTarget||this.scene&&this.scene.getCanvas&&e.target===this.viewer.scene.getCanvas())&&e.preventDefault()},mouseUpEvent:function(e){if(this.mouseDownPosition){var t=this.getPointerPosition(e);if(this.viewer.$el.hasClass("started")){if(Math.abs(this.mouseDownPosition.x-t.x)>20||Math.abs(this.mouseDownPosition.y-t.y)>20){var i=this.viewer._currentModel?this.viewer._currentModel.get("uid"):this.viewer._currentUid;o.a.modelEmbedModelInteraction(i,t.type)}this.mouseDownPosition=null}}},recenter:function(){this.viewer.scene&&this.viewer.scene.getViewerOSGJS().getManipulator().computeHomePosition()},onWatermarkClick:function(){var e=a()(".watermark").find("a").attr("href"),t=e.split("models/").pop().split("/")[0];o.a.modelEmbedWatermarkClicked(t)}})},function(e,t,i){"use strict";var r=i(19),a=i.n(r),n=i(5),o=i(166),s=i(419),u=i.n(s),l=i(16),c=i(2),h=i(150),d=n.a.osg,p=new u.a({device:"VWR"});t.a=o.a.extend({optionTypes:{color:c.b.string},initialize:function(){o.a.prototype.initialize.apply(this,arguments),this.options=a()({},this.options,{color:this.options.color||h.a.skfbBlue})},reset:function(){this._primaryProgress=0,this._secondaryProgress=0},handleLoading:function(e){e.scene.on("primary-progress",function(e){if(this.setPrimaryProgress(e.progress),Object(l.a)().isApp){var t=p.createMessage({data:{progress:e.progress+""}});this.previousMessage&&this.previousMessage.removeFromHash(),t.appendToHash(),this.previousMessage=t}}.bind(this)),e.scene.on("secondary-progress",function(e){this.setSecondaryProgress(e.progress)}.bind(this)),e.scene.on("success",function(){this.viewer.$el.removeClass("model-loading").addClass("model-loaded"),e.model.trigger("status:loaded"),this.trigger("loaded")}.bind(this)),e.scene.on("fail",function(){d.error("Viewer instanciation failed")}.bind(this))},setPrimaryProgress:function(e){this._primaryProgress=Math.min(Math.max(this._primaryProgress,e),1),this.updateMainProgressBar(),1===this._primaryProgress&&this.setSecondaryProgress(0)},setSecondaryProgress:function(e){this._secondaryProgress=Math.min(Math.max(0,e),1),this.updateSecondaryProgressBar()},updateMainProgressBar:function(){var e=this._primaryProgress,t=1===e;this.$(".main-progress").toggleClass("loading",!t),this.$(".main-progress-display__progress").css({width:100*e+"%",backgroundColor:this.options.color}),this.$(".main-progress-percentage").text(Math.floor(100*e)+" %")},updateSecondaryProgressBar:function(){var e=this._secondaryProgress;this.$(".secondary-progress-percentage").text(Math.floor(100*e)+" %"),this.$(".secondary-progress-display").css("width",100*e+"%");var t=1===this._primaryProgress,i=1===e;this.$(".secondary-progress").toggleClass("visible",t&&!i)}})},function(e,t,i){"use strict";var r=i(42),a=i.n(r),n=i(0),o=(i.n(n),i(166)),s=i(55),u=i(16);t.a=o.a.extend({initialize:function(){o.a.prototype.initialize.apply(this,arguments),this.$hint=this.$(".viewer-hint"),this.$hint.find(".viewer-movehint .label").html(this.moveHintTemplate()),this.options.fallback&&this.$hint.addClass("fallback-position")},show:function(e){e=Object(n.defaults)(Object(n.extend)({},e),{force:!1});var t=1===s.a.get("show_viewer_hint",1),i=Object(u.a)().uiHint;2===i&&(e.force=!0),(e.force||1===i&&t)&&this.$hint.addClass("active")},hide:function(e){e=Object(n.defaults)(Object(n.extend)({},e),{remember:!0}),this.$hint.removeClass("active"),e.remember&&s.a.set("show_viewer_hint",0,{expires:15552e6})},moveHintTemplate:function(){return a.a.any?"touch &amp; drag<br>to rotate":"click &amp; hold<br>to rotate"}})},function(e,t,i){"use strict";var r=i(3),a=i.n(r),n=i(0),o=(i.n(n),i(94)),s=i(11),u=i(166),l=Object(n.template)(['<div class="setting" data-setting="<%= name %>" data-setting-group="<%= group %>">','   <p class="setting-label"><%= label %></p>',"</div>"].join("")),c=Object(n.template)(['<div class="setting" data-setting="<%= name %>" data-setting-group="<%= group %>" data-setting-type="<%= type %>">','   <p class="setting-label"><%= label %></p>','   <p class="setting-value" data-value="<%= value %>" ><%= prettyValue %></p>',"</div>"].join("")),h=Object(n.template)(['   <a class="control-menu-back back">Back</a>','   <ul class="setting-list" data-setting="<%= name %>" data-setting-type="<%= type %>">',"       <%= listItems %>","   </ul>"].join("")),d=Object(n.template)(['<li class="setting-item <% if (selected) { %>selected<% } %>" data-value="<%= value %>">',"   <%= prettyValue %>",'   <span class="shortcut" title="Keyboard shortcut"><%= shortcut %></span>',"</li>"].join(""));t.a=u.a.extend({events:{"click .setting":"onSettingClick","touchend .setting":"onSettingClick","click .back":"togglePane","touchend .back":"togglePane","click .setting-item":"onSettingValueClick","touchend .setting-item":"onSettingValueClick",'click [data-setting="viewerMode"] li':"onViewerModeChange",'touchend [data-setting="viewerMode"] li':"onViewerModeChange"},initialize:function(e){if(u.a.prototype.initialize.apply(this,arguments),this.settings=e.settings,this.viewer=e.viewer,Object(n.isEmpty)(this.settings))return console.warn("No settings object given to SettingsMenu"),void this.$el.hide();this.$list=this.$(".control-menu-list"),this.$pane=this.$(".control-menu-pane"),this.$el.on("click touchend",'.wireframe-colors a[data-setting="wireframeColor"]:not(.active)',this.onWireframeColorClick.bind(this)),this.$el.on("click touchend",'.wireframe-colors a[data-setting="wireframeColor"].active',this.onDisableWireframeClick.bind(this)),this.$el.on("click touchend",'.wireframe-colors a[data-setting="wireframeEnable"]',this.onDisableWireframeClick.bind(this)),this.viewer.proxySettings.on("change",this.render.bind(this))},onViewerModeChange:function(e){e&&"touchend"===e.type&&e.preventDefault(),"0"===this.viewer.proxySettings.get("viewerMode")?this.viewer.subviews.osd.show("Click and hold to rotate",{position:"top",duration:3e3}):this.viewer.subviews.osd.show("Mouse to look around, keyboard to move",{position:"top",duration:3e3})},onDisableWireframeClick:function(e){e&&"touchend"===e.type&&e.preventDefault();var t=this.$('.wireframe-colors [data-setting="wireframeEnable"]');s.a.modelViewerWireframeToggleClicked(!1),this.viewer.proxySettings.set("wireframeEnable",!1),t.parent().find(".active").removeClass("active"),t.addClass("active")},onWireframeColorClick:function(e){e&&"touchend"===e.type&&e.preventDefault();var t=a()(e.currentTarget),i=t.attr("data-value");this.viewer.proxySettings.set("wireframeColor",i),this.viewer.proxySettings.set("wireframeEnable",!0),t.parent().find(".active").removeClass("active"),t.addClass("active"),s.a.modelViewerWireframeColorSelected(i)},onSettingClick:function(e){e&&"touchend"===e.type&&e.preventDefault&&e.preventDefault();var t=a()(e.currentTarget).attr("data-setting"),i=this.settings[t];if(i.name=t,i.isButton)return this[i.action]&&this[i.action](e);this.renderSettingPane(i),this.togglePane(!0)},onSettingValueClick:function(e){e.preventDefault(),e.stopPropagation();var t=a()(e.currentTarget),i=t.attr("data-value"),r=t.closest("[data-setting]"),n=r.attr("data-setting"),o=r.attr("data-setting-type")||"string";switch(n){case"shadingStyle":s.a.modelViewerShadingSelected(i);break;case"viewerMode":s.a.modelViewerViewerModeSelected(i)}switch(o){case"number":i=parseFloat(i);break;case"bool":i="true"===i}this.viewer.proxySettings.set(n,i)},onSettingChangeWhileOpen:function(){this.renderSettingPane(this._currentSetting)},renderSettingPane:function(e){var t="",i="",r=this.viewer.proxySettings.get(e.name),a=this.getSettingFromValue(e.name,r),o=this.viewer._currentModel.get("options").shading.type;this._currentSetting&&this.viewer.proxySettings.off("change:"+this._currentSetting.name,this.onSettingChangeWhileOpen,this),this._currentSetting=e,this._currentSetting&&this.viewer.proxySettings.on("change:"+this._currentSetting.name,this.onSettingChangeWhileOpen,this),"shadingStyle"===e.name&&"lit"!==o||Object(n.each)(e.settings,function(e){t+=d({value:e.value,type:e.type||"string",prettyValue:e.label,selected:a===e,shortcut:e.shortcut||""})}),i=(e.paneTemplate||h)({listItems:t,name:e.name,type:e.type||"string",viewerSettings:this.viewer.proxySettings.toJSON()}),this.$pane.html(i);var s=this.viewer.scene.getFeatures().webVR.getModel();"viewerMode"!==this._currentSetting.name||s.get("hasNativeHMD")?this.$('[data-value="2"]').show():this.$('[data-value="2"]').hide()},getSettingFromValue:function(e,t){var i;return(this.settings[e].settings||[]).forEach(function(e){e.value!==t&&e.value+""!=t+""||(i=e)}),i},togglePane:function(e,t){t&&"touchend"===t.type&&t.preventDefault(),this.$el.toggleClass("detail",e),Object(o.a)(this.$(".control-menu-wrapper"),function(){this.$el.hasClass("detail")||this.clearPane()}.bind(this))},clearPane:function(){this.$pane.html("")},render:function(){var e="",t=this.viewer.scene.getFeatures().quality.getModel(),i=this.viewer.scene.getFeatures().hotspot.getModel(),r=this.viewer.scene.getFeatures().animation.getModel(),a=[];Object(n.each)(this.settings,function(e,t){var i=Object(n.clone)(e);i.name=t,a.push(i)}),a=Object(n.sortBy)(a,"order"),Object(n.each)(a,function(t){var i,r=t.name;if(t.isButton)i=l({name:r,label:t.label,group:t.group});else{var a=this.getSettingFromValue(r,this.viewer.proxySettings.get(r))||t.settings[0];i=c({name:r,label:t.label,value:a.value,prettyValue:a.label,group:t.group,type:a.type})}e+=i}.bind(this)),this.$list.html(e),u.a.prototype.render.apply(this,arguments),r&&r.get("animations").length?this.$('[data-setting-group="animation"]').show():this.$('[data-setting-group="animation"]').hide(),t&&t.get("promiseReady").isFulfilled()?this.$('[data-setting-group="textureQuality"]').show():this.$('[data-setting-group="textureQuality"]').hide(),i&&i.get("hotspots").length?this.$('[data-setting-group="annotation"]').show():this.$('[data-setting-group="annotation"]').hide(),t&&t.get("promiseReady").isFulfilled()&&window.requestAnimationFrame(function(){var e=this.getSettingFromValue("textureQuality",t.get("level"));this.$('[data-setting="textureQuality"] .setting-value').attr("data-value",e.value).text(e.label)}.bind(this))},onTextureQualityReady:function(e){var t=this.viewer.scene.getFeatures().quality;if(t){if(!e.low&&!e.mid&&!e.high)return void this.$('[data-setting="textureQuality"]').remove();var i=t.getModel(),r=i.get("level");this.viewer.proxySettings.set("textureQuality",r),this.render()}}})},function(e,t,i){"use strict";var r=i(166);t.a=r.a.extend({events:{"click .close":"close"},close:function(e){e&&e.preventDefault&&e.preventDefault()}})},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(7)),n=i.n(a),o=i(5),s=i(166),u=i(944),l=i(943),c=i(26),h=i(611),d=o.a.osg;t.a=s.a.extend({events:{"mouseover .snapshot .button":"showGuides","mouseout .snapshot .button":"hideGuides"},initialize:function(){s.a.prototype.initialize.apply(this,arguments),this.$el.find(".snapshot .button").on("click",this.onSnapshot.bind(this))},onSnapshot:function(e){var t=this.viewer.scene;e.preventDefault();var i=this.$el.find(".snapshot"),r=this.$el.find(".snapshot-flash"),a=this.$el.find(".img-container");if(!i.hasClass("progress")){i.addClass("progress"),r.addClass("active"),setTimeout(function(){r.removeClass("active")},2e3);var o=!0,s=t.getFeatures();if(s.camera){s.camera.getModel().saveCameraPosition();var u=t.getFeatures().saveUI;u||(u=new l.a,u.init(t.getFeaturesManager()._context),u._views[0].enableSaving()),o=u._views[0].save()}n.a.all([t.getScreenShot(1920,1080),o]).then(this.onTakeScreenshot.bind(this,i,a))}},onTakeScreenshot:function(e,t,i){var r=i[0],a=r.toDataURL("image/jpeg"),n=Object(h.a)(a),o=new u.a({imageFile:n}),s=this.viewer._currentModel,l=o.save({modelUID:s.get("uid")}),p=t.find("img");p&&(p.remove(),null!==this.previewTimeout&&(window.clearTimeout(this.previewTimeout),this.previewTimeout=null));var f=new Image;f.src=a,t.prepend(f),t.removeClass("invisible"),this.previewTimeout=setTimeout(function(){t.addClass("invisible")},4e3),l.done(function(){e.removeClass("progress"),e.addClass("success"),setTimeout(function(){e.removeClass("success")},2e3)}).fail(function(){var t=new c.default({title:"Save settings error",text:"An unexpected error happened. The thumbnail has NOT been saved.",buttons:{ok:!0}});t.open().then(function(){t.close()}),d.error("Error while saving snapshot"),e.removeClass("progress")})},showGuides:Object(r.debounce)(function(){this.$(".snapshot-guides").addClass("active")},100),hideGuides:Object(r.debounce)(function(){this.$(".snapshot-guides").removeClass("active")},100)})},function(e,t,i){"use strict";var r=i(3),a=i.n(r),n=i(0),o=(i.n(n),i(11)),s=i(479),u=i(17),l=i(671),c=i(100),h=u.a.shortcuts;t.a=l.a.extend({displayName:"HelpOverlay",mixins:[Object(c.a)(".tabs-container")],events:{"click .tabs a":"onTabClick","touchstart .tabs a":"onTabClick",'click [data-action="reset-camera"]':"onResetCameraClick",'touchstart [data-action="reset-camera"]':"onResetCameraClick"},initialize:function(){l.a.prototype.initialize.apply(this,arguments),this.renderingShortcuts=new s.a(h.viewerRendering),this.annotationShortcuts=new s.a(h.annotationControl),this.animationShortcuts=new s.a(h.animationControl),this.render()},onResetCameraClick:function(e){e.preventDefault(),o.a.modelViewerResetCameraButtonClicked(),this.hide(),this.viewer.scene.getFeaturesManager().focusOnSavedCamera(2),Object(n.defer)(function(e){e.target.blur()},e)},render:function(){var e=this.renderingShortcuts.generateHelpSection(),t=this.annotationShortcuts.generateHelpSection(),i=this.animationShortcuts.generateHelpSection();this.$(".rendering-shortcuts").html(e),this.$(".annotation-shortcuts").html(t),this.$(".animation-shortcuts").html(i)},onTabClick:function(e){e.preventDefault();var t=a()(e.currentTarget),i=t.attr("data-target"),r=this.$("[data-tab].active"),n=this.$('[data-tab="'+i+'"]');o.a.modelViewerHelpTabClicked(i),this.$(".tabs li").removeClass("active"),t.parent().addClass("active"),r.removeClass("active"),n.addClass("active")}})},function(e,t,i){"use strict";var r=i(147),a=i(100),n=i(671),o=n.a.extend({mixins:[r.a,Object(a.a)(".js-scrollable")],events:{"click .tabs a":"onTabClick",'click [data-action="reset-camera"]':"onResetCameraClick"},setModel:function(e){this.model=e,this.render()},render:function(){this.model&&(this.$(".hotspot-title").html(this.model.get("name")),this.$(".hotspot-content").html(this.model.get("content").rendered),this.handleLazyLoading())}});t.a=o},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(100)),n=i(17),o=i(47),s=i(479),u=i(11),l=i(4),c=i(166),h=i(564),d=i(875),p=i(6),f=n.a.shortcuts,m={render:{title:"Render ("+f.inspectorControl.shortcuts[0].keyCombinations+")",displayViews:[{text:"Final Render",icon:"icon-final-render",value:"Default",has2dView:!1},{text:"No Post-Processing",icon:"icon-final-render",value:"DefaultNoPostProcess",has2dView:!1}]},materials:{title:"Material channels ("+f.inspectorControl.shortcuts[1].keyCombinations+")",displayViews:[{text:"Albedo",icon:"icon-diffuse",value:"DiffusePBR",has2dView:!0},{text:"Base Color",icon:"icon-diffuse",value:"AlbedoPBR",has2dView:!0},{text:"Diffuse",icon:"icon-diffuse",value:"DiffuseColor",has2dView:!0},{text:"Specular",icon:"icon-specular",value:"SpecularPBR",has2dView:!0},{text:"Metalness",icon:"icon-metalness",value:"MetalnessPBR",has2dView:!0},{text:"Specular Color",icon:"icon-specular",value:"SpecularColor",has2dView:!0},{text:"Glossiness",icon:"icon-roughness",value:"GlossinessPBR",has2dView:!0},{text:"Roughness",icon:"icon-roughness",value:"RoughnessPBR",has2dView:!0},{text:"Specular Glossiness",icon:"icon-specular",value:"SpecularHardness",has2dView:!0},{text:"Scattering",icon:"icon-subsurface",value:"SubsurfaceScattering",has2dView:!0},{text:"Translucency",icon:"icon-subsurface",value:"SubsurfaceTranslucency",has2dView:!0},{text:"Normal Map",icon:"icon-normal-map",value:"NormalMap",has2dView:!0},{text:"Bump Map",icon:"icon-normal-map",value:"BumpMap",has2dView:!0},{text:"AO map",icon:"icon-AO",value:"AOPBR",has2dView:!0},{text:"Cavity",icon:"icon-AO",value:"CavityPBR",has2dView:!0},{text:"Lightmap",icon:"icon-lightmap",value:"DiffuseIntensity",has2dView:!0},{text:"Displacement",icon:"icon-displacement",value:"Displacement",has2dView:!0},{text:"Opacity",icon:"icon-transparency",value:"Opacity",has2dView:!0},{text:"Emission",icon:"icon-emission",value:"EmitColor",has2dView:!0},{text:"Specular F0",icon:"icon-specular",value:"SpecularF0",has2dView:!0},{text:"Vertex Color",icon:"icon-diffuse",value:"VertexColor",has2dView:!0},{text:"Vertex Alpha",icon:"icon-transparency",value:"VertexAlpha",has2dView:!0}]},geometry:{title:"Geometry ("+f.inspectorControl.shortcuts[2].keyCombinations+")",displayViews:[{text:"Matcap",icon:"icon-final-render",value:"MatcapFlat",has2dView:!1},{text:"Matcap+Surface",icon:"icon-final-render",value:"MatcapDetail",has2dView:!1},{text:"Wireframe",icon:"icon-geometry",value:"Wireframe",has2dView:!0},{text:"Vertex Normals",icon:"icon-vertex-normals",value:"VertexNormal",has2dView:!1}]},uv:{title:"UV ("+f.inspectorControl.shortcuts[3].keyCombinations+")",displayViews:[{text:"UV Checker",icon:"icon-UV",value:"UVChecker",has2dView:!0}]}},g=l.default.getFromString('\n        <div class="model-inspector__wireframe">\n            {{ wireframe | safe }}\n        </div>\n        {% if inspectableTextures or isStaff %}\n            <div class="mode__title">Viewport{%if not inspectableTextures and isStaff %} (Staff only){% endif %}</div>\n            <div class="toggle-button{%if not inspectableTextures and isStaff %} --staff{% endif %}">\n                <span class="toggle-button__option">\n                    <input type="radio" name="splitType" data-value="3d" id="splitType-3d">\n                    <label for="splitType-3d">3D</label>\n                </span>\n                <span class="toggle-button__option">\n                    <input type="radio" name="splitType" data-value="split" id="splitType-split">\n                    <label for="splitType-split">3D + 2D</label>\n                </span>\n                <span class="toggle-button__option">\n                    <input type="radio" name="splitType" data-value="2d" id="splitType-2d">\n                    <label for="splitType-2d">2D</label>\n                </span>\n            </div>\n        {% endif %}\n       {% for category, mode in modes %}\n            {% if mode.displayViews %}\n                <div class="mode__title">{{ mode.title }}</div>\n            {% endif %}\n            <ul>\n                {% for button in mode.displayViews %}\n                    <li                        class="mode {{ "selected" if button.value == active else "" }}" data-mode="{{ mode.title }}" data-value="{{ button.value }}"\n                        style="{{ button.style }}"\n                    >\n                        <i class="mode__icon custom-icons {{ button.icon }}"></i>\n                        <span>{{ button.text }}</span>\n                    </li>\n                    {% endfor %}\n            </ul>\n       {% endfor %}\n    ');t.a=c.a.extend({mixins:[Object(a.a)(".js-scrollable")],children:{materialSelector:{selector:".model-inspector__2D-options .model-inspector__material-options",viewClass:h.b,shouldCreateChild:function(){return this.canInspectTextures()},options:function(){return{theme:"dark",value:this.model.get("material").toString(),onChange:function(e){this.model.set("material",e)}.bind(this),options:this.model.get("materialList").filter(function(e){return!e.uidUniqueMerged}).map(function(e){var t=e.uidListUnusedDuplicates.length?"Merged ("+e.name+", ...)":e.name;return{title:this.model.materialHasTextureInView2d(e.uid)?t:t+" (no texture)",value:e.uid}}.bind(this)).sort(function(e,t){return e.title<t.title?-1:e.title>t.title?1:void 0}),closeOnSelection:!1,autoScale:!0}}},UVSelector:{selector:".model-inspector__2D-options .model-inspector__UV-options",viewClass:h.b,shouldCreateChild:function(){return this.canInspectTextures()&&this.model.getCurrentUVs().length>1},options:function(){return{theme:"dark",value:this.model.get("texCoord").toString(),onChange:function(e){this.model.set("texCoord",e)}.bind(this),options:this.model.getCurrentUVs().sort(function(e,t){return e-t}).map(function(e){return{title:"UV "+e.toString(),value:e.toString()}}),closeOnSelection:!1,autoScale:!0}}}},events:{"click .mode":"onSelectDisplayView","click .model-inspector__minimize":"toggleVisibility",'click [name="splitType"]':"onSelectSplitType","click [data-setting]":"changeWireframe"},initialize:function(){c.a.prototype.initialize.apply(this,arguments),this.initializeShortcuts(),this.updateModes(),this.updateSavedState(),this._selectors=this.$(".model-inspector__2D-options"),this.render(),this._selectors.css({visibility:"hidden"})},delegateEvents:function(){c.a.prototype.delegateEvents.apply(this,arguments),this.model.on("change:displayView",this.updateDisplayViewUI,this),this.model.on("change:material change:texCoord change:displayView",this.renderChildren,this),this.model.on("change:material change:displayView change:splitType",this.update2DView,this),this.model.on("change:availableDisplayView",this.updateAvailableDisplayView,this),this.model.on("change:uiVisible",this.show,this)},undelegateEvents:function(){c.a.prototype.undelegateEvents.apply(this,arguments),this.model.off("change:displayView",this.updateDisplayViewUI,this),this.model.off("change:material change:texCoord change:displayView",this.renderChildren,this),this.model.off("change:material change:displayView change:splitType",this.update2DView,this),this.model.off("change:availableDisplayView",this.updateAvailableDisplayView,this),this.model.off("change:uiVisible",this.show,this)},updateModes:function(){var e=this.model.get("availableDisplayView");this.modes=Object(r.reduce)(m,function(t,i,a){var n=i.displayViews.filter(function(t){return-1!==e.indexOf(t.value)});if(0===n.length)return t;var o=Object(r.extend)({},i,{displayViews:n});return t[a]=o,t},{}),this.modeNamesWith2d=Object(r.reduce)(this.modes,function(e,t){var i=t.displayViews.filter(function(e){return e.has2dView}).map(function(e){return e.value});return e.concat(i)},[])},changeWireframe:function(e){var t=e.currentTarget.dataset.setting,i=e.currentTarget.dataset.value;if("wireframeEnable"===t){var r=!this.options.wireframeModel.get("wireframeEnable");return u.a.modelViewerWireframeToggleClicked(r),this.options.wireframeModel.set("wireframeEnable",r)}u.a.modelViewerWireframeColorSelected(i),this.options.wireframeModel.set("wireframeEnable",!0),this.options.wireframeModel.set(t,i)},onSelectDisplayView:function(e){var t=e.currentTarget.getAttribute("data-mode"),i=e.currentTarget.getAttribute("data-value");u.a.inspectorDisplayViewClicked(t,i),this.model.set("displayView",i)},canInspectTextures:function(){return this.options.inspectableTextures||p.a.me().get("isStaff")},_currentModeHas2dView:function(){var e=this.model.get("displayView");return-1!==this.modeNamesWith2d.indexOf(e)},_getDisplayViewLabel:function(){return this.$el.find("[data-value="+this.model.get("displayView")+"]").text().trim()},updateDisplayViewUI:function(){this.$el.find(".selected").removeClass("selected"),this.$el.find("[data-value="+this.model.get("displayView")+"]").addClass("selected")},updateAvailableDisplayView:function(){this.updateModes(),-1===this.model.get("availableDisplayView").indexOf(this._savedState.displayView)&&(this._savedState.displayView="Default"),this.render()},update2DView:function(){if(this.canInspectTextures())if(this.updateSelectorsUI(),"3d"===this.model.get("splitType")||this.model.materialHasContentInView2d(this.model.get("material")))this.$el.find(".model-inspector__empty-2d-view").text("");else{var e=this.model.get("materialByUid")[this.model.get("material")].name,t=this.$el.find(".model-inspector__empty-2d-view"),i="2d"===this.model.get("splitType")?"50%":"25%",r="";r=this._currentModeHas2dView()?"No data in "+e+"/"+this._getDisplayViewLabel():"2D view isn't available for "+this._getDisplayViewLabel()+".<br>Select a Material Channel to view textures.",t.html(r).css("right",i)}},updateSelectorsUI:function(){"3d"!==this.model.get("splitType")&&this._currentModeHas2dView()?this._selectors.css({visibility:"visible"}):this._selectors.css({visibility:"hidden"})},onSelectSplitType:function(e){this.canInspectTextures()&&(u.a.inspectorSplitTypeClicked(e.currentTarget.getAttribute("data-value")),this.model.set("splitType",e.currentTarget.getAttribute("data-value")))},initializeShortcuts:function(){var e=new s.a(f.inspectorControl),t=this.onShortcut.bind(this),i=function(){u.a.modelViewerInspectorShortcut(),this.toggle()}.bind(this);e.on("render materials geometry uv",t),e.on("inspector",i),e.listen()},onShortcut:function(e){var t=this.modes[e.id],i=this._savedState.displayView,a=Object(r.findIndex)(t.displayViews,function(e){return e.value===i}),n=(a+1)%t.displayViews.length,s=t.displayViews[n];this.model.get("uiVisible")?this.options.osd.hide():Object(o.a)()?this.model.set("uiVisible",!0):this.options.osd.show(s.text,{duration:1e3}),u.a.inspectorModeShortcut(t.title,s.value),this.model.set("displayView",s.value),this.updateSavedState({displayView:s.value})},close:function(){this.$el.removeClass("--show"),this.updateSavedState(),this.model.set("displayView","Default"),this.model.set("splitType","3d")},show:function(e,t){this.$el.toggleClass("--show --open",t)},restoreState:function(){this.model.set("displayView",this._savedState.displayView),this.model.set("splitType",this._savedState.splitType),this.model.set("material",this._savedState.material),this.model.set("texCoord",this._savedState.texCoord)},updateSavedState:function(e){this._savedState=Object(r.extend)({displayView:this.model.get("displayView"),material:this.model.get("material"),splitType:this.model.get("splitType"),texCoord:this.model.get("texCoord")},e)},toggle:function(){this.model.get("uiVisible")?(this.model.set("uiVisible",!1),this.close()):(this.model.set("uiVisible",!0),this.restoreState())},toggleVisibility:function(){u.a.inspectorUIVisibilityToggleClicked(),this.$el.toggleClass("--open")},render:function(){var e=this.viewer.proxySettings.get("setting.name");this.$(".model-inspector__modes").html(g({inspectableTextures:this.options.inspectableTextures,modes:this.modes,active:this.model.get("displayView"),wireframe:Object(d.b)({wireframeColor:e}),isStaff:p.a.me().get("isStaff")})),this.renderChildren(),this.afterRender()},afterRender:function(){this.$('[data-value="'+this.model.get("splitType")+'"]').prop("checked",!0)}})},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(166));t.a=a.a.extend({events:{"click .osd":"hide"},show:function(e,t){this.osdTimeout&&window.clearTimeout(this.osdTimeout),t=Object(r.extend)({position:"center"},t);var i=this.$(".osd");i.find(".osd-content").html(e),i.addClass("active"),i.removeClass("osd-top osd-center"),i.addClass("osd-"+t.position),t.duration&&(t.duration=Math.max(0,t.duration),this.osdTimeout=setTimeout(this.hide.bind(this),t.duration))},hide:function(){this.$(".osd").removeClass("active")}})},function(e,t,i){"use strict";var r=i(3),a=i.n(r),n=i(942),o=i(166),s=i(17),u=i(479);t.a=o.a.extend({_isHover:!1,events:{touchstart:"onTouchStart",mousedown:"onClick",mouseover:"onMouseover",mouseout:"onMouseout",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave"},initialize:function(){o.a.prototype.initialize.apply(this,arguments),this.previousValue=null,this._touched=!1,this.$icon=this.$(".fa"),this.listenTo(this.model,"change:volume",this.render.bind(this)),this.render(),this.$volumeMenu=this.$(".volume-menu"),this.slider=new n.a(void 0,{model:this.model,global:!0,orientation:"vertical"}),this.$volumeMenu.append(this.slider.$el),this.initializeShortcuts()},delegateEvents:function(){o.a.prototype.delegateEvents.apply(this,arguments),a()(window).on("mouseup.delegateEvents"+this.cid,this.onVolumeInteractionEnd.bind(this)),a()(window).on("touchend.delegateEvents"+this.cid,this.onVolumeInteractionEnd.bind(this))},undelegateEvents:function(){o.a.prototype.undelegateEvents.apply(this,arguments),a()(window).off(".delegateEvents"+this.cid)},initializeShortcuts:function(){this.soundControlShortcuts=new u.a(s.a.shortcuts.sound),this.soundControlShortcuts.on("mute",this.toggleMute.bind(this)),this.soundControlShortcuts.listen()},onTouchStart:function(){this._touched=!0},onClick:function(e){e.preventDefault();var t=a()(e.target);t.is(".volume-menu")||t.parents(".volume-menu").length||this.toggleMute()},onMouseEnter:function(){this._isHover=!0},onMouseLeave:function(){this._isHover=!1},toggleMute:function(){this.slider.onoff()},togglePane:function(e){this.$el.toggleClass("--active",e)},onMouseover:function(){if(this._touched)return void(this._touched=!1);this.togglePane(!0)},onMouseout:function(){!1===this.slider.started&&this.togglePane(!1)},onVolumeInteractionEnd:function(){this.model.get("enable")&&(this._isHover||this.togglePane(!1))},show:function(){this.viewer.$el.addClass("sound-enabled")},hide:function(){this.viewer.$el.removeClass("sound-enabled")},render:function(){var e=this.model.get("volume");return this.$icon.toggleClass("fa-volume-up",e>=.5),this.$icon.toggleClass("fa-volume-down",e>0&&e<.5),this.$icon.toggleClass("fa-volume-off",0===e),this}})},function(e,t,i){"use strict";var r=i(3),a=i.n(r),n=i(0),o=(i.n(n),i(8)),s=i(876),u=i(1368),l=o.a.extend({_isLoaded:!1,_context:null,isMoving:!1,startX:0,sensitivity:20,sprite:{current:0,steps:15,ratio:null,width:0},size:1,autospinTimer:null,events:{mousedown:"onMouseDown",mouseup:"onMouseUp","mousemove ":"onMouseMove",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove"},constructor:function(){this._boundResizeEvent=this.onWindowResize.bind(this),o.a.prototype.constructor.apply(this,arguments)},initialize:function(){o.a.prototype.initialize.apply(this,arguments),this.$viewport=a()(),this.$image=a()()},delegateEvents:function(){o.a.prototype.delegateEvents.apply(this,arguments),a()(window).on("resize",this._boundResizeEvent)},undelegateEvents:function(){o.a.prototype.undelegateEvents.apply(this,arguments),a()(window).off("resize",this._boundResizeEvent),this.autospinTimer&&clearInterval(this.autospinTimer)},isViewerReady:function(){return this._isLoaded},run:function(){var e=new s.a;this._context=e,this.$el.show(),this.$el.siblings(".webgl").hide(),this.$el.siblings(".osd").hide();var t=this.model.get("uid"),i=this._fallbackCollection=new u.a([],{uid:t});return i.fetch().then(function(){i.length>0?this.displayFallback():this.displayNoFallbackError()}.bind(this)).catch(function(){this.displayNoFallbackError()}.bind(this)),this._isLoaded=!0,!0},getContext:function(){return this._context},getFeatures:function(){return{}},findBestImage:function(){for(var e,t=this._fallbackCollection.toJSON(),i=this.$el.height(),r=1/0,a=0,n=t.length;a<n;++a){var o=t[a],s=Math.abs(i-o.height);s<r&&(r=s,e=o)}return e},displayFallback:function(){this.$viewport=a()(".fallback-viewport"),this.$image=this.$viewport.find("img.fallback-sprite");var e=this.findBestImage(),t=e.url;this._currentHeight=e.height,this.$image.on("load",function(e){var t=e.target.naturalHeight,i=e.target.naturalWidth/this.sprite.steps;this.sprite.ratio=t?i/t:0,a()(e.target).css("display","block"),this.trigger("secondary-progress",{progress:1}),this.trigger("success"),this.displayFallbackWarning(),this.onWindowResize()}.bind(this)),this.$image.on("error",function(e){console.error("Fallback loading failed. URL : "+t+" ERROR : "+e.toString()),this.trigger("fail"),this.displayFallbackLoadingError()}.bind(this)),this.$image.attr("src",t)},displayFallbackLoadingError:function(){this.$el.find(".fallback-error-loading").show()},displayNoFallbackError:function(){this.$el.find(".fallback-error-nofallback").show()},displayFallbackWarning:function(){this._warningDisplayed||(this._warningDisplayed=!0,this.$el.find(".fallback-warning").show(),this.fallbackWarning=setTimeout(function(){this.$el.find(".fallback-warning").fadeOut()}.bind(this),5e3))},onWindowResize:function(){if(this._fallbackCollection.length){var e,t,i=this.$el.width(),r=this.$el.height(),a=i/r;this.findBestImage().height>this._currentHeight&&this.displayFallback(),2===this.size?a<this.sprite.ratio?(e=i,t=Math.floor(e/this.sprite.ratio)):(t=r,e=Math.floor(t*this.sprite.ratio)):a<this.sprite.ratio?(t=r,e=Math.floor(t*this.sprite.ratio)):(e=i,t=Math.floor(e/this.sprite.ratio)),this.$viewport.width(e).height(t).css({"margin-top":Math.round(-1*t/2),"margin-left":Math.round(-1*e/2)}),this.sprite.width=Math.round(this.$image.prop("scrollHeight")*this.sprite.ratio),this.$viewport.scrollLeft(this.sprite.width*this.sprite.current)}},onMouseDown:function(e){e.preventDefault(),this.isMoving=!0,this.startX=e.clientX},onMouseMove:function(e){e.preventDefault(),this.move(e.clientX)},onMouseUp:function(e){e.preventDefault(),this.isMoving=!1},onTouchStart:function(e){e.preventDefault(),this.isMoving=!0;var t=e.originalEvent.touches[0];this.startX=t.clientX},onTouchMove:function(e){e.preventDefault(),this.move(e.originalEvent.touches[0].clientX)},onTouchEnd:function(e){e.preventDefault(),this.isMoving=!1},move:function(e){this.isMoving&&(this.autospinTimer&&this.stopAutospin(),e>this.startX+this.sensitivity&&(this.startX=e,this.moveRight()),e<this.startX-this.sensitivity&&(this.startX=e,this.moveLeft()))},moveRight:function(){0===this.sprite.current?this.sprite.current=this.sprite.steps-1:this.sprite.current=this.sprite.current-1,this.$viewport.scrollLeft(this.sprite.width*this.sprite.current)},moveLeft:function(){this.sprite.current=(this.sprite.current+1)%this.sprite.steps,this.$viewport.scrollLeft(this.sprite.width*this.sprite.current)},startAutospin:function(){this.autospinTimer=setInterval(Object(n.bind)(function(){this.moveLeft()},this),500)},stopAutospin:function(){clearInterval(this.autospinTimer),this.autospinTimer=null},toggleAutospin:function(){this.autospinTimer?this.stopAutospin():this.startAutospin()}});t.a=l},function(e,t,i){"use strict";var r=i(38),a=i(1369);t.a=r.a.extend({model:a.a,parse:function(e){return e.results.images},url:function(){return"/i/models/"+this.options.uid+"/fallback"}})},function(e,t,i){"use strict";var r=i(12);t.a=r.a.extend({})},function(e,t,i){"use strict";var r=i(5),a=i(16),n=i(37),o=i(146),s=r.a.osg,u=[[.263385,-.0252475],[-.38545,.054485],[-.139795,-.5379925],[-.2793775,.6875475],[.7139025,.4710925],[.90044,-.16422],[.4481775,-.82799],[-.9253375,-.2910625],[.3468025,1.02292],[-1.13742,.33522],[-.7676225,-.9123175],[-.2005775,-1.1774125],[-.926525,.96876],[1.12909,-.7500325],[.9603,1.14625]],l=function(e){return l.instance?l.instance:(this._canBeEnabled=Object(a.a)().supersample,this._viewer=e,this._sampleCount=15,this._isFakeSupersampling=!1,this._isSupersampling=!1,this._frameNum=1,this._frameNumTaa=0,this._switch=!0,this._jitter=o.a.uHalton.getInternalArray(),this._jitter[2]=1,l.instance=this,this)};s.createPrototypeObject(l,{getSampleCount:function(){return this._sampleCount},canBeEnabled:function(){return this._canBeEnabled},getSortedJitterTable:function(){return u},getBackgroundModel:function(){return this._viewer.getFeatures().background.getModel()},getAnimationModel:function(){return this._viewer.getFeatures().animation.getModel()},isWireframeDisplayed:function(){var e=this._viewer.getOrCreateScene().getWireframeNodes();return!!e.length&&0!==e[0].getNodeMask()},updateUniforms:function(e,t){var i=e%this._sampleCount,r=this.getSortedJitterTable()[i],a=this.isWireframeDisplayed()||t?.05:1;this._jitter[0]=r[0]*a,this._jitter[1]=r[1]*a,this._jitter[3]=i},setSwitch:function(e){this._switch=e},isTaaJitter:function(){var e=this._postProcess.getModel(),t=e.get("taaEnable"),i="none"!==this.getBackgroundModel().get("enable"),r=void 0!==Object(a.a)().taaJitter?Object(a.a)().taaJitter:i,n=e.get("webVR"),o=this.getAnimationModel().canActivateTAA(),s=0===Object(a.a)().autospin||Object(a.a)().taaAnimation;return o&&t&&r&&!n&&s},updateFrame:function(){if(this._jitter[2]=-this._jitter[2],this._postProcess.getModel().trigger("pingPongTexture0",this._jitter[2]>0),!this._isSupersampling)return this._jitter[2]=Math.sign(this._jitter[2]),n.a._doJitter&&this.isTaaJitter()?(this.updateUniforms(this._frameNumTaa,!0),this._frameNumTaa++):(this._jitter[0]=0,this._jitter[1]=0,this._frameNum=1,this._frameNumTaa=0),n.a._doJitter=!0,!1;n.a._doJitter=!0;var e=this._frameNum%this._sampleCount;return this.updateUniforms(e),this._frameNum++,this.isSupersampled()&&(this._isSupersampling=!1),this._isFakeSupersampling=!1,this._isSupersampling},update:function(e,t){if(!this._switch)return!0;var i=t.getFrameStamp().getFrameNumber();return this._lastUpdateFrame===i||(this._lastUpdateFrame=i,!this._postProcess&&(this._postProcess=this._viewer.getFeatures().postProcess,!this._postProcess)||(this.updateFrame()&&n.a.drawSameFrame(),!0))},isSupersampled:function(){return this._frameNum>=this._sampleCount},isEnabled:function(){return this._isSupersampling},isFakeEnabled:function(){return this._isFakeSupersampling},forceEnable:function(){this._isSupersampling=!0,this._jitter[0]=0,this._jitter[1]=0,this._jitter[2]=2*Math.sign(this._jitter[2]),this._jitter[3]=0,this._frameNum=1,n.a.drawSameFrame()},enable:function(){if(!this.canBeEnabled())return this._isFakeSupersampling||n.a.drawSameFrame(),void(this._isFakeSupersampling=!0);1===this._frameNum&&this.forceEnable()},reset:function(){this._jitter[2]=Math.sign(this._jitter[2]),this._frameNum=1,this._isSupersampling=!1,this._isFakeSupersampling=!1},setRoot:function(e){var t=new s.Node;e.addChild(t),t.addUpdateCallback(l.instance)}}),t.a=l},function(e,t,i){"use strict";var r=i(5),a=i(0),n=(i.n(a),i(1372)),o=i(136),s=r.a.osg,u=function(e,t,i){return Math.max(t,Math.min(i,e))},l=function(e){var t=e.materials;for(var i in t){var r=t[i];"object"==typeof r?void 0===r.stateSetID?delete t[r.id]:Object(n.a)(r):delete t[i]}},c=function(e){if(e.orientation.axis){var t=e.orientation.axis;t=s.vec3.fromValues(u(t[0],0,3),u(t[1],0,3),u(t[2],0,3)),delete e.orientation.axis,t[0]=(4-t[0])%4,t[1]=(4-t[1])%4,t[2]=(4-t[2])%4,e.orientation.matrix=s.mat4.fromRotation(s.mat4.create(),.5*Math.PI*(t[0]+t[1]+t[2]),t)}},h=function(e){if(e.animation){var t=e.animation.autoplay;void 0!==e.animation.autoplay&&(e.animation.initializeWithRestPose=!t,delete e.animation.autoplay)}},d=function(e){switch(e.shading.type){case"lit":case"matcap":case"shadeless":break;case"blending":case"default":case"default-shading":case"predefined-shading":case"shading":case void 0:e.shading.type="lit";break;default:case"no-shading":e.shading.type="shadeless"}e.shading.vertexColor||"pbr"!==e.shading.renderer||(e.shading.vertexColor={enable:!1,colorSpace:"linear"})},p=function(e){var t=e.environment;void 0!==t.exposure&&(t.exposure*=void 0!==t.light&&t.light>0?t.light:1);var i=t.backgroundEnable;void 0!==i&&!0===t.enable?e.background.enable=!0===i?"environment":!0===e.background.enable?"fixed":"none":void 0!==e.background.enable&&(!0===e.background.enable?e.background.enable="fixed":!1===e.background.enable&&(e.background.enable="none"))},f=function(e){if(e.lighting.lights)for(var t=e.lighting.lights,i=e.version,r=0,a=t.length;r<a;++r){var n=t[r];n.hardness=Math.max(Math.min(n.hardness,1),0),(void 0===n.castShadows||i<1&&n.attachedToCamera)&&(n.castShadows=!1)}else e.lighting={}},m=function(e){var t=e.scene&&e.scene.postProcess;if(t){var i=t.ssao;2===e.version&&t.enable&&i&&i.enable&&0===i.bias&&0===i.radius&&(i.ssaoBias=-1,i.ssaoRadius=-1,e.vr.scale=-1);var r=t.vignette;if(r&&r.lens){var a=r.lens;r.amount=1-.5*(a[0]+a[1]),r.hardness=1-.5*(a[0]-a[1]),delete r.lens}}},g=function(e){var t=e.vr;t&&t.scale&&(t.worldFactor=t.scale)},_=function(e){var t=e.camera,i=e.scene;t&&i&&(i.fov&&(t.fov=i.fov,delete i.fov),i.nearFarRatio&&(t.nearFarRatio=i.nearFarRatio,delete i.nearFarRatio))},v=function(e,t){if("object"!=typeof e)return void(t.textLog+=JSON.stringify(e));t.textLog+=" { ";for(var i in e){t.textLog+=i+": ";var r=e[i];void 0!==r?(v(r,t),t.textLog+=", "):t.textError+="\n "+i+"=> "+t.textLog.substring(Math.max(0,t.textLog.length-125),t.textLog.length)+" <= err"}t.textLog+=" } "},b=function(e){var t={textLog:"",textError:""};v(e,t),0!==t.textError.length&&o.a.client.captureMessage("Invalid CloneDeepWith: "+t.textError)},y=function(e,t){return h(e),_(e),c(e),d(e),p(e),l(e),f(e),m(e),g(e),t?e:Object(a.cloneDeepWith)(e,function(t){if(void 0===t&&b(e),t.byteLength)return Array.prototype.slice.call(t)})},x=function(e){var t=e.toJSON();return void 0===e.get("vertexCount")&&e.set("vertexCount",t.nbVertexes),void 0===e.get("faceCount")&&e.set("faceCount",t.nbTriangles),void 0===t.options&&(t.options={}),e.set("options",y(t.options,!0)),e.set("files",t.files),e};x.readOptions=y,t.a=x},function(e,t,i){"use strict";var r=i(5),a=i(0),n=(i.n(a),i(113)),o=r.a.osg,s=Object(a.invert)(o.Texture),u=["magFilter","minFilter","wrapS","wrapT","textureTarget","internalFormat"],l=["NormalMap","SubsurfaceScattering","Opacity","Displacement","BumpMap","AOPBR","CavityPBR","MetalnessPBR","GlossinessPBR","RoughnessPBR","SpecularF0","SpecularHardness"],c=function(e){e.image&&(e.url=e.image,delete e.image);for(var t=0,i=u.length;t<i;++t){var r=u[t];"number"==typeof e[r]&&(e[r]=s[e[r]])}void 0===e.texCoordUnit?e.texCoordUnit=0:"string"==typeof e.texCoordUnit&&(e.texCoordUnit=parseInt(e.texCoordUnit,10)),e.format&&delete e.format},h=function(e){return Math.max(0,Math.min(1,e))},d=function(e,t,i){if(void 0!==e.factor){var r=0,a=1;i<=2&&("Opacity"===t?"alphaMask"===e.type?r=.01:"alphaBlend"===e.type&&e.factor>=.99&&(e.factor=1):e.factor<.01&&(e.factor=0)),"BumpMap"===t||"EmitColor"===t?a=10:"SpecularHardness"===t?a=1e4:"Displacement"!==t&&"SubsurfaceScattering"!==t||(a=1e15),e.factor=Math.max(r,Math.min(a,e.factor))}if(e.color)if(l.indexOf(t)>=0)delete e.color;else{var s=e.color;e.color=o.vec3.fromValues(h(s[0]),h(s[1]),h(s[2]))}void 0===e.enable&&(e.enable=!0);var u=e.texture;if(u){c(u);var d=n.a.getPossibleFormat(t);if(!u.internalFormat||1===Object.keys(d).length)return void(u.internalFormat=n.a.getDefaultFormatString(t));d[u.internalFormat]||(d.ALPHA?u.internalFormat="ALPHA":d.RGB?u.internalFormat="RGB":u.internalFormat="LUMINANCE")}},p=function(e){var t=e.channels;t.Geometry&&(t.NormalMap=t.Geometry,delete t.Geometry),t.Reflection&&(void 0===e.reflection&&(e.reflection=t.Reflection.factor),delete t.Reflection),e.cullFace||e.cullFaceMode&&(e.cullFace=e.cullFaceMode,delete e.cullFaceMode),e.depthCheckMode&&(t.Opacity&&!t.Opacity.type&&(t.Opacity.type="alphaBlend"),delete e.depthCheckMode);var i=e.version||0;if(t)for(var r in t)d(t[r],r,i)};t.a=p},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(5)),n=i(47),o=i(34),s=i(612),u=i(59),l=i(879),c=i(1374),h=i(43),d=i(57),p=i(16),f=i(153),m=i(70),g=i(1375),_=i(615),v=i(146),b=i(556),y=i(445),x=i(664),S=i(79),M=i(572),w=i(119),T=i(458),C=i(63),E=i(6),L=i(145),P=i(37),A=a.a.osg,D=function(e,t){this._viewerWebGL=e,this._viewerOSGJS=e.getViewerOSGJS(),this._urlOptions=e.options,this._features=e.getFeatures(),this._context=t,this._canvas=e.getCanvas(),this._nodeGizmo=null,Object(T.a)(this)};D.prototype={getFeatures:function(){return this._features},getCanvas:function(){return this._canvas},getViewerWebGL:function(){return this._viewerWebGL},getViewerOSGJS:function(){return this._viewerOSGJS},getRootModel:function(){return this._viewerWebGL.getRootModel()},getWorldNode:function(){return this._features.autospin.getNode()},getTextureDepth:function(){return this._features.postProcess.getCamera()._textureDepth},getViewport3d:function(){return this._features.postProcess.getCamera().getViewport()},getIconScaleFov:function(e){if(!e){e=this._viewerOSGJS.getCamera().getProjectionMatrix()}var t=Math.sqrt(e[0]*e[0]+e[4]*e[4]+e[8]*e[8]);return.02*this.getViewport3d().width()*t/y.a.getPixelRatio()[0]},getResourceManager:function(){return this._resourceManager||u.default.instance},getCurrentTabName:function(){if(this._urlOptions.widgetAPI)return this._urlOptions.widgetAPI.getTabbedWidget().get()},getTargetAndEyeFocusFromBound:function(e,t,i){if(!e.valid())return!1;var r=this._viewerOSGJS.getManipulator(),a=r.getCurrentManipulator().getHomeBoundingSphere();a.volume()<e.volume()&&(e=a),A.vec3.copy(t,e.center(t));var n=r.getHomeDistance(e);return r.getEyePosition(i),A.vec3.sub(i,t,i),i[2]=0,A.vec3.normalize(i,i),A.vec3.scale(i,i,n),A.vec3.sub(i,t,i),!0},focusOnBound:function(){var e=A.vec3.create(),t=A.vec3.create();return function(i,r,a){return!!this.getTargetAndEyeFocusFromBound(i,e,t)&&this.focusOnTargetAndEye(e,t,r,a)}}(),focusOnTargetAndEye:function(){var e=A.vec3.create();return function(t,i,r,a){var n=this._features.camera;if(!n)return!1;var o=this._viewerOSGJS.getManipulator();if(!r||r<0)return o.setTargetAndEye(t,i),!0;var s=n.getModel();return t||(t=o.getTarget(e)),i||(i=o.getEyePosition(e)),s.setTargetAndEye(t,i,a),s.set("animationDuration",r),!0}}(),focusOnHomePosition:function(e){var t=this._features,i=t.camera;if(i&&i.getModel()){var r=i.getManipulator().getCurrentManipulator(),a=r.getHomeBoundingSphere(),n=a.center(),o=r.getEyePosition(A.vec3.create());A.vec3.sub(o,n,o),A.vec3.normalize(o,o),A.vec3.scale(o,o,r.getHomeDistance(a)),A.vec3.sub(o,n,o),this.focusOnTargetAndEye(n,o,e)}},focusOnSavedCamera:function(e){var t=this._context.getModel().get("options"),i=Object(p.a)(),r=this._viewerOSGJS.getManipulator(),a=i.cameraTarget||t.camera.target,n=i.cameraEye||t.camera.position,o=n&&null!==n[0];return o?o&&!this._features.camera.getModel().validateEyeTarget(n,a)?r.computeHomePosition():void this.focusOnTargetAndEye(a,n,e):r.computeHomePosition()},updateFocusOnAutoHit:function(){if(!this._autoHit.get("focus"))return!0;var e=Object(T.d)(this._autoHit),t=this._features.camera.getManipulator().getCurrentManipulator(),i=t.getEyePosition(A.vec3.create()),r=t.getTarget(A.vec3.create()),a=A.vec3.create(),n=A.vec3.create();return 1===Object(p.a)().cameraFollowBones?(A.vec3.sub(n,e,r),A.vec3.add(a,i,n),A.vec3.copy(n,e)):(A.vec3.sub(a,e,i),A.vec3.normalize(a,a),A.vec3.scale(a,a,A.vec3.dist(i,r)),A.vec3.sub(a,e,a),A.vec3.copy(n,e)),A.vec3.lerp(n,r,n,.25),A.vec3.lerp(a,i,a,.25),this.focusOnTargetAndEye(n,a,0),!0},setInitialAnimation:function(){var e=this._features.camera;if(e){if(!e.getModel().shouldPlayFirstCameraAnimation())return void o.a.resolveFirstCameraAnimation();var t=A.vec3.create(),i=A.vec3.create(),r=this._viewerOSGJS.getManipulator();r.getEyePosition(i),r.getTarget(t);var a=[t[0]-i[0],t[1]-i[1],0],n=a[0]>a[1]?0:1,s=0===n?1:0,u=A.vec3.create();u[s]=1;var l=a[n]<0?-1:1;u[2]=.2*l;var c=1.5*S.a.getModelBoxWithDisplacement().radius();A.vec3.scale(u,u,10*c*l);var h=A.vec3.add(A.vec3.create(),i,u);r.setEyePosition(h),this.focusOnTargetAndEye(t,i,2.5);var d=this._features.autospin;if(d){var p=d.getModel();p.set("speed",-p.get("speed")*l)}}},focusOnHit:function(e,t,i){var r=A.vec3.create();w.a.getWorldPositionFromHit(e,r);var a=this._features.camera.getManipulator().getCurrentManipulator(),n=a.getEyePosition(A.vec3.create()),o=a.getHomeDistance(a.getHomeBoundingSphere()),s=A.vec3.dist(r,n),u=i*o;s>u&&(A.vec3.sub(n,r,n),A.vec3.normalize(n,n),A.vec3.scale(n,n,u),A.vec3.sub(n,r,n)),this.focusOnTargetAndEye(r,n,t,!0)},onSingleClick:function(){var e=A.vec3.create(),t=A.vec3.create(),i=A.vec2.create();return function(r){var a=r.canvasX,n=r.canvasY,o="materials"===this.getCurrentTabName(),s=this._features.inspector.getModel(),u="split"===s.get("splitType")||o,l=this._features.postProcess.getModel(),c=l.get("enable")&&l.get("dofEnable"),h=this._viewerWebGL.getViewerAPI(),d=h&&h.intersectPoint||c||u,p=this._features.ARKit.getModel();if(p.get("enable")&&p.trigger("pick",A.vec2.fromValues(a,n)),d){var f=w.a.computeNearestIntersection2D(a,n);if(u&&this._singleClickOnInspector(f),f){var m=c?l.get("dofFocusPoint"):t,g=h&&h.intersectPoint?e:void 0;w.a.getWorldPositionFromHit(f,m,g),h&&h.intersectPoint&&(i[0]=a,i[1]=n,h.intersectPoint(f,m,i,g)),c&&l.trigger("change:dofFocusPoint",m)}}}}(),_singleClickOnInspector:function(e){var t=e&&w.a.getMaterialFromHit(e);if(!t)return void this._features.outline.getModel().trigger("hideOutline");var i=this._features.inspector.getModel(),r=t.get("id");i.get("material")===r?i.trigger("change:material",i,r):i.set("material",r)},onDoubleClick:function(e){if(Object(p.a)().doubleClick){var t=this._features.camera;if(!t.getModel().get("webVR")&&t.canMoveTarget()){if(this._autoHit&&this._autoHit.get("focus")&&this._autoHit.set("focus",!1),e.pointers&&e.pointers.length>1)return void this.focusOnHomePosition(1);var i=w.a.computeNearestIntersection2D(e.canvasX,e.canvasY);if(!i)return void this.focusOnHomePosition(1);var r=this.getCurrentTabName();if("virtual reality"===r)return void this._features.webVR.getModel().trigger("doubleTap",i);"annotations"!==r&&"sound"!==r&&(Object(p.a)().cameraFollowBones&&Object(s.a)(i._nodePath)?(this._features.hotspot.getModel().updateHotspotHit(this._autoHit,i),this._autoHit.set("focus",!0)):(this._features.outline.getModel().trigger("clearFocusTimeout"),this.focusOnHit(i,1,.2)))}}},preloadMaxBackground:function(){var e=this._features.background;if(e){var t=e.getModel();if(t&&"fixed"===t.get("enable")){var i=t.getBackground();if(i){var r=i.findImageNearestUpToResolution(window.screen.width,window.screen.height);r&&this.getResourceManager().getOrCreateTexture(r.url,{minFilter:A.Texture.LINEAR,magFilter:A.Texture.LINEAR,transferToGPU:!1,convertNPOT:!1,internalFormat:A.Texture.RGB})}}}},applyAutospinToCamera:function(e,t){var i=this._features.autospin;if(i){var r=i.getNode().getMatrix();A.vec3.transformMat4(e,e,r),A.vec3.transformMat4(t,t,r)}},getCameraWithoutAutospin:function(){var e=A.mat4.create();return function(t,i){var r=this._viewerOSGJS.getManipulator();r.getEyePosition(t),r.getTarget(i);var a=this._features.autospin;a&&(A.mat4.invert(e,a.getNode().getMatrix()),A.vec3.transformMat4(t,t,e),A.vec3.transformMat4(i,i,e))}}(),createGizmoNode:function(){var e=new A.Camera;e.getOrCreateStateSet().setRenderBinDetails(d.a.EDITOR_GIZMO,"RenderBin");var t=this._nodeGizmo=new l.a(this._viewerOSGJS);t.setTraversalMask(h.a.PICK_GIZMO_LIGHT),e.addChild(t);var i=this._urlOptions.widgetAPI;if(i){var r=this._features.orientation;i.getTabbedWidget().model.on("change:value",function(){t.attachToNode(null),r&&r.getModel().set("showGizmo",!1)})}return e},setManipulatorNode:function(e){this._features.camera?this._features.camera.getModel().set("node",e):this._viewerOSGJS.getManipulator().setNode(e)},getNodeGizmo:function(){return this._nodeGizmo},initializePreciseBoundManager:function(){var e=this.getWorldNode();S.a.computePreciseBox(e);var t=S.a.getModelBoxWithDisplacement();e.getBoundingBox().copy(t);var i=e.getBoundingSphere();i.set(t.center(i.center()),t.radius())},initGraph:function(e){var t=this._features,i=new A.Node;i.getOrCreateStateSet().setAttributeAndModes(C.a.CULL_DISABLE),i.setName("FeatureManager - Root"),i.addChild(b.a);var r=t.orientation,a=t.autospin,n=t.outline,o=t.environment,s=t.lighting,u=t.camera,l=t.sound,c=t.hotspot,h=t.postProcess,d=t.webVR,p=t.ARKit,f=t.inspector,m=s.getNodeShadow(),g=i;h&&(i.addChild(h.getNodeIn()),g=h.getNodeOut()),g.addChild(this.createGizmoNode(g)),g.addChild(m),g=m;for(var _=[u,o,s,l,d,c,f,n,a,p,r],v=0,y=_.length;v<y;++v){var x=_[v];if(x){var S=x.getNodeIn?x.getNodeIn():x.getNode(),M=x.getNodeOut?x.getNodeOut():x.getNode();g.addChild(S),g=M}}return g.addChild(e),i},addGlobalUniforms:function(){var e=this._features.postProcess,t=e.getNodeIn().getOrCreateStateSet();for(var i in v.a)t.addUniform(v.a[i])},finished:function(e){var t=this._features,i=this.getRootModel();i.setNodeMask(h.a.PICK_GEOMETRY_SHADOW),i.setName("rootModel");var r=this._viewerOSGJS.getCamera();M.a.setCamera(r),i.addUpdateCallback(M.a);var a=this.initGraph(i);e.addChild(a),this.setManipulatorNode(this.getWorldNode()),this.preloadMaxBackground();var s=t.lighting;s&&s.getModel().initLights(t.material.getSceneLights());var u=t.environment;u&&u.getNode().init(r,s.getNodeShadow());var l=E.a.me(),d=l.isAuthenticated()&&l.get("isStaff")?51:65;if(window.sketchfabViewerStats.shadows>2&&A.WebGLCaps.instance().getWebGLParameter("MAX_FRAGMENT_UNIFORM_VECTORS")<d)for(var f=s.getModel().get("lights"),v=2,b=2;b>=0&&0!==v;b--){var S=f[b];S.get("enable")&&S.isCastingShadows()&&(S.set("castShadows",!1),v--)}return w.a.init(this._context,this._features,this._viewerOSGJS,i),y.a.init(this._canvas,this._features.quality.getModel(),this._viewerOSGJS.getCanvasPixelRatio()),this.focusOnSavedCamera(),this._features.camera&&this._features.camera.getModel().saveCameraPosition(),L.a.initGlobalClickEvents(this,this._canvas),this._viewerOSGJS.getInputManager().setEnable("global_click_events",!0),i.getOrCreateStateSet().setAttribute(new _.a),Object(p.a)().zz?(i.accept(new g.a),o.a.getWireframeOptimizedSplit().then(function(){i.accept(new g.a),o.a.resolveWireframeOptimizedSplitCompressed()})):o.a.getWireframeOptimizedSplit().then(o.a.resolveWireframeOptimizedSplitCompressed),this.addGlobalUniforms(),A.time("drawFirstFrame"),this._viewerWebGL.drawFrame(),A.timeEnd("drawFirstFrame"),this.initializePreciseBoundManager(),t.webVR&&t.webVR.getModel().initAfterFirstFrame(),t.postProcess&&t.postProcess.getModel().initAfterFirstFrame(),t.camera&&t.camera.getModel().initAfterFirstFrame(),t.lighting&&t.lighting.getModel().set("forceShadowRedraw",!0),A.time("drawSecondFrame"),this._viewerWebGL.drawFrame(),A.timeEnd("drawSecondFrame"),t.lighting&&t.lighting.getModel().set("forceShadowRedraw",!1),Object(n.a)()&&(o.a.getFirstAnimation().then(function(){this.registerOptionsJSON(this._viewerWebGL.getOptionsJSON())}.bind(this)),window.addEventListener("beforeunload",this.onBeforeUnload.bind(this),!1)),!Object(m.a)()&&"onhashchange"in window&&window.addEventListener("hashchange",this._hashChanged.bind(this),!1),Object(p.a)().debug3D&&Object(c.a)(this,a),Object(p.a)().cameraFollowBones&&(this._autoHit=new x.a,a.addUpdateCallback({update:this.updateFocusOnAutoHit.bind(this)})),a},_registerCollection:function(e){e.each(function(e){e.registerOptions()})},registerOptionsJSON:function(e){this._lastOptions=Object(r.cloneDeep)(e);var t=this._features;this._registerCollection(t.animation.getModel().get("animations")),this._registerCollection(t.hotspot.getModel().get("hotspots"))},getUnsavedChanges:function(){var e=this._viewerWebGL.getOptionsJSON();return Object(r.reduce)(this._lastOptions,function(t,i,a){return Object(r.isEqual)(i,e[a])?t:t.concat(a)},[])},getUnsavedMessage:function(){var e=this.getUnsavedChanges();if(0!==e.length){var t="You have unsaved changes:\n";return t+="- "+e.join("\n- "),t+="\n\nYou might want to save your changes before leaving."}},onBeforeUnload:function(e){var t=this.getUnsavedMessage();return t&&(e.returnValue=t),t},_hashChanged:function(){var e={};e=Object(f.a)(e),this._features.material.getModel().overrideMaterialChannels(e);var t=Object(p.a)();!t.debug3D&&Boolean(e.debug3D)&&(t.debug3D=!0,Object(c.a)(this,this.getRootModel())),!t.stats&&Boolean(e.stats)&&(t.continuousRender=!0,t.stats=!0,this._viewerOSGJS.initStats({getBoolean:function(e){return"stats"===e}}))},getShadowForcedUpdate:function(){return!!Object(p.a)().shadow&&(!!P.a.getShadowForcedUpdate()||(!!this._viewerWebGL.getSuperSample().isEnabled()||(!!this._features.lighting.getModel().get("forceShadowRedraw")||(!!this._features.autospin.getModel().get("enable")||!!this._features.animation.getModel().isPlaying()))))}},t.a=D},function(e,t,i){"use strict";var r=i(0),a=(i.n(r),i(3)),n=i.n(a),o=i(5),s=i(34),u=i(879),l=i(37),c=i(57),h=i(855),d=i(878),p=i(119),f=i(63),m=i(873),g=i(615),_=i(145),v=i(78),b=o.a.osg,y=o.a.osgAnimation,x=o.a.osgUtil,S=b.StateAttribute.OVERRIDE_ON,M=function(){b.NodeVisitor.call(this,b.NodeVisitor.TRAVERSE_PARENTS),this._paths=[],this._halt=void 0};b.createPrototypeObject(M,b.objectInherit(b.NodeVisitor.prototype,{reset:function(){b.NodeVisitor.prototype.reset.call(this),this._paths.length=0},setHalt:function(e){this._halt=e},apply:function(e){e===this._halt&&this._paths.push(this.nodePath.slice(1)),this.traverse(e)}}));var w=function(e){b.NodeVisitor.call(this),this._cullCallback=e?void 0:h.a.hideCullCallback};b.createPrototypeObject(w,b.objectInherit(b.NodeVisitor.prototype,{apply:function(e){e instanceof b.Geometry&&e._isBoneBox&&e.setCullCallback(this._cullCallback),this.traverse(e)}}));var T=function(){var e=x.DisplayGeometryVisitor.prototype.apply;x.DisplayGeometryVisitor.prototype.apply=function(t){if(!t._isBoneBox&&!t._isSkeleton){e.apply(this,arguments);var i=t._originalStateSet;void 0!==i&&t.getStateSet()&&i!==t.getStateSet()&&t.getStateSet().setRenderBinDetails(c.a.DEBUG,"RenderBin")}}},C=function(e){var t=Object(r.invert)(c.a);e._graphRender.generateRenderBin=function(e,i){var r=i.className()+" ( "+i.getInstanceID()+" )";i.getName()&&(r+="\n"+i.getName());var a=i.getBinNumber();r+="\n"+t[a]||a,this._selectables.set(i.getInstanceID().toString(),i),e.addNode(i.getInstanceID(),{label:r,description:"",style:"fill: "+this.getColorFromClassName(i.className())+";stroke-width: 0px;"})}},E=function(){var e=y.UpdateMorph.prototype.updateWeights;y.UpdateMorph.prototype.updateWeights=function(){if(void 0!==this._debugActiveTarget){var t=parseInt(this._debugActiveTarget,0);if(-2===t){var i=this._weights;return void(i[0]=i[1]=i[2]=i[3]=0)}if(-1!==t)for(var r=this._targets,a=0,n=r.length;a<n;++a)r[a].value=a===t?1:0}return e.call(this)}},L=function(e,t){var i=function(){b.NodeVisitor.call(this,b.NodeVisitor.TRAVERSE_ALL_CHILDREN)};b.createPrototypeObject(i,b.objectInherit(b.NodeVisitor.prototype,{apply:function(t){for(var i=t.getUpdateCallbackList(),r=0,a=i.length;r<a;++r){var n=i[r];if(n instanceof y.UpdateMorph){var o={};o.___DEFAULT=-1,o["___NO MORPH"]=-2;for(var s=n._targetNames,u=0,c=s.length;u<c;++u)o[s[u]]=u;n._debugActiveTarget=-1;e.add(n,"_debugActiveTarget",o).name("Name "+n.getName()).onChange(l.a.draw)}}this.traverse(t)}}));var r=new i;t._rootModel.accept(r)},P=function(){h.a.DrawBones.prototype.apply=function(e){var t=e.getInstanceID();this._visitedNodes[t]||(this._visitedNodes[t]=!0,e instanceof y.Bone&&this.drawBone(e),this.traverse(e))}},A=function(e,t){this._fManager=e,this._viewerWebGL=e.getViewerWebGL(),this._rootModel=this._viewerWebGL.getRootModel(),this._rootFeature=t,this._debugNormal=!1,this._debugTangent=!1,this._debugScale=.5,this._baseScale=.07*this._rootModel.getMinimumBound().radius(),this._normalVisitor=new m.a,this._normalVisitor.setScale(this._baseScale*this._debugScale),this._geoColorVisitor=new x.DisplayGeometryVisitor,this._geoColorVisitor._stCenter.setRenderBinDetails(c.a.DEBUG_2,"RenderBin"),this._geoColorVisitor._stCenter.setAttribute(new g.a(!0)),T(),this._debugGeometry=!1,this._debugSkinning=!1,this._debugShadow=!1,this._useGizmo=!1,this._useSync=!1,this._protoUpdateWeights=y.UpdateMorph.prototype.updateWeights,this._protoComputeChannels=y.UpdateMatrixTransform.prototype.computeChannels,this._enableRig=!0,this._collectPathVisitor=new M,this._collectPathVisitor.setHalt(this._fManager.getWorldNode()),this._drawBonesVisitor=new h.a.DrawBones([]),P(),this._showSkeleton=!1,this._showBoneBoxes=!1,this._graphVisitor=x.DisplayGraph.instance(),C(this._graphVisitor),this._debugGraphNode="Model",this._debugGraphRenderer=!1,this._displayGraph=!1;var i=this._fManager.getFeatures().camera.getModel();this._enabledConstraints=i.get("enableCameraConstraints"),this._showConstraintsWidget=!1,_.a.initDebug3D(this)};A.prototype={_getSaveAElement:function(){return this._aSave?this._aSave:(this._aSave=document.createElement("a"),document.body.appendChild(this._aSave),this._aSave.style.display="none",this._aSave)},_download:function(e,t){var i=this._fManager._context.getModel("uid").get("uid")+"_";i+=(new Date).toString().split(" ").splice(1,4).join("_").replace(/:/g,"_"),i+=".";var r=this._getSaveAElement();r.href=e,r.download=i+t,r.click()},_getCameraModel:function(){return this._fManager.getFeatures().camera.getModel()},onTakeScreenShot:function(){Object(d.a)(2048,2048,this._viewerWebGL).toBlob(function(e){this._download(URL.createObjectURL(e),"png")}.bind(this),"png",1)},onStartMovieRecord:function(){var e=document.getElementsByClassName("canvas")[0],t=e.captureStream(25),i={mimeType:"video/webm; codecs=vp9"};this._recorder=new window.MediaRecorder(t,i);var r=[],a=function(e){var t=window.URL.createObjectURL(e);this._download(t,"webm")}.bind(this);this._recorder.ondataavailable=function(e){e.data&&e.data.size>0&&r.push(e.data)},this._recorder.onstop=function(){a(new Blob(r,{type:"video/webm"}))}.bind(this),this._recorder.start()},onEndMovieRecord:function(){this._recorder&&this._recorder.stop()},onTrianglePick:function(e){if(!this._displayGraph){var t=p.a.computeNearestIntersection2D(e.canvasX,e.canvasY);if(t){window.hit=t;var i=t._nodePath[t._nodePath.length-1];console.log("Active hit : window.hit"),console.log("Name geometry : "+i.getName()),console.log("Vertex indices : "+t._i1+", "+t._i2+", "+t._i3),console.log("Unique id : "+i._uniqueID);var r={};r[t._i1]={},r[t._i2]={},r[t._i3]={};var a=i.getVertexAttributeList();for(var n in r){var o=r[n];n=parseInt(n);for(var s in a)for(var u=a[s],l=u.getItemSize(),c=u.getElements(),h=o[s]=[],d=0;d<l;++d)h[d]=c[n*l+d]}t.verts=r,console.log("\n")}}},onDebugScale:function(e){this._normalVisitor.setScale(this._baseScale*e),l.a.draw()},testCreateNormalVisitor:function(){this._normalVisitor._alreadyRun||(this._normalVisitor._alreadyRun=!0,this._normalVisitor.apply(this._rootModel))},onDebugNormal:function(e){this.testCreateNormalVisitor(),this._normalVisitor.setNormalVisibility(e),l.a.draw()},onDebugTangent:function(e){this.testCreateNormalVisitor(),this._normalVisitor.setTangentVisibility(e),l.a.draw()},onDebugGeometry:function(){this._debugGeometry?this._geoColorVisitor.setGeometryDebug(this._rootModel):this._debugSkinning?this._geoColorVisitor.setSkinningDebug(this._rootModel):this._geoColorVisitor.disableDebug(this._rootModel),l.a.draw()},onEnableCamConstraints:function(){var e=this._getCameraModel();e.set("enableCameraConstraints",!e.get("enableCameraConstraints"))},onShowConstraintsWidget:function(){var e=this._getCameraModel();e.set("displayGizmo",!e.get("displayGizmo")),e.trigger("refreshConstraints"),l.a.draw()},resetGraph:function(){this._viewerWebGL.getInputManager().setEnable(v.a.DEBUG_GEOMPICK,!1),this._graphVisitor.reset()},onDisplayGraph:function(){this.resetGraph(),this._displayGraph&&(this._viewerWebGL.getInputManager().setEnable(v.a.DEBUG_GEOMPICK,!0),s.a.getModelDisplayed().then(this.createDebugGraph.bind(this)))},createDebugGraph:function(){var e;"Model"===this._debugGraphNode?e=this._rootModel:"Feature"===this._debugGraphNode&&(e=this._rootFeature),this._graphVisitor.setDisplayGraphRenderer(this._debugGraphRenderer),this._graphVisitor.createGraph(e),this._graphVisitor.setCallbackSelect(this.onNodeSelect.bind(this)),l.a.draw()},onDebugShadow:function(e){var t=this._fManager.getFeatures().lighting;if(t){t.getModel().set("forceShadowRedraw",e);for(var i=t.getModel().get("lights"),r=0,a=i.length;r<a;++r){var n=i[r];n.getShadowMap()&&(n.getShadowMap().setDebug(e),n.dirty())}l.a.draw()}},onPickSelect:function(e){var t=this._fManager.getWorldNode(),i=p.a.computeNearestIntersection2D(e.glX,e.glY,void 0,t);i&&(this._graphVisitor.selectNode(i._nodePath[i._nodePath.length-1]),this._graphVisitor.focusOnGraph())},onNodeSelect:function(e){if(e instanceof b.StateSet){var t=this._fManager.getFeatures().outline.getModel();return t.set("durationOutline",5),t.set("durationHighlight",2.5),void t.trigger("displayOutlineFocus",e,5,2.5)}for(var i=e.getBoundingBox(),r=e.getWorldMatrices(this._fManager.getWorldNode()),a=new b.BoundingBox,n=0;n<r.length;++n){var o=new b.BoundingBox;i.transformMat4(o,r[n]),a.expandByBoundingBox(o)}this._fManager.focusOnBound(a,1),this._collectPathVisitor.reset(),e.accept(this._collectPathVisitor);var s=this._collectPathVisitor._paths,u=this._fManager.getFeatures().outline.getNode();u.clearOutlineScene(),u.addPaths(s),u.showOutline()},_getCameraUrl:function(){var e=b.vec3.create(),t=b.vec3.create();this._fManager.getCameraWithoutAutospin(e,t);var i=window.location.href;return i+="&camera_eye="+e.join(",")+"&camera_target="+t.join(",")},cameraClipboard:function(){var e=this._getCameraUrl(),t=document.createTextNode(e);document.body.appendChild(t);var i=document.createRange();i.selectNode(t),window.getSelection().removeAllRanges(),window.getSelection().addRange(i),document.execCommand("copy"),document.body.removeChild(t)},cameraOpen:function(){window.open(this._getCameraUrl())},onEnableRig:function(e){y.UpdateMatrixTransform.prototype.computeChannels=e?this._protoComputeChannels:function(){this._dirty=!0;var e=this._matrix;b.mat4.identity(e);for(var t=this._stackedTransforms,i=0,r=t.length;i<r;i++){var a=t[i];a.resetToDefaultValue(),a.applyToMatrix(e)}},l.a.draw()},onShowSkeleton:function(e){l.a.draw();var t=this._drawBonesVisitor;if(!e)return void t._geoStateSet.setAttributeAndModes(f.a.DEPTH_NEVER,S);t._geoStateSet.setAttributeAndModes(f.a.DEPTH_ALWAYS,S),t._alreadyRun||(t._alreadyRun=!0,this._rootModel.accept(t))},onShowBoneBoxes:function(e){this._rootModel.accept(new w(e)),l.a.draw()},onUseGizmo:function(e){this._gizmo||(this._gizmo=new u.a(this._fManager.getViewerOSGJS()),this._rootFeature.addChild(this._gizmo)),this._gizmo.attachToNode(null),this._gizmo.setAutoMatrixTransformInsertion(e),this._gizmo.setCorrectPivotOnAutoInsert(e),this._gizmo.setTraversalMask(e?1:0),l.a.draw()}};var D=function(e,t,i){var r=e.addFolder("Debug graph"),a={Model:"Model",Feature:"Feature",None:"None"};return i._graphNode=r.add(t,"_debugGraphNode",a).name("Root"),i._graphNode.onChange(t.onDisplayGraph.bind(t)),i._graphRenderer=r.add(t,"_debugGraphRenderer").name("Renderer"),i._graphRenderer.onChange(t.onDisplayGraph.bind(t)),i._displayGraph=r.add(t,"_displayGraph").name("Display graph"),i._displayGraph.onChange(t.onDisplayGraph.bind(t)),r.open(),r},O=function(e,t,i){var r=e.addFolder("Display vectors");return i._showNormal=r.add(t,"_debugNormal").name("Display normal"),i._showNormal.onChange(t.onDebugNormal.bind(t)),i._showTangent=r.add(t,"_debugTangent").name("Display tangent"),i._showTangent.onChange(t.onDebugTangent.bind(t)),i._vectorScale=r.add(t,"_debugScale").min(0).max(2).name("Scale vectors"),i._vectorScale.onChange(t.onDebugScale.bind(t)),r.open(),r},k=function(e,t,i){var r=e.addFolder("Animation");return i._useRig=r.add(t,"_enableRig").name("Use rig"),i._useRig.onChange(t.onEnableRig.bind(t)),E(),L(r,t),i._showSkeleton=r.add(t,"_showSkeleton").name("Show skeleton"),i._showSkeleton.onChange(t.onShowSkeleton.bind(t)),i._showBoxes=r.add(t,"_showBoneBoxes").name("Show boxes"),i._showBoxes.onChange(t.onShowBoneBoxes.bind(t)),i._showSkinning=r.add(t,"_debugSkinning").name("Display skinning"),i._showSkinning.onChange(function(e){e&&t._debugGeometry&&i._showGeometry.setValue(!1),t.onDebugGeometry()}),r.open(),r},R=function(e,t,i){var r=e.addFolder("Camera");return i._enableConstraints=r.add(t,"_enabledConstraints").name("Constraints"),i._enableConstraints.onChange(t.onEnableCamConstraints.bind(t)),i._showConstraintsWidget=r.add(t,"_showConstraintsWidget").name("Show widget"),i._showConstraintsWidget.onChange(t.onShowConstraintsWidget.bind(t)),i._cameraClipboard=r.add(t,"cameraClipboard").name("Copy clipboard"),i._cameraOpen=r.add(t,"cameraOpen").name("Open new tab"),r.open(),r},I=function(e,t,i){var r=e.addFolder("Misc");return i._showGeometry=r.add(t,"_debugGeometry").name("Display geometry"),i._showGeometry.onChange(function(e){e&&t._debugSkinning&&i._showSkinning.setValue(!1),t.onDebugGeometry(),i._showSkinning.updateDisplay()}),i._gizmo=r.add(t,"_useGizmo").name("Use gizmo"),i._gizmo.onChange(t.onUseGizmo.bind(t)),r.add(t,"_debugShadow").name("Debug Shadow").onChange(t.onDebugShadow.bind(t)),r.add({ScreenShot:t.onTakeScreenShot.bind(t)},"ScreenShot"),r.add({StartRec:t.onStartMovieRecord.bind(t)},"StartRec"),r.add({StopRec:t.onEndMovieRecord.bind(t)},"StopRec"),r.open(),r},F=function(e){var t=new window.dat.GUI;t.domElement.style.paddingTop="50px";var i=new A(this,e),r={};D(t,i,r),O(t,i,r),k(t,i,r),R(t,i,r),I(t,i,r)},N=function(e,t){var i=F.bind(e,t);n.a.getScript("https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.5/dat.gui.min.js").done(i)};t.a=N},function(e,t,i){"use strict";var r=i(5),a=i(146),n=i(16),o=r.a.osg,s=r.a.osgAnimation,u=o.BufferArray.randa,l=function(e,t){return e+Math.random()*(t-e)},c=o.vec3.fromValues(l(.8,1),l(.3,.8),l(.1,.3)),h={},d=function(e,t){if(t._QVT)return e._QVT=t._QVT,void(e._QVS=t._QVS);var i=t._minMax||t.computeMinMaxVertex(h),r=o.vec3.fromValues(i.xmax-i.xmin,i.ymax-i.ymin,i.zmax-i.zmin);o.vec3.div(r,r,u),Object(n.a)().zr&&o.vec3.div(r,r,c);var a=o.vec3.fromValues(i.xmin,i.ymin,i.zmin);t._QVT=a,t._QVS=r,e._QVT=a,e._QVS=r},p=function(e,t,i){e._listQuantUV||(e._listQuantUV=[]);var r="uQUV"+i.substr(8),n=t._objQUV;if(n)return-1===e._listQuantUV.indexOf(n)&&e._listQuantUV.push(n),void(n.uniformName!==r&&e._listQuantUV.push({uniformName:r,_QUV:n._QUV}));var s=t.computeMinMaxUV(h),u=o.vec4.fromValues(s.xmin,s.ymin,s.xmax-s.xmin,s.ymax-s.ymin);t._QUV=u,n={uniformName:r,_QUV:u},t._objQUV=n,e._listQuantUV.push(n),a.a[r]||(a.a[r]=o.Uniform.createFloat4(r))},f=function(){o.ComputeBoundsVisitor.call(this),this.nodeMaskOverride=-1};o.createPrototypeObject(f,o.objectInherit(o.NodeVisitor.prototype,{apply:function(e){if(e instanceof o.Geometry==!1)return void this.traverse(e);var t=e.getSourceGeometry?e.getSourceGeometry():e,i=t instanceof s.MorphGeometry;if(!e._qcomp){e._qcomp=!0;var r=e.getVertexAttributeList();i||d(e,r.Vertex);var a=r.Normal;!i&&a&&(a._QNOR=!0);var n=r.Tangent;!i&&n&&(n._QTAN=!0);for(var u in r)u.startsWith("TexCoord")&&p(e,r[u],u)}}})),t.a=f},function(e,t,i){"use strict";var r=i(5),a=i(457),n=i(420),o=i(619),s=i(562),u=i(1377),l=i(1378),c=i(620),h=i(1379),d=i(1380),p=i(1381),f=i(1382),m=i(1383),g=i(1384),_=i(1385),v=r.a.osg,b=r.a.osgShader,y=b.ShaderGenerator,x=function(e,t){y.call(this),this.setShaderCompiler(e),this._materialHashCompiler=t||a.a.SHADING_COMPILER};v.createPrototypeObject(x,v.objectInherit(y.prototype,{getOrCreateProgram:function(e){return a.a.CURRENT_COMPILER=this._materialHashCompiler,y.prototype.getOrCreateProgram.call(this,e)}}));var S=function(e,t,i,r){e.addShaderGenerator(t,new x(i,r))},M={},w=!1;M.register=function(e){w||(w=!0,S(e,"lit-classic",n.a),S(e,"lit-pbr",o.a),S(e,"shadeless-classic",s.a),S(e,"shadeless-pbr",u.a),S(e,"matcap",l.a),S(e,"earlyz",c.a,a.a.EARLYZ_COMPILER),S(e,"shadowcast",h.a,a.a.SHADOWCAST_COMPILER),S(e,"outline",d.a,a.a.SHADOWCAST_COMPILER),S(e,"wireframe",p.a,a.a.WIREFRAME_COMPILER),S(e,"shading-vr",f.a),S(e,"shading-ar",m.a),S(e,"inspector",g.a),S(e,"skeleton",_.a))},t.a=M},function(e,t,i){"use strict";var r=i(5),a=i(619),n=i(562),o=r.a.osg,s=r.a.osgShader,u=function(){a.a.apply(this,arguments),this._isLighted=!1};s.Compiler.setStateAttributeConfig(u,s.Compiler.cloneStateAttributeConfig(n.a)),o.createPrototypeObject(u,o.objectInherit(a.a.prototype,{getCompilerName:function(){return"ShadelessPBR"},getOrCreateChannel:function(e){switch(e){case"Opacity":case"EmitColor":case"DiffusePBR":case"AlbedoPBR":case"CavityPBR":case"AOPBR":case"Displacement":return a.a.prototype.getOrCreateChannel.call(this,e)}},registerTextureEnvironment:function(){},registerTextureShadow:function(){}})),t.a=u},function(e,t,i){"use strict";var r=i(5),a=i(420),n=i(562),o=r.a.osg,s=r.a.osgShader,u=function(){a.a.apply(this,arguments),this._isLighted=!1};s.Compiler.setStateAttributeConfig(u,s.Compiler.cloneStateAttributeConfig(n.a)),o.createPrototypeObject(u,o.objectInherit(a.a.prototype,{getCompilerName:function(){return"Matcap"},getOrCreateChannel:function(e){switch(e){case"Opacity":case"NormalMap":case"BumpMap":case"Displacement":case"Matcap":return a.a.prototype.getOrCreateChannel.call(this,e)}},registerTextureEnvironment:function(){},registerTextureShadow:function(){},applyCurvature:function(e){var t=this.createVariable("float");this.getNode("InlineCode").code("%factor = %curvature / (length(%vertex.xyz) * atan(-1.0 / %projection[2][3]));").inputs({projection:this.getOrCreateUniform("mat4","uProjectionMatrix"),curvature:this.getOrCreateUniform("float","uMatcapCurvature"),vertex:this.getOrCreateViewVertex()}).outputs({factor:t});var i=this.createVariable("vec3");return this.getNode("ApplyCurvature").inputs({normal:this.getOrCreateMaterialNormal(),color:e,factor:t}).outputs({result:i}),i},getOrCreateMaterialDiffuseColor:function(){var e=this.getVariable("materialDiffuseColor");if(e)return e;e=this.createVariable("vec3","materialDiffuseColor");var t=this.getOrCreateUniform("vec3","uMatcapColor");return t=this.multiplyDiffuseWithVertexColor(t),this.getNode("SetFromNode").inputs(t).outputs(e),e},createFragmentShaderGraph:function(){var e=this.getOrCreateChannel("Matcap"),t=this.createVariable("vec3"),i=this.getOrCreateMaterialDiffuseColor();this.getNode("Mult").inputs(e,i).outputs(t);var r=this.applyCurvature(t);return this.applyRefraction({diffuse:r}),[this.getFinalFrag(r)]}})),t.a=u},function(e,t,i){"use strict";var r=i(5),a=i(620),n=r.a.osg,o=r.a.osgShader,s=r.a.osgShadow,u=s.ShadowCastCompiler,l=function(){a.a.apply(this,arguments)},c=o.Compiler.cloneStateAttributeConfig(a.a);c.attribute=["VertexCompression","SketchfabMaterial","ShadowCast","Morph","Skinning","PointSize"],o.Compiler.setStateAttributeConfig(l,c),n.createPrototypeObject(l,n.objectInherit(a.a.prototype,{getCompilerName:function(){return"ShadowCastSkfb"},getOrCreateProjectionMatrix:function(){var e=this.getVariable("jitteredProjection");if(e)return e;e=this.createVariable("mat4","jitteredProjection");var t=["%projOut = %projIn;","float doPersp = %projOut[3][3] == 0.0 ? 1.0 : 0.0;","vec2 jitter = (abs(%halton.z) == 2.0 ? 1.0 : 0.0) * (%halton.xy / %size.xy);","%projOut[2].xy += doPersp * jitter;","%projOut[3].xy += (1.0 - doPersp) * jitter;"];return this.getNode("InlineCode").code(t.join("\n")).inputs({projIn:this.getOrCreateUniform("mat4","uProjectionMatrix"),halton:this.getOrCreateUniform("vec4","uHalton"),size:this.getOrCreateUniform("vec2","uShadowMapSize"),viewVertex:this.getOrCreateViewVertex()}).outputs({projOut:e}),e},initAttributes:function(){for(var e=this._attributes,t=0,i=e.length;t<i;t++){var r=e[t].className();"Material"===r?this._material=e[t]:"ShadowCastAttribute"===r?this._shadowCastAttribute=e[t]:"Billboard"===r?this._isBillboard=!!e[t]:"SkinningAttribute"===r?this._skinningAttribute=e[t]:"MorphAttribute"===r?this._morphAttribute=e[t]:"VertexCompression"===r&&(this._vertexCompression=e[t])}},applyAlphaBlendMasking:function(e){return this.isAlphaBlendedMaterial()||this.isRefractionMaterial()?(this.getNode("InlineCode").code("if(%alpha < 1.0) discard;").inputs({alpha:this.getOrCreateChannel("Opacity")}).outputs({out:e}),e):e},createFragmentShaderGraph:function(){var e=this.getNode("glFragColor");return this.applyPointSizeCircle(e),this.applyAlphaMask(e),this.applyAlphaBlendMasking(e),u.prototype.createShadowCastDepth.call(this,e),[e]}})),t.a=l},function(e,t,i){"use strict";var r=i(5),a=i(620),n=i(562),o=r.a.osg,s=r.a.osgShader,u=function(){a.a.apply(this,arguments)};s.Compiler.setStateAttributeConfig(u,s.Compiler.cloneStateAttributeConfig(n.a)),o.createPrototypeObject(u,o.objectInherit(a.a.prototype,{getCompilerName:function(){return"Outline"},getOrCreateChannel:function(e){switch(e){case"Displacement":return a.a.prototype.getOrCreateChannel.call(this,e)}},getOrCreateProjectionMatrix:function(){return this.getOrCreateUniform("mat4","uProjectionMatrix")},registerTextureEnvironment:function(){},registerTextureShadow:function(){},createFragmentShaderGraph:function(){var e=this.getNode("glFragColor");return this.getNode("InlineCode").code("%frag = vec4(%color, 1.0);").inputs({color:this.getOrCreateUniform("vec3","uOutlineColor")}).outputs({frag:e}),[e]}})),t.a=u},function(e,t,i){"use strict";var r=i(5),a=i(420),n=i(562),o=r.a.osg,s=r.a.osgShader,u=function(){a.a.apply(this,arguments),this._isVertexColored=!1};s.Compiler.setStateAttributeConfig(u,s.Compiler.cloneStateAttributeConfig(n.a)),o.createPrototypeObject(u,o.objectInherit(a.a.prototype,{getCompilerName:function(){return"Wireframe"},getOrCreateChannel:function(e){switch(e){case"Displacement":return a.a.prototype.getOrCreateChannel.call(this,e)}},createFragmentShaderGraph:function(){var e=this.getNode("glFragColor");return this.getNode("InlineCode").code("%out = vec4( %color.rgb * %color.a, %color.a);").inputs({color:this.getOrCreateUniform("vec4","uColor")}).outputs({out:e}),[e]},declareScreenVertex:function(e){var t=this.getOrCreateViewVertex(),i=this.getOrCreateUniform("mat4","uProjectionMatrix"),r=this.createVariable("vec4");return this.getNode("InlineCode").code("%out = vec4(%pos.xyz, %pos.w + 0.005 / %proj[1][1]);").inputs({proj:i,pos:t}).outputs({out:r}),this.getNode("MatrixMultPosition").inputs({matrix:i,vec:r}).outputs({vec:e}),e},registerTextureEnvironment:function(){},registerTextureShadow:function(){}})),t.a=u},function(e,t,i){"use strict";var r=i(5),a=i(619),n=r.a.osg,o=r.a.osgShader,s=function(){a.a.apply(this,arguments)};o.Compiler.setStateAttributeConfig(s,o.Compiler.cloneStateAttributeConfig(a.a)),n.createPrototypeObject(s,n.objectInherit(a.a.prototype,{getCompilerName:function(){return"ShadingVr"},createFragmentShaderGraph:function(){var e=this.getOrCreateMaterialNormal(),t=this.getOrCreateUniform("float","uNormalScale");this.getNode("Mult").inputs(e,t).outputs(e);var i=this.createVariable("vec3").setValue("normalize(vec3(0.0, 0.3, 0.9))"),r=this.createVariable("float");this.getNode("InlineCode").code("%out = dot(%lightDir, %normal);").inputs({lightDir:i,normal:e}).outputs({out:r});var a=this.createVariable("vec3"),n=this.createVariable("vec3");this.getNode("ComputeLightLambertGGX").inputs({normal:e,eyeVector:this.getOrCreateNormalizedViewEyeDirection(),dotNL:r,precomputeGGX:this.getOrCreatePrecomputeGGX(),attenuation:this.getOrCreateConstantOne("float"),diffuse:this.getOrCreateMaterialDiffuseColor(),specular:this.getOrCreateMaterialSpecularPBR(),lightColor:this.createVariable("vec3").setValue("vec3(0.7, 0.7, 0.9)"),eyeLightDir:i}).outputs({diffuseOut:a,specularOut:n,lighted:this.createVariable("bool").setValue("true")});var o=this.createVariable("vec3");return this.getNode("Add").inputs(a,n).outputs(o),o=this.applyEmissive(o),[this.getFinalFrag(o)]},multiplyDiffuseWithVertexColor:function(e){if(void 0!==e){var t=this.createVariable("vec4");return this.getNode("InlineCode").code("%color.rgb = %diffuse.rgb * %vertexColor.r;").inputs({diffuse:e,vertexColor:this.getOrCreateVarying("vec4","vVertexColor")}).outputs({color:t}),t}},registerTextureEnvironment:function(){},registerTextureShadow:function(){}})),t.a=s},function(e,t,i){"use strict";var r=i(5),a=i(420),n=r.a.osg,o=r.a.osgShader,s=function(){a.a.apply(this,arguments),this._isLighted=!0},u=o.Compiler.cloneStateAttributeConfig(a.a);u.attribute=["VertexCompression","SketchfabLight0","ShadowReceive0","Morph","Skinning","PointSize"],o.Compiler.setStateAttributeConfig(s,u),n.createPrototypeObject(s,n.objectInherit(a.a.prototype,{getCompilerName:function(){return"ShadingAr"},registerTextureEnvironment:function(){},getOrCreateModelNormal:function(){if(this._fragmentShaderMode)return this.getOrCreateVarying("vec3","vModelNormal");var e=this._variables.modelNormal;return e||(e=this.createVariable("vec3","modelNormal"),this.getNode("MatrixMultDirection").inputs({matrix:this.getOrCreateUniform("mat3","uModelNormalMatrix"),vec:this.getOrCreateLocalNormal()}).outputs({vec:e}),e)},registerTextureAttributes:function(e,t){var i=e.className();return"PackedMaterialTexture"===i?this.registerTexture(e,t):"TextureEnvironment"===i?this.registerTextureEnvironment(e,t):"ShadowTexture"===i||"ShadowTextureAtlas"===i?this.registerTextureShadow(e,t):"Texture"===i||"MultiresTexture"===i?this.registerTexture(e,t):void 0},createFragmentShaderGraph:function(){var e,t=this.getNode("glFragColor");if(void 0!==this._textures[0]){var i=this.createVariable("vec2"),r=this.getOrCreateConstant("float","scaleAgain").setValue("10.0"),a=this.getOrCreateUniform("vec2","uScale"),n=this.getOrCreateVarying("vec2","vTexCoord0");this.getNode("Mult").inputs(n,a,r).outputs(i);var o=this.getOrCreateUniform("vec4","uColor"),s=this.getOrCreateSampler("sampler2D","uTextureIcon"),u=this.createVariable("vec4");this.getNode("Mult").inputs(this.createTextureRGBA(void 0,s,i),o).outputs(u),e="  vec2 fades = %texcoord * 2.0 - 1.0;\n",e+="  fades *= fades;\n",e+="  float x = max(fades.x , fades.y);\n",e+="  float fade = smoothstep(0.0, 2.0, 1.0 - x * 0.8);\n",e+="  fade =  fade * %color.a;\n",e+="  %finalColor = vec4(%color.rgb , fade);\n",e+="  %finalColor.rgb *= %finalColor.a;\n",this.getNode("InlineCode").code(e).inputs({texcoord:n,color:u}).outputs({finalColor:t})}else{var l=this.getOrCreateConstant("bool","lighted").setValue("true"),c=this.createShadowingLight(this._lights[0],l);e="  %finalColor = vec4(0.0, 0.0, 0.0, 0.5- %shadowed);\n",this.getNode("InlineCode").code(e).inputs({shadowed:c}).outputs({finalColor:t})}return[t]}})),t.a=s},function(e,t,i){"use strict";var r=i(5),a=i(420),n=r.a.osg,o=r.a.osgShader,s=function(){this._texCoordAsVertex=-1,a.a.apply(this,arguments),this._isLighted=!1},u=o.Compiler.cloneStateAttributeConfig(a.a);u.attribute=["VertexCompression","SketchfabMaterial","Morph","Skinning","PointSize","TexCoordAsVertex"],o.Compiler.setStateAttributeConfig(s,u),n.createPrototypeObject(s,n.objectInherit(a.a.prototype,{getCompilerName:function(){return"Inspector"+(this._texCoordAsVertex<0?"":"("+this._texCoordAsVertex+")")},initAttributes:function(){a.a.prototype.initAttributes.call(this);for(var e=this._attributes,t=0,i=e.length;t<i;t++){"TexCoordAsVertex"===e[t].className()&&(this._texCoordAsVertex=e[t].getTexCoord())}},getOrCreateChannel:function(e){if(!(this._texCoordAsVertex>=0)){var t;switch(e){case"Opacity":case"Displacement":case"Inspector":t=a.a.prototype.getOrCreateChannel.call(this,e)}if(!t||"Opacity"!==e)return t;return this.getVariable("float","hookAlpha")||this.forceOpaque2d(t,this.createVariable("float","hookAlpha"))}},getAlphaFinalAlpha:function(e){return e=a.a.prototype.getAlphaFinalAlpha.call(this,e),this.forceOpaque2d(e,this.createVariable("float","hookAlphaFinal"))},forceOpaque2d:function(e,t){var i=this.getOrCreateUniform("float","uDisplay2D"),r=this.getOrCreateConstantOne("float");return this.getNode("Blend").mode("MIX").inputs(e,r,i).outputs(t),t},getRGBM:function(e,t){var i=this.createVariable("vec4");return a.a.prototype.getRGBM.call(this,e,i),this.getNode("InlineCode").code("%out = %is2D == 1.0 ? vec4(%color, 1.0) : %rgbm;").inputs({is2D:this.getOrCreateUniform("float","uDisplay2D"),color:e,rgbm:i}).outputs({out:t}),t},applyInspector:function(e){var t=this.getOrCreateChannel("Inspector");if(!t)return e;var i=this._channels.Inspector,r=["%output = %invert == 0 ? %inspect : 1.0 - %inspect;","if(%mask > 0.0 && %is2D == 0.0) {","    %output = %output.x < %mask ? vec3(0.0) : vec3(1.0);","}"].join("\n");i.getTextureModel()&&(r+="\n%output *= %multColor;");var a=this.createVariable("vec3");this.getNode("InlineCode").code(r).inputs({color:e,inspect:t,invert:this.getOrCreateUniform("int","uInspectorInvert"),mask:this.getOrCreateUniform("float","uInspectorMaskThreshold"),multColor:this.getOrCreateUniform("vec3","uInspectorColor"),is2D:this.getOrCreateUniform("float","uDisplay2D")}).outputs({output:a});var n=this.getDisplayVertexColorOrAlpha();return this.getNode("Mult").inputs(a,n).outputs(a),i.getTextureModel()&&!i.getSRGB()&&this.getNode("sRGBToLinear").inputs({color:a}).outputs({result:a}),a},getOrCreateProjectionMatrix:function(){return this._texCoordAsVertex>=0?this.getOrCreateUniform("mat4","uProjectionMatrix"):a.a.prototype.getOrCreateProjectionMatrix.call(this)},getOrCreateSkinVertex:function(){if(this._texCoordAsVertex<0)return a.a.prototype.getOrCreateSkinVertex.call(this);var e=this.createVariable("vec4");return this.getNode("InlineCode").code("%out = vec4(%uv - 0.5, 1.0, 1.0);").inputs({uv:this.getOrCreateAttribute("vec2","TexCoord"+this._texCoordAsVertex)}).outputs({out:e}),e},getDisplayVertexColorOrAlpha:function(){if(!this._isVertexColored)return this.getOrCreateConstantOne("vec3");var e=this._texCoordAsVertex>=0,t=this.getOrCreateVarying("vec4","vVertexColor"),i=this.createVariable("vec3");return"linear"===this._material.getVertexColorColorSpace()?this.getNode("LinearTosRGB").inputs({color:t}).outputs({result:i}):this.getNode("SetFromNode").inputs(t).outputs(i),this._isVertexAlpha||this.getNode("InlineCode").code("%out = %displayAlpha == 0.0 ? %color : %vertexColor.aaa;").inputs({color:i,vertexColor:t,displayAlpha:this.getOrCreateUniform("float","uDisplayVertexAlpha")}).outputs({out:i}),e||this.getNode("sRGBToLinear").inputs({color:i}).outputs({result:i}),i},createFragmentShaderGraph:function(){if(this._texCoordAsVertex<0){var e=this.createVariable("vec3").setValue("vec3(0.0)");return e=this.applyInspector(e),[this.getFinalFrag(e)]}var t=this.getNode("glFragColor");return this.getNode("InlineCode").code("%out = %wire == 1 ? vec4(%color.rgb * %color.a, %color.a) : vec4(%vertexColor.rgb, 1.0);").inputs({color:this.getOrCreateUniform("vec4","uColor"),wire:this.getOrCreateUniform("int","uProjectedWireframe"),vertexColor:this.getDisplayVertexColorOrAlpha()}).outputs({out:t}),[t]},registerTextureEnvironment:function(){},registerTextureShadow:function(){}})),t.a=s},function(e,t,i){"use strict";var r=i(5),a=i(620),n=r.a.osg,o=r.a.osgShader,s=function(){a.a.apply(this,arguments),this._isVertexColored=!1},u=o.Compiler.cloneStateAttributeConfig(a.a);u.attribute=[],o.Compiler.setStateAttributeConfig(s,u),n.createPrototypeObject(s,n.objectInherit(a.a.prototype,{getCompilerName:function(){return"Skeleton"},initTextureAttributes:function(){},createFragmentShaderGraph:function(){var e=this.getNode("glFragColor");return this.getNode("SetFromNode").inputs(this.getOrCreateUniform("vec4","uColor")).outputs(e),[e]}})),t.a=s},function(e,t,i){"use strict";var r=i(59),a=i(16),n=i(607),o=i(606),s=i(42),u=i.n(s),l=function(e,t){this._key=e,this._progress=0,this._weight=0,this._active=!1,this._progressUpdate=t,this._promises,this._nbPromisesDone=0,this._lastSetPromiseId=0,this._cbFakeUpdate,this._refTime,this._totalBytes=0};l.prototype={setPromises:function(e){this._progress=0,this._promises=e,this._nbPromisesDone=0,this._totalBytes=0,this._lastSetPromiseId++,this._cbFakeUpdate=this._onPromiseAutoUpdate.bind(this,this._lastSetPromiseId);for(var t=0;t<this._promises.length;++t){var i=this._promises[t];i.finally(this._onPromiseDone.bind(this,this._lastSetPromiseId,i.size||0)),this._totalBytes+=this._promises[t].progressSize||0}window.setTimeout(this._cbFakeUpdate,100),this._updateRefTime()},_updateRefTime:function(){this._refTime=(new Date).getTime()},_onPromiseDone:function(e,t){this._lastSetPromiseId===e&&(this._totalBytes-=t,this._updateRefTime(),this._nbPromisesDone++,this._progress=this._nbPromisesDone/this._promises.length,this._progressUpdate(this))},_onPromiseAutoUpdate:function(e){if(this._lastSetPromiseId===e){var t=this._promises.length;if(this._nbPromisesDone!==t){var i=2e-4*((new Date).getTime()-this._refTime),r=this._nbPromisesDone/t,a=(this._nbPromisesDone+1)/t;this._progress=a-(a-r)/(i*i+1),this._progressUpdate(this),window.setTimeout(this._cbFakeUpdate,100)}}}};var c=function(e){this._triggerProgress=e,this._primaryChannels=[],this._secondaryChannels=[],this._init()};c.prototype={_init:function(){var e=this._updateChannelProgress.bind(this,!1),t=this._primaryChannels;t.push(new l("texture",e)),t.push(new l("polygon",e)),t.push(new l("osgjs",e)),t.push(new l("wireframe",e));var i=this._updateChannelProgress.bind(this,!0),r=this._secondaryChannels;r.push(new l("texture",i)),r.push(new l("environment",i)),r.push(new l("background",i)),r.push(new l("wireframe",i))},initPrimaryProgress:function(e,t,i){var r=this._getProgressChannel("texture",!1),a=this._getProgressChannel("polygon",!1),n=this._getProgressChannel("osgjs",!1),o=this._getProgressChannel("wireframe",!1);r._totalBytes=this._estimateTexturesSize(),a._totalBytes=t,n._totalBytes=e,o._totalBytes=i,r._active=!0,a._active=!0,n._active=!0,o._active=i>0,this._autoComputeWeights()},_estimateTexturesSize:function(){var e=r.default.instance.getTextureCollection().models,t=e.length;if(!t)return 0;if(!Object(a.a)().preload)return 5e3*t;var i,s=0,l=0,c=Object(n.a)();for(i=0;i<t;++i){var h=e[i].findImageNearestPowerOfTwoUpToResolution(c,c);l+=h.width*h.height,s=Math.max(s,h.width,h.height)}var d=Object(a.a)().pixelBudget;d=void 0!==d?0===d?1/0:d:u.a.any?6144:12288,d*=d;var p=Math.min(c,Math.sqrt(d/t));p=o.a.snapToPowerOf2(p,.75),(s<=c||l<=p*p)&&(p=c);var f=0;for(i=0;i<t;++i)f+=e[i].findImageNearestPowerOfTwoUpToResolution(p,p).size;return f},_getProgressChannel:function(e,t){for(var i=t?this._secondaryChannels:this._primaryChannels,r=0;r<i.length;++r)if(i[r]._key===e)return i[r]},_autoComputeWeights:function(e){var t=e?this._secondaryChannels:this._primaryChannels,i=0,r=0,a=0,n=0;for(r=0;r<t.length;++r)t[r]._active&&(i++,a+=t[r]._totalBytes,t[r]._totalBytes||n++);var o=1/i,s=1-o*n;for(r=0;r<t.length;++r)if(t[r]._active){var u=t[r]._totalBytes;t[r]._weight=u?s*u/a:o}else t[r]._weight=0},_updateChannelProgress:function(e,t){var i=e?this._secondaryChannels:this._primaryChannels;e&&!t._active&&(t._active=!0,this._autoComputeWeights(!0));var r=0,a=0;for(a=0;a<i.length;++a)r+=i[a]._progress*i[a]._weight;var n=e?"secondary-progress":"primary-progress";if(this._triggerProgress(n,{progress:r}),1===r)for(a=0;a<i.length;++a)i[a]._active=!1},updateProgress:function(e,t,i){var r=this._getProgressChannel(i,t);r._progress=e,this._updateChannelProgress(t,r)},setFakeProgress:function(e,t,i){var r=this._getProgressChannel(i,t);if(!r)return void console.error("Unexpected progress channel key : "+i);void 0===e.length&&(e=[e]),r.setPromises(e),t||this._autoComputeWeights()}},t.a=c}]);
//# sourceMappingURL=viewer-2c33777814c9f71e9b79.js.map